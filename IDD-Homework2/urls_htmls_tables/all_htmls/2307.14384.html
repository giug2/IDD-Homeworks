<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2307.14384] HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning</title><meta property="og:description" content="Federated learning (FL) collaboratively models user data in a decentralized way.
However, in the real world,
non-identical and independent data distributions (non-IID) among clients hinder the performance of FL due to …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2307.14384">

<!--Generated on Wed Feb 28 16:13:00 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Xinting Liao<sup id="id12.2.id1" class="ltx_sup">1</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Weiming Liu<sup id="id13.2.id1" class="ltx_sup">1</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chaochao Chen<sup id="id14.2.id1" class="ltx_sup"><span id="id14.2.id1.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes">Chaochao Chen is the corresponding author.</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pengyang Zhou<sup id="id15.2.id1" class="ltx_sup">1</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Huabin Zhu<sup id="id16.2.id1" class="ltx_sup">1</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<br class="ltx_break">Yanchao Tan<sup id="id17.2.id1" class="ltx_sup">2</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jun Wang<sup id="id18.6.id1" class="ltx_sup">3</sup>&amp;Yue Qi<sup id="id19.7.id2" class="ltx_sup">3</sup>
<sup id="id20.8.id3" class="ltx_sup">1</sup>College of Computer Science and Technology, Zhejiang University, Hangzhou, China
<br class="ltx_break"><sup id="id21.9.id4" class="ltx_sup">2</sup>College of Computer and Data Science, Fuzhou University, Fuzhou, China
<br class="ltx_break"><sup id="id22.10.id5" class="ltx_sup">3</sup>OPPO Research Institute, Shenzhen, China
<br class="ltx_break">{xintingliao, 21831010, zjuccc, zhoupy, zhb2000}@zju.edu.cn,
yctan@fzu.edu.cn,
junwang.lu@gmail.com,
qiyue@oppo.com
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id23.id1" class="ltx_p">Federated learning (FL) collaboratively models user data in a decentralized way.
However, in the real world,
non-identical and independent data distributions (non-IID) among clients hinder the performance of FL due to three issues, i.e., (1) the class statistics shifting, (2) the insufficient hierarchical information utilization, and (3) the inconsistency in aggregating clients.
To address the above issues, we propose <span id="id23.id1.1" class="ltx_text ltx_font_typewriter">HyperFed</span> which contains three main modules, i.e., hyperbolic prototype Tammes initialization (HPTI), hyperbolic prototype learning (HPL), and consistent aggregation (CA).
Firstly, HPTI in the server constructs uniformly distributed and fixed class prototypes, and shares them with clients to match class statistics, further guiding consistent feature representation for local clients.
Secondly, HPL in each client captures the hierarchical information in local data with the supervision of shared class prototypes in the hyperbolic model space.
Additionally, CA in the server mitigates the impact of the inconsistent deviations from clients to server.
Extensive studies of four datasets prove that <span id="id23.id1.2" class="ltx_text ltx_font_typewriter">HyperFed</span> is effective in enhancing the performance of FL under the non-IID setting.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL) trains a global model by collaboratively modeling decentralized data in local clients <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib34" title="" class="ltx_ref">2017</a>)</cite>.
Disappointingly, FL
comes into a performance bottleneck in many real-world applications, where clients contain data with
non-identical and independent distributions (non-IID)  <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib22" title="" class="ltx_ref">2019</a>); Zhao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib50" title="" class="ltx_ref">2018</a>)</cite>.
Taking a hand-written recognition system as an example,
different people have their personalized writing styles, making hand-written characters and letters differ in shape, size, and so on.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2307.14384/assets/figs/motivation.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="329" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>A motivation of fixed class prototypes in hyperbolic space.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Existing FL work with non-IID data either improves the performance of the general global model or enhances the personalized local model.
First, to obtain better global performance, a number of work tries to modify the local objectives by adding regularization, so as to make them consistent with generic global performance, e.g., FedProx <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite>.
Second, to enhance the performance of the local models, a series of studies encourage training a personalized model for individual clients with meta-learning <cite class="ltx_cite ltx_citemacro_cite">Fallah <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite>, transfer learning<cite class="ltx_cite ltx_citemacro_cite">Luo <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib32" title="" class="ltx_ref">2022</a>)</cite>, and so on.
Recently, FedBABU <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib38" title="" class="ltx_ref">Oh <span class="ltx_text ltx_font_italic">et al.</span> </a></cite> and Fed-RoD <cite class="ltx_cite ltx_citemacro_cite">Chen and Chao (<a href="#bib.bib4" title="" class="ltx_ref">2021</a>)</cite> find it possible to enhance global and local models simultaneously, which decouple model in FL into two parts, i.e., one for global generalization and the other for personalization.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Nevertheless, most existing methods overlook three issues in FL with non-IID data.
Firstly, <span id="S1.p3.1.1" class="ltx_text ltx_font_italic"> class statistics shifting <span id="S1.p3.1.1.1" class="ltx_text ltx_font_bold">(Issue 1)</span></span> happens in FL with non-IID data.
Clients have different class statistics information of local data distributions, i.e., the class prototypes, which will shift and bring trivial solutions in FL without fixing.
As Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(a) shows, ignoring fixing class prototypes brings two inevitable limits.
Client A fails to recognize the missing class, i.e., data corresponding to some class is missing, while client B causes the class overlapping, i.e., gathering the prototypes of blue and gray classes too tight to discriminate their image features.
Though FedBABU <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib38" title="" class="ltx_ref">Oh <span class="ltx_text ltx_font_italic">et al.</span> </a></cite> and SphereFed <cite class="ltx_cite ltx_citemacro_cite">Dong <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2022</a>)</cite> contribute to addressing this issue, they suffer from the <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">dimension dilemma</span> problem, i.e., they either lack scalability in low-dimensional space, or generate sparse representation in high-dimensional space.
Secondly, current work only captures the semantic information of non-IID data, having <span id="S1.p3.1.3" class="ltx_text ltx_font_italic">the insufficient hierarchical information utilization</span> issue <span id="S1.p3.1.4" class="ltx_text ltx_font_bold">(Issue 2)</span>.
As depicted in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(b), it is hard to gather the data samples of the same class together without hierarchical information.
Hierarchical information can be helpful to group data samples and generate fine-grained representations, which can further bring prediction gains.
To take this advantage, hyperbolic models are used for continuously capturing the hierarchical structure of data in the low-dimensional space <cite class="ltx_cite ltx_citemacro_cite">Liu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib28" title="" class="ltx_ref">2020</a>); Linial <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib26" title="" class="ltx_ref">1995</a>)</cite>, whose effectiveness is proved in computer vision <cite class="ltx_cite ltx_citemacro_cite">Khrulkov <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite>, recommender systems <cite class="ltx_cite ltx_citemacro_cite">Tan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib47" title="" class="ltx_ref">2022b</a>)</cite>, and natural language processing <cite class="ltx_cite ltx_citemacro_cite">Chen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib6" title="" class="ltx_ref">2022b</a>)</cite>.
However, how to integrate existing FL methods with the hierarchical information in hyperbolic space remains unknown.
Lastly, <span id="S1.p3.1.5" class="ltx_text ltx_font_italic">the inconsistency in aggregating clients <span id="S1.p3.1.5.1" class="ltx_text ltx_font_bold">(Issue 3)</span></span> deteriorates the performance of current FL methods as well.
In practice, clients usually have statistically heterogeneous data.
Existing aggregation methods, e.g., weighted average with data amounts, result in the aggregated global model deviating from the optimal global model.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this work, we propose <span id="S1.p4.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span> which contains three modules to address the above issues, respectively.
To solve <span id="S1.p4.1.2" class="ltx_text ltx_font_bold ltx_font_italic">Issue 1</span> and avoid dimension dilemma, <span id="S1.p4.1.3" class="ltx_text ltx_font_typewriter">HyperFed</span> contains <span id="S1.p4.1.4" class="ltx_text ltx_font_bold">hyperbolic prototype Tammes initialization (HPTI)</span> module in server.
The server first uses Tammes prototype initialization (TPI) to construct uniformly distributed class prototypes for the whole class set in hyperbolic space.
Then the server fixes the position of class prototypes, and shares class prototypes to initialize the hyperbolic predictors of clients.
In this way, <span id="S1.p4.1.5" class="ltx_text ltx_font_typewriter">HyperFed</span> not only guides the consistent and separated criteria, but also introduces the statistics of missing class, both of which encourage discriminative and fine-grained feature representation for non-IID data.
To avoid <span id="S1.p4.1.6" class="ltx_text ltx_font_bold ltx_font_italic">Issue 2</span>,
with the supervision of hyperbolic prototypes, <span id="S1.p4.1.7" class="ltx_text ltx_font_bold">hyperbolic prototype learning (HPL)</span> module in each client pulls the data sample close to its ground truth class prototype, and pushes other data samples away.
Thus <span id="S1.p4.1.8" class="ltx_text ltx_font_typewriter">HyperFed</span> enjoys the benefits of predicting with hierarchical information.
To tackle
<span id="S1.p4.1.9" class="ltx_text ltx_font_bold ltx_font_italic">Issue 3</span>, <span id="S1.p4.1.10" class="ltx_text ltx_font_typewriter">HyperFed</span> has a <span id="S1.p4.1.11" class="ltx_text ltx_font_bold">consistent aggregation (CA)</span> module that resolves the inconsistent deviations from clients to server by solving a multi-objective optimization with Pareto constraints.
Hence <span id="S1.p4.1.12" class="ltx_text ltx_font_typewriter">HyperFed</span> obtains consistent updating direction among clients, without the need of cumbersome grid search for aggregating clients.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In summary, we are the first, as far as we know, to explore hyperbolic prototypes in FL with non-IID Data.
We contribute in:
(1)
We adopt uniformly distributed and fixed class prototypes in hyperbolic space to alleviate the
impact of statistics shifting.
(2)
We
sufficiently leverage hyperbolic representation space to capture hierarchical information for FL.
(3) We optimize the aggregation of different client model to a Pareto stationary point, minimizing the impact of inconsistent clients deviations.
(4) Extensive experiments on four benchmark datasets prove the effectiveness of <span id="S1.p5.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning for Non-IID Data</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">In terms of the goal of optimization, there are mainly three categories of common FL work that tackles non-IID data:
(1) Global performance, which modifies the local objectives with a regularization term to obtain a
well-performed global model <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite>.
FedProx <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite> proposes an additional proximal term to local objective, which penalizes the updated local model that is far away from the global model.
FedDYN <cite class="ltx_cite ltx_citemacro_cite">Acar <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2020</a>)</cite> and MOON <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021a</a>)</cite> regularize the model change with both historical global and local models simultaneously.
(2) Local performance, which trains a personalized model for individual clients to enhance the performance of local models <cite class="ltx_cite ltx_citemacro_cite">T Dinh <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib44" title="" class="ltx_ref">2020</a>)</cite>;
and (3) Global and local performance, which empirically decomposes the network in FL into the body for universal representation, and the head for personalized classification.
Fed-RoD <cite class="ltx_cite ltx_citemacro_cite">Chen and Chao (<a href="#bib.bib4" title="" class="ltx_ref">2021</a>)</cite> consists of two classifiers to maintain the local and global performance, respectively.
However, no above work takes action to avoid class shifting.
Few work fixes the classifier to fill this gap, e.g., FedBABU <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib38" title="" class="ltx_ref">Oh <span class="ltx_text ltx_font_italic">et al.</span> </a></cite> and SphereFed <cite class="ltx_cite ltx_citemacro_cite">Dong <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2022</a>)</cite>.
FedBABU randomly initializes and fixes the classifier during training FL, which cannot guarantee the separation of different classes is distinguishable enough.
SphereFed considers fixing the classifier in hyperspherical space.
But SphereFed either lacks scalability in low-dimensional space, or generates sparse representation in high-dimensional space.
VFGNN <cite class="ltx_cite ltx_citemacro_cite">Chen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib5" title="" class="ltx_ref">2022a</a>)</cite> utilizes graph sturcture in vertical FL rather than horizontal FL.
Moreover, few existing work considers utilizing hierarchical structure and consistent aggregation, which degrades FL with non-IID data.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Hyperbolic Representation Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Hyperbolic geometry is a non-Euclidean geometry, which can be constructed by various isomorphic models, e.g., Poincaré model <cite class="ltx_cite ltx_citemacro_cite">Nickel and Kiela (<a href="#bib.bib37" title="" class="ltx_ref">2017</a>)</cite>.
Hyperbolic modeling has been leveraged in various deep networks, such as fully-connected layers <cite class="ltx_cite ltx_citemacro_cite">Shimizu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib42" title="" class="ltx_ref">2020</a>)</cite>, convolutional layers <cite class="ltx_cite ltx_citemacro_cite">Shimizu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib42" title="" class="ltx_ref">2020</a>)</cite>, recurrent layers <cite class="ltx_cite ltx_citemacro_cite">Ganea <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib13" title="" class="ltx_ref">2018</a>)</cite>, classification layers <cite class="ltx_cite ltx_citemacro_cite">Cho <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib7" title="" class="ltx_ref">2019</a>); Weber <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib48" title="" class="ltx_ref">2020</a>)</cite>, graph neural networks <cite class="ltx_cite ltx_citemacro_cite">Liu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib27" title="" class="ltx_ref">2019</a>); Tan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib46" title="" class="ltx_ref">2022a</a>)</cite> and Transformer <cite class="ltx_cite ltx_citemacro_cite">Ermolov <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib11" title="" class="ltx_ref">2022</a>)</cite>.
However, the existing work overlooks taking the advantage of hyperbolic learning in FL.
<cite class="ltx_cite ltx_citemacro_cite">Shen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib41" title="" class="ltx_ref">2021</a>); Mettes <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib35" title="" class="ltx_ref">2019</a>); Ghadimi Atigh <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>
treat additional prior using orthogonal basis or the prior knowledge
embeddings as hyperbolic prototypes, which are positioned as distant as possible from the origin, to avoid frequently updating in prototype learning.
These motivate us to utilize hyperbolic prototypes
in <span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span>.
On the contrary, we contract the class prototypes away from the bound of the Poincaré ball model,
aiming to obtain more general class semantic information.

</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminary: Poincaré Ball Model</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.11" class="ltx_p">Poincaré ball model is one of the common models in hyperbolic space, which is a type of Riemannian manifold <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathcal{M}</annotation></semantics></math> with constant negative curvature.
In this work, <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="||\bm{x}||_{2}=\sqrt{\Sigma_{i=1}^{n}x_{i}^{2}}" display="inline"><semantics id="S3.p1.2.m2.1a"><mrow id="S3.p1.2.m2.1.2" xref="S3.p1.2.m2.1.2.cmml"><msub id="S3.p1.2.m2.1.2.2" xref="S3.p1.2.m2.1.2.2.cmml"><mrow id="S3.p1.2.m2.1.2.2.2.2" xref="S3.p1.2.m2.1.2.2.2.1.cmml"><mo stretchy="false" id="S3.p1.2.m2.1.2.2.2.2.1" xref="S3.p1.2.m2.1.2.2.2.1.1.cmml">‖</mo><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.p1.2.m2.1.2.2.2.2.2" xref="S3.p1.2.m2.1.2.2.2.1.1.cmml">‖</mo></mrow><mn id="S3.p1.2.m2.1.2.2.3" xref="S3.p1.2.m2.1.2.2.3.cmml">2</mn></msub><mo id="S3.p1.2.m2.1.2.1" xref="S3.p1.2.m2.1.2.1.cmml">=</mo><msqrt id="S3.p1.2.m2.1.2.3" xref="S3.p1.2.m2.1.2.3.cmml"><mrow id="S3.p1.2.m2.1.2.3.2" xref="S3.p1.2.m2.1.2.3.2.cmml"><msubsup id="S3.p1.2.m2.1.2.3.2.2" xref="S3.p1.2.m2.1.2.3.2.2.cmml"><mi mathvariant="normal" id="S3.p1.2.m2.1.2.3.2.2.2.2" xref="S3.p1.2.m2.1.2.3.2.2.2.2.cmml">Σ</mi><mrow id="S3.p1.2.m2.1.2.3.2.2.2.3" xref="S3.p1.2.m2.1.2.3.2.2.2.3.cmml"><mi id="S3.p1.2.m2.1.2.3.2.2.2.3.2" xref="S3.p1.2.m2.1.2.3.2.2.2.3.2.cmml">i</mi><mo id="S3.p1.2.m2.1.2.3.2.2.2.3.1" xref="S3.p1.2.m2.1.2.3.2.2.2.3.1.cmml">=</mo><mn id="S3.p1.2.m2.1.2.3.2.2.2.3.3" xref="S3.p1.2.m2.1.2.3.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.p1.2.m2.1.2.3.2.2.3" xref="S3.p1.2.m2.1.2.3.2.2.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.p1.2.m2.1.2.3.2.1" xref="S3.p1.2.m2.1.2.3.2.1.cmml">​</mo><msubsup id="S3.p1.2.m2.1.2.3.2.3" xref="S3.p1.2.m2.1.2.3.2.3.cmml"><mi id="S3.p1.2.m2.1.2.3.2.3.2.2" xref="S3.p1.2.m2.1.2.3.2.3.2.2.cmml">x</mi><mi id="S3.p1.2.m2.1.2.3.2.3.2.3" xref="S3.p1.2.m2.1.2.3.2.3.2.3.cmml">i</mi><mn id="S3.p1.2.m2.1.2.3.2.3.3" xref="S3.p1.2.m2.1.2.3.2.3.3.cmml">2</mn></msubsup></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.2.cmml" xref="S3.p1.2.m2.1.2"><eq id="S3.p1.2.m2.1.2.1.cmml" xref="S3.p1.2.m2.1.2.1"></eq><apply id="S3.p1.2.m2.1.2.2.cmml" xref="S3.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.2.2.1.cmml" xref="S3.p1.2.m2.1.2.2">subscript</csymbol><apply id="S3.p1.2.m2.1.2.2.2.1.cmml" xref="S3.p1.2.m2.1.2.2.2.2"><csymbol cd="latexml" id="S3.p1.2.m2.1.2.2.2.1.1.cmml" xref="S3.p1.2.m2.1.2.2.2.2.1">norm</csymbol><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝒙</ci></apply><cn type="integer" id="S3.p1.2.m2.1.2.2.3.cmml" xref="S3.p1.2.m2.1.2.2.3">2</cn></apply><apply id="S3.p1.2.m2.1.2.3.cmml" xref="S3.p1.2.m2.1.2.3"><root id="S3.p1.2.m2.1.2.3a.cmml" xref="S3.p1.2.m2.1.2.3"></root><apply id="S3.p1.2.m2.1.2.3.2.cmml" xref="S3.p1.2.m2.1.2.3.2"><times id="S3.p1.2.m2.1.2.3.2.1.cmml" xref="S3.p1.2.m2.1.2.3.2.1"></times><apply id="S3.p1.2.m2.1.2.3.2.2.cmml" xref="S3.p1.2.m2.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.2.3.2.2.1.cmml" xref="S3.p1.2.m2.1.2.3.2.2">superscript</csymbol><apply id="S3.p1.2.m2.1.2.3.2.2.2.cmml" xref="S3.p1.2.m2.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.2.3.2.2.2.1.cmml" xref="S3.p1.2.m2.1.2.3.2.2">subscript</csymbol><ci id="S3.p1.2.m2.1.2.3.2.2.2.2.cmml" xref="S3.p1.2.m2.1.2.3.2.2.2.2">Σ</ci><apply id="S3.p1.2.m2.1.2.3.2.2.2.3.cmml" xref="S3.p1.2.m2.1.2.3.2.2.2.3"><eq id="S3.p1.2.m2.1.2.3.2.2.2.3.1.cmml" xref="S3.p1.2.m2.1.2.3.2.2.2.3.1"></eq><ci id="S3.p1.2.m2.1.2.3.2.2.2.3.2.cmml" xref="S3.p1.2.m2.1.2.3.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.p1.2.m2.1.2.3.2.2.2.3.3.cmml" xref="S3.p1.2.m2.1.2.3.2.2.2.3.3">1</cn></apply></apply><ci id="S3.p1.2.m2.1.2.3.2.2.3.cmml" xref="S3.p1.2.m2.1.2.3.2.2.3">𝑛</ci></apply><apply id="S3.p1.2.m2.1.2.3.2.3.cmml" xref="S3.p1.2.m2.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.2.3.2.3.1.cmml" xref="S3.p1.2.m2.1.2.3.2.3">superscript</csymbol><apply id="S3.p1.2.m2.1.2.3.2.3.2.cmml" xref="S3.p1.2.m2.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.2.3.2.3.2.1.cmml" xref="S3.p1.2.m2.1.2.3.2.3">subscript</csymbol><ci id="S3.p1.2.m2.1.2.3.2.3.2.2.cmml" xref="S3.p1.2.m2.1.2.3.2.3.2.2">𝑥</ci><ci id="S3.p1.2.m2.1.2.3.2.3.2.3.cmml" xref="S3.p1.2.m2.1.2.3.2.3.2.3">𝑖</ci></apply><cn type="integer" id="S3.p1.2.m2.1.2.3.2.3.3.cmml" xref="S3.p1.2.m2.1.2.3.2.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">||\bm{x}||_{2}=\sqrt{\Sigma_{i=1}^{n}x_{i}^{2}}</annotation></semantics></math> is a Euclidean norm.
The Poincaré is an open ball model in <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">n</annotation></semantics></math>-dimensional hyperbolic space defined as <math id="S3.p1.4.m4.2" class="ltx_Math" alttext="(\mathbb{P}^{n},g^{\mathbb{P}})" display="inline"><semantics id="S3.p1.4.m4.2a"><mrow id="S3.p1.4.m4.2.2.2" xref="S3.p1.4.m4.2.2.3.cmml"><mo stretchy="false" id="S3.p1.4.m4.2.2.2.3" xref="S3.p1.4.m4.2.2.3.cmml">(</mo><msup id="S3.p1.4.m4.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.cmml"><mi id="S3.p1.4.m4.1.1.1.1.2" xref="S3.p1.4.m4.1.1.1.1.2.cmml">ℙ</mi><mi id="S3.p1.4.m4.1.1.1.1.3" xref="S3.p1.4.m4.1.1.1.1.3.cmml">n</mi></msup><mo id="S3.p1.4.m4.2.2.2.4" xref="S3.p1.4.m4.2.2.3.cmml">,</mo><msup id="S3.p1.4.m4.2.2.2.2" xref="S3.p1.4.m4.2.2.2.2.cmml"><mi id="S3.p1.4.m4.2.2.2.2.2" xref="S3.p1.4.m4.2.2.2.2.2.cmml">g</mi><mi id="S3.p1.4.m4.2.2.2.2.3" xref="S3.p1.4.m4.2.2.2.2.3.cmml">ℙ</mi></msup><mo stretchy="false" id="S3.p1.4.m4.2.2.2.5" xref="S3.p1.4.m4.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.2b"><interval closure="open" id="S3.p1.4.m4.2.2.3.cmml" xref="S3.p1.4.m4.2.2.2"><apply id="S3.p1.4.m4.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1">superscript</csymbol><ci id="S3.p1.4.m4.1.1.1.1.2.cmml" xref="S3.p1.4.m4.1.1.1.1.2">ℙ</ci><ci id="S3.p1.4.m4.1.1.1.1.3.cmml" xref="S3.p1.4.m4.1.1.1.1.3">𝑛</ci></apply><apply id="S3.p1.4.m4.2.2.2.2.cmml" xref="S3.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.2.2.2.2.1.cmml" xref="S3.p1.4.m4.2.2.2.2">superscript</csymbol><ci id="S3.p1.4.m4.2.2.2.2.2.cmml" xref="S3.p1.4.m4.2.2.2.2.2">𝑔</ci><ci id="S3.p1.4.m4.2.2.2.2.3.cmml" xref="S3.p1.4.m4.2.2.2.2.3">ℙ</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.2c">(\mathbb{P}^{n},g^{\mathbb{P}})</annotation></semantics></math>, where <math id="S3.p1.5.m5.3" class="ltx_Math" alttext="\mathbb{P}^{n}=\{\bm{x}\in\mathbb{R}^{n}:||\bm{x}||_{2}&lt;1\}" display="inline"><semantics id="S3.p1.5.m5.3a"><mrow id="S3.p1.5.m5.3.3" xref="S3.p1.5.m5.3.3.cmml"><msup id="S3.p1.5.m5.3.3.4" xref="S3.p1.5.m5.3.3.4.cmml"><mi id="S3.p1.5.m5.3.3.4.2" xref="S3.p1.5.m5.3.3.4.2.cmml">ℙ</mi><mi id="S3.p1.5.m5.3.3.4.3" xref="S3.p1.5.m5.3.3.4.3.cmml">n</mi></msup><mo id="S3.p1.5.m5.3.3.3" xref="S3.p1.5.m5.3.3.3.cmml">=</mo><mrow id="S3.p1.5.m5.3.3.2.2" xref="S3.p1.5.m5.3.3.2.3.cmml"><mo stretchy="false" id="S3.p1.5.m5.3.3.2.2.3" xref="S3.p1.5.m5.3.3.2.3.1.cmml">{</mo><mrow id="S3.p1.5.m5.2.2.1.1.1" xref="S3.p1.5.m5.2.2.1.1.1.cmml"><mi id="S3.p1.5.m5.2.2.1.1.1.2" xref="S3.p1.5.m5.2.2.1.1.1.2.cmml">𝒙</mi><mo id="S3.p1.5.m5.2.2.1.1.1.1" xref="S3.p1.5.m5.2.2.1.1.1.1.cmml">∈</mo><msup id="S3.p1.5.m5.2.2.1.1.1.3" xref="S3.p1.5.m5.2.2.1.1.1.3.cmml"><mi id="S3.p1.5.m5.2.2.1.1.1.3.2" xref="S3.p1.5.m5.2.2.1.1.1.3.2.cmml">ℝ</mi><mi id="S3.p1.5.m5.2.2.1.1.1.3.3" xref="S3.p1.5.m5.2.2.1.1.1.3.3.cmml">n</mi></msup></mrow><mo lspace="0.278em" rspace="0.278em" id="S3.p1.5.m5.3.3.2.2.4" xref="S3.p1.5.m5.3.3.2.3.1.cmml">:</mo><mrow id="S3.p1.5.m5.3.3.2.2.2" xref="S3.p1.5.m5.3.3.2.2.2.cmml"><msub id="S3.p1.5.m5.3.3.2.2.2.2" xref="S3.p1.5.m5.3.3.2.2.2.2.cmml"><mrow id="S3.p1.5.m5.3.3.2.2.2.2.2.2" xref="S3.p1.5.m5.3.3.2.2.2.2.2.1.cmml"><mo stretchy="false" id="S3.p1.5.m5.3.3.2.2.2.2.2.2.1" xref="S3.p1.5.m5.3.3.2.2.2.2.2.1.1.cmml">‖</mo><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.p1.5.m5.3.3.2.2.2.2.2.2.2" xref="S3.p1.5.m5.3.3.2.2.2.2.2.1.1.cmml">‖</mo></mrow><mn id="S3.p1.5.m5.3.3.2.2.2.2.3" xref="S3.p1.5.m5.3.3.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.p1.5.m5.3.3.2.2.2.1" xref="S3.p1.5.m5.3.3.2.2.2.1.cmml">&lt;</mo><mn id="S3.p1.5.m5.3.3.2.2.2.3" xref="S3.p1.5.m5.3.3.2.2.2.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.p1.5.m5.3.3.2.2.5" xref="S3.p1.5.m5.3.3.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.3b"><apply id="S3.p1.5.m5.3.3.cmml" xref="S3.p1.5.m5.3.3"><eq id="S3.p1.5.m5.3.3.3.cmml" xref="S3.p1.5.m5.3.3.3"></eq><apply id="S3.p1.5.m5.3.3.4.cmml" xref="S3.p1.5.m5.3.3.4"><csymbol cd="ambiguous" id="S3.p1.5.m5.3.3.4.1.cmml" xref="S3.p1.5.m5.3.3.4">superscript</csymbol><ci id="S3.p1.5.m5.3.3.4.2.cmml" xref="S3.p1.5.m5.3.3.4.2">ℙ</ci><ci id="S3.p1.5.m5.3.3.4.3.cmml" xref="S3.p1.5.m5.3.3.4.3">𝑛</ci></apply><apply id="S3.p1.5.m5.3.3.2.3.cmml" xref="S3.p1.5.m5.3.3.2.2"><csymbol cd="latexml" id="S3.p1.5.m5.3.3.2.3.1.cmml" xref="S3.p1.5.m5.3.3.2.2.3">conditional-set</csymbol><apply id="S3.p1.5.m5.2.2.1.1.1.cmml" xref="S3.p1.5.m5.2.2.1.1.1"><in id="S3.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.p1.5.m5.2.2.1.1.1.1"></in><ci id="S3.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.p1.5.m5.2.2.1.1.1.2">𝒙</ci><apply id="S3.p1.5.m5.2.2.1.1.1.3.cmml" xref="S3.p1.5.m5.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.5.m5.2.2.1.1.1.3.1.cmml" xref="S3.p1.5.m5.2.2.1.1.1.3">superscript</csymbol><ci id="S3.p1.5.m5.2.2.1.1.1.3.2.cmml" xref="S3.p1.5.m5.2.2.1.1.1.3.2">ℝ</ci><ci id="S3.p1.5.m5.2.2.1.1.1.3.3.cmml" xref="S3.p1.5.m5.2.2.1.1.1.3.3">𝑛</ci></apply></apply><apply id="S3.p1.5.m5.3.3.2.2.2.cmml" xref="S3.p1.5.m5.3.3.2.2.2"><lt id="S3.p1.5.m5.3.3.2.2.2.1.cmml" xref="S3.p1.5.m5.3.3.2.2.2.1"></lt><apply id="S3.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.p1.5.m5.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.3.3.2.2.2.2.1.cmml" xref="S3.p1.5.m5.3.3.2.2.2.2">subscript</csymbol><apply id="S3.p1.5.m5.3.3.2.2.2.2.2.1.cmml" xref="S3.p1.5.m5.3.3.2.2.2.2.2.2"><csymbol cd="latexml" id="S3.p1.5.m5.3.3.2.2.2.2.2.1.1.cmml" xref="S3.p1.5.m5.3.3.2.2.2.2.2.2.1">norm</csymbol><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝒙</ci></apply><cn type="integer" id="S3.p1.5.m5.3.3.2.2.2.2.3.cmml" xref="S3.p1.5.m5.3.3.2.2.2.2.3">2</cn></apply><cn type="integer" id="S3.p1.5.m5.3.3.2.2.2.3.cmml" xref="S3.p1.5.m5.3.3.2.2.2.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.3c">\mathbb{P}^{n}=\{\bm{x}\in\mathbb{R}^{n}:||\bm{x}||_{2}&lt;1\}</annotation></semantics></math>
and <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="g^{\mathbb{P}}" display="inline"><semantics id="S3.p1.6.m6.1a"><msup id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml"><mi id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml">g</mi><mi id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">ℙ</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1">superscript</csymbol><ci id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2">𝑔</ci><ci id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3">ℙ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">g^{\mathbb{P}}</annotation></semantics></math> is the Riemannian metric of a Poincaré ball.
<math id="S3.p1.7.m7.1" class="ltx_Math" alttext="g^{\mathbb{P}}" display="inline"><semantics id="S3.p1.7.m7.1a"><msup id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">g</mi><mi id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml">ℙ</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1">superscript</csymbol><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">𝑔</ci><ci id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3">ℙ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">g^{\mathbb{P}}</annotation></semantics></math> is conformal to the metric of Euclidean space <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="g^{\mathbb{E}}" display="inline"><semantics id="S3.p1.8.m8.1a"><msup id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml"><mi id="S3.p1.8.m8.1.1.2" xref="S3.p1.8.m8.1.1.2.cmml">g</mi><mi id="S3.p1.8.m8.1.1.3" xref="S3.p1.8.m8.1.1.3.cmml">𝔼</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1">superscript</csymbol><ci id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1.2">𝑔</ci><ci id="S3.p1.8.m8.1.1.3.cmml" xref="S3.p1.8.m8.1.1.3">𝔼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">g^{\mathbb{E}}</annotation></semantics></math>, i.e.,
<math id="S3.p1.9.m9.1" class="ltx_Math" alttext="g^{\mathbb{P}}_{\bm{x}}=\lambda_{\bm{x}}^{2}g^{\mathbb{E}}," display="inline"><semantics id="S3.p1.9.m9.1a"><mrow id="S3.p1.9.m9.1.1.1" xref="S3.p1.9.m9.1.1.1.1.cmml"><mrow id="S3.p1.9.m9.1.1.1.1" xref="S3.p1.9.m9.1.1.1.1.cmml"><msubsup id="S3.p1.9.m9.1.1.1.1.2" xref="S3.p1.9.m9.1.1.1.1.2.cmml"><mi id="S3.p1.9.m9.1.1.1.1.2.2.2" xref="S3.p1.9.m9.1.1.1.1.2.2.2.cmml">g</mi><mi id="S3.p1.9.m9.1.1.1.1.2.3" xref="S3.p1.9.m9.1.1.1.1.2.3.cmml">𝒙</mi><mi id="S3.p1.9.m9.1.1.1.1.2.2.3" xref="S3.p1.9.m9.1.1.1.1.2.2.3.cmml">ℙ</mi></msubsup><mo id="S3.p1.9.m9.1.1.1.1.1" xref="S3.p1.9.m9.1.1.1.1.1.cmml">=</mo><mrow id="S3.p1.9.m9.1.1.1.1.3" xref="S3.p1.9.m9.1.1.1.1.3.cmml"><msubsup id="S3.p1.9.m9.1.1.1.1.3.2" xref="S3.p1.9.m9.1.1.1.1.3.2.cmml"><mi id="S3.p1.9.m9.1.1.1.1.3.2.2.2" xref="S3.p1.9.m9.1.1.1.1.3.2.2.2.cmml">λ</mi><mi id="S3.p1.9.m9.1.1.1.1.3.2.2.3" xref="S3.p1.9.m9.1.1.1.1.3.2.2.3.cmml">𝒙</mi><mn id="S3.p1.9.m9.1.1.1.1.3.2.3" xref="S3.p1.9.m9.1.1.1.1.3.2.3.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S3.p1.9.m9.1.1.1.1.3.1" xref="S3.p1.9.m9.1.1.1.1.3.1.cmml">​</mo><msup id="S3.p1.9.m9.1.1.1.1.3.3" xref="S3.p1.9.m9.1.1.1.1.3.3.cmml"><mi id="S3.p1.9.m9.1.1.1.1.3.3.2" xref="S3.p1.9.m9.1.1.1.1.3.3.2.cmml">g</mi><mi id="S3.p1.9.m9.1.1.1.1.3.3.3" xref="S3.p1.9.m9.1.1.1.1.3.3.3.cmml">𝔼</mi></msup></mrow></mrow><mo id="S3.p1.9.m9.1.1.1.2" xref="S3.p1.9.m9.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.1.1.1.cmml" xref="S3.p1.9.m9.1.1.1"><eq id="S3.p1.9.m9.1.1.1.1.1.cmml" xref="S3.p1.9.m9.1.1.1.1.1"></eq><apply id="S3.p1.9.m9.1.1.1.1.2.cmml" xref="S3.p1.9.m9.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.1.1.2.1.cmml" xref="S3.p1.9.m9.1.1.1.1.2">subscript</csymbol><apply id="S3.p1.9.m9.1.1.1.1.2.2.cmml" xref="S3.p1.9.m9.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.1.1.2.2.1.cmml" xref="S3.p1.9.m9.1.1.1.1.2">superscript</csymbol><ci id="S3.p1.9.m9.1.1.1.1.2.2.2.cmml" xref="S3.p1.9.m9.1.1.1.1.2.2.2">𝑔</ci><ci id="S3.p1.9.m9.1.1.1.1.2.2.3.cmml" xref="S3.p1.9.m9.1.1.1.1.2.2.3">ℙ</ci></apply><ci id="S3.p1.9.m9.1.1.1.1.2.3.cmml" xref="S3.p1.9.m9.1.1.1.1.2.3">𝒙</ci></apply><apply id="S3.p1.9.m9.1.1.1.1.3.cmml" xref="S3.p1.9.m9.1.1.1.1.3"><times id="S3.p1.9.m9.1.1.1.1.3.1.cmml" xref="S3.p1.9.m9.1.1.1.1.3.1"></times><apply id="S3.p1.9.m9.1.1.1.1.3.2.cmml" xref="S3.p1.9.m9.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.1.1.3.2.1.cmml" xref="S3.p1.9.m9.1.1.1.1.3.2">superscript</csymbol><apply id="S3.p1.9.m9.1.1.1.1.3.2.2.cmml" xref="S3.p1.9.m9.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.1.1.3.2.2.1.cmml" xref="S3.p1.9.m9.1.1.1.1.3.2">subscript</csymbol><ci id="S3.p1.9.m9.1.1.1.1.3.2.2.2.cmml" xref="S3.p1.9.m9.1.1.1.1.3.2.2.2">𝜆</ci><ci id="S3.p1.9.m9.1.1.1.1.3.2.2.3.cmml" xref="S3.p1.9.m9.1.1.1.1.3.2.2.3">𝒙</ci></apply><cn type="integer" id="S3.p1.9.m9.1.1.1.1.3.2.3.cmml" xref="S3.p1.9.m9.1.1.1.1.3.2.3">2</cn></apply><apply id="S3.p1.9.m9.1.1.1.1.3.3.cmml" xref="S3.p1.9.m9.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.1.1.3.3.1.cmml" xref="S3.p1.9.m9.1.1.1.1.3.3">superscript</csymbol><ci id="S3.p1.9.m9.1.1.1.1.3.3.2.cmml" xref="S3.p1.9.m9.1.1.1.1.3.3.2">𝑔</ci><ci id="S3.p1.9.m9.1.1.1.1.3.3.3.cmml" xref="S3.p1.9.m9.1.1.1.1.3.3.3">𝔼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">g^{\mathbb{P}}_{\bm{x}}=\lambda_{\bm{x}}^{2}g^{\mathbb{E}},</annotation></semantics></math>
where <math id="S3.p1.10.m10.1" class="ltx_Math" alttext="\lambda_{\bm{x}}=\frac{2}{1-||\bm{x}||_{2}^{2}}" display="inline"><semantics id="S3.p1.10.m10.1a"><mrow id="S3.p1.10.m10.1.2" xref="S3.p1.10.m10.1.2.cmml"><msub id="S3.p1.10.m10.1.2.2" xref="S3.p1.10.m10.1.2.2.cmml"><mi id="S3.p1.10.m10.1.2.2.2" xref="S3.p1.10.m10.1.2.2.2.cmml">λ</mi><mi id="S3.p1.10.m10.1.2.2.3" xref="S3.p1.10.m10.1.2.2.3.cmml">𝒙</mi></msub><mo id="S3.p1.10.m10.1.2.1" xref="S3.p1.10.m10.1.2.1.cmml">=</mo><mfrac id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml"><mn id="S3.p1.10.m10.1.1.3" xref="S3.p1.10.m10.1.1.3.cmml">2</mn><mrow id="S3.p1.10.m10.1.1.1" xref="S3.p1.10.m10.1.1.1.cmml"><mn id="S3.p1.10.m10.1.1.1.3" xref="S3.p1.10.m10.1.1.1.3.cmml">1</mn><mo id="S3.p1.10.m10.1.1.1.2" xref="S3.p1.10.m10.1.1.1.2.cmml">−</mo><msubsup id="S3.p1.10.m10.1.1.1.4" xref="S3.p1.10.m10.1.1.1.4.cmml"><mrow id="S3.p1.10.m10.1.1.1.4.2.2.2" xref="S3.p1.10.m10.1.1.1.4.2.2.1.cmml"><mo maxsize="142%" minsize="142%" id="S3.p1.10.m10.1.1.1.4.2.2.2.1" xref="S3.p1.10.m10.1.1.1.4.2.2.1.1.cmml">‖</mo><mi id="S3.p1.10.m10.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.cmml">𝒙</mi><mo maxsize="142%" minsize="142%" id="S3.p1.10.m10.1.1.1.4.2.2.2.2" xref="S3.p1.10.m10.1.1.1.4.2.2.1.1.cmml">‖</mo></mrow><mn id="S3.p1.10.m10.1.1.1.4.2.3" xref="S3.p1.10.m10.1.1.1.4.2.3.cmml">2</mn><mn id="S3.p1.10.m10.1.1.1.4.3" xref="S3.p1.10.m10.1.1.1.4.3.cmml">2</mn></msubsup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><apply id="S3.p1.10.m10.1.2.cmml" xref="S3.p1.10.m10.1.2"><eq id="S3.p1.10.m10.1.2.1.cmml" xref="S3.p1.10.m10.1.2.1"></eq><apply id="S3.p1.10.m10.1.2.2.cmml" xref="S3.p1.10.m10.1.2.2"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.2.2.1.cmml" xref="S3.p1.10.m10.1.2.2">subscript</csymbol><ci id="S3.p1.10.m10.1.2.2.2.cmml" xref="S3.p1.10.m10.1.2.2.2">𝜆</ci><ci id="S3.p1.10.m10.1.2.2.3.cmml" xref="S3.p1.10.m10.1.2.2.3">𝒙</ci></apply><apply id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1"><divide id="S3.p1.10.m10.1.1.2.cmml" xref="S3.p1.10.m10.1.1"></divide><cn type="integer" id="S3.p1.10.m10.1.1.3.cmml" xref="S3.p1.10.m10.1.1.3">2</cn><apply id="S3.p1.10.m10.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1"><minus id="S3.p1.10.m10.1.1.1.2.cmml" xref="S3.p1.10.m10.1.1.1.2"></minus><cn type="integer" id="S3.p1.10.m10.1.1.1.3.cmml" xref="S3.p1.10.m10.1.1.1.3">1</cn><apply id="S3.p1.10.m10.1.1.1.4.cmml" xref="S3.p1.10.m10.1.1.1.4"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.4.1.cmml" xref="S3.p1.10.m10.1.1.1.4">superscript</csymbol><apply id="S3.p1.10.m10.1.1.1.4.2.cmml" xref="S3.p1.10.m10.1.1.1.4"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.4.2.1.cmml" xref="S3.p1.10.m10.1.1.1.4">subscript</csymbol><apply id="S3.p1.10.m10.1.1.1.4.2.2.1.cmml" xref="S3.p1.10.m10.1.1.1.4.2.2.2"><csymbol cd="latexml" id="S3.p1.10.m10.1.1.1.4.2.2.1.1.cmml" xref="S3.p1.10.m10.1.1.1.4.2.2.2.1">norm</csymbol><ci id="S3.p1.10.m10.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1.1">𝒙</ci></apply><cn type="integer" id="S3.p1.10.m10.1.1.1.4.2.3.cmml" xref="S3.p1.10.m10.1.1.1.4.2.3">2</cn></apply><cn type="integer" id="S3.p1.10.m10.1.1.1.4.3.cmml" xref="S3.p1.10.m10.1.1.1.4.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">\lambda_{\bm{x}}=\frac{2}{1-||\bm{x}||_{2}^{2}}</annotation></semantics></math> is the conformal factor.
Given two points in the Poincaré ball model, i.e., <math id="S3.p1.11.m11.2" class="ltx_Math" alttext="\bm{x}_{1},\bm{x}_{2}\in\mathbb{P}^{n}" display="inline"><semantics id="S3.p1.11.m11.2a"><mrow id="S3.p1.11.m11.2.2" xref="S3.p1.11.m11.2.2.cmml"><mrow id="S3.p1.11.m11.2.2.2.2" xref="S3.p1.11.m11.2.2.2.3.cmml"><msub id="S3.p1.11.m11.1.1.1.1.1" xref="S3.p1.11.m11.1.1.1.1.1.cmml"><mi id="S3.p1.11.m11.1.1.1.1.1.2" xref="S3.p1.11.m11.1.1.1.1.1.2.cmml">𝒙</mi><mn id="S3.p1.11.m11.1.1.1.1.1.3" xref="S3.p1.11.m11.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.11.m11.2.2.2.2.3" xref="S3.p1.11.m11.2.2.2.3.cmml">,</mo><msub id="S3.p1.11.m11.2.2.2.2.2" xref="S3.p1.11.m11.2.2.2.2.2.cmml"><mi id="S3.p1.11.m11.2.2.2.2.2.2" xref="S3.p1.11.m11.2.2.2.2.2.2.cmml">𝒙</mi><mn id="S3.p1.11.m11.2.2.2.2.2.3" xref="S3.p1.11.m11.2.2.2.2.2.3.cmml">2</mn></msub></mrow><mo id="S3.p1.11.m11.2.2.3" xref="S3.p1.11.m11.2.2.3.cmml">∈</mo><msup id="S3.p1.11.m11.2.2.4" xref="S3.p1.11.m11.2.2.4.cmml"><mi id="S3.p1.11.m11.2.2.4.2" xref="S3.p1.11.m11.2.2.4.2.cmml">ℙ</mi><mi id="S3.p1.11.m11.2.2.4.3" xref="S3.p1.11.m11.2.2.4.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.2b"><apply id="S3.p1.11.m11.2.2.cmml" xref="S3.p1.11.m11.2.2"><in id="S3.p1.11.m11.2.2.3.cmml" xref="S3.p1.11.m11.2.2.3"></in><list id="S3.p1.11.m11.2.2.2.3.cmml" xref="S3.p1.11.m11.2.2.2.2"><apply id="S3.p1.11.m11.1.1.1.1.1.cmml" xref="S3.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.11.m11.1.1.1.1.1.1.cmml" xref="S3.p1.11.m11.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.11.m11.1.1.1.1.1.2.cmml" xref="S3.p1.11.m11.1.1.1.1.1.2">𝒙</ci><cn type="integer" id="S3.p1.11.m11.1.1.1.1.1.3.cmml" xref="S3.p1.11.m11.1.1.1.1.1.3">1</cn></apply><apply id="S3.p1.11.m11.2.2.2.2.2.cmml" xref="S3.p1.11.m11.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.11.m11.2.2.2.2.2.1.cmml" xref="S3.p1.11.m11.2.2.2.2.2">subscript</csymbol><ci id="S3.p1.11.m11.2.2.2.2.2.2.cmml" xref="S3.p1.11.m11.2.2.2.2.2.2">𝒙</ci><cn type="integer" id="S3.p1.11.m11.2.2.2.2.2.3.cmml" xref="S3.p1.11.m11.2.2.2.2.2.3">2</cn></apply></list><apply id="S3.p1.11.m11.2.2.4.cmml" xref="S3.p1.11.m11.2.2.4"><csymbol cd="ambiguous" id="S3.p1.11.m11.2.2.4.1.cmml" xref="S3.p1.11.m11.2.2.4">superscript</csymbol><ci id="S3.p1.11.m11.2.2.4.2.cmml" xref="S3.p1.11.m11.2.2.4.2">ℙ</ci><ci id="S3.p1.11.m11.2.2.4.3.cmml" xref="S3.p1.11.m11.2.2.4.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.2c">\bm{x}_{1},\bm{x}_{2}\in\mathbb{P}^{n}</annotation></semantics></math>, the Möbious addition is defined as:</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.6" class="ltx_Math" alttext="\bm{x}_{1}\oplus\bm{x}_{2}=\frac{(1+2\langle\bm{x}_{1},\bm{x}_{2}\rangle+||\bm{x}_{2}||_{2}^{2})\bm{x}_{1}+(1-||\bm{x}_{1}||_{2})\bm{x}_{2}^{2}}{1+2\langle\bm{x}_{1},\bm{x}_{2}\rangle+||\bm{x}_{1}||_{2}^{2}||\bm{x}_{2}||_{2}^{2}}" display="block"><semantics id="S3.Ex1.m1.6a"><mrow id="S3.Ex1.m1.6.7" xref="S3.Ex1.m1.6.7.cmml"><mrow id="S3.Ex1.m1.6.7.2" xref="S3.Ex1.m1.6.7.2.cmml"><msub id="S3.Ex1.m1.6.7.2.2" xref="S3.Ex1.m1.6.7.2.2.cmml"><mi id="S3.Ex1.m1.6.7.2.2.2" xref="S3.Ex1.m1.6.7.2.2.2.cmml">𝒙</mi><mn id="S3.Ex1.m1.6.7.2.2.3" xref="S3.Ex1.m1.6.7.2.2.3.cmml">1</mn></msub><mo id="S3.Ex1.m1.6.7.2.1" xref="S3.Ex1.m1.6.7.2.1.cmml">⊕</mo><msub id="S3.Ex1.m1.6.7.2.3" xref="S3.Ex1.m1.6.7.2.3.cmml"><mi id="S3.Ex1.m1.6.7.2.3.2" xref="S3.Ex1.m1.6.7.2.3.2.cmml">𝒙</mi><mn id="S3.Ex1.m1.6.7.2.3.3" xref="S3.Ex1.m1.6.7.2.3.3.cmml">2</mn></msub></mrow><mo id="S3.Ex1.m1.6.7.1" xref="S3.Ex1.m1.6.7.1.cmml">=</mo><mfrac id="S3.Ex1.m1.6.6" xref="S3.Ex1.m1.6.6.cmml"><mrow id="S3.Ex1.m1.2.2.2" xref="S3.Ex1.m1.2.2.2.cmml"><mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.Ex1.m1.1.1.1.1.1.1.1.5" xref="S3.Ex1.m1.1.1.1.1.1.1.1.5.cmml">1</mn><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.4" xref="S3.Ex1.m1.1.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.cmml"><mn id="S3.Ex1.m1.1.1.1.1.1.1.1.2.4" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.4.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.3.cmml">⟨</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mn id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.4" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝒙</mi><mn id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.5" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.3.cmml">⟩</mo></mrow></mrow><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.4a" xref="S3.Ex1.m1.1.1.1.1.1.1.1.4.cmml">+</mo><msubsup id="S3.Ex1.m1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.2.1.cmml">‖</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1.2.cmml">𝒙</mi><mn id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.3.cmml">2</mn><mn id="S3.Ex1.m1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msubsup></mrow><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.2.cmml">​</mo><msub id="S3.Ex1.m1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.3.2.cmml">𝒙</mi><mn id="S3.Ex1.m1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.Ex1.m1.2.2.2.3" xref="S3.Ex1.m1.2.2.2.3.cmml">+</mo><mrow id="S3.Ex1.m1.2.2.2.2" xref="S3.Ex1.m1.2.2.2.2.cmml"><mrow id="S3.Ex1.m1.2.2.2.2.1.1" xref="S3.Ex1.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.2.2.2.2.1.1.2" xref="S3.Ex1.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.2.2.2.2.1.1.1" xref="S3.Ex1.m1.2.2.2.2.1.1.1.cmml"><mn id="S3.Ex1.m1.2.2.2.2.1.1.1.3" xref="S3.Ex1.m1.2.2.2.2.1.1.1.3.cmml">1</mn><mo id="S3.Ex1.m1.2.2.2.2.1.1.1.2" xref="S3.Ex1.m1.2.2.2.2.1.1.1.2.cmml">−</mo><msub id="S3.Ex1.m1.2.2.2.2.1.1.1.1" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.2" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mn id="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.Ex1.m1.2.2.2.2.1.1.1.1.3" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S3.Ex1.m1.2.2.2.2.1.1.3" xref="S3.Ex1.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.2.2.2.2.2" xref="S3.Ex1.m1.2.2.2.2.2.cmml">​</mo><msubsup id="S3.Ex1.m1.2.2.2.2.3" xref="S3.Ex1.m1.2.2.2.2.3.cmml"><mi id="S3.Ex1.m1.2.2.2.2.3.2.2" xref="S3.Ex1.m1.2.2.2.2.3.2.2.cmml">𝒙</mi><mn id="S3.Ex1.m1.2.2.2.2.3.2.3" xref="S3.Ex1.m1.2.2.2.2.3.2.3.cmml">2</mn><mn id="S3.Ex1.m1.2.2.2.2.3.3" xref="S3.Ex1.m1.2.2.2.2.3.3.cmml">2</mn></msubsup></mrow></mrow><mrow id="S3.Ex1.m1.6.6.6" xref="S3.Ex1.m1.6.6.6.cmml"><mn id="S3.Ex1.m1.6.6.6.6" xref="S3.Ex1.m1.6.6.6.6.cmml">1</mn><mo id="S3.Ex1.m1.6.6.6.5" xref="S3.Ex1.m1.6.6.6.5.cmml">+</mo><mrow id="S3.Ex1.m1.4.4.4.2" xref="S3.Ex1.m1.4.4.4.2.cmml"><mn id="S3.Ex1.m1.4.4.4.2.4" xref="S3.Ex1.m1.4.4.4.2.4.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.4.4.4.2.3" xref="S3.Ex1.m1.4.4.4.2.3.cmml">​</mo><mrow id="S3.Ex1.m1.4.4.4.2.2.2" xref="S3.Ex1.m1.4.4.4.2.2.3.cmml"><mo stretchy="false" id="S3.Ex1.m1.4.4.4.2.2.2.3" xref="S3.Ex1.m1.4.4.4.2.2.3.cmml">⟨</mo><msub id="S3.Ex1.m1.3.3.3.1.1.1.1" xref="S3.Ex1.m1.3.3.3.1.1.1.1.cmml"><mi id="S3.Ex1.m1.3.3.3.1.1.1.1.2" xref="S3.Ex1.m1.3.3.3.1.1.1.1.2.cmml">𝒙</mi><mn id="S3.Ex1.m1.3.3.3.1.1.1.1.3" xref="S3.Ex1.m1.3.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex1.m1.4.4.4.2.2.2.4" xref="S3.Ex1.m1.4.4.4.2.2.3.cmml">,</mo><msub id="S3.Ex1.m1.4.4.4.2.2.2.2" xref="S3.Ex1.m1.4.4.4.2.2.2.2.cmml"><mi id="S3.Ex1.m1.4.4.4.2.2.2.2.2" xref="S3.Ex1.m1.4.4.4.2.2.2.2.2.cmml">𝒙</mi><mn id="S3.Ex1.m1.4.4.4.2.2.2.2.3" xref="S3.Ex1.m1.4.4.4.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.Ex1.m1.4.4.4.2.2.2.5" xref="S3.Ex1.m1.4.4.4.2.2.3.cmml">⟩</mo></mrow></mrow><mo id="S3.Ex1.m1.6.6.6.5a" xref="S3.Ex1.m1.6.6.6.5.cmml">+</mo><mrow id="S3.Ex1.m1.6.6.6.4" xref="S3.Ex1.m1.6.6.6.4.cmml"><msubsup id="S3.Ex1.m1.5.5.5.3.1" xref="S3.Ex1.m1.5.5.5.3.1.cmml"><mrow id="S3.Ex1.m1.5.5.5.3.1.1.1.1" xref="S3.Ex1.m1.5.5.5.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.5.5.5.3.1.1.1.1.2" xref="S3.Ex1.m1.5.5.5.3.1.1.1.2.1.cmml">‖</mo><msub id="S3.Ex1.m1.5.5.5.3.1.1.1.1.1" xref="S3.Ex1.m1.5.5.5.3.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.5.5.5.3.1.1.1.1.1.2" xref="S3.Ex1.m1.5.5.5.3.1.1.1.1.1.2.cmml">𝒙</mi><mn id="S3.Ex1.m1.5.5.5.3.1.1.1.1.1.3" xref="S3.Ex1.m1.5.5.5.3.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S3.Ex1.m1.5.5.5.3.1.1.1.1.3" xref="S3.Ex1.m1.5.5.5.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.Ex1.m1.5.5.5.3.1.1.3" xref="S3.Ex1.m1.5.5.5.3.1.1.3.cmml">2</mn><mn id="S3.Ex1.m1.5.5.5.3.1.3" xref="S3.Ex1.m1.5.5.5.3.1.3.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.6.6.6.4.3" xref="S3.Ex1.m1.6.6.6.4.3.cmml">​</mo><msubsup id="S3.Ex1.m1.6.6.6.4.2" xref="S3.Ex1.m1.6.6.6.4.2.cmml"><mrow id="S3.Ex1.m1.6.6.6.4.2.1.1.1" xref="S3.Ex1.m1.6.6.6.4.2.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.6.6.6.4.2.1.1.1.2" xref="S3.Ex1.m1.6.6.6.4.2.1.1.2.1.cmml">‖</mo><msub id="S3.Ex1.m1.6.6.6.4.2.1.1.1.1" xref="S3.Ex1.m1.6.6.6.4.2.1.1.1.1.cmml"><mi id="S3.Ex1.m1.6.6.6.4.2.1.1.1.1.2" xref="S3.Ex1.m1.6.6.6.4.2.1.1.1.1.2.cmml">𝒙</mi><mn id="S3.Ex1.m1.6.6.6.4.2.1.1.1.1.3" xref="S3.Ex1.m1.6.6.6.4.2.1.1.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="S3.Ex1.m1.6.6.6.4.2.1.1.1.3" xref="S3.Ex1.m1.6.6.6.4.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.Ex1.m1.6.6.6.4.2.1.3" xref="S3.Ex1.m1.6.6.6.4.2.1.3.cmml">2</mn><mn id="S3.Ex1.m1.6.6.6.4.2.3" xref="S3.Ex1.m1.6.6.6.4.2.3.cmml">2</mn></msubsup></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.6b"><apply id="S3.Ex1.m1.6.7.cmml" xref="S3.Ex1.m1.6.7"><eq id="S3.Ex1.m1.6.7.1.cmml" xref="S3.Ex1.m1.6.7.1"></eq><apply id="S3.Ex1.m1.6.7.2.cmml" xref="S3.Ex1.m1.6.7.2"><csymbol cd="latexml" id="S3.Ex1.m1.6.7.2.1.cmml" xref="S3.Ex1.m1.6.7.2.1">direct-sum</csymbol><apply id="S3.Ex1.m1.6.7.2.2.cmml" xref="S3.Ex1.m1.6.7.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.7.2.2.1.cmml" xref="S3.Ex1.m1.6.7.2.2">subscript</csymbol><ci id="S3.Ex1.m1.6.7.2.2.2.cmml" xref="S3.Ex1.m1.6.7.2.2.2">𝒙</ci><cn type="integer" id="S3.Ex1.m1.6.7.2.2.3.cmml" xref="S3.Ex1.m1.6.7.2.2.3">1</cn></apply><apply id="S3.Ex1.m1.6.7.2.3.cmml" xref="S3.Ex1.m1.6.7.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.7.2.3.1.cmml" xref="S3.Ex1.m1.6.7.2.3">subscript</csymbol><ci id="S3.Ex1.m1.6.7.2.3.2.cmml" xref="S3.Ex1.m1.6.7.2.3.2">𝒙</ci><cn type="integer" id="S3.Ex1.m1.6.7.2.3.3.cmml" xref="S3.Ex1.m1.6.7.2.3.3">2</cn></apply></apply><apply id="S3.Ex1.m1.6.6.cmml" xref="S3.Ex1.m1.6.6"><divide id="S3.Ex1.m1.6.6.7.cmml" xref="S3.Ex1.m1.6.6"></divide><apply id="S3.Ex1.m1.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2"><plus id="S3.Ex1.m1.2.2.2.3.cmml" xref="S3.Ex1.m1.2.2.2.3"></plus><apply id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1"><times id="S3.Ex1.m1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2"></times><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1"><plus id="S3.Ex1.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.4"></plus><cn type="integer" id="S3.Ex1.m1.1.1.1.1.1.1.1.5.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.5">1</cn><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2"><times id="S3.Ex1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.3"></times><cn type="integer" id="S3.Ex1.m1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.4">2</cn><list id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2"><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><cn type="integer" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2.2">𝒙</ci><cn type="integer" id="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.2.2.2.2.3">2</cn></apply></list></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.2">norm</csymbol><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1.2">𝒙</ci><cn type="integer" id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.1.1.1.3">2</cn></apply></apply><cn type="integer" id="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.1.3">2</cn></apply><cn type="integer" id="S3.Ex1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2">𝒙</ci><cn type="integer" id="S3.Ex1.m1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.Ex1.m1.2.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2"><times id="S3.Ex1.m1.2.2.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2"></times><apply id="S3.Ex1.m1.2.2.2.2.1.1.1.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1"><minus id="S3.Ex1.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1.1.2"></minus><cn type="integer" id="S3.Ex1.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1.1.3">1</cn><apply id="S3.Ex1.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1">subscript</csymbol><apply id="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1.2">𝒙</ci><cn type="integer" id="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.1.1.1.3">1</cn></apply></apply><cn type="integer" id="S3.Ex1.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.2.2.1.1.1.1.3">2</cn></apply></apply><apply id="S3.Ex1.m1.2.2.2.2.3.cmml" xref="S3.Ex1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.2.2.3.1.cmml" xref="S3.Ex1.m1.2.2.2.2.3">superscript</csymbol><apply id="S3.Ex1.m1.2.2.2.2.3.2.cmml" xref="S3.Ex1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.2.2.3.2.1.cmml" xref="S3.Ex1.m1.2.2.2.2.3">subscript</csymbol><ci id="S3.Ex1.m1.2.2.2.2.3.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2.3.2.2">𝒙</ci><cn type="integer" id="S3.Ex1.m1.2.2.2.2.3.2.3.cmml" xref="S3.Ex1.m1.2.2.2.2.3.2.3">2</cn></apply><cn type="integer" id="S3.Ex1.m1.2.2.2.2.3.3.cmml" xref="S3.Ex1.m1.2.2.2.2.3.3">2</cn></apply></apply></apply><apply id="S3.Ex1.m1.6.6.6.cmml" xref="S3.Ex1.m1.6.6.6"><plus id="S3.Ex1.m1.6.6.6.5.cmml" xref="S3.Ex1.m1.6.6.6.5"></plus><cn type="integer" id="S3.Ex1.m1.6.6.6.6.cmml" xref="S3.Ex1.m1.6.6.6.6">1</cn><apply id="S3.Ex1.m1.4.4.4.2.cmml" xref="S3.Ex1.m1.4.4.4.2"><times id="S3.Ex1.m1.4.4.4.2.3.cmml" xref="S3.Ex1.m1.4.4.4.2.3"></times><cn type="integer" id="S3.Ex1.m1.4.4.4.2.4.cmml" xref="S3.Ex1.m1.4.4.4.2.4">2</cn><list id="S3.Ex1.m1.4.4.4.2.2.3.cmml" xref="S3.Ex1.m1.4.4.4.2.2.2"><apply id="S3.Ex1.m1.3.3.3.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.3.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.3.1.1.1.1.2">𝒙</ci><cn type="integer" id="S3.Ex1.m1.3.3.3.1.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.3.1.1.1.1.3">1</cn></apply><apply id="S3.Ex1.m1.4.4.4.2.2.2.2.cmml" xref="S3.Ex1.m1.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.4.2.2.2.2.1.cmml" xref="S3.Ex1.m1.4.4.4.2.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.4.4.4.2.2.2.2.2.cmml" xref="S3.Ex1.m1.4.4.4.2.2.2.2.2">𝒙</ci><cn type="integer" id="S3.Ex1.m1.4.4.4.2.2.2.2.3.cmml" xref="S3.Ex1.m1.4.4.4.2.2.2.2.3">2</cn></apply></list></apply><apply id="S3.Ex1.m1.6.6.6.4.cmml" xref="S3.Ex1.m1.6.6.6.4"><times id="S3.Ex1.m1.6.6.6.4.3.cmml" xref="S3.Ex1.m1.6.6.6.4.3"></times><apply id="S3.Ex1.m1.5.5.5.3.1.cmml" xref="S3.Ex1.m1.5.5.5.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.5.3.1.2.cmml" xref="S3.Ex1.m1.5.5.5.3.1">superscript</csymbol><apply id="S3.Ex1.m1.5.5.5.3.1.1.cmml" xref="S3.Ex1.m1.5.5.5.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.5.3.1.1.2.cmml" xref="S3.Ex1.m1.5.5.5.3.1">subscript</csymbol><apply id="S3.Ex1.m1.5.5.5.3.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.5.3.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.5.5.5.3.1.1.1.2.1.cmml" xref="S3.Ex1.m1.5.5.5.3.1.1.1.1.2">norm</csymbol><apply id="S3.Ex1.m1.5.5.5.3.1.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.5.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.5.3.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.5.3.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.5.5.5.3.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.5.3.1.1.1.1.1.2">𝒙</ci><cn type="integer" id="S3.Ex1.m1.5.5.5.3.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.5.5.5.3.1.1.1.1.1.3">1</cn></apply></apply><cn type="integer" id="S3.Ex1.m1.5.5.5.3.1.1.3.cmml" xref="S3.Ex1.m1.5.5.5.3.1.1.3">2</cn></apply><cn type="integer" id="S3.Ex1.m1.5.5.5.3.1.3.cmml" xref="S3.Ex1.m1.5.5.5.3.1.3">2</cn></apply><apply id="S3.Ex1.m1.6.6.6.4.2.cmml" xref="S3.Ex1.m1.6.6.6.4.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.6.4.2.2.cmml" xref="S3.Ex1.m1.6.6.6.4.2">superscript</csymbol><apply id="S3.Ex1.m1.6.6.6.4.2.1.cmml" xref="S3.Ex1.m1.6.6.6.4.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.6.4.2.1.2.cmml" xref="S3.Ex1.m1.6.6.6.4.2">subscript</csymbol><apply id="S3.Ex1.m1.6.6.6.4.2.1.1.2.cmml" xref="S3.Ex1.m1.6.6.6.4.2.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.6.6.6.4.2.1.1.2.1.cmml" xref="S3.Ex1.m1.6.6.6.4.2.1.1.1.2">norm</csymbol><apply id="S3.Ex1.m1.6.6.6.4.2.1.1.1.1.cmml" xref="S3.Ex1.m1.6.6.6.4.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.6.4.2.1.1.1.1.1.cmml" xref="S3.Ex1.m1.6.6.6.4.2.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.6.6.6.4.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.6.6.6.4.2.1.1.1.1.2">𝒙</ci><cn type="integer" id="S3.Ex1.m1.6.6.6.4.2.1.1.1.1.3.cmml" xref="S3.Ex1.m1.6.6.6.4.2.1.1.1.1.3">2</cn></apply></apply><cn type="integer" id="S3.Ex1.m1.6.6.6.4.2.1.3.cmml" xref="S3.Ex1.m1.6.6.6.4.2.1.3">2</cn></apply><cn type="integer" id="S3.Ex1.m1.6.6.6.4.2.3.cmml" xref="S3.Ex1.m1.6.6.6.4.2.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.6c">\bm{x}_{1}\oplus\bm{x}_{2}=\frac{(1+2\langle\bm{x}_{1},\bm{x}_{2}\rangle+||\bm{x}_{2}||_{2}^{2})\bm{x}_{1}+(1-||\bm{x}_{1}||_{2})\bm{x}_{2}^{2}}{1+2\langle\bm{x}_{1},\bm{x}_{2}\rangle+||\bm{x}_{1}||_{2}^{2}||\bm{x}_{2}||_{2}^{2}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.p1.22" class="ltx_p">We can define the geodesic, i.e., the shortest distance between these two points in the Poincaré ball as below:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.5" class="ltx_Math" alttext="d(\bm{x}_{1},\bm{x}_{2})=\operatorname{arcosh}(1+\frac{2||\bm{x}_{1}-\bm{x}_{2}||_{2}^{2}}{(1-||\bm{x}_{1}||_{2}^{2})(1-||\bm{x}_{2}||_{2}^{2})})." display="block"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml"><mi id="S3.E1.m1.5.5.1.1.2.4" xref="S3.E1.m1.5.5.1.1.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.2.3" xref="S3.E1.m1.5.5.1.1.2.3.cmml">​</mo><mrow id="S3.E1.m1.5.5.1.1.2.2.2" xref="S3.E1.m1.5.5.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.2.2.2.3" xref="S3.E1.m1.5.5.1.1.2.2.3.cmml">(</mo><msub id="S3.E1.m1.5.5.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2.cmml">𝒙</mi><mn id="S3.E1.m1.5.5.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E1.m1.5.5.1.1.2.2.2.4" xref="S3.E1.m1.5.5.1.1.2.2.3.cmml">,</mo><msub id="S3.E1.m1.5.5.1.1.2.2.2.2" xref="S3.E1.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.5.5.1.1.2.2.2.2.2" xref="S3.E1.m1.5.5.1.1.2.2.2.2.2.cmml">𝒙</mi><mn id="S3.E1.m1.5.5.1.1.2.2.2.2.3" xref="S3.E1.m1.5.5.1.1.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.E1.m1.5.5.1.1.2.2.2.5" xref="S3.E1.m1.5.5.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.5.5.1.1.4" xref="S3.E1.m1.5.5.1.1.4.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.3.1" xref="S3.E1.m1.5.5.1.1.3.2.cmml"><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">arcosh</mi><mo id="S3.E1.m1.5.5.1.1.3.1a" xref="S3.E1.m1.5.5.1.1.3.2.cmml">⁡</mo><mrow id="S3.E1.m1.5.5.1.1.3.1.1" xref="S3.E1.m1.5.5.1.1.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.3.1.1.2" xref="S3.E1.m1.5.5.1.1.3.2.cmml">(</mo><mrow id="S3.E1.m1.5.5.1.1.3.1.1.1" xref="S3.E1.m1.5.5.1.1.3.1.1.1.cmml"><mn id="S3.E1.m1.5.5.1.1.3.1.1.1.2" xref="S3.E1.m1.5.5.1.1.3.1.1.1.2.cmml">1</mn><mo id="S3.E1.m1.5.5.1.1.3.1.1.1.1" xref="S3.E1.m1.5.5.1.1.3.1.1.1.1.cmml">+</mo><mfrac id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mn id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">​</mo><msubsup id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝒙</mi><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml">2</mn></msubsup></mrow><mrow id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml"><mrow id="S3.E1.m1.2.2.2.1.1" xref="S3.E1.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.1.1.2" xref="S3.E1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.2.2.2.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.cmml"><mn id="S3.E1.m1.2.2.2.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.3.cmml">1</mn><mo id="S3.E1.m1.2.2.2.1.1.1.2" xref="S3.E1.m1.2.2.2.1.1.1.2.cmml">−</mo><msubsup id="S3.E1.m1.2.2.2.1.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.1.cmml"><mrow id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mn id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1.m1.2.2.2.1.1.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E1.m1.2.2.2.1.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.1.3.cmml">2</mn></msubsup></mrow><mo stretchy="false" id="S3.E1.m1.2.2.2.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.3.2.1" xref="S3.E1.m1.3.3.3.2.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.3.2.1.2" xref="S3.E1.m1.3.3.3.2.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.3.2.1.1" xref="S3.E1.m1.3.3.3.2.1.1.cmml"><mn id="S3.E1.m1.3.3.3.2.1.1.3" xref="S3.E1.m1.3.3.3.2.1.1.3.cmml">1</mn><mo id="S3.E1.m1.3.3.3.2.1.1.2" xref="S3.E1.m1.3.3.3.2.1.1.2.cmml">−</mo><msubsup id="S3.E1.m1.3.3.3.2.1.1.1" xref="S3.E1.m1.3.3.3.2.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.3.2.1.1.1.1.1.1" xref="S3.E1.m1.3.3.3.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.3.2.1.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mn id="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.3.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1.m1.3.3.3.2.1.1.1.1.3" xref="S3.E1.m1.3.3.3.2.1.1.1.1.3.cmml">2</mn><mn id="S3.E1.m1.3.3.3.2.1.1.1.3" xref="S3.E1.m1.3.3.3.2.1.1.1.3.cmml">2</mn></msubsup></mrow><mo stretchy="false" id="S3.E1.m1.3.3.3.2.1.3" xref="S3.E1.m1.3.3.3.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo stretchy="false" id="S3.E1.m1.5.5.1.1.3.1.1.3" xref="S3.E1.m1.5.5.1.1.3.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E1.m1.5.5.1.2" xref="S3.E1.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1"><eq id="S3.E1.m1.5.5.1.1.4.cmml" xref="S3.E1.m1.5.5.1.1.4"></eq><apply id="S3.E1.m1.5.5.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2"><times id="S3.E1.m1.5.5.1.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.3"></times><ci id="S3.E1.m1.5.5.1.1.2.4.cmml" xref="S3.E1.m1.5.5.1.1.2.4">𝑑</ci><interval closure="open" id="S3.E1.m1.5.5.1.1.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2"><apply id="S3.E1.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.2">𝒙</ci><cn type="integer" id="S3.E1.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E1.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2.2.2">𝒙</ci><cn type="integer" id="S3.E1.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2.2.3">2</cn></apply></interval></apply><apply id="S3.E1.m1.5.5.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.3.1"><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">arcosh</ci><apply id="S3.E1.m1.5.5.1.1.3.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.3.1.1.1"><plus id="S3.E1.m1.5.5.1.1.3.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.3.1.1.1.1"></plus><cn type="integer" id="S3.E1.m1.5.5.1.1.3.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.3.1.1.1.2">1</cn><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><divide id="S3.E1.m1.3.3.4.cmml" xref="S3.E1.m1.3.3"></divide><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><times id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></times><cn type="integer" id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3">2</cn><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2">𝒙</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2">𝒙</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply><cn type="integer" id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">2</cn></apply><cn type="integer" id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3">2</cn></apply></apply><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"><times id="S3.E1.m1.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3"></times><apply id="S3.E1.m1.2.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1"><minus id="S3.E1.m1.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.2"></minus><cn type="integer" id="S3.E1.m1.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.3">1</cn><apply id="S3.E1.m1.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.2">𝒙</ci><cn type="integer" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><cn type="integer" id="S3.E1.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.3">2</cn></apply><cn type="integer" id="S3.E1.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.3">2</cn></apply></apply><apply id="S3.E1.m1.3.3.3.2.1.1.cmml" xref="S3.E1.m1.3.3.3.2.1"><minus id="S3.E1.m1.3.3.3.2.1.1.2.cmml" xref="S3.E1.m1.3.3.3.2.1.1.2"></minus><cn type="integer" id="S3.E1.m1.3.3.3.2.1.1.3.cmml" xref="S3.E1.m1.3.3.3.2.1.1.3">1</cn><apply id="S3.E1.m1.3.3.3.2.1.1.1.cmml" xref="S3.E1.m1.3.3.3.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.2.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.2.1.1.1">superscript</csymbol><apply id="S3.E1.m1.3.3.3.2.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.2.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.2.1.1.1">subscript</csymbol><apply id="S3.E1.m1.3.3.3.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.3.2.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1.2">𝒙</ci><cn type="integer" id="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.2.1.1.1.1.1.1.1.3">2</cn></apply></apply><cn type="integer" id="S3.E1.m1.3.3.3.2.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.2.1.1.1.1.3">2</cn></apply><cn type="integer" id="S3.E1.m1.3.3.3.2.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.2.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">d(\bm{x}_{1},\bm{x}_{2})=\operatorname{arcosh}(1+\frac{2||\bm{x}_{1}-\bm{x}_{2}||_{2}^{2}}{(1-||\bm{x}_{1}||_{2}^{2})(1-||\bm{x}_{2}||_{2}^{2})}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.19" class="ltx_p">For a point <math id="S3.p1.12.m1.1" class="ltx_Math" alttext="\bm{x}" display="inline"><semantics id="S3.p1.12.m1.1a"><mi id="S3.p1.12.m1.1.1" xref="S3.p1.12.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.p1.12.m1.1b"><ci id="S3.p1.12.m1.1.1.cmml" xref="S3.p1.12.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m1.1c">\bm{x}</annotation></semantics></math> in a manifold <math id="S3.p1.13.m2.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.p1.13.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.13.m2.1.1" xref="S3.p1.13.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.13.m2.1b"><ci id="S3.p1.13.m2.1.1.cmml" xref="S3.p1.13.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m2.1c">\mathcal{M}</annotation></semantics></math>, the tangent space <math id="S3.p1.14.m3.1" class="ltx_Math" alttext="T_{\bm{x}}\mathcal{M}" display="inline"><semantics id="S3.p1.14.m3.1a"><mrow id="S3.p1.14.m3.1.1" xref="S3.p1.14.m3.1.1.cmml"><msub id="S3.p1.14.m3.1.1.2" xref="S3.p1.14.m3.1.1.2.cmml"><mi id="S3.p1.14.m3.1.1.2.2" xref="S3.p1.14.m3.1.1.2.2.cmml">T</mi><mi id="S3.p1.14.m3.1.1.2.3" xref="S3.p1.14.m3.1.1.2.3.cmml">𝒙</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.14.m3.1.1.1" xref="S3.p1.14.m3.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.14.m3.1.1.3" xref="S3.p1.14.m3.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.14.m3.1b"><apply id="S3.p1.14.m3.1.1.cmml" xref="S3.p1.14.m3.1.1"><times id="S3.p1.14.m3.1.1.1.cmml" xref="S3.p1.14.m3.1.1.1"></times><apply id="S3.p1.14.m3.1.1.2.cmml" xref="S3.p1.14.m3.1.1.2"><csymbol cd="ambiguous" id="S3.p1.14.m3.1.1.2.1.cmml" xref="S3.p1.14.m3.1.1.2">subscript</csymbol><ci id="S3.p1.14.m3.1.1.2.2.cmml" xref="S3.p1.14.m3.1.1.2.2">𝑇</ci><ci id="S3.p1.14.m3.1.1.2.3.cmml" xref="S3.p1.14.m3.1.1.2.3">𝒙</ci></apply><ci id="S3.p1.14.m3.1.1.3.cmml" xref="S3.p1.14.m3.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m3.1c">T_{\bm{x}}\mathcal{M}</annotation></semantics></math> is a vector space comprising all directions that are tangent to <math id="S3.p1.15.m4.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.p1.15.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.15.m4.1.1" xref="S3.p1.15.m4.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.15.m4.1b"><ci id="S3.p1.15.m4.1.1.cmml" xref="S3.p1.15.m4.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m4.1c">\mathcal{M}</annotation></semantics></math> at <math id="S3.p1.16.m5.1" class="ltx_Math" alttext="\bm{x}" display="inline"><semantics id="S3.p1.16.m5.1a"><mi id="S3.p1.16.m5.1.1" xref="S3.p1.16.m5.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.p1.16.m5.1b"><ci id="S3.p1.16.m5.1.1.cmml" xref="S3.p1.16.m5.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.m5.1c">\bm{x}</annotation></semantics></math>.
Exponential map <math id="S3.p1.17.m6.1" class="ltx_Math" alttext="\exp_{\bm{x}}:T_{\bm{x}}\mathcal{M}\rightarrow\mathcal{M}" display="inline"><semantics id="S3.p1.17.m6.1a"><mrow id="S3.p1.17.m6.1.1" xref="S3.p1.17.m6.1.1.cmml"><msub id="S3.p1.17.m6.1.1.2" xref="S3.p1.17.m6.1.1.2.cmml"><mi id="S3.p1.17.m6.1.1.2.2" xref="S3.p1.17.m6.1.1.2.2.cmml">exp</mi><mi id="S3.p1.17.m6.1.1.2.3" xref="S3.p1.17.m6.1.1.2.3.cmml">𝒙</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.p1.17.m6.1.1.1" xref="S3.p1.17.m6.1.1.1.cmml">:</mo><mrow id="S3.p1.17.m6.1.1.3" xref="S3.p1.17.m6.1.1.3.cmml"><mrow id="S3.p1.17.m6.1.1.3.2" xref="S3.p1.17.m6.1.1.3.2.cmml"><msub id="S3.p1.17.m6.1.1.3.2.2" xref="S3.p1.17.m6.1.1.3.2.2.cmml"><mi id="S3.p1.17.m6.1.1.3.2.2.2" xref="S3.p1.17.m6.1.1.3.2.2.2.cmml">T</mi><mi id="S3.p1.17.m6.1.1.3.2.2.3" xref="S3.p1.17.m6.1.1.3.2.2.3.cmml">𝒙</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.17.m6.1.1.3.2.1" xref="S3.p1.17.m6.1.1.3.2.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.17.m6.1.1.3.2.3" xref="S3.p1.17.m6.1.1.3.2.3.cmml">ℳ</mi></mrow><mo stretchy="false" id="S3.p1.17.m6.1.1.3.1" xref="S3.p1.17.m6.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.17.m6.1.1.3.3" xref="S3.p1.17.m6.1.1.3.3.cmml">ℳ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.17.m6.1b"><apply id="S3.p1.17.m6.1.1.cmml" xref="S3.p1.17.m6.1.1"><ci id="S3.p1.17.m6.1.1.1.cmml" xref="S3.p1.17.m6.1.1.1">:</ci><apply id="S3.p1.17.m6.1.1.2.cmml" xref="S3.p1.17.m6.1.1.2"><csymbol cd="ambiguous" id="S3.p1.17.m6.1.1.2.1.cmml" xref="S3.p1.17.m6.1.1.2">subscript</csymbol><exp id="S3.p1.17.m6.1.1.2.2.cmml" xref="S3.p1.17.m6.1.1.2.2"></exp><ci id="S3.p1.17.m6.1.1.2.3.cmml" xref="S3.p1.17.m6.1.1.2.3">𝒙</ci></apply><apply id="S3.p1.17.m6.1.1.3.cmml" xref="S3.p1.17.m6.1.1.3"><ci id="S3.p1.17.m6.1.1.3.1.cmml" xref="S3.p1.17.m6.1.1.3.1">→</ci><apply id="S3.p1.17.m6.1.1.3.2.cmml" xref="S3.p1.17.m6.1.1.3.2"><times id="S3.p1.17.m6.1.1.3.2.1.cmml" xref="S3.p1.17.m6.1.1.3.2.1"></times><apply id="S3.p1.17.m6.1.1.3.2.2.cmml" xref="S3.p1.17.m6.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.p1.17.m6.1.1.3.2.2.1.cmml" xref="S3.p1.17.m6.1.1.3.2.2">subscript</csymbol><ci id="S3.p1.17.m6.1.1.3.2.2.2.cmml" xref="S3.p1.17.m6.1.1.3.2.2.2">𝑇</ci><ci id="S3.p1.17.m6.1.1.3.2.2.3.cmml" xref="S3.p1.17.m6.1.1.3.2.2.3">𝒙</ci></apply><ci id="S3.p1.17.m6.1.1.3.2.3.cmml" xref="S3.p1.17.m6.1.1.3.2.3">ℳ</ci></apply><ci id="S3.p1.17.m6.1.1.3.3.cmml" xref="S3.p1.17.m6.1.1.3.3">ℳ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.17.m6.1c">\exp_{\bm{x}}:T_{\bm{x}}\mathcal{M}\rightarrow\mathcal{M}</annotation></semantics></math> is a transformation that
projects any point <math id="S3.p1.18.m7.1" class="ltx_Math" alttext="\bm{u}" display="inline"><semantics id="S3.p1.18.m7.1a"><mi id="S3.p1.18.m7.1.1" xref="S3.p1.18.m7.1.1.cmml">𝒖</mi><annotation-xml encoding="MathML-Content" id="S3.p1.18.m7.1b"><ci id="S3.p1.18.m7.1.1.cmml" xref="S3.p1.18.m7.1.1">𝒖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m7.1c">\bm{u}</annotation></semantics></math> from the Euclidean tangent space to the Poincaré ball referred by point <math id="S3.p1.19.m8.1" class="ltx_Math" alttext="\bm{x}" display="inline"><semantics id="S3.p1.19.m8.1a"><mi id="S3.p1.19.m8.1.1" xref="S3.p1.19.m8.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.p1.19.m8.1b"><ci id="S3.p1.19.m8.1.1.cmml" xref="S3.p1.19.m8.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.19.m8.1c">\bm{x}</annotation></semantics></math>, defined as:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.5" class="ltx_Math" alttext="\exp_{\bm{x}}(\bm{u})=\bm{x}\oplus\left(\tanh\left(\frac{\lambda_{\bm{x}}\|\bm{u}\|_{2}}{2}\right)\frac{\bm{u}}{\|\bm{u}\|_{2}}\right)." display="block"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.2.cmml"><msub id="S3.E2.m1.5.5.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.2.cmml">exp</mi><mi id="S3.E2.m1.5.5.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.3.cmml">𝒙</mi></msub><mo id="S3.E2.m1.5.5.1.1.1.1a" xref="S3.E2.m1.5.5.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.2.1" xref="S3.E2.m1.5.5.1.1.1.2.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">𝒖</mi><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.2.2" xref="S3.E2.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.3" xref="S3.E2.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.2.cmml"><mi id="S3.E2.m1.5.5.1.1.2.3" xref="S3.E2.m1.5.5.1.1.2.3.cmml">𝒙</mi><mo id="S3.E2.m1.5.5.1.1.2.2" xref="S3.E2.m1.5.5.1.1.2.2.cmml">⊕</mo><mrow id="S3.E2.m1.5.5.1.1.2.1.1" xref="S3.E2.m1.5.5.1.1.2.1.1.1.cmml"><mo id="S3.E2.m1.5.5.1.1.2.1.1.2" xref="S3.E2.m1.5.5.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.5.5.1.1.2.1.1.1" xref="S3.E2.m1.5.5.1.1.2.1.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1.2.1.1.1.2.2" xref="S3.E2.m1.5.5.1.1.2.1.1.1.2.1.cmml"><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">tanh</mi><mo id="S3.E2.m1.5.5.1.1.2.1.1.1.2.2a" xref="S3.E2.m1.5.5.1.1.2.1.1.1.2.1.cmml">⁡</mo><mrow id="S3.E2.m1.5.5.1.1.2.1.1.1.2.2.1" xref="S3.E2.m1.5.5.1.1.2.1.1.1.2.1.cmml"><mo id="S3.E2.m1.5.5.1.1.2.1.1.1.2.2.1.1" xref="S3.E2.m1.5.5.1.1.2.1.1.1.2.1.cmml">(</mo><mfrac id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.3.2.cmml">λ</mi><mi id="S3.E2.m1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.3.3.cmml">𝒙</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">​</mo><msub id="S3.E2.m1.1.1.1.4" xref="S3.E2.m1.1.1.1.4.cmml"><mrow id="S3.E2.m1.1.1.1.4.2.2" xref="S3.E2.m1.1.1.1.4.2.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.4.2.2.1" xref="S3.E2.m1.1.1.1.4.2.1.1.cmml">‖</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">𝒖</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.4.2.2.2" xref="S3.E2.m1.1.1.1.4.2.1.1.cmml">‖</mo></mrow><mn id="S3.E2.m1.1.1.1.4.3" xref="S3.E2.m1.1.1.1.4.3.cmml">2</mn></msub></mrow><mn id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">2</mn></mfrac><mo id="S3.E2.m1.5.5.1.1.2.1.1.1.2.2.1.2" xref="S3.E2.m1.5.5.1.1.2.1.1.1.2.1.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.2.1.1.1.1" xref="S3.E2.m1.5.5.1.1.2.1.1.1.1.cmml">​</mo><mfrac id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mi id="S3.E2.m1.2.2.3" xref="S3.E2.m1.2.2.3.cmml">𝒖</mi><msub id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.cmml"><mrow id="S3.E2.m1.2.2.1.3.2" xref="S3.E2.m1.2.2.1.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.3.2.1" xref="S3.E2.m1.2.2.1.3.1.1.cmml">‖</mo><mi id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml">𝒖</mi><mo stretchy="false" id="S3.E2.m1.2.2.1.3.2.2" xref="S3.E2.m1.2.2.1.3.1.1.cmml">‖</mo></mrow><mn id="S3.E2.m1.2.2.1.4" xref="S3.E2.m1.2.2.1.4.cmml">2</mn></msub></mfrac></mrow><mo id="S3.E2.m1.5.5.1.1.2.1.1.3" xref="S3.E2.m1.5.5.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.5.5.1.2" xref="S3.E2.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1"><eq id="S3.E2.m1.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3"></eq><apply id="S3.E2.m1.5.5.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1"><apply id="S3.E2.m1.5.5.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1">subscript</csymbol><exp id="S3.E2.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.2"></exp><ci id="S3.E2.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.3">𝒙</ci></apply><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝒖</ci></apply><apply id="S3.E2.m1.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2"><csymbol cd="latexml" id="S3.E2.m1.5.5.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2">direct-sum</csymbol><ci id="S3.E2.m1.5.5.1.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.3">𝒙</ci><apply id="S3.E2.m1.5.5.1.1.2.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.2.1.1"><times id="S3.E2.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.2.1.1.1.1"></times><apply id="S3.E2.m1.5.5.1.1.2.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2.1.1.1.2.2"><tanh id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"></tanh><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><divide id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1"></divide><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><times id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.3.2">𝜆</ci><ci id="S3.E2.m1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.3.3">𝒙</ci></apply><apply id="S3.E2.m1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.4">subscript</csymbol><apply id="S3.E2.m1.1.1.1.4.2.1.cmml" xref="S3.E2.m1.1.1.1.4.2.2"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.4.2.1.1.cmml" xref="S3.E2.m1.1.1.1.4.2.2.1">norm</csymbol><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝒖</ci></apply><cn type="integer" id="S3.E2.m1.1.1.1.4.3.cmml" xref="S3.E2.m1.1.1.1.4.3">2</cn></apply></apply><cn type="integer" id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3">2</cn></apply></apply><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><divide id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2"></divide><ci id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.3">𝒖</ci><apply id="S3.E2.m1.2.2.1.cmml" xref="S3.E2.m1.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.2.cmml" xref="S3.E2.m1.2.2.1">subscript</csymbol><apply id="S3.E2.m1.2.2.1.3.1.cmml" xref="S3.E2.m1.2.2.1.3.2"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.3.1.1.cmml" xref="S3.E2.m1.2.2.1.3.2.1">norm</csymbol><ci id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1">𝒖</ci></apply><cn type="integer" id="S3.E2.m1.2.2.1.4.cmml" xref="S3.E2.m1.2.2.1.4">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\exp_{\bm{x}}(\bm{u})=\bm{x}\oplus\left(\tanh\left(\frac{\lambda_{\bm{x}}\|\bm{u}\|_{2}}{2}\right)\frac{\bm{u}}{\|\bm{u}\|_{2}}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.21" class="ltx_p">The reverse of <math id="S3.p1.20.m1.1" class="ltx_Math" alttext="\exp_{\bm{x}}" display="inline"><semantics id="S3.p1.20.m1.1a"><msub id="S3.p1.20.m1.1.1" xref="S3.p1.20.m1.1.1.cmml"><mi id="S3.p1.20.m1.1.1.2" xref="S3.p1.20.m1.1.1.2.cmml">exp</mi><mi id="S3.p1.20.m1.1.1.3" xref="S3.p1.20.m1.1.1.3.cmml">𝒙</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.20.m1.1b"><apply id="S3.p1.20.m1.1.1.cmml" xref="S3.p1.20.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.20.m1.1.1.1.cmml" xref="S3.p1.20.m1.1.1">subscript</csymbol><exp id="S3.p1.20.m1.1.1.2.cmml" xref="S3.p1.20.m1.1.1.2"></exp><ci id="S3.p1.20.m1.1.1.3.cmml" xref="S3.p1.20.m1.1.1.3">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.20.m1.1c">\exp_{\bm{x}}</annotation></semantics></math> is logarithmic map, i.e., <math id="S3.p1.21.m2.1" class="ltx_Math" alttext="\log_{\bm{x}}:\mathcal{M}\rightarrow T_{\mathbf{x}}\mathcal{M}" display="inline"><semantics id="S3.p1.21.m2.1a"><mrow id="S3.p1.21.m2.1.1" xref="S3.p1.21.m2.1.1.cmml"><msub id="S3.p1.21.m2.1.1.2" xref="S3.p1.21.m2.1.1.2.cmml"><mi id="S3.p1.21.m2.1.1.2.2" xref="S3.p1.21.m2.1.1.2.2.cmml">log</mi><mi id="S3.p1.21.m2.1.1.2.3" xref="S3.p1.21.m2.1.1.2.3.cmml">𝒙</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.p1.21.m2.1.1.1" xref="S3.p1.21.m2.1.1.1.cmml">:</mo><mrow id="S3.p1.21.m2.1.1.3" xref="S3.p1.21.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.21.m2.1.1.3.2" xref="S3.p1.21.m2.1.1.3.2.cmml">ℳ</mi><mo stretchy="false" id="S3.p1.21.m2.1.1.3.1" xref="S3.p1.21.m2.1.1.3.1.cmml">→</mo><mrow id="S3.p1.21.m2.1.1.3.3" xref="S3.p1.21.m2.1.1.3.3.cmml"><msub id="S3.p1.21.m2.1.1.3.3.2" xref="S3.p1.21.m2.1.1.3.3.2.cmml"><mi id="S3.p1.21.m2.1.1.3.3.2.2" xref="S3.p1.21.m2.1.1.3.3.2.2.cmml">T</mi><mi id="S3.p1.21.m2.1.1.3.3.2.3" xref="S3.p1.21.m2.1.1.3.3.2.3.cmml">𝐱</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.21.m2.1.1.3.3.1" xref="S3.p1.21.m2.1.1.3.3.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.21.m2.1.1.3.3.3" xref="S3.p1.21.m2.1.1.3.3.3.cmml">ℳ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.21.m2.1b"><apply id="S3.p1.21.m2.1.1.cmml" xref="S3.p1.21.m2.1.1"><ci id="S3.p1.21.m2.1.1.1.cmml" xref="S3.p1.21.m2.1.1.1">:</ci><apply id="S3.p1.21.m2.1.1.2.cmml" xref="S3.p1.21.m2.1.1.2"><csymbol cd="ambiguous" id="S3.p1.21.m2.1.1.2.1.cmml" xref="S3.p1.21.m2.1.1.2">subscript</csymbol><log id="S3.p1.21.m2.1.1.2.2.cmml" xref="S3.p1.21.m2.1.1.2.2"></log><ci id="S3.p1.21.m2.1.1.2.3.cmml" xref="S3.p1.21.m2.1.1.2.3">𝒙</ci></apply><apply id="S3.p1.21.m2.1.1.3.cmml" xref="S3.p1.21.m2.1.1.3"><ci id="S3.p1.21.m2.1.1.3.1.cmml" xref="S3.p1.21.m2.1.1.3.1">→</ci><ci id="S3.p1.21.m2.1.1.3.2.cmml" xref="S3.p1.21.m2.1.1.3.2">ℳ</ci><apply id="S3.p1.21.m2.1.1.3.3.cmml" xref="S3.p1.21.m2.1.1.3.3"><times id="S3.p1.21.m2.1.1.3.3.1.cmml" xref="S3.p1.21.m2.1.1.3.3.1"></times><apply id="S3.p1.21.m2.1.1.3.3.2.cmml" xref="S3.p1.21.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.p1.21.m2.1.1.3.3.2.1.cmml" xref="S3.p1.21.m2.1.1.3.3.2">subscript</csymbol><ci id="S3.p1.21.m2.1.1.3.3.2.2.cmml" xref="S3.p1.21.m2.1.1.3.3.2.2">𝑇</ci><ci id="S3.p1.21.m2.1.1.3.3.2.3.cmml" xref="S3.p1.21.m2.1.1.3.3.2.3">𝐱</ci></apply><ci id="S3.p1.21.m2.1.1.3.3.3.cmml" xref="S3.p1.21.m2.1.1.3.3.3">ℳ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.21.m2.1c">\log_{\bm{x}}:\mathcal{M}\rightarrow T_{\mathbf{x}}\mathcal{M}</annotation></semantics></math>, which projects hyperbolic vector back to Euclidean space.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Problem Statement</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.11" class="ltx_p">In FL with non-IID setting, we assume there are <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">K</annotation></semantics></math> clients, containing their own models and local datasets, and a central server with global model aggregated from clients.
Suppose a dataset <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mathcal{D}</annotation></semantics></math> has <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">C</annotation></semantics></math> classes indexed by <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="[C]" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.2.2" xref="S4.SS1.p1.4.m4.1.2.1.cmml"><mo stretchy="false" id="S4.SS1.p1.4.m4.1.2.2.1" xref="S4.SS1.p1.4.m4.1.2.1.1.cmml">[</mo><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">C</mi><mo stretchy="false" id="S4.SS1.p1.4.m4.1.2.2.2" xref="S4.SS1.p1.4.m4.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.2.2"><csymbol cd="latexml" id="S4.SS1.p1.4.m4.1.2.1.1.cmml" xref="S4.SS1.p1.4.m4.1.2.2.1">delimited-[]</csymbol><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">[C]</annotation></semantics></math>, where <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="[C]" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.2.2" xref="S4.SS1.p1.5.m5.1.2.1.cmml"><mo stretchy="false" id="S4.SS1.p1.5.m5.1.2.2.1" xref="S4.SS1.p1.5.m5.1.2.1.1.cmml">[</mo><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">C</mi><mo stretchy="false" id="S4.SS1.p1.5.m5.1.2.2.2" xref="S4.SS1.p1.5.m5.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.2.2"><csymbol cd="latexml" id="S4.SS1.p1.5.m5.1.2.1.1.cmml" xref="S4.SS1.p1.5.m5.1.2.2.1">delimited-[]</csymbol><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">[C]</annotation></semantics></math> means the full set of labels in <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">\mathcal{D}</annotation></semantics></math>.
Each client <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mi id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><ci id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">k</annotation></semantics></math> has access to its private local dataset <math id="S4.SS1.p1.8.m8.6" class="ltx_Math" alttext="\mathcal{D}_{k}=\{\bm{x}_{k,i},y_{k,i}\}_{i=1}^{N_{k}}" display="inline"><semantics id="S4.SS1.p1.8.m8.6a"><mrow id="S4.SS1.p1.8.m8.6.6" xref="S4.SS1.p1.8.m8.6.6.cmml"><msub id="S4.SS1.p1.8.m8.6.6.4" xref="S4.SS1.p1.8.m8.6.6.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.8.m8.6.6.4.2" xref="S4.SS1.p1.8.m8.6.6.4.2.cmml">𝒟</mi><mi id="S4.SS1.p1.8.m8.6.6.4.3" xref="S4.SS1.p1.8.m8.6.6.4.3.cmml">k</mi></msub><mo id="S4.SS1.p1.8.m8.6.6.3" xref="S4.SS1.p1.8.m8.6.6.3.cmml">=</mo><msubsup id="S4.SS1.p1.8.m8.6.6.2" xref="S4.SS1.p1.8.m8.6.6.2.cmml"><mrow id="S4.SS1.p1.8.m8.6.6.2.2.2.2" xref="S4.SS1.p1.8.m8.6.6.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p1.8.m8.6.6.2.2.2.2.3" xref="S4.SS1.p1.8.m8.6.6.2.2.2.3.cmml">{</mo><msub id="S4.SS1.p1.8.m8.5.5.1.1.1.1.1" xref="S4.SS1.p1.8.m8.5.5.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.8.m8.5.5.1.1.1.1.1.2" xref="S4.SS1.p1.8.m8.5.5.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="S4.SS1.p1.8.m8.2.2.2.4" xref="S4.SS1.p1.8.m8.2.2.2.3.cmml"><mi id="S4.SS1.p1.8.m8.1.1.1.1" xref="S4.SS1.p1.8.m8.1.1.1.1.cmml">k</mi><mo id="S4.SS1.p1.8.m8.2.2.2.4.1" xref="S4.SS1.p1.8.m8.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p1.8.m8.2.2.2.2" xref="S4.SS1.p1.8.m8.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S4.SS1.p1.8.m8.6.6.2.2.2.2.4" xref="S4.SS1.p1.8.m8.6.6.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p1.8.m8.6.6.2.2.2.2.2" xref="S4.SS1.p1.8.m8.6.6.2.2.2.2.2.cmml"><mi id="S4.SS1.p1.8.m8.6.6.2.2.2.2.2.2" xref="S4.SS1.p1.8.m8.6.6.2.2.2.2.2.2.cmml">y</mi><mrow id="S4.SS1.p1.8.m8.4.4.2.4" xref="S4.SS1.p1.8.m8.4.4.2.3.cmml"><mi id="S4.SS1.p1.8.m8.3.3.1.1" xref="S4.SS1.p1.8.m8.3.3.1.1.cmml">k</mi><mo id="S4.SS1.p1.8.m8.4.4.2.4.1" xref="S4.SS1.p1.8.m8.4.4.2.3.cmml">,</mo><mi id="S4.SS1.p1.8.m8.4.4.2.2" xref="S4.SS1.p1.8.m8.4.4.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="S4.SS1.p1.8.m8.6.6.2.2.2.2.5" xref="S4.SS1.p1.8.m8.6.6.2.2.2.3.cmml">}</mo></mrow><mrow id="S4.SS1.p1.8.m8.6.6.2.2.4" xref="S4.SS1.p1.8.m8.6.6.2.2.4.cmml"><mi id="S4.SS1.p1.8.m8.6.6.2.2.4.2" xref="S4.SS1.p1.8.m8.6.6.2.2.4.2.cmml">i</mi><mo id="S4.SS1.p1.8.m8.6.6.2.2.4.1" xref="S4.SS1.p1.8.m8.6.6.2.2.4.1.cmml">=</mo><mn id="S4.SS1.p1.8.m8.6.6.2.2.4.3" xref="S4.SS1.p1.8.m8.6.6.2.2.4.3.cmml">1</mn></mrow><msub id="S4.SS1.p1.8.m8.6.6.2.4" xref="S4.SS1.p1.8.m8.6.6.2.4.cmml"><mi id="S4.SS1.p1.8.m8.6.6.2.4.2" xref="S4.SS1.p1.8.m8.6.6.2.4.2.cmml">N</mi><mi id="S4.SS1.p1.8.m8.6.6.2.4.3" xref="S4.SS1.p1.8.m8.6.6.2.4.3.cmml">k</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.6b"><apply id="S4.SS1.p1.8.m8.6.6.cmml" xref="S4.SS1.p1.8.m8.6.6"><eq id="S4.SS1.p1.8.m8.6.6.3.cmml" xref="S4.SS1.p1.8.m8.6.6.3"></eq><apply id="S4.SS1.p1.8.m8.6.6.4.cmml" xref="S4.SS1.p1.8.m8.6.6.4"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.6.6.4.1.cmml" xref="S4.SS1.p1.8.m8.6.6.4">subscript</csymbol><ci id="S4.SS1.p1.8.m8.6.6.4.2.cmml" xref="S4.SS1.p1.8.m8.6.6.4.2">𝒟</ci><ci id="S4.SS1.p1.8.m8.6.6.4.3.cmml" xref="S4.SS1.p1.8.m8.6.6.4.3">𝑘</ci></apply><apply id="S4.SS1.p1.8.m8.6.6.2.cmml" xref="S4.SS1.p1.8.m8.6.6.2"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.6.6.2.3.cmml" xref="S4.SS1.p1.8.m8.6.6.2">superscript</csymbol><apply id="S4.SS1.p1.8.m8.6.6.2.2.cmml" xref="S4.SS1.p1.8.m8.6.6.2"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.6.6.2.2.3.cmml" xref="S4.SS1.p1.8.m8.6.6.2">subscript</csymbol><set id="S4.SS1.p1.8.m8.6.6.2.2.2.3.cmml" xref="S4.SS1.p1.8.m8.6.6.2.2.2.2"><apply id="S4.SS1.p1.8.m8.5.5.1.1.1.1.1.cmml" xref="S4.SS1.p1.8.m8.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.5.5.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.8.m8.5.5.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.8.m8.5.5.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.8.m8.5.5.1.1.1.1.1.2">𝒙</ci><list id="S4.SS1.p1.8.m8.2.2.2.3.cmml" xref="S4.SS1.p1.8.m8.2.2.2.4"><ci id="S4.SS1.p1.8.m8.1.1.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1">𝑘</ci><ci id="S4.SS1.p1.8.m8.2.2.2.2.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2">𝑖</ci></list></apply><apply id="S4.SS1.p1.8.m8.6.6.2.2.2.2.2.cmml" xref="S4.SS1.p1.8.m8.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.6.6.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.8.m8.6.6.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.8.m8.6.6.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.8.m8.6.6.2.2.2.2.2.2">𝑦</ci><list id="S4.SS1.p1.8.m8.4.4.2.3.cmml" xref="S4.SS1.p1.8.m8.4.4.2.4"><ci id="S4.SS1.p1.8.m8.3.3.1.1.cmml" xref="S4.SS1.p1.8.m8.3.3.1.1">𝑘</ci><ci id="S4.SS1.p1.8.m8.4.4.2.2.cmml" xref="S4.SS1.p1.8.m8.4.4.2.2">𝑖</ci></list></apply></set><apply id="S4.SS1.p1.8.m8.6.6.2.2.4.cmml" xref="S4.SS1.p1.8.m8.6.6.2.2.4"><eq id="S4.SS1.p1.8.m8.6.6.2.2.4.1.cmml" xref="S4.SS1.p1.8.m8.6.6.2.2.4.1"></eq><ci id="S4.SS1.p1.8.m8.6.6.2.2.4.2.cmml" xref="S4.SS1.p1.8.m8.6.6.2.2.4.2">𝑖</ci><cn type="integer" id="S4.SS1.p1.8.m8.6.6.2.2.4.3.cmml" xref="S4.SS1.p1.8.m8.6.6.2.2.4.3">1</cn></apply></apply><apply id="S4.SS1.p1.8.m8.6.6.2.4.cmml" xref="S4.SS1.p1.8.m8.6.6.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.6.6.2.4.1.cmml" xref="S4.SS1.p1.8.m8.6.6.2.4">subscript</csymbol><ci id="S4.SS1.p1.8.m8.6.6.2.4.2.cmml" xref="S4.SS1.p1.8.m8.6.6.2.4.2">𝑁</ci><ci id="S4.SS1.p1.8.m8.6.6.2.4.3.cmml" xref="S4.SS1.p1.8.m8.6.6.2.4.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.6c">\mathcal{D}_{k}=\{\bm{x}_{k,i},y_{k,i}\}_{i=1}^{N_{k}}</annotation></semantics></math>, containing <math id="S4.SS1.p1.9.m9.1" class="ltx_Math" alttext="N_{k}" display="inline"><semantics id="S4.SS1.p1.9.m9.1a"><msub id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml"><mi id="S4.SS1.p1.9.m9.1.1.2" xref="S4.SS1.p1.9.m9.1.1.2.cmml">N</mi><mi id="S4.SS1.p1.9.m9.1.1.3" xref="S4.SS1.p1.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><apply id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.1.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S4.SS1.p1.9.m9.1.1.2.cmml" xref="S4.SS1.p1.9.m9.1.1.2">𝑁</ci><ci id="S4.SS1.p1.9.m9.1.1.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">N_{k}</annotation></semantics></math> instances sampled from distinct distributions.
Therefore, we get <math id="S4.SS1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{D}=\cup_{k\in[K]}\mathcal{D}_{k}" display="inline"><semantics id="S4.SS1.p1.10.m10.1a"><mrow id="S4.SS1.p1.10.m10.1.2" xref="S4.SS1.p1.10.m10.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.10.m10.1.2.2" xref="S4.SS1.p1.10.m10.1.2.2.cmml">𝒟</mi><mo rspace="0em" id="S4.SS1.p1.10.m10.1.2.1" xref="S4.SS1.p1.10.m10.1.2.1.cmml">=</mo><mrow id="S4.SS1.p1.10.m10.1.2.3" xref="S4.SS1.p1.10.m10.1.2.3.cmml"><msub id="S4.SS1.p1.10.m10.1.2.3.1" xref="S4.SS1.p1.10.m10.1.2.3.1.cmml"><mo lspace="0em" id="S4.SS1.p1.10.m10.1.2.3.1.2" xref="S4.SS1.p1.10.m10.1.2.3.1.2.cmml">∪</mo><mrow id="S4.SS1.p1.10.m10.1.1.1" xref="S4.SS1.p1.10.m10.1.1.1.cmml"><mi id="S4.SS1.p1.10.m10.1.1.1.3" xref="S4.SS1.p1.10.m10.1.1.1.3.cmml">k</mi><mo id="S4.SS1.p1.10.m10.1.1.1.2" xref="S4.SS1.p1.10.m10.1.1.1.2.cmml">∈</mo><mrow id="S4.SS1.p1.10.m10.1.1.1.4.2" xref="S4.SS1.p1.10.m10.1.1.1.4.1.cmml"><mo stretchy="false" id="S4.SS1.p1.10.m10.1.1.1.4.2.1" xref="S4.SS1.p1.10.m10.1.1.1.4.1.1.cmml">[</mo><mi id="S4.SS1.p1.10.m10.1.1.1.1" xref="S4.SS1.p1.10.m10.1.1.1.1.cmml">K</mi><mo stretchy="false" id="S4.SS1.p1.10.m10.1.1.1.4.2.2" xref="S4.SS1.p1.10.m10.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><msub id="S4.SS1.p1.10.m10.1.2.3.2" xref="S4.SS1.p1.10.m10.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.10.m10.1.2.3.2.2" xref="S4.SS1.p1.10.m10.1.2.3.2.2.cmml">𝒟</mi><mi id="S4.SS1.p1.10.m10.1.2.3.2.3" xref="S4.SS1.p1.10.m10.1.2.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><apply id="S4.SS1.p1.10.m10.1.2.cmml" xref="S4.SS1.p1.10.m10.1.2"><eq id="S4.SS1.p1.10.m10.1.2.1.cmml" xref="S4.SS1.p1.10.m10.1.2.1"></eq><ci id="S4.SS1.p1.10.m10.1.2.2.cmml" xref="S4.SS1.p1.10.m10.1.2.2">𝒟</ci><apply id="S4.SS1.p1.10.m10.1.2.3.cmml" xref="S4.SS1.p1.10.m10.1.2.3"><apply id="S4.SS1.p1.10.m10.1.2.3.1.cmml" xref="S4.SS1.p1.10.m10.1.2.3.1"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.2.3.1.1.cmml" xref="S4.SS1.p1.10.m10.1.2.3.1">subscript</csymbol><union id="S4.SS1.p1.10.m10.1.2.3.1.2.cmml" xref="S4.SS1.p1.10.m10.1.2.3.1.2"></union><apply id="S4.SS1.p1.10.m10.1.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1.1"><in id="S4.SS1.p1.10.m10.1.1.1.2.cmml" xref="S4.SS1.p1.10.m10.1.1.1.2"></in><ci id="S4.SS1.p1.10.m10.1.1.1.3.cmml" xref="S4.SS1.p1.10.m10.1.1.1.3">𝑘</ci><apply id="S4.SS1.p1.10.m10.1.1.1.4.1.cmml" xref="S4.SS1.p1.10.m10.1.1.1.4.2"><csymbol cd="latexml" id="S4.SS1.p1.10.m10.1.1.1.4.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S4.SS1.p1.10.m10.1.1.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1.1.1">𝐾</ci></apply></apply></apply><apply id="S4.SS1.p1.10.m10.1.2.3.2.cmml" xref="S4.SS1.p1.10.m10.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.1.2.3.2.1.cmml" xref="S4.SS1.p1.10.m10.1.2.3.2">subscript</csymbol><ci id="S4.SS1.p1.10.m10.1.2.3.2.2.cmml" xref="S4.SS1.p1.10.m10.1.2.3.2.2">𝒟</ci><ci id="S4.SS1.p1.10.m10.1.2.3.2.3.cmml" xref="S4.SS1.p1.10.m10.1.2.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">\mathcal{D}=\cup_{k\in[K]}\mathcal{D}_{k}</annotation></semantics></math>, where the data distributions of different <math id="S4.SS1.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S4.SS1.p1.11.m11.1a"><msub id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.11.m11.1.1.2" xref="S4.SS1.p1.11.m11.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.p1.11.m11.1.1.3" xref="S4.SS1.p1.11.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><apply id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m11.1.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S4.SS1.p1.11.m11.1.1.2.cmml" xref="S4.SS1.p1.11.m11.1.1.2">𝒟</ci><ci id="S4.SS1.p1.11.m11.1.1.3.cmml" xref="S4.SS1.p1.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">\mathcal{D}_{k}</annotation></semantics></math> are different.
The overall objective in FL with non-IID setting is defined as below:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.6" class="ltx_math_unparsed" alttext="\small{\operatorname{min}}\mathcal{L}(\bm{\theta}_{1},\dots,\bm{\theta}_{K};\bm{p})=\Sigma_{k=1}^{K}p_{k}\mathbb{E}_{(\bm{x},{y})\sim D_{k}}[\mathcal{L}_{k}(\bm{\theta}_{k};(\bm{x},{y})]," display="block"><semantics id="S4.E3.m1.6a"><mrow id="S4.E3.m1.6b"><mi mathsize="90%" id="S4.E3.m1.6.7">min</mi><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E3.m1.6.8">ℒ</mi><mrow id="S4.E3.m1.6.9"><mo maxsize="90%" minsize="90%" id="S4.E3.m1.6.9.1">(</mo><msub id="S4.E3.m1.6.9.2"><mi mathsize="90%" id="S4.E3.m1.6.9.2.2">𝜽</mi><mn mathsize="90%" id="S4.E3.m1.6.9.2.3">1</mn></msub><mo mathsize="90%" id="S4.E3.m1.6.9.3">,</mo><mi mathsize="90%" mathvariant="normal" id="S4.E3.m1.3.3">…</mi><mo mathsize="90%" id="S4.E3.m1.6.9.4">,</mo><msub id="S4.E3.m1.6.9.5"><mi mathsize="90%" id="S4.E3.m1.6.9.5.2">𝜽</mi><mi mathsize="90%" id="S4.E3.m1.6.9.5.3">K</mi></msub><mo mathsize="90%" id="S4.E3.m1.6.9.6">;</mo><mi mathsize="90%" id="S4.E3.m1.4.4">𝒑</mi><mo maxsize="90%" minsize="90%" id="S4.E3.m1.6.9.7">)</mo></mrow><mo mathsize="90%" id="S4.E3.m1.6.10">=</mo><msubsup id="S4.E3.m1.6.11"><mi mathsize="90%" mathvariant="normal" id="S4.E3.m1.6.11.2.2">Σ</mi><mrow id="S4.E3.m1.6.11.2.3"><mi mathsize="90%" id="S4.E3.m1.6.11.2.3.2">k</mi><mo mathsize="90%" id="S4.E3.m1.6.11.2.3.1">=</mo><mn mathsize="90%" id="S4.E3.m1.6.11.2.3.3">1</mn></mrow><mi mathsize="90%" id="S4.E3.m1.6.11.3">K</mi></msubsup><msub id="S4.E3.m1.6.12"><mi mathsize="90%" id="S4.E3.m1.6.12.2">p</mi><mi mathsize="90%" id="S4.E3.m1.6.12.3">k</mi></msub><msub id="S4.E3.m1.6.13"><mi mathsize="90%" id="S4.E3.m1.6.13.2">𝔼</mi><mrow id="S4.E3.m1.2.2.2"><mrow id="S4.E3.m1.2.2.2.4.2"><mo maxsize="90%" minsize="90%" id="S4.E3.m1.2.2.2.4.2.1">(</mo><mi mathsize="90%" id="S4.E3.m1.1.1.1.1">𝒙</mi><mo mathsize="90%" id="S4.E3.m1.2.2.2.4.2.2">,</mo><mi mathsize="90%" id="S4.E3.m1.2.2.2.2">y</mi><mo maxsize="90%" minsize="90%" id="S4.E3.m1.2.2.2.4.2.3">)</mo></mrow><mo mathsize="90%" id="S4.E3.m1.2.2.2.3">∼</mo><msub id="S4.E3.m1.2.2.2.5"><mi mathsize="90%" id="S4.E3.m1.2.2.2.5.2">D</mi><mi mathsize="90%" id="S4.E3.m1.2.2.2.5.3">k</mi></msub></mrow></msub><mrow id="S4.E3.m1.6.14"><mo maxsize="90%" minsize="90%" id="S4.E3.m1.6.14.1">[</mo><msub id="S4.E3.m1.6.14.2"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S4.E3.m1.6.14.2.2">ℒ</mi><mi mathsize="90%" id="S4.E3.m1.6.14.2.3">k</mi></msub><mrow id="S4.E3.m1.6.14.3"><mo maxsize="90%" minsize="90%" id="S4.E3.m1.6.14.3.1">(</mo><msub id="S4.E3.m1.6.14.3.2"><mi mathsize="90%" id="S4.E3.m1.6.14.3.2.2">𝜽</mi><mi mathsize="90%" id="S4.E3.m1.6.14.3.2.3">k</mi></msub><mo mathsize="90%" id="S4.E3.m1.6.14.3.3">;</mo><mrow id="S4.E3.m1.6.14.3.4"><mo maxsize="90%" minsize="90%" id="S4.E3.m1.6.14.3.4.1">(</mo><mi mathsize="90%" id="S4.E3.m1.5.5">𝒙</mi><mo mathsize="90%" id="S4.E3.m1.6.14.3.4.2">,</mo><mi mathsize="90%" id="S4.E3.m1.6.6">y</mi><mo maxsize="90%" minsize="90%" id="S4.E3.m1.6.14.3.4.3">)</mo></mrow><mo maxsize="90%" minsize="90%" id="S4.E3.m1.6.14.3.5">]</mo></mrow><mo mathsize="90%" id="S4.E3.m1.6.14.4">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.E3.m1.6c">\small{\operatorname{min}}\mathcal{L}(\bm{\theta}_{1},\dots,\bm{\theta}_{K};\bm{p})=\Sigma_{k=1}^{K}p_{k}\mathbb{E}_{(\bm{x},{y})\sim D_{k}}[\mathcal{L}_{k}(\bm{\theta}_{k};(\bm{x},{y})],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.14" class="ltx_p">where <math id="S4.SS1.p1.12.m1.1" class="ltx_Math" alttext="\mathcal{L}_{k}(\cdot)" display="inline"><semantics id="S4.SS1.p1.12.m1.1a"><mrow id="S4.SS1.p1.12.m1.1.2" xref="S4.SS1.p1.12.m1.1.2.cmml"><msub id="S4.SS1.p1.12.m1.1.2.2" xref="S4.SS1.p1.12.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.12.m1.1.2.2.2" xref="S4.SS1.p1.12.m1.1.2.2.2.cmml">ℒ</mi><mi id="S4.SS1.p1.12.m1.1.2.2.3" xref="S4.SS1.p1.12.m1.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.12.m1.1.2.1" xref="S4.SS1.p1.12.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.p1.12.m1.1.2.3.2" xref="S4.SS1.p1.12.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.12.m1.1.2.3.2.1" xref="S4.SS1.p1.12.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p1.12.m1.1.1" xref="S4.SS1.p1.12.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.p1.12.m1.1.2.3.2.2" xref="S4.SS1.p1.12.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m1.1b"><apply id="S4.SS1.p1.12.m1.1.2.cmml" xref="S4.SS1.p1.12.m1.1.2"><times id="S4.SS1.p1.12.m1.1.2.1.cmml" xref="S4.SS1.p1.12.m1.1.2.1"></times><apply id="S4.SS1.p1.12.m1.1.2.2.cmml" xref="S4.SS1.p1.12.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m1.1.2.2.1.cmml" xref="S4.SS1.p1.12.m1.1.2.2">subscript</csymbol><ci id="S4.SS1.p1.12.m1.1.2.2.2.cmml" xref="S4.SS1.p1.12.m1.1.2.2.2">ℒ</ci><ci id="S4.SS1.p1.12.m1.1.2.2.3.cmml" xref="S4.SS1.p1.12.m1.1.2.2.3">𝑘</ci></apply><ci id="S4.SS1.p1.12.m1.1.1.cmml" xref="S4.SS1.p1.12.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m1.1c">\mathcal{L}_{k}(\cdot)</annotation></semantics></math> is the model loss at client <math id="S4.SS1.p1.13.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.13.m2.1a"><mi id="S4.SS1.p1.13.m2.1.1" xref="S4.SS1.p1.13.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m2.1b"><ci id="S4.SS1.p1.13.m2.1.1.cmml" xref="S4.SS1.p1.13.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m2.1c">k</annotation></semantics></math>, and <math id="S4.SS1.p1.14.m3.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="S4.SS1.p1.14.m3.1a"><msub id="S4.SS1.p1.14.m3.1.1" xref="S4.SS1.p1.14.m3.1.1.cmml"><mi id="S4.SS1.p1.14.m3.1.1.2" xref="S4.SS1.p1.14.m3.1.1.2.cmml">p</mi><mi id="S4.SS1.p1.14.m3.1.1.3" xref="S4.SS1.p1.14.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m3.1b"><apply id="S4.SS1.p1.14.m3.1.1.cmml" xref="S4.SS1.p1.14.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m3.1.1.1.cmml" xref="S4.SS1.p1.14.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.14.m3.1.1.2.cmml" xref="S4.SS1.p1.14.m3.1.1.2">𝑝</ci><ci id="S4.SS1.p1.14.m3.1.1.3.cmml" xref="S4.SS1.p1.14.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m3.1c">p_{k}</annotation></semantics></math> indicates its weight ratio for aggregating.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2307.14384/assets/figs/FL2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="598" height="530" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Framework of <span id="S4.F2.3.1" class="ltx_text ltx_font_typewriter">HyperFed</span>.
We take the modeling of <span id="S4.F2.4.2" class="ltx_text ltx_font_typewriter">HyperFed</span> with 2-dimensional Poincaré ball predictor on Cifar10 as an example. </figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Framework Overview</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.9" class="ltx_p">To explain how <span id="S4.SS2.p1.9.1" class="ltx_text ltx_font_typewriter">HyperFed</span> solve the problem in FL with non-IID data, i.e., Eq. (<a href="#S4.E3" title="In 4.1 Problem Statement ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), we introduce the framework overview of <span id="S4.SS2.p1.9.2" class="ltx_text ltx_font_typewriter">HyperFed</span>.
In Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.1 Problem Statement ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, there are a server and K clients.
Each client or server, similarly consists of a feature extractor, an exponential map, and a Poincaré ball predictor.
The feature extractor <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{F}(\cdot):\mathcal{X}\rightarrow\mathbb{R}^{d}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.2" xref="S4.SS2.p1.1.m1.1.2.cmml"><mrow id="S4.SS2.p1.1.m1.1.2.2" xref="S4.SS2.p1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.1.m1.1.2.2.2" xref="S4.SS2.p1.1.m1.1.2.2.2.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.2.2.1" xref="S4.SS2.p1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S4.SS2.p1.1.m1.1.2.2.3.2" xref="S4.SS2.p1.1.m1.1.2.2.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.2.2.3.2.1" xref="S4.SS2.p1.1.m1.1.2.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">⋅</mo><mo rspace="0.278em" stretchy="false" id="S4.SS2.p1.1.m1.1.2.2.3.2.2" xref="S4.SS2.p1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S4.SS2.p1.1.m1.1.2.1" xref="S4.SS2.p1.1.m1.1.2.1.cmml">:</mo><mrow id="S4.SS2.p1.1.m1.1.2.3" xref="S4.SS2.p1.1.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.1.m1.1.2.3.2" xref="S4.SS2.p1.1.m1.1.2.3.2.cmml">𝒳</mi><mo stretchy="false" id="S4.SS2.p1.1.m1.1.2.3.1" xref="S4.SS2.p1.1.m1.1.2.3.1.cmml">→</mo><msup id="S4.SS2.p1.1.m1.1.2.3.3" xref="S4.SS2.p1.1.m1.1.2.3.3.cmml"><mi id="S4.SS2.p1.1.m1.1.2.3.3.2" xref="S4.SS2.p1.1.m1.1.2.3.3.2.cmml">ℝ</mi><mi id="S4.SS2.p1.1.m1.1.2.3.3.3" xref="S4.SS2.p1.1.m1.1.2.3.3.3.cmml">d</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.2"><ci id="S4.SS2.p1.1.m1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.2.1">:</ci><apply id="S4.SS2.p1.1.m1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.2.2"><times id="S4.SS2.p1.1.m1.1.2.2.1.cmml" xref="S4.SS2.p1.1.m1.1.2.2.1"></times><ci id="S4.SS2.p1.1.m1.1.2.2.2.cmml" xref="S4.SS2.p1.1.m1.1.2.2.2">ℱ</ci><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">⋅</ci></apply><apply id="S4.SS2.p1.1.m1.1.2.3.cmml" xref="S4.SS2.p1.1.m1.1.2.3"><ci id="S4.SS2.p1.1.m1.1.2.3.1.cmml" xref="S4.SS2.p1.1.m1.1.2.3.1">→</ci><ci id="S4.SS2.p1.1.m1.1.2.3.2.cmml" xref="S4.SS2.p1.1.m1.1.2.3.2">𝒳</ci><apply id="S4.SS2.p1.1.m1.1.2.3.3.cmml" xref="S4.SS2.p1.1.m1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.2.3.3.1.cmml" xref="S4.SS2.p1.1.m1.1.2.3.3">superscript</csymbol><ci id="S4.SS2.p1.1.m1.1.2.3.3.2.cmml" xref="S4.SS2.p1.1.m1.1.2.3.3.2">ℝ</ci><ci id="S4.SS2.p1.1.m1.1.2.3.3.3.cmml" xref="S4.SS2.p1.1.m1.1.2.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mathcal{F}(\cdot):\mathcal{X}\rightarrow\mathbb{R}^{d}</annotation></semantics></math> maps an input data <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\bm{x}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\bm{x}</annotation></semantics></math> into a <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">n</annotation></semantics></math>-dimensional vector <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\bm{z}=\mathcal{F}(\bm{x})" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.2" xref="S4.SS2.p1.4.m4.1.2.cmml"><mi id="S4.SS2.p1.4.m4.1.2.2" xref="S4.SS2.p1.4.m4.1.2.2.cmml">𝒛</mi><mo id="S4.SS2.p1.4.m4.1.2.1" xref="S4.SS2.p1.4.m4.1.2.1.cmml">=</mo><mrow id="S4.SS2.p1.4.m4.1.2.3" xref="S4.SS2.p1.4.m4.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.4.m4.1.2.3.2" xref="S4.SS2.p1.4.m4.1.2.3.2.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.4.m4.1.2.3.1" xref="S4.SS2.p1.4.m4.1.2.3.1.cmml">​</mo><mrow id="S4.SS2.p1.4.m4.1.2.3.3.2" xref="S4.SS2.p1.4.m4.1.2.3.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m4.1.2.3.3.2.1" xref="S4.SS2.p1.4.m4.1.2.3.cmml">(</mo><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">𝒙</mi><mo stretchy="false" id="S4.SS2.p1.4.m4.1.2.3.3.2.2" xref="S4.SS2.p1.4.m4.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.2.cmml" xref="S4.SS2.p1.4.m4.1.2"><eq id="S4.SS2.p1.4.m4.1.2.1.cmml" xref="S4.SS2.p1.4.m4.1.2.1"></eq><ci id="S4.SS2.p1.4.m4.1.2.2.cmml" xref="S4.SS2.p1.4.m4.1.2.2">𝒛</ci><apply id="S4.SS2.p1.4.m4.1.2.3.cmml" xref="S4.SS2.p1.4.m4.1.2.3"><times id="S4.SS2.p1.4.m4.1.2.3.1.cmml" xref="S4.SS2.p1.4.m4.1.2.3.1"></times><ci id="S4.SS2.p1.4.m4.1.2.3.2.cmml" xref="S4.SS2.p1.4.m4.1.2.3.2">ℱ</ci><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\bm{z}=\mathcal{F}(\bm{x})</annotation></semantics></math> as feature representation.
Then we get <math id="S4.SS2.p1.5.m5.2" class="ltx_Math" alttext="\operatorname{exp}_{\bm{o}}(\bm{z})" display="inline"><semantics id="S4.SS2.p1.5.m5.2a"><mrow id="S4.SS2.p1.5.m5.2.2.1" xref="S4.SS2.p1.5.m5.2.2.2.cmml"><msub id="S4.SS2.p1.5.m5.2.2.1.1" xref="S4.SS2.p1.5.m5.2.2.1.1.cmml"><mi id="S4.SS2.p1.5.m5.2.2.1.1.2" xref="S4.SS2.p1.5.m5.2.2.1.1.2.cmml">exp</mi><mi id="S4.SS2.p1.5.m5.2.2.1.1.3" xref="S4.SS2.p1.5.m5.2.2.1.1.3.cmml">𝒐</mi></msub><mo id="S4.SS2.p1.5.m5.2.2.1a" xref="S4.SS2.p1.5.m5.2.2.2.cmml">⁡</mo><mrow id="S4.SS2.p1.5.m5.2.2.1.2" xref="S4.SS2.p1.5.m5.2.2.2.cmml"><mo stretchy="false" id="S4.SS2.p1.5.m5.2.2.1.2.1" xref="S4.SS2.p1.5.m5.2.2.2.cmml">(</mo><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">𝒛</mi><mo stretchy="false" id="S4.SS2.p1.5.m5.2.2.1.2.2" xref="S4.SS2.p1.5.m5.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.2b"><apply id="S4.SS2.p1.5.m5.2.2.2.cmml" xref="S4.SS2.p1.5.m5.2.2.1"><apply id="S4.SS2.p1.5.m5.2.2.1.1.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.2.2.1.1.1.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1">subscript</csymbol><ci id="S4.SS2.p1.5.m5.2.2.1.1.2.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.2">exp</ci><ci id="S4.SS2.p1.5.m5.2.2.1.1.3.cmml" xref="S4.SS2.p1.5.m5.2.2.1.1.3">𝒐</ci></apply><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.2c">\operatorname{exp}_{\bm{o}}(\bm{z})</annotation></semantics></math> by
leveraging exponential map on the feature representation <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="\bm{z}" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mi id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">\bm{z}</annotation></semantics></math> to the Poincaré ball space referred by the origin <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="\bm{o}" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><mi id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">𝒐</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><ci id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">𝒐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">\bm{o}</annotation></semantics></math>.
Finally, the Poincaré ball predictor <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="h(\cdot):\mathbb{R}^{d}\rightarrow\mathcal{Y}" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><mrow id="S4.SS2.p1.8.m8.1.2" xref="S4.SS2.p1.8.m8.1.2.cmml"><mrow id="S4.SS2.p1.8.m8.1.2.2" xref="S4.SS2.p1.8.m8.1.2.2.cmml"><mi id="S4.SS2.p1.8.m8.1.2.2.2" xref="S4.SS2.p1.8.m8.1.2.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m8.1.2.2.1" xref="S4.SS2.p1.8.m8.1.2.2.1.cmml">​</mo><mrow id="S4.SS2.p1.8.m8.1.2.2.3.2" xref="S4.SS2.p1.8.m8.1.2.2.cmml"><mo stretchy="false" id="S4.SS2.p1.8.m8.1.2.2.3.2.1" xref="S4.SS2.p1.8.m8.1.2.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml">⋅</mo><mo rspace="0.278em" stretchy="false" id="S4.SS2.p1.8.m8.1.2.2.3.2.2" xref="S4.SS2.p1.8.m8.1.2.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S4.SS2.p1.8.m8.1.2.1" xref="S4.SS2.p1.8.m8.1.2.1.cmml">:</mo><mrow id="S4.SS2.p1.8.m8.1.2.3" xref="S4.SS2.p1.8.m8.1.2.3.cmml"><msup id="S4.SS2.p1.8.m8.1.2.3.2" xref="S4.SS2.p1.8.m8.1.2.3.2.cmml"><mi id="S4.SS2.p1.8.m8.1.2.3.2.2" xref="S4.SS2.p1.8.m8.1.2.3.2.2.cmml">ℝ</mi><mi id="S4.SS2.p1.8.m8.1.2.3.2.3" xref="S4.SS2.p1.8.m8.1.2.3.2.3.cmml">d</mi></msup><mo stretchy="false" id="S4.SS2.p1.8.m8.1.2.3.1" xref="S4.SS2.p1.8.m8.1.2.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.8.m8.1.2.3.3" xref="S4.SS2.p1.8.m8.1.2.3.3.cmml">𝒴</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><apply id="S4.SS2.p1.8.m8.1.2.cmml" xref="S4.SS2.p1.8.m8.1.2"><ci id="S4.SS2.p1.8.m8.1.2.1.cmml" xref="S4.SS2.p1.8.m8.1.2.1">:</ci><apply id="S4.SS2.p1.8.m8.1.2.2.cmml" xref="S4.SS2.p1.8.m8.1.2.2"><times id="S4.SS2.p1.8.m8.1.2.2.1.cmml" xref="S4.SS2.p1.8.m8.1.2.2.1"></times><ci id="S4.SS2.p1.8.m8.1.2.2.2.cmml" xref="S4.SS2.p1.8.m8.1.2.2.2">ℎ</ci><ci id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1">⋅</ci></apply><apply id="S4.SS2.p1.8.m8.1.2.3.cmml" xref="S4.SS2.p1.8.m8.1.2.3"><ci id="S4.SS2.p1.8.m8.1.2.3.1.cmml" xref="S4.SS2.p1.8.m8.1.2.3.1">→</ci><apply id="S4.SS2.p1.8.m8.1.2.3.2.cmml" xref="S4.SS2.p1.8.m8.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.2.3.2.1.cmml" xref="S4.SS2.p1.8.m8.1.2.3.2">superscript</csymbol><ci id="S4.SS2.p1.8.m8.1.2.3.2.2.cmml" xref="S4.SS2.p1.8.m8.1.2.3.2.2">ℝ</ci><ci id="S4.SS2.p1.8.m8.1.2.3.2.3.cmml" xref="S4.SS2.p1.8.m8.1.2.3.2.3">𝑑</ci></apply><ci id="S4.SS2.p1.8.m8.1.2.3.3.cmml" xref="S4.SS2.p1.8.m8.1.2.3.3">𝒴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">h(\cdot):\mathbb{R}^{d}\rightarrow\mathcal{Y}</annotation></semantics></math> decides class label for input data based on the representation <math id="S4.SS2.p1.9.m9.2" class="ltx_Math" alttext="\operatorname{exp}_{\bm{o}}(\bm{z})" display="inline"><semantics id="S4.SS2.p1.9.m9.2a"><mrow id="S4.SS2.p1.9.m9.2.2.1" xref="S4.SS2.p1.9.m9.2.2.2.cmml"><msub id="S4.SS2.p1.9.m9.2.2.1.1" xref="S4.SS2.p1.9.m9.2.2.1.1.cmml"><mi id="S4.SS2.p1.9.m9.2.2.1.1.2" xref="S4.SS2.p1.9.m9.2.2.1.1.2.cmml">exp</mi><mi id="S4.SS2.p1.9.m9.2.2.1.1.3" xref="S4.SS2.p1.9.m9.2.2.1.1.3.cmml">𝒐</mi></msub><mo id="S4.SS2.p1.9.m9.2.2.1a" xref="S4.SS2.p1.9.m9.2.2.2.cmml">⁡</mo><mrow id="S4.SS2.p1.9.m9.2.2.1.2" xref="S4.SS2.p1.9.m9.2.2.2.cmml"><mo stretchy="false" id="S4.SS2.p1.9.m9.2.2.1.2.1" xref="S4.SS2.p1.9.m9.2.2.2.cmml">(</mo><mi id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">𝒛</mi><mo stretchy="false" id="S4.SS2.p1.9.m9.2.2.1.2.2" xref="S4.SS2.p1.9.m9.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.2b"><apply id="S4.SS2.p1.9.m9.2.2.2.cmml" xref="S4.SS2.p1.9.m9.2.2.1"><apply id="S4.SS2.p1.9.m9.2.2.1.1.cmml" xref="S4.SS2.p1.9.m9.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.2.2.1.1.1.cmml" xref="S4.SS2.p1.9.m9.2.2.1.1">subscript</csymbol><ci id="S4.SS2.p1.9.m9.2.2.1.1.2.cmml" xref="S4.SS2.p1.9.m9.2.2.1.1.2">exp</ci><ci id="S4.SS2.p1.9.m9.2.2.1.1.3.cmml" xref="S4.SS2.p1.9.m9.2.2.1.1.3">𝒐</ci></apply><ci id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.2c">\operatorname{exp}_{\bm{o}}(\bm{z})</annotation></semantics></math> in Poincaré ball.
All Poincaré ball predictors of server and clients are fixed and shared.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">As Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.1 Problem Statement ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows, there are mainly three steps in <span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span>.
(1) The server in <span id="S4.SS2.p2.1.2" class="ltx_text ltx_font_typewriter">HyperFed</span> leverages hyperbolic prototype Tammes
initialization (HPTI) module to construct a full set of uniformly-distributed class prototypes
for the Poincaré ball predictor by Tammes prototype initialization (TPI), contracts class prototypes close to origin,
and shares Poincaré ball predictor with fixed class prototypes to all of the clients.
(2) Each client models local data distribution independently with the hyperbolic prototype learning (HPL) module, then sends the parameters of the local model to the server for aggregation.
(3) Consistent aggregation (CA) module in the server updates the global model parameters using consistent updating (CU) to mitigate the inconsistent deviations from clients to server. After that, the server sends the new global model parameters back to clients.
This communication between server and clients, i.e., steps 2-3, iterates until the performance converges.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Hyperbolic Prototype Tammes Initialization</h3>

<section id="S4.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Motivation.</h4>

<div id="S4.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px1.p1.1" class="ltx_p">In this section, we devise HPTI module in server to resolve two limits brought from the class statistics shifting, i.e., missing class and class overlapping, as described in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(a).
To bypass the dilemma of choosing a dimension, HPTI explores the class statistics in the hyperbolic space, which is scalable and effective in modeling data with low-dimensional space.
Firstly, HPTI uses Tammes prototype
initialization (TPI) to construct uniformly distributed and distinguishable class prototypes for the entire class set.
Then HPTI fixes the position of the class prototypes on the Poincaré ball predictor.
Lastly, HPTI sends the Poincaré ball predictor with fixed hyperbolic class prototypes, including the missing classes, to clients.
We describe them in detail below.
</p>
</div>
<div id="S4.SS3.SSS0.Px1.p2" class="ltx_para">
<p id="S4.SS3.SSS0.Px1.p2.3" class="ltx_p">HPTI first constructs uniformly distributed hyperbolic prototypes with TPI, which is available in data without prior semantic information and efficient in computation.
Most work relies on prior semantic knowledge about classes to discover the positions and representations of class prototypes.
However, not all datasets contain prior semantic knowledge.
Motivated by <cite class="ltx_cite ltx_citemacro_cite">Ghadimi Atigh <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>, we randomly sample points on the boundary of Poincaré ball for assigning class prototypes, and optimize these points to be uniformly distributed in a ball-shaped space.
In this way, we incorporate the prior with large margin separation for Poincaré ball predictor.
To be specific, searching for uniformly distributed class prototypes can be formulated as a Tammes problem <cite class="ltx_cite ltx_citemacro_cite">Tammes (<a href="#bib.bib45" title="" class="ltx_ref">1930</a>)</cite>, i.e., arranging a set of points on a unit sphere that maximizes the minimum distance between any two points.
TPI optimizes this Tammes problem to obtain the class prototypes for all <math id="S4.SS3.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS3.SSS0.Px1.p2.1.m1.1a"><mi id="S4.SS3.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.1.m1.1b"><ci id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.1.m1.1c">C</annotation></semantics></math> classes in a dataset, i.e., <math id="S4.SS3.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="\bm{W}^{*}\in\mathbb{R}^{C\times n}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p2.2.m2.1a"><mrow id="S4.SS3.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.cmml"><msup id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.2" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.2.cmml">𝑾</mi><mo id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.3" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.3.cmml">∗</mo></msup><mo id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.2" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.cmml"><mi id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.2" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.1" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.3" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.2.m2.1b"><apply id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1"><in id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.1"></in><apply id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2">superscript</csymbol><ci id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.2">𝑾</ci><times id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.2.3"></times></apply><apply id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3"><times id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.1"></times><ci id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.2">𝐶</ci><ci id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.3.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.2.m2.1c">\bm{W}^{*}\in\mathbb{R}^{C\times n}</annotation></semantics></math> with <math id="S4.SS3.SSS0.Px1.p2.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS3.SSS0.Px1.p2.3.m3.1a"><mi id="S4.SS3.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.3.m3.1b"><ci id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.3.m3.1c">n</annotation></semantics></math> denoting the dimension of prototype:</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.32" class="ltx_Math" alttext="\small\begin{gathered}\bm{W}^{*}=\underset{\bm{W}\in\mathbb{P}^{n}}{\operatorname{argmin}}\left(\max_{(i,j,i\neq j)\in[C]}\bm{w}_{i}{\bm{w}_{j}}^{\top}\right),\\
\text{ s.t. }\forall i\in[C]\quad\left\|\bm{w}_{i}\right\|_{2}=1,\end{gathered}" display="block"><semantics id="S4.E4.m1.32a"><mtable displaystyle="true" rowspacing="0pt" id="S4.E4.m1.32.32.3"><mtr id="S4.E4.m1.32.32.3a"><mtd id="S4.E4.m1.32.32.3b"><mrow id="S4.E4.m1.31.31.2.30.15.15.15"><mrow id="S4.E4.m1.31.31.2.30.15.15.15.1"><msup id="S4.E4.m1.31.31.2.30.15.15.15.1.2"><mi mathsize="90%" id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml">𝑾</mi><mo mathsize="90%" id="S4.E4.m1.2.2.2.2.2.2.1" xref="S4.E4.m1.2.2.2.2.2.2.1.cmml">∗</mo></msup><mo mathsize="90%" id="S4.E4.m1.3.3.3.3.3.3" xref="S4.E4.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E4.m1.31.31.2.30.15.15.15.1.1"><munder accentunder="true" id="S4.E4.m1.4.4.4.4.4.4" xref="S4.E4.m1.4.4.4.4.4.4.cmml"><mi mathsize="90%" id="S4.E4.m1.4.4.4.4.4.4.2" xref="S4.E4.m1.4.4.4.4.4.4.2.cmml">argmin</mi><mrow id="S4.E4.m1.4.4.4.4.4.4.1" xref="S4.E4.m1.4.4.4.4.4.4.1.cmml"><mi mathsize="90%" id="S4.E4.m1.4.4.4.4.4.4.1.2" xref="S4.E4.m1.4.4.4.4.4.4.1.2.cmml">𝑾</mi><mo mathsize="90%" id="S4.E4.m1.4.4.4.4.4.4.1.1" xref="S4.E4.m1.4.4.4.4.4.4.1.1.cmml">∈</mo><msup id="S4.E4.m1.4.4.4.4.4.4.1.3" xref="S4.E4.m1.4.4.4.4.4.4.1.3.cmml"><mi mathsize="90%" id="S4.E4.m1.4.4.4.4.4.4.1.3.2" xref="S4.E4.m1.4.4.4.4.4.4.1.3.2.cmml">ℙ</mi><mi mathsize="90%" id="S4.E4.m1.4.4.4.4.4.4.1.3.3" xref="S4.E4.m1.4.4.4.4.4.4.1.3.3.cmml">n</mi></msup></mrow></munder><mo lspace="0em" rspace="0em" id="S4.E4.m1.31.31.2.30.15.15.15.1.1.2">​</mo><mrow id="S4.E4.m1.31.31.2.30.15.15.15.1.1.1.1"><mo id="S4.E4.m1.5.5.5.5.5.5">(</mo><mrow id="S4.E4.m1.31.31.2.30.15.15.15.1.1.1.1.1"><munder id="S4.E4.m1.31.31.2.30.15.15.15.1.1.1.1.1.1"><mi mathsize="90%" id="S4.E4.m1.6.6.6.6.6.6" xref="S4.E4.m1.6.6.6.6.6.6.cmml">max</mi><mrow id="S4.E4.m1.7.7.7.7.7.7.1" xref="S4.E4.m1.7.7.7.7.7.7.1.cmml"><mrow id="S4.E4.m1.7.7.7.7.7.7.1.5.1" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.5.1.2" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.cmml">(</mo><mrow id="S4.E4.m1.7.7.7.7.7.7.1.5.1.1" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.cmml"><mrow id="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.2.2" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.2.1.cmml"><mi mathsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.1" xref="S4.E4.m1.7.7.7.7.7.7.1.1.cmml">i</mi><mo mathsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.2.2.1" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.2.1.cmml">,</mo><mi mathsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.2" xref="S4.E4.m1.7.7.7.7.7.7.1.2.cmml">j</mi><mo mathsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.2.2.2" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.2.1.cmml">,</mo><mi mathsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.3" xref="S4.E4.m1.7.7.7.7.7.7.1.3.cmml">i</mi></mrow><mo mathsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.1" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.1.cmml">≠</mo><mi mathsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.3" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.3.cmml">j</mi></mrow><mo maxsize="90%" minsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.5.1.3" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.cmml">)</mo></mrow><mo mathsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.6" xref="S4.E4.m1.7.7.7.7.7.7.1.6.cmml">∈</mo><mrow id="S4.E4.m1.7.7.7.7.7.7.1.7.2" xref="S4.E4.m1.7.7.7.7.7.7.1.7.1.cmml"><mo maxsize="90%" minsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.7.2.1" xref="S4.E4.m1.7.7.7.7.7.7.1.7.1.1.cmml">[</mo><mi mathsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.4" xref="S4.E4.m1.7.7.7.7.7.7.1.4.cmml">C</mi><mo maxsize="90%" minsize="90%" id="S4.E4.m1.7.7.7.7.7.7.1.7.2.2" xref="S4.E4.m1.7.7.7.7.7.7.1.7.1.1.cmml">]</mo></mrow></mrow></munder><mo lspace="0.167em" id="S4.E4.m1.31.31.2.30.15.15.15.1.1.1.1.1a">⁡</mo><mrow id="S4.E4.m1.31.31.2.30.15.15.15.1.1.1.1.1.2"><msub id="S4.E4.m1.31.31.2.30.15.15.15.1.1.1.1.1.2.2"><mi mathsize="90%" id="S4.E4.m1.8.8.8.8.8.8" xref="S4.E4.m1.8.8.8.8.8.8.cmml">𝒘</mi><mi mathsize="90%" id="S4.E4.m1.9.9.9.9.9.9.1" xref="S4.E4.m1.9.9.9.9.9.9.1.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.31.31.2.30.15.15.15.1.1.1.1.1.2.1">​</mo><mmultiscripts id="S4.E4.m1.31.31.2.30.15.15.15.1.1.1.1.1.2.3"><mi mathsize="90%" id="S4.E4.m1.10.10.10.10.10.10" xref="S4.E4.m1.10.10.10.10.10.10.cmml">𝒘</mi><mi mathsize="90%" id="S4.E4.m1.11.11.11.11.11.11.1" xref="S4.E4.m1.11.11.11.11.11.11.1.cmml">j</mi><mrow id="S4.E4.m1.31.31.2.30.15.15.15.1.1.1.1.1.2.3a"></mrow><mrow id="S4.E4.m1.31.31.2.30.15.15.15.1.1.1.1.1.2.3b"></mrow><mo mathsize="90%" id="S4.E4.m1.12.12.12.12.12.12.1" xref="S4.E4.m1.12.12.12.12.12.12.1.cmml">⊤</mo></mmultiscripts></mrow></mrow><mo id="S4.E4.m1.13.13.13.13.13.13">)</mo></mrow></mrow></mrow><mo mathsize="90%" id="S4.E4.m1.14.14.14.14.14.14">,</mo></mrow></mtd></mtr><mtr id="S4.E4.m1.32.32.3c"><mtd id="S4.E4.m1.32.32.3d"><mrow id="S4.E4.m1.32.32.3.31.16.16.16"><mrow id="S4.E4.m1.32.32.3.31.16.16.16.1"><mrow id="S4.E4.m1.32.32.3.31.16.16.16.1.3"><mtext mathsize="90%" id="S4.E4.m1.15.15.15.1.1.1" xref="S4.E4.m1.15.15.15.1.1.1a.cmml"> s.t. </mtext><mo lspace="0.167em" rspace="0em" id="S4.E4.m1.32.32.3.31.16.16.16.1.3.1">​</mo><mrow id="S4.E4.m1.32.32.3.31.16.16.16.1.3.2"><mo mathsize="90%" rspace="0.167em" id="S4.E4.m1.16.16.16.2.2.2" xref="S4.E4.m1.16.16.16.2.2.2.cmml">∀</mo><mi mathsize="90%" id="S4.E4.m1.17.17.17.3.3.3" xref="S4.E4.m1.17.17.17.3.3.3.cmml">i</mi></mrow></mrow><mo mathsize="90%" id="S4.E4.m1.18.18.18.4.4.4" xref="S4.E4.m1.18.18.18.4.4.4.cmml">∈</mo><mrow id="S4.E4.m1.32.32.3.31.16.16.16.1.1"><mrow id="S4.E4.m1.32.32.3.31.16.16.16.1.1.3"><mo maxsize="90%" minsize="90%" id="S4.E4.m1.19.19.19.5.5.5">[</mo><mi mathsize="90%" id="S4.E4.m1.20.20.20.6.6.6" xref="S4.E4.m1.20.20.20.6.6.6.cmml">C</mi><mo maxsize="90%" minsize="90%" id="S4.E4.m1.21.21.21.7.7.7">]</mo></mrow><mo lspace="0.900em" rspace="0em" id="S4.E4.m1.32.32.3.31.16.16.16.1.1.2">​</mo><msub id="S4.E4.m1.32.32.3.31.16.16.16.1.1.1"><mrow id="S4.E4.m1.32.32.3.31.16.16.16.1.1.1.1.1"><mo id="S4.E4.m1.22.22.22.8.8.8">‖</mo><msub id="S4.E4.m1.32.32.3.31.16.16.16.1.1.1.1.1.1"><mi mathsize="90%" id="S4.E4.m1.23.23.23.9.9.9" xref="S4.E4.m1.23.23.23.9.9.9.cmml">𝒘</mi><mi mathsize="90%" id="S4.E4.m1.24.24.24.10.10.10.1" xref="S4.E4.m1.24.24.24.10.10.10.1.cmml">i</mi></msub><mo id="S4.E4.m1.25.25.25.11.11.11">‖</mo></mrow><mn mathsize="90%" id="S4.E4.m1.26.26.26.12.12.12.1" xref="S4.E4.m1.26.26.26.12.12.12.1.cmml">2</mn></msub></mrow><mo mathsize="90%" id="S4.E4.m1.27.27.27.13.13.13" xref="S4.E4.m1.27.27.27.13.13.13.cmml">=</mo><mn mathsize="90%" id="S4.E4.m1.28.28.28.14.14.14" xref="S4.E4.m1.28.28.28.14.14.14.cmml">1</mn></mrow><mo mathsize="90%" id="S4.E4.m1.29.29.29.15.15.15">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E4.m1.32b"><apply id="S4.E4.m1.30.30.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.30.30.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E4.m1.30.30.1.1.1.1.1.cmml"><eq id="S4.E4.m1.3.3.3.3.3.3.cmml" xref="S4.E4.m1.3.3.3.3.3.3"></eq><apply id="S4.E4.m1.30.30.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.30.30.1.1.1.1.1.3.1.cmml">superscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1">𝑾</ci><times id="S4.E4.m1.2.2.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1"></times></apply><apply id="S4.E4.m1.30.30.1.1.1.1.1.1.cmml"><times id="S4.E4.m1.30.30.1.1.1.1.1.1.2.cmml"></times><apply id="S4.E4.m1.4.4.4.4.4.4.cmml" xref="S4.E4.m1.4.4.4.4.4.4"><apply id="S4.E4.m1.4.4.4.4.4.4.1.cmml" xref="S4.E4.m1.4.4.4.4.4.4.1"><in id="S4.E4.m1.4.4.4.4.4.4.1.1.cmml" xref="S4.E4.m1.4.4.4.4.4.4.1.1"></in><ci id="S4.E4.m1.4.4.4.4.4.4.1.2.cmml" xref="S4.E4.m1.4.4.4.4.4.4.1.2">𝑾</ci><apply id="S4.E4.m1.4.4.4.4.4.4.1.3.cmml" xref="S4.E4.m1.4.4.4.4.4.4.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.4.4.4.4.1.3.1.cmml" xref="S4.E4.m1.4.4.4.4.4.4.1.3">superscript</csymbol><ci id="S4.E4.m1.4.4.4.4.4.4.1.3.2.cmml" xref="S4.E4.m1.4.4.4.4.4.4.1.3.2">ℙ</ci><ci id="S4.E4.m1.4.4.4.4.4.4.1.3.3.cmml" xref="S4.E4.m1.4.4.4.4.4.4.1.3.3">𝑛</ci></apply></apply><ci id="S4.E4.m1.4.4.4.4.4.4.2.cmml" xref="S4.E4.m1.4.4.4.4.4.4.2">argmin</ci></apply><apply id="S4.E4.m1.30.30.1.1.1.1.1.1.1.1.1.cmml"><apply id="S4.E4.m1.30.30.1.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.30.30.1.1.1.1.1.1.1.1.1.1.1.cmml">subscript</csymbol><max id="S4.E4.m1.6.6.6.6.6.6.cmml" xref="S4.E4.m1.6.6.6.6.6.6"></max><apply id="S4.E4.m1.7.7.7.7.7.7.1.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1"><in id="S4.E4.m1.7.7.7.7.7.7.1.6.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.6"></in><apply id="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1"><neq id="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.1.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.1"></neq><list id="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.2.1.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.2.2"><ci id="S4.E4.m1.7.7.7.7.7.7.1.1.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.1">𝑖</ci><ci id="S4.E4.m1.7.7.7.7.7.7.1.2.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.2">𝑗</ci><ci id="S4.E4.m1.7.7.7.7.7.7.1.3.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.3">𝑖</ci></list><ci id="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.3.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.5.1.1.3">𝑗</ci></apply><apply id="S4.E4.m1.7.7.7.7.7.7.1.7.1.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.7.2"><csymbol cd="latexml" id="S4.E4.m1.7.7.7.7.7.7.1.7.1.1.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.7.2.1">delimited-[]</csymbol><ci id="S4.E4.m1.7.7.7.7.7.7.1.4.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1.4">𝐶</ci></apply></apply></apply><apply id="S4.E4.m1.30.30.1.1.1.1.1.1.1.1.1.2.cmml"><times id="S4.E4.m1.30.30.1.1.1.1.1.1.1.1.1.2.1.cmml"></times><apply id="S4.E4.m1.30.30.1.1.1.1.1.1.1.1.1.2.2.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.30.30.1.1.1.1.1.1.1.1.1.2.2.1.cmml">subscript</csymbol><ci id="S4.E4.m1.8.8.8.8.8.8.cmml" xref="S4.E4.m1.8.8.8.8.8.8">𝒘</ci><ci id="S4.E4.m1.9.9.9.9.9.9.1.cmml" xref="S4.E4.m1.9.9.9.9.9.9.1">𝑖</ci></apply><apply id="S4.E4.m1.30.30.1.1.1.1.1.1.1.1.1.2.3.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.30.30.1.1.1.1.1.1.1.1.1.2.3.1.cmml">superscript</csymbol><apply id="S4.E4.m1.30.30.1.1.1.1.1.1.1.1.1.2.3.2.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.30.30.1.1.1.1.1.1.1.1.1.2.3.2.1.cmml">subscript</csymbol><ci id="S4.E4.m1.10.10.10.10.10.10.cmml" xref="S4.E4.m1.10.10.10.10.10.10">𝒘</ci><ci id="S4.E4.m1.11.11.11.11.11.11.1.cmml" xref="S4.E4.m1.11.11.11.11.11.11.1">𝑗</ci></apply><csymbol cd="latexml" id="S4.E4.m1.12.12.12.12.12.12.1.cmml" xref="S4.E4.m1.12.12.12.12.12.12.1">top</csymbol></apply></apply></apply></apply></apply><apply id="S4.E4.m1.30.30.1.1.1.2.2.cmml"><and id="S4.E4.m1.30.30.1.1.1.2.2a.cmml"></and><apply id="S4.E4.m1.30.30.1.1.1.2.2b.cmml"><in id="S4.E4.m1.18.18.18.4.4.4.cmml" xref="S4.E4.m1.18.18.18.4.4.4"></in><apply id="S4.E4.m1.30.30.1.1.1.2.2.3.cmml"><times id="S4.E4.m1.30.30.1.1.1.2.2.3.1.cmml"></times><ci id="S4.E4.m1.15.15.15.1.1.1a.cmml" xref="S4.E4.m1.15.15.15.1.1.1"><mtext mathsize="90%" id="S4.E4.m1.15.15.15.1.1.1.cmml" xref="S4.E4.m1.15.15.15.1.1.1"> s.t. </mtext></ci><apply id="S4.E4.m1.30.30.1.1.1.2.2.3.3.cmml"><csymbol cd="latexml" id="S4.E4.m1.16.16.16.2.2.2.cmml" xref="S4.E4.m1.16.16.16.2.2.2">for-all</csymbol><ci id="S4.E4.m1.17.17.17.3.3.3.cmml" xref="S4.E4.m1.17.17.17.3.3.3">𝑖</ci></apply></apply><apply id="S4.E4.m1.30.30.1.1.1.2.2.1.cmml"><times id="S4.E4.m1.30.30.1.1.1.2.2.1.2.cmml"></times><apply id="S4.E4.m1.30.30.1.1.1.2.2.1.3.cmml"><csymbol cd="latexml" id="S4.E4.m1.30.30.1.1.1.2.2.1.3.1.cmml">delimited-[]</csymbol><ci id="S4.E4.m1.20.20.20.6.6.6.cmml" xref="S4.E4.m1.20.20.20.6.6.6">𝐶</ci></apply><apply id="S4.E4.m1.30.30.1.1.1.2.2.1.1.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.30.30.1.1.1.2.2.1.1.2.cmml">subscript</csymbol><apply id="S4.E4.m1.30.30.1.1.1.2.2.1.1.1.2.cmml"><csymbol cd="latexml" id="S4.E4.m1.30.30.1.1.1.2.2.1.1.1.2.1.cmml">delimited-∥∥</csymbol><apply id="S4.E4.m1.30.30.1.1.1.2.2.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E4.m1.30.30.1.1.1.2.2.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S4.E4.m1.23.23.23.9.9.9.cmml" xref="S4.E4.m1.23.23.23.9.9.9">𝒘</ci><ci id="S4.E4.m1.24.24.24.10.10.10.1.cmml" xref="S4.E4.m1.24.24.24.10.10.10.1">𝑖</ci></apply></apply><cn type="integer" id="S4.E4.m1.26.26.26.12.12.12.1.cmml" xref="S4.E4.m1.26.26.26.12.12.12.1">2</cn></apply></apply></apply><apply id="S4.E4.m1.30.30.1.1.1.2.2c.cmml"><eq id="S4.E4.m1.27.27.27.13.13.13.cmml" xref="S4.E4.m1.27.27.27.13.13.13"></eq><share href="#S4.E4.m1.30.30.1.1.1.2.2.1.cmml" id="S4.E4.m1.30.30.1.1.1.2.2d.cmml"></share><cn type="integer" id="S4.E4.m1.28.28.28.14.14.14.cmml" xref="S4.E4.m1.28.28.28.14.14.14">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.32c">\small\begin{gathered}\bm{W}^{*}=\underset{\bm{W}\in\mathbb{P}^{n}}{\operatorname{argmin}}\left(\max_{(i,j,i\neq j)\in[C]}\bm{w}_{i}{\bm{w}_{j}}^{\top}\right),\\
\text{ s.t. }\forall i\in[C]\quad\left\|\bm{w}_{i}\right\|_{2}=1,\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.SSS0.Px1.p2.10" class="ltx_p">where <math id="S4.SS3.SSS0.Px1.p2.4.m1.1" class="ltx_Math" alttext="\bm{w}_{i}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p2.4.m1.1a"><msub id="S4.SS3.SSS0.Px1.p2.4.m1.1.1" xref="S4.SS3.SSS0.Px1.p2.4.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.4.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p2.4.m1.1.1.2.cmml">𝒘</mi><mi id="S4.SS3.SSS0.Px1.p2.4.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p2.4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.4.m1.1b"><apply id="S4.SS3.SSS0.Px1.p2.4.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p2.4.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.4.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p2.4.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.4.m1.1.1.2">𝒘</ci><ci id="S4.SS3.SSS0.Px1.p2.4.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p2.4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.4.m1.1c">\bm{w}_{i}</annotation></semantics></math> (<math id="S4.SS3.SSS0.Px1.p2.5.m2.1" class="ltx_Math" alttext="\bm{w}_{j}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p2.5.m2.1a"><msub id="S4.SS3.SSS0.Px1.p2.5.m2.1.1" xref="S4.SS3.SSS0.Px1.p2.5.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.5.m2.1.1.2" xref="S4.SS3.SSS0.Px1.p2.5.m2.1.1.2.cmml">𝒘</mi><mi id="S4.SS3.SSS0.Px1.p2.5.m2.1.1.3" xref="S4.SS3.SSS0.Px1.p2.5.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.5.m2.1b"><apply id="S4.SS3.SSS0.Px1.p2.5.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p2.5.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.5.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p2.5.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.5.m2.1.1.2">𝒘</ci><ci id="S4.SS3.SSS0.Px1.p2.5.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p2.5.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.5.m2.1c">\bm{w}_{j}</annotation></semantics></math>) is the <math id="S4.SS3.SSS0.Px1.p2.6.m3.1" class="ltx_Math" alttext="i-" display="inline"><semantics id="S4.SS3.SSS0.Px1.p2.6.m3.1a"><mrow id="S4.SS3.SSS0.Px1.p2.6.m3.1.1" xref="S4.SS3.SSS0.Px1.p2.6.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.6.m3.1.1.2" xref="S4.SS3.SSS0.Px1.p2.6.m3.1.1.2.cmml">i</mi><mo id="S4.SS3.SSS0.Px1.p2.6.m3.1.1.3" xref="S4.SS3.SSS0.Px1.p2.6.m3.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.6.m3.1b"><apply id="S4.SS3.SSS0.Px1.p2.6.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.6.m3.1.1"><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.6.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.6.m3.1.1">limit-from</csymbol><ci id="S4.SS3.SSS0.Px1.p2.6.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.6.m3.1.1.2">𝑖</ci><minus id="S4.SS3.SSS0.Px1.p2.6.m3.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p2.6.m3.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.6.m3.1c">i-</annotation></semantics></math>th (<math id="S4.SS3.SSS0.Px1.p2.7.m4.1" class="ltx_Math" alttext="j-" display="inline"><semantics id="S4.SS3.SSS0.Px1.p2.7.m4.1a"><mrow id="S4.SS3.SSS0.Px1.p2.7.m4.1.1" xref="S4.SS3.SSS0.Px1.p2.7.m4.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.7.m4.1.1.2" xref="S4.SS3.SSS0.Px1.p2.7.m4.1.1.2.cmml">j</mi><mo id="S4.SS3.SSS0.Px1.p2.7.m4.1.1.3" xref="S4.SS3.SSS0.Px1.p2.7.m4.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.7.m4.1b"><apply id="S4.SS3.SSS0.Px1.p2.7.m4.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.7.m4.1.1"><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.7.m4.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.7.m4.1.1">limit-from</csymbol><ci id="S4.SS3.SSS0.Px1.p2.7.m4.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.7.m4.1.1.2">𝑗</ci><minus id="S4.SS3.SSS0.Px1.p2.7.m4.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p2.7.m4.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.7.m4.1c">j-</annotation></semantics></math>th) row of <math id="S4.SS3.SSS0.Px1.p2.8.m5.1" class="ltx_Math" alttext="\bm{W}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p2.8.m5.1a"><mi id="S4.SS3.SSS0.Px1.p2.8.m5.1.1" xref="S4.SS3.SSS0.Px1.p2.8.m5.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.8.m5.1b"><ci id="S4.SS3.SSS0.Px1.p2.8.m5.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.8.m5.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.8.m5.1c">\bm{W}</annotation></semantics></math> representing as the <math id="S4.SS3.SSS0.Px1.p2.9.m6.1" class="ltx_Math" alttext="i-" display="inline"><semantics id="S4.SS3.SSS0.Px1.p2.9.m6.1a"><mrow id="S4.SS3.SSS0.Px1.p2.9.m6.1.1" xref="S4.SS3.SSS0.Px1.p2.9.m6.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.9.m6.1.1.2" xref="S4.SS3.SSS0.Px1.p2.9.m6.1.1.2.cmml">i</mi><mo id="S4.SS3.SSS0.Px1.p2.9.m6.1.1.3" xref="S4.SS3.SSS0.Px1.p2.9.m6.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.9.m6.1b"><apply id="S4.SS3.SSS0.Px1.p2.9.m6.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.9.m6.1.1"><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.9.m6.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.9.m6.1.1">limit-from</csymbol><ci id="S4.SS3.SSS0.Px1.p2.9.m6.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.9.m6.1.1.2">𝑖</ci><minus id="S4.SS3.SSS0.Px1.p2.9.m6.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p2.9.m6.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.9.m6.1c">i-</annotation></semantics></math>th (<math id="S4.SS3.SSS0.Px1.p2.10.m7.1" class="ltx_Math" alttext="j-" display="inline"><semantics id="S4.SS3.SSS0.Px1.p2.10.m7.1a"><mrow id="S4.SS3.SSS0.Px1.p2.10.m7.1.1" xref="S4.SS3.SSS0.Px1.p2.10.m7.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p2.10.m7.1.1.2" xref="S4.SS3.SSS0.Px1.p2.10.m7.1.1.2.cmml">j</mi><mo id="S4.SS3.SSS0.Px1.p2.10.m7.1.1.3" xref="S4.SS3.SSS0.Px1.p2.10.m7.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.10.m7.1b"><apply id="S4.SS3.SSS0.Px1.p2.10.m7.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.10.m7.1.1"><csymbol cd="latexml" id="S4.SS3.SSS0.Px1.p2.10.m7.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.10.m7.1.1">limit-from</csymbol><ci id="S4.SS3.SSS0.Px1.p2.10.m7.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p2.10.m7.1.1.2">𝑗</ci><minus id="S4.SS3.SSS0.Px1.p2.10.m7.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p2.10.m7.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.10.m7.1c">j-</annotation></semantics></math>th) class prototype.
We choose cosine similarity to measure this distance,
because Poincaré ball model space is conformal to the Euclidean space <cite class="ltx_cite ltx_citemacro_cite">Ganea <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib13" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="S4.SS3.SSS0.Px1.p3" class="ltx_para">
<p id="S4.SS3.SSS0.Px1.p3.1" class="ltx_p">Optimizing Eq. (<a href="#S4.E4" title="In Motivation. ‣ 4.3 Hyperbolic Prototype Tammes Initialization ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) requires computing pairwise similarity of class prototypes iteratively, which is inefficient.
To mitigate it, we utilize the similarity of Poinecaré ball and hyper-sphere to follow <cite class="ltx_cite ltx_citemacro_cite">Mettes <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib35" title="" class="ltx_ref">2019</a>)</cite>, and minimize the largest cosine similarity for each prototype in the form of matrix, thus accelerating the optimization:</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.39" class="ltx_Math" alttext="\small\begin{gathered}\mathbf{L}_{P}=\frac{1}{C}\Sigma_{i=1}^{C}\max_{j\in[C]}\mathbf{M}_{ij},\mathbf{M}=\bm{W}\bm{W}^{T}-2\mathbf{I},\\
\text{ s.t. }\forall i\in[C]\quad\left\|\bm{w}_{i}\right\|_{2}=1.\end{gathered}" display="block"><semantics id="S4.E5.m1.39a"><mtable displaystyle="true" rowspacing="0pt" id="S4.E5.m1.39.39.3"><mtr id="S4.E5.m1.39.39.3a"><mtd id="S4.E5.m1.39.39.3b"><mrow id="S4.E5.m1.38.38.2.37.22.22.22"><mrow id="S4.E5.m1.38.38.2.37.22.22.22.1"><mrow id="S4.E5.m1.38.38.2.37.22.22.22.1.1.1"><msub id="S4.E5.m1.38.38.2.37.22.22.22.1.1.1.1"><mi mathsize="90%" id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml">𝐋</mi><mi mathsize="90%" id="S4.E5.m1.2.2.2.2.2.2.1" xref="S4.E5.m1.2.2.2.2.2.2.1.cmml">P</mi></msub><mo mathsize="90%" id="S4.E5.m1.3.3.3.3.3.3" xref="S4.E5.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E5.m1.38.38.2.37.22.22.22.1.1.1.2"><mfrac id="S4.E5.m1.4.4.4.4.4.4" xref="S4.E5.m1.4.4.4.4.4.4.cmml"><mn mathsize="90%" id="S4.E5.m1.4.4.4.4.4.4.2" xref="S4.E5.m1.4.4.4.4.4.4.2.cmml">1</mn><mi mathsize="90%" id="S4.E5.m1.4.4.4.4.4.4.3" xref="S4.E5.m1.4.4.4.4.4.4.3.cmml">C</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E5.m1.38.38.2.37.22.22.22.1.1.1.2.1">​</mo><msubsup id="S4.E5.m1.38.38.2.37.22.22.22.1.1.1.2.2"><mi mathsize="90%" mathvariant="normal" id="S4.E5.m1.5.5.5.5.5.5" xref="S4.E5.m1.5.5.5.5.5.5.cmml">Σ</mi><mrow id="S4.E5.m1.6.6.6.6.6.6.1" xref="S4.E5.m1.6.6.6.6.6.6.1.cmml"><mi mathsize="90%" id="S4.E5.m1.6.6.6.6.6.6.1.2" xref="S4.E5.m1.6.6.6.6.6.6.1.2.cmml">i</mi><mo mathsize="90%" id="S4.E5.m1.6.6.6.6.6.6.1.1" xref="S4.E5.m1.6.6.6.6.6.6.1.1.cmml">=</mo><mn mathsize="90%" id="S4.E5.m1.6.6.6.6.6.6.1.3" xref="S4.E5.m1.6.6.6.6.6.6.1.3.cmml">1</mn></mrow><mi mathsize="90%" id="S4.E5.m1.7.7.7.7.7.7.1" xref="S4.E5.m1.7.7.7.7.7.7.1.cmml">C</mi></msubsup><mo lspace="0.167em" rspace="0em" id="S4.E5.m1.38.38.2.37.22.22.22.1.1.1.2.1a">​</mo><mrow id="S4.E5.m1.38.38.2.37.22.22.22.1.1.1.2.3"><munder id="S4.E5.m1.38.38.2.37.22.22.22.1.1.1.2.3.1"><mi mathsize="90%" id="S4.E5.m1.8.8.8.8.8.8" xref="S4.E5.m1.8.8.8.8.8.8.cmml">max</mi><mrow id="S4.E5.m1.9.9.9.9.9.9.1" xref="S4.E5.m1.9.9.9.9.9.9.1.cmml"><mi mathsize="90%" id="S4.E5.m1.9.9.9.9.9.9.1.3" xref="S4.E5.m1.9.9.9.9.9.9.1.3.cmml">j</mi><mo mathsize="90%" id="S4.E5.m1.9.9.9.9.9.9.1.2" xref="S4.E5.m1.9.9.9.9.9.9.1.2.cmml">∈</mo><mrow id="S4.E5.m1.9.9.9.9.9.9.1.4.2" xref="S4.E5.m1.9.9.9.9.9.9.1.4.1.cmml"><mo maxsize="90%" minsize="90%" id="S4.E5.m1.9.9.9.9.9.9.1.4.2.1" xref="S4.E5.m1.9.9.9.9.9.9.1.4.1.1.cmml">[</mo><mi mathsize="90%" id="S4.E5.m1.9.9.9.9.9.9.1.1" xref="S4.E5.m1.9.9.9.9.9.9.1.1.cmml">C</mi><mo maxsize="90%" minsize="90%" id="S4.E5.m1.9.9.9.9.9.9.1.4.2.2" xref="S4.E5.m1.9.9.9.9.9.9.1.4.1.1.cmml">]</mo></mrow></mrow></munder><mo lspace="0.167em" id="S4.E5.m1.38.38.2.37.22.22.22.1.1.1.2.3a">⁡</mo><msub id="S4.E5.m1.38.38.2.37.22.22.22.1.1.1.2.3.2"><mi mathsize="90%" id="S4.E5.m1.10.10.10.10.10.10" xref="S4.E5.m1.10.10.10.10.10.10.cmml">𝐌</mi><mrow id="S4.E5.m1.11.11.11.11.11.11.1" xref="S4.E5.m1.11.11.11.11.11.11.1.cmml"><mi mathsize="90%" id="S4.E5.m1.11.11.11.11.11.11.1.2" xref="S4.E5.m1.11.11.11.11.11.11.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.11.11.11.11.11.11.1.1" xref="S4.E5.m1.11.11.11.11.11.11.1.1.cmml">​</mo><mi mathsize="90%" id="S4.E5.m1.11.11.11.11.11.11.1.3" xref="S4.E5.m1.11.11.11.11.11.11.1.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo mathsize="90%" id="S4.E5.m1.12.12.12.12.12.12">,</mo><mrow id="S4.E5.m1.38.38.2.37.22.22.22.1.2.2"><mi mathsize="90%" id="S4.E5.m1.13.13.13.13.13.13" xref="S4.E5.m1.13.13.13.13.13.13.cmml">𝐌</mi><mo mathsize="90%" id="S4.E5.m1.14.14.14.14.14.14" xref="S4.E5.m1.14.14.14.14.14.14.cmml">=</mo><mrow id="S4.E5.m1.38.38.2.37.22.22.22.1.2.2.1"><mrow id="S4.E5.m1.38.38.2.37.22.22.22.1.2.2.1.1"><mi mathsize="90%" id="S4.E5.m1.15.15.15.15.15.15" xref="S4.E5.m1.15.15.15.15.15.15.cmml">𝑾</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.38.38.2.37.22.22.22.1.2.2.1.1.1">​</mo><msup id="S4.E5.m1.38.38.2.37.22.22.22.1.2.2.1.1.2"><mi mathsize="90%" id="S4.E5.m1.16.16.16.16.16.16" xref="S4.E5.m1.16.16.16.16.16.16.cmml">𝑾</mi><mi mathsize="90%" id="S4.E5.m1.17.17.17.17.17.17.1" xref="S4.E5.m1.17.17.17.17.17.17.1.cmml">T</mi></msup></mrow><mo mathsize="90%" id="S4.E5.m1.18.18.18.18.18.18" xref="S4.E5.m1.18.18.18.18.18.18.cmml">−</mo><mrow id="S4.E5.m1.38.38.2.37.22.22.22.1.2.2.1.2"><mn mathsize="90%" id="S4.E5.m1.19.19.19.19.19.19" xref="S4.E5.m1.19.19.19.19.19.19.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.E5.m1.38.38.2.37.22.22.22.1.2.2.1.2.1">​</mo><mi mathsize="90%" id="S4.E5.m1.20.20.20.20.20.20" xref="S4.E5.m1.20.20.20.20.20.20.cmml">𝐈</mi></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S4.E5.m1.21.21.21.21.21.21">,</mo></mrow></mtd></mtr><mtr id="S4.E5.m1.39.39.3c"><mtd id="S4.E5.m1.39.39.3d"><mrow id="S4.E5.m1.39.39.3.38.16.16.16"><mrow id="S4.E5.m1.39.39.3.38.16.16.16.1"><mrow id="S4.E5.m1.39.39.3.38.16.16.16.1.3"><mtext mathsize="90%" id="S4.E5.m1.22.22.22.1.1.1" xref="S4.E5.m1.22.22.22.1.1.1a.cmml"> s.t. </mtext><mo lspace="0.167em" rspace="0em" id="S4.E5.m1.39.39.3.38.16.16.16.1.3.1">​</mo><mrow id="S4.E5.m1.39.39.3.38.16.16.16.1.3.2"><mo mathsize="90%" rspace="0.167em" id="S4.E5.m1.23.23.23.2.2.2" xref="S4.E5.m1.23.23.23.2.2.2.cmml">∀</mo><mi mathsize="90%" id="S4.E5.m1.24.24.24.3.3.3" xref="S4.E5.m1.24.24.24.3.3.3.cmml">i</mi></mrow></mrow><mo mathsize="90%" id="S4.E5.m1.25.25.25.4.4.4" xref="S4.E5.m1.25.25.25.4.4.4.cmml">∈</mo><mrow id="S4.E5.m1.39.39.3.38.16.16.16.1.1"><mrow id="S4.E5.m1.39.39.3.38.16.16.16.1.1.3"><mo maxsize="90%" minsize="90%" id="S4.E5.m1.26.26.26.5.5.5">[</mo><mi mathsize="90%" id="S4.E5.m1.27.27.27.6.6.6" xref="S4.E5.m1.27.27.27.6.6.6.cmml">C</mi><mo maxsize="90%" minsize="90%" id="S4.E5.m1.28.28.28.7.7.7">]</mo></mrow><mo lspace="0.900em" rspace="0em" id="S4.E5.m1.39.39.3.38.16.16.16.1.1.2">​</mo><msub id="S4.E5.m1.39.39.3.38.16.16.16.1.1.1"><mrow id="S4.E5.m1.39.39.3.38.16.16.16.1.1.1.1.1"><mo id="S4.E5.m1.29.29.29.8.8.8">‖</mo><msub id="S4.E5.m1.39.39.3.38.16.16.16.1.1.1.1.1.1"><mi mathsize="90%" id="S4.E5.m1.30.30.30.9.9.9" xref="S4.E5.m1.30.30.30.9.9.9.cmml">𝒘</mi><mi mathsize="90%" id="S4.E5.m1.31.31.31.10.10.10.1" xref="S4.E5.m1.31.31.31.10.10.10.1.cmml">i</mi></msub><mo id="S4.E5.m1.32.32.32.11.11.11">‖</mo></mrow><mn mathsize="90%" id="S4.E5.m1.33.33.33.12.12.12.1" xref="S4.E5.m1.33.33.33.12.12.12.1.cmml">2</mn></msub></mrow><mo mathsize="90%" id="S4.E5.m1.34.34.34.13.13.13" xref="S4.E5.m1.34.34.34.13.13.13.cmml">=</mo><mn mathsize="90%" id="S4.E5.m1.35.35.35.14.14.14" xref="S4.E5.m1.35.35.35.14.14.14.cmml">1</mn></mrow><mo lspace="0em" mathsize="90%" id="S4.E5.m1.36.36.36.15.15.15">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E5.m1.39b"><apply id="S4.E5.m1.37.37.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.37.37.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S4.E5.m1.37.37.1.1.1.1.1.cmml"><eq id="S4.E5.m1.3.3.3.3.3.3.cmml" xref="S4.E5.m1.3.3.3.3.3.3"></eq><apply id="S4.E5.m1.37.37.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.37.37.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1">𝐋</ci><ci id="S4.E5.m1.2.2.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.2.2.2.1">𝑃</ci></apply><apply id="S4.E5.m1.37.37.1.1.1.1.1.3.cmml"><times id="S4.E5.m1.37.37.1.1.1.1.1.3.1.cmml"></times><apply id="S4.E5.m1.4.4.4.4.4.4.cmml" xref="S4.E5.m1.4.4.4.4.4.4"><divide id="S4.E5.m1.4.4.4.4.4.4.1.cmml" xref="S4.E5.m1.4.4.4.4.4.4"></divide><cn type="integer" id="S4.E5.m1.4.4.4.4.4.4.2.cmml" xref="S4.E5.m1.4.4.4.4.4.4.2">1</cn><ci id="S4.E5.m1.4.4.4.4.4.4.3.cmml" xref="S4.E5.m1.4.4.4.4.4.4.3">𝐶</ci></apply><apply id="S4.E5.m1.37.37.1.1.1.1.1.3.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.37.37.1.1.1.1.1.3.3.1.cmml">superscript</csymbol><apply id="S4.E5.m1.37.37.1.1.1.1.1.3.3.2.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.37.37.1.1.1.1.1.3.3.2.1.cmml">subscript</csymbol><ci id="S4.E5.m1.5.5.5.5.5.5.cmml" xref="S4.E5.m1.5.5.5.5.5.5">Σ</ci><apply id="S4.E5.m1.6.6.6.6.6.6.1.cmml" xref="S4.E5.m1.6.6.6.6.6.6.1"><eq id="S4.E5.m1.6.6.6.6.6.6.1.1.cmml" xref="S4.E5.m1.6.6.6.6.6.6.1.1"></eq><ci id="S4.E5.m1.6.6.6.6.6.6.1.2.cmml" xref="S4.E5.m1.6.6.6.6.6.6.1.2">𝑖</ci><cn type="integer" id="S4.E5.m1.6.6.6.6.6.6.1.3.cmml" xref="S4.E5.m1.6.6.6.6.6.6.1.3">1</cn></apply></apply><ci id="S4.E5.m1.7.7.7.7.7.7.1.cmml" xref="S4.E5.m1.7.7.7.7.7.7.1">𝐶</ci></apply><apply id="S4.E5.m1.37.37.1.1.1.1.1.3.4.cmml"><apply id="S4.E5.m1.37.37.1.1.1.1.1.3.4.1.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.37.37.1.1.1.1.1.3.4.1.1.cmml">subscript</csymbol><max id="S4.E5.m1.8.8.8.8.8.8.cmml" xref="S4.E5.m1.8.8.8.8.8.8"></max><apply id="S4.E5.m1.9.9.9.9.9.9.1.cmml" xref="S4.E5.m1.9.9.9.9.9.9.1"><in id="S4.E5.m1.9.9.9.9.9.9.1.2.cmml" xref="S4.E5.m1.9.9.9.9.9.9.1.2"></in><ci id="S4.E5.m1.9.9.9.9.9.9.1.3.cmml" xref="S4.E5.m1.9.9.9.9.9.9.1.3">𝑗</ci><apply id="S4.E5.m1.9.9.9.9.9.9.1.4.1.cmml" xref="S4.E5.m1.9.9.9.9.9.9.1.4.2"><csymbol cd="latexml" id="S4.E5.m1.9.9.9.9.9.9.1.4.1.1.cmml" xref="S4.E5.m1.9.9.9.9.9.9.1.4.2.1">delimited-[]</csymbol><ci id="S4.E5.m1.9.9.9.9.9.9.1.1.cmml" xref="S4.E5.m1.9.9.9.9.9.9.1.1">𝐶</ci></apply></apply></apply><apply id="S4.E5.m1.37.37.1.1.1.1.1.3.4.2.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.37.37.1.1.1.1.1.3.4.2.1.cmml">subscript</csymbol><ci id="S4.E5.m1.10.10.10.10.10.10.cmml" xref="S4.E5.m1.10.10.10.10.10.10">𝐌</ci><apply id="S4.E5.m1.11.11.11.11.11.11.1.cmml" xref="S4.E5.m1.11.11.11.11.11.11.1"><times id="S4.E5.m1.11.11.11.11.11.11.1.1.cmml" xref="S4.E5.m1.11.11.11.11.11.11.1.1"></times><ci id="S4.E5.m1.11.11.11.11.11.11.1.2.cmml" xref="S4.E5.m1.11.11.11.11.11.11.1.2">𝑖</ci><ci id="S4.E5.m1.11.11.11.11.11.11.1.3.cmml" xref="S4.E5.m1.11.11.11.11.11.11.1.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S4.E5.m1.37.37.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.37.37.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S4.E5.m1.37.37.1.1.1.2.2.1.1.cmml"><eq id="S4.E5.m1.14.14.14.14.14.14.cmml" xref="S4.E5.m1.14.14.14.14.14.14"></eq><ci id="S4.E5.m1.13.13.13.13.13.13.cmml" xref="S4.E5.m1.13.13.13.13.13.13">𝐌</ci><apply id="S4.E5.m1.37.37.1.1.1.2.2.1.1.3.cmml"><minus id="S4.E5.m1.18.18.18.18.18.18.cmml" xref="S4.E5.m1.18.18.18.18.18.18"></minus><apply id="S4.E5.m1.37.37.1.1.1.2.2.1.1.3.2.cmml"><times id="S4.E5.m1.37.37.1.1.1.2.2.1.1.3.2.1.cmml"></times><ci id="S4.E5.m1.15.15.15.15.15.15.cmml" xref="S4.E5.m1.15.15.15.15.15.15">𝑾</ci><apply id="S4.E5.m1.37.37.1.1.1.2.2.1.1.3.2.3.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.37.37.1.1.1.2.2.1.1.3.2.3.1.cmml">superscript</csymbol><ci id="S4.E5.m1.16.16.16.16.16.16.cmml" xref="S4.E5.m1.16.16.16.16.16.16">𝑾</ci><ci id="S4.E5.m1.17.17.17.17.17.17.1.cmml" xref="S4.E5.m1.17.17.17.17.17.17.1">𝑇</ci></apply></apply><apply id="S4.E5.m1.37.37.1.1.1.2.2.1.1.3.3.cmml"><times id="S4.E5.m1.37.37.1.1.1.2.2.1.1.3.3.1.cmml"></times><cn type="integer" id="S4.E5.m1.19.19.19.19.19.19.cmml" xref="S4.E5.m1.19.19.19.19.19.19">2</cn><ci id="S4.E5.m1.20.20.20.20.20.20.cmml" xref="S4.E5.m1.20.20.20.20.20.20">𝐈</ci></apply></apply></apply><apply id="S4.E5.m1.37.37.1.1.1.2.2.2.2.cmml"><and id="S4.E5.m1.37.37.1.1.1.2.2.2.2a.cmml"></and><apply id="S4.E5.m1.37.37.1.1.1.2.2.2.2b.cmml"><in id="S4.E5.m1.25.25.25.4.4.4.cmml" xref="S4.E5.m1.25.25.25.4.4.4"></in><apply id="S4.E5.m1.37.37.1.1.1.2.2.2.2.3.cmml"><times id="S4.E5.m1.37.37.1.1.1.2.2.2.2.3.1.cmml"></times><ci id="S4.E5.m1.22.22.22.1.1.1a.cmml" xref="S4.E5.m1.22.22.22.1.1.1"><mtext mathsize="90%" id="S4.E5.m1.22.22.22.1.1.1.cmml" xref="S4.E5.m1.22.22.22.1.1.1"> s.t. </mtext></ci><apply id="S4.E5.m1.37.37.1.1.1.2.2.2.2.3.3.cmml"><csymbol cd="latexml" id="S4.E5.m1.23.23.23.2.2.2.cmml" xref="S4.E5.m1.23.23.23.2.2.2">for-all</csymbol><ci id="S4.E5.m1.24.24.24.3.3.3.cmml" xref="S4.E5.m1.24.24.24.3.3.3">𝑖</ci></apply></apply><apply id="S4.E5.m1.37.37.1.1.1.2.2.2.2.1.cmml"><times id="S4.E5.m1.37.37.1.1.1.2.2.2.2.1.2.cmml"></times><apply id="S4.E5.m1.37.37.1.1.1.2.2.2.2.1.3.cmml"><csymbol cd="latexml" id="S4.E5.m1.37.37.1.1.1.2.2.2.2.1.3.1.cmml">delimited-[]</csymbol><ci id="S4.E5.m1.27.27.27.6.6.6.cmml" xref="S4.E5.m1.27.27.27.6.6.6">𝐶</ci></apply><apply id="S4.E5.m1.37.37.1.1.1.2.2.2.2.1.1.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.37.37.1.1.1.2.2.2.2.1.1.2.cmml">subscript</csymbol><apply id="S4.E5.m1.37.37.1.1.1.2.2.2.2.1.1.1.2.cmml"><csymbol cd="latexml" id="S4.E5.m1.37.37.1.1.1.2.2.2.2.1.1.1.2.1.cmml">delimited-∥∥</csymbol><apply id="S4.E5.m1.37.37.1.1.1.2.2.2.2.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S4.E5.m1.37.37.1.1.1.2.2.2.2.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S4.E5.m1.30.30.30.9.9.9.cmml" xref="S4.E5.m1.30.30.30.9.9.9">𝒘</ci><ci id="S4.E5.m1.31.31.31.10.10.10.1.cmml" xref="S4.E5.m1.31.31.31.10.10.10.1">𝑖</ci></apply></apply><cn type="integer" id="S4.E5.m1.33.33.33.12.12.12.1.cmml" xref="S4.E5.m1.33.33.33.12.12.12.1">2</cn></apply></apply></apply><apply id="S4.E5.m1.37.37.1.1.1.2.2.2.2c.cmml"><eq id="S4.E5.m1.34.34.34.13.13.13.cmml" xref="S4.E5.m1.34.34.34.13.13.13"></eq><share href="#S4.E5.m1.37.37.1.1.1.2.2.2.2.1.cmml" id="S4.E5.m1.37.37.1.1.1.2.2.2.2d.cmml"></share><cn type="integer" id="S4.E5.m1.35.35.35.14.14.14.cmml" xref="S4.E5.m1.35.35.35.14.14.14">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.39c">\small\begin{gathered}\mathbf{L}_{P}=\frac{1}{C}\Sigma_{i=1}^{C}\max_{j\in[C]}\mathbf{M}_{ij},\mathbf{M}=\bm{W}\bm{W}^{T}-2\mathbf{I},\\
\text{ s.t. }\forall i\in[C]\quad\left\|\bm{w}_{i}\right\|_{2}=1.\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.SSS0.Px1.p4" class="ltx_para">
<p id="S4.SS3.SSS0.Px1.p4.3" class="ltx_p">Next, we find the position to fix the hyperbolic class prototypes.
As Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(b) shows, in Poincaré ball model, the closer the distance from the referred origin to the node, the more general the semantic information of node represents <cite class="ltx_cite ltx_citemacro_cite">Liu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite>.
But the uniformly distributed class prototypes are initially positioned on the boundary of the Poincaré ball, which is against the distribution of hierarchical structure in Poincaré ball.
In order to enjoy the benefits of uniformity and generality simultaneously, we contract the class prototypes along with the radius to the origin <math id="S4.SS3.SSS0.Px1.p4.1.m1.1" class="ltx_Math" alttext="\bm{o}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p4.1.m1.1a"><mi id="S4.SS3.SSS0.Px1.p4.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p4.1.m1.1.1.cmml">𝒐</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p4.1.m1.1b"><ci id="S4.SS3.SSS0.Px1.p4.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p4.1.m1.1.1">𝒐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p4.1.m1.1c">\bm{o}</annotation></semantics></math> by a slope degree <math id="S4.SS3.SSS0.Px1.p4.2.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS3.SSS0.Px1.p4.2.m2.1a"><mi id="S4.SS3.SSS0.Px1.p4.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p4.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p4.2.m2.1b"><ci id="S4.SS3.SSS0.Px1.p4.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p4.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p4.2.m2.1c">s</annotation></semantics></math>, i.e., <math id="S4.SS3.SSS0.Px1.p4.3.m3.1" class="ltx_Math" alttext="\bm{W}_{\mathbb{P}}=s\bm{W}^{*}\in\mathbb{R}^{C\times n}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p4.3.m3.1a"><mrow id="S4.SS3.SSS0.Px1.p4.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.cmml"><msub id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2.2" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2.2.cmml">𝑾</mi><mi id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2.3" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2.3.cmml">ℙ</mi></msub><mo id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.3" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.3.cmml">=</mo><mrow id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.cmml"><mi id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.2" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.1" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.1.cmml">​</mo><msup id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3.cmml"><mi id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3.2" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3.2.cmml">𝑾</mi><mo id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3.3" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3.3.cmml">∗</mo></msup></mrow><mo id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.5" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.5.cmml">∈</mo><msup id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.cmml"><mi id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.2" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.2.cmml">ℝ</mi><mrow id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.cmml"><mi id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.2" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.2.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.1" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.1.cmml">×</mo><mi id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.3" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p4.3.m3.1b"><apply id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1"><and id="S4.SS3.SSS0.Px1.p4.3.m3.1.1a.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1"></and><apply id="S4.SS3.SSS0.Px1.p4.3.m3.1.1b.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1"><eq id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.3"></eq><apply id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2.2">𝑾</ci><ci id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.2.3">ℙ</ci></apply><apply id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4"><times id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.1.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.1"></times><ci id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.2.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.2">𝑠</ci><apply id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3.1.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3">superscript</csymbol><ci id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3.2.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3.2">𝑾</ci><times id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3.3.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.3.3"></times></apply></apply></apply><apply id="S4.SS3.SSS0.Px1.p4.3.m3.1.1c.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1"><in id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.5.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.5"></in><share href="#S4.SS3.SSS0.Px1.p4.3.m3.1.1.4.cmml" id="S4.SS3.SSS0.Px1.p4.3.m3.1.1d.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1"></share><apply id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.1.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6">superscript</csymbol><ci id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.2.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.2">ℝ</ci><apply id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3"><times id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.1.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.1"></times><ci id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.2.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.2">𝐶</ci><ci id="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.3.cmml" xref="S4.SS3.SSS0.Px1.p4.3.m3.1.1.6.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p4.3.m3.1c">\bm{W}_{\mathbb{P}}=s\bm{W}^{*}\in\mathbb{R}^{C\times n}</annotation></semantics></math>.
Lastly, HPTI shares and fixes the Poincaré ball model to clients, which encourages local clients to model local data sufficiently with the supervision of consistent and separated hyperbolic prototypes.</p>
</div>
</section>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Hyperbolic Prototype Learning</h3>

<section id="S4.SS4.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Motivation.</h4>

<div id="S4.SS4.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS4.SSS0.Px1.p1.1" class="ltx_p">In this part, we provide the details of HPL, which utilizes the hierarchical information inherent in data to obtain fine-grained and gathered data representations.
To utilize the hierarchical information of data, HPL uses Poincaré ball model for the benefits of continuous optimization and effective representation in low-dimensional space.
To start with, HPL extracts the feature for data samples and applies an exponential map referred by the origin shared with class prototypes.
According to the supervision of shared class prototypes in hyperbolic space, HPL next represents the data features of the same class according to hyperbolic triplet loss.</p>
</div>
<div id="S4.SS4.SSS0.Px1.p2" class="ltx_para">
<p id="S4.SS4.SSS0.Px1.p2.11" class="ltx_p">In the following, we present how to model the hyperbolic representations of data samples for each client <math id="S4.SS4.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS4.SSS0.Px1.p2.1.m1.1a"><mi id="S4.SS4.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.1.m1.1b"><ci id="S4.SS4.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.1.m1.1c">k</annotation></semantics></math> locally.
Specifically, we expect to learn a projection of local data <math id="S4.SS4.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p2.2.m2.1a"><msub id="S4.SS4.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.cmml">𝒟</mi><mi id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.3" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.2.m2.1b"><apply id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.2">𝒟</ci><ci id="S4.SS4.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S4.SS4.SSS0.Px1.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.2.m2.1c">\mathcal{D}_{k}</annotation></semantics></math> to the local Poincaré ball model, i.e., <math id="S4.SS4.SSS0.Px1.p2.3.m3.1" class="ltx_Math" alttext="\mathbb{P}^{n}_{k}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p2.3.m3.1a"><msubsup id="S4.SS4.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p2.3.m3.1.1.2.2" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1.2.2.cmml">ℙ</mi><mi id="S4.SS4.SSS0.Px1.p2.3.m3.1.1.3" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1.3.cmml">k</mi><mi id="S4.SS4.SSS0.Px1.p2.3.m3.1.1.2.3" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.3.m3.1b"><apply id="S4.SS4.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1">subscript</csymbol><apply id="S4.SS4.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.3.m3.1.1.2.1.cmml" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS4.SSS0.Px1.p2.3.m3.1.1.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1.2.2">ℙ</ci><ci id="S4.SS4.SSS0.Px1.p2.3.m3.1.1.2.3.cmml" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1.2.3">𝑛</ci></apply><ci id="S4.SS4.SSS0.Px1.p2.3.m3.1.1.3.cmml" xref="S4.SS4.SSS0.Px1.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.3.m3.1c">\mathbb{P}^{n}_{k}</annotation></semantics></math>, in which we compute the similarity between data samples and class prototypes for each client.
As introduced in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.1 Problem Statement ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we take a feature extractor <math id="S4.SS4.SSS0.Px1.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{F}_{\bm{\theta}_{k}}(\cdot)" display="inline"><semantics id="S4.SS4.SSS0.Px1.p2.4.m4.1a"><mrow id="S4.SS4.SSS0.Px1.p2.4.m4.1.2" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.cmml"><msub id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.2" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.2.cmml">ℱ</mi><msub id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3.cmml"><mi id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3.2" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3.2.cmml">𝜽</mi><mi id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3.3" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.1" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.1.cmml">​</mo><mrow id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.3.2" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.3.2.1" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS4.SSS0.Px1.p2.4.m4.1.1" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.3.2.2" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.4.m4.1b"><apply id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.cmml" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2"><times id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.1.cmml" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.1"></times><apply id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.1.cmml" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2">subscript</csymbol><ci id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.2">ℱ</ci><apply id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3.cmml" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3.2.cmml" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3.2">𝜽</ci><ci id="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3.3.cmml" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.2.2.3.3">𝑘</ci></apply></apply><ci id="S4.SS4.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.4.m4.1c">\mathcal{F}_{\bm{\theta}_{k}}(\cdot)</annotation></semantics></math> in Euclidean space to obtain the feature representations of local data samples, i.e., <math id="S4.SS4.SSS0.Px1.p2.5.m5.1" class="ltx_Math" alttext="\bm{z}=\mathcal{F}_{\bm{\theta}_{k}}(\bm{x})" display="inline"><semantics id="S4.SS4.SSS0.Px1.p2.5.m5.1a"><mrow id="S4.SS4.SSS0.Px1.p2.5.m5.1.2" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.cmml"><mi id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.2" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.2.cmml">𝒛</mi><mo id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.1" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.1.cmml">=</mo><mrow id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.cmml"><msub id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.2" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.2.cmml">ℱ</mi><msub id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3.cmml"><mi id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3.2" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3.2.cmml">𝜽</mi><mi id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3.3" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.1" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.1.cmml">​</mo><mrow id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.3.2" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.cmml"><mo stretchy="false" id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.3.2.1" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.cmml">(</mo><mi id="S4.SS4.SSS0.Px1.p2.5.m5.1.1" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.1.cmml">𝒙</mi><mo stretchy="false" id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.3.2.2" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.5.m5.1b"><apply id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2"><eq id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.1.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.1"></eq><ci id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.2">𝒛</ci><apply id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3"><times id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.1"></times><apply id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.1.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2">subscript</csymbol><ci id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.2">ℱ</ci><apply id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3.2.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3.2">𝜽</ci><ci id="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3.3.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.2.3.2.3.3">𝑘</ci></apply></apply><ci id="S4.SS4.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.5.m5.1.1">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.5.m5.1c">\bm{z}=\mathcal{F}_{\bm{\theta}_{k}}(\bm{x})</annotation></semantics></math> for an instance pair <math id="S4.SS4.SSS0.Px1.p2.6.m6.2" class="ltx_Math" alttext="(\bm{x},y)" display="inline"><semantics id="S4.SS4.SSS0.Px1.p2.6.m6.2a"><mrow id="S4.SS4.SSS0.Px1.p2.6.m6.2.3.2" xref="S4.SS4.SSS0.Px1.p2.6.m6.2.3.1.cmml"><mo stretchy="false" id="S4.SS4.SSS0.Px1.p2.6.m6.2.3.2.1" xref="S4.SS4.SSS0.Px1.p2.6.m6.2.3.1.cmml">(</mo><mi id="S4.SS4.SSS0.Px1.p2.6.m6.1.1" xref="S4.SS4.SSS0.Px1.p2.6.m6.1.1.cmml">𝒙</mi><mo id="S4.SS4.SSS0.Px1.p2.6.m6.2.3.2.2" xref="S4.SS4.SSS0.Px1.p2.6.m6.2.3.1.cmml">,</mo><mi id="S4.SS4.SSS0.Px1.p2.6.m6.2.2" xref="S4.SS4.SSS0.Px1.p2.6.m6.2.2.cmml">y</mi><mo stretchy="false" id="S4.SS4.SSS0.Px1.p2.6.m6.2.3.2.3" xref="S4.SS4.SSS0.Px1.p2.6.m6.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.6.m6.2b"><interval closure="open" id="S4.SS4.SSS0.Px1.p2.6.m6.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p2.6.m6.2.3.2"><ci id="S4.SS4.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.6.m6.1.1">𝒙</ci><ci id="S4.SS4.SSS0.Px1.p2.6.m6.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.6.m6.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.6.m6.2c">(\bm{x},y)</annotation></semantics></math> in <math id="S4.SS4.SSS0.Px1.p2.7.m7.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p2.7.m7.1a"><msub id="S4.SS4.SSS0.Px1.p2.7.m7.1.1" xref="S4.SS4.SSS0.Px1.p2.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px1.p2.7.m7.1.1.2" xref="S4.SS4.SSS0.Px1.p2.7.m7.1.1.2.cmml">𝒟</mi><mi id="S4.SS4.SSS0.Px1.p2.7.m7.1.1.3" xref="S4.SS4.SSS0.Px1.p2.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.7.m7.1b"><apply id="S4.SS4.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.7.m7.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS4.SSS0.Px1.p2.7.m7.1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p2.7.m7.1.1.2">𝒟</ci><ci id="S4.SS4.SSS0.Px1.p2.7.m7.1.1.3.cmml" xref="S4.SS4.SSS0.Px1.p2.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.7.m7.1c">\mathcal{D}_{k}</annotation></semantics></math>.
Referred by origin <math id="S4.SS4.SSS0.Px1.p2.8.m8.1" class="ltx_Math" alttext="\bm{o}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p2.8.m8.1a"><mi id="S4.SS4.SSS0.Px1.p2.8.m8.1.1" xref="S4.SS4.SSS0.Px1.p2.8.m8.1.1.cmml">𝒐</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.8.m8.1b"><ci id="S4.SS4.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.8.m8.1.1">𝒐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.8.m8.1c">\bm{o}</annotation></semantics></math>, we apply an exponential map from tangent space <math id="S4.SS4.SSS0.Px1.p2.9.m9.1" class="ltx_Math" alttext="\mathcal{T}_{\bm{o}}\mathcal{M}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p2.9.m9.1a"><mrow id="S4.SS4.SSS0.Px1.p2.9.m9.1.1" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1.cmml"><msub id="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2.2" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2.2.cmml">𝒯</mi><mi id="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2.3" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2.3.cmml">𝒐</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS4.SSS0.Px1.p2.9.m9.1.1.1" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px1.p2.9.m9.1.1.3" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.9.m9.1b"><apply id="S4.SS4.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1"><times id="S4.SS4.SSS0.Px1.p2.9.m9.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1.1"></times><apply id="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2.1.cmml" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2">subscript</csymbol><ci id="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2.2">𝒯</ci><ci id="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2.3.cmml" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1.2.3">𝒐</ci></apply><ci id="S4.SS4.SSS0.Px1.p2.9.m9.1.1.3.cmml" xref="S4.SS4.SSS0.Px1.p2.9.m9.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.9.m9.1c">\mathcal{T}_{\bm{o}}\mathcal{M}</annotation></semantics></math> to the Poincaré ball model <math id="S4.SS4.SSS0.Px1.p2.10.m10.1" class="ltx_Math" alttext="\mathbb{P}^{n}_{k}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p2.10.m10.1a"><msubsup id="S4.SS4.SSS0.Px1.p2.10.m10.1.1" xref="S4.SS4.SSS0.Px1.p2.10.m10.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p2.10.m10.1.1.2.2" xref="S4.SS4.SSS0.Px1.p2.10.m10.1.1.2.2.cmml">ℙ</mi><mi id="S4.SS4.SSS0.Px1.p2.10.m10.1.1.3" xref="S4.SS4.SSS0.Px1.p2.10.m10.1.1.3.cmml">k</mi><mi id="S4.SS4.SSS0.Px1.p2.10.m10.1.1.2.3" xref="S4.SS4.SSS0.Px1.p2.10.m10.1.1.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.10.m10.1b"><apply id="S4.SS4.SSS0.Px1.p2.10.m10.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.10.m10.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.10.m10.1.1">subscript</csymbol><apply id="S4.SS4.SSS0.Px1.p2.10.m10.1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.10.m10.1.1.2.1.cmml" xref="S4.SS4.SSS0.Px1.p2.10.m10.1.1">superscript</csymbol><ci id="S4.SS4.SSS0.Px1.p2.10.m10.1.1.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.10.m10.1.1.2.2">ℙ</ci><ci id="S4.SS4.SSS0.Px1.p2.10.m10.1.1.2.3.cmml" xref="S4.SS4.SSS0.Px1.p2.10.m10.1.1.2.3">𝑛</ci></apply><ci id="S4.SS4.SSS0.Px1.p2.10.m10.1.1.3.cmml" xref="S4.SS4.SSS0.Px1.p2.10.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.10.m10.1c">\mathbb{P}^{n}_{k}</annotation></semantics></math> shared with class prototypes.
Hence, the representation of data samples in Poincaré ball model <math id="S4.SS4.SSS0.Px1.p2.11.m11.1" class="ltx_Math" alttext="\mathbb{P}^{n}_{k}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p2.11.m11.1a"><msubsup id="S4.SS4.SSS0.Px1.p2.11.m11.1.1" xref="S4.SS4.SSS0.Px1.p2.11.m11.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p2.11.m11.1.1.2.2" xref="S4.SS4.SSS0.Px1.p2.11.m11.1.1.2.2.cmml">ℙ</mi><mi id="S4.SS4.SSS0.Px1.p2.11.m11.1.1.3" xref="S4.SS4.SSS0.Px1.p2.11.m11.1.1.3.cmml">k</mi><mi id="S4.SS4.SSS0.Px1.p2.11.m11.1.1.2.3" xref="S4.SS4.SSS0.Px1.p2.11.m11.1.1.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p2.11.m11.1b"><apply id="S4.SS4.SSS0.Px1.p2.11.m11.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.11.m11.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p2.11.m11.1.1">subscript</csymbol><apply id="S4.SS4.SSS0.Px1.p2.11.m11.1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p2.11.m11.1.1.2.1.cmml" xref="S4.SS4.SSS0.Px1.p2.11.m11.1.1">superscript</csymbol><ci id="S4.SS4.SSS0.Px1.p2.11.m11.1.1.2.2.cmml" xref="S4.SS4.SSS0.Px1.p2.11.m11.1.1.2.2">ℙ</ci><ci id="S4.SS4.SSS0.Px1.p2.11.m11.1.1.2.3.cmml" xref="S4.SS4.SSS0.Px1.p2.11.m11.1.1.2.3">𝑛</ci></apply><ci id="S4.SS4.SSS0.Px1.p2.11.m11.1.1.3.cmml" xref="S4.SS4.SSS0.Px1.p2.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p2.11.m11.1c">\mathbb{P}^{n}_{k}</annotation></semantics></math> can be:</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.5" class="ltx_Math" alttext="\exp_{\bm{0}}(\bm{z})=\tanh(||\bm{z}||_{2})\frac{\bm{z}}{||\bm{z}||_{2}}." display="block"><semantics id="S4.E6.m1.5a"><mrow id="S4.E6.m1.5.5.1" xref="S4.E6.m1.5.5.1.1.cmml"><mrow id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.1.cmml"><mrow id="S4.E6.m1.5.5.1.1.1.1" xref="S4.E6.m1.5.5.1.1.1.2.cmml"><msub id="S4.E6.m1.5.5.1.1.1.1.1" xref="S4.E6.m1.5.5.1.1.1.1.1.cmml"><mi id="S4.E6.m1.5.5.1.1.1.1.1.2" xref="S4.E6.m1.5.5.1.1.1.1.1.2.cmml">exp</mi><mn id="S4.E6.m1.5.5.1.1.1.1.1.3" xref="S4.E6.m1.5.5.1.1.1.1.1.3.cmml">𝟎</mn></msub><mo id="S4.E6.m1.5.5.1.1.1.1a" xref="S4.E6.m1.5.5.1.1.1.2.cmml">⁡</mo><mrow id="S4.E6.m1.5.5.1.1.1.1.2" xref="S4.E6.m1.5.5.1.1.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.5.5.1.1.1.1.2.1" xref="S4.E6.m1.5.5.1.1.1.2.cmml">(</mo><mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">𝒛</mi><mo stretchy="false" id="S4.E6.m1.5.5.1.1.1.1.2.2" xref="S4.E6.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.5.5.1.1.3" xref="S4.E6.m1.5.5.1.1.3.cmml">=</mo><mrow id="S4.E6.m1.5.5.1.1.2" xref="S4.E6.m1.5.5.1.1.2.cmml"><mrow id="S4.E6.m1.5.5.1.1.2.1.1" xref="S4.E6.m1.5.5.1.1.2.1.2.cmml"><mi id="S4.E6.m1.4.4" xref="S4.E6.m1.4.4.cmml">tanh</mi><mo id="S4.E6.m1.5.5.1.1.2.1.1a" xref="S4.E6.m1.5.5.1.1.2.1.2.cmml">⁡</mo><mrow id="S4.E6.m1.5.5.1.1.2.1.1.1" xref="S4.E6.m1.5.5.1.1.2.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.5.5.1.1.2.1.1.1.2" xref="S4.E6.m1.5.5.1.1.2.1.2.cmml">(</mo><msub id="S4.E6.m1.5.5.1.1.2.1.1.1.1" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.cmml"><mrow id="S4.E6.m1.5.5.1.1.2.1.1.1.1.2.2" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.2.1.cmml"><mo stretchy="false" id="S4.E6.m1.5.5.1.1.2.1.1.1.1.2.2.1" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.2.1.1.cmml">‖</mo><mi id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml">𝒛</mi><mo stretchy="false" id="S4.E6.m1.5.5.1.1.2.1.1.1.1.2.2.2" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.2.1.1.cmml">‖</mo></mrow><mn id="S4.E6.m1.5.5.1.1.2.1.1.1.1.3" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="S4.E6.m1.5.5.1.1.2.1.1.1.3" xref="S4.E6.m1.5.5.1.1.2.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.2.2" xref="S4.E6.m1.5.5.1.1.2.2.cmml">​</mo><mfrac id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><mi id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3.cmml">𝒛</mi><msub id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.3.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.3.2.1" xref="S4.E6.m1.1.1.1.3.1.1.cmml">‖</mo><mi id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">𝒛</mi><mo stretchy="false" id="S4.E6.m1.1.1.1.3.2.2" xref="S4.E6.m1.1.1.1.3.1.1.cmml">‖</mo></mrow><mn id="S4.E6.m1.1.1.1.4" xref="S4.E6.m1.1.1.1.4.cmml">2</mn></msub></mfrac></mrow></mrow><mo lspace="0em" id="S4.E6.m1.5.5.1.2" xref="S4.E6.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.5b"><apply id="S4.E6.m1.5.5.1.1.cmml" xref="S4.E6.m1.5.5.1"><eq id="S4.E6.m1.5.5.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.3"></eq><apply id="S4.E6.m1.5.5.1.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1"><apply id="S4.E6.m1.5.5.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1">subscript</csymbol><exp id="S4.E6.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.2"></exp><cn type="integer" id="S4.E6.m1.5.5.1.1.1.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.3">0</cn></apply><ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">𝒛</ci></apply><apply id="S4.E6.m1.5.5.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2"><times id="S4.E6.m1.5.5.1.1.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2.2"></times><apply id="S4.E6.m1.5.5.1.1.2.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1"><tanh id="S4.E6.m1.4.4.cmml" xref="S4.E6.m1.4.4"></tanh><apply id="S4.E6.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1">subscript</csymbol><apply id="S4.E6.m1.5.5.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.2.2"><csymbol cd="latexml" id="S4.E6.m1.5.5.1.1.2.1.1.1.1.2.1.1.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.2.2.1">norm</csymbol><ci id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.3.3">𝒛</ci></apply><cn type="integer" id="S4.E6.m1.5.5.1.1.2.1.1.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.2.1.1.1.1.3">2</cn></apply></apply><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><divide id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1"></divide><ci id="S4.E6.m1.1.1.3.cmml" xref="S4.E6.m1.1.1.3">𝒛</ci><apply id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1">subscript</csymbol><apply id="S4.E6.m1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.3.2"><csymbol cd="latexml" id="S4.E6.m1.1.1.1.3.1.1.cmml" xref="S4.E6.m1.1.1.1.3.2.1">norm</csymbol><ci id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">𝒛</ci></apply><cn type="integer" id="S4.E6.m1.1.1.1.4.cmml" xref="S4.E6.m1.1.1.1.4">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.5c">\exp_{\bm{0}}(\bm{z})=\tanh(||\bm{z}||_{2})\frac{\bm{z}}{||\bm{z}||_{2}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS4.SSS0.Px1.p3" class="ltx_para">
<p id="S4.SS4.SSS0.Px1.p3.2" class="ltx_p">As mentioned ahead, we seek to construct the hierarchical structure between the feature representations of data samples and their corresponding class prototypes.
Triplet loss <cite class="ltx_cite ltx_citemacro_cite">Movshovitz-Attias <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib36" title="" class="ltx_ref">2017</a>); Liu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib29" title="" class="ltx_ref">2021</a>, <a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite>
optimizes the distances among a set of triplets, denoted as {anchor point, positive point, negative point}, by creating a fixed margin, i.e., <math id="S4.SS4.SSS0.Px1.p3.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS4.SSS0.Px1.p3.1.m1.1a"><mi id="S4.SS4.SSS0.Px1.p3.1.m1.1.1" xref="S4.SS4.SSS0.Px1.p3.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p3.1.m1.1b"><ci id="S4.SS4.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p3.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p3.1.m1.1c">m</annotation></semantics></math>, between the anchor-positive points difference and the anchor-negative points difference.
Motivated by this, we choose each data sample representation in the Poincaré ball model as <span id="S4.SS4.SSS0.Px1.p3.2.1" class="ltx_text ltx_font_italic">anchor point</span>, the ground truth class prototype as <span id="S4.SS4.SSS0.Px1.p3.2.2" class="ltx_text ltx_font_italic">positive point</span>, and the remaining prototypes of the full class set as <span id="S4.SS4.SSS0.Px1.p3.2.3" class="ltx_text ltx_font_italic">negative points</span>.
In this way, each client incorporates the prototypes of its missing class to feature representation, by randomly sampling negative points.
We define hyperbolic triplet loss for client <math id="S4.SS4.SSS0.Px1.p3.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS4.SSS0.Px1.p3.2.m2.1a"><mi id="S4.SS4.SSS0.Px1.p3.2.m2.1.1" xref="S4.SS4.SSS0.Px1.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p3.2.m2.1b"><ci id="S4.SS4.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S4.SS4.SSS0.Px1.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p3.2.m2.1c">k</annotation></semantics></math> as below:</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.5" class="ltx_Math" alttext="\small\mathbf{L}_{k}^{R}=\max(d(\exp_{\bm{0}}(\bm{z}),\bm{w}_{y})-d(\exp_{\bm{0}}(\bm{z}),\bm{w}_{y^{\prime}})+m,0)," display="block"><semantics id="S4.E7.m1.5a"><mrow id="S4.E7.m1.5.5.1" xref="S4.E7.m1.5.5.1.1.cmml"><mrow id="S4.E7.m1.5.5.1.1" xref="S4.E7.m1.5.5.1.1.cmml"><msubsup id="S4.E7.m1.5.5.1.1.3" xref="S4.E7.m1.5.5.1.1.3.cmml"><mi mathsize="90%" id="S4.E7.m1.5.5.1.1.3.2.2" xref="S4.E7.m1.5.5.1.1.3.2.2.cmml">𝐋</mi><mi mathsize="90%" id="S4.E7.m1.5.5.1.1.3.2.3" xref="S4.E7.m1.5.5.1.1.3.2.3.cmml">k</mi><mi mathsize="90%" id="S4.E7.m1.5.5.1.1.3.3" xref="S4.E7.m1.5.5.1.1.3.3.cmml">R</mi></msubsup><mo mathsize="90%" id="S4.E7.m1.5.5.1.1.2" xref="S4.E7.m1.5.5.1.1.2.cmml">=</mo><mrow id="S4.E7.m1.5.5.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.2.cmml"><mi mathsize="90%" id="S4.E7.m1.3.3" xref="S4.E7.m1.3.3.cmml">max</mi><mo id="S4.E7.m1.5.5.1.1.1.1a" xref="S4.E7.m1.5.5.1.1.1.2.cmml">⁡</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.2" xref="S4.E7.m1.5.5.1.1.1.2.cmml">(</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.4" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.cmml"><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.cmml"><mi mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.4" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml">(</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">exp</mi><mn mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝟎</mn></msub><mo id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1a" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi mathsize="90%" id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">𝒛</mi><mo maxsize="90%" minsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.4" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml">,</mo><msub id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.cmml"><mi mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.2.cmml">𝒘</mi><mi mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.3.cmml">y</mi></msub><mo maxsize="90%" minsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.5" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.4.5" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.5.cmml">−</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.cmml"><mi mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.4" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.3.cmml">​</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.3.cmml">(</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.2.cmml"><msub id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1.cmml"><mi mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1.2.cmml">exp</mi><mn mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1.3.cmml">𝟎</mn></msub><mo id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1a" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.2.1" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.2.cmml">(</mo><mi mathsize="90%" id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml">𝒛</mi><mo maxsize="90%" minsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.2.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.4" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.3.cmml">,</mo><msub id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.cmml"><mi mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.2.cmml">𝒘</mi><msup id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3.cmml"><mi mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3.2" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3.2.cmml">y</mi><mo mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3.3" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3.3.cmml">′</mo></msup></msub><mo maxsize="90%" minsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.5" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.5" xref="S4.E7.m1.5.5.1.1.1.1.1.1.5.cmml">+</mo><mi mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.1.6" xref="S4.E7.m1.5.5.1.1.1.1.1.1.6.cmml">m</mi></mrow><mo mathsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.3" xref="S4.E7.m1.5.5.1.1.1.2.cmml">,</mo><mn mathsize="90%" id="S4.E7.m1.4.4" xref="S4.E7.m1.4.4.cmml">0</mn><mo maxsize="90%" minsize="90%" id="S4.E7.m1.5.5.1.1.1.1.1.4" xref="S4.E7.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo mathsize="90%" id="S4.E7.m1.5.5.1.2" xref="S4.E7.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.5b"><apply id="S4.E7.m1.5.5.1.1.cmml" xref="S4.E7.m1.5.5.1"><eq id="S4.E7.m1.5.5.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.2"></eq><apply id="S4.E7.m1.5.5.1.1.3.cmml" xref="S4.E7.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.3.1.cmml" xref="S4.E7.m1.5.5.1.1.3">superscript</csymbol><apply id="S4.E7.m1.5.5.1.1.3.2.cmml" xref="S4.E7.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.3.2.1.cmml" xref="S4.E7.m1.5.5.1.1.3">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.3.2.2.cmml" xref="S4.E7.m1.5.5.1.1.3.2.2">𝐋</ci><ci id="S4.E7.m1.5.5.1.1.3.2.3.cmml" xref="S4.E7.m1.5.5.1.1.3.2.3">𝑘</ci></apply><ci id="S4.E7.m1.5.5.1.1.3.3.cmml" xref="S4.E7.m1.5.5.1.1.3.3">𝑅</ci></apply><apply id="S4.E7.m1.5.5.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1"><max id="S4.E7.m1.3.3.cmml" xref="S4.E7.m1.3.3"></max><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1"><plus id="S4.E7.m1.5.5.1.1.1.1.1.1.5.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.5"></plus><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.4.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4"><minus id="S4.E7.m1.5.5.1.1.1.1.1.1.4.5.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.5"></minus><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2"><times id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.3"></times><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.4.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.4">𝑑</ci><interval closure="open" id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2"><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><exp id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2"></exp><cn type="integer" id="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3">0</cn></apply><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝒛</ci></apply><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.2">𝒘</ci><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.3">𝑦</ci></apply></interval></apply><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4"><times id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.3"></times><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.4.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.4">𝑑</ci><interval closure="open" id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2"><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1"><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1">subscript</csymbol><exp id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1.2"></exp><cn type="integer" id="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.3.3.1.1.1.1.1.3">0</cn></apply><ci id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2">𝒛</ci></apply><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.2">𝒘</ci><apply id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3.1.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3">superscript</csymbol><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3.2.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3.2">𝑦</ci><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3.3.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.4.4.2.2.2.3.3">′</ci></apply></apply></interval></apply></apply><ci id="S4.E7.m1.5.5.1.1.1.1.1.1.6.cmml" xref="S4.E7.m1.5.5.1.1.1.1.1.1.6">𝑚</ci></apply><cn type="integer" id="S4.E7.m1.4.4.cmml" xref="S4.E7.m1.4.4">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.5c">\small\mathbf{L}_{k}^{R}=\max(d(\exp_{\bm{0}}(\bm{z}),\bm{w}_{y})-d(\exp_{\bm{0}}(\bm{z}),\bm{w}_{y^{\prime}})+m,0),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS4.SSS0.Px1.p3.6" class="ltx_p">where <math id="S4.SS4.SSS0.Px1.p3.3.m1.1" class="ltx_Math" alttext="\bm{z}=\mathcal{F}_{\bm{\theta}_{k}}(\bm{x})" display="inline"><semantics id="S4.SS4.SSS0.Px1.p3.3.m1.1a"><mrow id="S4.SS4.SSS0.Px1.p3.3.m1.1.2" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.cmml"><mi id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.2" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.2.cmml">𝒛</mi><mo id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.1" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.1.cmml">=</mo><mrow id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.cmml"><msub id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.2" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.2.cmml">ℱ</mi><msub id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3.cmml"><mi id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3.2" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3.2.cmml">𝜽</mi><mi id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3.3" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.1" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.1.cmml">​</mo><mrow id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.3.2" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.cmml"><mo stretchy="false" id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.3.2.1" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.cmml">(</mo><mi id="S4.SS4.SSS0.Px1.p3.3.m1.1.1" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.3.2.2" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p3.3.m1.1b"><apply id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2"><eq id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.1.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.1"></eq><ci id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.2.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.2">𝒛</ci><apply id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3"><times id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.1"></times><apply id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.1.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2">subscript</csymbol><ci id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.2.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.2">ℱ</ci><apply id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3">subscript</csymbol><ci id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3.2.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3.2">𝜽</ci><ci id="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3.3.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.2.3.2.3.3">𝑘</ci></apply></apply><ci id="S4.SS4.SSS0.Px1.p3.3.m1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p3.3.m1.1.1">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p3.3.m1.1c">\bm{z}=\mathcal{F}_{\bm{\theta}_{k}}(\bm{x})</annotation></semantics></math>, <math id="S4.SS4.SSS0.Px1.p3.4.m2.1" class="ltx_Math" alttext="\bm{w}_{y^{\prime}}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p3.4.m2.1a"><msub id="S4.SS4.SSS0.Px1.p3.4.m2.1.1" xref="S4.SS4.SSS0.Px1.p3.4.m2.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p3.4.m2.1.1.2" xref="S4.SS4.SSS0.Px1.p3.4.m2.1.1.2.cmml">𝒘</mi><msup id="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3" xref="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3.2" xref="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3.2.cmml">y</mi><mo id="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3.3" xref="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3.3.cmml">′</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p3.4.m2.1b"><apply id="S4.SS4.SSS0.Px1.p3.4.m2.1.1.cmml" xref="S4.SS4.SSS0.Px1.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p3.4.m2.1.1.1.cmml" xref="S4.SS4.SSS0.Px1.p3.4.m2.1.1">subscript</csymbol><ci id="S4.SS4.SSS0.Px1.p3.4.m2.1.1.2.cmml" xref="S4.SS4.SSS0.Px1.p3.4.m2.1.1.2">𝒘</ci><apply id="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3.cmml" xref="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3.1.cmml" xref="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3">superscript</csymbol><ci id="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3.2.cmml" xref="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3.2">𝑦</ci><ci id="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3.3.cmml" xref="S4.SS4.SSS0.Px1.p3.4.m2.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p3.4.m2.1c">\bm{w}_{y^{\prime}}</annotation></semantics></math> is randomly sampled negative class prototype, <math id="S4.SS4.SSS0.Px1.p3.5.m3.2" class="ltx_Math" alttext="d(\cdot,\cdot)" display="inline"><semantics id="S4.SS4.SSS0.Px1.p3.5.m3.2a"><mrow id="S4.SS4.SSS0.Px1.p3.5.m3.2.3" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.3.cmml"><mi id="S4.SS4.SSS0.Px1.p3.5.m3.2.3.2" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS4.SSS0.Px1.p3.5.m3.2.3.1" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.3.1.cmml">​</mo><mrow id="S4.SS4.SSS0.Px1.p3.5.m3.2.3.3.2" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS4.SSS0.Px1.p3.5.m3.2.3.3.2.1" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS4.SSS0.Px1.p3.5.m3.1.1" xref="S4.SS4.SSS0.Px1.p3.5.m3.1.1.cmml">⋅</mo><mo rspace="0em" id="S4.SS4.SSS0.Px1.p3.5.m3.2.3.3.2.2" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.SS4.SSS0.Px1.p3.5.m3.2.2" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS4.SSS0.Px1.p3.5.m3.2.3.3.2.3" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p3.5.m3.2b"><apply id="S4.SS4.SSS0.Px1.p3.5.m3.2.3.cmml" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.3"><times id="S4.SS4.SSS0.Px1.p3.5.m3.2.3.1.cmml" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.3.1"></times><ci id="S4.SS4.SSS0.Px1.p3.5.m3.2.3.2.cmml" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.3.2">𝑑</ci><interval closure="open" id="S4.SS4.SSS0.Px1.p3.5.m3.2.3.3.1.cmml" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.3.3.2"><ci id="S4.SS4.SSS0.Px1.p3.5.m3.1.1.cmml" xref="S4.SS4.SSS0.Px1.p3.5.m3.1.1">⋅</ci><ci id="S4.SS4.SSS0.Px1.p3.5.m3.2.2.cmml" xref="S4.SS4.SSS0.Px1.p3.5.m3.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p3.5.m3.2c">d(\cdot,\cdot)</annotation></semantics></math> is the geodesic distance defined in Eq. (<a href="#S3.E1" title="In 3 Preliminary: Poincaré Ball Model ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), and margin <math id="S4.SS4.SSS0.Px1.p3.6.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS4.SSS0.Px1.p3.6.m4.1a"><mi id="S4.SS4.SSS0.Px1.p3.6.m4.1.1" xref="S4.SS4.SSS0.Px1.p3.6.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS0.Px1.p3.6.m4.1b"><ci id="S4.SS4.SSS0.Px1.p3.6.m4.1.1.cmml" xref="S4.SS4.SSS0.Px1.p3.6.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS0.Px1.p3.6.m4.1c">m</annotation></semantics></math> is a hyper-parameter.
We obtain fine-grained representation with sufficient hierarchical information, by simultaneously minimizing the positive geodesic, e.g., the green curve in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.1 Problem Statement ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, and maximizing the negative geodesic, e.g., the red curve in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.1 Problem Statement ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
In this way, <span id="S4.SS4.SSS0.Px1.p3.6.1" class="ltx_text ltx_font_typewriter">HyperFed</span> utilizes the data hierarchical information to enhance the prediction.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.10.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Training procedure of <span id="alg1.11.2" class="ltx_text ltx_font_typewriter">HyperFed</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.7" class="ltx_p ltx_figure_panel"><span id="alg1.7.1" class="ltx_text ltx_font_bold">Input</span>: Batch size <math id="alg1.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">B</annotation></semantics></math>, communication rounds <math id="alg1.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.2.m2.1a"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">T</annotation></semantics></math>, number of clients <math id="alg1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.3.m3.1a"><mi id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">K</annotation></semantics></math>, local steps <math id="alg1.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.4.m4.1a"><mi id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><ci id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">E</annotation></semantics></math>, dataset <math id="alg1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}=\cup_{k\in[K]}\mathcal{D}_{k}" display="inline"><semantics id="alg1.5.m5.1a"><mrow id="alg1.5.m5.1.2" xref="alg1.5.m5.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.5.m5.1.2.2" xref="alg1.5.m5.1.2.2.cmml">𝒟</mi><mo rspace="0em" id="alg1.5.m5.1.2.1" xref="alg1.5.m5.1.2.1.cmml">=</mo><mrow id="alg1.5.m5.1.2.3" xref="alg1.5.m5.1.2.3.cmml"><msub id="alg1.5.m5.1.2.3.1" xref="alg1.5.m5.1.2.3.1.cmml"><mo lspace="0em" id="alg1.5.m5.1.2.3.1.2" xref="alg1.5.m5.1.2.3.1.2.cmml">∪</mo><mrow id="alg1.5.m5.1.1.1" xref="alg1.5.m5.1.1.1.cmml"><mi id="alg1.5.m5.1.1.1.3" xref="alg1.5.m5.1.1.1.3.cmml">k</mi><mo id="alg1.5.m5.1.1.1.2" xref="alg1.5.m5.1.1.1.2.cmml">∈</mo><mrow id="alg1.5.m5.1.1.1.4.2" xref="alg1.5.m5.1.1.1.4.1.cmml"><mo stretchy="false" id="alg1.5.m5.1.1.1.4.2.1" xref="alg1.5.m5.1.1.1.4.1.1.cmml">[</mo><mi id="alg1.5.m5.1.1.1.1" xref="alg1.5.m5.1.1.1.1.cmml">K</mi><mo stretchy="false" id="alg1.5.m5.1.1.1.4.2.2" xref="alg1.5.m5.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><msub id="alg1.5.m5.1.2.3.2" xref="alg1.5.m5.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.5.m5.1.2.3.2.2" xref="alg1.5.m5.1.2.3.2.2.cmml">𝒟</mi><mi id="alg1.5.m5.1.2.3.2.3" xref="alg1.5.m5.1.2.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><apply id="alg1.5.m5.1.2.cmml" xref="alg1.5.m5.1.2"><eq id="alg1.5.m5.1.2.1.cmml" xref="alg1.5.m5.1.2.1"></eq><ci id="alg1.5.m5.1.2.2.cmml" xref="alg1.5.m5.1.2.2">𝒟</ci><apply id="alg1.5.m5.1.2.3.cmml" xref="alg1.5.m5.1.2.3"><apply id="alg1.5.m5.1.2.3.1.cmml" xref="alg1.5.m5.1.2.3.1"><csymbol cd="ambiguous" id="alg1.5.m5.1.2.3.1.1.cmml" xref="alg1.5.m5.1.2.3.1">subscript</csymbol><union id="alg1.5.m5.1.2.3.1.2.cmml" xref="alg1.5.m5.1.2.3.1.2"></union><apply id="alg1.5.m5.1.1.1.cmml" xref="alg1.5.m5.1.1.1"><in id="alg1.5.m5.1.1.1.2.cmml" xref="alg1.5.m5.1.1.1.2"></in><ci id="alg1.5.m5.1.1.1.3.cmml" xref="alg1.5.m5.1.1.1.3">𝑘</ci><apply id="alg1.5.m5.1.1.1.4.1.cmml" xref="alg1.5.m5.1.1.1.4.2"><csymbol cd="latexml" id="alg1.5.m5.1.1.1.4.1.1.cmml" xref="alg1.5.m5.1.1.1.4.2.1">delimited-[]</csymbol><ci id="alg1.5.m5.1.1.1.1.cmml" xref="alg1.5.m5.1.1.1.1">𝐾</ci></apply></apply></apply><apply id="alg1.5.m5.1.2.3.2.cmml" xref="alg1.5.m5.1.2.3.2"><csymbol cd="ambiguous" id="alg1.5.m5.1.2.3.2.1.cmml" xref="alg1.5.m5.1.2.3.2">subscript</csymbol><ci id="alg1.5.m5.1.2.3.2.2.cmml" xref="alg1.5.m5.1.2.3.2.2">𝒟</ci><ci id="alg1.5.m5.1.2.3.2.3.cmml" xref="alg1.5.m5.1.2.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">\mathcal{D}=\cup_{k\in[K]}\mathcal{D}_{k}</annotation></semantics></math>
<br class="ltx_break"><span id="alg1.7.2" class="ltx_text ltx_font_bold">Output</span>: hyperbolic class prototypes <math id="alg1.6.m6.1" class="ltx_Math" alttext="\bm{W}_{\mathbb{P}}" display="inline"><semantics id="alg1.6.m6.1a"><msub id="alg1.6.m6.1.1" xref="alg1.6.m6.1.1.cmml"><mi id="alg1.6.m6.1.1.2" xref="alg1.6.m6.1.1.2.cmml">𝑾</mi><mi id="alg1.6.m6.1.1.3" xref="alg1.6.m6.1.1.3.cmml">ℙ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.6.m6.1b"><apply id="alg1.6.m6.1.1.cmml" xref="alg1.6.m6.1.1"><csymbol cd="ambiguous" id="alg1.6.m6.1.1.1.cmml" xref="alg1.6.m6.1.1">subscript</csymbol><ci id="alg1.6.m6.1.1.2.cmml" xref="alg1.6.m6.1.1.2">𝑾</ci><ci id="alg1.6.m6.1.1.3.cmml" xref="alg1.6.m6.1.1.3">ℙ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m6.1c">\bm{W}_{\mathbb{P}}</annotation></semantics></math>, model parameters, i.e., <math id="alg1.7.m7.1" class="ltx_Math" alttext="\bm{\theta}^{T}\text{and}\{\bm{\theta}_{k}^{T}\}" display="inline"><semantics id="alg1.7.m7.1a"><mrow id="alg1.7.m7.1.1" xref="alg1.7.m7.1.1.cmml"><msup id="alg1.7.m7.1.1.3" xref="alg1.7.m7.1.1.3.cmml"><mi id="alg1.7.m7.1.1.3.2" xref="alg1.7.m7.1.1.3.2.cmml">𝜽</mi><mi id="alg1.7.m7.1.1.3.3" xref="alg1.7.m7.1.1.3.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="alg1.7.m7.1.1.2" xref="alg1.7.m7.1.1.2.cmml">​</mo><mtext id="alg1.7.m7.1.1.4" xref="alg1.7.m7.1.1.4a.cmml">and</mtext><mo lspace="0em" rspace="0em" id="alg1.7.m7.1.1.2a" xref="alg1.7.m7.1.1.2.cmml">​</mo><mrow id="alg1.7.m7.1.1.1.1" xref="alg1.7.m7.1.1.1.2.cmml"><mo stretchy="false" id="alg1.7.m7.1.1.1.1.2" xref="alg1.7.m7.1.1.1.2.cmml">{</mo><msubsup id="alg1.7.m7.1.1.1.1.1" xref="alg1.7.m7.1.1.1.1.1.cmml"><mi id="alg1.7.m7.1.1.1.1.1.2.2" xref="alg1.7.m7.1.1.1.1.1.2.2.cmml">𝜽</mi><mi id="alg1.7.m7.1.1.1.1.1.2.3" xref="alg1.7.m7.1.1.1.1.1.2.3.cmml">k</mi><mi id="alg1.7.m7.1.1.1.1.1.3" xref="alg1.7.m7.1.1.1.1.1.3.cmml">T</mi></msubsup><mo stretchy="false" id="alg1.7.m7.1.1.1.1.3" xref="alg1.7.m7.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.7.m7.1b"><apply id="alg1.7.m7.1.1.cmml" xref="alg1.7.m7.1.1"><times id="alg1.7.m7.1.1.2.cmml" xref="alg1.7.m7.1.1.2"></times><apply id="alg1.7.m7.1.1.3.cmml" xref="alg1.7.m7.1.1.3"><csymbol cd="ambiguous" id="alg1.7.m7.1.1.3.1.cmml" xref="alg1.7.m7.1.1.3">superscript</csymbol><ci id="alg1.7.m7.1.1.3.2.cmml" xref="alg1.7.m7.1.1.3.2">𝜽</ci><ci id="alg1.7.m7.1.1.3.3.cmml" xref="alg1.7.m7.1.1.3.3">𝑇</ci></apply><ci id="alg1.7.m7.1.1.4a.cmml" xref="alg1.7.m7.1.1.4"><mtext id="alg1.7.m7.1.1.4.cmml" xref="alg1.7.m7.1.1.4">and</mtext></ci><set id="alg1.7.m7.1.1.1.2.cmml" xref="alg1.7.m7.1.1.1.1"><apply id="alg1.7.m7.1.1.1.1.1.cmml" xref="alg1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.7.m7.1.1.1.1.1.1.cmml" xref="alg1.7.m7.1.1.1.1.1">superscript</csymbol><apply id="alg1.7.m7.1.1.1.1.1.2.cmml" xref="alg1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.7.m7.1.1.1.1.1.2.1.cmml" xref="alg1.7.m7.1.1.1.1.1">subscript</csymbol><ci id="alg1.7.m7.1.1.1.1.1.2.2.cmml" xref="alg1.7.m7.1.1.1.1.1.2.2">𝜽</ci><ci id="alg1.7.m7.1.1.1.1.1.2.3.cmml" xref="alg1.7.m7.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg1.7.m7.1.1.1.1.1.3.cmml" xref="alg1.7.m7.1.1.1.1.1.3">𝑇</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m7.1c">\bm{\theta}^{T}\text{and}\{\bm{\theta}_{k}^{T}\}</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.12" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">Server executes():</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  Initialize
<math id="alg1.l2.m1.1" class="ltx_Math" alttext="\bm{\theta}^{0}" display="inline"><semantics id="alg1.l2.m1.1a"><msup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">𝜽</mi><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝜽</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\bm{\theta}^{0}</annotation></semantics></math> with random distribution and <math id="alg1.l2.m2.1" class="ltx_Math" alttext="\bm{W}_{\mathbb{P}}" display="inline"><semantics id="alg1.l2.m2.1a"><msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">𝑾</mi><mi id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">ℙ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝑾</ci><ci id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">ℙ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">\bm{W}_{\mathbb{P}}</annotation></semantics></math> by <span id="alg1.l2.2" class="ltx_text ltx_font_bold ltx_font_italic">HPTI</span>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.4" class="ltx_Math" alttext="t=0,1,...,T-1" display="inline"><semantics id="alg1.l3.m1.4a"><mrow id="alg1.l3.m1.4.4" xref="alg1.l3.m1.4.4.cmml"><mi id="alg1.l3.m1.4.4.3" xref="alg1.l3.m1.4.4.3.cmml">t</mi><mo id="alg1.l3.m1.4.4.2" xref="alg1.l3.m1.4.4.2.cmml">=</mo><mrow id="alg1.l3.m1.4.4.1.1" xref="alg1.l3.m1.4.4.1.2.cmml"><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">0</mn><mo id="alg1.l3.m1.4.4.1.1.2" xref="alg1.l3.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">1</mn><mo id="alg1.l3.m1.4.4.1.1.3" xref="alg1.l3.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">…</mi><mo id="alg1.l3.m1.4.4.1.1.4" xref="alg1.l3.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l3.m1.4.4.1.1.1" xref="alg1.l3.m1.4.4.1.1.1.cmml"><mi id="alg1.l3.m1.4.4.1.1.1.2" xref="alg1.l3.m1.4.4.1.1.1.2.cmml">T</mi><mo id="alg1.l3.m1.4.4.1.1.1.1" xref="alg1.l3.m1.4.4.1.1.1.1.cmml">−</mo><mn id="alg1.l3.m1.4.4.1.1.1.3" xref="alg1.l3.m1.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.4b"><apply id="alg1.l3.m1.4.4.cmml" xref="alg1.l3.m1.4.4"><eq id="alg1.l3.m1.4.4.2.cmml" xref="alg1.l3.m1.4.4.2"></eq><ci id="alg1.l3.m1.4.4.3.cmml" xref="alg1.l3.m1.4.4.3">𝑡</ci><list id="alg1.l3.m1.4.4.1.2.cmml" xref="alg1.l3.m1.4.4.1.1"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">0</cn><cn type="integer" id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">1</cn><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">…</ci><apply id="alg1.l3.m1.4.4.1.1.1.cmml" xref="alg1.l3.m1.4.4.1.1.1"><minus id="alg1.l3.m1.4.4.1.1.1.1.cmml" xref="alg1.l3.m1.4.4.1.1.1.1"></minus><ci id="alg1.l3.m1.4.4.1.1.1.2.cmml" xref="alg1.l3.m1.4.4.1.1.1.2">𝑇</ci><cn type="integer" id="alg1.l3.m1.4.4.1.1.1.3.cmml" xref="alg1.l3.m1.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.4c">t=0,1,...,T-1</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l4.m1.4" class="ltx_Math" alttext="k=1,2,...,K" display="inline"><semantics id="alg1.l4.m1.4a"><mrow id="alg1.l4.m1.4.5" xref="alg1.l4.m1.4.5.cmml"><mi id="alg1.l4.m1.4.5.2" xref="alg1.l4.m1.4.5.2.cmml">k</mi><mo id="alg1.l4.m1.4.5.1" xref="alg1.l4.m1.4.5.1.cmml">=</mo><mrow id="alg1.l4.m1.4.5.3.2" xref="alg1.l4.m1.4.5.3.1.cmml"><mn id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">1</mn><mo id="alg1.l4.m1.4.5.3.2.1" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">2</mn><mo id="alg1.l4.m1.4.5.3.2.2" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">…</mi><mo id="alg1.l4.m1.4.5.3.2.3" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l4.m1.4.4" xref="alg1.l4.m1.4.4.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.4b"><apply id="alg1.l4.m1.4.5.cmml" xref="alg1.l4.m1.4.5"><eq id="alg1.l4.m1.4.5.1.cmml" xref="alg1.l4.m1.4.5.1"></eq><ci id="alg1.l4.m1.4.5.2.cmml" xref="alg1.l4.m1.4.5.2">𝑘</ci><list id="alg1.l4.m1.4.5.3.1.cmml" xref="alg1.l4.m1.4.5.3.2"><cn type="integer" id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">1</cn><cn type="integer" id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">2</cn><ci id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3">…</ci><ci id="alg1.l4.m1.4.4.cmml" xref="alg1.l4.m1.4.4">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.4c">k=1,2,...,K</annotation></semantics></math> <span id="alg1.l4.3" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l4.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        Send <math id="alg1.l5.m1.2" class="ltx_Math" alttext="\{\bm{\theta}^{t},\bm{W}_{\mathbb{P}}\}" display="inline"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.3.cmml"><mo stretchy="false" id="alg1.l5.m1.2.2.2.3" xref="alg1.l5.m1.2.2.3.cmml">{</mo><msup id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.2.cmml">𝜽</mi><mi id="alg1.l5.m1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.3.cmml">t</mi></msup><mo id="alg1.l5.m1.2.2.2.4" xref="alg1.l5.m1.2.2.3.cmml">,</mo><msub id="alg1.l5.m1.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.cmml"><mi id="alg1.l5.m1.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.cmml">𝑾</mi><mi id="alg1.l5.m1.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.3.cmml">ℙ</mi></msub><mo stretchy="false" id="alg1.l5.m1.2.2.2.5" xref="alg1.l5.m1.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><set id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.2"><apply id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.2">𝜽</ci><ci id="alg1.l5.m1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l5.m1.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2">𝑾</ci><ci id="alg1.l5.m1.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.3">ℙ</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">\{\bm{\theta}^{t},\bm{W}_{\mathbb{P}}\}</annotation></semantics></math> to client <math id="alg1.l5.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l5.m2.1a"><mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">k</annotation></semantics></math> if <math id="alg1.l5.m3.1" class="ltx_Math" alttext="t=0" display="inline"><semantics id="alg1.l5.m3.1a"><mrow id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml"><mi id="alg1.l5.m3.1.1.2" xref="alg1.l5.m3.1.1.2.cmml">t</mi><mo id="alg1.l5.m3.1.1.1" xref="alg1.l5.m3.1.1.1.cmml">=</mo><mn id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1"><eq id="alg1.l5.m3.1.1.1.cmml" xref="alg1.l5.m3.1.1.1"></eq><ci id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1.2">𝑡</ci><cn type="integer" id="alg1.l5.m3.1.1.3.cmml" xref="alg1.l5.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">t=0</annotation></semantics></math> else <math id="alg1.l5.m4.1" class="ltx_Math" alttext="\bm{\theta}^{t}" display="inline"><semantics id="alg1.l5.m4.1a"><msup id="alg1.l5.m4.1.1" xref="alg1.l5.m4.1.1.cmml"><mi id="alg1.l5.m4.1.1.2" xref="alg1.l5.m4.1.1.2.cmml">𝜽</mi><mi id="alg1.l5.m4.1.1.3" xref="alg1.l5.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l5.m4.1b"><apply id="alg1.l5.m4.1.1.cmml" xref="alg1.l5.m4.1.1"><csymbol cd="ambiguous" id="alg1.l5.m4.1.1.1.cmml" xref="alg1.l5.m4.1.1">superscript</csymbol><ci id="alg1.l5.m4.1.1.2.cmml" xref="alg1.l5.m4.1.1.2">𝜽</ci><ci id="alg1.l5.m4.1.1.3.cmml" xref="alg1.l5.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m4.1c">\bm{\theta}^{t}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\bm{\theta}_{k}^{t+1}\leftarrow" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msubsup id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.2.2.2" xref="alg1.l6.m1.1.1.2.2.2.cmml">𝜽</mi><mi id="alg1.l6.m1.1.1.2.2.3" xref="alg1.l6.m1.1.1.2.2.3.cmml">k</mi><mrow id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml"><mi id="alg1.l6.m1.1.1.2.3.2" xref="alg1.l6.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l6.m1.1.1.2.3.1" xref="alg1.l6.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l6.m1.1.1.2.3.3" xref="alg1.l6.m1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">←</mo><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">superscript</csymbol><apply id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.2.1.cmml" xref="alg1.l6.m1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.2.cmml" xref="alg1.l6.m1.1.1.2.2.2">𝜽</ci><ci id="alg1.l6.m1.1.1.2.2.3.cmml" xref="alg1.l6.m1.1.1.2.2.3">𝑘</ci></apply><apply id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3"><plus id="alg1.l6.m1.1.1.2.3.1.cmml" xref="alg1.l6.m1.1.1.2.3.1"></plus><ci id="alg1.l6.m1.1.1.2.3.2.cmml" xref="alg1.l6.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l6.m1.1.1.2.3.3.cmml" xref="alg1.l6.m1.1.1.2.3.3">1</cn></apply></apply><csymbol cd="latexml" id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\bm{\theta}_{k}^{t+1}\leftarrow</annotation></semantics></math> <span id="alg1.l6.2" class="ltx_text ltx_font_bold ltx_font_italic">HPL:</span> <span id="alg1.l6.3" class="ltx_text ltx_font_bold">Client executes</span>(<math id="alg1.l6.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l6.m2.1a"><mi id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><ci id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">k</annotation></semantics></math>, <math id="alg1.l6.m3.1" class="ltx_Math" alttext="\bm{\theta}^{t}" display="inline"><semantics id="alg1.l6.m3.1a"><msup id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml"><mi id="alg1.l6.m3.1.1.2" xref="alg1.l6.m3.1.1.2.cmml">𝜽</mi><mi id="alg1.l6.m3.1.1.3" xref="alg1.l6.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b"><apply id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1"><csymbol cd="ambiguous" id="alg1.l6.m3.1.1.1.cmml" xref="alg1.l6.m3.1.1">superscript</csymbol><ci id="alg1.l6.m3.1.1.2.cmml" xref="alg1.l6.m3.1.1.2">𝜽</ci><ci id="alg1.l6.m3.1.1.3.cmml" xref="alg1.l6.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.1c">\bm{\theta}^{t}</annotation></semantics></math>)

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="alg1.l7.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l7.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="alg1.l8.2" class="ltx_text ltx_font_bold ltx_font_italic">CA:</span> optimize Eq. (<a href="#S4.E10" title="In Motivation. ‣ 4.5 Consistent Aggregation ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) with CU and update parameters of <math id="alg1.l8.m1.1" class="ltx_Math" alttext="\bm{\theta}^{t+1}" display="inline"><semantics id="alg1.l8.m1.1a"><msup id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">𝜽</mi><mrow id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml">t</mi><mo id="alg1.l8.m1.1.1.3.1" xref="alg1.l8.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">superscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝜽</ci><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><plus id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3.1"></plus><ci id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l8.m1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\bm{\theta}^{t+1}</annotation></semantics></math> by Eq. (<a href="#S4.E8" title="In Motivation. ‣ 4.5 Consistent Aggregation ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>)

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>  <span id="alg1.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>  <span id="alg1.l10.2" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l10.m1.3" class="ltx_Math" alttext="\bm{\theta}^{T},\bm{W}_{\mathbb{P}},\{\bm{\theta}_{k}^{T}\}" display="inline"><semantics id="alg1.l10.m1.3a"><mrow id="alg1.l10.m1.3.3.3" xref="alg1.l10.m1.3.3.4.cmml"><msup id="alg1.l10.m1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.2.cmml">𝜽</mi><mi id="alg1.l10.m1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.3.cmml">T</mi></msup><mo id="alg1.l10.m1.3.3.3.4" xref="alg1.l10.m1.3.3.4.cmml">,</mo><msub id="alg1.l10.m1.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.cmml"><mi id="alg1.l10.m1.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.cmml">𝑾</mi><mi id="alg1.l10.m1.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.3.cmml">ℙ</mi></msub><mo id="alg1.l10.m1.3.3.3.5" xref="alg1.l10.m1.3.3.4.cmml">,</mo><mrow id="alg1.l10.m1.3.3.3.3.1" xref="alg1.l10.m1.3.3.3.3.2.cmml"><mo stretchy="false" id="alg1.l10.m1.3.3.3.3.1.2" xref="alg1.l10.m1.3.3.3.3.2.cmml">{</mo><msubsup id="alg1.l10.m1.3.3.3.3.1.1" xref="alg1.l10.m1.3.3.3.3.1.1.cmml"><mi id="alg1.l10.m1.3.3.3.3.1.1.2.2" xref="alg1.l10.m1.3.3.3.3.1.1.2.2.cmml">𝜽</mi><mi id="alg1.l10.m1.3.3.3.3.1.1.2.3" xref="alg1.l10.m1.3.3.3.3.1.1.2.3.cmml">k</mi><mi id="alg1.l10.m1.3.3.3.3.1.1.3" xref="alg1.l10.m1.3.3.3.3.1.1.3.cmml">T</mi></msubsup><mo stretchy="false" id="alg1.l10.m1.3.3.3.3.1.3" xref="alg1.l10.m1.3.3.3.3.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.3b"><list id="alg1.l10.m1.3.3.4.cmml" xref="alg1.l10.m1.3.3.3"><apply id="alg1.l10.m1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.2">𝜽</ci><ci id="alg1.l10.m1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.3">𝑇</ci></apply><apply id="alg1.l10.m1.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l10.m1.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2">𝑾</ci><ci id="alg1.l10.m1.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.3">ℙ</ci></apply><set id="alg1.l10.m1.3.3.3.3.2.cmml" xref="alg1.l10.m1.3.3.3.3.1"><apply id="alg1.l10.m1.3.3.3.3.1.1.cmml" xref="alg1.l10.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.3.3.3.3.1.1.1.cmml" xref="alg1.l10.m1.3.3.3.3.1.1">superscript</csymbol><apply id="alg1.l10.m1.3.3.3.3.1.1.2.cmml" xref="alg1.l10.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.3.3.3.3.1.1.2.1.cmml" xref="alg1.l10.m1.3.3.3.3.1.1">subscript</csymbol><ci id="alg1.l10.m1.3.3.3.3.1.1.2.2.cmml" xref="alg1.l10.m1.3.3.3.3.1.1.2.2">𝜽</ci><ci id="alg1.l10.m1.3.3.3.3.1.1.2.3.cmml" xref="alg1.l10.m1.3.3.3.3.1.1.2.3">𝑘</ci></apply><ci id="alg1.l10.m1.3.3.3.3.1.1.3.cmml" xref="alg1.l10.m1.3.3.3.3.1.1.3">𝑇</ci></apply></set></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.3c">\bm{\theta}^{T},\bm{W}_{\mathbb{P}},\{\bm{\theta}_{k}^{T}\}</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>  <span id="alg1.l11.2" class="ltx_text ltx_font_bold ltx_font_italic">HPL:</span> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">Client executes</span>(<math id="alg1.l11.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l11.m1.1a"><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">k</annotation></semantics></math>, <math id="alg1.l11.m2.1" class="ltx_Math" alttext="\bm{\theta}^{t}" display="inline"><semantics id="alg1.l11.m2.1a"><msup id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml">𝜽</mi><mi id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1">superscript</csymbol><ci id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">𝜽</ci><ci id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">\bm{\theta}^{t}</annotation></semantics></math>)<span id="alg1.l11.4" class="ltx_text ltx_font_bold">:</span>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>  Assign global model to the local model <math id="alg1.l12.m1.1" class="ltx_Math" alttext="\bm{\theta}_{k}^{t}\leftarrow\bm{\theta}^{t}" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msubsup id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml"><mi id="alg1.l12.m1.1.1.2.2.2" xref="alg1.l12.m1.1.1.2.2.2.cmml">𝜽</mi><mi id="alg1.l12.m1.1.1.2.2.3" xref="alg1.l12.m1.1.1.2.2.3.cmml">k</mi><mi id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">←</mo><msup id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml">𝜽</mi><mi id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2">superscript</csymbol><apply id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.2.1.cmml" xref="alg1.l12.m1.1.1.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.2.cmml" xref="alg1.l12.m1.1.1.2.2.2">𝜽</ci><ci id="alg1.l12.m1.1.1.2.2.3.cmml" xref="alg1.l12.m1.1.1.2.2.3">𝑘</ci></apply><ci id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3">superscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2">𝜽</ci><ci id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\bm{\theta}_{k}^{t}\leftarrow\bm{\theta}^{t}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>  <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span> each local epoch <math id="alg1.l13.m1.4" class="ltx_Math" alttext="e=1,2,...,E" display="inline"><semantics id="alg1.l13.m1.4a"><mrow id="alg1.l13.m1.4.5" xref="alg1.l13.m1.4.5.cmml"><mi id="alg1.l13.m1.4.5.2" xref="alg1.l13.m1.4.5.2.cmml">e</mi><mo id="alg1.l13.m1.4.5.1" xref="alg1.l13.m1.4.5.1.cmml">=</mo><mrow id="alg1.l13.m1.4.5.3.2" xref="alg1.l13.m1.4.5.3.1.cmml"><mn id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">1</mn><mo id="alg1.l13.m1.4.5.3.2.1" xref="alg1.l13.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l13.m1.2.2" xref="alg1.l13.m1.2.2.cmml">2</mn><mo id="alg1.l13.m1.4.5.3.2.2" xref="alg1.l13.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l13.m1.3.3" xref="alg1.l13.m1.3.3.cmml">…</mi><mo id="alg1.l13.m1.4.5.3.2.3" xref="alg1.l13.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l13.m1.4.4" xref="alg1.l13.m1.4.4.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.4b"><apply id="alg1.l13.m1.4.5.cmml" xref="alg1.l13.m1.4.5"><eq id="alg1.l13.m1.4.5.1.cmml" xref="alg1.l13.m1.4.5.1"></eq><ci id="alg1.l13.m1.4.5.2.cmml" xref="alg1.l13.m1.4.5.2">𝑒</ci><list id="alg1.l13.m1.4.5.3.1.cmml" xref="alg1.l13.m1.4.5.3.2"><cn type="integer" id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">1</cn><cn type="integer" id="alg1.l13.m1.2.2.cmml" xref="alg1.l13.m1.2.2">2</cn><ci id="alg1.l13.m1.3.3.cmml" xref="alg1.l13.m1.3.3">…</ci><ci id="alg1.l13.m1.4.4.cmml" xref="alg1.l13.m1.4.4">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.4c">e=1,2,...,E</annotation></semantics></math> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     <span id="alg1.l14.2" class="ltx_text ltx_font_bold">for</span> batch of samples <math id="alg1.l14.m1.6" class="ltx_Math" alttext="(\bm{x}_{k,1:B},\bm{y}_{k,1:B})\in\mathcal{D}_{k}" display="inline"><semantics id="alg1.l14.m1.6a"><mrow id="alg1.l14.m1.6.6" xref="alg1.l14.m1.6.6.cmml"><mrow id="alg1.l14.m1.6.6.2.2" xref="alg1.l14.m1.6.6.2.3.cmml"><mo stretchy="false" id="alg1.l14.m1.6.6.2.2.3" xref="alg1.l14.m1.6.6.2.3.cmml">(</mo><msub id="alg1.l14.m1.5.5.1.1.1" xref="alg1.l14.m1.5.5.1.1.1.cmml"><mi id="alg1.l14.m1.5.5.1.1.1.2" xref="alg1.l14.m1.5.5.1.1.1.2.cmml">𝒙</mi><mrow id="alg1.l14.m1.2.2.2" xref="alg1.l14.m1.2.2.2.cmml"><mrow id="alg1.l14.m1.2.2.2.4.2" xref="alg1.l14.m1.2.2.2.4.1.cmml"><mi id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.cmml">k</mi><mo id="alg1.l14.m1.2.2.2.4.2.1" xref="alg1.l14.m1.2.2.2.4.1.cmml">,</mo><mn id="alg1.l14.m1.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="alg1.l14.m1.2.2.2.3" xref="alg1.l14.m1.2.2.2.3.cmml">:</mo><mi id="alg1.l14.m1.2.2.2.5" xref="alg1.l14.m1.2.2.2.5.cmml">B</mi></mrow></msub><mo id="alg1.l14.m1.6.6.2.2.4" xref="alg1.l14.m1.6.6.2.3.cmml">,</mo><msub id="alg1.l14.m1.6.6.2.2.2" xref="alg1.l14.m1.6.6.2.2.2.cmml"><mi id="alg1.l14.m1.6.6.2.2.2.2" xref="alg1.l14.m1.6.6.2.2.2.2.cmml">𝒚</mi><mrow id="alg1.l14.m1.4.4.2" xref="alg1.l14.m1.4.4.2.cmml"><mrow id="alg1.l14.m1.4.4.2.4.2" xref="alg1.l14.m1.4.4.2.4.1.cmml"><mi id="alg1.l14.m1.3.3.1.1" xref="alg1.l14.m1.3.3.1.1.cmml">k</mi><mo id="alg1.l14.m1.4.4.2.4.2.1" xref="alg1.l14.m1.4.4.2.4.1.cmml">,</mo><mn id="alg1.l14.m1.4.4.2.2" xref="alg1.l14.m1.4.4.2.2.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="alg1.l14.m1.4.4.2.3" xref="alg1.l14.m1.4.4.2.3.cmml">:</mo><mi id="alg1.l14.m1.4.4.2.5" xref="alg1.l14.m1.4.4.2.5.cmml">B</mi></mrow></msub><mo stretchy="false" id="alg1.l14.m1.6.6.2.2.5" xref="alg1.l14.m1.6.6.2.3.cmml">)</mo></mrow><mo id="alg1.l14.m1.6.6.3" xref="alg1.l14.m1.6.6.3.cmml">∈</mo><msub id="alg1.l14.m1.6.6.4" xref="alg1.l14.m1.6.6.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m1.6.6.4.2" xref="alg1.l14.m1.6.6.4.2.cmml">𝒟</mi><mi id="alg1.l14.m1.6.6.4.3" xref="alg1.l14.m1.6.6.4.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.6b"><apply id="alg1.l14.m1.6.6.cmml" xref="alg1.l14.m1.6.6"><in id="alg1.l14.m1.6.6.3.cmml" xref="alg1.l14.m1.6.6.3"></in><interval closure="open" id="alg1.l14.m1.6.6.2.3.cmml" xref="alg1.l14.m1.6.6.2.2"><apply id="alg1.l14.m1.5.5.1.1.1.cmml" xref="alg1.l14.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.5.5.1.1.1.1.cmml" xref="alg1.l14.m1.5.5.1.1.1">subscript</csymbol><ci id="alg1.l14.m1.5.5.1.1.1.2.cmml" xref="alg1.l14.m1.5.5.1.1.1.2">𝒙</ci><apply id="alg1.l14.m1.2.2.2.cmml" xref="alg1.l14.m1.2.2.2"><ci id="alg1.l14.m1.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.3">:</ci><list id="alg1.l14.m1.2.2.2.4.1.cmml" xref="alg1.l14.m1.2.2.2.4.2"><ci id="alg1.l14.m1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1">𝑘</ci><cn type="integer" id="alg1.l14.m1.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2">1</cn></list><ci id="alg1.l14.m1.2.2.2.5.cmml" xref="alg1.l14.m1.2.2.2.5">𝐵</ci></apply></apply><apply id="alg1.l14.m1.6.6.2.2.2.cmml" xref="alg1.l14.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.6.6.2.2.2.1.cmml" xref="alg1.l14.m1.6.6.2.2.2">subscript</csymbol><ci id="alg1.l14.m1.6.6.2.2.2.2.cmml" xref="alg1.l14.m1.6.6.2.2.2.2">𝒚</ci><apply id="alg1.l14.m1.4.4.2.cmml" xref="alg1.l14.m1.4.4.2"><ci id="alg1.l14.m1.4.4.2.3.cmml" xref="alg1.l14.m1.4.4.2.3">:</ci><list id="alg1.l14.m1.4.4.2.4.1.cmml" xref="alg1.l14.m1.4.4.2.4.2"><ci id="alg1.l14.m1.3.3.1.1.cmml" xref="alg1.l14.m1.3.3.1.1">𝑘</ci><cn type="integer" id="alg1.l14.m1.4.4.2.2.cmml" xref="alg1.l14.m1.4.4.2.2">1</cn></list><ci id="alg1.l14.m1.4.4.2.5.cmml" xref="alg1.l14.m1.4.4.2.5">𝐵</ci></apply></apply></interval><apply id="alg1.l14.m1.6.6.4.cmml" xref="alg1.l14.m1.6.6.4"><csymbol cd="ambiguous" id="alg1.l14.m1.6.6.4.1.cmml" xref="alg1.l14.m1.6.6.4">subscript</csymbol><ci id="alg1.l14.m1.6.6.4.2.cmml" xref="alg1.l14.m1.6.6.4.2">𝒟</ci><ci id="alg1.l14.m1.6.6.4.3.cmml" xref="alg1.l14.m1.6.6.4.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.6c">(\bm{x}_{k,1:B},\bm{y}_{k,1:B})\in\mathcal{D}_{k}</annotation></semantics></math> <span id="alg1.l14.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>        Feature extraction <math id="alg1.l15.m1.5" class="ltx_Math" alttext="\bm{z}_{k,1:B}\leftarrow\mathcal{F}_{\bm{\theta}_{k}^{e}}(\bm{x}_{k,1:B})" display="inline"><semantics id="alg1.l15.m1.5a"><mrow id="alg1.l15.m1.5.5" xref="alg1.l15.m1.5.5.cmml"><msub id="alg1.l15.m1.5.5.3" xref="alg1.l15.m1.5.5.3.cmml"><mi id="alg1.l15.m1.5.5.3.2" xref="alg1.l15.m1.5.5.3.2.cmml">𝒛</mi><mrow id="alg1.l15.m1.2.2.2" xref="alg1.l15.m1.2.2.2.cmml"><mrow id="alg1.l15.m1.2.2.2.4.2" xref="alg1.l15.m1.2.2.2.4.1.cmml"><mi id="alg1.l15.m1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.cmml">k</mi><mo id="alg1.l15.m1.2.2.2.4.2.1" xref="alg1.l15.m1.2.2.2.4.1.cmml">,</mo><mn id="alg1.l15.m1.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="alg1.l15.m1.2.2.2.3" xref="alg1.l15.m1.2.2.2.3.cmml">:</mo><mi id="alg1.l15.m1.2.2.2.5" xref="alg1.l15.m1.2.2.2.5.cmml">B</mi></mrow></msub><mo stretchy="false" id="alg1.l15.m1.5.5.2" xref="alg1.l15.m1.5.5.2.cmml">←</mo><mrow id="alg1.l15.m1.5.5.1" xref="alg1.l15.m1.5.5.1.cmml"><msub id="alg1.l15.m1.5.5.1.3" xref="alg1.l15.m1.5.5.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.5.5.1.3.2" xref="alg1.l15.m1.5.5.1.3.2.cmml">ℱ</mi><msubsup id="alg1.l15.m1.5.5.1.3.3" xref="alg1.l15.m1.5.5.1.3.3.cmml"><mi id="alg1.l15.m1.5.5.1.3.3.2.2" xref="alg1.l15.m1.5.5.1.3.3.2.2.cmml">𝜽</mi><mi id="alg1.l15.m1.5.5.1.3.3.2.3" xref="alg1.l15.m1.5.5.1.3.3.2.3.cmml">k</mi><mi id="alg1.l15.m1.5.5.1.3.3.3" xref="alg1.l15.m1.5.5.1.3.3.3.cmml">e</mi></msubsup></msub><mo lspace="0em" rspace="0em" id="alg1.l15.m1.5.5.1.2" xref="alg1.l15.m1.5.5.1.2.cmml">​</mo><mrow id="alg1.l15.m1.5.5.1.1.1" xref="alg1.l15.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l15.m1.5.5.1.1.1.2" xref="alg1.l15.m1.5.5.1.1.1.1.cmml">(</mo><msub id="alg1.l15.m1.5.5.1.1.1.1" xref="alg1.l15.m1.5.5.1.1.1.1.cmml"><mi id="alg1.l15.m1.5.5.1.1.1.1.2" xref="alg1.l15.m1.5.5.1.1.1.1.2.cmml">𝒙</mi><mrow id="alg1.l15.m1.4.4.2" xref="alg1.l15.m1.4.4.2.cmml"><mrow id="alg1.l15.m1.4.4.2.4.2" xref="alg1.l15.m1.4.4.2.4.1.cmml"><mi id="alg1.l15.m1.3.3.1.1" xref="alg1.l15.m1.3.3.1.1.cmml">k</mi><mo id="alg1.l15.m1.4.4.2.4.2.1" xref="alg1.l15.m1.4.4.2.4.1.cmml">,</mo><mn id="alg1.l15.m1.4.4.2.2" xref="alg1.l15.m1.4.4.2.2.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="alg1.l15.m1.4.4.2.3" xref="alg1.l15.m1.4.4.2.3.cmml">:</mo><mi id="alg1.l15.m1.4.4.2.5" xref="alg1.l15.m1.4.4.2.5.cmml">B</mi></mrow></msub><mo stretchy="false" id="alg1.l15.m1.5.5.1.1.1.3" xref="alg1.l15.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.5b"><apply id="alg1.l15.m1.5.5.cmml" xref="alg1.l15.m1.5.5"><ci id="alg1.l15.m1.5.5.2.cmml" xref="alg1.l15.m1.5.5.2">←</ci><apply id="alg1.l15.m1.5.5.3.cmml" xref="alg1.l15.m1.5.5.3"><csymbol cd="ambiguous" id="alg1.l15.m1.5.5.3.1.cmml" xref="alg1.l15.m1.5.5.3">subscript</csymbol><ci id="alg1.l15.m1.5.5.3.2.cmml" xref="alg1.l15.m1.5.5.3.2">𝒛</ci><apply id="alg1.l15.m1.2.2.2.cmml" xref="alg1.l15.m1.2.2.2"><ci id="alg1.l15.m1.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.3">:</ci><list id="alg1.l15.m1.2.2.2.4.1.cmml" xref="alg1.l15.m1.2.2.2.4.2"><ci id="alg1.l15.m1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1">𝑘</ci><cn type="integer" id="alg1.l15.m1.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2">1</cn></list><ci id="alg1.l15.m1.2.2.2.5.cmml" xref="alg1.l15.m1.2.2.2.5">𝐵</ci></apply></apply><apply id="alg1.l15.m1.5.5.1.cmml" xref="alg1.l15.m1.5.5.1"><times id="alg1.l15.m1.5.5.1.2.cmml" xref="alg1.l15.m1.5.5.1.2"></times><apply id="alg1.l15.m1.5.5.1.3.cmml" xref="alg1.l15.m1.5.5.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.5.5.1.3.1.cmml" xref="alg1.l15.m1.5.5.1.3">subscript</csymbol><ci id="alg1.l15.m1.5.5.1.3.2.cmml" xref="alg1.l15.m1.5.5.1.3.2">ℱ</ci><apply id="alg1.l15.m1.5.5.1.3.3.cmml" xref="alg1.l15.m1.5.5.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.5.5.1.3.3.1.cmml" xref="alg1.l15.m1.5.5.1.3.3">superscript</csymbol><apply id="alg1.l15.m1.5.5.1.3.3.2.cmml" xref="alg1.l15.m1.5.5.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.5.5.1.3.3.2.1.cmml" xref="alg1.l15.m1.5.5.1.3.3">subscript</csymbol><ci id="alg1.l15.m1.5.5.1.3.3.2.2.cmml" xref="alg1.l15.m1.5.5.1.3.3.2.2">𝜽</ci><ci id="alg1.l15.m1.5.5.1.3.3.2.3.cmml" xref="alg1.l15.m1.5.5.1.3.3.2.3">𝑘</ci></apply><ci id="alg1.l15.m1.5.5.1.3.3.3.cmml" xref="alg1.l15.m1.5.5.1.3.3.3">𝑒</ci></apply></apply><apply id="alg1.l15.m1.5.5.1.1.1.1.cmml" xref="alg1.l15.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.5.5.1.1.1.1.1.cmml" xref="alg1.l15.m1.5.5.1.1.1">subscript</csymbol><ci id="alg1.l15.m1.5.5.1.1.1.1.2.cmml" xref="alg1.l15.m1.5.5.1.1.1.1.2">𝒙</ci><apply id="alg1.l15.m1.4.4.2.cmml" xref="alg1.l15.m1.4.4.2"><ci id="alg1.l15.m1.4.4.2.3.cmml" xref="alg1.l15.m1.4.4.2.3">:</ci><list id="alg1.l15.m1.4.4.2.4.1.cmml" xref="alg1.l15.m1.4.4.2.4.2"><ci id="alg1.l15.m1.3.3.1.1.cmml" xref="alg1.l15.m1.3.3.1.1">𝑘</ci><cn type="integer" id="alg1.l15.m1.4.4.2.2.cmml" xref="alg1.l15.m1.4.4.2.2">1</cn></list><ci id="alg1.l15.m1.4.4.2.5.cmml" xref="alg1.l15.m1.4.4.2.5">𝐵</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.5c">\bm{z}_{k,1:B}\leftarrow\mathcal{F}_{\bm{\theta}_{k}^{e}}(\bm{x}_{k,1:B})</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>        Project <math id="alg1.l16.m1.2" class="ltx_Math" alttext="\bm{z}_{k,1:B}" display="inline"><semantics id="alg1.l16.m1.2a"><msub id="alg1.l16.m1.2.3" xref="alg1.l16.m1.2.3.cmml"><mi id="alg1.l16.m1.2.3.2" xref="alg1.l16.m1.2.3.2.cmml">𝒛</mi><mrow id="alg1.l16.m1.2.2.2" xref="alg1.l16.m1.2.2.2.cmml"><mrow id="alg1.l16.m1.2.2.2.4.2" xref="alg1.l16.m1.2.2.2.4.1.cmml"><mi id="alg1.l16.m1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.cmml">k</mi><mo id="alg1.l16.m1.2.2.2.4.2.1" xref="alg1.l16.m1.2.2.2.4.1.cmml">,</mo><mn id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.cmml">1</mn></mrow><mo lspace="0.278em" rspace="0.278em" id="alg1.l16.m1.2.2.2.3" xref="alg1.l16.m1.2.2.2.3.cmml">:</mo><mi id="alg1.l16.m1.2.2.2.5" xref="alg1.l16.m1.2.2.2.5.cmml">B</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.3.cmml" xref="alg1.l16.m1.2.3"><csymbol cd="ambiguous" id="alg1.l16.m1.2.3.1.cmml" xref="alg1.l16.m1.2.3">subscript</csymbol><ci id="alg1.l16.m1.2.3.2.cmml" xref="alg1.l16.m1.2.3.2">𝒛</ci><apply id="alg1.l16.m1.2.2.2.cmml" xref="alg1.l16.m1.2.2.2"><ci id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.3">:</ci><list id="alg1.l16.m1.2.2.2.4.1.cmml" xref="alg1.l16.m1.2.2.2.4.2"><ci id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1">𝑘</ci><cn type="integer" id="alg1.l16.m1.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2">1</cn></list><ci id="alg1.l16.m1.2.2.2.5.cmml" xref="alg1.l16.m1.2.2.2.5">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">\bm{z}_{k,1:B}</annotation></semantics></math> to Poincaré ball by Eq. (<a href="#S4.E6" title="In Motivation. ‣ 4.4 Hyperbolic Prototype Learning ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>)

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>        Compute loss <math id="alg1.l17.m1.1" class="ltx_Math" alttext="\mathbf{L}_{k}^{R}" display="inline"><semantics id="alg1.l17.m1.1a"><msubsup id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2.2" xref="alg1.l17.m1.1.1.2.2.cmml">𝐋</mi><mi id="alg1.l17.m1.1.1.2.3" xref="alg1.l17.m1.1.1.2.3.cmml">k</mi><mi id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml">R</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1">superscript</csymbol><apply id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.2.2">𝐋</ci><ci id="alg1.l17.m1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">\mathbf{L}_{k}^{R}</annotation></semantics></math> by Eq. (<a href="#S4.E7" title="In Motivation. ‣ 4.4 Hyperbolic Prototype Learning ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>)

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>        Update parameters of <math id="alg1.l18.m1.1" class="ltx_Math" alttext="\bm{\theta}_{k}^{e}" display="inline"><semantics id="alg1.l18.m1.1a"><msubsup id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><mi id="alg1.l18.m1.1.1.2.2" xref="alg1.l18.m1.1.1.2.2.cmml">𝜽</mi><mi id="alg1.l18.m1.1.1.2.3" xref="alg1.l18.m1.1.1.2.3.cmml">k</mi><mi id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml">e</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1">superscript</csymbol><apply id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1">subscript</csymbol><ci id="alg1.l18.m1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.2.2">𝜽</ci><ci id="alg1.l18.m1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">\bm{\theta}_{k}^{e}</annotation></semantics></math>
by RSGD

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>     <span id="alg1.l19.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>  <span id="alg1.l20.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l20.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>  <span id="alg1.l21.2" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l21.m1.1" class="ltx_Math" alttext="\bm{\theta}_{k}^{E}" display="inline"><semantics id="alg1.l21.m1.1a"><msubsup id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi id="alg1.l21.m1.1.1.2.2" xref="alg1.l21.m1.1.1.2.2.cmml">𝜽</mi><mi id="alg1.l21.m1.1.1.2.3" xref="alg1.l21.m1.1.1.2.3.cmml">k</mi><mi id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml">E</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1">superscript</csymbol><apply id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.2.1.cmml" xref="alg1.l21.m1.1.1">subscript</csymbol><ci id="alg1.l21.m1.1.1.2.2.cmml" xref="alg1.l21.m1.1.1.2.2">𝜽</ci><ci id="alg1.l21.m1.1.1.2.3.cmml" xref="alg1.l21.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">\bm{\theta}_{k}^{E}</annotation></semantics></math> to server

</div>
</div>
</div>
</div>
</figure>
</section>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Consistent Aggregation</h3>

<section id="S4.SS5.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Motivation.</h4>

<div id="S4.SS5.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS5.SSS0.Px1.p1.1" class="ltx_p">Finally, we introduce CA which mitigates the inconsistent deviations from clients to server caused by the statistically heterogeneous data distributions.
In FL aggregation,
CA first formulates the aggregation of local feature extractors in <span id="S4.SS5.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span> 
as a multi-objective optimization.
Then CA applies consistent updating (CU) to pick the toughest client, i.e., the client with the most divergent deviation, and alleviate the inconsistency between the toughest client and the remaining clients.
Lastly, CU iteratively optimizes this multi-objective optimization to yield a Pareto optimal solution and obtain the
weight ratio of different client models.</p>
</div>
<div id="S4.SS5.SSS0.Px1.p2" class="ltx_para">
<p id="S4.SS5.SSS0.Px1.p2.7" class="ltx_p">We formulate the aggregation as a multi-objective optimization in the following.
Specifically, we first compute the different deviations from clients to server as multiple objectives, then the goal of alleviating the inconsistency of these deviations can be achieved by multiple-objective optimization.
We obtain the combination of local parameters in server:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.1" class="ltx_Math" alttext="\bm{\theta}^{t+1}=\bm{\theta}^{t}+\Sigma_{k=1}^{K}p_{k}\left(\bm{\theta}_{k}^{t+1}-\bm{\theta}^{t}\right)," display="block"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><mrow id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><msup id="S4.E8.m1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.3.2.cmml">𝜽</mi><mrow id="S4.E8.m1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.3.3.cmml"><mi id="S4.E8.m1.1.1.1.1.3.3.2" xref="S4.E8.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S4.E8.m1.1.1.1.1.3.3.1" xref="S4.E8.m1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.E8.m1.1.1.1.1.3.3.3" xref="S4.E8.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msup><mo id="S4.E8.m1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.cmml"><msup id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.1.3.2.cmml">𝜽</mi><mi id="S4.E8.m1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.3.3.cmml">t</mi></msup><mo id="S4.E8.m1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><msubsup id="S4.E8.m1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E8.m1.1.1.1.1.1.1.3.2.2" xref="S4.E8.m1.1.1.1.1.1.1.3.2.2.cmml">Σ</mi><mrow id="S4.E8.m1.1.1.1.1.1.1.3.2.3" xref="S4.E8.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.3.2.3.2" xref="S4.E8.m1.1.1.1.1.1.1.3.2.3.2.cmml">k</mi><mo id="S4.E8.m1.1.1.1.1.1.1.3.2.3.1" xref="S4.E8.m1.1.1.1.1.1.1.3.2.3.1.cmml">=</mo><mn id="S4.E8.m1.1.1.1.1.1.1.3.2.3.3" xref="S4.E8.m1.1.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E8.m1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.1.3.3.cmml">K</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S4.E8.m1.1.1.1.1.1.1.4" xref="S4.E8.m1.1.1.1.1.1.1.4.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.4.2" xref="S4.E8.m1.1.1.1.1.1.1.4.2.cmml">p</mi><mi id="S4.E8.m1.1.1.1.1.1.1.4.3" xref="S4.E8.m1.1.1.1.1.1.1.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.1.1.2a" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝜽</mi><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">k</mi><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S4.E8.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝜽</mi><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><eq id="S4.E8.m1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.2"></eq><apply id="S4.E8.m1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3">superscript</csymbol><ci id="S4.E8.m1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.2">𝜽</ci><apply id="S4.E8.m1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3"><plus id="S4.E8.m1.1.1.1.1.3.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3.3.1"></plus><ci id="S4.E8.m1.1.1.1.1.3.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S4.E8.m1.1.1.1.1.3.3.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S4.E8.m1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><plus id="S4.E8.m1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.2"></plus><apply id="S4.E8.m1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.3.2">𝜽</ci><ci id="S4.E8.m1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1"><times id="S4.E8.m1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2"></times><apply id="S4.E8.m1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.2.2">Σ</ci><apply id="S4.E8.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.2.3"><eq id="S4.E8.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.2.3.1"></eq><ci id="S4.E8.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.2.3.2">𝑘</ci><cn type="integer" id="S4.E8.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S4.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.3">𝐾</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.4.cmml" xref="S4.E8.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.4.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.4.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.4.2">𝑝</ci><ci id="S4.E8.m1.1.1.1.1.1.1.4.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.4.3">𝑘</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1"><minus id="S4.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝜽</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3"><plus id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.2">𝜽</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\bm{\theta}^{t+1}=\bm{\theta}^{t}+\Sigma_{k=1}^{K}p_{k}\left(\bm{\theta}_{k}^{t+1}-\bm{\theta}^{t}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS5.SSS0.Px1.p2.6" class="ltx_p">where <math id="S4.SS5.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="\bm{\theta}^{t}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p2.1.m1.1a"><msup id="S4.SS5.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.2" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1.2.cmml">𝜽</mi><mi id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.3" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p2.1.m1.1b"><apply id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1.2">𝜽</ci><ci id="S4.SS5.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p2.1.m1.1c">\bm{\theta}^{t}</annotation></semantics></math> is the global model and <math id="S4.SS5.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="\bm{\theta}_{k}^{t}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p2.2.m2.1a"><msubsup id="S4.SS5.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2.2" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2.2.cmml">𝜽</mi><mi id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2.3" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2.3.cmml">k</mi><mi id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.3" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p2.2.m2.1b"><apply id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1">superscript</csymbol><apply id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2.1.cmml" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2.2.cmml" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2.2">𝜽</ci><ci id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2.3.cmml" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.2.3">𝑘</ci></apply><ci id="S4.SS5.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p2.2.m2.1c">\bm{\theta}_{k}^{t}</annotation></semantics></math> is the local model of the client <math id="S4.SS5.SSS0.Px1.p2.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS5.SSS0.Px1.p2.3.m3.1a"><mi id="S4.SS5.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS5.SSS0.Px1.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p2.3.m3.1b"><ci id="S4.SS5.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p2.3.m3.1c">k</annotation></semantics></math> at <math id="S4.SS5.SSS0.Px1.p2.4.m4.1" class="ltx_Math" alttext="t-" display="inline"><semantics id="S4.SS5.SSS0.Px1.p2.4.m4.1a"><mrow id="S4.SS5.SSS0.Px1.p2.4.m4.1.1" xref="S4.SS5.SSS0.Px1.p2.4.m4.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p2.4.m4.1.1.2" xref="S4.SS5.SSS0.Px1.p2.4.m4.1.1.2.cmml">t</mi><mo id="S4.SS5.SSS0.Px1.p2.4.m4.1.1.3" xref="S4.SS5.SSS0.Px1.p2.4.m4.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p2.4.m4.1b"><apply id="S4.SS5.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.4.m4.1.1"><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.4.m4.1.1">limit-from</csymbol><ci id="S4.SS5.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p2.4.m4.1.1.2">𝑡</ci><minus id="S4.SS5.SSS0.Px1.p2.4.m4.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p2.4.m4.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p2.4.m4.1c">t-</annotation></semantics></math>th communication.
Next, we denote global and client deviations, i.e., <math id="S4.SS5.SSS0.Px1.p2.5.m5.1" class="ltx_Math" alttext="\Delta_{\bm{\theta}}^{t+1}=\bm{\theta}^{t+1}-\bm{\theta}^{t}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p2.5.m5.1a"><mrow id="S4.SS5.SSS0.Px1.p2.5.m5.1.1" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.cmml"><msubsup id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.2.2" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.2.2.cmml">Δ</mi><mi id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.2.3" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.2.3.cmml">𝜽</mi><mrow id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.cmml"><mi id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.2" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.2.cmml">t</mi><mo id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.1" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.1.cmml">+</mo><mn id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.3" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.1" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.1.cmml">=</mo><mrow id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.cmml"><msup id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.cmml"><mi id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.2" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.2.cmml">𝜽</mi><mrow id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.cmml"><mi id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.2" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.2.cmml">t</mi><mo id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.1" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.1.cmml">+</mo><mn id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.3" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.3.cmml">1</mn></mrow></msup><mo id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.1" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.1.cmml">−</mo><msup id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3.cmml"><mi id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3.2" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3.2.cmml">𝜽</mi><mi id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3.3" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3.3.cmml">t</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p2.5.m5.1b"><apply id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1"><eq id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.1"></eq><apply id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.1.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2">superscript</csymbol><apply id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.2.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.2.2">Δ</ci><ci id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.2.3">𝜽</ci></apply><apply id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3"><plus id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.1.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.1"></plus><ci id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.2.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.3.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3"><minus id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.1.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.1"></minus><apply id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.1.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2">superscript</csymbol><ci id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.2.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.2">𝜽</ci><apply id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3"><plus id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.1.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.1"></plus><ci id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.2.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.3.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.2.3.3">1</cn></apply></apply><apply id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3.1.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3">superscript</csymbol><ci id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3.2.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3.2">𝜽</ci><ci id="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3.3.cmml" xref="S4.SS5.SSS0.Px1.p2.5.m5.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p2.5.m5.1c">\Delta_{\bm{\theta}}^{t+1}=\bm{\theta}^{t+1}-\bm{\theta}^{t}</annotation></semantics></math> and <math id="S4.SS5.SSS0.Px1.p2.6.m6.1" class="ltx_Math" alttext="\Delta_{\bm{\theta}_{k}}^{t+1}=\bm{\theta}_{k}^{t+1}-\bm{\theta}^{t}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p2.6.m6.1a"><mrow id="S4.SS5.SSS0.Px1.p2.6.m6.1.1" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.cmml"><msubsup id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.2" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.2.cmml">Δ</mi><msub id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3.cmml"><mi id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3.2" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3.2.cmml">𝜽</mi><mi id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3.3" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3.3.cmml">k</mi></msub><mrow id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.cmml"><mi id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.2" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.2.cmml">t</mi><mo id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.1" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.1.cmml">+</mo><mn id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.3" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.1" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.1.cmml">=</mo><mrow id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.cmml"><msubsup id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.cmml"><mi id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.2.2" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.2.2.cmml">𝜽</mi><mi id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.2.3" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.cmml">k</mi><mrow id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.cmml"><mi id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.2" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.2.cmml">t</mi><mo id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.1" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.1.cmml">+</mo><mn id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.3" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.1" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.1.cmml">−</mo><msup id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3.cmml"><mi id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3.2" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3.2.cmml">𝜽</mi><mi id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3.3" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3.3.cmml">t</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p2.6.m6.1b"><apply id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1"><eq id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.1"></eq><apply id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.1.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2">superscript</csymbol><apply id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.2">Δ</ci><apply id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3.1.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3.2.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3.2">𝜽</ci><ci id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3.3.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.2.3.3">𝑘</ci></apply></apply><apply id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3"><plus id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.1.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.1"></plus><ci id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.2.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.3.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3"><minus id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.1.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.1"></minus><apply id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.1.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2">superscript</csymbol><apply id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.2.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.2.2">𝜽</ci><ci id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.2.3">𝑘</ci></apply><apply id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3"><plus id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.1.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.1"></plus><ci id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.2.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.3.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.2.3.3">1</cn></apply></apply><apply id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3.1.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3">superscript</csymbol><ci id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3.2.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3.2">𝜽</ci><ci id="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3.3.cmml" xref="S4.SS5.SSS0.Px1.p2.6.m6.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p2.6.m6.1c">\Delta_{\bm{\theta}_{k}}^{t+1}=\bm{\theta}_{k}^{t+1}-\bm{\theta}^{t}</annotation></semantics></math>, respectively, and rewrite Eq. (<a href="#S4.E8" title="In Motivation. ‣ 4.5 Consistent Aggregation ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) as:</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.1" class="ltx_Math" alttext="\Delta_{\bm{\theta}}^{t+1}=\Sigma_{k=1}^{K}p_{k}\Delta_{\bm{\theta}_{k}}^{t+1}." display="block"><semantics id="S4.E9.m1.1a"><mrow id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><msubsup id="S4.E9.m1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S4.E9.m1.1.1.1.1.2.2.2" xref="S4.E9.m1.1.1.1.1.2.2.2.cmml">Δ</mi><mi id="S4.E9.m1.1.1.1.1.2.2.3" xref="S4.E9.m1.1.1.1.1.2.2.3.cmml">𝜽</mi><mrow id="S4.E9.m1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.2.3.2" xref="S4.E9.m1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S4.E9.m1.1.1.1.1.2.3.1" xref="S4.E9.m1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S4.E9.m1.1.1.1.1.2.3.3" xref="S4.E9.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E9.m1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.3.cmml"><msubsup id="S4.E9.m1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.3.2.cmml"><mi mathvariant="normal" id="S4.E9.m1.1.1.1.1.3.2.2.2" xref="S4.E9.m1.1.1.1.1.3.2.2.2.cmml">Σ</mi><mrow id="S4.E9.m1.1.1.1.1.3.2.2.3" xref="S4.E9.m1.1.1.1.1.3.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.3.2.2.3.2" xref="S4.E9.m1.1.1.1.1.3.2.2.3.2.cmml">k</mi><mo id="S4.E9.m1.1.1.1.1.3.2.2.3.1" xref="S4.E9.m1.1.1.1.1.3.2.2.3.1.cmml">=</mo><mn id="S4.E9.m1.1.1.1.1.3.2.2.3.3" xref="S4.E9.m1.1.1.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.1.1.1.1.3.2.3" xref="S4.E9.m1.1.1.1.1.3.2.3.cmml">K</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.3.1" xref="S4.E9.m1.1.1.1.1.3.1.cmml">​</mo><msub id="S4.E9.m1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.3.3.cmml"><mi id="S4.E9.m1.1.1.1.1.3.3.2" xref="S4.E9.m1.1.1.1.1.3.3.2.cmml">p</mi><mi id="S4.E9.m1.1.1.1.1.3.3.3" xref="S4.E9.m1.1.1.1.1.3.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.3.1a" xref="S4.E9.m1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S4.E9.m1.1.1.1.1.3.4" xref="S4.E9.m1.1.1.1.1.3.4.cmml"><mi mathvariant="normal" id="S4.E9.m1.1.1.1.1.3.4.2.2" xref="S4.E9.m1.1.1.1.1.3.4.2.2.cmml">Δ</mi><msub id="S4.E9.m1.1.1.1.1.3.4.2.3" xref="S4.E9.m1.1.1.1.1.3.4.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.3.4.2.3.2" xref="S4.E9.m1.1.1.1.1.3.4.2.3.2.cmml">𝜽</mi><mi id="S4.E9.m1.1.1.1.1.3.4.2.3.3" xref="S4.E9.m1.1.1.1.1.3.4.2.3.3.cmml">k</mi></msub><mrow id="S4.E9.m1.1.1.1.1.3.4.3" xref="S4.E9.m1.1.1.1.1.3.4.3.cmml"><mi id="S4.E9.m1.1.1.1.1.3.4.3.2" xref="S4.E9.m1.1.1.1.1.3.4.3.2.cmml">t</mi><mo id="S4.E9.m1.1.1.1.1.3.4.3.1" xref="S4.E9.m1.1.1.1.1.3.4.3.1.cmml">+</mo><mn id="S4.E9.m1.1.1.1.1.3.4.3.3" xref="S4.E9.m1.1.1.1.1.3.4.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><mo lspace="0em" id="S4.E9.m1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"><eq id="S4.E9.m1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1"></eq><apply id="S4.E9.m1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.2">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.2.2.1.cmml" xref="S4.E9.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2">Δ</ci><ci id="S4.E9.m1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.3">𝜽</ci></apply><apply id="S4.E9.m1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.3"><plus id="S4.E9.m1.1.1.1.1.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.2.3.1"></plus><ci id="S4.E9.m1.1.1.1.1.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.E9.m1.1.1.1.1.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E9.m1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.3"><times id="S4.E9.m1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.3.1"></times><apply id="S4.E9.m1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E9.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.3.2.2.2">Σ</ci><apply id="S4.E9.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.3.2.2.3"><eq id="S4.E9.m1.1.1.1.1.3.2.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.3.2.2.3.1"></eq><ci id="S4.E9.m1.1.1.1.1.3.2.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.3.2.2.3.2">𝑘</ci><cn type="integer" id="S4.E9.m1.1.1.1.1.3.2.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.1.1.1.1.3.2.3">𝐾</ci></apply><apply id="S4.E9.m1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.3.3.1.cmml" xref="S4.E9.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.3.3.2.cmml" xref="S4.E9.m1.1.1.1.1.3.3.2">𝑝</ci><ci id="S4.E9.m1.1.1.1.1.3.3.3.cmml" xref="S4.E9.m1.1.1.1.1.3.3.3">𝑘</ci></apply><apply id="S4.E9.m1.1.1.1.1.3.4.cmml" xref="S4.E9.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.3.4.1.cmml" xref="S4.E9.m1.1.1.1.1.3.4">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.3.4.2.cmml" xref="S4.E9.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.3.4.2.1.cmml" xref="S4.E9.m1.1.1.1.1.3.4">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.3.4.2.2.cmml" xref="S4.E9.m1.1.1.1.1.3.4.2.2">Δ</ci><apply id="S4.E9.m1.1.1.1.1.3.4.2.3.cmml" xref="S4.E9.m1.1.1.1.1.3.4.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.3.4.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.3.4.2.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.3.4.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.3.4.2.3.2">𝜽</ci><ci id="S4.E9.m1.1.1.1.1.3.4.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.3.4.2.3.3">𝑘</ci></apply></apply><apply id="S4.E9.m1.1.1.1.1.3.4.3.cmml" xref="S4.E9.m1.1.1.1.1.3.4.3"><plus id="S4.E9.m1.1.1.1.1.3.4.3.1.cmml" xref="S4.E9.m1.1.1.1.1.3.4.3.1"></plus><ci id="S4.E9.m1.1.1.1.1.3.4.3.2.cmml" xref="S4.E9.m1.1.1.1.1.3.4.3.2">𝑡</ci><cn type="integer" id="S4.E9.m1.1.1.1.1.3.4.3.3.cmml" xref="S4.E9.m1.1.1.1.1.3.4.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">\Delta_{\bm{\theta}}^{t+1}=\Sigma_{k=1}^{K}p_{k}\Delta_{\bm{\theta}_{k}}^{t+1}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS5.SSS0.Px1.p2.8" class="ltx_p">Then CA solves this multiple-objective optimization to Pareto stationary point, i.e., minimizing the minimum possible convex combination of inconsistent deviations:
<span id="S4.SS5.SSS0.Px1.p2.8.1" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E10.m1.1" class="ltx_Math" alttext="\min\frac{1}{2}\left\|\Sigma_{k=1}^{K}p_{k}\Delta_{\bm{\theta}_{k}}^{t+1}\right\|^{2}_{2}\text{, s.t. }\Sigma_{k=1}^{K}p_{k}=1\text{, and }\forall k,p_{k}\geq 0." display="block"><semantics id="S4.E10.m1.1a"><mrow id="S4.E10.m1.1.1.1"><mrow id="S4.E10.m1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.3.cmml"><mrow id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E10.m1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.1.2.cmml">min</mi><mo lspace="0.167em" id="S4.E10.m1.1.1.1.1.1.1.1a" xref="S4.E10.m1.1.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.cmml"><mfrac id="S4.E10.m1.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.cmml"><mn mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mn mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msubsup id="S4.E10.m1.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" mathvariant="normal" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">Σ</mi><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">K</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1a" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi mathsize="90%" mathvariant="normal" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml">Δ</mi><msub id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml"><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.2.cmml">𝜽</mi><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.3.cmml">k</mi></msub><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml"><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml">t</mi><mo mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">+</mo><mn mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msubsup></mrow><mo id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn><mn mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.1.1.2a" xref="S4.E10.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mtext mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.4" xref="S4.E10.m1.1.1.1.1.1.1.1.1.4a.cmml">, s.t. </mtext><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.1.1.2b" xref="S4.E10.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msubsup id="S4.E10.m1.1.1.1.1.1.1.1.1.5" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.cmml"><mi mathsize="90%" mathvariant="normal" id="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.2.cmml">Σ</mi><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.cmml"><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.2.cmml">k</mi><mo mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.1.cmml">=</mo><mn mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.5.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.3.cmml">K</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.1.1.2c" xref="S4.E10.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S4.E10.m1.1.1.1.1.1.1.1.1.6" xref="S4.E10.m1.1.1.1.1.1.1.1.1.6.cmml"><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.6.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.6.2.cmml">p</mi><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.6.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.6.3.cmml">k</mi></msub></mrow></mrow><mo mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.3.cmml"><mn mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.3.1" xref="S4.E10.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mtext mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.1.1.3.3a.cmml">, and </mtext><mo lspace="0.167em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.3.1a" xref="S4.E10.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.3.4" xref="S4.E10.m1.1.1.1.1.1.1.3.4.cmml"><mo mathsize="90%" rspace="0.167em" id="S4.E10.m1.1.1.1.1.1.1.3.4.1" xref="S4.E10.m1.1.1.1.1.1.1.3.4.1.cmml">∀</mo><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.3.4.2" xref="S4.E10.m1.1.1.1.1.1.1.3.4.2.cmml">k</mi></mrow></mrow></mrow><mo mathsize="90%" id="S4.E10.m1.1.1.1.1.2.3" xref="S4.E10.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S4.E10.m1.1.1.1.1.2.2" xref="S4.E10.m1.1.1.1.1.2.2.cmml"><msub id="S4.E10.m1.1.1.1.1.2.2.2" xref="S4.E10.m1.1.1.1.1.2.2.2.cmml"><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.2.2.2.2" xref="S4.E10.m1.1.1.1.1.2.2.2.2.cmml">p</mi><mi mathsize="90%" id="S4.E10.m1.1.1.1.1.2.2.2.3" xref="S4.E10.m1.1.1.1.1.2.2.2.3.cmml">k</mi></msub><mo mathsize="90%" id="S4.E10.m1.1.1.1.1.2.2.1" xref="S4.E10.m1.1.1.1.1.2.2.1.cmml">≥</mo><mn mathsize="90%" id="S4.E10.m1.1.1.1.1.2.2.3" xref="S4.E10.m1.1.1.1.1.2.2.3.cmml">0</mn></mrow></mrow><mo lspace="0em" mathsize="90%" id="S4.E10.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.1b"><apply id="S4.E10.m1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3a.cmml" xref="S4.E10.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1"><eq id="S4.E10.m1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2"></eq><apply id="S4.E10.m1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1"><min id="S4.E10.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.2"></min><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1"><times id="S4.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3"><divide id="S4.E10.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3"></divide><cn type="integer" id="S4.E10.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.2">1</cn><cn type="integer" id="S4.E10.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">Σ</ci><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3"><eq id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4">superscript</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.2">Δ</ci><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.2">𝜽</ci><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.2.3.3">𝑘</ci></apply></apply><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3"><plus id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.1"></plus><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.2">𝑡</ci><cn type="integer" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.4.3.3">1</cn></apply></apply></apply></apply><cn type="integer" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.3">2</cn></apply><cn type="integer" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3">2</cn></apply><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.4a.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.4"><mtext mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.4">, s.t. </mtext></ci><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.5.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5">superscript</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.2">Σ</ci><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3"><eq id="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.1"></eq><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.2">𝑘</ci><cn type="integer" id="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.2.3.3">1</cn></apply></apply><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.5.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.5.3">𝐾</ci></apply><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.6.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.6.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.6.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.6.2">𝑝</ci><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.6.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.6.3">𝑘</ci></apply></apply></apply><apply id="S4.E10.m1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3"><times id="S4.E10.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.1"></times><cn type="integer" id="S4.E10.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2">1</cn><ci id="S4.E10.m1.1.1.1.1.1.1.3.3a.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.3"><mtext mathsize="90%" id="S4.E10.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.3">, and </mtext></ci><apply id="S4.E10.m1.1.1.1.1.1.1.3.4.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.4"><csymbol cd="latexml" id="S4.E10.m1.1.1.1.1.1.1.3.4.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.4.1">for-all</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.3.4.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.4.2">𝑘</ci></apply></apply></apply><apply id="S4.E10.m1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.1.1.1.1.2.2"><geq id="S4.E10.m1.1.1.1.1.2.2.1.cmml" xref="S4.E10.m1.1.1.1.1.2.2.1"></geq><apply id="S4.E10.m1.1.1.1.1.2.2.2.cmml" xref="S4.E10.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.2.2.2.1.cmml" xref="S4.E10.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E10.m1.1.1.1.1.2.2.2.2">𝑝</ci><ci id="S4.E10.m1.1.1.1.1.2.2.2.3.cmml" xref="S4.E10.m1.1.1.1.1.2.2.2.3">𝑘</ci></apply><cn type="integer" id="S4.E10.m1.1.1.1.1.2.2.3.cmml" xref="S4.E10.m1.1.1.1.1.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.1c">\min\frac{1}{2}\left\|\Sigma_{k=1}^{K}p_{k}\Delta_{\bm{\theta}_{k}}^{t+1}\right\|^{2}_{2}\text{, s.t. }\Sigma_{k=1}^{K}p_{k}=1\text{, and }\forall k,p_{k}\geq 0.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS5.SSS0.Px1.p3" class="ltx_para">
<p id="S4.SS5.SSS0.Px1.p3.10" class="ltx_p">Next, we introduce CU which derives from Multiple Gradient Descent Algorithm (MGDA) <cite class="ltx_cite ltx_citemacro_cite">Désidéri (<a href="#bib.bib9" title="" class="ltx_ref">2012</a>); Sener and Koltun (<a href="#bib.bib40" title="" class="ltx_ref">2018</a>)</cite> to solve this optimization.
The optimization problem defined in Eq. (<a href="#S4.E10" title="In Motivation. ‣ 4.5 Consistent Aggregation ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) is equivalent to finding a minimum-norm point in the convex hull of the set of input points, i.e., a convex quadratic problem with linear constraints.
CU iteratively optimizes Eq. (<a href="#S4.E10" title="In Motivation. ‣ 4.5 Consistent Aggregation ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) by linear search, which can be solved analytically <cite class="ltx_cite ltx_citemacro_cite">Jaggi (<a href="#bib.bib17" title="" class="ltx_ref">2013</a>)</cite>.
In detail, we find the toughest client, treat the combination of the remaining clients as a virtual client, and analyze the solution according to the directions of the toughest client and the virtual client.
Firstly,
we initialize <math id="S4.SS5.SSS0.Px1.p3.1.m1.1" class="ltx_Math" alttext="\bm{p}_{0}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.1.m1.1a"><msub id="S4.SS5.SSS0.Px1.p3.1.m1.1.1" xref="S4.SS5.SSS0.Px1.p3.1.m1.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.1.m1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.1.m1.1.1.2.cmml">𝒑</mi><mn id="S4.SS5.SSS0.Px1.p3.1.m1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.1.m1.1b"><apply id="S4.SS5.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.1.m1.1.1.2">𝒑</ci><cn type="integer" id="S4.SS5.SSS0.Px1.p3.1.m1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.1.m1.1c">\bm{p}_{0}</annotation></semantics></math> with the weight of data samples, i.e., <math id="S4.SS5.SSS0.Px1.p3.2.m2.1" class="ltx_Math" alttext="p_{k}=\nicefrac{{N_{k}}}{{\Sigma_{k=1}^{K}N_{k}}}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.2.m2.1a"><mrow id="S4.SS5.SSS0.Px1.p3.2.m2.1.1" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.cmml"><msub id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2.cmml"><mi id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2.2" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2.2.cmml">p</mi><mi id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2.3" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2.3.cmml">k</mi></msub><mo id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.1" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.1.cmml">=</mo><mrow id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.cmml"><mpadded voffset="0.3em" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2.cmml"><msub id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2a" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2.cmml"><mi mathsize="70%" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2.2" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2.2.cmml">N</mi><mi mathsize="71%" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2.3" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2.3.cmml">k</mi></msub></mpadded><mpadded lspace="-0.1em" width="-0.15em" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.1" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.1.cmml"><mo stretchy="true" symmetric="true" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.1a" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.1.cmml">/</mo></mpadded><mrow id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.cmml"><msubsup id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.cmml"><mi mathsize="70%" mathvariant="normal" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.2" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.2.cmml">Σ</mi><mrow id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.cmml"><mi mathsize="71%" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.2" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.2.cmml">k</mi><mo mathsize="71%" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.1" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.1.cmml">=</mo><mn mathsize="71%" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.3" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.3.cmml">1</mn></mrow><mi mathsize="71%" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.3" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.3.cmml">K</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.1" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.1.cmml">​</mo><msub id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3.cmml"><mi mathsize="70%" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3.2" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3.2.cmml">N</mi><mi mathsize="71%" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3.3" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.2.m2.1b"><apply id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1"><eq id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.1"></eq><apply id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2.2">𝑝</ci><ci id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.2.3">𝑘</ci></apply><apply id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3"><divide id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.1"></divide><apply id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2.2">𝑁</ci><ci id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.2.3">𝑘</ci></apply><apply id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3"><times id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.1"></times><apply id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2">superscript</csymbol><apply id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.2">Σ</ci><apply id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3"><eq id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.1"></eq><ci id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.2">𝑘</ci><cn type="integer" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.2.3.3">1</cn></apply></apply><ci id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.2.3">𝐾</ci></apply><apply id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3.2">𝑁</ci><ci id="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.2.m2.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.2.m2.1c">p_{k}=\nicefrac{{N_{k}}}{{\Sigma_{k=1}^{K}N_{k}}}</annotation></semantics></math>, and
precompute the consistency of deviations <math id="S4.SS5.SSS0.Px1.p3.3.m3.7" class="ltx_Math" alttext="\bm{V},s.t.\bm{V}_{k,k^{\prime}}={\Delta_{\bm{\theta}_{k}}}^{\top}{\Delta_{\bm{\theta}_{k^{\prime}}}}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.3.m3.7a"><mrow id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.3.cmml"><mrow id="S4.SS5.SSS0.Px1.p3.3.m3.6.6.1.1.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.6.6.1.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.3.m3.3.3" xref="S4.SS5.SSS0.Px1.p3.3.m3.3.3.cmml">𝑽</mi><mo id="S4.SS5.SSS0.Px1.p3.3.m3.6.6.1.1.2.1" xref="S4.SS5.SSS0.Px1.p3.3.m3.6.6.1.1.1.cmml">,</mo><mi id="S4.SS5.SSS0.Px1.p3.3.m3.4.4" xref="S4.SS5.SSS0.Px1.p3.3.m3.4.4.cmml">s</mi></mrow><mo lspace="0em" rspace="0.167em" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.3" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.3a.cmml">.</mo><mi id="S4.SS5.SSS0.Px1.p3.3.m3.5.5" xref="S4.SS5.SSS0.Px1.p3.3.m3.5.5.cmml">t</mi><mo lspace="0em" rspace="0.167em" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.4" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.3a.cmml">.</mo><mrow id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.cmml"><msub id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.2.cmml"><mi id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.2.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.2.2.cmml">𝑽</mi><mrow id="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.3.m3.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.3.m3.1.1.1.1.cmml">k</mi><mo id="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.3.cmml">,</mo><msup id="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1" xref="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1.2.cmml">k</mi><mo id="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1.3" xref="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1.3.cmml">′</mo></msup></mrow></msub><mo id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.1" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.1.cmml">=</mo><mrow id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.cmml"><mmultiscripts id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.2.cmml">Δ</mi><msub id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3.2.cmml">𝜽</mi><mi id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3.3" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3.3.cmml">k</mi></msub><mrow id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2a" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.cmml"></mrow><mrow id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2b" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.cmml"></mrow><mo id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.3" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.3.cmml">⊤</mo></mmultiscripts><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.1" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.1.cmml">​</mo><msub id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.2.cmml">Δ</mi><msub id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.2.cmml">𝜽</mi><msup id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3.2" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3.2.cmml">k</mi><mo id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3.3" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3.3.cmml">′</mo></msup></msub></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.3.m3.7b"><apply id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.3.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.3a.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.3">formulae-sequence</csymbol><list id="S4.SS5.SSS0.Px1.p3.3.m3.6.6.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.6.6.1.1.2"><ci id="S4.SS5.SSS0.Px1.p3.3.m3.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.3.3">𝑽</ci><ci id="S4.SS5.SSS0.Px1.p3.3.m3.4.4.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.4.4">𝑠</ci></list><ci id="S4.SS5.SSS0.Px1.p3.3.m3.5.5.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.5.5">𝑡</ci><apply id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2"><eq id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.1"></eq><apply id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.2.2">𝑽</ci><list id="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2"><ci id="S4.SS5.SSS0.Px1.p3.3.m3.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.1.1.1.1">𝑘</ci><apply id="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1">superscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1.2">𝑘</ci><ci id="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.2.2.2.2.1.3">′</ci></apply></list></apply><apply id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3"><times id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.1"></times><apply id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2">superscript</csymbol><apply id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.2">Δ</ci><apply id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3.2">𝜽</ci><ci id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.2.3.3">𝑘</ci></apply></apply><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.2.3">top</csymbol></apply><apply id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.2">Δ</ci><apply id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.2">𝜽</ci><apply id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3">superscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3.2">𝑘</ci><ci id="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.3.m3.7.7.2.2.3.3.3.3.3">′</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.3.m3.7c">\bm{V},s.t.\bm{V}_{k,k^{\prime}}={\Delta_{\bm{\theta}_{k}}}^{\top}{\Delta_{\bm{\theta}_{k^{\prime}}}}</annotation></semantics></math>.
Then we find the toughest client by <math id="S4.SS5.SSS0.Px1.p3.4.m4.2" class="ltx_Math" alttext="\tau=\operatorname{arg}\operatorname{min}_{k^{\prime}}\Sigma_{k=1}^{K}p_{k}\bm{V}_{k^{\prime},k}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.4.m4.2a"><mrow id="S4.SS5.SSS0.Px1.p3.4.m4.2.3" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.2.cmml">τ</mi><mo id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.1" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.1.cmml">=</mo><mrow id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.1" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.1.cmml">arg</mi><mo lspace="0.167em" id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3a" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.cmml">⁡</mo><mrow id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.cmml"><msub id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.2.cmml">min</mi><msup id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3.2.cmml">k</mi><mo id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3.3" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3.3.cmml">′</mo></msup></msub><mo lspace="0.167em" id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2a" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.cmml">⁡</mo><mrow id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.cmml"><msubsup id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.2.cmml">Σ</mi><mrow id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.2.cmml">k</mi><mo id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.1" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.1.cmml">=</mo><mn id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.3" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.3" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.3.cmml">K</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.1" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.1.cmml">​</mo><msub id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3.2.cmml">p</mi><mi id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3.3" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.1a" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.1.cmml">​</mo><msub id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.4" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.4.cmml"><mi id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.4.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.4.2.cmml">𝑽</mi><mrow id="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.3.cmml"><msup id="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1.2.cmml">k</mi><mo id="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1.3" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1.3.cmml">′</mo></msup><mo id="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.2" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.3.cmml">,</mo><mi id="S4.SS5.SSS0.Px1.p3.4.m4.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.4.m4.1.1.1.1.cmml">k</mi></mrow></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.4.m4.2b"><apply id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3"><eq id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.1"></eq><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.2">𝜏</ci><apply id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3"><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.1">arg</ci><apply id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2"><apply id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.2">min</ci><apply id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3">superscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3.2">𝑘</ci><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.1.3.3">′</ci></apply></apply><apply id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2"><times id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.1"></times><apply id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2">superscript</csymbol><apply id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.2">Σ</ci><apply id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3"><eq id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.1"></eq><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.2">𝑘</ci><cn type="integer" id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.2.3.3">1</cn></apply></apply><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.2.3">𝐾</ci></apply><apply id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3.2">𝑝</ci><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.3.3">𝑘</ci></apply><apply id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.4.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.4"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.4.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.4">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.4.2.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.3.3.2.2.4.2">𝑽</ci><list id="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2"><apply id="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1">superscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1.2">𝑘</ci><ci id="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.2.2.2.2.1.3">′</ci></apply><ci id="S4.SS5.SSS0.Px1.p3.4.m4.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.4.m4.1.1.1.1">𝑘</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.4.m4.2c">\tau=\operatorname{arg}\operatorname{min}_{k^{\prime}}\Sigma_{k=1}^{K}p_{k}\bm{V}_{k^{\prime},k}</annotation></semantics></math> with deviation <math id="S4.SS5.SSS0.Px1.p3.5.m5.1" class="ltx_Math" alttext="\Delta_{\tau}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.5.m5.1a"><msub id="S4.SS5.SSS0.Px1.p3.5.m5.1.1" xref="S4.SS5.SSS0.Px1.p3.5.m5.1.1.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p3.5.m5.1.1.2" xref="S4.SS5.SSS0.Px1.p3.5.m5.1.1.2.cmml">Δ</mi><mi id="S4.SS5.SSS0.Px1.p3.5.m5.1.1.3" xref="S4.SS5.SSS0.Px1.p3.5.m5.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.5.m5.1b"><apply id="S4.SS5.SSS0.Px1.p3.5.m5.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.5.m5.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.5.m5.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.5.m5.1.1.2">Δ</ci><ci id="S4.SS5.SSS0.Px1.p3.5.m5.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.5.m5.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.5.m5.1c">\Delta_{\tau}</annotation></semantics></math>, and remain the combination of others with historical weights to be a virtual client, i.e., <math id="S4.SS5.SSS0.Px1.p3.6.m6.2" class="ltx_Math" alttext="\Delta_{\text{vir}}=\Sigma_{k=1,k\neq\tau}^{K}p_{k}\Delta_{\bm{\theta}_{k}}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.6.m6.2a"><mrow id="S4.SS5.SSS0.Px1.p3.6.m6.2.3" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.cmml"><msub id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.2" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.2.cmml">Δ</mi><mtext id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.3" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.3a.cmml">vir</mtext></msub><mo id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.1" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.1.cmml">=</mo><mrow id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.cmml"><msubsup id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.2.2" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.2.2.cmml">Σ</mi><mrow id="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.3.cmml"><mrow id="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.2.cmml">k</mi><mo id="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.1.cmml">=</mo><mn id="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.3" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.3a.cmml">,</mo><mrow id="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.cmml"><mi id="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.2" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.2.cmml">k</mi><mo id="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.1" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.1.cmml">≠</mo><mi id="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.3" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.3.cmml">τ</mi></mrow></mrow><mi id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.3" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.3.cmml">K</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.1" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.1.cmml">​</mo><msub id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3.2" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3.2.cmml">p</mi><mi id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3.3" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.1a" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.1.cmml">​</mo><msub id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.2" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.2.cmml">Δ</mi><msub id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3.2" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3.2.cmml">𝜽</mi><mi id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3.3" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3.3.cmml">k</mi></msub></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.6.m6.2b"><apply id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3"><eq id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.1"></eq><apply id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.2">Δ</ci><ci id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.3a.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.3"><mtext mathsize="70%" id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.2.3">vir</mtext></ci></apply><apply id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3"><times id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.1"></times><apply id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2">superscript</csymbol><apply id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.2.2">Σ</ci><apply id="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.3a.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1"><eq id="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.1"></eq><ci id="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.2">𝑘</ci><cn type="integer" id="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.1.1.1.1.1.3">1</cn></apply><apply id="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2"><neq id="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.1"></neq><ci id="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.2">𝑘</ci><ci id="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.2.2.2.2.3">𝜏</ci></apply></apply></apply><ci id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.2.3">𝐾</ci></apply><apply id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3.2">𝑝</ci><ci id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.3.3">𝑘</ci></apply><apply id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.1.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.2.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.2">Δ</ci><apply id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3.2">𝜽</ci><ci id="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.6.m6.2.3.3.4.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.6.m6.2c">\Delta_{\text{vir}}=\Sigma_{k=1,k\neq\tau}^{K}p_{k}\Delta_{\bm{\theta}_{k}}</annotation></semantics></math>.
Thus we simplify Eq. (<a href="#S4.E10" title="In Motivation. ‣ 4.5 Consistent Aggregation ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>), i.e., <math id="S4.SS5.SSS0.Px1.p3.7.m7.3" class="ltx_Math" alttext="\operatorname{min}_{p_{\tau}\in[0,1]}\frac{1}{2}\|p_{\tau}\Delta_{{\tau}}+(1-p_{\tau})\Delta_{{\text{vir}}}\|^{2}_{2}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.7.m7.3a"><mrow id="S4.SS5.SSS0.Px1.p3.7.m7.3.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.cmml"><msub id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.2.cmml"><mi id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.2.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.2.2.cmml">min</mi><mrow id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.cmml"><msub id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4.cmml"><mi id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4.2.cmml">p</mi><mi id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4.3.cmml">τ</mi></msub><mo id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.3.cmml">∈</mo><mrow id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.5.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.5.1.cmml"><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.5.2.1" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.5.1.cmml">[</mo><mn id="S4.SS5.SSS0.Px1.p3.7.m7.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.7.m7.1.1.1.1.cmml">0</mn><mo id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.5.2.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.5.1.cmml">,</mo><mn id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.5.2.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.5.1.cmml">]</mo></mrow></mrow></msub><mo lspace="0.167em" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3a" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.cmml">⁡</mo><mrow id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.cmml"><mfrac id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3.cmml"><mn id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3.2.cmml">1</mn><mn id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.2.cmml">​</mo><msubsup id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.cmml"><mrow id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.cmml"><mrow id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.cmml"><msub id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2.3.cmml">τ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.1" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3.2.cmml">Δ</mi><mi id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3.3.cmml">τ</mi></msub></mrow><mo id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">τ</mi></msub></mrow><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.2" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mtext id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.3a.cmml">vir</mtext></msub></mrow></mrow><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.3.cmml">2</mn><mn id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.7.m7.3b"><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3"><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.2.2">min</ci><apply id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2"><in id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.3"></in><apply id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4.2">𝑝</ci><ci id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.4.3">𝜏</ci></apply><interval closure="closed" id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.5.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.5.2"><cn type="integer" id="S4.SS5.SSS0.Px1.p3.7.m7.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.1.1.1.1">0</cn><cn type="integer" id="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.2.2.2.2">1</cn></interval></apply></apply><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1"><times id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.2"></times><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3"><divide id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3"></divide><cn type="integer" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3.2">1</cn><cn type="integer" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.3.3">2</cn></apply><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1">subscript</csymbol><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1">superscript</csymbol><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.2">norm</csymbol><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1"><plus id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.2"></plus><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3"><times id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.1"></times><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.2.3">𝜏</ci></apply><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3.2">Δ</ci><ci id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.3.3.3">𝜏</ci></apply></apply><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1"><times id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.2"></times><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1"><minus id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.1.1.1.3.3">𝜏</ci></apply></apply><apply id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.2">Δ</ci><ci id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.3a.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.1.1.1.1.3.3">vir</mtext></ci></apply></apply></apply></apply><cn type="integer" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.1.3">2</cn></apply><cn type="integer" id="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.7.m7.3.3.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.7.m7.3c">\operatorname{min}_{p_{\tau}\in[0,1]}\frac{1}{2}\|p_{\tau}\Delta_{{\tau}}+(1-p_{\tau})\Delta_{{\text{vir}}}\|^{2}_{2}</annotation></semantics></math>.
According to the directions of <math id="S4.SS5.SSS0.Px1.p3.8.m8.1" class="ltx_Math" alttext="\Delta_{\tau}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.8.m8.1a"><msub id="S4.SS5.SSS0.Px1.p3.8.m8.1.1" xref="S4.SS5.SSS0.Px1.p3.8.m8.1.1.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p3.8.m8.1.1.2" xref="S4.SS5.SSS0.Px1.p3.8.m8.1.1.2.cmml">Δ</mi><mi id="S4.SS5.SSS0.Px1.p3.8.m8.1.1.3" xref="S4.SS5.SSS0.Px1.p3.8.m8.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.8.m8.1b"><apply id="S4.SS5.SSS0.Px1.p3.8.m8.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.8.m8.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.8.m8.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.8.m8.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.8.m8.1.1.2">Δ</ci><ci id="S4.SS5.SSS0.Px1.p3.8.m8.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.8.m8.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.8.m8.1c">\Delta_{\tau}</annotation></semantics></math> and <math id="S4.SS5.SSS0.Px1.p3.9.m9.1" class="ltx_Math" alttext="\Delta_{\text{vir}}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.9.m9.1a"><msub id="S4.SS5.SSS0.Px1.p3.9.m9.1.1" xref="S4.SS5.SSS0.Px1.p3.9.m9.1.1.cmml"><mi mathvariant="normal" id="S4.SS5.SSS0.Px1.p3.9.m9.1.1.2" xref="S4.SS5.SSS0.Px1.p3.9.m9.1.1.2.cmml">Δ</mi><mtext id="S4.SS5.SSS0.Px1.p3.9.m9.1.1.3" xref="S4.SS5.SSS0.Px1.p3.9.m9.1.1.3a.cmml">vir</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.9.m9.1b"><apply id="S4.SS5.SSS0.Px1.p3.9.m9.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.9.m9.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.9.m9.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.9.m9.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.9.m9.1.1.2">Δ</ci><ci id="S4.SS5.SSS0.Px1.p3.9.m9.1.1.3a.cmml" xref="S4.SS5.SSS0.Px1.p3.9.m9.1.1.3"><mtext mathsize="70%" id="S4.SS5.SSS0.Px1.p3.9.m9.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.9.m9.1.1.3">vir</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.9.m9.1c">\Delta_{\text{vir}}</annotation></semantics></math>, we can obtain the analytical solution for <math id="S4.SS5.SSS0.Px1.p3.10.m10.1" class="ltx_Math" alttext="p_{\tau}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.10.m10.1a"><msub id="S4.SS5.SSS0.Px1.p3.10.m10.1.1" xref="S4.SS5.SSS0.Px1.p3.10.m10.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.10.m10.1.1.2" xref="S4.SS5.SSS0.Px1.p3.10.m10.1.1.2.cmml">p</mi><mi id="S4.SS5.SSS0.Px1.p3.10.m10.1.1.3" xref="S4.SS5.SSS0.Px1.p3.10.m10.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.10.m10.1b"><apply id="S4.SS5.SSS0.Px1.p3.10.m10.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.10.m10.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.10.m10.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.10.m10.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.10.m10.1.1.2">𝑝</ci><ci id="S4.SS5.SSS0.Px1.p3.10.m10.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.10.m10.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.10.m10.1c">p_{\tau}</annotation></semantics></math>:</p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E11.m1.3" class="ltx_Math" alttext="p_{\tau}=\operatorname{CU}^{+}\left[\nicefrac{{{(\Delta_{\text{vir}}-\Delta_{\tau})}^{\top}\Delta_{\text{vir}}}}{{\|\Delta_{\tau}-\Delta_{\text{vir}}\|^{2}_{2}}}\right]," display="block"><semantics id="S4.E11.m1.3a"><mrow id="S4.E11.m1.3.3.1" xref="S4.E11.m1.3.3.1.1.cmml"><mrow id="S4.E11.m1.3.3.1.1" xref="S4.E11.m1.3.3.1.1.cmml"><msub id="S4.E11.m1.3.3.1.1.3" xref="S4.E11.m1.3.3.1.1.3.cmml"><mi id="S4.E11.m1.3.3.1.1.3.2" xref="S4.E11.m1.3.3.1.1.3.2.cmml">p</mi><mi id="S4.E11.m1.3.3.1.1.3.3" xref="S4.E11.m1.3.3.1.1.3.3.cmml">τ</mi></msub><mo id="S4.E11.m1.3.3.1.1.2" xref="S4.E11.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E11.m1.3.3.1.1.1.1" xref="S4.E11.m1.3.3.1.1.1.2.cmml"><msup id="S4.E11.m1.3.3.1.1.1.1.1" xref="S4.E11.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.E11.m1.3.3.1.1.1.1.1.2" xref="S4.E11.m1.3.3.1.1.1.1.1.2.cmml">CU</mi><mo id="S4.E11.m1.3.3.1.1.1.1.1.3" xref="S4.E11.m1.3.3.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S4.E11.m1.3.3.1.1.1.1a" xref="S4.E11.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S4.E11.m1.3.3.1.1.1.1.2" xref="S4.E11.m1.3.3.1.1.1.2.cmml"><mo id="S4.E11.m1.3.3.1.1.1.1.2.1" xref="S4.E11.m1.3.3.1.1.1.2.cmml">[</mo><mrow id="S4.E11.m1.2.2" xref="S4.E11.m1.2.2.cmml"><mpadded voffset="0.3em" id="S4.E11.m1.1.1.1" xref="S4.E11.m1.1.1.1.cmml"><msup id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml"><mrow id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml"><msub id="S4.E11.m1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S4.E11.m1.1.1.1.1.1.1.1.2.2" xref="S4.E11.m1.1.1.1.1.1.1.1.2.2.cmml">Δ</mi><mtext id="S4.E11.m1.1.1.1.1.1.1.1.2.3" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3a.cmml">vir</mtext></msub><mo id="S4.E11.m1.1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E11.m1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E11.m1.1.1.1.1.1.1.1.3.2" xref="S4.E11.m1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mi id="S4.E11.m1.1.1.1.1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.1.1.1.1.3.3.cmml">τ</mi></msub></mrow><mo stretchy="false" id="S4.E11.m1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E11.m1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S4.E11.m1.1.1.1.2" xref="S4.E11.m1.1.1.1.2.cmml">​</mo><msub id="S4.E11.m1.1.1.1.3" xref="S4.E11.m1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E11.m1.1.1.1.3.2" xref="S4.E11.m1.1.1.1.3.2.cmml">Δ</mi><mtext id="S4.E11.m1.1.1.1.3.3" xref="S4.E11.m1.1.1.1.3.3a.cmml">vir</mtext></msub></mpadded><mpadded lspace="-0.1em" width="-0.15em" id="S4.E11.m1.2.2.3" xref="S4.E11.m1.2.2.3.cmml"><mo stretchy="true" symmetric="true" id="S4.E11.m1.2.2.3a" xref="S4.E11.m1.2.2.3.cmml">/</mo></mpadded><msubsup id="S4.E11.m1.2.2.2" xref="S4.E11.m1.2.2.2.cmml"><mrow id="S4.E11.m1.2.2.2.1.1.1" xref="S4.E11.m1.2.2.2.1.1.2.cmml"><mo lspace="0.222em" stretchy="false" id="S4.E11.m1.2.2.2.1.1.1.2" xref="S4.E11.m1.2.2.2.1.1.2.1.cmml">‖</mo><mrow id="S4.E11.m1.2.2.2.1.1.1.1" xref="S4.E11.m1.2.2.2.1.1.1.1.cmml"><msub id="S4.E11.m1.2.2.2.1.1.1.1.2" xref="S4.E11.m1.2.2.2.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S4.E11.m1.2.2.2.1.1.1.1.2.2" xref="S4.E11.m1.2.2.2.1.1.1.1.2.2.cmml">Δ</mi><mi id="S4.E11.m1.2.2.2.1.1.1.1.2.3" xref="S4.E11.m1.2.2.2.1.1.1.1.2.3.cmml">τ</mi></msub><mo id="S4.E11.m1.2.2.2.1.1.1.1.1" xref="S4.E11.m1.2.2.2.1.1.1.1.1.cmml">−</mo><msub id="S4.E11.m1.2.2.2.1.1.1.1.3" xref="S4.E11.m1.2.2.2.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E11.m1.2.2.2.1.1.1.1.3.2" xref="S4.E11.m1.2.2.2.1.1.1.1.3.2.cmml">Δ</mi><mtext id="S4.E11.m1.2.2.2.1.1.1.1.3.3" xref="S4.E11.m1.2.2.2.1.1.1.1.3.3a.cmml">vir</mtext></msub></mrow><mo stretchy="false" id="S4.E11.m1.2.2.2.1.1.1.3" xref="S4.E11.m1.2.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E11.m1.2.2.2.3" xref="S4.E11.m1.2.2.2.3.cmml">2</mn><mn id="S4.E11.m1.2.2.2.1.3" xref="S4.E11.m1.2.2.2.1.3.cmml">2</mn></msubsup></mrow><mo id="S4.E11.m1.3.3.1.1.1.1.2.2" xref="S4.E11.m1.3.3.1.1.1.2.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E11.m1.3.3.1.2" xref="S4.E11.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.3b"><apply id="S4.E11.m1.3.3.1.1.cmml" xref="S4.E11.m1.3.3.1"><eq id="S4.E11.m1.3.3.1.1.2.cmml" xref="S4.E11.m1.3.3.1.1.2"></eq><apply id="S4.E11.m1.3.3.1.1.3.cmml" xref="S4.E11.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.1.1.3.1.cmml" xref="S4.E11.m1.3.3.1.1.3">subscript</csymbol><ci id="S4.E11.m1.3.3.1.1.3.2.cmml" xref="S4.E11.m1.3.3.1.1.3.2">𝑝</ci><ci id="S4.E11.m1.3.3.1.1.3.3.cmml" xref="S4.E11.m1.3.3.1.1.3.3">𝜏</ci></apply><apply id="S4.E11.m1.3.3.1.1.1.2.cmml" xref="S4.E11.m1.3.3.1.1.1.1"><apply id="S4.E11.m1.3.3.1.1.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1">superscript</csymbol><ci id="S4.E11.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.2">CU</ci><plus id="S4.E11.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.3"></plus></apply><apply id="S4.E11.m1.2.2.cmml" xref="S4.E11.m1.2.2"><divide id="S4.E11.m1.2.2.3.cmml" xref="S4.E11.m1.2.2.3"></divide><apply id="S4.E11.m1.1.1.1.cmml" xref="S4.E11.m1.1.1.1"><times id="S4.E11.m1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.2"></times><apply id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1">superscript</csymbol><apply id="S4.E11.m1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1"><minus id="S4.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E11.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2.2">Δ</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.2.3a.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S4.E11.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2.3">vir</mtext></ci></apply><apply id="S4.E11.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3.2">Δ</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3.3">𝜏</ci></apply></apply><csymbol cd="latexml" id="S4.E11.m1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.3">top</csymbol></apply><apply id="S4.E11.m1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.3.1.cmml" xref="S4.E11.m1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.1.1.1.3.2.cmml" xref="S4.E11.m1.1.1.1.3.2">Δ</ci><ci id="S4.E11.m1.1.1.1.3.3a.cmml" xref="S4.E11.m1.1.1.1.3.3"><mtext mathsize="70%" id="S4.E11.m1.1.1.1.3.3.cmml" xref="S4.E11.m1.1.1.1.3.3">vir</mtext></ci></apply></apply><apply id="S4.E11.m1.2.2.2.cmml" xref="S4.E11.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2">subscript</csymbol><apply id="S4.E11.m1.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.1.2.cmml" xref="S4.E11.m1.2.2.2">superscript</csymbol><apply id="S4.E11.m1.2.2.2.1.1.2.cmml" xref="S4.E11.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="S4.E11.m1.2.2.2.1.1.2.1.cmml" xref="S4.E11.m1.2.2.2.1.1.1.2">norm</csymbol><apply id="S4.E11.m1.2.2.2.1.1.1.1.cmml" xref="S4.E11.m1.2.2.2.1.1.1.1"><minus id="S4.E11.m1.2.2.2.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.2.1.1.1.1.1"></minus><apply id="S4.E11.m1.2.2.2.1.1.1.1.2.cmml" xref="S4.E11.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.1.1.1.1.2.1.cmml" xref="S4.E11.m1.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.E11.m1.2.2.2.1.1.1.1.2.2.cmml" xref="S4.E11.m1.2.2.2.1.1.1.1.2.2">Δ</ci><ci id="S4.E11.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S4.E11.m1.2.2.2.1.1.1.1.2.3">𝜏</ci></apply><apply id="S4.E11.m1.2.2.2.1.1.1.1.3.cmml" xref="S4.E11.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S4.E11.m1.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S4.E11.m1.2.2.2.1.1.1.1.3.2">Δ</ci><ci id="S4.E11.m1.2.2.2.1.1.1.1.3.3a.cmml" xref="S4.E11.m1.2.2.2.1.1.1.1.3.3"><mtext mathsize="70%" id="S4.E11.m1.2.2.2.1.1.1.1.3.3.cmml" xref="S4.E11.m1.2.2.2.1.1.1.1.3.3">vir</mtext></ci></apply></apply></apply><cn type="integer" id="S4.E11.m1.2.2.2.1.3.cmml" xref="S4.E11.m1.2.2.2.1.3">2</cn></apply><cn type="integer" id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.3c">p_{\tau}=\operatorname{CU}^{+}\left[\nicefrac{{{(\Delta_{\text{vir}}-\Delta_{\tau})}^{\top}\Delta_{\text{vir}}}}{{\|\Delta_{\tau}-\Delta_{\text{vir}}\|^{2}_{2}}}\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.SS5.SSS0.Px1.p3.18" class="ltx_p">where <math id="S4.SS5.SSS0.Px1.p3.11.m1.8" class="ltx_Math" alttext="\operatorname{CU}^{+}[\cdot]=\operatorname{max}(\operatorname{min}(\cdot,1),0)" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.11.m1.8a"><mrow id="S4.SS5.SSS0.Px1.p3.11.m1.8.8" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.cmml"><mrow id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.2.cmml"><msup id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1.2.cmml">CU</mi><mo id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1.3.cmml">+</mo></msup><mo id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1a" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.2.cmml">⁡</mo><mrow id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.2" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.2.cmml"><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.2.1" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.2.cmml">[</mo><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.11.m1.1.1" xref="S4.SS5.SSS0.Px1.p3.11.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.2.2" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.2.cmml">]</mo></mrow></mrow><mo id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.3" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.3.cmml">=</mo><mrow id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.2.cmml"><mi id="S4.SS5.SSS0.Px1.p3.11.m1.5.5" xref="S4.SS5.SSS0.Px1.p3.11.m1.5.5.cmml">max</mi><mo id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1a" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.2.cmml">⁡</mo><mrow id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.2.cmml"><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.2" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.2.cmml">(</mo><mrow id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.11.m1.2.2" xref="S4.SS5.SSS0.Px1.p3.11.m1.2.2.cmml">min</mi><mo id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.2a" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.1.cmml">⁡</mo><mrow id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.2.1" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.2.1.1" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.11.m1.3.3" xref="S4.SS5.SSS0.Px1.p3.11.m1.3.3.cmml">⋅</mo><mo id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.2.1.2" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.1.cmml">,</mo><mn id="S4.SS5.SSS0.Px1.p3.11.m1.4.4" xref="S4.SS5.SSS0.Px1.p3.11.m1.4.4.cmml">1</mn><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.2.1.3" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.3" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.2.cmml">,</mo><mn id="S4.SS5.SSS0.Px1.p3.11.m1.6.6" xref="S4.SS5.SSS0.Px1.p3.11.m1.6.6.cmml">0</mn><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.4" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.11.m1.8b"><apply id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8"><eq id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.3.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.3"></eq><apply id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1"><apply id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1">superscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1.2">CU</ci><plus id="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.7.7.1.1.1.3"></plus></apply><ci id="S4.SS5.SSS0.Px1.p3.11.m1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.1.1">⋅</ci></apply><apply id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1"><ci id="S4.SS5.SSS0.Px1.p3.11.m1.5.5.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.5.5">max</ci><apply id="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.8.8.2.1.1.1.2"><ci id="S4.SS5.SSS0.Px1.p3.11.m1.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.2.2">min</ci><ci id="S4.SS5.SSS0.Px1.p3.11.m1.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.3.3">⋅</ci><cn type="integer" id="S4.SS5.SSS0.Px1.p3.11.m1.4.4.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.4.4">1</cn></apply><cn type="integer" id="S4.SS5.SSS0.Px1.p3.11.m1.6.6.cmml" xref="S4.SS5.SSS0.Px1.p3.11.m1.6.6">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.11.m1.8c">\operatorname{CU}^{+}[\cdot]=\operatorname{max}(\operatorname{min}(\cdot,1),0)</annotation></semantics></math>.
In Appendix C, we present the analysis of optimization for obtaining <math id="S4.SS5.SSS0.Px1.p3.12.m2.2" class="ltx_Math" alttext="\operatorname{CU}^{+}[\cdot]" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.12.m2.2a"><mrow id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.2.cmml"><msup id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1.2" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1.2.cmml">CU</mi><mo id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1.3" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1.3.cmml">+</mo></msup><mo id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1a" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.2.cmml">⁡</mo><mrow id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.2" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.2.cmml"><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.2.1" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.2.cmml">[</mo><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.12.m2.1.1" xref="S4.SS5.SSS0.Px1.p3.12.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.2.2" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.12.m2.2b"><apply id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1"><apply id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1">superscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1.2">CU</ci><plus id="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.12.m2.2.2.1.1.3"></plus></apply><ci id="S4.SS5.SSS0.Px1.p3.12.m2.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.12.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.12.m2.2c">\operatorname{CU}^{+}[\cdot]</annotation></semantics></math> based on the computational geometry <cite class="ltx_cite ltx_citemacro_cite">Sekitani and
Yamamoto (<a href="#bib.bib39" title="" class="ltx_ref">1993</a>)</cite> of minimum-norm in the convex hull.
Given <math id="S4.SS5.SSS0.Px1.p3.13.m3.1" class="ltx_Math" alttext="p_{\tau}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.13.m3.1a"><msub id="S4.SS5.SSS0.Px1.p3.13.m3.1.1" xref="S4.SS5.SSS0.Px1.p3.13.m3.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.13.m3.1.1.2" xref="S4.SS5.SSS0.Px1.p3.13.m3.1.1.2.cmml">p</mi><mi id="S4.SS5.SSS0.Px1.p3.13.m3.1.1.3" xref="S4.SS5.SSS0.Px1.p3.13.m3.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.13.m3.1b"><apply id="S4.SS5.SSS0.Px1.p3.13.m3.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.13.m3.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.13.m3.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.13.m3.1.1">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.13.m3.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.13.m3.1.1.2">𝑝</ci><ci id="S4.SS5.SSS0.Px1.p3.13.m3.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.13.m3.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.13.m3.1c">p_{\tau}</annotation></semantics></math>, we update the weight ratio <math id="S4.SS5.SSS0.Px1.p3.14.m4.1" class="ltx_Math" alttext="\bm{p}=(1-p_{\tau})\bm{p}+p_{\tau}\bm{e}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.14.m4.1a"><mrow id="S4.SS5.SSS0.Px1.p3.14.m4.1.1" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.3" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.3.cmml">𝒑</mi><mo id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.2" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.2.cmml">=</mo><mrow id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.cmml"><mrow id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.cmml"><mrow id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.cmml"><mn id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.1" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3.2" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3.3" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3.3.cmml">τ</mi></msub></mrow><mo stretchy="false" id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.2.cmml">​</mo><mi id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.3.cmml">𝒑</mi></mrow><mo id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.2" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.2.cmml">+</mo><mrow id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.cmml"><msub id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2.cmml"><mi id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2.2" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2.2.cmml">p</mi><mi id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2.3" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2.3.cmml">τ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.1" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.1.cmml">​</mo><mi id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.3" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.3.cmml">𝒆</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.14.m4.1b"><apply id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1"><eq id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.2"></eq><ci id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.3">𝒑</ci><apply id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1"><plus id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.2"></plus><apply id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1"><times id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.2"></times><apply id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1"><minus id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.2">1</cn><apply id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.1.1.1.3.3">𝜏</ci></apply></apply><ci id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.1.3">𝒑</ci></apply><apply id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3"><times id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.1.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.1"></times><apply id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2.1.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2">subscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2.2.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2.2">𝑝</ci><ci id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2.3.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.2.3">𝜏</ci></apply><ci id="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.3.cmml" xref="S4.SS5.SSS0.Px1.p3.14.m4.1.1.1.3.3">𝒆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.14.m4.1c">\bm{p}=(1-p_{\tau})\bm{p}+p_{\tau}\bm{e}</annotation></semantics></math>, where <math id="S4.SS5.SSS0.Px1.p3.15.m5.1" class="ltx_Math" alttext="\bm{e}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.15.m5.1a"><mi id="S4.SS5.SSS0.Px1.p3.15.m5.1.1" xref="S4.SS5.SSS0.Px1.p3.15.m5.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.15.m5.1b"><ci id="S4.SS5.SSS0.Px1.p3.15.m5.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.15.m5.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.15.m5.1c">\bm{e}</annotation></semantics></math> is the one-hot vector with 1 in the <math id="S4.SS5.SSS0.Px1.p3.16.m6.1" class="ltx_Math" alttext="\tau-" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.16.m6.1a"><mrow id="S4.SS5.SSS0.Px1.p3.16.m6.1.1" xref="S4.SS5.SSS0.Px1.p3.16.m6.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.16.m6.1.1.2" xref="S4.SS5.SSS0.Px1.p3.16.m6.1.1.2.cmml">τ</mi><mo id="S4.SS5.SSS0.Px1.p3.16.m6.1.1.3" xref="S4.SS5.SSS0.Px1.p3.16.m6.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.16.m6.1b"><apply id="S4.SS5.SSS0.Px1.p3.16.m6.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.16.m6.1.1"><csymbol cd="latexml" id="S4.SS5.SSS0.Px1.p3.16.m6.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.16.m6.1.1">limit-from</csymbol><ci id="S4.SS5.SSS0.Px1.p3.16.m6.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.16.m6.1.1.2">𝜏</ci><minus id="S4.SS5.SSS0.Px1.p3.16.m6.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.16.m6.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.16.m6.1c">\tau-</annotation></semantics></math>th position.
In order to obtain the Pareto stationary point,
CU iterates the process of finding the toughest client several times to obtain the best combination <math id="S4.SS5.SSS0.Px1.p3.17.m7.1" class="ltx_Math" alttext="\bm{p}^{*}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.17.m7.1a"><msup id="S4.SS5.SSS0.Px1.p3.17.m7.1.1" xref="S4.SS5.SSS0.Px1.p3.17.m7.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.17.m7.1.1.2" xref="S4.SS5.SSS0.Px1.p3.17.m7.1.1.2.cmml">𝒑</mi><mo id="S4.SS5.SSS0.Px1.p3.17.m7.1.1.3" xref="S4.SS5.SSS0.Px1.p3.17.m7.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.17.m7.1b"><apply id="S4.SS5.SSS0.Px1.p3.17.m7.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.17.m7.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.17.m7.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.17.m7.1.1">superscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.17.m7.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.17.m7.1.1.2">𝒑</ci><times id="S4.SS5.SSS0.Px1.p3.17.m7.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.17.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.17.m7.1c">\bm{p}^{*}</annotation></semantics></math> that alleviates the inconsistent deviations of clients.
Finally, we find the consistent optimization direction with the Pareto optimal solution <math id="S4.SS5.SSS0.Px1.p3.18.m8.1" class="ltx_Math" alttext="\bm{p}^{*}" display="inline"><semantics id="S4.SS5.SSS0.Px1.p3.18.m8.1a"><msup id="S4.SS5.SSS0.Px1.p3.18.m8.1.1" xref="S4.SS5.SSS0.Px1.p3.18.m8.1.1.cmml"><mi id="S4.SS5.SSS0.Px1.p3.18.m8.1.1.2" xref="S4.SS5.SSS0.Px1.p3.18.m8.1.1.2.cmml">𝒑</mi><mo id="S4.SS5.SSS0.Px1.p3.18.m8.1.1.3" xref="S4.SS5.SSS0.Px1.p3.18.m8.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS5.SSS0.Px1.p3.18.m8.1b"><apply id="S4.SS5.SSS0.Px1.p3.18.m8.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.18.m8.1.1"><csymbol cd="ambiguous" id="S4.SS5.SSS0.Px1.p3.18.m8.1.1.1.cmml" xref="S4.SS5.SSS0.Px1.p3.18.m8.1.1">superscript</csymbol><ci id="S4.SS5.SSS0.Px1.p3.18.m8.1.1.2.cmml" xref="S4.SS5.SSS0.Px1.p3.18.m8.1.1.2">𝒑</ci><times id="S4.SS5.SSS0.Px1.p3.18.m8.1.1.3.cmml" xref="S4.SS5.SSS0.Px1.p3.18.m8.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.SSS0.Px1.p3.18.m8.1c">\bm{p}^{*}</annotation></semantics></math> for aggregating in Eq. (<a href="#S4.E8" title="In Motivation. ‣ 4.5 Consistent Aggregation ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>).</p>
</div>
<div id="S4.SS5.SSS0.Px1.p4" class="ltx_para">
<p id="S4.SS5.SSS0.Px1.p4.1" class="ltx_p">Given three main modules, i.e., HPTI, HPL, and CA, we illustrate the overall algorithm of modeling <span id="S4.SS5.SSS0.Px1.p4.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span> in Algo. <a href="#alg1" title="Algorithm 1 ‣ Motivation. ‣ 4.4 Hyperbolic Prototype Learning ‣ 4 Method ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
Steps 1-10 are the server execution.
In step2, the server initializes model parameters and HPTI in it initializes the hyperbolic class prototypes.
Then for each communication round, all clients use HPL to train their local model with the shared Poincaré ball predictor in step 6.
After that, in step 8, CA in server receives the model parameters of all clients, and mitigates the inconsistency of client deviations in aggregation.
The details of client execution is listed in steps 11-21.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments and Discussion</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>

<section id="S5.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Datasets.</h4>

<div id="S5.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS1.SSS0.Px1.p1.5" class="ltx_p">We use four public datasets in torchvision<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://pytorch.org/vision/stable/index.html</span></span></span>, i.e., EMNIST by Letters <cite class="ltx_cite ltx_citemacro_cite">Cohen <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib8" title="" class="ltx_ref">2017</a>)</cite>, Fashion-MNIST (FMNIST) <cite class="ltx_cite ltx_citemacro_cite">Xiao <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib49" title="" class="ltx_ref">2017</a>)</cite>, Cifar10, and Cifar100 <cite class="ltx_cite ltx_citemacro_cite">Krizhevsky <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib20" title="" class="ltx_ref">2009</a>)</cite>, which are widely-used in the recent FL work <cite class="ltx_cite ltx_citemacro_cite">Chen and Chao (<a href="#bib.bib4" title="" class="ltx_ref">2021</a>); <a href="#bib.bib38" title="" class="ltx_ref">Oh <span class="ltx_text ltx_font_italic">et al.</span> </a>; Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021a</a>)</cite>.
There are two evaluation goals for FL with non-IID data, i.e., global performance (G-FL) and local personalized performance (P-FL).
G-FL tests the global model aggregated in the server by evaluating the <span id="S5.SS1.SSS0.Px1.p1.5.1" class="ltx_text ltx_font_italic">test set</span> published in the torchvision.
In P-FL, we simulate local data distribution using the <span id="S5.SS1.SSS0.Px1.p1.5.2" class="ltx_text ltx_font_italic">train set</span> published in torchvision to evaluate the local models.
For all datasets, we simulate the non-IID data distributions following <cite class="ltx_cite ltx_citemacro_cite">Hsu <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib16" title="" class="ltx_ref">2019</a>); Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021a</a>)</cite>.
Specifically, we sample a proportion of instances of class <math id="S5.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="S5.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.1.m1.1c">j</annotation></semantics></math> to client <math id="S5.SS1.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.2.m2.1a"><mi id="S5.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.2.m2.1b"><ci id="S5.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.2.m2.1c">k</annotation></semantics></math> with Dirichlet distribution, i.e., <math id="S5.SS1.SSS0.Px1.p1.3.m3.3" class="ltx_Math" alttext="p_{j,k}\sim{Dir}_{N}(\alpha)" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.3.m3.3a"><mrow id="S5.SS1.SSS0.Px1.p1.3.m3.3.4" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.cmml"><msub id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.2" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.2.cmml"><mi id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.2.2" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.2.2.cmml">p</mi><mrow id="S5.SS1.SSS0.Px1.p1.3.m3.2.2.2.4" xref="S5.SS1.SSS0.Px1.p1.3.m3.2.2.2.3.cmml"><mi id="S5.SS1.SSS0.Px1.p1.3.m3.1.1.1.1" xref="S5.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.cmml">j</mi><mo id="S5.SS1.SSS0.Px1.p1.3.m3.2.2.2.4.1" xref="S5.SS1.SSS0.Px1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S5.SS1.SSS0.Px1.p1.3.m3.2.2.2.2" xref="S5.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.1" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.1.cmml">∼</mo><mrow id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.cmml"><mi id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.2" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.1" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.1.cmml">​</mo><mi id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.3" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.1a" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.1.cmml">​</mo><msub id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4.cmml"><mi id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4.2" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4.2.cmml">r</mi><mi id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4.3" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.1b" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.1.cmml">​</mo><mrow id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.5.2" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.cmml"><mo stretchy="false" id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.5.2.1" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.cmml">(</mo><mi id="S5.SS1.SSS0.Px1.p1.3.m3.3.3" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.3.cmml">α</mi><mo stretchy="false" id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.5.2.2" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.3.m3.3b"><apply id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4"><csymbol cd="latexml" id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.1.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.1">similar-to</csymbol><apply id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.2.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.2"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.2.1.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.2">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.2.2.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.2.2">𝑝</ci><list id="S5.SS1.SSS0.Px1.p1.3.m3.2.2.2.3.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.2.2.2.4"><ci id="S5.SS1.SSS0.Px1.p1.3.m3.1.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.1.1.1.1">𝑗</ci><ci id="S5.SS1.SSS0.Px1.p1.3.m3.2.2.2.2.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.2.2.2.2">𝑘</ci></list></apply><apply id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3"><times id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.1.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.1"></times><ci id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.2.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.2">𝐷</ci><ci id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.3.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.3">𝑖</ci><apply id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4"><csymbol cd="ambiguous" id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4.1.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4">subscript</csymbol><ci id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4.2.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4.2">𝑟</ci><ci id="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4.3.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.4.3.4.3">𝑁</ci></apply><ci id="S5.SS1.SSS0.Px1.p1.3.m3.3.3.cmml" xref="S5.SS1.SSS0.Px1.p1.3.m3.3.3">𝛼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.3.m3.3c">p_{j,k}\sim{Dir}_{N}(\alpha)</annotation></semantics></math>, where <math id="S5.SS1.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.4.m4.1a"><mi id="S5.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S5.SS1.SSS0.Px1.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.4.m4.1b"><ci id="S5.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.4.m4.1c">\alpha</annotation></semantics></math> denotes the non-IID degree of every class among the clients.
The smaller <math id="S5.SS1.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.5.m5.1a"><mi id="S5.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.5.m5.1b"><ci id="S5.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.5.m5.1c">\alpha</annotation></semantics></math> indicates the more heterogeneous data distribution.
We
sample 75% of local data as <span id="S5.SS1.SSS0.Px1.p1.5.3" class="ltx_text ltx_font_italic">local training set</span> and the remaining as <span id="S5.SS1.SSS0.Px1.p1.5.4" class="ltx_text ltx_font_italic">local test set</span>.</p>
</div>
</section>
<section id="S5.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Comparison Methods.</h4>

<div id="S5.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS1.SSS0.Px2.p1.1" class="ltx_p">We compare <span id="S5.SS1.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span> with three categories of state-of-the-art approaches according to their optimization goals, i.e., (1) optimizing global model: <span id="S5.SS1.SSS0.Px2.p1.1.2" class="ltx_text ltx_font_bold">FedAvg</span> <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib34" title="" class="ltx_ref">2017</a>)</cite>, <span id="S5.SS1.SSS0.Px2.p1.1.3" class="ltx_text ltx_font_bold">FedProx</span> <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite>, <span id="S5.SS1.SSS0.Px2.p1.1.4" class="ltx_text ltx_font_bold">SCAFFOLD</span> <cite class="ltx_cite ltx_citemacro_cite">Karimireddy <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib18" title="" class="ltx_ref">2019</a>)</cite>, <span id="S5.SS1.SSS0.Px2.p1.1.5" class="ltx_text ltx_font_bold">FedDYN</span> <cite class="ltx_cite ltx_citemacro_cite">Acar <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib1" title="" class="ltx_ref">2020</a>)</cite>, <span id="S5.SS1.SSS0.Px2.p1.1.6" class="ltx_text ltx_font_bold">MOON</span> <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib24" title="" class="ltx_ref">2021a</a>)</cite>, (2) optimizing local personalized models: <span id="S5.SS1.SSS0.Px2.p1.1.7" class="ltx_text ltx_font_bold">FedMTL</span> <cite class="ltx_cite ltx_citemacro_cite">Smith <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib43" title="" class="ltx_ref">2017</a>)</cite>, <span id="S5.SS1.SSS0.Px2.p1.1.8" class="ltx_text ltx_font_bold">FedPer</span> <cite class="ltx_cite ltx_citemacro_cite">Arivazhagan <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib2" title="" class="ltx_ref">2019</a>)</cite>, <span id="S5.SS1.SSS0.Px2.p1.1.9" class="ltx_text ltx_font_bold">pFedMe</span> <cite class="ltx_cite ltx_citemacro_cite">T Dinh <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib44" title="" class="ltx_ref">2020</a>)</cite>, <span id="S5.SS1.SSS0.Px2.p1.1.10" class="ltx_text ltx_font_bold">Ditto</span> <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib25" title="" class="ltx_ref">2021b</a>)</cite>,
<span id="S5.SS1.SSS0.Px2.p1.1.11" class="ltx_text ltx_font_bold">APPLE</span> <cite class="ltx_cite ltx_citemacro_cite">Luo and Wu (<a href="#bib.bib31" title="" class="ltx_ref">2021</a>)</cite>, and (3) optimizing both global and local models: <span id="S5.SS1.SSS0.Px2.p1.1.12" class="ltx_text ltx_font_bold">Fed-RoD</span> <cite class="ltx_cite ltx_citemacro_cite">Chen and Chao (<a href="#bib.bib4" title="" class="ltx_ref">2021</a>)</cite>, <span id="S5.SS1.SSS0.Px2.p1.1.13" class="ltx_text ltx_font_bold">FedBABU</span> <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib38" title="" class="ltx_ref">Oh <span class="ltx_text ltx_font_italic">et al.</span> </a></cite>, and <span id="S5.SS1.SSS0.Px2.p1.1.14" class="ltx_text ltx_font_bold">SphereFed</span> <cite class="ltx_cite ltx_citemacro_cite">Dong <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib10" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
</section>
<section id="S5.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Implementation Details.</h4>

<div id="S5.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="S5.SS1.SSS0.Px3.p1.4" class="ltx_p">We adopt ConvNet <cite class="ltx_cite ltx_citemacro_cite">LeCun <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib21" title="" class="ltx_ref">1998</a>)</cite> as a feature extractor for EMNIST and FMNIST, while ResNet <cite class="ltx_cite ltx_citemacro_cite">He <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib15" title="" class="ltx_ref">2016</a>)</cite> for Cifar10 and Cifar100.
We set all of the datasets with batch size as 128 and embedding dimension as 20.
For <span id="S5.SS1.SSS0.Px3.p1.4.1" class="ltx_text ltx_font_typewriter">HyperFed</span>, we choose RSGD <cite class="ltx_cite ltx_citemacro_cite">Bonnabel (<a href="#bib.bib3" title="" class="ltx_ref">2013</a>)</cite> as the optimizer, set the learning rate <math id="S5.SS1.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="lr=0.3" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.1.m1.1a"><mrow id="S5.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.cmml"><mrow id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml"><mi id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.2" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.1" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.3" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.3.cmml">r</mi></mrow><mo id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.1" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.3" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.1.m1.1b"><apply id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1"><eq id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.1"></eq><apply id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2"><times id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.1.cmml" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.1"></times><ci id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.2.cmml" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.2">𝑙</ci><ci id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.3.cmml" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.2.3">𝑟</ci></apply><cn type="float" id="S5.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS0.Px3.p1.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.1.m1.1c">lr=0.3</annotation></semantics></math>, the margin <math id="S5.SS1.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="m=3" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.2.m2.1a"><mrow id="S5.SS1.SSS0.Px3.p1.2.m2.1.1" xref="S5.SS1.SSS0.Px3.p1.2.m2.1.1.cmml"><mi id="S5.SS1.SSS0.Px3.p1.2.m2.1.1.2" xref="S5.SS1.SSS0.Px3.p1.2.m2.1.1.2.cmml">m</mi><mo id="S5.SS1.SSS0.Px3.p1.2.m2.1.1.1" xref="S5.SS1.SSS0.Px3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px3.p1.2.m2.1.1.3" xref="S5.SS1.SSS0.Px3.p1.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.2.m2.1b"><apply id="S5.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.2.m2.1.1"><eq id="S5.SS1.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.2.m2.1.1.1"></eq><ci id="S5.SS1.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS0.Px3.p1.2.m2.1.1.2">𝑚</ci><cn type="integer" id="S5.SS1.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S5.SS1.SSS0.Px3.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.2.m2.1c">m=3</annotation></semantics></math>, and the slope degree <math id="S5.SS1.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="s=0.9" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.3.m3.1a"><mrow id="S5.SS1.SSS0.Px3.p1.3.m3.1.1" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.2" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml">s</mi><mo id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.1" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.3" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.3.m3.1b"><apply id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1"><eq id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.1"></eq><ci id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.2">𝑠</ci><cn type="float" id="S5.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S5.SS1.SSS0.Px3.p1.3.m3.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.3.m3.1c">s=0.9</annotation></semantics></math>.
We conduct training for all of the methods with 5 local epochs per round until converge.
We evaluate both G-FL and P-FL by top-1 accuracy.
We set the non-IID degree <math id="S5.SS1.SSS0.Px3.p1.4.m4.3" class="ltx_Math" alttext="\alpha=\{0.1,0.5,5\}" display="inline"><semantics id="S5.SS1.SSS0.Px3.p1.4.m4.3a"><mrow id="S5.SS1.SSS0.Px3.p1.4.m4.3.4" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.4.cmml"><mi id="S5.SS1.SSS0.Px3.p1.4.m4.3.4.2" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.4.2.cmml">α</mi><mo id="S5.SS1.SSS0.Px3.p1.4.m4.3.4.1" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.4.1.cmml">=</mo><mrow id="S5.SS1.SSS0.Px3.p1.4.m4.3.4.3.2" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.4.3.1.cmml"><mo stretchy="false" id="S5.SS1.SSS0.Px3.p1.4.m4.3.4.3.2.1" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.4.3.1.cmml">{</mo><mn id="S5.SS1.SSS0.Px3.p1.4.m4.1.1" xref="S5.SS1.SSS0.Px3.p1.4.m4.1.1.cmml">0.1</mn><mo id="S5.SS1.SSS0.Px3.p1.4.m4.3.4.3.2.2" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.4.3.1.cmml">,</mo><mn id="S5.SS1.SSS0.Px3.p1.4.m4.2.2" xref="S5.SS1.SSS0.Px3.p1.4.m4.2.2.cmml">0.5</mn><mo id="S5.SS1.SSS0.Px3.p1.4.m4.3.4.3.2.3" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.4.3.1.cmml">,</mo><mn id="S5.SS1.SSS0.Px3.p1.4.m4.3.3" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.3.cmml">5</mn><mo stretchy="false" id="S5.SS1.SSS0.Px3.p1.4.m4.3.4.3.2.4" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px3.p1.4.m4.3b"><apply id="S5.SS1.SSS0.Px3.p1.4.m4.3.4.cmml" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.4"><eq id="S5.SS1.SSS0.Px3.p1.4.m4.3.4.1.cmml" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.4.1"></eq><ci id="S5.SS1.SSS0.Px3.p1.4.m4.3.4.2.cmml" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.4.2">𝛼</ci><set id="S5.SS1.SSS0.Px3.p1.4.m4.3.4.3.1.cmml" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.4.3.2"><cn type="float" id="S5.SS1.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS0.Px3.p1.4.m4.1.1">0.1</cn><cn type="float" id="S5.SS1.SSS0.Px3.p1.4.m4.2.2.cmml" xref="S5.SS1.SSS0.Px3.p1.4.m4.2.2">0.5</cn><cn type="integer" id="S5.SS1.SSS0.Px3.p1.4.m4.3.3.cmml" xref="S5.SS1.SSS0.Px3.p1.4.m4.3.3">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px3.p1.4.m4.3c">\alpha=\{0.1,0.5,5\}</annotation></semantics></math>, respectively, for evaluating the performance of different methods.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2307.14384/assets/figs/visualization/fmnist/3.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="509" height="422" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>UMAP visualizations on FMNIST (<math id="S5.F3.2.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S5.F3.2.m1.1b"><mrow id="S5.F3.2.m1.1.1" xref="S5.F3.2.m1.1.1.cmml"><mi id="S5.F3.2.m1.1.1.2" xref="S5.F3.2.m1.1.1.2.cmml">α</mi><mo id="S5.F3.2.m1.1.1.1" xref="S5.F3.2.m1.1.1.1.cmml">=</mo><mn id="S5.F3.2.m1.1.1.3" xref="S5.F3.2.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.2.m1.1c"><apply id="S5.F3.2.m1.1.1.cmml" xref="S5.F3.2.m1.1.1"><eq id="S5.F3.2.m1.1.1.1.cmml" xref="S5.F3.2.m1.1.1.1"></eq><ci id="S5.F3.2.m1.1.1.2.cmml" xref="S5.F3.2.m1.1.1.2">𝛼</ci><cn type="float" id="S5.F3.2.m1.1.1.3.cmml" xref="S5.F3.2.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.2.m1.1d">\alpha=0.5</annotation></semantics></math>).</figcaption>
</figure>
<figure id="S5.T1" class="ltx_table">
<div id="S5.T1.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:173.1pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-100.1pt,39.8pt) scale(0.684211790988839,0.684211790988839) ;">
<table id="S5.T1.3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.3.1.1.1" class="ltx_tr">
<th id="S5.T1.3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dataset</th>
<td id="S5.T1.3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;" colspan="3">EMNIST</td>
<td id="S5.T1.3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;" colspan="3">FMNIST</td>
<td id="S5.T1.3.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;" colspan="3">Cifar10</td>
<td id="S5.T1.3.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;" colspan="3">Cifar100</td>
</tr>
<tr id="S5.T1.3.1.2.2" class="ltx_tr">
<th id="S5.T1.3.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Method \NonIID</th>
<td id="S5.T1.3.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.1)</td>
<td id="S5.T1.3.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.5)</td>
<td id="S5.T1.3.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(5)</td>
<td id="S5.T1.3.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.1)</td>
<td id="S5.T1.3.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.5)</td>
<td id="S5.T1.3.1.2.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(5)</td>
<td id="S5.T1.3.1.2.2.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.1)</td>
<td id="S5.T1.3.1.2.2.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.5)</td>
<td id="S5.T1.3.1.2.2.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(5)</td>
<td id="S5.T1.3.1.2.2.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.1)</td>
<td id="S5.T1.3.1.2.2.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.5)</td>
<td id="S5.T1.3.1.2.2.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(5)</td>
</tr>
<tr id="S5.T1.3.1.3.3" class="ltx_tr">
<th id="S5.T1.3.1.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">FedAvg</th>
<td id="S5.T1.3.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">88.86</td>
<td id="S5.T1.3.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.86</td>
<td id="S5.T1.3.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.31</td>
<td id="S5.T1.3.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">78.51</td>
<td id="S5.T1.3.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">86.75</td>
<td id="S5.T1.3.1.3.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">88.75</td>
<td id="S5.T1.3.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">36.82</td>
<td id="S5.T1.3.1.3.3.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">62.44</td>
<td id="S5.T1.3.1.3.3.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">67.53</td>
<td id="S5.T1.3.1.3.3.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">27.61</td>
<td id="S5.T1.3.1.3.3.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">29.26</td>
<td id="S5.T1.3.1.3.3.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">30.12</td>
</tr>
<tr id="S5.T1.3.1.4.4" class="ltx_tr">
<th id="S5.T1.3.1.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">FedProx</th>
<td id="S5.T1.3.1.4.4.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.75</td>
<td id="S5.T1.3.1.4.4.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.27</td>
<td id="S5.T1.3.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.65</td>
<td id="S5.T1.3.1.4.4.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">78.49</td>
<td id="S5.T1.3.1.4.4.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">86.57</td>
<td id="S5.T1.3.1.4.4.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">88.68</td>
<td id="S5.T1.3.1.4.4.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">37.95</td>
<td id="S5.T1.3.1.4.4.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">63.48</td>
<td id="S5.T1.3.1.4.4.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">67.23</td>
<td id="S5.T1.3.1.4.4.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">26.91</td>
<td id="S5.T1.3.1.4.4.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">29.77</td>
<td id="S5.T1.3.1.4.4.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">29.98</td>
</tr>
<tr id="S5.T1.3.1.5.5" class="ltx_tr">
<th id="S5.T1.3.1.5.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">SCAFFOLD</th>
<td id="S5.T1.3.1.5.5.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.35</td>
<td id="S5.T1.3.1.5.5.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.38</td>
<td id="S5.T1.3.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.70</td>
<td id="S5.T1.3.1.5.5.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">79.20</td>
<td id="S5.T1.3.1.5.5.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">87.03</td>
<td id="S5.T1.3.1.5.5.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">88.80</td>
<td id="S5.T1.3.1.5.5.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">33.10</td>
<td id="S5.T1.3.1.5.5.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">66.99</td>
<td id="S5.T1.3.1.5.5.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">70.53</td>
<td id="S5.T1.3.1.5.5.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">29.57</td>
<td id="S5.T1.3.1.5.5.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">33.25</td>
<td id="S5.T1.3.1.5.5.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">33.86</td>
</tr>
<tr id="S5.T1.3.1.6.6" class="ltx_tr">
<th id="S5.T1.3.1.6.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">FedDYN</th>
<td id="S5.T1.3.1.6.6.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.30</td>
<td id="S5.T1.3.1.6.6.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.63</td>
<td id="S5.T1.3.1.6.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.13</td>
<td id="S5.T1.3.1.6.6.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">85.25</td>
<td id="S5.T1.3.1.6.6.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">89.46</td>
<td id="S5.T1.3.1.6.6.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.51</td>
<td id="S5.T1.3.1.6.6.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">35.16</td>
<td id="S5.T1.3.1.6.6.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">65.07</td>
<td id="S5.T1.3.1.6.6.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">69.04</td>
<td id="S5.T1.3.1.6.6.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">29.16</td>
<td id="S5.T1.3.1.6.6.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">31.49</td>
<td id="S5.T1.3.1.6.6.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">32.21</td>
</tr>
<tr id="S5.T1.3.1.7.7" class="ltx_tr">
<th id="S5.T1.3.1.7.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">MOON</th>
<td id="S5.T1.3.1.7.7.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.97</td>
<td id="S5.T1.3.1.7.7.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.50</td>
<td id="S5.T1.3.1.7.7.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.91</td>
<td id="S5.T1.3.1.7.7.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">83.78</td>
<td id="S5.T1.3.1.7.7.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.27</td>
<td id="S5.T1.3.1.7.7.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.08</td>
<td id="S5.T1.3.1.7.7.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">33.54</td>
<td id="S5.T1.3.1.7.7.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">60.23</td>
<td id="S5.T1.3.1.7.7.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">62.45</td>
<td id="S5.T1.3.1.7.7.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">22.86</td>
<td id="S5.T1.3.1.7.7.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">24.49</td>
<td id="S5.T1.3.1.7.7.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">25.99</td>
</tr>
<tr id="S5.T1.3.1.8.8" class="ltx_tr">
<th id="S5.T1.3.1.8.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Fed-RoD</th>
<td id="S5.T1.3.1.8.8.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">89.42</td>
<td id="S5.T1.3.1.8.8.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.80</td>
<td id="S5.T1.3.1.8.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.52</td>
<td id="S5.T1.3.1.8.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">77.26</td>
<td id="S5.T1.3.1.8.8.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">89.17</td>
<td id="S5.T1.3.1.8.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.78</td>
<td id="S5.T1.3.1.8.8.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">37.79</td>
<td id="S5.T1.3.1.8.8.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">66.90</td>
<td id="S5.T1.3.1.8.8.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">70.81</td>
<td id="S5.T1.3.1.8.8.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">17.06</td>
<td id="S5.T1.3.1.8.8.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">24.32</td>
<td id="S5.T1.3.1.8.8.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">31.99</td>
</tr>
<tr id="S5.T1.3.1.9.9" class="ltx_tr">
<th id="S5.T1.3.1.9.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">FedBABU</th>
<td id="S5.T1.3.1.9.9.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">86.34</td>
<td id="S5.T1.3.1.9.9.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.95</td>
<td id="S5.T1.3.1.9.9.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.74</td>
<td id="S5.T1.3.1.9.9.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">74.31</td>
<td id="S5.T1.3.1.9.9.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">82.44</td>
<td id="S5.T1.3.1.9.9.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">85.21</td>
<td id="S5.T1.3.1.9.9.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">37.90</td>
<td id="S5.T1.3.1.9.9.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">60.11</td>
<td id="S5.T1.3.1.9.9.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">65.16</td>
<td id="S5.T1.3.1.9.9.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">22.98</td>
<td id="S5.T1.3.1.9.9.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">24.56</td>
<td id="S5.T1.3.1.9.9.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">23.89</td>
</tr>
<tr id="S5.T1.3.1.10.10" class="ltx_tr">
<th id="S5.T1.3.1.10.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">SphereFed</th>
<td id="S5.T1.3.1.10.10.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.25</td>
<td id="S5.T1.3.1.10.10.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.93</td>
<td id="S5.T1.3.1.10.10.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.07</td>
<td id="S5.T1.3.1.10.10.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">88.55</td>
<td id="S5.T1.3.1.10.10.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.55</td>
<td id="S5.T1.3.1.10.10.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.17</td>
<td id="S5.T1.3.1.10.10.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">32.41</td>
<td id="S5.T1.3.1.10.10.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">70.02</td>
<td id="S5.T1.3.1.10.10.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">70.13</td>
<td id="S5.T1.3.1.10.10.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">22.37</td>
<td id="S5.T1.3.1.10.10.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">24.96</td>
<td id="S5.T1.3.1.10.10.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">24.72</td>
</tr>
<tr id="S5.T1.3.1.11.11" class="ltx_tr">
<th id="S5.T1.3.1.11.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">
<span id="S5.T1.3.1.11.11.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span>-<span id="S5.T1.3.1.11.11.1.2" class="ltx_text ltx_font_typewriter">Geodesic</span>
</th>
<td id="S5.T1.3.1.11.11.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.35</td>
<td id="S5.T1.3.1.11.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.13</td>
<td id="S5.T1.3.1.11.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.43</td>
<td id="S5.T1.3.1.11.11.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">79.00</td>
<td id="S5.T1.3.1.11.11.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.76</td>
<td id="S5.T1.3.1.11.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.48</td>
<td id="S5.T1.3.1.11.11.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">34.26</td>
<td id="S5.T1.3.1.11.11.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">65.53</td>
<td id="S5.T1.3.1.11.11.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">68.65</td>
<td id="S5.T1.3.1.11.11.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">26.05</td>
<td id="S5.T1.3.1.11.11.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">29.07</td>
<td id="S5.T1.3.1.11.11.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">26.62</td>
</tr>
<tr id="S5.T1.3.1.12.12" class="ltx_tr">
<th id="S5.T1.3.1.12.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">
<span id="S5.T1.3.1.12.12.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span>-<span id="S5.T1.3.1.12.12.1.2" class="ltx_text ltx_font_typewriter">Shared</span>
</th>
<td id="S5.T1.3.1.12.12.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.82</td>
<td id="S5.T1.3.1.12.12.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.98</td>
<td id="S5.T1.3.1.12.12.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.16</td>
<td id="S5.T1.3.1.12.12.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">85.29</td>
<td id="S5.T1.3.1.12.12.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.48</td>
<td id="S5.T1.3.1.12.12.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.23</td>
<td id="S5.T1.3.1.12.12.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">36.44</td>
<td id="S5.T1.3.1.12.12.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">69.21</td>
<td id="S5.T1.3.1.12.12.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">73.16</td>
<td id="S5.T1.3.1.12.12.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">33.62</td>
<td id="S5.T1.3.1.12.12.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">35.31</td>
<td id="S5.T1.3.1.12.12.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">36.30</td>
</tr>
<tr id="S5.T1.3.1.13.13" class="ltx_tr">
<th id="S5.T1.3.1.13.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">
<span id="S5.T1.3.1.13.13.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span>-<span id="S5.T1.3.1.13.13.1.2" class="ltx_text ltx_font_typewriter">Averaged</span>
</th>
<td id="S5.T1.3.1.13.13.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.65</td>
<td id="S5.T1.3.1.13.13.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.29</td>
<td id="S5.T1.3.1.13.13.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.45</td>
<td id="S5.T1.3.1.13.13.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">87.91</td>
<td id="S5.T1.3.1.13.13.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.98</td>
<td id="S5.T1.3.1.13.13.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.69</td>
<td id="S5.T1.3.1.13.13.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">36.69</td>
<td id="S5.T1.3.1.13.13.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">70.12</td>
<td id="S5.T1.3.1.13.13.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">70.81</td>
<td id="S5.T1.3.1.13.13.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">33.39</td>
<td id="S5.T1.3.1.13.13.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">36.33</td>
<td id="S5.T1.3.1.13.13.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">36.93</td>
</tr>
<tr id="S5.T1.3.1.14.14" class="ltx_tr">
<th id="S5.T1.3.1.14.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span></th>
<td id="S5.T1.3.1.14.14.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.2.1" class="ltx_text ltx_font_bold">94.00</span></td>
<td id="S5.T1.3.1.14.14.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.3.1" class="ltx_text ltx_font_bold">94.33</span></td>
<td id="S5.T1.3.1.14.14.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.4.1" class="ltx_text ltx_font_bold">94.46</span></td>
<td id="S5.T1.3.1.14.14.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.5.1" class="ltx_text ltx_font_bold">89.38</span></td>
<td id="S5.T1.3.1.14.14.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.6.1" class="ltx_text ltx_font_bold">91.16</span></td>
<td id="S5.T1.3.1.14.14.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.7.1" class="ltx_text ltx_font_bold">91.83</span></td>
<td id="S5.T1.3.1.14.14.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.8.1" class="ltx_text ltx_font_bold">38.03</span></td>
<td id="S5.T1.3.1.14.14.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.9.1" class="ltx_text ltx_font_bold">71.25</span></td>
<td id="S5.T1.3.1.14.14.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.10.1" class="ltx_text ltx_font_bold">75.22</span></td>
<td id="S5.T1.3.1.14.14.11" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.11.1" class="ltx_text ltx_font_bold">33.93</span></td>
<td id="S5.T1.3.1.14.14.12" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.12.1" class="ltx_text ltx_font_bold">38.89</span></td>
<td id="S5.T1.3.1.14.14.13" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T1.3.1.14.14.13.1" class="ltx_text ltx_font_bold">37.50</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>G-FL accuracy (<math id="S5.T1.2.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.T1.2.m1.1b"><mo id="S5.T1.2.m1.1.1" xref="S5.T1.2.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.T1.2.m1.1c"><csymbol cd="latexml" id="S5.T1.2.m1.1.1.cmml" xref="S5.T1.2.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.m1.1d">\%</annotation></semantics></math>) of the global model. We bold the best result.</figcaption>
</figure>
<figure id="S5.T2" class="ltx_table">
<div id="S5.T2.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:185.4pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-100.1pt,42.6pt) scale(0.684211790988839,0.684211790988839) ;">
<table id="S5.T2.3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.3.1.1.1" class="ltx_tr">
<th id="S5.T2.3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dataset</th>
<td id="S5.T2.3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;" colspan="3">EMNIST</td>
<td id="S5.T2.3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;" colspan="3">FMNIST</td>
<td id="S5.T2.3.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;" colspan="3">Cifar10</td>
<td id="S5.T2.3.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;" colspan="3">Cifar100</td>
</tr>
<tr id="S5.T2.3.1.2.2" class="ltx_tr">
<th id="S5.T2.3.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Method \NonIID</th>
<td id="S5.T2.3.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.1)</td>
<td id="S5.T2.3.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.5)</td>
<td id="S5.T2.3.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(5)</td>
<td id="S5.T2.3.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.1)</td>
<td id="S5.T2.3.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.5)</td>
<td id="S5.T2.3.1.2.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(5)</td>
<td id="S5.T2.3.1.2.2.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.1)</td>
<td id="S5.T2.3.1.2.2.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.5)</td>
<td id="S5.T2.3.1.2.2.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(5)</td>
<td id="S5.T2.3.1.2.2.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.1)</td>
<td id="S5.T2.3.1.2.2.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(0.5)</td>
<td id="S5.T2.3.1.2.2.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dir(5)</td>
</tr>
<tr id="S5.T2.3.1.3.3" class="ltx_tr">
<th id="S5.T2.3.1.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">FedMTL</th>
<td id="S5.T2.3.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">96.28</td>
<td id="S5.T2.3.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.08</td>
<td id="S5.T2.3.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">88.21</td>
<td id="S5.T2.3.1.3.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.39</td>
<td id="S5.T2.3.1.3.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.89</td>
<td id="S5.T2.3.1.3.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">85.71</td>
<td id="S5.T2.3.1.3.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.57</td>
<td id="S5.T2.3.1.3.3.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">65.68</td>
<td id="S5.T2.3.1.3.3.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">48.31</td>
<td id="S5.T2.3.1.3.3.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">46.28</td>
<td id="S5.T2.3.1.3.3.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">24.72</td>
<td id="S5.T2.3.1.3.3.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">11.64</td>
</tr>
<tr id="S5.T2.3.1.4.4" class="ltx_tr">
<th id="S5.T2.3.1.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">FedPer</th>
<td id="S5.T2.3.1.4.4.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.23</td>
<td id="S5.T2.3.1.4.4.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.19</td>
<td id="S5.T2.3.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.97</td>
<td id="S5.T2.3.1.4.4.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">96.87</td>
<td id="S5.T2.3.1.4.4.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.54</td>
<td id="S5.T2.3.1.4.4.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">87.21</td>
<td id="S5.T2.3.1.4.4.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.93</td>
<td id="S5.T2.3.1.4.4.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">75.63</td>
<td id="S5.T2.3.1.4.4.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">67.20</td>
<td id="S5.T2.3.1.4.4.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">49.69</td>
<td id="S5.T2.3.1.4.4.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">32.75</td>
<td id="S5.T2.3.1.4.4.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">23.89</td>
</tr>
<tr id="S5.T2.3.1.5.5" class="ltx_tr">
<th id="S5.T2.3.1.5.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">pFedMe</th>
<td id="S5.T2.3.1.5.5.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.23</td>
<td id="S5.T2.3.1.5.5.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.03</td>
<td id="S5.T2.3.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.62</td>
<td id="S5.T2.3.1.5.5.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">96.03</td>
<td id="S5.T2.3.1.5.5.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">88.57</td>
<td id="S5.T2.3.1.5.5.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">84.95</td>
<td id="S5.T2.3.1.5.5.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.45</td>
<td id="S5.T2.3.1.5.5.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">77.64</td>
<td id="S5.T2.3.1.5.5.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">66.09</td>
<td id="S5.T2.3.1.5.5.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">55.20</td>
<td id="S5.T2.3.1.5.5.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">36.34</td>
<td id="S5.T2.3.1.5.5.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">28.19</td>
</tr>
<tr id="S5.T2.3.1.6.6" class="ltx_tr">
<th id="S5.T2.3.1.6.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Ditto</th>
<td id="S5.T2.3.1.6.6.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.72</td>
<td id="S5.T2.3.1.6.6.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">95.32</td>
<td id="S5.T2.3.1.6.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.30</td>
<td id="S5.T2.3.1.6.6.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.79</td>
<td id="S5.T2.3.1.6.6.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.75</td>
<td id="S5.T2.3.1.6.6.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.05</td>
<td id="S5.T2.3.1.6.6.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.34</td>
<td id="S5.T2.3.1.6.6.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">74.35</td>
<td id="S5.T2.3.1.6.6.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">69.94</td>
<td id="S5.T2.3.1.6.6.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">47.08</td>
<td id="S5.T2.3.1.6.6.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">31.89</td>
<td id="S5.T2.3.1.6.6.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">27.04</td>
</tr>
<tr id="S5.T2.3.1.7.7" class="ltx_tr">
<th id="S5.T2.3.1.7.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">APPLE</th>
<td id="S5.T2.3.1.7.7.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.19</td>
<td id="S5.T2.3.1.7.7.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.08</td>
<td id="S5.T2.3.1.7.7.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.63</td>
<td id="S5.T2.3.1.7.7.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">96.79</td>
<td id="S5.T2.3.1.7.7.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.49</td>
<td id="S5.T2.3.1.7.7.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">86.59</td>
<td id="S5.T2.3.1.7.7.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">89.85</td>
<td id="S5.T2.3.1.7.7.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">67.96</td>
<td id="S5.T2.3.1.7.7.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">56.13</td>
<td id="S5.T2.3.1.7.7.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">42.94</td>
<td id="S5.T2.3.1.7.7.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">24.61</td>
<td id="S5.T2.3.1.7.7.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">20.39</td>
</tr>
<tr id="S5.T2.3.1.8.8" class="ltx_tr">
<th id="S5.T2.3.1.8.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Fed-RoD</th>
<td id="S5.T2.3.1.8.8.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.76</td>
<td id="S5.T2.3.1.8.8.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">95.31</td>
<td id="S5.T2.3.1.8.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.99</td>
<td id="S5.T2.3.1.8.8.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.21</td>
<td id="S5.T2.3.1.8.8.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.48</td>
<td id="S5.T2.3.1.8.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.62</td>
<td id="S5.T2.3.1.8.8.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.24</td>
<td id="S5.T2.3.1.8.8.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">72.11</td>
<td id="S5.T2.3.1.8.8.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">71.33</td>
<td id="S5.T2.3.1.8.8.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">35.03</td>
<td id="S5.T2.3.1.8.8.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">27.70</td>
<td id="S5.T2.3.1.8.8.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">32.22</td>
</tr>
<tr id="S5.T2.3.1.9.9" class="ltx_tr">
<th id="S5.T2.3.1.9.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">FedBABU</th>
<td id="S5.T2.3.1.9.9.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.36</td>
<td id="S5.T2.3.1.9.9.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.17</td>
<td id="S5.T2.3.1.9.9.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.81</td>
<td id="S5.T2.3.1.9.9.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">96.64</td>
<td id="S5.T2.3.1.9.9.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">89.59</td>
<td id="S5.T2.3.1.9.9.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">85.57</td>
<td id="S5.T2.3.1.9.9.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.04</td>
<td id="S5.T2.3.1.9.9.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">64.05</td>
<td id="S5.T2.3.1.9.9.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">63.46</td>
<td id="S5.T2.3.1.9.9.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">29.30</td>
<td id="S5.T2.3.1.9.9.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">25.05</td>
<td id="S5.T2.3.1.9.9.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">24.01</td>
</tr>
<tr id="S5.T2.3.1.10.10" class="ltx_tr">
<th id="S5.T2.3.1.10.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">SphereFed</th>
<td id="S5.T2.3.1.10.10.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.61</td>
<td id="S5.T2.3.1.10.10.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.11</td>
<td id="S5.T2.3.1.10.10.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.34</td>
<td id="S5.T2.3.1.10.10.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">88.91</td>
<td id="S5.T2.3.1.10.10.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.87</td>
<td id="S5.T2.3.1.10.10.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.88</td>
<td id="S5.T2.3.1.10.10.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.68</td>
<td id="S5.T2.3.1.10.10.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">78.39</td>
<td id="S5.T2.3.1.10.10.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">72.86</td>
<td id="S5.T2.3.1.10.10.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">40.68</td>
<td id="S5.T2.3.1.10.10.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">32.63</td>
<td id="S5.T2.3.1.10.10.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">34.90</td>
</tr>
<tr id="S5.T2.3.1.11.11" class="ltx_tr">
<th id="S5.T2.3.1.11.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">
<span id="S5.T2.3.1.11.11.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span>-<span id="S5.T2.3.1.11.11.1.2" class="ltx_text ltx_font_typewriter">Geodesic</span>
</th>
<td id="S5.T2.3.1.11.11.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.97</td>
<td id="S5.T2.3.1.11.11.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">95.60</td>
<td id="S5.T2.3.1.11.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.48</td>
<td id="S5.T2.3.1.11.11.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.00</td>
<td id="S5.T2.3.1.11.11.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.98</td>
<td id="S5.T2.3.1.11.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.89</td>
<td id="S5.T2.3.1.11.11.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.68</td>
<td id="S5.T2.3.1.11.11.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">72.20</td>
<td id="S5.T2.3.1.11.11.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">69.02</td>
<td id="S5.T2.3.1.11.11.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">29.70</td>
<td id="S5.T2.3.1.11.11.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">27.11</td>
<td id="S5.T2.3.1.11.11.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">27.03</td>
</tr>
<tr id="S5.T2.3.1.12.12" class="ltx_tr">
<th id="S5.T2.3.1.12.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">
<span id="S5.T2.3.1.12.12.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span>-<span id="S5.T2.3.1.12.12.1.2" class="ltx_text ltx_font_typewriter">Fixed</span>
</th>
<td id="S5.T2.3.1.12.12.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.96</td>
<td id="S5.T2.3.1.12.12.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">95.65</td>
<td id="S5.T2.3.1.12.12.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.45</td>
<td id="S5.T2.3.1.12.12.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">96.53</td>
<td id="S5.T2.3.1.12.12.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.66</td>
<td id="S5.T2.3.1.12.12.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.85</td>
<td id="S5.T2.3.1.12.12.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.57</td>
<td id="S5.T2.3.1.12.12.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">79.66</td>
<td id="S5.T2.3.1.12.12.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">59.38</td>
<td id="S5.T2.3.1.12.12.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">49.08</td>
<td id="S5.T2.3.1.12.12.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">20.20</td>
<td id="S5.T2.3.1.12.12.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">11.31</td>
</tr>
<tr id="S5.T2.3.1.13.13" class="ltx_tr">
<th id="S5.T2.3.1.13.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">
<span id="S5.T2.3.1.13.13.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span>-<span id="S5.T2.3.1.13.13.1.2" class="ltx_text ltx_font_typewriter">Shared</span>
</th>
<td id="S5.T2.3.1.13.13.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.50</td>
<td id="S5.T2.3.1.13.13.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">95.66</td>
<td id="S5.T2.3.1.13.13.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.39</td>
<td id="S5.T2.3.1.13.13.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.50</td>
<td id="S5.T2.3.1.13.13.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.00</td>
<td id="S5.T2.3.1.13.13.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.52</td>
<td id="S5.T2.3.1.13.13.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.69</td>
<td id="S5.T2.3.1.13.13.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">77.43</td>
<td id="S5.T2.3.1.13.13.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">71.62</td>
<td id="S5.T2.3.1.13.13.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">47.97</td>
<td id="S5.T2.3.1.13.13.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">33.16</td>
<td id="S5.T2.3.1.13.13.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">35.19</td>
</tr>
<tr id="S5.T2.3.1.14.14" class="ltx_tr">
<th id="S5.T2.3.1.14.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">
<span id="S5.T2.3.1.14.14.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span>-<span id="S5.T2.3.1.14.14.1.2" class="ltx_text ltx_font_typewriter">Averaged</span>
</th>
<td id="S5.T2.3.1.14.14.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.71</td>
<td id="S5.T2.3.1.14.14.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">95.13</td>
<td id="S5.T2.3.1.14.14.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">94.46</td>
<td id="S5.T2.3.1.14.14.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">97.83</td>
<td id="S5.T2.3.1.14.14.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.73</td>
<td id="S5.T2.3.1.14.14.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.96</td>
<td id="S5.T2.3.1.14.14.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">92.63</td>
<td id="S5.T2.3.1.14.14.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">70.53</td>
<td id="S5.T2.3.1.14.14.10" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">69.02</td>
<td id="S5.T2.3.1.14.14.11" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">53.50</td>
<td id="S5.T2.3.1.14.14.12" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">36.49</td>
<td id="S5.T2.3.1.14.14.13" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">35.79</td>
</tr>
<tr id="S5.T2.3.1.15.15" class="ltx_tr">
<th id="S5.T2.3.1.15.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span></th>
<td id="S5.T2.3.1.15.15.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.2.1" class="ltx_text ltx_font_bold">98.76</span></td>
<td id="S5.T2.3.1.15.15.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.3.1" class="ltx_text ltx_font_bold">96.11</span></td>
<td id="S5.T2.3.1.15.15.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.4.1" class="ltx_text ltx_font_bold">94.53</span></td>
<td id="S5.T2.3.1.15.15.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.5.1" class="ltx_text ltx_font_bold">98.13</span></td>
<td id="S5.T2.3.1.15.15.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.6.1" class="ltx_text ltx_font_bold">94.19</span></td>
<td id="S5.T2.3.1.15.15.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.7.1" class="ltx_text ltx_font_bold">92.08</span></td>
<td id="S5.T2.3.1.15.15.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.8.1" class="ltx_text ltx_font_bold">93.49</span></td>
<td id="S5.T2.3.1.15.15.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.9.1" class="ltx_text ltx_font_bold">83.17</span></td>
<td id="S5.T2.3.1.15.15.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.10.1" class="ltx_text ltx_font_bold">74.94</span></td>
<td id="S5.T2.3.1.15.15.11" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.11.1" class="ltx_text ltx_font_bold">59.85</span></td>
<td id="S5.T2.3.1.15.15.12" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.12.1" class="ltx_text ltx_font_bold">40.94</span></td>
<td id="S5.T2.3.1.15.15.13" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;"><span id="S5.T2.3.1.15.15.13.1" class="ltx_text ltx_font_bold">36.80</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>P-FL accuracy (<math id="S5.T2.2.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S5.T2.2.m1.1b"><mo id="S5.T2.2.m1.1.1" xref="S5.T2.2.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.m1.1c"><csymbol cd="latexml" id="S5.T2.2.m1.1.1.cmml" xref="S5.T2.2.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.m1.1d">\%</annotation></semantics></math>) of the local model. We bold the best result.</figcaption>
</figure>
<figure id="S5.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S5.F4.sf1.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:203.8pt;">
<img src="/html/2307.14384/assets/figs/sensitivity/LocalEpochs_CIFAR10_GFL.png" id="S5.F4.sf1.1.g1" class="ltx_graphics ltx_img_landscape" width="489" height="250" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf1.3.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S5.F4.sf1.4.2" class="ltx_text" style="font-size:80%;">G-FL</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S5.F4.sf2.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:203.8pt;">
<img src="/html/2307.14384/assets/figs/sensitivity/LocalEpochs_CIFAR10_PFL.png" id="S5.F4.sf2.1.g1" class="ltx_graphics ltx_img_landscape" width="475" height="250" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf2.3.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S5.F4.sf2.4.2" class="ltx_text" style="font-size:80%;">P-FL</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Effect of local epochs <math id="S5.F4.3.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.F4.3.m1.1b"><mi id="S5.F4.3.m1.1.1" xref="S5.F4.3.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.F4.3.m1.1c"><ci id="S5.F4.3.m1.1.1.cmml" xref="S5.F4.3.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.3.m1.1d">E</annotation></semantics></math> on Cifar10 (<math id="S5.F4.4.m2.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S5.F4.4.m2.1b"><mrow id="S5.F4.4.m2.1.1" xref="S5.F4.4.m2.1.1.cmml"><mi id="S5.F4.4.m2.1.1.2" xref="S5.F4.4.m2.1.1.2.cmml">α</mi><mo id="S5.F4.4.m2.1.1.1" xref="S5.F4.4.m2.1.1.1.cmml">=</mo><mn id="S5.F4.4.m2.1.1.3" xref="S5.F4.4.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F4.4.m2.1c"><apply id="S5.F4.4.m2.1.1.cmml" xref="S5.F4.4.m2.1.1"><eq id="S5.F4.4.m2.1.1.1.cmml" xref="S5.F4.4.m2.1.1.1"></eq><ci id="S5.F4.4.m2.1.1.2.cmml" xref="S5.F4.4.m2.1.1.2">𝛼</ci><cn type="float" id="S5.F4.4.m2.1.1.3.cmml" xref="S5.F4.4.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.4.m2.1d">\alpha=0.5</annotation></semantics></math>).</figcaption>
</figure>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S5.F5.sf1.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:203.8pt;">
<img src="/html/2307.14384/assets/figs/sensitivity/slopedegree_CIFAR10FMNIST_GFL.png" id="S5.F5.sf1.1.g1" class="ltx_graphics ltx_img_landscape" width="475" height="250" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.sf1.3.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S5.F5.sf1.4.2" class="ltx_text" style="font-size:80%;">G-FL</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S5.F5.sf2.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:203.8pt;">
<img src="/html/2307.14384/assets/figs/sensitivity/slopedegree_CIFAR10FMNIST_PFL.png" id="S5.F5.sf2.1.g1" class="ltx_graphics ltx_img_landscape" width="475" height="250" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.sf2.3.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S5.F5.sf2.4.2" class="ltx_text" style="font-size:80%;">P-FL</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Effect of slope degree <math id="S5.F5.4.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S5.F5.4.m1.1b"><mi id="S5.F5.4.m1.1.1" xref="S5.F5.4.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S5.F5.4.m1.1c"><ci id="S5.F5.4.m1.1.1.cmml" xref="S5.F5.4.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.4.m1.1d">s</annotation></semantics></math> on FMNIST <math id="S5.F5.5.m2.1" class="ltx_Math" alttext="\&amp;" display="inline"><semantics id="S5.F5.5.m2.1b"><mo id="S5.F5.5.m2.1.1" xref="S5.F5.5.m2.1.1.cmml">&amp;</mo><annotation-xml encoding="MathML-Content" id="S5.F5.5.m2.1c"><and id="S5.F5.5.m2.1.1.cmml" xref="S5.F5.5.m2.1.1"></and></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.5.m2.1d">\&amp;</annotation></semantics></math> Cifar10 (<math id="S5.F5.6.m3.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S5.F5.6.m3.1b"><mrow id="S5.F5.6.m3.1.1" xref="S5.F5.6.m3.1.1.cmml"><mi id="S5.F5.6.m3.1.1.2" xref="S5.F5.6.m3.1.1.2.cmml">α</mi><mo id="S5.F5.6.m3.1.1.1" xref="S5.F5.6.m3.1.1.1.cmml">=</mo><mn id="S5.F5.6.m3.1.1.3" xref="S5.F5.6.m3.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F5.6.m3.1c"><apply id="S5.F5.6.m3.1.1.cmml" xref="S5.F5.6.m3.1.1"><eq id="S5.F5.6.m3.1.1.1.cmml" xref="S5.F5.6.m3.1.1.1"></eq><ci id="S5.F5.6.m3.1.1.2.cmml" xref="S5.F5.6.m3.1.1.2">𝛼</ci><cn type="float" id="S5.F5.6.m3.1.1.3.cmml" xref="S5.F5.6.m3.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.6.m3.1d">\alpha=0.5</annotation></semantics></math>)</figcaption>
</figure>
<figure id="S5.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S5.F6.sf1.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:203.8pt;">
<img src="/html/2307.14384/assets/figs/sensitivity/margin_CIFAR10FMNIST_GFL.png" id="S5.F6.sf1.1.g1" class="ltx_graphics ltx_img_landscape" width="475" height="250" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.sf1.3.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S5.F6.sf1.4.2" class="ltx_text" style="font-size:80%;">G-FL</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S5.F6.sf2.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:203.8pt;">
<img src="/html/2307.14384/assets/figs/sensitivity/margin_CIFAR10FMNIST_PFL.png" id="S5.F6.sf2.1.g1" class="ltx_graphics ltx_img_landscape" width="489" height="250" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.sf2.3.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S5.F6.sf2.4.2" class="ltx_text" style="font-size:80%;">P-FL</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Effect of margin <math id="S5.F6.4.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.F6.4.m1.1b"><mi id="S5.F6.4.m1.1.1" xref="S5.F6.4.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.F6.4.m1.1c"><ci id="S5.F6.4.m1.1.1.cmml" xref="S5.F6.4.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.4.m1.1d">m</annotation></semantics></math> on FMNIST <math id="S5.F6.5.m2.1" class="ltx_Math" alttext="\&amp;" display="inline"><semantics id="S5.F6.5.m2.1b"><mo id="S5.F6.5.m2.1.1" xref="S5.F6.5.m2.1.1.cmml">&amp;</mo><annotation-xml encoding="MathML-Content" id="S5.F6.5.m2.1c"><and id="S5.F6.5.m2.1.1.cmml" xref="S5.F6.5.m2.1.1"></and></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.5.m2.1d">\&amp;</annotation></semantics></math> Cifar10 (<math id="S5.F6.6.m3.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S5.F6.6.m3.1b"><mrow id="S5.F6.6.m3.1.1" xref="S5.F6.6.m3.1.1.cmml"><mi id="S5.F6.6.m3.1.1.2" xref="S5.F6.6.m3.1.1.2.cmml">α</mi><mo id="S5.F6.6.m3.1.1.1" xref="S5.F6.6.m3.1.1.1.cmml">=</mo><mn id="S5.F6.6.m3.1.1.3" xref="S5.F6.6.m3.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.6.m3.1c"><apply id="S5.F6.6.m3.1.1.cmml" xref="S5.F6.6.m3.1.1"><eq id="S5.F6.6.m3.1.1.1.cmml" xref="S5.F6.6.m3.1.1.1"></eq><ci id="S5.F6.6.m3.1.1.2.cmml" xref="S5.F6.6.m3.1.1.2">𝛼</ci><cn type="float" id="S5.F6.6.m3.1.1.3.cmml" xref="S5.F6.6.m3.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.6.m3.1d">\alpha=0.5</annotation></semantics></math>).</figcaption>
</figure>
<figure id="S5.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S5.F7.sf1.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:203.8pt;">
<img src="/html/2307.14384/assets/figs/sensitivity/ClientNumber_FMNIST_GFL.png" id="S5.F7.sf1.1.g1" class="ltx_graphics ltx_img_landscape" width="490" height="250" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.sf1.3.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S5.F7.sf1.4.2" class="ltx_text" style="font-size:80%;">G-FL</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S5.F7.sf2.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:203.8pt;">
<img src="/html/2307.14384/assets/figs/sensitivity/ClientNumber_FMNIST_PFL.png" id="S5.F7.sf2.1.g1" class="ltx_graphics ltx_img_landscape" width="490" height="250" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.sf2.3.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S5.F7.sf2.4.2" class="ltx_text" style="font-size:80%;">P-FL</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Effect of clients number <math id="S5.F7.3.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.F7.3.m1.1b"><mi id="S5.F7.3.m1.1.1" xref="S5.F7.3.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.F7.3.m1.1c"><ci id="S5.F7.3.m1.1.1.cmml" xref="S5.F7.3.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.3.m1.1d">K</annotation></semantics></math> on FMNIST (<math id="S5.F7.4.m2.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S5.F7.4.m2.1b"><mrow id="S5.F7.4.m2.1.1" xref="S5.F7.4.m2.1.1.cmml"><mi id="S5.F7.4.m2.1.1.2" xref="S5.F7.4.m2.1.1.2.cmml">α</mi><mo id="S5.F7.4.m2.1.1.1" xref="S5.F7.4.m2.1.1.1.cmml">=</mo><mn id="S5.F7.4.m2.1.1.3" xref="S5.F7.4.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F7.4.m2.1c"><apply id="S5.F7.4.m2.1.1.cmml" xref="S5.F7.4.m2.1.1"><eq id="S5.F7.4.m2.1.1.1.cmml" xref="S5.F7.4.m2.1.1.1"></eq><ci id="S5.F7.4.m2.1.1.2.cmml" xref="S5.F7.4.m2.1.1.2">𝛼</ci><cn type="float" id="S5.F7.4.m2.1.1.3.cmml" xref="S5.F7.4.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.4.m2.1d">\alpha=0.5</annotation></semantics></math>). </figcaption>
</figure>
<figure id="S5.T3" class="ltx_table">
<div id="S5.T3.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:115.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(48.0pt,-12.8pt) scale(1.28421635639041,1.28421635639041) ;">
<table id="S5.T3.2.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.2.2.3.1" class="ltx_tr">
<th id="S5.T3.2.2.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Dataset</th>
<th id="S5.T3.2.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Goal</th>
<th id="S5.T3.2.2.3.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">2</th>
<th id="S5.T3.2.2.3.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">5</th>
<th id="S5.T3.2.2.3.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">10</th>
<th id="S5.T3.2.2.3.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">20</th>
<th id="S5.T3.2.2.3.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">25</th>
<th id="S5.T3.2.2.3.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">50</th>
<th id="S5.T3.2.2.3.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.2.2.4.1" class="ltx_tr">
<td id="S5.T3.2.2.4.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">FMNIST</td>
<td id="S5.T3.2.2.4.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">P-FL</td>
<td id="S5.T3.2.2.4.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">88.91</td>
<td id="S5.T3.2.2.4.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.20</td>
<td id="S5.T3.2.2.4.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.84</td>
<td id="S5.T3.2.2.4.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.98</td>
<td id="S5.T3.2.2.4.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.70</td>
<td id="S5.T3.2.2.4.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.73</td>
<td id="S5.T3.2.2.4.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">93.66</td>
</tr>
<tr id="S5.T3.1.1.1" class="ltx_tr">
<td id="S5.T3.1.1.1.1" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">(<math id="S5.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T3.1.1.1.1.m1.1a"><mi id="S5.T3.1.1.1.1.m1.1.1" xref="S5.T3.1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.1.m1.1c">\alpha</annotation></semantics></math>=0.5)</td>
<td id="S5.T3.1.1.1.2" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">G-FL</td>
<td id="S5.T3.1.1.1.3" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">88.59</td>
<td id="S5.T3.1.1.1.4" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.07</td>
<td id="S5.T3.1.1.1.5" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.91</td>
<td id="S5.T3.1.1.1.6" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">91.16</td>
<td id="S5.T3.1.1.1.7" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.74</td>
<td id="S5.T3.1.1.1.8" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.74</td>
<td id="S5.T3.1.1.1.9" class="ltx_td ltx_align_center" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">90.74</td>
</tr>
<tr id="S5.T3.2.2.5.2" class="ltx_tr">
<td id="S5.T3.2.2.5.2.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">Cifar10</td>
<td id="S5.T3.2.2.5.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">P-FL</td>
<td id="S5.T3.2.2.5.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">72.82</td>
<td id="S5.T3.2.2.5.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">80.55</td>
<td id="S5.T3.2.2.5.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">82.83</td>
<td id="S5.T3.2.2.5.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">83.17</td>
<td id="S5.T3.2.2.5.2.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">82.50</td>
<td id="S5.T3.2.2.5.2.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">83.15</td>
<td id="S5.T3.2.2.5.2.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">82.76</td>
</tr>
<tr id="S5.T3.2.2.2" class="ltx_tr">
<td id="S5.T3.2.2.2.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">(<math id="S5.T3.2.2.2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T3.2.2.2.1.m1.1a"><mi id="S5.T3.2.2.2.1.m1.1.1" xref="S5.T3.2.2.2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.1.m1.1b"><ci id="S5.T3.2.2.2.1.m1.1.1.cmml" xref="S5.T3.2.2.2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.1.m1.1c">\alpha</annotation></semantics></math>=0.5)</td>
<td id="S5.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">G-FL</td>
<td id="S5.T3.2.2.2.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">60.87</td>
<td id="S5.T3.2.2.2.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">68.82</td>
<td id="S5.T3.2.2.2.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">69.84</td>
<td id="S5.T3.2.2.2.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">71.25</td>
<td id="S5.T3.2.2.2.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">70.67</td>
<td id="S5.T3.2.2.2.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">71.51</td>
<td id="S5.T3.2.2.2.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:-2.5pt;padding-bottom:-2.5pt;">71.69</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Effect of the representation dimension in <span id="S5.T3.4.1" class="ltx_text ltx_font_typewriter">HyperFed</span>.</figcaption>
</figure>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Empirical Results</h3>

<section id="S5.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Performance Comparison.</h4>

<div id="S5.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px1.p1.3" class="ltx_p">We run each method 5 times and report the performance of G-FL and P-FL in Tab. <a href="#S5.T1" title="Table 1 ‣ Implementation Details. ‣ 5.1 Experimental Setup ‣ 5 Experiments and Discussion ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-<a href="#S5.T2" title="Table 2 ‣ Implementation Details. ‣ 5.1 Experimental Setup ‣ 5 Experiments and Discussion ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> with the average value, respectively.
There are mainly three observations.
(1) <span id="S5.SS2.SSS0.Px1.p1.3.1" class="ltx_text ltx_font_bold">In terms of G-FL</span> evaluated in Tab. <a href="#S5.T1" title="Table 1 ‣ Implementation Details. ‣ 5.1 Experimental Setup ‣ 5 Experiments and Discussion ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, generally speaking, the performance of G-FL is increasing along with the increase of non-IID degree <math id="S5.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="S5.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.1.m1.1c">\alpha</annotation></semantics></math>.
It states that the heterogeneity of data distribution deteriorates the performance of FL methods.
FedAvg takes no measure to handle non-IID, which is worse than most methods.
Similarly, FedBABU is a variant of FedAvg that fixes the randomly initialized classifier, perform inferior as well.
It means that simply fixing the classifier initialized by random is not enough for FL with non-IID data.
(2) <span id="S5.SS2.SSS0.Px1.p1.3.2" class="ltx_text ltx_font_bold">In terms of P-FL</span> evaluated in Tab. <a href="#S5.T2" title="Table 2 ‣ Implementation Details. ‣ 5.1 Experimental Setup ‣ 5 Experiments and Discussion ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>,
the methods of the third category can achieve accuracy similar as the second category on FMNIST and EMNIST, but cannot maintain the personalization on Cifar100.
This indicates that simply fixing class statistics in FL is less promising than personalization strategies on complex dataset.
SphereFed is the runner-up of Cifar100 (<math id="S5.SS2.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\alpha=5" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.2.m2.1a"><mrow id="S5.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">α</mi><mo id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.1" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1"><eq id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.1"></eq><ci id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.2">𝛼</ci><cn type="integer" id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.2.m2.1c">\alpha=5</annotation></semantics></math>), but it fails to perform well on more heterogeous setting, i.e., Cifar100 (<math id="S5.SS2.SSS0.Px1.p1.3.m3.2" class="ltx_Math" alttext="\alpha=\{0.1,0.5\}" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.3.m3.2a"><mrow id="S5.SS2.SSS0.Px1.p1.3.m3.2.3" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.3.cmml"><mi id="S5.SS2.SSS0.Px1.p1.3.m3.2.3.2" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.3.2.cmml">α</mi><mo id="S5.SS2.SSS0.Px1.p1.3.m3.2.3.1" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.3.1.cmml">=</mo><mrow id="S5.SS2.SSS0.Px1.p1.3.m3.2.3.3.2" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px1.p1.3.m3.2.3.3.2.1" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.3.3.1.cmml">{</mo><mn id="S5.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">0.1</mn><mo id="S5.SS2.SSS0.Px1.p1.3.m3.2.3.3.2.2" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.3.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px1.p1.3.m3.2.2" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.2.cmml">0.5</mn><mo stretchy="false" id="S5.SS2.SSS0.Px1.p1.3.m3.2.3.3.2.3" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.3.m3.2b"><apply id="S5.SS2.SSS0.Px1.p1.3.m3.2.3.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.3"><eq id="S5.SS2.SSS0.Px1.p1.3.m3.2.3.1.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.3.1"></eq><ci id="S5.SS2.SSS0.Px1.p1.3.m3.2.3.2.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.3.2">𝛼</ci><set id="S5.SS2.SSS0.Px1.p1.3.m3.2.3.3.1.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.3.3.2"><cn type="float" id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1">0.1</cn><cn type="float" id="S5.SS2.SSS0.Px1.p1.3.m3.2.2.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.2.2">0.5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.3.m3.2c">\alpha=\{0.1,0.5\}</annotation></semantics></math>).
This phenomenon shows that <span id="S5.SS2.SSS0.Px1.p1.3.3" class="ltx_text ltx_font_typewriter">HyperFed</span> performs better for FL with non-IID data, as a FL method of the third category.
(3) <span id="S5.SS2.SSS0.Px1.p1.3.4" class="ltx_text ltx_font_bold">In terms of the performance of <span id="S5.SS2.SSS0.Px1.p1.3.4.1" class="ltx_text ltx_font_typewriter">HyperFed</span></span>, <span id="S5.SS2.SSS0.Px1.p1.3.5" class="ltx_text ltx_font_typewriter">HyperFed</span> achieves the best results in all kinds of non-IID degrees and different datasets, which verifies the efficacy of <span id="S5.SS2.SSS0.Px1.p1.3.6" class="ltx_text ltx_font_typewriter">HyperFed</span> for non-IID problems.
In the results of Cifar100,
<span id="S5.SS2.SSS0.Px1.p1.3.7" class="ltx_text ltx_font_typewriter">HyperFed</span> significantly outperforms all of the comparison algorithms listed both in G-FL and P-FL, in terms of at least 10.75% and 5.44%, respectively.
This shows that <span id="S5.SS2.SSS0.Px1.p1.3.8" class="ltx_text ltx_font_typewriter">HyperFed</span> can capture more fine-grained representation to improve performance, especially on large and complicated datasets with low dimensional representation.</p>
</div>
<div id="S5.SS2.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px1.p2.1" class="ltx_p"><span id="S5.SS2.SSS0.Px1.p2.1.1" class="ltx_text ltx_font_bold">Visualization. </span>
To verify the benefits of fixing class statistics in hyperbolic space, we utilize UMAP <cite class="ltx_cite ltx_citemacro_cite">McInnes <span class="ltx_text ltx_font_italic">et al.</span> (<a href="#bib.bib33" title="" class="ltx_ref">2018</a>)</cite> to visualize the G-FL hidden representations of the global model in <span id="S5.SS2.SSS0.Px1.p2.1.2" class="ltx_text ltx_font_typewriter">HyperFed</span>, the runner-up of G-FL,i.e., SphereFed, and P-FL, i.e., Ditto, and FedBABU on FMNIST (<math id="S5.SS2.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S5.SS2.SSS0.Px1.p2.1.m1.1a"><mrow id="S5.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S5.SS2.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S5.SS2.SSS0.Px1.p2.1.m1.1.1.2" xref="S5.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS2.SSS0.Px1.p2.1.m1.1.1.1" xref="S5.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px1.p2.1.m1.1.1.3" xref="S5.SS2.SSS0.Px1.p2.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p2.1.m1.1b"><apply id="S5.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p2.1.m1.1.1"><eq id="S5.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p2.1.m1.1.1.1"></eq><ci id="S5.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.SS2.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p2.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p2.1.m1.1c">\alpha=0.5</annotation></semantics></math>) in Fig. <a href="#S5.F3" title="Figure 3 ‣ Implementation Details. ‣ 5.1 Experimental Setup ‣ 5 Experiments and Discussion ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
we can find that: (1) Compared with Ditto, methods fixing the class statistics attain more gathered representations.
(2) Though FedBABU fixes the classifier, the randomly initialized classifier is limited in resolving class overlapping.
(3) Compared with SphereFed whose classifier is initialized with a set of orthogonal basis in hypersphere, <span id="S5.SS2.SSS0.Px1.p2.1.3" class="ltx_text ltx_font_typewriter">HyperFed</span> concentrates the hidden representation tighter due to sufficiently utilizing the hierarchical information.</p>
</div>
</section>
<section id="S5.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Ablation Studies.</h4>

<div id="S5.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px2.p1.1" class="ltx_p">We consider four variants of <span id="S5.SS2.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span>:
(1) <span id="S5.SS2.SSS0.Px2.p1.1.2" class="ltx_text ltx_font_typewriter">HyperFed</span> uses geodesic
as metric, i.e., <span id="S5.SS2.SSS0.Px2.p1.1.3" class="ltx_text ltx_font_typewriter">HyperFed</span>-<span id="S5.SS2.SSS0.Px2.p1.1.4" class="ltx_text ltx_font_typewriter">Geodesic</span>,
(2) <span id="S5.SS2.SSS0.Px2.p1.1.5" class="ltx_text ltx_font_typewriter">HyperFed</span> uses fixed class prototypes only, i.e., <span id="S5.SS2.SSS0.Px2.p1.1.6" class="ltx_text ltx_font_typewriter">HyperFed</span>-<span id="S5.SS2.SSS0.Px2.p1.1.7" class="ltx_text ltx_font_typewriter">fixed</span>, (3) <span id="S5.SS2.SSS0.Px2.p1.1.8" class="ltx_text ltx_font_typewriter">HyperFed</span> uses shared class prototypes only, i.e., <span id="S5.SS2.SSS0.Px2.p1.1.9" class="ltx_text ltx_font_typewriter">HyperFed</span>-<span id="S5.SS2.SSS0.Px2.p1.1.10" class="ltx_text ltx_font_typewriter">shared</span>, and (4) <span id="S5.SS2.SSS0.Px2.p1.1.11" class="ltx_text ltx_font_typewriter">HyperFed</span> uses weighted average aggregation by data amounts,
i.e., <span id="S5.SS2.SSS0.Px2.p1.1.12" class="ltx_text ltx_font_typewriter">HyperFed</span>-<span id="S5.SS2.SSS0.Px2.p1.1.13" class="ltx_text ltx_font_typewriter">Averaged</span>.
From Tab. <a href="#S5.T1" title="Table 1 ‣ Implementation Details. ‣ 5.1 Experimental Setup ‣ 5 Experiments and Discussion ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>-<a href="#S5.T2" title="Table 2 ‣ Implementation Details. ‣ 5.1 Experimental Setup ‣ 5 Experiments and Discussion ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we can discover that:
All of the variants decrease their performance compared with <span id="S5.SS2.SSS0.Px2.p1.1.14" class="ltx_text ltx_font_typewriter">HyperFed</span>.
These results identify that all of the components of <span id="S5.SS2.SSS0.Px2.p1.1.15" class="ltx_text ltx_font_typewriter">HyperFed</span>,
contribute to performance enhancement.</p>
</div>
<div id="S5.SS2.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px2.p2.7" class="ltx_p"><span id="S5.SS2.SSS0.Px2.p2.7.1" class="ltx_text ltx_font_bold">Hyper-parameters Sensitivity.</span>
To study the sensitivity of hyper-parameters, we compare the performance of FMNIST and Cifar10 by varying the local epochs <math id="S5.SS2.SSS0.Px2.p2.1.m1.4" class="ltx_Math" alttext="E=\{5,10,20,50\}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p2.1.m1.4a"><mrow id="S5.SS2.SSS0.Px2.p2.1.m1.4.5" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5.cmml"><mi id="S5.SS2.SSS0.Px2.p2.1.m1.4.5.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5.2.cmml">E</mi><mo id="S5.SS2.SSS0.Px2.p2.1.m1.4.5.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5.1.cmml">=</mo><mrow id="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.2.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.1.cmml">{</mo><mn id="S5.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1.cmml">5</mn><mo id="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.2.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.1.m1.2.2" xref="S5.SS2.SSS0.Px2.p2.1.m1.2.2.cmml">10</mn><mo id="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.2.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.1.m1.3.3" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3.cmml">20</mn><mo id="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.2.4" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.1.m1.4.4" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.4.cmml">50</mn><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.2.5" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p2.1.m1.4b"><apply id="S5.SS2.SSS0.Px2.p2.1.m1.4.5.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5"><eq id="S5.SS2.SSS0.Px2.p2.1.m1.4.5.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5.1"></eq><ci id="S5.SS2.SSS0.Px2.p2.1.m1.4.5.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5.2">𝐸</ci><set id="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.5.3.2"><cn type="integer" id="S5.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.1.1">5</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.1.m1.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.2.2">10</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.1.m1.3.3.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.3.3">20</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.1.m1.4.4.cmml" xref="S5.SS2.SSS0.Px2.p2.1.m1.4.4">50</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p2.1.m1.4c">E=\{5,10,20,50\}</annotation></semantics></math> in Fig. <a href="#S5.F4" title="Figure 4 ‣ Implementation Details. ‣ 5.1 Experimental Setup ‣ 5 Experiments and Discussion ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, slope degree <math id="S5.SS2.SSS0.Px2.p2.2.m2.6" class="ltx_Math" alttext="s=\{0.2,0.5,0.8,0.9,0.95,1\}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p2.2.m2.6a"><mrow id="S5.SS2.SSS0.Px2.p2.2.m2.6.7" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.cmml"><mi id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.2" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.2.cmml">s</mi><mo id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.1" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.1.cmml">=</mo><mrow id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.2" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.2.1" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.1.cmml">{</mo><mn id="S5.SS2.SSS0.Px2.p2.2.m2.1.1" xref="S5.SS2.SSS0.Px2.p2.2.m2.1.1.cmml">0.2</mn><mo id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.2.2" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.2.m2.2.2" xref="S5.SS2.SSS0.Px2.p2.2.m2.2.2.cmml">0.5</mn><mo id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.2.3" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.2.m2.3.3" xref="S5.SS2.SSS0.Px2.p2.2.m2.3.3.cmml">0.8</mn><mo id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.2.4" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.2.m2.4.4" xref="S5.SS2.SSS0.Px2.p2.2.m2.4.4.cmml">0.9</mn><mo id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.2.5" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.2.m2.5.5" xref="S5.SS2.SSS0.Px2.p2.2.m2.5.5.cmml">0.95</mn><mo id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.2.6" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.2.m2.6.6" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.6.cmml">1</mn><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.2.7" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p2.2.m2.6b"><apply id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.cmml" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7"><eq id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.1.cmml" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.1"></eq><ci id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.2.cmml" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.2">𝑠</ci><set id="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.7.3.2"><cn type="float" id="S5.SS2.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.2.m2.1.1">0.2</cn><cn type="float" id="S5.SS2.SSS0.Px2.p2.2.m2.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.2.m2.2.2">0.5</cn><cn type="float" id="S5.SS2.SSS0.Px2.p2.2.m2.3.3.cmml" xref="S5.SS2.SSS0.Px2.p2.2.m2.3.3">0.8</cn><cn type="float" id="S5.SS2.SSS0.Px2.p2.2.m2.4.4.cmml" xref="S5.SS2.SSS0.Px2.p2.2.m2.4.4">0.9</cn><cn type="float" id="S5.SS2.SSS0.Px2.p2.2.m2.5.5.cmml" xref="S5.SS2.SSS0.Px2.p2.2.m2.5.5">0.95</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.2.m2.6.6.cmml" xref="S5.SS2.SSS0.Px2.p2.2.m2.6.6">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p2.2.m2.6c">s=\{0.2,0.5,0.8,0.9,0.95,1\}</annotation></semantics></math> in Fig. <a href="#S5.F5" title="Figure 5 ‣ Implementation Details. ‣ 5.1 Experimental Setup ‣ 5 Experiments and Discussion ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, margin <math id="S5.SS2.SSS0.Px2.p2.3.m3.9" class="ltx_Math" alttext="m=\{1,1.5,2,2.5,3,3.5,4,4.5,5\}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p2.3.m3.9a"><mrow id="S5.SS2.SSS0.Px2.p2.3.m3.9.10" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.cmml"><mi id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.2.cmml">m</mi><mo id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.1" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.1.cmml">=</mo><mrow id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.2.1" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.1.cmml">{</mo><mn id="S5.SS2.SSS0.Px2.p2.3.m3.1.1" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1.cmml">1</mn><mo id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.2.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.3.m3.2.2" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.2.cmml">1.5</mn><mo id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.2.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.3.m3.3.3" xref="S5.SS2.SSS0.Px2.p2.3.m3.3.3.cmml">2</mn><mo id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.2.4" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.3.m3.4.4" xref="S5.SS2.SSS0.Px2.p2.3.m3.4.4.cmml">2.5</mn><mo id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.2.5" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.3.m3.5.5" xref="S5.SS2.SSS0.Px2.p2.3.m3.5.5.cmml">3</mn><mo id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.2.6" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.3.m3.6.6" xref="S5.SS2.SSS0.Px2.p2.3.m3.6.6.cmml">3.5</mn><mo id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.2.7" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.3.m3.7.7" xref="S5.SS2.SSS0.Px2.p2.3.m3.7.7.cmml">4</mn><mo id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.2.8" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.3.m3.8.8" xref="S5.SS2.SSS0.Px2.p2.3.m3.8.8.cmml">4.5</mn><mo id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.2.9" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.3.m3.9.9" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.9.cmml">5</mn><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.2.10" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p2.3.m3.9b"><apply id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10"><eq id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.1"></eq><ci id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.2">𝑚</ci><set id="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.10.3.2"><cn type="integer" id="S5.SS2.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.1.1">1</cn><cn type="float" id="S5.SS2.SSS0.Px2.p2.3.m3.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.2.2">1.5</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.3.m3.3.3.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.3.3">2</cn><cn type="float" id="S5.SS2.SSS0.Px2.p2.3.m3.4.4.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.4.4">2.5</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.3.m3.5.5.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.5.5">3</cn><cn type="float" id="S5.SS2.SSS0.Px2.p2.3.m3.6.6.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.6.6">3.5</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.3.m3.7.7.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.7.7">4</cn><cn type="float" id="S5.SS2.SSS0.Px2.p2.3.m3.8.8.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.8.8">4.5</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.3.m3.9.9.cmml" xref="S5.SS2.SSS0.Px2.p2.3.m3.9.9">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p2.3.m3.9c">m=\{1,1.5,2,2.5,3,3.5,4,4.5,5\}</annotation></semantics></math> in Fig. <a href="#S5.F6" title="Figure 6 ‣ Implementation Details. ‣ 5.1 Experimental Setup ‣ 5 Experiments and Discussion ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, number of clients <math id="S5.SS2.SSS0.Px2.p2.4.m4.5" class="ltx_Math" alttext="K=\{5,10,20,50,100\}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p2.4.m4.5a"><mrow id="S5.SS2.SSS0.Px2.p2.4.m4.5.6" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.cmml"><mi id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.2" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.2.cmml">K</mi><mo id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.1" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.1.cmml">=</mo><mrow id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.2" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.2.1" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.1.cmml">{</mo><mn id="S5.SS2.SSS0.Px2.p2.4.m4.1.1" xref="S5.SS2.SSS0.Px2.p2.4.m4.1.1.cmml">5</mn><mo id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.2.2" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.4.m4.2.2" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.2.cmml">10</mn><mo id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.2.3" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.4.m4.3.3" xref="S5.SS2.SSS0.Px2.p2.4.m4.3.3.cmml">20</mn><mo id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.2.4" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.4.m4.4.4" xref="S5.SS2.SSS0.Px2.p2.4.m4.4.4.cmml">50</mn><mo id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.2.5" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.4.m4.5.5" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.5.cmml">100</mn><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.2.6" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p2.4.m4.5b"><apply id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6"><eq id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.1.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.1"></eq><ci id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.2.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.2">𝐾</ci><set id="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.6.3.2"><cn type="integer" id="S5.SS2.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.1.1">5</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.4.m4.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.2.2">10</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.4.m4.3.3.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.3.3">20</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.4.m4.4.4.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.4.4">50</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.4.m4.5.5.cmml" xref="S5.SS2.SSS0.Px2.p2.4.m4.5.5">100</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p2.4.m4.5c">K=\{5,10,20,50,100\}</annotation></semantics></math> in Fig. <a href="#S5.F7" title="Figure 7 ‣ Implementation Details. ‣ 5.1 Experimental Setup ‣ 5 Experiments and Discussion ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, and the dimension of features representation <math id="S5.SS2.SSS0.Px2.p2.5.m5.7" class="ltx_Math" alttext="d=\{2,5,10,20,25,50,100\}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p2.5.m5.7a"><mrow id="S5.SS2.SSS0.Px2.p2.5.m5.7.8" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.cmml"><mi id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.2" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.2.cmml">d</mi><mo id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.1" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.1.cmml">=</mo><mrow id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.2" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.2.1" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.1.cmml">{</mo><mn id="S5.SS2.SSS0.Px2.p2.5.m5.1.1" xref="S5.SS2.SSS0.Px2.p2.5.m5.1.1.cmml">2</mn><mo id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.2.2" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.5.m5.2.2" xref="S5.SS2.SSS0.Px2.p2.5.m5.2.2.cmml">5</mn><mo id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.2.3" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.5.m5.3.3" xref="S5.SS2.SSS0.Px2.p2.5.m5.3.3.cmml">10</mn><mo id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.2.4" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.5.m5.4.4" xref="S5.SS2.SSS0.Px2.p2.5.m5.4.4.cmml">20</mn><mo id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.2.5" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.5.m5.5.5" xref="S5.SS2.SSS0.Px2.p2.5.m5.5.5.cmml">25</mn><mo id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.2.6" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.5.m5.6.6" xref="S5.SS2.SSS0.Px2.p2.5.m5.6.6.cmml">50</mn><mo id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.2.7" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p2.5.m5.7.7" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.7.cmml">100</mn><mo stretchy="false" id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.2.8" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p2.5.m5.7b"><apply id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.cmml" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8"><eq id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.1.cmml" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.1"></eq><ci id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.2.cmml" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.2">𝑑</ci><set id="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.1.cmml" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.8.3.2"><cn type="integer" id="S5.SS2.SSS0.Px2.p2.5.m5.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.5.m5.1.1">2</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.5.m5.2.2.cmml" xref="S5.SS2.SSS0.Px2.p2.5.m5.2.2">5</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.5.m5.3.3.cmml" xref="S5.SS2.SSS0.Px2.p2.5.m5.3.3">10</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.5.m5.4.4.cmml" xref="S5.SS2.SSS0.Px2.p2.5.m5.4.4">20</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.5.m5.5.5.cmml" xref="S5.SS2.SSS0.Px2.p2.5.m5.5.5">25</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.5.m5.6.6.cmml" xref="S5.SS2.SSS0.Px2.p2.5.m5.6.6">50</cn><cn type="integer" id="S5.SS2.SSS0.Px2.p2.5.m5.7.7.cmml" xref="S5.SS2.SSS0.Px2.p2.5.m5.7.7">100</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p2.5.m5.7c">d=\{2,5,10,20,25,50,100\}</annotation></semantics></math> in Tab. <a href="#S5.T3" title="Table 3 ‣ Implementation Details. ‣ 5.1 Experimental Setup ‣ 5 Experiments and Discussion ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, respectively.
We can conclude that:
(1) The increase of local epochs per communication round decreases the performance of FL methods.
(2) <span id="S5.SS2.SSS0.Px2.p2.7.2" class="ltx_text ltx_font_typewriter">HyperFed</span> nearly converges when <math id="S5.SS2.SSS0.Px2.p2.6.m6.1" class="ltx_Math" alttext="s=0.9" display="inline"><semantics id="S5.SS2.SSS0.Px2.p2.6.m6.1a"><mrow id="S5.SS2.SSS0.Px2.p2.6.m6.1.1" xref="S5.SS2.SSS0.Px2.p2.6.m6.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p2.6.m6.1.1.2" xref="S5.SS2.SSS0.Px2.p2.6.m6.1.1.2.cmml">s</mi><mo id="S5.SS2.SSS0.Px2.p2.6.m6.1.1.1" xref="S5.SS2.SSS0.Px2.p2.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px2.p2.6.m6.1.1.3" xref="S5.SS2.SSS0.Px2.p2.6.m6.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p2.6.m6.1b"><apply id="S5.SS2.SSS0.Px2.p2.6.m6.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.6.m6.1.1"><eq id="S5.SS2.SSS0.Px2.p2.6.m6.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.6.m6.1.1.1"></eq><ci id="S5.SS2.SSS0.Px2.p2.6.m6.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p2.6.m6.1.1.2">𝑠</ci><cn type="float" id="S5.SS2.SSS0.Px2.p2.6.m6.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p2.6.m6.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p2.6.m6.1c">s=0.9</annotation></semantics></math>, which indicates that positioning the class prototypes in 90% of radius achieves a balance between the best model performance and the most general class information.
(3) The performance of <span id="S5.SS2.SSS0.Px2.p2.7.3" class="ltx_text ltx_font_typewriter">HyperFed</span> varying by <math id="S5.SS2.SSS0.Px2.p2.7.m7.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS2.SSS0.Px2.p2.7.m7.1a"><mi id="S5.SS2.SSS0.Px2.p2.7.m7.1.1" xref="S5.SS2.SSS0.Px2.p2.7.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p2.7.m7.1b"><ci id="S5.SS2.SSS0.Px2.p2.7.m7.1.1.cmml" xref="S5.SS2.SSS0.Px2.p2.7.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p2.7.m7.1c">m</annotation></semantics></math> forms a slight bell curve.
(4) <span id="S5.SS2.SSS0.Px2.p2.7.4" class="ltx_text ltx_font_typewriter">HyperFed</span> outperforms the runner-up methods in all cases of different number of clients.
(5) The dimension changes slightly affect the performance of <span id="S5.SS2.SSS0.Px2.p2.7.5" class="ltx_text ltx_font_typewriter">HyperFed</span>, proving that <span id="S5.SS2.SSS0.Px2.p2.7.6" class="ltx_text ltx_font_typewriter">HyperFed</span> is proficient in low-dimensional representation.</p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">To enhance federated learning (FL) with non-IID data, we propose <span id="S6.p1.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span> which contains hyperbolic prototype Tammes initialization (HPTI) module, hyperbolic prototype learning (HPL) module, and consistent aggregation (CA) module.
Firstly, HPTI constructs uniformly distributed and fixed class prototypes on server, and
shares them with clients to guide consistent feature representation for local clients.
secondly, HPL models client data in the hyperbolic model space with the supervision of shared class prototypes.
Additionally, CA mitigates the impact of inconsistent deviations from clients to server.
Extensive studies on four datasets prove the effectiveness of <span id="S6.p1.1.2" class="ltx_text ltx_font_typewriter">HyperFed</span>.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work was supported in part by the “Pioneer” and “Leading Goose” R&amp;D Program of Zhejiang (No.2022C01126), and Leading Expert of “Ten Thousands Talent Program” of Zhejiang Province (No.2021R52001).</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Acar <span id="bib.bib1.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Durmus Alp Emre Acar, Yue Zhao, Ramon Matas, Matthew Mattina, Paul Whatmough,
and Venkatesh Saligrama.

</span>
<span class="ltx_bibblock">Federated learning based on dynamic regularization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.3.1" class="ltx_text ltx_font_italic">ICLR</span>, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan <span id="bib.bib2.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Manoj Ghuhan Arivazhagan, Vinay Aggarwal, Aaditya Kumar Singh, and Sunav
Choudhary.

</span>
<span class="ltx_bibblock">Federated learning with personalization layers.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1912.00818</span>, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonnabel [2013]</span>
<span class="ltx_bibblock">
Silvere Bonnabel.

</span>
<span class="ltx_bibblock">Stochastic gradient descent on riemannian manifolds.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Automatic Control</span>, 58(9):2217–2229, 2013.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen and Chao [2021]</span>
<span class="ltx_bibblock">
Hong-You Chen and Wei-Lun Chao.

</span>
<span class="ltx_bibblock">On bridging generic and personalized federated learning for image
classification.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen <span id="bib.bib5.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022a]</span>
<span class="ltx_bibblock">
Chaochao Chen, Jun Zhou, Longfei Zheng, Huiwen Wu, Lingjuan Lyu, Jia Wu,
Bingzhe Wu, Ziqi Liu, Li Wang, and Xiaolin Zheng.

</span>
<span class="ltx_bibblock">Vertically federated graph neural network for privacy-preserving node
classification.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.3.1" class="ltx_text ltx_font_italic">IJCAI</span>, pages 1959–1965. ijcai.org, 2022.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen <span id="bib.bib6.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022b]</span>
<span class="ltx_bibblock">
Weize Chen, Xu Han, Yankai Lin, Hexu Zhao, Zhiyuan Liu, Peng Li, Maosong Sun,
and Jie Zhou.

</span>
<span class="ltx_bibblock">Fully hyperbolic neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.3.1" class="ltx_text ltx_font_italic">Proceedings of the 60th Annual Meeting of the Association for
Computational Linguistics</span>, pages 5672–5686, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cho <span id="bib.bib7.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Hyunghoon Cho, Benjamin DeMeo, Jian Peng, and Bonnie Berger.

</span>
<span class="ltx_bibblock">Large-margin classification in hyperbolic space.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.3.1" class="ltx_text ltx_font_italic">PMLR</span>, pages 1832–1840. PMLR, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohen <span id="bib.bib8.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Gregory Cohen, Saeed Afshar, Jonathan Tapson, and Andre Van Schaik.

</span>
<span class="ltx_bibblock">Emnist: Extending mnist to handwritten letters.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.3.1" class="ltx_text ltx_font_italic">IJCNN</span>, pages 2921–2926. IEEE, 2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Désidéri [2012]</span>
<span class="ltx_bibblock">
Jean-Antoine Désidéri.

</span>
<span class="ltx_bibblock">Multiple-gradient descent algorithm (mgda) for multiobjective
optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Comptes Rendus Mathematique</span>, 350(5-6):313–318, 2012.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong <span id="bib.bib10.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Xin Dong, Sai Qian Zhang, Ang Li, and HT Kung.

</span>
<span class="ltx_bibblock">Spherefed: Hyperspherical federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.3.1" class="ltx_text ltx_font_italic">ECCV</span>, pages 165–184. Springer, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ermolov <span id="bib.bib11.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Aleksandr Ermolov, Leyla Mirvakhabova, Valentin Khrulkov, Nicu Sebe, and Ivan
Oseledets.

</span>
<span class="ltx_bibblock">Hyperbolic vision transformers: Combining improvements in metric
learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.3.1" class="ltx_text ltx_font_italic">CVPR</span>, pages 7409–7419, 2022.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fallah <span id="bib.bib12.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.

</span>
<span class="ltx_bibblock">Personalized federated learning with theoretical guarantees: A
model-agnostic meta-learning approach.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 33:3557–3568, 2020.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ganea <span id="bib.bib13.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Octavian Ganea, Gary Bécigneul, and Thomas Hofmann.

</span>
<span class="ltx_bibblock">Hyperbolic entailment cones for learning hierarchical embeddings.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.3.1" class="ltx_text ltx_font_italic">ICML</span>, pages 1646–1655. PMLR, 2018.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghadimi Atigh <span id="bib.bib14.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Mina Ghadimi Atigh, Martin Keller-Ressel, and Pascal Mettes.

</span>
<span class="ltx_bibblock">Hyperbolic busemann learning with ideal prototypes.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 34:103–115, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He <span id="bib.bib15.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2016]</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.3.1" class="ltx_text ltx_font_italic">CVPR</span>, pages 770–778, 2016.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu <span id="bib.bib16.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for
federated visual classification.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1909.06335</span>, 2019.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jaggi [2013]</span>
<span class="ltx_bibblock">
Martin Jaggi.

</span>
<span class="ltx_bibblock">Revisiting frank-wolfe: Projection-free sparse convex optimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">ICML</span>, pages 427–435. PMLR, 2013.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy <span id="bib.bib18.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank J Reddi,
Sebastian U Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for on-device federated
learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.3.1" class="ltx_text ltx_font_italic">ICML</span>. PMLR, 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khrulkov <span id="bib.bib19.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Valentin Khrulkov, Leyla Mirvakhabova, Evgeniya Ustinova, Ivan Oseledets, and
Victor Lempitsky.

</span>
<span class="ltx_bibblock">Hyperbolic image embeddings.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.3.1" class="ltx_text ltx_font_italic">CVPR</span>, pages 6418–6428, 2020.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky <span id="bib.bib20.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2009]</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Geoffrey Hinton, et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic">Technical Report, University of Toronto</span>, 2009.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun <span id="bib.bib21.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [1998]</span>
<span class="ltx_bibblock">
Yann LeCun, Léon Bottou, Yoshua Bengio, and Patrick Haffner.

</span>
<span class="ltx_bibblock">Gradient-based learning applied to document recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE</span>, 86(11):2278–2324, 1998.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib22.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Xiang Li, Kaixuan Huang, Wenhao Yang, Shusen Wang, and Zhihua Zhang.

</span>
<span class="ltx_bibblock">On the convergence of fedavg on non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1907.02189</span>, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib23.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic">Proceedings of Machine Learning and Systems</span>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib24.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021a]</span>
<span class="ltx_bibblock">
Qinbin Li, Bingsheng He, and Dawn Song.

</span>
<span class="ltx_bibblock">Model-contrastive federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.3.1" class="ltx_text ltx_font_italic">CVPR</span>, pages 10713–10722, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li <span id="bib.bib25.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021b]</span>
<span class="ltx_bibblock">
Tian Li, Shengyuan Hu, Ahmad Beirami, and Virginia Smith.

</span>
<span class="ltx_bibblock">Ditto: Fair and robust federated learning through personalization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.3.1" class="ltx_text ltx_font_italic">ICML</span>, pages 6357–6368. PMLR, 2021.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Linial <span id="bib.bib26.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [1995]</span>
<span class="ltx_bibblock">
Nathan Linial, Eran London, and Yuri Rabinovich.

</span>
<span class="ltx_bibblock">The geometry of graphs and some of its algorithmic applications.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic">Combinatorica</span>, 15(2):215–245, 1995.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib27.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Qi Liu, Maximilian Nickel, and Douwe Kiela.

</span>
<span class="ltx_bibblock">Hyperbolic graph neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 32, 2019.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib28.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Shaoteng Liu, Jingjing Chen, Liangming Pan, Chong-Wah Ngo, Tat-Seng Chua, and
Yu-Gang Jiang.

</span>
<span class="ltx_bibblock">Hyperbolic visual embedding learning for zero-shot recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.3.1" class="ltx_text ltx_font_italic">CVPR</span>, pages 9273–9281, 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib29.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Weiming Liu, Jiajie Su, Chaochao Chen, and Xiaolin Zheng.

</span>
<span class="ltx_bibblock">Leveraging distribution alignment via stein path for cross-domain
cold-start recommendation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib29.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, pages 19223–19234, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu <span id="bib.bib30.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2023]</span>
<span class="ltx_bibblock">
Weiming Liu, Xiaolin Zheng, Chaochao Chen, Jiajie Su, Xinting Liao, Mengling
Hu, and Yanchao Tan.

</span>
<span class="ltx_bibblock">Joint internal multi-interest exploration and external domain
alignment for cross domain sequential recommendation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib30.3.1" class="ltx_text ltx_font_italic">WWW</span>, page 383–394, New York, NY, USA, 2023. Association
for Computing Machinery.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo and Wu [2021]</span>
<span class="ltx_bibblock">
Jun Luo and Shandong Wu.

</span>
<span class="ltx_bibblock">Adapt to adaptation: Learning personalization for cross-silo
federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2110.08394</span>, 2021.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo <span id="bib.bib32.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022]</span>
<span class="ltx_bibblock">
Zhengquan Luo, Yunlong Wang, Zilei Wang, Zhenan Sun, and Tieniu Tan.

</span>
<span class="ltx_bibblock">Disentangled federated learning for tackling attributes skew via
invariant aggregation and diversity transferring.

</span>
<span class="ltx_bibblock">In <span id="bib.bib32.3.1" class="ltx_text ltx_font_italic">ICML</span>, volume 162 of <span id="bib.bib32.4.2" class="ltx_text ltx_font_italic">Proceedings of Machine Learning
Research</span>, pages 14527–14541. PMLR, 2022.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McInnes <span id="bib.bib33.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Leland McInnes, John Healy, and James Melville.

</span>
<span class="ltx_bibblock">Umap: Uniform manifold approximation and projection for dimension
reduction.

</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1802.03426</span>, 2018.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan <span id="bib.bib34.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.3.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pages 1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mettes <span id="bib.bib35.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2019]</span>
<span class="ltx_bibblock">
Pascal Mettes, Elise van der Pol, and Cees Snoek.

</span>
<span class="ltx_bibblock">Hyperspherical prototype networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 32, 2019.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Movshovitz-Attias <span id="bib.bib36.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Yair Movshovitz-Attias, Alexander Toshev, Thomas K Leung, Sergey Ioffe, and
Saurabh Singh.

</span>
<span class="ltx_bibblock">No fuss distance metric learning using proxies.

</span>
<span class="ltx_bibblock">In <span id="bib.bib36.3.1" class="ltx_text ltx_font_italic">CVPR</span>, pages 360–368, 2017.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nickel and Kiela [2017]</span>
<span class="ltx_bibblock">
Maximillian Nickel and Douwe Kiela.

</span>
<span class="ltx_bibblock">Poincaré embeddings for learning hierarchical representations.

</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 30, 2017.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Jaehoon Oh, SangMook Kim, and Se-Young Yun.

</span>
<span class="ltx_bibblock">Fedbabu: Toward enhanced representation for federated image
classification.

</span>
<span class="ltx_bibblock">In <span id="bib.bib38.2.1" class="ltx_text ltx_font_italic">ICLR, 2021</span>.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sekitani and
Yamamoto [1993]</span>
<span class="ltx_bibblock">
Kazuyuki Sekitani and Yoshitsugu Yamamoto.

</span>
<span class="ltx_bibblock">A recursive algorithm for finding the minimum norm point in a
polytope and a pair of closest points in two polytopes.

</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">Mathematical Programming</span>, 61(1):233–249, 1993.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sener and Koltun [2018]</span>
<span class="ltx_bibblock">
Ozan Sener and Vladlen Koltun.

</span>
<span class="ltx_bibblock">Multi-task learning as multi-objective optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 31, 2018.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen <span id="bib.bib41.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2021]</span>
<span class="ltx_bibblock">
Jiayi Shen, Zehao Xiao, Xiantong Zhen, and Lei Zhang.

</span>
<span class="ltx_bibblock">Spherical zero-shot learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Circuits and Systems for Video Technology</span>,
32(2):634–645, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shimizu <span id="bib.bib42.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Ryohei Shimizu, Yusuke Mukuta, and Tatsuya Harada.

</span>
<span class="ltx_bibblock">Hyperbolic neural networks++.

</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2006.08210</span>, 2020.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith <span id="bib.bib43.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Virginia Smith, Chao-Kai Chiang, Maziar Sanjabi, and Ameet S Talwalkar.

</span>
<span class="ltx_bibblock">Federated multi-task learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 30, 2017.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">T Dinh <span id="bib.bib44.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Canh T Dinh, Nguyen Tran, and Josh Nguyen.

</span>
<span class="ltx_bibblock">Personalized federated learning with moreau envelopes.

</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 33:21394–21405, 2020.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tammes [1930]</span>
<span class="ltx_bibblock">
Pieter Merkus Lambertus Tammes.

</span>
<span class="ltx_bibblock">On the origin of number and arrangement of the places of exit on the
surface of pollen-grains.

</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text ltx_font_italic">Recueil des travaux botaniques néerlandais</span>, 27(1):1–84,
1930.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan <span id="bib.bib46.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022a]</span>
<span class="ltx_bibblock">
Alysa Ziying Tan, Han Yu, Lizhen Cui, and Qiang Yang.

</span>
<span class="ltx_bibblock">Towards personalized federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</span>,
2022.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan <span id="bib.bib47.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2022b]</span>
<span class="ltx_bibblock">
Yanchao Tan, Carl Yang, Xiangyu Wei, Chaochao Chen, Longfei Li, and Xiaolin
Zheng.

</span>
<span class="ltx_bibblock">Enhancing recommendation with automated tag taxonomy construction in
hyperbolic space.

</span>
<span class="ltx_bibblock">In <span id="bib.bib47.3.1" class="ltx_text ltx_font_italic">ICDE</span>, pages 1180–1192. IEEE, 2022.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weber <span id="bib.bib48.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2020]</span>
<span class="ltx_bibblock">
Melanie Weber, Manzil Zaheer, Ankit Singh Rawat, Aditya K Menon, and Sanjiv
Kumar.

</span>
<span class="ltx_bibblock">Robust large-margin learning in hyperbolic space.

</span>
<span class="ltx_bibblock"><span id="bib.bib48.3.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 33:17863–17873, 2020.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao <span id="bib.bib49.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2017]</span>
<span class="ltx_bibblock">
Han Xiao, Kashif Rasul, and Roland Vollgraf.

</span>
<span class="ltx_bibblock">Fashion-mnist: a novel image dataset for benchmarking machine
learning algorithms.

</span>
<span class="ltx_bibblock"><span id="bib.bib49.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1708.07747</span>, 2017.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao <span id="bib.bib50.2.2.1" class="ltx_text ltx_font_italic">et al.</span> [2018]</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib50.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1806.00582</span>, 2018.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Datasets</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">We visualize the data distributions under different degrees of non-IID, i.e., <math id="A1.p1.1.m1.3" class="ltx_Math" alttext="\alpha=\{0.1,0.5,5\}" display="inline"><semantics id="A1.p1.1.m1.3a"><mrow id="A1.p1.1.m1.3.4" xref="A1.p1.1.m1.3.4.cmml"><mi id="A1.p1.1.m1.3.4.2" xref="A1.p1.1.m1.3.4.2.cmml">α</mi><mo id="A1.p1.1.m1.3.4.1" xref="A1.p1.1.m1.3.4.1.cmml">=</mo><mrow id="A1.p1.1.m1.3.4.3.2" xref="A1.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="A1.p1.1.m1.3.4.3.2.1" xref="A1.p1.1.m1.3.4.3.1.cmml">{</mo><mn id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">0.1</mn><mo id="A1.p1.1.m1.3.4.3.2.2" xref="A1.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.p1.1.m1.2.2" xref="A1.p1.1.m1.2.2.cmml">0.5</mn><mo id="A1.p1.1.m1.3.4.3.2.3" xref="A1.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="A1.p1.1.m1.3.3" xref="A1.p1.1.m1.3.3.cmml">5</mn><mo stretchy="false" id="A1.p1.1.m1.3.4.3.2.4" xref="A1.p1.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.3b"><apply id="A1.p1.1.m1.3.4.cmml" xref="A1.p1.1.m1.3.4"><eq id="A1.p1.1.m1.3.4.1.cmml" xref="A1.p1.1.m1.3.4.1"></eq><ci id="A1.p1.1.m1.3.4.2.cmml" xref="A1.p1.1.m1.3.4.2">𝛼</ci><set id="A1.p1.1.m1.3.4.3.1.cmml" xref="A1.p1.1.m1.3.4.3.2"><cn type="float" id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">0.1</cn><cn type="float" id="A1.p1.1.m1.2.2.cmml" xref="A1.p1.1.m1.2.2">0.5</cn><cn type="integer" id="A1.p1.1.m1.3.3.cmml" xref="A1.p1.1.m1.3.3">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.3c">\alpha=\{0.1,0.5,5\}</annotation></semantics></math> for EMNIST, FMNIST, Cifar10, and Cifar100 in Fig. <a href="#A1.F8" title="Figure 8 ‣ Appendix A Datasets ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>-Fig. <a href="#A1.F10" title="Figure 10 ‣ Appendix A Datasets ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>.</p>
</div>
<figure id="A1.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F8.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="A1.F8.sf1.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2307.14384/assets/figs/heatmap/emnist-letters-alpha0.1.png" id="A1.F8.sf1.1.g1" class="ltx_graphics ltx_img_landscape" width="621" height="438" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F8.sf1.5.2.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="A1.F8.sf1.3.1" class="ltx_text" style="font-size:80%;">EMNIST <math id="A1.F8.sf1.3.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.F8.sf1.3.1.m1.1b"><mrow id="A1.F8.sf1.3.1.m1.1.1" xref="A1.F8.sf1.3.1.m1.1.1.cmml"><mi id="A1.F8.sf1.3.1.m1.1.1.2" xref="A1.F8.sf1.3.1.m1.1.1.2.cmml">α</mi><mo id="A1.F8.sf1.3.1.m1.1.1.1" xref="A1.F8.sf1.3.1.m1.1.1.1.cmml">=</mo><mn id="A1.F8.sf1.3.1.m1.1.1.3" xref="A1.F8.sf1.3.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F8.sf1.3.1.m1.1c"><apply id="A1.F8.sf1.3.1.m1.1.1.cmml" xref="A1.F8.sf1.3.1.m1.1.1"><eq id="A1.F8.sf1.3.1.m1.1.1.1.cmml" xref="A1.F8.sf1.3.1.m1.1.1.1"></eq><ci id="A1.F8.sf1.3.1.m1.1.1.2.cmml" xref="A1.F8.sf1.3.1.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F8.sf1.3.1.m1.1.1.3.cmml" xref="A1.F8.sf1.3.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.sf1.3.1.m1.1d">\alpha=0.1</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F8.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="A1.F8.sf2.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2307.14384/assets/figs/heatmap/fmnist-alpha0.1.png" id="A1.F8.sf2.1.g1" class="ltx_graphics ltx_img_landscape" width="621" height="438" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F8.sf2.5.2.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="A1.F8.sf2.3.1" class="ltx_text" style="font-size:80%;">FMNIST <math id="A1.F8.sf2.3.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.F8.sf2.3.1.m1.1b"><mrow id="A1.F8.sf2.3.1.m1.1.1" xref="A1.F8.sf2.3.1.m1.1.1.cmml"><mi id="A1.F8.sf2.3.1.m1.1.1.2" xref="A1.F8.sf2.3.1.m1.1.1.2.cmml">α</mi><mo id="A1.F8.sf2.3.1.m1.1.1.1" xref="A1.F8.sf2.3.1.m1.1.1.1.cmml">=</mo><mn id="A1.F8.sf2.3.1.m1.1.1.3" xref="A1.F8.sf2.3.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F8.sf2.3.1.m1.1c"><apply id="A1.F8.sf2.3.1.m1.1.1.cmml" xref="A1.F8.sf2.3.1.m1.1.1"><eq id="A1.F8.sf2.3.1.m1.1.1.1.cmml" xref="A1.F8.sf2.3.1.m1.1.1.1"></eq><ci id="A1.F8.sf2.3.1.m1.1.1.2.cmml" xref="A1.F8.sf2.3.1.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F8.sf2.3.1.m1.1.1.3.cmml" xref="A1.F8.sf2.3.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.sf2.3.1.m1.1d">\alpha=0.1</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F8.sf3" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="A1.F8.sf3.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2307.14384/assets/figs/heatmap/cifar10-alpha0.1.png" id="A1.F8.sf3.1.g1" class="ltx_graphics ltx_img_landscape" width="621" height="438" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F8.sf3.5.2.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="A1.F8.sf3.3.1" class="ltx_text" style="font-size:80%;">Cifar10 <math id="A1.F8.sf3.3.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.F8.sf3.3.1.m1.1b"><mrow id="A1.F8.sf3.3.1.m1.1.1" xref="A1.F8.sf3.3.1.m1.1.1.cmml"><mi id="A1.F8.sf3.3.1.m1.1.1.2" xref="A1.F8.sf3.3.1.m1.1.1.2.cmml">α</mi><mo id="A1.F8.sf3.3.1.m1.1.1.1" xref="A1.F8.sf3.3.1.m1.1.1.1.cmml">=</mo><mn id="A1.F8.sf3.3.1.m1.1.1.3" xref="A1.F8.sf3.3.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F8.sf3.3.1.m1.1c"><apply id="A1.F8.sf3.3.1.m1.1.1.cmml" xref="A1.F8.sf3.3.1.m1.1.1"><eq id="A1.F8.sf3.3.1.m1.1.1.1.cmml" xref="A1.F8.sf3.3.1.m1.1.1.1"></eq><ci id="A1.F8.sf3.3.1.m1.1.1.2.cmml" xref="A1.F8.sf3.3.1.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F8.sf3.3.1.m1.1.1.3.cmml" xref="A1.F8.sf3.3.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.sf3.3.1.m1.1d">\alpha=0.1</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F8.sf4" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="A1.F8.sf4.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2307.14384/assets/figs/heatmap/cifar100-alpha0.1.png" id="A1.F8.sf4.1.g1" class="ltx_graphics ltx_img_landscape" width="616" height="444" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F8.sf4.5.2.1" class="ltx_text" style="font-size:80%;">(d)</span> </span><span id="A1.F8.sf4.3.1" class="ltx_text" style="font-size:80%;">Cifar100 <math id="A1.F8.sf4.3.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.F8.sf4.3.1.m1.1b"><mrow id="A1.F8.sf4.3.1.m1.1.1" xref="A1.F8.sf4.3.1.m1.1.1.cmml"><mi id="A1.F8.sf4.3.1.m1.1.1.2" xref="A1.F8.sf4.3.1.m1.1.1.2.cmml">α</mi><mo id="A1.F8.sf4.3.1.m1.1.1.1" xref="A1.F8.sf4.3.1.m1.1.1.1.cmml">=</mo><mn id="A1.F8.sf4.3.1.m1.1.1.3" xref="A1.F8.sf4.3.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F8.sf4.3.1.m1.1c"><apply id="A1.F8.sf4.3.1.m1.1.1.cmml" xref="A1.F8.sf4.3.1.m1.1.1"><eq id="A1.F8.sf4.3.1.m1.1.1.1.cmml" xref="A1.F8.sf4.3.1.m1.1.1.1"></eq><ci id="A1.F8.sf4.3.1.m1.1.1.2.cmml" xref="A1.F8.sf4.3.1.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F8.sf4.3.1.m1.1.1.3.cmml" xref="A1.F8.sf4.3.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.sf4.3.1.m1.1d">\alpha=0.1</annotation></semantics></math></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Distributions of <math id="A1.F8.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.F8.2.m1.1b"><mrow id="A1.F8.2.m1.1.1" xref="A1.F8.2.m1.1.1.cmml"><mi id="A1.F8.2.m1.1.1.2" xref="A1.F8.2.m1.1.1.2.cmml">α</mi><mo id="A1.F8.2.m1.1.1.1" xref="A1.F8.2.m1.1.1.1.cmml">=</mo><mn id="A1.F8.2.m1.1.1.3" xref="A1.F8.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F8.2.m1.1c"><apply id="A1.F8.2.m1.1.1.cmml" xref="A1.F8.2.m1.1.1"><eq id="A1.F8.2.m1.1.1.1.cmml" xref="A1.F8.2.m1.1.1.1"></eq><ci id="A1.F8.2.m1.1.1.2.cmml" xref="A1.F8.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F8.2.m1.1.1.3.cmml" xref="A1.F8.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F8.2.m1.1d">\alpha=0.1</annotation></semantics></math>.</figcaption>
</figure>
<figure id="A1.F9" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F9.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="A1.F9.sf1.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2307.14384/assets/figs/heatmap/emnist-letters-alpha0.5.png" id="A1.F9.sf1.1.g1" class="ltx_graphics ltx_img_landscape" width="621" height="438" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F9.sf1.5.2.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="A1.F9.sf1.3.1" class="ltx_text" style="font-size:80%;">EMNIST <math id="A1.F9.sf1.3.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="A1.F9.sf1.3.1.m1.1b"><mrow id="A1.F9.sf1.3.1.m1.1.1" xref="A1.F9.sf1.3.1.m1.1.1.cmml"><mi id="A1.F9.sf1.3.1.m1.1.1.2" xref="A1.F9.sf1.3.1.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf1.3.1.m1.1.1.1" xref="A1.F9.sf1.3.1.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf1.3.1.m1.1.1.3" xref="A1.F9.sf1.3.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf1.3.1.m1.1c"><apply id="A1.F9.sf1.3.1.m1.1.1.cmml" xref="A1.F9.sf1.3.1.m1.1.1"><eq id="A1.F9.sf1.3.1.m1.1.1.1.cmml" xref="A1.F9.sf1.3.1.m1.1.1.1"></eq><ci id="A1.F9.sf1.3.1.m1.1.1.2.cmml" xref="A1.F9.sf1.3.1.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.sf1.3.1.m1.1.1.3.cmml" xref="A1.F9.sf1.3.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf1.3.1.m1.1d">\alpha=0.5</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F9.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="A1.F9.sf2.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2307.14384/assets/figs/heatmap/fmnist-alpha0.5.png" id="A1.F9.sf2.1.g1" class="ltx_graphics ltx_img_landscape" width="621" height="438" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F9.sf2.5.2.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="A1.F9.sf2.3.1" class="ltx_text" style="font-size:80%;">FMNIST <math id="A1.F9.sf2.3.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="A1.F9.sf2.3.1.m1.1b"><mrow id="A1.F9.sf2.3.1.m1.1.1" xref="A1.F9.sf2.3.1.m1.1.1.cmml"><mi id="A1.F9.sf2.3.1.m1.1.1.2" xref="A1.F9.sf2.3.1.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf2.3.1.m1.1.1.1" xref="A1.F9.sf2.3.1.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf2.3.1.m1.1.1.3" xref="A1.F9.sf2.3.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf2.3.1.m1.1c"><apply id="A1.F9.sf2.3.1.m1.1.1.cmml" xref="A1.F9.sf2.3.1.m1.1.1"><eq id="A1.F9.sf2.3.1.m1.1.1.1.cmml" xref="A1.F9.sf2.3.1.m1.1.1.1"></eq><ci id="A1.F9.sf2.3.1.m1.1.1.2.cmml" xref="A1.F9.sf2.3.1.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.sf2.3.1.m1.1.1.3.cmml" xref="A1.F9.sf2.3.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf2.3.1.m1.1d">\alpha=0.5</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F9.sf3" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="A1.F9.sf3.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2307.14384/assets/figs/heatmap/cifar10-alpha0.5.png" id="A1.F9.sf3.1.g1" class="ltx_graphics ltx_img_landscape" width="621" height="438" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F9.sf3.5.2.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="A1.F9.sf3.3.1" class="ltx_text" style="font-size:80%;">Cifar10 <math id="A1.F9.sf3.3.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="A1.F9.sf3.3.1.m1.1b"><mrow id="A1.F9.sf3.3.1.m1.1.1" xref="A1.F9.sf3.3.1.m1.1.1.cmml"><mi id="A1.F9.sf3.3.1.m1.1.1.2" xref="A1.F9.sf3.3.1.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf3.3.1.m1.1.1.1" xref="A1.F9.sf3.3.1.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf3.3.1.m1.1.1.3" xref="A1.F9.sf3.3.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf3.3.1.m1.1c"><apply id="A1.F9.sf3.3.1.m1.1.1.cmml" xref="A1.F9.sf3.3.1.m1.1.1"><eq id="A1.F9.sf3.3.1.m1.1.1.1.cmml" xref="A1.F9.sf3.3.1.m1.1.1.1"></eq><ci id="A1.F9.sf3.3.1.m1.1.1.2.cmml" xref="A1.F9.sf3.3.1.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.sf3.3.1.m1.1.1.3.cmml" xref="A1.F9.sf3.3.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf3.3.1.m1.1d">\alpha=0.5</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F9.sf4" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="A1.F9.sf4.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2307.14384/assets/figs/heatmap/cifar100-alpha0.5.png" id="A1.F9.sf4.1.g1" class="ltx_graphics ltx_img_landscape" width="616" height="444" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F9.sf4.5.2.1" class="ltx_text" style="font-size:80%;">(d)</span> </span><span id="A1.F9.sf4.3.1" class="ltx_text" style="font-size:80%;">Cifar100 <math id="A1.F9.sf4.3.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.F9.sf4.3.1.m1.1b"><mrow id="A1.F9.sf4.3.1.m1.1.1" xref="A1.F9.sf4.3.1.m1.1.1.cmml"><mi id="A1.F9.sf4.3.1.m1.1.1.2" xref="A1.F9.sf4.3.1.m1.1.1.2.cmml">α</mi><mo id="A1.F9.sf4.3.1.m1.1.1.1" xref="A1.F9.sf4.3.1.m1.1.1.1.cmml">=</mo><mn id="A1.F9.sf4.3.1.m1.1.1.3" xref="A1.F9.sf4.3.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.sf4.3.1.m1.1c"><apply id="A1.F9.sf4.3.1.m1.1.1.cmml" xref="A1.F9.sf4.3.1.m1.1.1"><eq id="A1.F9.sf4.3.1.m1.1.1.1.cmml" xref="A1.F9.sf4.3.1.m1.1.1.1"></eq><ci id="A1.F9.sf4.3.1.m1.1.1.2.cmml" xref="A1.F9.sf4.3.1.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.sf4.3.1.m1.1.1.3.cmml" xref="A1.F9.sf4.3.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.sf4.3.1.m1.1d">\alpha=0.1</annotation></semantics></math></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Distributions of <math id="A1.F9.2.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="A1.F9.2.m1.1b"><mrow id="A1.F9.2.m1.1.1" xref="A1.F9.2.m1.1.1.cmml"><mi id="A1.F9.2.m1.1.1.2" xref="A1.F9.2.m1.1.1.2.cmml">α</mi><mo id="A1.F9.2.m1.1.1.1" xref="A1.F9.2.m1.1.1.1.cmml">=</mo><mn id="A1.F9.2.m1.1.1.3" xref="A1.F9.2.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.2.m1.1c"><apply id="A1.F9.2.m1.1.1.cmml" xref="A1.F9.2.m1.1.1"><eq id="A1.F9.2.m1.1.1.1.cmml" xref="A1.F9.2.m1.1.1.1"></eq><ci id="A1.F9.2.m1.1.1.2.cmml" xref="A1.F9.2.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F9.2.m1.1.1.3.cmml" xref="A1.F9.2.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.2.m1.1d">\alpha=0.5</annotation></semantics></math>.</figcaption>
</figure>
<figure id="A1.F10" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F10.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="A1.F10.sf1.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2307.14384/assets/figs/heatmap/emnist-letters-alpha5.png" id="A1.F10.sf1.1.g1" class="ltx_graphics ltx_img_landscape" width="611" height="438" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F10.sf1.5.2.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="A1.F10.sf1.3.1" class="ltx_text" style="font-size:80%;">EMNIST <math id="A1.F10.sf1.3.1.m1.1" class="ltx_Math" alttext="\alpha=5" display="inline"><semantics id="A1.F10.sf1.3.1.m1.1b"><mrow id="A1.F10.sf1.3.1.m1.1.1" xref="A1.F10.sf1.3.1.m1.1.1.cmml"><mi id="A1.F10.sf1.3.1.m1.1.1.2" xref="A1.F10.sf1.3.1.m1.1.1.2.cmml">α</mi><mo id="A1.F10.sf1.3.1.m1.1.1.1" xref="A1.F10.sf1.3.1.m1.1.1.1.cmml">=</mo><mn id="A1.F10.sf1.3.1.m1.1.1.3" xref="A1.F10.sf1.3.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F10.sf1.3.1.m1.1c"><apply id="A1.F10.sf1.3.1.m1.1.1.cmml" xref="A1.F10.sf1.3.1.m1.1.1"><eq id="A1.F10.sf1.3.1.m1.1.1.1.cmml" xref="A1.F10.sf1.3.1.m1.1.1.1"></eq><ci id="A1.F10.sf1.3.1.m1.1.1.2.cmml" xref="A1.F10.sf1.3.1.m1.1.1.2">𝛼</ci><cn type="integer" id="A1.F10.sf1.3.1.m1.1.1.3.cmml" xref="A1.F10.sf1.3.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.sf1.3.1.m1.1d">\alpha=5</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F10.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="A1.F10.sf2.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2307.14384/assets/figs/heatmap/fmnist-alpha5.png" id="A1.F10.sf2.1.g1" class="ltx_graphics ltx_img_landscape" width="611" height="438" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F10.sf2.5.2.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="A1.F10.sf2.3.1" class="ltx_text" style="font-size:80%;">FMNIST <math id="A1.F10.sf2.3.1.m1.1" class="ltx_Math" alttext="\alpha=5" display="inline"><semantics id="A1.F10.sf2.3.1.m1.1b"><mrow id="A1.F10.sf2.3.1.m1.1.1" xref="A1.F10.sf2.3.1.m1.1.1.cmml"><mi id="A1.F10.sf2.3.1.m1.1.1.2" xref="A1.F10.sf2.3.1.m1.1.1.2.cmml">α</mi><mo id="A1.F10.sf2.3.1.m1.1.1.1" xref="A1.F10.sf2.3.1.m1.1.1.1.cmml">=</mo><mn id="A1.F10.sf2.3.1.m1.1.1.3" xref="A1.F10.sf2.3.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F10.sf2.3.1.m1.1c"><apply id="A1.F10.sf2.3.1.m1.1.1.cmml" xref="A1.F10.sf2.3.1.m1.1.1"><eq id="A1.F10.sf2.3.1.m1.1.1.1.cmml" xref="A1.F10.sf2.3.1.m1.1.1.1"></eq><ci id="A1.F10.sf2.3.1.m1.1.1.2.cmml" xref="A1.F10.sf2.3.1.m1.1.1.2">𝛼</ci><cn type="integer" id="A1.F10.sf2.3.1.m1.1.1.3.cmml" xref="A1.F10.sf2.3.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.sf2.3.1.m1.1d">\alpha=5</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F10.sf3" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="A1.F10.sf3.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2307.14384/assets/figs/heatmap/cifar10-alpha5.png" id="A1.F10.sf3.1.g1" class="ltx_graphics ltx_img_landscape" width="611" height="438" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F10.sf3.5.2.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="A1.F10.sf3.3.1" class="ltx_text" style="font-size:80%;">Cifar10 <math id="A1.F10.sf3.3.1.m1.1" class="ltx_Math" alttext="\alpha=5" display="inline"><semantics id="A1.F10.sf3.3.1.m1.1b"><mrow id="A1.F10.sf3.3.1.m1.1.1" xref="A1.F10.sf3.3.1.m1.1.1.cmml"><mi id="A1.F10.sf3.3.1.m1.1.1.2" xref="A1.F10.sf3.3.1.m1.1.1.2.cmml">α</mi><mo id="A1.F10.sf3.3.1.m1.1.1.1" xref="A1.F10.sf3.3.1.m1.1.1.1.cmml">=</mo><mn id="A1.F10.sf3.3.1.m1.1.1.3" xref="A1.F10.sf3.3.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F10.sf3.3.1.m1.1c"><apply id="A1.F10.sf3.3.1.m1.1.1.cmml" xref="A1.F10.sf3.3.1.m1.1.1"><eq id="A1.F10.sf3.3.1.m1.1.1.1.cmml" xref="A1.F10.sf3.3.1.m1.1.1.1"></eq><ci id="A1.F10.sf3.3.1.m1.1.1.2.cmml" xref="A1.F10.sf3.3.1.m1.1.1.2">𝛼</ci><cn type="integer" id="A1.F10.sf3.3.1.m1.1.1.3.cmml" xref="A1.F10.sf3.3.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.sf3.3.1.m1.1d">\alpha=5</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F10.sf4" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="A1.F10.sf4.1" class="ltx_block ltx_minipage ltx_align_middle" style="width:195.1pt;">
<img src="/html/2307.14384/assets/figs/heatmap/cifar100-alpha5.png" id="A1.F10.sf4.1.g1" class="ltx_graphics ltx_img_landscape" width="605" height="444" alt="Refer to caption">
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F10.sf4.5.2.1" class="ltx_text" style="font-size:80%;">(d)</span> </span><span id="A1.F10.sf4.3.1" class="ltx_text" style="font-size:80%;">Cifar100 <math id="A1.F10.sf4.3.1.m1.1" class="ltx_Math" alttext="\alpha=5" display="inline"><semantics id="A1.F10.sf4.3.1.m1.1b"><mrow id="A1.F10.sf4.3.1.m1.1.1" xref="A1.F10.sf4.3.1.m1.1.1.cmml"><mi id="A1.F10.sf4.3.1.m1.1.1.2" xref="A1.F10.sf4.3.1.m1.1.1.2.cmml">α</mi><mo id="A1.F10.sf4.3.1.m1.1.1.1" xref="A1.F10.sf4.3.1.m1.1.1.1.cmml">=</mo><mn id="A1.F10.sf4.3.1.m1.1.1.3" xref="A1.F10.sf4.3.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F10.sf4.3.1.m1.1c"><apply id="A1.F10.sf4.3.1.m1.1.1.cmml" xref="A1.F10.sf4.3.1.m1.1.1"><eq id="A1.F10.sf4.3.1.m1.1.1.1.cmml" xref="A1.F10.sf4.3.1.m1.1.1.1"></eq><ci id="A1.F10.sf4.3.1.m1.1.1.2.cmml" xref="A1.F10.sf4.3.1.m1.1.1.2">𝛼</ci><cn type="integer" id="A1.F10.sf4.3.1.m1.1.1.3.cmml" xref="A1.F10.sf4.3.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.sf4.3.1.m1.1d">\alpha=5</annotation></semantics></math></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Distributions of <math id="A1.F10.2.m1.1" class="ltx_Math" alttext="\alpha=5" display="inline"><semantics id="A1.F10.2.m1.1b"><mrow id="A1.F10.2.m1.1.1" xref="A1.F10.2.m1.1.1.cmml"><mi id="A1.F10.2.m1.1.1.2" xref="A1.F10.2.m1.1.1.2.cmml">α</mi><mo id="A1.F10.2.m1.1.1.1" xref="A1.F10.2.m1.1.1.1.cmml">=</mo><mn id="A1.F10.2.m1.1.1.3" xref="A1.F10.2.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F10.2.m1.1c"><apply id="A1.F10.2.m1.1.1.cmml" xref="A1.F10.2.m1.1.1"><eq id="A1.F10.2.m1.1.1.1.cmml" xref="A1.F10.2.m1.1.1.1"></eq><ci id="A1.F10.2.m1.1.1.2.cmml" xref="A1.F10.2.m1.1.1.2">𝛼</ci><cn type="integer" id="A1.F10.2.m1.1.1.3.cmml" xref="A1.F10.2.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F10.2.m1.1d">\alpha=5</annotation></semantics></math>.</figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Details of Comparison Methods</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">We compare <span id="A2.p1.1.1" class="ltx_text ltx_font_typewriter">HyperFed</span> with three categories of state-of-the-art approaches according to their optimization goals, i.e., (1) optimizing global model: <span id="A2.p1.1.2" class="ltx_text ltx_font_bold">FedAvg</span> <cite class="ltx_cite ltx_citemacro_cite">McMahan <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib34" title="" class="ltx_ref">2017</a>]</cite>, <span id="A2.p1.1.3" class="ltx_text ltx_font_bold">FedProx</span> <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib23" title="" class="ltx_ref">2020</a>]</cite>, <span id="A2.p1.1.4" class="ltx_text ltx_font_bold">SCAFFOLD</span> <cite class="ltx_cite ltx_citemacro_cite">Karimireddy <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib18" title="" class="ltx_ref">2019</a>]</cite>, <span id="A2.p1.1.5" class="ltx_text ltx_font_bold">FedDYN</span> <cite class="ltx_cite ltx_citemacro_cite">Acar <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib1" title="" class="ltx_ref">2020</a>]</cite>, <span id="A2.p1.1.6" class="ltx_text ltx_font_bold">MOON</span> <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib24" title="" class="ltx_ref">2021a</a>]</cite>, (2) optimizing local personalized models: <span id="A2.p1.1.7" class="ltx_text ltx_font_bold">FedMTL</span> <cite class="ltx_cite ltx_citemacro_cite">Smith <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib43" title="" class="ltx_ref">2017</a>]</cite>, <span id="A2.p1.1.8" class="ltx_text ltx_font_bold">FedPer</span> <cite class="ltx_cite ltx_citemacro_cite">Arivazhagan <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib2" title="" class="ltx_ref">2019</a>]</cite>, <span id="A2.p1.1.9" class="ltx_text ltx_font_bold">pFedMe</span> <cite class="ltx_cite ltx_citemacro_cite">T Dinh <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib44" title="" class="ltx_ref">2020</a>]</cite>, <span id="A2.p1.1.10" class="ltx_text ltx_font_bold">Ditto</span> <cite class="ltx_cite ltx_citemacro_cite">Li <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib25" title="" class="ltx_ref">2021b</a>]</cite>,
<span id="A2.p1.1.11" class="ltx_text ltx_font_bold">APPLE</span> <cite class="ltx_cite ltx_citemacro_cite">Luo and Wu [<a href="#bib.bib31" title="" class="ltx_ref">2021</a>]</cite>, and (3) optimizing both global and local models: <span id="A2.p1.1.12" class="ltx_text ltx_font_bold">Fed-RoD</span> <cite class="ltx_cite ltx_citemacro_cite">Chen and Chao [<a href="#bib.bib4" title="" class="ltx_ref">2021</a>]</cite>, <span id="A2.p1.1.13" class="ltx_text ltx_font_bold">FedBABU</span> <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib38" title="" class="ltx_ref">Oh <span class="ltx_text ltx_font_italic">et al.</span> </a></cite>, <span id="A2.p1.1.14" class="ltx_text ltx_font_bold">SphereFed</span> <cite class="ltx_cite ltx_citemacro_cite">Dong <span class="ltx_text ltx_font_italic">et al.</span> [<a href="#bib.bib10" title="" class="ltx_ref">2022</a>]</cite>.
<span id="A2.p1.1.15" class="ltx_text ltx_font_bold">FedAvg</span> is the first vanilla federated learning framework to collaborate among server and clients.
<span id="A2.p1.1.16" class="ltx_text ltx_font_bold">FedProx</span> takes a proximal term to regularize the change from global model to the local model.
<span id="A2.p1.1.17" class="ltx_text ltx_font_bold">SCAFFOLD</span> considers the variance of global model and local model when updating local gradients.
<span id="A2.p1.1.18" class="ltx_text ltx_font_bold">FedDYN</span> applies an dynamic regularizer to pull local model close to the global model, while to push local model away from historical local model.
<span id="A2.p1.1.19" class="ltx_text ltx_font_bold">MOON</span> introduces contrastive learning to federated learning.
<span id="A2.p1.1.20" class="ltx_text ltx_font_bold">FedMTL</span> is an algorithm that takes personalized learning as a multi-task learning objective.
<span id="A2.p1.1.21" class="ltx_text ltx_font_bold">FedPer</span> decouples the global representation and local personalized classification.
<span id="A2.p1.1.22" class="ltx_text ltx_font_bold">pFedMe</span> uses Moreau envelopes as clients’ regularized loss functions to decouple personalized model optimization from the global model learning.
<span id="A2.p1.1.23" class="ltx_text ltx_font_bold">Ditto</span> is a multi-task learning objective for federated learning that provides personalization while retaining similar efficiency.
<span id="A2.p1.1.24" class="ltx_text ltx_font_bold">APPLE</span> adaptively learns to personalize the client models.
<span id="A2.p1.1.25" class="ltx_text ltx_font_bold">Fed-RoD</span> explicitly decouples a model’s dual duties with two prediction tasks.
<span id="A2.p1.1.26" class="ltx_text ltx_font_bold">FedBABU</span> only updates the representation body of the model during federated training, and the head is fine-tuned for personalization during the evaluation process.
<span id="A2.p1.1.27" class="ltx_text ltx_font_bold">SphereFed</span> is a hyperspherical federated learning framework to
address PFL problem.</p>
</div>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.9" class="ltx_p">We conduct all of the experiments on one NVIDIA RTX 3090 GPU with 24Gb Memory.
In the first category of methods, a hyper-parameter <math id="A2.p2.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="A2.p2.1.m1.1a"><mi id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><ci id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">\mu</annotation></semantics></math> is mainly set to balance the local objective and regularization term (between the global model and local model).
According to the optimal results, we set <math id="A2.p2.2.m2.4" class="ltx_Math" alttext="\mu=0.01,1,0.1," display="inline"><semantics id="A2.p2.2.m2.4a"><mrow id="A2.p2.2.m2.4.4.1" xref="A2.p2.2.m2.4.4.1.1.cmml"><mrow id="A2.p2.2.m2.4.4.1.1" xref="A2.p2.2.m2.4.4.1.1.cmml"><mi id="A2.p2.2.m2.4.4.1.1.2" xref="A2.p2.2.m2.4.4.1.1.2.cmml">μ</mi><mo id="A2.p2.2.m2.4.4.1.1.1" xref="A2.p2.2.m2.4.4.1.1.1.cmml">=</mo><mrow id="A2.p2.2.m2.4.4.1.1.3.2" xref="A2.p2.2.m2.4.4.1.1.3.1.cmml"><mn id="A2.p2.2.m2.1.1" xref="A2.p2.2.m2.1.1.cmml">0.01</mn><mo id="A2.p2.2.m2.4.4.1.1.3.2.1" xref="A2.p2.2.m2.4.4.1.1.3.1.cmml">,</mo><mn id="A2.p2.2.m2.2.2" xref="A2.p2.2.m2.2.2.cmml">1</mn><mo id="A2.p2.2.m2.4.4.1.1.3.2.2" xref="A2.p2.2.m2.4.4.1.1.3.1.cmml">,</mo><mn id="A2.p2.2.m2.3.3" xref="A2.p2.2.m2.3.3.cmml">0.1</mn></mrow></mrow><mo id="A2.p2.2.m2.4.4.1.2" xref="A2.p2.2.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.2.m2.4b"><apply id="A2.p2.2.m2.4.4.1.1.cmml" xref="A2.p2.2.m2.4.4.1"><eq id="A2.p2.2.m2.4.4.1.1.1.cmml" xref="A2.p2.2.m2.4.4.1.1.1"></eq><ci id="A2.p2.2.m2.4.4.1.1.2.cmml" xref="A2.p2.2.m2.4.4.1.1.2">𝜇</ci><list id="A2.p2.2.m2.4.4.1.1.3.1.cmml" xref="A2.p2.2.m2.4.4.1.1.3.2"><cn type="float" id="A2.p2.2.m2.1.1.cmml" xref="A2.p2.2.m2.1.1">0.01</cn><cn type="integer" id="A2.p2.2.m2.2.2.cmml" xref="A2.p2.2.m2.2.2">1</cn><cn type="float" id="A2.p2.2.m2.3.3.cmml" xref="A2.p2.2.m2.3.3">0.1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m2.4c">\mu=0.01,1,0.1,</annotation></semantics></math> for FedProx, MOON, and FedDYN, respectively.
Besides, we set <math id="A2.p2.3.m3.1" class="ltx_Math" alttext="\tau=0.5" display="inline"><semantics id="A2.p2.3.m3.1a"><mrow id="A2.p2.3.m3.1.1" xref="A2.p2.3.m3.1.1.cmml"><mi id="A2.p2.3.m3.1.1.2" xref="A2.p2.3.m3.1.1.2.cmml">τ</mi><mo id="A2.p2.3.m3.1.1.1" xref="A2.p2.3.m3.1.1.1.cmml">=</mo><mn id="A2.p2.3.m3.1.1.3" xref="A2.p2.3.m3.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.3.m3.1b"><apply id="A2.p2.3.m3.1.1.cmml" xref="A2.p2.3.m3.1.1"><eq id="A2.p2.3.m3.1.1.1.cmml" xref="A2.p2.3.m3.1.1.1"></eq><ci id="A2.p2.3.m3.1.1.2.cmml" xref="A2.p2.3.m3.1.1.2">𝜏</ci><cn type="float" id="A2.p2.3.m3.1.1.3.cmml" xref="A2.p2.3.m3.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.3.m3.1c">\tau=0.5</annotation></semantics></math>, the default temperature of MOON as specified in the original paper.
For all of the second category of methods as well as the third category of methods, we follow the personalized way as their original setting.
We similarly finetune <span id="A2.p2.9.1" class="ltx_text ltx_font_typewriter">HyperFed</span> and FedBABU with additional 5 local steps in P-FL.
For pFedMe, we set regularization parameter <math id="A2.p2.4.m4.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="A2.p2.4.m4.1a"><mrow id="A2.p2.4.m4.1.1" xref="A2.p2.4.m4.1.1.cmml"><mi id="A2.p2.4.m4.1.1.2" xref="A2.p2.4.m4.1.1.2.cmml">μ</mi><mo id="A2.p2.4.m4.1.1.1" xref="A2.p2.4.m4.1.1.1.cmml">=</mo><mn id="A2.p2.4.m4.1.1.3" xref="A2.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.4.m4.1b"><apply id="A2.p2.4.m4.1.1.cmml" xref="A2.p2.4.m4.1.1"><eq id="A2.p2.4.m4.1.1.1.cmml" xref="A2.p2.4.m4.1.1.1"></eq><ci id="A2.p2.4.m4.1.1.2.cmml" xref="A2.p2.4.m4.1.1.2">𝜇</ci><cn type="integer" id="A2.p2.4.m4.1.1.3.cmml" xref="A2.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.4.m4.1c">\mu=1</annotation></semantics></math> for controlling the strength of personalized model, computation complexity <math id="A2.p2.5.m5.1" class="ltx_Math" alttext="k=5" display="inline"><semantics id="A2.p2.5.m5.1a"><mrow id="A2.p2.5.m5.1.1" xref="A2.p2.5.m5.1.1.cmml"><mi id="A2.p2.5.m5.1.1.2" xref="A2.p2.5.m5.1.1.2.cmml">k</mi><mo id="A2.p2.5.m5.1.1.1" xref="A2.p2.5.m5.1.1.1.cmml">=</mo><mn id="A2.p2.5.m5.1.1.3" xref="A2.p2.5.m5.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.5.m5.1b"><apply id="A2.p2.5.m5.1.1.cmml" xref="A2.p2.5.m5.1.1"><eq id="A2.p2.5.m5.1.1.1.cmml" xref="A2.p2.5.m5.1.1.1"></eq><ci id="A2.p2.5.m5.1.1.2.cmml" xref="A2.p2.5.m5.1.1.2">𝑘</ci><cn type="integer" id="A2.p2.5.m5.1.1.3.cmml" xref="A2.p2.5.m5.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.5.m5.1c">k=5</annotation></semantics></math>, the interpolation parameter <math id="A2.p2.6.m6.1" class="ltx_Math" alttext="\beta=1" display="inline"><semantics id="A2.p2.6.m6.1a"><mrow id="A2.p2.6.m6.1.1" xref="A2.p2.6.m6.1.1.cmml"><mi id="A2.p2.6.m6.1.1.2" xref="A2.p2.6.m6.1.1.2.cmml">β</mi><mo id="A2.p2.6.m6.1.1.1" xref="A2.p2.6.m6.1.1.1.cmml">=</mo><mn id="A2.p2.6.m6.1.1.3" xref="A2.p2.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.6.m6.1b"><apply id="A2.p2.6.m6.1.1.cmml" xref="A2.p2.6.m6.1.1"><eq id="A2.p2.6.m6.1.1.1.cmml" xref="A2.p2.6.m6.1.1.1"></eq><ci id="A2.p2.6.m6.1.1.2.cmml" xref="A2.p2.6.m6.1.1.2">𝛽</ci><cn type="integer" id="A2.p2.6.m6.1.1.3.cmml" xref="A2.p2.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.6.m6.1c">\beta=1</annotation></semantics></math> for global weights.
We choose hyper-parameter controlling the interpolation between global and local model , i.e., <math id="A2.p2.7.m7.1" class="ltx_Math" alttext="\lambda=1" display="inline"><semantics id="A2.p2.7.m7.1a"><mrow id="A2.p2.7.m7.1.1" xref="A2.p2.7.m7.1.1.cmml"><mi id="A2.p2.7.m7.1.1.2" xref="A2.p2.7.m7.1.1.2.cmml">λ</mi><mo id="A2.p2.7.m7.1.1.1" xref="A2.p2.7.m7.1.1.1.cmml">=</mo><mn id="A2.p2.7.m7.1.1.3" xref="A2.p2.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.7.m7.1b"><apply id="A2.p2.7.m7.1.1.cmml" xref="A2.p2.7.m7.1.1"><eq id="A2.p2.7.m7.1.1.1.cmml" xref="A2.p2.7.m7.1.1.1"></eq><ci id="A2.p2.7.m7.1.1.2.cmml" xref="A2.p2.7.m7.1.1.2">𝜆</ci><cn type="integer" id="A2.p2.7.m7.1.1.3.cmml" xref="A2.p2.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.7.m7.1c">\lambda=1</annotation></semantics></math> and local personalized iteration as 1 for Ditto.
In APPLE, we take the hyper-parameter <math id="A2.p2.8.m8.1" class="ltx_Math" alttext="\mu=0.001" display="inline"><semantics id="A2.p2.8.m8.1a"><mrow id="A2.p2.8.m8.1.1" xref="A2.p2.8.m8.1.1.cmml"><mi id="A2.p2.8.m8.1.1.2" xref="A2.p2.8.m8.1.1.2.cmml">μ</mi><mo id="A2.p2.8.m8.1.1.1" xref="A2.p2.8.m8.1.1.1.cmml">=</mo><mn id="A2.p2.8.m8.1.1.3" xref="A2.p2.8.m8.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.8.m8.1b"><apply id="A2.p2.8.m8.1.1.cmml" xref="A2.p2.8.m8.1.1"><eq id="A2.p2.8.m8.1.1.1.cmml" xref="A2.p2.8.m8.1.1.1"></eq><ci id="A2.p2.8.m8.1.1.2.cmml" xref="A2.p2.8.m8.1.1.2">𝜇</ci><cn type="float" id="A2.p2.8.m8.1.1.3.cmml" xref="A2.p2.8.m8.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.8.m8.1c">\mu=0.001</annotation></semantics></math>, and the round number <math id="A2.p2.9.m9.1" class="ltx_Math" alttext="L=0.2" display="inline"><semantics id="A2.p2.9.m9.1a"><mrow id="A2.p2.9.m9.1.1" xref="A2.p2.9.m9.1.1.cmml"><mi id="A2.p2.9.m9.1.1.2" xref="A2.p2.9.m9.1.1.2.cmml">L</mi><mo id="A2.p2.9.m9.1.1.1" xref="A2.p2.9.m9.1.1.1.cmml">=</mo><mn id="A2.p2.9.m9.1.1.3" xref="A2.p2.9.m9.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.9.m9.1b"><apply id="A2.p2.9.m9.1.1.cmml" xref="A2.p2.9.m9.1.1"><eq id="A2.p2.9.m9.1.1.1.cmml" xref="A2.p2.9.m9.1.1.1"></eq><ci id="A2.p2.9.m9.1.1.2.cmml" xref="A2.p2.9.m9.1.1.2">𝐿</ci><cn type="float" id="A2.p2.9.m9.1.1.3.cmml" xref="A2.p2.9.m9.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.9.m9.1c">L=0.2</annotation></semantics></math> for loss scheduler.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Theoretical Analysis</h2>

<section id="A3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Convex Optimization</h3>

<figure id="A3.F11" class="ltx_figure"><img src="/html/2307.14384/assets/figs/CU_all.png" id="A3.F11.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="140" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Computational geometry of the deviations of the toughest client and the virtual client.</figcaption>
</figure>
<div id="A3.SS1.p1" class="ltx_para">
<p id="A3.SS1.p1.1" class="ltx_p">For the simplified optimization of the convex combination between the toughest deviation and the virtual deviation:</p>
<table id="A3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E12.m1.3" class="ltx_Math" alttext="\operatornamewithlimits{min}\limits_{p_{\tau}\in[0,1]}\frac{1}{2}\|p_{\tau}\Delta_{{\tau}}+(1-p_{\tau})\Delta_{{\text{vir}}}\|^{2}_{2}," display="block"><semantics id="A3.E12.m1.3a"><mrow id="A3.E12.m1.3.3.1" xref="A3.E12.m1.3.3.1.1.cmml"><mrow id="A3.E12.m1.3.3.1.1" xref="A3.E12.m1.3.3.1.1.cmml"><munder id="A3.E12.m1.3.3.1.1.2" xref="A3.E12.m1.3.3.1.1.2.cmml"><mo id="A3.E12.m1.3.3.1.1.2.2" xref="A3.E12.m1.3.3.1.1.2.2.cmml">min</mo><mrow id="A3.E12.m1.2.2.2" xref="A3.E12.m1.2.2.2.cmml"><msub id="A3.E12.m1.2.2.2.4" xref="A3.E12.m1.2.2.2.4.cmml"><mi id="A3.E12.m1.2.2.2.4.2" xref="A3.E12.m1.2.2.2.4.2.cmml">p</mi><mi id="A3.E12.m1.2.2.2.4.3" xref="A3.E12.m1.2.2.2.4.3.cmml">τ</mi></msub><mo id="A3.E12.m1.2.2.2.3" xref="A3.E12.m1.2.2.2.3.cmml">∈</mo><mrow id="A3.E12.m1.2.2.2.5.2" xref="A3.E12.m1.2.2.2.5.1.cmml"><mo stretchy="false" id="A3.E12.m1.2.2.2.5.2.1" xref="A3.E12.m1.2.2.2.5.1.cmml">[</mo><mn id="A3.E12.m1.1.1.1.1" xref="A3.E12.m1.1.1.1.1.cmml">0</mn><mo id="A3.E12.m1.2.2.2.5.2.2" xref="A3.E12.m1.2.2.2.5.1.cmml">,</mo><mn id="A3.E12.m1.2.2.2.2" xref="A3.E12.m1.2.2.2.2.cmml">1</mn><mo stretchy="false" id="A3.E12.m1.2.2.2.5.2.3" xref="A3.E12.m1.2.2.2.5.1.cmml">]</mo></mrow></mrow></munder><mrow id="A3.E12.m1.3.3.1.1.1" xref="A3.E12.m1.3.3.1.1.1.cmml"><mfrac id="A3.E12.m1.3.3.1.1.1.3" xref="A3.E12.m1.3.3.1.1.1.3.cmml"><mn id="A3.E12.m1.3.3.1.1.1.3.2" xref="A3.E12.m1.3.3.1.1.1.3.2.cmml">1</mn><mn id="A3.E12.m1.3.3.1.1.1.3.3" xref="A3.E12.m1.3.3.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A3.E12.m1.3.3.1.1.1.2" xref="A3.E12.m1.3.3.1.1.1.2.cmml">​</mo><msubsup id="A3.E12.m1.3.3.1.1.1.1" xref="A3.E12.m1.3.3.1.1.1.1.cmml"><mrow id="A3.E12.m1.3.3.1.1.1.1.1.1.1" xref="A3.E12.m1.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.2" xref="A3.E12.m1.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><msub id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.3" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml">τ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.1" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml"><mi mathvariant="normal" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml">Δ</mi><mi id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.3" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml">τ</mi></msub></mrow><mo id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.2" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mrow id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">τ</mi></msub></mrow><mo stretchy="false" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msub id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mtext id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.3a.cmml">vir</mtext></msub></mrow></mrow><mo stretchy="false" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.3" xref="A3.E12.m1.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A3.E12.m1.3.3.1.1.1.1.3" xref="A3.E12.m1.3.3.1.1.1.1.3.cmml">2</mn><mn id="A3.E12.m1.3.3.1.1.1.1.1.3" xref="A3.E12.m1.3.3.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo id="A3.E12.m1.3.3.1.2" xref="A3.E12.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E12.m1.3b"><apply id="A3.E12.m1.3.3.1.1.cmml" xref="A3.E12.m1.3.3.1"><apply id="A3.E12.m1.3.3.1.1.2.cmml" xref="A3.E12.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A3.E12.m1.3.3.1.1.2.1.cmml" xref="A3.E12.m1.3.3.1.1.2">subscript</csymbol><ci id="A3.E12.m1.3.3.1.1.2.2.cmml" xref="A3.E12.m1.3.3.1.1.2.2">min</ci><apply id="A3.E12.m1.2.2.2.cmml" xref="A3.E12.m1.2.2.2"><in id="A3.E12.m1.2.2.2.3.cmml" xref="A3.E12.m1.2.2.2.3"></in><apply id="A3.E12.m1.2.2.2.4.cmml" xref="A3.E12.m1.2.2.2.4"><csymbol cd="ambiguous" id="A3.E12.m1.2.2.2.4.1.cmml" xref="A3.E12.m1.2.2.2.4">subscript</csymbol><ci id="A3.E12.m1.2.2.2.4.2.cmml" xref="A3.E12.m1.2.2.2.4.2">𝑝</ci><ci id="A3.E12.m1.2.2.2.4.3.cmml" xref="A3.E12.m1.2.2.2.4.3">𝜏</ci></apply><interval closure="closed" id="A3.E12.m1.2.2.2.5.1.cmml" xref="A3.E12.m1.2.2.2.5.2"><cn type="integer" id="A3.E12.m1.1.1.1.1.cmml" xref="A3.E12.m1.1.1.1.1">0</cn><cn type="integer" id="A3.E12.m1.2.2.2.2.cmml" xref="A3.E12.m1.2.2.2.2">1</cn></interval></apply></apply><apply id="A3.E12.m1.3.3.1.1.1.cmml" xref="A3.E12.m1.3.3.1.1.1"><times id="A3.E12.m1.3.3.1.1.1.2.cmml" xref="A3.E12.m1.3.3.1.1.1.2"></times><apply id="A3.E12.m1.3.3.1.1.1.3.cmml" xref="A3.E12.m1.3.3.1.1.1.3"><divide id="A3.E12.m1.3.3.1.1.1.3.1.cmml" xref="A3.E12.m1.3.3.1.1.1.3"></divide><cn type="integer" id="A3.E12.m1.3.3.1.1.1.3.2.cmml" xref="A3.E12.m1.3.3.1.1.1.3.2">1</cn><cn type="integer" id="A3.E12.m1.3.3.1.1.1.3.3.cmml" xref="A3.E12.m1.3.3.1.1.1.3.3">2</cn></apply><apply id="A3.E12.m1.3.3.1.1.1.1.cmml" xref="A3.E12.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A3.E12.m1.3.3.1.1.1.1.2.cmml" xref="A3.E12.m1.3.3.1.1.1.1">subscript</csymbol><apply id="A3.E12.m1.3.3.1.1.1.1.1.cmml" xref="A3.E12.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A3.E12.m1.3.3.1.1.1.1.1.2.cmml" xref="A3.E12.m1.3.3.1.1.1.1">superscript</csymbol><apply id="A3.E12.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A3.E12.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1"><plus id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.2"></plus><apply id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3"><times id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.1"></times><apply id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.2">𝑝</ci><ci id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.3">𝜏</ci></apply><apply id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2">Δ</ci><ci id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.3">𝜏</ci></apply></apply><apply id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1"><times id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.2"></times><apply id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><minus id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝜏</ci></apply></apply><apply id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">Δ</ci><ci id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.3">vir</mtext></ci></apply></apply></apply></apply><cn type="integer" id="A3.E12.m1.3.3.1.1.1.1.1.3.cmml" xref="A3.E12.m1.3.3.1.1.1.1.1.3">2</cn></apply><cn type="integer" id="A3.E12.m1.3.3.1.1.1.1.3.cmml" xref="A3.E12.m1.3.3.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E12.m1.3c">\operatornamewithlimits{min}\limits_{p_{\tau}\in[0,1]}\frac{1}{2}\|p_{\tau}\Delta_{{\tau}}+(1-p_{\tau})\Delta_{{\text{vir}}}\|^{2}_{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.p1.2" class="ltx_p">we rewrite it as:</p>
<table id="A3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E13.m1.3" class="ltx_Math" alttext="\min_{p_{\tau}\in[0,1]}J=\frac{1}{2}\left\|p_{\tau}\left(\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right)+\Delta_{{\text{vir}}}\right\|_{2}^{2}." display="block"><semantics id="A3.E13.m1.3a"><mrow id="A3.E13.m1.3.3.1" xref="A3.E13.m1.3.3.1.1.cmml"><mrow id="A3.E13.m1.3.3.1.1" xref="A3.E13.m1.3.3.1.1.cmml"><mrow id="A3.E13.m1.3.3.1.1.3" xref="A3.E13.m1.3.3.1.1.3.cmml"><munder id="A3.E13.m1.3.3.1.1.3.1" xref="A3.E13.m1.3.3.1.1.3.1.cmml"><mi id="A3.E13.m1.3.3.1.1.3.1.2" xref="A3.E13.m1.3.3.1.1.3.1.2.cmml">min</mi><mrow id="A3.E13.m1.2.2.2" xref="A3.E13.m1.2.2.2.cmml"><msub id="A3.E13.m1.2.2.2.4" xref="A3.E13.m1.2.2.2.4.cmml"><mi id="A3.E13.m1.2.2.2.4.2" xref="A3.E13.m1.2.2.2.4.2.cmml">p</mi><mi id="A3.E13.m1.2.2.2.4.3" xref="A3.E13.m1.2.2.2.4.3.cmml">τ</mi></msub><mo id="A3.E13.m1.2.2.2.3" xref="A3.E13.m1.2.2.2.3.cmml">∈</mo><mrow id="A3.E13.m1.2.2.2.5.2" xref="A3.E13.m1.2.2.2.5.1.cmml"><mo stretchy="false" id="A3.E13.m1.2.2.2.5.2.1" xref="A3.E13.m1.2.2.2.5.1.cmml">[</mo><mn id="A3.E13.m1.1.1.1.1" xref="A3.E13.m1.1.1.1.1.cmml">0</mn><mo id="A3.E13.m1.2.2.2.5.2.2" xref="A3.E13.m1.2.2.2.5.1.cmml">,</mo><mn id="A3.E13.m1.2.2.2.2" xref="A3.E13.m1.2.2.2.2.cmml">1</mn><mo stretchy="false" id="A3.E13.m1.2.2.2.5.2.3" xref="A3.E13.m1.2.2.2.5.1.cmml">]</mo></mrow></mrow></munder><mo lspace="0.167em" id="A3.E13.m1.3.3.1.1.3a" xref="A3.E13.m1.3.3.1.1.3.cmml">⁡</mo><mi id="A3.E13.m1.3.3.1.1.3.2" xref="A3.E13.m1.3.3.1.1.3.2.cmml">J</mi></mrow><mo id="A3.E13.m1.3.3.1.1.2" xref="A3.E13.m1.3.3.1.1.2.cmml">=</mo><mrow id="A3.E13.m1.3.3.1.1.1" xref="A3.E13.m1.3.3.1.1.1.cmml"><mfrac id="A3.E13.m1.3.3.1.1.1.3" xref="A3.E13.m1.3.3.1.1.1.3.cmml"><mn id="A3.E13.m1.3.3.1.1.1.3.2" xref="A3.E13.m1.3.3.1.1.1.3.2.cmml">1</mn><mn id="A3.E13.m1.3.3.1.1.1.3.3" xref="A3.E13.m1.3.3.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A3.E13.m1.3.3.1.1.1.2" xref="A3.E13.m1.3.3.1.1.1.2.cmml">​</mo><msubsup id="A3.E13.m1.3.3.1.1.1.1" xref="A3.E13.m1.3.3.1.1.1.1.cmml"><mrow id="A3.E13.m1.3.3.1.1.1.1.1.1.1" xref="A3.E13.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="A3.E13.m1.3.3.1.1.1.1.1.1.1.2" xref="A3.E13.m1.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml">τ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">Δ</mi><mi id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mtext id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml">vir</mtext></msub></mrow><mo id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.2" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">+</mo><msub id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mtext id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.3a.cmml">vir</mtext></msub></mrow><mo id="A3.E13.m1.3.3.1.1.1.1.1.1.1.3" xref="A3.E13.m1.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A3.E13.m1.3.3.1.1.1.1.1.3" xref="A3.E13.m1.3.3.1.1.1.1.1.3.cmml">2</mn><mn id="A3.E13.m1.3.3.1.1.1.1.3" xref="A3.E13.m1.3.3.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo lspace="0em" id="A3.E13.m1.3.3.1.2" xref="A3.E13.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E13.m1.3b"><apply id="A3.E13.m1.3.3.1.1.cmml" xref="A3.E13.m1.3.3.1"><eq id="A3.E13.m1.3.3.1.1.2.cmml" xref="A3.E13.m1.3.3.1.1.2"></eq><apply id="A3.E13.m1.3.3.1.1.3.cmml" xref="A3.E13.m1.3.3.1.1.3"><apply id="A3.E13.m1.3.3.1.1.3.1.cmml" xref="A3.E13.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="A3.E13.m1.3.3.1.1.3.1.1.cmml" xref="A3.E13.m1.3.3.1.1.3.1">subscript</csymbol><min id="A3.E13.m1.3.3.1.1.3.1.2.cmml" xref="A3.E13.m1.3.3.1.1.3.1.2"></min><apply id="A3.E13.m1.2.2.2.cmml" xref="A3.E13.m1.2.2.2"><in id="A3.E13.m1.2.2.2.3.cmml" xref="A3.E13.m1.2.2.2.3"></in><apply id="A3.E13.m1.2.2.2.4.cmml" xref="A3.E13.m1.2.2.2.4"><csymbol cd="ambiguous" id="A3.E13.m1.2.2.2.4.1.cmml" xref="A3.E13.m1.2.2.2.4">subscript</csymbol><ci id="A3.E13.m1.2.2.2.4.2.cmml" xref="A3.E13.m1.2.2.2.4.2">𝑝</ci><ci id="A3.E13.m1.2.2.2.4.3.cmml" xref="A3.E13.m1.2.2.2.4.3">𝜏</ci></apply><interval closure="closed" id="A3.E13.m1.2.2.2.5.1.cmml" xref="A3.E13.m1.2.2.2.5.2"><cn type="integer" id="A3.E13.m1.1.1.1.1.cmml" xref="A3.E13.m1.1.1.1.1">0</cn><cn type="integer" id="A3.E13.m1.2.2.2.2.cmml" xref="A3.E13.m1.2.2.2.2">1</cn></interval></apply></apply><ci id="A3.E13.m1.3.3.1.1.3.2.cmml" xref="A3.E13.m1.3.3.1.1.3.2">𝐽</ci></apply><apply id="A3.E13.m1.3.3.1.1.1.cmml" xref="A3.E13.m1.3.3.1.1.1"><times id="A3.E13.m1.3.3.1.1.1.2.cmml" xref="A3.E13.m1.3.3.1.1.1.2"></times><apply id="A3.E13.m1.3.3.1.1.1.3.cmml" xref="A3.E13.m1.3.3.1.1.1.3"><divide id="A3.E13.m1.3.3.1.1.1.3.1.cmml" xref="A3.E13.m1.3.3.1.1.1.3"></divide><cn type="integer" id="A3.E13.m1.3.3.1.1.1.3.2.cmml" xref="A3.E13.m1.3.3.1.1.1.3.2">1</cn><cn type="integer" id="A3.E13.m1.3.3.1.1.1.3.3.cmml" xref="A3.E13.m1.3.3.1.1.1.3.3">2</cn></apply><apply id="A3.E13.m1.3.3.1.1.1.1.cmml" xref="A3.E13.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A3.E13.m1.3.3.1.1.1.1.2.cmml" xref="A3.E13.m1.3.3.1.1.1.1">superscript</csymbol><apply id="A3.E13.m1.3.3.1.1.1.1.1.cmml" xref="A3.E13.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A3.E13.m1.3.3.1.1.1.1.1.2.cmml" xref="A3.E13.m1.3.3.1.1.1.1">subscript</csymbol><apply id="A3.E13.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A3.E13.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1"><plus id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.2"></plus><apply id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1"><times id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.2"></times><apply id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.3.3">𝜏</ci></apply><apply id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><minus id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2">Δ</ci><ci id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><apply id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2">Δ</ci><ci id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3">vir</mtext></ci></apply></apply></apply><apply id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2">Δ</ci><ci id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.3a.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.1.1.1.3.3">vir</mtext></ci></apply></apply></apply><cn type="integer" id="A3.E13.m1.3.3.1.1.1.1.1.3.cmml" xref="A3.E13.m1.3.3.1.1.1.1.1.3">2</cn></apply><cn type="integer" id="A3.E13.m1.3.3.1.1.1.1.3.cmml" xref="A3.E13.m1.3.3.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E13.m1.3c">\min_{p_{\tau}\in[0,1]}J=\frac{1}{2}\left\|p_{\tau}\left(\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right)+\Delta_{{\text{vir}}}\right\|_{2}^{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div id="A3.SS1.p2" class="ltx_para">
<p id="A3.SS1.p2.1" class="ltx_p">Next, we can analyze the solution according to its geometry, i.e., analyzing the directions among the toughest deviation, the virtual deviation, and their difference.
As the geometry suggests in Fig. <a href="#A3.F11" title="Figure 11 ‣ C.1 Convex Optimization ‣ Appendix C Theoretical Analysis ‣ HyperFed: Hyperbolic Prototypes Exploration with Consistent Aggregation for Non-IID Data in Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>, the solution of finding the minimized norm is either a perpendicular vector or an edge case.
Thus we obtain the three cases as bellow:</p>
</div>
<section id="A3.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Case 1</h4>

<div id="A3.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="A3.SS1.SSS0.Px1.p1.2" class="ltx_p">When it has the condition as:</p>
<table id="A3.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E14.m1.2" class="ltx_Math" alttext="\left\{\begin{array}[]{l}\left(\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right)^{\top}\cdot\Delta_{{\tau}}\ &gt;0\\
\left(\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right)^{\top}\cdot\Delta_{{\text{vir}}}&lt;0,\end{array}\right." display="block"><semantics id="A3.E14.m1.2a"><mrow id="A3.E14.m1.2.3.2" xref="A3.E14.m1.2.3.1.cmml"><mo id="A3.E14.m1.2.3.2.1" xref="A3.E14.m1.2.3.1.1.cmml">{</mo><mtable displaystyle="true" rowspacing="0pt" id="A3.E14.m1.2.2" xref="A3.E14.m1.2.2.cmml"><mtr id="A3.E14.m1.2.2a" xref="A3.E14.m1.2.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E14.m1.2.2b" xref="A3.E14.m1.2.2.cmml"><mrow id="A3.E14.m1.1.1.1.1.1" xref="A3.E14.m1.1.1.1.1.1.cmml"><mrow id="A3.E14.m1.1.1.1.1.1.1" xref="A3.E14.m1.1.1.1.1.1.1.cmml"><msup id="A3.E14.m1.1.1.1.1.1.1.1" xref="A3.E14.m1.1.1.1.1.1.1.1.cmml"><mrow id="A3.E14.m1.1.1.1.1.1.1.1.1.1" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E14.m1.1.1.1.1.1.1.1.1.1.2" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">Δ</mi><mi id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mtext id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml">vir</mtext></msub></mrow><mo id="A3.E14.m1.1.1.1.1.1.1.1.1.1.3" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.E14.m1.1.1.1.1.1.1.1.3" xref="A3.E14.m1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo lspace="0.222em" rspace="0.222em" id="A3.E14.m1.1.1.1.1.1.1.2" xref="A3.E14.m1.1.1.1.1.1.1.2.cmml">⋅</mo><msub id="A3.E14.m1.1.1.1.1.1.1.3" xref="A3.E14.m1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E14.m1.1.1.1.1.1.1.3.2" xref="A3.E14.m1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mi id="A3.E14.m1.1.1.1.1.1.1.3.3" xref="A3.E14.m1.1.1.1.1.1.1.3.3.cmml">τ</mi></msub></mrow><mo id="A3.E14.m1.1.1.1.1.1.2" xref="A3.E14.m1.1.1.1.1.1.2.cmml">&gt;</mo><mn id="A3.E14.m1.1.1.1.1.1.3" xref="A3.E14.m1.1.1.1.1.1.3.cmml">0</mn></mrow></mtd></mtr><mtr id="A3.E14.m1.2.2c" xref="A3.E14.m1.2.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="A3.E14.m1.2.2d" xref="A3.E14.m1.2.2.cmml"><mrow id="A3.E14.m1.2.2.2.1.1.1" xref="A3.E14.m1.2.2.2.1.1.1.1.cmml"><mrow id="A3.E14.m1.2.2.2.1.1.1.1" xref="A3.E14.m1.2.2.2.1.1.1.1.cmml"><mrow id="A3.E14.m1.2.2.2.1.1.1.1.1" xref="A3.E14.m1.2.2.2.1.1.1.1.1.cmml"><msup id="A3.E14.m1.2.2.2.1.1.1.1.1.1" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.cmml"><mrow id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.2" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">Δ</mi><mi id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mtext id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3a.cmml">vir</mtext></msub></mrow><mo id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.3" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.E14.m1.2.2.2.1.1.1.1.1.1.3" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo lspace="0.222em" rspace="0.222em" id="A3.E14.m1.2.2.2.1.1.1.1.1.2" xref="A3.E14.m1.2.2.2.1.1.1.1.1.2.cmml">⋅</mo><msub id="A3.E14.m1.2.2.2.1.1.1.1.1.3" xref="A3.E14.m1.2.2.2.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E14.m1.2.2.2.1.1.1.1.1.3.2" xref="A3.E14.m1.2.2.2.1.1.1.1.1.3.2.cmml">Δ</mi><mtext id="A3.E14.m1.2.2.2.1.1.1.1.1.3.3" xref="A3.E14.m1.2.2.2.1.1.1.1.1.3.3a.cmml">vir</mtext></msub></mrow><mo id="A3.E14.m1.2.2.2.1.1.1.1.2" xref="A3.E14.m1.2.2.2.1.1.1.1.2.cmml">&lt;</mo><mn id="A3.E14.m1.2.2.2.1.1.1.1.3" xref="A3.E14.m1.2.2.2.1.1.1.1.3.cmml">0</mn></mrow><mo id="A3.E14.m1.2.2.2.1.1.1.2" xref="A3.E14.m1.2.2.2.1.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><mi id="A3.E14.m1.2.3.2.2" xref="A3.E14.m1.2.3.1.1.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A3.E14.m1.2b"><apply id="A3.E14.m1.2.3.1.cmml" xref="A3.E14.m1.2.3.2"><csymbol cd="latexml" id="A3.E14.m1.2.3.1.1.cmml" xref="A3.E14.m1.2.3.2.1">cases</csymbol><matrix id="A3.E14.m1.2.2.cmml" xref="A3.E14.m1.2.2"><matrixrow id="A3.E14.m1.2.2a.cmml" xref="A3.E14.m1.2.2"><apply id="A3.E14.m1.1.1.1.1.1.cmml" xref="A3.E14.m1.1.1.1.1.1"><gt id="A3.E14.m1.1.1.1.1.1.2.cmml" xref="A3.E14.m1.1.1.1.1.1.2"></gt><apply id="A3.E14.m1.1.1.1.1.1.1.cmml" xref="A3.E14.m1.1.1.1.1.1.1"><ci id="A3.E14.m1.1.1.1.1.1.1.2.cmml" xref="A3.E14.m1.1.1.1.1.1.1.2">⋅</ci><apply id="A3.E14.m1.1.1.1.1.1.1.1.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E14.m1.1.1.1.1.1.1.1.2.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1"><minus id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2.2">Δ</ci><ci id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><apply id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.2">Δ</ci><ci id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.1.1.1.3.3">vir</mtext></ci></apply></apply><csymbol cd="latexml" id="A3.E14.m1.1.1.1.1.1.1.1.3.cmml" xref="A3.E14.m1.1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="A3.E14.m1.1.1.1.1.1.1.3.cmml" xref="A3.E14.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E14.m1.1.1.1.1.1.1.3.1.cmml" xref="A3.E14.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E14.m1.1.1.1.1.1.1.3.2.cmml" xref="A3.E14.m1.1.1.1.1.1.1.3.2">Δ</ci><ci id="A3.E14.m1.1.1.1.1.1.1.3.3.cmml" xref="A3.E14.m1.1.1.1.1.1.1.3.3">𝜏</ci></apply></apply><cn type="integer" id="A3.E14.m1.1.1.1.1.1.3.cmml" xref="A3.E14.m1.1.1.1.1.1.3">0</cn></apply></matrixrow><matrixrow id="A3.E14.m1.2.2b.cmml" xref="A3.E14.m1.2.2"><apply id="A3.E14.m1.2.2.2.1.1.1.1.cmml" xref="A3.E14.m1.2.2.2.1.1.1"><lt id="A3.E14.m1.2.2.2.1.1.1.1.2.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.2"></lt><apply id="A3.E14.m1.2.2.2.1.1.1.1.1.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1"><ci id="A3.E14.m1.2.2.2.1.1.1.1.1.2.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.2">⋅</ci><apply id="A3.E14.m1.2.2.2.1.1.1.1.1.1.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E14.m1.2.2.2.1.1.1.1.1.1.2.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1"><minus id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.2">Δ</ci><ci id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><apply id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.2">Δ</ci><ci id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3">vir</mtext></ci></apply></apply><csymbol cd="latexml" id="A3.E14.m1.2.2.2.1.1.1.1.1.1.3.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.1.3">top</csymbol></apply><apply id="A3.E14.m1.2.2.2.1.1.1.1.1.3.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E14.m1.2.2.2.1.1.1.1.1.3.1.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E14.m1.2.2.2.1.1.1.1.1.3.2.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.3.2">Δ</ci><ci id="A3.E14.m1.2.2.2.1.1.1.1.1.3.3a.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.3.3"><mtext mathsize="70%" id="A3.E14.m1.2.2.2.1.1.1.1.1.3.3.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.1.3.3">vir</mtext></ci></apply></apply><cn type="integer" id="A3.E14.m1.2.2.2.1.1.1.1.3.cmml" xref="A3.E14.m1.2.2.2.1.1.1.1.3">0</cn></apply></matrixrow></matrix></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E14.m1.2c">\left\{\begin{array}[]{l}\left(\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right)^{\top}\cdot\Delta_{{\tau}}\ &gt;0\\
\left(\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right)^{\top}\cdot\Delta_{{\text{vir}}}&lt;0,\end{array}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.SSS0.Px1.p1.1" class="ltx_p">Then we should take the differentiation <math id="A3.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\frac{\partial J}{\partial p_{\tau}}=0" display="inline"><semantics id="A3.SS1.SSS0.Px1.p1.1.m1.1a"><mrow id="A3.SS1.SSS0.Px1.p1.1.m1.1.1" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mfrac id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml"><mrow id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.cmml"><mo rspace="0em" id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.1" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.1.cmml">∂</mo><mi id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.2" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.2.cmml">J</mi></mrow><mrow id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.cmml"><mo rspace="0em" id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.1" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.1.cmml">∂</mo><msub id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2.cmml"><mi id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2.2" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2.2.cmml">p</mi><mi id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2.3" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2.3.cmml">τ</mi></msub></mrow></mfrac><mo id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.1" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1"><eq id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.1"></eq><apply id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2"><divide id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.1.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2"></divide><apply id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2"><partialdiff id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.1.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.1"></partialdiff><ci id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.2.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.2">𝐽</ci></apply><apply id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3"><partialdiff id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.1.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.1"></partialdiff><apply id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2.1.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2">subscript</csymbol><ci id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2.2.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2.2">𝑝</ci><ci id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2.3.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.2.3.2.3">𝜏</ci></apply></apply></apply><cn type="integer" id="A3.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="A3.SS1.SSS0.Px1.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS0.Px1.p1.1.m1.1c">\frac{\partial J}{\partial p_{\tau}}=0</annotation></semantics></math> and get:</p>
<table id="A3.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E15.m1.1" class="ltx_Math" alttext="\left(\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right)^{\top}\left(p_{\tau}\Delta_{{\tau}}+(1-p_{\tau})\Delta_{{\text{vir}}}\right)=0." display="block"><semantics id="A3.E15.m1.1a"><mrow id="A3.E15.m1.1.1.1" xref="A3.E15.m1.1.1.1.1.cmml"><mrow id="A3.E15.m1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.cmml"><mrow id="A3.E15.m1.1.1.1.1.2" xref="A3.E15.m1.1.1.1.1.2.cmml"><msup id="A3.E15.m1.1.1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.1.1.cmml"><mrow id="A3.E15.m1.1.1.1.1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E15.m1.1.1.1.1.1.1.1.1.2" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E15.m1.1.1.1.1.1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E15.m1.1.1.1.1.1.1.1.1.1.2" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="A3.E15.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">Δ</mi><mi id="A3.E15.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A3.E15.m1.1.1.1.1.1.1.1.1.1.3" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mtext id="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.3a.cmml">vir</mtext></msub></mrow><mo id="A3.E15.m1.1.1.1.1.1.1.1.1.3" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.E15.m1.1.1.1.1.1.1.3" xref="A3.E15.m1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="A3.E15.m1.1.1.1.1.2.3" xref="A3.E15.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="A3.E15.m1.1.1.1.1.2.2.1" xref="A3.E15.m1.1.1.1.1.2.2.1.1.cmml"><mo id="A3.E15.m1.1.1.1.1.2.2.1.2" xref="A3.E15.m1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="A3.E15.m1.1.1.1.1.2.2.1.1" xref="A3.E15.m1.1.1.1.1.2.2.1.1.cmml"><mrow id="A3.E15.m1.1.1.1.1.2.2.1.1.3" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.cmml"><msub id="A3.E15.m1.1.1.1.1.2.2.1.1.3.2" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.2.cmml"><mi id="A3.E15.m1.1.1.1.1.2.2.1.1.3.2.2" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.2.2.cmml">p</mi><mi id="A3.E15.m1.1.1.1.1.2.2.1.1.3.2.3" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.2.3.cmml">τ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E15.m1.1.1.1.1.2.2.1.1.3.1" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.1.cmml">​</mo><msub id="A3.E15.m1.1.1.1.1.2.2.1.1.3.3" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.3.cmml"><mi mathvariant="normal" id="A3.E15.m1.1.1.1.1.2.2.1.1.3.3.2" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.3.2.cmml">Δ</mi><mi id="A3.E15.m1.1.1.1.1.2.2.1.1.3.3.3" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.3.3.cmml">τ</mi></msub></mrow><mo id="A3.E15.m1.1.1.1.1.2.2.1.1.2" xref="A3.E15.m1.1.1.1.1.2.2.1.1.2.cmml">+</mo><mrow id="A3.E15.m1.1.1.1.1.2.2.1.1.1" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.cmml"><mrow id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.2" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><mn id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.2" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml">1</mn><mo id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.1" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml">−</mo><msub id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml"><mi id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.3" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.3.cmml">τ</mi></msub></mrow><mo stretchy="false" id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.3" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E15.m1.1.1.1.1.2.2.1.1.1.2" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.2.cmml">​</mo><msub id="A3.E15.m1.1.1.1.1.2.2.1.1.1.3" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.2" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.2.cmml">Δ</mi><mtext id="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.3" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.3a.cmml">vir</mtext></msub></mrow></mrow><mo id="A3.E15.m1.1.1.1.1.2.2.1.3" xref="A3.E15.m1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E15.m1.1.1.1.1.3" xref="A3.E15.m1.1.1.1.1.3.cmml">=</mo><mn id="A3.E15.m1.1.1.1.1.4" xref="A3.E15.m1.1.1.1.1.4.cmml">0</mn></mrow><mo lspace="0em" id="A3.E15.m1.1.1.1.2" xref="A3.E15.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E15.m1.1b"><apply id="A3.E15.m1.1.1.1.1.cmml" xref="A3.E15.m1.1.1.1"><eq id="A3.E15.m1.1.1.1.1.3.cmml" xref="A3.E15.m1.1.1.1.1.3"></eq><apply id="A3.E15.m1.1.1.1.1.2.cmml" xref="A3.E15.m1.1.1.1.1.2"><times id="A3.E15.m1.1.1.1.1.2.3.cmml" xref="A3.E15.m1.1.1.1.1.2.3"></times><apply id="A3.E15.m1.1.1.1.1.1.1.cmml" xref="A3.E15.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.1.1.2.cmml" xref="A3.E15.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E15.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1"><minus id="A3.E15.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A3.E15.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.2.2">Δ</ci><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><apply id="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.2">Δ</ci><ci id="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E15.m1.1.1.1.1.1.1.1.1.1.3.3">vir</mtext></ci></apply></apply><csymbol cd="latexml" id="A3.E15.m1.1.1.1.1.1.1.3.cmml" xref="A3.E15.m1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="A3.E15.m1.1.1.1.1.2.2.1.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1"><plus id="A3.E15.m1.1.1.1.1.2.2.1.1.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.2"></plus><apply id="A3.E15.m1.1.1.1.1.2.2.1.1.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3"><times id="A3.E15.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.1"></times><apply id="A3.E15.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.2.2.1.1.3.2.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.2">subscript</csymbol><ci id="A3.E15.m1.1.1.1.1.2.2.1.1.3.2.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.2.2">𝑝</ci><ci id="A3.E15.m1.1.1.1.1.2.2.1.1.3.2.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.2.3">𝜏</ci></apply><apply id="A3.E15.m1.1.1.1.1.2.2.1.1.3.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.2.2.1.1.3.3.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.3">subscript</csymbol><ci id="A3.E15.m1.1.1.1.1.2.2.1.1.3.3.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.3.2">Δ</ci><ci id="A3.E15.m1.1.1.1.1.2.2.1.1.3.3.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.3.3.3">𝜏</ci></apply></apply><apply id="A3.E15.m1.1.1.1.1.2.2.1.1.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1"><times id="A3.E15.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.2"></times><apply id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1"><minus id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.1"></minus><cn type="integer" id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.2">1</cn><apply id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.2">𝑝</ci><ci id="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.3">𝜏</ci></apply></apply><apply id="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.2">Δ</ci><ci id="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.3a.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.3"><mtext mathsize="70%" id="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="A3.E15.m1.1.1.1.1.2.2.1.1.1.3.3">vir</mtext></ci></apply></apply></apply></apply><cn type="integer" id="A3.E15.m1.1.1.1.1.4.cmml" xref="A3.E15.m1.1.1.1.1.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E15.m1.1c">\left(\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right)^{\top}\left(p_{\tau}\Delta_{{\tau}}+(1-p_{\tau})\Delta_{{\text{vir}}}\right)=0.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.SSS0.Px1.p1.3" class="ltx_p">Hence the solution is given:</p>
<table id="A3.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E16.m1.27" class="ltx_math_unparsed" alttext="\begin{gathered}p_{\tau}^{*}=\frac{\left(\Delta_{{\text{vir}}}-\Delta_{{\tau}}\right)^{\top}\cdot\Delta_{{\text{vir}}}}{\left\|\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right\|_{2}^{2}}\quad\Leftrightarrow\quad\\
\Delta_{\bm{\theta}}^{t+1}=(1-p_{\tau}^{*})\Delta_{{\text{vir}}}+{p_{\tau}^{*}}\Delta_{\tau}.\end{gathered}" display="block"><semantics id="A3.E16.m1.27a"><mtable displaystyle="true" rowspacing="0pt" id="A3.E16.m1.27.27.1"><mtr id="A3.E16.m1.27.27.1a"><mtd id="A3.E16.m1.27.27.1b"><mrow id="A3.E16.m1.6.6.6.6.6"><msubsup id="A3.E16.m1.6.6.6.6.6.7"><mi id="A3.E16.m1.1.1.1.1.1.1">p</mi><mi id="A3.E16.m1.2.2.2.2.2.2.1">τ</mi><mo id="A3.E16.m1.3.3.3.3.3.3.1">∗</mo></msubsup><mo id="A3.E16.m1.4.4.4.4.4.4">=</mo><mrow id="A3.E16.m1.6.6.6.6.6.8"><mfrac id="A3.E16.m1.5.5.5.5.5.5"><mrow id="A3.E16.m1.5.5.5.5.5.5.1"><msup id="A3.E16.m1.5.5.5.5.5.5.1.1"><mrow id="A3.E16.m1.5.5.5.5.5.5.1.1.1.1"><mo id="A3.E16.m1.5.5.5.5.5.5.1.1.1.1.2">(</mo><mrow id="A3.E16.m1.5.5.5.5.5.5.1.1.1.1.1"><msub id="A3.E16.m1.5.5.5.5.5.5.1.1.1.1.1.2"><mi mathvariant="normal" id="A3.E16.m1.5.5.5.5.5.5.1.1.1.1.1.2.2">Δ</mi><mtext id="A3.E16.m1.5.5.5.5.5.5.1.1.1.1.1.2.3">vir</mtext></msub><mo id="A3.E16.m1.5.5.5.5.5.5.1.1.1.1.1.1">−</mo><msub id="A3.E16.m1.5.5.5.5.5.5.1.1.1.1.1.3"><mi mathvariant="normal" id="A3.E16.m1.5.5.5.5.5.5.1.1.1.1.1.3.2">Δ</mi><mi id="A3.E16.m1.5.5.5.5.5.5.1.1.1.1.1.3.3">τ</mi></msub></mrow><mo id="A3.E16.m1.5.5.5.5.5.5.1.1.1.1.3">)</mo></mrow><mo id="A3.E16.m1.5.5.5.5.5.5.1.1.3">⊤</mo></msup><mo lspace="0.222em" rspace="0.222em" id="A3.E16.m1.5.5.5.5.5.5.1.2">⋅</mo><msub id="A3.E16.m1.5.5.5.5.5.5.1.3"><mi mathvariant="normal" id="A3.E16.m1.5.5.5.5.5.5.1.3.2">Δ</mi><mtext id="A3.E16.m1.5.5.5.5.5.5.1.3.3">vir</mtext></msub></mrow><msubsup id="A3.E16.m1.5.5.5.5.5.5.2"><mrow id="A3.E16.m1.5.5.5.5.5.5.2.1.1.1"><mo id="A3.E16.m1.5.5.5.5.5.5.2.1.1.1.2">‖</mo><mrow id="A3.E16.m1.5.5.5.5.5.5.2.1.1.1.1"><msub id="A3.E16.m1.5.5.5.5.5.5.2.1.1.1.1.2"><mi mathvariant="normal" id="A3.E16.m1.5.5.5.5.5.5.2.1.1.1.1.2.2">Δ</mi><mi id="A3.E16.m1.5.5.5.5.5.5.2.1.1.1.1.2.3">τ</mi></msub><mo id="A3.E16.m1.5.5.5.5.5.5.2.1.1.1.1.1">−</mo><msub id="A3.E16.m1.5.5.5.5.5.5.2.1.1.1.1.3"><mi mathvariant="normal" id="A3.E16.m1.5.5.5.5.5.5.2.1.1.1.1.3.2">Δ</mi><mtext id="A3.E16.m1.5.5.5.5.5.5.2.1.1.1.1.3.3">vir</mtext></msub></mrow><mo id="A3.E16.m1.5.5.5.5.5.5.2.1.1.1.3">‖</mo></mrow><mn id="A3.E16.m1.5.5.5.5.5.5.2.1.3">2</mn><mn id="A3.E16.m1.5.5.5.5.5.5.2.3">2</mn></msubsup></mfrac><mspace width="1em" id="A3.E16.m1.6.6.6.6.6.8.1"></mspace><mo stretchy="false" id="A3.E16.m1.6.6.6.6.6.6">⇔</mo></mrow></mrow></mtd></mtr><mtr id="A3.E16.m1.27.27.1c"><mtd id="A3.E16.m1.27.27.1d"><mrow id="A3.E16.m1.27.27.1.27.21.21.21"><mrow id="A3.E16.m1.27.27.1.27.21.21.21.1"><msubsup id="A3.E16.m1.27.27.1.27.21.21.21.1.2"><mi mathvariant="normal" id="A3.E16.m1.7.7.7.1.1.1">Δ</mi><mi id="A3.E16.m1.8.8.8.2.2.2.1">𝜽</mi><mrow id="A3.E16.m1.9.9.9.3.3.3.1"><mi id="A3.E16.m1.9.9.9.3.3.3.1.2">t</mi><mo id="A3.E16.m1.9.9.9.3.3.3.1.1">+</mo><mn id="A3.E16.m1.9.9.9.3.3.3.1.3">1</mn></mrow></msubsup><mo id="A3.E16.m1.10.10.10.4.4.4">=</mo><mrow id="A3.E16.m1.27.27.1.27.21.21.21.1.1"><mrow id="A3.E16.m1.27.27.1.27.21.21.21.1.1.1"><mrow id="A3.E16.m1.27.27.1.27.21.21.21.1.1.1.1.1"><mo stretchy="false" id="A3.E16.m1.11.11.11.5.5.5">(</mo><mrow id="A3.E16.m1.27.27.1.27.21.21.21.1.1.1.1.1.1"><mn id="A3.E16.m1.12.12.12.6.6.6">1</mn><mo id="A3.E16.m1.13.13.13.7.7.7">−</mo><msubsup id="A3.E16.m1.27.27.1.27.21.21.21.1.1.1.1.1.1.1"><mi id="A3.E16.m1.14.14.14.8.8.8">p</mi><mi id="A3.E16.m1.15.15.15.9.9.9.1">τ</mi><mo id="A3.E16.m1.16.16.16.10.10.10.1">∗</mo></msubsup></mrow><mo stretchy="false" id="A3.E16.m1.17.17.17.11.11.11">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.E16.m1.27.27.1.27.21.21.21.1.1.1.2">​</mo><msub id="A3.E16.m1.27.27.1.27.21.21.21.1.1.1.3"><mi mathvariant="normal" id="A3.E16.m1.18.18.18.12.12.12">Δ</mi><mtext id="A3.E16.m1.19.19.19.13.13.13.1">vir</mtext></msub></mrow><mo id="A3.E16.m1.20.20.20.14.14.14">+</mo><mrow id="A3.E16.m1.27.27.1.27.21.21.21.1.1.2"><msubsup id="A3.E16.m1.27.27.1.27.21.21.21.1.1.2.2"><mi id="A3.E16.m1.21.21.21.15.15.15">p</mi><mi id="A3.E16.m1.22.22.22.16.16.16.1">τ</mi><mo id="A3.E16.m1.23.23.23.17.17.17.1">∗</mo></msubsup><mo lspace="0em" rspace="0em" id="A3.E16.m1.27.27.1.27.21.21.21.1.1.2.1">​</mo><msub id="A3.E16.m1.27.27.1.27.21.21.21.1.1.2.3"><mi mathvariant="normal" id="A3.E16.m1.24.24.24.18.18.18">Δ</mi><mi id="A3.E16.m1.25.25.25.19.19.19.1">τ</mi></msub></mrow></mrow></mrow><mo lspace="0em" id="A3.E16.m1.26.26.26.20.20.20">.</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="A3.E16.m1.27b">\begin{gathered}p_{\tau}^{*}=\frac{\left(\Delta_{{\text{vir}}}-\Delta_{{\tau}}\right)^{\top}\cdot\Delta_{{\text{vir}}}}{\left\|\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right\|_{2}^{2}}\quad\Leftrightarrow\quad\\
\Delta_{\bm{\theta}}^{t+1}=(1-p_{\tau}^{*})\Delta_{{\text{vir}}}+{p_{\tau}^{*}}\Delta_{\tau}.\end{gathered}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.SSS0.Px1.p1.4" class="ltx_p">In this scenario, we find the perpendicular vector of the difference between the virtual deviation and the toughest deviation to obtain the minimum-norm.</p>
</div>
</section>
<section id="A3.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Case 2</h4>

<div id="A3.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="A3.SS1.SSS0.Px2.p1.3" class="ltx_p">When it has the condition as:</p>
<table id="A3.E17" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E17.m1.1" class="ltx_Math" alttext="\left(\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right)^{\top}\cdot\Delta_{{\text{vir}}}\geq 0," display="block"><semantics id="A3.E17.m1.1a"><mrow id="A3.E17.m1.1.1.1" xref="A3.E17.m1.1.1.1.1.cmml"><mrow id="A3.E17.m1.1.1.1.1" xref="A3.E17.m1.1.1.1.1.cmml"><mrow id="A3.E17.m1.1.1.1.1.1" xref="A3.E17.m1.1.1.1.1.1.cmml"><msup id="A3.E17.m1.1.1.1.1.1.1" xref="A3.E17.m1.1.1.1.1.1.1.cmml"><mrow id="A3.E17.m1.1.1.1.1.1.1.1.1" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E17.m1.1.1.1.1.1.1.1.1.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E17.m1.1.1.1.1.1.1.1.1.1" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E17.m1.1.1.1.1.1.1.1.1.1.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="A3.E17.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">Δ</mi><mi id="A3.E17.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo id="A3.E17.m1.1.1.1.1.1.1.1.1.1.1" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A3.E17.m1.1.1.1.1.1.1.1.1.1.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mtext id="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.3a.cmml">vir</mtext></msub></mrow><mo id="A3.E17.m1.1.1.1.1.1.1.1.1.3" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.E17.m1.1.1.1.1.1.1.3" xref="A3.E17.m1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo lspace="0.222em" rspace="0.222em" id="A3.E17.m1.1.1.1.1.1.2" xref="A3.E17.m1.1.1.1.1.1.2.cmml">⋅</mo><msub id="A3.E17.m1.1.1.1.1.1.3" xref="A3.E17.m1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E17.m1.1.1.1.1.1.3.2" xref="A3.E17.m1.1.1.1.1.1.3.2.cmml">Δ</mi><mtext id="A3.E17.m1.1.1.1.1.1.3.3" xref="A3.E17.m1.1.1.1.1.1.3.3a.cmml">vir</mtext></msub></mrow><mo id="A3.E17.m1.1.1.1.1.2" xref="A3.E17.m1.1.1.1.1.2.cmml">≥</mo><mn id="A3.E17.m1.1.1.1.1.3" xref="A3.E17.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="A3.E17.m1.1.1.1.2" xref="A3.E17.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E17.m1.1b"><apply id="A3.E17.m1.1.1.1.1.cmml" xref="A3.E17.m1.1.1.1"><geq id="A3.E17.m1.1.1.1.1.2.cmml" xref="A3.E17.m1.1.1.1.1.2"></geq><apply id="A3.E17.m1.1.1.1.1.1.cmml" xref="A3.E17.m1.1.1.1.1.1"><ci id="A3.E17.m1.1.1.1.1.1.2.cmml" xref="A3.E17.m1.1.1.1.1.1.2">⋅</ci><apply id="A3.E17.m1.1.1.1.1.1.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E17.m1.1.1.1.1.1.1.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1"><minus id="A3.E17.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E17.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.2.2">Δ</ci><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><apply id="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.2">Δ</ci><ci id="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.1.1.1.3.3">vir</mtext></ci></apply></apply><csymbol cd="latexml" id="A3.E17.m1.1.1.1.1.1.1.3.cmml" xref="A3.E17.m1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="A3.E17.m1.1.1.1.1.1.3.cmml" xref="A3.E17.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E17.m1.1.1.1.1.1.3.1.cmml" xref="A3.E17.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E17.m1.1.1.1.1.1.3.2.cmml" xref="A3.E17.m1.1.1.1.1.1.3.2">Δ</ci><ci id="A3.E17.m1.1.1.1.1.1.3.3a.cmml" xref="A3.E17.m1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="A3.E17.m1.1.1.1.1.1.3.3.cmml" xref="A3.E17.m1.1.1.1.1.1.3.3">vir</mtext></ci></apply></apply><cn type="integer" id="A3.E17.m1.1.1.1.1.3.cmml" xref="A3.E17.m1.1.1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E17.m1.1c">\left(\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right)^{\top}\cdot\Delta_{{\text{vir}}}\geq 0,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.SSS0.Px2.p1.4" class="ltx_p">the solution</p>
<table id="A3.E18" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E18.m1.3" class="ltx_Math" alttext="p_{\tau}^{*}=0\quad\Leftrightarrow\quad\Delta_{\bm{\theta}}^{t+1}=\Delta_{{\text{vir}}}." display="block"><semantics id="A3.E18.m1.3a"><mrow id="A3.E18.m1.3.3.1"><mrow id="A3.E18.m1.3.3.1.1.2" xref="A3.E18.m1.3.3.1.1.3.cmml"><mrow id="A3.E18.m1.3.3.1.1.1.1" xref="A3.E18.m1.3.3.1.1.1.1.cmml"><msubsup id="A3.E18.m1.3.3.1.1.1.1.2" xref="A3.E18.m1.3.3.1.1.1.1.2.cmml"><mi id="A3.E18.m1.3.3.1.1.1.1.2.2.2" xref="A3.E18.m1.3.3.1.1.1.1.2.2.2.cmml">p</mi><mi id="A3.E18.m1.3.3.1.1.1.1.2.2.3" xref="A3.E18.m1.3.3.1.1.1.1.2.2.3.cmml">τ</mi><mo id="A3.E18.m1.3.3.1.1.1.1.2.3" xref="A3.E18.m1.3.3.1.1.1.1.2.3.cmml">∗</mo></msubsup><mo id="A3.E18.m1.3.3.1.1.1.1.1" xref="A3.E18.m1.3.3.1.1.1.1.1.cmml">=</mo><mrow id="A3.E18.m1.3.3.1.1.1.1.3.2" xref="A3.E18.m1.3.3.1.1.1.1.3.1.cmml"><mn id="A3.E18.m1.1.1" xref="A3.E18.m1.1.1.cmml">0</mn><mspace width="1em" id="A3.E18.m1.3.3.1.1.1.1.3.2.1" xref="A3.E18.m1.3.3.1.1.1.1.3.1.cmml"></mspace><mo stretchy="false" id="A3.E18.m1.2.2" xref="A3.E18.m1.2.2.cmml">⇔</mo></mrow></mrow><mspace width="1em" id="A3.E18.m1.3.3.1.1.2.3" xref="A3.E18.m1.3.3.1.1.3a.cmml"></mspace><mrow id="A3.E18.m1.3.3.1.1.2.2" xref="A3.E18.m1.3.3.1.1.2.2.cmml"><msubsup id="A3.E18.m1.3.3.1.1.2.2.2" xref="A3.E18.m1.3.3.1.1.2.2.2.cmml"><mi mathvariant="normal" id="A3.E18.m1.3.3.1.1.2.2.2.2.2" xref="A3.E18.m1.3.3.1.1.2.2.2.2.2.cmml">Δ</mi><mi id="A3.E18.m1.3.3.1.1.2.2.2.2.3" xref="A3.E18.m1.3.3.1.1.2.2.2.2.3.cmml">𝜽</mi><mrow id="A3.E18.m1.3.3.1.1.2.2.2.3" xref="A3.E18.m1.3.3.1.1.2.2.2.3.cmml"><mi id="A3.E18.m1.3.3.1.1.2.2.2.3.2" xref="A3.E18.m1.3.3.1.1.2.2.2.3.2.cmml">t</mi><mo id="A3.E18.m1.3.3.1.1.2.2.2.3.1" xref="A3.E18.m1.3.3.1.1.2.2.2.3.1.cmml">+</mo><mn id="A3.E18.m1.3.3.1.1.2.2.2.3.3" xref="A3.E18.m1.3.3.1.1.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="A3.E18.m1.3.3.1.1.2.2.1" xref="A3.E18.m1.3.3.1.1.2.2.1.cmml">=</mo><msub id="A3.E18.m1.3.3.1.1.2.2.3" xref="A3.E18.m1.3.3.1.1.2.2.3.cmml"><mi mathvariant="normal" id="A3.E18.m1.3.3.1.1.2.2.3.2" xref="A3.E18.m1.3.3.1.1.2.2.3.2.cmml">Δ</mi><mtext id="A3.E18.m1.3.3.1.1.2.2.3.3" xref="A3.E18.m1.3.3.1.1.2.2.3.3a.cmml">vir</mtext></msub></mrow></mrow><mo lspace="0em" id="A3.E18.m1.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E18.m1.3b"><apply id="A3.E18.m1.3.3.1.1.3.cmml" xref="A3.E18.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A3.E18.m1.3.3.1.1.3a.cmml" xref="A3.E18.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="A3.E18.m1.3.3.1.1.1.1.cmml" xref="A3.E18.m1.3.3.1.1.1.1"><eq id="A3.E18.m1.3.3.1.1.1.1.1.cmml" xref="A3.E18.m1.3.3.1.1.1.1.1"></eq><apply id="A3.E18.m1.3.3.1.1.1.1.2.cmml" xref="A3.E18.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E18.m1.3.3.1.1.1.1.2.1.cmml" xref="A3.E18.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="A3.E18.m1.3.3.1.1.1.1.2.2.cmml" xref="A3.E18.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E18.m1.3.3.1.1.1.1.2.2.1.cmml" xref="A3.E18.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="A3.E18.m1.3.3.1.1.1.1.2.2.2.cmml" xref="A3.E18.m1.3.3.1.1.1.1.2.2.2">𝑝</ci><ci id="A3.E18.m1.3.3.1.1.1.1.2.2.3.cmml" xref="A3.E18.m1.3.3.1.1.1.1.2.2.3">𝜏</ci></apply><times id="A3.E18.m1.3.3.1.1.1.1.2.3.cmml" xref="A3.E18.m1.3.3.1.1.1.1.2.3"></times></apply><list id="A3.E18.m1.3.3.1.1.1.1.3.1.cmml" xref="A3.E18.m1.3.3.1.1.1.1.3.2"><cn type="integer" id="A3.E18.m1.1.1.cmml" xref="A3.E18.m1.1.1">0</cn><ci id="A3.E18.m1.2.2.cmml" xref="A3.E18.m1.2.2">⇔</ci></list></apply><apply id="A3.E18.m1.3.3.1.1.2.2.cmml" xref="A3.E18.m1.3.3.1.1.2.2"><eq id="A3.E18.m1.3.3.1.1.2.2.1.cmml" xref="A3.E18.m1.3.3.1.1.2.2.1"></eq><apply id="A3.E18.m1.3.3.1.1.2.2.2.cmml" xref="A3.E18.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.E18.m1.3.3.1.1.2.2.2.1.cmml" xref="A3.E18.m1.3.3.1.1.2.2.2">superscript</csymbol><apply id="A3.E18.m1.3.3.1.1.2.2.2.2.cmml" xref="A3.E18.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.E18.m1.3.3.1.1.2.2.2.2.1.cmml" xref="A3.E18.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="A3.E18.m1.3.3.1.1.2.2.2.2.2.cmml" xref="A3.E18.m1.3.3.1.1.2.2.2.2.2">Δ</ci><ci id="A3.E18.m1.3.3.1.1.2.2.2.2.3.cmml" xref="A3.E18.m1.3.3.1.1.2.2.2.2.3">𝜽</ci></apply><apply id="A3.E18.m1.3.3.1.1.2.2.2.3.cmml" xref="A3.E18.m1.3.3.1.1.2.2.2.3"><plus id="A3.E18.m1.3.3.1.1.2.2.2.3.1.cmml" xref="A3.E18.m1.3.3.1.1.2.2.2.3.1"></plus><ci id="A3.E18.m1.3.3.1.1.2.2.2.3.2.cmml" xref="A3.E18.m1.3.3.1.1.2.2.2.3.2">𝑡</ci><cn type="integer" id="A3.E18.m1.3.3.1.1.2.2.2.3.3.cmml" xref="A3.E18.m1.3.3.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="A3.E18.m1.3.3.1.1.2.2.3.cmml" xref="A3.E18.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="A3.E18.m1.3.3.1.1.2.2.3.1.cmml" xref="A3.E18.m1.3.3.1.1.2.2.3">subscript</csymbol><ci id="A3.E18.m1.3.3.1.1.2.2.3.2.cmml" xref="A3.E18.m1.3.3.1.1.2.2.3.2">Δ</ci><ci id="A3.E18.m1.3.3.1.1.2.2.3.3a.cmml" xref="A3.E18.m1.3.3.1.1.2.2.3.3"><mtext mathsize="70%" id="A3.E18.m1.3.3.1.1.2.2.3.3.cmml" xref="A3.E18.m1.3.3.1.1.2.2.3.3">vir</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E18.m1.3c">p_{\tau}^{*}=0\quad\Leftrightarrow\quad\Delta_{\bm{\theta}}^{t+1}=\Delta_{{\text{vir}}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.SSS0.Px2.p1.2" class="ltx_p">In this scenario, the <math id="A3.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\left\|\Delta_{{\text{vir}}}\right\|_{2}^{2}" display="inline"><semantics id="A3.SS1.SSS0.Px2.p1.1.m1.1a"><msubsup id="A3.SS1.SSS0.Px2.p1.1.m1.1.1" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mrow id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.2.cmml"><mo id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.2" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.2.1.cmml">‖</mo><msub id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.2" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.2.cmml">Δ</mi><mtext id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3a.cmml">vir</mtext></msub><mo id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.3" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.3" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.3.cmml">2</mn><mn id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1">superscript</csymbol><apply id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.2.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><apply id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.2.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.2.1.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.2">norm</csymbol><apply id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.2">Δ</ci><ci id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3a.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.1.1.1.3">vir</mtext></ci></apply></apply><cn type="integer" id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.3.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.1.3">2</cn></apply><cn type="integer" id="A3.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="A3.SS1.SSS0.Px2.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS0.Px2.p1.1.m1.1c">\left\|\Delta_{{\text{vir}}}\right\|_{2}^{2}</annotation></semantics></math> is smaller than <math id="A3.SS1.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="\left\|\Delta_{{\tau}}\right\|_{2}^{2}" display="inline"><semantics id="A3.SS1.SSS0.Px2.p1.2.m2.1a"><msubsup id="A3.SS1.SSS0.Px2.p1.2.m2.1.1" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml"><mrow id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.2.cmml"><mo id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.2" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.2.1.cmml">‖</mo><msub id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.cmml">Δ</mi><mi id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.3" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.3" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.cmml">2</mn><mn id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.3" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS0.Px2.p1.2.m2.1b"><apply id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1">superscript</csymbol><apply id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.2.cmml" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><apply id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.2.cmml" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.2.1.cmml" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.2">norm</csymbol><apply id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2">Δ</ci><ci id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3">𝜏</ci></apply></apply><cn type="integer" id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.cmml" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.1.3">2</cn></apply><cn type="integer" id="A3.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="A3.SS1.SSS0.Px2.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS0.Px2.p1.2.m2.1c">\left\|\Delta_{{\tau}}\right\|_{2}^{2}</annotation></semantics></math>. The smaller deviation will hurdle the optimization on the virtual client. Therefore, we add weight on the virtual client.</p>
</div>
</section>
<section id="A3.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Case 3</h4>

<div id="A3.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="A3.SS1.SSS0.Px3.p1.3" class="ltx_p">When it has the condition as:</p>
<table id="A3.E19" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E19.m1.1" class="ltx_Math" alttext="\left(\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right)^{\top}\cdot\Delta_{{\tau}}\leq 0," display="block"><semantics id="A3.E19.m1.1a"><mrow id="A3.E19.m1.1.1.1" xref="A3.E19.m1.1.1.1.1.cmml"><mrow id="A3.E19.m1.1.1.1.1" xref="A3.E19.m1.1.1.1.1.cmml"><mrow id="A3.E19.m1.1.1.1.1.1" xref="A3.E19.m1.1.1.1.1.1.cmml"><msup id="A3.E19.m1.1.1.1.1.1.1" xref="A3.E19.m1.1.1.1.1.1.1.cmml"><mrow id="A3.E19.m1.1.1.1.1.1.1.1.1" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A3.E19.m1.1.1.1.1.1.1.1.1.2" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E19.m1.1.1.1.1.1.1.1.1.1" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A3.E19.m1.1.1.1.1.1.1.1.1.1.2" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="A3.E19.m1.1.1.1.1.1.1.1.1.1.2.2" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">Δ</mi><mi id="A3.E19.m1.1.1.1.1.1.1.1.1.1.2.3" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">τ</mi></msub><mo id="A3.E19.m1.1.1.1.1.1.1.1.1.1.1" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A3.E19.m1.1.1.1.1.1.1.1.1.1.3" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.2" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mtext id="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.3" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.3a.cmml">vir</mtext></msub></mrow><mo id="A3.E19.m1.1.1.1.1.1.1.1.1.3" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A3.E19.m1.1.1.1.1.1.1.3" xref="A3.E19.m1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo lspace="0.222em" rspace="0.222em" id="A3.E19.m1.1.1.1.1.1.2" xref="A3.E19.m1.1.1.1.1.1.2.cmml">⋅</mo><msub id="A3.E19.m1.1.1.1.1.1.3" xref="A3.E19.m1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="A3.E19.m1.1.1.1.1.1.3.2" xref="A3.E19.m1.1.1.1.1.1.3.2.cmml">Δ</mi><mi id="A3.E19.m1.1.1.1.1.1.3.3" xref="A3.E19.m1.1.1.1.1.1.3.3.cmml">τ</mi></msub></mrow><mo id="A3.E19.m1.1.1.1.1.2" xref="A3.E19.m1.1.1.1.1.2.cmml">≤</mo><mn id="A3.E19.m1.1.1.1.1.3" xref="A3.E19.m1.1.1.1.1.3.cmml">0</mn></mrow><mo id="A3.E19.m1.1.1.1.2" xref="A3.E19.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E19.m1.1b"><apply id="A3.E19.m1.1.1.1.1.cmml" xref="A3.E19.m1.1.1.1"><leq id="A3.E19.m1.1.1.1.1.2.cmml" xref="A3.E19.m1.1.1.1.1.2"></leq><apply id="A3.E19.m1.1.1.1.1.1.cmml" xref="A3.E19.m1.1.1.1.1.1"><ci id="A3.E19.m1.1.1.1.1.1.2.cmml" xref="A3.E19.m1.1.1.1.1.1.2">⋅</ci><apply id="A3.E19.m1.1.1.1.1.1.1.cmml" xref="A3.E19.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E19.m1.1.1.1.1.1.1.2.cmml" xref="A3.E19.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A3.E19.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E19.m1.1.1.1.1.1.1.1.1"><minus id="A3.E19.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A3.E19.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E19.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E19.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.2.2">Δ</ci><ci id="A3.E19.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.2.3">𝜏</ci></apply><apply id="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.2">Δ</ci><ci id="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A3.E19.m1.1.1.1.1.1.1.1.1.1.3.3">vir</mtext></ci></apply></apply><csymbol cd="latexml" id="A3.E19.m1.1.1.1.1.1.1.3.cmml" xref="A3.E19.m1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="A3.E19.m1.1.1.1.1.1.3.cmml" xref="A3.E19.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E19.m1.1.1.1.1.1.3.1.cmml" xref="A3.E19.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E19.m1.1.1.1.1.1.3.2.cmml" xref="A3.E19.m1.1.1.1.1.1.3.2">Δ</ci><ci id="A3.E19.m1.1.1.1.1.1.3.3.cmml" xref="A3.E19.m1.1.1.1.1.1.3.3">𝜏</ci></apply></apply><cn type="integer" id="A3.E19.m1.1.1.1.1.3.cmml" xref="A3.E19.m1.1.1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E19.m1.1c">\left(\Delta_{{\tau}}-\Delta_{{\text{vir}}}\right)^{\top}\cdot\Delta_{{\tau}}\leq 0,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.SSS0.Px3.p1.4" class="ltx_p">the solution</p>
<table id="A3.E20" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E20.m1.3" class="ltx_Math" alttext="p_{\tau}^{*}=1,\quad\Leftrightarrow\quad\Delta_{\bm{\theta}}^{t+1}=\Delta_{{\tau}}." display="block"><semantics id="A3.E20.m1.3a"><mrow id="A3.E20.m1.3.3.1"><mrow id="A3.E20.m1.3.3.1.1.2" xref="A3.E20.m1.3.3.1.1.3.cmml"><mrow id="A3.E20.m1.3.3.1.1.1.1" xref="A3.E20.m1.3.3.1.1.1.1.cmml"><msubsup id="A3.E20.m1.3.3.1.1.1.1.2" xref="A3.E20.m1.3.3.1.1.1.1.2.cmml"><mi id="A3.E20.m1.3.3.1.1.1.1.2.2.2" xref="A3.E20.m1.3.3.1.1.1.1.2.2.2.cmml">p</mi><mi id="A3.E20.m1.3.3.1.1.1.1.2.2.3" xref="A3.E20.m1.3.3.1.1.1.1.2.2.3.cmml">τ</mi><mo id="A3.E20.m1.3.3.1.1.1.1.2.3" xref="A3.E20.m1.3.3.1.1.1.1.2.3.cmml">∗</mo></msubsup><mo id="A3.E20.m1.3.3.1.1.1.1.1" xref="A3.E20.m1.3.3.1.1.1.1.1.cmml">=</mo><mrow id="A3.E20.m1.3.3.1.1.1.1.3.2" xref="A3.E20.m1.3.3.1.1.1.1.3.1.cmml"><mn id="A3.E20.m1.1.1" xref="A3.E20.m1.1.1.cmml">1</mn><mo rspace="0.889em" id="A3.E20.m1.3.3.1.1.1.1.3.2.1" xref="A3.E20.m1.3.3.1.1.1.1.3.1.cmml">,</mo><mo stretchy="false" id="A3.E20.m1.2.2" xref="A3.E20.m1.2.2.cmml">⇔</mo></mrow></mrow><mspace width="1em" id="A3.E20.m1.3.3.1.1.2.3" xref="A3.E20.m1.3.3.1.1.3a.cmml"></mspace><mrow id="A3.E20.m1.3.3.1.1.2.2" xref="A3.E20.m1.3.3.1.1.2.2.cmml"><msubsup id="A3.E20.m1.3.3.1.1.2.2.2" xref="A3.E20.m1.3.3.1.1.2.2.2.cmml"><mi mathvariant="normal" id="A3.E20.m1.3.3.1.1.2.2.2.2.2" xref="A3.E20.m1.3.3.1.1.2.2.2.2.2.cmml">Δ</mi><mi id="A3.E20.m1.3.3.1.1.2.2.2.2.3" xref="A3.E20.m1.3.3.1.1.2.2.2.2.3.cmml">𝜽</mi><mrow id="A3.E20.m1.3.3.1.1.2.2.2.3" xref="A3.E20.m1.3.3.1.1.2.2.2.3.cmml"><mi id="A3.E20.m1.3.3.1.1.2.2.2.3.2" xref="A3.E20.m1.3.3.1.1.2.2.2.3.2.cmml">t</mi><mo id="A3.E20.m1.3.3.1.1.2.2.2.3.1" xref="A3.E20.m1.3.3.1.1.2.2.2.3.1.cmml">+</mo><mn id="A3.E20.m1.3.3.1.1.2.2.2.3.3" xref="A3.E20.m1.3.3.1.1.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="A3.E20.m1.3.3.1.1.2.2.1" xref="A3.E20.m1.3.3.1.1.2.2.1.cmml">=</mo><msub id="A3.E20.m1.3.3.1.1.2.2.3" xref="A3.E20.m1.3.3.1.1.2.2.3.cmml"><mi mathvariant="normal" id="A3.E20.m1.3.3.1.1.2.2.3.2" xref="A3.E20.m1.3.3.1.1.2.2.3.2.cmml">Δ</mi><mi id="A3.E20.m1.3.3.1.1.2.2.3.3" xref="A3.E20.m1.3.3.1.1.2.2.3.3.cmml">τ</mi></msub></mrow></mrow><mo lspace="0em" id="A3.E20.m1.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.E20.m1.3b"><apply id="A3.E20.m1.3.3.1.1.3.cmml" xref="A3.E20.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A3.E20.m1.3.3.1.1.3a.cmml" xref="A3.E20.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="A3.E20.m1.3.3.1.1.1.1.cmml" xref="A3.E20.m1.3.3.1.1.1.1"><eq id="A3.E20.m1.3.3.1.1.1.1.1.cmml" xref="A3.E20.m1.3.3.1.1.1.1.1"></eq><apply id="A3.E20.m1.3.3.1.1.1.1.2.cmml" xref="A3.E20.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E20.m1.3.3.1.1.1.1.2.1.cmml" xref="A3.E20.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="A3.E20.m1.3.3.1.1.1.1.2.2.cmml" xref="A3.E20.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E20.m1.3.3.1.1.1.1.2.2.1.cmml" xref="A3.E20.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="A3.E20.m1.3.3.1.1.1.1.2.2.2.cmml" xref="A3.E20.m1.3.3.1.1.1.1.2.2.2">𝑝</ci><ci id="A3.E20.m1.3.3.1.1.1.1.2.2.3.cmml" xref="A3.E20.m1.3.3.1.1.1.1.2.2.3">𝜏</ci></apply><times id="A3.E20.m1.3.3.1.1.1.1.2.3.cmml" xref="A3.E20.m1.3.3.1.1.1.1.2.3"></times></apply><list id="A3.E20.m1.3.3.1.1.1.1.3.1.cmml" xref="A3.E20.m1.3.3.1.1.1.1.3.2"><cn type="integer" id="A3.E20.m1.1.1.cmml" xref="A3.E20.m1.1.1">1</cn><ci id="A3.E20.m1.2.2.cmml" xref="A3.E20.m1.2.2">⇔</ci></list></apply><apply id="A3.E20.m1.3.3.1.1.2.2.cmml" xref="A3.E20.m1.3.3.1.1.2.2"><eq id="A3.E20.m1.3.3.1.1.2.2.1.cmml" xref="A3.E20.m1.3.3.1.1.2.2.1"></eq><apply id="A3.E20.m1.3.3.1.1.2.2.2.cmml" xref="A3.E20.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.E20.m1.3.3.1.1.2.2.2.1.cmml" xref="A3.E20.m1.3.3.1.1.2.2.2">superscript</csymbol><apply id="A3.E20.m1.3.3.1.1.2.2.2.2.cmml" xref="A3.E20.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.E20.m1.3.3.1.1.2.2.2.2.1.cmml" xref="A3.E20.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="A3.E20.m1.3.3.1.1.2.2.2.2.2.cmml" xref="A3.E20.m1.3.3.1.1.2.2.2.2.2">Δ</ci><ci id="A3.E20.m1.3.3.1.1.2.2.2.2.3.cmml" xref="A3.E20.m1.3.3.1.1.2.2.2.2.3">𝜽</ci></apply><apply id="A3.E20.m1.3.3.1.1.2.2.2.3.cmml" xref="A3.E20.m1.3.3.1.1.2.2.2.3"><plus id="A3.E20.m1.3.3.1.1.2.2.2.3.1.cmml" xref="A3.E20.m1.3.3.1.1.2.2.2.3.1"></plus><ci id="A3.E20.m1.3.3.1.1.2.2.2.3.2.cmml" xref="A3.E20.m1.3.3.1.1.2.2.2.3.2">𝑡</ci><cn type="integer" id="A3.E20.m1.3.3.1.1.2.2.2.3.3.cmml" xref="A3.E20.m1.3.3.1.1.2.2.2.3.3">1</cn></apply></apply><apply id="A3.E20.m1.3.3.1.1.2.2.3.cmml" xref="A3.E20.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="A3.E20.m1.3.3.1.1.2.2.3.1.cmml" xref="A3.E20.m1.3.3.1.1.2.2.3">subscript</csymbol><ci id="A3.E20.m1.3.3.1.1.2.2.3.2.cmml" xref="A3.E20.m1.3.3.1.1.2.2.3.2">Δ</ci><ci id="A3.E20.m1.3.3.1.1.2.2.3.3.cmml" xref="A3.E20.m1.3.3.1.1.2.2.3.3">𝜏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E20.m1.3c">p_{\tau}^{*}=1,\quad\Leftrightarrow\quad\Delta_{\bm{\theta}}^{t+1}=\Delta_{{\tau}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p id="A3.SS1.SSS0.Px3.p1.2" class="ltx_p">In this scenario, the <math id="A3.SS1.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="\left\|\Delta_{{\tau}}\right\|_{2}^{2}" display="inline"><semantics id="A3.SS1.SSS0.Px3.p1.1.m1.1a"><msubsup id="A3.SS1.SSS0.Px3.p1.1.m1.1.1" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.cmml"><mrow id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.2.cmml"><mo id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.2" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.2.1.cmml">‖</mo><msub id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.2" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.2.cmml">Δ</mi><mi id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.3" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.3.cmml">τ</mi></msub><mo id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.3" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.3" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.3.cmml">2</mn><mn id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.3" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS0.Px3.p1.1.m1.1b"><apply id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1">superscript</csymbol><apply id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.2.cmml" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1">subscript</csymbol><apply id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.2.cmml" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.2.1.cmml" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.2">norm</csymbol><apply id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.2">Δ</ci><ci id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.1.1.1.3">𝜏</ci></apply></apply><cn type="integer" id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.3.cmml" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.1.3">2</cn></apply><cn type="integer" id="A3.SS1.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="A3.SS1.SSS0.Px3.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS0.Px3.p1.1.m1.1c">\left\|\Delta_{{\tau}}\right\|_{2}^{2}</annotation></semantics></math> is smaller than <math id="A3.SS1.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="\left\|\Delta_{{\text{vir}}}\right\|_{2}^{2}" display="inline"><semantics id="A3.SS1.SSS0.Px3.p1.2.m2.1a"><msubsup id="A3.SS1.SSS0.Px3.p1.2.m2.1.1" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.cmml"><mrow id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.2.cmml"><mo id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.2" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.2.1.cmml">‖</mo><msub id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.2" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.2.cmml">Δ</mi><mtext id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.3" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.3a.cmml">vir</mtext></msub><mo id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.3" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.3" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.3.cmml">2</mn><mn id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.3" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS1.SSS0.Px3.p1.2.m2.1b"><apply id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1">superscript</csymbol><apply id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.2.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1">subscript</csymbol><apply id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.2.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.2.1.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.2">norm</csymbol><apply id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.2">Δ</ci><ci id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.3a.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.3"><mtext mathsize="70%" id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.1.1.1.3">vir</mtext></ci></apply></apply><cn type="integer" id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.3.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.1.3">2</cn></apply><cn type="integer" id="A3.SS1.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="A3.SS1.SSS0.Px3.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.SSS0.Px3.p1.2.m2.1c">\left\|\Delta_{{\text{vir}}}\right\|_{2}^{2}</annotation></semantics></math>. The smaller deviation will hurdle the optimization on the toughest client. Therefore, we add weight on the toughest client.</p>
</div>
</section>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2307.14383" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2307.14384" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2307.14384">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2307.14384" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2307.14385" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 16:13:00 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
