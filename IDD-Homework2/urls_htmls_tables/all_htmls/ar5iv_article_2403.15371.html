<article class="ltx_document ltx_authors_1line">
 <h1 class="ltx_title ltx_title_document">
  Can large language models explore in-context?
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Akshay Krishnamurthy
    <span class="ltx_note ltx_role_footnote" id="footnote1">
     <sup class="ltx_note_mark">
      1
     </sup>
     <span class="ltx_note_outer">
      <span class="ltx_note_content">
       <sup class="ltx_note_mark">
        1
       </sup>
       <span class="ltx_tag ltx_tag_note">
        1
       </span>
       Corresponding authors:
       <span class="ltx_text ltx_font_typewriter" id="footnote1.1">
        {akshaykr,slivkins}@microsoft.com
       </span>
       .
      </span>
     </span>
    </span>
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
     Microsoft Research
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Keegan Harris
    <span class="ltx_note ltx_role_footnote" id="footnote2">
     <sup class="ltx_note_mark">
      2
     </sup>
     <span class="ltx_note_outer">
      <span class="ltx_note_content">
       <sup class="ltx_note_mark">
        2
       </sup>
       <span class="ltx_tag ltx_tag_note">
        2
       </span>
       Some of the results were obtained while the author was an intern at Microsoft Research.
      </span>
     </span>
    </span>
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
     Carnegie Mellon University
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Dylan J. Foster
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
     Microsoft Research
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    <br class="ltx_break"/>
    Cyril Zhang
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
     Microsoft Research
    </span>
   </span>
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Aleksandrs Slivkins
    <sup class="ltx_sup" id="id2.2.id1">
     ∗
    </sup>
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
     Microsoft Research
    </span>
   </span>
  </span>
 </div>
 <div class="ltx_dates">
  (March 2024)
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id3.id1">
   We investigate the extent to which contemporary Large Language Models (LLMs) can engage in
   <em class="ltx_emph ltx_font_italic" id="id3.id1.1">
    exploration
   </em>
   , a core capability in reinforcement learning and decision making. We focus on native performance of existing LLMs, without training interventions. We deploy LLMs as agents in simple
   <em class="ltx_emph ltx_font_italic" id="id3.id1.2">
    multi-armed bandit
   </em>
   environments, specifying the environment description and interaction history entirely
   <em class="ltx_emph ltx_font_italic" id="id3.id1.3">
    in-context
   </em>
   , i.e., within the LLM prompt. We experiment with
   <span class="ltx_text ltx_font_smallcaps" id="id3.id1.4">
    Gpt-3.5
   </span>
   ,
   <span class="ltx_text ltx_font_smallcaps" id="id3.id1.5">
    Gpt-4
   </span>
   , and
   <span class="ltx_text ltx_font_smallcaps" id="id3.id1.6">
    Llama2
   </span>
   , using a variety of prompt designs, and find that the models do not robustly engage in exploration without substantial interventions: i) Across all of our experiments, only one configuration resulted in satisfactory exploratory behavior:
   <span class="ltx_text ltx_font_smallcaps" id="id3.id1.7">
    Gpt-4
   </span>
   with chain-of-thought reasoning and an externally summarized interaction history, presented as sufficient statistics; ii) All other configurations did not result in robust exploratory behavior, including those with chain-of-thought reasoning but unsummarized history.
Although these findings can be interpreted positively, they suggest that external summarization—which may not be possible in more complex settings—is important for obtaining desirable behavior from LLM agents.
We conclude that non-trivial algorithmic interventions, such as fine-tuning or dataset curation, may be required to empower LLM-based decision making agents in complex settings.
  </p>
 </div>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <div class="ltx_para" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">
     In-context learning
    </em>
    is an important emergent capability of Large Language Models (LLMs) that enables one to use a pre-trained LLM to solve a problem by specifying the problem description and relevant data entirely
    <em class="ltx_emph ltx_font_italic" id="S1.p1.1.2">
     in-context
    </em>
    , i.e., within the LLM prompt, with no updates to the LLM parameters
    <cite class="ltx_cite ltx_citemacro_citep">
     (Brown et al.,
     <a class="ltx_ref" href="#bib.bib14" title="">
      2020
     </a>
     )
    </cite>
    .
For example, one can prompt an LLM with numeric covariate vectors and scalar targets and subsequently obtain regression-style predictions from the model by including new covariate vectors in the prompt
    <cite class="ltx_cite ltx_citemacro_citep">
     (Garg et al.,
     <a class="ltx_ref" href="#bib.bib23" title="">
      2022
     </a>
     )
    </cite>
    .
Perhaps surprisingly, LLMs are not explicitly trained for this behavior; instead
the underlying algorithms employed for in-context learning are extracted from the training corpus and
    <em class="ltx_emph ltx_font_italic" id="S1.p1.1.3">
     emerge
    </em>
    at scale.
   </p>
  </div>
  <div class="ltx_para" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    Since its discovery in the
    <span class="ltx_text ltx_font_smallcaps" id="S1.p2.1.1">
     Gpt-3
    </span>
    model
    <cite class="ltx_cite ltx_citemacro_citep">
     (Brown et al.,
     <a class="ltx_ref" href="#bib.bib14" title="">
      2020
     </a>
     )
    </cite>
    , in-context learning has been the subject of a growing body of research.
These works include theoretical investigations into the underlying mechanisms
    <cite class="ltx_cite ltx_citemacro_citep">
     (e.g., Xie et al.,
     <a class="ltx_ref" href="#bib.bib68" title="">
      2021
     </a>
     ; Akyürek et al.,
     <a class="ltx_ref" href="#bib.bib7" title="">
      2022
     </a>
     )
    </cite>
    , empirical probes
    <cite class="ltx_cite ltx_citemacro_citep">
     (e.g., Garg et al.,
     <a class="ltx_ref" href="#bib.bib23" title="">
      2022
     </a>
     ; Kirsch et al.,
     <a class="ltx_ref" href="#bib.bib34" title="">
      2022
     </a>
     )
    </cite>
    , and works leveraging in-context learning in applications
    <cite class="ltx_cite ltx_citemacro_citep">
     (e.g., Xu et al.,
     <a class="ltx_ref" href="#bib.bib69" title="">
      2022
     </a>
     ; Som et al.,
     <a class="ltx_ref" href="#bib.bib57" title="">
      2023
     </a>
     ; Edwards et al.,
     <a class="ltx_ref" href="#bib.bib20" title="">
      2023
     </a>
     )
    </cite>
    .
This literature predominantly studies in-context learning for prediction or supervised learning tasks,
and while theoretical progress is in its infancy, our understanding of how to use
    <em class="ltx_emph ltx_font_italic" id="S1.p2.1.2">
     in-context supervised learning
    </em>
    (ICSL) in practice is rapidly taking shape.
   </p>
  </div>
  <div class="ltx_para" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    Although supervised learning is an important capability, many applications demand the use of ML models for downstream
    <em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">
     decision making
    </em>
    .
Thus,
    <em class="ltx_emph ltx_font_italic" id="S1.p3.1.2">
     in-context reinforcement learning
    </em>
    (ICRL) and sequential decision making is a natural next frontier. LLMs are already being used as decision making agents in applications ranging from experimental design in the natural sciences
    <cite class="ltx_cite ltx_citemacro_citep">
     (Lee et al.,
     <a class="ltx_ref" href="#bib.bib39" title="">
      2023b
     </a>
     )
    </cite>
    to game playing
    <cite class="ltx_cite ltx_citemacro_citep">
     (Shinn et al.,
     <a class="ltx_ref" href="#bib.bib53" title="">
      2023
     </a>
     ; Wang et al.,
     <a class="ltx_ref" href="#bib.bib62" title="">
      2023
     </a>
     )
    </cite>
    , but our understanding—theoretically and operationally—of ICRL is far less developed than for ICSL.
To date, we lack a systematic understanding as to whether LLMs can be
considered general-purpose decision making agents.
   </p>
  </div>
  <div class="ltx_para" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    Decision making agents must possess three core capabilities:
    <em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">
     generalization
    </em>
    (required for supervised learning),
    <em class="ltx_emph ltx_font_italic" id="S1.p4.1.2">
     exploration
    </em>
    (making decisions that may be suboptimal in the short term for the sake of gathering more information) and
    <em class="ltx_emph ltx_font_italic" id="S1.p4.1.3">
     planning
    </em>
    (to account for long-term consequences of decisions).
In this paper, we focus on exploration, the capability to deliberately gather information in order to evaluate alternatives and reduce uncertainty.
A recent series of papers
    <cite class="ltx_cite ltx_citemacro_citep">
     (Laskin et al.,
     <a class="ltx_ref" href="#bib.bib36" title="">
      2022
     </a>
     ; Lee et al.,
     <a class="ltx_ref" href="#bib.bib38" title="">
      2023a
     </a>
     ; Raparthy et al.,
     <a class="ltx_ref" href="#bib.bib48" title="">
      2023
     </a>
     )
    </cite>
    demonstrates in-context reinforcement learning behavior (including exploration) in transformer models when they are
    <em class="ltx_emph ltx_font_italic" id="S1.p4.1.4">
     explicitly trained
    </em>
    to produce this behavior using data from reinforcement learning agents or expert demonstrations on related tasks.
Such training tends to be laborious, expensive, and possibly task-specific.
In particular, these findings do not shed light into whether exploratory behavior manifests in general-purpose LLMs obtained via standard training methods, which suggests the following basic question:
   </p>
  </div>
  <div class="ltx_para" id="S1.p5">
   <blockquote class="ltx_quote" id="S1.p5.1">
    <p class="ltx_p ltx_align_center" id="S1.p5.1.1">
     <em class="ltx_emph ltx_font_italic" id="S1.p5.1.1.1">
      Do contemporary LLMs exhibit the capability to explore in-context?
     </em>
    </p>
   </blockquote>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p6">
   <p class="ltx_p" id="S1.p6.1">
    <span class="ltx_text ltx_font_bold" id="S1.p6.1.1">
     Contributions.
    </span>
    We investigate this question by deploying
LLMs as agents in simple synthetic reinforcement learning problems, namely
    <em class="ltx_emph ltx_font_italic" id="S1.p6.1.2">
     multi-armed bandits (MABs)
    </em>
    <cite class="ltx_cite ltx_citemacro_citep">
     (Slivkins,
     <a class="ltx_ref" href="#bib.bib55" title="">
      2019
     </a>
     ; Lattimore and Szepesvári,
     <a class="ltx_ref" href="#bib.bib37" title="">
      2020
     </a>
     )
    </cite>
    , specifying the environment description and interaction history entirely within the LLM prompt.
Multi-armed bandits are a classical and well-studied type of RL problem that isolates the tradeoff between exploration and
    <em class="ltx_emph ltx_font_italic" id="S1.p6.1.3">
     exploitation
    </em>
    , i.e., making the best decision given the available data.
They are also a fundamental building block toward general sequential decision making; the ability to solve MABs is a prerequisite for more challenging reinforcement learning tasks.
Their simplicity, centrality to RL, and focus on exploration versus exploitation make MABs a natural choice for systematically studying the in-context exploration abilities of LLMs.
   </p>
  </div>
  <div class="ltx_para" id="S1.p7">
   <p class="ltx_p" id="S1.p7.1">
    We evaluate the in-context exploration behavior of
    <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.1">
     Gpt-3.5
    </span>
    <cite class="ltx_cite ltx_citemacro_citep">
     (Brown et al.,
     <a class="ltx_ref" href="#bib.bib14" title="">
      2020
     </a>
     )
    </cite>
    ,
    <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.2">
     Gpt-4
    </span>
    <cite class="ltx_cite ltx_citemacro_citep">
     (OpenAI,
     <a class="ltx_ref" href="#bib.bib46" title="">
      2023
     </a>
     )
    </cite>
    , and
    <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.3">
     Llama2
    </span>
    <cite class="ltx_cite ltx_citemacro_citep">
     (Touvron et al.,
     <a class="ltx_ref" href="#bib.bib59" title="">
      2023
     </a>
     )
    </cite>
    in MAB environments, using a variety of prompt designs. In our experiments, we find that only a single configuration (i.e., a prompt design and LLM pair) results in satisfactory exploratory behavior.
All other configurations exhibit
exploration failures, failing to converge to the best decision (
    <em class="ltx_emph ltx_font_italic" id="S1.p7.1.4">
     arm
    </em>
    ) with significant probability.
We find that typically this happens due to
    <em class="ltx_emph ltx_font_italic" id="S1.p7.1.5">
     suffix failures
    </em>
    , where the LLM fails to select the best arm even once after some initial rounds (i.e., in some “time suffix”).
This scenario is reflected in
    <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Can large language models explore in-context?">
     Figure
     <span class="ltx_ref ltx_nolink">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </span>
    </a>
    (a): in particular,
    <span class="ltx_text ltx_font_smallcaps" id="S1.p7.1.6">
     Gpt-4
    </span>
    with our basic prompt design experiences a suffix failure
in
    <math alttext="&gt;60\%" class="ltx_Math" display="inline" id="S1.p7.1.m1.1">
     <semantics id="S1.p7.1.m1.1a">
      <mrow id="S1.p7.1.m1.1.1" xref="S1.p7.1.m1.1.1.cmml">
       <mi id="S1.p7.1.m1.1.1.2" xref="S1.p7.1.m1.1.1.2.cmml">
       </mi>
       <mo id="S1.p7.1.m1.1.1.1" xref="S1.p7.1.m1.1.1.1.cmml">
        &gt;
       </mo>
       <mrow id="S1.p7.1.m1.1.1.3" xref="S1.p7.1.m1.1.1.3.cmml">
        <mn id="S1.p7.1.m1.1.1.3.2" xref="S1.p7.1.m1.1.1.3.2.cmml">
         60
        </mn>
        <mo id="S1.p7.1.m1.1.1.3.1" xref="S1.p7.1.m1.1.1.3.1.cmml">
         %
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S1.p7.1.m1.1b">
       <apply id="S1.p7.1.m1.1.1.cmml" xref="S1.p7.1.m1.1.1">
        <gt id="S1.p7.1.m1.1.1.1.cmml" xref="S1.p7.1.m1.1.1.1">
        </gt>
        <csymbol cd="latexml" id="S1.p7.1.m1.1.1.2.cmml" xref="S1.p7.1.m1.1.1.2">
         absent
        </csymbol>
        <apply id="S1.p7.1.m1.1.1.3.cmml" xref="S1.p7.1.m1.1.1.3">
         <csymbol cd="latexml" id="S1.p7.1.m1.1.1.3.1.cmml" xref="S1.p7.1.m1.1.1.3.1">
          percent
         </csymbol>
         <cn id="S1.p7.1.m1.1.1.3.2.cmml" type="integer" xref="S1.p7.1.m1.1.1.3.2">
          60
         </cn>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.p7.1.m1.1c">
       &gt;60\%
      </annotation>
     </semantics>
    </math>
    of the replicates.
An alternative failure mode we identify is where the LLM behaves “uniformly”, selecting all arms near-equally often and failing to narrow down to the better ones.
   </p>
  </div>
  <div class="ltx_para" id="S1.p8">
   <p class="ltx_p" id="S1.p8.1">
    The single configuration thato succeeds in our experiments involves a
combination of
    <span class="ltx_text ltx_font_smallcaps" id="S1.p8.1.1">
     Gpt-4
    </span>
    and an “enhanced” prompt that (a) provides a
suggestive hint to explore, (b) externally summarizes the history of
interaction into per-arm averages,
and (c) asks the LLM to use
zero-shot chain-of-thought reasoning
    <cite class="ltx_cite ltx_citemacro_citep">
     (Wei et al.,
     <a class="ltx_ref" href="#bib.bib64" title="">
      2022
     </a>
     ; Kojima et al.,
     <a class="ltx_ref" href="#bib.bib35" title="">
      2022
     </a>
     )
    </cite>
    . This configuration is visualized in
    <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Can large language models explore in-context?">
     Figure
     <span class="ltx_ref ltx_nolink">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </span>
    </a>
    (b). One can interpret this finding
positively: state-of-the-art LLMs
    <em class="ltx_emph ltx_font_italic" id="S1.p8.1.2">
     do
    </em>
    possess the capability to
robustly explore, provided that the prompt is carefully designed to
elicit this behavior. On the other hand, we find that the same
configuration without external summarization fails, which leads to a
negative interpretation: LLMs may fail to explore in more
complex environments, where externally summarizing the history is a non-trivial algorithm design problem.
    <span class="ltx_note ltx_role_footnote" id="footnote3">
     <sup class="ltx_note_mark">
      3
     </sup>
     <span class="ltx_note_outer">
      <span class="ltx_note_content">
       <sup class="ltx_note_mark">
        3
       </sup>
       <span class="ltx_tag ltx_tag_note">
        3
       </span>
       E.g., if there are many arms, or if we are considering contextual bandits with many contexts, then we may only play each arm (context-arm pair) a few times, so averaging reward separately for each—as we do in our experiments—does not provide much summarization. (See
       <a class="ltx_ref" href="#S5" title="5 Discussion and open questions ‣ Can large language models explore in-context?">
        Section
        <span class="ltx_ref ltx_nolink">
         <span class="ltx_text ltx_ref_tag">
          5
         </span>
        </span>
       </a>
       for further discussion.)
      </span>
     </span>
    </span>
   </p>
  </div>
  <div class="ltx_para" id="S1.p9">
   <p class="ltx_p" id="S1.p9.1">
    We conclude that while the current generation of LLMs can perhaps explore in simple RL environments with appropriate prompt engineering,
training
interventions—in the spirit
of
    <cite class="ltx_cite ltx_citemacro_citet">
     Lee et al. (
     <a class="ltx_ref" href="#bib.bib38" title="">
      2023a
     </a>
     ); Raparthy et al. (
     <a class="ltx_ref" href="#bib.bib48" title="">
      2023
     </a>
     )
    </cite>
    —may be
required to endow LLMs with more sophisticated exploration capabilities required for more complex settings.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S1.p10">
   <p class="ltx_p" id="S1.p10.1">
    <span class="ltx_text ltx_font_bold" id="S1.p10.1.1">
     Methodology.
    </span>
    An underlying technical challenge in assessing LLM
capabilities and limitations is that one must search a combinatorially large space of
prompt designs while obtaining statistically meaningful results, all
while meeting the financial and computational constraints associated with
LLMs. Assessing in-context bandit learning
is even more challenging because (a) stochasticity in the environment
demands a high degree of replication for statistical significance and
(b) the sample complexity of learning/exploration demands that even a
single experiment involve hundreds or thousands of LLM queries to obtain meaningful
effect sizes (i.e., separation between successful and failing methods).
To address these issues, our core technical contribution is to
identify
    <em class="ltx_emph ltx_font_italic" id="S1.p10.1.2">
     surrogate statistics
    </em>
    as diagnostics for long-term exploration failure. The surrogate statistics we consider characterize long-term exploration failure, yet can be
measured at moderate scale with few replicates and short learning
horizons, even when
the standard performance measure (namely,
reward)
is too noisy to be useful.
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F1">
   <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="213" id="S1.F1.g1" src="/html/2403.15371/assets/x1.png" width="484"/>
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_figure">
     Figure 1:
    </span>
    <span class="ltx_text ltx_font_bold" id="S1.F1.31.1">
     Representative experiments:
    </span>
    Two prompt configurations for
    <span class="ltx_text ltx_font_smallcaps" id="S1.F1.32.2">
     Gpt-4
    </span>
    on a
    <math alttext="5" class="ltx_Math" display="inline" id="S1.F1.9.m1.1">
     <semantics id="S1.F1.9.m1.1b">
      <mn id="S1.F1.9.m1.1.1" xref="S1.F1.9.m1.1.1.cmml">
       5
      </mn>
      <annotation-xml encoding="MathML-Content" id="S1.F1.9.m1.1c">
       <cn id="S1.F1.9.m1.1.1.cmml" type="integer" xref="S1.F1.9.m1.1.1">
        5
       </cn>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.F1.9.m1.1d">
       5
      </annotation>
     </semantics>
    </math>
    -armed bandit problem, demonstrating exploration failure (top) and success (bottom).
The baselines are two standard bandit algorithms with performance guarantees, Upper Confidence Bound (
    <span class="ltx_text ltx_font_smallcaps" id="S1.F1.33.3">
     UCB
    </span>
    ) and Thompson Sampling (
    <span class="ltx_text ltx_font_smallcaps" id="S1.F1.34.4">
     TS
    </span>
    ), as well as the
    <span class="ltx_text ltx_font_smallcaps" id="S1.F1.35.5">
     Greedy
    </span>
    algorithm, which always chooses an arm with the best average reward so far and is known to perform poorly. Visualizations are: (Left) histogram over replicates of the number of times the best arm is chosen, (Center) for each
    <math alttext="t" class="ltx_Math" display="inline" id="S1.F1.10.m2.1">
     <semantics id="S1.F1.10.m2.1b">
      <mi id="S1.F1.10.m2.1.1" xref="S1.F1.10.m2.1.1.cmml">
       t
      </mi>
      <annotation-xml encoding="MathML-Content" id="S1.F1.10.m2.1c">
       <ci id="S1.F1.10.m2.1.1.cmml" xref="S1.F1.10.m2.1.1">
        𝑡
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.F1.10.m2.1d">
       t
      </annotation>
     </semantics>
    </math>
    , we plot the
    <em class="ltx_emph ltx_font_italic" id="S1.F1.36.6">
     suffix failure frequency
    </em>
    , the fraction of replicates for which the best arm is never chosen after time-step
    <math alttext="t" class="ltx_Math" display="inline" id="S1.F1.11.m3.1">
     <semantics id="S1.F1.11.m3.1b">
      <mi id="S1.F1.11.m3.1.1" xref="S1.F1.11.m3.1.1.cmml">
       t
      </mi>
      <annotation-xml encoding="MathML-Content" id="S1.F1.11.m3.1c">
       <ci id="S1.F1.11.m3.1.1.cmml" xref="S1.F1.11.m3.1.1">
        𝑡
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.F1.11.m3.1d">
       t
      </annotation>
     </semantics>
    </math>
    , and (Right) cumulative time-averaged rewards, averaged over replicates.
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_bold" id="S1.F1.37.7">
     (a) Top row.
    </span>
    <span class="ltx_text ltx_font_smallcaps" id="S1.F1.38.8">
     Gpt-4
    </span>
    with our basic prompt design with zero temperature. The experiment runs for
    <math alttext="T=500" class="ltx_Math" display="inline" id="S1.F1.12.m4.1">
     <semantics id="S1.F1.12.m4.1b">
      <mrow id="S1.F1.12.m4.1.1" xref="S1.F1.12.m4.1.1.cmml">
       <mi id="S1.F1.12.m4.1.1.2" xref="S1.F1.12.m4.1.1.2.cmml">
        T
       </mi>
       <mo id="S1.F1.12.m4.1.1.1" xref="S1.F1.12.m4.1.1.1.cmml">
        =
       </mo>
       <mn id="S1.F1.12.m4.1.1.3" xref="S1.F1.12.m4.1.1.3.cmml">
        500
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S1.F1.12.m4.1c">
       <apply id="S1.F1.12.m4.1.1.cmml" xref="S1.F1.12.m4.1.1">
        <eq id="S1.F1.12.m4.1.1.1.cmml" xref="S1.F1.12.m4.1.1.1">
        </eq>
        <ci id="S1.F1.12.m4.1.1.2.cmml" xref="S1.F1.12.m4.1.1.2">
         𝑇
        </ci>
        <cn id="S1.F1.12.m4.1.1.3.cmml" type="integer" xref="S1.F1.12.m4.1.1.3">
         500
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.F1.12.m4.1d">
       T=500
      </annotation>
     </semantics>
    </math>
    rounds, and is replicated
    <math alttext="N=20" class="ltx_Math" display="inline" id="S1.F1.13.m5.1">
     <semantics id="S1.F1.13.m5.1b">
      <mrow id="S1.F1.13.m5.1.1" xref="S1.F1.13.m5.1.1.cmml">
       <mi id="S1.F1.13.m5.1.1.2" xref="S1.F1.13.m5.1.1.2.cmml">
        N
       </mi>
       <mo id="S1.F1.13.m5.1.1.1" xref="S1.F1.13.m5.1.1.1.cmml">
        =
       </mo>
       <mn id="S1.F1.13.m5.1.1.3" xref="S1.F1.13.m5.1.1.3.cmml">
        20
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S1.F1.13.m5.1c">
       <apply id="S1.F1.13.m5.1.1.cmml" xref="S1.F1.13.m5.1.1">
        <eq id="S1.F1.13.m5.1.1.1.cmml" xref="S1.F1.13.m5.1.1.1">
        </eq>
        <ci id="S1.F1.13.m5.1.1.2.cmml" xref="S1.F1.13.m5.1.1.2">
         𝑁
        </ci>
        <cn id="S1.F1.13.m5.1.1.3.cmml" type="integer" xref="S1.F1.13.m5.1.1.3">
         20
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.F1.13.m5.1d">
       N=20
      </annotation>
     </semantics>
    </math>
    times, varying environment randomness.
This configuration exhibits highly bimodal behavior: a large (
    <math alttext="&gt;60\%" class="ltx_Math" display="inline" id="S1.F1.14.m6.1">
     <semantics id="S1.F1.14.m6.1b">
      <mrow id="S1.F1.14.m6.1.1" xref="S1.F1.14.m6.1.1.cmml">
       <mi id="S1.F1.14.m6.1.1.2" xref="S1.F1.14.m6.1.1.2.cmml">
       </mi>
       <mo id="S1.F1.14.m6.1.1.1" xref="S1.F1.14.m6.1.1.1.cmml">
        &gt;
       </mo>
       <mrow id="S1.F1.14.m6.1.1.3" xref="S1.F1.14.m6.1.1.3.cmml">
        <mn id="S1.F1.14.m6.1.1.3.2" xref="S1.F1.14.m6.1.1.3.2.cmml">
         60
        </mn>
        <mo id="S1.F1.14.m6.1.1.3.1" xref="S1.F1.14.m6.1.1.3.1.cmml">
         %
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S1.F1.14.m6.1c">
       <apply id="S1.F1.14.m6.1.1.cmml" xref="S1.F1.14.m6.1.1">
        <gt id="S1.F1.14.m6.1.1.1.cmml" xref="S1.F1.14.m6.1.1.1">
        </gt>
        <csymbol cd="latexml" id="S1.F1.14.m6.1.1.2.cmml" xref="S1.F1.14.m6.1.1.2">
         absent
        </csymbol>
        <apply id="S1.F1.14.m6.1.1.3.cmml" xref="S1.F1.14.m6.1.1.3">
         <csymbol cd="latexml" id="S1.F1.14.m6.1.1.3.1.cmml" xref="S1.F1.14.m6.1.1.3.1">
          percent
         </csymbol>
         <cn id="S1.F1.14.m6.1.1.3.2.cmml" type="integer" xref="S1.F1.14.m6.1.1.3.2">
          60
         </cn>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.F1.14.m6.1d">
       &gt;60\%
      </annotation>
     </semantics>
    </math>
    ) fraction of replicates choose the best arm only a handful of times and exhibit suffix failures, similar to
    <span class="ltx_text ltx_font_smallcaps" id="S1.F1.39.9">
     Greedy
    </span>
    , and very unlike
    <span class="ltx_text ltx_font_smallcaps" id="S1.F1.40.10">
     UCB
    </span>
    and
    <span class="ltx_text ltx_font_smallcaps" id="S1.F1.41.11">
     TS
    </span>
    . This is suggestive of a long term failure to explore and, indeed, this configuration underperforms substantially in terms of reward.
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_bold" id="S1.F1.42.12">
     (b) Bottom row.
    </span>
    <span class="ltx_text ltx_font_smallcaps" id="S1.F1.43.13">
     Gpt-4
    </span>
    with a suggestive framing, summarized history, and chain-of-thought with zero temperature. The experiment runs for
    <math alttext="T=200" class="ltx_Math" display="inline" id="S1.F1.15.m7.1">
     <semantics id="S1.F1.15.m7.1b">
      <mrow id="S1.F1.15.m7.1.1" xref="S1.F1.15.m7.1.1.cmml">
       <mi id="S1.F1.15.m7.1.1.2" xref="S1.F1.15.m7.1.1.2.cmml">
        T
       </mi>
       <mo id="S1.F1.15.m7.1.1.1" xref="S1.F1.15.m7.1.1.1.cmml">
        =
       </mo>
       <mn id="S1.F1.15.m7.1.1.3" xref="S1.F1.15.m7.1.1.3.cmml">
        200
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S1.F1.15.m7.1c">
       <apply id="S1.F1.15.m7.1.1.cmml" xref="S1.F1.15.m7.1.1">
        <eq id="S1.F1.15.m7.1.1.1.cmml" xref="S1.F1.15.m7.1.1.1">
        </eq>
        <ci id="S1.F1.15.m7.1.1.2.cmml" xref="S1.F1.15.m7.1.1.2">
         𝑇
        </ci>
        <cn id="S1.F1.15.m7.1.1.3.cmml" type="integer" xref="S1.F1.15.m7.1.1.3">
         200
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.F1.15.m7.1d">
       T=200
      </annotation>
     </semantics>
    </math>
    rounds and is replicated
    <math alttext="N=40" class="ltx_Math" display="inline" id="S1.F1.16.m8.1">
     <semantics id="S1.F1.16.m8.1b">
      <mrow id="S1.F1.16.m8.1.1" xref="S1.F1.16.m8.1.1.cmml">
       <mi id="S1.F1.16.m8.1.1.2" xref="S1.F1.16.m8.1.1.2.cmml">
        N
       </mi>
       <mo id="S1.F1.16.m8.1.1.1" xref="S1.F1.16.m8.1.1.1.cmml">
        =
       </mo>
       <mn id="S1.F1.16.m8.1.1.3" xref="S1.F1.16.m8.1.1.3.cmml">
        40
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S1.F1.16.m8.1c">
       <apply id="S1.F1.16.m8.1.1.cmml" xref="S1.F1.16.m8.1.1">
        <eq id="S1.F1.16.m8.1.1.1.cmml" xref="S1.F1.16.m8.1.1.1">
        </eq>
        <ci id="S1.F1.16.m8.1.1.2.cmml" xref="S1.F1.16.m8.1.1.2">
         𝑁
        </ci>
        <cn id="S1.F1.16.m8.1.1.3.cmml" type="integer" xref="S1.F1.16.m8.1.1.3">
         40
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.F1.16.m8.1d">
       N=40
      </annotation>
     </semantics>
    </math>
    times.
This configuration exhibits a unimodal distribution of plays of the best arm, very few suffix failures, and reward that is comparable to
    <span class="ltx_text ltx_font_smallcaps" id="S1.F1.44.14">
     TS
    </span>
    .
   </figcaption>
  </figure>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Experimental setup
  </h2>
  <div class="ltx_para ltx_noindent" id="S2.p1">
   <p class="ltx_p" id="S2.p1.11">
    <span class="ltx_text ltx_font_bold" id="S2.p1.11.1">
     Multi-armed bandits (MAB).
    </span>
    We consider a basic multi-armed bandit variant,
    <em class="ltx_emph ltx_font_italic" id="S2.p1.11.2">
     stochastic Bernoulli bandits
    </em>
    . There are
    <math alttext="K" class="ltx_Math" display="inline" id="S2.p1.1.m1.1">
     <semantics id="S2.p1.1.m1.1a">
      <mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">
       K
      </mi>
      <annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b">
       <ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">
        𝐾
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">
       K
      </annotation>
     </semantics>
    </math>
    possible actions (
    <em class="ltx_emph ltx_font_italic" id="S2.p1.11.3">
     arms
    </em>
    ), indexed as
    <math alttext="[K]:=\{1,\ldots,K\}" class="ltx_Math" display="inline" id="S2.p1.2.m2.4">
     <semantics id="S2.p1.2.m2.4a">
      <mrow id="S2.p1.2.m2.4.5" xref="S2.p1.2.m2.4.5.cmml">
       <mrow id="S2.p1.2.m2.4.5.2.2" xref="S2.p1.2.m2.4.5.2.1.cmml">
        <mo id="S2.p1.2.m2.4.5.2.2.1" stretchy="false" xref="S2.p1.2.m2.4.5.2.1.1.cmml">
         [
        </mo>
        <mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">
         K
        </mi>
        <mo id="S2.p1.2.m2.4.5.2.2.2" rspace="0.278em" stretchy="false" xref="S2.p1.2.m2.4.5.2.1.1.cmml">
         ]
        </mo>
       </mrow>
       <mo id="S2.p1.2.m2.4.5.1" rspace="0.278em" xref="S2.p1.2.m2.4.5.1.cmml">
        :=
       </mo>
       <mrow id="S2.p1.2.m2.4.5.3.2" xref="S2.p1.2.m2.4.5.3.1.cmml">
        <mo id="S2.p1.2.m2.4.5.3.2.1" stretchy="false" xref="S2.p1.2.m2.4.5.3.1.cmml">
         {
        </mo>
        <mn id="S2.p1.2.m2.2.2" xref="S2.p1.2.m2.2.2.cmml">
         1
        </mn>
        <mo id="S2.p1.2.m2.4.5.3.2.2" xref="S2.p1.2.m2.4.5.3.1.cmml">
         ,
        </mo>
        <mi id="S2.p1.2.m2.3.3" mathvariant="normal" xref="S2.p1.2.m2.3.3.cmml">
         …
        </mi>
        <mo id="S2.p1.2.m2.4.5.3.2.3" xref="S2.p1.2.m2.4.5.3.1.cmml">
         ,
        </mo>
        <mi id="S2.p1.2.m2.4.4" xref="S2.p1.2.m2.4.4.cmml">
         K
        </mi>
        <mo id="S2.p1.2.m2.4.5.3.2.4" stretchy="false" xref="S2.p1.2.m2.4.5.3.1.cmml">
         }
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.4b">
       <apply id="S2.p1.2.m2.4.5.cmml" xref="S2.p1.2.m2.4.5">
        <csymbol cd="latexml" id="S2.p1.2.m2.4.5.1.cmml" xref="S2.p1.2.m2.4.5.1">
         assign
        </csymbol>
        <apply id="S2.p1.2.m2.4.5.2.1.cmml" xref="S2.p1.2.m2.4.5.2.2">
         <csymbol cd="latexml" id="S2.p1.2.m2.4.5.2.1.1.cmml" xref="S2.p1.2.m2.4.5.2.2.1">
          delimited-[]
         </csymbol>
         <ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">
          𝐾
         </ci>
        </apply>
        <set id="S2.p1.2.m2.4.5.3.1.cmml" xref="S2.p1.2.m2.4.5.3.2">
         <cn id="S2.p1.2.m2.2.2.cmml" type="integer" xref="S2.p1.2.m2.2.2">
          1
         </cn>
         <ci id="S2.p1.2.m2.3.3.cmml" xref="S2.p1.2.m2.3.3">
          …
         </ci>
         <ci id="S2.p1.2.m2.4.4.cmml" xref="S2.p1.2.m2.4.4">
          𝐾
         </ci>
        </set>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p1.2.m2.4c">
       [K]:=\{1,\ldots,K\}
      </annotation>
     </semantics>
    </math>
    . Each arm
    <math alttext="a" class="ltx_Math" display="inline" id="S2.p1.3.m3.1">
     <semantics id="S2.p1.3.m3.1a">
      <mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">
       a
      </mi>
      <annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b">
       <ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">
        𝑎
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">
       a
      </annotation>
     </semantics>
    </math>
    is associated with mean reward
    <math alttext="\mu_{a}\in[0,1]" class="ltx_Math" display="inline" id="S2.p1.4.m4.2">
     <semantics id="S2.p1.4.m4.2a">
      <mrow id="S2.p1.4.m4.2.3" xref="S2.p1.4.m4.2.3.cmml">
       <msub id="S2.p1.4.m4.2.3.2" xref="S2.p1.4.m4.2.3.2.cmml">
        <mi id="S2.p1.4.m4.2.3.2.2" xref="S2.p1.4.m4.2.3.2.2.cmml">
         μ
        </mi>
        <mi id="S2.p1.4.m4.2.3.2.3" xref="S2.p1.4.m4.2.3.2.3.cmml">
         a
        </mi>
       </msub>
       <mo id="S2.p1.4.m4.2.3.1" xref="S2.p1.4.m4.2.3.1.cmml">
        ∈
       </mo>
       <mrow id="S2.p1.4.m4.2.3.3.2" xref="S2.p1.4.m4.2.3.3.1.cmml">
        <mo id="S2.p1.4.m4.2.3.3.2.1" stretchy="false" xref="S2.p1.4.m4.2.3.3.1.cmml">
         [
        </mo>
        <mn id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">
         0
        </mn>
        <mo id="S2.p1.4.m4.2.3.3.2.2" xref="S2.p1.4.m4.2.3.3.1.cmml">
         ,
        </mo>
        <mn id="S2.p1.4.m4.2.2" xref="S2.p1.4.m4.2.2.cmml">
         1
        </mn>
        <mo id="S2.p1.4.m4.2.3.3.2.3" stretchy="false" xref="S2.p1.4.m4.2.3.3.1.cmml">
         ]
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.2b">
       <apply id="S2.p1.4.m4.2.3.cmml" xref="S2.p1.4.m4.2.3">
        <in id="S2.p1.4.m4.2.3.1.cmml" xref="S2.p1.4.m4.2.3.1">
        </in>
        <apply id="S2.p1.4.m4.2.3.2.cmml" xref="S2.p1.4.m4.2.3.2">
         <csymbol cd="ambiguous" id="S2.p1.4.m4.2.3.2.1.cmml" xref="S2.p1.4.m4.2.3.2">
          subscript
         </csymbol>
         <ci id="S2.p1.4.m4.2.3.2.2.cmml" xref="S2.p1.4.m4.2.3.2.2">
          𝜇
         </ci>
         <ci id="S2.p1.4.m4.2.3.2.3.cmml" xref="S2.p1.4.m4.2.3.2.3">
          𝑎
         </ci>
        </apply>
        <interval closure="closed" id="S2.p1.4.m4.2.3.3.1.cmml" xref="S2.p1.4.m4.2.3.3.2">
         <cn id="S2.p1.4.m4.1.1.cmml" type="integer" xref="S2.p1.4.m4.1.1">
          0
         </cn>
         <cn id="S2.p1.4.m4.2.2.cmml" type="integer" xref="S2.p1.4.m4.2.2">
          1
         </cn>
        </interval>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p1.4.m4.2c">
       \mu_{a}\in[0,1]
      </annotation>
     </semantics>
    </math>
    , which is unknown.
An agent interacts with the environment for
    <math alttext="T" class="ltx_Math" display="inline" id="S2.p1.5.m5.1">
     <semantics id="S2.p1.5.m5.1a">
      <mi id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">
       T
      </mi>
      <annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b">
       <ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">
        𝑇
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">
       T
      </annotation>
     </semantics>
    </math>
    time steps, where in each time step
    <math alttext="t\in[T]" class="ltx_Math" display="inline" id="S2.p1.6.m6.1">
     <semantics id="S2.p1.6.m6.1a">
      <mrow id="S2.p1.6.m6.1.2" xref="S2.p1.6.m6.1.2.cmml">
       <mi id="S2.p1.6.m6.1.2.2" xref="S2.p1.6.m6.1.2.2.cmml">
        t
       </mi>
       <mo id="S2.p1.6.m6.1.2.1" xref="S2.p1.6.m6.1.2.1.cmml">
        ∈
       </mo>
       <mrow id="S2.p1.6.m6.1.2.3.2" xref="S2.p1.6.m6.1.2.3.1.cmml">
        <mo id="S2.p1.6.m6.1.2.3.2.1" stretchy="false" xref="S2.p1.6.m6.1.2.3.1.1.cmml">
         [
        </mo>
        <mi id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml">
         T
        </mi>
        <mo id="S2.p1.6.m6.1.2.3.2.2" stretchy="false" xref="S2.p1.6.m6.1.2.3.1.1.cmml">
         ]
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b">
       <apply id="S2.p1.6.m6.1.2.cmml" xref="S2.p1.6.m6.1.2">
        <in id="S2.p1.6.m6.1.2.1.cmml" xref="S2.p1.6.m6.1.2.1">
        </in>
        <ci id="S2.p1.6.m6.1.2.2.cmml" xref="S2.p1.6.m6.1.2.2">
         𝑡
        </ci>
        <apply id="S2.p1.6.m6.1.2.3.1.cmml" xref="S2.p1.6.m6.1.2.3.2">
         <csymbol cd="latexml" id="S2.p1.6.m6.1.2.3.1.1.cmml" xref="S2.p1.6.m6.1.2.3.2.1">
          delimited-[]
         </csymbol>
         <ci id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1">
          𝑇
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">
       t\in[T]
      </annotation>
     </semantics>
    </math>
    the agent selects an arm
    <math alttext="a_{t}\in[K]" class="ltx_Math" display="inline" id="S2.p1.7.m7.1">
     <semantics id="S2.p1.7.m7.1a">
      <mrow id="S2.p1.7.m7.1.2" xref="S2.p1.7.m7.1.2.cmml">
       <msub id="S2.p1.7.m7.1.2.2" xref="S2.p1.7.m7.1.2.2.cmml">
        <mi id="S2.p1.7.m7.1.2.2.2" xref="S2.p1.7.m7.1.2.2.2.cmml">
         a
        </mi>
        <mi id="S2.p1.7.m7.1.2.2.3" xref="S2.p1.7.m7.1.2.2.3.cmml">
         t
        </mi>
       </msub>
       <mo id="S2.p1.7.m7.1.2.1" xref="S2.p1.7.m7.1.2.1.cmml">
        ∈
       </mo>
       <mrow id="S2.p1.7.m7.1.2.3.2" xref="S2.p1.7.m7.1.2.3.1.cmml">
        <mo id="S2.p1.7.m7.1.2.3.2.1" stretchy="false" xref="S2.p1.7.m7.1.2.3.1.1.cmml">
         [
        </mo>
        <mi id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml">
         K
        </mi>
        <mo id="S2.p1.7.m7.1.2.3.2.2" stretchy="false" xref="S2.p1.7.m7.1.2.3.1.1.cmml">
         ]
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b">
       <apply id="S2.p1.7.m7.1.2.cmml" xref="S2.p1.7.m7.1.2">
        <in id="S2.p1.7.m7.1.2.1.cmml" xref="S2.p1.7.m7.1.2.1">
        </in>
        <apply id="S2.p1.7.m7.1.2.2.cmml" xref="S2.p1.7.m7.1.2.2">
         <csymbol cd="ambiguous" id="S2.p1.7.m7.1.2.2.1.cmml" xref="S2.p1.7.m7.1.2.2">
          subscript
         </csymbol>
         <ci id="S2.p1.7.m7.1.2.2.2.cmml" xref="S2.p1.7.m7.1.2.2.2">
          𝑎
         </ci>
         <ci id="S2.p1.7.m7.1.2.2.3.cmml" xref="S2.p1.7.m7.1.2.2.3">
          𝑡
         </ci>
        </apply>
        <apply id="S2.p1.7.m7.1.2.3.1.cmml" xref="S2.p1.7.m7.1.2.3.2">
         <csymbol cd="latexml" id="S2.p1.7.m7.1.2.3.1.1.cmml" xref="S2.p1.7.m7.1.2.3.2.1">
          delimited-[]
         </csymbol>
         <ci id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1">
          𝐾
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">
       a_{t}\in[K]
      </annotation>
     </semantics>
    </math>
    and receives a reward
    <math alttext="r_{t}\in\{0,1\}" class="ltx_Math" display="inline" id="S2.p1.8.m8.2">
     <semantics id="S2.p1.8.m8.2a">
      <mrow id="S2.p1.8.m8.2.3" xref="S2.p1.8.m8.2.3.cmml">
       <msub id="S2.p1.8.m8.2.3.2" xref="S2.p1.8.m8.2.3.2.cmml">
        <mi id="S2.p1.8.m8.2.3.2.2" xref="S2.p1.8.m8.2.3.2.2.cmml">
         r
        </mi>
        <mi id="S2.p1.8.m8.2.3.2.3" xref="S2.p1.8.m8.2.3.2.3.cmml">
         t
        </mi>
       </msub>
       <mo id="S2.p1.8.m8.2.3.1" xref="S2.p1.8.m8.2.3.1.cmml">
        ∈
       </mo>
       <mrow id="S2.p1.8.m8.2.3.3.2" xref="S2.p1.8.m8.2.3.3.1.cmml">
        <mo id="S2.p1.8.m8.2.3.3.2.1" stretchy="false" xref="S2.p1.8.m8.2.3.3.1.cmml">
         {
        </mo>
        <mn id="S2.p1.8.m8.1.1" xref="S2.p1.8.m8.1.1.cmml">
         0
        </mn>
        <mo id="S2.p1.8.m8.2.3.3.2.2" xref="S2.p1.8.m8.2.3.3.1.cmml">
         ,
        </mo>
        <mn id="S2.p1.8.m8.2.2" xref="S2.p1.8.m8.2.2.cmml">
         1
        </mn>
        <mo id="S2.p1.8.m8.2.3.3.2.3" stretchy="false" xref="S2.p1.8.m8.2.3.3.1.cmml">
         }
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.2b">
       <apply id="S2.p1.8.m8.2.3.cmml" xref="S2.p1.8.m8.2.3">
        <in id="S2.p1.8.m8.2.3.1.cmml" xref="S2.p1.8.m8.2.3.1">
        </in>
        <apply id="S2.p1.8.m8.2.3.2.cmml" xref="S2.p1.8.m8.2.3.2">
         <csymbol cd="ambiguous" id="S2.p1.8.m8.2.3.2.1.cmml" xref="S2.p1.8.m8.2.3.2">
          subscript
         </csymbol>
         <ci id="S2.p1.8.m8.2.3.2.2.cmml" xref="S2.p1.8.m8.2.3.2.2">
          𝑟
         </ci>
         <ci id="S2.p1.8.m8.2.3.2.3.cmml" xref="S2.p1.8.m8.2.3.2.3">
          𝑡
         </ci>
        </apply>
        <set id="S2.p1.8.m8.2.3.3.1.cmml" xref="S2.p1.8.m8.2.3.3.2">
         <cn id="S2.p1.8.m8.1.1.cmml" type="integer" xref="S2.p1.8.m8.1.1">
          0
         </cn>
         <cn id="S2.p1.8.m8.2.2.cmml" type="integer" xref="S2.p1.8.m8.2.2">
          1
         </cn>
        </set>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p1.8.m8.2c">
       r_{t}\in\{0,1\}
      </annotation>
     </semantics>
    </math>
    drawn independently from a Bernoulli distribution with mean
    <math alttext="\mu_{a_{t}}" class="ltx_Math" display="inline" id="S2.p1.9.m9.1">
     <semantics id="S2.p1.9.m9.1a">
      <msub id="S2.p1.9.m9.1.1" xref="S2.p1.9.m9.1.1.cmml">
       <mi id="S2.p1.9.m9.1.1.2" xref="S2.p1.9.m9.1.1.2.cmml">
        μ
       </mi>
       <msub id="S2.p1.9.m9.1.1.3" xref="S2.p1.9.m9.1.1.3.cmml">
        <mi id="S2.p1.9.m9.1.1.3.2" xref="S2.p1.9.m9.1.1.3.2.cmml">
         a
        </mi>
        <mi id="S2.p1.9.m9.1.1.3.3" xref="S2.p1.9.m9.1.1.3.3.cmml">
         t
        </mi>
       </msub>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S2.p1.9.m9.1b">
       <apply id="S2.p1.9.m9.1.1.cmml" xref="S2.p1.9.m9.1.1">
        <csymbol cd="ambiguous" id="S2.p1.9.m9.1.1.1.cmml" xref="S2.p1.9.m9.1.1">
         subscript
        </csymbol>
        <ci id="S2.p1.9.m9.1.1.2.cmml" xref="S2.p1.9.m9.1.1.2">
         𝜇
        </ci>
        <apply id="S2.p1.9.m9.1.1.3.cmml" xref="S2.p1.9.m9.1.1.3">
         <csymbol cd="ambiguous" id="S2.p1.9.m9.1.1.3.1.cmml" xref="S2.p1.9.m9.1.1.3">
          subscript
         </csymbol>
         <ci id="S2.p1.9.m9.1.1.3.2.cmml" xref="S2.p1.9.m9.1.1.3.2">
          𝑎
         </ci>
         <ci id="S2.p1.9.m9.1.1.3.3.cmml" xref="S2.p1.9.m9.1.1.3.3">
          𝑡
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p1.9.m9.1c">
       \mu_{a_{t}}
      </annotation>
     </semantics>
    </math>
    . Thus, the MAB instance is determined by the mean rewards
    <math alttext="\left(\mu_{a}:\,a\in[K]\right)" class="ltx_Math" display="inline" id="S2.p1.10.m10.2">
     <semantics id="S2.p1.10.m10.2a">
      <mrow id="S2.p1.10.m10.2.2.1" xref="S2.p1.10.m10.2.2.1.1.cmml">
       <mo id="S2.p1.10.m10.2.2.1.2" xref="S2.p1.10.m10.2.2.1.1.cmml">
        (
       </mo>
       <mrow id="S2.p1.10.m10.2.2.1.1" xref="S2.p1.10.m10.2.2.1.1.cmml">
        <msub id="S2.p1.10.m10.2.2.1.1.2" xref="S2.p1.10.m10.2.2.1.1.2.cmml">
         <mi id="S2.p1.10.m10.2.2.1.1.2.2" xref="S2.p1.10.m10.2.2.1.1.2.2.cmml">
          μ
         </mi>
         <mi id="S2.p1.10.m10.2.2.1.1.2.3" xref="S2.p1.10.m10.2.2.1.1.2.3.cmml">
          a
         </mi>
        </msub>
        <mo id="S2.p1.10.m10.2.2.1.1.1" lspace="0.278em" rspace="0.448em" xref="S2.p1.10.m10.2.2.1.1.1.cmml">
         :
        </mo>
        <mrow id="S2.p1.10.m10.2.2.1.1.3" xref="S2.p1.10.m10.2.2.1.1.3.cmml">
         <mi id="S2.p1.10.m10.2.2.1.1.3.2" xref="S2.p1.10.m10.2.2.1.1.3.2.cmml">
          a
         </mi>
         <mo id="S2.p1.10.m10.2.2.1.1.3.1" xref="S2.p1.10.m10.2.2.1.1.3.1.cmml">
          ∈
         </mo>
         <mrow id="S2.p1.10.m10.2.2.1.1.3.3.2" xref="S2.p1.10.m10.2.2.1.1.3.3.1.cmml">
          <mo id="S2.p1.10.m10.2.2.1.1.3.3.2.1" stretchy="false" xref="S2.p1.10.m10.2.2.1.1.3.3.1.1.cmml">
           [
          </mo>
          <mi id="S2.p1.10.m10.1.1" xref="S2.p1.10.m10.1.1.cmml">
           K
          </mi>
          <mo id="S2.p1.10.m10.2.2.1.1.3.3.2.2" stretchy="false" xref="S2.p1.10.m10.2.2.1.1.3.3.1.1.cmml">
           ]
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <mo id="S2.p1.10.m10.2.2.1.3" xref="S2.p1.10.m10.2.2.1.1.cmml">
        )
       </mo>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p1.10.m10.2b">
       <apply id="S2.p1.10.m10.2.2.1.1.cmml" xref="S2.p1.10.m10.2.2.1">
        <ci id="S2.p1.10.m10.2.2.1.1.1.cmml" xref="S2.p1.10.m10.2.2.1.1.1">
         :
        </ci>
        <apply id="S2.p1.10.m10.2.2.1.1.2.cmml" xref="S2.p1.10.m10.2.2.1.1.2">
         <csymbol cd="ambiguous" id="S2.p1.10.m10.2.2.1.1.2.1.cmml" xref="S2.p1.10.m10.2.2.1.1.2">
          subscript
         </csymbol>
         <ci id="S2.p1.10.m10.2.2.1.1.2.2.cmml" xref="S2.p1.10.m10.2.2.1.1.2.2">
          𝜇
         </ci>
         <ci id="S2.p1.10.m10.2.2.1.1.2.3.cmml" xref="S2.p1.10.m10.2.2.1.1.2.3">
          𝑎
         </ci>
        </apply>
        <apply id="S2.p1.10.m10.2.2.1.1.3.cmml" xref="S2.p1.10.m10.2.2.1.1.3">
         <in id="S2.p1.10.m10.2.2.1.1.3.1.cmml" xref="S2.p1.10.m10.2.2.1.1.3.1">
         </in>
         <ci id="S2.p1.10.m10.2.2.1.1.3.2.cmml" xref="S2.p1.10.m10.2.2.1.1.3.2">
          𝑎
         </ci>
         <apply id="S2.p1.10.m10.2.2.1.1.3.3.1.cmml" xref="S2.p1.10.m10.2.2.1.1.3.3.2">
          <csymbol cd="latexml" id="S2.p1.10.m10.2.2.1.1.3.3.1.1.cmml" xref="S2.p1.10.m10.2.2.1.1.3.3.2.1">
           delimited-[]
          </csymbol>
          <ci id="S2.p1.10.m10.1.1.cmml" xref="S2.p1.10.m10.1.1">
           𝐾
          </ci>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p1.10.m10.2c">
       \left(\mu_{a}:\,a\in[K]\right)
      </annotation>
     </semantics>
    </math>
    and the time horizon
    <math alttext="T" class="ltx_Math" display="inline" id="S2.p1.11.m11.1">
     <semantics id="S2.p1.11.m11.1a">
      <mi id="S2.p1.11.m11.1.1" xref="S2.p1.11.m11.1.1.cmml">
       T
      </mi>
      <annotation-xml encoding="MathML-Content" id="S2.p1.11.m11.1b">
       <ci id="S2.p1.11.m11.1.1.cmml" xref="S2.p1.11.m11.1.1">
        𝑇
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p1.11.m11.1c">
       T
      </annotation>
     </semantics>
    </math>
    . The goal is to maximize the total reward, which roughly corresponds to identifying the
    <em class="ltx_emph ltx_font_italic" id="S2.p1.11.4">
     best arm
    </em>
    : an arm with the highest mean reward.
A key feature of the MAB setup is that rewards for arms not chosen by the agent are not revealed, so exploration is necessary to identify the best arm.
   </p>
  </div>
  <div class="ltx_para" id="S2.p2">
   <p class="ltx_p" id="S2.p2.8">
    We focus on MAB instances where the best arm has mean reward
    <math alttext="\mu^{\star}=0.5+\Delta/2" class="ltx_Math" display="inline" id="S2.p2.1.m1.1">
     <semantics id="S2.p2.1.m1.1a">
      <mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">
       <msup id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">
        <mi id="S2.p2.1.m1.1.1.2.2" xref="S2.p2.1.m1.1.1.2.2.cmml">
         μ
        </mi>
        <mo id="S2.p2.1.m1.1.1.2.3" xref="S2.p2.1.m1.1.1.2.3.cmml">
         ⋆
        </mo>
       </msup>
       <mo id="S2.p2.1.m1.1.1.1" xref="S2.p2.1.m1.1.1.1.cmml">
        =
       </mo>
       <mrow id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">
        <mn id="S2.p2.1.m1.1.1.3.2" xref="S2.p2.1.m1.1.1.3.2.cmml">
         0.5
        </mn>
        <mo id="S2.p2.1.m1.1.1.3.1" xref="S2.p2.1.m1.1.1.3.1.cmml">
         +
        </mo>
        <mrow id="S2.p2.1.m1.1.1.3.3" xref="S2.p2.1.m1.1.1.3.3.cmml">
         <mi id="S2.p2.1.m1.1.1.3.3.2" mathvariant="normal" xref="S2.p2.1.m1.1.1.3.3.2.cmml">
          Δ
         </mi>
         <mo id="S2.p2.1.m1.1.1.3.3.1" xref="S2.p2.1.m1.1.1.3.3.1.cmml">
          /
         </mo>
         <mn id="S2.p2.1.m1.1.1.3.3.3" xref="S2.p2.1.m1.1.1.3.3.3.cmml">
          2
         </mn>
        </mrow>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b">
       <apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">
        <eq id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1">
        </eq>
        <apply id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">
         <csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.2.1.cmml" xref="S2.p2.1.m1.1.1.2">
          superscript
         </csymbol>
         <ci id="S2.p2.1.m1.1.1.2.2.cmml" xref="S2.p2.1.m1.1.1.2.2">
          𝜇
         </ci>
         <ci id="S2.p2.1.m1.1.1.2.3.cmml" xref="S2.p2.1.m1.1.1.2.3">
          ⋆
         </ci>
        </apply>
        <apply id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3">
         <plus id="S2.p2.1.m1.1.1.3.1.cmml" xref="S2.p2.1.m1.1.1.3.1">
         </plus>
         <cn id="S2.p2.1.m1.1.1.3.2.cmml" type="float" xref="S2.p2.1.m1.1.1.3.2">
          0.5
         </cn>
         <apply id="S2.p2.1.m1.1.1.3.3.cmml" xref="S2.p2.1.m1.1.1.3.3">
          <divide id="S2.p2.1.m1.1.1.3.3.1.cmml" xref="S2.p2.1.m1.1.1.3.3.1">
          </divide>
          <ci id="S2.p2.1.m1.1.1.3.3.2.cmml" xref="S2.p2.1.m1.1.1.3.3.2">
           Δ
          </ci>
          <cn id="S2.p2.1.m1.1.1.3.3.3.cmml" type="integer" xref="S2.p2.1.m1.1.1.3.3.3">
           2
          </cn>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">
       \mu^{\star}=0.5+\Delta/2
      </annotation>
     </semantics>
    </math>
    for a parameter
    <math alttext="\Delta&gt;0" class="ltx_Math" display="inline" id="S2.p2.2.m2.1">
     <semantics id="S2.p2.2.m2.1a">
      <mrow id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">
       <mi id="S2.p2.2.m2.1.1.2" mathvariant="normal" xref="S2.p2.2.m2.1.1.2.cmml">
        Δ
       </mi>
       <mo id="S2.p2.2.m2.1.1.1" xref="S2.p2.2.m2.1.1.1.cmml">
        &gt;
       </mo>
       <mn id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">
        0
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b">
       <apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">
        <gt id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1">
        </gt>
        <ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">
         Δ
        </ci>
        <cn id="S2.p2.2.m2.1.1.3.cmml" type="integer" xref="S2.p2.2.m2.1.1.3">
         0
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">
       \Delta&gt;0
      </annotation>
     </semantics>
    </math>
    , while all other arms have mean reward
    <math alttext="\mu=0.5-\Delta/2" class="ltx_Math" display="inline" id="S2.p2.3.m3.1">
     <semantics id="S2.p2.3.m3.1a">
      <mrow id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">
       <mi id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">
        μ
       </mi>
       <mo id="S2.p2.3.m3.1.1.1" xref="S2.p2.3.m3.1.1.1.cmml">
        =
       </mo>
       <mrow id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml">
        <mn id="S2.p2.3.m3.1.1.3.2" xref="S2.p2.3.m3.1.1.3.2.cmml">
         0.5
        </mn>
        <mo id="S2.p2.3.m3.1.1.3.1" xref="S2.p2.3.m3.1.1.3.1.cmml">
         −
        </mo>
        <mrow id="S2.p2.3.m3.1.1.3.3" xref="S2.p2.3.m3.1.1.3.3.cmml">
         <mi id="S2.p2.3.m3.1.1.3.3.2" mathvariant="normal" xref="S2.p2.3.m3.1.1.3.3.2.cmml">
          Δ
         </mi>
         <mo id="S2.p2.3.m3.1.1.3.3.1" xref="S2.p2.3.m3.1.1.3.3.1.cmml">
          /
         </mo>
         <mn id="S2.p2.3.m3.1.1.3.3.3" xref="S2.p2.3.m3.1.1.3.3.3.cmml">
          2
         </mn>
        </mrow>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b">
       <apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">
        <eq id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1.1">
        </eq>
        <ci id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">
         𝜇
        </ci>
        <apply id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3">
         <minus id="S2.p2.3.m3.1.1.3.1.cmml" xref="S2.p2.3.m3.1.1.3.1">
         </minus>
         <cn id="S2.p2.3.m3.1.1.3.2.cmml" type="float" xref="S2.p2.3.m3.1.1.3.2">
          0.5
         </cn>
         <apply id="S2.p2.3.m3.1.1.3.3.cmml" xref="S2.p2.3.m3.1.1.3.3">
          <divide id="S2.p2.3.m3.1.1.3.3.1.cmml" xref="S2.p2.3.m3.1.1.3.3.1">
          </divide>
          <ci id="S2.p2.3.m3.1.1.3.3.2.cmml" xref="S2.p2.3.m3.1.1.3.3.2">
           Δ
          </ci>
          <cn id="S2.p2.3.m3.1.1.3.3.3.cmml" type="integer" xref="S2.p2.3.m3.1.1.3.3.3">
           2
          </cn>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">
       \mu=0.5-\Delta/2
      </annotation>
     </semantics>
    </math>
    (so,
    <math alttext="\Delta=\mu^{\star}-\mu" class="ltx_Math" display="inline" id="S2.p2.4.m4.1">
     <semantics id="S2.p2.4.m4.1a">
      <mrow id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml">
       <mi id="S2.p2.4.m4.1.1.2" mathvariant="normal" xref="S2.p2.4.m4.1.1.2.cmml">
        Δ
       </mi>
       <mo id="S2.p2.4.m4.1.1.1" xref="S2.p2.4.m4.1.1.1.cmml">
        =
       </mo>
       <mrow id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml">
        <msup id="S2.p2.4.m4.1.1.3.2" xref="S2.p2.4.m4.1.1.3.2.cmml">
         <mi id="S2.p2.4.m4.1.1.3.2.2" xref="S2.p2.4.m4.1.1.3.2.2.cmml">
          μ
         </mi>
         <mo id="S2.p2.4.m4.1.1.3.2.3" xref="S2.p2.4.m4.1.1.3.2.3.cmml">
          ⋆
         </mo>
        </msup>
        <mo id="S2.p2.4.m4.1.1.3.1" xref="S2.p2.4.m4.1.1.3.1.cmml">
         −
        </mo>
        <mi id="S2.p2.4.m4.1.1.3.3" xref="S2.p2.4.m4.1.1.3.3.cmml">
         μ
        </mi>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b">
       <apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1">
        <eq id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1.1">
        </eq>
        <ci id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2">
         Δ
        </ci>
        <apply id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3">
         <minus id="S2.p2.4.m4.1.1.3.1.cmml" xref="S2.p2.4.m4.1.1.3.1">
         </minus>
         <apply id="S2.p2.4.m4.1.1.3.2.cmml" xref="S2.p2.4.m4.1.1.3.2">
          <csymbol cd="ambiguous" id="S2.p2.4.m4.1.1.3.2.1.cmml" xref="S2.p2.4.m4.1.1.3.2">
           superscript
          </csymbol>
          <ci id="S2.p2.4.m4.1.1.3.2.2.cmml" xref="S2.p2.4.m4.1.1.3.2.2">
           𝜇
          </ci>
          <ci id="S2.p2.4.m4.1.1.3.2.3.cmml" xref="S2.p2.4.m4.1.1.3.2.3">
           ⋆
          </ci>
         </apply>
         <ci id="S2.p2.4.m4.1.1.3.3.cmml" xref="S2.p2.4.m4.1.1.3.3">
          𝜇
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">
       \Delta=\mu^{\star}-\mu
      </annotation>
     </semantics>
    </math>
    is the
    <em class="ltx_emph ltx_font_italic" id="S2.p2.8.1">
     gap
    </em>
    between the best and the second-best arm).
The main instance we consider has
    <math alttext="K=5" class="ltx_Math" display="inline" id="S2.p2.5.m5.1">
     <semantics id="S2.p2.5.m5.1a">
      <mrow id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml">
       <mi id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">
        K
       </mi>
       <mo id="S2.p2.5.m5.1.1.1" xref="S2.p2.5.m5.1.1.1.cmml">
        =
       </mo>
       <mn id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml">
        5
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b">
       <apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1">
        <eq id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1.1">
        </eq>
        <ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">
         𝐾
        </ci>
        <cn id="S2.p2.5.m5.1.1.3.cmml" type="integer" xref="S2.p2.5.m5.1.1.3">
         5
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">
       K=5
      </annotation>
     </semantics>
    </math>
    arms and gap
    <math alttext="\Delta=0.2" class="ltx_Math" display="inline" id="S2.p2.6.m6.1">
     <semantics id="S2.p2.6.m6.1a">
      <mrow id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml">
       <mi id="S2.p2.6.m6.1.1.2" mathvariant="normal" xref="S2.p2.6.m6.1.1.2.cmml">
        Δ
       </mi>
       <mo id="S2.p2.6.m6.1.1.1" xref="S2.p2.6.m6.1.1.1.cmml">
        =
       </mo>
       <mn id="S2.p2.6.m6.1.1.3" xref="S2.p2.6.m6.1.1.3.cmml">
        0.2
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b">
       <apply id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1">
        <eq id="S2.p2.6.m6.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1">
        </eq>
        <ci id="S2.p2.6.m6.1.1.2.cmml" xref="S2.p2.6.m6.1.1.2">
         Δ
        </ci>
        <cn id="S2.p2.6.m6.1.1.3.cmml" type="float" xref="S2.p2.6.m6.1.1.3">
         0.2
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">
       \Delta=0.2
      </annotation>
     </semantics>
    </math>
    . We call this the
    <span class="ltx_text ltx_font_typewriter" id="S2.p2.8.2">
     hard
    </span>
    instance, as we also consider an
    <span class="ltx_text ltx_font_typewriter" id="S2.p2.8.3">
     easy
    </span>
    instance with
    <math alttext="K=4" class="ltx_Math" display="inline" id="S2.p2.7.m7.1">
     <semantics id="S2.p2.7.m7.1a">
      <mrow id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml">
       <mi id="S2.p2.7.m7.1.1.2" xref="S2.p2.7.m7.1.1.2.cmml">
        K
       </mi>
       <mo id="S2.p2.7.m7.1.1.1" xref="S2.p2.7.m7.1.1.1.cmml">
        =
       </mo>
       <mn id="S2.p2.7.m7.1.1.3" xref="S2.p2.7.m7.1.1.3.cmml">
        4
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b">
       <apply id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1">
        <eq id="S2.p2.7.m7.1.1.1.cmml" xref="S2.p2.7.m7.1.1.1">
        </eq>
        <ci id="S2.p2.7.m7.1.1.2.cmml" xref="S2.p2.7.m7.1.1.2">
         𝐾
        </ci>
        <cn id="S2.p2.7.m7.1.1.3.cmml" type="integer" xref="S2.p2.7.m7.1.1.3">
         4
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">
       K=4
      </annotation>
     </semantics>
    </math>
    and
    <math alttext="\Delta=0.5" class="ltx_Math" display="inline" id="S2.p2.8.m8.1">
     <semantics id="S2.p2.8.m8.1a">
      <mrow id="S2.p2.8.m8.1.1" xref="S2.p2.8.m8.1.1.cmml">
       <mi id="S2.p2.8.m8.1.1.2" mathvariant="normal" xref="S2.p2.8.m8.1.1.2.cmml">
        Δ
       </mi>
       <mo id="S2.p2.8.m8.1.1.1" xref="S2.p2.8.m8.1.1.1.cmml">
        =
       </mo>
       <mn id="S2.p2.8.m8.1.1.3" xref="S2.p2.8.m8.1.1.3.cmml">
        0.5
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.1b">
       <apply id="S2.p2.8.m8.1.1.cmml" xref="S2.p2.8.m8.1.1">
        <eq id="S2.p2.8.m8.1.1.1.cmml" xref="S2.p2.8.m8.1.1.1">
        </eq>
        <ci id="S2.p2.8.m8.1.1.2.cmml" xref="S2.p2.8.m8.1.1.2">
         Δ
        </ci>
        <cn id="S2.p2.8.m8.1.1.3.cmml" type="float" xref="S2.p2.8.m8.1.1.3">
         0.5
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p2.8.m8.1c">
       \Delta=0.5
      </annotation>
     </semantics>
    </math>
    .
    <span class="ltx_note ltx_role_footnote" id="footnote4">
     <sup class="ltx_note_mark">
      4
     </sup>
     <span class="ltx_note_outer">
      <span class="ltx_note_content">
       <sup class="ltx_note_mark">
        4
       </sup>
       <span class="ltx_tag ltx_tag_note">
        4
       </span>
       A larger gap
       <math alttext="\Delta" class="ltx_Math" display="inline" id="footnote4.m1.1">
        <semantics id="footnote4.m1.1b">
         <mi id="footnote4.m1.1.1" mathvariant="normal" xref="footnote4.m1.1.1.cmml">
          Δ
         </mi>
         <annotation-xml encoding="MathML-Content" id="footnote4.m1.1c">
          <ci id="footnote4.m1.1.1.cmml" xref="footnote4.m1.1.1">
           Δ
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="footnote4.m1.1d">
          \Delta
         </annotation>
        </semantics>
       </math>
       makes it easier to distinguish arms, while smaller
       <math alttext="K" class="ltx_Math" display="inline" id="footnote4.m2.1">
        <semantics id="footnote4.m2.1b">
         <mi id="footnote4.m2.1.1" xref="footnote4.m2.1.1.cmml">
          K
         </mi>
         <annotation-xml encoding="MathML-Content" id="footnote4.m2.1c">
          <ci id="footnote4.m2.1.1.cmml" xref="footnote4.m2.1.1">
           𝐾
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="footnote4.m2.1d">
          K
         </annotation>
        </semantics>
       </math>
       means there are fewer alternatives to explore.
      </span>
     </span>
    </span>
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S2.p3">
   <p class="ltx_p" id="S2.p3.2">
    <span class="ltx_text ltx_font_bold" id="S2.p3.2.1">
     Prompts.
    </span>
    We employ LLMs to operate as decision making agents that interact with MAB instances by prompting them
with a description of the MAB problem (including the time horizon
    <math alttext="T" class="ltx_Math" display="inline" id="S2.p3.1.m1.1">
     <semantics id="S2.p3.1.m1.1a">
      <mi id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">
       T
      </mi>
      <annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b">
       <ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">
        𝑇
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">
       T
      </annotation>
     </semantics>
    </math>
    ) and the history of interaction thus far. Our prompt design allows several independent choices.
First is a “scenario”, which provides a grounding for the decision making problem, positioning the LLM either a) as an agent choosing
    <em class="ltx_emph ltx_font_italic" id="S2.p3.2.2">
     buttons
    </em>
    to press, or b) as a recommendation engine displaying
    <em class="ltx_emph ltx_font_italic" id="S2.p3.2.3">
     advertisements
    </em>
    to users.
Second, we specify a “framing” as either a) explicitly
    <em class="ltx_emph ltx_font_italic" id="S2.p3.2.4">
     suggestive
    </em>
    of the need to balance exploration and exploitation, or b)
    <em class="ltx_emph ltx_font_italic" id="S2.p3.2.5">
     neutral
    </em>
    .
Third, the history can be presented as a) a
    <em class="ltx_emph ltx_font_italic" id="S2.p3.2.6">
     raw
    </em>
    list over rounds, or it can b) be
    <em class="ltx_emph ltx_font_italic" id="S2.p3.2.7">
     summarized
    </em>
    via number of plays and average rewards of each arm.
Fourth, the requested final answer can be a) a single
    <em class="ltx_emph ltx_font_italic" id="S2.p3.2.8">
     arm
    </em>
    , or b) a
    <em class="ltx_emph ltx_font_italic" id="S2.p3.2.9">
     distribution
    </em>
    over arms.
Finally, we either a) request the answer only, or b) also allow the LLM to provide a “chain-of-thought” (CoT) explanation.
Altogether, these choices lead to
    <math alttext="2^{5}=32" class="ltx_Math" display="inline" id="S2.p3.2.m2.1">
     <semantics id="S2.p3.2.m2.1a">
      <mrow id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">
       <msup id="S2.p3.2.m2.1.1.2" xref="S2.p3.2.m2.1.1.2.cmml">
        <mn id="S2.p3.2.m2.1.1.2.2" xref="S2.p3.2.m2.1.1.2.2.cmml">
         2
        </mn>
        <mn id="S2.p3.2.m2.1.1.2.3" xref="S2.p3.2.m2.1.1.2.3.cmml">
         5
        </mn>
       </msup>
       <mo id="S2.p3.2.m2.1.1.1" xref="S2.p3.2.m2.1.1.1.cmml">
        =
       </mo>
       <mn id="S2.p3.2.m2.1.1.3" xref="S2.p3.2.m2.1.1.3.cmml">
        32
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b">
       <apply id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">
        <eq id="S2.p3.2.m2.1.1.1.cmml" xref="S2.p3.2.m2.1.1.1">
        </eq>
        <apply id="S2.p3.2.m2.1.1.2.cmml" xref="S2.p3.2.m2.1.1.2">
         <csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.2.1.cmml" xref="S2.p3.2.m2.1.1.2">
          superscript
         </csymbol>
         <cn id="S2.p3.2.m2.1.1.2.2.cmml" type="integer" xref="S2.p3.2.m2.1.1.2.2">
          2
         </cn>
         <cn id="S2.p3.2.m2.1.1.2.3.cmml" type="integer" xref="S2.p3.2.m2.1.1.2.3">
          5
         </cn>
        </apply>
        <cn id="S2.p3.2.m2.1.1.3.cmml" type="integer" xref="S2.p3.2.m2.1.1.3">
         32
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">
       2^{5}=32
      </annotation>
     </semantics>
    </math>
    prompt designs, illustrated in
    <a class="ltx_ref" href="#S2.F2" title="Figure 2 ‣ 2 Experimental setup ‣ Can large language models explore in-context?">
     Figure
     <span class="ltx_ref ltx_nolink">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </span>
    </a>
    .
More details about the prompt design, including examples, are provided in
    <a class="ltx_ref" href="#A1" title="Appendix A Prompt designs ‣ Can large language models explore in-context?">
     Appendix
     <span class="ltx_ref ltx_nolink">
      <span class="ltx_text ltx_ref_tag">
       A
      </span>
     </span>
    </a>
    .
   </p>
  </div>
  <div class="ltx_para" id="S2.p4">
   <p class="ltx_p" id="S2.p4.1">
    The most basic prompt design from the options above uses the buttons scenario, neutral framing, and raw history, and requests the LLM to return only an arm with no CoT.
Each of the five possible modifications to this prompt can potentially help the LLM, and our experiments evaluate this.
For example, both the advertising scenario and suggestive framing might help invoke the LLM’s knowledge of bandit algorithms (as bandit algorithms are commonly used in content recommendation).
History summarization might help if the LLM cannot reliably summarize history itself (perhaps due to arithmetic errors
    <span class="ltx_note ltx_role_footnote" id="footnote5">
     <sup class="ltx_note_mark">
      5
     </sup>
     <span class="ltx_note_outer">
      <span class="ltx_note_content">
       <sup class="ltx_note_mark">
        5
       </sup>
       <span class="ltx_tag ltx_tag_note">
        5
       </span>
       E.g., LLMs sometimes fail at basic arithmetic
       <cite class="ltx_cite ltx_citemacro_citep">
        (Gao et al.,
        <a class="ltx_ref" href="#bib.bib22" title="">
         2023
        </a>
        ; Liu et al.,
        <a class="ltx_ref" href="#bib.bib42" title="">
         2024
        </a>
        )
       </cite>
       , though this is likely to improve in the near future via better training and/or integrating calculator-like tools.
      </span>
     </span>
    </span>
    )
and/or does not fully realize that it should. Returning a distribution might help if the LLM can identify a good distribution, but fails to correctly sample from it. Finally, chain-of-thought is known to help in a wide variety of LLM scenarios
    <cite class="ltx_cite ltx_citemacro_citep">
     (Wei et al.,
     <a class="ltx_ref" href="#bib.bib64" title="">
      2022
     </a>
     ; Malach,
     <a class="ltx_ref" href="#bib.bib44" title="">
      2023
     </a>
     )
    </cite>
    , even when used in a zero-shot manner
    <cite class="ltx_cite ltx_citemacro_citep">
     (Kojima et al.,
     <a class="ltx_ref" href="#bib.bib35" title="">
      2022
     </a>
     )
    </cite>
    as we do here.
   </p>
  </div>
  <figure class="ltx_figure ltx_align_floatright" id="S2.F2">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="213" id="S2.F2.1.g1" src="/html/2403.15371/assets/prompt-Jan28.png" width="299"/>
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_figure">
     Figure 2:
    </span>
    Prompt designs; see Figure
    <a class="ltx_ref" href="#A1.F11" title="Figure 11 ‣ Appendix A Prompt designs ‣ Can large language models explore in-context?">
     <span class="ltx_text ltx_ref_tag">
      11
     </span>
    </a>
    for a more detailed view. A prompt is generated by traversing the graph from top to bottom.
   </figcaption>
  </figure>
  <div class="ltx_para" id="S2.p5">
   <p class="ltx_p" id="S2.p5.1">
    Prompts are presented to each LLM using both system and user messages (exposed by all three LLM APIs). The system message presents information about the scenario and framing and prompts the LLM about whether to use CoT and whether (and how) to return a distribution.
The user message presents the history and reminds the LLM about how to format its response.
For
    <span class="ltx_text ltx_font_smallcaps" id="S2.p5.1.1">
     Gpt-4
    </span>
    only, we found that prompting the LLM to use CoT in the system prompt did not reliably elicit CoT outputs, so—for
    <span class="ltx_text ltx_font_smallcaps" id="S2.p5.1.2">
     Gpt-4
    </span>
    only—we also consider a
    <em class="ltx_emph ltx_font_italic" id="S2.p5.1.3">
     reinforced CoT
    </em>
    prompt design that additionally reminds the LLM to use CoT at the end of the user prompt.
See
    <a class="ltx_ref" href="#A1" title="Appendix A Prompt designs ‣ Can large language models explore in-context?">
     Appendix
     <span class="ltx_ref ltx_nolink">
      <span class="ltx_text ltx_ref_tag">
       A
      </span>
     </span>
    </a>
    for examples.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S2.p6">
   <p class="ltx_p" id="S2.p6.5">
    <span class="ltx_text ltx_font_bold" id="S2.p6.5.1">
     LLM configurations.
    </span>
    We experiment with three LLMs:
    <span class="ltx_text ltx_font_smallcaps" id="S2.p6.5.2">
     Gpt-3.5
    </span>
    ,
    <span class="ltx_text ltx_font_smallcaps" id="S2.p6.5.3">
     Gpt-4
    </span>
    , and
    <span class="ltx_text ltx_font_smallcaps" id="S2.p6.5.4">
     Llama2
    </span>
    .
    <span class="ltx_note ltx_role_footnote" id="footnote6">
     <sup class="ltx_note_mark">
      6
     </sup>
     <span class="ltx_note_outer">
      <span class="ltx_note_content">
       <sup class="ltx_note_mark">
        6
       </sup>
       <span class="ltx_tag ltx_tag_note">
        6
       </span>
       Specifically:
       <span class="ltx_text ltx_font_smallcaps" id="footnote6.1">
        GPT-3.5-Turbo-0613
       </span>
       (released 06/13/2023),
       <span class="ltx_text ltx_font_smallcaps" id="footnote6.2">
        GPT-4-0613
       </span>
       (released 06/13/2023), and
       <span class="ltx_text ltx_font_smallcaps" id="footnote6.3">
        Llama2-13B-chat
       </span>
       quantized to 4-bits
       <cite class="ltx_cite ltx_citemacro_citep">
        (Dettmers and Zettlemoyer,
        <a class="ltx_ref" href="#bib.bib19" title="">
         2023
        </a>
        )
       </cite>
       .
      </span>
     </span>
    </span>
    In addition to the prompt variations above, we also consider two choices for the temperature parameter,
    <math alttext="0" class="ltx_Math" display="inline" id="S2.p6.1.m1.1">
     <semantics id="S2.p6.1.m1.1a">
      <mn id="S2.p6.1.m1.1.1" xref="S2.p6.1.m1.1.1.cmml">
       0
      </mn>
      <annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.1b">
       <cn id="S2.p6.1.m1.1.1.cmml" type="integer" xref="S2.p6.1.m1.1.1">
        0
       </cn>
      </annotation-xml>
     </semantics>
    </math>
    and
    <math alttext="1" class="ltx_Math" display="inline" id="S2.p6.2.m2.1">
     <semantics id="S2.p6.2.m2.1a">
      <mn id="S2.p6.2.m2.1.1" xref="S2.p6.2.m2.1.1.cmml">
       1
      </mn>
      <annotation-xml encoding="MathML-Content" id="S2.p6.2.m2.1b">
       <cn id="S2.p6.2.m2.1.1.cmml" type="integer" xref="S2.p6.2.m2.1.1">
        1
       </cn>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p6.2.m2.1c">
       1
      </annotation>
     </semantics>
    </math>
    .
A temperature of
    <math alttext="0" class="ltx_Math" display="inline" id="S2.p6.3.m3.1">
     <semantics id="S2.p6.3.m3.1a">
      <mn id="S2.p6.3.m3.1.1" xref="S2.p6.3.m3.1.1.cmml">
       0
      </mn>
      <annotation-xml encoding="MathML-Content" id="S2.p6.3.m3.1b">
       <cn id="S2.p6.3.m3.1.1.cmml" type="integer" xref="S2.p6.3.m3.1.1">
        0
       </cn>
      </annotation-xml>
     </semantics>
    </math>
    forces the LLM to be deterministic and therefore isolates the “deliberate” exploration behavior of the LLM itself.
A temperature of
    <math alttext="1" class="ltx_Math" display="inline" id="S2.p6.4.m4.1">
     <semantics id="S2.p6.4.m4.1a">
      <mn id="S2.p6.4.m4.1.1" xref="S2.p6.4.m4.1.1.cmml">
       1
      </mn>
      <annotation-xml encoding="MathML-Content" id="S2.p6.4.m4.1b">
       <cn id="S2.p6.4.m4.1.1.cmml" type="integer" xref="S2.p6.4.m4.1.1">
        1
       </cn>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p6.4.m4.1c">
       1
      </annotation>
     </semantics>
    </math>
    provides a source of external randomness in the LLM responses, which may or may not result in randomization among the arms.
Allowing the LLM to return a distribution instead of a single arm
also provides external randomness (as we sample from the returned distribution); to
isolate sources of randomness, we do not consider temperature
    <math alttext="1" class="ltx_Math" display="inline" id="S2.p6.5.m5.1">
     <semantics id="S2.p6.5.m5.1a">
      <mn id="S2.p6.5.m5.1.1" xref="S2.p6.5.m5.1.1.cmml">
       1
      </mn>
      <annotation-xml encoding="MathML-Content" id="S2.p6.5.m5.1b">
       <cn id="S2.p6.5.m5.1.1.cmml" type="integer" xref="S2.p6.5.m5.1.1">
        1
       </cn>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p6.5.m5.1c">
       1
      </annotation>
     </semantics>
    </math>
    with “return distribution” prompt designs.
   </p>
  </div>
  <div class="ltx_para" id="S2.p7">
   <p class="ltx_p" id="S2.p7.2">
    We refer to the tuple (prompt design, temperature) as the
    <em class="ltx_emph ltx_font_italic" id="S2.p7.2.1">
     LLM configuration
    </em>
    . We identify each configuration with a 5-letter “code”
    <math alttext="L_{1}L_{2}L_{3}L_{4}L_{5}" class="ltx_Math" display="inline" id="S2.p7.1.m1.1">
     <semantics id="S2.p7.1.m1.1a">
      <mrow id="S2.p7.1.m1.1.1" xref="S2.p7.1.m1.1.1.cmml">
       <msub id="S2.p7.1.m1.1.1.2" xref="S2.p7.1.m1.1.1.2.cmml">
        <mi id="S2.p7.1.m1.1.1.2.2" xref="S2.p7.1.m1.1.1.2.2.cmml">
         L
        </mi>
        <mn id="S2.p7.1.m1.1.1.2.3" xref="S2.p7.1.m1.1.1.2.3.cmml">
         1
        </mn>
       </msub>
       <mo id="S2.p7.1.m1.1.1.1" lspace="0em" rspace="0em" xref="S2.p7.1.m1.1.1.1.cmml">
        ​
       </mo>
       <msub id="S2.p7.1.m1.1.1.3" xref="S2.p7.1.m1.1.1.3.cmml">
        <mi id="S2.p7.1.m1.1.1.3.2" xref="S2.p7.1.m1.1.1.3.2.cmml">
         L
        </mi>
        <mn id="S2.p7.1.m1.1.1.3.3" xref="S2.p7.1.m1.1.1.3.3.cmml">
         2
        </mn>
       </msub>
       <mo id="S2.p7.1.m1.1.1.1a" lspace="0em" rspace="0em" xref="S2.p7.1.m1.1.1.1.cmml">
        ​
       </mo>
       <msub id="S2.p7.1.m1.1.1.4" xref="S2.p7.1.m1.1.1.4.cmml">
        <mi id="S2.p7.1.m1.1.1.4.2" xref="S2.p7.1.m1.1.1.4.2.cmml">
         L
        </mi>
        <mn id="S2.p7.1.m1.1.1.4.3" xref="S2.p7.1.m1.1.1.4.3.cmml">
         3
        </mn>
       </msub>
       <mo id="S2.p7.1.m1.1.1.1b" lspace="0em" rspace="0em" xref="S2.p7.1.m1.1.1.1.cmml">
        ​
       </mo>
       <msub id="S2.p7.1.m1.1.1.5" xref="S2.p7.1.m1.1.1.5.cmml">
        <mi id="S2.p7.1.m1.1.1.5.2" xref="S2.p7.1.m1.1.1.5.2.cmml">
         L
        </mi>
        <mn id="S2.p7.1.m1.1.1.5.3" xref="S2.p7.1.m1.1.1.5.3.cmml">
         4
        </mn>
       </msub>
       <mo id="S2.p7.1.m1.1.1.1c" lspace="0em" rspace="0em" xref="S2.p7.1.m1.1.1.1.cmml">
        ​
       </mo>
       <msub id="S2.p7.1.m1.1.1.6" xref="S2.p7.1.m1.1.1.6.cmml">
        <mi id="S2.p7.1.m1.1.1.6.2" xref="S2.p7.1.m1.1.1.6.2.cmml">
         L
        </mi>
        <mn id="S2.p7.1.m1.1.1.6.3" xref="S2.p7.1.m1.1.1.6.3.cmml">
         5
        </mn>
       </msub>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S2.p7.1.m1.1b">
       <apply id="S2.p7.1.m1.1.1.cmml" xref="S2.p7.1.m1.1.1">
        <times id="S2.p7.1.m1.1.1.1.cmml" xref="S2.p7.1.m1.1.1.1">
        </times>
        <apply id="S2.p7.1.m1.1.1.2.cmml" xref="S2.p7.1.m1.1.1.2">
         <csymbol cd="ambiguous" id="S2.p7.1.m1.1.1.2.1.cmml" xref="S2.p7.1.m1.1.1.2">
          subscript
         </csymbol>
         <ci id="S2.p7.1.m1.1.1.2.2.cmml" xref="S2.p7.1.m1.1.1.2.2">
          𝐿
         </ci>
         <cn id="S2.p7.1.m1.1.1.2.3.cmml" type="integer" xref="S2.p7.1.m1.1.1.2.3">
          1
         </cn>
        </apply>
        <apply id="S2.p7.1.m1.1.1.3.cmml" xref="S2.p7.1.m1.1.1.3">
         <csymbol cd="ambiguous" id="S2.p7.1.m1.1.1.3.1.cmml" xref="S2.p7.1.m1.1.1.3">
          subscript
         </csymbol>
         <ci id="S2.p7.1.m1.1.1.3.2.cmml" xref="S2.p7.1.m1.1.1.3.2">
          𝐿
         </ci>
         <cn id="S2.p7.1.m1.1.1.3.3.cmml" type="integer" xref="S2.p7.1.m1.1.1.3.3">
          2
         </cn>
        </apply>
        <apply id="S2.p7.1.m1.1.1.4.cmml" xref="S2.p7.1.m1.1.1.4">
         <csymbol cd="ambiguous" id="S2.p7.1.m1.1.1.4.1.cmml" xref="S2.p7.1.m1.1.1.4">
          subscript
         </csymbol>
         <ci id="S2.p7.1.m1.1.1.4.2.cmml" xref="S2.p7.1.m1.1.1.4.2">
          𝐿
         </ci>
         <cn id="S2.p7.1.m1.1.1.4.3.cmml" type="integer" xref="S2.p7.1.m1.1.1.4.3">
          3
         </cn>
        </apply>
        <apply id="S2.p7.1.m1.1.1.5.cmml" xref="S2.p7.1.m1.1.1.5">
         <csymbol cd="ambiguous" id="S2.p7.1.m1.1.1.5.1.cmml" xref="S2.p7.1.m1.1.1.5">
          subscript
         </csymbol>
         <ci id="S2.p7.1.m1.1.1.5.2.cmml" xref="S2.p7.1.m1.1.1.5.2">
          𝐿
         </ci>
         <cn id="S2.p7.1.m1.1.1.5.3.cmml" type="integer" xref="S2.p7.1.m1.1.1.5.3">
          4
         </cn>
        </apply>
        <apply id="S2.p7.1.m1.1.1.6.cmml" xref="S2.p7.1.m1.1.1.6">
         <csymbol cd="ambiguous" id="S2.p7.1.m1.1.1.6.1.cmml" xref="S2.p7.1.m1.1.1.6">
          subscript
         </csymbol>
         <ci id="S2.p7.1.m1.1.1.6.2.cmml" xref="S2.p7.1.m1.1.1.6.2">
          𝐿
         </ci>
         <cn id="S2.p7.1.m1.1.1.6.3.cmml" type="integer" xref="S2.p7.1.m1.1.1.6.3">
          5
         </cn>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p7.1.m1.1c">
       L_{1}L_{2}L_{3}L_{4}L_{5}
      </annotation>
     </semantics>
    </math>
    , with letters
    <math alttext="L_{i}" class="ltx_Math" display="inline" id="S2.p7.2.m2.1">
     <semantics id="S2.p7.2.m2.1a">
      <msub id="S2.p7.2.m2.1.1" xref="S2.p7.2.m2.1.1.cmml">
       <mi id="S2.p7.2.m2.1.1.2" xref="S2.p7.2.m2.1.1.2.cmml">
        L
       </mi>
       <mi id="S2.p7.2.m2.1.1.3" xref="S2.p7.2.m2.1.1.3.cmml">
        i
       </mi>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S2.p7.2.m2.1b">
       <apply id="S2.p7.2.m2.1.1.cmml" xref="S2.p7.2.m2.1.1">
        <csymbol cd="ambiguous" id="S2.p7.2.m2.1.1.1.cmml" xref="S2.p7.2.m2.1.1">
         subscript
        </csymbol>
        <ci id="S2.p7.2.m2.1.1.2.cmml" xref="S2.p7.2.m2.1.1.2">
         𝐿
        </ci>
        <ci id="S2.p7.2.m2.1.1.3.cmml" xref="S2.p7.2.m2.1.1.3">
         𝑖
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S2.p7.2.m2.1c">
       L_{i}
      </annotation>
     </semantics>
    </math>
    denoting the choices:
   </p>
   <ul class="ltx_itemize" id="S2.I1">
    <li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S2.I1.i1.p1">
      <p class="ltx_p" id="S2.I1.i1.p1.1">
       <math alttext="L_{1}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.1">
        <semantics id="S2.I1.i1.p1.1.m1.1a">
         <msub id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml">
          <mi id="S2.I1.i1.p1.1.m1.1.1.2" xref="S2.I1.i1.p1.1.m1.1.1.2.cmml">
           L
          </mi>
          <mn id="S2.I1.i1.p1.1.m1.1.1.3" xref="S2.I1.i1.p1.1.m1.1.1.3.cmml">
           1
          </mn>
         </msub>
         <annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b">
          <apply id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">
           <csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">
            subscript
           </csymbol>
           <ci id="S2.I1.i1.p1.1.m1.1.1.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2">
            𝐿
           </ci>
           <cn id="S2.I1.i1.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.I1.i1.p1.1.m1.1.1.3">
            1
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">
          L_{1}
         </annotation>
        </semantics>
       </math>
       : ‘B’ or ‘A’ for, resp., buttons or advertisements scenario;
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S2.I1.i2.p1">
      <p class="ltx_p" id="S2.I1.i2.p1.1">
       <math alttext="L_{2}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.m1.1">
        <semantics id="S2.I1.i2.p1.1.m1.1a">
         <msub id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml">
          <mi id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2.cmml">
           L
          </mi>
          <mn id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3.cmml">
           2
          </mn>
         </msub>
         <annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b">
          <apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">
           <csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">
            subscript
           </csymbol>
           <ci id="S2.I1.i2.p1.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2">
            𝐿
           </ci>
           <cn id="S2.I1.i2.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.I1.i2.p1.1.m1.1.1.3">
            2
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">
          L_{2}
         </annotation>
        </semantics>
       </math>
       : ‘N’ or ‘S’ for, resp., neutral or suggestive framing;
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S2.I1.i3.p1">
      <p class="ltx_p" id="S2.I1.i3.p1.1">
       <math alttext="L_{3}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.1.m1.1">
        <semantics id="S2.I1.i3.p1.1.m1.1a">
         <msub id="S2.I1.i3.p1.1.m1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.cmml">
          <mi id="S2.I1.i3.p1.1.m1.1.1.2" xref="S2.I1.i3.p1.1.m1.1.1.2.cmml">
           L
          </mi>
          <mn id="S2.I1.i3.p1.1.m1.1.1.3" xref="S2.I1.i3.p1.1.m1.1.1.3.cmml">
           3
          </mn>
         </msub>
         <annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.1.m1.1b">
          <apply id="S2.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1">
           <csymbol cd="ambiguous" id="S2.I1.i3.p1.1.m1.1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1">
            subscript
           </csymbol>
           <ci id="S2.I1.i3.p1.1.m1.1.1.2.cmml" xref="S2.I1.i3.p1.1.m1.1.1.2">
            𝐿
           </ci>
           <cn id="S2.I1.i3.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.I1.i3.p1.1.m1.1.1.3">
            3
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S2.I1.i3.p1.1.m1.1c">
          L_{3}
         </annotation>
        </semantics>
       </math>
       : ‘R’ or ‘S’ for, resp., raw or summarized history;
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S2.I1.i4" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S2.I1.i4.p1">
      <p class="ltx_p" id="S2.I1.i4.p1.2">
       <math alttext="L_{4}" class="ltx_Math" display="inline" id="S2.I1.i4.p1.1.m1.1">
        <semantics id="S2.I1.i4.p1.1.m1.1a">
         <msub id="S2.I1.i4.p1.1.m1.1.1" xref="S2.I1.i4.p1.1.m1.1.1.cmml">
          <mi id="S2.I1.i4.p1.1.m1.1.1.2" xref="S2.I1.i4.p1.1.m1.1.1.2.cmml">
           L
          </mi>
          <mn id="S2.I1.i4.p1.1.m1.1.1.3" xref="S2.I1.i4.p1.1.m1.1.1.3.cmml">
           4
          </mn>
         </msub>
         <annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.1.m1.1b">
          <apply id="S2.I1.i4.p1.1.m1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1">
           <csymbol cd="ambiguous" id="S2.I1.i4.p1.1.m1.1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1">
            subscript
           </csymbol>
           <ci id="S2.I1.i4.p1.1.m1.1.1.2.cmml" xref="S2.I1.i4.p1.1.m1.1.1.2">
            𝐿
           </ci>
           <cn id="S2.I1.i4.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.I1.i4.p1.1.m1.1.1.3">
            4
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S2.I1.i4.p1.1.m1.1c">
          L_{4}
         </annotation>
        </semantics>
       </math>
       : ‘C’ or ‘
       <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S2.I1.i4.p1.2.m2.1">
        <semantics id="S2.I1.i4.p1.2.m2.1a">
         <mover accent="true" id="S2.I1.i4.p1.2.m2.1.1" xref="S2.I1.i4.p1.2.m2.1.1.cmml">
          <mtext id="S2.I1.i4.p1.2.m2.1.1.2" xref="S2.I1.i4.p1.2.m2.1.1.2a.cmml">
           C
          </mtext>
          <mo id="S2.I1.i4.p1.2.m2.1.1.1" xref="S2.I1.i4.p1.2.m2.1.1.1.cmml">
           ~
          </mo>
         </mover>
         <annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.2.m2.1b">
          <apply id="S2.I1.i4.p1.2.m2.1.1.cmml" xref="S2.I1.i4.p1.2.m2.1.1">
           <ci id="S2.I1.i4.p1.2.m2.1.1.1.cmml" xref="S2.I1.i4.p1.2.m2.1.1.1">
            ~
           </ci>
           <ci id="S2.I1.i4.p1.2.m2.1.1.2a.cmml" xref="S2.I1.i4.p1.2.m2.1.1.2">
            <mtext id="S2.I1.i4.p1.2.m2.1.1.2.cmml" xref="S2.I1.i4.p1.2.m2.1.1.2">
             C
            </mtext>
           </ci>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S2.I1.i4.p1.2.m2.1c">
          \widetilde{\text{C}}
         </annotation>
        </semantics>
       </math>
       ’ or ‘N’ for, resp., chain-of-thought, reinforced CoT, or no CoT.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S2.I1.i5" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S2.I1.i5.p1">
      <p class="ltx_p" id="S2.I1.i5.p1.2">
       <math alttext="L_{5}" class="ltx_Math" display="inline" id="S2.I1.i5.p1.1.m1.1">
        <semantics id="S2.I1.i5.p1.1.m1.1a">
         <msub id="S2.I1.i5.p1.1.m1.1.1" xref="S2.I1.i5.p1.1.m1.1.1.cmml">
          <mi id="S2.I1.i5.p1.1.m1.1.1.2" xref="S2.I1.i5.p1.1.m1.1.1.2.cmml">
           L
          </mi>
          <mn id="S2.I1.i5.p1.1.m1.1.1.3" xref="S2.I1.i5.p1.1.m1.1.1.3.cmml">
           5
          </mn>
         </msub>
         <annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.1.m1.1b">
          <apply id="S2.I1.i5.p1.1.m1.1.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1">
           <csymbol cd="ambiguous" id="S2.I1.i5.p1.1.m1.1.1.1.cmml" xref="S2.I1.i5.p1.1.m1.1.1">
            subscript
           </csymbol>
           <ci id="S2.I1.i5.p1.1.m1.1.1.2.cmml" xref="S2.I1.i5.p1.1.m1.1.1.2">
            𝐿
           </ci>
           <cn id="S2.I1.i5.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.I1.i5.p1.1.m1.1.1.3">
            5
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S2.I1.i5.p1.1.m1.1c">
          L_{5}
         </annotation>
        </semantics>
       </math>
       : ’0’, ’1’ or ’D’ for, resp., temperature and returning a distribution (with temperature
       <math alttext="0" class="ltx_Math" display="inline" id="S2.I1.i5.p1.2.m2.1">
        <semantics id="S2.I1.i5.p1.2.m2.1a">
         <mn id="S2.I1.i5.p1.2.m2.1.1" xref="S2.I1.i5.p1.2.m2.1.1.cmml">
          0
         </mn>
         <annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.2.m2.1b">
          <cn id="S2.I1.i5.p1.2.m2.1.1.cmml" type="integer" xref="S2.I1.i5.p1.2.m2.1.1">
           0
          </cn>
         </annotation-xml>
        </semantics>
       </math>
       ).
      </p>
     </div>
    </li>
   </ul>
   <p class="ltx_p" id="S2.p7.3">
    We refer to “BNRN0” as the
    <em class="ltx_emph ltx_font_italic" id="S2.p7.3.1">
     basic
    </em>
    configuration going forward.
Most of our experiments consider the “buttons” scenario, and we use the “advertisements” scenario primarily as a robustness check.
   </p>
  </div>
  <div class="ltx_para" id="S2.p8">
   <p class="ltx_p" id="S2.p8.1">
    For
    <span class="ltx_text ltx_font_smallcaps" id="S2.p8.1.1">
     Gpt-3.5
    </span>
    and
    <span class="ltx_text ltx_font_smallcaps" id="S2.p8.1.2">
     Llama2
    </span>
    , we do not consider reinforced CoT as it is not required to reliably elicit CoT outputs; thus, we have 48 configurations total for these two LLMs.
For
    <span class="ltx_text ltx_font_smallcaps" id="S2.p8.1.3">
     Gpt-4
    </span>
    , we primarily used reinforced CoT, but did experiment with some standard CoT prompt designs; thus, there are 72 configurations total for
    <span class="ltx_text ltx_font_smallcaps" id="S2.p8.1.4">
     Gpt-4
    </span>
    .
   </p>
  </div>
  <section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
   <h4 class="ltx_title ltx_title_paragraph">
    Baselines
   </h4>
   <div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
    <p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.3">
     For baselines, we consider two standard MAB algorithms,
     <span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px1.p1.3.1">
      UCB
     </span>
     <cite class="ltx_cite ltx_citemacro_citep">
      (Auer et al.,
      <a class="ltx_ref" href="#bib.bib9" title="">
       2002
      </a>
      )
     </cite>
     and Thompson Sampling (
     <span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px1.p1.3.2">
      TS
     </span>
     )
     <cite class="ltx_cite ltx_citemacro_citep">
      (Thompson,
      <a class="ltx_ref" href="#bib.bib58" title="">
       1933
      </a>
      )
     </cite>
     , which are optimal in a certain theoretical sense and also reasonably effective in practice. We also consider the
     <span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px1.p1.3.3">
      Greedy
     </span>
     algorithm, which does not explore and is known to fail.
     <span class="ltx_note ltx_role_footnote" id="footnote7">
      <sup class="ltx_note_mark">
       7
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         7
        </sup>
        <span class="ltx_tag ltx_tag_note">
         7
        </span>
        In each round,
        <span class="ltx_text ltx_font_smallcaps" id="footnote7.1">
         Greedy
        </span>
        chooses an arm with the largest average reward so far. The algorithm is initialized with one sample of each arm. It
        <em class="ltx_emph ltx_font_italic" id="footnote7.2">
         fails
        </em>
        in that with constant probability, it never chooses the best arm after initialization.
       </span>
      </span>
     </span>
     While all three baselines have tunable parameters,
we perform no parameter tuning (see
     <a class="ltx_ref" href="#S4.SS1" title="4.1 Further background on multi-armed bandits ‣ 4 Related work ‣ Can large language models explore in-context?">
      Section
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        4.1
       </span>
      </span>
     </a>
     for a detailed description of each algorithm with parameter settings). In addition to these baselines, some of our experiments include the the
     <math alttext="\epsilon" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.1.m1.1">
      <semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a">
       <mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">
        ϵ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b">
        <ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">
         italic-ϵ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">
        \epsilon
       </annotation>
      </semantics>
     </math>
     -
     <span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px1.p1.3.4">
      Greedy
     </span>
     algorithm
     <span class="ltx_note ltx_role_footnote" id="footnote8">
      <sup class="ltx_note_mark">
       8
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         8
        </sup>
        <span class="ltx_tag ltx_tag_note">
         8
        </span>
        <math alttext="\epsilon" class="ltx_Math" display="inline" id="footnote8.m1.1">
         <semantics id="footnote8.m1.1b">
          <mi id="footnote8.m1.1.1" xref="footnote8.m1.1.1.cmml">
           ϵ
          </mi>
          <annotation-xml encoding="MathML-Content" id="footnote8.m1.1c">
           <ci id="footnote8.m1.1.1.cmml" xref="footnote8.m1.1.1">
            italic-ϵ
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="footnote8.m1.1d">
           \epsilon
          </annotation>
         </semantics>
        </math>
        -
        <span class="ltx_text ltx_font_smallcaps" id="footnote8.1">
         Greedy
        </span>
        is a standard MAB algorithm which in each round chooses an arm uniformly at random with a given probability
        <math alttext="\epsilon" class="ltx_Math" display="inline" id="footnote8.m2.1">
         <semantics id="footnote8.m2.1b">
          <mi id="footnote8.m2.1.1" xref="footnote8.m2.1.1.cmml">
           ϵ
          </mi>
          <annotation-xml encoding="MathML-Content" id="footnote8.m2.1c">
           <ci id="footnote8.m2.1.1.cmml" xref="footnote8.m2.1.1">
            italic-ϵ
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="footnote8.m2.1d">
           \epsilon
          </annotation>
         </semantics>
        </math>
        , and exploits (i.e., mimics
        <span class="ltx_text ltx_font_smallcaps" id="footnote8.2">
         Greedy
        </span>
        ) otherwise.
       </span>
      </span>
     </span>
     with various choices of
     <math alttext="\epsilon" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.2.m2.1">
      <semantics id="S2.SS0.SSS0.Px1.p1.2.m2.1a">
       <mi id="S2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">
        ϵ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.2.m2.1b">
        <ci id="S2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.2.m2.1.1">
         italic-ϵ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.2.m2.1c">
        \epsilon
       </annotation>
      </semantics>
     </math>
     to quantitatively demonstrate tradeoffs between exploration and exploitation.
We ran
     <math alttext="1000" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.3.m3.1">
      <semantics id="S2.SS0.SSS0.Px1.p1.3.m3.1a">
       <mn id="S2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">
        1000
       </mn>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.3.m3.1b">
        <cn id="S2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p1.3.m3.1.1">
         1000
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.3.m3.1c">
        1000
       </annotation>
      </semantics>
     </math>
     replicates for each baseline and each MAB instance (with rewards realized independently across the replicates).
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px1.p2">
    <p class="ltx_p" id="S2.SS0.SSS0.Px1.p2.4">
     <span class="ltx_text ltx_font_bold" id="S2.SS0.SSS0.Px1.p2.4.1">
      Scale of the experiments.
     </span>
     Our main set of experiments has time horizon
     <math alttext="T=100" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.1.m1.1">
      <semantics id="S2.SS0.SSS0.Px1.p2.1.m1.1a">
       <mrow id="S2.SS0.SSS0.Px1.p2.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2.cmml">
         T
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.1" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.1.m1.1b">
        <apply id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1">
         <eq id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.2">
          𝑇
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p2.1.m1.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.1.m1.1c">
        T=100
       </annotation>
      </semantics>
     </math>
     .
To account for randomness in rewards (and possibly in the LLM, via temperature) we ran
     <math alttext="N\in\{10,20\}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.2.m2.2">
      <semantics id="S2.SS0.SSS0.Px1.p2.2.m2.2a">
       <mrow id="S2.SS0.SSS0.Px1.p2.2.m2.2.3" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.3.cmml">
        <mi id="S2.SS0.SSS0.Px1.p2.2.m2.2.3.2" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.3.2.cmml">
         N
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p2.2.m2.2.3.1" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.3.1.cmml">
         ∈
        </mo>
        <mrow id="S2.SS0.SSS0.Px1.p2.2.m2.2.3.3.2" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.3.3.1.cmml">
         <mo id="S2.SS0.SSS0.Px1.p2.2.m2.2.3.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.3.3.1.cmml">
          {
         </mo>
         <mn id="S2.SS0.SSS0.Px1.p2.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1.cmml">
          10
         </mn>
         <mo id="S2.SS0.SSS0.Px1.p2.2.m2.2.3.3.2.2" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.3.3.1.cmml">
          ,
         </mo>
         <mn id="S2.SS0.SSS0.Px1.p2.2.m2.2.2" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.2.cmml">
          20
         </mn>
         <mo id="S2.SS0.SSS0.Px1.p2.2.m2.2.3.3.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.3.3.1.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.2.m2.2b">
        <apply id="S2.SS0.SSS0.Px1.p2.2.m2.2.3.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.3">
         <in id="S2.SS0.SSS0.Px1.p2.2.m2.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.3.1">
         </in>
         <ci id="S2.SS0.SSS0.Px1.p2.2.m2.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.3.2">
          𝑁
         </ci>
         <set id="S2.SS0.SSS0.Px1.p2.2.m2.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.3.3.2">
          <cn id="S2.SS0.SSS0.Px1.p2.2.m2.1.1.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p2.2.m2.1.1">
           10
          </cn>
          <cn id="S2.SS0.SSS0.Px1.p2.2.m2.2.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p2.2.m2.2.2">
           20
          </cn>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.2.m2.2c">
        N\in\{10,20\}
       </annotation>
      </semantics>
     </math>
     replicates for each LLM configuration and each bandit instance, with rewards generated independently across the replicates.
As a robustness check, we ran a single experiment on
     <span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px1.p2.4.2">
      Gpt-4
     </span>
     with the basic configuration for
     <math alttext="T=500" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.3.m3.1">
      <semantics id="S2.SS0.SSS0.Px1.p2.3.m3.1a">
       <mrow id="S2.SS0.SSS0.Px1.p2.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.2" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.2.cmml">
         T
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.1" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.3" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.3.cmml">
         500
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.3.m3.1b">
        <apply id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1">
         <eq id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.2">
          𝑇
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p2.3.m3.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p2.3.m3.1.1.3">
          500
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.3.m3.1c">
        T=500
       </annotation>
      </semantics>
     </math>
     rounds (with
     <math alttext="N=20" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p2.4.m4.1">
      <semantics id="S2.SS0.SSS0.Px1.p2.4.m4.1a">
       <mrow id="S2.SS0.SSS0.Px1.p2.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.cmml">
         N
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.1" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.3" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.3.cmml">
         20
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p2.4.m4.1b">
        <apply id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1">
         <eq id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.2">
          𝑁
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p2.4.m4.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p2.4.m4.1.1.3">
          20
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p2.4.m4.1c">
        N=20
       </annotation>
      </semantics>
     </math>
     ), and obtained consistent/stronger conclusions, depicted in
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        1
       </span>
      </span>
     </a>
     (a).
    </p>
   </div>
   <div class="ltx_para" id="S2.SS0.SSS0.Px1.p3">
    <p class="ltx_p" id="S2.SS0.SSS0.Px1.p3.11">
     In more detail, for
     <span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px1.p3.11.1">
      Gpt-3.5
     </span>
     we used
     <math alttext="N=20" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.1.m1.1">
      <semantics id="S2.SS0.SSS0.Px1.p3.1.m1.1a">
       <mrow id="S2.SS0.SSS0.Px1.p3.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.2.cmml">
         N
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.1" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.cmml">
         20
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.1.m1.1b">
        <apply id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1">
         <eq id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.2">
          𝑁
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p3.1.m1.1.1.3">
          20
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.1.m1.1c">
        N=20
       </annotation>
      </semantics>
     </math>
     replicates across all
     <math alttext="48" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.2.m2.1">
      <semantics id="S2.SS0.SSS0.Px1.p3.2.m2.1a">
       <mn id="S2.SS0.SSS0.Px1.p3.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1.cmml">
        48
       </mn>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.2.m2.1b">
        <cn id="S2.SS0.SSS0.Px1.p3.2.m2.1.1.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p3.2.m2.1.1">
         48
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.2.m2.1c">
        48
       </annotation>
      </semantics>
     </math>
     prompt configurations, resulting in
     <math alttext="\approx 200K" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.3.m3.1">
      <semantics id="S2.SS0.SSS0.Px1.p3.3.m3.1a">
       <mrow id="S2.SS0.SSS0.Px1.p3.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.2" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.2.cmml">
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.1" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.1.cmml">
         ≈
        </mo>
        <mrow id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.cmml">
         <mn id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.2" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.2.cmml">
          200
         </mn>
         <mo id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.1" lspace="0em" rspace="0em" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.3" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.3.cmml">
          K
         </mi>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.3.m3.1b">
        <apply id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1">
         <approx id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.1">
         </approx>
         <csymbol cd="latexml" id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.2">
          absent
         </csymbol>
         <apply id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3">
          <times id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.1">
          </times>
          <cn id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.2">
           200
          </cn>
          <ci id="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p3.3.m3.1.1.3.3">
           𝐾
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.3.m3.1c">
        \approx 200K
       </annotation>
      </semantics>
     </math>
     queries in total.
     <span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px1.p3.11.2">
      Gpt-4
     </span>
     was an order of magnitude more expensive, considerably slower on throughput, and subject to unpredictable throttling.
As such, we only used
     <math alttext="N=10" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.4.m4.1">
      <semantics id="S2.SS0.SSS0.Px1.p3.4.m4.1a">
       <mrow id="S2.SS0.SSS0.Px1.p3.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.2" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1.2.cmml">
         N
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.1" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.3" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1.3.cmml">
         10
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.4.m4.1b">
        <apply id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1">
         <eq id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1.2">
          𝑁
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p3.4.m4.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p3.4.m4.1.1.3">
          10
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.4.m4.1c">
        N=10
       </annotation>
      </semantics>
     </math>
     replicates across
     <math alttext="10" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.5.m5.1">
      <semantics id="S2.SS0.SSS0.Px1.p3.5.m5.1a">
       <mn id="S2.SS0.SSS0.Px1.p3.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p3.5.m5.1.1.cmml">
        10
       </mn>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.5.m5.1b">
        <cn id="S2.SS0.SSS0.Px1.p3.5.m5.1.1.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p3.5.m5.1.1">
         10
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.5.m5.1c">
        10
       </annotation>
      </semantics>
     </math>
     representative prompt configurations.
     <span class="ltx_note ltx_role_footnote" id="footnote9">
      <sup class="ltx_note_mark">
       9
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         9
        </sup>
        <span class="ltx_tag ltx_tag_note">
         9
        </span>
        Precisely,
        <math alttext="N=10" class="ltx_Math" display="inline" id="footnote9.m1.1">
         <semantics id="footnote9.m1.1b">
          <mrow id="footnote9.m1.1.1" xref="footnote9.m1.1.1.cmml">
           <mi id="footnote9.m1.1.1.2" xref="footnote9.m1.1.1.2.cmml">
            N
           </mi>
           <mo id="footnote9.m1.1.1.1" xref="footnote9.m1.1.1.1.cmml">
            =
           </mo>
           <mn id="footnote9.m1.1.1.3" xref="footnote9.m1.1.1.3.cmml">
            10
           </mn>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="footnote9.m1.1c">
           <apply id="footnote9.m1.1.1.cmml" xref="footnote9.m1.1.1">
            <eq id="footnote9.m1.1.1.1.cmml" xref="footnote9.m1.1.1.1">
            </eq>
            <ci id="footnote9.m1.1.1.2.cmml" xref="footnote9.m1.1.1.2">
             𝑁
            </ci>
            <cn id="footnote9.m1.1.1.3.cmml" type="integer" xref="footnote9.m1.1.1.3">
             10
            </cn>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="footnote9.m1.1d">
           N=10
          </annotation>
         </semantics>
        </math>
        for the buttons scenario, and
        <math alttext="N=3" class="ltx_Math" display="inline" id="footnote9.m2.1">
         <semantics id="footnote9.m2.1b">
          <mrow id="footnote9.m2.1.1" xref="footnote9.m2.1.1.cmml">
           <mi id="footnote9.m2.1.1.2" xref="footnote9.m2.1.1.2.cmml">
            N
           </mi>
           <mo id="footnote9.m2.1.1.1" xref="footnote9.m2.1.1.1.cmml">
            =
           </mo>
           <mn id="footnote9.m2.1.1.3" xref="footnote9.m2.1.1.3.cmml">
            3
           </mn>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="footnote9.m2.1c">
           <apply id="footnote9.m2.1.1.cmml" xref="footnote9.m2.1.1">
            <eq id="footnote9.m2.1.1.1.cmml" xref="footnote9.m2.1.1.1">
            </eq>
            <ci id="footnote9.m2.1.1.2.cmml" xref="footnote9.m2.1.1.2">
             𝑁
            </ci>
            <cn id="footnote9.m2.1.1.3.cmml" type="integer" xref="footnote9.m2.1.1.3">
             3
            </cn>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="footnote9.m2.1d">
           N=3
          </annotation>
         </semantics>
        </math>
        for the robustness check with the advertisements scenario.
       </span>
      </span>
     </span>
     For additional robustness checks, we ran four
     <span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px1.p3.11.3">
      Gpt-4
     </span>
     configurations with
     <math alttext="T=200" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.6.m6.1">
      <semantics id="S2.SS0.SSS0.Px1.p3.6.m6.1a">
       <mrow id="S2.SS0.SSS0.Px1.p3.6.m6.1.1" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.2" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1.2.cmml">
         T
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.1" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.3" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1.3.cmml">
         200
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.6.m6.1b">
        <apply id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1">
         <eq id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1.2">
          𝑇
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p3.6.m6.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p3.6.m6.1.1.3">
          200
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.6.m6.1c">
        T=200
       </annotation>
      </semantics>
     </math>
     , two for
     <math alttext="N=20" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.7.m7.1">
      <semantics id="S2.SS0.SSS0.Px1.p3.7.m7.1a">
       <mrow id="S2.SS0.SSS0.Px1.p3.7.m7.1.1" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.cmml">
         N
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.1" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.cmml">
         20
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.7.m7.1b">
        <apply id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1">
         <eq id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.2">
          𝑁
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p3.7.m7.1.1.3">
          20
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.7.m7.1c">
        N=20
       </annotation>
      </semantics>
     </math>
     replicates and two for
     <math alttext="N=40" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.8.m8.1">
      <semantics id="S2.SS0.SSS0.Px1.p3.8.m8.1a">
       <mrow id="S2.SS0.SSS0.Px1.p3.8.m8.1.1" xref="S2.SS0.SSS0.Px1.p3.8.m8.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p3.8.m8.1.1.2" xref="S2.SS0.SSS0.Px1.p3.8.m8.1.1.2.cmml">
         N
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p3.8.m8.1.1.1" xref="S2.SS0.SSS0.Px1.p3.8.m8.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p3.8.m8.1.1.3" xref="S2.SS0.SSS0.Px1.p3.8.m8.1.1.3.cmml">
         40
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.8.m8.1b">
        <apply id="S2.SS0.SSS0.Px1.p3.8.m8.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.8.m8.1.1">
         <eq id="S2.SS0.SSS0.Px1.p3.8.m8.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.8.m8.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p3.8.m8.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.8.m8.1.1.2">
          𝑁
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p3.8.m8.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p3.8.m8.1.1.3">
          40
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.8.m8.1c">
        N=40
       </annotation>
      </semantics>
     </math>
     replicates.
In total, this resulted in
     <math alttext="{\approx}50K" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.9.m9.1">
      <semantics id="S2.SS0.SSS0.Px1.p3.9.m9.1a">
       <mrow id="S2.SS0.SSS0.Px1.p3.9.m9.1.1" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.2" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.2.cmml">
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.1" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.1.cmml">
         ≈
        </mo>
        <mrow id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.cmml">
         <mn id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.2" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.2.cmml">
          50
         </mn>
         <mo id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.1" lspace="0em" rspace="0em" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.1.cmml">
          ​
         </mo>
         <mi id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.3" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.3.cmml">
          K
         </mi>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.9.m9.1b">
        <apply id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1">
         <approx id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.1">
         </approx>
         <csymbol cd="latexml" id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.2">
          absent
         </csymbol>
         <apply id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3">
          <times id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.1.cmml" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.1">
          </times>
          <cn id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.2">
           50
          </cn>
          <ci id="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.3.cmml" xref="S2.SS0.SSS0.Px1.p3.9.m9.1.1.3.3">
           𝐾
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.9.m9.1c">
        {\approx}50K
       </annotation>
      </semantics>
     </math>
     queries issued to
     <span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px1.p3.11.4">
      Gpt-4
     </span>
     .
     <span class="ltx_text ltx_font_smallcaps" id="S2.SS0.SSS0.Px1.p3.11.5">
      Llama2
     </span>
     was essentially free from our perspective (since it was locally hosted), but its performance was consistently sub-par; we limited our experiments to the
     <span class="ltx_text ltx_font_typewriter" id="S2.SS0.SSS0.Px1.p3.11.6">
      hard
     </span>
     MAB instance,
     <math alttext="32" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.10.m10.1">
      <semantics id="S2.SS0.SSS0.Px1.p3.10.m10.1a">
       <mn id="S2.SS0.SSS0.Px1.p3.10.m10.1.1" xref="S2.SS0.SSS0.Px1.p3.10.m10.1.1.cmml">
        32
       </mn>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.10.m10.1b">
        <cn id="S2.SS0.SSS0.Px1.p3.10.m10.1.1.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p3.10.m10.1.1">
         32
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.10.m10.1c">
        32
       </annotation>
      </semantics>
     </math>
     configurations, and
     <math alttext="N=10" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p3.11.m11.1">
      <semantics id="S2.SS0.SSS0.Px1.p3.11.m11.1a">
       <mrow id="S2.SS0.SSS0.Px1.p3.11.m11.1.1" xref="S2.SS0.SSS0.Px1.p3.11.m11.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p3.11.m11.1.1.2" xref="S2.SS0.SSS0.Px1.p3.11.m11.1.1.2.cmml">
         N
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p3.11.m11.1.1.1" xref="S2.SS0.SSS0.Px1.p3.11.m11.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p3.11.m11.1.1.3" xref="S2.SS0.SSS0.Px1.p3.11.m11.1.1.3.cmml">
         10
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p3.11.m11.1b">
        <apply id="S2.SS0.SSS0.Px1.p3.11.m11.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.11.m11.1.1">
         <eq id="S2.SS0.SSS0.Px1.p3.11.m11.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p3.11.m11.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p3.11.m11.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p3.11.m11.1.1.2">
          𝑁
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p3.11.m11.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p3.11.m11.1.1.3">
          10
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p3.11.m11.1c">
        N=10
       </annotation>
      </semantics>
     </math>
     replicates.
    </p>
   </div>
   <div class="ltx_para" id="S2.SS0.SSS0.Px1.p4">
    <p class="ltx_p" id="S2.SS0.SSS0.Px1.p4.12">
     We emphasize that bandit experiments with LLMs are quite costly in terms of money and time. They take
     <math alttext="N\cdot T" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.1.m1.1">
      <semantics id="S2.SS0.SSS0.Px1.p4.1.m1.1a">
       <mrow id="S2.SS0.SSS0.Px1.p4.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p4.1.m1.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p4.1.m1.1.1.2" xref="S2.SS0.SSS0.Px1.p4.1.m1.1.1.2.cmml">
         N
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p4.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.SS0.SSS0.Px1.p4.1.m1.1.1.1.cmml">
         ⋅
        </mo>
        <mi id="S2.SS0.SSS0.Px1.p4.1.m1.1.1.3" xref="S2.SS0.SSS0.Px1.p4.1.m1.1.1.3.cmml">
         T
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.1.m1.1b">
        <apply id="S2.SS0.SSS0.Px1.p4.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.1.m1.1.1">
         <ci id="S2.SS0.SSS0.Px1.p4.1.m1.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.1.m1.1.1.1">
          ⋅
         </ci>
         <ci id="S2.SS0.SSS0.Px1.p4.1.m1.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p4.1.m1.1.1.2">
          𝑁
         </ci>
         <ci id="S2.SS0.SSS0.Px1.p4.1.m1.1.1.3.cmml" xref="S2.SS0.SSS0.Px1.p4.1.m1.1.1.3">
          𝑇
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.1.m1.1c">
        N\cdot T
       </annotation>
      </semantics>
     </math>
     LLM queries for each LLM configuration and each MAB instance being tested.
Both
     <math alttext="N" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.2.m2.1">
      <semantics id="S2.SS0.SSS0.Px1.p4.2.m2.1a">
       <mi id="S2.SS0.SSS0.Px1.p4.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p4.2.m2.1.1.cmml">
        N
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.2.m2.1b">
        <ci id="S2.SS0.SSS0.Px1.p4.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.2.m2.1.1">
         𝑁
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.2.m2.1c">
        N
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="T" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.3.m3.1">
      <semantics id="S2.SS0.SSS0.Px1.p4.3.m3.1a">
       <mi id="S2.SS0.SSS0.Px1.p4.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p4.3.m3.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.3.m3.1b">
        <ci id="S2.SS0.SSS0.Px1.p4.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.3.m3.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.3.m3.1c">
        T
       </annotation>
      </semantics>
     </math>
     must be relatively large to obtain statistically meaningful results:
     <math alttext="N" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.4.m4.1">
      <semantics id="S2.SS0.SSS0.Px1.p4.4.m4.1a">
       <mi id="S2.SS0.SSS0.Px1.p4.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p4.4.m4.1.1.cmml">
        N
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.4.m4.1b">
        <ci id="S2.SS0.SSS0.Px1.p4.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.4.m4.1.1">
         𝑁
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.4.m4.1c">
        N
       </annotation>
      </semantics>
     </math>
     governs the significance level and must be large to overcome randomness in reward realizations, while
     <math alttext="T" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.5.m5.1">
      <semantics id="S2.SS0.SSS0.Px1.p4.5.m5.1a">
       <mi id="S2.SS0.SSS0.Px1.p4.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p4.5.m5.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.5.m5.1b">
        <ci id="S2.SS0.SSS0.Px1.p4.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.5.m5.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.5.m5.1c">
        T
       </annotation>
      </semantics>
     </math>
     governs the effect size and must be large so that good algorithms have enough time to identify the optimal arm.
Both issues are more pronounced in harder MAB instances (many arms
     <math alttext="K" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.6.m6.1">
      <semantics id="S2.SS0.SSS0.Px1.p4.6.m6.1a">
       <mi id="S2.SS0.SSS0.Px1.p4.6.m6.1.1" xref="S2.SS0.SSS0.Px1.p4.6.m6.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.6.m6.1b">
        <ci id="S2.SS0.SSS0.Px1.p4.6.m6.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.6.m6.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.6.m6.1c">
        K
       </annotation>
      </semantics>
     </math>
     and/or small gap
     <math alttext="\Delta" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.7.m7.1">
      <semantics id="S2.SS0.SSS0.Px1.p4.7.m7.1a">
       <mi id="S2.SS0.SSS0.Px1.p4.7.m7.1.1" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p4.7.m7.1.1.cmml">
        Δ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.7.m7.1b">
        <ci id="S2.SS0.SSS0.Px1.p4.7.m7.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.7.m7.1.1">
         Δ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.7.m7.1c">
        \Delta
       </annotation>
      </semantics>
     </math>
     ), but exploration failures also tend to be less frequent in (very) easy MAB instances.
     <span class="ltx_note ltx_role_footnote" id="footnote10">
      <sup class="ltx_note_mark">
       10
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         10
        </sup>
        <span class="ltx_tag ltx_tag_note">
         10
        </span>
        For example,
        <span class="ltx_text ltx_font_smallcaps" id="footnote10.1">
         Greedy
        </span>
        always succeeds when the gap is
        <math alttext="\Delta=1" class="ltx_Math" display="inline" id="footnote10.m1.1">
         <semantics id="footnote10.m1.1b">
          <mrow id="footnote10.m1.1.1" xref="footnote10.m1.1.1.cmml">
           <mi id="footnote10.m1.1.1.2" mathvariant="normal" xref="footnote10.m1.1.1.2.cmml">
            Δ
           </mi>
           <mo id="footnote10.m1.1.1.1" xref="footnote10.m1.1.1.1.cmml">
            =
           </mo>
           <mn id="footnote10.m1.1.1.3" xref="footnote10.m1.1.1.3.cmml">
            1
           </mn>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="footnote10.m1.1c">
           <apply id="footnote10.m1.1.1.cmml" xref="footnote10.m1.1.1">
            <eq id="footnote10.m1.1.1.1.cmml" xref="footnote10.m1.1.1.1">
            </eq>
            <ci id="footnote10.m1.1.1.2.cmml" xref="footnote10.m1.1.1.2">
             Δ
            </ci>
            <cn id="footnote10.m1.1.1.3.cmml" type="integer" xref="footnote10.m1.1.1.3">
             1
            </cn>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="footnote10.m1.1d">
           \Delta=1
          </annotation>
         </semantics>
        </math>
        , i.e., there is no noise, and trivially succeeds with probability at least
        <math alttext="(1+\Delta)^{2}/4" class="ltx_Math" display="inline" id="footnote10.m2.1">
         <semantics id="footnote10.m2.1b">
          <mrow id="footnote10.m2.1.1" xref="footnote10.m2.1.1.cmml">
           <msup id="footnote10.m2.1.1.1" xref="footnote10.m2.1.1.1.cmml">
            <mrow id="footnote10.m2.1.1.1.1.1" xref="footnote10.m2.1.1.1.1.1.1.cmml">
             <mo id="footnote10.m2.1.1.1.1.1.2" stretchy="false" xref="footnote10.m2.1.1.1.1.1.1.cmml">
              (
             </mo>
             <mrow id="footnote10.m2.1.1.1.1.1.1" xref="footnote10.m2.1.1.1.1.1.1.cmml">
              <mn id="footnote10.m2.1.1.1.1.1.1.2" xref="footnote10.m2.1.1.1.1.1.1.2.cmml">
               1
              </mn>
              <mo id="footnote10.m2.1.1.1.1.1.1.1" xref="footnote10.m2.1.1.1.1.1.1.1.cmml">
               +
              </mo>
              <mi id="footnote10.m2.1.1.1.1.1.1.3" mathvariant="normal" xref="footnote10.m2.1.1.1.1.1.1.3.cmml">
               Δ
              </mi>
             </mrow>
             <mo id="footnote10.m2.1.1.1.1.1.3" stretchy="false" xref="footnote10.m2.1.1.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
            <mn id="footnote10.m2.1.1.1.3" xref="footnote10.m2.1.1.1.3.cmml">
             2
            </mn>
           </msup>
           <mo id="footnote10.m2.1.1.2" xref="footnote10.m2.1.1.2.cmml">
            /
           </mo>
           <mn id="footnote10.m2.1.1.3" xref="footnote10.m2.1.1.3.cmml">
            4
           </mn>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="footnote10.m2.1c">
           <apply id="footnote10.m2.1.1.cmml" xref="footnote10.m2.1.1">
            <divide id="footnote10.m2.1.1.2.cmml" xref="footnote10.m2.1.1.2">
            </divide>
            <apply id="footnote10.m2.1.1.1.cmml" xref="footnote10.m2.1.1.1">
             <csymbol cd="ambiguous" id="footnote10.m2.1.1.1.2.cmml" xref="footnote10.m2.1.1.1">
              superscript
             </csymbol>
             <apply id="footnote10.m2.1.1.1.1.1.1.cmml" xref="footnote10.m2.1.1.1.1.1">
              <plus id="footnote10.m2.1.1.1.1.1.1.1.cmml" xref="footnote10.m2.1.1.1.1.1.1.1">
              </plus>
              <cn id="footnote10.m2.1.1.1.1.1.1.2.cmml" type="integer" xref="footnote10.m2.1.1.1.1.1.1.2">
               1
              </cn>
              <ci id="footnote10.m2.1.1.1.1.1.1.3.cmml" xref="footnote10.m2.1.1.1.1.1.1.3">
               Δ
              </ci>
             </apply>
             <cn id="footnote10.m2.1.1.1.3.cmml" type="integer" xref="footnote10.m2.1.1.1.3">
              2
             </cn>
            </apply>
            <cn id="footnote10.m2.1.1.3.cmml" type="integer" xref="footnote10.m2.1.1.3">
             4
            </cn>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="footnote10.m2.1d">
           (1+\Delta)^{2}/4
          </annotation>
         </semantics>
        </math>
        when the initial samples evaluate to
        <math alttext="1" class="ltx_Math" display="inline" id="footnote10.m3.1">
         <semantics id="footnote10.m3.1b">
          <mn id="footnote10.m3.1.1" xref="footnote10.m3.1.1.cmml">
           1
          </mn>
          <annotation-xml encoding="MathML-Content" id="footnote10.m3.1c">
           <cn id="footnote10.m3.1.1.cmml" type="integer" xref="footnote10.m3.1.1">
            1
           </cn>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="footnote10.m3.1d">
           1
          </annotation>
         </semantics>
        </math>
        for the good arm and
        <math alttext="0" class="ltx_Math" display="inline" id="footnote10.m4.1">
         <semantics id="footnote10.m4.1b">
          <mn id="footnote10.m4.1.1" xref="footnote10.m4.1.1.cmml">
           0
          </mn>
          <annotation-xml encoding="MathML-Content" id="footnote10.m4.1c">
           <cn id="footnote10.m4.1.1.cmml" type="integer" xref="footnote10.m4.1.1">
            0
           </cn>
          </annotation-xml>
         </semantics>
        </math>
        for the bad arm.
       </span>
      </span>
     </span>
     Further, we need to cover the space of possible prompt designs, which is essentially infinitely large, to ensure that our findings do not overfit to one particular design.
Thus, ideally we would take
     <math alttext="N" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.8.m8.1">
      <semantics id="S2.SS0.SSS0.Px1.p4.8.m8.1a">
       <mi id="S2.SS0.SSS0.Px1.p4.8.m8.1.1" xref="S2.SS0.SSS0.Px1.p4.8.m8.1.1.cmml">
        N
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.8.m8.1b">
        <ci id="S2.SS0.SSS0.Px1.p4.8.m8.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.8.m8.1.1">
         𝑁
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.8.m8.1c">
        N
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="T" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.9.m9.1">
      <semantics id="S2.SS0.SSS0.Px1.p4.9.m9.1a">
       <mi id="S2.SS0.SSS0.Px1.p4.9.m9.1.1" xref="S2.SS0.SSS0.Px1.p4.9.m9.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.9.m9.1b">
        <ci id="S2.SS0.SSS0.Px1.p4.9.m9.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.9.m9.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.9.m9.1c">
        T
       </annotation>
      </semantics>
     </math>
     , the number of MAB instances, and the number of prompts to be rather large, but doing so is not practically feasible.
     <span class="ltx_note ltx_role_footnote" id="footnote11">
      <sup class="ltx_note_mark">
       11
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         11
        </sup>
        <span class="ltx_tag ltx_tag_note">
         11
        </span>
        Raw-history prompts and chain-of-thought outputs are particularly expensive, as LLM APIs bill per token.
       </span>
      </span>
     </span>
     Instead, we use
moderately small gap
     <math alttext="\Delta=0.2" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.10.m10.1">
      <semantics id="S2.SS0.SSS0.Px1.p4.10.m10.1a">
       <mrow id="S2.SS0.SSS0.Px1.p4.10.m10.1.1" xref="S2.SS0.SSS0.Px1.p4.10.m10.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p4.10.m10.1.1.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p4.10.m10.1.1.2.cmml">
         Δ
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p4.10.m10.1.1.1" xref="S2.SS0.SSS0.Px1.p4.10.m10.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p4.10.m10.1.1.3" xref="S2.SS0.SSS0.Px1.p4.10.m10.1.1.3.cmml">
         0.2
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.10.m10.1b">
        <apply id="S2.SS0.SSS0.Px1.p4.10.m10.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.10.m10.1.1">
         <eq id="S2.SS0.SSS0.Px1.p4.10.m10.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.10.m10.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p4.10.m10.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p4.10.m10.1.1.2">
          Δ
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p4.10.m10.1.1.3.cmml" type="float" xref="S2.SS0.SSS0.Px1.p4.10.m10.1.1.3">
          0.2
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.10.m10.1c">
        \Delta=0.2
       </annotation>
      </semantics>
     </math>
     , moderately large choices for
     <math alttext="N\in\{10,20\}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.11.m11.2">
      <semantics id="S2.SS0.SSS0.Px1.p4.11.m11.2a">
       <mrow id="S2.SS0.SSS0.Px1.p4.11.m11.2.3" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.3.cmml">
        <mi id="S2.SS0.SSS0.Px1.p4.11.m11.2.3.2" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.3.2.cmml">
         N
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p4.11.m11.2.3.1" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.3.1.cmml">
         ∈
        </mo>
        <mrow id="S2.SS0.SSS0.Px1.p4.11.m11.2.3.3.2" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.3.3.1.cmml">
         <mo id="S2.SS0.SSS0.Px1.p4.11.m11.2.3.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.3.3.1.cmml">
          {
         </mo>
         <mn id="S2.SS0.SSS0.Px1.p4.11.m11.1.1" xref="S2.SS0.SSS0.Px1.p4.11.m11.1.1.cmml">
          10
         </mn>
         <mo id="S2.SS0.SSS0.Px1.p4.11.m11.2.3.3.2.2" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.3.3.1.cmml">
          ,
         </mo>
         <mn id="S2.SS0.SSS0.Px1.p4.11.m11.2.2" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.2.cmml">
          20
         </mn>
         <mo id="S2.SS0.SSS0.Px1.p4.11.m11.2.3.3.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.3.3.1.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.11.m11.2b">
        <apply id="S2.SS0.SSS0.Px1.p4.11.m11.2.3.cmml" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.3">
         <in id="S2.SS0.SSS0.Px1.p4.11.m11.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.3.1">
         </in>
         <ci id="S2.SS0.SSS0.Px1.p4.11.m11.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.3.2">
          𝑁
         </ci>
         <set id="S2.SS0.SSS0.Px1.p4.11.m11.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.3.3.2">
          <cn id="S2.SS0.SSS0.Px1.p4.11.m11.1.1.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p4.11.m11.1.1">
           10
          </cn>
          <cn id="S2.SS0.SSS0.Px1.p4.11.m11.2.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p4.11.m11.2.2">
           20
          </cn>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.11.m11.2c">
        N\in\{10,20\}
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="T=100" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p4.12.m12.1">
      <semantics id="S2.SS0.SSS0.Px1.p4.12.m12.1a">
       <mrow id="S2.SS0.SSS0.Px1.p4.12.m12.1.1" xref="S2.SS0.SSS0.Px1.p4.12.m12.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p4.12.m12.1.1.2" xref="S2.SS0.SSS0.Px1.p4.12.m12.1.1.2.cmml">
         T
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p4.12.m12.1.1.1" xref="S2.SS0.SSS0.Px1.p4.12.m12.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p4.12.m12.1.1.3" xref="S2.SS0.SSS0.Px1.p4.12.m12.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p4.12.m12.1b">
        <apply id="S2.SS0.SSS0.Px1.p4.12.m12.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.12.m12.1.1">
         <eq id="S2.SS0.SSS0.Px1.p4.12.m12.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p4.12.m12.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p4.12.m12.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p4.12.m12.1.1.2">
          𝑇
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p4.12.m12.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p4.12.m12.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p4.12.m12.1c">
        T=100
       </annotation>
      </semantics>
     </math>
     , and the prompt design space as described above.
    </p>
   </div>
   <div class="ltx_para" id="S2.SS0.SSS0.Px1.p5">
    <p class="ltx_p" id="S2.SS0.SSS0.Px1.p5.5">
     As we will see below, these choices (specifically,
     <math alttext="N\in\{10,20\}" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p5.1.m1.2">
      <semantics id="S2.SS0.SSS0.Px1.p5.1.m1.2a">
       <mrow id="S2.SS0.SSS0.Px1.p5.1.m1.2.3" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.3.cmml">
        <mi id="S2.SS0.SSS0.Px1.p5.1.m1.2.3.2" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.3.2.cmml">
         N
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p5.1.m1.2.3.1" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.3.1.cmml">
         ∈
        </mo>
        <mrow id="S2.SS0.SSS0.Px1.p5.1.m1.2.3.3.2" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.3.3.1.cmml">
         <mo id="S2.SS0.SSS0.Px1.p5.1.m1.2.3.3.2.1" stretchy="false" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.3.3.1.cmml">
          {
         </mo>
         <mn id="S2.SS0.SSS0.Px1.p5.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p5.1.m1.1.1.cmml">
          10
         </mn>
         <mo id="S2.SS0.SSS0.Px1.p5.1.m1.2.3.3.2.2" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.3.3.1.cmml">
          ,
         </mo>
         <mn id="S2.SS0.SSS0.Px1.p5.1.m1.2.2" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.2.cmml">
          20
         </mn>
         <mo id="S2.SS0.SSS0.Px1.p5.1.m1.2.3.3.2.3" stretchy="false" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.3.3.1.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p5.1.m1.2b">
        <apply id="S2.SS0.SSS0.Px1.p5.1.m1.2.3.cmml" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.3">
         <in id="S2.SS0.SSS0.Px1.p5.1.m1.2.3.1.cmml" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.3.1">
         </in>
         <ci id="S2.SS0.SSS0.Px1.p5.1.m1.2.3.2.cmml" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.3.2">
          𝑁
         </ci>
         <set id="S2.SS0.SSS0.Px1.p5.1.m1.2.3.3.1.cmml" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.3.3.2">
          <cn id="S2.SS0.SSS0.Px1.p5.1.m1.1.1.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p5.1.m1.1.1">
           10
          </cn>
          <cn id="S2.SS0.SSS0.Px1.p5.1.m1.2.2.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p5.1.m1.2.2">
           20
          </cn>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p5.1.m1.2c">
        N\in\{10,20\}
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="T=100" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p5.2.m2.1">
      <semantics id="S2.SS0.SSS0.Px1.p5.2.m2.1a">
       <mrow id="S2.SS0.SSS0.Px1.p5.2.m2.1.1" xref="S2.SS0.SSS0.Px1.p5.2.m2.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p5.2.m2.1.1.2" xref="S2.SS0.SSS0.Px1.p5.2.m2.1.1.2.cmml">
         T
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p5.2.m2.1.1.1" xref="S2.SS0.SSS0.Px1.p5.2.m2.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p5.2.m2.1.1.3" xref="S2.SS0.SSS0.Px1.p5.2.m2.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p5.2.m2.1b">
        <apply id="S2.SS0.SSS0.Px1.p5.2.m2.1.1.cmml" xref="S2.SS0.SSS0.Px1.p5.2.m2.1.1">
         <eq id="S2.SS0.SSS0.Px1.p5.2.m2.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p5.2.m2.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p5.2.m2.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p5.2.m2.1.1.2">
          𝑇
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p5.2.m2.1.1.3.cmml" type="integer" xref="S2.SS0.SSS0.Px1.p5.2.m2.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p5.2.m2.1c">
        T=100
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="\Delta=0.2" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p5.3.m3.1">
      <semantics id="S2.SS0.SSS0.Px1.p5.3.m3.1a">
       <mrow id="S2.SS0.SSS0.Px1.p5.3.m3.1.1" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.1.cmml">
        <mi id="S2.SS0.SSS0.Px1.p5.3.m3.1.1.2" mathvariant="normal" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.1.2.cmml">
         Δ
        </mi>
        <mo id="S2.SS0.SSS0.Px1.p5.3.m3.1.1.1" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.1.1.cmml">
         =
        </mo>
        <mn id="S2.SS0.SSS0.Px1.p5.3.m3.1.1.3" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.1.3.cmml">
         0.2
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p5.3.m3.1b">
        <apply id="S2.SS0.SSS0.Px1.p5.3.m3.1.1.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.1">
         <eq id="S2.SS0.SSS0.Px1.p5.3.m3.1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.1.1">
         </eq>
         <ci id="S2.SS0.SSS0.Px1.p5.3.m3.1.1.2.cmml" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.1.2">
          Δ
         </ci>
         <cn id="S2.SS0.SSS0.Px1.p5.3.m3.1.1.3.cmml" type="float" xref="S2.SS0.SSS0.Px1.p5.3.m3.1.1.3">
          0.2
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p5.3.m3.1c">
        \Delta=0.2
       </annotation>
      </semantics>
     </math>
     ) do not provide enough statistical power
to distinguish between successful and unsuccessful methods based
solely on accumulated rewards. In lieu of further increasing the scale
of the experiments, which is not practically feasible, we rely
on
     <em class="ltx_emph ltx_font_italic" id="S2.SS0.SSS0.Px1.p5.5.1">
      surrogate statistics
     </em>
     which can be detected at our moderate
scale, and which are highly suggestive of long-term/persistent
exploration failures. Our robustness checks with larger
     <math alttext="T" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p5.4.m4.1">
      <semantics id="S2.SS0.SSS0.Px1.p5.4.m4.1a">
       <mi id="S2.SS0.SSS0.Px1.p5.4.m4.1.1" xref="S2.SS0.SSS0.Px1.p5.4.m4.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p5.4.m4.1b">
        <ci id="S2.SS0.SSS0.Px1.p5.4.m4.1.1.cmml" xref="S2.SS0.SSS0.Px1.p5.4.m4.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p5.4.m4.1c">
        T
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="N" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p5.5.m5.1">
      <semantics id="S2.SS0.SSS0.Px1.p5.5.m5.1a">
       <mi id="S2.SS0.SSS0.Px1.p5.5.m5.1.1" xref="S2.SS0.SSS0.Px1.p5.5.m5.1.1.cmml">
        N
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p5.5.m5.1b">
        <ci id="S2.SS0.SSS0.Px1.p5.5.m5.1.1.cmml" xref="S2.SS0.SSS0.Px1.p5.5.m5.1.1">
         𝑁
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p5.5.m5.1c">
        N
       </annotation>
      </semantics>
     </math>
     , as well as qualitative findings that we report below provide supporting evidence for this methodology.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Experimental results
  </h2>
  <figure class="ltx_figure" id="S3.F3">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="182" id="S3.F3.g1" src="/html/2403.15371/assets/x2.png" width="276"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 3:
    </span>
    Scatter plot summarizing all experiments with
    <math alttext="T=100" class="ltx_Math" display="inline" id="S3.F3.7.m1.1">
     <semantics id="S3.F3.7.m1.1b">
      <mrow id="S3.F3.7.m1.1.1" xref="S3.F3.7.m1.1.1.cmml">
       <mi id="S3.F3.7.m1.1.1.2" xref="S3.F3.7.m1.1.1.2.cmml">
        T
       </mi>
       <mo id="S3.F3.7.m1.1.1.1" xref="S3.F3.7.m1.1.1.1.cmml">
        =
       </mo>
       <mn id="S3.F3.7.m1.1.1.3" xref="S3.F3.7.m1.1.1.3.cmml">
        100
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.F3.7.m1.1c">
       <apply id="S3.F3.7.m1.1.1.cmml" xref="S3.F3.7.m1.1.1">
        <eq id="S3.F3.7.m1.1.1.1.cmml" xref="S3.F3.7.m1.1.1.1">
        </eq>
        <ci id="S3.F3.7.m1.1.1.2.cmml" xref="S3.F3.7.m1.1.1.2">
         𝑇
        </ci>
        <cn id="S3.F3.7.m1.1.1.3.cmml" type="integer" xref="S3.F3.7.m1.1.1.3">
         100
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.F3.7.m1.1d">
       T=100
      </annotation>
     </semantics>
    </math>
    . We plot suffix failures (expressed via
    <math alttext="\texttt{SuffFailFreq}(T/2)" class="ltx_Math" display="inline" id="S3.F3.8.m2.1">
     <semantics id="S3.F3.8.m2.1b">
      <mrow id="S3.F3.8.m2.1.1" xref="S3.F3.8.m2.1.1.cmml">
       <mtext class="ltx_mathvariant_monospace" id="S3.F3.8.m2.1.1.3" xref="S3.F3.8.m2.1.1.3a.cmml">
        SuffFailFreq
       </mtext>
       <mo id="S3.F3.8.m2.1.1.2" lspace="0em" rspace="0em" xref="S3.F3.8.m2.1.1.2.cmml">
        ​
       </mo>
       <mrow id="S3.F3.8.m2.1.1.1.1" xref="S3.F3.8.m2.1.1.1.1.1.cmml">
        <mo id="S3.F3.8.m2.1.1.1.1.2" stretchy="false" xref="S3.F3.8.m2.1.1.1.1.1.cmml">
         (
        </mo>
        <mrow id="S3.F3.8.m2.1.1.1.1.1" xref="S3.F3.8.m2.1.1.1.1.1.cmml">
         <mi id="S3.F3.8.m2.1.1.1.1.1.2" xref="S3.F3.8.m2.1.1.1.1.1.2.cmml">
          T
         </mi>
         <mo id="S3.F3.8.m2.1.1.1.1.1.1" xref="S3.F3.8.m2.1.1.1.1.1.1.cmml">
          /
         </mo>
         <mn id="S3.F3.8.m2.1.1.1.1.1.3" xref="S3.F3.8.m2.1.1.1.1.1.3.cmml">
          2
         </mn>
        </mrow>
        <mo id="S3.F3.8.m2.1.1.1.1.3" stretchy="false" xref="S3.F3.8.m2.1.1.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.F3.8.m2.1c">
       <apply id="S3.F3.8.m2.1.1.cmml" xref="S3.F3.8.m2.1.1">
        <times id="S3.F3.8.m2.1.1.2.cmml" xref="S3.F3.8.m2.1.1.2">
        </times>
        <ci id="S3.F3.8.m2.1.1.3a.cmml" xref="S3.F3.8.m2.1.1.3">
         <mtext class="ltx_mathvariant_monospace" id="S3.F3.8.m2.1.1.3.cmml" xref="S3.F3.8.m2.1.1.3">
          SuffFailFreq
         </mtext>
        </ci>
        <apply id="S3.F3.8.m2.1.1.1.1.1.cmml" xref="S3.F3.8.m2.1.1.1.1">
         <divide id="S3.F3.8.m2.1.1.1.1.1.1.cmml" xref="S3.F3.8.m2.1.1.1.1.1.1">
         </divide>
         <ci id="S3.F3.8.m2.1.1.1.1.1.2.cmml" xref="S3.F3.8.m2.1.1.1.1.1.2">
          𝑇
         </ci>
         <cn id="S3.F3.8.m2.1.1.1.1.1.3.cmml" type="integer" xref="S3.F3.8.m2.1.1.1.1.1.3">
          2
         </cn>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.F3.8.m2.1d">
       \texttt{SuffFailFreq}(T/2)
      </annotation>
     </semantics>
    </math>
    ) vs. uniform-like failures (expressed via
    <math alttext="K\cdot\texttt{MinFrac}(T)" class="ltx_Math" display="inline" id="S3.F3.9.m3.1">
     <semantics id="S3.F3.9.m3.1b">
      <mrow id="S3.F3.9.m3.1.2" xref="S3.F3.9.m3.1.2.cmml">
       <mrow id="S3.F3.9.m3.1.2.2" xref="S3.F3.9.m3.1.2.2.cmml">
        <mi id="S3.F3.9.m3.1.2.2.2" xref="S3.F3.9.m3.1.2.2.2.cmml">
         K
        </mi>
        <mo id="S3.F3.9.m3.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.F3.9.m3.1.2.2.1.cmml">
         ⋅
        </mo>
        <mtext class="ltx_mathvariant_monospace" id="S3.F3.9.m3.1.2.2.3" xref="S3.F3.9.m3.1.2.2.3a.cmml">
         MinFrac
        </mtext>
       </mrow>
       <mo id="S3.F3.9.m3.1.2.1" lspace="0em" rspace="0em" xref="S3.F3.9.m3.1.2.1.cmml">
        ​
       </mo>
       <mrow id="S3.F3.9.m3.1.2.3.2" xref="S3.F3.9.m3.1.2.cmml">
        <mo id="S3.F3.9.m3.1.2.3.2.1" stretchy="false" xref="S3.F3.9.m3.1.2.cmml">
         (
        </mo>
        <mi id="S3.F3.9.m3.1.1" xref="S3.F3.9.m3.1.1.cmml">
         T
        </mi>
        <mo id="S3.F3.9.m3.1.2.3.2.2" stretchy="false" xref="S3.F3.9.m3.1.2.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.F3.9.m3.1c">
       <apply id="S3.F3.9.m3.1.2.cmml" xref="S3.F3.9.m3.1.2">
        <times id="S3.F3.9.m3.1.2.1.cmml" xref="S3.F3.9.m3.1.2.1">
        </times>
        <apply id="S3.F3.9.m3.1.2.2.cmml" xref="S3.F3.9.m3.1.2.2">
         <ci id="S3.F3.9.m3.1.2.2.1.cmml" xref="S3.F3.9.m3.1.2.2.1">
          ⋅
         </ci>
         <ci id="S3.F3.9.m3.1.2.2.2.cmml" xref="S3.F3.9.m3.1.2.2.2">
          𝐾
         </ci>
         <ci id="S3.F3.9.m3.1.2.2.3a.cmml" xref="S3.F3.9.m3.1.2.2.3">
          <mtext class="ltx_mathvariant_monospace" id="S3.F3.9.m3.1.2.2.3.cmml" xref="S3.F3.9.m3.1.2.2.3">
           MinFrac
          </mtext>
         </ci>
        </apply>
        <ci id="S3.F3.9.m3.1.1.cmml" xref="S3.F3.9.m3.1.1">
         𝑇
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.F3.9.m3.1d">
       K\cdot\texttt{MinFrac}(T)
      </annotation>
     </semantics>
    </math>
    ).
Each LLM/configuration pair maps to a dot on this plane (some dots may overlap).
The
    <span class="ltx_text ltx_font_smallcaps" id="S3.F3.15.1">
     Gpt-4
    </span>
    configuration labeled with a star is BSS
    <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.F3.10.m4.1">
     <semantics id="S3.F3.10.m4.1b">
      <mover accent="true" id="S3.F3.10.m4.1.1" xref="S3.F3.10.m4.1.1.cmml">
       <mtext id="S3.F3.10.m4.1.1.2" xref="S3.F3.10.m4.1.1.2a.cmml">
        C
       </mtext>
       <mo id="S3.F3.10.m4.1.1.1" xref="S3.F3.10.m4.1.1.1.cmml">
        ~
       </mo>
      </mover>
      <annotation-xml encoding="MathML-Content" id="S3.F3.10.m4.1c">
       <apply id="S3.F3.10.m4.1.1.cmml" xref="S3.F3.10.m4.1.1">
        <ci id="S3.F3.10.m4.1.1.1.cmml" xref="S3.F3.10.m4.1.1.1">
         ~
        </ci>
        <ci id="S3.F3.10.m4.1.1.2a.cmml" xref="S3.F3.10.m4.1.1.2">
         <mtext id="S3.F3.10.m4.1.1.2.cmml" xref="S3.F3.10.m4.1.1.2">
          C
         </mtext>
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.F3.10.m4.1d">
       \widetilde{\text{C}}
      </annotation>
     </semantics>
    </math>
    0, which is the only configuration that succeeds.
We also plot
    <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.F3.11.m5.1">
     <semantics id="S3.F3.11.m5.1b">
      <mi id="S3.F3.11.m5.1.1" xref="S3.F3.11.m5.1.1.cmml">
       ϵ
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.F3.11.m5.1c">
       <ci id="S3.F3.11.m5.1.1.cmml" xref="S3.F3.11.m5.1.1">
        italic-ϵ
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.F3.11.m5.1d">
       \epsilon
      </annotation>
     </semantics>
    </math>
    -
    <span class="ltx_text ltx_font_smallcaps" id="S3.F3.16.2">
     Greedy
    </span>
    , tracing out the different tradeoffs obtained for different values of
    <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.F3.12.m6.1">
     <semantics id="S3.F3.12.m6.1b">
      <mi id="S3.F3.12.m6.1.1" xref="S3.F3.12.m6.1.1.cmml">
       ϵ
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.F3.12.m6.1c">
       <ci id="S3.F3.12.m6.1.1.cmml" xref="S3.F3.12.m6.1.1">
        italic-ϵ
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.F3.12.m6.1d">
       \epsilon
      </annotation>
     </semantics>
    </math>
    .
   </figcaption>
  </figure>
  <div class="ltx_para" id="S3.p1">
   <p class="ltx_p" id="S3.p1.1">
    In this section, we present our experimental findings, beginning with a summary in
    <a class="ltx_ref" href="#S3.SS1" title="3.1 Overview ‣ 3 Experimental results ‣ Can large language models explore in-context?">
     <span class="ltx_text ltx_ref_tag">
      Section
     </span>
     <span class="ltx_text ltx_ref_tag">
      3.1
     </span>
    </a>
    .
In
    <a class="ltx_ref" href="#S3.SS2" title="3.2 Identifying failures ‣ 3 Experimental results ‣ Can large language models explore in-context?">
     <span class="ltx_text ltx_ref_tag">
      Section
     </span>
     <span class="ltx_text ltx_ref_tag">
      3.2
     </span>
    </a>
    we investigate failing LLM configurations
in detail, and in
    <a class="ltx_ref" href="#S3.SS3" title="3.3 Investigating successes ‣ 3 Experimental results ‣ Can large language models explore in-context?">
     <span class="ltx_text ltx_ref_tag">
      Section
     </span>
     <span class="ltx_text ltx_ref_tag">
      3.3
     </span>
    </a>
    we focus on the single
successful LLM configuration our experiments identified.
Finally, in
    <a class="ltx_ref" href="#S3.SS4" title="3.4 Root causes ‣ 3 Experimental results ‣ Can large language models explore in-context?">
     <span class="ltx_text ltx_ref_tag">
      Section
     </span>
     <span class="ltx_text ltx_ref_tag">
      3.4
     </span>
    </a>
    we attempt to diagnose the underlying causes for exploration failures.
   </p>
  </div>
  <section class="ltx_subsection" id="S3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.1
    </span>
    Overview
   </h3>
   <div class="ltx_para" id="S3.SS1.p1">
    <p class="ltx_p" id="S3.SS1.p1.2">
     We find that all but one of the LLM configurations we consider exhibit exploration failures, not converging to the best
arm with significant probability. This happens either due to
     <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.2.1">
      suffix failures
     </em>
     , where the LLM never selects the best arm after
a small number of initial rounds, or (in a smaller number of configurations) due to
     <em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.2.2">
      uniform-like
failures
     </em>
     , where the LLM selects all arms at an approximately uniform
rate, failing to eliminate poorly performing arms. The only one
exception is
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p1.2.3">
      Gpt-4
     </span>
     with
the BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1">
      <semantics id="S3.SS1.p1.1.m1.1a">
       <mover accent="true" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">
        <mtext id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b">
        <apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">
         <ci id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1">
          ~
         </ci>
         <ci id="S3.SS1.p1.1.m1.1.1.2a.cmml" xref="S3.SS1.p1.1.m1.1.1.2">
          <mtext id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 configuration, i.e., with the buttons
scenario, suggestive framing, summarized history, reinforced CoT, and
temperature
     <math alttext="0" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1">
      <semantics id="S3.SS1.p1.2.m2.1a">
       <mn id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">
        0
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b">
        <cn id="S3.SS1.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS1.p1.2.m2.1.1">
         0
        </cn>
       </annotation-xml>
      </semantics>
     </math>
     .
    </p>
   </div>
   <div class="ltx_para" id="S3.SS1.p2">
    <p class="ltx_p" id="S3.SS1.p2.9">
     We summarize our key findings in
     <a class="ltx_ref" href="#S3.F3" title="Figure 3 ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        3
       </span>
      </span>
     </a>
     and
     <a class="ltx_ref" href="#S3.F4" title="Figure 4 ‣ 3.1 Overview ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        4
       </span>
      </span>
     </a>
     .
     <a class="ltx_ref" href="#S3.F3" title="Figure 3 ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        3
       </span>
      </span>
     </a>
     summarizes the main set
of experiments (which we recall consider the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p2.9.1">
      hard
     </span>
     MAB instance), visualizing each LLM
configuration with a single point on a scatter plot where the
axes correspond to two
     <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.9.2">
      surrogate statistics
     </em>
     ,
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS1.p2.9.3">
      SuffFailFreq
     </span>
     and
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS1.p2.9.4">
      MinFrac
     </span>
     , which represent the
strength of the two failure modes (
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS1.p2.9.5">
      SuffFailFreq
     </span>
     measures
suffix failures, and
     <math alttext="K\cdot\texttt{MinFrac}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1">
      <semantics id="S3.SS1.p2.4.m4.1a">
       <mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">
        <mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">
         K
        </mi>
        <mo id="S3.SS1.p2.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.4.m4.1.1.1.cmml">
         ⋅
        </mo>
        <mtext class="ltx_mathvariant_monospace" id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3a.cmml">
         MinFrac
        </mtext>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b">
        <apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">
         <ci id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1">
          ⋅
         </ci>
         <ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">
          𝐾
         </ci>
         <ci id="S3.SS1.p2.4.m4.1.1.3a.cmml" xref="S3.SS1.p2.4.m4.1.1.3">
          <mtext class="ltx_mathvariant_monospace" id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">
           MinFrac
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">
        K\cdot\texttt{MinFrac}
       </annotation>
      </semantics>
     </math>
     measures uniform-like failures); these statistics are described in detail in the sequel.
     <a class="ltx_ref" href="#S3.F4" title="Figure 4 ‣ 3.1 Overview ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        4
       </span>
      </span>
     </a>
     displays
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS1.p2.9.6">
      SuffFailFreq
     </span>
     ,
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS1.p2.9.7">
      MinFrac
     </span>
     ,
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS1.p2.9.8">
      GreedyFrac
     </span>
     (which measures how similar a method is to
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.9.9">
      Greedy
     </span>
     ), and additional summary statistics for each of the
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.9.10">
      Gpt-4
     </span>
     configurations in
the main set of experiments. These statistics reveal that all of the LLM configurations, except for
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.9.11">
      Gpt-4
     </span>
     -BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1">
      <semantics id="S3.SS1.p2.8.m8.1a">
       <mover accent="true" id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">
        <mtext id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS1.p2.8.m8.1.1.1" xref="S3.SS1.p2.8.m8.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b">
        <apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">
         <ci id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1.1">
          ~
         </ci>
         <ci id="S3.SS1.p2.8.m8.1.1.2a.cmml" xref="S3.SS1.p2.8.m8.1.1.2">
          <mtext id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 (the blue star
in
     <a class="ltx_ref" href="#S3.F3" title="Figure 3 ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        3
       </span>
      </span>
     </a>
     ), behave fundamentally differently from the
baseline algorithms
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.9.12">
      UCB
     </span>
     and
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.9.13">
      TS
     </span>
     , and we find that these
differences result in a large, persistent drop in performance.
Conversely, we find that
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS1.p2.9.14">
      Gpt-4
     </span>
     -BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.1">
      <semantics id="S3.SS1.p2.9.m9.1a">
       <mover accent="true" id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">
        <mtext id="S3.SS1.p2.9.m9.1.1.2" xref="S3.SS1.p2.9.m9.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS1.p2.9.m9.1.1.1" xref="S3.SS1.p2.9.m9.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b">
        <apply id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">
         <ci id="S3.SS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1.1">
          ~
         </ci>
         <ci id="S3.SS1.p2.9.m9.1.1.2a.cmml" xref="S3.SS1.p2.9.m9.1.1.2">
          <mtext id="S3.SS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 successfully explores and (as a result) converges to the best arm.
    </p>
   </div>
   <figure class="ltx_figure" id="S3.F4">
    <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="115" id="S3.F4.g1" src="/html/2403.15371/assets/x3.png" width="461"/>
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_figure">
      Figure 4:
     </span>
     <span class="ltx_text ltx_font_smallcaps" id="S3.F4.9.1">
      Gpt-4
     </span>
     for
     <math alttext="T=100" class="ltx_Math" display="inline" id="S3.F4.3.m1.1">
      <semantics id="S3.F4.3.m1.1b">
       <mrow id="S3.F4.3.m1.1.1" xref="S3.F4.3.m1.1.1.cmml">
        <mi id="S3.F4.3.m1.1.1.2" xref="S3.F4.3.m1.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.F4.3.m1.1.1.1" xref="S3.F4.3.m1.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.F4.3.m1.1.1.3" xref="S3.F4.3.m1.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.F4.3.m1.1c">
        <apply id="S3.F4.3.m1.1.1.cmml" xref="S3.F4.3.m1.1.1">
         <eq id="S3.F4.3.m1.1.1.1.cmml" xref="S3.F4.3.m1.1.1.1">
         </eq>
         <ci id="S3.F4.3.m1.1.1.2.cmml" xref="S3.F4.3.m1.1.1.2">
          𝑇
         </ci>
         <cn id="S3.F4.3.m1.1.1.3.cmml" type="integer" xref="S3.F4.3.m1.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F4.3.m1.1d">
        T=100
       </annotation>
      </semantics>
     </math>
     : a per-configuration
     <span class="ltx_text ltx_font_bold" id="S3.F4.10.2">
      summary
table
     </span>
     on the
     <span class="ltx_text ltx_font_typewriter" id="S3.F4.11.3">
      hard
     </span>
     MAB instance.
Only
three
     <span class="ltx_text ltx_font_smallcaps" id="S3.F4.12.4">
      Gpt-4
     </span>
     configurations do not exhibit suffix failures; two of
these (BNRND and BSSCD) exhibit uniform-like failures. The final
configuration (BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.F4.4.m2.1">
      <semantics id="S3.F4.4.m2.1b">
       <mover accent="true" id="S3.F4.4.m2.1.1" xref="S3.F4.4.m2.1.1.cmml">
        <mtext id="S3.F4.4.m2.1.1.2" xref="S3.F4.4.m2.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.F4.4.m2.1.1.1" xref="S3.F4.4.m2.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.F4.4.m2.1c">
        <apply id="S3.F4.4.m2.1.1.cmml" xref="S3.F4.4.m2.1.1">
         <ci id="S3.F4.4.m2.1.1.1.cmml" xref="S3.F4.4.m2.1.1.1">
          ~
         </ci>
         <ci id="S3.F4.4.m2.1.1.2a.cmml" xref="S3.F4.4.m2.1.1.2">
          <mtext id="S3.F4.4.m2.1.1.2.cmml" xref="S3.F4.4.m2.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F4.4.m2.1d">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0) succeeds.
    </figcaption>
   </figure>
   <figure class="ltx_figure" id="S3.F5">
    <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="116" id="S3.F5.g1" src="/html/2403.15371/assets/x4.png" width="461"/>
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_figure">
      Figure 5:
     </span>
     Detailed view of bimodal behavior and suffix failures for
     <span class="ltx_text ltx_font_smallcaps" id="S3.F5.6.1">
      Gpt-4
     </span>
     with
     <math alttext="T=100" class="ltx_Math" display="inline" id="S3.F5.3.m1.1">
      <semantics id="S3.F5.3.m1.1b">
       <mrow id="S3.F5.3.m1.1.1" xref="S3.F5.3.m1.1.1.cmml">
        <mi id="S3.F5.3.m1.1.1.2" xref="S3.F5.3.m1.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.F5.3.m1.1.1.1" xref="S3.F5.3.m1.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.F5.3.m1.1.1.3" xref="S3.F5.3.m1.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.F5.3.m1.1c">
        <apply id="S3.F5.3.m1.1.1.cmml" xref="S3.F5.3.m1.1.1">
         <eq id="S3.F5.3.m1.1.1.1.cmml" xref="S3.F5.3.m1.1.1.1">
         </eq>
         <ci id="S3.F5.3.m1.1.1.2.cmml" xref="S3.F5.3.m1.1.1.2">
          𝑇
         </ci>
         <cn id="S3.F5.3.m1.1.1.3.cmml" type="integer" xref="S3.F5.3.m1.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F5.3.m1.1d">
        T=100
       </annotation>
      </semantics>
     </math>
     . Configurations visualized are the basic configuration (BNRN0) and the same configuration but with temperature
     <math alttext="1" class="ltx_Math" display="inline" id="S3.F5.4.m2.1">
      <semantics id="S3.F5.4.m2.1b">
       <mn id="S3.F5.4.m2.1.1" xref="S3.F5.4.m2.1.1.cmml">
        1
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.F5.4.m2.1c">
        <cn id="S3.F5.4.m2.1.1.cmml" type="integer" xref="S3.F5.4.m2.1.1">
         1
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F5.4.m2.1d">
        1
       </annotation>
      </semantics>
     </math>
     (BNRN1). Visualizations are the same as in
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        1
       </span>
      </span>
     </a>
     .
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="S3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.2
    </span>
    Identifying failures
   </h3>
   <div class="ltx_para" id="S3.SS2.p1">
    <p class="ltx_p" id="S3.SS2.p1.2">
     We now give a precise overview of the exploration failures illustrated in
     <a class="ltx_ref" href="#S3.F3" title="In 3 Experimental results ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       Figure
      </span>
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     and
     <a class="ltx_ref" href="#S3.F4" title="In 3.1 Overview ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       Figure
      </span>
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     , and provide
additional results and figures that illustrate failure in greater detail. We focus
on
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.2.1">
      Gpt-4
     </span>
     , as
we find that
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.2.2">
      Gpt-3.5
     </span>
     and
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.2.3">
      Llama2
     </span>
     perform worse (and often
     <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.2.4">
      much
     </em>
     worse) in all experiments; detailed results for
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.2.5">
      Gpt-3.5
     </span>
     and
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p1.2.6">
      Llama2
     </span>
     are included in
     <a class="ltx_ref" href="#A2" title="Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      Appendix
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        B
       </span>
      </span>
     </a>
     for completeness. We begin
with detailed background on the surrogate statistics,
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS2.p1.2.7">
      SuffFailFreq
     </span>
     and
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS2.p1.2.8">
      MinFrac
     </span>
     , used to quantify failures
in
     <a class="ltx_ref" href="#S3.F3" title="In 3 Experimental results ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       Figures
      </span>
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     and
     <a class="ltx_ref" href="#S3.F4" title="Figure 4 ‣ 3.1 Overview ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     and beyond, providing evidence that exploration
failure—as quantified by these statistics—results in a persistent drop in performance.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p2">
    <p class="ltx_p" id="S3.SS2.p2.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">
      Suffix failures.
     </span>
     Most of the LLM configurations we consider exhibit highly
     <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.1.2">
      bimodal
     </em>
     behavior, whereby a large fraction of the replicates
choose the best arm very rarely, and a few
replicates converge to the best arm extremely quickly. Consistent with
this bimodal behavior, we observe a large incidence of
     <em class="ltx_emph ltx_font_italic" id="S3.SS2.p2.1.3">
      suffix
failures
     </em>
     , where the best arm is not selected even once after a
small number initial of rounds (i.e., in some “time suffix”). Suffix failures are suggestive of a long-term failure to explore which cannot be improved by running the algorithm for longer, because, without playing the optimal arm, one cannot acquire information to learn that it is indeed optimal. Such behaviors
are qualitatively similar to those of
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p2.1.4">
      Greedy
     </span>
     and qualitatively very different from those of
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p2.1.5">
      UCB
     </span>
     and Thompson Sampling.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p3">
    <p class="ltx_p" id="S3.SS2.p3.10">
     Our surrogate statistic for measuring suffix failures is defined as
follows: For an experiment replicate
     <math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1">
      <semantics id="S3.SS2.p3.1.m1.1a">
       <mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">
        R
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b">
        <ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">
         𝑅
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">
        R
       </annotation>
      </semantics>
     </math>
     and round
     <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1">
      <semantics id="S3.SS2.p3.2.m2.1a">
       <mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b">
        <ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">
        t
       </annotation>
      </semantics>
     </math>
     , let
     <math alttext="\texttt{SuffFail}(t,R)" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.2">
      <semantics id="S3.SS2.p3.3.m3.2a">
       <mrow id="S3.SS2.p3.3.m3.2.3" xref="S3.SS2.p3.3.m3.2.3.cmml">
        <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.3.m3.2.3.2" xref="S3.SS2.p3.3.m3.2.3.2a.cmml">
         SuffFail
        </mtext>
        <mo id="S3.SS2.p3.3.m3.2.3.1" lspace="0em" rspace="0em" xref="S3.SS2.p3.3.m3.2.3.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p3.3.m3.2.3.3.2" xref="S3.SS2.p3.3.m3.2.3.3.1.cmml">
         <mo id="S3.SS2.p3.3.m3.2.3.3.2.1" stretchy="false" xref="S3.SS2.p3.3.m3.2.3.3.1.cmml">
          (
         </mo>
         <mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">
          t
         </mi>
         <mo id="S3.SS2.p3.3.m3.2.3.3.2.2" xref="S3.SS2.p3.3.m3.2.3.3.1.cmml">
          ,
         </mo>
         <mi id="S3.SS2.p3.3.m3.2.2" xref="S3.SS2.p3.3.m3.2.2.cmml">
          R
         </mi>
         <mo id="S3.SS2.p3.3.m3.2.3.3.2.3" stretchy="false" xref="S3.SS2.p3.3.m3.2.3.3.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.2b">
        <apply id="S3.SS2.p3.3.m3.2.3.cmml" xref="S3.SS2.p3.3.m3.2.3">
         <times id="S3.SS2.p3.3.m3.2.3.1.cmml" xref="S3.SS2.p3.3.m3.2.3.1">
         </times>
         <ci id="S3.SS2.p3.3.m3.2.3.2a.cmml" xref="S3.SS2.p3.3.m3.2.3.2">
          <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.3.m3.2.3.2.cmml" xref="S3.SS2.p3.3.m3.2.3.2">
           SuffFail
          </mtext>
         </ci>
         <interval closure="open" id="S3.SS2.p3.3.m3.2.3.3.1.cmml" xref="S3.SS2.p3.3.m3.2.3.3.2">
          <ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">
           𝑡
          </ci>
          <ci id="S3.SS2.p3.3.m3.2.2.cmml" xref="S3.SS2.p3.3.m3.2.2">
           𝑅
          </ci>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.2c">
        \texttt{SuffFail}(t,R)
       </annotation>
      </semantics>
     </math>
     be a binary variable that is
     <math alttext="1" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1">
      <semantics id="S3.SS2.p3.4.m4.1a">
       <mn id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">
        1
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b">
        <cn id="S3.SS2.p3.4.m4.1.1.cmml" type="integer" xref="S3.SS2.p3.4.m4.1.1">
         1
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">
        1
       </annotation>
      </semantics>
     </math>
     if the best arm is
never chosen in rounds
     <math alttext="[t,T]" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.2">
      <semantics id="S3.SS2.p3.5.m5.2a">
       <mrow id="S3.SS2.p3.5.m5.2.3.2" xref="S3.SS2.p3.5.m5.2.3.1.cmml">
        <mo id="S3.SS2.p3.5.m5.2.3.2.1" stretchy="false" xref="S3.SS2.p3.5.m5.2.3.1.cmml">
         [
        </mo>
        <mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">
         t
        </mi>
        <mo id="S3.SS2.p3.5.m5.2.3.2.2" xref="S3.SS2.p3.5.m5.2.3.1.cmml">
         ,
        </mo>
        <mi id="S3.SS2.p3.5.m5.2.2" xref="S3.SS2.p3.5.m5.2.2.cmml">
         T
        </mi>
        <mo id="S3.SS2.p3.5.m5.2.3.2.3" stretchy="false" xref="S3.SS2.p3.5.m5.2.3.1.cmml">
         ]
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.2b">
        <interval closure="closed" id="S3.SS2.p3.5.m5.2.3.1.cmml" xref="S3.SS2.p3.5.m5.2.3.2">
         <ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">
          𝑡
         </ci>
         <ci id="S3.SS2.p3.5.m5.2.2.cmml" xref="S3.SS2.p3.5.m5.2.2">
          𝑇
         </ci>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.2c">
        [t,T]
       </annotation>
      </semantics>
     </math>
     . Then let
     <math alttext="\texttt{SuffFailFreq}(t):=\text{mean}(\left\{\texttt{SuffFail}(t,R):\,\text{replicates $R$}\right\})" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.5">
      <semantics id="S3.SS2.p3.6.m6.5a">
       <mrow id="S3.SS2.p3.6.m6.5.5" xref="S3.SS2.p3.6.m6.5.5.cmml">
        <mrow id="S3.SS2.p3.6.m6.5.5.3" xref="S3.SS2.p3.6.m6.5.5.3.cmml">
         <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.6.m6.5.5.3.2" xref="S3.SS2.p3.6.m6.5.5.3.2a.cmml">
          SuffFailFreq
         </mtext>
         <mo id="S3.SS2.p3.6.m6.5.5.3.1" lspace="0em" rspace="0em" xref="S3.SS2.p3.6.m6.5.5.3.1.cmml">
          ​
         </mo>
         <mrow id="S3.SS2.p3.6.m6.5.5.3.3.2" xref="S3.SS2.p3.6.m6.5.5.3.cmml">
          <mo id="S3.SS2.p3.6.m6.5.5.3.3.2.1" stretchy="false" xref="S3.SS2.p3.6.m6.5.5.3.cmml">
           (
          </mo>
          <mi id="S3.SS2.p3.6.m6.2.2" xref="S3.SS2.p3.6.m6.2.2.cmml">
           t
          </mi>
          <mo id="S3.SS2.p3.6.m6.5.5.3.3.2.2" rspace="0.278em" stretchy="false" xref="S3.SS2.p3.6.m6.5.5.3.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S3.SS2.p3.6.m6.5.5.2" rspace="0.278em" xref="S3.SS2.p3.6.m6.5.5.2.cmml">
         :=
        </mo>
        <mrow id="S3.SS2.p3.6.m6.5.5.1" xref="S3.SS2.p3.6.m6.5.5.1.cmml">
         <mtext id="S3.SS2.p3.6.m6.5.5.1.3" xref="S3.SS2.p3.6.m6.5.5.1.3a.cmml">
          mean
         </mtext>
         <mo id="S3.SS2.p3.6.m6.5.5.1.2" lspace="0em" rspace="0em" xref="S3.SS2.p3.6.m6.5.5.1.2.cmml">
          ​
         </mo>
         <mrow id="S3.SS2.p3.6.m6.5.5.1.1.1" xref="S3.SS2.p3.6.m6.5.5.1.cmml">
          <mo id="S3.SS2.p3.6.m6.5.5.1.1.1.2" stretchy="false" xref="S3.SS2.p3.6.m6.5.5.1.cmml">
           (
          </mo>
          <mrow id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.2.cmml">
           <mo id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.2" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.2.1.cmml">
            {
           </mo>
           <mrow id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.cmml">
            <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.2" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.2a.cmml">
             SuffFail
            </mtext>
            <mo id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.1.cmml">
             ​
            </mo>
            <mrow id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.3.2" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.3.1.cmml">
             <mo id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.3.1.cmml">
              (
             </mo>
             <mi id="S3.SS2.p3.6.m6.3.3" xref="S3.SS2.p3.6.m6.3.3.cmml">
              t
             </mi>
             <mo id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.3.2.2" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.3.1.cmml">
              ,
             </mo>
             <mi id="S3.SS2.p3.6.m6.4.4" xref="S3.SS2.p3.6.m6.4.4.cmml">
              R
             </mi>
             <mo id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.3.2.3" rspace="0.278em" stretchy="false" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.3.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.3" rspace="0.448em" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.2.1.cmml">
            :
           </mo>
           <mrow id="S3.SS2.p3.6.m6.1.1.1" xref="S3.SS2.p3.6.m6.1.1.1b.cmml">
            <mtext id="S3.SS2.p3.6.m6.1.1.1a" xref="S3.SS2.p3.6.m6.1.1.1b.cmml">
             replicates
            </mtext>
            <mi id="S3.SS2.p3.6.m6.1.1.1.m1.1.1" xref="S3.SS2.p3.6.m6.1.1.1.m1.1.1.cmml">
             R
            </mi>
           </mrow>
           <mo id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.4" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.2.1.cmml">
            }
           </mo>
          </mrow>
          <mo id="S3.SS2.p3.6.m6.5.5.1.1.1.3" stretchy="false" xref="S3.SS2.p3.6.m6.5.5.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.5b">
        <apply id="S3.SS2.p3.6.m6.5.5.cmml" xref="S3.SS2.p3.6.m6.5.5">
         <csymbol cd="latexml" id="S3.SS2.p3.6.m6.5.5.2.cmml" xref="S3.SS2.p3.6.m6.5.5.2">
          assign
         </csymbol>
         <apply id="S3.SS2.p3.6.m6.5.5.3.cmml" xref="S3.SS2.p3.6.m6.5.5.3">
          <times id="S3.SS2.p3.6.m6.5.5.3.1.cmml" xref="S3.SS2.p3.6.m6.5.5.3.1">
          </times>
          <ci id="S3.SS2.p3.6.m6.5.5.3.2a.cmml" xref="S3.SS2.p3.6.m6.5.5.3.2">
           <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.6.m6.5.5.3.2.cmml" xref="S3.SS2.p3.6.m6.5.5.3.2">
            SuffFailFreq
           </mtext>
          </ci>
          <ci id="S3.SS2.p3.6.m6.2.2.cmml" xref="S3.SS2.p3.6.m6.2.2">
           𝑡
          </ci>
         </apply>
         <apply id="S3.SS2.p3.6.m6.5.5.1.cmml" xref="S3.SS2.p3.6.m6.5.5.1">
          <times id="S3.SS2.p3.6.m6.5.5.1.2.cmml" xref="S3.SS2.p3.6.m6.5.5.1.2">
          </times>
          <ci id="S3.SS2.p3.6.m6.5.5.1.3a.cmml" xref="S3.SS2.p3.6.m6.5.5.1.3">
           <mtext id="S3.SS2.p3.6.m6.5.5.1.3.cmml" xref="S3.SS2.p3.6.m6.5.5.1.3">
            mean
           </mtext>
          </ci>
          <apply id="S3.SS2.p3.6.m6.5.5.1.1.1.1.2.cmml" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1">
           <csymbol cd="latexml" id="S3.SS2.p3.6.m6.5.5.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.2">
            conditional-set
           </csymbol>
           <apply id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1">
            <times id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.1">
            </times>
            <ci id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.2a.cmml" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.2">
             <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.2">
              SuffFail
             </mtext>
            </ci>
            <interval closure="open" id="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p3.6.m6.5.5.1.1.1.1.1.1.3.2">
             <ci id="S3.SS2.p3.6.m6.3.3.cmml" xref="S3.SS2.p3.6.m6.3.3">
              𝑡
             </ci>
             <ci id="S3.SS2.p3.6.m6.4.4.cmml" xref="S3.SS2.p3.6.m6.4.4">
              𝑅
             </ci>
            </interval>
           </apply>
           <ci id="S3.SS2.p3.6.m6.1.1.1b.cmml" xref="S3.SS2.p3.6.m6.1.1.1">
            <mrow id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1.1">
             <mtext id="S3.SS2.p3.6.m6.1.1.1a.cmml" xref="S3.SS2.p3.6.m6.1.1.1">
              replicates
             </mtext>
             <mi id="S3.SS2.p3.6.m6.1.1.1.m1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1.1.m1.1.1">
              R
             </mi>
            </mrow>
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.5c">
        \texttt{SuffFailFreq}(t):=\text{mean}(\left\{\texttt{SuffFail}(t,R):\,\text{replicates $R$}\right\})
       </annotation>
      </semantics>
     </math>
     . Suffix failures manifest in most of our experiments at
     <math alttext="T=100" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1">
      <semantics id="S3.SS2.p3.7.m7.1a">
       <mrow id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml">
        <mi id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.SS2.p3.7.m7.1.1.1" xref="S3.SS2.p3.7.m7.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b">
        <apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">
         <eq id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1">
         </eq>
         <ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">
          𝑇
         </ci>
         <cn id="S3.SS2.p3.7.m7.1.1.3.cmml" type="integer" xref="S3.SS2.p3.7.m7.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">
        T=100
       </annotation>
      </semantics>
     </math>
     .
In the scatter plot in
     <a class="ltx_ref" href="#S3.F3" title="Figure 3 ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        3
       </span>
      </span>
     </a>
     , the X-axis plots
     <math alttext="\texttt{SuffFailFreq}(T/2)" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m8.1">
      <semantics id="S3.SS2.p3.8.m8.1a">
       <mrow id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml">
        <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.8.m8.1.1.3" xref="S3.SS2.p3.8.m8.1.1.3a.cmml">
         SuffFailFreq
        </mtext>
        <mo id="S3.SS2.p3.8.m8.1.1.2" lspace="0em" rspace="0em" xref="S3.SS2.p3.8.m8.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p3.8.m8.1.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.1.1.cmml">
         <mo id="S3.SS2.p3.8.m8.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.8.m8.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S3.SS2.p3.8.m8.1.1.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.1.1.cmml">
          <mi id="S3.SS2.p3.8.m8.1.1.1.1.1.2" xref="S3.SS2.p3.8.m8.1.1.1.1.1.2.cmml">
           T
          </mi>
          <mo id="S3.SS2.p3.8.m8.1.1.1.1.1.1" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1.cmml">
           /
          </mo>
          <mn id="S3.SS2.p3.8.m8.1.1.1.1.1.3" xref="S3.SS2.p3.8.m8.1.1.1.1.1.3.cmml">
           2
          </mn>
         </mrow>
         <mo id="S3.SS2.p3.8.m8.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.8.m8.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b">
        <apply id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">
         <times id="S3.SS2.p3.8.m8.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.2">
         </times>
         <ci id="S3.SS2.p3.8.m8.1.1.3a.cmml" xref="S3.SS2.p3.8.m8.1.1.3">
          <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.8.m8.1.1.3.cmml" xref="S3.SS2.p3.8.m8.1.1.3">
           SuffFailFreq
          </mtext>
         </ci>
         <apply id="S3.SS2.p3.8.m8.1.1.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1">
          <divide id="S3.SS2.p3.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.1.1">
          </divide>
          <ci id="S3.SS2.p3.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.1.1.1.2">
           𝑇
          </ci>
          <cn id="S3.SS2.p3.8.m8.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p3.8.m8.1.1.1.1.1.3">
           2
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">
        \texttt{SuffFailFreq}(T/2)
       </annotation>
      </semantics>
     </math>
     for each
LLM configuration, and we find that all but five configurations have
     <math alttext="\texttt{SuffFailFreq}(T/2)\geq 15\%" class="ltx_Math" display="inline" id="S3.SS2.p3.9.m9.1">
      <semantics id="S3.SS2.p3.9.m9.1a">
       <mrow id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml">
        <mrow id="S3.SS2.p3.9.m9.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.cmml">
         <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.9.m9.1.1.1.3" xref="S3.SS2.p3.9.m9.1.1.1.3a.cmml">
          SuffFailFreq
         </mtext>
         <mo id="S3.SS2.p3.9.m9.1.1.1.2" lspace="0em" rspace="0em" xref="S3.SS2.p3.9.m9.1.1.1.2.cmml">
          ​
         </mo>
         <mrow id="S3.SS2.p3.9.m9.1.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.cmml">
          <mo id="S3.SS2.p3.9.m9.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.cmml">
           (
          </mo>
          <mrow id="S3.SS2.p3.9.m9.1.1.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.cmml">
           <mi id="S3.SS2.p3.9.m9.1.1.1.1.1.1.2" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.2.cmml">
            T
           </mi>
           <mo id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.cmml">
            /
           </mo>
           <mn id="S3.SS2.p3.9.m9.1.1.1.1.1.1.3" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.3.cmml">
            2
           </mn>
          </mrow>
          <mo id="S3.SS2.p3.9.m9.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S3.SS2.p3.9.m9.1.1.2" xref="S3.SS2.p3.9.m9.1.1.2.cmml">
         ≥
        </mo>
        <mrow id="S3.SS2.p3.9.m9.1.1.3" xref="S3.SS2.p3.9.m9.1.1.3.cmml">
         <mn id="S3.SS2.p3.9.m9.1.1.3.2" xref="S3.SS2.p3.9.m9.1.1.3.2.cmml">
          15
         </mn>
         <mo id="S3.SS2.p3.9.m9.1.1.3.1" xref="S3.SS2.p3.9.m9.1.1.3.1.cmml">
          %
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b">
        <apply id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">
         <geq id="S3.SS2.p3.9.m9.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.2">
         </geq>
         <apply id="S3.SS2.p3.9.m9.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1.1">
          <times id="S3.SS2.p3.9.m9.1.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.1.2">
          </times>
          <ci id="S3.SS2.p3.9.m9.1.1.1.3a.cmml" xref="S3.SS2.p3.9.m9.1.1.1.3">
           <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p3.9.m9.1.1.1.3.cmml" xref="S3.SS2.p3.9.m9.1.1.1.3">
            SuffFailFreq
           </mtext>
          </ci>
          <apply id="S3.SS2.p3.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1">
           <divide id="S3.SS2.p3.9.m9.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.1">
           </divide>
           <ci id="S3.SS2.p3.9.m9.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.2">
            𝑇
           </ci>
           <cn id="S3.SS2.p3.9.m9.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p3.9.m9.1.1.1.1.1.1.3">
            2
           </cn>
          </apply>
         </apply>
         <apply id="S3.SS2.p3.9.m9.1.1.3.cmml" xref="S3.SS2.p3.9.m9.1.1.3">
          <csymbol cd="latexml" id="S3.SS2.p3.9.m9.1.1.3.1.cmml" xref="S3.SS2.p3.9.m9.1.1.3.1">
           percent
          </csymbol>
          <cn id="S3.SS2.p3.9.m9.1.1.3.2.cmml" type="integer" xref="S3.SS2.p3.9.m9.1.1.3.2">
           15
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">
        \texttt{SuffFailFreq}(T/2)\geq 15\%
       </annotation>
      </semantics>
     </math>
     . Recalling the definition of suffix
failures, this means that
     <math alttext="\geq 15\%" class="ltx_Math" display="inline" id="S3.SS2.p3.10.m10.1">
      <semantics id="S3.SS2.p3.10.m10.1a">
       <mrow id="S3.SS2.p3.10.m10.1.1" xref="S3.SS2.p3.10.m10.1.1.cmml">
        <mi id="S3.SS2.p3.10.m10.1.1.2" xref="S3.SS2.p3.10.m10.1.1.2.cmml">
        </mi>
        <mo id="S3.SS2.p3.10.m10.1.1.1" xref="S3.SS2.p3.10.m10.1.1.1.cmml">
         ≥
        </mo>
        <mrow id="S3.SS2.p3.10.m10.1.1.3" xref="S3.SS2.p3.10.m10.1.1.3.cmml">
         <mn id="S3.SS2.p3.10.m10.1.1.3.2" xref="S3.SS2.p3.10.m10.1.1.3.2.cmml">
          15
         </mn>
         <mo id="S3.SS2.p3.10.m10.1.1.3.1" xref="S3.SS2.p3.10.m10.1.1.3.1.cmml">
          %
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.1b">
        <apply id="S3.SS2.p3.10.m10.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1">
         <geq id="S3.SS2.p3.10.m10.1.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1.1">
         </geq>
         <csymbol cd="latexml" id="S3.SS2.p3.10.m10.1.1.2.cmml" xref="S3.SS2.p3.10.m10.1.1.2">
          absent
         </csymbol>
         <apply id="S3.SS2.p3.10.m10.1.1.3.cmml" xref="S3.SS2.p3.10.m10.1.1.3">
          <csymbol cd="latexml" id="S3.SS2.p3.10.m10.1.1.3.1.cmml" xref="S3.SS2.p3.10.m10.1.1.3.1">
           percent
          </csymbol>
          <cn id="S3.SS2.p3.10.m10.1.1.3.2.cmml" type="integer" xref="S3.SS2.p3.10.m10.1.1.3.2">
           15
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.1c">
        \geq 15\%
       </annotation>
      </semantics>
     </math>
     of the time, these configurations do
not pull the best arm
     <em class="ltx_emph ltx_font_italic" id="S3.SS2.p3.10.1">
      even once
     </em>
     in the last half of the rounds.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p4">
    <p class="ltx_p" id="S3.SS2.p4.7">
     A more detailed view of suffix failures and bimodal behavior can be
obtained by focusing on individual LLM configurations. We visualize
this for the basic configuration (
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p4.7.1">
      Gpt-4
     </span>
     -BNRN0) in
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        1
       </span>
      </span>
     </a>
     (top) for
     <math alttext="T=500" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1">
      <semantics id="S3.SS2.p4.1.m1.1a">
       <mrow id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">
        <mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.SS2.p4.1.m1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">
         500
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b">
        <apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">
         <eq id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1">
         </eq>
         <ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">
          𝑇
         </ci>
         <cn id="S3.SS2.p4.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p4.1.m1.1.1.3">
          500
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">
        T=500
       </annotation>
      </semantics>
     </math>
     , and
in
     <a class="ltx_ref" href="#S3.F5" title="Figure 5 ‣ 3.1 Overview ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        5
       </span>
      </span>
     </a>
     for
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p4.7.2">
      Gpt-4
     </span>
     (BNRN0 and BNRN1) at
     <math alttext="T=100" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1">
      <semantics id="S3.SS2.p4.2.m2.1a">
       <mrow id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">
        <mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.SS2.p4.2.m2.1.1.1" xref="S3.SS2.p4.2.m2.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b">
        <apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">
         <eq id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1">
         </eq>
         <ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">
          𝑇
         </ci>
         <cn id="S3.SS2.p4.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p4.2.m2.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">
        T=100
       </annotation>
      </semantics>
     </math>
     .
In these detailed views, the middle panels plot
     <math alttext="\texttt{SuffFailFreq}(t)" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1">
      <semantics id="S3.SS2.p4.3.m3.1a">
       <mrow id="S3.SS2.p4.3.m3.1.2" xref="S3.SS2.p4.3.m3.1.2.cmml">
        <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p4.3.m3.1.2.2" xref="S3.SS2.p4.3.m3.1.2.2a.cmml">
         SuffFailFreq
        </mtext>
        <mo id="S3.SS2.p4.3.m3.1.2.1" lspace="0em" rspace="0em" xref="S3.SS2.p4.3.m3.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p4.3.m3.1.2.3.2" xref="S3.SS2.p4.3.m3.1.2.cmml">
         <mo id="S3.SS2.p4.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS2.p4.3.m3.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">
          t
         </mi>
         <mo id="S3.SS2.p4.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS2.p4.3.m3.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b">
        <apply id="S3.SS2.p4.3.m3.1.2.cmml" xref="S3.SS2.p4.3.m3.1.2">
         <times id="S3.SS2.p4.3.m3.1.2.1.cmml" xref="S3.SS2.p4.3.m3.1.2.1">
         </times>
         <ci id="S3.SS2.p4.3.m3.1.2.2a.cmml" xref="S3.SS2.p4.3.m3.1.2.2">
          <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p4.3.m3.1.2.2.cmml" xref="S3.SS2.p4.3.m3.1.2.2">
           SuffFailFreq
          </mtext>
         </ci>
         <ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">
        \texttt{SuffFailFreq}(t)
       </annotation>
      </semantics>
     </math>
     at
each time
     <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.1">
      <semantics id="S3.SS2.p4.4.m4.1a">
       <mi id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b">
        <ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">
        t
       </annotation>
      </semantics>
     </math>
     for the given LLM configurations, as well as
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p4.7.3">
      UCB
     </span>
     ,
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p4.7.4">
      TS
     </span>
     , and
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p4.7.5">
      Greedy
     </span>
     . We find that these LLM configurations have much higher suffix failure rates than both
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p4.7.6">
      UCB
     </span>
     and
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p4.7.7">
      TS
     </span>
     .
Bimodal behavior
is visualized in the left panel of each plot, where for each
configuration, a large fraction of replicates rarely pulls the best
arm, while the remaining fraction almost always pulls the best arm.
Because of this bimodal behavior (particularly because a constant
fraction of replicates by chance
almost always pull the best arm), suffix failures are not fully
reflected in the total reward plots in the right panels of
     <a class="ltx_ref" href="#S3.F5" title="In 3.1 Overview ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       Figure
      </span>
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     , since the time horizon
     <math alttext="T=100" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.1">
      <semantics id="S3.SS2.p4.5.m5.1a">
       <mrow id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">
        <mi id="S3.SS2.p4.5.m5.1.1.2" xref="S3.SS2.p4.5.m5.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.SS2.p4.5.m5.1.1.1" xref="S3.SS2.p4.5.m5.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS2.p4.5.m5.1.1.3" xref="S3.SS2.p4.5.m5.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b">
        <apply id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">
         <eq id="S3.SS2.p4.5.m5.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1.1">
         </eq>
         <ci id="S3.SS2.p4.5.m5.1.1.2.cmml" xref="S3.SS2.p4.5.m5.1.1.2">
          𝑇
         </ci>
         <cn id="S3.SS2.p4.5.m5.1.1.3.cmml" type="integer" xref="S3.SS2.p4.5.m5.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">
        T=100
       </annotation>
      </semantics>
     </math>
     is not large enough. However, as mentioned,
suffix failures are suggestive of an irrecoverable failure to explore
which leads to stark differences in reward for larger
     <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.p4.6.m6.1">
      <semantics id="S3.SS2.p4.6.m6.1a">
       <mi id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b">
        <ci id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">
        T
       </annotation>
      </semantics>
     </math>
     . This
is precisely what we find at
     <math alttext="T=500" class="ltx_Math" display="inline" id="S3.SS2.p4.7.m7.1">
      <semantics id="S3.SS2.p4.7.m7.1a">
       <mrow id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml">
        <mi id="S3.SS2.p4.7.m7.1.1.2" xref="S3.SS2.p4.7.m7.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.SS2.p4.7.m7.1.1.1" xref="S3.SS2.p4.7.m7.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS2.p4.7.m7.1.1.3" xref="S3.SS2.p4.7.m7.1.1.3.cmml">
         500
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b">
        <apply id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1">
         <eq id="S3.SS2.p4.7.m7.1.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1.1">
         </eq>
         <ci id="S3.SS2.p4.7.m7.1.1.2.cmml" xref="S3.SS2.p4.7.m7.1.1.2">
          𝑇
         </ci>
         <cn id="S3.SS2.p4.7.m7.1.1.3.cmml" type="integer" xref="S3.SS2.p4.7.m7.1.1.3">
          500
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">
        T=500
       </annotation>
      </semantics>
     </math>
     in
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        1
       </span>
      </span>
     </a>
     ,
which suggests that suffix failures indeed lead to poor long-term
performance.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p5">
    <p class="ltx_p" id="S3.SS2.p5.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p5.1.1">
      Uniform-like failures.
     </span>
     Returning to the left panel of
     <a class="ltx_ref" href="#S3.F3" title="Figure 3 ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        3
       </span>
      </span>
     </a>
     , we see that three
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p5.1.2">
      Gpt-4
     </span>
     configurations avoid suffix failures.
Two of these configurations exhibit a different type of failure,
where the LLM selects arms in roughly equal
proportions for the entirety of the
     <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1">
      <semantics id="S3.SS2.p5.1.m1.1a">
       <mi id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b">
        <ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">
        T
       </annotation>
      </semantics>
     </math>
     rounds and fails to exploit the acquired information to focus on the better arms.
We call this a
     <em class="ltx_emph ltx_font_italic" id="S3.SS2.p5.1.3">
      uniform-like failure
     </em>
     .
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p6">
    <p class="ltx_p" id="S3.SS2.p6.14">
     Our surrogate statistic for measuring such failures is defined as follows: For a particular experiment replicate
     <math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.p6.1.m1.1">
      <semantics id="S3.SS2.p6.1.m1.1a">
       <mi id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml">
        R
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b">
        <ci id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">
         𝑅
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">
        R
       </annotation>
      </semantics>
     </math>
     and round
     <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p6.2.m2.1">
      <semantics id="S3.SS2.p6.2.m2.1a">
       <mi id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b">
        <ci id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">
        t
       </annotation>
      </semantics>
     </math>
     , let
     <math alttext="f_{a}(t,R)" class="ltx_Math" display="inline" id="S3.SS2.p6.3.m3.2">
      <semantics id="S3.SS2.p6.3.m3.2a">
       <mrow id="S3.SS2.p6.3.m3.2.3" xref="S3.SS2.p6.3.m3.2.3.cmml">
        <msub id="S3.SS2.p6.3.m3.2.3.2" xref="S3.SS2.p6.3.m3.2.3.2.cmml">
         <mi id="S3.SS2.p6.3.m3.2.3.2.2" xref="S3.SS2.p6.3.m3.2.3.2.2.cmml">
          f
         </mi>
         <mi id="S3.SS2.p6.3.m3.2.3.2.3" xref="S3.SS2.p6.3.m3.2.3.2.3.cmml">
          a
         </mi>
        </msub>
        <mo id="S3.SS2.p6.3.m3.2.3.1" lspace="0em" rspace="0em" xref="S3.SS2.p6.3.m3.2.3.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p6.3.m3.2.3.3.2" xref="S3.SS2.p6.3.m3.2.3.3.1.cmml">
         <mo id="S3.SS2.p6.3.m3.2.3.3.2.1" stretchy="false" xref="S3.SS2.p6.3.m3.2.3.3.1.cmml">
          (
         </mo>
         <mi id="S3.SS2.p6.3.m3.1.1" xref="S3.SS2.p6.3.m3.1.1.cmml">
          t
         </mi>
         <mo id="S3.SS2.p6.3.m3.2.3.3.2.2" xref="S3.SS2.p6.3.m3.2.3.3.1.cmml">
          ,
         </mo>
         <mi id="S3.SS2.p6.3.m3.2.2" xref="S3.SS2.p6.3.m3.2.2.cmml">
          R
         </mi>
         <mo id="S3.SS2.p6.3.m3.2.3.3.2.3" stretchy="false" xref="S3.SS2.p6.3.m3.2.3.3.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.3.m3.2b">
        <apply id="S3.SS2.p6.3.m3.2.3.cmml" xref="S3.SS2.p6.3.m3.2.3">
         <times id="S3.SS2.p6.3.m3.2.3.1.cmml" xref="S3.SS2.p6.3.m3.2.3.1">
         </times>
         <apply id="S3.SS2.p6.3.m3.2.3.2.cmml" xref="S3.SS2.p6.3.m3.2.3.2">
          <csymbol cd="ambiguous" id="S3.SS2.p6.3.m3.2.3.2.1.cmml" xref="S3.SS2.p6.3.m3.2.3.2">
           subscript
          </csymbol>
          <ci id="S3.SS2.p6.3.m3.2.3.2.2.cmml" xref="S3.SS2.p6.3.m3.2.3.2.2">
           𝑓
          </ci>
          <ci id="S3.SS2.p6.3.m3.2.3.2.3.cmml" xref="S3.SS2.p6.3.m3.2.3.2.3">
           𝑎
          </ci>
         </apply>
         <interval closure="open" id="S3.SS2.p6.3.m3.2.3.3.1.cmml" xref="S3.SS2.p6.3.m3.2.3.3.2">
          <ci id="S3.SS2.p6.3.m3.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1">
           𝑡
          </ci>
          <ci id="S3.SS2.p6.3.m3.2.2.cmml" xref="S3.SS2.p6.3.m3.2.2">
           𝑅
          </ci>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.3.m3.2c">
        f_{a}(t,R)
       </annotation>
      </semantics>
     </math>
     be the fraction of rounds in which a given arm
     <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.p6.4.m4.1">
      <semantics id="S3.SS2.p6.4.m4.1a">
       <mi id="S3.SS2.p6.4.m4.1.1" xref="S3.SS2.p6.4.m4.1.1.cmml">
        a
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.4.m4.1b">
        <ci id="S3.SS2.p6.4.m4.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1">
         𝑎
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.4.m4.1c">
        a
       </annotation>
      </semantics>
     </math>
     is chosen,
     <math alttext="\texttt{MinFrac}(t,R):=\min_{a}f_{a}(t,R)" class="ltx_Math" display="inline" id="S3.SS2.p6.5.m5.4">
      <semantics id="S3.SS2.p6.5.m5.4a">
       <mrow id="S3.SS2.p6.5.m5.4.5" xref="S3.SS2.p6.5.m5.4.5.cmml">
        <mrow id="S3.SS2.p6.5.m5.4.5.2" xref="S3.SS2.p6.5.m5.4.5.2.cmml">
         <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.5.m5.4.5.2.2" xref="S3.SS2.p6.5.m5.4.5.2.2a.cmml">
          MinFrac
         </mtext>
         <mo id="S3.SS2.p6.5.m5.4.5.2.1" lspace="0em" rspace="0em" xref="S3.SS2.p6.5.m5.4.5.2.1.cmml">
          ​
         </mo>
         <mrow id="S3.SS2.p6.5.m5.4.5.2.3.2" xref="S3.SS2.p6.5.m5.4.5.2.3.1.cmml">
          <mo id="S3.SS2.p6.5.m5.4.5.2.3.2.1" stretchy="false" xref="S3.SS2.p6.5.m5.4.5.2.3.1.cmml">
           (
          </mo>
          <mi id="S3.SS2.p6.5.m5.1.1" xref="S3.SS2.p6.5.m5.1.1.cmml">
           t
          </mi>
          <mo id="S3.SS2.p6.5.m5.4.5.2.3.2.2" xref="S3.SS2.p6.5.m5.4.5.2.3.1.cmml">
           ,
          </mo>
          <mi id="S3.SS2.p6.5.m5.2.2" xref="S3.SS2.p6.5.m5.2.2.cmml">
           R
          </mi>
          <mo id="S3.SS2.p6.5.m5.4.5.2.3.2.3" rspace="0.278em" stretchy="false" xref="S3.SS2.p6.5.m5.4.5.2.3.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S3.SS2.p6.5.m5.4.5.1" rspace="0.278em" xref="S3.SS2.p6.5.m5.4.5.1.cmml">
         :=
        </mo>
        <mrow id="S3.SS2.p6.5.m5.4.5.3" xref="S3.SS2.p6.5.m5.4.5.3.cmml">
         <mrow id="S3.SS2.p6.5.m5.4.5.3.2" xref="S3.SS2.p6.5.m5.4.5.3.2.cmml">
          <msub id="S3.SS2.p6.5.m5.4.5.3.2.1" xref="S3.SS2.p6.5.m5.4.5.3.2.1.cmml">
           <mi id="S3.SS2.p6.5.m5.4.5.3.2.1.2" xref="S3.SS2.p6.5.m5.4.5.3.2.1.2.cmml">
            min
           </mi>
           <mi id="S3.SS2.p6.5.m5.4.5.3.2.1.3" xref="S3.SS2.p6.5.m5.4.5.3.2.1.3.cmml">
            a
           </mi>
          </msub>
          <mo id="S3.SS2.p6.5.m5.4.5.3.2a" lspace="0.167em" xref="S3.SS2.p6.5.m5.4.5.3.2.cmml">
           ⁡
          </mo>
          <msub id="S3.SS2.p6.5.m5.4.5.3.2.2" xref="S3.SS2.p6.5.m5.4.5.3.2.2.cmml">
           <mi id="S3.SS2.p6.5.m5.4.5.3.2.2.2" xref="S3.SS2.p6.5.m5.4.5.3.2.2.2.cmml">
            f
           </mi>
           <mi id="S3.SS2.p6.5.m5.4.5.3.2.2.3" xref="S3.SS2.p6.5.m5.4.5.3.2.2.3.cmml">
            a
           </mi>
          </msub>
         </mrow>
         <mo id="S3.SS2.p6.5.m5.4.5.3.1" lspace="0em" rspace="0em" xref="S3.SS2.p6.5.m5.4.5.3.1.cmml">
          ​
         </mo>
         <mrow id="S3.SS2.p6.5.m5.4.5.3.3.2" xref="S3.SS2.p6.5.m5.4.5.3.3.1.cmml">
          <mo id="S3.SS2.p6.5.m5.4.5.3.3.2.1" stretchy="false" xref="S3.SS2.p6.5.m5.4.5.3.3.1.cmml">
           (
          </mo>
          <mi id="S3.SS2.p6.5.m5.3.3" xref="S3.SS2.p6.5.m5.3.3.cmml">
           t
          </mi>
          <mo id="S3.SS2.p6.5.m5.4.5.3.3.2.2" xref="S3.SS2.p6.5.m5.4.5.3.3.1.cmml">
           ,
          </mo>
          <mi id="S3.SS2.p6.5.m5.4.4" xref="S3.SS2.p6.5.m5.4.4.cmml">
           R
          </mi>
          <mo id="S3.SS2.p6.5.m5.4.5.3.3.2.3" stretchy="false" xref="S3.SS2.p6.5.m5.4.5.3.3.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.5.m5.4b">
        <apply id="S3.SS2.p6.5.m5.4.5.cmml" xref="S3.SS2.p6.5.m5.4.5">
         <csymbol cd="latexml" id="S3.SS2.p6.5.m5.4.5.1.cmml" xref="S3.SS2.p6.5.m5.4.5.1">
          assign
         </csymbol>
         <apply id="S3.SS2.p6.5.m5.4.5.2.cmml" xref="S3.SS2.p6.5.m5.4.5.2">
          <times id="S3.SS2.p6.5.m5.4.5.2.1.cmml" xref="S3.SS2.p6.5.m5.4.5.2.1">
          </times>
          <ci id="S3.SS2.p6.5.m5.4.5.2.2a.cmml" xref="S3.SS2.p6.5.m5.4.5.2.2">
           <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.5.m5.4.5.2.2.cmml" xref="S3.SS2.p6.5.m5.4.5.2.2">
            MinFrac
           </mtext>
          </ci>
          <interval closure="open" id="S3.SS2.p6.5.m5.4.5.2.3.1.cmml" xref="S3.SS2.p6.5.m5.4.5.2.3.2">
           <ci id="S3.SS2.p6.5.m5.1.1.cmml" xref="S3.SS2.p6.5.m5.1.1">
            𝑡
           </ci>
           <ci id="S3.SS2.p6.5.m5.2.2.cmml" xref="S3.SS2.p6.5.m5.2.2">
            𝑅
           </ci>
          </interval>
         </apply>
         <apply id="S3.SS2.p6.5.m5.4.5.3.cmml" xref="S3.SS2.p6.5.m5.4.5.3">
          <times id="S3.SS2.p6.5.m5.4.5.3.1.cmml" xref="S3.SS2.p6.5.m5.4.5.3.1">
          </times>
          <apply id="S3.SS2.p6.5.m5.4.5.3.2.cmml" xref="S3.SS2.p6.5.m5.4.5.3.2">
           <apply id="S3.SS2.p6.5.m5.4.5.3.2.1.cmml" xref="S3.SS2.p6.5.m5.4.5.3.2.1">
            <csymbol cd="ambiguous" id="S3.SS2.p6.5.m5.4.5.3.2.1.1.cmml" xref="S3.SS2.p6.5.m5.4.5.3.2.1">
             subscript
            </csymbol>
            <min id="S3.SS2.p6.5.m5.4.5.3.2.1.2.cmml" xref="S3.SS2.p6.5.m5.4.5.3.2.1.2">
            </min>
            <ci id="S3.SS2.p6.5.m5.4.5.3.2.1.3.cmml" xref="S3.SS2.p6.5.m5.4.5.3.2.1.3">
             𝑎
            </ci>
           </apply>
           <apply id="S3.SS2.p6.5.m5.4.5.3.2.2.cmml" xref="S3.SS2.p6.5.m5.4.5.3.2.2">
            <csymbol cd="ambiguous" id="S3.SS2.p6.5.m5.4.5.3.2.2.1.cmml" xref="S3.SS2.p6.5.m5.4.5.3.2.2">
             subscript
            </csymbol>
            <ci id="S3.SS2.p6.5.m5.4.5.3.2.2.2.cmml" xref="S3.SS2.p6.5.m5.4.5.3.2.2.2">
             𝑓
            </ci>
            <ci id="S3.SS2.p6.5.m5.4.5.3.2.2.3.cmml" xref="S3.SS2.p6.5.m5.4.5.3.2.2.3">
             𝑎
            </ci>
           </apply>
          </apply>
          <interval closure="open" id="S3.SS2.p6.5.m5.4.5.3.3.1.cmml" xref="S3.SS2.p6.5.m5.4.5.3.3.2">
           <ci id="S3.SS2.p6.5.m5.3.3.cmml" xref="S3.SS2.p6.5.m5.3.3">
            𝑡
           </ci>
           <ci id="S3.SS2.p6.5.m5.4.4.cmml" xref="S3.SS2.p6.5.m5.4.4">
            𝑅
           </ci>
          </interval>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.5.m5.4c">
        \texttt{MinFrac}(t,R):=\min_{a}f_{a}(t,R)
       </annotation>
      </semantics>
     </math>
     , and
     <math alttext="\texttt{MinFrac}(t):=\text{mean}(\left\{\texttt{MinFrac}(t,R):\,\text{replicates $R$}\right\})" class="ltx_Math" display="inline" id="S3.SS2.p6.6.m6.5">
      <semantics id="S3.SS2.p6.6.m6.5a">
       <mrow id="S3.SS2.p6.6.m6.5.5" xref="S3.SS2.p6.6.m6.5.5.cmml">
        <mrow id="S3.SS2.p6.6.m6.5.5.3" xref="S3.SS2.p6.6.m6.5.5.3.cmml">
         <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.6.m6.5.5.3.2" xref="S3.SS2.p6.6.m6.5.5.3.2a.cmml">
          MinFrac
         </mtext>
         <mo id="S3.SS2.p6.6.m6.5.5.3.1" lspace="0em" rspace="0em" xref="S3.SS2.p6.6.m6.5.5.3.1.cmml">
          ​
         </mo>
         <mrow id="S3.SS2.p6.6.m6.5.5.3.3.2" xref="S3.SS2.p6.6.m6.5.5.3.cmml">
          <mo id="S3.SS2.p6.6.m6.5.5.3.3.2.1" stretchy="false" xref="S3.SS2.p6.6.m6.5.5.3.cmml">
           (
          </mo>
          <mi id="S3.SS2.p6.6.m6.2.2" xref="S3.SS2.p6.6.m6.2.2.cmml">
           t
          </mi>
          <mo id="S3.SS2.p6.6.m6.5.5.3.3.2.2" rspace="0.278em" stretchy="false" xref="S3.SS2.p6.6.m6.5.5.3.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S3.SS2.p6.6.m6.5.5.2" rspace="0.278em" xref="S3.SS2.p6.6.m6.5.5.2.cmml">
         :=
        </mo>
        <mrow id="S3.SS2.p6.6.m6.5.5.1" xref="S3.SS2.p6.6.m6.5.5.1.cmml">
         <mtext id="S3.SS2.p6.6.m6.5.5.1.3" xref="S3.SS2.p6.6.m6.5.5.1.3a.cmml">
          mean
         </mtext>
         <mo id="S3.SS2.p6.6.m6.5.5.1.2" lspace="0em" rspace="0em" xref="S3.SS2.p6.6.m6.5.5.1.2.cmml">
          ​
         </mo>
         <mrow id="S3.SS2.p6.6.m6.5.5.1.1.1" xref="S3.SS2.p6.6.m6.5.5.1.cmml">
          <mo id="S3.SS2.p6.6.m6.5.5.1.1.1.2" stretchy="false" xref="S3.SS2.p6.6.m6.5.5.1.cmml">
           (
          </mo>
          <mrow id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.2.cmml">
           <mo id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.2" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.2.1.cmml">
            {
           </mo>
           <mrow id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.cmml">
            <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.2" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.2a.cmml">
             MinFrac
            </mtext>
            <mo id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.1.cmml">
             ​
            </mo>
            <mrow id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.3.2" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.3.1.cmml">
             <mo id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.3.1.cmml">
              (
             </mo>
             <mi id="S3.SS2.p6.6.m6.3.3" xref="S3.SS2.p6.6.m6.3.3.cmml">
              t
             </mi>
             <mo id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.3.2.2" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.3.1.cmml">
              ,
             </mo>
             <mi id="S3.SS2.p6.6.m6.4.4" xref="S3.SS2.p6.6.m6.4.4.cmml">
              R
             </mi>
             <mo id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.3.2.3" rspace="0.278em" stretchy="false" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.3.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.3" rspace="0.448em" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.2.1.cmml">
            :
           </mo>
           <mrow id="S3.SS2.p6.6.m6.1.1.1" xref="S3.SS2.p6.6.m6.1.1.1b.cmml">
            <mtext id="S3.SS2.p6.6.m6.1.1.1a" xref="S3.SS2.p6.6.m6.1.1.1b.cmml">
             replicates
            </mtext>
            <mi id="S3.SS2.p6.6.m6.1.1.1.m1.1.1" xref="S3.SS2.p6.6.m6.1.1.1.m1.1.1.cmml">
             R
            </mi>
           </mrow>
           <mo id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.4" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.2.1.cmml">
            }
           </mo>
          </mrow>
          <mo id="S3.SS2.p6.6.m6.5.5.1.1.1.3" stretchy="false" xref="S3.SS2.p6.6.m6.5.5.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.6.m6.5b">
        <apply id="S3.SS2.p6.6.m6.5.5.cmml" xref="S3.SS2.p6.6.m6.5.5">
         <csymbol cd="latexml" id="S3.SS2.p6.6.m6.5.5.2.cmml" xref="S3.SS2.p6.6.m6.5.5.2">
          assign
         </csymbol>
         <apply id="S3.SS2.p6.6.m6.5.5.3.cmml" xref="S3.SS2.p6.6.m6.5.5.3">
          <times id="S3.SS2.p6.6.m6.5.5.3.1.cmml" xref="S3.SS2.p6.6.m6.5.5.3.1">
          </times>
          <ci id="S3.SS2.p6.6.m6.5.5.3.2a.cmml" xref="S3.SS2.p6.6.m6.5.5.3.2">
           <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.6.m6.5.5.3.2.cmml" xref="S3.SS2.p6.6.m6.5.5.3.2">
            MinFrac
           </mtext>
          </ci>
          <ci id="S3.SS2.p6.6.m6.2.2.cmml" xref="S3.SS2.p6.6.m6.2.2">
           𝑡
          </ci>
         </apply>
         <apply id="S3.SS2.p6.6.m6.5.5.1.cmml" xref="S3.SS2.p6.6.m6.5.5.1">
          <times id="S3.SS2.p6.6.m6.5.5.1.2.cmml" xref="S3.SS2.p6.6.m6.5.5.1.2">
          </times>
          <ci id="S3.SS2.p6.6.m6.5.5.1.3a.cmml" xref="S3.SS2.p6.6.m6.5.5.1.3">
           <mtext id="S3.SS2.p6.6.m6.5.5.1.3.cmml" xref="S3.SS2.p6.6.m6.5.5.1.3">
            mean
           </mtext>
          </ci>
          <apply id="S3.SS2.p6.6.m6.5.5.1.1.1.1.2.cmml" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1">
           <csymbol cd="latexml" id="S3.SS2.p6.6.m6.5.5.1.1.1.1.2.1.cmml" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.2">
            conditional-set
           </csymbol>
           <apply id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.cmml" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1">
            <times id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.1">
            </times>
            <ci id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.2a.cmml" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.2">
             <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.2">
              MinFrac
             </mtext>
            </ci>
            <interval closure="open" id="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p6.6.m6.5.5.1.1.1.1.1.1.3.2">
             <ci id="S3.SS2.p6.6.m6.3.3.cmml" xref="S3.SS2.p6.6.m6.3.3">
              𝑡
             </ci>
             <ci id="S3.SS2.p6.6.m6.4.4.cmml" xref="S3.SS2.p6.6.m6.4.4">
              𝑅
             </ci>
            </interval>
           </apply>
           <ci id="S3.SS2.p6.6.m6.1.1.1b.cmml" xref="S3.SS2.p6.6.m6.1.1.1">
            <mrow id="S3.SS2.p6.6.m6.1.1.1.cmml" xref="S3.SS2.p6.6.m6.1.1.1">
             <mtext id="S3.SS2.p6.6.m6.1.1.1a.cmml" xref="S3.SS2.p6.6.m6.1.1.1">
              replicates
             </mtext>
             <mi id="S3.SS2.p6.6.m6.1.1.1.m1.1.1.cmml" xref="S3.SS2.p6.6.m6.1.1.1.m1.1.1">
              R
             </mi>
            </mrow>
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.6.m6.5c">
        \texttt{MinFrac}(t):=\text{mean}(\left\{\texttt{MinFrac}(t,R):\,\text{replicates $R$}\right\})
       </annotation>
      </semantics>
     </math>
     .
Since
     <math alttext="\texttt{MinFrac}(t)\leq 1/K,\;\forall t\in[T]" class="ltx_Math" display="inline" id="S3.SS2.p6.7.m7.4">
      <semantics id="S3.SS2.p6.7.m7.4a">
       <mrow id="S3.SS2.p6.7.m7.4.4.2" xref="S3.SS2.p6.7.m7.4.4.3.cmml">
        <mrow id="S3.SS2.p6.7.m7.3.3.1.1" xref="S3.SS2.p6.7.m7.3.3.1.1.cmml">
         <mrow id="S3.SS2.p6.7.m7.3.3.1.1.2" xref="S3.SS2.p6.7.m7.3.3.1.1.2.cmml">
          <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.7.m7.3.3.1.1.2.2" xref="S3.SS2.p6.7.m7.3.3.1.1.2.2a.cmml">
           MinFrac
          </mtext>
          <mo id="S3.SS2.p6.7.m7.3.3.1.1.2.1" lspace="0em" rspace="0em" xref="S3.SS2.p6.7.m7.3.3.1.1.2.1.cmml">
           ​
          </mo>
          <mrow id="S3.SS2.p6.7.m7.3.3.1.1.2.3.2" xref="S3.SS2.p6.7.m7.3.3.1.1.2.cmml">
           <mo id="S3.SS2.p6.7.m7.3.3.1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p6.7.m7.3.3.1.1.2.cmml">
            (
           </mo>
           <mi id="S3.SS2.p6.7.m7.1.1" xref="S3.SS2.p6.7.m7.1.1.cmml">
            t
           </mi>
           <mo id="S3.SS2.p6.7.m7.3.3.1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p6.7.m7.3.3.1.1.2.cmml">
            )
           </mo>
          </mrow>
         </mrow>
         <mo id="S3.SS2.p6.7.m7.3.3.1.1.1" xref="S3.SS2.p6.7.m7.3.3.1.1.1.cmml">
          ≤
         </mo>
         <mrow id="S3.SS2.p6.7.m7.3.3.1.1.3" xref="S3.SS2.p6.7.m7.3.3.1.1.3.cmml">
          <mn id="S3.SS2.p6.7.m7.3.3.1.1.3.2" xref="S3.SS2.p6.7.m7.3.3.1.1.3.2.cmml">
           1
          </mn>
          <mo id="S3.SS2.p6.7.m7.3.3.1.1.3.1" xref="S3.SS2.p6.7.m7.3.3.1.1.3.1.cmml">
           /
          </mo>
          <mi id="S3.SS2.p6.7.m7.3.3.1.1.3.3" xref="S3.SS2.p6.7.m7.3.3.1.1.3.3.cmml">
           K
          </mi>
         </mrow>
        </mrow>
        <mo id="S3.SS2.p6.7.m7.4.4.2.3" rspace="0.447em" xref="S3.SS2.p6.7.m7.4.4.3a.cmml">
         ,
        </mo>
        <mrow id="S3.SS2.p6.7.m7.4.4.2.2" xref="S3.SS2.p6.7.m7.4.4.2.2.cmml">
         <mrow id="S3.SS2.p6.7.m7.4.4.2.2.2" xref="S3.SS2.p6.7.m7.4.4.2.2.2.cmml">
          <mo id="S3.SS2.p6.7.m7.4.4.2.2.2.1" rspace="0.167em" xref="S3.SS2.p6.7.m7.4.4.2.2.2.1.cmml">
           ∀
          </mo>
          <mi id="S3.SS2.p6.7.m7.4.4.2.2.2.2" xref="S3.SS2.p6.7.m7.4.4.2.2.2.2.cmml">
           t
          </mi>
         </mrow>
         <mo id="S3.SS2.p6.7.m7.4.4.2.2.1" xref="S3.SS2.p6.7.m7.4.4.2.2.1.cmml">
          ∈
         </mo>
         <mrow id="S3.SS2.p6.7.m7.4.4.2.2.3.2" xref="S3.SS2.p6.7.m7.4.4.2.2.3.1.cmml">
          <mo id="S3.SS2.p6.7.m7.4.4.2.2.3.2.1" stretchy="false" xref="S3.SS2.p6.7.m7.4.4.2.2.3.1.1.cmml">
           [
          </mo>
          <mi id="S3.SS2.p6.7.m7.2.2" xref="S3.SS2.p6.7.m7.2.2.cmml">
           T
          </mi>
          <mo id="S3.SS2.p6.7.m7.4.4.2.2.3.2.2" stretchy="false" xref="S3.SS2.p6.7.m7.4.4.2.2.3.1.1.cmml">
           ]
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.7.m7.4b">
        <apply id="S3.SS2.p6.7.m7.4.4.3.cmml" xref="S3.SS2.p6.7.m7.4.4.2">
         <csymbol cd="ambiguous" id="S3.SS2.p6.7.m7.4.4.3a.cmml" xref="S3.SS2.p6.7.m7.4.4.2.3">
          formulae-sequence
         </csymbol>
         <apply id="S3.SS2.p6.7.m7.3.3.1.1.cmml" xref="S3.SS2.p6.7.m7.3.3.1.1">
          <leq id="S3.SS2.p6.7.m7.3.3.1.1.1.cmml" xref="S3.SS2.p6.7.m7.3.3.1.1.1">
          </leq>
          <apply id="S3.SS2.p6.7.m7.3.3.1.1.2.cmml" xref="S3.SS2.p6.7.m7.3.3.1.1.2">
           <times id="S3.SS2.p6.7.m7.3.3.1.1.2.1.cmml" xref="S3.SS2.p6.7.m7.3.3.1.1.2.1">
           </times>
           <ci id="S3.SS2.p6.7.m7.3.3.1.1.2.2a.cmml" xref="S3.SS2.p6.7.m7.3.3.1.1.2.2">
            <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.7.m7.3.3.1.1.2.2.cmml" xref="S3.SS2.p6.7.m7.3.3.1.1.2.2">
             MinFrac
            </mtext>
           </ci>
           <ci id="S3.SS2.p6.7.m7.1.1.cmml" xref="S3.SS2.p6.7.m7.1.1">
            𝑡
           </ci>
          </apply>
          <apply id="S3.SS2.p6.7.m7.3.3.1.1.3.cmml" xref="S3.SS2.p6.7.m7.3.3.1.1.3">
           <divide id="S3.SS2.p6.7.m7.3.3.1.1.3.1.cmml" xref="S3.SS2.p6.7.m7.3.3.1.1.3.1">
           </divide>
           <cn id="S3.SS2.p6.7.m7.3.3.1.1.3.2.cmml" type="integer" xref="S3.SS2.p6.7.m7.3.3.1.1.3.2">
            1
           </cn>
           <ci id="S3.SS2.p6.7.m7.3.3.1.1.3.3.cmml" xref="S3.SS2.p6.7.m7.3.3.1.1.3.3">
            𝐾
           </ci>
          </apply>
         </apply>
         <apply id="S3.SS2.p6.7.m7.4.4.2.2.cmml" xref="S3.SS2.p6.7.m7.4.4.2.2">
          <in id="S3.SS2.p6.7.m7.4.4.2.2.1.cmml" xref="S3.SS2.p6.7.m7.4.4.2.2.1">
          </in>
          <apply id="S3.SS2.p6.7.m7.4.4.2.2.2.cmml" xref="S3.SS2.p6.7.m7.4.4.2.2.2">
           <csymbol cd="latexml" id="S3.SS2.p6.7.m7.4.4.2.2.2.1.cmml" xref="S3.SS2.p6.7.m7.4.4.2.2.2.1">
            for-all
           </csymbol>
           <ci id="S3.SS2.p6.7.m7.4.4.2.2.2.2.cmml" xref="S3.SS2.p6.7.m7.4.4.2.2.2.2">
            𝑡
           </ci>
          </apply>
          <apply id="S3.SS2.p6.7.m7.4.4.2.2.3.1.cmml" xref="S3.SS2.p6.7.m7.4.4.2.2.3.2">
           <csymbol cd="latexml" id="S3.SS2.p6.7.m7.4.4.2.2.3.1.1.cmml" xref="S3.SS2.p6.7.m7.4.4.2.2.3.2.1">
            delimited-[]
           </csymbol>
           <ci id="S3.SS2.p6.7.m7.2.2.cmml" xref="S3.SS2.p6.7.m7.2.2">
            𝑇
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.7.m7.4c">
        \texttt{MinFrac}(t)\leq 1/K,\;\forall t\in[T]
       </annotation>
      </semantics>
     </math>
     , we always plot
     <math alttext="K\cdot\texttt{MinFrac}(t)" class="ltx_Math" display="inline" id="S3.SS2.p6.8.m8.1">
      <semantics id="S3.SS2.p6.8.m8.1a">
       <mrow id="S3.SS2.p6.8.m8.1.2" xref="S3.SS2.p6.8.m8.1.2.cmml">
        <mrow id="S3.SS2.p6.8.m8.1.2.2" xref="S3.SS2.p6.8.m8.1.2.2.cmml">
         <mi id="S3.SS2.p6.8.m8.1.2.2.2" xref="S3.SS2.p6.8.m8.1.2.2.2.cmml">
          K
         </mi>
         <mo id="S3.SS2.p6.8.m8.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p6.8.m8.1.2.2.1.cmml">
          ⋅
         </mo>
         <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.8.m8.1.2.2.3" xref="S3.SS2.p6.8.m8.1.2.2.3a.cmml">
          MinFrac
         </mtext>
        </mrow>
        <mo id="S3.SS2.p6.8.m8.1.2.1" lspace="0em" rspace="0em" xref="S3.SS2.p6.8.m8.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p6.8.m8.1.2.3.2" xref="S3.SS2.p6.8.m8.1.2.cmml">
         <mo id="S3.SS2.p6.8.m8.1.2.3.2.1" stretchy="false" xref="S3.SS2.p6.8.m8.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p6.8.m8.1.1" xref="S3.SS2.p6.8.m8.1.1.cmml">
          t
         </mi>
         <mo id="S3.SS2.p6.8.m8.1.2.3.2.2" stretchy="false" xref="S3.SS2.p6.8.m8.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.8.m8.1b">
        <apply id="S3.SS2.p6.8.m8.1.2.cmml" xref="S3.SS2.p6.8.m8.1.2">
         <times id="S3.SS2.p6.8.m8.1.2.1.cmml" xref="S3.SS2.p6.8.m8.1.2.1">
         </times>
         <apply id="S3.SS2.p6.8.m8.1.2.2.cmml" xref="S3.SS2.p6.8.m8.1.2.2">
          <ci id="S3.SS2.p6.8.m8.1.2.2.1.cmml" xref="S3.SS2.p6.8.m8.1.2.2.1">
           ⋅
          </ci>
          <ci id="S3.SS2.p6.8.m8.1.2.2.2.cmml" xref="S3.SS2.p6.8.m8.1.2.2.2">
           𝐾
          </ci>
          <ci id="S3.SS2.p6.8.m8.1.2.2.3a.cmml" xref="S3.SS2.p6.8.m8.1.2.2.3">
           <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.8.m8.1.2.2.3.cmml" xref="S3.SS2.p6.8.m8.1.2.2.3">
            MinFrac
           </mtext>
          </ci>
         </apply>
         <ci id="S3.SS2.p6.8.m8.1.1.cmml" xref="S3.SS2.p6.8.m8.1.1">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.8.m8.1c">
        K\cdot\texttt{MinFrac}(t)
       </annotation>
      </semantics>
     </math>
     ,
so as to rescale the range to
     <math alttext="[0,1]" class="ltx_Math" display="inline" id="S3.SS2.p6.9.m9.2">
      <semantics id="S3.SS2.p6.9.m9.2a">
       <mrow id="S3.SS2.p6.9.m9.2.3.2" xref="S3.SS2.p6.9.m9.2.3.1.cmml">
        <mo id="S3.SS2.p6.9.m9.2.3.2.1" stretchy="false" xref="S3.SS2.p6.9.m9.2.3.1.cmml">
         [
        </mo>
        <mn id="S3.SS2.p6.9.m9.1.1" xref="S3.SS2.p6.9.m9.1.1.cmml">
         0
        </mn>
        <mo id="S3.SS2.p6.9.m9.2.3.2.2" xref="S3.SS2.p6.9.m9.2.3.1.cmml">
         ,
        </mo>
        <mn id="S3.SS2.p6.9.m9.2.2" xref="S3.SS2.p6.9.m9.2.2.cmml">
         1
        </mn>
        <mo id="S3.SS2.p6.9.m9.2.3.2.3" stretchy="false" xref="S3.SS2.p6.9.m9.2.3.1.cmml">
         ]
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.9.m9.2b">
        <interval closure="closed" id="S3.SS2.p6.9.m9.2.3.1.cmml" xref="S3.SS2.p6.9.m9.2.3.2">
         <cn id="S3.SS2.p6.9.m9.1.1.cmml" type="integer" xref="S3.SS2.p6.9.m9.1.1">
          0
         </cn>
         <cn id="S3.SS2.p6.9.m9.2.2.cmml" type="integer" xref="S3.SS2.p6.9.m9.2.2">
          1
         </cn>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.9.m9.2c">
        [0,1]
       </annotation>
      </semantics>
     </math>
     .
Larger
     <math alttext="\texttt{MinFrac}(t)" class="ltx_Math" display="inline" id="S3.SS2.p6.10.m10.1">
      <semantics id="S3.SS2.p6.10.m10.1a">
       <mrow id="S3.SS2.p6.10.m10.1.2" xref="S3.SS2.p6.10.m10.1.2.cmml">
        <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.10.m10.1.2.2" xref="S3.SS2.p6.10.m10.1.2.2a.cmml">
         MinFrac
        </mtext>
        <mo id="S3.SS2.p6.10.m10.1.2.1" lspace="0em" rspace="0em" xref="S3.SS2.p6.10.m10.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p6.10.m10.1.2.3.2" xref="S3.SS2.p6.10.m10.1.2.cmml">
         <mo id="S3.SS2.p6.10.m10.1.2.3.2.1" stretchy="false" xref="S3.SS2.p6.10.m10.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p6.10.m10.1.1" xref="S3.SS2.p6.10.m10.1.1.cmml">
          t
         </mi>
         <mo id="S3.SS2.p6.10.m10.1.2.3.2.2" stretchy="false" xref="S3.SS2.p6.10.m10.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.10.m10.1b">
        <apply id="S3.SS2.p6.10.m10.1.2.cmml" xref="S3.SS2.p6.10.m10.1.2">
         <times id="S3.SS2.p6.10.m10.1.2.1.cmml" xref="S3.SS2.p6.10.m10.1.2.1">
         </times>
         <ci id="S3.SS2.p6.10.m10.1.2.2a.cmml" xref="S3.SS2.p6.10.m10.1.2.2">
          <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.10.m10.1.2.2.cmml" xref="S3.SS2.p6.10.m10.1.2.2">
           MinFrac
          </mtext>
         </ci>
         <ci id="S3.SS2.p6.10.m10.1.1.cmml" xref="S3.SS2.p6.10.m10.1.1">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.10.m10.1c">
        \texttt{MinFrac}(t)
       </annotation>
      </semantics>
     </math>
     corresponds to a more uniform selection of arms
at time
     <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p6.11.m11.1">
      <semantics id="S3.SS2.p6.11.m11.1a">
       <mi id="S3.SS2.p6.11.m11.1.1" xref="S3.SS2.p6.11.m11.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.11.m11.1b">
        <ci id="S3.SS2.p6.11.m11.1.1.cmml" xref="S3.SS2.p6.11.m11.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.11.m11.1c">
        t
       </annotation>
      </semantics>
     </math>
     . When an LLM’s
     <math alttext="\texttt{MinFrac}(t)" class="ltx_Math" display="inline" id="S3.SS2.p6.12.m12.1">
      <semantics id="S3.SS2.p6.12.m12.1a">
       <mrow id="S3.SS2.p6.12.m12.1.2" xref="S3.SS2.p6.12.m12.1.2.cmml">
        <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.12.m12.1.2.2" xref="S3.SS2.p6.12.m12.1.2.2a.cmml">
         MinFrac
        </mtext>
        <mo id="S3.SS2.p6.12.m12.1.2.1" lspace="0em" rspace="0em" xref="S3.SS2.p6.12.m12.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p6.12.m12.1.2.3.2" xref="S3.SS2.p6.12.m12.1.2.cmml">
         <mo id="S3.SS2.p6.12.m12.1.2.3.2.1" stretchy="false" xref="S3.SS2.p6.12.m12.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p6.12.m12.1.1" xref="S3.SS2.p6.12.m12.1.1.cmml">
          t
         </mi>
         <mo id="S3.SS2.p6.12.m12.1.2.3.2.2" stretchy="false" xref="S3.SS2.p6.12.m12.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.12.m12.1b">
        <apply id="S3.SS2.p6.12.m12.1.2.cmml" xref="S3.SS2.p6.12.m12.1.2">
         <times id="S3.SS2.p6.12.m12.1.2.1.cmml" xref="S3.SS2.p6.12.m12.1.2.1">
         </times>
         <ci id="S3.SS2.p6.12.m12.1.2.2a.cmml" xref="S3.SS2.p6.12.m12.1.2.2">
          <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p6.12.m12.1.2.2.cmml" xref="S3.SS2.p6.12.m12.1.2.2">
           MinFrac
          </mtext>
         </ci>
         <ci id="S3.SS2.p6.12.m12.1.1.cmml" xref="S3.SS2.p6.12.m12.1.1">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.12.m12.1c">
        \texttt{MinFrac}(t)
       </annotation>
      </semantics>
     </math>
     does not decrease over time
and stays substantively larger than that of the baselines (especially
as
     <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p6.13.m13.1">
      <semantics id="S3.SS2.p6.13.m13.1a">
       <mi id="S3.SS2.p6.13.m13.1.1" xref="S3.SS2.p6.13.m13.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.13.m13.1b">
        <ci id="S3.SS2.p6.13.m13.1.1.cmml" xref="S3.SS2.p6.13.m13.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.13.m13.1c">
        t
       </annotation>
      </semantics>
     </math>
     approaches the time horizon
     <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.p6.14.m14.1">
      <semantics id="S3.SS2.p6.14.m14.1a">
       <mi id="S3.SS2.p6.14.m14.1.1" xref="S3.SS2.p6.14.m14.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p6.14.m14.1b">
        <ci id="S3.SS2.p6.14.m14.1.1.cmml" xref="S3.SS2.p6.14.m14.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p6.14.m14.1c">
        T
       </annotation>
      </semantics>
     </math>
     ), we take it as an indication of a uniform-like failure.
    </p>
   </div>
   <figure class="ltx_figure" id="S3.F6">
    <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="116" id="S3.F6.g1" src="/html/2403.15371/assets/x5.png" width="461"/>
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_figure">
      Figure 6:
     </span>
     Detailed view of uniform-like failures for
     <span class="ltx_text ltx_font_smallcaps" id="S3.F6.8.1">
      Gpt-4
     </span>
     (the BNRND and BNSND configurations) with
     <math alttext="T=200" class="ltx_Math" display="inline" id="S3.F6.4.m1.1">
      <semantics id="S3.F6.4.m1.1b">
       <mrow id="S3.F6.4.m1.1.1" xref="S3.F6.4.m1.1.1.cmml">
        <mi id="S3.F6.4.m1.1.1.2" xref="S3.F6.4.m1.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.F6.4.m1.1.1.1" xref="S3.F6.4.m1.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.F6.4.m1.1.1.3" xref="S3.F6.4.m1.1.1.3.cmml">
         200
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.F6.4.m1.1c">
        <apply id="S3.F6.4.m1.1.1.cmml" xref="S3.F6.4.m1.1.1">
         <eq id="S3.F6.4.m1.1.1.1.cmml" xref="S3.F6.4.m1.1.1.1">
         </eq>
         <ci id="S3.F6.4.m1.1.1.2.cmml" xref="S3.F6.4.m1.1.1.2">
          𝑇
         </ci>
         <cn id="S3.F6.4.m1.1.1.3.cmml" type="integer" xref="S3.F6.4.m1.1.1.3">
          200
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F6.4.m1.1d">
        T=200
       </annotation>
      </semantics>
     </math>
     . Visualizations are: (Left) suffix failure frequency, (Center)
     <math alttext="K\cdot\texttt{MinFrac}(t)" class="ltx_Math" display="inline" id="S3.F6.5.m2.1">
      <semantics id="S3.F6.5.m2.1b">
       <mrow id="S3.F6.5.m2.1.2" xref="S3.F6.5.m2.1.2.cmml">
        <mrow id="S3.F6.5.m2.1.2.2" xref="S3.F6.5.m2.1.2.2.cmml">
         <mi id="S3.F6.5.m2.1.2.2.2" xref="S3.F6.5.m2.1.2.2.2.cmml">
          K
         </mi>
         <mo id="S3.F6.5.m2.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.F6.5.m2.1.2.2.1.cmml">
          ⋅
         </mo>
         <mtext class="ltx_mathvariant_monospace" id="S3.F6.5.m2.1.2.2.3" xref="S3.F6.5.m2.1.2.2.3a.cmml">
          MinFrac
         </mtext>
        </mrow>
        <mo id="S3.F6.5.m2.1.2.1" lspace="0em" rspace="0em" xref="S3.F6.5.m2.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.F6.5.m2.1.2.3.2" xref="S3.F6.5.m2.1.2.cmml">
         <mo id="S3.F6.5.m2.1.2.3.2.1" stretchy="false" xref="S3.F6.5.m2.1.2.cmml">
          (
         </mo>
         <mi id="S3.F6.5.m2.1.1" xref="S3.F6.5.m2.1.1.cmml">
          t
         </mi>
         <mo id="S3.F6.5.m2.1.2.3.2.2" stretchy="false" xref="S3.F6.5.m2.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.F6.5.m2.1c">
        <apply id="S3.F6.5.m2.1.2.cmml" xref="S3.F6.5.m2.1.2">
         <times id="S3.F6.5.m2.1.2.1.cmml" xref="S3.F6.5.m2.1.2.1">
         </times>
         <apply id="S3.F6.5.m2.1.2.2.cmml" xref="S3.F6.5.m2.1.2.2">
          <ci id="S3.F6.5.m2.1.2.2.1.cmml" xref="S3.F6.5.m2.1.2.2.1">
           ⋅
          </ci>
          <ci id="S3.F6.5.m2.1.2.2.2.cmml" xref="S3.F6.5.m2.1.2.2.2">
           𝐾
          </ci>
          <ci id="S3.F6.5.m2.1.2.2.3a.cmml" xref="S3.F6.5.m2.1.2.2.3">
           <mtext class="ltx_mathvariant_monospace" id="S3.F6.5.m2.1.2.2.3.cmml" xref="S3.F6.5.m2.1.2.2.3">
            MinFrac
           </mtext>
          </ci>
         </apply>
         <ci id="S3.F6.5.m2.1.1.cmml" xref="S3.F6.5.m2.1.1">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F6.5.m2.1d">
        K\cdot\texttt{MinFrac}(t)
       </annotation>
      </semantics>
     </math>
     as a function of
     <math alttext="t" class="ltx_Math" display="inline" id="S3.F6.6.m3.1">
      <semantics id="S3.F6.6.m3.1b">
       <mi id="S3.F6.6.m3.1.1" xref="S3.F6.6.m3.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.F6.6.m3.1c">
        <ci id="S3.F6.6.m3.1.1.cmml" xref="S3.F6.6.m3.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F6.6.m3.1d">
        t
       </annotation>
      </semantics>
     </math>
     and (Right) cumulative time-averaged rewards.
These configurations exhibit uniform-like failures but not suffix failures, and uniform-like failures are detrimental to long-term rewards.
    </figcaption>
   </figure>
   <div class="ltx_para" id="S3.SS2.p7">
    <p class="ltx_p" id="S3.SS2.p7.6">
     The Y-axis of
     <a class="ltx_ref" href="#S3.F3" title="Figure 3 ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        3
       </span>
      </span>
     </a>
     records
     <math alttext="K\cdot\texttt{MinFrac}(T)" class="ltx_Math" display="inline" id="S3.SS2.p7.1.m1.1">
      <semantics id="S3.SS2.p7.1.m1.1a">
       <mrow id="S3.SS2.p7.1.m1.1.2" xref="S3.SS2.p7.1.m1.1.2.cmml">
        <mrow id="S3.SS2.p7.1.m1.1.2.2" xref="S3.SS2.p7.1.m1.1.2.2.cmml">
         <mi id="S3.SS2.p7.1.m1.1.2.2.2" xref="S3.SS2.p7.1.m1.1.2.2.2.cmml">
          K
         </mi>
         <mo id="S3.SS2.p7.1.m1.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p7.1.m1.1.2.2.1.cmml">
          ⋅
         </mo>
         <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p7.1.m1.1.2.2.3" xref="S3.SS2.p7.1.m1.1.2.2.3a.cmml">
          MinFrac
         </mtext>
        </mrow>
        <mo id="S3.SS2.p7.1.m1.1.2.1" lspace="0em" rspace="0em" xref="S3.SS2.p7.1.m1.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p7.1.m1.1.2.3.2" xref="S3.SS2.p7.1.m1.1.2.cmml">
         <mo id="S3.SS2.p7.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p7.1.m1.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml">
          T
         </mi>
         <mo id="S3.SS2.p7.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p7.1.m1.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b">
        <apply id="S3.SS2.p7.1.m1.1.2.cmml" xref="S3.SS2.p7.1.m1.1.2">
         <times id="S3.SS2.p7.1.m1.1.2.1.cmml" xref="S3.SS2.p7.1.m1.1.2.1">
         </times>
         <apply id="S3.SS2.p7.1.m1.1.2.2.cmml" xref="S3.SS2.p7.1.m1.1.2.2">
          <ci id="S3.SS2.p7.1.m1.1.2.2.1.cmml" xref="S3.SS2.p7.1.m1.1.2.2.1">
           ⋅
          </ci>
          <ci id="S3.SS2.p7.1.m1.1.2.2.2.cmml" xref="S3.SS2.p7.1.m1.1.2.2.2">
           𝐾
          </ci>
          <ci id="S3.SS2.p7.1.m1.1.2.2.3a.cmml" xref="S3.SS2.p7.1.m1.1.2.2.3">
           <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p7.1.m1.1.2.2.3.cmml" xref="S3.SS2.p7.1.m1.1.2.2.3">
            MinFrac
           </mtext>
          </ci>
         </apply>
         <ci id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">
          𝑇
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">
        K\cdot\texttt{MinFrac}(T)
       </annotation>
      </semantics>
     </math>
     for each
configuration, where we see that of the three
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p7.6.1">
      Gpt-4
     </span>
     configurations
that avoid suffix failures, two configurations have very high
     <math alttext="\texttt{MinFrac}(T)" class="ltx_Math" display="inline" id="S3.SS2.p7.2.m2.1">
      <semantics id="S3.SS2.p7.2.m2.1a">
       <mrow id="S3.SS2.p7.2.m2.1.2" xref="S3.SS2.p7.2.m2.1.2.cmml">
        <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p7.2.m2.1.2.2" xref="S3.SS2.p7.2.m2.1.2.2a.cmml">
         MinFrac
        </mtext>
        <mo id="S3.SS2.p7.2.m2.1.2.1" lspace="0em" rspace="0em" xref="S3.SS2.p7.2.m2.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p7.2.m2.1.2.3.2" xref="S3.SS2.p7.2.m2.1.2.cmml">
         <mo id="S3.SS2.p7.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.p7.2.m2.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p7.2.m2.1.1" xref="S3.SS2.p7.2.m2.1.1.cmml">
          T
         </mi>
         <mo id="S3.SS2.p7.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.p7.2.m2.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m2.1b">
        <apply id="S3.SS2.p7.2.m2.1.2.cmml" xref="S3.SS2.p7.2.m2.1.2">
         <times id="S3.SS2.p7.2.m2.1.2.1.cmml" xref="S3.SS2.p7.2.m2.1.2.1">
         </times>
         <ci id="S3.SS2.p7.2.m2.1.2.2a.cmml" xref="S3.SS2.p7.2.m2.1.2.2">
          <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p7.2.m2.1.2.2.cmml" xref="S3.SS2.p7.2.m2.1.2.2">
           MinFrac
          </mtext>
         </ci>
         <ci id="S3.SS2.p7.2.m2.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1">
          𝑇
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.2.m2.1c">
        \texttt{MinFrac}(T)
       </annotation>
      </semantics>
     </math>
     relative to
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p7.6.2">
      UCB
     </span>
     and
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p7.6.3">
      TS
     </span>
     (the third configuration is
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p7.6.4">
      Gpt-4
     </span>
     -BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS2.p7.3.m3.1">
      <semantics id="S3.SS2.p7.3.m3.1a">
       <mover accent="true" id="S3.SS2.p7.3.m3.1.1" xref="S3.SS2.p7.3.m3.1.1.cmml">
        <mtext id="S3.SS2.p7.3.m3.1.1.2" xref="S3.SS2.p7.3.m3.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS2.p7.3.m3.1.1.1" xref="S3.SS2.p7.3.m3.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.3.m3.1b">
        <apply id="S3.SS2.p7.3.m3.1.1.cmml" xref="S3.SS2.p7.3.m3.1.1">
         <ci id="S3.SS2.p7.3.m3.1.1.1.cmml" xref="S3.SS2.p7.3.m3.1.1.1">
          ~
         </ci>
         <ci id="S3.SS2.p7.3.m3.1.1.2a.cmml" xref="S3.SS2.p7.3.m3.1.1.2">
          <mtext id="S3.SS2.p7.3.m3.1.1.2.cmml" xref="S3.SS2.p7.3.m3.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.3.m3.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0, which is successful). These two configurations are
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p7.6.5">
      Gpt-4
     </span>
     -BNRND and
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p7.6.6">
      Gpt-4
     </span>
     -BSSCD, both of which use the
     <em class="ltx_emph ltx_font_italic" id="S3.SS2.p7.6.7">
      distributional
     </em>
     output format.
We provide a more detailed view of
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p7.6.8">
      Gpt-4
     </span>
     -BNRND (as well as
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p7.6.9">
      Gpt-4
     </span>
     -BNSND, which also exhibits uniform-like failures, but only differs from
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p7.6.10">
      Gpt-4
     </span>
     -BNRND in the use of summarized history)
in
     <a class="ltx_ref" href="#S3.F6" title="Figure 6 ‣ 3.2 Identifying failures ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        6
       </span>
      </span>
     </a>
     , which considers a longer horizon and more
replicates (
     <math alttext="T=200" class="ltx_Math" display="inline" id="S3.SS2.p7.4.m4.1">
      <semantics id="S3.SS2.p7.4.m4.1a">
       <mrow id="S3.SS2.p7.4.m4.1.1" xref="S3.SS2.p7.4.m4.1.1.cmml">
        <mi id="S3.SS2.p7.4.m4.1.1.2" xref="S3.SS2.p7.4.m4.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.SS2.p7.4.m4.1.1.1" xref="S3.SS2.p7.4.m4.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS2.p7.4.m4.1.1.3" xref="S3.SS2.p7.4.m4.1.1.3.cmml">
         200
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.4.m4.1b">
        <apply id="S3.SS2.p7.4.m4.1.1.cmml" xref="S3.SS2.p7.4.m4.1.1">
         <eq id="S3.SS2.p7.4.m4.1.1.1.cmml" xref="S3.SS2.p7.4.m4.1.1.1">
         </eq>
         <ci id="S3.SS2.p7.4.m4.1.1.2.cmml" xref="S3.SS2.p7.4.m4.1.1.2">
          𝑇
         </ci>
         <cn id="S3.SS2.p7.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p7.4.m4.1.1.3">
          200
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.4.m4.1c">
        T=200
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="N=20" class="ltx_Math" display="inline" id="S3.SS2.p7.5.m5.1">
      <semantics id="S3.SS2.p7.5.m5.1a">
       <mrow id="S3.SS2.p7.5.m5.1.1" xref="S3.SS2.p7.5.m5.1.1.cmml">
        <mi id="S3.SS2.p7.5.m5.1.1.2" xref="S3.SS2.p7.5.m5.1.1.2.cmml">
         N
        </mi>
        <mo id="S3.SS2.p7.5.m5.1.1.1" xref="S3.SS2.p7.5.m5.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS2.p7.5.m5.1.1.3" xref="S3.SS2.p7.5.m5.1.1.3.cmml">
         20
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.5.m5.1b">
        <apply id="S3.SS2.p7.5.m5.1.1.cmml" xref="S3.SS2.p7.5.m5.1.1">
         <eq id="S3.SS2.p7.5.m5.1.1.1.cmml" xref="S3.SS2.p7.5.m5.1.1.1">
         </eq>
         <ci id="S3.SS2.p7.5.m5.1.1.2.cmml" xref="S3.SS2.p7.5.m5.1.1.2">
          𝑁
         </ci>
         <cn id="S3.SS2.p7.5.m5.1.1.3.cmml" type="integer" xref="S3.SS2.p7.5.m5.1.1.3">
          20
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.5.m5.1c">
        N=20
       </annotation>
      </semantics>
     </math>
     ). The middle panel reveals that
     <math alttext="K\cdot\texttt{MinFrac}(t)" class="ltx_Math" display="inline" id="S3.SS2.p7.6.m6.1">
      <semantics id="S3.SS2.p7.6.m6.1a">
       <mrow id="S3.SS2.p7.6.m6.1.2" xref="S3.SS2.p7.6.m6.1.2.cmml">
        <mrow id="S3.SS2.p7.6.m6.1.2.2" xref="S3.SS2.p7.6.m6.1.2.2.cmml">
         <mi id="S3.SS2.p7.6.m6.1.2.2.2" xref="S3.SS2.p7.6.m6.1.2.2.2.cmml">
          K
         </mi>
         <mo id="S3.SS2.p7.6.m6.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p7.6.m6.1.2.2.1.cmml">
          ⋅
         </mo>
         <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p7.6.m6.1.2.2.3" xref="S3.SS2.p7.6.m6.1.2.2.3a.cmml">
          MinFrac
         </mtext>
        </mrow>
        <mo id="S3.SS2.p7.6.m6.1.2.1" lspace="0em" rspace="0em" xref="S3.SS2.p7.6.m6.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p7.6.m6.1.2.3.2" xref="S3.SS2.p7.6.m6.1.2.cmml">
         <mo id="S3.SS2.p7.6.m6.1.2.3.2.1" stretchy="false" xref="S3.SS2.p7.6.m6.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p7.6.m6.1.1" xref="S3.SS2.p7.6.m6.1.1.cmml">
          t
         </mi>
         <mo id="S3.SS2.p7.6.m6.1.2.3.2.2" stretchy="false" xref="S3.SS2.p7.6.m6.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p7.6.m6.1b">
        <apply id="S3.SS2.p7.6.m6.1.2.cmml" xref="S3.SS2.p7.6.m6.1.2">
         <times id="S3.SS2.p7.6.m6.1.2.1.cmml" xref="S3.SS2.p7.6.m6.1.2.1">
         </times>
         <apply id="S3.SS2.p7.6.m6.1.2.2.cmml" xref="S3.SS2.p7.6.m6.1.2.2">
          <ci id="S3.SS2.p7.6.m6.1.2.2.1.cmml" xref="S3.SS2.p7.6.m6.1.2.2.1">
           ⋅
          </ci>
          <ci id="S3.SS2.p7.6.m6.1.2.2.2.cmml" xref="S3.SS2.p7.6.m6.1.2.2.2">
           𝐾
          </ci>
          <ci id="S3.SS2.p7.6.m6.1.2.2.3a.cmml" xref="S3.SS2.p7.6.m6.1.2.2.3">
           <mtext class="ltx_mathvariant_monospace" id="S3.SS2.p7.6.m6.1.2.2.3.cmml" xref="S3.SS2.p7.6.m6.1.2.2.3">
            MinFrac
           </mtext>
          </ci>
         </apply>
         <ci id="S3.SS2.p7.6.m6.1.1.cmml" xref="S3.SS2.p7.6.m6.1.1">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p7.6.m6.1c">
        K\cdot\texttt{MinFrac}(t)
       </annotation>
      </semantics>
     </math>
     does not decrease over time for these LLM configurations, while it
does for the baselines. This behavior results in no suffix failures,
but leads to much lower reward than the baselines. In particular, we obtain a clear separation in
total reward, showing that uniform-like failures indeed result in poor
long-term performance.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p8">
    <p class="ltx_p" id="S3.SS2.p8.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p8.1.1">
      Generality of the failures.
     </span>
     To summarize,
     <a class="ltx_ref" href="#S3.F3" title="Figure 3 ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        3
       </span>
      </span>
     </a>
     shows that all LLM configurations except
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p8.1.2">
      Gpt-4
     </span>
     -BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS2.p8.1.m1.1">
      <semantics id="S3.SS2.p8.1.m1.1a">
       <mover accent="true" id="S3.SS2.p8.1.m1.1.1" xref="S3.SS2.p8.1.m1.1.1.cmml">
        <mtext id="S3.SS2.p8.1.m1.1.1.2" xref="S3.SS2.p8.1.m1.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS2.p8.1.m1.1.1.1" xref="S3.SS2.p8.1.m1.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p8.1.m1.1b">
        <apply id="S3.SS2.p8.1.m1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1">
         <ci id="S3.SS2.p8.1.m1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1.1">
          ~
         </ci>
         <ci id="S3.SS2.p8.1.m1.1.1.2a.cmml" xref="S3.SS2.p8.1.m1.1.1.2">
          <mtext id="S3.SS2.p8.1.m1.1.1.2.cmml" xref="S3.SS2.p8.1.m1.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p8.1.m1.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 exhibit either a suffix failure or a uniform failure for the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p8.1.3">
      hard
     </span>
     MAB instance and the buttons scenario.
Scatter plots for the other three experiments (i.e., the advertisements scenario and/or the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p8.1.4">
      easy
     </span>
     MAB instance) are qualitatively similar and are deferred to
     <a class="ltx_ref" href="#A2" title="Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      Appendix
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        B
       </span>
      </span>
     </a>
     .
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p9">
    <p class="ltx_p" id="S3.SS2.p9.1">
     The same data, but with attributions to specific LLM configurations,
are presented for
     <em class="ltx_emph ltx_font_italic" id="S3.SS2.p9.1.1">
      all
     </em>
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p9.1.2">
      Gpt-4
     </span>
     configurations in
     <a class="ltx_ref" href="#S3.F4" title="Figure 4 ‣ 3.1 Overview ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        4
       </span>
      </span>
     </a>
     ; analogous
tables for other LLMs and experimental settings are given in
     <a class="ltx_ref" href="#A2" title="Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      Appendix
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        B
       </span>
      </span>
     </a>
     . As it is not instructive to present detailed plots such as
     <a class="ltx_ref" href="#S3.F5" title="Figure 5 ‣ 3.1 Overview ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        5
       </span>
      </span>
     </a>
     for every LLM configuration,
     <a class="ltx_ref" href="#S3.F4" title="In 3.1 Overview ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       Figure
      </span>
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     summarizes the performance of each configuration with just a few statistics. We include:
    </p>
    <ul class="ltx_itemize" id="S3.I1">
     <li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="S3.I1.i1.p1">
       <p class="ltx_p" id="S3.I1.i1.p1.2">
        <math alttext="\texttt{SuffFailFreq}(T/2)" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.1">
         <semantics id="S3.I1.i1.p1.1.m1.1a">
          <mrow id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">
           <mtext class="ltx_mathvariant_monospace" id="S3.I1.i1.p1.1.m1.1.1.3" xref="S3.I1.i1.p1.1.m1.1.1.3a.cmml">
            SuffFailFreq
           </mtext>
           <mo id="S3.I1.i1.p1.1.m1.1.1.2" lspace="0em" rspace="0em" xref="S3.I1.i1.p1.1.m1.1.1.2.cmml">
            ​
           </mo>
           <mrow id="S3.I1.i1.p1.1.m1.1.1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.cmml">
            <mo id="S3.I1.i1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.cmml">
             (
            </mo>
            <mrow id="S3.I1.i1.p1.1.m1.1.1.1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.cmml">
             <mi id="S3.I1.i1.p1.1.m1.1.1.1.1.1.2" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml">
              T
             </mi>
             <mo id="S3.I1.i1.p1.1.m1.1.1.1.1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml">
              /
             </mo>
             <mn id="S3.I1.i1.p1.1.m1.1.1.1.1.1.3" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml">
              2
             </mn>
            </mrow>
            <mo id="S3.I1.i1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b">
           <apply id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">
            <times id="S3.I1.i1.p1.1.m1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.2">
            </times>
            <ci id="S3.I1.i1.p1.1.m1.1.1.3a.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3">
             <mtext class="ltx_mathvariant_monospace" id="S3.I1.i1.p1.1.m1.1.1.3.cmml" xref="S3.I1.i1.p1.1.m1.1.1.3">
              SuffFailFreq
             </mtext>
            </ci>
            <apply id="S3.I1.i1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1">
             <divide id="S3.I1.i1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.1">
             </divide>
             <ci id="S3.I1.i1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.2">
              𝑇
             </ci>
             <cn id="S3.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.I1.i1.p1.1.m1.1.1.1.1.1.3">
              2
             </cn>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">
           \texttt{SuffFailFreq}(T/2)
          </annotation>
         </semantics>
        </math>
        and
        <math alttext="\texttt{MinFrac}(T)" class="ltx_Math" display="inline" id="S3.I1.i1.p1.2.m2.1">
         <semantics id="S3.I1.i1.p1.2.m2.1a">
          <mrow id="S3.I1.i1.p1.2.m2.1.2" xref="S3.I1.i1.p1.2.m2.1.2.cmml">
           <mtext class="ltx_mathvariant_monospace" id="S3.I1.i1.p1.2.m2.1.2.2" xref="S3.I1.i1.p1.2.m2.1.2.2a.cmml">
            MinFrac
           </mtext>
           <mo id="S3.I1.i1.p1.2.m2.1.2.1" lspace="0em" rspace="0em" xref="S3.I1.i1.p1.2.m2.1.2.1.cmml">
            ​
           </mo>
           <mrow id="S3.I1.i1.p1.2.m2.1.2.3.2" xref="S3.I1.i1.p1.2.m2.1.2.cmml">
            <mo id="S3.I1.i1.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S3.I1.i1.p1.2.m2.1.2.cmml">
             (
            </mo>
            <mi id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml">
             T
            </mi>
            <mo id="S3.I1.i1.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S3.I1.i1.p1.2.m2.1.2.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b">
           <apply id="S3.I1.i1.p1.2.m2.1.2.cmml" xref="S3.I1.i1.p1.2.m2.1.2">
            <times id="S3.I1.i1.p1.2.m2.1.2.1.cmml" xref="S3.I1.i1.p1.2.m2.1.2.1">
            </times>
            <ci id="S3.I1.i1.p1.2.m2.1.2.2a.cmml" xref="S3.I1.i1.p1.2.m2.1.2.2">
             <mtext class="ltx_mathvariant_monospace" id="S3.I1.i1.p1.2.m2.1.2.2.cmml" xref="S3.I1.i1.p1.2.m2.1.2.2">
              MinFrac
             </mtext>
            </ci>
            <ci id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1">
             𝑇
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">
           \texttt{MinFrac}(T)
          </annotation>
         </semantics>
        </math>
        , defined above.
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="S3.I1.i2.p1">
       <p class="ltx_p" id="S3.I1.i2.p1.1">
        <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.I1.i2.p1.1.1">
         MedianReward
        </span>
        : the rescaled median (over replicates) of the time-averaged total reward.
        <span class="ltx_note ltx_role_footnote" id="footnote12">
         <sup class="ltx_note_mark">
          12
         </sup>
         <span class="ltx_note_outer">
          <span class="ltx_note_content">
           <sup class="ltx_note_mark">
            12
           </sup>
           <span class="ltx_tag ltx_tag_note">
            12
           </span>
           More precisely, let
           <math alttext="\Phi(R)" class="ltx_Math" display="inline" id="footnote12.m1.1">
            <semantics id="footnote12.m1.1b">
             <mrow id="footnote12.m1.1.2" xref="footnote12.m1.1.2.cmml">
              <mi id="footnote12.m1.1.2.2" mathvariant="normal" xref="footnote12.m1.1.2.2.cmml">
               Φ
              </mi>
              <mo id="footnote12.m1.1.2.1" lspace="0em" rspace="0em" xref="footnote12.m1.1.2.1.cmml">
               ​
              </mo>
              <mrow id="footnote12.m1.1.2.3.2" xref="footnote12.m1.1.2.cmml">
               <mo id="footnote12.m1.1.2.3.2.1" stretchy="false" xref="footnote12.m1.1.2.cmml">
                (
               </mo>
               <mi id="footnote12.m1.1.1" xref="footnote12.m1.1.1.cmml">
                R
               </mi>
               <mo id="footnote12.m1.1.2.3.2.2" stretchy="false" xref="footnote12.m1.1.2.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <annotation-xml encoding="MathML-Content" id="footnote12.m1.1c">
              <apply id="footnote12.m1.1.2.cmml" xref="footnote12.m1.1.2">
               <times id="footnote12.m1.1.2.1.cmml" xref="footnote12.m1.1.2.1">
               </times>
               <ci id="footnote12.m1.1.2.2.cmml" xref="footnote12.m1.1.2.2">
                Φ
               </ci>
               <ci id="footnote12.m1.1.1.cmml" xref="footnote12.m1.1.1">
                𝑅
               </ci>
              </apply>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="footnote12.m1.1d">
              \Phi(R)
             </annotation>
            </semantics>
           </math>
           be the time-averaged total reward for a given replicate
           <math alttext="R" class="ltx_Math" display="inline" id="footnote12.m2.1">
            <semantics id="footnote12.m2.1b">
             <mi id="footnote12.m2.1.1" xref="footnote12.m2.1.1.cmml">
              R
             </mi>
             <annotation-xml encoding="MathML-Content" id="footnote12.m2.1c">
              <ci id="footnote12.m2.1.1.cmml" xref="footnote12.m2.1.1">
               𝑅
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="footnote12.m2.1d">
              R
             </annotation>
            </semantics>
           </math>
           . Then
           <math alttext="\operatornamewithlimits{\mathbb{E}}\left[\Phi(R)\right]" class="ltx_Math" display="inline" id="footnote12.m3.3">
            <semantics id="footnote12.m3.3b">
             <mrow id="footnote12.m3.3.3.1" xref="footnote12.m3.3.3.2.cmml">
              <mo id="footnote12.m3.2.2" rspace="0em" xref="footnote12.m3.2.2.cmml">
               𝔼
              </mo>
              <mrow id="footnote12.m3.3.3.1.1" xref="footnote12.m3.3.3.2.cmml">
               <mo id="footnote12.m3.3.3.1.1.2" xref="footnote12.m3.3.3.2.cmml">
                [
               </mo>
               <mrow id="footnote12.m3.3.3.1.1.1" xref="footnote12.m3.3.3.1.1.1.cmml">
                <mi id="footnote12.m3.3.3.1.1.1.2" mathvariant="normal" xref="footnote12.m3.3.3.1.1.1.2.cmml">
                 Φ
                </mi>
                <mo id="footnote12.m3.3.3.1.1.1.1" lspace="0em" rspace="0em" xref="footnote12.m3.3.3.1.1.1.1.cmml">
                 ​
                </mo>
                <mrow id="footnote12.m3.3.3.1.1.1.3.2" xref="footnote12.m3.3.3.1.1.1.cmml">
                 <mo id="footnote12.m3.3.3.1.1.1.3.2.1" stretchy="false" xref="footnote12.m3.3.3.1.1.1.cmml">
                  (
                 </mo>
                 <mi id="footnote12.m3.1.1" xref="footnote12.m3.1.1.cmml">
                  R
                 </mi>
                 <mo id="footnote12.m3.3.3.1.1.1.3.2.2" stretchy="false" xref="footnote12.m3.3.3.1.1.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="footnote12.m3.3.3.1.1.3" xref="footnote12.m3.3.3.2.cmml">
                ]
               </mo>
              </mrow>
             </mrow>
             <annotation-xml encoding="MathML-Content" id="footnote12.m3.3c">
              <apply id="footnote12.m3.3.3.2.cmml" xref="footnote12.m3.3.3.1">
               <ci id="footnote12.m3.2.2.cmml" xref="footnote12.m3.2.2">
                𝔼
               </ci>
               <apply id="footnote12.m3.3.3.1.1.1.cmml" xref="footnote12.m3.3.3.1.1.1">
                <times id="footnote12.m3.3.3.1.1.1.1.cmml" xref="footnote12.m3.3.3.1.1.1.1">
                </times>
                <ci id="footnote12.m3.3.3.1.1.1.2.cmml" xref="footnote12.m3.3.3.1.1.1.2">
                 Φ
                </ci>
                <ci id="footnote12.m3.1.1.cmml" xref="footnote12.m3.1.1">
                 𝑅
                </ci>
               </apply>
              </apply>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="footnote12.m3.3d">
              \operatornamewithlimits{\mathbb{E}}\left[\Phi(R)\right]
             </annotation>
            </semantics>
           </math>
           ranges in the interval
           <math alttext="[\nicefrac{{1}}{{2}}-\Delta/2,\,\nicefrac{{1}}{{2}}+\Delta/2]" class="ltx_Math" display="inline" id="footnote12.m4.2">
            <semantics id="footnote12.m4.2b">
             <mrow id="footnote12.m4.2.2.2" xref="footnote12.m4.2.2.3.cmml">
              <mo id="footnote12.m4.2.2.2.3" stretchy="false" xref="footnote12.m4.2.2.3.cmml">
               [
              </mo>
              <mrow id="footnote12.m4.1.1.1.1" xref="footnote12.m4.1.1.1.1.cmml">
               <mrow id="footnote12.m4.1.1.1.1.2" xref="footnote12.m4.1.1.1.1.2.cmml">
                <mpadded id="footnote12.m4.1.1.1.1.2.2" voffset="0.3em" xref="footnote12.m4.1.1.1.1.2.2.cmml">
                 <mn id="footnote12.m4.1.1.1.1.2.2b" mathsize="70%" xref="footnote12.m4.1.1.1.1.2.2.cmml">
                  1
                 </mn>
                </mpadded>
                <mpadded id="footnote12.m4.1.1.1.1.2.1" lspace="-0.1em" width="-0.15em" xref="footnote12.m4.1.1.1.1.2.1.cmml">
                 <mo id="footnote12.m4.1.1.1.1.2.1b" stretchy="true" symmetric="true" xref="footnote12.m4.1.1.1.1.2.1.cmml">
                  /
                 </mo>
                </mpadded>
                <mn id="footnote12.m4.1.1.1.1.2.3" mathsize="70%" xref="footnote12.m4.1.1.1.1.2.3.cmml">
                 2
                </mn>
               </mrow>
               <mo id="footnote12.m4.1.1.1.1.1" xref="footnote12.m4.1.1.1.1.1.cmml">
                −
               </mo>
               <mrow id="footnote12.m4.1.1.1.1.3" xref="footnote12.m4.1.1.1.1.3.cmml">
                <mi id="footnote12.m4.1.1.1.1.3.2" mathvariant="normal" xref="footnote12.m4.1.1.1.1.3.2.cmml">
                 Δ
                </mi>
                <mo id="footnote12.m4.1.1.1.1.3.1" xref="footnote12.m4.1.1.1.1.3.1.cmml">
                 /
                </mo>
                <mn id="footnote12.m4.1.1.1.1.3.3" xref="footnote12.m4.1.1.1.1.3.3.cmml">
                 2
                </mn>
               </mrow>
              </mrow>
              <mo id="footnote12.m4.2.2.2.4" rspace="0.337em" xref="footnote12.m4.2.2.3.cmml">
               ,
              </mo>
              <mrow id="footnote12.m4.2.2.2.2" xref="footnote12.m4.2.2.2.2.cmml">
               <mrow id="footnote12.m4.2.2.2.2.2" xref="footnote12.m4.2.2.2.2.2.cmml">
                <mpadded id="footnote12.m4.2.2.2.2.2.2" voffset="0.3em" xref="footnote12.m4.2.2.2.2.2.2.cmml">
                 <mn id="footnote12.m4.2.2.2.2.2.2b" mathsize="70%" xref="footnote12.m4.2.2.2.2.2.2.cmml">
                  1
                 </mn>
                </mpadded>
                <mpadded id="footnote12.m4.2.2.2.2.2.1" lspace="-0.1em" width="-0.15em" xref="footnote12.m4.2.2.2.2.2.1.cmml">
                 <mo id="footnote12.m4.2.2.2.2.2.1b" stretchy="true" symmetric="true" xref="footnote12.m4.2.2.2.2.2.1.cmml">
                  /
                 </mo>
                </mpadded>
                <mn id="footnote12.m4.2.2.2.2.2.3" mathsize="70%" xref="footnote12.m4.2.2.2.2.2.3.cmml">
                 2
                </mn>
               </mrow>
               <mo id="footnote12.m4.2.2.2.2.1" xref="footnote12.m4.2.2.2.2.1.cmml">
                +
               </mo>
               <mrow id="footnote12.m4.2.2.2.2.3" xref="footnote12.m4.2.2.2.2.3.cmml">
                <mi id="footnote12.m4.2.2.2.2.3.2" mathvariant="normal" xref="footnote12.m4.2.2.2.2.3.2.cmml">
                 Δ
                </mi>
                <mo id="footnote12.m4.2.2.2.2.3.1" xref="footnote12.m4.2.2.2.2.3.1.cmml">
                 /
                </mo>
                <mn id="footnote12.m4.2.2.2.2.3.3" xref="footnote12.m4.2.2.2.2.3.3.cmml">
                 2
                </mn>
               </mrow>
              </mrow>
              <mo id="footnote12.m4.2.2.2.5" stretchy="false" xref="footnote12.m4.2.2.3.cmml">
               ]
              </mo>
             </mrow>
             <annotation-xml encoding="MathML-Content" id="footnote12.m4.2c">
              <interval closure="closed" id="footnote12.m4.2.2.3.cmml" xref="footnote12.m4.2.2.2">
               <apply id="footnote12.m4.1.1.1.1.cmml" xref="footnote12.m4.1.1.1.1">
                <minus id="footnote12.m4.1.1.1.1.1.cmml" xref="footnote12.m4.1.1.1.1.1">
                </minus>
                <apply id="footnote12.m4.1.1.1.1.2.cmml" xref="footnote12.m4.1.1.1.1.2">
                 <divide id="footnote12.m4.1.1.1.1.2.1.cmml" xref="footnote12.m4.1.1.1.1.2.1">
                 </divide>
                 <cn id="footnote12.m4.1.1.1.1.2.2.cmml" type="integer" xref="footnote12.m4.1.1.1.1.2.2">
                  1
                 </cn>
                 <cn id="footnote12.m4.1.1.1.1.2.3.cmml" type="integer" xref="footnote12.m4.1.1.1.1.2.3">
                  2
                 </cn>
                </apply>
                <apply id="footnote12.m4.1.1.1.1.3.cmml" xref="footnote12.m4.1.1.1.1.3">
                 <divide id="footnote12.m4.1.1.1.1.3.1.cmml" xref="footnote12.m4.1.1.1.1.3.1">
                 </divide>
                 <ci id="footnote12.m4.1.1.1.1.3.2.cmml" xref="footnote12.m4.1.1.1.1.3.2">
                  Δ
                 </ci>
                 <cn id="footnote12.m4.1.1.1.1.3.3.cmml" type="integer" xref="footnote12.m4.1.1.1.1.3.3">
                  2
                 </cn>
                </apply>
               </apply>
               <apply id="footnote12.m4.2.2.2.2.cmml" xref="footnote12.m4.2.2.2.2">
                <plus id="footnote12.m4.2.2.2.2.1.cmml" xref="footnote12.m4.2.2.2.2.1">
                </plus>
                <apply id="footnote12.m4.2.2.2.2.2.cmml" xref="footnote12.m4.2.2.2.2.2">
                 <divide id="footnote12.m4.2.2.2.2.2.1.cmml" xref="footnote12.m4.2.2.2.2.2.1">
                 </divide>
                 <cn id="footnote12.m4.2.2.2.2.2.2.cmml" type="integer" xref="footnote12.m4.2.2.2.2.2.2">
                  1
                 </cn>
                 <cn id="footnote12.m4.2.2.2.2.2.3.cmml" type="integer" xref="footnote12.m4.2.2.2.2.2.3">
                  2
                 </cn>
                </apply>
                <apply id="footnote12.m4.2.2.2.2.3.cmml" xref="footnote12.m4.2.2.2.2.3">
                 <divide id="footnote12.m4.2.2.2.2.3.1.cmml" xref="footnote12.m4.2.2.2.2.3.1">
                 </divide>
                 <ci id="footnote12.m4.2.2.2.2.3.2.cmml" xref="footnote12.m4.2.2.2.2.3.2">
                  Δ
                 </ci>
                 <cn id="footnote12.m4.2.2.2.2.3.3.cmml" type="integer" xref="footnote12.m4.2.2.2.2.3.3">
                  2
                 </cn>
                </apply>
               </apply>
              </interval>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="footnote12.m4.2d">
              [\nicefrac{{1}}{{2}}-\Delta/2,\,\nicefrac{{1}}{{2}}+\Delta/2]
             </annotation>
            </semantics>
           </math>
           .
We rescale
           <math alttext="\Phi(R)" class="ltx_Math" display="inline" id="footnote12.m5.1">
            <semantics id="footnote12.m5.1b">
             <mrow id="footnote12.m5.1.2" xref="footnote12.m5.1.2.cmml">
              <mi id="footnote12.m5.1.2.2" mathvariant="normal" xref="footnote12.m5.1.2.2.cmml">
               Φ
              </mi>
              <mo id="footnote12.m5.1.2.1" lspace="0em" rspace="0em" xref="footnote12.m5.1.2.1.cmml">
               ​
              </mo>
              <mrow id="footnote12.m5.1.2.3.2" xref="footnote12.m5.1.2.cmml">
               <mo id="footnote12.m5.1.2.3.2.1" stretchy="false" xref="footnote12.m5.1.2.cmml">
                (
               </mo>
               <mi id="footnote12.m5.1.1" xref="footnote12.m5.1.1.cmml">
                R
               </mi>
               <mo id="footnote12.m5.1.2.3.2.2" stretchy="false" xref="footnote12.m5.1.2.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <annotation-xml encoding="MathML-Content" id="footnote12.m5.1c">
              <apply id="footnote12.m5.1.2.cmml" xref="footnote12.m5.1.2">
               <times id="footnote12.m5.1.2.1.cmml" xref="footnote12.m5.1.2.1">
               </times>
               <ci id="footnote12.m5.1.2.2.cmml" xref="footnote12.m5.1.2.2">
                Φ
               </ci>
               <ci id="footnote12.m5.1.1.cmml" xref="footnote12.m5.1.1">
                𝑅
               </ci>
              </apply>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="footnote12.m5.1d">
              \Phi(R)
             </annotation>
            </semantics>
           </math>
           , by translating and multiplying, so that
           <math alttext="\operatornamewithlimits{\mathbb{E}}\left[\Phi(R)\right]" class="ltx_Math" display="inline" id="footnote12.m6.3">
            <semantics id="footnote12.m6.3b">
             <mrow id="footnote12.m6.3.3.1" xref="footnote12.m6.3.3.2.cmml">
              <mo id="footnote12.m6.2.2" rspace="0em" xref="footnote12.m6.2.2.cmml">
               𝔼
              </mo>
              <mrow id="footnote12.m6.3.3.1.1" xref="footnote12.m6.3.3.2.cmml">
               <mo id="footnote12.m6.3.3.1.1.2" xref="footnote12.m6.3.3.2.cmml">
                [
               </mo>
               <mrow id="footnote12.m6.3.3.1.1.1" xref="footnote12.m6.3.3.1.1.1.cmml">
                <mi id="footnote12.m6.3.3.1.1.1.2" mathvariant="normal" xref="footnote12.m6.3.3.1.1.1.2.cmml">
                 Φ
                </mi>
                <mo id="footnote12.m6.3.3.1.1.1.1" lspace="0em" rspace="0em" xref="footnote12.m6.3.3.1.1.1.1.cmml">
                 ​
                </mo>
                <mrow id="footnote12.m6.3.3.1.1.1.3.2" xref="footnote12.m6.3.3.1.1.1.cmml">
                 <mo id="footnote12.m6.3.3.1.1.1.3.2.1" stretchy="false" xref="footnote12.m6.3.3.1.1.1.cmml">
                  (
                 </mo>
                 <mi id="footnote12.m6.1.1" xref="footnote12.m6.1.1.cmml">
                  R
                 </mi>
                 <mo id="footnote12.m6.3.3.1.1.1.3.2.2" stretchy="false" xref="footnote12.m6.3.3.1.1.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="footnote12.m6.3.3.1.1.3" xref="footnote12.m6.3.3.2.cmml">
                ]
               </mo>
              </mrow>
             </mrow>
             <annotation-xml encoding="MathML-Content" id="footnote12.m6.3c">
              <apply id="footnote12.m6.3.3.2.cmml" xref="footnote12.m6.3.3.1">
               <ci id="footnote12.m6.2.2.cmml" xref="footnote12.m6.2.2">
                𝔼
               </ci>
               <apply id="footnote12.m6.3.3.1.1.1.cmml" xref="footnote12.m6.3.3.1.1.1">
                <times id="footnote12.m6.3.3.1.1.1.1.cmml" xref="footnote12.m6.3.3.1.1.1.1">
                </times>
                <ci id="footnote12.m6.3.3.1.1.1.2.cmml" xref="footnote12.m6.3.3.1.1.1.2">
                 Φ
                </ci>
                <ci id="footnote12.m6.1.1.cmml" xref="footnote12.m6.1.1">
                 𝑅
                </ci>
               </apply>
              </apply>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="footnote12.m6.3d">
              \operatornamewithlimits{\mathbb{E}}\left[\Phi(R)\right]
             </annotation>
            </semantics>
           </math>
           ranges in
           <math alttext="[0,1]" class="ltx_Math" display="inline" id="footnote12.m7.2">
            <semantics id="footnote12.m7.2b">
             <mrow id="footnote12.m7.2.3.2" xref="footnote12.m7.2.3.1.cmml">
              <mo id="footnote12.m7.2.3.2.1" stretchy="false" xref="footnote12.m7.2.3.1.cmml">
               [
              </mo>
              <mn id="footnote12.m7.1.1" xref="footnote12.m7.1.1.cmml">
               0
              </mn>
              <mo id="footnote12.m7.2.3.2.2" xref="footnote12.m7.2.3.1.cmml">
               ,
              </mo>
              <mn id="footnote12.m7.2.2" xref="footnote12.m7.2.2.cmml">
               1
              </mn>
              <mo id="footnote12.m7.2.3.2.3" stretchy="false" xref="footnote12.m7.2.3.1.cmml">
               ]
              </mo>
             </mrow>
             <annotation-xml encoding="MathML-Content" id="footnote12.m7.2c">
              <interval closure="closed" id="footnote12.m7.2.3.1.cmml" xref="footnote12.m7.2.3.2">
               <cn id="footnote12.m7.1.1.cmml" type="integer" xref="footnote12.m7.1.1">
                0
               </cn>
               <cn id="footnote12.m7.2.2.cmml" type="integer" xref="footnote12.m7.2.2">
                1
               </cn>
              </interval>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="footnote12.m7.2d">
              [0,1]
             </annotation>
            </semantics>
           </math>
           .
          </span>
         </span>
        </span>
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       •
      </span>
      <div class="ltx_para" id="S3.I1.i3.p1">
       <p class="ltx_p" id="S3.I1.i3.p1.1">
        <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.I1.i3.p1.1.1">
         GreedyFrac
        </span>
        : the fraction of
        <em class="ltx_emph ltx_font_italic" id="S3.I1.i3.p1.1.2">
         greedy rounds
        </em>
        , averaged over the replicates. A greedy round is one in which an arm with a largest average reward is selected. This is one way to quantify the extent to which a configuration behaves like
        <span class="ltx_text ltx_font_smallcaps" id="S3.I1.i3.p1.1.3">
         Greedy
        </span>
        .
       </p>
      </div>
     </li>
    </ul>
   </div>
   <figure class="ltx_figure" id="S3.F7">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="138" id="S3.F7.g1" src="/html/2403.15371/assets/x6.png" width="369"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 7:
     </span>
     Summary statistics of two
     <span class="ltx_text ltx_font_smallcaps" id="S3.F7.15.1">
      Gpt-4
     </span>
     configurations with reinforced CoT
(BSR
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.F7.7.m1.1">
      <semantics id="S3.F7.7.m1.1b">
       <mover accent="true" id="S3.F7.7.m1.1.1" xref="S3.F7.7.m1.1.1.cmml">
        <mtext id="S3.F7.7.m1.1.1.2" xref="S3.F7.7.m1.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.F7.7.m1.1.1.1" xref="S3.F7.7.m1.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.F7.7.m1.1c">
        <apply id="S3.F7.7.m1.1.1.cmml" xref="S3.F7.7.m1.1.1">
         <ci id="S3.F7.7.m1.1.1.1.cmml" xref="S3.F7.7.m1.1.1.1">
          ~
         </ci>
         <ci id="S3.F7.7.m1.1.1.2a.cmml" xref="S3.F7.7.m1.1.1.2">
          <mtext id="S3.F7.7.m1.1.1.2.cmml" xref="S3.F7.7.m1.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F7.7.m1.1d">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 and BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.F7.8.m2.1">
      <semantics id="S3.F7.8.m2.1b">
       <mover accent="true" id="S3.F7.8.m2.1.1" xref="S3.F7.8.m2.1.1.cmml">
        <mtext id="S3.F7.8.m2.1.1.2" xref="S3.F7.8.m2.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.F7.8.m2.1.1.1" xref="S3.F7.8.m2.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.F7.8.m2.1c">
        <apply id="S3.F7.8.m2.1.1.cmml" xref="S3.F7.8.m2.1.1">
         <ci id="S3.F7.8.m2.1.1.1.cmml" xref="S3.F7.8.m2.1.1.1">
          ~
         </ci>
         <ci id="S3.F7.8.m2.1.1.2a.cmml" xref="S3.F7.8.m2.1.1.2">
          <mtext id="S3.F7.8.m2.1.1.2.cmml" xref="S3.F7.8.m2.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F7.8.m2.1d">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0) when run on the
     <span class="ltx_text ltx_font_typewriter" id="S3.F7.16.2">
      hard
     </span>
     MAB
instance with
     <math alttext="T=200" class="ltx_Math" display="inline" id="S3.F7.9.m3.1">
      <semantics id="S3.F7.9.m3.1b">
       <mrow id="S3.F7.9.m3.1.1" xref="S3.F7.9.m3.1.1.cmml">
        <mi id="S3.F7.9.m3.1.1.2" xref="S3.F7.9.m3.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.F7.9.m3.1.1.1" xref="S3.F7.9.m3.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.F7.9.m3.1.1.3" xref="S3.F7.9.m3.1.1.3.cmml">
         200
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.F7.9.m3.1c">
        <apply id="S3.F7.9.m3.1.1.cmml" xref="S3.F7.9.m3.1.1">
         <eq id="S3.F7.9.m3.1.1.1.cmml" xref="S3.F7.9.m3.1.1.1">
         </eq>
         <ci id="S3.F7.9.m3.1.1.2.cmml" xref="S3.F7.9.m3.1.1.2">
          𝑇
         </ci>
         <cn id="S3.F7.9.m3.1.1.3.cmml" type="integer" xref="S3.F7.9.m3.1.1.3">
          200
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F7.9.m3.1d">
        T=200
       </annotation>
      </semantics>
     </math>
     for
     <math alttext="N=40" class="ltx_Math" display="inline" id="S3.F7.10.m4.1">
      <semantics id="S3.F7.10.m4.1b">
       <mrow id="S3.F7.10.m4.1.1" xref="S3.F7.10.m4.1.1.cmml">
        <mi id="S3.F7.10.m4.1.1.2" xref="S3.F7.10.m4.1.1.2.cmml">
         N
        </mi>
        <mo id="S3.F7.10.m4.1.1.1" xref="S3.F7.10.m4.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.F7.10.m4.1.1.3" xref="S3.F7.10.m4.1.1.3.cmml">
         40
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.F7.10.m4.1c">
        <apply id="S3.F7.10.m4.1.1.cmml" xref="S3.F7.10.m4.1.1">
         <eq id="S3.F7.10.m4.1.1.1.cmml" xref="S3.F7.10.m4.1.1.1">
         </eq>
         <ci id="S3.F7.10.m4.1.1.2.cmml" xref="S3.F7.10.m4.1.1.2">
          𝑁
         </ci>
         <cn id="S3.F7.10.m4.1.1.3.cmml" type="integer" xref="S3.F7.10.m4.1.1.3">
          40
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F7.10.m4.1d">
        N=40
       </annotation>
      </semantics>
     </math>
     replicates. BSR
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.F7.11.m5.1">
      <semantics id="S3.F7.11.m5.1b">
       <mover accent="true" id="S3.F7.11.m5.1.1" xref="S3.F7.11.m5.1.1.cmml">
        <mtext id="S3.F7.11.m5.1.1.2" xref="S3.F7.11.m5.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.F7.11.m5.1.1.1" xref="S3.F7.11.m5.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.F7.11.m5.1c">
        <apply id="S3.F7.11.m5.1.1.cmml" xref="S3.F7.11.m5.1.1">
         <ci id="S3.F7.11.m5.1.1.1.cmml" xref="S3.F7.11.m5.1.1.1">
          ~
         </ci>
         <ci id="S3.F7.11.m5.1.1.2a.cmml" xref="S3.F7.11.m5.1.1.2">
          <mtext id="S3.F7.11.m5.1.1.2.cmml" xref="S3.F7.11.m5.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F7.11.m5.1d">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 exhibits suffix
failures. BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.F7.12.m6.1">
      <semantics id="S3.F7.12.m6.1b">
       <mover accent="true" id="S3.F7.12.m6.1.1" xref="S3.F7.12.m6.1.1.cmml">
        <mtext id="S3.F7.12.m6.1.1.2" xref="S3.F7.12.m6.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.F7.12.m6.1.1.1" xref="S3.F7.12.m6.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.F7.12.m6.1c">
        <apply id="S3.F7.12.m6.1.1.cmml" xref="S3.F7.12.m6.1.1">
         <ci id="S3.F7.12.m6.1.1.1.cmml" xref="S3.F7.12.m6.1.1.1">
          ~
         </ci>
         <ci id="S3.F7.12.m6.1.1.2a.cmml" xref="S3.F7.12.m6.1.1.2">
          <mtext id="S3.F7.12.m6.1.1.2.cmml" xref="S3.F7.12.m6.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F7.12.m6.1d">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 exhibits neither suffix failures nor uniform-like
failures and has reasonable reward, so we declare it to be successful.
    </figcaption>
   </figure>
   <div class="ltx_para" id="S3.SS2.p10">
    <p class="ltx_p" id="S3.SS2.p10.1">
     We now summarize
further findings from the scatter plots (
     <a class="ltx_ref" href="#S3.F3" title="In 3 Experimental results ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       Figures
      </span>
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     and
     <a class="ltx_ref" href="#A2.F12" title="Figure 12 ‣ Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       12
      </span>
     </a>
     ) and
the summary tables (
     <a class="ltx_ref" href="#A2.F13" title="In Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       Figures
      </span>
      <span class="ltx_text ltx_ref_tag">
       13
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#A2.F14" title="Figure 14 ‣ Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       14
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#A2.F15" title="Figure 15 ‣ Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       15
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#A2.F16" title="Figure 16 ‣ Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       16
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#A2.F17" title="Figure 17 ‣ Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       17
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#A2.F18" title="Figure 18 ‣ Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       18
      </span>
     </a>
     and
     <a class="ltx_ref" href="#A2.F19" title="Figure 19 ‣ Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       19
      </span>
     </a>
     ). First,
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p10.1.1">
      Gpt-4
     </span>
     performs much better than
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p10.1.2">
      Gpt-3.5
     </span>
     , and
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p10.1.3">
      Llama2
     </span>
     performs much worse (in particular, the suffix
failure frequency for
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p10.1.4">
      Llama2
     </span>
     ranges from that of
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.p10.1.5">
      Greedy
     </span>
     to much
larger). Second, we observe that all LLMs are sensitive to small changes in
the prompt design. However, the different modifications we consider
appear to interact with each other, and it is difficult to identify
which individual modifications improve performance and which degrade it.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.3
    </span>
    Investigating successes
   </h3>
   <div class="ltx_para" id="S3.SS3.p1">
    <p class="ltx_p" id="S3.SS3.p1.3">
     On the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS3.p1.3.1">
      hard
     </span>
     MAB instance, the only configuration in our experiments
that avoids both suffix failures and uniform-like failures is
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p1.3.2">
      Gpt-4
     </span>
     with the BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1">
      <semantics id="S3.SS3.p1.1.m1.1a">
       <mover accent="true" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">
        <mtext id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p1.1.m1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b">
        <apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">
         <ci id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p1.1.m1.1.1.2a.cmml" xref="S3.SS3.p1.1.m1.1.1.2">
          <mtext id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 prompt design. As can be seen
from
     <a class="ltx_ref" href="#S3.F4" title="Figure 4 ‣ 3.1 Overview ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        4
       </span>
      </span>
     </a>
     , at
     <math alttext="T=100" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1">
      <semantics id="S3.SS3.p1.2.m2.1a">
       <mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">
        <mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.SS3.p1.2.m2.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b">
        <apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">
         <eq id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1">
         </eq>
         <ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">
          𝑇
         </ci>
         <cn id="S3.SS3.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.p1.2.m2.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">
        T=100
       </annotation>
      </semantics>
     </math>
     , this configuration has no
suffix failures, the
     <math alttext="K\cdot\texttt{MinFrac}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1">
      <semantics id="S3.SS3.p1.3.m3.1a">
       <mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">
        <mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">
         K
        </mi>
        <mo id="S3.SS3.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.3.m3.1.1.1.cmml">
         ⋅
        </mo>
        <mtext class="ltx_mathvariant_monospace" id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3a.cmml">
         MinFrac
        </mtext>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b">
        <apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">
         <ci id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1">
          ⋅
         </ci>
         <ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">
          𝐾
         </ci>
         <ci id="S3.SS3.p1.3.m3.1.1.3a.cmml" xref="S3.SS3.p1.3.m3.1.1.3">
          <mtext class="ltx_mathvariant_monospace" id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">
           MinFrac
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">
        K\cdot\texttt{MinFrac}
       </annotation>
      </semantics>
     </math>
     value is only slightly larger than
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p1.3.3">
      TS
     </span>
     , and the reward is comparable to
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p1.3.4">
      TS
     </span>
     . These statistics suggest
that this configuration succeeds, and in this section we present
further evidence supporting this claim.
    </p>
   </div>
   <figure class="ltx_figure" id="S3.F8">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="153" id="S3.F8.g1" src="/html/2403.15371/assets/x7.png" width="461"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 8:
     </span>
     Traces of the arm chosen at each time step for (a)
     <math alttext="4" class="ltx_Math" display="inline" id="S3.F8.7.m1.1">
      <semantics id="S3.F8.7.m1.1b">
       <mn id="S3.F8.7.m1.1.1" xref="S3.F8.7.m1.1.1.cmml">
        4
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.F8.7.m1.1c">
        <cn id="S3.F8.7.m1.1.1.cmml" type="integer" xref="S3.F8.7.m1.1.1">
         4
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F8.7.m1.1d">
        4
       </annotation>
      </semantics>
     </math>
     of
the replicates of the basic configuration (
     <span class="ltx_text ltx_font_smallcaps" id="S3.F8.19.1">
      Gpt-4
     </span>
     -BNRN0) (left
four cells in top row), (b)
     <math alttext="4" class="ltx_Math" display="inline" id="S3.F8.8.m2.1">
      <semantics id="S3.F8.8.m2.1b">
       <mn id="S3.F8.8.m2.1.1" xref="S3.F8.8.m2.1.1.cmml">
        4
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.F8.8.m2.1c">
        <cn id="S3.F8.8.m2.1.1.cmml" type="integer" xref="S3.F8.8.m2.1.1">
         4
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F8.8.m2.1d">
        4
       </annotation>
      </semantics>
     </math>
     of the replicates of
     <span class="ltx_text ltx_font_smallcaps" id="S3.F8.20.2">
      Gpt-4
     </span>
     -BSR
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.F8.9.m3.1">
      <semantics id="S3.F8.9.m3.1b">
       <mover accent="true" id="S3.F8.9.m3.1.1" xref="S3.F8.9.m3.1.1.cmml">
        <mtext id="S3.F8.9.m3.1.1.2" xref="S3.F8.9.m3.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.F8.9.m3.1.1.1" xref="S3.F8.9.m3.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.F8.9.m3.1c">
        <apply id="S3.F8.9.m3.1.1.cmml" xref="S3.F8.9.m3.1.1">
         <ci id="S3.F8.9.m3.1.1.1.cmml" xref="S3.F8.9.m3.1.1.1">
          ~
         </ci>
         <ci id="S3.F8.9.m3.1.1.2a.cmml" xref="S3.F8.9.m3.1.1.2">
          <mtext id="S3.F8.9.m3.1.1.2.cmml" xref="S3.F8.9.m3.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F8.9.m3.1d">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 (left four cells of the middle row), (c)
     <math alttext="4" class="ltx_Math" display="inline" id="S3.F8.10.m4.1">
      <semantics id="S3.F8.10.m4.1b">
       <mn id="S3.F8.10.m4.1.1" xref="S3.F8.10.m4.1.1.cmml">
        4
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.F8.10.m4.1c">
        <cn id="S3.F8.10.m4.1.1.cmml" type="integer" xref="S3.F8.10.m4.1.1">
         4
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F8.10.m4.1d">
        4
       </annotation>
      </semantics>
     </math>
     of
the replicates of
     <span class="ltx_text ltx_font_smallcaps" id="S3.F8.21.3">
      Gpt-4
     </span>
     -BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.F8.11.m5.1">
      <semantics id="S3.F8.11.m5.1b">
       <mover accent="true" id="S3.F8.11.m5.1.1" xref="S3.F8.11.m5.1.1.cmml">
        <mtext id="S3.F8.11.m5.1.1.2" xref="S3.F8.11.m5.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.F8.11.m5.1.1.1" xref="S3.F8.11.m5.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.F8.11.m5.1c">
        <apply id="S3.F8.11.m5.1.1.cmml" xref="S3.F8.11.m5.1.1">
         <ci id="S3.F8.11.m5.1.1.1.cmml" xref="S3.F8.11.m5.1.1.1">
          ~
         </ci>
         <ci id="S3.F8.11.m5.1.1.2a.cmml" xref="S3.F8.11.m5.1.1.2">
          <mtext id="S3.F8.11.m5.1.1.2.cmml" xref="S3.F8.11.m5.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F8.11.m5.1d">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 (left four cells of the
bottom row), as well as one replicate of
     <span class="ltx_text ltx_font_smallcaps" id="S3.F8.22.4">
      Greedy
     </span>
     (red border),
     <span class="ltx_text ltx_font_smallcaps" id="S3.F8.23.5">
      UCB
     </span>
     (green border) and
     <span class="ltx_text ltx_font_smallcaps" id="S3.F8.24.6">
      TS
     </span>
     (orange border). For each of the
     <math alttext="T=100" class="ltx_Math" display="inline" id="S3.F8.12.m6.1">
      <semantics id="S3.F8.12.m6.1b">
       <mrow id="S3.F8.12.m6.1.1" xref="S3.F8.12.m6.1.1.cmml">
        <mi id="S3.F8.12.m6.1.1.2" xref="S3.F8.12.m6.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.F8.12.m6.1.1.1" xref="S3.F8.12.m6.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.F8.12.m6.1.1.3" xref="S3.F8.12.m6.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.F8.12.m6.1c">
        <apply id="S3.F8.12.m6.1.1.cmml" xref="S3.F8.12.m6.1.1">
         <eq id="S3.F8.12.m6.1.1.1.cmml" xref="S3.F8.12.m6.1.1.1">
         </eq>
         <ci id="S3.F8.12.m6.1.1.2.cmml" xref="S3.F8.12.m6.1.1.2">
          𝑇
         </ci>
         <cn id="S3.F8.12.m6.1.1.3.cmml" type="integer" xref="S3.F8.12.m6.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F8.12.m6.1d">
        T=100
       </annotation>
      </semantics>
     </math>
     time steps (X-axis) we indicate which of the five arms was
chosen (Y-axis). The best arm is the top row of each plot,
highlighted with blue boxes.
    </figcaption>
   </figure>
   <figure class="ltx_figure" id="S3.F9">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="103" id="S3.F9.g1" src="/html/2403.15371/assets/x8.png" width="461"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 9:
     </span>
     Visualization of the per-replicate behavior of two
     <span class="ltx_text ltx_font_smallcaps" id="S3.F9.6.1">
      Gpt-4
     </span>
     configurations with reinforced-CoT and the baselines. For each algorithm,
replicate and time step
     <math alttext="t" class="ltx_Math" display="inline" id="S3.F9.3.m1.1">
      <semantics id="S3.F9.3.m1.1b">
       <mi id="S3.F9.3.m1.1.1" xref="S3.F9.3.m1.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.F9.3.m1.1c">
        <ci id="S3.F9.3.m1.1.1.cmml" xref="S3.F9.3.m1.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F9.3.m1.1d">
        t
       </annotation>
      </semantics>
     </math>
     , we plot the fraction of rounds in
     <math alttext="[0,t]" class="ltx_Math" display="inline" id="S3.F9.4.m2.2">
      <semantics id="S3.F9.4.m2.2b">
       <mrow id="S3.F9.4.m2.2.3.2" xref="S3.F9.4.m2.2.3.1.cmml">
        <mo id="S3.F9.4.m2.2.3.2.1" stretchy="false" xref="S3.F9.4.m2.2.3.1.cmml">
         [
        </mo>
        <mn id="S3.F9.4.m2.1.1" xref="S3.F9.4.m2.1.1.cmml">
         0
        </mn>
        <mo id="S3.F9.4.m2.2.3.2.2" xref="S3.F9.4.m2.2.3.1.cmml">
         ,
        </mo>
        <mi id="S3.F9.4.m2.2.2" xref="S3.F9.4.m2.2.2.cmml">
         t
        </mi>
        <mo id="S3.F9.4.m2.2.3.2.3" stretchy="false" xref="S3.F9.4.m2.2.3.1.cmml">
         ]
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.F9.4.m2.2c">
        <interval closure="closed" id="S3.F9.4.m2.2.3.1.cmml" xref="S3.F9.4.m2.2.3.2">
         <cn id="S3.F9.4.m2.1.1.cmml" type="integer" xref="S3.F9.4.m2.1.1">
          0
         </cn>
         <ci id="S3.F9.4.m2.2.2.cmml" xref="S3.F9.4.m2.2.2">
          𝑡
         </ci>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F9.4.m2.2d">
        [0,t]
       </annotation>
      </semantics>
     </math>
     where the optimal arm was pulled.
    </figcaption>
   </figure>
   <div class="ltx_para" id="S3.SS3.p2">
    <p class="ltx_p" id="S3.SS3.p2.8">
     To do so, we run
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p2.8.1">
      Gpt-4
     </span>
     -BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1">
      <semantics id="S3.SS3.p2.1.m1.1a">
       <mover accent="true" id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">
        <mtext id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b">
        <apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">
         <ci id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p2.1.m1.1.1.2a.cmml" xref="S3.SS3.p2.1.m1.1.1.2">
          <mtext id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 on the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS3.p2.8.2">
      hard
     </span>
     MAB
instance with
     <math alttext="T=200" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1">
      <semantics id="S3.SS3.p2.2.m2.1a">
       <mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">
        <mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">
         200
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b">
        <apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">
         <eq id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1">
         </eq>
         <ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">
          𝑇
         </ci>
         <cn id="S3.SS3.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.p2.2.m2.1.1.3">
          200
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">
        T=200
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="N=40" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1">
      <semantics id="S3.SS3.p2.3.m3.1a">
       <mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">
        <mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">
         N
        </mi>
        <mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">
         40
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b">
        <apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">
         <eq id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1">
         </eq>
         <ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">
          𝑁
         </ci>
         <cn id="S3.SS3.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS3.p2.3.m3.1.1.3">
          40
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">
        N=40
       </annotation>
      </semantics>
     </math>
     to obtain more statistically
meaningful results. We also consider
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p2.8.3">
      Gpt-4
     </span>
     -BSR
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1">
      <semantics id="S3.SS3.p2.4.m4.1a">
       <mover accent="true" id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">
        <mtext id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p2.4.m4.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b">
        <apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">
         <ci id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p2.4.m4.1.1.2a.cmml" xref="S3.SS3.p2.4.m4.1.1.2">
          <mtext id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0, which swaps summarized history
for raw history, as an ablation.
     <a class="ltx_ref" href="#S3.F7" title="Figure 7 ‣ 3.2 Identifying failures ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        7
       </span>
      </span>
     </a>
     provides a summary of the results from this experiment,
while
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        1
       </span>
      </span>
     </a>
     (b) provides a detailed view of the
BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1">
      <semantics id="S3.SS3.p2.5.m5.1a">
       <mover accent="true" id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">
        <mtext id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p2.5.m5.1.1.1" xref="S3.SS3.p2.5.m5.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b">
        <apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">
         <ci id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p2.5.m5.1.1.2a.cmml" xref="S3.SS3.p2.5.m5.1.1.2">
          <mtext id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 configuration. The figures reveal that
BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1">
      <semantics id="S3.SS3.p2.6.m6.1a">
       <mover accent="true" id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">
        <mtext id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p2.6.m6.1.1.1" xref="S3.SS3.p2.6.m6.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b">
        <apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">
         <ci id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p2.6.m6.1.1.2a.cmml" xref="S3.SS3.p2.6.m6.1.1.2">
          <mtext id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 continues to avoid suffix failures and
performs relatively well in terms of reward for larger
     <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1">
      <semantics id="S3.SS3.p2.7.m7.1a">
       <mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b">
        <ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">
        T
       </annotation>
      </semantics>
     </math>
     . On the other hand, we see
that BSR
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m8.1">
      <semantics id="S3.SS3.p2.8.m8.1a">
       <mover accent="true" id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml">
        <mtext id="S3.SS3.p2.8.m8.1.1.2" xref="S3.SS3.p2.8.m8.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p2.8.m8.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b">
        <apply id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">
         <ci id="S3.SS3.p2.8.m8.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p2.8.m8.1.1.2a.cmml" xref="S3.SS3.p2.8.m8.1.1.2">
          <mtext id="S3.SS3.p2.8.m8.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 exhibits a non-trivial fraction of
suffix failures, demonstrating that this ablation results in
fundamentally different behavior.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS3.p3">
    <p class="ltx_p" id="S3.SS3.p3.5">
     We also provide two additional visualizations that provide some
qualitative evidence toward the success of BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1">
      <semantics id="S3.SS3.p3.1.m1.1a">
       <mover accent="true" id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">
        <mtext id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p3.1.m1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b">
        <apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">
         <ci id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p3.1.m1.1.1.2a.cmml" xref="S3.SS3.p3.1.m1.1.1.2">
          <mtext id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0,
as well as the failure of other configurations. These are presented
in
     <a class="ltx_ref" href="#S3.F8" title="Figure 8 ‣ 3.3 Investigating successes ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        8
       </span>
      </span>
     </a>
     and
     <a class="ltx_ref" href="#S3.F9" title="Figure 9 ‣ 3.3 Investigating successes ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        9
       </span>
      </span>
     </a>
     . In
     <a class="ltx_ref" href="#S3.F8" title="Figure 8 ‣ 3.3 Investigating successes ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        8
       </span>
      </span>
     </a>
     we
visualize the arm chosen at each time step for various replicates of
several different methods (LLMs and baselines). Specifically,
     <a class="ltx_ref" href="#S3.F8" title="In 3.3 Investigating successes ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       Figure
      </span>
      <span class="ltx_text ltx_ref_tag">
       8
      </span>
     </a>
     shows
four replicates for the basic configuration (BNRN0) and the
two configurations with reinforced CoT (BSR
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1">
      <semantics id="S3.SS3.p3.2.m2.1a">
       <mover accent="true" id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">
        <mtext id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p3.2.m2.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b">
        <apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">
         <ci id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p3.2.m2.1.1.2a.cmml" xref="S3.SS3.p3.2.m2.1.1.2">
          <mtext id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 and
BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1">
      <semantics id="S3.SS3.p3.3.m3.1a">
       <mover accent="true" id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">
        <mtext id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p3.3.m3.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b">
        <apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">
         <ci id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p3.3.m3.1.1.2a.cmml" xref="S3.SS3.p3.3.m3.1.1.2">
          <mtext id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0), as well as one replicate of each of the
baseline algorithms. We see that the basic configuration BNRN0 tends to commit to a
single arm for several rounds, a behavior that is similar to that of
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p3.5.1">
      Greedy
     </span>
     and very different from both
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p3.5.2">
      UCB
     </span>
     and
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p3.5.3">
      TS
     </span>
     .
BSR
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p3.4.m4.1">
      <semantics id="S3.SS3.p3.4.m4.1a">
       <mover accent="true" id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">
        <mtext id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p3.4.m4.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b">
        <apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">
         <ci id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p3.4.m4.1.1.2a.cmml" xref="S3.SS3.p3.4.m4.1.1.2">
          <mtext id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 also commits for long periods, but to a lesser extent than
the basic configuration. In contrast, BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m5.1">
      <semantics id="S3.SS3.p3.5.m5.1a">
       <mover accent="true" id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml">
        <mtext id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p3.5.m5.1.1.1" xref="S3.SS3.p3.5.m5.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b">
        <apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">
         <ci id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p3.5.m5.1.1.2a.cmml" xref="S3.SS3.p3.5.m5.1.1.2">
          <mtext id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0
switches arms much more frequently, and qualitatively appears much more
similar to
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p3.5.4">
      TS
     </span>
     .
    </p>
   </div>
   <div class="ltx_para" id="S3.SS3.p4">
    <p class="ltx_p" id="S3.SS3.p4.7">
     In
     <a class="ltx_ref" href="#S3.F9" title="Figure 9 ‣ 3.3 Investigating successes ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      Figure
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        9
       </span>
      </span>
     </a>
     , we plot the fraction of rounds in
     <math alttext="[0,t]" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.2">
      <semantics id="S3.SS3.p4.1.m1.2a">
       <mrow id="S3.SS3.p4.1.m1.2.3.2" xref="S3.SS3.p4.1.m1.2.3.1.cmml">
        <mo id="S3.SS3.p4.1.m1.2.3.2.1" stretchy="false" xref="S3.SS3.p4.1.m1.2.3.1.cmml">
         [
        </mo>
        <mn id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">
         0
        </mn>
        <mo id="S3.SS3.p4.1.m1.2.3.2.2" xref="S3.SS3.p4.1.m1.2.3.1.cmml">
         ,
        </mo>
        <mi id="S3.SS3.p4.1.m1.2.2" xref="S3.SS3.p4.1.m1.2.2.cmml">
         t
        </mi>
        <mo id="S3.SS3.p4.1.m1.2.3.2.3" stretchy="false" xref="S3.SS3.p4.1.m1.2.3.1.cmml">
         ]
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.2b">
        <interval closure="closed" id="S3.SS3.p4.1.m1.2.3.1.cmml" xref="S3.SS3.p4.1.m1.2.3.2">
         <cn id="S3.SS3.p4.1.m1.1.1.cmml" type="integer" xref="S3.SS3.p4.1.m1.1.1">
          0
         </cn>
         <ci id="S3.SS3.p4.1.m1.2.2.cmml" xref="S3.SS3.p4.1.m1.2.2">
          𝑡
         </ci>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.2c">
        [0,t]
       </annotation>
      </semantics>
     </math>
     where
the optimal arm was pulled as a function of
     <math alttext="t" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.1">
      <semantics id="S3.SS3.p4.2.m2.1a">
       <mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b">
        <ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">
        t
       </annotation>
      </semantics>
     </math>
     for individual
replicates. BSR
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p4.3.m3.1">
      <semantics id="S3.SS3.p4.3.m3.1a">
       <mover accent="true" id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">
        <mtext id="S3.SS3.p4.3.m3.1.1.2" xref="S3.SS3.p4.3.m3.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p4.3.m3.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b">
        <apply id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">
         <ci id="S3.SS3.p4.3.m3.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p4.3.m3.1.1.2a.cmml" xref="S3.SS3.p4.3.m3.1.1.2">
          <mtext id="S3.SS3.p4.3.m3.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 is visually similar to
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p4.7.1">
      UCB
     </span>
     , except that a non-trivial fraction of runs exhibit suffix failures (the curves that converge to
     <math alttext="0" class="ltx_Math" display="inline" id="S3.SS3.p4.4.m4.1">
      <semantics id="S3.SS3.p4.4.m4.1a">
       <mn id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml">
        0
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b">
        <cn id="S3.SS3.p4.4.m4.1.1.cmml" type="integer" xref="S3.SS3.p4.4.m4.1.1">
         0
        </cn>
       </annotation-xml>
      </semantics>
     </math>
     on the plot). Meanwhile, BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p4.5.m5.1">
      <semantics id="S3.SS3.p4.5.m5.1a">
       <mover accent="true" id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">
        <mtext id="S3.SS3.p4.5.m5.1.1.2" xref="S3.SS3.p4.5.m5.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p4.5.m5.1.1.1" xref="S3.SS3.p4.5.m5.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b">
        <apply id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">
         <ci id="S3.SS3.p4.5.m5.1.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p4.5.m5.1.1.2a.cmml" xref="S3.SS3.p4.5.m5.1.1.2">
          <mtext id="S3.SS3.p4.5.m5.1.1.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 is visually
similar to
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p4.7.2">
      TS
     </span>
     , with almost all replicates slowly converging to
     <math alttext="1" class="ltx_Math" display="inline" id="S3.SS3.p4.6.m6.1">
      <semantics id="S3.SS3.p4.6.m6.1a">
       <mn id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml">
        1
       </mn>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b">
        <cn id="S3.SS3.p4.6.m6.1.1.cmml" type="integer" xref="S3.SS3.p4.6.m6.1.1">
         1
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">
        1
       </annotation>
      </semantics>
     </math>
     .
These visualizations, along with the summary statistics,
suggest that BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS3.p4.7.m7.1">
      <semantics id="S3.SS3.p4.7.m7.1a">
       <mover accent="true" id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml">
        <mtext id="S3.SS3.p4.7.m7.1.1.2" xref="S3.SS3.p4.7.m7.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS3.p4.7.m7.1.1.1" xref="S3.SS3.p4.7.m7.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b">
        <apply id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1">
         <ci id="S3.SS3.p4.7.m7.1.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p4.7.m7.1.1.2a.cmml" xref="S3.SS3.p4.7.m7.1.1.2">
          <mtext id="S3.SS3.p4.7.m7.1.1.2.cmml" xref="S3.SS3.p4.7.m7.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0 behaves most similarly to
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS3.p4.7.3">
      TS
     </span>
     , which further suggests it will successfully converge to the
optimal arm given a long enough time horizon.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.4
    </span>
    Root causes
   </h3>
   <figure class="ltx_figure ltx_align_floatright" id="S3.F10">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="111" id="S3.F10.g1" src="/html/2403.15371/assets/x9.png" width="207"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 10:
     </span>
     Per-round decisions with some
     <span class="ltx_text ltx_font_smallcaps" id="S3.F10.7.1">
      Gpt-3.5
     </span>
     configurations.
     <math alttext="T=100" class="ltx_Math" display="inline" id="S3.F10.3.m1.1">
      <semantics id="S3.F10.3.m1.1b">
       <mrow id="S3.F10.3.m1.1.1" xref="S3.F10.3.m1.1.1.cmml">
        <mi id="S3.F10.3.m1.1.1.2" xref="S3.F10.3.m1.1.1.2.cmml">
         T
        </mi>
        <mo id="S3.F10.3.m1.1.1.1" xref="S3.F10.3.m1.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.F10.3.m1.1.1.3" xref="S3.F10.3.m1.1.1.3.cmml">
         100
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.F10.3.m1.1c">
        <apply id="S3.F10.3.m1.1.1.cmml" xref="S3.F10.3.m1.1.1">
         <eq id="S3.F10.3.m1.1.1.1.cmml" xref="S3.F10.3.m1.1.1.1">
         </eq>
         <ci id="S3.F10.3.m1.1.1.2.cmml" xref="S3.F10.3.m1.1.1.2">
          𝑇
         </ci>
         <cn id="S3.F10.3.m1.1.1.3.cmml" type="integer" xref="S3.F10.3.m1.1.1.3">
          100
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F10.3.m1.1d">
        T=100
       </annotation>
      </semantics>
     </math>
     , histories of length
     <math alttext="t=30" class="ltx_Math" display="inline" id="S3.F10.4.m2.1">
      <semantics id="S3.F10.4.m2.1b">
       <mrow id="S3.F10.4.m2.1.1" xref="S3.F10.4.m2.1.1.cmml">
        <mi id="S3.F10.4.m2.1.1.2" xref="S3.F10.4.m2.1.1.2.cmml">
         t
        </mi>
        <mo id="S3.F10.4.m2.1.1.1" xref="S3.F10.4.m2.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.F10.4.m2.1.1.3" xref="S3.F10.4.m2.1.1.3.cmml">
         30
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.F10.4.m2.1c">
        <apply id="S3.F10.4.m2.1.1.cmml" xref="S3.F10.4.m2.1.1">
         <eq id="S3.F10.4.m2.1.1.1.cmml" xref="S3.F10.4.m2.1.1.1">
         </eq>
         <ci id="S3.F10.4.m2.1.1.2.cmml" xref="S3.F10.4.m2.1.1.2">
          𝑡
         </ci>
         <cn id="S3.F10.4.m2.1.1.3.cmml" type="integer" xref="S3.F10.4.m2.1.1.3">
          30
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F10.4.m2.1d">
        t=30
       </annotation>
      </semantics>
     </math>
     ,
     <span class="ltx_text ltx_font_typewriter" id="S3.F10.8.2">
      hard
     </span>
     MAB instance.
    </figcaption>
   </figure>
   <div class="ltx_para" id="S3.SS4.p1">
    <p class="ltx_p" id="S3.SS4.p1.1">
     Our experimental findings above shed light on how LLM-based decision
making agents
behave, but it is also worthwhile to understand
     <em class="ltx_emph ltx_font_italic" id="S3.SS4.p1.1.1">
      why
     </em>
     they behave
the way they do (and particularly, why they fail). This question is
rather challenging to answer decisively, but two natural hypotheses
are that the configurations we consider (outside of
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p1.1.2">
      Gpt-4
     </span>
     -BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1">
      <semantics id="S3.SS4.p1.1.m1.1a">
       <mover accent="true" id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">
        <mtext id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2a.cmml">
         C
        </mtext>
        <mo id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b">
        <apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">
         <ci id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1">
          ~
         </ci>
         <ci id="S3.SS4.p1.1.m1.1.1.2a.cmml" xref="S3.SS4.p1.1.m1.1.1.2">
          <mtext id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     0) are either a) too greedy, or b) too uniform-like. In
this section, we describe how our experiments offer some insight into
this hypotheses.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS4.p2">
    <p class="ltx_p" id="S3.SS4.p2.2">
     First, focusing on
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.2.1">
      Gpt-4
     </span>
     , our experiments reveal qualitatively
different behavior between the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p2.2.2">
      easy
     </span>
     and
     <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p2.2.3">
      hard
     </span>
     instances (
     <a class="ltx_ref" href="#A2.F13" title="In Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       Figure
      </span>
      <span class="ltx_text ltx_ref_tag">
       13
      </span>
     </a>
     (a) and
     <a class="ltx_ref" href="#A2.F13" title="In Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       Figure
      </span>
      <span class="ltx_text ltx_ref_tag">
       13
      </span>
     </a>
     (c)).
Indeed, the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p2.2.4">
      easy
     </span>
     instance appears to be
     <em class="ltx_emph ltx_font_italic" id="S3.SS4.p2.2.5">
      much
     </em>
     easier; most
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.2.6">
      Gpt-4
     </span>
     configurations avoid suffix failures and accrue large rewards
on this instance, and the
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS4.p2.2.7">
      GreedyFrac
     </span>
     statistic offers a potential explanation as to why.
On the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p2.2.8">
      easy
     </span>
     instance, most
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.2.9">
      Gpt-4
     </span>
     configurations have very high
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS4.p2.2.10">
      GreedyFrac
     </span>
     values, so they behave similarly to
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.2.11">
      Greedy
     </span>
     , which performs quite well (even though
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.2.12">
      Greedy
     </span>
     provably fails with small constant probability and, empirically, has many suffix failures on this instance).
     <span class="ltx_note ltx_role_footnote" id="footnote13">
      <sup class="ltx_note_mark">
       13
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         13
        </sup>
        <span class="ltx_tag ltx_tag_note">
         13
        </span>
        Indeed, in
        <a class="ltx_ref" href="#A2.F13" title="Figure 13 ‣ Appendix B Scatter plots and summary tables ‣ Can large language models explore in-context?">
         Figure
         <span class="ltx_ref ltx_nolink">
          <span class="ltx_text ltx_ref_tag">
           13
          </span>
         </span>
        </a>
        (c) we see that most
        <span class="ltx_text ltx_font_smallcaps" id="footnote13.1">
         Gpt-4
        </span>
        configurations have very high
        <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="footnote13.2">
         GreedyFrac
        </span>
        but no suffix failures. Apparently, even a very small amount of exploration suffices for easy instances (and makes a big difference, relative to
        <span class="ltx_text ltx_font_smallcaps" id="footnote13.3">
         Greedy
        </span>
        ). However, this should not be construed as evidence for the more general and robust exploratory behavior necessary for harder bandit instances.
       </span>
      </span>
     </span>
     A plausible hypothesis from this is that
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.2.13">
      Gpt-4
     </span>
     performs quite well in low-noise settings, which is precisely when
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p2.2.14">
      Greedy
     </span>
     also performs well.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS4.p3">
    <p class="ltx_p" id="S3.SS4.p3.1">
     A stronger hypothesis would be that most
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p3.1.1">
      Gpt-4
     </span>
     configurations (except perhaps those using reinforced CoT) behave like
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p3.1.2">
      Greedy
     </span>
     on
     <em class="ltx_emph ltx_font_italic" id="S3.SS4.p3.1.3">
      all
     </em>
     instances, but this hypothesis is invalidated by the
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS4.p3.1.4">
      GreedyFrac
     </span>
     statistics for our experiments on the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p3.1.5">
      hard
     </span>
     instance.
On the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p3.1.6">
      hard
     </span>
     instance, it seems that most
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p3.1.7">
      Gpt-4
     </span>
     configurations are
doing something non-trivial (albeit flawed); their behavior is neither
completely
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p3.1.8">
      Greedy
     </span>
     -like nor like uniform-at-random.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS4.p4">
    <p class="ltx_p" id="S3.SS4.p4.6">
     Toward a more fine-grained understanding, we ran a collection of small-scale secondary experiments focusing on the
     <em class="ltx_emph ltx_font_italic" id="S3.SS4.p4.6.1">
      per-round decisions
     </em>
     of LLM-agents.
The experiments focus on a single round
     <math alttext="t" class="ltx_Math" display="inline" id="S3.SS4.p4.1.m1.1">
      <semantics id="S3.SS4.p4.1.m1.1a">
       <mi id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b">
        <ci id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">
        t
       </annotation>
      </semantics>
     </math>
     in a bandit problem. Each
experiment considers a particular “data source” (a distribution of
bandit histories), samples
     <math alttext="N=50" class="ltx_Math" display="inline" id="S3.SS4.p4.2.m2.1">
      <semantics id="S3.SS4.p4.2.m2.1a">
       <mrow id="S3.SS4.p4.2.m2.1.1" xref="S3.SS4.p4.2.m2.1.1.cmml">
        <mi id="S3.SS4.p4.2.m2.1.1.2" xref="S3.SS4.p4.2.m2.1.1.2.cmml">
         N
        </mi>
        <mo id="S3.SS4.p4.2.m2.1.1.1" xref="S3.SS4.p4.2.m2.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS4.p4.2.m2.1.1.3" xref="S3.SS4.p4.2.m2.1.1.3.cmml">
         50
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.1b">
        <apply id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1">
         <eq id="S3.SS4.p4.2.m2.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1.1">
         </eq>
         <ci id="S3.SS4.p4.2.m2.1.1.2.cmml" xref="S3.SS4.p4.2.m2.1.1.2">
          𝑁
         </ci>
         <cn id="S3.SS4.p4.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.p4.2.m2.1.1.3">
          50
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">
        N=50
       </annotation>
      </semantics>
     </math>
     bandit histories of length
     <math alttext="t" class="ltx_Math" display="inline" id="S3.SS4.p4.3.m3.1">
      <semantics id="S3.SS4.p4.3.m3.1a">
       <mi id="S3.SS4.p4.3.m3.1.1" xref="S3.SS4.p4.3.m3.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m3.1b">
        <ci id="S3.SS4.p4.3.m3.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p4.3.m3.1c">
        t
       </annotation>
      </semantics>
     </math>
     from this
distribution, and presents them to the agents (the LLMs and the
baselines) and asks them to output an arm or distribution over
arms. We track two statistics for each agent:
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS4.p4.6.2">
      GreedyFrac
     </span>
     and
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS4.p4.6.3">
      LeastFrac
     </span>
     , the fraction of replicates in which the agent chose,
resp., an empirically best arm so far and a least-chosen arm so
far. We vary the data source, i.e., the algorithm which generates the
history. In particular, we consider histories generated by sampling
uniformly at random (
     <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p4.6.4">
      Unif
     </span>
     ) and by running our baselines
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p4.6.5">
      UCB
     </span>
     and
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p4.6.6">
      TS
     </span>
     for
     <math alttext="t" class="ltx_Math" display="inline" id="S3.SS4.p4.6.m6.1">
      <semantics id="S3.SS4.p4.6.m6.1a">
       <mi id="S3.SS4.p4.6.m6.1.1" xref="S3.SS4.p4.6.m6.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p4.6.m6.1b">
        <ci id="S3.SS4.p4.6.m6.1.1.cmml" xref="S3.SS4.p4.6.m6.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p4.6.m6.1c">
        t
       </annotation>
      </semantics>
     </math>
     rounds.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS4.p5">
    <p class="ltx_p" id="S3.SS4.p5.1">
     Results are summarized in
     <a class="ltx_ref" href="#S3.F10" title="In 3.4 Root causes ‣ 3 Experimental results ‣ Can large language models explore in-context?">
      <span class="ltx_text ltx_ref_tag">
       Figure
      </span>
      <span class="ltx_text ltx_ref_tag">
       10
      </span>
     </a>
     . Unfortunately, we
find that per-round performance of both the LLMs and the baselines is very
sensitive to the particular data source. For example, the
     <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S3.SS4.p5.1.1">
      MinFrac
     </span>
     statistic of
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p5.1.2">
      UCB
     </span>
     can vary from as high as 0.46 on histories generated
uniformly at random to as low as 0.09 on histories generated by
     <span class="ltx_text ltx_font_smallcaps" id="S3.SS4.p5.1.3">
      UCB
     </span>
     itself. It seems plausible to conclude the BNSN0 is too greedy while
BSRN0 is too uniform, but the statistics for the other two LLM
configurations (BNRN0 and BNRC0)—both of which fail in our
longitudinal experiments—fall within the reasonable range provided
by the baselines. Thus, we find that it is challenging to assess whether
LLM agents are too greedy or too uniform-like based on per-round
decisions, even though these agents behave rather differently from the
baselines in the longitudinal experiments.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   Related work
  </h2>
  <div class="ltx_para" id="S4.p1">
   <p class="ltx_p" id="S4.p1.1">
    This paper belongs to a recent body of work that aims to understand the capabilities of LLMs, i.e., what they can and cannot do well, and why.
Capabilities that have received considerable attention, but are peripheral to the present paper, include general intelligence
    <cite class="ltx_cite ltx_citemacro_citep">
     (Bubeck et al.,
     <a class="ltx_ref" href="#bib.bib16" title="">
      2023
     </a>
     )
    </cite>
    , causal
    <cite class="ltx_cite ltx_citemacro_citep">
     (Kıcıman et al.,
     <a class="ltx_ref" href="#bib.bib33" title="">
      2023
     </a>
     ; Yiu et al.,
     <a class="ltx_ref" href="#bib.bib71" title="">
      2023
     </a>
     )
    </cite>
    and mathematical reasoning
    <cite class="ltx_cite ltx_citemacro_citep">
     (Cobbe et al.,
     <a class="ltx_ref" href="#bib.bib18" title="">
      2021
     </a>
     ; Lu et al.,
     <a class="ltx_ref" href="#bib.bib43" title="">
      2023
     </a>
     )
    </cite>
    , planning
    <cite class="ltx_cite ltx_citemacro_citep">
     (Valmeekam et al.,
     <a class="ltx_ref" href="#bib.bib60" title="">
      2023
     </a>
     ; Momennejad et al.,
     <a class="ltx_ref" href="#bib.bib45" title="">
      2023
     </a>
     ; Brooks et al.,
     <a class="ltx_ref" href="#bib.bib13" title="">
      2023
     </a>
     )
    </cite>
    , and compositionality
    <cite class="ltx_cite ltx_citemacro_citep">
     (Yu et al.,
     <a class="ltx_ref" href="#bib.bib72" title="">
      2023
     </a>
     )
    </cite>
    .
   </p>
  </div>
  <div class="ltx_para" id="S4.p2">
   <p class="ltx_p" id="S4.p2.1">
    In more detail, our work contributes to the broader literature on capabilities of in-context learning.
Prior studies of in-context learning include theoretical
    <cite class="ltx_cite ltx_citemacro_citep">
     (Xie et al.,
     <a class="ltx_ref" href="#bib.bib68" title="">
      2021
     </a>
     ; Akyürek et al.,
     <a class="ltx_ref" href="#bib.bib7" title="">
      2022
     </a>
     ; Zhang et al.,
     <a class="ltx_ref" href="#bib.bib74" title="">
      2023b
     </a>
     ; Abernethy et al.,
     <a class="ltx_ref" href="#bib.bib1" title="">
      2023
     </a>
     ; Zhang et al.,
     <a class="ltx_ref" href="#bib.bib73" title="">
      2023a
     </a>
     ; Han et al.,
     <a class="ltx_ref" href="#bib.bib26" title="">
      2023a
     </a>
     ; Cheng et al.,
     <a class="ltx_ref" href="#bib.bib17" title="">
      2023
     </a>
     ; Ahn et al.,
     <a class="ltx_ref" href="#bib.bib4" title="">
      2023
     </a>
     ; Wies et al.,
     <a class="ltx_ref" href="#bib.bib65" title="">
      2023
     </a>
     ; Fu et al.,
     <a class="ltx_ref" href="#bib.bib21" title="">
      2023
     </a>
     ; Wu et al.,
     <a class="ltx_ref" href="#bib.bib66" title="">
      2023
     </a>
     ; Huang et al.,
     <a class="ltx_ref" href="#bib.bib30" title="">
      2023
     </a>
     ; Hendel et al.,
     <a class="ltx_ref" href="#bib.bib28" title="">
      2023
     </a>
     ; Li et al.,
     <a class="ltx_ref" href="#bib.bib40" title="">
      2023
     </a>
     ; Von Oswald et al.,
     <a class="ltx_ref" href="#bib.bib61" title="">
      2023
     </a>
     ; Bai et al.,
     <a class="ltx_ref" href="#bib.bib10" title="">
      2023
     </a>
     ; Hahn and Goyal,
     <a class="ltx_ref" href="#bib.bib25" title="">
      2023
     </a>
     ; Jeon et al.,
     <a class="ltx_ref" href="#bib.bib31" title="">
      2024
     </a>
     )
    </cite>
    and empirical
    <cite class="ltx_cite ltx_citemacro_citep">
     (Garg et al.,
     <a class="ltx_ref" href="#bib.bib23" title="">
      2022
     </a>
     ; Kirsch et al.,
     <a class="ltx_ref" href="#bib.bib34" title="">
      2022
     </a>
     ; Ahuja et al.,
     <a class="ltx_ref" href="#bib.bib6" title="">
      2023
     </a>
     ; Han et al.,
     <a class="ltx_ref" href="#bib.bib27" title="">
      2023b
     </a>
     ; Raventós et al.,
     <a class="ltx_ref" href="#bib.bib49" title="">
      2023
     </a>
     ; Weber et al.,
     <a class="ltx_ref" href="#bib.bib63" title="">
      2023
     </a>
     ; Bhattamishra et al.,
     <a class="ltx_ref" href="#bib.bib12" title="">
      2023
     </a>
     ; Guo et al.,
     <a class="ltx_ref" href="#bib.bib24" title="">
      2023
     </a>
     ; Shen et al.,
     <a class="ltx_ref" href="#bib.bib52" title="">
      2023
     </a>
     ; Akyürek et al.,
     <a class="ltx_ref" href="#bib.bib8" title="">
      2024
     </a>
     )
    </cite>
    investigations, though as
mentioned in the prequel, the vast majority of this work pertains to in-context
supervised learning; in-context reinforcement learning has received far less attention. The small collection of empirical
works that study in-context RL
    <cite class="ltx_cite ltx_citemacro_citep">
     (Laskin et al.,
     <a class="ltx_ref" href="#bib.bib36" title="">
      2022
     </a>
     ; Lee et al.,
     <a class="ltx_ref" href="#bib.bib38" title="">
      2023a
     </a>
     ; Raparthy et al.,
     <a class="ltx_ref" href="#bib.bib48" title="">
      2023
     </a>
     ; Xu et al.,
     <a class="ltx_ref" href="#bib.bib69" title="">
      2022
     </a>
     )
    </cite>
    focus on models trained from scratch using trajectory data collected
from another agent (either an RL algorithm or an
expert); theoretically,
    <cite class="ltx_cite ltx_citemacro_citet">
     Lee et al. (
     <a class="ltx_ref" href="#bib.bib38" title="">
      2023a
     </a>
     )
    </cite>
    and
later
    <cite class="ltx_cite ltx_citemacro_citet">
     Lin et al. (
     <a class="ltx_ref" href="#bib.bib41" title="">
      2023
     </a>
     )
    </cite>
    justify this approach with a Bayesian
meta-reinforcement learning perspective
    <cite class="ltx_cite ltx_citemacro_citep">
     (Simchowitz et al.,
     <a class="ltx_ref" href="#bib.bib54" title="">
      2021
     </a>
     )
    </cite>
    ,
and show that pre-trained transformers can implement classical
exploration strategies like Thompson sampling and upper confidence
bounds (UCB). However, these works require interventions to the
    <em class="ltx_emph ltx_font_italic" id="S4.p2.1.1">
     pre-training
    </em>
    phase of the language model, and do not study
whether existing LLMs exhibit exploration capabilities under standard
training conditions.
   </p>
  </div>
  <div class="ltx_para" id="S4.p3">
   <p class="ltx_p" id="S4.p3.1">
    In parallel, there is a rapidly growing line of work that applies LLMs to real-world decision-making applications. Beyond previously mentioned works
    <cite class="ltx_cite ltx_citemacro_citep">
     (Shinn et al.,
     <a class="ltx_ref" href="#bib.bib53" title="">
      2023
     </a>
     ; Wang et al.,
     <a class="ltx_ref" href="#bib.bib62" title="">
      2023
     </a>
     ; Lee et al.,
     <a class="ltx_ref" href="#bib.bib39" title="">
      2023b
     </a>
     )
    </cite>
    , which consider applications to gaming, programming, and medicine, highlights include
    <cite class="ltx_cite ltx_citemacro_citet">
     Park et al. (
     <a class="ltx_ref" href="#bib.bib47" title="">
      2023
     </a>
     )
    </cite>
    , who introduce generative agents which simulate human behavior in an open-world environment,
    <cite class="ltx_cite ltx_citemacro_citet">
     Ahn et al. (
     <a class="ltx_ref" href="#bib.bib5" title="">
      2022
     </a>
     ); Xu et al. (
     <a class="ltx_ref" href="#bib.bib70" title="">
      2023
     </a>
     )
    </cite>
    , who develop LLM-enabled robots.
   </p>
  </div>
  <div class="ltx_para" id="S4.p4">
   <p class="ltx_p" id="S4.p4.2">
    Concurrent work of
    <cite class="ltx_cite ltx_citemacro_citet">
     Wu et al. (
     <a class="ltx_ref" href="#bib.bib67" title="">
      2024
     </a>
     )
    </cite>
    studies LLM performance in a battery of tasks that aim to characterize “intelligent agents”, with two-armed bandits as a specific task of interest. Their bandit experiments differ in several key respects: They consider a very easy MAB instance (with
    <math alttext="2" class="ltx_Math" display="inline" id="S4.p4.1.m1.1">
     <semantics id="S4.p4.1.m1.1a">
      <mn id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml">
       2
      </mn>
      <annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b">
       <cn id="S4.p4.1.m1.1.1.cmml" type="integer" xref="S4.p4.1.m1.1.1">
        2
       </cn>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">
       2
      </annotation>
     </semantics>
    </math>
    arms and a gap
    <math alttext="\Delta=0.6" class="ltx_Math" display="inline" id="S4.p4.2.m2.1">
     <semantics id="S4.p4.2.m2.1a">
      <mrow id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml">
       <mi id="S4.p4.2.m2.1.1.2" mathvariant="normal" xref="S4.p4.2.m2.1.1.2.cmml">
        Δ
       </mi>
       <mo id="S4.p4.2.m2.1.1.1" xref="S4.p4.2.m2.1.1.1.cmml">
        =
       </mo>
       <mn id="S4.p4.2.m2.1.1.3" xref="S4.p4.2.m2.1.1.3.cmml">
        0.6
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b">
       <apply id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1">
        <eq id="S4.p4.2.m2.1.1.1.cmml" xref="S4.p4.2.m2.1.1.1">
        </eq>
        <ci id="S4.p4.2.m2.1.1.2.cmml" xref="S4.p4.2.m2.1.1.2">
         Δ
        </ci>
        <cn id="S4.p4.2.m2.1.1.3.cmml" type="float" xref="S4.p4.2.m2.1.1.3">
         0.6
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">
       \Delta=0.6
      </annotation>
     </semantics>
    </math>
    , which is much easier than both of our instances), focus on a single prompt design (similar to our basic prompt), and compare to human players rather than algorithmic benchmarks. These differences lead to very different experimental findings. In particular, they find that
    <span class="ltx_text ltx_font_smallcaps" id="S4.p4.2.1">
     Gpt-4
    </span>
    performs well on their simple MAB instance, converging very quickly to the best arm, while we find that
    <span class="ltx_text ltx_font_smallcaps" id="S4.p4.2.2">
     Gpt-4
    </span>
    with a similar prompt fails on a harder MAB instance. However, their finding is consistent with ours, as we also find that several configurations of
    <span class="ltx_text ltx_font_smallcaps" id="S4.p4.2.3">
     Gpt-4
    </span>
    do well on the
    <span class="ltx_text ltx_font_typewriter" id="S4.p4.2.4">
     easy
    </span>
    MAB instance. As we discuss in
    <a class="ltx_ref" href="#S3.SS4" title="3.4 Root causes ‣ 3 Experimental results ‣ Can large language models explore in-context?">
     <span class="ltx_text ltx_ref_tag">
      Section
     </span>
     <span class="ltx_text ltx_ref_tag">
      3.4
     </span>
    </a>
    , this instance is too simple to provide compelling evidence for principled exploratory behavior.
   </p>
  </div>
  <section class="ltx_subsection" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    Further background on multi-armed bandits
   </h3>
   <div class="ltx_para" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.1">
     Here, we provide additional background on the multi-armed bandit problem, and on the baseline algorithms used in this paper. Deeper discussion can be found in
     <cite class="ltx_cite ltx_citemacro_citet">
      Bubeck and Cesa-Bianchi (
      <a class="ltx_ref" href="#bib.bib15" title="">
       2012
      </a>
      ); Slivkins (
      <a class="ltx_ref" href="#bib.bib55" title="">
       2019
      </a>
      ); Lattimore and Szepesvári (
      <a class="ltx_ref" href="#bib.bib37" title="">
       2020
      </a>
      )
     </cite>
     .
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p2">
    <p class="ltx_p" id="S4.SS1.p2.5">
     The
     <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p2.5.1">
      UCB
     </span>
     algorithm
     <cite class="ltx_cite ltx_citemacro_citep">
      (Auer et al.,
      <a class="ltx_ref" href="#bib.bib9" title="">
       2002
      </a>
      )
     </cite>
     explores by assigning each arm
     <math alttext="a" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1">
      <semantics id="S4.SS1.p2.1.m1.1a">
       <mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">
        a
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b">
        <ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">
         𝑎
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">
        a
       </annotation>
      </semantics>
     </math>
     an
     <em class="ltx_emph ltx_font_italic" id="S4.SS1.p2.5.2">
      index
     </em>
     , defined as the average reward from the arm so far plus a
     <em class="ltx_emph ltx_font_italic" id="S4.SS1.p2.5.3">
      bonus
     </em>
     of the form
     <math alttext="\sqrt{C/n_{a}}" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1">
      <semantics id="S4.SS1.p2.2.m2.1a">
       <msqrt id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">
        <mrow id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">
         <mi id="S4.SS1.p2.2.m2.1.1.2.2" xref="S4.SS1.p2.2.m2.1.1.2.2.cmml">
          C
         </mi>
         <mo id="S4.SS1.p2.2.m2.1.1.2.1" xref="S4.SS1.p2.2.m2.1.1.2.1.cmml">
          /
         </mo>
         <msub id="S4.SS1.p2.2.m2.1.1.2.3" xref="S4.SS1.p2.2.m2.1.1.2.3.cmml">
          <mi id="S4.SS1.p2.2.m2.1.1.2.3.2" xref="S4.SS1.p2.2.m2.1.1.2.3.2.cmml">
           n
          </mi>
          <mi id="S4.SS1.p2.2.m2.1.1.2.3.3" xref="S4.SS1.p2.2.m2.1.1.2.3.3.cmml">
           a
          </mi>
         </msub>
        </mrow>
       </msqrt>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b">
        <apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">
         <root id="S4.SS1.p2.2.m2.1.1a.cmml" xref="S4.SS1.p2.2.m2.1.1">
         </root>
         <apply id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">
          <divide id="S4.SS1.p2.2.m2.1.1.2.1.cmml" xref="S4.SS1.p2.2.m2.1.1.2.1">
          </divide>
          <ci id="S4.SS1.p2.2.m2.1.1.2.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2.2">
           𝐶
          </ci>
          <apply id="S4.SS1.p2.2.m2.1.1.2.3.cmml" xref="S4.SS1.p2.2.m2.1.1.2.3">
           <csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.2.3.1.cmml" xref="S4.SS1.p2.2.m2.1.1.2.3">
            subscript
           </csymbol>
           <ci id="S4.SS1.p2.2.m2.1.1.2.3.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2.3.2">
            𝑛
           </ci>
           <ci id="S4.SS1.p2.2.m2.1.1.2.3.3.cmml" xref="S4.SS1.p2.2.m2.1.1.2.3.3">
            𝑎
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">
        \sqrt{C/n_{a}}
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="C=\Theta(\log T)" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1">
      <semantics id="S4.SS1.p2.3.m3.1a">
       <mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">
        <mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">
         C
        </mi>
        <mo id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">
         =
        </mo>
        <mrow id="S4.SS1.p2.3.m3.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.cmml">
         <mi id="S4.SS1.p2.3.m3.1.1.1.3" mathvariant="normal" xref="S4.SS1.p2.3.m3.1.1.1.3.cmml">
          Θ
         </mi>
         <mo id="S4.SS1.p2.3.m3.1.1.1.2" lspace="0em" rspace="0em" xref="S4.SS1.p2.3.m3.1.1.1.2.cmml">
          ​
         </mo>
         <mrow id="S4.SS1.p2.3.m3.1.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml">
          <mo id="S4.SS1.p2.3.m3.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml">
           (
          </mo>
          <mrow id="S4.SS1.p2.3.m3.1.1.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml">
           <mi id="S4.SS1.p2.3.m3.1.1.1.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.cmml">
            log
           </mi>
           <mo id="S4.SS1.p2.3.m3.1.1.1.1.1.1a" lspace="0.167em" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml">
            ⁡
           </mo>
           <mi id="S4.SS1.p2.3.m3.1.1.1.1.1.1.2" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.2.cmml">
            T
           </mi>
          </mrow>
          <mo id="S4.SS1.p2.3.m3.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b">
        <apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">
         <eq id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">
         </eq>
         <ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">
          𝐶
         </ci>
         <apply id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1">
          <times id="S4.SS1.p2.3.m3.1.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.1.2">
          </times>
          <ci id="S4.SS1.p2.3.m3.1.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.1.3">
           Θ
          </ci>
          <apply id="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1">
           <log id="S4.SS1.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.1">
           </log>
           <ci id="S4.SS1.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.2">
            𝑇
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">
        C=\Theta(\log T)
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="n_{a}" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1">
      <semantics id="S4.SS1.p2.4.m4.1a">
       <msub id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">
        <mi id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">
         n
        </mi>
        <mi id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml">
         a
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b">
        <apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">
          𝑛
         </ci>
         <ci id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3">
          𝑎
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">
        n_{a}
       </annotation>
      </semantics>
     </math>
     is the number of samples from the arm so far. In each round, it chooses an arm with the largest index. The bonus implements the principle of
     <em class="ltx_emph ltx_font_italic" id="S4.SS1.p2.5.4">
      optimism under uncertainty
     </em>
     . We use a version of
     <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p2.5.5">
      UCB
     </span>
     that sets
     <math alttext="C=1" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1">
      <semantics id="S4.SS1.p2.5.m5.1a">
       <mrow id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">
        <mi id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">
         C
        </mi>
        <mo id="S4.SS1.p2.5.m5.1.1.1" xref="S4.SS1.p2.5.m5.1.1.1.cmml">
         =
        </mo>
        <mn id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b">
        <apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">
         <eq id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1.1">
         </eq>
         <ci id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2">
          𝐶
         </ci>
         <cn id="S4.SS1.p2.5.m5.1.1.3.cmml" type="integer" xref="S4.SS1.p2.5.m5.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">
        C=1
       </annotation>
      </semantics>
     </math>
     (a heuristic), which has been observed to have a favorable empirical performance
     <cite class="ltx_cite ltx_citemacro_citep">
      (e.g.,  Slivkins et al.,
      <a class="ltx_ref" href="#bib.bib56" title="">
       2013
      </a>
      ; Ho et al.,
      <a class="ltx_ref" href="#bib.bib29" title="">
       2016
      </a>
      )
     </cite>
     .
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p3">
    <p class="ltx_p" id="S4.SS1.p3.1">
     Thompson Sampling
     <cite class="ltx_cite ltx_citemacro_citep">
      (Thompson,
      <a class="ltx_ref" href="#bib.bib58" title="">
       1933
      </a>
      ; Russo et al.,
      <a class="ltx_ref" href="#bib.bib50" title="">
       2018
      </a>
      , for a survey)
     </cite>
     proceeds as if the arms’ mean rewards were initially drawn from some Bayesian prior. In each round, it computes a Bayesian posterior given the history so far, draws a sample from the posterior, and chooses an arm with largest mean reward according to this sample (i.e., assuming the sample were the ground truth).
In our setting, the prior is essentially a parameter to the algorithm. We choose the prior that draws the mean reward of each arm independently and uniformly at random from the
     <math alttext="[0,1]" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.2">
      <semantics id="S4.SS1.p3.1.m1.2a">
       <mrow id="S4.SS1.p3.1.m1.2.3.2" xref="S4.SS1.p3.1.m1.2.3.1.cmml">
        <mo id="S4.SS1.p3.1.m1.2.3.2.1" stretchy="false" xref="S4.SS1.p3.1.m1.2.3.1.cmml">
         [
        </mo>
        <mn id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">
         0
        </mn>
        <mo id="S4.SS1.p3.1.m1.2.3.2.2" xref="S4.SS1.p3.1.m1.2.3.1.cmml">
         ,
        </mo>
        <mn id="S4.SS1.p3.1.m1.2.2" xref="S4.SS1.p3.1.m1.2.2.cmml">
         1
        </mn>
        <mo id="S4.SS1.p3.1.m1.2.3.2.3" stretchy="false" xref="S4.SS1.p3.1.m1.2.3.1.cmml">
         ]
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.2b">
        <interval closure="closed" id="S4.SS1.p3.1.m1.2.3.1.cmml" xref="S4.SS1.p3.1.m1.2.3.2">
         <cn id="S4.SS1.p3.1.m1.1.1.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1">
          0
         </cn>
         <cn id="S4.SS1.p3.1.m1.2.2.cmml" type="integer" xref="S4.SS1.p3.1.m1.2.2">
          1
         </cn>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.2c">
        [0,1]
       </annotation>
      </semantics>
     </math>
     interval. This is one standard choice, achieving near-optimal regret bounds, as well as good empirical performance
     <cite class="ltx_cite ltx_citemacro_citep">
      (Kaufmann et al.,
      <a class="ltx_ref" href="#bib.bib32" title="">
       2012
      </a>
      ; Agrawal and Goyal,
      <a class="ltx_ref" href="#bib.bib2" title="">
       2012
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib3" title="">
       2017
      </a>
      )
     </cite>
     . Each arm is updated independently as a Beta-Bernoulli conjugate prior. Further optimizing
     <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p3.1.1">
      UCB
     </span>
     and Thompson Sampling is non-essential to this paper, as they already perform quite well in our experiments.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p4">
    <p class="ltx_p" id="S4.SS1.p4.4">
     Provable guarantees for bandit algorithms are commonly expressed via
     <em class="ltx_emph ltx_font_italic" id="S4.SS1.p4.4.1">
      regret
     </em>
     : the difference in expected total reward of the best arm and the algorithm. Both baselines achieve regret
     <math alttext="O(\sqrt{KT\log T})" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1">
      <semantics id="S4.SS1.p4.1.m1.1a">
       <mrow id="S4.SS1.p4.1.m1.1.2" xref="S4.SS1.p4.1.m1.1.2.cmml">
        <mi id="S4.SS1.p4.1.m1.1.2.2" xref="S4.SS1.p4.1.m1.1.2.2.cmml">
         O
        </mi>
        <mo id="S4.SS1.p4.1.m1.1.2.1" lspace="0em" rspace="0em" xref="S4.SS1.p4.1.m1.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S4.SS1.p4.1.m1.1.2.3.2" xref="S4.SS1.p4.1.m1.1.1.cmml">
         <mo id="S4.SS1.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS1.p4.1.m1.1.1.cmml">
          (
         </mo>
         <msqrt id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">
          <mrow id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">
           <mi id="S4.SS1.p4.1.m1.1.1.2.2" xref="S4.SS1.p4.1.m1.1.1.2.2.cmml">
            K
           </mi>
           <mo id="S4.SS1.p4.1.m1.1.1.2.1" lspace="0em" rspace="0em" xref="S4.SS1.p4.1.m1.1.1.2.1.cmml">
            ​
           </mo>
           <mi id="S4.SS1.p4.1.m1.1.1.2.3" xref="S4.SS1.p4.1.m1.1.1.2.3.cmml">
            T
           </mi>
           <mo id="S4.SS1.p4.1.m1.1.1.2.1a" lspace="0.167em" rspace="0em" xref="S4.SS1.p4.1.m1.1.1.2.1.cmml">
            ​
           </mo>
           <mrow id="S4.SS1.p4.1.m1.1.1.2.4" xref="S4.SS1.p4.1.m1.1.1.2.4.cmml">
            <mi id="S4.SS1.p4.1.m1.1.1.2.4.1" xref="S4.SS1.p4.1.m1.1.1.2.4.1.cmml">
             log
            </mi>
            <mo id="S4.SS1.p4.1.m1.1.1.2.4a" lspace="0.167em" xref="S4.SS1.p4.1.m1.1.1.2.4.cmml">
             ⁡
            </mo>
            <mi id="S4.SS1.p4.1.m1.1.1.2.4.2" xref="S4.SS1.p4.1.m1.1.1.2.4.2.cmml">
             T
            </mi>
           </mrow>
          </mrow>
         </msqrt>
         <mo id="S4.SS1.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS1.p4.1.m1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b">
        <apply id="S4.SS1.p4.1.m1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.2">
         <times id="S4.SS1.p4.1.m1.1.2.1.cmml" xref="S4.SS1.p4.1.m1.1.2.1">
         </times>
         <ci id="S4.SS1.p4.1.m1.1.2.2.cmml" xref="S4.SS1.p4.1.m1.1.2.2">
          𝑂
         </ci>
         <apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.2.3.2">
          <root id="S4.SS1.p4.1.m1.1.1a.cmml" xref="S4.SS1.p4.1.m1.1.2.3.2">
          </root>
          <apply id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">
           <times id="S4.SS1.p4.1.m1.1.1.2.1.cmml" xref="S4.SS1.p4.1.m1.1.1.2.1">
           </times>
           <ci id="S4.SS1.p4.1.m1.1.1.2.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2.2">
            𝐾
           </ci>
           <ci id="S4.SS1.p4.1.m1.1.1.2.3.cmml" xref="S4.SS1.p4.1.m1.1.1.2.3">
            𝑇
           </ci>
           <apply id="S4.SS1.p4.1.m1.1.1.2.4.cmml" xref="S4.SS1.p4.1.m1.1.1.2.4">
            <log id="S4.SS1.p4.1.m1.1.1.2.4.1.cmml" xref="S4.SS1.p4.1.m1.1.1.2.4.1">
            </log>
            <ci id="S4.SS1.p4.1.m1.1.1.2.4.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2.4.2">
             𝑇
            </ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">
        O(\sqrt{KT\log T})
       </annotation>
      </semantics>
     </math>
     , which is nearly minimax optimal as a function of
     <math alttext="T" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1">
      <semantics id="S4.SS1.p4.2.m2.1a">
       <mi id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">
        T
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b">
        <ci id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">
         𝑇
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">
        T
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1">
      <semantics id="S4.SS1.p4.3.m3.1a">
       <mi id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b">
        <ci id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">
        K
       </annotation>
      </semantics>
     </math>
     . They also achieve a nearly instance-optimal regret rate, which scales as
     <math alttext="O\left(\nicefrac{{K}}{{\Delta}}\,\log T\right)" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.1">
      <semantics id="S4.SS1.p4.4.m4.1a">
       <mrow id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">
        <mi id="S4.SS1.p4.4.m4.1.1.3" xref="S4.SS1.p4.4.m4.1.1.3.cmml">
         O
        </mi>
        <mo id="S4.SS1.p4.4.m4.1.1.2" lspace="0em" rspace="0em" xref="S4.SS1.p4.4.m4.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S4.SS1.p4.4.m4.1.1.1.1" xref="S4.SS1.p4.4.m4.1.1.1.1.1.cmml">
         <mo id="S4.SS1.p4.4.m4.1.1.1.1.2" xref="S4.SS1.p4.4.m4.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S4.SS1.p4.4.m4.1.1.1.1.1" xref="S4.SS1.p4.4.m4.1.1.1.1.1.cmml">
          <mrow id="S4.SS1.p4.4.m4.1.1.1.1.1.2" xref="S4.SS1.p4.4.m4.1.1.1.1.1.2.cmml">
           <mpadded id="S4.SS1.p4.4.m4.1.1.1.1.1.2.2" voffset="0.3em" xref="S4.SS1.p4.4.m4.1.1.1.1.1.2.2.cmml">
            <mi id="S4.SS1.p4.4.m4.1.1.1.1.1.2.2a" mathsize="70%" xref="S4.SS1.p4.4.m4.1.1.1.1.1.2.2.cmml">
             K
            </mi>
           </mpadded>
           <mpadded id="S4.SS1.p4.4.m4.1.1.1.1.1.2.1" lspace="-0.1em" width="-0.15em" xref="S4.SS1.p4.4.m4.1.1.1.1.1.2.1.cmml">
            <mo id="S4.SS1.p4.4.m4.1.1.1.1.1.2.1a" stretchy="true" symmetric="true" xref="S4.SS1.p4.4.m4.1.1.1.1.1.2.1.cmml">
             /
            </mo>
           </mpadded>
           <mi id="S4.SS1.p4.4.m4.1.1.1.1.1.2.3" mathsize="70%" mathvariant="normal" xref="S4.SS1.p4.4.m4.1.1.1.1.1.2.3.cmml">
            Δ
           </mi>
          </mrow>
          <mo id="S4.SS1.p4.4.m4.1.1.1.1.1.1" lspace="0.167em" rspace="0em" xref="S4.SS1.p4.4.m4.1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mrow id="S4.SS1.p4.4.m4.1.1.1.1.1.3" xref="S4.SS1.p4.4.m4.1.1.1.1.1.3.cmml">
           <mi id="S4.SS1.p4.4.m4.1.1.1.1.1.3.1" xref="S4.SS1.p4.4.m4.1.1.1.1.1.3.1.cmml">
            log
           </mi>
           <mo id="S4.SS1.p4.4.m4.1.1.1.1.1.3a" lspace="0.167em" xref="S4.SS1.p4.4.m4.1.1.1.1.1.3.cmml">
            ⁡
           </mo>
           <mi id="S4.SS1.p4.4.m4.1.1.1.1.1.3.2" xref="S4.SS1.p4.4.m4.1.1.1.1.1.3.2.cmml">
            T
           </mi>
          </mrow>
         </mrow>
         <mo id="S4.SS1.p4.4.m4.1.1.1.1.3" xref="S4.SS1.p4.4.m4.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b">
        <apply id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">
         <times id="S4.SS1.p4.4.m4.1.1.2.cmml" xref="S4.SS1.p4.4.m4.1.1.2">
         </times>
         <ci id="S4.SS1.p4.4.m4.1.1.3.cmml" xref="S4.SS1.p4.4.m4.1.1.3">
          𝑂
         </ci>
         <apply id="S4.SS1.p4.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1">
          <times id="S4.SS1.p4.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1.1.1">
          </times>
          <apply id="S4.SS1.p4.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1.1.2">
           <divide id="S4.SS1.p4.4.m4.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1.1.2.1">
           </divide>
           <ci id="S4.SS1.p4.4.m4.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1.1.2.2">
            𝐾
           </ci>
           <ci id="S4.SS1.p4.4.m4.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1.1.2.3">
            Δ
           </ci>
          </apply>
          <apply id="S4.SS1.p4.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1.1.3">
           <log id="S4.SS1.p4.4.m4.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1.1.3.1">
           </log>
           <ci id="S4.SS1.p4.4.m4.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p4.4.m4.1.1.1.1.1.3.2">
            𝑇
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">
        O\left(\nicefrac{{K}}{{\Delta}}\,\log T\right)
       </annotation>
      </semantics>
     </math>
     for the instances we consider.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p5">
    <p class="ltx_p" id="S4.SS1.p5.4">
     The
     <math alttext="\epsilon" class="ltx_Math" display="inline" id="S4.SS1.p5.1.m1.1">
      <semantics id="S4.SS1.p5.1.m1.1a">
       <mi id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml">
        ϵ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b">
        <ci id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">
         italic-ϵ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">
        \epsilon
       </annotation>
      </semantics>
     </math>
     -
     <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p5.4.1">
      Greedy
     </span>
     algorithm (
     <a class="ltx_ref" href="#footnote8" title="Footnote 8 ‣ Baselines ‣ 2 Experimental setup ‣ Can large language models explore in-context?">
      Footnote
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        8
       </span>
      </span>
     </a>
     ) is fundamentally inefficient in that it does not adaptively steer its exploration toward better-performing arms. Accordingly, its regret rate scales as
     <math alttext="T^{2/3}" class="ltx_Math" display="inline" id="S4.SS1.p5.2.m2.1">
      <semantics id="S4.SS1.p5.2.m2.1a">
       <msup id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml">
        <mi id="S4.SS1.p5.2.m2.1.1.2" xref="S4.SS1.p5.2.m2.1.1.2.cmml">
         T
        </mi>
        <mrow id="S4.SS1.p5.2.m2.1.1.3" xref="S4.SS1.p5.2.m2.1.1.3.cmml">
         <mn id="S4.SS1.p5.2.m2.1.1.3.2" xref="S4.SS1.p5.2.m2.1.1.3.2.cmml">
          2
         </mn>
         <mo id="S4.SS1.p5.2.m2.1.1.3.1" xref="S4.SS1.p5.2.m2.1.1.3.1.cmml">
          /
         </mo>
         <mn id="S4.SS1.p5.2.m2.1.1.3.3" xref="S4.SS1.p5.2.m2.1.1.3.3.cmml">
          3
         </mn>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b">
        <apply id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS1.p5.2.m2.1.1.2.cmml" xref="S4.SS1.p5.2.m2.1.1.2">
          𝑇
         </ci>
         <apply id="S4.SS1.p5.2.m2.1.1.3.cmml" xref="S4.SS1.p5.2.m2.1.1.3">
          <divide id="S4.SS1.p5.2.m2.1.1.3.1.cmml" xref="S4.SS1.p5.2.m2.1.1.3.1">
          </divide>
          <cn id="S4.SS1.p5.2.m2.1.1.3.2.cmml" type="integer" xref="S4.SS1.p5.2.m2.1.1.3.2">
           2
          </cn>
          <cn id="S4.SS1.p5.2.m2.1.1.3.3.cmml" type="integer" xref="S4.SS1.p5.2.m2.1.1.3.3">
           3
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">
        T^{2/3}
       </annotation>
      </semantics>
     </math>
     (for an optimal setting of
     <math alttext="\epsilon\sim T^{-1/3}" class="ltx_Math" display="inline" id="S4.SS1.p5.3.m3.1">
      <semantics id="S4.SS1.p5.3.m3.1a">
       <mrow id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml">
        <mi id="S4.SS1.p5.3.m3.1.1.2" xref="S4.SS1.p5.3.m3.1.1.2.cmml">
         ϵ
        </mi>
        <mo id="S4.SS1.p5.3.m3.1.1.1" xref="S4.SS1.p5.3.m3.1.1.1.cmml">
         ∼
        </mo>
        <msup id="S4.SS1.p5.3.m3.1.1.3" xref="S4.SS1.p5.3.m3.1.1.3.cmml">
         <mi id="S4.SS1.p5.3.m3.1.1.3.2" xref="S4.SS1.p5.3.m3.1.1.3.2.cmml">
          T
         </mi>
         <mrow id="S4.SS1.p5.3.m3.1.1.3.3" xref="S4.SS1.p5.3.m3.1.1.3.3.cmml">
          <mo id="S4.SS1.p5.3.m3.1.1.3.3a" xref="S4.SS1.p5.3.m3.1.1.3.3.cmml">
           −
          </mo>
          <mrow id="S4.SS1.p5.3.m3.1.1.3.3.2" xref="S4.SS1.p5.3.m3.1.1.3.3.2.cmml">
           <mn id="S4.SS1.p5.3.m3.1.1.3.3.2.2" xref="S4.SS1.p5.3.m3.1.1.3.3.2.2.cmml">
            1
           </mn>
           <mo id="S4.SS1.p5.3.m3.1.1.3.3.2.1" xref="S4.SS1.p5.3.m3.1.1.3.3.2.1.cmml">
            /
           </mo>
           <mn id="S4.SS1.p5.3.m3.1.1.3.3.2.3" xref="S4.SS1.p5.3.m3.1.1.3.3.2.3.cmml">
            3
           </mn>
          </mrow>
         </mrow>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b">
        <apply id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1">
         <csymbol cd="latexml" id="S4.SS1.p5.3.m3.1.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1.1">
          similar-to
         </csymbol>
         <ci id="S4.SS1.p5.3.m3.1.1.2.cmml" xref="S4.SS1.p5.3.m3.1.1.2">
          italic-ϵ
         </ci>
         <apply id="S4.SS1.p5.3.m3.1.1.3.cmml" xref="S4.SS1.p5.3.m3.1.1.3">
          <csymbol cd="ambiguous" id="S4.SS1.p5.3.m3.1.1.3.1.cmml" xref="S4.SS1.p5.3.m3.1.1.3">
           superscript
          </csymbol>
          <ci id="S4.SS1.p5.3.m3.1.1.3.2.cmml" xref="S4.SS1.p5.3.m3.1.1.3.2">
           𝑇
          </ci>
          <apply id="S4.SS1.p5.3.m3.1.1.3.3.cmml" xref="S4.SS1.p5.3.m3.1.1.3.3">
           <minus id="S4.SS1.p5.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p5.3.m3.1.1.3.3">
           </minus>
           <apply id="S4.SS1.p5.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.p5.3.m3.1.1.3.3.2">
            <divide id="S4.SS1.p5.3.m3.1.1.3.3.2.1.cmml" xref="S4.SS1.p5.3.m3.1.1.3.3.2.1">
            </divide>
            <cn id="S4.SS1.p5.3.m3.1.1.3.3.2.2.cmml" type="integer" xref="S4.SS1.p5.3.m3.1.1.3.3.2.2">
             1
            </cn>
            <cn id="S4.SS1.p5.3.m3.1.1.3.3.2.3.cmml" type="integer" xref="S4.SS1.p5.3.m3.1.1.3.3.2.3">
             3
            </cn>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">
        \epsilon\sim T^{-1/3}
       </annotation>
      </semantics>
     </math>
     ). Fixing such
     <math alttext="\epsilon" class="ltx_Math" display="inline" id="S4.SS1.p5.4.m4.1">
      <semantics id="S4.SS1.p5.4.m4.1a">
       <mi id="S4.SS1.p5.4.m4.1.1" xref="S4.SS1.p5.4.m4.1.1.cmml">
        ϵ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p5.4.m4.1b">
        <ci id="S4.SS1.p5.4.m4.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1">
         italic-ϵ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p5.4.m4.1c">
        \epsilon
       </annotation>
      </semantics>
     </math>
     , regret does not improve for easier instances.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p6">
    <p class="ltx_p" id="S4.SS1.p6.6">
     The
     <span class="ltx_text ltx_font_smallcaps" id="S4.SS1.p6.6.1">
      Greedy
     </span>
     algorithm (
     <a class="ltx_ref" href="#footnote7" title="Footnote 7 ‣ Baselines ‣ 2 Experimental setup ‣ Can large language models explore in-context?">
      Footnote
      <span class="ltx_ref ltx_nolink">
       <span class="ltx_text ltx_ref_tag">
        7
       </span>
      </span>
     </a>
     ) does not explore at all, which causes suffix failures. This is obvious when the algorithm is initialized with a single sample (
     <math alttext="n=1" class="ltx_Math" display="inline" id="S4.SS1.p6.1.m1.1">
      <semantics id="S4.SS1.p6.1.m1.1a">
       <mrow id="S4.SS1.p6.1.m1.1.1" xref="S4.SS1.p6.1.m1.1.1.cmml">
        <mi id="S4.SS1.p6.1.m1.1.1.2" xref="S4.SS1.p6.1.m1.1.1.2.cmml">
         n
        </mi>
        <mo id="S4.SS1.p6.1.m1.1.1.1" xref="S4.SS1.p6.1.m1.1.1.1.cmml">
         =
        </mo>
        <mn id="S4.SS1.p6.1.m1.1.1.3" xref="S4.SS1.p6.1.m1.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p6.1.m1.1b">
        <apply id="S4.SS1.p6.1.m1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1">
         <eq id="S4.SS1.p6.1.m1.1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1.1">
         </eq>
         <ci id="S4.SS1.p6.1.m1.1.1.2.cmml" xref="S4.SS1.p6.1.m1.1.1.2">
          𝑛
         </ci>
         <cn id="S4.SS1.p6.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p6.1.m1.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p6.1.m1.1c">
        n=1
       </annotation>
      </semantics>
     </math>
     ) of each arm: a suffix failure happens when the good arm returns
     <math alttext="0" class="ltx_Math" display="inline" id="S4.SS1.p6.2.m2.1">
      <semantics id="S4.SS1.p6.2.m2.1a">
       <mn id="S4.SS1.p6.2.m2.1.1" xref="S4.SS1.p6.2.m2.1.1.cmml">
        0
       </mn>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p6.2.m2.1b">
        <cn id="S4.SS1.p6.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p6.2.m2.1.1">
         0
        </cn>
       </annotation-xml>
      </semantics>
     </math>
     , and one of the other arms returns
     <math alttext="1" class="ltx_Math" display="inline" id="S4.SS1.p6.3.m3.1">
      <semantics id="S4.SS1.p6.3.m3.1a">
       <mn id="S4.SS1.p6.3.m3.1.1" xref="S4.SS1.p6.3.m3.1.1.cmml">
        1
       </mn>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p6.3.m3.1b">
        <cn id="S4.SS1.p6.3.m3.1.1.cmml" type="integer" xref="S4.SS1.p6.3.m3.1.1">
         1
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p6.3.m3.1c">
        1
       </annotation>
      </semantics>
     </math>
     . However, suffix failures are not an artifact of small
     <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.p6.4.m4.1">
      <semantics id="S4.SS1.p6.4.m4.1a">
       <mi id="S4.SS1.p6.4.m4.1.1" xref="S4.SS1.p6.4.m4.1.1.cmml">
        n
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p6.4.m4.1b">
        <ci id="S4.SS1.p6.4.m4.1.1.cmml" xref="S4.SS1.p6.4.m4.1.1">
         𝑛
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p6.4.m4.1c">
        n
       </annotation>
      </semantics>
     </math>
     : they can happen for any
     <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.p6.5.m5.1">
      <semantics id="S4.SS1.p6.5.m5.1a">
       <mi id="S4.SS1.p6.5.m5.1.1" xref="S4.SS1.p6.5.m5.1.1.cmml">
        n
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p6.5.m5.1b">
        <ci id="S4.SS1.p6.5.m5.1.1.cmml" xref="S4.SS1.p6.5.m5.1.1">
         𝑛
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p6.5.m5.1c">
        n
       </annotation>
      </semantics>
     </math>
     , with probability that scales as
     <math alttext="\Omega(1/\sqrt{n})" class="ltx_Math" display="inline" id="S4.SS1.p6.6.m6.1">
      <semantics id="S4.SS1.p6.6.m6.1a">
       <mrow id="S4.SS1.p6.6.m6.1.1" xref="S4.SS1.p6.6.m6.1.1.cmml">
        <mi id="S4.SS1.p6.6.m6.1.1.3" mathvariant="normal" xref="S4.SS1.p6.6.m6.1.1.3.cmml">
         Ω
        </mi>
        <mo id="S4.SS1.p6.6.m6.1.1.2" lspace="0em" rspace="0em" xref="S4.SS1.p6.6.m6.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S4.SS1.p6.6.m6.1.1.1.1" xref="S4.SS1.p6.6.m6.1.1.1.1.1.cmml">
         <mo id="S4.SS1.p6.6.m6.1.1.1.1.2" stretchy="false" xref="S4.SS1.p6.6.m6.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S4.SS1.p6.6.m6.1.1.1.1.1" xref="S4.SS1.p6.6.m6.1.1.1.1.1.cmml">
          <mn id="S4.SS1.p6.6.m6.1.1.1.1.1.2" xref="S4.SS1.p6.6.m6.1.1.1.1.1.2.cmml">
           1
          </mn>
          <mo id="S4.SS1.p6.6.m6.1.1.1.1.1.1" xref="S4.SS1.p6.6.m6.1.1.1.1.1.1.cmml">
           /
          </mo>
          <msqrt id="S4.SS1.p6.6.m6.1.1.1.1.1.3" xref="S4.SS1.p6.6.m6.1.1.1.1.1.3.cmml">
           <mi id="S4.SS1.p6.6.m6.1.1.1.1.1.3.2" xref="S4.SS1.p6.6.m6.1.1.1.1.1.3.2.cmml">
            n
           </mi>
          </msqrt>
         </mrow>
         <mo id="S4.SS1.p6.6.m6.1.1.1.1.3" stretchy="false" xref="S4.SS1.p6.6.m6.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p6.6.m6.1b">
        <apply id="S4.SS1.p6.6.m6.1.1.cmml" xref="S4.SS1.p6.6.m6.1.1">
         <times id="S4.SS1.p6.6.m6.1.1.2.cmml" xref="S4.SS1.p6.6.m6.1.1.2">
         </times>
         <ci id="S4.SS1.p6.6.m6.1.1.3.cmml" xref="S4.SS1.p6.6.m6.1.1.3">
          Ω
         </ci>
         <apply id="S4.SS1.p6.6.m6.1.1.1.1.1.cmml" xref="S4.SS1.p6.6.m6.1.1.1.1">
          <divide id="S4.SS1.p6.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS1.p6.6.m6.1.1.1.1.1.1">
          </divide>
          <cn id="S4.SS1.p6.6.m6.1.1.1.1.1.2.cmml" type="integer" xref="S4.SS1.p6.6.m6.1.1.1.1.1.2">
           1
          </cn>
          <apply id="S4.SS1.p6.6.m6.1.1.1.1.1.3.cmml" xref="S4.SS1.p6.6.m6.1.1.1.1.1.3">
           <root id="S4.SS1.p6.6.m6.1.1.1.1.1.3a.cmml" xref="S4.SS1.p6.6.m6.1.1.1.1.1.3">
           </root>
           <ci id="S4.SS1.p6.6.m6.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p6.6.m6.1.1.1.1.1.3.2">
            𝑛
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p6.6.m6.1c">
        \Omega(1/\sqrt{n})
       </annotation>
      </semantics>
     </math>
     <cite class="ltx_cite ltx_citemacro_citep">
      (Banihashem et al.,
      <a class="ltx_ref" href="#bib.bib11" title="">
       2023
      </a>
      )
     </cite>
     .
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Discussion and open questions
  </h2>
  <div class="ltx_para" id="S5.p1">
   <p class="ltx_p" id="S5.p1.1">
    Our investigation suggests that contemporary LLMs do not
robustly engage in exploration required for very basic
statistical reinforcement learning and decision making problems, at least without further
intervention. In what follows, we identify several next steps to further evaluate this
hypothesis and search for interventions to mitigate this behavior.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S5.p2">
   <p class="ltx_p" id="S5.p2.3">
    <span class="ltx_text ltx_font_bold" id="S5.p2.3.1">
     Basic interventions and the need for methodological advancements.
    </span>
    In light of our negative results, the most obvious interventions one might consider include:
   </p>
   <ol class="ltx_enumerate" id="S5.I1">
    <li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      1.
     </span>
     <div class="ltx_para" id="S5.I1.i1.p1">
      <p class="ltx_p" id="S5.I1.i1.p1.1">
       <em class="ltx_emph ltx_font_italic" id="S5.I1.i1.p1.1.1">
        Experiment with other prompts.
       </em>
       As with many other settings
       <cite class="ltx_cite ltx_citemacro_citep">
        (Sclar et al.,
        <a class="ltx_ref" href="#bib.bib51" title="">
         2023
        </a>
        )
       </cite>
       , it is possible that small changes to our prompt template might improve performance. However, sensitivity to prompt design is already concerning.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      2.
     </span>
     <div class="ltx_para" id="S5.I1.i2.p1">
      <p class="ltx_p" id="S5.I1.i2.p1.1">
       <em class="ltx_emph ltx_font_italic" id="S5.I1.i2.p1.1.1">
        Experiment with few-shot prompting,
       </em>
       where the prompt contains examples of exploratory behavior, or use such examples to
       <em class="ltx_emph ltx_font_italic" id="S5.I1.i2.p1.1.2">
        fine-tune
       </em>
       the LLM.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      3.
     </span>
     <div class="ltx_para" id="S5.I1.i3.p1">
      <p class="ltx_p" id="S5.I1.i3.p1.1">
       <em class="ltx_emph ltx_font_italic" id="S5.I1.i3.p1.1.1">
        Train the LLM to use auxiliary tools,
       </em>
       such as a calculator for basic arithmetic or a “randomizer” to correctly sample from a distribution.
      </p>
     </div>
    </li>
   </ol>
   <p class="ltx_p" id="S5.p2.2">
    While these steps are quite natural, cost, access to models, and compute pose significant barriers to further study, particularly because of the need to employ long horizons
    <math alttext="T" class="ltx_Math" display="inline" id="S5.p2.1.m1.1">
     <semantics id="S5.p2.1.m1.1a">
      <mi id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml">
       T
      </mi>
      <annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b">
       <ci id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1">
        𝑇
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">
       T
      </annotation>
     </semantics>
    </math>
    and many replicates
    <math alttext="N" class="ltx_Math" display="inline" id="S5.p2.2.m2.1">
     <semantics id="S5.p2.2.m2.1a">
      <mi id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml">
       N
      </mi>
      <annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b">
       <ci id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1">
        𝑁
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">
       N
      </annotation>
     </semantics>
    </math>
    to obtain statistically meaningful results.
To this end, we believe that further methodological and/or statistical advancements to enable cost-effective diagnosis and understanding of LLM-agent behavior (e.g., our surrogate statistics) are essential.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S5.p3">
   <p class="ltx_p" id="S5.p3.1">
    <span class="ltx_text ltx_font_bold" id="S5.p3.1.1">
     Implications for complex decision making problems.
    </span>
    Our focus on simple multi-armed bandit problems provides a clean and controllable
experimental setup to study the exploratory behavior of LLMs and
potential algorithmic interventions. Exploration failures here suggest
that similar failures will also occur in more complex RL and decision making settings. On the other hand, caution must be exercised in developing mitigations, as solutions that succeed for the MAB setting may not generalize to more complex settings.
For example, while
    <span class="ltx_text ltx_font_smallcaps" id="S5.p3.1.2">
     Gpt-4
    </span>
    with summarized interaction history and reinforced CoT seems to successfully
explore in our MAB setting, it is not clear how one should externally summarize the history in settings with complex, high-dimensional observations such as contextual bandits (see
    <a class="ltx_ref" href="#footnote3" title="Footnote 3 ‣ 1 Introduction ‣ Can large language models explore in-context?">
     Footnote
     <span class="ltx_ref ltx_nolink">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </span>
    </a>
    ). Indeed, even for linear contextual bandits, the approach may not be applicable without a substantial algorithmic intervention (such as, e.g., a linear regression computed externally and included in the prompt)
and the many explicit modeling and algorithmic choices involved in such interventions.
We believe a deeper investigation of algorithmic interventions is essential to understand the extent to which LLMs can operate as decision making agents.
   </p>
  </div>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Abernethy et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Jacob Abernethy, Alekh Agarwal, Teodor V Marinov, and Manfred K Warmuth.
    </span>
    <span class="ltx_bibblock">
     A mechanism for sample-efficient in-context learning for sparse
retrieval tasks.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">
      arXiv:2305.17040
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Agrawal and Goyal (2012)
    </span>
    <span class="ltx_bibblock">
     Shipra Agrawal and Navin Goyal.
    </span>
    <span class="ltx_bibblock">
     Analysis of Thompson Sampling for the multi-armed bandit problem.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">
      Conference on Learning Theory
     </em>
     , 2012.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Agrawal and Goyal (2017)
    </span>
    <span class="ltx_bibblock">
     Shipra Agrawal and Navin Goyal.
    </span>
    <span class="ltx_bibblock">
     Near-optimal regret bounds for thompson sampling.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">
      Journal of the ACM
     </em>
     , 2017.
    </span>
    <span class="ltx_bibblock">
     Preliminary version in
     <em class="ltx_emph ltx_font_italic" id="bib.bib3.2.1">
      AISTATS 2013
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ahn et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Kwangjun Ahn, Xiang Cheng, Hadi Daneshmand, and Suvrit Sra.
    </span>
    <span class="ltx_bibblock">
     Transformers learn to implement preconditioned gradient descent for
in-context learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">
      arXiv:2306.00297
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ahn et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Michael Ahn, Anthony Brohan, Noah Brown, Yevgen Chebotar, Omar Cortes, Byron
David, Chelsea Finn, Chuyuan Fu, Keerthana Gopalakrishnan, Karol Hausman,
Daniel Herzon, Alexand Ho, Jasmine Hsu, Julian Ibarz, Brian Ichter, Alex
Irpan, Eric Jang, Rosario Jauregui Ruano, Kyle Jeffrey, Sally Jesmonth,
Nikhil J Joshi, Ryan Julian, Dmitry Kalashnikov, Yuheng Kuang, Kuang-Huei
Lee, Sergey Levine, Yao Lu, Linda Luu, Carolina Parada, Peter Pastor, Jornell
Quiambao, Kanishka Rao, Jarek Rettinghouse, Diego Reyes, Pierre Sermanet,
Nicolas Sievers, Clayton Tan, Alexander Toshev, Vincent Vanhoucke, Fei Xia,
Ted Xiao, Peng Xu, Sichun Xu, Mengyuan Yan, and Andy Zeng.
    </span>
    <span class="ltx_bibblock">
     Do as I can, not as I say: Grounding language in robotic
affordances.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">
      arXiv:2204.01691
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ahuja et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Kabir Ahuja, Madhur Panwar, and Navin Goyal.
    </span>
    <span class="ltx_bibblock">
     In-context learning through the bayesian prism.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">
      arXiv:2306.04891
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Akyürek et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Ekin Akyürek, Dale Schuurmans, Jacob Andreas, Tengyu Ma, and Denny Zhou.
    </span>
    <span class="ltx_bibblock">
     What learning algorithm is in-context learning? Investigations with
linear models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">
      arXiv:2211.15661
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Akyürek et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Ekin Akyürek, Bailin Wang, Yoon Kim, and Jacob Andreas.
    </span>
    <span class="ltx_bibblock">
     In-context language learning: Architectures and algorithms.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">
      arXiv:2401.12973
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Auer et al. (2002)
    </span>
    <span class="ltx_bibblock">
     Peter Auer, Nicolò Cesa-Bianchi, and Paul Fischer.
    </span>
    <span class="ltx_bibblock">
     Finite-time analysis of the multiarmed bandit problem.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">
      Machine Learning
     </em>
     , 2002.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bai et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Yu Bai, Fan Chen, Huan Wang, Caiming Xiong, and Song Mei.
    </span>
    <span class="ltx_bibblock">
     Transformers as statisticians: Provable in-context learning with
in-context algorithm selection.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">
      arXiv:2306.04637
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Banihashem et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Kiarash Banihashem, MohammadTaghi Hajiaghayi, Suho Shin, and Aleksandrs
Slivkins.
    </span>
    <span class="ltx_bibblock">
     Bandit social learning: Exploration under myopic behavior.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">
      arXiv:2302.07425
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bhattamishra et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Satwik Bhattamishra, Arkil Patel, Phil Blunsom, and Varun Kanade.
    </span>
    <span class="ltx_bibblock">
     Understanding in-context learning in transformers and LLMs by
learning to learn discrete functions.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">
      arXiv:2310.03016
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Brooks et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Ethan Brooks, Logan A Walls, Richard Lewis, and Satinder Singh.
    </span>
    <span class="ltx_bibblock">
     Large language models can implement policy iteration.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Brown et al. (2020)
    </span>
    <span class="ltx_bibblock">
     Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla
Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon
Child, Aditya Ramesh, Daniel Ziegler, Jeffrey Wu, Clemens Winter, Chris
Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess,
Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever,
and Dario Amodei.
    </span>
    <span class="ltx_bibblock">
     Language models are few-shot learners.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bubeck and Cesa-Bianchi (2012)
    </span>
    <span class="ltx_bibblock">
     Sébastien Bubeck and Nicolo Cesa-Bianchi.
    </span>
    <span class="ltx_bibblock">
     Regret Analysis of Stochastic and Nonstochastic Multi-armed Bandit
Problems.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">
      Foundations and Trends in Machine Learning
     </em>
     , 5(1):1–122, 2012.
    </span>
    <span class="ltx_bibblock">
     Published with
     <em class="ltx_emph ltx_font_italic" id="bib.bib15.2.1">
      Now Publishers
     </em>
     (Boston, MA, USA). Also
available at
     <span class="ltx_text ltx_font_typewriter" id="bib.bib15.3.2">
      https://arxiv.org/abs/1204.5721
     </span>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bubeck et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Sébastien Bubeck, Varun Chandrasekaran, Ronen Eldan, Johannes Gehrke, Eric
Horvitz, Ece Kamar, Peter Lee, Yin Tat Lee, Yuanzhi Li, Scott Lundberg,
Harsha Nori, Hamid Palangi, Marco Tulio Ribeiro, and Yi Zhang.
    </span>
    <span class="ltx_bibblock">
     Sparks of artificial general intelligence: Early experiments with
gpt-4.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">
      arXiv:2303.12712
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cheng et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Xiang Cheng, Yuxin Chen, and Suvrit Sra.
    </span>
    <span class="ltx_bibblock">
     Transformers implement functional gradient descent to learn
non-linear functions in context.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">
      arXiv:2312.06528
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cobbe et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Mark Chen, Heewoo Jun, Lukasz
Kaiser, Matthias Plappert, Jerry Tworek, Jacob Hilton, Reiichiro Nakano,
Christopher Hesse, and John Schulman.
    </span>
    <span class="ltx_bibblock">
     Training verifiers to solve math word problems.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">
      arXiv:2110.14168
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Dettmers and Zettlemoyer (2023)
    </span>
    <span class="ltx_bibblock">
     Tim Dettmers and Luke Zettlemoyer.
    </span>
    <span class="ltx_bibblock">
     The case for 4-bit precision: k-bit inference scaling laws.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">
      International Conference on Machine Learning
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Edwards et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Carl N Edwards, Aakanksha Naik, Tushar Khot, Martin D Burke, Heng Ji, and Tom
Hope.
    </span>
    <span class="ltx_bibblock">
     Synergpt: In-context learning for personalized drug synergy
prediction and drug design.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">
      arXiv:2307.11694
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Fu et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Deqing Fu, Tian-Qi Chen, Robin Jia, and Vatsal Sharan.
    </span>
    <span class="ltx_bibblock">
     Transformers learn higher-order optimization methods for in-context
learning: A study with linear models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">
      arXiv:2310.17086
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Gao et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Luyu Gao, Aman Madaan, Shuyan Zhou, Uri Alon, Pengfei Liu, Yiming Yang, Jamie
Callan, and Graham Neubig.
    </span>
    <span class="ltx_bibblock">
     Pal: Program-aided language models.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">
      International Conference on Machine Learning
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Garg et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Shivam Garg, Dimitris Tsipras, Percy S Liang, and Gregory Valiant.
    </span>
    <span class="ltx_bibblock">
     What can transformers learn in-context? a case study of simple
function classes.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Guo et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Tianyu Guo, Wei Hu, Song Mei, Huan Wang, Caiming Xiong, Silvio Savarese, and
Yu Bai.
    </span>
    <span class="ltx_bibblock">
     How do transformers learn in-context beyond simple functions? A
case study on learning with representations.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">
      arXiv:2310.10616
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hahn and Goyal (2023)
    </span>
    <span class="ltx_bibblock">
     Michael Hahn and Navin Goyal.
    </span>
    <span class="ltx_bibblock">
     A theory of emergent in-context learning as implicit structure
induction.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">
      arXiv:2303.07971
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Han et al. (2023a)
    </span>
    <span class="ltx_bibblock">
     Chi Han, Ziqi Wang, Han Zhao, and Heng Ji.
    </span>
    <span class="ltx_bibblock">
     Explaining emergent in-context learning as kernel regression.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">
      arXiv:2305.12766
     </em>
     , 2023a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Han et al. (2023b)
    </span>
    <span class="ltx_bibblock">
     Xiaochuang Han, Daniel Simig, Todor Mihaylov, Yulia Tsvetkov, Asli Celikyilmaz,
and Tianlu Wang.
    </span>
    <span class="ltx_bibblock">
     Understanding in-context learning via supportive pretraining data.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">
      arXiv:2306.15091
     </em>
     , 2023b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hendel et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Roee Hendel, Mor Geva, and Amir Globerson.
    </span>
    <span class="ltx_bibblock">
     In-context learning creates task vectors.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">
      arXiv:2310.15916
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ho et al. (2016)
    </span>
    <span class="ltx_bibblock">
     Chien-Ju Ho, Aleksandrs Slivkins, and Jennifer Wortman Vaughan.
    </span>
    <span class="ltx_bibblock">
     Adaptive contract design for crowdsourcing markets: Bandit algorithms
for repeated principal-agent problems.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">
      Journal of Artificial Intelligence Research
     </em>
     , 2016.
    </span>
    <span class="ltx_bibblock">
     Preliminary version in
     <em class="ltx_emph ltx_font_italic" id="bib.bib29.2.1">
      ACM EC 2014
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Huang et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Yu Huang, Yuan Cheng, and Yingbin Liang.
    </span>
    <span class="ltx_bibblock">
     In-context convergence of transformers.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">
      arXiv:2310.05249
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jeon et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Hong Jun Jeon, Jason D Lee, Qi Lei, and Benjamin Van Roy.
    </span>
    <span class="ltx_bibblock">
     An information-theoretic analysis of in-context learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">
      arXiv:2401.15530
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kaufmann et al. (2012)
    </span>
    <span class="ltx_bibblock">
     Emilie Kaufmann, Nathaniel Korda, and Rémi Munos.
    </span>
    <span class="ltx_bibblock">
     Thompson sampling: An asymptotically optimal finite-time analysis.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">
      International Conference on Algorithmic Learning Theory
     </em>
     ,
2012.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kıcıman et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Emre Kıcıman, Robert Ness, Amit Sharma, and Chenhao Tan.
    </span>
    <span class="ltx_bibblock">
     Causal reasoning and large language models: Opening a new frontier
for causality.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">
      arXiv:2305.00050
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kirsch et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Louis Kirsch, James Harrison, Jascha Sohl-Dickstein, and Luke Metz.
    </span>
    <span class="ltx_bibblock">
     General-purpose in-context learning by meta-learning transformers.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">
      arXiv:2212.04458
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kojima et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Takeshi Kojima, Shixiang Shane Gu, Machel Reid, Yutaka Matsuo, and Yusuke
Iwasawa.
    </span>
    <span class="ltx_bibblock">
     Large language models are zero-shot reasoners.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">
      Advances in neural information processing systems
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Laskin et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Michael Laskin, Luyu Wang, Junhyuk Oh, Emilio Parisotto, Stephen Spencer,
Richie Steigerwald, DJ Strouse, Steven Hansen, Angelos Filos, Ethan Brooks,
Maxime Gazeau, Himanshu Sahni, Satinder Singh, and Volodymyr Mnih.
    </span>
    <span class="ltx_bibblock">
     In-context reinforcement learning with algorithm distillation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">
      arXiv:2210.14215
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lattimore and Szepesvári (2020)
    </span>
    <span class="ltx_bibblock">
     Tor Lattimore and Csaba Szepesvári.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">
      Bandit Algorithms
     </em>
     .
    </span>
    <span class="ltx_bibblock">
     Cambridge University Press, 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lee et al. (2023a)
    </span>
    <span class="ltx_bibblock">
     Jonathan N Lee, Annie Xie, Aldo Pacchiano, Yash Chandak, Chelsea Finn, Ofir
Nachum, and Emma Brunskill.
    </span>
    <span class="ltx_bibblock">
     Supervised pretraining can learn in-context reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">
      arXiv:2306.14892
     </em>
     , 2023a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lee et al. (2023b)
    </span>
    <span class="ltx_bibblock">
     Peter Lee, Carey Goldberg, and Isaac Kohane.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">
      The AI revolution in medicine: GPT-4 and beyond
     </em>
     .
    </span>
    <span class="ltx_bibblock">
     Pearson, 2023b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib40">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Yingcong Li, Muhammed Emrullah Ildiz, Dimitris Papailiopoulos, and Samet Oymak.
    </span>
    <span class="ltx_bibblock">
     Transformers as algorithms: Generalization and stability in
in-context learning.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">
      International Conference on Machine Learning
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib41">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lin et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Licong Lin, Yu Bai, and Song Mei.
    </span>
    <span class="ltx_bibblock">
     Transformers as decision makers: Provable in-context reinforcement
learning via supervised pretraining.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">
      arXiv:2310.08566
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib42">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Liu et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Bingbin Liu, Jordan Ash, Surbhi Goel, Akshay Krishnamurthy, and Cyril Zhang.
    </span>
    <span class="ltx_bibblock">
     Exposing attention glitches with flip-flop language modeling.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib43">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lu et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Pan Lu, Hritik Bansal, Tony Xia, Jiacheng Liu, Chunyuan Li, Hannaneh
Hajishirzi, Hao Cheng, Kai-Wei Chang, Michel Galley, and Jianfeng Gao.
    </span>
    <span class="ltx_bibblock">
     Mathvista: Evaluating mathematical reasoning of foundation models in
visual contexts.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">
      arXiv:2310.02255
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib44">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Malach (2023)
    </span>
    <span class="ltx_bibblock">
     Eran Malach.
    </span>
    <span class="ltx_bibblock">
     Auto-regressive next-token predictors are universal learners.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">
      arXiv:2309.06979
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib45">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Momennejad et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Ida Momennejad, Hosein Hasanbeig, Felipe Vieira, Hiteshi Sharma, Robert Osazuwa
Ness, Nebojsa Jojic, Hamid Palangi, and Jonathan Larson.
    </span>
    <span class="ltx_bibblock">
     Evaluating cognitive maps and planning in large language models with
cogeval.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">
      arXiv:2309.15129
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib46">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     OpenAI (2023)
    </span>
    <span class="ltx_bibblock">
     OpenAI.
    </span>
    <span class="ltx_bibblock">
     Gpt-4 technical report.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">
      arXiv:2303.08774
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib47">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Park et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Joon Sung Park, Joseph O’Brien, Carrie Jun Cai, Meredith Ringel Morris, Percy
Liang, and Michael S Bernstein.
    </span>
    <span class="ltx_bibblock">
     Generative agents: Interactive simulacra of human behavior.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">
      Symposium on User Interface Software and Technology
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib48">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Raparthy et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Sharath Chandra Raparthy, Eric Hambro, Robert Kirk, Mikael Henaff, and Roberta
Raileanu.
    </span>
    <span class="ltx_bibblock">
     Generalization to new sequential decision making tasks with
in-context learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">
      arXiv:2312.03801
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib49">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Raventós et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Allan Raventós, Mansheej Paul, Feng Chen, and Surya Ganguli.
    </span>
    <span class="ltx_bibblock">
     Pretraining task diversity and the emergence of non-bayesian
in-context learning for regression.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">
      arXiv:2306.15063
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib50">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Russo et al. (2018)
    </span>
    <span class="ltx_bibblock">
     Daniel Russo, Benjamin Van Roy, Abbas Kazerouni, Ian Osband, and Zheng Wen.
    </span>
    <span class="ltx_bibblock">
     A tutorial on thompson sampling.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">
      Foundations and Trends in Machine Learning
     </em>
     , 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib51">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Sclar et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Melanie Sclar, Yejin Choi, Yulia Tsvetkov, and Alane Suhr.
    </span>
    <span class="ltx_bibblock">
     Quantifying language models’ sensitivity to spurious features in
prompt design or: How i learned to start worrying about prompt formatting.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">
      arXiv:2310.11324
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib52">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shen et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Lingfeng Shen, Aayush Mishra, and Daniel Khashabi.
    </span>
    <span class="ltx_bibblock">
     Do pretrained transformers really learn in-context by gradient
descent?
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">
      arXiv:2310.08540
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib53">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shinn et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Noah Shinn, Federico Cassano, Beck Labash, Ashwin Gopinath, Karthik Narasimhan,
and Shunyu Yao.
    </span>
    <span class="ltx_bibblock">
     Reflexion: Language agents with verbal reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">
      arXiv:2303.11366
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib54">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Simchowitz et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Max Simchowitz, Christopher Tosh, Akshay Krishnamurthy, Daniel J Hsu, Thodoris
Lykouris, Miro Dudik, and Robert E Schapire.
    </span>
    <span class="ltx_bibblock">
     Bayesian decision-making under misspecified priors with applications
to meta-learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib55">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Slivkins (2019)
    </span>
    <span class="ltx_bibblock">
     Aleksandrs Slivkins.
    </span>
    <span class="ltx_bibblock">
     Introduction to multi-armed bandits.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">
      Foundations and Trends in Machine Learning
     </em>
     , 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib56">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Slivkins et al. (2013)
    </span>
    <span class="ltx_bibblock">
     Aleksandrs Slivkins, Filip Radlinski, and Sreenivas Gollapudi.
    </span>
    <span class="ltx_bibblock">
     Ranked bandits in metric spaces: Learning optimally diverse rankings
over large document collections.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">
      Journal of Machine Learning Research
     </em>
     , 2013.
    </span>
    <span class="ltx_bibblock">
     Preliminary version in
     <span class="ltx_text ltx_font_italic" id="bib.bib56.2.1">
      ICML
     </span>
     , 2010.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib57">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Som et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Anirudh Som, Karan Sikka, Helen Gent, Ajay Divakaran, Andreas Kathol, and
Dimitra Vergyri.
    </span>
    <span class="ltx_bibblock">
     Demonstrations are all you need: Advancing offensive content
paraphrasing using in-context learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">
      arXiv:2310.10707
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib58">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Thompson (1933)
    </span>
    <span class="ltx_bibblock">
     William R. Thompson.
    </span>
    <span class="ltx_bibblock">
     On the likelihood that one unknown probability exceeds another in
view of the evidence of two samples.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">
      Biometrika
     </em>
     , 1933.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib59">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Touvron et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine
Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale,
Dan Bikel, Lukas Blecher, Cristian Canton Ferrer, Moya Chen, Guillem
Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller,
Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar
Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa,
Isabel Kloumann, Artem Korenev, Punit Singh Koura, Marie-Anne Lachaux,
Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier
Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew
Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan
Silva, Eric Michael Smith, Ranjan Subramanian, Xiaoqing Ellen Tan, Binh Tang,
Ross Taylor, Adina Williams, Jian Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan
Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aurelien
Rodriguez, Robert Stojnic, Sergey Edunov, and Thomas Scialom.
    </span>
    <span class="ltx_bibblock">
     Llama 2: Open foundation and fine-tuned chat models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">
      arXiv:2307.09288
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib60">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Valmeekam et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Karthik Valmeekam, Matthew Marquez, Alberto Olmo, Sarath Sreedharan, and
Subbarao Kambhampati.
    </span>
    <span class="ltx_bibblock">
     Planbench: An extensible benchmark for evaluating large language
models on planning and reasoning about change.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">
      Advances in Neural Information Processing Systems: Datasets
and Benchmarks Track
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib61">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Von Oswald et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Johannes Von Oswald, Eyvind Niklasson, Ettore Randazzo, João Sacramento,
Alexander Mordvintsev, Andrey Zhmoginov, and Max Vladymyrov.
    </span>
    <span class="ltx_bibblock">
     Transformers learn in-context by gradient descent.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">
      International Conference on Machine Learning
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib62">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Guanzhi Wang, Yuqi Xie, Yunfan Jiang, Ajay Mandlekar, Chaowei Xiao, Yuke Zhu,
Linxi Fan, and Anima Anandkumar.
    </span>
    <span class="ltx_bibblock">
     Voyager: An open-ended embodied agent with large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">
      arXiv:2305.16291
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib63">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Weber et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Lucas Weber, Elia Bruni, and Dieuwke Hupkes.
    </span>
    <span class="ltx_bibblock">
     The ICL consistency test.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">
      arXiv:2312.04945
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib64">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wei et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Fei Xia, Ed Chi, Quoc V
Le, and Denny Zhou.
    </span>
    <span class="ltx_bibblock">
     Chain-of-thought prompting elicits reasoning in large language
models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib65">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wies et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Noam Wies, Yoav Levine, and Amnon Shashua.
    </span>
    <span class="ltx_bibblock">
     The learnability of in-context learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">
      arXiv:2303.07895
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib66">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Jingfeng Wu, Difan Zou, Zixiang Chen, Vladimir Braverman, Quanquan Gu, and
Peter L Bartlett.
    </span>
    <span class="ltx_bibblock">
     How many pretraining tasks are needed for in-context learning of
linear regression?
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">
      arXiv:2310.08391
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib67">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Yue Wu, Xuan Tang, Tom Mitchell, and Yuanzhi Li.
    </span>
    <span class="ltx_bibblock">
     Smartplay: A benchmark for LLMs as intelligent agents.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">
      International Conference on Learning Representations
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib68">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Xie et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Sang Michael Xie, Aditi Raghunathan, Percy Liang, and Tengyu Ma.
    </span>
    <span class="ltx_bibblock">
     An explanation of in-context learning as implicit bayesian inference.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib68.1.1">
      arXiv:2111.02080
     </em>
     , 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib69">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Xu et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Mengdi Xu, Yikang Shen, Shun Zhang, Yuchen Lu, Ding Zhao, Joshua Tenenbaum, and
Chuang Gan.
    </span>
    <span class="ltx_bibblock">
     Prompting decision transformer for few-shot policy generalization.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib69.1.1">
      International Conference on Machine Learning
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib70">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Xu et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Mengdi Xu, Peide Huang, Wenhao Yu, Shiqi Liu, Xilun Zhang, Yaru Niu, Tingnan
Zhang, Fei Xia, Jie Tan, and Ding Zhao.
    </span>
    <span class="ltx_bibblock">
     Creative robot tool use with large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib70.1.1">
      arXiv:2310.13065
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib71">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yiu et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Eunice Yiu, Eliza Kosoy, and Alison Gopnik.
    </span>
    <span class="ltx_bibblock">
     Imitation versus innovation: What children can do that large language
and language-and-vision models cannot (yet)?
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib71.1.1">
      arXiv:2305.07666
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib72">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yu et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Dingli Yu, Simran Kaur, Arushi Gupta, Jonah Brown-Cohen, Anirudh Goyal, and
Sanjeev Arora.
    </span>
    <span class="ltx_bibblock">
     Skill-mix: A flexible and expandable family of evaluations for ai
models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib72.1.1">
      arXiv:2310.17567
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib73">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhang et al. (2023a)
    </span>
    <span class="ltx_bibblock">
     Ruiqi Zhang, Spencer Frei, and Peter L Bartlett.
    </span>
    <span class="ltx_bibblock">
     Trained transformers learn linear models in-context.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib73.1.1">
      arXiv:2306.09927
     </em>
     , 2023a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib74">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhang et al. (2023b)
    </span>
    <span class="ltx_bibblock">
     Yufeng Zhang, Fengzhuo Zhang, Zhuoran Yang, and Zhaoran Wang.
    </span>
    <span class="ltx_bibblock">
     What and how does in-context learning learn? bayesian model
averaging, parameterization, and generalization.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib74.1.1">
      arXiv:2305.19420
     </em>
     , 2023b.
    </span>
   </li>
  </ul>
 </section>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <section class="ltx_appendix" id="A1">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Prompt designs
  </h2>
  <figure class="ltx_figure" id="A1.F11">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="534" id="A1.F11.1.g1" src="/html/2403.15371/assets/prompt-large-Jan28.png" width="598"/>
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_figure">
     Figure 11:
    </span>
    Prompt designs with text in the buttons scenario, expanding on
    <a class="ltx_ref" href="#S2.F2" title="Figure 2 ‣ 2 Experimental setup ‣ Can large language models explore in-context?">
     Figure
     <span class="ltx_ref ltx_nolink">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </span>
    </a>
    .
   </figcaption>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
  <section class="ltx_subsection" id="A1.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.1
    </span>
    Prompt examples
   </h3>
   <div class="ltx_para" id="A1.SS1.p1">
    <p class="ltx_p" id="A1.SS1.p1.1">
     Let us present three full examples of our prompts. We remove the blank
lines for the sake of readability.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A1.SS1.p2">
    <p class="ltx_p" id="A1.SS1.p2.1">
     <span class="ltx_text ltx_font_bold" id="A1.SS1.p2.1.1">
      (a)
     </span>
     Our basic prompt design (i.e., BNRN, as temperature is specified elsewhere): the buttons scenario with neutral framing and raw histories, asking the LLM to return an action without chain-of-thought reasoning.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS1.p3">
    <blockquote class="ltx_quote" id="A1.SS1.p3.1">
     <p class="ltx_p" id="A1.SS1.p3.1.1">
      [SYSTEM] You are in a room with 5 buttons labeled blue, green, red, yellow, purple. Each button is associated with a Bernoulli distribution with a fixed but unknown mean; the means for the buttons could be different. For each button, when you press it, you will get a reward that is sampled from the button’s associated distribution. You have 10 time steps and, on each time step, you can choose any button and receive the reward. Your goal is to maximize the total reward over the 10 time steps.
     </p>
     <p class="ltx_p" id="A1.SS1.p3.1.2">
      At each time step, I will show you your past choices and rewards. Then you must make the next choice, which must be exactly one of blue, green, red, yellow, purple. You must provide your final answer immediately within the tags &lt;Answer&gt;COLOR&lt;/Answer&gt; where COLOR is one of blue, green, red, yellow, purple and with no text explanation.
     </p>
     <p class="ltx_p" id="A1.SS1.p3.1.3">
      [USER] So far you have played 2 times with the following choices and rewards:
     </p>
     <p class="ltx_p" id="A1.SS1.p3.1.4">
      blue button, reward 1
      <br class="ltx_break"/>
      green button, reward 0
     </p>
     <p class="ltx_p" id="A1.SS1.p3.1.5">
      Which button will you choose next? Remember, YOU MUST provide your final answer within the tags &lt;Answer&gt;COLOR&lt;/Answer&gt; where COLOR is one of blue, green, red, yellow, purple.
     </p>
    </blockquote>
   </div>
   <div class="ltx_para ltx_noindent" id="A1.SS1.p4">
    <p class="ltx_p" id="A1.SS1.p4.1">
     <span class="ltx_text ltx_font_bold" id="A1.SS1.p4.1.1">
      (b)
     </span>
     The adverts scenario with all the “advanced” modifications (i.e., ASSCD) : suggestive framing, summarized histories, asking the LLM to return a distribution over actions, and asking for a chain-of-thought reasoning.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS1.p5">
    <blockquote class="ltx_quote" id="A1.SS1.p5.1">
     <p class="ltx_p" id="A1.SS1.p5.1.1">
      [SYSTEM] You are recommendation engine that chooses advertisements to display to users when they visit your webpage. There are 5 advertisements you can choose from, named A, B, C, D, E. When a user visits the webpage you can choose an advertisement to display and you will observe whether the user clicks on the ad or not. You model this by assuming that each advertisement has a certain click rate and users click on advertisements with their corresponding rates.
     </p>
     <p class="ltx_p" id="A1.SS1.p5.1.2">
      You have a budget of 10 users to interact with and your goal is to maximize the total number of clicks during this process.
     </p>
     <p class="ltx_p" id="A1.SS1.p5.1.3">
      A good strategy to optimize for clicks in these situations requires balancing exploration and exploitation. You need to explore to try out all of the options and find those with high click rates, but you also have to exploit the information that you have to accumulate clicks.
     </p>
     <p class="ltx_p" id="A1.SS1.p5.1.4">
      When each user visits the webpage, I will show you a summary of the data you have collected so far.
     </p>
     <p class="ltx_p" id="A1.SS1.p5.1.5">
      Then you must choose which advertisement to display. You may output a distribution over the 5 choices formatted EXACTLY like “A:n1,B:n2,C:n3,D:n4,E:n5”.
     </p>
     <p class="ltx_p" id="A1.SS1.p5.1.6">
      Let’s think step by step to make sure we make a good choice. Then, you must provide your final answer within the tags &lt;Answer&gt;DIST&lt;/Answer&gt; where DIST is the distribution in the format specified above.
     </p>
     <p class="ltx_p" id="A1.SS1.p5.1.7">
      [USER] So far you have interacted with 2 users. Here is a summary of the data you have collected:
     </p>
     <p class="ltx_p" id="A1.SS1.p5.1.8">
      Advertisement A was shown to 1 users with an estimated click rate of 1.00
      <br class="ltx_break"/>
      Advertisement B was shown to 1 users with an estimated click rate of 0.00
      <br class="ltx_break"/>
      Advertisement C has not been shown
      <br class="ltx_break"/>
      Advertisement D has not been shown
      <br class="ltx_break"/>
      Advertisement E has not been shown
     </p>
     <p class="ltx_p" id="A1.SS1.p5.1.9">
      Which advertisement will you choose next? Remember, YOU MUST provide your final answer within the tags &lt;Answer&gt;DIST&lt;/Answer&gt; where DIST is formatted like “A:n1,B:n2,C:n3,D:n4,E:n5”.
     </p>
    </blockquote>
   </div>
   <div class="ltx_para ltx_noindent" id="A1.SS1.p6">
    <p class="ltx_p" id="A1.SS1.p6.1">
     <span class="ltx_text ltx_font_bold" id="A1.SS1.p6.1.1">
      (c)
     </span>
     The successful configuration for
     <span class="ltx_text ltx_font_smallcaps" id="A1.SS1.p6.1.2">
      Gpt-4
     </span>
     (i.e., BSS
     <math alttext="\widetilde{\text{C}}" class="ltx_Math" display="inline" id="A1.SS1.p6.1.m1.1">
      <semantics id="A1.SS1.p6.1.m1.1a">
       <mover accent="true" id="A1.SS1.p6.1.m1.1.1" xref="A1.SS1.p6.1.m1.1.1.cmml">
        <mtext id="A1.SS1.p6.1.m1.1.1.2" xref="A1.SS1.p6.1.m1.1.1.2a.cmml">
         C
        </mtext>
        <mo id="A1.SS1.p6.1.m1.1.1.1" xref="A1.SS1.p6.1.m1.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="A1.SS1.p6.1.m1.1b">
        <apply id="A1.SS1.p6.1.m1.1.1.cmml" xref="A1.SS1.p6.1.m1.1.1">
         <ci id="A1.SS1.p6.1.m1.1.1.1.cmml" xref="A1.SS1.p6.1.m1.1.1.1">
          ~
         </ci>
         <ci id="A1.SS1.p6.1.m1.1.1.2a.cmml" xref="A1.SS1.p6.1.m1.1.1.2">
          <mtext id="A1.SS1.p6.1.m1.1.1.2.cmml" xref="A1.SS1.p6.1.m1.1.1.2">
           C
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS1.p6.1.m1.1c">
        \widetilde{\text{C}}
       </annotation>
      </semantics>
     </math>
     , as temperature is specified elsewhere), which uses the buttons scenario, suggestive framing, summarized histories, and reinforced chain-of-thought reasoning.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS1.p7">
    <blockquote class="ltx_quote" id="A1.SS1.p7.1">
     <p class="ltx_p" id="A1.SS1.p7.1.1">
      [SYSTEM] You are a bandit algorithm in a room with 5 buttons labeled blue, green, red, yellow, purple.
Each button is associated with a Bernoulli distribution with a fixed but unknown mean; the means for the buttons could be different.
For each button, when you press it, you will get a reward that is sampled from the button’s associated distribution.
You have 10 time steps and, on each time step, you can choose any button and receive the reward.
Your goal is to maximize the total reward over the 10 time steps.
     </p>
     <p class="ltx_p" id="A1.SS1.p7.1.2">
      At each time step, I will show you a summary of your past choices and rewards. Then you must make the next choice, which must be exactly one of blue, green, red, yellow, purple. Let’s think step by step to make sure we make a good choice. You must provide your final answer within the tags &lt;Answer&gt;COLOR&lt;/Answer&gt; where COLOR is one of blue, green, red, yellow, purple.
     </p>
     <p class="ltx_p" id="A1.SS1.p7.1.3">
      [USER] So far you have played 2 times with your past choices and rewards summarized as follows:
      <br class="ltx_break"/>
      blue button: pressed 1 times with average reward 1.00
      <br class="ltx_break"/>
      green button: pressed 1 times with average reward 0.00
      <br class="ltx_break"/>
      red button: pressed 0 times
      <br class="ltx_break"/>
      yellow button: pressed 0 times
      <br class="ltx_break"/>
      purple button: pressed 0 times
     </p>
     <p class="ltx_p" id="A1.SS1.p7.1.4">
      Which button will you choose next? Remember, YOU MUST provide your final answer within the tags &lt;Answer&gt;COLOR&lt;/Answer&gt; where COLOR is one of blue, green, red, yellow, purple. Let’s think step by step to make sure we make a good choice.
     </p>
    </blockquote>
   </div>
   <div class="ltx_pagination ltx_role_newpage">
   </div>
  </section>
 </section>
 <section class="ltx_appendix" id="A2">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix B
   </span>
   Scatter plots and summary tables
  </h2>
  <figure class="ltx_figure" id="A2.F12">
   <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="322" id="A2.F12.g1" src="/html/2403.15371/assets/x10.png" width="461"/>
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_figure">
     Figure 12:
    </span>
    All
    <span class="ltx_text ltx_font_bold" id="A2.F12.13.1">
     scatter plots
    </span>
    for the main experiments (
    <math alttext="T=100" class="ltx_Math" display="inline" id="A2.F12.6.m1.1">
     <semantics id="A2.F12.6.m1.1b">
      <mrow id="A2.F12.6.m1.1.1" xref="A2.F12.6.m1.1.1.cmml">
       <mi id="A2.F12.6.m1.1.1.2" xref="A2.F12.6.m1.1.1.2.cmml">
        T
       </mi>
       <mo id="A2.F12.6.m1.1.1.1" xref="A2.F12.6.m1.1.1.1.cmml">
        =
       </mo>
       <mn id="A2.F12.6.m1.1.1.3" xref="A2.F12.6.m1.1.1.3.cmml">
        100
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.F12.6.m1.1c">
       <apply id="A2.F12.6.m1.1.1.cmml" xref="A2.F12.6.m1.1.1">
        <eq id="A2.F12.6.m1.1.1.1.cmml" xref="A2.F12.6.m1.1.1.1">
        </eq>
        <ci id="A2.F12.6.m1.1.1.2.cmml" xref="A2.F12.6.m1.1.1.2">
         𝑇
        </ci>
        <cn id="A2.F12.6.m1.1.1.3.cmml" type="integer" xref="A2.F12.6.m1.1.1.3">
         100
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.F12.6.m1.1d">
       T=100
      </annotation>
     </semantics>
    </math>
    ): suffix failures vs. uniform-like failures.
Specifically:
    <math alttext="\texttt{SuffFailFreq}(T/2)" class="ltx_Math" display="inline" id="A2.F12.7.m2.1">
     <semantics id="A2.F12.7.m2.1b">
      <mrow id="A2.F12.7.m2.1.1" xref="A2.F12.7.m2.1.1.cmml">
       <mtext class="ltx_mathvariant_monospace" id="A2.F12.7.m2.1.1.3" xref="A2.F12.7.m2.1.1.3a.cmml">
        SuffFailFreq
       </mtext>
       <mo id="A2.F12.7.m2.1.1.2" lspace="0em" rspace="0em" xref="A2.F12.7.m2.1.1.2.cmml">
        ​
       </mo>
       <mrow id="A2.F12.7.m2.1.1.1.1" xref="A2.F12.7.m2.1.1.1.1.1.cmml">
        <mo id="A2.F12.7.m2.1.1.1.1.2" stretchy="false" xref="A2.F12.7.m2.1.1.1.1.1.cmml">
         (
        </mo>
        <mrow id="A2.F12.7.m2.1.1.1.1.1" xref="A2.F12.7.m2.1.1.1.1.1.cmml">
         <mi id="A2.F12.7.m2.1.1.1.1.1.2" xref="A2.F12.7.m2.1.1.1.1.1.2.cmml">
          T
         </mi>
         <mo id="A2.F12.7.m2.1.1.1.1.1.1" xref="A2.F12.7.m2.1.1.1.1.1.1.cmml">
          /
         </mo>
         <mn id="A2.F12.7.m2.1.1.1.1.1.3" xref="A2.F12.7.m2.1.1.1.1.1.3.cmml">
          2
         </mn>
        </mrow>
        <mo id="A2.F12.7.m2.1.1.1.1.3" stretchy="false" xref="A2.F12.7.m2.1.1.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.F12.7.m2.1c">
       <apply id="A2.F12.7.m2.1.1.cmml" xref="A2.F12.7.m2.1.1">
        <times id="A2.F12.7.m2.1.1.2.cmml" xref="A2.F12.7.m2.1.1.2">
        </times>
        <ci id="A2.F12.7.m2.1.1.3a.cmml" xref="A2.F12.7.m2.1.1.3">
         <mtext class="ltx_mathvariant_monospace" id="A2.F12.7.m2.1.1.3.cmml" xref="A2.F12.7.m2.1.1.3">
          SuffFailFreq
         </mtext>
        </ci>
        <apply id="A2.F12.7.m2.1.1.1.1.1.cmml" xref="A2.F12.7.m2.1.1.1.1">
         <divide id="A2.F12.7.m2.1.1.1.1.1.1.cmml" xref="A2.F12.7.m2.1.1.1.1.1.1">
         </divide>
         <ci id="A2.F12.7.m2.1.1.1.1.1.2.cmml" xref="A2.F12.7.m2.1.1.1.1.1.2">
          𝑇
         </ci>
         <cn id="A2.F12.7.m2.1.1.1.1.1.3.cmml" type="integer" xref="A2.F12.7.m2.1.1.1.1.1.3">
          2
         </cn>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.F12.7.m2.1d">
       \texttt{SuffFailFreq}(T/2)
      </annotation>
     </semantics>
    </math>
    vs
    <math alttext="K\cdot\texttt{MinFrac}(T)" class="ltx_Math" display="inline" id="A2.F12.8.m3.1">
     <semantics id="A2.F12.8.m3.1b">
      <mrow id="A2.F12.8.m3.1.2" xref="A2.F12.8.m3.1.2.cmml">
       <mrow id="A2.F12.8.m3.1.2.2" xref="A2.F12.8.m3.1.2.2.cmml">
        <mi id="A2.F12.8.m3.1.2.2.2" xref="A2.F12.8.m3.1.2.2.2.cmml">
         K
        </mi>
        <mo id="A2.F12.8.m3.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="A2.F12.8.m3.1.2.2.1.cmml">
         ⋅
        </mo>
        <mtext class="ltx_mathvariant_monospace" id="A2.F12.8.m3.1.2.2.3" xref="A2.F12.8.m3.1.2.2.3a.cmml">
         MinFrac
        </mtext>
       </mrow>
       <mo id="A2.F12.8.m3.1.2.1" lspace="0em" rspace="0em" xref="A2.F12.8.m3.1.2.1.cmml">
        ​
       </mo>
       <mrow id="A2.F12.8.m3.1.2.3.2" xref="A2.F12.8.m3.1.2.cmml">
        <mo id="A2.F12.8.m3.1.2.3.2.1" stretchy="false" xref="A2.F12.8.m3.1.2.cmml">
         (
        </mo>
        <mi id="A2.F12.8.m3.1.1" xref="A2.F12.8.m3.1.1.cmml">
         T
        </mi>
        <mo id="A2.F12.8.m3.1.2.3.2.2" stretchy="false" xref="A2.F12.8.m3.1.2.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.F12.8.m3.1c">
       <apply id="A2.F12.8.m3.1.2.cmml" xref="A2.F12.8.m3.1.2">
        <times id="A2.F12.8.m3.1.2.1.cmml" xref="A2.F12.8.m3.1.2.1">
        </times>
        <apply id="A2.F12.8.m3.1.2.2.cmml" xref="A2.F12.8.m3.1.2.2">
         <ci id="A2.F12.8.m3.1.2.2.1.cmml" xref="A2.F12.8.m3.1.2.2.1">
          ⋅
         </ci>
         <ci id="A2.F12.8.m3.1.2.2.2.cmml" xref="A2.F12.8.m3.1.2.2.2">
          𝐾
         </ci>
         <ci id="A2.F12.8.m3.1.2.2.3a.cmml" xref="A2.F12.8.m3.1.2.2.3">
          <mtext class="ltx_mathvariant_monospace" id="A2.F12.8.m3.1.2.2.3.cmml" xref="A2.F12.8.m3.1.2.2.3">
           MinFrac
          </mtext>
         </ci>
        </apply>
        <ci id="A2.F12.8.m3.1.1.cmml" xref="A2.F12.8.m3.1.1">
         𝑇
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.F12.8.m3.1d">
       K\cdot\texttt{MinFrac}(T)
      </annotation>
     </semantics>
    </math>
    .
Each LLM/configuration pair maps to a dot on this plane. (However, some dots may be hidden by some others.)
We also plot
    <math alttext="\epsilon" class="ltx_Math" display="inline" id="A2.F12.9.m4.1">
     <semantics id="A2.F12.9.m4.1b">
      <mi id="A2.F12.9.m4.1.1" xref="A2.F12.9.m4.1.1.cmml">
       ϵ
      </mi>
      <annotation-xml encoding="MathML-Content" id="A2.F12.9.m4.1c">
       <ci id="A2.F12.9.m4.1.1.cmml" xref="A2.F12.9.m4.1.1">
        italic-ϵ
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.F12.9.m4.1d">
       \epsilon
      </annotation>
     </semantics>
    </math>
    -
    <span class="ltx_text ltx_font_smallcaps" id="A2.F12.14.2">
     Greedy
    </span>
    , tracing out the different tradeoffs obtained for different values of
    <math alttext="\epsilon" class="ltx_Math" display="inline" id="A2.F12.10.m5.1">
     <semantics id="A2.F12.10.m5.1b">
      <mi id="A2.F12.10.m5.1.1" xref="A2.F12.10.m5.1.1.cmml">
       ϵ
      </mi>
      <annotation-xml encoding="MathML-Content" id="A2.F12.10.m5.1c">
       <ci id="A2.F12.10.m5.1.1.cmml" xref="A2.F12.10.m5.1.1">
        italic-ϵ
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.F12.10.m5.1d">
       \epsilon
      </annotation>
     </semantics>
    </math>
    .
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A2.F13">
   <div class="ltx_flex_figure">
    <div class="ltx_flex_cell ltx_flex_size_1">
     <p class="ltx_p ltx_figure_panel" id="A2.F13.2">
      <span class="ltx_text ltx_font_bold" id="A2.F13.2.1">
       (a)
      </span>
      Hard MAB instance (
      <math alttext="\Delta=0.2" class="ltx_Math" display="inline" id="A2.F13.1.m1.1">
       <semantics id="A2.F13.1.m1.1a">
        <mrow id="A2.F13.1.m1.1.1" xref="A2.F13.1.m1.1.1.cmml">
         <mi id="A2.F13.1.m1.1.1.2" mathvariant="normal" xref="A2.F13.1.m1.1.1.2.cmml">
          Δ
         </mi>
         <mo id="A2.F13.1.m1.1.1.1" xref="A2.F13.1.m1.1.1.1.cmml">
          =
         </mo>
         <mn id="A2.F13.1.m1.1.1.3" xref="A2.F13.1.m1.1.1.3.cmml">
          0.2
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="A2.F13.1.m1.1b">
         <apply id="A2.F13.1.m1.1.1.cmml" xref="A2.F13.1.m1.1.1">
          <eq id="A2.F13.1.m1.1.1.1.cmml" xref="A2.F13.1.m1.1.1.1">
          </eq>
          <ci id="A2.F13.1.m1.1.1.2.cmml" xref="A2.F13.1.m1.1.1.2">
           Δ
          </ci>
          <cn id="A2.F13.1.m1.1.1.3.cmml" type="float" xref="A2.F13.1.m1.1.1.3">
           0.2
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A2.F13.1.m1.1c">
         \Delta=0.2
        </annotation>
       </semantics>
      </math>
      ), buttons scenario,
      <math alttext="N=10" class="ltx_Math" display="inline" id="A2.F13.2.m2.1">
       <semantics id="A2.F13.2.m2.1a">
        <mrow id="A2.F13.2.m2.1.1" xref="A2.F13.2.m2.1.1.cmml">
         <mi id="A2.F13.2.m2.1.1.2" xref="A2.F13.2.m2.1.1.2.cmml">
          N
         </mi>
         <mo id="A2.F13.2.m2.1.1.1" xref="A2.F13.2.m2.1.1.1.cmml">
          =
         </mo>
         <mn id="A2.F13.2.m2.1.1.3" xref="A2.F13.2.m2.1.1.3.cmml">
          10
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="A2.F13.2.m2.1b">
         <apply id="A2.F13.2.m2.1.1.cmml" xref="A2.F13.2.m2.1.1">
          <eq id="A2.F13.2.m2.1.1.1.cmml" xref="A2.F13.2.m2.1.1.1">
          </eq>
          <ci id="A2.F13.2.m2.1.1.2.cmml" xref="A2.F13.2.m2.1.1.2">
           𝑁
          </ci>
          <cn id="A2.F13.2.m2.1.1.3.cmml" type="integer" xref="A2.F13.2.m2.1.1.3">
           10
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A2.F13.2.m2.1c">
         N=10
        </annotation>
       </semantics>
      </math>
      replicates.
     </p>
    </div>
    <div class="ltx_flex_break">
    </div>
    <div class="ltx_flex_cell ltx_flex_size_1">
     <img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="115" id="A2.F13.g1" src="/html/2403.15371/assets/x11.png" width="461"/>
    </div>
    <div class="ltx_flex_break">
    </div>
    <div class="ltx_flex_cell ltx_flex_size_1">
     <p class="ltx_p ltx_figure_panel" id="A2.F13.4">
      <span class="ltx_text ltx_font_bold" id="A2.F13.4.1">
       (b)
      </span>
      Hard MAB instance (
      <math alttext="\Delta=0.2" class="ltx_Math" display="inline" id="A2.F13.3.m1.1">
       <semantics id="A2.F13.3.m1.1a">
        <mrow id="A2.F13.3.m1.1.1" xref="A2.F13.3.m1.1.1.cmml">
         <mi id="A2.F13.3.m1.1.1.2" mathvariant="normal" xref="A2.F13.3.m1.1.1.2.cmml">
          Δ
         </mi>
         <mo id="A2.F13.3.m1.1.1.1" xref="A2.F13.3.m1.1.1.1.cmml">
          =
         </mo>
         <mn id="A2.F13.3.m1.1.1.3" xref="A2.F13.3.m1.1.1.3.cmml">
          0.2
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="A2.F13.3.m1.1b">
         <apply id="A2.F13.3.m1.1.1.cmml" xref="A2.F13.3.m1.1.1">
          <eq id="A2.F13.3.m1.1.1.1.cmml" xref="A2.F13.3.m1.1.1.1">
          </eq>
          <ci id="A2.F13.3.m1.1.1.2.cmml" xref="A2.F13.3.m1.1.1.2">
           Δ
          </ci>
          <cn id="A2.F13.3.m1.1.1.3.cmml" type="float" xref="A2.F13.3.m1.1.1.3">
           0.2
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A2.F13.3.m1.1c">
         \Delta=0.2
        </annotation>
       </semantics>
      </math>
      ), advertisements scenario,
      <math alttext="N=3" class="ltx_Math" display="inline" id="A2.F13.4.m2.1">
       <semantics id="A2.F13.4.m2.1a">
        <mrow id="A2.F13.4.m2.1.1" xref="A2.F13.4.m2.1.1.cmml">
         <mi id="A2.F13.4.m2.1.1.2" xref="A2.F13.4.m2.1.1.2.cmml">
          N
         </mi>
         <mo id="A2.F13.4.m2.1.1.1" xref="A2.F13.4.m2.1.1.1.cmml">
          =
         </mo>
         <mn id="A2.F13.4.m2.1.1.3" xref="A2.F13.4.m2.1.1.3.cmml">
          3
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="A2.F13.4.m2.1b">
         <apply id="A2.F13.4.m2.1.1.cmml" xref="A2.F13.4.m2.1.1">
          <eq id="A2.F13.4.m2.1.1.1.cmml" xref="A2.F13.4.m2.1.1.1">
          </eq>
          <ci id="A2.F13.4.m2.1.1.2.cmml" xref="A2.F13.4.m2.1.1.2">
           𝑁
          </ci>
          <cn id="A2.F13.4.m2.1.1.3.cmml" type="integer" xref="A2.F13.4.m2.1.1.3">
           3
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A2.F13.4.m2.1c">
         N=3
        </annotation>
       </semantics>
      </math>
      replicates.
     </p>
    </div>
    <div class="ltx_flex_break">
    </div>
    <div class="ltx_flex_cell ltx_flex_size_1">
     <img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="115" id="A2.F13.g2" src="/html/2403.15371/assets/x12.png" width="461"/>
    </div>
    <div class="ltx_flex_break">
    </div>
    <div class="ltx_flex_cell ltx_flex_size_1">
     <p class="ltx_p ltx_figure_panel" id="A2.F13.6">
      <span class="ltx_text ltx_font_bold" id="A2.F13.6.1">
       (c)
      </span>
      Easy MAB instance (
      <math alttext="\Delta=0.5" class="ltx_Math" display="inline" id="A2.F13.5.m1.1">
       <semantics id="A2.F13.5.m1.1a">
        <mrow id="A2.F13.5.m1.1.1" xref="A2.F13.5.m1.1.1.cmml">
         <mi id="A2.F13.5.m1.1.1.2" mathvariant="normal" xref="A2.F13.5.m1.1.1.2.cmml">
          Δ
         </mi>
         <mo id="A2.F13.5.m1.1.1.1" xref="A2.F13.5.m1.1.1.1.cmml">
          =
         </mo>
         <mn id="A2.F13.5.m1.1.1.3" xref="A2.F13.5.m1.1.1.3.cmml">
          0.5
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="A2.F13.5.m1.1b">
         <apply id="A2.F13.5.m1.1.1.cmml" xref="A2.F13.5.m1.1.1">
          <eq id="A2.F13.5.m1.1.1.1.cmml" xref="A2.F13.5.m1.1.1.1">
          </eq>
          <ci id="A2.F13.5.m1.1.1.2.cmml" xref="A2.F13.5.m1.1.1.2">
           Δ
          </ci>
          <cn id="A2.F13.5.m1.1.1.3.cmml" type="float" xref="A2.F13.5.m1.1.1.3">
           0.5
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A2.F13.5.m1.1c">
         \Delta=0.5
        </annotation>
       </semantics>
      </math>
      ), buttons scenario,
      <math alttext="N=3" class="ltx_Math" display="inline" id="A2.F13.6.m2.1">
       <semantics id="A2.F13.6.m2.1a">
        <mrow id="A2.F13.6.m2.1.1" xref="A2.F13.6.m2.1.1.cmml">
         <mi id="A2.F13.6.m2.1.1.2" xref="A2.F13.6.m2.1.1.2.cmml">
          N
         </mi>
         <mo id="A2.F13.6.m2.1.1.1" xref="A2.F13.6.m2.1.1.1.cmml">
          =
         </mo>
         <mn id="A2.F13.6.m2.1.1.3" xref="A2.F13.6.m2.1.1.3.cmml">
          3
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="A2.F13.6.m2.1b">
         <apply id="A2.F13.6.m2.1.1.cmml" xref="A2.F13.6.m2.1.1">
          <eq id="A2.F13.6.m2.1.1.1.cmml" xref="A2.F13.6.m2.1.1.1">
          </eq>
          <ci id="A2.F13.6.m2.1.1.2.cmml" xref="A2.F13.6.m2.1.1.2">
           𝑁
          </ci>
          <cn id="A2.F13.6.m2.1.1.3.cmml" type="integer" xref="A2.F13.6.m2.1.1.3">
           3
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A2.F13.6.m2.1c">
         N=3
        </annotation>
       </semantics>
      </math>
      replicates.
     </p>
    </div>
    <div class="ltx_flex_break">
    </div>
    <div class="ltx_flex_cell ltx_flex_size_1">
     <img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="115" id="A2.F13.g3" src="/html/2403.15371/assets/x13.png" width="461"/>
    </div>
    <div class="ltx_flex_break">
    </div>
    <div class="ltx_flex_cell ltx_flex_size_1">
     <p class="ltx_p ltx_figure_panel" id="A2.F13.8">
      <span class="ltx_text ltx_font_bold" id="A2.F13.8.1">
       (d)
      </span>
      Easy MAB instance (
      <math alttext="\Delta=0.5" class="ltx_Math" display="inline" id="A2.F13.7.m1.1">
       <semantics id="A2.F13.7.m1.1a">
        <mrow id="A2.F13.7.m1.1.1" xref="A2.F13.7.m1.1.1.cmml">
         <mi id="A2.F13.7.m1.1.1.2" mathvariant="normal" xref="A2.F13.7.m1.1.1.2.cmml">
          Δ
         </mi>
         <mo id="A2.F13.7.m1.1.1.1" xref="A2.F13.7.m1.1.1.1.cmml">
          =
         </mo>
         <mn id="A2.F13.7.m1.1.1.3" xref="A2.F13.7.m1.1.1.3.cmml">
          0.5
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="A2.F13.7.m1.1b">
         <apply id="A2.F13.7.m1.1.1.cmml" xref="A2.F13.7.m1.1.1">
          <eq id="A2.F13.7.m1.1.1.1.cmml" xref="A2.F13.7.m1.1.1.1">
          </eq>
          <ci id="A2.F13.7.m1.1.1.2.cmml" xref="A2.F13.7.m1.1.1.2">
           Δ
          </ci>
          <cn id="A2.F13.7.m1.1.1.3.cmml" type="float" xref="A2.F13.7.m1.1.1.3">
           0.5
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A2.F13.7.m1.1c">
         \Delta=0.5
        </annotation>
       </semantics>
      </math>
      ), advertisements scenario,
      <math alttext="N=3" class="ltx_Math" display="inline" id="A2.F13.8.m2.1">
       <semantics id="A2.F13.8.m2.1a">
        <mrow id="A2.F13.8.m2.1.1" xref="A2.F13.8.m2.1.1.cmml">
         <mi id="A2.F13.8.m2.1.1.2" xref="A2.F13.8.m2.1.1.2.cmml">
          N
         </mi>
         <mo id="A2.F13.8.m2.1.1.1" xref="A2.F13.8.m2.1.1.1.cmml">
          =
         </mo>
         <mn id="A2.F13.8.m2.1.1.3" xref="A2.F13.8.m2.1.1.3.cmml">
          3
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="A2.F13.8.m2.1b">
         <apply id="A2.F13.8.m2.1.1.cmml" xref="A2.F13.8.m2.1.1">
          <eq id="A2.F13.8.m2.1.1.1.cmml" xref="A2.F13.8.m2.1.1.1">
          </eq>
          <ci id="A2.F13.8.m2.1.1.2.cmml" xref="A2.F13.8.m2.1.1.2">
           𝑁
          </ci>
          <cn id="A2.F13.8.m2.1.1.3.cmml" type="integer" xref="A2.F13.8.m2.1.1.3">
           3
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="A2.F13.8.m2.1c">
         N=3
        </annotation>
       </semantics>
      </math>
      replicates.
     </p>
    </div>
    <div class="ltx_flex_break">
    </div>
    <div class="ltx_flex_cell ltx_flex_size_1">
     <img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="115" id="A2.F13.g4" src="/html/2403.15371/assets/x14.png" width="461"/>
    </div>
   </div>
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_figure">
     Figure 13:
    </span>
    <span class="ltx_text ltx_font_smallcaps" id="A2.F13.13.1">
     Gpt-4
    </span>
    for
    <math alttext="T=100" class="ltx_Math" display="inline" id="A2.F13.10.m1.1">
     <semantics id="A2.F13.10.m1.1b">
      <mrow id="A2.F13.10.m1.1.1" xref="A2.F13.10.m1.1.1.cmml">
       <mi id="A2.F13.10.m1.1.1.2" xref="A2.F13.10.m1.1.1.2.cmml">
        T
       </mi>
       <mo id="A2.F13.10.m1.1.1.1" xref="A2.F13.10.m1.1.1.1.cmml">
        =
       </mo>
       <mn id="A2.F13.10.m1.1.1.3" xref="A2.F13.10.m1.1.1.3.cmml">
        100
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.F13.10.m1.1c">
       <apply id="A2.F13.10.m1.1.1.cmml" xref="A2.F13.10.m1.1.1">
        <eq id="A2.F13.10.m1.1.1.1.cmml" xref="A2.F13.10.m1.1.1.1">
        </eq>
        <ci id="A2.F13.10.m1.1.1.2.cmml" xref="A2.F13.10.m1.1.1.2">
         𝑇
        </ci>
        <cn id="A2.F13.10.m1.1.1.3.cmml" type="integer" xref="A2.F13.10.m1.1.1.3">
         100
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.F13.10.m1.1d">
       T=100
      </annotation>
     </semantics>
    </math>
    : the per-configuration
    <span class="ltx_text ltx_font_bold" id="A2.F13.14.2">
     summary tables
    </span>
    . The “fails” row indicates that all replicates completed successfully.
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A2.F14">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="576" id="A2.F14.g1" src="/html/2403.15371/assets/x15.png" width="461"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 14:
    </span>
    <span class="ltx_text ltx_font_smallcaps" id="A2.F14.5.1">
     Gpt-3.5
    </span>
    for
    <math alttext="T=100" class="ltx_Math" display="inline" id="A2.F14.2.m1.1">
     <semantics id="A2.F14.2.m1.1b">
      <mrow id="A2.F14.2.m1.1.1" xref="A2.F14.2.m1.1.1.cmml">
       <mi id="A2.F14.2.m1.1.1.2" xref="A2.F14.2.m1.1.1.2.cmml">
        T
       </mi>
       <mo id="A2.F14.2.m1.1.1.1" xref="A2.F14.2.m1.1.1.1.cmml">
        =
       </mo>
       <mn id="A2.F14.2.m1.1.1.3" xref="A2.F14.2.m1.1.1.3.cmml">
        100
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.F14.2.m1.1c">
       <apply id="A2.F14.2.m1.1.1.cmml" xref="A2.F14.2.m1.1.1">
        <eq id="A2.F14.2.m1.1.1.1.cmml" xref="A2.F14.2.m1.1.1.1">
        </eq>
        <ci id="A2.F14.2.m1.1.1.2.cmml" xref="A2.F14.2.m1.1.1.2">
         𝑇
        </ci>
        <cn id="A2.F14.2.m1.1.1.3.cmml" type="integer" xref="A2.F14.2.m1.1.1.3">
         100
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.F14.2.m1.1d">
       T=100
      </annotation>
     </semantics>
    </math>
    : the per-configuration
    <span class="ltx_text ltx_font_bold" id="A2.F14.6.2">
     summary table
    </span>
    .
The buttons scenario, hard MAB instance.
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A2.F15">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="576" id="A2.F15.g1" src="/html/2403.15371/assets/x16.png" width="461"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 15:
    </span>
    <span class="ltx_text ltx_font_smallcaps" id="A2.F15.5.1">
     Gpt-3.5
    </span>
    for
    <math alttext="T=100" class="ltx_Math" display="inline" id="A2.F15.2.m1.1">
     <semantics id="A2.F15.2.m1.1b">
      <mrow id="A2.F15.2.m1.1.1" xref="A2.F15.2.m1.1.1.cmml">
       <mi id="A2.F15.2.m1.1.1.2" xref="A2.F15.2.m1.1.1.2.cmml">
        T
       </mi>
       <mo id="A2.F15.2.m1.1.1.1" xref="A2.F15.2.m1.1.1.1.cmml">
        =
       </mo>
       <mn id="A2.F15.2.m1.1.1.3" xref="A2.F15.2.m1.1.1.3.cmml">
        100
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.F15.2.m1.1c">
       <apply id="A2.F15.2.m1.1.1.cmml" xref="A2.F15.2.m1.1.1">
        <eq id="A2.F15.2.m1.1.1.1.cmml" xref="A2.F15.2.m1.1.1.1">
        </eq>
        <ci id="A2.F15.2.m1.1.1.2.cmml" xref="A2.F15.2.m1.1.1.2">
         𝑇
        </ci>
        <cn id="A2.F15.2.m1.1.1.3.cmml" type="integer" xref="A2.F15.2.m1.1.1.3">
         100
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.F15.2.m1.1d">
       T=100
      </annotation>
     </semantics>
    </math>
    : the per-configuration
    <span class="ltx_text ltx_font_bold" id="A2.F15.6.2">
     summary table
    </span>
    .
The advertisements scenario, hard MAB instance.
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A2.F16">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="576" id="A2.F16.g1" src="/html/2403.15371/assets/x17.png" width="461"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 16:
    </span>
    <span class="ltx_text ltx_font_smallcaps" id="A2.F16.5.1">
     Gpt-3.5
    </span>
    for
    <math alttext="T=100" class="ltx_Math" display="inline" id="A2.F16.2.m1.1">
     <semantics id="A2.F16.2.m1.1b">
      <mrow id="A2.F16.2.m1.1.1" xref="A2.F16.2.m1.1.1.cmml">
       <mi id="A2.F16.2.m1.1.1.2" xref="A2.F16.2.m1.1.1.2.cmml">
        T
       </mi>
       <mo id="A2.F16.2.m1.1.1.1" xref="A2.F16.2.m1.1.1.1.cmml">
        =
       </mo>
       <mn id="A2.F16.2.m1.1.1.3" xref="A2.F16.2.m1.1.1.3.cmml">
        100
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.F16.2.m1.1c">
       <apply id="A2.F16.2.m1.1.1.cmml" xref="A2.F16.2.m1.1.1">
        <eq id="A2.F16.2.m1.1.1.1.cmml" xref="A2.F16.2.m1.1.1.1">
        </eq>
        <ci id="A2.F16.2.m1.1.1.2.cmml" xref="A2.F16.2.m1.1.1.2">
         𝑇
        </ci>
        <cn id="A2.F16.2.m1.1.1.3.cmml" type="integer" xref="A2.F16.2.m1.1.1.3">
         100
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.F16.2.m1.1d">
       T=100
      </annotation>
     </semantics>
    </math>
    : the per-configuration
    <span class="ltx_text ltx_font_bold" id="A2.F16.6.2">
     summary table
    </span>
    .
The buttons scenario, easy MAB instance.
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A2.F17">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="576" id="A2.F17.g1" src="/html/2403.15371/assets/x18.png" width="461"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 17:
    </span>
    <span class="ltx_text ltx_font_smallcaps" id="A2.F17.5.1">
     Gpt-3.5
    </span>
    for
    <math alttext="T=100" class="ltx_Math" display="inline" id="A2.F17.2.m1.1">
     <semantics id="A2.F17.2.m1.1b">
      <mrow id="A2.F17.2.m1.1.1" xref="A2.F17.2.m1.1.1.cmml">
       <mi id="A2.F17.2.m1.1.1.2" xref="A2.F17.2.m1.1.1.2.cmml">
        T
       </mi>
       <mo id="A2.F17.2.m1.1.1.1" xref="A2.F17.2.m1.1.1.1.cmml">
        =
       </mo>
       <mn id="A2.F17.2.m1.1.1.3" xref="A2.F17.2.m1.1.1.3.cmml">
        100
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.F17.2.m1.1c">
       <apply id="A2.F17.2.m1.1.1.cmml" xref="A2.F17.2.m1.1.1">
        <eq id="A2.F17.2.m1.1.1.1.cmml" xref="A2.F17.2.m1.1.1.1">
        </eq>
        <ci id="A2.F17.2.m1.1.1.2.cmml" xref="A2.F17.2.m1.1.1.2">
         𝑇
        </ci>
        <cn id="A2.F17.2.m1.1.1.3.cmml" type="integer" xref="A2.F17.2.m1.1.1.3">
         100
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.F17.2.m1.1d">
       T=100
      </annotation>
     </semantics>
    </math>
    : the per-configuration
    <span class="ltx_text ltx_font_bold" id="A2.F17.6.2">
     summary table
    </span>
    .
The adverts scenario, easy MAB instance.
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A2.F18">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="482" id="A2.F18.g1" src="/html/2403.15371/assets/x19.png" width="461"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 18:
    </span>
    <span class="ltx_text ltx_font_smallcaps" id="A2.F18.5.1">
     Llama2
    </span>
    for
    <math alttext="T=100" class="ltx_Math" display="inline" id="A2.F18.2.m1.1">
     <semantics id="A2.F18.2.m1.1b">
      <mrow id="A2.F18.2.m1.1.1" xref="A2.F18.2.m1.1.1.cmml">
       <mi id="A2.F18.2.m1.1.1.2" xref="A2.F18.2.m1.1.1.2.cmml">
        T
       </mi>
       <mo id="A2.F18.2.m1.1.1.1" xref="A2.F18.2.m1.1.1.1.cmml">
        =
       </mo>
       <mn id="A2.F18.2.m1.1.1.3" xref="A2.F18.2.m1.1.1.3.cmml">
        100
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.F18.2.m1.1c">
       <apply id="A2.F18.2.m1.1.1.cmml" xref="A2.F18.2.m1.1.1">
        <eq id="A2.F18.2.m1.1.1.1.cmml" xref="A2.F18.2.m1.1.1.1">
        </eq>
        <ci id="A2.F18.2.m1.1.1.2.cmml" xref="A2.F18.2.m1.1.1.2">
         𝑇
        </ci>
        <cn id="A2.F18.2.m1.1.1.3.cmml" type="integer" xref="A2.F18.2.m1.1.1.3">
         100
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.F18.2.m1.1d">
       T=100
      </annotation>
     </semantics>
    </math>
    : the per-configuration
    <span class="ltx_text ltx_font_bold" id="A2.F18.6.2">
     summary tables
    </span>
    .
The buttons scenario, hard MAB instance.
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="A2.F19">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="482" id="A2.F19.g1" src="/html/2403.15371/assets/x20.png" width="461"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 19:
    </span>
    <span class="ltx_text ltx_font_smallcaps" id="A2.F19.5.1">
     Llama2
    </span>
    for
    <math alttext="T=100" class="ltx_Math" display="inline" id="A2.F19.2.m1.1">
     <semantics id="A2.F19.2.m1.1b">
      <mrow id="A2.F19.2.m1.1.1" xref="A2.F19.2.m1.1.1.cmml">
       <mi id="A2.F19.2.m1.1.1.2" xref="A2.F19.2.m1.1.1.2.cmml">
        T
       </mi>
       <mo id="A2.F19.2.m1.1.1.1" xref="A2.F19.2.m1.1.1.1.cmml">
        =
       </mo>
       <mn id="A2.F19.2.m1.1.1.3" xref="A2.F19.2.m1.1.1.3.cmml">
        100
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.F19.2.m1.1c">
       <apply id="A2.F19.2.m1.1.1.cmml" xref="A2.F19.2.m1.1.1">
        <eq id="A2.F19.2.m1.1.1.1.cmml" xref="A2.F19.2.m1.1.1.1">
        </eq>
        <ci id="A2.F19.2.m1.1.1.2.cmml" xref="A2.F19.2.m1.1.1.2">
         𝑇
        </ci>
        <cn id="A2.F19.2.m1.1.1.3.cmml" type="integer" xref="A2.F19.2.m1.1.1.3">
         100
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.F19.2.m1.1d">
       T=100
      </annotation>
     </semantics>
    </math>
    : the per-configuration
    <span class="ltx_text ltx_font_bold" id="A2.F19.6.2">
     summary tables
    </span>
    .
The advertisements scenario, hard MAB instance.
   </figcaption>
  </figure>
 </section>
</article>
