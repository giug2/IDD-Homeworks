<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1902.07864] Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering</title><meta property="og:description" content="We propose a new class of probabilistic neural-symbolic models,
that have symbolic functional programs as a latent, stochastic variable.
Instantiated in the context of visual question answering, our probabilistic
formu…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1902.07864">

<!--Generated on Sat Mar 16 20:25:37 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Machine Learning,  ICML">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Probabilistic Neural-symbolic Models for 
<br class="ltx_break">Interpretable
Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ramakrishna Vedantam
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Karan Desai
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Stefan Lee
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Marcus Rohrbach
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dhruv Batra
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Devi Parikh
</span></span>
</div>

<h1 class="ltx_title ltx_title_document">Appendix</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ramakrishna Vedantam
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Karan Desai
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Stefan Lee
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Marcus Rohrbach
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dhruv Batra
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Devi Parikh
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p"><span id="id1.id1.1" class="ltx_text" style="color:#000000;">We propose a new class of probabilistic neural-symbolic models,
that have symbolic functional programs as a latent, stochastic variable.
Instantiated in the context of visual question answering, our probabilistic
formulation offers two key conceptual advantages over prior neural-symbolic models for VQA.
Firstly, the programs generated by our model are more understandable while requiring
less number of teaching examples. Secondly, we show that one can pose counterfactual
scenarios to the model, to probe its beliefs on the programs that could
lead to a specified answer given an image. Our results on the CLEVR and SHAPES
datasets verify our hypotheses, showing that the model gets better
program (and answer) prediction accuracy even in the low data regime, and
allows one to probe the coherence and consistency of reasoning performed.</span></p>
</div>
<div class="ltx_keywords">Machine Learning, ICML
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Building flexible learning and reasoning machines is a central challenge in
Artificial Intelligence (AI). Deep representation learning <cite class="ltx_cite ltx_citemacro_citep">(LeCun et al., <a href="#bib.bib27" title="" class="ltx_ref">2015</a>)</cite>
provides us powerful, flexible function approximations that
have resulted in state-of-the-art
performance across multiple AI tasks such as
recognition <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib24" title="" class="ltx_ref">2012</a>; He et al., <a href="#bib.bib14" title="" class="ltx_ref">2016</a>)</cite>,
machine translation <cite class="ltx_cite ltx_citemacro_citep">(Sutskever et al., <a href="#bib.bib41" title="" class="ltx_ref">2014</a>)</cite>, visual question
answering <cite class="ltx_cite ltx_citemacro_citep">(Agrawal et al., <a href="#bib.bib1" title="" class="ltx_ref">2015</a>)</cite>, speech modeling <cite class="ltx_cite ltx_citemacro_citep">(van den Oord et al., <a href="#bib.bib46" title="" class="ltx_ref">2016</a>)</cite>,
and reinforcement learning <cite class="ltx_cite ltx_citemacro_citep">(Mnih et al., <a href="#bib.bib33" title="" class="ltx_ref">2015</a>)</cite>.
However, many
aspects of human cognition such as systematic compositional
generalization
<span id="S1.p1.1.1" class="ltx_text" style="color:#000000;">(<em id="S1.p1.1.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, understanding that “John loves Mary” could
imply that “Mary loves John”)</span> <cite class="ltx_cite ltx_citemacro_citep">(Lake et al., <a href="#bib.bib26" title="" class="ltx_ref">2017</a>; Lake &amp; Baroni, <a href="#bib.bib25" title="" class="ltx_ref">2018</a>)</cite>
have proved harder to model.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Symbol manipulation <cite class="ltx_cite ltx_citemacro_citep">(Newell &amp; Simon, <a href="#bib.bib35" title="" class="ltx_ref">1976</a>)</cite>,
on the other hand lacks flexible
learning capabilities but supports
strong generalization and systematicity <cite class="ltx_cite ltx_citemacro_citep">(Lake &amp; Baroni, <a href="#bib.bib25" title="" class="ltx_ref">2018</a>)</cite>.
Consequently, many works have focused
on building neural-symbolic models with the aim of combining the best of
representation learning and symbolic reasoning
 <cite class="ltx_cite ltx_citemacro_citep">(Bader &amp; Hitzler, <a href="#bib.bib5" title="" class="ltx_ref">2005</a>; Evans et al., <a href="#bib.bib12" title="" class="ltx_ref">2018</a>; Valiant, <a href="#bib.bib44" title="" class="ltx_ref">2003</a>; Yi et al., <a href="#bib.bib52" title="" class="ltx_ref">2018</a>; Yin et al., <a href="#bib.bib53" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1902.07864/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="81" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S1.F1.22.1" class="ltx_text ltx_font_bold">Probabilistic Neural Symbolic Models for VQA:</span> We show our novel
probabilistic
neural-symbolic model (<span id="S1.F1.23.2" class="ltx_text ltx_font_bold">Prob-NMN</span>) in plate notation (right). Given image <math id="S1.F1.10.m1.1" class="ltx_Math" alttext="\mathbf{i}" display="inline"><semantics id="S1.F1.10.m1.1b"><mi id="S1.F1.10.m1.1.1" xref="S1.F1.10.m1.1.1.cmml">𝐢</mi><annotation-xml encoding="MathML-Content" id="S1.F1.10.m1.1c"><ci id="S1.F1.10.m1.1.1.cmml" xref="S1.F1.10.m1.1.1">𝐢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.10.m1.1d">\mathbf{i}</annotation></semantics></math>, programs
<math id="S1.F1.11.m2.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S1.F1.11.m2.1b"><mi id="S1.F1.11.m2.1.1" xref="S1.F1.11.m2.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S1.F1.11.m2.1c"><ci id="S1.F1.11.m2.1.1.cmml" xref="S1.F1.11.m2.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.11.m2.1d">\mathbf{z}</annotation></semantics></math> are a (partially observed) latent variable executed on the image to generate an answer <math id="S1.F1.12.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S1.F1.12.m3.1b"><mi id="S1.F1.12.m3.1.1" xref="S1.F1.12.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S1.F1.12.m3.1c"><ci id="S1.F1.12.m3.1.1.cmml" xref="S1.F1.12.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.12.m3.1d">a</annotation></semantics></math>
using parameters <math id="S1.F1.13.m4.1" class="ltx_Math" alttext="\theta_{\mathbf{z}}" display="inline"><semantics id="S1.F1.13.m4.1b"><msub id="S1.F1.13.m4.1.1" xref="S1.F1.13.m4.1.1.cmml"><mi id="S1.F1.13.m4.1.1.2" xref="S1.F1.13.m4.1.1.2.cmml">θ</mi><mi id="S1.F1.13.m4.1.1.3" xref="S1.F1.13.m4.1.1.3.cmml">𝐳</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.13.m4.1c"><apply id="S1.F1.13.m4.1.1.cmml" xref="S1.F1.13.m4.1.1"><csymbol cd="ambiguous" id="S1.F1.13.m4.1.1.1.cmml" xref="S1.F1.13.m4.1.1">subscript</csymbol><ci id="S1.F1.13.m4.1.1.2.cmml" xref="S1.F1.13.m4.1.1.2">𝜃</ci><ci id="S1.F1.13.m4.1.1.3.cmml" xref="S1.F1.13.m4.1.1.3">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.13.m4.1d">\theta_{\mathbf{z}}</annotation></semantics></math> (left). For VQA, we infer <math id="S1.F1.14.m5.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S1.F1.14.m5.1b"><mi id="S1.F1.14.m5.1.1" xref="S1.F1.14.m5.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S1.F1.14.m5.1c"><ci id="S1.F1.14.m5.1.1.cmml" xref="S1.F1.14.m5.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.14.m5.1d">\mathbf{z}</annotation></semantics></math> given question <math id="S1.F1.15.m6.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S1.F1.15.m6.1b"><mi id="S1.F1.15.m6.1.1" xref="S1.F1.15.m6.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S1.F1.15.m6.1c"><ci id="S1.F1.15.m6.1.1.cmml" xref="S1.F1.15.m6.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.15.m6.1d">\mathbf{x}</annotation></semantics></math>
to generate an answer. Inference on <math id="S1.F1.16.m7.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S1.F1.16.m7.1b"><mi id="S1.F1.16.m7.1.1" xref="S1.F1.16.m7.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S1.F1.16.m7.1c"><ci id="S1.F1.16.m7.1.1.cmml" xref="S1.F1.16.m7.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.16.m7.1d">\mathbf{z}</annotation></semantics></math> given <math id="S1.F1.17.m8.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S1.F1.17.m8.1b"><mi id="S1.F1.17.m8.1.1" xref="S1.F1.17.m8.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S1.F1.17.m8.1c"><ci id="S1.F1.17.m8.1.1.cmml" xref="S1.F1.17.m8.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.17.m8.1d">a</annotation></semantics></math> and <math id="S1.F1.18.m9.1" class="ltx_Math" alttext="\mathbf{i}" display="inline"><semantics id="S1.F1.18.m9.1b"><mi id="S1.F1.18.m9.1.1" xref="S1.F1.18.m9.1.1.cmml">𝐢</mi><annotation-xml encoding="MathML-Content" id="S1.F1.18.m9.1c"><ci id="S1.F1.18.m9.1.1.cmml" xref="S1.F1.18.m9.1.1">𝐢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.18.m9.1d">\mathbf{i}</annotation></semantics></math> tests coherence
of reasoning patterns. Baseline non-probabilsitic neural symbolic models (<span id="S1.F1.24.3" class="ltx_text ltx_font_bold">NMNs</span>)
capture (subset of) terms and edges shown in blue, and are less data-efficient
and less interpretable reasoning models than our (probabilistic) proposal.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">As we scale machine learning to machine reasoning
 <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al., <a href="#bib.bib4" title="" class="ltx_ref">2017</a>, <a href="#bib.bib3" title="" class="ltx_ref">2016</a>; Bottou, <a href="#bib.bib7" title="" class="ltx_ref">2011</a>; Weston et al., <a href="#bib.bib49" title="" class="ltx_ref">2016</a>)</cite>
a natural desire is to provide guidance to the model in the form of
instructions. In such a context, symbols
are more intuitive to specify than say the parameters of a neural network.
Thus, a promising method for interpretable reasoning models
is to specify the reasoning plan
symbolically and learn to execute it using deep learning.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.4" class="ltx_p">This neural-symbolic methodology has been extensively used to model
reasoning capabilities in visual
question answering (VQA) <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>; Hu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>; Mao et al., <a href="#bib.bib30" title="" class="ltx_ref">2019</a>; Mascharka et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>; Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>; Yi et al., <a href="#bib.bib52" title="" class="ltx_ref">2018</a>)</cite> and
to some extent in reinforcement learning
 <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al., <a href="#bib.bib4" title="" class="ltx_ref">2017</a>; Das et al., <a href="#bib.bib10" title="" class="ltx_ref">2018</a>)</cite>. Concretely, in the VQA task one is given an image <math id="S1.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{i}" display="inline"><semantics id="S1.p4.1.m1.1a"><mi id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">𝐢</mi><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">𝐢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\mathbf{i}</annotation></semantics></math>,
a question <math id="S1.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S1.p4.2.m2.1a"><mi id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\mathbf{x}</annotation></semantics></math> (“<em id="S1.p4.4.1" class="ltx_emph ltx_font_italic">Is there a cylinder left of a cube?</em>”),
for which we would like to provide an answer <math id="S1.p4.3.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S1.p4.3.m3.1a"><mi id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><ci id="S1.p4.3.m3.1.1.cmml" xref="S1.p4.3.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">a</annotation></semantics></math> (<span id="S1.p4.4.2" class="ltx_text ltx_font_typewriter">yes</span>).
In addition, one may also
optionally be provided a program <math id="S1.p4.4.m4.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S1.p4.4.m4.1a"><mi id="S1.p4.4.m4.1.1" xref="S1.p4.4.m4.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S1.p4.4.m4.1b"><ci id="S1.p4.4.m4.1.1.cmml" xref="S1.p4.4.m4.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.m4.1c">\mathbf{z}</annotation></semantics></math> for the question that specifies
a reasoning plan. For <em id="S1.p4.4.3" class="ltx_emph ltx_font_italic">e.g.</em>, one might ask a model to
apply the <span id="S1.p4.4.4" class="ltx_text ltx_font_typewriter">filter[cube]</span> operator,
follwed by <span id="S1.p4.4.5" class="ltx_text ltx_font_typewriter">relate[left]</span>, and then <span id="S1.p4.4.6" class="ltx_text ltx_font_typewriter">And</span>
the result together with <span id="S1.p4.4.7" class="ltx_text ltx_font_typewriter">filter[cylinder]</span> to
predict the answer, where each operator is parameterized as a neural
network (<a href="#S1.F1" title="In 1 Introduction ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The scope of this current work is to provide a probabilistic
framework for such neural-symbolic models. This provides two benefits:
firstly, given a limited number of teaching
examples of plans / programs for a given question / context,
we show one can better capture the association between
the question and programs to provide more understandable and legible
program explanations for novel questions. Inspired by <cite class="ltx_cite ltx_citemacro_citet">Dragan et al. (<a href="#bib.bib11" title="" class="ltx_ref">2013</a>)</cite>,
we call this notion data-efficient legibility, since the model’s program (actions)
in this case need to be legible, <em id="S1.p5.1.1" class="ltx_emph ltx_font_italic">i.e.</em> clearly convey the
question (goal specification) the model has been given.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Secondly, the formulation makes it possible to probe deeper
into the model’s reasoning capabilities.
For <em id="S1.p6.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, one can test if the reasoning done by the system is:
1) coherent: programs which lead to similar answers are consistent
with each other and 2) sensitive: tweaking the
answer meaningfully changes the underlying reasoning plan.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.3" class="ltx_p"><span id="S1.p7.1.1" class="ltx_text" style="color:#000000;">Our probabilistic model treats
functional programs (<math id="S1.p7.1.1.m1.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S1.p7.1.1.m1.1a"><mi mathcolor="#000000" id="S1.p7.1.1.m1.1.1" xref="S1.p7.1.1.m1.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S1.p7.1.1.m1.1b"><ci id="S1.p7.1.1.m1.1.1.cmml" xref="S1.p7.1.1.m1.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.1.1.m1.1c">\mathbf{z}</annotation></semantics></math>) as a stochastic latent variable.</span>
This allows us to share statistics
meaningfully between questions with associated programs
and those without corresponding
programs. This aids data-efficient legibility.
Secondly, probabilistic modeling brings to bear a rich set of
inferential techniques to answer conditional queries on the beliefs of the model.
After fitting a model for VQA, one can sample <math id="S1.p7.2.m1.3" class="ltx_Math" alttext="\mathbf{z}\sim p(\mathbf{z}|\mathbf{i},a)" display="inline"><semantics id="S1.p7.2.m1.3a"><mrow id="S1.p7.2.m1.3.3" xref="S1.p7.2.m1.3.3.cmml"><mi id="S1.p7.2.m1.3.3.3" xref="S1.p7.2.m1.3.3.3.cmml">𝐳</mi><mo id="S1.p7.2.m1.3.3.2" xref="S1.p7.2.m1.3.3.2.cmml">∼</mo><mrow id="S1.p7.2.m1.3.3.1" xref="S1.p7.2.m1.3.3.1.cmml"><mi id="S1.p7.2.m1.3.3.1.3" xref="S1.p7.2.m1.3.3.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S1.p7.2.m1.3.3.1.2" xref="S1.p7.2.m1.3.3.1.2.cmml">​</mo><mrow id="S1.p7.2.m1.3.3.1.1.1" xref="S1.p7.2.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S1.p7.2.m1.3.3.1.1.1.2" xref="S1.p7.2.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S1.p7.2.m1.3.3.1.1.1.1" xref="S1.p7.2.m1.3.3.1.1.1.1.cmml"><mi id="S1.p7.2.m1.3.3.1.1.1.1.2" xref="S1.p7.2.m1.3.3.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S1.p7.2.m1.3.3.1.1.1.1.1" xref="S1.p7.2.m1.3.3.1.1.1.1.1.cmml">|</mo><mrow id="S1.p7.2.m1.3.3.1.1.1.1.3.2" xref="S1.p7.2.m1.3.3.1.1.1.1.3.1.cmml"><mi id="S1.p7.2.m1.1.1" xref="S1.p7.2.m1.1.1.cmml">𝐢</mi><mo id="S1.p7.2.m1.3.3.1.1.1.1.3.2.1" xref="S1.p7.2.m1.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="S1.p7.2.m1.2.2" xref="S1.p7.2.m1.2.2.cmml">a</mi></mrow></mrow><mo stretchy="false" id="S1.p7.2.m1.3.3.1.1.1.3" xref="S1.p7.2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p7.2.m1.3b"><apply id="S1.p7.2.m1.3.3.cmml" xref="S1.p7.2.m1.3.3"><csymbol cd="latexml" id="S1.p7.2.m1.3.3.2.cmml" xref="S1.p7.2.m1.3.3.2">similar-to</csymbol><ci id="S1.p7.2.m1.3.3.3.cmml" xref="S1.p7.2.m1.3.3.3">𝐳</ci><apply id="S1.p7.2.m1.3.3.1.cmml" xref="S1.p7.2.m1.3.3.1"><times id="S1.p7.2.m1.3.3.1.2.cmml" xref="S1.p7.2.m1.3.3.1.2"></times><ci id="S1.p7.2.m1.3.3.1.3.cmml" xref="S1.p7.2.m1.3.3.1.3">𝑝</ci><apply id="S1.p7.2.m1.3.3.1.1.1.1.cmml" xref="S1.p7.2.m1.3.3.1.1.1"><csymbol cd="latexml" id="S1.p7.2.m1.3.3.1.1.1.1.1.cmml" xref="S1.p7.2.m1.3.3.1.1.1.1.1">conditional</csymbol><ci id="S1.p7.2.m1.3.3.1.1.1.1.2.cmml" xref="S1.p7.2.m1.3.3.1.1.1.1.2">𝐳</ci><list id="S1.p7.2.m1.3.3.1.1.1.1.3.1.cmml" xref="S1.p7.2.m1.3.3.1.1.1.1.3.2"><ci id="S1.p7.2.m1.1.1.cmml" xref="S1.p7.2.m1.1.1">𝐢</ci><ci id="S1.p7.2.m1.2.2.cmml" xref="S1.p7.2.m1.2.2">𝑎</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.2.m1.3c">\mathbf{z}\sim p(\mathbf{z}|\mathbf{i},a)</annotation></semantics></math>, to probe if the reasoning done by the model is
coherent (<em id="S1.p7.3.2" class="ltx_emph ltx_font_italic">i.e.</em> multiple programs leading to answer <span id="S1.p7.3.3" class="ltx_text ltx_font_typewriter">yes</span> are coherent)
and sensitive to a different answer (<math id="S1.p7.3.m2.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S1.p7.3.m2.1a"><mi id="S1.p7.3.m2.1.1" xref="S1.p7.3.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S1.p7.3.m2.1b"><ci id="S1.p7.3.m2.1.1.cmml" xref="S1.p7.3.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.3.m2.1c">a</annotation></semantics></math>) (say, <span id="S1.p7.3.4" class="ltx_text ltx_font_typewriter">no</span>).</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.11" class="ltx_p">Given an image (<math id="S1.p8.1.m1.1" class="ltx_Math" alttext="\mathbf{i}" display="inline"><semantics id="S1.p8.1.m1.1a"><mi id="S1.p8.1.m1.1.1" xref="S1.p8.1.m1.1.1.cmml">𝐢</mi><annotation-xml encoding="MathML-Content" id="S1.p8.1.m1.1b"><ci id="S1.p8.1.m1.1.1.cmml" xref="S1.p8.1.m1.1.1">𝐢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.1.m1.1c">\mathbf{i}</annotation></semantics></math>), we build a model for
<math id="S1.p8.2.m2.3" class="ltx_Math" alttext="p(\mathbf{x},\mathbf{z},a|\mathbf{i})" display="inline"><semantics id="S1.p8.2.m2.3a"><mrow id="S1.p8.2.m2.3.3" xref="S1.p8.2.m2.3.3.cmml"><mi id="S1.p8.2.m2.3.3.3" xref="S1.p8.2.m2.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S1.p8.2.m2.3.3.2" xref="S1.p8.2.m2.3.3.2.cmml">​</mo><mrow id="S1.p8.2.m2.3.3.1.1" xref="S1.p8.2.m2.3.3.1.2.cmml"><mo stretchy="false" id="S1.p8.2.m2.3.3.1.1.2" xref="S1.p8.2.m2.3.3.1.2.cmml">(</mo><mi id="S1.p8.2.m2.1.1" xref="S1.p8.2.m2.1.1.cmml">𝐱</mi><mo id="S1.p8.2.m2.3.3.1.1.3" xref="S1.p8.2.m2.3.3.1.2.cmml">,</mo><mi id="S1.p8.2.m2.2.2" xref="S1.p8.2.m2.2.2.cmml">𝐳</mi><mo id="S1.p8.2.m2.3.3.1.1.4" xref="S1.p8.2.m2.3.3.1.2.cmml">,</mo><mrow id="S1.p8.2.m2.3.3.1.1.1" xref="S1.p8.2.m2.3.3.1.1.1.cmml"><mi id="S1.p8.2.m2.3.3.1.1.1.2" xref="S1.p8.2.m2.3.3.1.1.1.2.cmml">a</mi><mo fence="false" id="S1.p8.2.m2.3.3.1.1.1.1" xref="S1.p8.2.m2.3.3.1.1.1.1.cmml">|</mo><mi id="S1.p8.2.m2.3.3.1.1.1.3" xref="S1.p8.2.m2.3.3.1.1.1.3.cmml">𝐢</mi></mrow><mo stretchy="false" id="S1.p8.2.m2.3.3.1.1.5" xref="S1.p8.2.m2.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p8.2.m2.3b"><apply id="S1.p8.2.m2.3.3.cmml" xref="S1.p8.2.m2.3.3"><times id="S1.p8.2.m2.3.3.2.cmml" xref="S1.p8.2.m2.3.3.2"></times><ci id="S1.p8.2.m2.3.3.3.cmml" xref="S1.p8.2.m2.3.3.3">𝑝</ci><vector id="S1.p8.2.m2.3.3.1.2.cmml" xref="S1.p8.2.m2.3.3.1.1"><ci id="S1.p8.2.m2.1.1.cmml" xref="S1.p8.2.m2.1.1">𝐱</ci><ci id="S1.p8.2.m2.2.2.cmml" xref="S1.p8.2.m2.2.2">𝐳</ci><apply id="S1.p8.2.m2.3.3.1.1.1.cmml" xref="S1.p8.2.m2.3.3.1.1.1"><csymbol cd="latexml" id="S1.p8.2.m2.3.3.1.1.1.1.cmml" xref="S1.p8.2.m2.3.3.1.1.1.1">conditional</csymbol><ci id="S1.p8.2.m2.3.3.1.1.1.2.cmml" xref="S1.p8.2.m2.3.3.1.1.1.2">𝑎</ci><ci id="S1.p8.2.m2.3.3.1.1.1.3.cmml" xref="S1.p8.2.m2.3.3.1.1.1.3">𝐢</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.2.m2.3c">p(\mathbf{x},\mathbf{z},a|\mathbf{i})</annotation></semantics></math> (see <a href="#S1.F1" title="In 1 Introduction ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>); where the model factorizes as:
<math id="S1.p8.3.m3.8" class="ltx_Math" alttext="p(\mathbf{x},\mathbf{z},a|\mathbf{i})=p(\mathbf{z})p(\mathbf{x}|\mathbf{z})p(a|\mathbf{z},\mathbf{i})" display="inline"><semantics id="S1.p8.3.m3.8a"><mrow id="S1.p8.3.m3.8.8" xref="S1.p8.3.m3.8.8.cmml"><mrow id="S1.p8.3.m3.6.6.1" xref="S1.p8.3.m3.6.6.1.cmml"><mi id="S1.p8.3.m3.6.6.1.3" xref="S1.p8.3.m3.6.6.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S1.p8.3.m3.6.6.1.2" xref="S1.p8.3.m3.6.6.1.2.cmml">​</mo><mrow id="S1.p8.3.m3.6.6.1.1.1" xref="S1.p8.3.m3.6.6.1.1.2.cmml"><mo stretchy="false" id="S1.p8.3.m3.6.6.1.1.1.2" xref="S1.p8.3.m3.6.6.1.1.2.cmml">(</mo><mi id="S1.p8.3.m3.1.1" xref="S1.p8.3.m3.1.1.cmml">𝐱</mi><mo id="S1.p8.3.m3.6.6.1.1.1.3" xref="S1.p8.3.m3.6.6.1.1.2.cmml">,</mo><mi id="S1.p8.3.m3.2.2" xref="S1.p8.3.m3.2.2.cmml">𝐳</mi><mo id="S1.p8.3.m3.6.6.1.1.1.4" xref="S1.p8.3.m3.6.6.1.1.2.cmml">,</mo><mrow id="S1.p8.3.m3.6.6.1.1.1.1" xref="S1.p8.3.m3.6.6.1.1.1.1.cmml"><mi id="S1.p8.3.m3.6.6.1.1.1.1.2" xref="S1.p8.3.m3.6.6.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S1.p8.3.m3.6.6.1.1.1.1.1" xref="S1.p8.3.m3.6.6.1.1.1.1.1.cmml">|</mo><mi id="S1.p8.3.m3.6.6.1.1.1.1.3" xref="S1.p8.3.m3.6.6.1.1.1.1.3.cmml">𝐢</mi></mrow><mo stretchy="false" id="S1.p8.3.m3.6.6.1.1.1.5" xref="S1.p8.3.m3.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="S1.p8.3.m3.8.8.4" xref="S1.p8.3.m3.8.8.4.cmml">=</mo><mrow id="S1.p8.3.m3.8.8.3" xref="S1.p8.3.m3.8.8.3.cmml"><mi id="S1.p8.3.m3.8.8.3.4" xref="S1.p8.3.m3.8.8.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S1.p8.3.m3.8.8.3.3" xref="S1.p8.3.m3.8.8.3.3.cmml">​</mo><mrow id="S1.p8.3.m3.8.8.3.5.2" xref="S1.p8.3.m3.8.8.3.cmml"><mo stretchy="false" id="S1.p8.3.m3.8.8.3.5.2.1" xref="S1.p8.3.m3.8.8.3.cmml">(</mo><mi id="S1.p8.3.m3.3.3" xref="S1.p8.3.m3.3.3.cmml">𝐳</mi><mo stretchy="false" id="S1.p8.3.m3.8.8.3.5.2.2" xref="S1.p8.3.m3.8.8.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S1.p8.3.m3.8.8.3.3a" xref="S1.p8.3.m3.8.8.3.3.cmml">​</mo><mi id="S1.p8.3.m3.8.8.3.6" xref="S1.p8.3.m3.8.8.3.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="S1.p8.3.m3.8.8.3.3b" xref="S1.p8.3.m3.8.8.3.3.cmml">​</mo><mrow id="S1.p8.3.m3.7.7.2.1.1" xref="S1.p8.3.m3.7.7.2.1.1.1.cmml"><mo stretchy="false" id="S1.p8.3.m3.7.7.2.1.1.2" xref="S1.p8.3.m3.7.7.2.1.1.1.cmml">(</mo><mrow id="S1.p8.3.m3.7.7.2.1.1.1" xref="S1.p8.3.m3.7.7.2.1.1.1.cmml"><mi id="S1.p8.3.m3.7.7.2.1.1.1.2" xref="S1.p8.3.m3.7.7.2.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S1.p8.3.m3.7.7.2.1.1.1.1" xref="S1.p8.3.m3.7.7.2.1.1.1.1.cmml">|</mo><mi id="S1.p8.3.m3.7.7.2.1.1.1.3" xref="S1.p8.3.m3.7.7.2.1.1.1.3.cmml">𝐳</mi></mrow><mo stretchy="false" id="S1.p8.3.m3.7.7.2.1.1.3" xref="S1.p8.3.m3.7.7.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S1.p8.3.m3.8.8.3.3c" xref="S1.p8.3.m3.8.8.3.3.cmml">​</mo><mi id="S1.p8.3.m3.8.8.3.7" xref="S1.p8.3.m3.8.8.3.7.cmml">p</mi><mo lspace="0em" rspace="0em" id="S1.p8.3.m3.8.8.3.3d" xref="S1.p8.3.m3.8.8.3.3.cmml">​</mo><mrow id="S1.p8.3.m3.8.8.3.2.1" xref="S1.p8.3.m3.8.8.3.2.1.1.cmml"><mo stretchy="false" id="S1.p8.3.m3.8.8.3.2.1.2" xref="S1.p8.3.m3.8.8.3.2.1.1.cmml">(</mo><mrow id="S1.p8.3.m3.8.8.3.2.1.1" xref="S1.p8.3.m3.8.8.3.2.1.1.cmml"><mi id="S1.p8.3.m3.8.8.3.2.1.1.2" xref="S1.p8.3.m3.8.8.3.2.1.1.2.cmml">a</mi><mo fence="false" id="S1.p8.3.m3.8.8.3.2.1.1.1" xref="S1.p8.3.m3.8.8.3.2.1.1.1.cmml">|</mo><mrow id="S1.p8.3.m3.8.8.3.2.1.1.3.2" xref="S1.p8.3.m3.8.8.3.2.1.1.3.1.cmml"><mi id="S1.p8.3.m3.4.4" xref="S1.p8.3.m3.4.4.cmml">𝐳</mi><mo id="S1.p8.3.m3.8.8.3.2.1.1.3.2.1" xref="S1.p8.3.m3.8.8.3.2.1.1.3.1.cmml">,</mo><mi id="S1.p8.3.m3.5.5" xref="S1.p8.3.m3.5.5.cmml">𝐢</mi></mrow></mrow><mo stretchy="false" id="S1.p8.3.m3.8.8.3.2.1.3" xref="S1.p8.3.m3.8.8.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p8.3.m3.8b"><apply id="S1.p8.3.m3.8.8.cmml" xref="S1.p8.3.m3.8.8"><eq id="S1.p8.3.m3.8.8.4.cmml" xref="S1.p8.3.m3.8.8.4"></eq><apply id="S1.p8.3.m3.6.6.1.cmml" xref="S1.p8.3.m3.6.6.1"><times id="S1.p8.3.m3.6.6.1.2.cmml" xref="S1.p8.3.m3.6.6.1.2"></times><ci id="S1.p8.3.m3.6.6.1.3.cmml" xref="S1.p8.3.m3.6.6.1.3">𝑝</ci><vector id="S1.p8.3.m3.6.6.1.1.2.cmml" xref="S1.p8.3.m3.6.6.1.1.1"><ci id="S1.p8.3.m3.1.1.cmml" xref="S1.p8.3.m3.1.1">𝐱</ci><ci id="S1.p8.3.m3.2.2.cmml" xref="S1.p8.3.m3.2.2">𝐳</ci><apply id="S1.p8.3.m3.6.6.1.1.1.1.cmml" xref="S1.p8.3.m3.6.6.1.1.1.1"><csymbol cd="latexml" id="S1.p8.3.m3.6.6.1.1.1.1.1.cmml" xref="S1.p8.3.m3.6.6.1.1.1.1.1">conditional</csymbol><ci id="S1.p8.3.m3.6.6.1.1.1.1.2.cmml" xref="S1.p8.3.m3.6.6.1.1.1.1.2">𝑎</ci><ci id="S1.p8.3.m3.6.6.1.1.1.1.3.cmml" xref="S1.p8.3.m3.6.6.1.1.1.1.3">𝐢</ci></apply></vector></apply><apply id="S1.p8.3.m3.8.8.3.cmml" xref="S1.p8.3.m3.8.8.3"><times id="S1.p8.3.m3.8.8.3.3.cmml" xref="S1.p8.3.m3.8.8.3.3"></times><ci id="S1.p8.3.m3.8.8.3.4.cmml" xref="S1.p8.3.m3.8.8.3.4">𝑝</ci><ci id="S1.p8.3.m3.3.3.cmml" xref="S1.p8.3.m3.3.3">𝐳</ci><ci id="S1.p8.3.m3.8.8.3.6.cmml" xref="S1.p8.3.m3.8.8.3.6">𝑝</ci><apply id="S1.p8.3.m3.7.7.2.1.1.1.cmml" xref="S1.p8.3.m3.7.7.2.1.1"><csymbol cd="latexml" id="S1.p8.3.m3.7.7.2.1.1.1.1.cmml" xref="S1.p8.3.m3.7.7.2.1.1.1.1">conditional</csymbol><ci id="S1.p8.3.m3.7.7.2.1.1.1.2.cmml" xref="S1.p8.3.m3.7.7.2.1.1.1.2">𝐱</ci><ci id="S1.p8.3.m3.7.7.2.1.1.1.3.cmml" xref="S1.p8.3.m3.7.7.2.1.1.1.3">𝐳</ci></apply><ci id="S1.p8.3.m3.8.8.3.7.cmml" xref="S1.p8.3.m3.8.8.3.7">𝑝</ci><apply id="S1.p8.3.m3.8.8.3.2.1.1.cmml" xref="S1.p8.3.m3.8.8.3.2.1"><csymbol cd="latexml" id="S1.p8.3.m3.8.8.3.2.1.1.1.cmml" xref="S1.p8.3.m3.8.8.3.2.1.1.1">conditional</csymbol><ci id="S1.p8.3.m3.8.8.3.2.1.1.2.cmml" xref="S1.p8.3.m3.8.8.3.2.1.1.2">𝑎</ci><list id="S1.p8.3.m3.8.8.3.2.1.1.3.1.cmml" xref="S1.p8.3.m3.8.8.3.2.1.1.3.2"><ci id="S1.p8.3.m3.4.4.cmml" xref="S1.p8.3.m3.4.4">𝐳</ci><ci id="S1.p8.3.m3.5.5.cmml" xref="S1.p8.3.m3.5.5">𝐢</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.3.m3.8c">p(\mathbf{x},\mathbf{z},a|\mathbf{i})=p(\mathbf{z})p(\mathbf{x}|\mathbf{z})p(a|\mathbf{z},\mathbf{i})</annotation></semantics></math>.
The implied generative process is as follows. First we sample a program <math id="S1.p8.4.m4.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S1.p8.4.m4.1a"><mi id="S1.p8.4.m4.1.1" xref="S1.p8.4.m4.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S1.p8.4.m4.1b"><ci id="S1.p8.4.m4.1.1.cmml" xref="S1.p8.4.m4.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.4.m4.1c">\mathbf{z}</annotation></semantics></math>,
which generates questions <math id="S1.p8.5.m5.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S1.p8.5.m5.1a"><mi id="S1.p8.5.m5.1.1" xref="S1.p8.5.m5.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S1.p8.5.m5.1b"><ci id="S1.p8.5.m5.1.1.cmml" xref="S1.p8.5.m5.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.5.m5.1c">\mathbf{x}</annotation></semantics></math>. Further, given a program <math id="S1.p8.6.m6.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S1.p8.6.m6.1a"><mi id="S1.p8.6.m6.1.1" xref="S1.p8.6.m6.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S1.p8.6.m6.1b"><ci id="S1.p8.6.m6.1.1.cmml" xref="S1.p8.6.m6.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.6.m6.1c">\mathbf{z}</annotation></semantics></math> and an image <math id="S1.p8.7.m7.1" class="ltx_Math" alttext="\mathbf{i}" display="inline"><semantics id="S1.p8.7.m7.1a"><mi id="S1.p8.7.m7.1.1" xref="S1.p8.7.m7.1.1.cmml">𝐢</mi><annotation-xml encoding="MathML-Content" id="S1.p8.7.m7.1b"><ci id="S1.p8.7.m7.1.1.cmml" xref="S1.p8.7.m7.1.1">𝐢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.7.m7.1c">\mathbf{i}</annotation></semantics></math>
we generate answers <math id="S1.p8.8.m8.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S1.p8.8.m8.1a"><mi id="S1.p8.8.m8.1.1" xref="S1.p8.8.m8.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S1.p8.8.m8.1b"><ci id="S1.p8.8.m8.1.1.cmml" xref="S1.p8.8.m8.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.8.m8.1c">a</annotation></semantics></math>. Note that based on the symbolic program <math id="S1.p8.9.m9.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S1.p8.9.m9.1a"><mi id="S1.p8.9.m9.1.1" xref="S1.p8.9.m9.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S1.p8.9.m9.1b"><ci id="S1.p8.9.m9.1.1.cmml" xref="S1.p8.9.m9.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.9.m9.1c">\mathbf{z}</annotation></semantics></math>, we dynamically
instantiate parameters of a neural network <math id="S1.p8.10.m10.1" class="ltx_Math" alttext="\theta_{\mathbf{z}}" display="inline"><semantics id="S1.p8.10.m10.1a"><msub id="S1.p8.10.m10.1.1" xref="S1.p8.10.m10.1.1.cmml"><mi id="S1.p8.10.m10.1.1.2" xref="S1.p8.10.m10.1.1.2.cmml">θ</mi><mi id="S1.p8.10.m10.1.1.3" xref="S1.p8.10.m10.1.1.3.cmml">𝐳</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p8.10.m10.1b"><apply id="S1.p8.10.m10.1.1.cmml" xref="S1.p8.10.m10.1.1"><csymbol cd="ambiguous" id="S1.p8.10.m10.1.1.1.cmml" xref="S1.p8.10.m10.1.1">subscript</csymbol><ci id="S1.p8.10.m10.1.1.2.cmml" xref="S1.p8.10.m10.1.1.2">𝜃</ci><ci id="S1.p8.10.m10.1.1.3.cmml" xref="S1.p8.10.m10.1.1.3">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.10.m10.1c">\theta_{\mathbf{z}}</annotation></semantics></math> (these are deterministic,
given <math id="S1.p8.11.m11.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S1.p8.11.m11.1a"><mi id="S1.p8.11.m11.1.1" xref="S1.p8.11.m11.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S1.p8.11.m11.1b"><ci id="S1.p8.11.m11.1.1.cmml" xref="S1.p8.11.m11.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.11.m11.1c">\mathbf{z}</annotation></semantics></math>), by composing smaller neural-modules
for each symbol in the program. This is similar to prior work on neural-symbolic VQA
 <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>; Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite> using neural module networks (NMNs).
In comparison to prior works, our probabilistic formulation (shorthand Prob-NMN) leads to better semi-supervised learning, and reasoning capabilities<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Note that this model assumes independence of programs
from images, which corresponds to the weak sampling assumptions
in concept learning <cite class="ltx_cite ltx_citemacro_citep">(Tenenbaum, <a href="#bib.bib43" title="" class="ltx_ref">1999</a>)</cite>, one can handle question
premise, <em id="footnote1.1" class="ltx_emph ltx_font_italic">i.e.</em> that people might ask a specific set of questions
for an image in such a model by reparameterizing the answer variable to include a
relevance label.</span></span></span>.</p>
</div>
<div id="S1.p9" class="ltx_para">
<p id="S1.p9.1" class="ltx_p">Our technical contribution is to formulate semi-supervised learning
with this deep generative neural-symbolic model using variational inference <cite class="ltx_cite ltx_citemacro_citep">(Jordan et al., <a href="#bib.bib20" title="" class="ltx_ref">1999</a>)</cite>.
First, we derive variational lower bounds on the evidence
for the model for the semi-supervised and supervised cases, and show how this motivates
the semi-supervised objectives used in previous work with discrete structured latent spaces
 <cite class="ltx_cite ltx_citemacro_citep">(Miao &amp; Blunsom, <a href="#bib.bib32" title="" class="ltx_ref">2016</a>; Yin et al., <a href="#bib.bib53" title="" class="ltx_ref">2018</a>)</cite>. Next, we show how to learn program execution, <em id="S1.p9.1.1" class="ltx_emph ltx_font_italic">i.e.</em> <math id="S1.p9.1.m1.3" class="ltx_Math" alttext="p(a|\mathbf{z},\mathbf{i})" display="inline"><semantics id="S1.p9.1.m1.3a"><mrow id="S1.p9.1.m1.3.3" xref="S1.p9.1.m1.3.3.cmml"><mi id="S1.p9.1.m1.3.3.3" xref="S1.p9.1.m1.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S1.p9.1.m1.3.3.2" xref="S1.p9.1.m1.3.3.2.cmml">​</mo><mrow id="S1.p9.1.m1.3.3.1.1" xref="S1.p9.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S1.p9.1.m1.3.3.1.1.2" xref="S1.p9.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S1.p9.1.m1.3.3.1.1.1" xref="S1.p9.1.m1.3.3.1.1.1.cmml"><mi id="S1.p9.1.m1.3.3.1.1.1.2" xref="S1.p9.1.m1.3.3.1.1.1.2.cmml">a</mi><mo fence="false" id="S1.p9.1.m1.3.3.1.1.1.1" xref="S1.p9.1.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S1.p9.1.m1.3.3.1.1.1.3.2" xref="S1.p9.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S1.p9.1.m1.1.1" xref="S1.p9.1.m1.1.1.cmml">𝐳</mi><mo id="S1.p9.1.m1.3.3.1.1.1.3.2.1" xref="S1.p9.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S1.p9.1.m1.2.2" xref="S1.p9.1.m1.2.2.cmml">𝐢</mi></mrow></mrow><mo stretchy="false" id="S1.p9.1.m1.3.3.1.1.3" xref="S1.p9.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p9.1.m1.3b"><apply id="S1.p9.1.m1.3.3.cmml" xref="S1.p9.1.m1.3.3"><times id="S1.p9.1.m1.3.3.2.cmml" xref="S1.p9.1.m1.3.3.2"></times><ci id="S1.p9.1.m1.3.3.3.cmml" xref="S1.p9.1.m1.3.3.3">𝑝</ci><apply id="S1.p9.1.m1.3.3.1.1.1.cmml" xref="S1.p9.1.m1.3.3.1.1"><csymbol cd="latexml" id="S1.p9.1.m1.3.3.1.1.1.1.cmml" xref="S1.p9.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S1.p9.1.m1.3.3.1.1.1.2.cmml" xref="S1.p9.1.m1.3.3.1.1.1.2">𝑎</ci><list id="S1.p9.1.m1.3.3.1.1.1.3.1.cmml" xref="S1.p9.1.m1.3.3.1.1.1.3.2"><ci id="S1.p9.1.m1.1.1.cmml" xref="S1.p9.1.m1.1.1">𝐳</ci><ci id="S1.p9.1.m1.2.2.cmml" xref="S1.p9.1.m1.2.2">𝐢</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p9.1.m1.3c">p(a|\mathbf{z},\mathbf{i})</annotation></semantics></math>
jointly with the remaining terms in the model by devising a stage-wise optimization
algorithm <span id="S1.p9.1.2" class="ltx_text" style="color:#000000;">inspired by <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>.</span></p>
</div>
<div id="S1.p10" class="ltx_para">
<p id="S1.p10.1" class="ltx_p"><span id="S1.p10.1.1" class="ltx_text ltx_font_bold">Contributions.</span>
First, we provide tractable algorithms for training models with probabilistic latent programs
that also learn to execute them in an end-to-end manner.
Second, we take the first steps towards deriving useful semi-supervised learning
objectives for the class of structured sequential latent variable models <cite class="ltx_cite ltx_citemacro_citep">(Miao &amp; Blunsom, <a href="#bib.bib32" title="" class="ltx_ref">2016</a>; Yin et al., <a href="#bib.bib53" title="" class="ltx_ref">2018</a>)</cite>.
Third, our approach enables interpretable reasoning systems that are more
legible with less supervision, and expose their reasoning process to test
coherence and sensitivity.
Fourth, our system offers improvements on the <span id="S1.p10.1.2" class="ltx_text" style="color:#000000;">CLEVR <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>
as well as SHAPES <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>)</cite> datasets in the low question program supervision regime.
That is, our model answers questions more accurately and with legible (understandable) programs
than adaptations of prior work to our setting as well as baseline non-probabilistic
variants of our model.</span>

</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methods</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text" style="color:#000000;">We first explain the model and its parameterization,
then detail the training objectives along with a discussion of
a stage-wise training procedure.</span></p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.10" class="ltx_p">Let <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{i}\in\mathbb{R}^{U\times V}" display="inline"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">𝐢</mi><mo id="S2.p2.1.m1.1.1.1" xref="S2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml"><mi id="S2.p2.1.m1.1.1.3.2" xref="S2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p2.1.m1.1.1.3.3" xref="S2.p2.1.m1.1.1.3.3.cmml"><mi id="S2.p2.1.m1.1.1.3.3.2" xref="S2.p2.1.m1.1.1.3.3.2.cmml">U</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p2.1.m1.1.1.3.3.1" xref="S2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.p2.1.m1.1.1.3.3.3" xref="S2.p2.1.m1.1.1.3.3.3.cmml">V</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><in id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1"></in><ci id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">𝐢</ci><apply id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.3.1.cmml" xref="S2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S2.p2.1.m1.1.1.3.2.cmml" xref="S2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S2.p2.1.m1.1.1.3.3.cmml" xref="S2.p2.1.m1.1.1.3.3"><times id="S2.p2.1.m1.1.1.3.3.1.cmml" xref="S2.p2.1.m1.1.1.3.3.1"></times><ci id="S2.p2.1.m1.1.1.3.3.2.cmml" xref="S2.p2.1.m1.1.1.3.3.2">𝑈</ci><ci id="S2.p2.1.m1.1.1.3.3.3.cmml" xref="S2.p2.1.m1.1.1.3.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\mathbf{i}\in\mathbb{R}^{U\times V}</annotation></semantics></math> be an input image,
<math id="S2.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathbf{x}</annotation></semantics></math> be a question, which is comprised of a sequence of words
<math id="S2.p2.3.m3.3" class="ltx_Math" alttext="(x_{1},\cdots,x_{t})" display="inline"><semantics id="S2.p2.3.m3.3a"><mrow id="S2.p2.3.m3.3.3.2" xref="S2.p2.3.m3.3.3.3.cmml"><mo stretchy="false" id="S2.p2.3.m3.3.3.2.3" xref="S2.p2.3.m3.3.3.3.cmml">(</mo><msub id="S2.p2.3.m3.2.2.1.1" xref="S2.p2.3.m3.2.2.1.1.cmml"><mi id="S2.p2.3.m3.2.2.1.1.2" xref="S2.p2.3.m3.2.2.1.1.2.cmml">x</mi><mn id="S2.p2.3.m3.2.2.1.1.3" xref="S2.p2.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.p2.3.m3.3.3.2.4" xref="S2.p2.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">⋯</mi><mo id="S2.p2.3.m3.3.3.2.5" xref="S2.p2.3.m3.3.3.3.cmml">,</mo><msub id="S2.p2.3.m3.3.3.2.2" xref="S2.p2.3.m3.3.3.2.2.cmml"><mi id="S2.p2.3.m3.3.3.2.2.2" xref="S2.p2.3.m3.3.3.2.2.2.cmml">x</mi><mi id="S2.p2.3.m3.3.3.2.2.3" xref="S2.p2.3.m3.3.3.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S2.p2.3.m3.3.3.2.6" xref="S2.p2.3.m3.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.3b"><vector id="S2.p2.3.m3.3.3.3.cmml" xref="S2.p2.3.m3.3.3.2"><apply id="S2.p2.3.m3.2.2.1.1.cmml" xref="S2.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S2.p2.3.m3.2.2.1.1.1.cmml" xref="S2.p2.3.m3.2.2.1.1">subscript</csymbol><ci id="S2.p2.3.m3.2.2.1.1.2.cmml" xref="S2.p2.3.m3.2.2.1.1.2">𝑥</ci><cn type="integer" id="S2.p2.3.m3.2.2.1.1.3.cmml" xref="S2.p2.3.m3.2.2.1.1.3">1</cn></apply><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">⋯</ci><apply id="S2.p2.3.m3.3.3.2.2.cmml" xref="S2.p2.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S2.p2.3.m3.3.3.2.2.1.cmml" xref="S2.p2.3.m3.3.3.2.2">subscript</csymbol><ci id="S2.p2.3.m3.3.3.2.2.2.cmml" xref="S2.p2.3.m3.3.3.2.2.2">𝑥</ci><ci id="S2.p2.3.m3.3.3.2.2.3.cmml" xref="S2.p2.3.m3.3.3.2.2.3">𝑡</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.3c">(x_{1},\cdots,x_{t})</annotation></semantics></math>, where each <math id="S2.p2.4.m4.1" class="ltx_Math" alttext="x_{t}\in\mathcal{X}" display="inline"><semantics id="S2.p2.4.m4.1a"><mrow id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><msub id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml"><mi id="S2.p2.4.m4.1.1.2.2" xref="S2.p2.4.m4.1.1.2.2.cmml">x</mi><mi id="S2.p2.4.m4.1.1.2.3" xref="S2.p2.4.m4.1.1.2.3.cmml">t</mi></msub><mo id="S2.p2.4.m4.1.1.1" xref="S2.p2.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><in id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1.1"></in><apply id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.1.2.1.cmml" xref="S2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S2.p2.4.m4.1.1.2.2.cmml" xref="S2.p2.4.m4.1.1.2.2">𝑥</ci><ci id="S2.p2.4.m4.1.1.2.3.cmml" xref="S2.p2.4.m4.1.1.2.3">𝑡</ci></apply><ci id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">x_{t}\in\mathcal{X}</annotation></semantics></math>, where
<math id="S2.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S2.p2.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><ci id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">\mathcal{X}</annotation></semantics></math> is the vocabulary comprising all words,
similarly, <math id="S2.p2.6.m6.1" class="ltx_Math" alttext="a\in\mathcal{A}" display="inline"><semantics id="S2.p2.6.m6.1a"><mrow id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml"><mi id="S2.p2.6.m6.1.1.2" xref="S2.p2.6.m6.1.1.2.cmml">a</mi><mo id="S2.p2.6.m6.1.1.1" xref="S2.p2.6.m6.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.6.m6.1.1.3" xref="S2.p2.6.m6.1.1.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><apply id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1"><in id="S2.p2.6.m6.1.1.1.cmml" xref="S2.p2.6.m6.1.1.1"></in><ci id="S2.p2.6.m6.1.1.2.cmml" xref="S2.p2.6.m6.1.1.2">𝑎</ci><ci id="S2.p2.6.m6.1.1.3.cmml" xref="S2.p2.6.m6.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">a\in\mathcal{A}</annotation></semantics></math> be the answer
(where <math id="S2.p2.7.m7.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S2.p2.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b"><ci id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">\mathcal{A}</annotation></semantics></math> is the answer vocabulary),
and <math id="S2.p2.8.m8.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S2.p2.8.m8.1a"><mi id="S2.p2.8.m8.1.1" xref="S2.p2.8.m8.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.1b"><ci id="S2.p2.8.m8.1.1.cmml" xref="S2.p2.8.m8.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m8.1c">\mathbf{z}</annotation></semantics></math> be the prefix serialization of a program.
That is, <math id="S2.p2.9.m9.3" class="ltx_Math" alttext="\mathbf{z}=(z_{1},\cdots,z_{T})\ni z_{t}\in\mathcal{Z}" display="inline"><semantics id="S2.p2.9.m9.3a"><mrow id="S2.p2.9.m9.3.3" xref="S2.p2.9.m9.3.3.cmml"><mi id="S2.p2.9.m9.3.3.4" xref="S2.p2.9.m9.3.3.4.cmml">𝐳</mi><mo id="S2.p2.9.m9.3.3.5" xref="S2.p2.9.m9.3.3.5.cmml">=</mo><mrow id="S2.p2.9.m9.3.3.2.2" xref="S2.p2.9.m9.3.3.2.3.cmml"><mo stretchy="false" id="S2.p2.9.m9.3.3.2.2.3" xref="S2.p2.9.m9.3.3.2.3.cmml">(</mo><msub id="S2.p2.9.m9.2.2.1.1.1" xref="S2.p2.9.m9.2.2.1.1.1.cmml"><mi id="S2.p2.9.m9.2.2.1.1.1.2" xref="S2.p2.9.m9.2.2.1.1.1.2.cmml">z</mi><mn id="S2.p2.9.m9.2.2.1.1.1.3" xref="S2.p2.9.m9.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.p2.9.m9.3.3.2.2.4" xref="S2.p2.9.m9.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.p2.9.m9.1.1" xref="S2.p2.9.m9.1.1.cmml">⋯</mi><mo id="S2.p2.9.m9.3.3.2.2.5" xref="S2.p2.9.m9.3.3.2.3.cmml">,</mo><msub id="S2.p2.9.m9.3.3.2.2.2" xref="S2.p2.9.m9.3.3.2.2.2.cmml"><mi id="S2.p2.9.m9.3.3.2.2.2.2" xref="S2.p2.9.m9.3.3.2.2.2.2.cmml">z</mi><mi id="S2.p2.9.m9.3.3.2.2.2.3" xref="S2.p2.9.m9.3.3.2.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="S2.p2.9.m9.3.3.2.2.6" xref="S2.p2.9.m9.3.3.2.3.cmml">)</mo></mrow><mo id="S2.p2.9.m9.3.3.6" xref="S2.p2.9.m9.3.3.6.cmml">∋</mo><msub id="S2.p2.9.m9.3.3.7" xref="S2.p2.9.m9.3.3.7.cmml"><mi id="S2.p2.9.m9.3.3.7.2" xref="S2.p2.9.m9.3.3.7.2.cmml">z</mi><mi id="S2.p2.9.m9.3.3.7.3" xref="S2.p2.9.m9.3.3.7.3.cmml">t</mi></msub><mo id="S2.p2.9.m9.3.3.8" xref="S2.p2.9.m9.3.3.8.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.9.m9.3.3.9" xref="S2.p2.9.m9.3.3.9.cmml">𝒵</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.9.m9.3b"><apply id="S2.p2.9.m9.3.3.cmml" xref="S2.p2.9.m9.3.3"><and id="S2.p2.9.m9.3.3a.cmml" xref="S2.p2.9.m9.3.3"></and><apply id="S2.p2.9.m9.3.3b.cmml" xref="S2.p2.9.m9.3.3"><eq id="S2.p2.9.m9.3.3.5.cmml" xref="S2.p2.9.m9.3.3.5"></eq><ci id="S2.p2.9.m9.3.3.4.cmml" xref="S2.p2.9.m9.3.3.4">𝐳</ci><vector id="S2.p2.9.m9.3.3.2.3.cmml" xref="S2.p2.9.m9.3.3.2.2"><apply id="S2.p2.9.m9.2.2.1.1.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p2.9.m9.2.2.1.1.1.1.cmml" xref="S2.p2.9.m9.2.2.1.1.1">subscript</csymbol><ci id="S2.p2.9.m9.2.2.1.1.1.2.cmml" xref="S2.p2.9.m9.2.2.1.1.1.2">𝑧</ci><cn type="integer" id="S2.p2.9.m9.2.2.1.1.1.3.cmml" xref="S2.p2.9.m9.2.2.1.1.1.3">1</cn></apply><ci id="S2.p2.9.m9.1.1.cmml" xref="S2.p2.9.m9.1.1">⋯</ci><apply id="S2.p2.9.m9.3.3.2.2.2.cmml" xref="S2.p2.9.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.p2.9.m9.3.3.2.2.2.1.cmml" xref="S2.p2.9.m9.3.3.2.2.2">subscript</csymbol><ci id="S2.p2.9.m9.3.3.2.2.2.2.cmml" xref="S2.p2.9.m9.3.3.2.2.2.2">𝑧</ci><ci id="S2.p2.9.m9.3.3.2.2.2.3.cmml" xref="S2.p2.9.m9.3.3.2.2.2.3">𝑇</ci></apply></vector></apply><apply id="S2.p2.9.m9.3.3c.cmml" xref="S2.p2.9.m9.3.3"><csymbol cd="latexml" id="S2.p2.9.m9.3.3.6.cmml" xref="S2.p2.9.m9.3.3.6">contains</csymbol><share href="#S2.p2.9.m9.3.3.2.cmml" id="S2.p2.9.m9.3.3d.cmml" xref="S2.p2.9.m9.3.3"></share><apply id="S2.p2.9.m9.3.3.7.cmml" xref="S2.p2.9.m9.3.3.7"><csymbol cd="ambiguous" id="S2.p2.9.m9.3.3.7.1.cmml" xref="S2.p2.9.m9.3.3.7">subscript</csymbol><ci id="S2.p2.9.m9.3.3.7.2.cmml" xref="S2.p2.9.m9.3.3.7.2">𝑧</ci><ci id="S2.p2.9.m9.3.3.7.3.cmml" xref="S2.p2.9.m9.3.3.7.3">𝑡</ci></apply></apply><apply id="S2.p2.9.m9.3.3e.cmml" xref="S2.p2.9.m9.3.3"><in id="S2.p2.9.m9.3.3.8.cmml" xref="S2.p2.9.m9.3.3.8"></in><share href="#S2.p2.9.m9.3.3.7.cmml" id="S2.p2.9.m9.3.3f.cmml" xref="S2.p2.9.m9.3.3"></share><ci id="S2.p2.9.m9.3.3.9.cmml" xref="S2.p2.9.m9.3.3.9">𝒵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m9.3c">\mathbf{z}=(z_{1},\cdots,z_{T})\ni z_{t}\in\mathcal{Z}</annotation></semantics></math>, where <math id="S2.p2.10.m10.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S2.p2.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p2.10.m10.1.1" xref="S2.p2.10.m10.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S2.p2.10.m10.1b"><ci id="S2.p2.10.m10.1.1.cmml" xref="S2.p2.10.m10.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m10.1c">\mathcal{Z}</annotation></semantics></math> is the program token
vocabulary.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.9" class="ltx_p">The model we describe below assumes <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S2.p3.1.m1.1a"><mi id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\mathbf{z}</annotation></semantics></math>
is a latent variable that is observed only for a subset of datapoints in <math id="S2.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\mathcal{D}</annotation></semantics></math>.
<span id="S2.p3.9.7" class="ltx_text" style="color:#000000;">Concretely, the programs <math id="S2.p3.3.1.m1.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S2.p3.3.1.m1.1a"><mi mathcolor="#000000" id="S2.p3.3.1.m1.1.1" xref="S2.p3.3.1.m1.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S2.p3.3.1.m1.1b"><ci id="S2.p3.3.1.m1.1.1.cmml" xref="S2.p3.3.1.m1.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.1.m1.1c">\mathbf{z}</annotation></semantics></math> express (prefix-serializations of)
tree structured graphs. Computations are performed given this
symbolic representation by instantiating, for each symbol
<math id="S2.p3.4.2.m2.1" class="ltx_Math" alttext="z\in\mathcal{Z}" display="inline"><semantics id="S2.p3.4.2.m2.1a"><mrow id="S2.p3.4.2.m2.1.1" xref="S2.p3.4.2.m2.1.1.cmml"><mi mathcolor="#000000" id="S2.p3.4.2.m2.1.1.2" xref="S2.p3.4.2.m2.1.1.2.cmml">z</mi><mo mathcolor="#000000" id="S2.p3.4.2.m2.1.1.1" xref="S2.p3.4.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S2.p3.4.2.m2.1.1.3" xref="S2.p3.4.2.m2.1.1.3.cmml">𝒵</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.4.2.m2.1b"><apply id="S2.p3.4.2.m2.1.1.cmml" xref="S2.p3.4.2.m2.1.1"><in id="S2.p3.4.2.m2.1.1.1.cmml" xref="S2.p3.4.2.m2.1.1.1"></in><ci id="S2.p3.4.2.m2.1.1.2.cmml" xref="S2.p3.4.2.m2.1.1.2">𝑧</ci><ci id="S2.p3.4.2.m2.1.1.3.cmml" xref="S2.p3.4.2.m2.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.2.m2.1c">z\in\mathcal{Z}</annotation></semantics></math> a corresponding neural network (<a href="#S1.F1" title="In 1 Introduction ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>, right) with parameters
<math id="S2.p3.5.3.m3.1" class="ltx_Math" alttext="\theta_{z}" display="inline"><semantics id="S2.p3.5.3.m3.1a"><msub id="S2.p3.5.3.m3.1.1" xref="S2.p3.5.3.m3.1.1.cmml"><mi mathcolor="#000000" id="S2.p3.5.3.m3.1.1.2" xref="S2.p3.5.3.m3.1.1.2.cmml">θ</mi><mi mathcolor="#000000" id="S2.p3.5.3.m3.1.1.3" xref="S2.p3.5.3.m3.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.5.3.m3.1b"><apply id="S2.p3.5.3.m3.1.1.cmml" xref="S2.p3.5.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p3.5.3.m3.1.1.1.cmml" xref="S2.p3.5.3.m3.1.1">subscript</csymbol><ci id="S2.p3.5.3.m3.1.1.2.cmml" xref="S2.p3.5.3.m3.1.1.2">𝜃</ci><ci id="S2.p3.5.3.m3.1.1.3.cmml" xref="S2.p3.5.3.m3.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.3.m3.1c">\theta_{z}</annotation></semantics></math> (<a href="#S1.F1" title="In 1 Introduction ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>). That is, given a symbol in the program,
say <span id="S2.p3.9.7.1" class="ltx_text ltx_font_typewriter">find[green]</span>, the model instantiates parameters <math id="S2.p3.6.4.m4.1" class="ltx_Math" alttext="\theta_{\texttt{find[green]}}" display="inline"><semantics id="S2.p3.6.4.m4.1a"><msub id="S2.p3.6.4.m4.1.1" xref="S2.p3.6.4.m4.1.1.cmml"><mi mathcolor="#000000" id="S2.p3.6.4.m4.1.1.2" xref="S2.p3.6.4.m4.1.1.2.cmml">θ</mi><mtext class="ltx_mathvariant_monospace" mathcolor="#000000" id="S2.p3.6.4.m4.1.1.3" xref="S2.p3.6.4.m4.1.1.3a.cmml">find[green]</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.p3.6.4.m4.1b"><apply id="S2.p3.6.4.m4.1.1.cmml" xref="S2.p3.6.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p3.6.4.m4.1.1.1.cmml" xref="S2.p3.6.4.m4.1.1">subscript</csymbol><ci id="S2.p3.6.4.m4.1.1.2.cmml" xref="S2.p3.6.4.m4.1.1.2">𝜃</ci><ci id="S2.p3.6.4.m4.1.1.3a.cmml" xref="S2.p3.6.4.m4.1.1.3"><mtext class="ltx_mathvariant_monospace" mathcolor="#000000" mathsize="70%" id="S2.p3.6.4.m4.1.1.3.cmml" xref="S2.p3.6.4.m4.1.1.3">find[green]</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.4.m4.1c">\theta_{\texttt{find[green]}}</annotation></semantics></math>.
In this manner, the mapping <math id="S2.p3.7.5.m5.3" class="ltx_Math" alttext="p(a|\mathbf{i},\mathbf{z})" display="inline"><semantics id="S2.p3.7.5.m5.3a"><mrow id="S2.p3.7.5.m5.3.3" xref="S2.p3.7.5.m5.3.3.cmml"><mi mathcolor="#000000" id="S2.p3.7.5.m5.3.3.3" xref="S2.p3.7.5.m5.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.p3.7.5.m5.3.3.2" xref="S2.p3.7.5.m5.3.3.2.cmml">​</mo><mrow id="S2.p3.7.5.m5.3.3.1.1" xref="S2.p3.7.5.m5.3.3.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.p3.7.5.m5.3.3.1.1.2" xref="S2.p3.7.5.m5.3.3.1.1.1.cmml">(</mo><mrow id="S2.p3.7.5.m5.3.3.1.1.1" xref="S2.p3.7.5.m5.3.3.1.1.1.cmml"><mi mathcolor="#000000" id="S2.p3.7.5.m5.3.3.1.1.1.2" xref="S2.p3.7.5.m5.3.3.1.1.1.2.cmml">a</mi><mo fence="false" mathcolor="#000000" id="S2.p3.7.5.m5.3.3.1.1.1.1" xref="S2.p3.7.5.m5.3.3.1.1.1.1.cmml">|</mo><mrow id="S2.p3.7.5.m5.3.3.1.1.1.3.2" xref="S2.p3.7.5.m5.3.3.1.1.1.3.1.cmml"><mi mathcolor="#000000" id="S2.p3.7.5.m5.1.1" xref="S2.p3.7.5.m5.1.1.cmml">𝐢</mi><mo mathcolor="#000000" id="S2.p3.7.5.m5.3.3.1.1.1.3.2.1" xref="S2.p3.7.5.m5.3.3.1.1.1.3.1.cmml">,</mo><mi mathcolor="#000000" id="S2.p3.7.5.m5.2.2" xref="S2.p3.7.5.m5.2.2.cmml">𝐳</mi></mrow></mrow><mo mathcolor="#000000" stretchy="false" id="S2.p3.7.5.m5.3.3.1.1.3" xref="S2.p3.7.5.m5.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.7.5.m5.3b"><apply id="S2.p3.7.5.m5.3.3.cmml" xref="S2.p3.7.5.m5.3.3"><times id="S2.p3.7.5.m5.3.3.2.cmml" xref="S2.p3.7.5.m5.3.3.2"></times><ci id="S2.p3.7.5.m5.3.3.3.cmml" xref="S2.p3.7.5.m5.3.3.3">𝑝</ci><apply id="S2.p3.7.5.m5.3.3.1.1.1.cmml" xref="S2.p3.7.5.m5.3.3.1.1"><csymbol cd="latexml" id="S2.p3.7.5.m5.3.3.1.1.1.1.cmml" xref="S2.p3.7.5.m5.3.3.1.1.1.1">conditional</csymbol><ci id="S2.p3.7.5.m5.3.3.1.1.1.2.cmml" xref="S2.p3.7.5.m5.3.3.1.1.1.2">𝑎</ci><list id="S2.p3.7.5.m5.3.3.1.1.1.3.1.cmml" xref="S2.p3.7.5.m5.3.3.1.1.1.3.2"><ci id="S2.p3.7.5.m5.1.1.cmml" xref="S2.p3.7.5.m5.1.1">𝐢</ci><ci id="S2.p3.7.5.m5.2.2.cmml" xref="S2.p3.7.5.m5.2.2">𝐳</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.5.m5.3c">p(a|\mathbf{i},\mathbf{z})</annotation></semantics></math> is operationalized as <math id="S2.p3.8.6.m6.2" class="ltx_Math" alttext="p(a|\mathbf{i};\theta_{\mathbf{z}})" display="inline"><semantics id="S2.p3.8.6.m6.2a"><mrow id="S2.p3.8.6.m6.2.2" xref="S2.p3.8.6.m6.2.2.cmml"><mi mathcolor="#000000" id="S2.p3.8.6.m6.2.2.3" xref="S2.p3.8.6.m6.2.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.p3.8.6.m6.2.2.2" xref="S2.p3.8.6.m6.2.2.2.cmml">​</mo><mrow id="S2.p3.8.6.m6.2.2.1.1" xref="S2.p3.8.6.m6.2.2.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.p3.8.6.m6.2.2.1.1.2" xref="S2.p3.8.6.m6.2.2.1.1.1.cmml">(</mo><mrow id="S2.p3.8.6.m6.2.2.1.1.1" xref="S2.p3.8.6.m6.2.2.1.1.1.cmml"><mi mathcolor="#000000" id="S2.p3.8.6.m6.2.2.1.1.1.3" xref="S2.p3.8.6.m6.2.2.1.1.1.3.cmml">a</mi><mo fence="false" mathcolor="#000000" id="S2.p3.8.6.m6.2.2.1.1.1.2" xref="S2.p3.8.6.m6.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.p3.8.6.m6.2.2.1.1.1.1.1" xref="S2.p3.8.6.m6.2.2.1.1.1.1.2.cmml"><mi mathcolor="#000000" id="S2.p3.8.6.m6.1.1" xref="S2.p3.8.6.m6.1.1.cmml">𝐢</mi><mo mathcolor="#000000" id="S2.p3.8.6.m6.2.2.1.1.1.1.1.2" xref="S2.p3.8.6.m6.2.2.1.1.1.1.2.cmml">;</mo><msub id="S2.p3.8.6.m6.2.2.1.1.1.1.1.1" xref="S2.p3.8.6.m6.2.2.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S2.p3.8.6.m6.2.2.1.1.1.1.1.1.2" xref="S2.p3.8.6.m6.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mi mathcolor="#000000" id="S2.p3.8.6.m6.2.2.1.1.1.1.1.1.3" xref="S2.p3.8.6.m6.2.2.1.1.1.1.1.1.3.cmml">𝐳</mi></msub></mrow></mrow><mo mathcolor="#000000" stretchy="false" id="S2.p3.8.6.m6.2.2.1.1.3" xref="S2.p3.8.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.8.6.m6.2b"><apply id="S2.p3.8.6.m6.2.2.cmml" xref="S2.p3.8.6.m6.2.2"><times id="S2.p3.8.6.m6.2.2.2.cmml" xref="S2.p3.8.6.m6.2.2.2"></times><ci id="S2.p3.8.6.m6.2.2.3.cmml" xref="S2.p3.8.6.m6.2.2.3">𝑝</ci><apply id="S2.p3.8.6.m6.2.2.1.1.1.cmml" xref="S2.p3.8.6.m6.2.2.1.1"><csymbol cd="latexml" id="S2.p3.8.6.m6.2.2.1.1.1.2.cmml" xref="S2.p3.8.6.m6.2.2.1.1.1.2">conditional</csymbol><ci id="S2.p3.8.6.m6.2.2.1.1.1.3.cmml" xref="S2.p3.8.6.m6.2.2.1.1.1.3">𝑎</ci><list id="S2.p3.8.6.m6.2.2.1.1.1.1.2.cmml" xref="S2.p3.8.6.m6.2.2.1.1.1.1.1"><ci id="S2.p3.8.6.m6.1.1.cmml" xref="S2.p3.8.6.m6.1.1">𝐢</ci><apply id="S2.p3.8.6.m6.2.2.1.1.1.1.1.1.cmml" xref="S2.p3.8.6.m6.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.8.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p3.8.6.m6.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.8.6.m6.2.2.1.1.1.1.1.1.2.cmml" xref="S2.p3.8.6.m6.2.2.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.p3.8.6.m6.2.2.1.1.1.1.1.1.3.cmml" xref="S2.p3.8.6.m6.2.2.1.1.1.1.1.1.3">𝐳</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.6.m6.2c">p(a|\mathbf{i};\theta_{\mathbf{z}})</annotation></semantics></math>,
where <math id="S2.p3.9.7.m7.1" class="ltx_Math" alttext="\theta_{\mathbf{z}}=\{\theta_{z_{t}}\}_{t=1}^{T}" display="inline"><semantics id="S2.p3.9.7.m7.1a"><mrow id="S2.p3.9.7.m7.1.1" xref="S2.p3.9.7.m7.1.1.cmml"><msub id="S2.p3.9.7.m7.1.1.3" xref="S2.p3.9.7.m7.1.1.3.cmml"><mi mathcolor="#000000" id="S2.p3.9.7.m7.1.1.3.2" xref="S2.p3.9.7.m7.1.1.3.2.cmml">θ</mi><mi mathcolor="#000000" id="S2.p3.9.7.m7.1.1.3.3" xref="S2.p3.9.7.m7.1.1.3.3.cmml">𝐳</mi></msub><mo mathcolor="#000000" id="S2.p3.9.7.m7.1.1.2" xref="S2.p3.9.7.m7.1.1.2.cmml">=</mo><msubsup id="S2.p3.9.7.m7.1.1.1" xref="S2.p3.9.7.m7.1.1.1.cmml"><mrow id="S2.p3.9.7.m7.1.1.1.1.1.1" xref="S2.p3.9.7.m7.1.1.1.1.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.p3.9.7.m7.1.1.1.1.1.1.2" xref="S2.p3.9.7.m7.1.1.1.1.1.2.cmml">{</mo><msub id="S2.p3.9.7.m7.1.1.1.1.1.1.1" xref="S2.p3.9.7.m7.1.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S2.p3.9.7.m7.1.1.1.1.1.1.1.2" xref="S2.p3.9.7.m7.1.1.1.1.1.1.1.2.cmml">θ</mi><msub id="S2.p3.9.7.m7.1.1.1.1.1.1.1.3" xref="S2.p3.9.7.m7.1.1.1.1.1.1.1.3.cmml"><mi mathcolor="#000000" id="S2.p3.9.7.m7.1.1.1.1.1.1.1.3.2" xref="S2.p3.9.7.m7.1.1.1.1.1.1.1.3.2.cmml">z</mi><mi mathcolor="#000000" id="S2.p3.9.7.m7.1.1.1.1.1.1.1.3.3" xref="S2.p3.9.7.m7.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></msub><mo mathcolor="#000000" stretchy="false" id="S2.p3.9.7.m7.1.1.1.1.1.1.3" xref="S2.p3.9.7.m7.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p3.9.7.m7.1.1.1.1.3" xref="S2.p3.9.7.m7.1.1.1.1.3.cmml"><mi mathcolor="#000000" id="S2.p3.9.7.m7.1.1.1.1.3.2" xref="S2.p3.9.7.m7.1.1.1.1.3.2.cmml">t</mi><mo mathcolor="#000000" id="S2.p3.9.7.m7.1.1.1.1.3.1" xref="S2.p3.9.7.m7.1.1.1.1.3.1.cmml">=</mo><mn mathcolor="#000000" id="S2.p3.9.7.m7.1.1.1.1.3.3" xref="S2.p3.9.7.m7.1.1.1.1.3.3.cmml">1</mn></mrow><mi mathcolor="#000000" id="S2.p3.9.7.m7.1.1.1.3" xref="S2.p3.9.7.m7.1.1.1.3.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.9.7.m7.1b"><apply id="S2.p3.9.7.m7.1.1.cmml" xref="S2.p3.9.7.m7.1.1"><eq id="S2.p3.9.7.m7.1.1.2.cmml" xref="S2.p3.9.7.m7.1.1.2"></eq><apply id="S2.p3.9.7.m7.1.1.3.cmml" xref="S2.p3.9.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.p3.9.7.m7.1.1.3.1.cmml" xref="S2.p3.9.7.m7.1.1.3">subscript</csymbol><ci id="S2.p3.9.7.m7.1.1.3.2.cmml" xref="S2.p3.9.7.m7.1.1.3.2">𝜃</ci><ci id="S2.p3.9.7.m7.1.1.3.3.cmml" xref="S2.p3.9.7.m7.1.1.3.3">𝐳</ci></apply><apply id="S2.p3.9.7.m7.1.1.1.cmml" xref="S2.p3.9.7.m7.1.1.1"><csymbol cd="ambiguous" id="S2.p3.9.7.m7.1.1.1.2.cmml" xref="S2.p3.9.7.m7.1.1.1">superscript</csymbol><apply id="S2.p3.9.7.m7.1.1.1.1.cmml" xref="S2.p3.9.7.m7.1.1.1"><csymbol cd="ambiguous" id="S2.p3.9.7.m7.1.1.1.1.2.cmml" xref="S2.p3.9.7.m7.1.1.1">subscript</csymbol><set id="S2.p3.9.7.m7.1.1.1.1.1.2.cmml" xref="S2.p3.9.7.m7.1.1.1.1.1.1"><apply id="S2.p3.9.7.m7.1.1.1.1.1.1.1.cmml" xref="S2.p3.9.7.m7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.9.7.m7.1.1.1.1.1.1.1.1.cmml" xref="S2.p3.9.7.m7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.9.7.m7.1.1.1.1.1.1.1.2.cmml" xref="S2.p3.9.7.m7.1.1.1.1.1.1.1.2">𝜃</ci><apply id="S2.p3.9.7.m7.1.1.1.1.1.1.1.3.cmml" xref="S2.p3.9.7.m7.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.9.7.m7.1.1.1.1.1.1.1.3.1.cmml" xref="S2.p3.9.7.m7.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p3.9.7.m7.1.1.1.1.1.1.1.3.2.cmml" xref="S2.p3.9.7.m7.1.1.1.1.1.1.1.3.2">𝑧</ci><ci id="S2.p3.9.7.m7.1.1.1.1.1.1.1.3.3.cmml" xref="S2.p3.9.7.m7.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></set><apply id="S2.p3.9.7.m7.1.1.1.1.3.cmml" xref="S2.p3.9.7.m7.1.1.1.1.3"><eq id="S2.p3.9.7.m7.1.1.1.1.3.1.cmml" xref="S2.p3.9.7.m7.1.1.1.1.3.1"></eq><ci id="S2.p3.9.7.m7.1.1.1.1.3.2.cmml" xref="S2.p3.9.7.m7.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S2.p3.9.7.m7.1.1.1.1.3.3.cmml" xref="S2.p3.9.7.m7.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p3.9.7.m7.1.1.1.3.cmml" xref="S2.p3.9.7.m7.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.9.7.m7.1c">\theta_{\mathbf{z}}=\{\theta_{z_{t}}\}_{t=1}^{T}</annotation></semantics></math>.</span></p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.8" class="ltx_p"><span id="S2.p4.8.8" class="ltx_text" style="color:#000000;">Our model factorizes as
<math id="S2.p4.1.1.m1.7" class="ltx_Math" alttext="p(\mathbf{x},\mathbf{z},a|\mathbf{i})=p(\mathbf{z})p(\mathbf{x}|\mathbf{z})p(a|\mathbf{i};\theta_{\mathbf{z}})" display="inline"><semantics id="S2.p4.1.1.m1.7a"><mrow id="S2.p4.1.1.m1.7.7" xref="S2.p4.1.1.m1.7.7.cmml"><mrow id="S2.p4.1.1.m1.5.5.1" xref="S2.p4.1.1.m1.5.5.1.cmml"><mi mathcolor="#000000" id="S2.p4.1.1.m1.5.5.1.3" xref="S2.p4.1.1.m1.5.5.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.p4.1.1.m1.5.5.1.2" xref="S2.p4.1.1.m1.5.5.1.2.cmml">​</mo><mrow id="S2.p4.1.1.m1.5.5.1.1.1" xref="S2.p4.1.1.m1.5.5.1.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.p4.1.1.m1.5.5.1.1.1.2" xref="S2.p4.1.1.m1.5.5.1.1.2.cmml">(</mo><mi mathcolor="#000000" id="S2.p4.1.1.m1.1.1" xref="S2.p4.1.1.m1.1.1.cmml">𝐱</mi><mo mathcolor="#000000" id="S2.p4.1.1.m1.5.5.1.1.1.3" xref="S2.p4.1.1.m1.5.5.1.1.2.cmml">,</mo><mi mathcolor="#000000" id="S2.p4.1.1.m1.2.2" xref="S2.p4.1.1.m1.2.2.cmml">𝐳</mi><mo mathcolor="#000000" id="S2.p4.1.1.m1.5.5.1.1.1.4" xref="S2.p4.1.1.m1.5.5.1.1.2.cmml">,</mo><mrow id="S2.p4.1.1.m1.5.5.1.1.1.1" xref="S2.p4.1.1.m1.5.5.1.1.1.1.cmml"><mi mathcolor="#000000" id="S2.p4.1.1.m1.5.5.1.1.1.1.2" xref="S2.p4.1.1.m1.5.5.1.1.1.1.2.cmml">a</mi><mo fence="false" mathcolor="#000000" id="S2.p4.1.1.m1.5.5.1.1.1.1.1" xref="S2.p4.1.1.m1.5.5.1.1.1.1.1.cmml">|</mo><mi mathcolor="#000000" id="S2.p4.1.1.m1.5.5.1.1.1.1.3" xref="S2.p4.1.1.m1.5.5.1.1.1.1.3.cmml">𝐢</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S2.p4.1.1.m1.5.5.1.1.1.5" xref="S2.p4.1.1.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo mathcolor="#000000" id="S2.p4.1.1.m1.7.7.4" xref="S2.p4.1.1.m1.7.7.4.cmml">=</mo><mrow id="S2.p4.1.1.m1.7.7.3" xref="S2.p4.1.1.m1.7.7.3.cmml"><mi mathcolor="#000000" id="S2.p4.1.1.m1.7.7.3.4" xref="S2.p4.1.1.m1.7.7.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.p4.1.1.m1.7.7.3.3" xref="S2.p4.1.1.m1.7.7.3.3.cmml">​</mo><mrow id="S2.p4.1.1.m1.7.7.3.5.2" xref="S2.p4.1.1.m1.7.7.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.p4.1.1.m1.7.7.3.5.2.1" xref="S2.p4.1.1.m1.7.7.3.cmml">(</mo><mi mathcolor="#000000" id="S2.p4.1.1.m1.3.3" xref="S2.p4.1.1.m1.3.3.cmml">𝐳</mi><mo mathcolor="#000000" stretchy="false" id="S2.p4.1.1.m1.7.7.3.5.2.2" xref="S2.p4.1.1.m1.7.7.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.p4.1.1.m1.7.7.3.3a" xref="S2.p4.1.1.m1.7.7.3.3.cmml">​</mo><mi mathcolor="#000000" id="S2.p4.1.1.m1.7.7.3.6" xref="S2.p4.1.1.m1.7.7.3.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.p4.1.1.m1.7.7.3.3b" xref="S2.p4.1.1.m1.7.7.3.3.cmml">​</mo><mrow id="S2.p4.1.1.m1.6.6.2.1.1" xref="S2.p4.1.1.m1.6.6.2.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.p4.1.1.m1.6.6.2.1.1.2" xref="S2.p4.1.1.m1.6.6.2.1.1.1.cmml">(</mo><mrow id="S2.p4.1.1.m1.6.6.2.1.1.1" xref="S2.p4.1.1.m1.6.6.2.1.1.1.cmml"><mi mathcolor="#000000" id="S2.p4.1.1.m1.6.6.2.1.1.1.2" xref="S2.p4.1.1.m1.6.6.2.1.1.1.2.cmml">𝐱</mi><mo fence="false" mathcolor="#000000" id="S2.p4.1.1.m1.6.6.2.1.1.1.1" xref="S2.p4.1.1.m1.6.6.2.1.1.1.1.cmml">|</mo><mi mathcolor="#000000" id="S2.p4.1.1.m1.6.6.2.1.1.1.3" xref="S2.p4.1.1.m1.6.6.2.1.1.1.3.cmml">𝐳</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S2.p4.1.1.m1.6.6.2.1.1.3" xref="S2.p4.1.1.m1.6.6.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.p4.1.1.m1.7.7.3.3c" xref="S2.p4.1.1.m1.7.7.3.3.cmml">​</mo><mi mathcolor="#000000" id="S2.p4.1.1.m1.7.7.3.7" xref="S2.p4.1.1.m1.7.7.3.7.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.p4.1.1.m1.7.7.3.3d" xref="S2.p4.1.1.m1.7.7.3.3.cmml">​</mo><mrow id="S2.p4.1.1.m1.7.7.3.2.1" xref="S2.p4.1.1.m1.7.7.3.2.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.p4.1.1.m1.7.7.3.2.1.2" xref="S2.p4.1.1.m1.7.7.3.2.1.1.cmml">(</mo><mrow id="S2.p4.1.1.m1.7.7.3.2.1.1" xref="S2.p4.1.1.m1.7.7.3.2.1.1.cmml"><mi mathcolor="#000000" id="S2.p4.1.1.m1.7.7.3.2.1.1.3" xref="S2.p4.1.1.m1.7.7.3.2.1.1.3.cmml">a</mi><mo fence="false" mathcolor="#000000" id="S2.p4.1.1.m1.7.7.3.2.1.1.2" xref="S2.p4.1.1.m1.7.7.3.2.1.1.2.cmml">|</mo><mrow id="S2.p4.1.1.m1.7.7.3.2.1.1.1.1" xref="S2.p4.1.1.m1.7.7.3.2.1.1.1.2.cmml"><mi mathcolor="#000000" id="S2.p4.1.1.m1.4.4" xref="S2.p4.1.1.m1.4.4.cmml">𝐢</mi><mo mathcolor="#000000" id="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.2" xref="S2.p4.1.1.m1.7.7.3.2.1.1.1.2.cmml">;</mo><msub id="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1" xref="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1.2" xref="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1.2.cmml">θ</mi><mi mathcolor="#000000" id="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1.3" xref="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1.3.cmml">𝐳</mi></msub></mrow></mrow><mo mathcolor="#000000" stretchy="false" id="S2.p4.1.1.m1.7.7.3.2.1.3" xref="S2.p4.1.1.m1.7.7.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.1.1.m1.7b"><apply id="S2.p4.1.1.m1.7.7.cmml" xref="S2.p4.1.1.m1.7.7"><eq id="S2.p4.1.1.m1.7.7.4.cmml" xref="S2.p4.1.1.m1.7.7.4"></eq><apply id="S2.p4.1.1.m1.5.5.1.cmml" xref="S2.p4.1.1.m1.5.5.1"><times id="S2.p4.1.1.m1.5.5.1.2.cmml" xref="S2.p4.1.1.m1.5.5.1.2"></times><ci id="S2.p4.1.1.m1.5.5.1.3.cmml" xref="S2.p4.1.1.m1.5.5.1.3">𝑝</ci><vector id="S2.p4.1.1.m1.5.5.1.1.2.cmml" xref="S2.p4.1.1.m1.5.5.1.1.1"><ci id="S2.p4.1.1.m1.1.1.cmml" xref="S2.p4.1.1.m1.1.1">𝐱</ci><ci id="S2.p4.1.1.m1.2.2.cmml" xref="S2.p4.1.1.m1.2.2">𝐳</ci><apply id="S2.p4.1.1.m1.5.5.1.1.1.1.cmml" xref="S2.p4.1.1.m1.5.5.1.1.1.1"><csymbol cd="latexml" id="S2.p4.1.1.m1.5.5.1.1.1.1.1.cmml" xref="S2.p4.1.1.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S2.p4.1.1.m1.5.5.1.1.1.1.2.cmml" xref="S2.p4.1.1.m1.5.5.1.1.1.1.2">𝑎</ci><ci id="S2.p4.1.1.m1.5.5.1.1.1.1.3.cmml" xref="S2.p4.1.1.m1.5.5.1.1.1.1.3">𝐢</ci></apply></vector></apply><apply id="S2.p4.1.1.m1.7.7.3.cmml" xref="S2.p4.1.1.m1.7.7.3"><times id="S2.p4.1.1.m1.7.7.3.3.cmml" xref="S2.p4.1.1.m1.7.7.3.3"></times><ci id="S2.p4.1.1.m1.7.7.3.4.cmml" xref="S2.p4.1.1.m1.7.7.3.4">𝑝</ci><ci id="S2.p4.1.1.m1.3.3.cmml" xref="S2.p4.1.1.m1.3.3">𝐳</ci><ci id="S2.p4.1.1.m1.7.7.3.6.cmml" xref="S2.p4.1.1.m1.7.7.3.6">𝑝</ci><apply id="S2.p4.1.1.m1.6.6.2.1.1.1.cmml" xref="S2.p4.1.1.m1.6.6.2.1.1"><csymbol cd="latexml" id="S2.p4.1.1.m1.6.6.2.1.1.1.1.cmml" xref="S2.p4.1.1.m1.6.6.2.1.1.1.1">conditional</csymbol><ci id="S2.p4.1.1.m1.6.6.2.1.1.1.2.cmml" xref="S2.p4.1.1.m1.6.6.2.1.1.1.2">𝐱</ci><ci id="S2.p4.1.1.m1.6.6.2.1.1.1.3.cmml" xref="S2.p4.1.1.m1.6.6.2.1.1.1.3">𝐳</ci></apply><ci id="S2.p4.1.1.m1.7.7.3.7.cmml" xref="S2.p4.1.1.m1.7.7.3.7">𝑝</ci><apply id="S2.p4.1.1.m1.7.7.3.2.1.1.cmml" xref="S2.p4.1.1.m1.7.7.3.2.1"><csymbol cd="latexml" id="S2.p4.1.1.m1.7.7.3.2.1.1.2.cmml" xref="S2.p4.1.1.m1.7.7.3.2.1.1.2">conditional</csymbol><ci id="S2.p4.1.1.m1.7.7.3.2.1.1.3.cmml" xref="S2.p4.1.1.m1.7.7.3.2.1.1.3">𝑎</ci><list id="S2.p4.1.1.m1.7.7.3.2.1.1.1.2.cmml" xref="S2.p4.1.1.m1.7.7.3.2.1.1.1.1"><ci id="S2.p4.1.1.m1.4.4.cmml" xref="S2.p4.1.1.m1.4.4">𝐢</ci><apply id="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1.cmml" xref="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1.1.cmml" xref="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1">subscript</csymbol><ci id="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1.2.cmml" xref="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1.2">𝜃</ci><ci id="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1.3.cmml" xref="S2.p4.1.1.m1.7.7.3.2.1.1.1.1.1.3">𝐳</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.1.m1.7c">p(\mathbf{x},\mathbf{z},a|\mathbf{i})=p(\mathbf{z})p(\mathbf{x}|\mathbf{z})p(a|\mathbf{i};\theta_{\mathbf{z}})</annotation></semantics></math>
(see <a href="#S1.F1" title="In 1 Introduction ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>), where parameters <math id="S2.p4.2.2.m2.1" class="ltx_Math" alttext="\theta_{\mathbf{z}}" display="inline"><semantics id="S2.p4.2.2.m2.1a"><msub id="S2.p4.2.2.m2.1.1" xref="S2.p4.2.2.m2.1.1.cmml"><mi mathcolor="#000000" id="S2.p4.2.2.m2.1.1.2" xref="S2.p4.2.2.m2.1.1.2.cmml">θ</mi><mi mathcolor="#000000" id="S2.p4.2.2.m2.1.1.3" xref="S2.p4.2.2.m2.1.1.3.cmml">𝐳</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p4.2.2.m2.1b"><apply id="S2.p4.2.2.m2.1.1.cmml" xref="S2.p4.2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p4.2.2.m2.1.1.1.cmml" xref="S2.p4.2.2.m2.1.1">subscript</csymbol><ci id="S2.p4.2.2.m2.1.1.2.cmml" xref="S2.p4.2.2.m2.1.1.2">𝜃</ci><ci id="S2.p4.2.2.m2.1.1.3.cmml" xref="S2.p4.2.2.m2.1.1.3">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.2.m2.1c">\theta_{\mathbf{z}}</annotation></semantics></math>
are a deterministic node in the graph instantiated given the program
<math id="S2.p4.3.3.m3.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S2.p4.3.3.m3.1a"><mi mathcolor="#000000" id="S2.p4.3.3.m3.1.1" xref="S2.p4.3.3.m3.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S2.p4.3.3.m3.1b"><ci id="S2.p4.3.3.m3.1.1.cmml" xref="S2.p4.3.3.m3.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.3.m3.1c">\mathbf{z}</annotation></semantics></math> and <math id="S2.p4.4.4.m4.1" class="ltx_Math" alttext="\theta_{\mathcal{Z}}" display="inline"><semantics id="S2.p4.4.4.m4.1a"><msub id="S2.p4.4.4.m4.1.1" xref="S2.p4.4.4.m4.1.1.cmml"><mi mathcolor="#000000" id="S2.p4.4.4.m4.1.1.2" xref="S2.p4.4.4.m4.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S2.p4.4.4.m4.1.1.3" xref="S2.p4.4.4.m4.1.1.3.cmml">𝒵</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p4.4.4.m4.1b"><apply id="S2.p4.4.4.m4.1.1.cmml" xref="S2.p4.4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p4.4.4.m4.1.1.1.cmml" xref="S2.p4.4.4.m4.1.1">subscript</csymbol><ci id="S2.p4.4.4.m4.1.1.2.cmml" xref="S2.p4.4.4.m4.1.1.2">𝜃</ci><ci id="S2.p4.4.4.m4.1.1.3.cmml" xref="S2.p4.4.4.m4.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.4.m4.1c">\theta_{\mathcal{Z}}</annotation></semantics></math> (which
represents the concatenation of parameters across all tokens in <math id="S2.p4.5.5.m5.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S2.p4.5.5.m5.1a"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S2.p4.5.5.m5.1.1" xref="S2.p4.5.5.m5.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S2.p4.5.5.m5.1b"><ci id="S2.p4.5.5.m5.1.1.cmml" xref="S2.p4.5.5.m5.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.5.5.m5.1c">\mathcal{Z}</annotation></semantics></math>).
In addition
to the generative model, we also use an inference network <math id="S2.p4.6.6.m6.1" class="ltx_Math" alttext="q_{\phi}(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S2.p4.6.6.m6.1a"><mrow id="S2.p4.6.6.m6.1.1" xref="S2.p4.6.6.m6.1.1.cmml"><msub id="S2.p4.6.6.m6.1.1.3" xref="S2.p4.6.6.m6.1.1.3.cmml"><mi mathcolor="#000000" id="S2.p4.6.6.m6.1.1.3.2" xref="S2.p4.6.6.m6.1.1.3.2.cmml">q</mi><mi mathcolor="#000000" id="S2.p4.6.6.m6.1.1.3.3" xref="S2.p4.6.6.m6.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.p4.6.6.m6.1.1.2" xref="S2.p4.6.6.m6.1.1.2.cmml">​</mo><mrow id="S2.p4.6.6.m6.1.1.1.1" xref="S2.p4.6.6.m6.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.p4.6.6.m6.1.1.1.1.2" xref="S2.p4.6.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S2.p4.6.6.m6.1.1.1.1.1" xref="S2.p4.6.6.m6.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S2.p4.6.6.m6.1.1.1.1.1.2" xref="S2.p4.6.6.m6.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" mathcolor="#000000" id="S2.p4.6.6.m6.1.1.1.1.1.1" xref="S2.p4.6.6.m6.1.1.1.1.1.1.cmml">|</mo><mi mathcolor="#000000" id="S2.p4.6.6.m6.1.1.1.1.1.3" xref="S2.p4.6.6.m6.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S2.p4.6.6.m6.1.1.1.1.3" xref="S2.p4.6.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.6.6.m6.1b"><apply id="S2.p4.6.6.m6.1.1.cmml" xref="S2.p4.6.6.m6.1.1"><times id="S2.p4.6.6.m6.1.1.2.cmml" xref="S2.p4.6.6.m6.1.1.2"></times><apply id="S2.p4.6.6.m6.1.1.3.cmml" xref="S2.p4.6.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.p4.6.6.m6.1.1.3.1.cmml" xref="S2.p4.6.6.m6.1.1.3">subscript</csymbol><ci id="S2.p4.6.6.m6.1.1.3.2.cmml" xref="S2.p4.6.6.m6.1.1.3.2">𝑞</ci><ci id="S2.p4.6.6.m6.1.1.3.3.cmml" xref="S2.p4.6.6.m6.1.1.3.3">italic-ϕ</ci></apply><apply id="S2.p4.6.6.m6.1.1.1.1.1.cmml" xref="S2.p4.6.6.m6.1.1.1.1"><csymbol cd="latexml" id="S2.p4.6.6.m6.1.1.1.1.1.1.cmml" xref="S2.p4.6.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p4.6.6.m6.1.1.1.1.1.2.cmml" xref="S2.p4.6.6.m6.1.1.1.1.1.2">𝐳</ci><ci id="S2.p4.6.6.m6.1.1.1.1.1.3.cmml" xref="S2.p4.6.6.m6.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.6.6.m6.1c">q_{\phi}(\mathbf{z}|\mathbf{x})</annotation></semantics></math>
to map questions to latent structured programs. Thus, the generative parameters
in the model are <math id="S2.p4.7.7.m7.2" class="ltx_Math" alttext="\{\theta_{\mathcal{Z}},\sigma\}" display="inline"><semantics id="S2.p4.7.7.m7.2a"><mrow id="S2.p4.7.7.m7.2.2.1" xref="S2.p4.7.7.m7.2.2.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.p4.7.7.m7.2.2.1.2" xref="S2.p4.7.7.m7.2.2.2.cmml">{</mo><msub id="S2.p4.7.7.m7.2.2.1.1" xref="S2.p4.7.7.m7.2.2.1.1.cmml"><mi mathcolor="#000000" id="S2.p4.7.7.m7.2.2.1.1.2" xref="S2.p4.7.7.m7.2.2.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S2.p4.7.7.m7.2.2.1.1.3" xref="S2.p4.7.7.m7.2.2.1.1.3.cmml">𝒵</mi></msub><mo mathcolor="#000000" id="S2.p4.7.7.m7.2.2.1.3" xref="S2.p4.7.7.m7.2.2.2.cmml">,</mo><mi mathcolor="#000000" id="S2.p4.7.7.m7.1.1" xref="S2.p4.7.7.m7.1.1.cmml">σ</mi><mo mathcolor="#000000" stretchy="false" id="S2.p4.7.7.m7.2.2.1.4" xref="S2.p4.7.7.m7.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.7.7.m7.2b"><set id="S2.p4.7.7.m7.2.2.2.cmml" xref="S2.p4.7.7.m7.2.2.1"><apply id="S2.p4.7.7.m7.2.2.1.1.cmml" xref="S2.p4.7.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S2.p4.7.7.m7.2.2.1.1.1.cmml" xref="S2.p4.7.7.m7.2.2.1.1">subscript</csymbol><ci id="S2.p4.7.7.m7.2.2.1.1.2.cmml" xref="S2.p4.7.7.m7.2.2.1.1.2">𝜃</ci><ci id="S2.p4.7.7.m7.2.2.1.1.3.cmml" xref="S2.p4.7.7.m7.2.2.1.1.3">𝒵</ci></apply><ci id="S2.p4.7.7.m7.1.1.cmml" xref="S2.p4.7.7.m7.1.1">𝜎</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.7.7.m7.2c">\{\theta_{\mathcal{Z}},\sigma\}</annotation></semantics></math>, and inference parameters are <math id="S2.p4.8.8.m8.1" class="ltx_Math" alttext="{\phi}" display="inline"><semantics id="S2.p4.8.8.m8.1a"><mi mathcolor="#000000" id="S2.p4.8.8.m8.1.1" xref="S2.p4.8.8.m8.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.p4.8.8.m8.1b"><ci id="S2.p4.8.8.m8.1.1.cmml" xref="S2.p4.8.8.m8.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.8.8.m8.1c">{\phi}</annotation></semantics></math>.</span></p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Parameterization</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.6" class="ltx_p"><span id="S2.SS1.p1.6.6" class="ltx_text" style="color:#000000;">The terms <math id="S2.SS1.p1.1.1.m1.1" class="ltx_Math" alttext="p(\mathbf{z})" display="inline"><semantics id="S2.SS1.p1.1.1.m1.1a"><mrow id="S2.SS1.p1.1.1.m1.1.2" xref="S2.SS1.p1.1.1.m1.1.2.cmml"><mi mathcolor="#000000" id="S2.SS1.p1.1.1.m1.1.2.2" xref="S2.SS1.p1.1.1.m1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.1.1.m1.1.2.1" xref="S2.SS1.p1.1.1.m1.1.2.1.cmml">​</mo><mrow id="S2.SS1.p1.1.1.m1.1.2.3.2" xref="S2.SS1.p1.1.1.m1.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.SS1.p1.1.1.m1.1.2.3.2.1" xref="S2.SS1.p1.1.1.m1.1.2.cmml">(</mo><mi mathcolor="#000000" id="S2.SS1.p1.1.1.m1.1.1" xref="S2.SS1.p1.1.1.m1.1.1.cmml">𝐳</mi><mo mathcolor="#000000" stretchy="false" id="S2.SS1.p1.1.1.m1.1.2.3.2.2" xref="S2.SS1.p1.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.1.m1.1b"><apply id="S2.SS1.p1.1.1.m1.1.2.cmml" xref="S2.SS1.p1.1.1.m1.1.2"><times id="S2.SS1.p1.1.1.m1.1.2.1.cmml" xref="S2.SS1.p1.1.1.m1.1.2.1"></times><ci id="S2.SS1.p1.1.1.m1.1.2.2.cmml" xref="S2.SS1.p1.1.1.m1.1.2.2">𝑝</ci><ci id="S2.SS1.p1.1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.1.m1.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.1.m1.1c">p(\mathbf{z})</annotation></semantics></math>, <math id="S2.SS1.p1.2.2.m2.1" class="ltx_Math" alttext="p_{\sigma}(\mathbf{x}|\mathbf{z})" display="inline"><semantics id="S2.SS1.p1.2.2.m2.1a"><mrow id="S2.SS1.p1.2.2.m2.1.1" xref="S2.SS1.p1.2.2.m2.1.1.cmml"><msub id="S2.SS1.p1.2.2.m2.1.1.3" xref="S2.SS1.p1.2.2.m2.1.1.3.cmml"><mi mathcolor="#000000" id="S2.SS1.p1.2.2.m2.1.1.3.2" xref="S2.SS1.p1.2.2.m2.1.1.3.2.cmml">p</mi><mi mathcolor="#000000" id="S2.SS1.p1.2.2.m2.1.1.3.3" xref="S2.SS1.p1.2.2.m2.1.1.3.3.cmml">σ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.2.2.m2.1.1.2" xref="S2.SS1.p1.2.2.m2.1.1.2.cmml">​</mo><mrow id="S2.SS1.p1.2.2.m2.1.1.1.1" xref="S2.SS1.p1.2.2.m2.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.SS1.p1.2.2.m2.1.1.1.1.2" xref="S2.SS1.p1.2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.2.2.m2.1.1.1.1.1" xref="S2.SS1.p1.2.2.m2.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S2.SS1.p1.2.2.m2.1.1.1.1.1.2" xref="S2.SS1.p1.2.2.m2.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" mathcolor="#000000" id="S2.SS1.p1.2.2.m2.1.1.1.1.1.1" xref="S2.SS1.p1.2.2.m2.1.1.1.1.1.1.cmml">|</mo><mi mathcolor="#000000" id="S2.SS1.p1.2.2.m2.1.1.1.1.1.3" xref="S2.SS1.p1.2.2.m2.1.1.1.1.1.3.cmml">𝐳</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S2.SS1.p1.2.2.m2.1.1.1.1.3" xref="S2.SS1.p1.2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.2.m2.1b"><apply id="S2.SS1.p1.2.2.m2.1.1.cmml" xref="S2.SS1.p1.2.2.m2.1.1"><times id="S2.SS1.p1.2.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.2.m2.1.1.2"></times><apply id="S2.SS1.p1.2.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.2.m2.1.1.3.1.cmml" xref="S2.SS1.p1.2.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.2.2.m2.1.1.3.2.cmml" xref="S2.SS1.p1.2.2.m2.1.1.3.2">𝑝</ci><ci id="S2.SS1.p1.2.2.m2.1.1.3.3.cmml" xref="S2.SS1.p1.2.2.m2.1.1.3.3">𝜎</ci></apply><apply id="S2.SS1.p1.2.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.2.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.p1.2.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.2.2.m2.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS1.p1.2.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.2.2.m2.1.1.1.1.1.3">𝐳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.2.m2.1c">p_{\sigma}(\mathbf{x}|\mathbf{z})</annotation></semantics></math> and <math id="S2.SS1.p1.3.3.m3.1" class="ltx_Math" alttext="q_{\phi}(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S2.SS1.p1.3.3.m3.1a"><mrow id="S2.SS1.p1.3.3.m3.1.1" xref="S2.SS1.p1.3.3.m3.1.1.cmml"><msub id="S2.SS1.p1.3.3.m3.1.1.3" xref="S2.SS1.p1.3.3.m3.1.1.3.cmml"><mi mathcolor="#000000" id="S2.SS1.p1.3.3.m3.1.1.3.2" xref="S2.SS1.p1.3.3.m3.1.1.3.2.cmml">q</mi><mi mathcolor="#000000" id="S2.SS1.p1.3.3.m3.1.1.3.3" xref="S2.SS1.p1.3.3.m3.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.3.3.m3.1.1.2" xref="S2.SS1.p1.3.3.m3.1.1.2.cmml">​</mo><mrow id="S2.SS1.p1.3.3.m3.1.1.1.1" xref="S2.SS1.p1.3.3.m3.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.SS1.p1.3.3.m3.1.1.1.1.2" xref="S2.SS1.p1.3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.3.3.m3.1.1.1.1.1" xref="S2.SS1.p1.3.3.m3.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S2.SS1.p1.3.3.m3.1.1.1.1.1.2" xref="S2.SS1.p1.3.3.m3.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" mathcolor="#000000" id="S2.SS1.p1.3.3.m3.1.1.1.1.1.1" xref="S2.SS1.p1.3.3.m3.1.1.1.1.1.1.cmml">|</mo><mi mathcolor="#000000" id="S2.SS1.p1.3.3.m3.1.1.1.1.1.3" xref="S2.SS1.p1.3.3.m3.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S2.SS1.p1.3.3.m3.1.1.1.1.3" xref="S2.SS1.p1.3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.3.m3.1b"><apply id="S2.SS1.p1.3.3.m3.1.1.cmml" xref="S2.SS1.p1.3.3.m3.1.1"><times id="S2.SS1.p1.3.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.3.m3.1.1.2"></times><apply id="S2.SS1.p1.3.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.3.3.m3.1.1.3.1.cmml" xref="S2.SS1.p1.3.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.3.3.m3.1.1.3.2.cmml" xref="S2.SS1.p1.3.3.m3.1.1.3.2">𝑞</ci><ci id="S2.SS1.p1.3.3.m3.1.1.3.3.cmml" xref="S2.SS1.p1.3.3.m3.1.1.3.3">italic-ϕ</ci></apply><apply id="S2.SS1.p1.3.3.m3.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.3.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.p1.3.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.3.m3.1.1.1.1.1.2">𝐳</ci><ci id="S2.SS1.p1.3.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.3.3.m3.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.3.m3.1c">q_{\phi}(\mathbf{z}|\mathbf{x})</annotation></semantics></math> are all
parameterized as LSTM neural networks <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter &amp; Schmidhuber, <a href="#bib.bib15" title="" class="ltx_ref">1997</a>)</cite>. The program prior <math id="S2.SS1.p1.4.4.m4.1" class="ltx_Math" alttext="p(\mathbf{z})" display="inline"><semantics id="S2.SS1.p1.4.4.m4.1a"><mrow id="S2.SS1.p1.4.4.m4.1.2" xref="S2.SS1.p1.4.4.m4.1.2.cmml"><mi mathcolor="#000000" id="S2.SS1.p1.4.4.m4.1.2.2" xref="S2.SS1.p1.4.4.m4.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.4.4.m4.1.2.1" xref="S2.SS1.p1.4.4.m4.1.2.1.cmml">​</mo><mrow id="S2.SS1.p1.4.4.m4.1.2.3.2" xref="S2.SS1.p1.4.4.m4.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.SS1.p1.4.4.m4.1.2.3.2.1" xref="S2.SS1.p1.4.4.m4.1.2.cmml">(</mo><mi mathcolor="#000000" id="S2.SS1.p1.4.4.m4.1.1" xref="S2.SS1.p1.4.4.m4.1.1.cmml">𝐳</mi><mo mathcolor="#000000" stretchy="false" id="S2.SS1.p1.4.4.m4.1.2.3.2.2" xref="S2.SS1.p1.4.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.4.m4.1b"><apply id="S2.SS1.p1.4.4.m4.1.2.cmml" xref="S2.SS1.p1.4.4.m4.1.2"><times id="S2.SS1.p1.4.4.m4.1.2.1.cmml" xref="S2.SS1.p1.4.4.m4.1.2.1"></times><ci id="S2.SS1.p1.4.4.m4.1.2.2.cmml" xref="S2.SS1.p1.4.4.m4.1.2.2">𝑝</ci><ci id="S2.SS1.p1.4.4.m4.1.1.cmml" xref="S2.SS1.p1.4.4.m4.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.4.m4.1c">p(\mathbf{z})</annotation></semantics></math> is pretrained using
maximum likelihood on programs
simulated using the syntax of the program or a held-out dataset of programs. The
prior is learned first and kept fixed for the rest of the training process.
Finally, the parameters <math id="S2.SS1.p1.5.5.m5.1" class="ltx_Math" alttext="\theta_{z}" display="inline"><semantics id="S2.SS1.p1.5.5.m5.1a"><msub id="S2.SS1.p1.5.5.m5.1.1" xref="S2.SS1.p1.5.5.m5.1.1.cmml"><mi mathcolor="#000000" id="S2.SS1.p1.5.5.m5.1.1.2" xref="S2.SS1.p1.5.5.m5.1.1.2.cmml">θ</mi><mi mathcolor="#000000" id="S2.SS1.p1.5.5.m5.1.1.3" xref="S2.SS1.p1.5.5.m5.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.5.m5.1b"><apply id="S2.SS1.p1.5.5.m5.1.1.cmml" xref="S2.SS1.p1.5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.5.m5.1.1.2">𝜃</ci><ci id="S2.SS1.p1.5.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.5.m5.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.5.m5.1c">\theta_{z}</annotation></semantics></math> for symbols <math id="S2.SS1.p1.6.6.m6.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S2.SS1.p1.6.6.m6.1a"><mi mathcolor="#000000" id="S2.SS1.p1.6.6.m6.1.1" xref="S2.SS1.p1.6.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.6.m6.1b"><ci id="S2.SS1.p1.6.6.m6.1.1.cmml" xref="S2.SS1.p1.6.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.6.m6.1c">z</annotation></semantics></math> parameterize small, deep
convolutional neural networks which optionally take as input an attention map over the image
(see Appendix for more details).</span></p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.2" class="ltx_p">For reference, previous non-probabilistic, neural-symbolic models for VQA <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>; Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>; Mascharka et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite>
model <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="q_{\phi}(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mrow id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><msub id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml"><mi id="S2.SS1.p2.1.m1.1.1.3.2" xref="S2.SS1.p2.1.m1.1.1.3.2.cmml">q</mi><mi id="S2.SS1.p2.1.m1.1.1.3.3" xref="S2.SS1.p2.1.m1.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S2.SS1.p2.1.m1.1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p2.1.m1.1.1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.1.m1.1.1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.1.1.1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S2.SS1.p2.1.m1.1.1.1.1.1.1" xref="S2.SS1.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p2.1.m1.1.1.1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S2.SS1.p2.1.m1.1.1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><times id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2"></times><apply id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.3.1.cmml" xref="S2.SS1.p2.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.3.2.cmml" xref="S2.SS1.p2.1.m1.1.1.3.2">𝑞</ci><ci id="S2.SS1.p2.1.m1.1.1.3.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3.3">italic-ϕ</ci></apply><apply id="S2.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1.1.2">𝐳</ci><ci id="S2.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">q_{\phi}(\mathbf{z}|\mathbf{x})</annotation></semantics></math> and <math id="S2.SS1.p2.2.m2.2" class="ltx_Math" alttext="p(\mathbf{a}|\mathbf{i};\theta_{\mathbf{z}})" display="inline"><semantics id="S2.SS1.p2.2.m2.2a"><mrow id="S2.SS1.p2.2.m2.2.2" xref="S2.SS1.p2.2.m2.2.2.cmml"><mi id="S2.SS1.p2.2.m2.2.2.3" xref="S2.SS1.p2.2.m2.2.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.2.m2.2.2.2" xref="S2.SS1.p2.2.m2.2.2.2.cmml">​</mo><mrow id="S2.SS1.p2.2.m2.2.2.1.1" xref="S2.SS1.p2.2.m2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p2.2.m2.2.2.1.1.2" xref="S2.SS1.p2.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.2.m2.2.2.1.1.1" xref="S2.SS1.p2.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.2.m2.2.2.1.1.1.3" xref="S2.SS1.p2.2.m2.2.2.1.1.1.3.cmml">𝐚</mi><mo fence="false" id="S2.SS1.p2.2.m2.2.2.1.1.1.2" xref="S2.SS1.p2.2.m2.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.SS1.p2.2.m2.2.2.1.1.1.1.1" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.2.cmml"><mi id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">𝐢</mi><mo id="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.2" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.2.cmml">;</mo><msub id="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1.2" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1.3" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1.3.cmml">𝐳</mi></msub></mrow></mrow><mo stretchy="false" id="S2.SS1.p2.2.m2.2.2.1.1.3" xref="S2.SS1.p2.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.2b"><apply id="S2.SS1.p2.2.m2.2.2.cmml" xref="S2.SS1.p2.2.m2.2.2"><times id="S2.SS1.p2.2.m2.2.2.2.cmml" xref="S2.SS1.p2.2.m2.2.2.2"></times><ci id="S2.SS1.p2.2.m2.2.2.3.cmml" xref="S2.SS1.p2.2.m2.2.2.3">𝑝</ci><apply id="S2.SS1.p2.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1"><csymbol cd="latexml" id="S2.SS1.p2.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1.2">conditional</csymbol><ci id="S2.SS1.p2.2.m2.2.2.1.1.1.3.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1.3">𝐚</ci><list id="S2.SS1.p2.2.m2.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.1"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝐢</ci><apply id="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.1.1.1.1.3">𝐳</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.2c">p(\mathbf{a}|\mathbf{i};\theta_{\mathbf{z}})</annotation></semantics></math> terms from our present model (see blue arrows in <a href="#S1.F1" title="In 1 Introduction ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.4" class="ltx_p"><span id="S2.SS2.p1.3.3" class="ltx_text" style="color:#000000;">We assume access to a dataset <math id="S2.SS2.p1.1.1.m1.5" class="ltx_Math" alttext="\mathcal{D}=\{\mathbf{x}^{n},\mathbf{z}^{n}\}\cup\{\mathbf{x}^{m},a^{m},\mathbf{i}^{m}\}" display="inline"><semantics id="S2.SS2.p1.1.1.m1.5a"><mrow id="S2.SS2.p1.1.1.m1.5.5" xref="S2.SS2.p1.1.1.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S2.SS2.p1.1.1.m1.5.5.7" xref="S2.SS2.p1.1.1.m1.5.5.7.cmml">𝒟</mi><mo mathcolor="#000000" id="S2.SS2.p1.1.1.m1.5.5.6" xref="S2.SS2.p1.1.1.m1.5.5.6.cmml">=</mo><mrow id="S2.SS2.p1.1.1.m1.5.5.5" xref="S2.SS2.p1.1.1.m1.5.5.5.cmml"><mrow id="S2.SS2.p1.1.1.m1.2.2.2.2.2" xref="S2.SS2.p1.1.1.m1.2.2.2.2.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p1.1.1.m1.2.2.2.2.2.3" xref="S2.SS2.p1.1.1.m1.2.2.2.2.3.cmml">{</mo><msup id="S2.SS2.p1.1.1.m1.1.1.1.1.1.1" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S2.SS2.p1.1.1.m1.1.1.1.1.1.1.2" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi mathcolor="#000000" id="S2.SS2.p1.1.1.m1.1.1.1.1.1.1.3" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo mathcolor="#000000" id="S2.SS2.p1.1.1.m1.2.2.2.2.2.4" xref="S2.SS2.p1.1.1.m1.2.2.2.2.3.cmml">,</mo><msup id="S2.SS2.p1.1.1.m1.2.2.2.2.2.2" xref="S2.SS2.p1.1.1.m1.2.2.2.2.2.2.cmml"><mi mathcolor="#000000" id="S2.SS2.p1.1.1.m1.2.2.2.2.2.2.2" xref="S2.SS2.p1.1.1.m1.2.2.2.2.2.2.2.cmml">𝐳</mi><mi mathcolor="#000000" id="S2.SS2.p1.1.1.m1.2.2.2.2.2.2.3" xref="S2.SS2.p1.1.1.m1.2.2.2.2.2.2.3.cmml">n</mi></msup><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p1.1.1.m1.2.2.2.2.2.5" xref="S2.SS2.p1.1.1.m1.2.2.2.2.3.cmml">}</mo></mrow><mo mathcolor="#000000" id="S2.SS2.p1.1.1.m1.5.5.5.6" xref="S2.SS2.p1.1.1.m1.5.5.5.6.cmml">∪</mo><mrow id="S2.SS2.p1.1.1.m1.5.5.5.5.3" xref="S2.SS2.p1.1.1.m1.5.5.5.5.4.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p1.1.1.m1.5.5.5.5.3.4" xref="S2.SS2.p1.1.1.m1.5.5.5.5.4.cmml">{</mo><msup id="S2.SS2.p1.1.1.m1.3.3.3.3.1.1" xref="S2.SS2.p1.1.1.m1.3.3.3.3.1.1.cmml"><mi mathcolor="#000000" id="S2.SS2.p1.1.1.m1.3.3.3.3.1.1.2" xref="S2.SS2.p1.1.1.m1.3.3.3.3.1.1.2.cmml">𝐱</mi><mi mathcolor="#000000" id="S2.SS2.p1.1.1.m1.3.3.3.3.1.1.3" xref="S2.SS2.p1.1.1.m1.3.3.3.3.1.1.3.cmml">m</mi></msup><mo mathcolor="#000000" id="S2.SS2.p1.1.1.m1.5.5.5.5.3.5" xref="S2.SS2.p1.1.1.m1.5.5.5.5.4.cmml">,</mo><msup id="S2.SS2.p1.1.1.m1.4.4.4.4.2.2" xref="S2.SS2.p1.1.1.m1.4.4.4.4.2.2.cmml"><mi mathcolor="#000000" id="S2.SS2.p1.1.1.m1.4.4.4.4.2.2.2" xref="S2.SS2.p1.1.1.m1.4.4.4.4.2.2.2.cmml">a</mi><mi mathcolor="#000000" id="S2.SS2.p1.1.1.m1.4.4.4.4.2.2.3" xref="S2.SS2.p1.1.1.m1.4.4.4.4.2.2.3.cmml">m</mi></msup><mo mathcolor="#000000" id="S2.SS2.p1.1.1.m1.5.5.5.5.3.6" xref="S2.SS2.p1.1.1.m1.5.5.5.5.4.cmml">,</mo><msup id="S2.SS2.p1.1.1.m1.5.5.5.5.3.3" xref="S2.SS2.p1.1.1.m1.5.5.5.5.3.3.cmml"><mi mathcolor="#000000" id="S2.SS2.p1.1.1.m1.5.5.5.5.3.3.2" xref="S2.SS2.p1.1.1.m1.5.5.5.5.3.3.2.cmml">𝐢</mi><mi mathcolor="#000000" id="S2.SS2.p1.1.1.m1.5.5.5.5.3.3.3" xref="S2.SS2.p1.1.1.m1.5.5.5.5.3.3.3.cmml">m</mi></msup><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p1.1.1.m1.5.5.5.5.3.7" xref="S2.SS2.p1.1.1.m1.5.5.5.5.4.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.1.m1.5b"><apply id="S2.SS2.p1.1.1.m1.5.5.cmml" xref="S2.SS2.p1.1.1.m1.5.5"><eq id="S2.SS2.p1.1.1.m1.5.5.6.cmml" xref="S2.SS2.p1.1.1.m1.5.5.6"></eq><ci id="S2.SS2.p1.1.1.m1.5.5.7.cmml" xref="S2.SS2.p1.1.1.m1.5.5.7">𝒟</ci><apply id="S2.SS2.p1.1.1.m1.5.5.5.cmml" xref="S2.SS2.p1.1.1.m1.5.5.5"><union id="S2.SS2.p1.1.1.m1.5.5.5.6.cmml" xref="S2.SS2.p1.1.1.m1.5.5.5.6"></union><set id="S2.SS2.p1.1.1.m1.2.2.2.2.3.cmml" xref="S2.SS2.p1.1.1.m1.2.2.2.2.2"><apply id="S2.SS2.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p1.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS2.p1.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S2.SS2.p1.1.1.m1.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.1.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.1.m1.2.2.2.2.2.2.1.cmml" xref="S2.SS2.p1.1.1.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S2.SS2.p1.1.1.m1.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.1.1.m1.2.2.2.2.2.2.2">𝐳</ci><ci id="S2.SS2.p1.1.1.m1.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p1.1.1.m1.2.2.2.2.2.2.3">𝑛</ci></apply></set><set id="S2.SS2.p1.1.1.m1.5.5.5.5.4.cmml" xref="S2.SS2.p1.1.1.m1.5.5.5.5.3"><apply id="S2.SS2.p1.1.1.m1.3.3.3.3.1.1.cmml" xref="S2.SS2.p1.1.1.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.1.m1.3.3.3.3.1.1.1.cmml" xref="S2.SS2.p1.1.1.m1.3.3.3.3.1.1">superscript</csymbol><ci id="S2.SS2.p1.1.1.m1.3.3.3.3.1.1.2.cmml" xref="S2.SS2.p1.1.1.m1.3.3.3.3.1.1.2">𝐱</ci><ci id="S2.SS2.p1.1.1.m1.3.3.3.3.1.1.3.cmml" xref="S2.SS2.p1.1.1.m1.3.3.3.3.1.1.3">𝑚</ci></apply><apply id="S2.SS2.p1.1.1.m1.4.4.4.4.2.2.cmml" xref="S2.SS2.p1.1.1.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.1.m1.4.4.4.4.2.2.1.cmml" xref="S2.SS2.p1.1.1.m1.4.4.4.4.2.2">superscript</csymbol><ci id="S2.SS2.p1.1.1.m1.4.4.4.4.2.2.2.cmml" xref="S2.SS2.p1.1.1.m1.4.4.4.4.2.2.2">𝑎</ci><ci id="S2.SS2.p1.1.1.m1.4.4.4.4.2.2.3.cmml" xref="S2.SS2.p1.1.1.m1.4.4.4.4.2.2.3">𝑚</ci></apply><apply id="S2.SS2.p1.1.1.m1.5.5.5.5.3.3.cmml" xref="S2.SS2.p1.1.1.m1.5.5.5.5.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.1.m1.5.5.5.5.3.3.1.cmml" xref="S2.SS2.p1.1.1.m1.5.5.5.5.3.3">superscript</csymbol><ci id="S2.SS2.p1.1.1.m1.5.5.5.5.3.3.2.cmml" xref="S2.SS2.p1.1.1.m1.5.5.5.5.3.3.2">𝐢</ci><ci id="S2.SS2.p1.1.1.m1.5.5.5.5.3.3.3.cmml" xref="S2.SS2.p1.1.1.m1.5.5.5.5.3.3.3">𝑚</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.1.m1.5c">\mathcal{D}=\{\mathbf{x}^{n},\mathbf{z}^{n}\}\cup\{\mathbf{x}^{m},a^{m},\mathbf{i}^{m}\}</annotation></semantics></math>
where <math id="S2.SS2.p1.2.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS2.p1.2.2.m2.1a"><mi mathcolor="#000000" id="S2.SS2.p1.2.2.m2.1.1" xref="S2.SS2.p1.2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.2.m2.1b"><ci id="S2.SS2.p1.2.2.m2.1.1.cmml" xref="S2.SS2.p1.2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.2.m2.1c">m</annotation></semantics></math> indexes the visual question answering dataset, with questions, corresponding images
and answers, while <math id="S2.SS2.p1.3.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS2.p1.3.3.m3.1a"><mi mathcolor="#000000" id="S2.SS2.p1.3.3.m3.1.1" xref="S2.SS2.p1.3.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.3.m3.1b"><ci id="S2.SS2.p1.3.3.m3.1.1.cmml" xref="S2.SS2.p1.3.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.3.m3.1c">n</annotation></semantics></math> indexes a teaching dataset, which provides the corresponding programs
for a question, explaining the steps required to solve the question.</span>
For <span id="S2.SS2.p1.4.4" class="ltx_text" style="color:#000000;">data-efficient</span> legibility, we are interested in the setting where
<math id="S2.SS2.p1.4.m1.1" class="ltx_Math" alttext="N&lt;M" display="inline"><semantics id="S2.SS2.p1.4.m1.1a"><mrow id="S2.SS2.p1.4.m1.1.1" xref="S2.SS2.p1.4.m1.1.1.cmml"><mi id="S2.SS2.p1.4.m1.1.1.2" xref="S2.SS2.p1.4.m1.1.1.2.cmml">N</mi><mo id="S2.SS2.p1.4.m1.1.1.1" xref="S2.SS2.p1.4.m1.1.1.1.cmml">&lt;</mo><mi id="S2.SS2.p1.4.m1.1.1.3" xref="S2.SS2.p1.4.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m1.1b"><apply id="S2.SS2.p1.4.m1.1.1.cmml" xref="S2.SS2.p1.4.m1.1.1"><lt id="S2.SS2.p1.4.m1.1.1.1.cmml" xref="S2.SS2.p1.4.m1.1.1.1"></lt><ci id="S2.SS2.p1.4.m1.1.1.2.cmml" xref="S2.SS2.p1.4.m1.1.1.2">𝑁</ci><ci id="S2.SS2.p1.4.m1.1.1.3.cmml" xref="S2.SS2.p1.4.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m1.1c">N&lt;M</annotation></semantics></math> <em id="S2.SS2.p1.4.5" class="ltx_emph ltx_font_italic">i.e.</em> we have few annotated examples of programs which might be
more expensive to specify.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Given this, learning in our model consists of estimating parameters
<math id="S2.SS2.p2.1.m1.3" class="ltx_Math" alttext="\{\theta_{\mathcal{Z}},\sigma,\phi\}" display="inline"><semantics id="S2.SS2.p2.1.m1.3a"><mrow id="S2.SS2.p2.1.m1.3.3.1" xref="S2.SS2.p2.1.m1.3.3.2.cmml"><mo stretchy="false" id="S2.SS2.p2.1.m1.3.3.1.2" xref="S2.SS2.p2.1.m1.3.3.2.cmml">{</mo><msub id="S2.SS2.p2.1.m1.3.3.1.1" xref="S2.SS2.p2.1.m1.3.3.1.1.cmml"><mi id="S2.SS2.p2.1.m1.3.3.1.1.2" xref="S2.SS2.p2.1.m1.3.3.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.1.m1.3.3.1.1.3" xref="S2.SS2.p2.1.m1.3.3.1.1.3.cmml">𝒵</mi></msub><mo id="S2.SS2.p2.1.m1.3.3.1.3" xref="S2.SS2.p2.1.m1.3.3.2.cmml">,</mo><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">σ</mi><mo id="S2.SS2.p2.1.m1.3.3.1.4" xref="S2.SS2.p2.1.m1.3.3.2.cmml">,</mo><mi id="S2.SS2.p2.1.m1.2.2" xref="S2.SS2.p2.1.m1.2.2.cmml">ϕ</mi><mo stretchy="false" id="S2.SS2.p2.1.m1.3.3.1.5" xref="S2.SS2.p2.1.m1.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.3b"><set id="S2.SS2.p2.1.m1.3.3.2.cmml" xref="S2.SS2.p2.1.m1.3.3.1"><apply id="S2.SS2.p2.1.m1.3.3.1.1.cmml" xref="S2.SS2.p2.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.3.3.1.1.1.cmml" xref="S2.SS2.p2.1.m1.3.3.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.3.3.1.1.2.cmml" xref="S2.SS2.p2.1.m1.3.3.1.1.2">𝜃</ci><ci id="S2.SS2.p2.1.m1.3.3.1.1.3.cmml" xref="S2.SS2.p2.1.m1.3.3.1.1.3">𝒵</ci></apply><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝜎</ci><ci id="S2.SS2.p2.1.m1.2.2.cmml" xref="S2.SS2.p2.1.m1.2.2">italic-ϕ</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.3c">\{\theta_{\mathcal{Z}},\sigma,\phi\}</annotation></semantics></math>. We do this in a
stage-wise fashion (shown below) (c.f. <cite class="ltx_cite ltx_citemacro_citet">Johnson et al. (<a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>):</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.7" class="ltx_p"><span id="S2.SS2.p3.7.1" class="ltx_text ltx_font_bold">Stage-wise Optimization.
<br class="ltx_break"></span>1) Question Coding: Optimizing parameters <math id="S2.SS2.p3.1.m1.2" class="ltx_Math" alttext="\{\sigma,\phi\}" display="inline"><semantics id="S2.SS2.p3.1.m1.2a"><mrow id="S2.SS2.p3.1.m1.2.3.2" xref="S2.SS2.p3.1.m1.2.3.1.cmml"><mo stretchy="false" id="S2.SS2.p3.1.m1.2.3.2.1" xref="S2.SS2.p3.1.m1.2.3.1.cmml">{</mo><mi id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">σ</mi><mo id="S2.SS2.p3.1.m1.2.3.2.2" xref="S2.SS2.p3.1.m1.2.3.1.cmml">,</mo><mi id="S2.SS2.p3.1.m1.2.2" xref="S2.SS2.p3.1.m1.2.2.cmml">ϕ</mi><mo stretchy="false" id="S2.SS2.p3.1.m1.2.3.2.3" xref="S2.SS2.p3.1.m1.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.2b"><set id="S2.SS2.p3.1.m1.2.3.1.cmml" xref="S2.SS2.p3.1.m1.2.3.2"><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">𝜎</ci><ci id="S2.SS2.p3.1.m1.2.2.cmml" xref="S2.SS2.p3.1.m1.2.2">italic-ϕ</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.2c">\{\sigma,\phi\}</annotation></semantics></math> to learn a good code for
questions <math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">\mathbf{x}</annotation></semantics></math> in the latent space <math id="S2.SS2.p3.3.m3.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S2.SS2.p3.3.m3.1a"><mi id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><ci id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">\mathbf{z}</annotation></semantics></math>.
<br class="ltx_break">2) Module Training: Optimizing parameters <math id="S2.SS2.p3.4.m4.1" class="ltx_Math" alttext="\theta_{\mathcal{Z}}" display="inline"><semantics id="S2.SS2.p3.4.m4.1a"><msub id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml"><mi id="S2.SS2.p3.4.m4.1.1.2" xref="S2.SS2.p3.4.m4.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.4.m4.1.1.3" xref="S2.SS2.p3.4.m4.1.1.3.cmml">𝒵</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.1b"><apply id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.4.m4.1.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p3.4.m4.1.1.2.cmml" xref="S2.SS2.p3.4.m4.1.1.2">𝜃</ci><ci id="S2.SS2.p3.4.m4.1.1.3.cmml" xref="S2.SS2.p3.4.m4.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.1c">\theta_{\mathcal{Z}}</annotation></semantics></math> for learning
to execute symbols <math id="S2.SS2.p3.5.m5.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S2.SS2.p3.5.m5.1a"><mi id="S2.SS2.p3.5.m5.1.1" xref="S2.SS2.p3.5.m5.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.5.m5.1b"><ci id="S2.SS2.p3.5.m5.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.5.m5.1c">z</annotation></semantics></math> using neural networks <math id="S2.SS2.p3.6.m6.1" class="ltx_Math" alttext="\theta_{z}" display="inline"><semantics id="S2.SS2.p3.6.m6.1a"><msub id="S2.SS2.p3.6.m6.1.1" xref="S2.SS2.p3.6.m6.1.1.cmml"><mi id="S2.SS2.p3.6.m6.1.1.2" xref="S2.SS2.p3.6.m6.1.1.2.cmml">θ</mi><mi id="S2.SS2.p3.6.m6.1.1.3" xref="S2.SS2.p3.6.m6.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.6.m6.1b"><apply id="S2.SS2.p3.6.m6.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.6.m6.1.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p3.6.m6.1.1.2.cmml" xref="S2.SS2.p3.6.m6.1.1.2">𝜃</ci><ci id="S2.SS2.p3.6.m6.1.1.3.cmml" xref="S2.SS2.p3.6.m6.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.6.m6.1c">\theta_{z}</annotation></semantics></math>.
<br class="ltx_break">3) Joint Training: Learning all the parameters of the model <math id="S2.SS2.p3.7.m7.3" class="ltx_Math" alttext="\{\theta_{\mathcal{Z}},\sigma,\phi\}" display="inline"><semantics id="S2.SS2.p3.7.m7.3a"><mrow id="S2.SS2.p3.7.m7.3.3.1" xref="S2.SS2.p3.7.m7.3.3.2.cmml"><mo stretchy="false" id="S2.SS2.p3.7.m7.3.3.1.2" xref="S2.SS2.p3.7.m7.3.3.2.cmml">{</mo><msub id="S2.SS2.p3.7.m7.3.3.1.1" xref="S2.SS2.p3.7.m7.3.3.1.1.cmml"><mi id="S2.SS2.p3.7.m7.3.3.1.1.2" xref="S2.SS2.p3.7.m7.3.3.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.7.m7.3.3.1.1.3" xref="S2.SS2.p3.7.m7.3.3.1.1.3.cmml">𝒵</mi></msub><mo id="S2.SS2.p3.7.m7.3.3.1.3" xref="S2.SS2.p3.7.m7.3.3.2.cmml">,</mo><mi id="S2.SS2.p3.7.m7.1.1" xref="S2.SS2.p3.7.m7.1.1.cmml">σ</mi><mo id="S2.SS2.p3.7.m7.3.3.1.4" xref="S2.SS2.p3.7.m7.3.3.2.cmml">,</mo><mi id="S2.SS2.p3.7.m7.2.2" xref="S2.SS2.p3.7.m7.2.2.cmml">ϕ</mi><mo stretchy="false" id="S2.SS2.p3.7.m7.3.3.1.5" xref="S2.SS2.p3.7.m7.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.7.m7.3b"><set id="S2.SS2.p3.7.m7.3.3.2.cmml" xref="S2.SS2.p3.7.m7.3.3.1"><apply id="S2.SS2.p3.7.m7.3.3.1.1.cmml" xref="S2.SS2.p3.7.m7.3.3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.7.m7.3.3.1.1.1.cmml" xref="S2.SS2.p3.7.m7.3.3.1.1">subscript</csymbol><ci id="S2.SS2.p3.7.m7.3.3.1.1.2.cmml" xref="S2.SS2.p3.7.m7.3.3.1.1.2">𝜃</ci><ci id="S2.SS2.p3.7.m7.3.3.1.1.3.cmml" xref="S2.SS2.p3.7.m7.3.3.1.1.3">𝒵</ci></apply><ci id="S2.SS2.p3.7.m7.1.1.cmml" xref="S2.SS2.p3.7.m7.1.1">𝜎</ci><ci id="S2.SS2.p3.7.m7.2.2.cmml" xref="S2.SS2.p3.7.m7.2.2">italic-ϕ</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.7.m7.3c">\{\theta_{\mathcal{Z}},\sigma,\phi\}</annotation></semantics></math>.
<br class="ltx_break"><span id="S2.SS2.p3.7.2" class="ltx_text" style="color:#000000;">We describe each of the stages in detail below, and defer the reader to the Appendix for a
more details.</span></p>
</div>
<div id="S2.SS2.p4" class="ltx_para ltx_noindent">
<p id="S2.SS2.p4.5" class="ltx_p"><span id="S2.SS2.p4.5.6" class="ltx_text ltx_font_bold">Question Coding.</span>
<span id="S2.SS2.p4.5.5" class="ltx_text" style="color:#000000;">We fit the model on the evidence for questions <math id="S2.SS2.p4.1.1.m1.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.SS2.p4.1.1.m1.1a"><mi mathcolor="#000000" id="S2.SS2.p4.1.1.m1.1.1" xref="S2.SS2.p4.1.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.1.m1.1b"><ci id="S2.SS2.p4.1.1.m1.1.1.cmml" xref="S2.SS2.p4.1.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.1.m1.1c">\mathbf{x}</annotation></semantics></math>
and programs <math id="S2.SS2.p4.2.2.m2.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S2.SS2.p4.2.2.m2.1a"><mi mathcolor="#000000" id="S2.SS2.p4.2.2.m2.1.1" xref="S2.SS2.p4.2.2.m2.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.2.m2.1b"><ci id="S2.SS2.p4.2.2.m2.1.1.cmml" xref="S2.SS2.p4.2.2.m2.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.2.m2.1c">\mathbf{z}</annotation></semantics></math>, marginalizing answers <math id="S2.SS2.p4.3.3.m3.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S2.SS2.p4.3.3.m3.1a"><mi mathcolor="#000000" id="S2.SS2.p4.3.3.m3.1.1" xref="S2.SS2.p4.3.3.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.3.3.m3.1b"><ci id="S2.SS2.p4.3.3.m3.1.1.cmml" xref="S2.SS2.p4.3.3.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.3.3.m3.1c">a</annotation></semantics></math>, <em id="S2.SS2.p4.5.5.1" class="ltx_emph ltx_font_italic">i.e.</em> <math id="S2.SS2.p4.4.4.m4.3" class="ltx_Math" alttext="\sum_{n}\log p(\mathbf{x}^{n},\mathbf{z}^{n})+\sum_{m}\log p(\mathbf{x}^{m})" display="inline"><semantics id="S2.SS2.p4.4.4.m4.3a"><mrow id="S2.SS2.p4.4.4.m4.3.3" xref="S2.SS2.p4.4.4.m4.3.3.cmml"><mrow id="S2.SS2.p4.4.4.m4.2.2.2" xref="S2.SS2.p4.4.4.m4.2.2.2.cmml"><msub id="S2.SS2.p4.4.4.m4.2.2.2.3" xref="S2.SS2.p4.4.4.m4.2.2.2.3.cmml"><mo mathcolor="#000000" id="S2.SS2.p4.4.4.m4.2.2.2.3.2" xref="S2.SS2.p4.4.4.m4.2.2.2.3.2.cmml">∑</mo><mi mathcolor="#000000" id="S2.SS2.p4.4.4.m4.2.2.2.3.3" xref="S2.SS2.p4.4.4.m4.2.2.2.3.3.cmml">n</mi></msub><mrow id="S2.SS2.p4.4.4.m4.2.2.2.2" xref="S2.SS2.p4.4.4.m4.2.2.2.2.cmml"><mrow id="S2.SS2.p4.4.4.m4.2.2.2.2.4" xref="S2.SS2.p4.4.4.m4.2.2.2.2.4.cmml"><mi mathcolor="#000000" id="S2.SS2.p4.4.4.m4.2.2.2.2.4.1" xref="S2.SS2.p4.4.4.m4.2.2.2.2.4.1.cmml">log</mi><mo lspace="0.167em" id="S2.SS2.p4.4.4.m4.2.2.2.2.4a" xref="S2.SS2.p4.4.4.m4.2.2.2.2.4.cmml">⁡</mo><mi mathcolor="#000000" id="S2.SS2.p4.4.4.m4.2.2.2.2.4.2" xref="S2.SS2.p4.4.4.m4.2.2.2.2.4.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p4.4.4.m4.2.2.2.2.3" xref="S2.SS2.p4.4.4.m4.2.2.2.2.3.cmml">​</mo><mrow id="S2.SS2.p4.4.4.m4.2.2.2.2.2.2" xref="S2.SS2.p4.4.4.m4.2.2.2.2.2.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.3" xref="S2.SS2.p4.4.4.m4.2.2.2.2.2.3.cmml">(</mo><msup id="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1" xref="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1.2" xref="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi mathcolor="#000000" id="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1.3" xref="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo mathcolor="#000000" id="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.4" xref="S2.SS2.p4.4.4.m4.2.2.2.2.2.3.cmml">,</mo><msup id="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2" xref="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2.cmml"><mi mathcolor="#000000" id="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2.2" xref="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2.2.cmml">𝐳</mi><mi mathcolor="#000000" id="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2.3" xref="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2.3.cmml">n</mi></msup><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.5" xref="S2.SS2.p4.4.4.m4.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo mathcolor="#000000" rspace="0.055em" id="S2.SS2.p4.4.4.m4.3.3.4" xref="S2.SS2.p4.4.4.m4.3.3.4.cmml">+</mo><mrow id="S2.SS2.p4.4.4.m4.3.3.3" xref="S2.SS2.p4.4.4.m4.3.3.3.cmml"><msub id="S2.SS2.p4.4.4.m4.3.3.3.2" xref="S2.SS2.p4.4.4.m4.3.3.3.2.cmml"><mo mathcolor="#000000" id="S2.SS2.p4.4.4.m4.3.3.3.2.2" xref="S2.SS2.p4.4.4.m4.3.3.3.2.2.cmml">∑</mo><mi mathcolor="#000000" id="S2.SS2.p4.4.4.m4.3.3.3.2.3" xref="S2.SS2.p4.4.4.m4.3.3.3.2.3.cmml">m</mi></msub><mrow id="S2.SS2.p4.4.4.m4.3.3.3.1" xref="S2.SS2.p4.4.4.m4.3.3.3.1.cmml"><mrow id="S2.SS2.p4.4.4.m4.3.3.3.1.3" xref="S2.SS2.p4.4.4.m4.3.3.3.1.3.cmml"><mi mathcolor="#000000" id="S2.SS2.p4.4.4.m4.3.3.3.1.3.1" xref="S2.SS2.p4.4.4.m4.3.3.3.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.SS2.p4.4.4.m4.3.3.3.1.3a" xref="S2.SS2.p4.4.4.m4.3.3.3.1.3.cmml">⁡</mo><mi mathcolor="#000000" id="S2.SS2.p4.4.4.m4.3.3.3.1.3.2" xref="S2.SS2.p4.4.4.m4.3.3.3.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p4.4.4.m4.3.3.3.1.2" xref="S2.SS2.p4.4.4.m4.3.3.3.1.2.cmml">​</mo><mrow id="S2.SS2.p4.4.4.m4.3.3.3.1.1.1" xref="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.2" xref="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.cmml">(</mo><msup id="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1" xref="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.cmml"><mi mathcolor="#000000" id="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.2" xref="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.2.cmml">𝐱</mi><mi mathcolor="#000000" id="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.3" xref="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.3.cmml">m</mi></msup><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.3" xref="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.4.4.m4.3b"><apply id="S2.SS2.p4.4.4.m4.3.3.cmml" xref="S2.SS2.p4.4.4.m4.3.3"><plus id="S2.SS2.p4.4.4.m4.3.3.4.cmml" xref="S2.SS2.p4.4.4.m4.3.3.4"></plus><apply id="S2.SS2.p4.4.4.m4.2.2.2.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2"><apply id="S2.SS2.p4.4.4.m4.2.2.2.3.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p4.4.4.m4.2.2.2.3.1.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.3">subscript</csymbol><sum id="S2.SS2.p4.4.4.m4.2.2.2.3.2.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.3.2"></sum><ci id="S2.SS2.p4.4.4.m4.2.2.2.3.3.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.3.3">𝑛</ci></apply><apply id="S2.SS2.p4.4.4.m4.2.2.2.2.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.2"><times id="S2.SS2.p4.4.4.m4.2.2.2.2.3.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.2.3"></times><apply id="S2.SS2.p4.4.4.m4.2.2.2.2.4.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.2.4"><log id="S2.SS2.p4.4.4.m4.2.2.2.2.4.1.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.2.4.1"></log><ci id="S2.SS2.p4.4.4.m4.2.2.2.2.4.2.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.2.4.2">𝑝</ci></apply><interval closure="open" id="S2.SS2.p4.4.4.m4.2.2.2.2.2.3.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.2.2.2"><apply id="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p4.4.4.m4.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2.1.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2">superscript</csymbol><ci id="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2.2">𝐳</ci><ci id="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p4.4.4.m4.2.2.2.2.2.2.2.3">𝑛</ci></apply></interval></apply></apply><apply id="S2.SS2.p4.4.4.m4.3.3.3.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3"><apply id="S2.SS2.p4.4.4.m4.3.3.3.2.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.p4.4.4.m4.3.3.3.2.1.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.2">subscript</csymbol><sum id="S2.SS2.p4.4.4.m4.3.3.3.2.2.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.2.2"></sum><ci id="S2.SS2.p4.4.4.m4.3.3.3.2.3.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.2.3">𝑚</ci></apply><apply id="S2.SS2.p4.4.4.m4.3.3.3.1.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.1"><times id="S2.SS2.p4.4.4.m4.3.3.3.1.2.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.1.2"></times><apply id="S2.SS2.p4.4.4.m4.3.3.3.1.3.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.1.3"><log id="S2.SS2.p4.4.4.m4.3.3.3.1.3.1.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.1.3.1"></log><ci id="S2.SS2.p4.4.4.m4.3.3.3.1.3.2.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.1.3.2">𝑝</ci></apply><apply id="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.1.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.1.1.1">superscript</csymbol><ci id="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.2.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.2">𝐱</ci><ci id="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.3.cmml" xref="S2.SS2.p4.4.4.m4.3.3.3.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.4.4.m4.3c">\sum_{n}\log p(\mathbf{x}^{n},\mathbf{z}^{n})+\sum_{m}\log p(\mathbf{x}^{m})</annotation></semantics></math>. We lower-bound the second
term, optimizing the evidence lower bound (ELBO) with an amortized inference
network <math id="S2.SS2.p4.5.5.m5.1" class="ltx_Math" alttext="q_{\phi}" display="inline"><semantics id="S2.SS2.p4.5.5.m5.1a"><msub id="S2.SS2.p4.5.5.m5.1.1" xref="S2.SS2.p4.5.5.m5.1.1.cmml"><mi mathcolor="#000000" id="S2.SS2.p4.5.5.m5.1.1.2" xref="S2.SS2.p4.5.5.m5.1.1.2.cmml">q</mi><mi mathcolor="#000000" id="S2.SS2.p4.5.5.m5.1.1.3" xref="S2.SS2.p4.5.5.m5.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.5.5.m5.1b"><apply id="S2.SS2.p4.5.5.m5.1.1.cmml" xref="S2.SS2.p4.5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.5.5.m5.1.1.1.cmml" xref="S2.SS2.p4.5.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p4.5.5.m5.1.1.2.cmml" xref="S2.SS2.p4.5.5.m5.1.1.2">𝑞</ci><ci id="S2.SS2.p4.5.5.m5.1.1.3.cmml" xref="S2.SS2.p4.5.5.m5.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.5.5.m5.1c">q_{\phi}</annotation></semantics></math> (c.f. <cite class="ltx_cite ltx_citemacro_citet">Kingma &amp; Welling (<a href="#bib.bib22" title="" class="ltx_ref">2014</a>); Rezende et al. (<a href="#bib.bib38" title="" class="ltx_ref">2014</a>)</cite>)</span>:</p>
<table id="S15.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td colspan="2" class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S2.E1.m1.49" class="ltx_Math" alttext="\displaystyle\begin{split}\sum_{m}\log p(\mathbf{x}^{m})&amp;\geq\sum_{m}\mathbb{E}_{\mathbf{z}\sim q_{\phi}(\mathbf{z}|\mathbf{x}^{m})}[\log p_{\sigma}(\mathbf{x}^{m}|\mathbf{z})-\\
&amp;\beta\log q_{\phi}(\mathbf{z}|\mathbf{x}^{m})+\beta\log p(\mathbf{z})]=\mathcal{U}^{\beta}_{qc}\end{split}" display="inline"><semantics id="S2.E1.m1.49a"><mtable columnspacing="0pt" rowspacing="0pt" id="S2.E1.m1.49.49.3" xref="S2.E1.m1.48.48.2.cmml"><mtr id="S2.E1.m1.49.49.3a" xref="S2.E1.m1.48.48.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S2.E1.m1.49.49.3b" xref="S2.E1.m1.48.48.2.cmml"><mrow id="S2.E1.m1.49.49.3.47.25.9" xref="S2.E1.m1.48.48.2.cmml"><mstyle displaystyle="true" id="S2.E1.m1.49.49.3.47.25.9.10" xref="S2.E1.m1.48.48.2.cmml"><munder id="S2.E1.m1.49.49.3.47.25.9.10a" xref="S2.E1.m1.48.48.2.cmml"><mo movablelimits="false" id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml">∑</mo><mi id="S2.E1.m1.2.2.2.2.2.2.1" xref="S2.E1.m1.2.2.2.2.2.2.1.cmml">m</mi></munder></mstyle><mrow id="S2.E1.m1.49.49.3.47.25.9.9" xref="S2.E1.m1.48.48.2.cmml"><mrow id="S2.E1.m1.49.49.3.47.25.9.9.3" xref="S2.E1.m1.48.48.2.cmml"><mi id="S2.E1.m1.3.3.3.3.3.3" xref="S2.E1.m1.3.3.3.3.3.3.cmml">log</mi><mo lspace="0.167em" id="S2.E1.m1.49.49.3.47.25.9.9.3a" xref="S2.E1.m1.48.48.2a.cmml">⁡</mo><mi id="S2.E1.m1.4.4.4.4.4.4" xref="S2.E1.m1.4.4.4.4.4.4.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.49.49.3.47.25.9.9.2" xref="S2.E1.m1.48.48.2a.cmml">​</mo><mrow id="S2.E1.m1.49.49.3.47.25.9.9.1.1" xref="S2.E1.m1.48.48.2.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.5.5.5.5" xref="S2.E1.m1.48.48.2a.cmml">(</mo><msup id="S2.E1.m1.49.49.3.47.25.9.9.1.1.1" xref="S2.E1.m1.48.48.2.cmml"><mi id="S2.E1.m1.6.6.6.6.6.6" xref="S2.E1.m1.6.6.6.6.6.6.cmml">𝐱</mi><mi id="S2.E1.m1.7.7.7.7.7.7.1" xref="S2.E1.m1.7.7.7.7.7.7.1.cmml">m</mi></msup><mo stretchy="false" id="S2.E1.m1.8.8.8.8.8.8" xref="S2.E1.m1.48.48.2a.cmml">)</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.49.49.3c" xref="S2.E1.m1.48.48.2.cmml"><mrow id="S2.E1.m1.24.24.24.24.16a" xref="S2.E1.m1.48.48.2.cmml"><mo id="S2.E1.m1.9.9.9.9.1.1" xref="S2.E1.m1.9.9.9.9.1.1.cmml">≥</mo><mstyle displaystyle="true" id="S2.E1.m1.24.24.24.24.16a.17" xref="S2.E1.m1.48.48.2.cmml"><munder id="S2.E1.m1.24.24.24.24.16a.17a" xref="S2.E1.m1.48.48.2.cmml"><mo movablelimits="false" id="S2.E1.m1.10.10.10.10.2.2" xref="S2.E1.m1.10.10.10.10.2.2.cmml">∑</mo><mi id="S2.E1.m1.11.11.11.11.3.3.1" xref="S2.E1.m1.11.11.11.11.3.3.1.cmml">m</mi></munder></mstyle><msub id="S2.E1.m1.24.24.24.24.16a.18" xref="S2.E1.m1.48.48.2.cmml"><mi id="S2.E1.m1.12.12.12.12.4.4" xref="S2.E1.m1.12.12.12.12.4.4.cmml">𝔼</mi><mrow id="S2.E1.m1.13.13.13.13.5.5.1" xref="S2.E1.m1.13.13.13.13.5.5.1.cmml"><mi id="S2.E1.m1.13.13.13.13.5.5.1.3" xref="S2.E1.m1.13.13.13.13.5.5.1.3.cmml">𝐳</mi><mo id="S2.E1.m1.13.13.13.13.5.5.1.2" xref="S2.E1.m1.13.13.13.13.5.5.1.2.cmml">∼</mo><mrow id="S2.E1.m1.13.13.13.13.5.5.1.1" xref="S2.E1.m1.13.13.13.13.5.5.1.1.cmml"><msub id="S2.E1.m1.13.13.13.13.5.5.1.1.3" xref="S2.E1.m1.13.13.13.13.5.5.1.1.3.cmml"><mi id="S2.E1.m1.13.13.13.13.5.5.1.1.3.2" xref="S2.E1.m1.13.13.13.13.5.5.1.1.3.2.cmml">q</mi><mi id="S2.E1.m1.13.13.13.13.5.5.1.1.3.3" xref="S2.E1.m1.13.13.13.13.5.5.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.13.13.13.13.5.5.1.1.2" xref="S2.E1.m1.13.13.13.13.5.5.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.2" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.cmml"><mi id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.2" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.1" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.1.cmml">|</mo><msup id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3.2" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3.3" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3.3.cmml">m</mi></msup></mrow><mo stretchy="false" id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.3" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mrow id="S2.E1.m1.24.24.24.24.16a.19" xref="S2.E1.m1.48.48.2.cmml"><mo stretchy="false" id="S2.E1.m1.14.14.14.14.6.6" xref="S2.E1.m1.48.48.2a.cmml">[</mo><mi id="S2.E1.m1.15.15.15.15.7.7" xref="S2.E1.m1.15.15.15.15.7.7.cmml">log</mi><msub id="S2.E1.m1.24.24.24.24.16a.19.1" xref="S2.E1.m1.48.48.2.cmml"><mi id="S2.E1.m1.16.16.16.16.8.8" xref="S2.E1.m1.16.16.16.16.8.8.cmml">p</mi><mi id="S2.E1.m1.17.17.17.17.9.9.1" xref="S2.E1.m1.17.17.17.17.9.9.1.cmml">σ</mi></msub><mrow id="S2.E1.m1.24.24.24.24.16a.19.2" xref="S2.E1.m1.48.48.2.cmml"><mo stretchy="false" id="S2.E1.m1.18.18.18.18.10.10" xref="S2.E1.m1.48.48.2a.cmml">(</mo><msup id="S2.E1.m1.24.24.24.24.16a.19.2.1" xref="S2.E1.m1.48.48.2.cmml"><mi id="S2.E1.m1.19.19.19.19.11.11" xref="S2.E1.m1.19.19.19.19.11.11.cmml">𝐱</mi><mi id="S2.E1.m1.20.20.20.20.12.12.1" xref="S2.E1.m1.20.20.20.20.12.12.1.cmml">m</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E1.m1.21.21.21.21.13.13" xref="S2.E1.m1.21.21.21.21.13.13.cmml">|</mo><mi id="S2.E1.m1.22.22.22.22.14.14" xref="S2.E1.m1.22.22.22.22.14.14.cmml">𝐳</mi><mo stretchy="false" id="S2.E1.m1.23.23.23.23.15.15" xref="S2.E1.m1.48.48.2a.cmml">)</mo></mrow><mo id="S2.E1.m1.24.24.24.24.16.16" xref="S2.E1.m1.24.24.24.24.16.16.cmml">−</mo></mrow></mrow></mtd></mtr><mtr id="S2.E1.m1.49.49.3d" xref="S2.E1.m1.48.48.2.cmml"><mtd id="S2.E1.m1.49.49.3e" xref="S2.E1.m1.48.48.2a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.49.49.3f" xref="S2.E1.m1.48.48.2.cmml"><mrow id="S2.E1.m1.46.46.46.22.22a" xref="S2.E1.m1.48.48.2.cmml"><mi id="S2.E1.m1.25.25.25.1.1.1" xref="S2.E1.m1.25.25.25.1.1.1.cmml">β</mi><mi id="S2.E1.m1.26.26.26.2.2.2" xref="S2.E1.m1.26.26.26.2.2.2.cmml">log</mi><msub id="S2.E1.m1.46.46.46.22.22a.23" xref="S2.E1.m1.48.48.2.cmml"><mi id="S2.E1.m1.27.27.27.3.3.3" xref="S2.E1.m1.27.27.27.3.3.3.cmml">q</mi><mi id="S2.E1.m1.28.28.28.4.4.4.1" xref="S2.E1.m1.28.28.28.4.4.4.1.cmml">ϕ</mi></msub><mrow id="S2.E1.m1.46.46.46.22.22a.24" xref="S2.E1.m1.48.48.2.cmml"><mo stretchy="false" id="S2.E1.m1.29.29.29.5.5.5" xref="S2.E1.m1.48.48.2a.cmml">(</mo><mi id="S2.E1.m1.30.30.30.6.6.6" xref="S2.E1.m1.30.30.30.6.6.6.cmml">𝐳</mi><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E1.m1.31.31.31.7.7.7" xref="S2.E1.m1.31.31.31.7.7.7.cmml">|</mo><msup id="S2.E1.m1.46.46.46.22.22a.24.1" xref="S2.E1.m1.48.48.2.cmml"><mi id="S2.E1.m1.32.32.32.8.8.8" xref="S2.E1.m1.32.32.32.8.8.8.cmml">𝐱</mi><mi id="S2.E1.m1.33.33.33.9.9.9.1" xref="S2.E1.m1.33.33.33.9.9.9.1.cmml">m</mi></msup><mo stretchy="false" id="S2.E1.m1.34.34.34.10.10.10" xref="S2.E1.m1.48.48.2a.cmml">)</mo></mrow><mo id="S2.E1.m1.35.35.35.11.11.11" xref="S2.E1.m1.35.35.35.11.11.11.cmml">+</mo><mi id="S2.E1.m1.36.36.36.12.12.12" xref="S2.E1.m1.36.36.36.12.12.12.cmml">β</mi><mi id="S2.E1.m1.37.37.37.13.13.13" xref="S2.E1.m1.37.37.37.13.13.13.cmml">log</mi><mi id="S2.E1.m1.38.38.38.14.14.14" xref="S2.E1.m1.38.38.38.14.14.14.cmml">p</mi><mrow id="S2.E1.m1.46.46.46.22.22a.25" xref="S2.E1.m1.48.48.2.cmml"><mo stretchy="false" id="S2.E1.m1.39.39.39.15.15.15" xref="S2.E1.m1.48.48.2a.cmml">(</mo><mi id="S2.E1.m1.40.40.40.16.16.16" xref="S2.E1.m1.40.40.40.16.16.16.cmml">𝐳</mi><mo stretchy="false" id="S2.E1.m1.41.41.41.17.17.17" xref="S2.E1.m1.48.48.2a.cmml">)</mo></mrow><mo stretchy="false" id="S2.E1.m1.42.42.42.18.18.18" xref="S2.E1.m1.48.48.2a.cmml">]</mo><mo id="S2.E1.m1.43.43.43.19.19.19" xref="S2.E1.m1.43.43.43.19.19.19.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.44.44.44.20.20.20" xref="S2.E1.m1.44.44.44.20.20.20.cmml">𝒰</mi><msup id="S2.E1.m1.46.46.46.22.22a.26" xref="S2.E1.m1.48.48.2.cmml"><mi id="S2.E1.m1.46.46.46.22.22a.26a" xref="S2.E1.m1.48.48.2a.cmml"></mi><mi id="S2.E1.m1.45.45.45.21.21.21.1" xref="S2.E1.m1.45.45.45.21.21.21.1.cmml">β</mi></msup><msub id="S2.E1.m1.46.46.46.22.22a.27" xref="S2.E1.m1.48.48.2.cmml"><mi id="S2.E1.m1.46.46.46.22.22a.27a" xref="S2.E1.m1.48.48.2a.cmml"></mi><mrow id="S2.E1.m1.46.46.46.22.22.22.1" xref="S2.E1.m1.46.46.46.22.22.22.1.cmml"><mi id="S2.E1.m1.46.46.46.22.22.22.1.2" xref="S2.E1.m1.46.46.46.22.22.22.1.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.46.46.46.22.22.22.1.1" xref="S2.E1.m1.46.46.46.22.22.22.1.1.cmml">​</mo><mi id="S2.E1.m1.46.46.46.22.22.22.1.3" xref="S2.E1.m1.46.46.46.22.22.22.1.3.cmml">c</mi></mrow></msub></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E1.m1.49b"><apply id="S2.E1.m1.48.48.2.cmml" xref="S2.E1.m1.49.49.3"><and id="S2.E1.m1.48.48.2a.cmml" xref="S2.E1.m1.49.49.3.47.25.9.9.3a"></and><apply id="S2.E1.m1.48.48.2b.cmml" xref="S2.E1.m1.49.49.3"><geq id="S2.E1.m1.9.9.9.9.1.1.cmml" xref="S2.E1.m1.9.9.9.9.1.1"></geq><apply id="S2.E1.m1.47.47.1.1.cmml" xref="S2.E1.m1.49.49.3"><apply id="S2.E1.m1.47.47.1.1.2.cmml" xref="S2.E1.m1.49.49.3"><csymbol cd="ambiguous" id="S2.E1.m1.47.47.1.1.2.1.cmml" xref="S2.E1.m1.49.49.3.47.25.9.9.3a">subscript</csymbol><sum id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"></sum><ci id="S2.E1.m1.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.1">𝑚</ci></apply><apply id="S2.E1.m1.47.47.1.1.1.cmml" xref="S2.E1.m1.49.49.3"><times id="S2.E1.m1.47.47.1.1.1.2.cmml" xref="S2.E1.m1.49.49.3.47.25.9.9.3a"></times><apply id="S2.E1.m1.47.47.1.1.1.3.cmml" xref="S2.E1.m1.49.49.3"><log id="S2.E1.m1.3.3.3.3.3.3.cmml" xref="S2.E1.m1.3.3.3.3.3.3"></log><ci id="S2.E1.m1.4.4.4.4.4.4.cmml" xref="S2.E1.m1.4.4.4.4.4.4">𝑝</ci></apply><apply id="S2.E1.m1.47.47.1.1.1.1.1.1.cmml" xref="S2.E1.m1.49.49.3"><csymbol cd="ambiguous" id="S2.E1.m1.47.47.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.49.49.3">superscript</csymbol><ci id="S2.E1.m1.6.6.6.6.6.6.cmml" xref="S2.E1.m1.6.6.6.6.6.6">𝐱</ci><ci id="S2.E1.m1.7.7.7.7.7.7.1.cmml" xref="S2.E1.m1.7.7.7.7.7.7.1">𝑚</ci></apply></apply></apply><apply id="S2.E1.m1.48.48.2.2.cmml" xref="S2.E1.m1.49.49.3"><apply id="S2.E1.m1.48.48.2.2.2.cmml" xref="S2.E1.m1.49.49.3"><csymbol cd="ambiguous" id="S2.E1.m1.48.48.2.2.2.1.cmml" xref="S2.E1.m1.49.49.3.47.25.9.9.3a">subscript</csymbol><sum id="S2.E1.m1.10.10.10.10.2.2.cmml" xref="S2.E1.m1.10.10.10.10.2.2"></sum><ci id="S2.E1.m1.11.11.11.11.3.3.1.cmml" xref="S2.E1.m1.11.11.11.11.3.3.1">𝑚</ci></apply><apply id="S2.E1.m1.48.48.2.2.1.cmml" xref="S2.E1.m1.49.49.3"><times id="S2.E1.m1.48.48.2.2.1.2.cmml" xref="S2.E1.m1.49.49.3.47.25.9.9.3a"></times><apply id="S2.E1.m1.48.48.2.2.1.3.cmml" xref="S2.E1.m1.49.49.3"><csymbol cd="ambiguous" id="S2.E1.m1.48.48.2.2.1.3.1.cmml" xref="S2.E1.m1.49.49.3.47.25.9.9.3a">subscript</csymbol><ci id="S2.E1.m1.12.12.12.12.4.4.cmml" xref="S2.E1.m1.12.12.12.12.4.4">𝔼</ci><apply id="S2.E1.m1.13.13.13.13.5.5.1.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1"><csymbol cd="latexml" id="S2.E1.m1.13.13.13.13.5.5.1.2.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.2">similar-to</csymbol><ci id="S2.E1.m1.13.13.13.13.5.5.1.3.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.3">𝐳</ci><apply id="S2.E1.m1.13.13.13.13.5.5.1.1.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1"><times id="S2.E1.m1.13.13.13.13.5.5.1.1.2.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1.2"></times><apply id="S2.E1.m1.13.13.13.13.5.5.1.1.3.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.13.13.13.13.5.5.1.1.3.1.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1.3">subscript</csymbol><ci id="S2.E1.m1.13.13.13.13.5.5.1.1.3.2.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1.3.2">𝑞</ci><ci id="S2.E1.m1.13.13.13.13.5.5.1.1.3.3.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1.3.3">italic-ϕ</ci></apply><apply id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.1.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.2.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.2">𝐳</ci><apply id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3.2">𝐱</ci><ci id="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.13.13.13.13.5.5.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply></apply></apply><apply id="S2.E1.m1.48.48.2.2.1.1.2.cmml" xref="S2.E1.m1.49.49.3"><csymbol cd="latexml" id="S2.E1.m1.48.48.2.2.1.1.2.1.cmml" xref="S2.E1.m1.49.49.3">delimited-[]</csymbol><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.cmml" xref="S2.E1.m1.49.49.3"><plus id="S2.E1.m1.35.35.35.11.11.11.cmml" xref="S2.E1.m1.35.35.35.11.11.11"></plus><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.2.cmml" xref="S2.E1.m1.49.49.3"><minus id="S2.E1.m1.24.24.24.24.16.16.cmml" xref="S2.E1.m1.24.24.24.24.16.16"></minus><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.49.49.3"><times id="S2.E1.m1.48.48.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.49.49.3"></times><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.49.49.3"><log id="S2.E1.m1.15.15.15.15.7.7.cmml" xref="S2.E1.m1.15.15.15.15.7.7"></log><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.49.49.3"><csymbol cd="ambiguous" id="S2.E1.m1.48.48.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.49.49.3">subscript</csymbol><ci id="S2.E1.m1.16.16.16.16.8.8.cmml" xref="S2.E1.m1.16.16.16.16.8.8">𝑝</ci><ci id="S2.E1.m1.17.17.17.17.9.9.1.cmml" xref="S2.E1.m1.17.17.17.17.9.9.1">𝜎</ci></apply></apply><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.49.49.3"><ci id="S2.E1.m1.21.21.21.21.13.13.cmml" xref="S2.E1.m1.21.21.21.21.13.13">|</ci><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.49.49.3"><csymbol cd="ambiguous" id="S2.E1.m1.48.48.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.49.49.3">superscript</csymbol><ci id="S2.E1.m1.19.19.19.19.11.11.cmml" xref="S2.E1.m1.19.19.19.19.11.11">𝐱</ci><ci id="S2.E1.m1.20.20.20.20.12.12.1.cmml" xref="S2.E1.m1.20.20.20.20.12.12.1">𝑚</ci></apply><ci id="S2.E1.m1.22.22.22.22.14.14.cmml" xref="S2.E1.m1.22.22.22.22.14.14">𝐳</ci></apply></apply><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.2.2.cmml" xref="S2.E1.m1.49.49.3"><times id="S2.E1.m1.48.48.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.49.49.3"></times><ci id="S2.E1.m1.25.25.25.1.1.1.cmml" xref="S2.E1.m1.25.25.25.1.1.1">𝛽</ci><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.2.2.4.cmml" xref="S2.E1.m1.49.49.3"><log id="S2.E1.m1.26.26.26.2.2.2.cmml" xref="S2.E1.m1.26.26.26.2.2.2"></log><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.2.2.4.2.cmml" xref="S2.E1.m1.49.49.3"><csymbol cd="ambiguous" id="S2.E1.m1.48.48.2.2.1.1.1.1.2.2.4.2.1.cmml" xref="S2.E1.m1.49.49.3">subscript</csymbol><ci id="S2.E1.m1.27.27.27.3.3.3.cmml" xref="S2.E1.m1.27.27.27.3.3.3">𝑞</ci><ci id="S2.E1.m1.28.28.28.4.4.4.1.cmml" xref="S2.E1.m1.28.28.28.4.4.4.1">italic-ϕ</ci></apply></apply><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.2.2.1.1.1.cmml" xref="S2.E1.m1.49.49.3"><ci id="S2.E1.m1.31.31.31.7.7.7.cmml" xref="S2.E1.m1.31.31.31.7.7.7">|</ci><ci id="S2.E1.m1.30.30.30.6.6.6.cmml" xref="S2.E1.m1.30.30.30.6.6.6">𝐳</ci><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.2.2.1.1.1.3.cmml" xref="S2.E1.m1.49.49.3"><csymbol cd="ambiguous" id="S2.E1.m1.48.48.2.2.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S2.E1.m1.49.49.3">superscript</csymbol><ci id="S2.E1.m1.32.32.32.8.8.8.cmml" xref="S2.E1.m1.32.32.32.8.8.8">𝐱</ci><ci id="S2.E1.m1.33.33.33.9.9.9.1.cmml" xref="S2.E1.m1.33.33.33.9.9.9.1">𝑚</ci></apply></apply></apply></apply><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.4.cmml" xref="S2.E1.m1.49.49.3"><times id="S2.E1.m1.48.48.2.2.1.1.1.1.4.1.cmml" xref="S2.E1.m1.49.49.3"></times><ci id="S2.E1.m1.36.36.36.12.12.12.cmml" xref="S2.E1.m1.36.36.36.12.12.12">𝛽</ci><apply id="S2.E1.m1.48.48.2.2.1.1.1.1.4.3.cmml" xref="S2.E1.m1.49.49.3"><log id="S2.E1.m1.37.37.37.13.13.13.cmml" xref="S2.E1.m1.37.37.37.13.13.13"></log><ci id="S2.E1.m1.38.38.38.14.14.14.cmml" xref="S2.E1.m1.38.38.38.14.14.14">𝑝</ci></apply><ci id="S2.E1.m1.40.40.40.16.16.16.cmml" xref="S2.E1.m1.40.40.40.16.16.16">𝐳</ci></apply></apply></apply></apply></apply></apply><apply id="S2.E1.m1.48.48.2c.cmml" xref="S2.E1.m1.49.49.3"><eq id="S2.E1.m1.43.43.43.19.19.19.cmml" xref="S2.E1.m1.43.43.43.19.19.19"></eq><share href="#S2.E1.m1.48.48.2.2.cmml" id="S2.E1.m1.48.48.2d.cmml" xref="S2.E1.m1.49.49.3.47.25.9.9.3a"></share><apply id="S2.E1.m1.48.48.2.6.cmml" xref="S2.E1.m1.49.49.3"><csymbol cd="ambiguous" id="S2.E1.m1.48.48.2.6.1.cmml" xref="S2.E1.m1.49.49.3.47.25.9.9.3a">subscript</csymbol><apply id="S2.E1.m1.48.48.2.6.2.cmml" xref="S2.E1.m1.49.49.3"><csymbol cd="ambiguous" id="S2.E1.m1.48.48.2.6.2.1.cmml" xref="S2.E1.m1.49.49.3.47.25.9.9.3a">superscript</csymbol><ci id="S2.E1.m1.44.44.44.20.20.20.cmml" xref="S2.E1.m1.44.44.44.20.20.20">𝒰</ci><ci id="S2.E1.m1.45.45.45.21.21.21.1.cmml" xref="S2.E1.m1.45.45.45.21.21.21.1">𝛽</ci></apply><apply id="S2.E1.m1.46.46.46.22.22.22.1.cmml" xref="S2.E1.m1.46.46.46.22.22.22.1"><times id="S2.E1.m1.46.46.46.22.22.22.1.1.cmml" xref="S2.E1.m1.46.46.46.22.22.22.1.1"></times><ci id="S2.E1.m1.46.46.46.22.22.22.1.2.cmml" xref="S2.E1.m1.46.46.46.22.22.22.1.2">𝑞</ci><ci id="S2.E1.m1.46.46.46.22.22.22.1.3.cmml" xref="S2.E1.m1.46.46.46.22.22.22.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.49c">\displaystyle\begin{split}\sum_{m}\log p(\mathbf{x}^{m})&amp;\geq\sum_{m}\mathbb{E}_{\mathbf{z}\sim q_{\phi}(\mathbf{z}|\mathbf{x}^{m})}[\log p_{\sigma}(\mathbf{x}^{m}|\mathbf{z})-\\
&amp;\beta\log q_{\phi}(\mathbf{z}|\mathbf{x}^{m})+\beta\log p(\mathbf{z})]=\mathcal{U}^{\beta}_{qc}\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p4.8" class="ltx_p">where the lower bound holds for <math id="S2.SS2.p4.6.m1.1" class="ltx_Math" alttext="\beta&gt;1" display="inline"><semantics id="S2.SS2.p4.6.m1.1a"><mrow id="S2.SS2.p4.6.m1.1.1" xref="S2.SS2.p4.6.m1.1.1.cmml"><mi id="S2.SS2.p4.6.m1.1.1.2" xref="S2.SS2.p4.6.m1.1.1.2.cmml">β</mi><mo id="S2.SS2.p4.6.m1.1.1.1" xref="S2.SS2.p4.6.m1.1.1.1.cmml">&gt;</mo><mn id="S2.SS2.p4.6.m1.1.1.3" xref="S2.SS2.p4.6.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.6.m1.1b"><apply id="S2.SS2.p4.6.m1.1.1.cmml" xref="S2.SS2.p4.6.m1.1.1"><gt id="S2.SS2.p4.6.m1.1.1.1.cmml" xref="S2.SS2.p4.6.m1.1.1.1"></gt><ci id="S2.SS2.p4.6.m1.1.1.2.cmml" xref="S2.SS2.p4.6.m1.1.1.2">𝛽</ci><cn type="integer" id="S2.SS2.p4.6.m1.1.1.3.cmml" xref="S2.SS2.p4.6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.6.m1.1c">\beta&gt;1</annotation></semantics></math>. <span id="S2.SS2.p4.8.2" class="ltx_text" style="color:#000000;">In practice,
we follow prior work in violating the bound, using
<math id="S2.SS2.p4.7.1.m1.1" class="ltx_Math" alttext="\beta&lt;1" display="inline"><semantics id="S2.SS2.p4.7.1.m1.1a"><mrow id="S2.SS2.p4.7.1.m1.1.1" xref="S2.SS2.p4.7.1.m1.1.1.cmml"><mi mathcolor="#000000" id="S2.SS2.p4.7.1.m1.1.1.2" xref="S2.SS2.p4.7.1.m1.1.1.2.cmml">β</mi><mo mathcolor="#000000" id="S2.SS2.p4.7.1.m1.1.1.1" xref="S2.SS2.p4.7.1.m1.1.1.1.cmml">&lt;</mo><mn mathcolor="#000000" id="S2.SS2.p4.7.1.m1.1.1.3" xref="S2.SS2.p4.7.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.7.1.m1.1b"><apply id="S2.SS2.p4.7.1.m1.1.1.cmml" xref="S2.SS2.p4.7.1.m1.1.1"><lt id="S2.SS2.p4.7.1.m1.1.1.1.cmml" xref="S2.SS2.p4.7.1.m1.1.1.1"></lt><ci id="S2.SS2.p4.7.1.m1.1.1.2.cmml" xref="S2.SS2.p4.7.1.m1.1.1.2">𝛽</ci><cn type="integer" id="S2.SS2.p4.7.1.m1.1.1.3.cmml" xref="S2.SS2.p4.7.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.7.1.m1.1c">\beta&lt;1</annotation></semantics></math> to scale the contribution from
<math id="S2.SS2.p4.8.2.m2.1" class="ltx_math_unparsed" alttext="\mathbb{KL}\left({q(\mathbf{z}|\mathbf{x})}||{p(\mathbf{z})}\right)" display="inline"><semantics id="S2.SS2.p4.8.2.m2.1a"><mrow id="S2.SS2.p4.8.2.m2.1b"><mi mathcolor="#000000" id="S2.SS2.p4.8.2.m2.1.2">𝕂</mi><mi mathcolor="#000000" id="S2.SS2.p4.8.2.m2.1.3">𝕃</mi><mrow id="S2.SS2.p4.8.2.m2.1.4"><mo mathcolor="#000000" id="S2.SS2.p4.8.2.m2.1.4.1">(</mo><mi mathcolor="#000000" id="S2.SS2.p4.8.2.m2.1.4.2">q</mi><mrow id="S2.SS2.p4.8.2.m2.1.4.3"><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p4.8.2.m2.1.4.3.1">(</mo><mi mathcolor="#000000" id="S2.SS2.p4.8.2.m2.1.4.3.2">𝐳</mi><mo fence="false" mathcolor="#000000" rspace="0.167em" stretchy="false" id="S2.SS2.p4.8.2.m2.1.4.3.3">|</mo><mi mathcolor="#000000" id="S2.SS2.p4.8.2.m2.1.4.3.4">𝐱</mi><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p4.8.2.m2.1.4.3.5">)</mo></mrow><mo fence="false" mathcolor="#000000" rspace="0.167em" stretchy="false" id="S2.SS2.p4.8.2.m2.1.4.4">|</mo><mo fence="false" mathcolor="#000000" rspace="0.167em" stretchy="false" id="S2.SS2.p4.8.2.m2.1.4.5">|</mo><mi mathcolor="#000000" id="S2.SS2.p4.8.2.m2.1.4.6">p</mi><mrow id="S2.SS2.p4.8.2.m2.1.4.7"><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p4.8.2.m2.1.4.7.1">(</mo><mi mathcolor="#000000" id="S2.SS2.p4.8.2.m2.1.1">𝐳</mi><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p4.8.2.m2.1.4.7.2">)</mo></mrow><mo mathcolor="#000000" id="S2.SS2.p4.8.2.m2.1.4.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.SS2.p4.8.2.m2.1c">\mathbb{KL}\left({q(\mathbf{z}|\mathbf{x})}||{p(\mathbf{z})}\right)</annotation></semantics></math>
in <a href="#S2.E1" title="In 2.2 Learning ‣ 2 Methods ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">1</span></a>. This has been shown to be important for learning meaningful representations
when decoding sequences (c.f. <cite class="ltx_cite ltx_citemacro_citet">Alemi et al. (<a href="#bib.bib2" title="" class="ltx_ref">2018</a>); Bowman et al. (<a href="#bib.bib8" title="" class="ltx_ref">2016</a>); Miao &amp; Blunsom (<a href="#bib.bib32" title="" class="ltx_ref">2016</a>); Yin et al. (<a href="#bib.bib53" title="" class="ltx_ref">2018</a>)</cite>).
For more context, <cite class="ltx_cite ltx_citemacro_citet">Alemi et al. (<a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>
provides theoretical justifications for why this is desirable when decoding
sequences which we discuss in more detail in the Appendix.</span></p>
</div>
<div id="S2.SS2.p5" class="ltx_para">
<p id="S2.SS2.p5.8" class="ltx_p"><span id="S2.SS2.p5.1.1" class="ltx_text" style="color:#000000;">The <math id="S2.SS2.p5.1.1.m1.1" class="ltx_Math" alttext="\mathcal{U}_{qc}" display="inline"><semantics id="S2.SS2.p5.1.1.m1.1a"><msub id="S2.SS2.p5.1.1.m1.1.1" xref="S2.SS2.p5.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S2.SS2.p5.1.1.m1.1.1.2" xref="S2.SS2.p5.1.1.m1.1.1.2.cmml">𝒰</mi><mrow id="S2.SS2.p5.1.1.m1.1.1.3" xref="S2.SS2.p5.1.1.m1.1.1.3.cmml"><mi mathcolor="#000000" id="S2.SS2.p5.1.1.m1.1.1.3.2" xref="S2.SS2.p5.1.1.m1.1.1.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.1.1.m1.1.1.3.1" xref="S2.SS2.p5.1.1.m1.1.1.3.1.cmml">​</mo><mi mathcolor="#000000" id="S2.SS2.p5.1.1.m1.1.1.3.3" xref="S2.SS2.p5.1.1.m1.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.1.1.m1.1b"><apply id="S2.SS2.p5.1.1.m1.1.1.cmml" xref="S2.SS2.p5.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.1.1.m1.1.1.1.cmml" xref="S2.SS2.p5.1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p5.1.1.m1.1.1.2.cmml" xref="S2.SS2.p5.1.1.m1.1.1.2">𝒰</ci><apply id="S2.SS2.p5.1.1.m1.1.1.3.cmml" xref="S2.SS2.p5.1.1.m1.1.1.3"><times id="S2.SS2.p5.1.1.m1.1.1.3.1.cmml" xref="S2.SS2.p5.1.1.m1.1.1.3.1"></times><ci id="S2.SS2.p5.1.1.m1.1.1.3.2.cmml" xref="S2.SS2.p5.1.1.m1.1.1.3.2">𝑞</ci><ci id="S2.SS2.p5.1.1.m1.1.1.3.3.cmml" xref="S2.SS2.p5.1.1.m1.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.1.1.m1.1c">\mathcal{U}_{qc}</annotation></semantics></math> term in <a href="#S2.E1" title="In 2.2 Learning ‣ 2 Methods ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">1</span></a> does not capture the semantics of programs,
in terms of how they relate to particular questions. For modeling legible programs,</span>
we would also like to make use of the labelled data <math id="S2.SS2.p5.2.m1.2" class="ltx_Math" alttext="\{\mathbf{x}^{n},\mathbf{z}^{n}\}" display="inline"><semantics id="S2.SS2.p5.2.m1.2a"><mrow id="S2.SS2.p5.2.m1.2.2.2" xref="S2.SS2.p5.2.m1.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.p5.2.m1.2.2.2.3" xref="S2.SS2.p5.2.m1.2.2.3.cmml">{</mo><msup id="S2.SS2.p5.2.m1.1.1.1.1" xref="S2.SS2.p5.2.m1.1.1.1.1.cmml"><mi id="S2.SS2.p5.2.m1.1.1.1.1.2" xref="S2.SS2.p5.2.m1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS2.p5.2.m1.1.1.1.1.3" xref="S2.SS2.p5.2.m1.1.1.1.1.3.cmml">n</mi></msup><mo id="S2.SS2.p5.2.m1.2.2.2.4" xref="S2.SS2.p5.2.m1.2.2.3.cmml">,</mo><msup id="S2.SS2.p5.2.m1.2.2.2.2" xref="S2.SS2.p5.2.m1.2.2.2.2.cmml"><mi id="S2.SS2.p5.2.m1.2.2.2.2.2" xref="S2.SS2.p5.2.m1.2.2.2.2.2.cmml">𝐳</mi><mi id="S2.SS2.p5.2.m1.2.2.2.2.3" xref="S2.SS2.p5.2.m1.2.2.2.2.3.cmml">n</mi></msup><mo stretchy="false" id="S2.SS2.p5.2.m1.2.2.2.5" xref="S2.SS2.p5.2.m1.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.2.m1.2b"><set id="S2.SS2.p5.2.m1.2.2.3.cmml" xref="S2.SS2.p5.2.m1.2.2.2"><apply id="S2.SS2.p5.2.m1.1.1.1.1.cmml" xref="S2.SS2.p5.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.2.m1.1.1.1.1.1.cmml" xref="S2.SS2.p5.2.m1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p5.2.m1.1.1.1.1.2.cmml" xref="S2.SS2.p5.2.m1.1.1.1.1.2">𝐱</ci><ci id="S2.SS2.p5.2.m1.1.1.1.1.3.cmml" xref="S2.SS2.p5.2.m1.1.1.1.1.3">𝑛</ci></apply><apply id="S2.SS2.p5.2.m1.2.2.2.2.cmml" xref="S2.SS2.p5.2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.2.m1.2.2.2.2.1.cmml" xref="S2.SS2.p5.2.m1.2.2.2.2">superscript</csymbol><ci id="S2.SS2.p5.2.m1.2.2.2.2.2.cmml" xref="S2.SS2.p5.2.m1.2.2.2.2.2">𝐳</ci><ci id="S2.SS2.p5.2.m1.2.2.2.2.3.cmml" xref="S2.SS2.p5.2.m1.2.2.2.2.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.2.m1.2c">\{\mathbf{x}^{n},\mathbf{z}^{n}\}</annotation></semantics></math>
to learn associations between questions and programs, and provide legible explanations
for novel questions <math id="S2.SS2.p5.3.m2.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.SS2.p5.3.m2.1a"><mi id="S2.SS2.p5.3.m2.1.1" xref="S2.SS2.p5.3.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.3.m2.1b"><ci id="S2.SS2.p5.3.m2.1.1.cmml" xref="S2.SS2.p5.3.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.3.m2.1c">\mathbf{x}</annotation></semantics></math>. To do this, one can factorize the model to maximize
<math id="S2.SS2.p5.4.m3.2" class="ltx_Math" alttext="\mathcal{L}=\sum_{n}\log p(\mathbf{x}^{n}|\mathbf{z}^{n})+\log p(\mathbf{z}^{n})" display="inline"><semantics id="S2.SS2.p5.4.m3.2a"><mrow id="S2.SS2.p5.4.m3.2.2" xref="S2.SS2.p5.4.m3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p5.4.m3.2.2.4" xref="S2.SS2.p5.4.m3.2.2.4.cmml">ℒ</mi><mo rspace="0.111em" id="S2.SS2.p5.4.m3.2.2.3" xref="S2.SS2.p5.4.m3.2.2.3.cmml">=</mo><mrow id="S2.SS2.p5.4.m3.2.2.2" xref="S2.SS2.p5.4.m3.2.2.2.cmml"><mrow id="S2.SS2.p5.4.m3.1.1.1.1" xref="S2.SS2.p5.4.m3.1.1.1.1.cmml"><msub id="S2.SS2.p5.4.m3.1.1.1.1.2" xref="S2.SS2.p5.4.m3.1.1.1.1.2.cmml"><mo id="S2.SS2.p5.4.m3.1.1.1.1.2.2" xref="S2.SS2.p5.4.m3.1.1.1.1.2.2.cmml">∑</mo><mi id="S2.SS2.p5.4.m3.1.1.1.1.2.3" xref="S2.SS2.p5.4.m3.1.1.1.1.2.3.cmml">n</mi></msub><mrow id="S2.SS2.p5.4.m3.1.1.1.1.1" xref="S2.SS2.p5.4.m3.1.1.1.1.1.cmml"><mrow id="S2.SS2.p5.4.m3.1.1.1.1.1.3" xref="S2.SS2.p5.4.m3.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p5.4.m3.1.1.1.1.1.3.1" xref="S2.SS2.p5.4.m3.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.SS2.p5.4.m3.1.1.1.1.1.3a" xref="S2.SS2.p5.4.m3.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.SS2.p5.4.m3.1.1.1.1.1.3.2" xref="S2.SS2.p5.4.m3.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p5.4.m3.1.1.1.1.1.2" xref="S2.SS2.p5.4.m3.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.2" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.cmml"><msup id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2.2" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2.3" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2.3.cmml">n</mi></msup><mo fence="false" id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.1" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.1.cmml">|</mo><msup id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3.2" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3.3" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></msup></mrow><mo stretchy="false" id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.3" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS2.p5.4.m3.2.2.2.3" xref="S2.SS2.p5.4.m3.2.2.2.3.cmml">+</mo><mrow id="S2.SS2.p5.4.m3.2.2.2.2" xref="S2.SS2.p5.4.m3.2.2.2.2.cmml"><mrow id="S2.SS2.p5.4.m3.2.2.2.2.3" xref="S2.SS2.p5.4.m3.2.2.2.2.3.cmml"><mi id="S2.SS2.p5.4.m3.2.2.2.2.3.1" xref="S2.SS2.p5.4.m3.2.2.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.SS2.p5.4.m3.2.2.2.2.3a" xref="S2.SS2.p5.4.m3.2.2.2.2.3.cmml">⁡</mo><mi id="S2.SS2.p5.4.m3.2.2.2.2.3.2" xref="S2.SS2.p5.4.m3.2.2.2.2.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p5.4.m3.2.2.2.2.2" xref="S2.SS2.p5.4.m3.2.2.2.2.2.cmml">​</mo><mrow id="S2.SS2.p5.4.m3.2.2.2.2.1.1" xref="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p5.4.m3.2.2.2.2.1.1.2" xref="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.cmml">(</mo><msup id="S2.SS2.p5.4.m3.2.2.2.2.1.1.1" xref="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.cmml"><mi id="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.2" xref="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.2.cmml">𝐳</mi><mi id="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.3" xref="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.3.cmml">n</mi></msup><mo stretchy="false" id="S2.SS2.p5.4.m3.2.2.2.2.1.1.3" xref="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.4.m3.2b"><apply id="S2.SS2.p5.4.m3.2.2.cmml" xref="S2.SS2.p5.4.m3.2.2"><eq id="S2.SS2.p5.4.m3.2.2.3.cmml" xref="S2.SS2.p5.4.m3.2.2.3"></eq><ci id="S2.SS2.p5.4.m3.2.2.4.cmml" xref="S2.SS2.p5.4.m3.2.2.4">ℒ</ci><apply id="S2.SS2.p5.4.m3.2.2.2.cmml" xref="S2.SS2.p5.4.m3.2.2.2"><plus id="S2.SS2.p5.4.m3.2.2.2.3.cmml" xref="S2.SS2.p5.4.m3.2.2.2.3"></plus><apply id="S2.SS2.p5.4.m3.1.1.1.1.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1"><apply id="S2.SS2.p5.4.m3.1.1.1.1.2.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p5.4.m3.1.1.1.1.2.1.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.2">subscript</csymbol><sum id="S2.SS2.p5.4.m3.1.1.1.1.2.2.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.2.2"></sum><ci id="S2.SS2.p5.4.m3.1.1.1.1.2.3.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.2.3">𝑛</ci></apply><apply id="S2.SS2.p5.4.m3.1.1.1.1.1.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1"><times id="S2.SS2.p5.4.m3.1.1.1.1.1.2.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.2"></times><apply id="S2.SS2.p5.4.m3.1.1.1.1.1.3.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.3"><log id="S2.SS2.p5.4.m3.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.3.1"></log><ci id="S2.SS2.p5.4.m3.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3.2">𝐳</ci><ci id="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p5.4.m3.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S2.SS2.p5.4.m3.2.2.2.2.cmml" xref="S2.SS2.p5.4.m3.2.2.2.2"><times id="S2.SS2.p5.4.m3.2.2.2.2.2.cmml" xref="S2.SS2.p5.4.m3.2.2.2.2.2"></times><apply id="S2.SS2.p5.4.m3.2.2.2.2.3.cmml" xref="S2.SS2.p5.4.m3.2.2.2.2.3"><log id="S2.SS2.p5.4.m3.2.2.2.2.3.1.cmml" xref="S2.SS2.p5.4.m3.2.2.2.2.3.1"></log><ci id="S2.SS2.p5.4.m3.2.2.2.2.3.2.cmml" xref="S2.SS2.p5.4.m3.2.2.2.2.3.2">𝑝</ci></apply><apply id="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.cmml" xref="S2.SS2.p5.4.m3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p5.4.m3.2.2.2.2.1.1">superscript</csymbol><ci id="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.2">𝐳</ci><ci id="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p5.4.m3.2.2.2.2.1.1.1.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.4.m3.2c">\mathcal{L}=\sum_{n}\log p(\mathbf{x}^{n}|\mathbf{z}^{n})+\log p(\mathbf{z}^{n})</annotation></semantics></math>. <span id="S2.SS2.p5.8.5" class="ltx_text" style="color:#000000;">While in theory
given the joint, it is possible to estimate <math id="S2.SS2.p5.5.2.m1.1" class="ltx_Math" alttext="p(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S2.SS2.p5.5.2.m1.1a"><mrow id="S2.SS2.p5.5.2.m1.1.1" xref="S2.SS2.p5.5.2.m1.1.1.cmml"><mi mathcolor="#000000" id="S2.SS2.p5.5.2.m1.1.1.3" xref="S2.SS2.p5.5.2.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.5.2.m1.1.1.2" xref="S2.SS2.p5.5.2.m1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p5.5.2.m1.1.1.1.1" xref="S2.SS2.p5.5.2.m1.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p5.5.2.m1.1.1.1.1.2" xref="S2.SS2.p5.5.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p5.5.2.m1.1.1.1.1.1" xref="S2.SS2.p5.5.2.m1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S2.SS2.p5.5.2.m1.1.1.1.1.1.2" xref="S2.SS2.p5.5.2.m1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" mathcolor="#000000" id="S2.SS2.p5.5.2.m1.1.1.1.1.1.1" xref="S2.SS2.p5.5.2.m1.1.1.1.1.1.1.cmml">|</mo><mi mathcolor="#000000" id="S2.SS2.p5.5.2.m1.1.1.1.1.1.3" xref="S2.SS2.p5.5.2.m1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p5.5.2.m1.1.1.1.1.3" xref="S2.SS2.p5.5.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.5.2.m1.1b"><apply id="S2.SS2.p5.5.2.m1.1.1.cmml" xref="S2.SS2.p5.5.2.m1.1.1"><times id="S2.SS2.p5.5.2.m1.1.1.2.cmml" xref="S2.SS2.p5.5.2.m1.1.1.2"></times><ci id="S2.SS2.p5.5.2.m1.1.1.3.cmml" xref="S2.SS2.p5.5.2.m1.1.1.3">𝑝</ci><apply id="S2.SS2.p5.5.2.m1.1.1.1.1.1.cmml" xref="S2.SS2.p5.5.2.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p5.5.2.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.5.2.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p5.5.2.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p5.5.2.m1.1.1.1.1.1.2">𝐳</ci><ci id="S2.SS2.p5.5.2.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p5.5.2.m1.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.5.2.m1.1c">p(\mathbf{z}|\mathbf{x})</annotation></semantics></math>, this is expensive and requires
an (in general) intractable sum over all possible programs. Ideally, one would like to
reuse
the <em id="S2.SS2.p5.8.5.1" class="ltx_emph ltx_font_italic">same</em> variational approximation <math id="S2.SS2.p5.6.3.m2.1" class="ltx_Math" alttext="q_{\phi}(\cdot)" display="inline"><semantics id="S2.SS2.p5.6.3.m2.1a"><mrow id="S2.SS2.p5.6.3.m2.1.2" xref="S2.SS2.p5.6.3.m2.1.2.cmml"><msub id="S2.SS2.p5.6.3.m2.1.2.2" xref="S2.SS2.p5.6.3.m2.1.2.2.cmml"><mi mathcolor="#000000" id="S2.SS2.p5.6.3.m2.1.2.2.2" xref="S2.SS2.p5.6.3.m2.1.2.2.2.cmml">q</mi><mi mathcolor="#000000" id="S2.SS2.p5.6.3.m2.1.2.2.3" xref="S2.SS2.p5.6.3.m2.1.2.2.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p5.6.3.m2.1.2.1" xref="S2.SS2.p5.6.3.m2.1.2.1.cmml">​</mo><mrow id="S2.SS2.p5.6.3.m2.1.2.3.2" xref="S2.SS2.p5.6.3.m2.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p5.6.3.m2.1.2.3.2.1" xref="S2.SS2.p5.6.3.m2.1.2.cmml">(</mo><mo lspace="0em" mathcolor="#000000" rspace="0em" id="S2.SS2.p5.6.3.m2.1.1" xref="S2.SS2.p5.6.3.m2.1.1.cmml">⋅</mo><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p5.6.3.m2.1.2.3.2.2" xref="S2.SS2.p5.6.3.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.6.3.m2.1b"><apply id="S2.SS2.p5.6.3.m2.1.2.cmml" xref="S2.SS2.p5.6.3.m2.1.2"><times id="S2.SS2.p5.6.3.m2.1.2.1.cmml" xref="S2.SS2.p5.6.3.m2.1.2.1"></times><apply id="S2.SS2.p5.6.3.m2.1.2.2.cmml" xref="S2.SS2.p5.6.3.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.6.3.m2.1.2.2.1.cmml" xref="S2.SS2.p5.6.3.m2.1.2.2">subscript</csymbol><ci id="S2.SS2.p5.6.3.m2.1.2.2.2.cmml" xref="S2.SS2.p5.6.3.m2.1.2.2.2">𝑞</ci><ci id="S2.SS2.p5.6.3.m2.1.2.2.3.cmml" xref="S2.SS2.p5.6.3.m2.1.2.2.3">italic-ϕ</ci></apply><ci id="S2.SS2.p5.6.3.m2.1.1.cmml" xref="S2.SS2.p5.6.3.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.6.3.m2.1c">q_{\phi}(\cdot)</annotation></semantics></math>
that we are training for <math id="S2.SS2.p5.7.4.m3.1" class="ltx_Math" alttext="\mathcal{U}_{qc}" display="inline"><semantics id="S2.SS2.p5.7.4.m3.1a"><msub id="S2.SS2.p5.7.4.m3.1.1" xref="S2.SS2.p5.7.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#000000" id="S2.SS2.p5.7.4.m3.1.1.2" xref="S2.SS2.p5.7.4.m3.1.1.2.cmml">𝒰</mi><mrow id="S2.SS2.p5.7.4.m3.1.1.3" xref="S2.SS2.p5.7.4.m3.1.1.3.cmml"><mi mathcolor="#000000" id="S2.SS2.p5.7.4.m3.1.1.3.2" xref="S2.SS2.p5.7.4.m3.1.1.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.7.4.m3.1.1.3.1" xref="S2.SS2.p5.7.4.m3.1.1.3.1.cmml">​</mo><mi mathcolor="#000000" id="S2.SS2.p5.7.4.m3.1.1.3.3" xref="S2.SS2.p5.7.4.m3.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.7.4.m3.1b"><apply id="S2.SS2.p5.7.4.m3.1.1.cmml" xref="S2.SS2.p5.7.4.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.7.4.m3.1.1.1.cmml" xref="S2.SS2.p5.7.4.m3.1.1">subscript</csymbol><ci id="S2.SS2.p5.7.4.m3.1.1.2.cmml" xref="S2.SS2.p5.7.4.m3.1.1.2">𝒰</ci><apply id="S2.SS2.p5.7.4.m3.1.1.3.cmml" xref="S2.SS2.p5.7.4.m3.1.1.3"><times id="S2.SS2.p5.7.4.m3.1.1.3.1.cmml" xref="S2.SS2.p5.7.4.m3.1.1.3.1"></times><ci id="S2.SS2.p5.7.4.m3.1.1.3.2.cmml" xref="S2.SS2.p5.7.4.m3.1.1.3.2">𝑞</ci><ci id="S2.SS2.p5.7.4.m3.1.1.3.3.cmml" xref="S2.SS2.p5.7.4.m3.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.7.4.m3.1c">\mathcal{U}_{qc}</annotation></semantics></math> so that it
learns from both labelled as well
as unlabelled data (c.f. <cite class="ltx_cite ltx_citemacro_citet">Kingma et al. (<a href="#bib.bib23" title="" class="ltx_ref">2014</a>)</cite>).
We prove the following lemma and use it to construct an objective that makes
use of <math id="S2.SS2.p5.8.5.m4.1" class="ltx_Math" alttext="q_{\phi}" display="inline"><semantics id="S2.SS2.p5.8.5.m4.1a"><msub id="S2.SS2.p5.8.5.m4.1.1" xref="S2.SS2.p5.8.5.m4.1.1.cmml"><mi mathcolor="#000000" id="S2.SS2.p5.8.5.m4.1.1.2" xref="S2.SS2.p5.8.5.m4.1.1.2.cmml">q</mi><mi mathcolor="#000000" id="S2.SS2.p5.8.5.m4.1.1.3" xref="S2.SS2.p5.8.5.m4.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.8.5.m4.1b"><apply id="S2.SS2.p5.8.5.m4.1.1.cmml" xref="S2.SS2.p5.8.5.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.8.5.m4.1.1.1.cmml" xref="S2.SS2.p5.8.5.m4.1.1">subscript</csymbol><ci id="S2.SS2.p5.8.5.m4.1.1.2.cmml" xref="S2.SS2.p5.8.5.m4.1.1.2">𝑞</ci><ci id="S2.SS2.p5.8.5.m4.1.1.3.cmml" xref="S2.SS2.p5.8.5.m4.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.8.5.m4.1c">q_{\phi}</annotation></semantics></math>, and relate it to the evidence.</span></p>
</div>
<div id="Thmlemma1" class="ltx_theorem ltx_theorem_lemma">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmlemma1.1.1.1" class="ltx_text ltx_font_bold">Lemma 1</span></span><span id="Thmlemma1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmlemma1.p1" class="ltx_para">
<p id="Thmlemma1.p1.9" class="ltx_p"><span id="Thmlemma1.p1.9.9" class="ltx_text ltx_font_italic">Given observations <math id="Thmlemma1.p1.1.1.m1.2" class="ltx_Math" alttext="\{\mathbf{x}^{n},\mathbf{z}^{n}\}" display="inline"><semantics id="Thmlemma1.p1.1.1.m1.2a"><mrow id="Thmlemma1.p1.1.1.m1.2.2.2" xref="Thmlemma1.p1.1.1.m1.2.2.3.cmml"><mo stretchy="false" id="Thmlemma1.p1.1.1.m1.2.2.2.3" xref="Thmlemma1.p1.1.1.m1.2.2.3.cmml">{</mo><msup id="Thmlemma1.p1.1.1.m1.1.1.1.1" xref="Thmlemma1.p1.1.1.m1.1.1.1.1.cmml"><mi id="Thmlemma1.p1.1.1.m1.1.1.1.1.2" xref="Thmlemma1.p1.1.1.m1.1.1.1.1.2.cmml">𝐱</mi><mi id="Thmlemma1.p1.1.1.m1.1.1.1.1.3" xref="Thmlemma1.p1.1.1.m1.1.1.1.1.3.cmml">n</mi></msup><mo id="Thmlemma1.p1.1.1.m1.2.2.2.4" xref="Thmlemma1.p1.1.1.m1.2.2.3.cmml">,</mo><msup id="Thmlemma1.p1.1.1.m1.2.2.2.2" xref="Thmlemma1.p1.1.1.m1.2.2.2.2.cmml"><mi id="Thmlemma1.p1.1.1.m1.2.2.2.2.2" xref="Thmlemma1.p1.1.1.m1.2.2.2.2.2.cmml">𝐳</mi><mi id="Thmlemma1.p1.1.1.m1.2.2.2.2.3" xref="Thmlemma1.p1.1.1.m1.2.2.2.2.3.cmml">n</mi></msup><mo stretchy="false" id="Thmlemma1.p1.1.1.m1.2.2.2.5" xref="Thmlemma1.p1.1.1.m1.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.1.1.m1.2b"><set id="Thmlemma1.p1.1.1.m1.2.2.3.cmml" xref="Thmlemma1.p1.1.1.m1.2.2.2"><apply id="Thmlemma1.p1.1.1.m1.1.1.1.1.cmml" xref="Thmlemma1.p1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="Thmlemma1.p1.1.1.m1.1.1.1.1.1.cmml" xref="Thmlemma1.p1.1.1.m1.1.1.1.1">superscript</csymbol><ci id="Thmlemma1.p1.1.1.m1.1.1.1.1.2.cmml" xref="Thmlemma1.p1.1.1.m1.1.1.1.1.2">𝐱</ci><ci id="Thmlemma1.p1.1.1.m1.1.1.1.1.3.cmml" xref="Thmlemma1.p1.1.1.m1.1.1.1.1.3">𝑛</ci></apply><apply id="Thmlemma1.p1.1.1.m1.2.2.2.2.cmml" xref="Thmlemma1.p1.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="Thmlemma1.p1.1.1.m1.2.2.2.2.1.cmml" xref="Thmlemma1.p1.1.1.m1.2.2.2.2">superscript</csymbol><ci id="Thmlemma1.p1.1.1.m1.2.2.2.2.2.cmml" xref="Thmlemma1.p1.1.1.m1.2.2.2.2.2">𝐳</ci><ci id="Thmlemma1.p1.1.1.m1.2.2.2.2.3.cmml" xref="Thmlemma1.p1.1.1.m1.2.2.2.2.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.1.1.m1.2c">\{\mathbf{x}^{n},\mathbf{z}^{n}\}</annotation></semantics></math> and <math id="Thmlemma1.p1.2.2.m2.4" class="ltx_Math" alttext="p(\mathbf{x},\mathbf{z})=p(\mathbf{z})p_{\sigma}(\mathbf{x}|\mathbf{z})" display="inline"><semantics id="Thmlemma1.p1.2.2.m2.4a"><mrow id="Thmlemma1.p1.2.2.m2.4.4" xref="Thmlemma1.p1.2.2.m2.4.4.cmml"><mrow id="Thmlemma1.p1.2.2.m2.4.4.3" xref="Thmlemma1.p1.2.2.m2.4.4.3.cmml"><mi id="Thmlemma1.p1.2.2.m2.4.4.3.2" xref="Thmlemma1.p1.2.2.m2.4.4.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.2.2.m2.4.4.3.1" xref="Thmlemma1.p1.2.2.m2.4.4.3.1.cmml">​</mo><mrow id="Thmlemma1.p1.2.2.m2.4.4.3.3.2" xref="Thmlemma1.p1.2.2.m2.4.4.3.3.1.cmml"><mo stretchy="false" id="Thmlemma1.p1.2.2.m2.4.4.3.3.2.1" xref="Thmlemma1.p1.2.2.m2.4.4.3.3.1.cmml">(</mo><mi id="Thmlemma1.p1.2.2.m2.1.1" xref="Thmlemma1.p1.2.2.m2.1.1.cmml">𝐱</mi><mo id="Thmlemma1.p1.2.2.m2.4.4.3.3.2.2" xref="Thmlemma1.p1.2.2.m2.4.4.3.3.1.cmml">,</mo><mi id="Thmlemma1.p1.2.2.m2.2.2" xref="Thmlemma1.p1.2.2.m2.2.2.cmml">𝐳</mi><mo stretchy="false" id="Thmlemma1.p1.2.2.m2.4.4.3.3.2.3" xref="Thmlemma1.p1.2.2.m2.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo id="Thmlemma1.p1.2.2.m2.4.4.2" xref="Thmlemma1.p1.2.2.m2.4.4.2.cmml">=</mo><mrow id="Thmlemma1.p1.2.2.m2.4.4.1" xref="Thmlemma1.p1.2.2.m2.4.4.1.cmml"><mi id="Thmlemma1.p1.2.2.m2.4.4.1.3" xref="Thmlemma1.p1.2.2.m2.4.4.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.2.2.m2.4.4.1.2" xref="Thmlemma1.p1.2.2.m2.4.4.1.2.cmml">​</mo><mrow id="Thmlemma1.p1.2.2.m2.4.4.1.4.2" xref="Thmlemma1.p1.2.2.m2.4.4.1.cmml"><mo stretchy="false" id="Thmlemma1.p1.2.2.m2.4.4.1.4.2.1" xref="Thmlemma1.p1.2.2.m2.4.4.1.cmml">(</mo><mi id="Thmlemma1.p1.2.2.m2.3.3" xref="Thmlemma1.p1.2.2.m2.3.3.cmml">𝐳</mi><mo stretchy="false" id="Thmlemma1.p1.2.2.m2.4.4.1.4.2.2" xref="Thmlemma1.p1.2.2.m2.4.4.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.2.2.m2.4.4.1.2a" xref="Thmlemma1.p1.2.2.m2.4.4.1.2.cmml">​</mo><msub id="Thmlemma1.p1.2.2.m2.4.4.1.5" xref="Thmlemma1.p1.2.2.m2.4.4.1.5.cmml"><mi id="Thmlemma1.p1.2.2.m2.4.4.1.5.2" xref="Thmlemma1.p1.2.2.m2.4.4.1.5.2.cmml">p</mi><mi id="Thmlemma1.p1.2.2.m2.4.4.1.5.3" xref="Thmlemma1.p1.2.2.m2.4.4.1.5.3.cmml">σ</mi></msub><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.2.2.m2.4.4.1.2b" xref="Thmlemma1.p1.2.2.m2.4.4.1.2.cmml">​</mo><mrow id="Thmlemma1.p1.2.2.m2.4.4.1.1.1" xref="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.cmml"><mo stretchy="false" id="Thmlemma1.p1.2.2.m2.4.4.1.1.1.2" xref="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.cmml">(</mo><mrow id="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1" xref="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.cmml"><mi id="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.2" xref="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.1" xref="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.1.cmml">|</mo><mi id="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.3" xref="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.3.cmml">𝐳</mi></mrow><mo stretchy="false" id="Thmlemma1.p1.2.2.m2.4.4.1.1.1.3" xref="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.2.2.m2.4b"><apply id="Thmlemma1.p1.2.2.m2.4.4.cmml" xref="Thmlemma1.p1.2.2.m2.4.4"><eq id="Thmlemma1.p1.2.2.m2.4.4.2.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.2"></eq><apply id="Thmlemma1.p1.2.2.m2.4.4.3.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.3"><times id="Thmlemma1.p1.2.2.m2.4.4.3.1.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.3.1"></times><ci id="Thmlemma1.p1.2.2.m2.4.4.3.2.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.3.2">𝑝</ci><interval closure="open" id="Thmlemma1.p1.2.2.m2.4.4.3.3.1.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.3.3.2"><ci id="Thmlemma1.p1.2.2.m2.1.1.cmml" xref="Thmlemma1.p1.2.2.m2.1.1">𝐱</ci><ci id="Thmlemma1.p1.2.2.m2.2.2.cmml" xref="Thmlemma1.p1.2.2.m2.2.2">𝐳</ci></interval></apply><apply id="Thmlemma1.p1.2.2.m2.4.4.1.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.1"><times id="Thmlemma1.p1.2.2.m2.4.4.1.2.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.1.2"></times><ci id="Thmlemma1.p1.2.2.m2.4.4.1.3.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.1.3">𝑝</ci><ci id="Thmlemma1.p1.2.2.m2.3.3.cmml" xref="Thmlemma1.p1.2.2.m2.3.3">𝐳</ci><apply id="Thmlemma1.p1.2.2.m2.4.4.1.5.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.1.5"><csymbol cd="ambiguous" id="Thmlemma1.p1.2.2.m2.4.4.1.5.1.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.1.5">subscript</csymbol><ci id="Thmlemma1.p1.2.2.m2.4.4.1.5.2.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.1.5.2">𝑝</ci><ci id="Thmlemma1.p1.2.2.m2.4.4.1.5.3.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.1.5.3">𝜎</ci></apply><apply id="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.1.1.1"><csymbol cd="latexml" id="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.1.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.1">conditional</csymbol><ci id="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.2.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.2">𝐱</ci><ci id="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.3.cmml" xref="Thmlemma1.p1.2.2.m2.4.4.1.1.1.1.3">𝐳</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.2.2.m2.4c">p(\mathbf{x},\mathbf{z})=p(\mathbf{z})p_{\sigma}(\mathbf{x}|\mathbf{z})</annotation></semantics></math>,
let <math id="Thmlemma1.p1.3.3.m3.1" class="ltx_Math" alttext="z_{t}" display="inline"><semantics id="Thmlemma1.p1.3.3.m3.1a"><msub id="Thmlemma1.p1.3.3.m3.1.1" xref="Thmlemma1.p1.3.3.m3.1.1.cmml"><mi id="Thmlemma1.p1.3.3.m3.1.1.2" xref="Thmlemma1.p1.3.3.m3.1.1.2.cmml">z</mi><mi id="Thmlemma1.p1.3.3.m3.1.1.3" xref="Thmlemma1.p1.3.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.3.3.m3.1b"><apply id="Thmlemma1.p1.3.3.m3.1.1.cmml" xref="Thmlemma1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="Thmlemma1.p1.3.3.m3.1.1.1.cmml" xref="Thmlemma1.p1.3.3.m3.1.1">subscript</csymbol><ci id="Thmlemma1.p1.3.3.m3.1.1.2.cmml" xref="Thmlemma1.p1.3.3.m3.1.1.2">𝑧</ci><ci id="Thmlemma1.p1.3.3.m3.1.1.3.cmml" xref="Thmlemma1.p1.3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.3.3.m3.1c">z_{t}</annotation></semantics></math>, the token at the <math id="Thmlemma1.p1.4.4.m4.1" class="ltx_Math" alttext="t^{th}" display="inline"><semantics id="Thmlemma1.p1.4.4.m4.1a"><msup id="Thmlemma1.p1.4.4.m4.1.1" xref="Thmlemma1.p1.4.4.m4.1.1.cmml"><mi id="Thmlemma1.p1.4.4.m4.1.1.2" xref="Thmlemma1.p1.4.4.m4.1.1.2.cmml">t</mi><mrow id="Thmlemma1.p1.4.4.m4.1.1.3" xref="Thmlemma1.p1.4.4.m4.1.1.3.cmml"><mi id="Thmlemma1.p1.4.4.m4.1.1.3.2" xref="Thmlemma1.p1.4.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.4.4.m4.1.1.3.1" xref="Thmlemma1.p1.4.4.m4.1.1.3.1.cmml">​</mo><mi id="Thmlemma1.p1.4.4.m4.1.1.3.3" xref="Thmlemma1.p1.4.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.4.4.m4.1b"><apply id="Thmlemma1.p1.4.4.m4.1.1.cmml" xref="Thmlemma1.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="Thmlemma1.p1.4.4.m4.1.1.1.cmml" xref="Thmlemma1.p1.4.4.m4.1.1">superscript</csymbol><ci id="Thmlemma1.p1.4.4.m4.1.1.2.cmml" xref="Thmlemma1.p1.4.4.m4.1.1.2">𝑡</ci><apply id="Thmlemma1.p1.4.4.m4.1.1.3.cmml" xref="Thmlemma1.p1.4.4.m4.1.1.3"><times id="Thmlemma1.p1.4.4.m4.1.1.3.1.cmml" xref="Thmlemma1.p1.4.4.m4.1.1.3.1"></times><ci id="Thmlemma1.p1.4.4.m4.1.1.3.2.cmml" xref="Thmlemma1.p1.4.4.m4.1.1.3.2">𝑡</ci><ci id="Thmlemma1.p1.4.4.m4.1.1.3.3.cmml" xref="Thmlemma1.p1.4.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.4.4.m4.1c">t^{th}</annotation></semantics></math> timestep in a sequence <math id="Thmlemma1.p1.5.5.m5.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="Thmlemma1.p1.5.5.m5.1a"><mi id="Thmlemma1.p1.5.5.m5.1.1" xref="Thmlemma1.p1.5.5.m5.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.5.5.m5.1b"><ci id="Thmlemma1.p1.5.5.m5.1.1.cmml" xref="Thmlemma1.p1.5.5.m5.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.5.5.m5.1c">\mathbf{z}</annotation></semantics></math> be distributed
as a categorical with parameters <math id="Thmlemma1.p1.6.6.m6.1" class="ltx_Math" alttext="\pi_{t}" display="inline"><semantics id="Thmlemma1.p1.6.6.m6.1a"><msub id="Thmlemma1.p1.6.6.m6.1.1" xref="Thmlemma1.p1.6.6.m6.1.1.cmml"><mi id="Thmlemma1.p1.6.6.m6.1.1.2" xref="Thmlemma1.p1.6.6.m6.1.1.2.cmml">π</mi><mi id="Thmlemma1.p1.6.6.m6.1.1.3" xref="Thmlemma1.p1.6.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.6.6.m6.1b"><apply id="Thmlemma1.p1.6.6.m6.1.1.cmml" xref="Thmlemma1.p1.6.6.m6.1.1"><csymbol cd="ambiguous" id="Thmlemma1.p1.6.6.m6.1.1.1.cmml" xref="Thmlemma1.p1.6.6.m6.1.1">subscript</csymbol><ci id="Thmlemma1.p1.6.6.m6.1.1.2.cmml" xref="Thmlemma1.p1.6.6.m6.1.1.2">𝜋</ci><ci id="Thmlemma1.p1.6.6.m6.1.1.3.cmml" xref="Thmlemma1.p1.6.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.6.6.m6.1c">\pi_{t}</annotation></semantics></math>. Let us denote
<math id="Thmlemma1.p1.7.7.m7.1" class="ltx_Math" alttext="\Pi=\{\pi_{t}\}_{t=1}^{T}" display="inline"><semantics id="Thmlemma1.p1.7.7.m7.1a"><mrow id="Thmlemma1.p1.7.7.m7.1.1" xref="Thmlemma1.p1.7.7.m7.1.1.cmml"><mi mathvariant="normal" id="Thmlemma1.p1.7.7.m7.1.1.3" xref="Thmlemma1.p1.7.7.m7.1.1.3.cmml">Π</mi><mo id="Thmlemma1.p1.7.7.m7.1.1.2" xref="Thmlemma1.p1.7.7.m7.1.1.2.cmml">=</mo><msubsup id="Thmlemma1.p1.7.7.m7.1.1.1" xref="Thmlemma1.p1.7.7.m7.1.1.1.cmml"><mrow id="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.2" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.1.2.cmml">{</mo><msub id="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1.cmml"><mi id="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1.2" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1.2.cmml">π</mi><mi id="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1.3" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.3" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="Thmlemma1.p1.7.7.m7.1.1.1.1.3" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.3.cmml"><mi id="Thmlemma1.p1.7.7.m7.1.1.1.1.3.2" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.3.2.cmml">t</mi><mo id="Thmlemma1.p1.7.7.m7.1.1.1.1.3.1" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.3.1.cmml">=</mo><mn id="Thmlemma1.p1.7.7.m7.1.1.1.1.3.3" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="Thmlemma1.p1.7.7.m7.1.1.1.3" xref="Thmlemma1.p1.7.7.m7.1.1.1.3.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.7.7.m7.1b"><apply id="Thmlemma1.p1.7.7.m7.1.1.cmml" xref="Thmlemma1.p1.7.7.m7.1.1"><eq id="Thmlemma1.p1.7.7.m7.1.1.2.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.2"></eq><ci id="Thmlemma1.p1.7.7.m7.1.1.3.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.3">Π</ci><apply id="Thmlemma1.p1.7.7.m7.1.1.1.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1"><csymbol cd="ambiguous" id="Thmlemma1.p1.7.7.m7.1.1.1.2.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1">superscript</csymbol><apply id="Thmlemma1.p1.7.7.m7.1.1.1.1.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1"><csymbol cd="ambiguous" id="Thmlemma1.p1.7.7.m7.1.1.1.1.2.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1">subscript</csymbol><set id="Thmlemma1.p1.7.7.m7.1.1.1.1.1.2.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1"><apply id="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1.1.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1">subscript</csymbol><ci id="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1.2.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1.2">𝜋</ci><ci id="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1.3.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="Thmlemma1.p1.7.7.m7.1.1.1.1.3.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.3"><eq id="Thmlemma1.p1.7.7.m7.1.1.1.1.3.1.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.3.1"></eq><ci id="Thmlemma1.p1.7.7.m7.1.1.1.1.3.2.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="Thmlemma1.p1.7.7.m7.1.1.1.1.3.3.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1.1.3.3">1</cn></apply></apply><ci id="Thmlemma1.p1.7.7.m7.1.1.1.3.cmml" xref="Thmlemma1.p1.7.7.m7.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.7.7.m7.1c">\Pi=\{\pi_{t}\}_{t=1}^{T}</annotation></semantics></math>, the joint random variable over all <math id="Thmlemma1.p1.8.8.m8.1" class="ltx_Math" alttext="\pi_{t}" display="inline"><semantics id="Thmlemma1.p1.8.8.m8.1a"><msub id="Thmlemma1.p1.8.8.m8.1.1" xref="Thmlemma1.p1.8.8.m8.1.1.cmml"><mi id="Thmlemma1.p1.8.8.m8.1.1.2" xref="Thmlemma1.p1.8.8.m8.1.1.2.cmml">π</mi><mi id="Thmlemma1.p1.8.8.m8.1.1.3" xref="Thmlemma1.p1.8.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.8.8.m8.1b"><apply id="Thmlemma1.p1.8.8.m8.1.1.cmml" xref="Thmlemma1.p1.8.8.m8.1.1"><csymbol cd="ambiguous" id="Thmlemma1.p1.8.8.m8.1.1.1.cmml" xref="Thmlemma1.p1.8.8.m8.1.1">subscript</csymbol><ci id="Thmlemma1.p1.8.8.m8.1.1.2.cmml" xref="Thmlemma1.p1.8.8.m8.1.1.2">𝜋</ci><ci id="Thmlemma1.p1.8.8.m8.1.1.3.cmml" xref="Thmlemma1.p1.8.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.8.8.m8.1c">\pi_{t}</annotation></semantics></math>. Then,
the following is a lower bound on the joint evidence <math id="Thmlemma1.p1.9.9.m9.2" class="ltx_Math" alttext="\mathcal{L}=\sum_{n}\log p(\mathbf{z}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})" display="inline"><semantics id="Thmlemma1.p1.9.9.m9.2a"><mrow id="Thmlemma1.p1.9.9.m9.2.2" xref="Thmlemma1.p1.9.9.m9.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmlemma1.p1.9.9.m9.2.2.4" xref="Thmlemma1.p1.9.9.m9.2.2.4.cmml">ℒ</mi><mo rspace="0.111em" id="Thmlemma1.p1.9.9.m9.2.2.3" xref="Thmlemma1.p1.9.9.m9.2.2.3.cmml">=</mo><mrow id="Thmlemma1.p1.9.9.m9.2.2.2" xref="Thmlemma1.p1.9.9.m9.2.2.2.cmml"><mrow id="Thmlemma1.p1.9.9.m9.1.1.1.1" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.cmml"><msub id="Thmlemma1.p1.9.9.m9.1.1.1.1.2" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.2.cmml"><mo id="Thmlemma1.p1.9.9.m9.1.1.1.1.2.2" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.2.2.cmml">∑</mo><mi id="Thmlemma1.p1.9.9.m9.1.1.1.1.2.3" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.2.3.cmml">n</mi></msub><mrow id="Thmlemma1.p1.9.9.m9.1.1.1.1.1" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.cmml"><mrow id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3.cmml"><mi id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3.1" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3a" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3.cmml">⁡</mo><mi id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3.2" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.2" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.2.cmml">​</mo><mrow id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.2" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.cmml"><mi id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.2" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.3" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo stretchy="false" id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.3" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Thmlemma1.p1.9.9.m9.2.2.2.3" xref="Thmlemma1.p1.9.9.m9.2.2.2.3.cmml">+</mo><mrow id="Thmlemma1.p1.9.9.m9.2.2.2.2" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.cmml"><mrow id="Thmlemma1.p1.9.9.m9.2.2.2.2.3" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.3.cmml"><mi id="Thmlemma1.p1.9.9.m9.2.2.2.2.3.1" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="Thmlemma1.p1.9.9.m9.2.2.2.2.3a" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.3.cmml">⁡</mo><msub id="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2.cmml"><mi id="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2.2" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2.2.cmml">p</mi><mi id="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2.3" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2.3.cmml">σ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.9.9.m9.2.2.2.2.2" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.2.cmml">​</mo><mrow id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.2" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.cmml">(</mo><mrow id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.cmml"><msup id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2.cmml"><mi id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2.2" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2.2.cmml">𝐱</mi><mi id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2.3" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2.3.cmml">n</mi></msup><mo fence="false" id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.1" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.1.cmml">|</mo><msup id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3.cmml"><mi id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3.2" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3.2.cmml">𝐳</mi><mi id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3.3" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3.3.cmml">n</mi></msup></mrow><mo stretchy="false" id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.3" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.9.9.m9.2b"><apply id="Thmlemma1.p1.9.9.m9.2.2.cmml" xref="Thmlemma1.p1.9.9.m9.2.2"><eq id="Thmlemma1.p1.9.9.m9.2.2.3.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.3"></eq><ci id="Thmlemma1.p1.9.9.m9.2.2.4.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.4">ℒ</ci><apply id="Thmlemma1.p1.9.9.m9.2.2.2.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2"><plus id="Thmlemma1.p1.9.9.m9.2.2.2.3.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.3"></plus><apply id="Thmlemma1.p1.9.9.m9.1.1.1.1.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1"><apply id="Thmlemma1.p1.9.9.m9.1.1.1.1.2.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.2"><csymbol cd="ambiguous" id="Thmlemma1.p1.9.9.m9.1.1.1.1.2.1.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.2">subscript</csymbol><sum id="Thmlemma1.p1.9.9.m9.1.1.1.1.2.2.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.2.2"></sum><ci id="Thmlemma1.p1.9.9.m9.1.1.1.1.2.3.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.2.3">𝑛</ci></apply><apply id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1"><times id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.2.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.2"></times><apply id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3"><log id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3.1.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3.1"></log><ci id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3.2.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.1.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1">superscript</csymbol><ci id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.2.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.3.cmml" xref="Thmlemma1.p1.9.9.m9.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="Thmlemma1.p1.9.9.m9.2.2.2.2.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2"><times id="Thmlemma1.p1.9.9.m9.2.2.2.2.2.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.2"></times><apply id="Thmlemma1.p1.9.9.m9.2.2.2.2.3.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.3"><log id="Thmlemma1.p1.9.9.m9.2.2.2.2.3.1.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.3.1"></log><apply id="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2"><csymbol cd="ambiguous" id="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2.1.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2">subscript</csymbol><ci id="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2.2.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2.2">𝑝</ci><ci id="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2.3.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.3.2.3">𝜎</ci></apply></apply><apply id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1"><csymbol cd="latexml" id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.1.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.1">conditional</csymbol><apply id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2.1.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2.2.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2.2">𝐱</ci><ci id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2.3.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.2.3">𝑛</ci></apply><apply id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3.1.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3.2.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3.2">𝐳</ci><ci id="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3.3.cmml" xref="Thmlemma1.p1.9.9.m9.2.2.2.2.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.9.9.m9.2c">\mathcal{L}=\sum_{n}\log p(\mathbf{z}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})</annotation></semantics></math>:</span></p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.49" class="ltx_math_unparsed" alttext="\mathcal{L}\geq\sum_{n=1}^{N}\log q_{\phi}(\mathbf{z}^{n}|\mathbf{x}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})-\\
\mathbb{KL}\left({q(\Pi|\mathbf{z}^{n},\mathbf{x}^{n})}||{p(\Pi)}\right)" display="block"><semantics id="S2.E2.m1.49a"><mtable displaystyle="true" rowspacing="0pt" id="S2.E2.m1.49.49.2"><mtr id="S2.E2.m1.49.49.2a"><mtd class="ltx_align_left" columnalign="left" id="S2.E2.m1.49.49.2b"><mrow id="S2.E2.m1.49.49.2.49.29.29"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.1.1">ℒ</mi><mo rspace="0.111em" id="S2.E2.m1.2.2.2.2.2.2">≥</mo><mrow id="S2.E2.m1.49.49.2.49.29.29.29"><mrow id="S2.E2.m1.48.48.1.48.28.28.28.1"><munderover id="S2.E2.m1.48.48.1.48.28.28.28.1.2"><mo movablelimits="false" id="S2.E2.m1.3.3.3.3.3.3">∑</mo><mrow id="S2.E2.m1.4.4.4.4.4.4.1"><mi id="S2.E2.m1.4.4.4.4.4.4.1.2">n</mi><mo id="S2.E2.m1.4.4.4.4.4.4.1.1">=</mo><mn id="S2.E2.m1.4.4.4.4.4.4.1.3">1</mn></mrow><mi id="S2.E2.m1.5.5.5.5.5.5.1">N</mi></munderover><mrow id="S2.E2.m1.48.48.1.48.28.28.28.1.1"><mrow id="S2.E2.m1.48.48.1.48.28.28.28.1.1.3"><mi id="S2.E2.m1.6.6.6.6.6.6">log</mi><mo lspace="0.167em" id="S2.E2.m1.48.48.1.48.28.28.28.1.1.3a">⁡</mo><msub id="S2.E2.m1.48.48.1.48.28.28.28.1.1.3.1"><mi id="S2.E2.m1.7.7.7.7.7.7">q</mi><mi id="S2.E2.m1.8.8.8.8.8.8.1">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.48.48.1.48.28.28.28.1.1.2">​</mo><mrow id="S2.E2.m1.48.48.1.48.28.28.28.1.1.1.1"><mo stretchy="false" id="S2.E2.m1.9.9.9.9.9.9">(</mo><mrow id="S2.E2.m1.48.48.1.48.28.28.28.1.1.1.1.1"><msup id="S2.E2.m1.48.48.1.48.28.28.28.1.1.1.1.1.1"><mi id="S2.E2.m1.10.10.10.10.10.10">𝐳</mi><mi id="S2.E2.m1.11.11.11.11.11.11.1">n</mi></msup><mo fence="false" id="S2.E2.m1.12.12.12.12.12.12">|</mo><msup id="S2.E2.m1.48.48.1.48.28.28.28.1.1.1.1.1.2"><mi id="S2.E2.m1.13.13.13.13.13.13">𝐱</mi><mi id="S2.E2.m1.14.14.14.14.14.14.1">n</mi></msup></mrow><mo stretchy="false" id="S2.E2.m1.15.15.15.15.15.15">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.16.16.16.16.16.16">+</mo><mrow id="S2.E2.m1.49.49.2.49.29.29.29.2"><mrow id="S2.E2.m1.49.49.2.49.29.29.29.2.1"><mrow id="S2.E2.m1.49.49.2.49.29.29.29.2.1.3"><mi id="S2.E2.m1.17.17.17.17.17.17">log</mi><mo lspace="0.167em" id="S2.E2.m1.49.49.2.49.29.29.29.2.1.3a">⁡</mo><msub id="S2.E2.m1.49.49.2.49.29.29.29.2.1.3.1"><mi id="S2.E2.m1.18.18.18.18.18.18">p</mi><mi id="S2.E2.m1.19.19.19.19.19.19.1">σ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.49.49.2.49.29.29.29.2.1.2">​</mo><mrow id="S2.E2.m1.49.49.2.49.29.29.29.2.1.1.1"><mo stretchy="false" id="S2.E2.m1.20.20.20.20.20.20">(</mo><mrow id="S2.E2.m1.49.49.2.49.29.29.29.2.1.1.1.1"><msup id="S2.E2.m1.49.49.2.49.29.29.29.2.1.1.1.1.1"><mi id="S2.E2.m1.21.21.21.21.21.21">𝐱</mi><mi id="S2.E2.m1.22.22.22.22.22.22.1">n</mi></msup><mo fence="false" id="S2.E2.m1.23.23.23.23.23.23">|</mo><msup id="S2.E2.m1.49.49.2.49.29.29.29.2.1.1.1.1.2"><mi id="S2.E2.m1.24.24.24.24.24.24">𝐳</mi><mi id="S2.E2.m1.25.25.25.25.25.25.1">n</mi></msup></mrow><mo stretchy="false" id="S2.E2.m1.26.26.26.26.26.26">)</mo></mrow></mrow><mo id="S2.E2.m1.27.27.27.27.27.27">−</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S2.E2.m1.49.49.2c"><mtd class="ltx_align_right" columnalign="right" id="S2.E2.m1.49.49.2d"><mrow id="S2.E2.m1.47.47.47.20.20"><mi id="S2.E2.m1.28.28.28.1.1.1">𝕂</mi><mi id="S2.E2.m1.29.29.29.2.2.2">𝕃</mi><mrow id="S2.E2.m1.47.47.47.20.20.21"><mo id="S2.E2.m1.30.30.30.3.3.3">(</mo><mi id="S2.E2.m1.31.31.31.4.4.4">q</mi><mrow id="S2.E2.m1.47.47.47.20.20.21.1"><mo stretchy="false" id="S2.E2.m1.32.32.32.5.5.5">(</mo><mi mathvariant="normal" id="S2.E2.m1.33.33.33.6.6.6">Π</mi><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E2.m1.34.34.34.7.7.7">|</mo><msup id="S2.E2.m1.47.47.47.20.20.21.1.1"><mi id="S2.E2.m1.35.35.35.8.8.8">𝐳</mi><mi id="S2.E2.m1.36.36.36.9.9.9.1">n</mi></msup><mo id="S2.E2.m1.37.37.37.10.10.10">,</mo><msup id="S2.E2.m1.47.47.47.20.20.21.1.2"><mi id="S2.E2.m1.38.38.38.11.11.11">𝐱</mi><mi id="S2.E2.m1.39.39.39.12.12.12.1">n</mi></msup><mo stretchy="false" id="S2.E2.m1.40.40.40.13.13.13">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E2.m1.41.41.41.14.14.14">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E2.m1.42.42.42.15.15.15">|</mo><mi id="S2.E2.m1.43.43.43.16.16.16">p</mi><mrow id="S2.E2.m1.47.47.47.20.20.21.2"><mo stretchy="false" id="S2.E2.m1.44.44.44.17.17.17">(</mo><mi mathvariant="normal" id="S2.E2.m1.45.45.45.18.18.18">Π</mi><mo stretchy="false" id="S2.E2.m1.46.46.46.19.19.19">)</mo></mrow><mo id="S2.E2.m1.47.47.47.20.20.20">)</mo></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S2.E2.m1.49b">\mathcal{L}\geq\sum_{n=1}^{N}\log q_{\phi}(\mathbf{z}^{n}|\mathbf{x}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})-\\
\mathbb{KL}\left({q(\Pi|\mathbf{z}^{n},\mathbf{x}^{n})}||{p(\Pi)}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="Thmlemma1.p1.13" class="ltx_p"><span id="Thmlemma1.p1.13.4" class="ltx_text ltx_font_italic">where <math id="Thmlemma1.p1.10.1.m1.1" class="ltx_Math" alttext="p(\Pi)" display="inline"><semantics id="Thmlemma1.p1.10.1.m1.1a"><mrow id="Thmlemma1.p1.10.1.m1.1.2" xref="Thmlemma1.p1.10.1.m1.1.2.cmml"><mi id="Thmlemma1.p1.10.1.m1.1.2.2" xref="Thmlemma1.p1.10.1.m1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.10.1.m1.1.2.1" xref="Thmlemma1.p1.10.1.m1.1.2.1.cmml">​</mo><mrow id="Thmlemma1.p1.10.1.m1.1.2.3.2" xref="Thmlemma1.p1.10.1.m1.1.2.cmml"><mo stretchy="false" id="Thmlemma1.p1.10.1.m1.1.2.3.2.1" xref="Thmlemma1.p1.10.1.m1.1.2.cmml">(</mo><mi mathvariant="normal" id="Thmlemma1.p1.10.1.m1.1.1" xref="Thmlemma1.p1.10.1.m1.1.1.cmml">Π</mi><mo stretchy="false" id="Thmlemma1.p1.10.1.m1.1.2.3.2.2" xref="Thmlemma1.p1.10.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.10.1.m1.1b"><apply id="Thmlemma1.p1.10.1.m1.1.2.cmml" xref="Thmlemma1.p1.10.1.m1.1.2"><times id="Thmlemma1.p1.10.1.m1.1.2.1.cmml" xref="Thmlemma1.p1.10.1.m1.1.2.1"></times><ci id="Thmlemma1.p1.10.1.m1.1.2.2.cmml" xref="Thmlemma1.p1.10.1.m1.1.2.2">𝑝</ci><ci id="Thmlemma1.p1.10.1.m1.1.1.cmml" xref="Thmlemma1.p1.10.1.m1.1.1">Π</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.10.1.m1.1c">p(\Pi)</annotation></semantics></math> is a distribution over the sampling distributions implied by the prior <math id="Thmlemma1.p1.11.2.m2.1" class="ltx_Math" alttext="p(\mathbf{z})" display="inline"><semantics id="Thmlemma1.p1.11.2.m2.1a"><mrow id="Thmlemma1.p1.11.2.m2.1.2" xref="Thmlemma1.p1.11.2.m2.1.2.cmml"><mi id="Thmlemma1.p1.11.2.m2.1.2.2" xref="Thmlemma1.p1.11.2.m2.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.11.2.m2.1.2.1" xref="Thmlemma1.p1.11.2.m2.1.2.1.cmml">​</mo><mrow id="Thmlemma1.p1.11.2.m2.1.2.3.2" xref="Thmlemma1.p1.11.2.m2.1.2.cmml"><mo stretchy="false" id="Thmlemma1.p1.11.2.m2.1.2.3.2.1" xref="Thmlemma1.p1.11.2.m2.1.2.cmml">(</mo><mi id="Thmlemma1.p1.11.2.m2.1.1" xref="Thmlemma1.p1.11.2.m2.1.1.cmml">𝐳</mi><mo stretchy="false" id="Thmlemma1.p1.11.2.m2.1.2.3.2.2" xref="Thmlemma1.p1.11.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.11.2.m2.1b"><apply id="Thmlemma1.p1.11.2.m2.1.2.cmml" xref="Thmlemma1.p1.11.2.m2.1.2"><times id="Thmlemma1.p1.11.2.m2.1.2.1.cmml" xref="Thmlemma1.p1.11.2.m2.1.2.1"></times><ci id="Thmlemma1.p1.11.2.m2.1.2.2.cmml" xref="Thmlemma1.p1.11.2.m2.1.2.2">𝑝</ci><ci id="Thmlemma1.p1.11.2.m2.1.1.cmml" xref="Thmlemma1.p1.11.2.m2.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.11.2.m2.1c">p(\mathbf{z})</annotation></semantics></math>
and <math id="Thmlemma1.p1.12.3.m3.4" class="ltx_Math" alttext="q(\Pi|\mathbf{x}^{n},\mathbf{z}^{n})=q(\pi_{0})\prod_{t=1}^{T}q(\pi_{t}|\mathbf{x}^{n},z_{0}^{n},\cdots,z_{t-1}^{n})" display="inline"><semantics id="Thmlemma1.p1.12.3.m3.4a"><mrow id="Thmlemma1.p1.12.3.m3.4.4" xref="Thmlemma1.p1.12.3.m3.4.4.cmml"><mrow id="Thmlemma1.p1.12.3.m3.2.2.1" xref="Thmlemma1.p1.12.3.m3.2.2.1.cmml"><mi id="Thmlemma1.p1.12.3.m3.2.2.1.3" xref="Thmlemma1.p1.12.3.m3.2.2.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.12.3.m3.2.2.1.2" xref="Thmlemma1.p1.12.3.m3.2.2.1.2.cmml">​</mo><mrow id="Thmlemma1.p1.12.3.m3.2.2.1.1.1" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.2" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.cmml">(</mo><mrow id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.cmml"><mi mathvariant="normal" id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.4" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.4.cmml">Π</mi><mo fence="false" id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.3" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.3.cmml">|</mo><mrow id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.3.cmml"><msup id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.cmml"><mi id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.2" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.3" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.3" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.3.cmml">,</mo><msup id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.cmml"><mi id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.2" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.2.cmml">𝐳</mi><mi id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.3" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.3.cmml">n</mi></msup></mrow></mrow><mo stretchy="false" id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.3" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmlemma1.p1.12.3.m3.4.4.4" xref="Thmlemma1.p1.12.3.m3.4.4.4.cmml">=</mo><mrow id="Thmlemma1.p1.12.3.m3.4.4.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.cmml"><mi id="Thmlemma1.p1.12.3.m3.4.4.3.4" xref="Thmlemma1.p1.12.3.m3.4.4.3.4.cmml">q</mi><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.12.3.m3.4.4.3.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.3.cmml">​</mo><mrow id="Thmlemma1.p1.12.3.m3.3.3.2.1.1" xref="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.cmml"><mo stretchy="false" id="Thmlemma1.p1.12.3.m3.3.3.2.1.1.2" xref="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.cmml">(</mo><msub id="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1" xref="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.cmml"><mi id="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.2" xref="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.2.cmml">π</mi><mn id="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.3" xref="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.3.cmml">0</mn></msub><mo stretchy="false" id="Thmlemma1.p1.12.3.m3.3.3.2.1.1.3" xref="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.12.3.m3.4.4.3.3a" xref="Thmlemma1.p1.12.3.m3.4.4.3.3.cmml">​</mo><mrow id="Thmlemma1.p1.12.3.m3.4.4.3.2" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.cmml"><msubsup id="Thmlemma1.p1.12.3.m3.4.4.3.2.2" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.cmml"><mo id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.2" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.2.cmml">∏</mo><mrow id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.cmml"><mi id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.2" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.2.cmml">t</mi><mo id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.1" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.1.cmml">=</mo><mn id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.3.cmml">1</mn></mrow><mi id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.3.cmml">T</mi></msubsup><mrow id="Thmlemma1.p1.12.3.m3.4.4.3.2.1" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.cmml"><mi id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.2" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.2.cmml">​</mo><mrow id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.cmml"><mo stretchy="false" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.2" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.cmml">(</mo><mrow id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.cmml"><msub id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.cmml"><mi id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.2" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.2.cmml">π</mi><mi id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.3.cmml">t</mi></msub><mo fence="false" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.4" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.4.cmml">|</mo><mrow id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.4.cmml"><msup id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.cmml"><mi id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.2" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.4" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.4.cmml">,</mo><msubsup id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.cmml"><mi id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.2" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.2.cmml">z</mi><mn id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.3.cmml">0</mn><mi id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.3.cmml">n</mi></msubsup><mo id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.5" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="Thmlemma1.p1.12.3.m3.1.1" xref="Thmlemma1.p1.12.3.m3.1.1.cmml">⋯</mi><mo id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.6" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.4.cmml">,</mo><msubsup id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.cmml"><mi id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.2" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.2.cmml">z</mi><mrow id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.cmml"><mi id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.2" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.2.cmml">t</mi><mo id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.1" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.1.cmml">−</mo><mn id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.3.cmml">1</mn></mrow><mi id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.3.cmml">n</mi></msubsup></mrow></mrow><mo stretchy="false" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.3" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.12.3.m3.4b"><apply id="Thmlemma1.p1.12.3.m3.4.4.cmml" xref="Thmlemma1.p1.12.3.m3.4.4"><eq id="Thmlemma1.p1.12.3.m3.4.4.4.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.4"></eq><apply id="Thmlemma1.p1.12.3.m3.2.2.1.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1"><times id="Thmlemma1.p1.12.3.m3.2.2.1.2.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.2"></times><ci id="Thmlemma1.p1.12.3.m3.2.2.1.3.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.3">𝑞</ci><apply id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1"><csymbol cd="latexml" id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.3.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.3">conditional</csymbol><ci id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.4.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.4">Π</ci><list id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.3.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2"><apply id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.1.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.2.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.2">𝐱</ci><ci id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.3.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.1.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.2.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.2">𝐳</ci><ci id="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.3.cmml" xref="Thmlemma1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.3">𝑛</ci></apply></list></apply></apply><apply id="Thmlemma1.p1.12.3.m3.4.4.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3"><times id="Thmlemma1.p1.12.3.m3.4.4.3.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.3"></times><ci id="Thmlemma1.p1.12.3.m3.4.4.3.4.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.4">𝑞</ci><apply id="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.cmml" xref="Thmlemma1.p1.12.3.m3.3.3.2.1.1"><csymbol cd="ambiguous" id="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.1.cmml" xref="Thmlemma1.p1.12.3.m3.3.3.2.1.1">subscript</csymbol><ci id="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.2.cmml" xref="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.2">𝜋</ci><cn type="integer" id="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.3.cmml" xref="Thmlemma1.p1.12.3.m3.3.3.2.1.1.1.3">0</cn></apply><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2"><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2"><csymbol cd="ambiguous" id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2">superscript</csymbol><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2"><csymbol cd="ambiguous" id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2">subscript</csymbol><csymbol cd="latexml" id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.2">product</csymbol><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3"><eq id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.1"></eq><ci id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.2">𝑡</ci><cn type="integer" id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.2.3.3">1</cn></apply></apply><ci id="Thmlemma1.p1.12.3.m3.4.4.3.2.2.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.2.3">𝑇</ci></apply><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1"><times id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.2"></times><ci id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.3">𝑞</ci><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1"><csymbol cd="latexml" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.4.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.4">conditional</csymbol><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5"><csymbol cd="ambiguous" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5">subscript</csymbol><ci id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.2">𝜋</ci><ci id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.3">𝑡</ci></apply><list id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.4.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3"><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.2">𝐱</ci><ci id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2">superscript</csymbol><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.2">𝑧</ci><cn type="integer" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.3">0</cn></apply><ci id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.3">𝑛</ci></apply><ci id="Thmlemma1.p1.12.3.m3.1.1.cmml" xref="Thmlemma1.p1.12.3.m3.1.1">⋯</ci><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3">superscript</csymbol><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3">subscript</csymbol><ci id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.2">𝑧</ci><apply id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3"><minus id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.1.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.1"></minus><ci id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.2.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.2">𝑡</ci><cn type="integer" id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.3">1</cn></apply></apply><ci id="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.3.cmml" xref="Thmlemma1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.3">𝑛</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.12.3.m3.4c">q(\Pi|\mathbf{x}^{n},\mathbf{z}^{n})=q(\pi_{0})\prod_{t=1}^{T}q(\pi_{t}|\mathbf{x}^{n},z_{0}^{n},\cdots,z_{t-1}^{n})</annotation></semantics></math>, where
each <math id="Thmlemma1.p1.13.4.m4.1" class="ltx_Math" alttext="q(\pi_{t}|\cdot)" display="inline"><semantics id="Thmlemma1.p1.13.4.m4.1a"><mrow id="Thmlemma1.p1.13.4.m4.1.1" xref="Thmlemma1.p1.13.4.m4.1.1.cmml"><mi id="Thmlemma1.p1.13.4.m4.1.1.3" xref="Thmlemma1.p1.13.4.m4.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.13.4.m4.1.1.2" xref="Thmlemma1.p1.13.4.m4.1.1.2.cmml">​</mo><mrow id="Thmlemma1.p1.13.4.m4.1.1.1.1" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="Thmlemma1.p1.13.4.m4.1.1.1.1.2" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="Thmlemma1.p1.13.4.m4.1.1.1.1.1" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.cmml"><msub id="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2.cmml"><mi id="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2.2" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2.2.cmml">π</mi><mi id="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2.3" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" rspace="0em" id="Thmlemma1.p1.13.4.m4.1.1.1.1.1.1" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.1.cmml">|</mo><mo lspace="0em" rspace="0em" id="Thmlemma1.p1.13.4.m4.1.1.1.1.1.3" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.3.cmml">⋅</mo></mrow><mo stretchy="false" id="Thmlemma1.p1.13.4.m4.1.1.1.1.3" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmlemma1.p1.13.4.m4.1b"><apply id="Thmlemma1.p1.13.4.m4.1.1.cmml" xref="Thmlemma1.p1.13.4.m4.1.1"><times id="Thmlemma1.p1.13.4.m4.1.1.2.cmml" xref="Thmlemma1.p1.13.4.m4.1.1.2"></times><ci id="Thmlemma1.p1.13.4.m4.1.1.3.cmml" xref="Thmlemma1.p1.13.4.m4.1.1.3">𝑞</ci><apply id="Thmlemma1.p1.13.4.m4.1.1.1.1.1.cmml" xref="Thmlemma1.p1.13.4.m4.1.1.1.1"><csymbol cd="latexml" id="Thmlemma1.p1.13.4.m4.1.1.1.1.1.1.cmml" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.1">conditional</csymbol><apply id="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2.cmml" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2.1.cmml" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2">subscript</csymbol><ci id="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2.2.cmml" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2.2">𝜋</ci><ci id="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2.3.cmml" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="Thmlemma1.p1.13.4.m4.1.1.1.1.1.3.cmml" xref="Thmlemma1.p1.13.4.m4.1.1.1.1.1.3">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmlemma1.p1.13.4.m4.1c">q(\pi_{t}|\cdot)</annotation></semantics></math> is a delta distribution on the probability simplex.</span></p>
</div>
</div>
<div id="S2.SS2.p6" class="ltx_para">
<p id="S2.SS2.p6.2" class="ltx_p">See Appendix for a proof of the result. <span id="S2.SS2.p6.2.2" class="ltx_text" style="color:#000000;">This is an extension
of the result for a related graphical model (with discrete <math id="S2.SS2.p6.1.1.m1.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S2.SS2.p6.1.1.m1.1a"><mi mathcolor="#000000" id="S2.SS2.p6.1.1.m1.1.1" xref="S2.SS2.p6.1.1.m1.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.1.1.m1.1b"><ci id="S2.SS2.p6.1.1.m1.1.1.cmml" xref="S2.SS2.p6.1.1.m1.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.1.1.m1.1c">\mathbf{z}</annotation></semantics></math> observations)
from <cite class="ltx_cite ltx_citemacro_citep">(Kingma et al., <a href="#bib.bib23" title="" class="ltx_ref">2014</a>; Keng, <a href="#bib.bib21" title="" class="ltx_ref">2017</a>)</cite> to
the case where <math id="S2.SS2.p6.2.2.m2.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S2.SS2.p6.2.2.m2.1a"><mi mathcolor="#000000" id="S2.SS2.p6.2.2.m2.1.1" xref="S2.SS2.p6.2.2.m2.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.2.2.m2.1b"><ci id="S2.SS2.p6.2.2.m2.1.1.cmml" xref="S2.SS2.p6.2.2.m2.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.2.2.m2.1c">\mathbf{z}</annotation></semantics></math> is a sequence.</span></p>
</div>
<div id="S2.SS2.p7" class="ltx_para">
<p id="S2.SS2.p7.3" class="ltx_p"><span id="S2.SS2.p7.3.1" class="ltx_text" style="color:#000000;">In practice, </span>the bound above <span id="S2.SS2.p7.3.2" class="ltx_text" style="color:#000000;">not useful,</span> as the proof assumes a delta posterior
<math id="S2.SS2.p7.1.m1.3" class="ltx_Math" alttext="q(\Pi|\mathbf{z},\mathbf{x})" display="inline"><semantics id="S2.SS2.p7.1.m1.3a"><mrow id="S2.SS2.p7.1.m1.3.3" xref="S2.SS2.p7.1.m1.3.3.cmml"><mi id="S2.SS2.p7.1.m1.3.3.3" xref="S2.SS2.p7.1.m1.3.3.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p7.1.m1.3.3.2" xref="S2.SS2.p7.1.m1.3.3.2.cmml">​</mo><mrow id="S2.SS2.p7.1.m1.3.3.1.1" xref="S2.SS2.p7.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p7.1.m1.3.3.1.1.2" xref="S2.SS2.p7.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S2.SS2.p7.1.m1.3.3.1.1.1" xref="S2.SS2.p7.1.m1.3.3.1.1.1.cmml"><mi mathvariant="normal" id="S2.SS2.p7.1.m1.3.3.1.1.1.2" xref="S2.SS2.p7.1.m1.3.3.1.1.1.2.cmml">Π</mi><mo fence="false" id="S2.SS2.p7.1.m1.3.3.1.1.1.1" xref="S2.SS2.p7.1.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S2.SS2.p7.1.m1.3.3.1.1.1.3.2" xref="S2.SS2.p7.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S2.SS2.p7.1.m1.1.1" xref="S2.SS2.p7.1.m1.1.1.cmml">𝐳</mi><mo id="S2.SS2.p7.1.m1.3.3.1.1.1.3.2.1" xref="S2.SS2.p7.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S2.SS2.p7.1.m1.2.2" xref="S2.SS2.p7.1.m1.2.2.cmml">𝐱</mi></mrow></mrow><mo stretchy="false" id="S2.SS2.p7.1.m1.3.3.1.1.3" xref="S2.SS2.p7.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.1.m1.3b"><apply id="S2.SS2.p7.1.m1.3.3.cmml" xref="S2.SS2.p7.1.m1.3.3"><times id="S2.SS2.p7.1.m1.3.3.2.cmml" xref="S2.SS2.p7.1.m1.3.3.2"></times><ci id="S2.SS2.p7.1.m1.3.3.3.cmml" xref="S2.SS2.p7.1.m1.3.3.3">𝑞</ci><apply id="S2.SS2.p7.1.m1.3.3.1.1.1.cmml" xref="S2.SS2.p7.1.m1.3.3.1.1"><csymbol cd="latexml" id="S2.SS2.p7.1.m1.3.3.1.1.1.1.cmml" xref="S2.SS2.p7.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p7.1.m1.3.3.1.1.1.2.cmml" xref="S2.SS2.p7.1.m1.3.3.1.1.1.2">Π</ci><list id="S2.SS2.p7.1.m1.3.3.1.1.1.3.1.cmml" xref="S2.SS2.p7.1.m1.3.3.1.1.1.3.2"><ci id="S2.SS2.p7.1.m1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1">𝐳</ci><ci id="S2.SS2.p7.1.m1.2.2.cmml" xref="S2.SS2.p7.1.m1.2.2">𝐱</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.1.m1.3c">q(\Pi|\mathbf{z},\mathbf{x})</annotation></semantics></math> which makes the last <math id="S2.SS2.p7.2.m2.1" class="ltx_Math" alttext="\mathrm{KL}" display="inline"><semantics id="S2.SS2.p7.2.m2.1a"><mi id="S2.SS2.p7.2.m2.1.1" xref="S2.SS2.p7.2.m2.1.1.cmml">KL</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.2.m2.1b"><ci id="S2.SS2.p7.2.m2.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1">KL</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.2.m2.1c">\mathrm{KL}</annotation></semantics></math> term <math id="S2.SS2.p7.3.m3.1" class="ltx_Math" alttext="\infty" display="inline"><semantics id="S2.SS2.p7.3.m3.1a"><mi mathvariant="normal" id="S2.SS2.p7.3.m3.1.1" xref="S2.SS2.p7.3.m3.1.1.cmml">∞</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.3.m3.1b"><infinity id="S2.SS2.p7.3.m3.1.1.cmml" xref="S2.SS2.p7.3.m3.1.1"></infinity></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.3.m3.1c">\infty</annotation></semantics></math>. This means we have to resort to
learning only the first two terms in <a href="#S7.E7" title="In Lemma. ‣ 7 A variational lower bound on the evidence for sequential latent variable models ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">7</span></a> as an approximation:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.2" class="ltx_Math" alttext="\vspace{-5pt}\mathcal{L}\approx\sum_{n=1}^{N}\alpha\log q_{\phi}(\mathbf{z}^{n}|\mathbf{x}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})" display="block"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.4" xref="S2.E3.m1.2.2.4.cmml">ℒ</mi><mo rspace="0.111em" id="S2.E3.m1.2.2.3" xref="S2.E3.m1.2.2.3.cmml">≈</mo><mrow id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><munderover id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E3.m1.1.1.1.1.2.2.2" xref="S2.E3.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m1.1.1.1.1.2.2.3" xref="S2.E3.m1.1.1.1.1.2.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1.2.2.3.2" xref="S2.E3.m1.1.1.1.1.2.2.3.2.cmml">n</mi><mo id="S2.E3.m1.1.1.1.1.2.2.3.1" xref="S2.E3.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m1.1.1.1.1.2.2.3.3" xref="S2.E3.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.1.1.1.1.1.4" xref="S2.E3.m1.1.1.1.1.1.4.cmml"><mi id="S2.E3.m1.1.1.1.1.1.4.1" xref="S2.E3.m1.1.1.1.1.1.4.1.cmml">log</mi><mo lspace="0.167em" id="S2.E3.m1.1.1.1.1.1.4a" xref="S2.E3.m1.1.1.1.1.1.4.cmml">⁡</mo><msub id="S2.E3.m1.1.1.1.1.1.4.2" xref="S2.E3.m1.1.1.1.1.1.4.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.4.2.2" xref="S2.E3.m1.1.1.1.1.1.4.2.2.cmml">q</mi><mi id="S2.E3.m1.1.1.1.1.1.4.2.3" xref="S2.E3.m1.1.1.1.1.1.4.2.3.cmml">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1.1.1.2a" xref="S2.E3.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><msup id="S2.E3.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml">n</mi></msup><mo fence="false" id="S2.E3.m1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msup id="S2.E3.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></msup></mrow><mo stretchy="false" id="S2.E3.m1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.2.3" xref="S2.E3.m1.2.2.2.3.cmml">+</mo><mrow id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml"><mrow id="S2.E3.m1.2.2.2.2.3" xref="S2.E3.m1.2.2.2.2.3.cmml"><mi id="S2.E3.m1.2.2.2.2.3.1" xref="S2.E3.m1.2.2.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E3.m1.2.2.2.2.3a" xref="S2.E3.m1.2.2.2.2.3.cmml">⁡</mo><msub id="S2.E3.m1.2.2.2.2.3.2" xref="S2.E3.m1.2.2.2.2.3.2.cmml"><mi id="S2.E3.m1.2.2.2.2.3.2.2" xref="S2.E3.m1.2.2.2.2.3.2.2.cmml">p</mi><mi id="S2.E3.m1.2.2.2.2.3.2.3" xref="S2.E3.m1.2.2.2.2.3.2.3.cmml">σ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.2.cmml">​</mo><mrow id="S2.E3.m1.2.2.2.2.1.1" xref="S2.E3.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.2.2.1.1.2" xref="S2.E3.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.2.2.1.1.1" xref="S2.E3.m1.2.2.2.2.1.1.1.cmml"><msup id="S2.E3.m1.2.2.2.2.1.1.1.2" xref="S2.E3.m1.2.2.2.2.1.1.1.2.cmml"><mi id="S2.E3.m1.2.2.2.2.1.1.1.2.2" xref="S2.E3.m1.2.2.2.2.1.1.1.2.2.cmml">𝐱</mi><mi id="S2.E3.m1.2.2.2.2.1.1.1.2.3" xref="S2.E3.m1.2.2.2.2.1.1.1.2.3.cmml">n</mi></msup><mo fence="false" id="S2.E3.m1.2.2.2.2.1.1.1.1" xref="S2.E3.m1.2.2.2.2.1.1.1.1.cmml">|</mo><msup id="S2.E3.m1.2.2.2.2.1.1.1.3" xref="S2.E3.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.2.2.1.1.1.3.2" xref="S2.E3.m1.2.2.2.2.1.1.1.3.2.cmml">𝐳</mi><mi id="S2.E3.m1.2.2.2.2.1.1.1.3.3" xref="S2.E3.m1.2.2.2.2.1.1.1.3.3.cmml">n</mi></msup></mrow><mo stretchy="false" id="S2.E3.m1.2.2.2.2.1.1.3" xref="S2.E3.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><approx id="S2.E3.m1.2.2.3.cmml" xref="S2.E3.m1.2.2.3"></approx><ci id="S2.E3.m1.2.2.4.cmml" xref="S2.E3.m1.2.2.4">ℒ</ci><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><plus id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.3"></plus><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1"><apply id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.2">subscript</csymbol><sum id="S2.E3.m1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2"></sum><apply id="S2.E3.m1.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.2.3"><eq id="S2.E3.m1.1.1.1.1.2.2.3.1.cmml" xref="S2.E3.m1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m1.1.1.1.1.2.2.3.2.cmml" xref="S2.E3.m1.1.1.1.1.2.2.3.2">𝑛</ci><cn type="integer" id="S2.E3.m1.1.1.1.1.2.2.3.3.cmml" xref="S2.E3.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.2"></times><ci id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3">𝛼</ci><apply id="S2.E3.m1.1.1.1.1.1.4.cmml" xref="S2.E3.m1.1.1.1.1.1.4"><log id="S2.E3.m1.1.1.1.1.1.4.1.cmml" xref="S2.E3.m1.1.1.1.1.1.4.1"></log><apply id="S2.E3.m1.1.1.1.1.1.4.2.cmml" xref="S2.E3.m1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.4.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.4.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.4.2.2">𝑞</ci><ci id="S2.E3.m1.1.1.1.1.1.4.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.4.2.3">italic-ϕ</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.2">𝐳</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.2">𝐱</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2"><times id="S2.E3.m1.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2"></times><apply id="S2.E3.m1.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.3"><log id="S2.E3.m1.2.2.2.2.3.1.cmml" xref="S2.E3.m1.2.2.2.2.3.1"></log><apply id="S2.E3.m1.2.2.2.2.3.2.cmml" xref="S2.E3.m1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.3.2.1.cmml" xref="S2.E3.m1.2.2.2.2.3.2">subscript</csymbol><ci id="S2.E3.m1.2.2.2.2.3.2.2.cmml" xref="S2.E3.m1.2.2.2.2.3.2.2">𝑝</ci><ci id="S2.E3.m1.2.2.2.2.3.2.3.cmml" xref="S2.E3.m1.2.2.2.2.3.2.3">𝜎</ci></apply></apply><apply id="S2.E3.m1.2.2.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1.1">conditional</csymbol><apply id="S2.E3.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="S2.E3.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1.2.2">𝐱</ci><ci id="S2.E3.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1.2.3">𝑛</ci></apply><apply id="S2.E3.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S2.E3.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1.3.2">𝐳</ci><ci id="S2.E3.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\vspace{-5pt}\mathcal{L}\approx\sum_{n=1}^{N}\alpha\log q_{\phi}(\mathbf{z}^{n}|\mathbf{x}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p7.5" class="ltx_p">where <math id="S2.SS2.p7.4.m1.1" class="ltx_Math" alttext="\alpha&gt;1" display="inline"><semantics id="S2.SS2.p7.4.m1.1a"><mrow id="S2.SS2.p7.4.m1.1.1" xref="S2.SS2.p7.4.m1.1.1.cmml"><mi id="S2.SS2.p7.4.m1.1.1.2" xref="S2.SS2.p7.4.m1.1.1.2.cmml">α</mi><mo id="S2.SS2.p7.4.m1.1.1.1" xref="S2.SS2.p7.4.m1.1.1.1.cmml">&gt;</mo><mn id="S2.SS2.p7.4.m1.1.1.3" xref="S2.SS2.p7.4.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.4.m1.1b"><apply id="S2.SS2.p7.4.m1.1.1.cmml" xref="S2.SS2.p7.4.m1.1.1"><gt id="S2.SS2.p7.4.m1.1.1.1.cmml" xref="S2.SS2.p7.4.m1.1.1.1"></gt><ci id="S2.SS2.p7.4.m1.1.1.2.cmml" xref="S2.SS2.p7.4.m1.1.1.2">𝛼</ci><cn type="integer" id="S2.SS2.p7.4.m1.1.1.3.cmml" xref="S2.SS2.p7.4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.4.m1.1c">\alpha&gt;1</annotation></semantics></math> is a scaling on <math id="S2.SS2.p7.5.m2.1" class="ltx_Math" alttext="\log q_{\phi}" display="inline"><semantics id="S2.SS2.p7.5.m2.1a"><mrow id="S2.SS2.p7.5.m2.1.1" xref="S2.SS2.p7.5.m2.1.1.cmml"><mi id="S2.SS2.p7.5.m2.1.1.1" xref="S2.SS2.p7.5.m2.1.1.1.cmml">log</mi><mo lspace="0.167em" id="S2.SS2.p7.5.m2.1.1a" xref="S2.SS2.p7.5.m2.1.1.cmml">⁡</mo><msub id="S2.SS2.p7.5.m2.1.1.2" xref="S2.SS2.p7.5.m2.1.1.2.cmml"><mi id="S2.SS2.p7.5.m2.1.1.2.2" xref="S2.SS2.p7.5.m2.1.1.2.2.cmml">q</mi><mi id="S2.SS2.p7.5.m2.1.1.2.3" xref="S2.SS2.p7.5.m2.1.1.2.3.cmml">ϕ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.5.m2.1b"><apply id="S2.SS2.p7.5.m2.1.1.cmml" xref="S2.SS2.p7.5.m2.1.1"><log id="S2.SS2.p7.5.m2.1.1.1.cmml" xref="S2.SS2.p7.5.m2.1.1.1"></log><apply id="S2.SS2.p7.5.m2.1.1.2.cmml" xref="S2.SS2.p7.5.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p7.5.m2.1.1.2.1.cmml" xref="S2.SS2.p7.5.m2.1.1.2">subscript</csymbol><ci id="S2.SS2.p7.5.m2.1.1.2.2.cmml" xref="S2.SS2.p7.5.m2.1.1.2.2">𝑞</ci><ci id="S2.SS2.p7.5.m2.1.1.2.3.cmml" xref="S2.SS2.p7.5.m2.1.1.2.3">italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.5.m2.1c">\log q_{\phi}</annotation></semantics></math>, also used in
 <cite class="ltx_cite ltx_citemacro_citet">Kingma &amp; Welling (<a href="#bib.bib22" title="" class="ltx_ref">2014</a>); Miao &amp; Blunsom (<a href="#bib.bib32" title="" class="ltx_ref">2016</a>)</cite>
<span id="S2.SS2.p7.5.1" class="ltx_text" style="color:#000000;">(see Appendix for more details and a justification).</span></p>
</div>
<div id="S2.SS2.p8" class="ltx_para ltx_noindent">
<p id="S2.SS2.p8.6" class="ltx_p"><span id="S2.SS2.p8.6.1" class="ltx_text ltx_font_bold">Connections to other objectives.</span> To our knowledge, two previous works
 <cite class="ltx_cite ltx_citemacro_citep">(Miao &amp; Blunsom, <a href="#bib.bib32" title="" class="ltx_ref">2016</a>; Yin et al., <a href="#bib.bib53" title="" class="ltx_ref">2018</a>)</cite>
have formulated semi-supervised learning with discrete (sequential) latent variable
models. While <cite class="ltx_cite ltx_citemacro_citet">Miao &amp; Blunsom (<a href="#bib.bib32" title="" class="ltx_ref">2016</a>)</cite> write the supervised term as <math id="S2.SS2.p8.1.m1.1" class="ltx_Math" alttext="\log p_{\phi}(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S2.SS2.p8.1.m1.1a"><mrow id="S2.SS2.p8.1.m1.1.1" xref="S2.SS2.p8.1.m1.1.1.cmml"><mrow id="S2.SS2.p8.1.m1.1.1.3" xref="S2.SS2.p8.1.m1.1.1.3.cmml"><mi id="S2.SS2.p8.1.m1.1.1.3.1" xref="S2.SS2.p8.1.m1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.SS2.p8.1.m1.1.1.3a" xref="S2.SS2.p8.1.m1.1.1.3.cmml">⁡</mo><msub id="S2.SS2.p8.1.m1.1.1.3.2" xref="S2.SS2.p8.1.m1.1.1.3.2.cmml"><mi id="S2.SS2.p8.1.m1.1.1.3.2.2" xref="S2.SS2.p8.1.m1.1.1.3.2.2.cmml">p</mi><mi id="S2.SS2.p8.1.m1.1.1.3.2.3" xref="S2.SS2.p8.1.m1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p8.1.m1.1.1.2" xref="S2.SS2.p8.1.m1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p8.1.m1.1.1.1.1" xref="S2.SS2.p8.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p8.1.m1.1.1.1.1.2" xref="S2.SS2.p8.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p8.1.m1.1.1.1.1.1" xref="S2.SS2.p8.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.p8.1.m1.1.1.1.1.1.2" xref="S2.SS2.p8.1.m1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S2.SS2.p8.1.m1.1.1.1.1.1.1" xref="S2.SS2.p8.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p8.1.m1.1.1.1.1.1.3" xref="S2.SS2.p8.1.m1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S2.SS2.p8.1.m1.1.1.1.1.3" xref="S2.SS2.p8.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.1.m1.1b"><apply id="S2.SS2.p8.1.m1.1.1.cmml" xref="S2.SS2.p8.1.m1.1.1"><times id="S2.SS2.p8.1.m1.1.1.2.cmml" xref="S2.SS2.p8.1.m1.1.1.2"></times><apply id="S2.SS2.p8.1.m1.1.1.3.cmml" xref="S2.SS2.p8.1.m1.1.1.3"><log id="S2.SS2.p8.1.m1.1.1.3.1.cmml" xref="S2.SS2.p8.1.m1.1.1.3.1"></log><apply id="S2.SS2.p8.1.m1.1.1.3.2.cmml" xref="S2.SS2.p8.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p8.1.m1.1.1.3.2.1.cmml" xref="S2.SS2.p8.1.m1.1.1.3.2">subscript</csymbol><ci id="S2.SS2.p8.1.m1.1.1.3.2.2.cmml" xref="S2.SS2.p8.1.m1.1.1.3.2.2">𝑝</ci><ci id="S2.SS2.p8.1.m1.1.1.3.2.3.cmml" xref="S2.SS2.p8.1.m1.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S2.SS2.p8.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p8.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p8.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p8.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p8.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p8.1.m1.1.1.1.1.1.2">𝐳</ci><ci id="S2.SS2.p8.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p8.1.m1.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.1.m1.1c">\log p_{\phi}(\mathbf{z}|\mathbf{x})</annotation></semantics></math>,
 <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a href="#bib.bib53" title="" class="ltx_ref">2018</a>)</cite> write it as <math id="S2.SS2.p8.2.m2.2" class="ltx_Math" alttext="\log q_{\phi}(\mathbf{z}|\mathbf{x})+\log p_{\sigma}(\mathbf{x}|\mathbf{z})" display="inline"><semantics id="S2.SS2.p8.2.m2.2a"><mrow id="S2.SS2.p8.2.m2.2.2" xref="S2.SS2.p8.2.m2.2.2.cmml"><mrow id="S2.SS2.p8.2.m2.1.1.1" xref="S2.SS2.p8.2.m2.1.1.1.cmml"><mrow id="S2.SS2.p8.2.m2.1.1.1.3" xref="S2.SS2.p8.2.m2.1.1.1.3.cmml"><mi id="S2.SS2.p8.2.m2.1.1.1.3.1" xref="S2.SS2.p8.2.m2.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.SS2.p8.2.m2.1.1.1.3a" xref="S2.SS2.p8.2.m2.1.1.1.3.cmml">⁡</mo><msub id="S2.SS2.p8.2.m2.1.1.1.3.2" xref="S2.SS2.p8.2.m2.1.1.1.3.2.cmml"><mi id="S2.SS2.p8.2.m2.1.1.1.3.2.2" xref="S2.SS2.p8.2.m2.1.1.1.3.2.2.cmml">q</mi><mi id="S2.SS2.p8.2.m2.1.1.1.3.2.3" xref="S2.SS2.p8.2.m2.1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p8.2.m2.1.1.1.2" xref="S2.SS2.p8.2.m2.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p8.2.m2.1.1.1.1.1" xref="S2.SS2.p8.2.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p8.2.m2.1.1.1.1.1.2" xref="S2.SS2.p8.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p8.2.m2.1.1.1.1.1.1" xref="S2.SS2.p8.2.m2.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p8.2.m2.1.1.1.1.1.1.2" xref="S2.SS2.p8.2.m2.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S2.SS2.p8.2.m2.1.1.1.1.1.1.1" xref="S2.SS2.p8.2.m2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p8.2.m2.1.1.1.1.1.1.3" xref="S2.SS2.p8.2.m2.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S2.SS2.p8.2.m2.1.1.1.1.1.3" xref="S2.SS2.p8.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p8.2.m2.2.2.3" xref="S2.SS2.p8.2.m2.2.2.3.cmml">+</mo><mrow id="S2.SS2.p8.2.m2.2.2.2" xref="S2.SS2.p8.2.m2.2.2.2.cmml"><mrow id="S2.SS2.p8.2.m2.2.2.2.3" xref="S2.SS2.p8.2.m2.2.2.2.3.cmml"><mi id="S2.SS2.p8.2.m2.2.2.2.3.1" xref="S2.SS2.p8.2.m2.2.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.SS2.p8.2.m2.2.2.2.3a" xref="S2.SS2.p8.2.m2.2.2.2.3.cmml">⁡</mo><msub id="S2.SS2.p8.2.m2.2.2.2.3.2" xref="S2.SS2.p8.2.m2.2.2.2.3.2.cmml"><mi id="S2.SS2.p8.2.m2.2.2.2.3.2.2" xref="S2.SS2.p8.2.m2.2.2.2.3.2.2.cmml">p</mi><mi id="S2.SS2.p8.2.m2.2.2.2.3.2.3" xref="S2.SS2.p8.2.m2.2.2.2.3.2.3.cmml">σ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p8.2.m2.2.2.2.2" xref="S2.SS2.p8.2.m2.2.2.2.2.cmml">​</mo><mrow id="S2.SS2.p8.2.m2.2.2.2.1.1" xref="S2.SS2.p8.2.m2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p8.2.m2.2.2.2.1.1.2" xref="S2.SS2.p8.2.m2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS2.p8.2.m2.2.2.2.1.1.1" xref="S2.SS2.p8.2.m2.2.2.2.1.1.1.cmml"><mi id="S2.SS2.p8.2.m2.2.2.2.1.1.1.2" xref="S2.SS2.p8.2.m2.2.2.2.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S2.SS2.p8.2.m2.2.2.2.1.1.1.1" xref="S2.SS2.p8.2.m2.2.2.2.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p8.2.m2.2.2.2.1.1.1.3" xref="S2.SS2.p8.2.m2.2.2.2.1.1.1.3.cmml">𝐳</mi></mrow><mo stretchy="false" id="S2.SS2.p8.2.m2.2.2.2.1.1.3" xref="S2.SS2.p8.2.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.2.m2.2b"><apply id="S2.SS2.p8.2.m2.2.2.cmml" xref="S2.SS2.p8.2.m2.2.2"><plus id="S2.SS2.p8.2.m2.2.2.3.cmml" xref="S2.SS2.p8.2.m2.2.2.3"></plus><apply id="S2.SS2.p8.2.m2.1.1.1.cmml" xref="S2.SS2.p8.2.m2.1.1.1"><times id="S2.SS2.p8.2.m2.1.1.1.2.cmml" xref="S2.SS2.p8.2.m2.1.1.1.2"></times><apply id="S2.SS2.p8.2.m2.1.1.1.3.cmml" xref="S2.SS2.p8.2.m2.1.1.1.3"><log id="S2.SS2.p8.2.m2.1.1.1.3.1.cmml" xref="S2.SS2.p8.2.m2.1.1.1.3.1"></log><apply id="S2.SS2.p8.2.m2.1.1.1.3.2.cmml" xref="S2.SS2.p8.2.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p8.2.m2.1.1.1.3.2.1.cmml" xref="S2.SS2.p8.2.m2.1.1.1.3.2">subscript</csymbol><ci id="S2.SS2.p8.2.m2.1.1.1.3.2.2.cmml" xref="S2.SS2.p8.2.m2.1.1.1.3.2.2">𝑞</ci><ci id="S2.SS2.p8.2.m2.1.1.1.3.2.3.cmml" xref="S2.SS2.p8.2.m2.1.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S2.SS2.p8.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p8.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p8.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p8.2.m2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p8.2.m2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p8.2.m2.1.1.1.1.1.1.2">𝐳</ci><ci id="S2.SS2.p8.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p8.2.m2.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S2.SS2.p8.2.m2.2.2.2.cmml" xref="S2.SS2.p8.2.m2.2.2.2"><times id="S2.SS2.p8.2.m2.2.2.2.2.cmml" xref="S2.SS2.p8.2.m2.2.2.2.2"></times><apply id="S2.SS2.p8.2.m2.2.2.2.3.cmml" xref="S2.SS2.p8.2.m2.2.2.2.3"><log id="S2.SS2.p8.2.m2.2.2.2.3.1.cmml" xref="S2.SS2.p8.2.m2.2.2.2.3.1"></log><apply id="S2.SS2.p8.2.m2.2.2.2.3.2.cmml" xref="S2.SS2.p8.2.m2.2.2.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p8.2.m2.2.2.2.3.2.1.cmml" xref="S2.SS2.p8.2.m2.2.2.2.3.2">subscript</csymbol><ci id="S2.SS2.p8.2.m2.2.2.2.3.2.2.cmml" xref="S2.SS2.p8.2.m2.2.2.2.3.2.2">𝑝</ci><ci id="S2.SS2.p8.2.m2.2.2.2.3.2.3.cmml" xref="S2.SS2.p8.2.m2.2.2.2.3.2.3">𝜎</ci></apply></apply><apply id="S2.SS2.p8.2.m2.2.2.2.1.1.1.cmml" xref="S2.SS2.p8.2.m2.2.2.2.1.1"><csymbol cd="latexml" id="S2.SS2.p8.2.m2.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p8.2.m2.2.2.2.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p8.2.m2.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p8.2.m2.2.2.2.1.1.1.2">𝐱</ci><ci id="S2.SS2.p8.2.m2.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p8.2.m2.2.2.2.1.1.1.3">𝐳</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.2.m2.2c">\log q_{\phi}(\mathbf{z}|\mathbf{x})+\log p_{\sigma}(\mathbf{x}|\mathbf{z})</annotation></semantics></math>.
The lemma above provides a clarifying perspective on both the objectives, firstly
showing that <math id="S2.SS2.p8.3.m3.1" class="ltx_Math" alttext="p_{\phi}" display="inline"><semantics id="S2.SS2.p8.3.m3.1a"><msub id="S2.SS2.p8.3.m3.1.1" xref="S2.SS2.p8.3.m3.1.1.cmml"><mi id="S2.SS2.p8.3.m3.1.1.2" xref="S2.SS2.p8.3.m3.1.1.2.cmml">p</mi><mi id="S2.SS2.p8.3.m3.1.1.3" xref="S2.SS2.p8.3.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.3.m3.1b"><apply id="S2.SS2.p8.3.m3.1.1.cmml" xref="S2.SS2.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p8.3.m3.1.1.1.cmml" xref="S2.SS2.p8.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p8.3.m3.1.1.2.cmml" xref="S2.SS2.p8.3.m3.1.1.2">𝑝</ci><ci id="S2.SS2.p8.3.m3.1.1.3.cmml" xref="S2.SS2.p8.3.m3.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.3.m3.1c">p_{\phi}</annotation></semantics></math> should actually be written as <math id="S2.SS2.p8.4.m4.1" class="ltx_Math" alttext="q_{\phi}" display="inline"><semantics id="S2.SS2.p8.4.m4.1a"><msub id="S2.SS2.p8.4.m4.1.1" xref="S2.SS2.p8.4.m4.1.1.cmml"><mi id="S2.SS2.p8.4.m4.1.1.2" xref="S2.SS2.p8.4.m4.1.1.2.cmml">q</mi><mi id="S2.SS2.p8.4.m4.1.1.3" xref="S2.SS2.p8.4.m4.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.4.m4.1b"><apply id="S2.SS2.p8.4.m4.1.1.cmml" xref="S2.SS2.p8.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p8.4.m4.1.1.1.cmml" xref="S2.SS2.p8.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p8.4.m4.1.1.2.cmml" xref="S2.SS2.p8.4.m4.1.1.2">𝑞</ci><ci id="S2.SS2.p8.4.m4.1.1.3.cmml" xref="S2.SS2.p8.4.m4.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.4.m4.1c">q_{\phi}</annotation></semantics></math> (and
suggests an additional <math id="S2.SS2.p8.5.m5.1" class="ltx_Math" alttext="p_{\sigma}" display="inline"><semantics id="S2.SS2.p8.5.m5.1a"><msub id="S2.SS2.p8.5.m5.1.1" xref="S2.SS2.p8.5.m5.1.1.cmml"><mi id="S2.SS2.p8.5.m5.1.1.2" xref="S2.SS2.p8.5.m5.1.1.2.cmml">p</mi><mi id="S2.SS2.p8.5.m5.1.1.3" xref="S2.SS2.p8.5.m5.1.1.3.cmml">σ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.5.m5.1b"><apply id="S2.SS2.p8.5.m5.1.1.cmml" xref="S2.SS2.p8.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p8.5.m5.1.1.1.cmml" xref="S2.SS2.p8.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p8.5.m5.1.1.2.cmml" xref="S2.SS2.p8.5.m5.1.1.2">𝑝</ci><ci id="S2.SS2.p8.5.m5.1.1.3.cmml" xref="S2.SS2.p8.5.m5.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.5.m5.1c">p_{\sigma}</annotation></semantics></math> term), and that
the objective from <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a href="#bib.bib53" title="" class="ltx_ref">2018</a>)</cite> is actually a part of a loose lower bound
on the evidence for <math id="S2.SS2.p8.6.m6.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S2.SS2.p8.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p8.6.m6.1.1" xref="S2.SS2.p8.6.m6.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.6.m6.1b"><ci id="S2.SS2.p8.6.m6.1.1.cmml" xref="S2.SS2.p8.6.m6.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.6.m6.1c">\mathcal{L}</annotation></semantics></math> providing some justification for the intuition
presented in <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a href="#bib.bib53" title="" class="ltx_ref">2018</a>)</cite><span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>A promising direction for obtaining tighter bounds could be to change the parameterization
of the variational <math id="footnote2.m1.1" class="ltx_Math" alttext="q(\Pi)" display="inline"><semantics id="footnote2.m1.1b"><mrow id="footnote2.m1.1.2" xref="footnote2.m1.1.2.cmml"><mi id="footnote2.m1.1.2.2" xref="footnote2.m1.1.2.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="footnote2.m1.1.2.1" xref="footnote2.m1.1.2.1.cmml">​</mo><mrow id="footnote2.m1.1.2.3.2" xref="footnote2.m1.1.2.cmml"><mo stretchy="false" id="footnote2.m1.1.2.3.2.1" xref="footnote2.m1.1.2.cmml">(</mo><mi mathvariant="normal" id="footnote2.m1.1.1" xref="footnote2.m1.1.1.cmml">Π</mi><mo stretchy="false" id="footnote2.m1.1.2.3.2.2" xref="footnote2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote2.m1.1c"><apply id="footnote2.m1.1.2.cmml" xref="footnote2.m1.1.2"><times id="footnote2.m1.1.2.1.cmml" xref="footnote2.m1.1.2.1"></times><ci id="footnote2.m1.1.2.2.cmml" xref="footnote2.m1.1.2.2">𝑞</ci><ci id="footnote2.m1.1.1.cmml" xref="footnote2.m1.1.1">Π</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.1d">q(\Pi)</annotation></semantics></math> distribution. <span id="footnote2.1" class="ltx_text" style="color:#000000;">Overall, learning of
<math id="footnote2.1.m1.1" class="ltx_Math" alttext="q_{\phi}" display="inline"><semantics id="footnote2.1.m1.1b"><msub id="footnote2.1.m1.1.1" xref="footnote2.1.m1.1.1.cmml"><mi mathcolor="#000000" id="footnote2.1.m1.1.1.2" xref="footnote2.1.m1.1.1.2.cmml">q</mi><mi mathcolor="#000000" id="footnote2.1.m1.1.1.3" xref="footnote2.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="footnote2.1.m1.1c"><apply id="footnote2.1.m1.1.1.cmml" xref="footnote2.1.m1.1.1"><csymbol cd="ambiguous" id="footnote2.1.m1.1.1.1.cmml" xref="footnote2.1.m1.1.1">subscript</csymbol><ci id="footnote2.1.m1.1.1.2.cmml" xref="footnote2.1.m1.1.1.2">𝑞</ci><ci id="footnote2.1.m1.1.1.3.cmml" xref="footnote2.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.1.m1.1d">q_{\phi}</annotation></semantics></math> is challenging in the structured, discrete space of sequences and a proper treatment
of how to train this term in a semi-supervised setting is important for this class of models.</span></span></span></span>.</p>
</div>
<div id="S2.SS2.p9" class="ltx_para">
<p id="S2.SS2.p9.1" class="ltx_p">We next explain the evidence formulation for the full graphical model; and then introduce the module training
and joint training steps.</p>
</div>
<div id="S2.SS2.p10" class="ltx_para ltx_noindent">
<p id="S2.SS2.p10.5" class="ltx_p"><span id="S2.SS2.p10.5.1" class="ltx_text ltx_font_bold">Module and Joint Training.</span>
For the full model (including the answers <math id="S2.SS2.p10.1.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S2.SS2.p10.1.m1.1a"><mi id="S2.SS2.p10.1.m1.1.1" xref="S2.SS2.p10.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p10.1.m1.1b"><ci id="S2.SS2.p10.1.m1.1.1.cmml" xref="S2.SS2.p10.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p10.1.m1.1c">a</annotation></semantics></math>), the evidence is
<math id="S2.SS2.p10.2.m2.1" class="ltx_Math" alttext="\mathcal{L}+\mathcal{U}_{f}" display="inline"><semantics id="S2.SS2.p10.2.m2.1a"><mrow id="S2.SS2.p10.2.m2.1.1" xref="S2.SS2.p10.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p10.2.m2.1.1.2" xref="S2.SS2.p10.2.m2.1.1.2.cmml">ℒ</mi><mo id="S2.SS2.p10.2.m2.1.1.1" xref="S2.SS2.p10.2.m2.1.1.1.cmml">+</mo><msub id="S2.SS2.p10.2.m2.1.1.3" xref="S2.SS2.p10.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p10.2.m2.1.1.3.2" xref="S2.SS2.p10.2.m2.1.1.3.2.cmml">𝒰</mi><mi id="S2.SS2.p10.2.m2.1.1.3.3" xref="S2.SS2.p10.2.m2.1.1.3.3.cmml">f</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p10.2.m2.1b"><apply id="S2.SS2.p10.2.m2.1.1.cmml" xref="S2.SS2.p10.2.m2.1.1"><plus id="S2.SS2.p10.2.m2.1.1.1.cmml" xref="S2.SS2.p10.2.m2.1.1.1"></plus><ci id="S2.SS2.p10.2.m2.1.1.2.cmml" xref="S2.SS2.p10.2.m2.1.1.2">ℒ</ci><apply id="S2.SS2.p10.2.m2.1.1.3.cmml" xref="S2.SS2.p10.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p10.2.m2.1.1.3.1.cmml" xref="S2.SS2.p10.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS2.p10.2.m2.1.1.3.2.cmml" xref="S2.SS2.p10.2.m2.1.1.3.2">𝒰</ci><ci id="S2.SS2.p10.2.m2.1.1.3.3.cmml" xref="S2.SS2.p10.2.m2.1.1.3.3">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p10.2.m2.1c">\mathcal{L}+\mathcal{U}_{f}</annotation></semantics></math>, where <math id="S2.SS2.p10.3.m3.2" class="ltx_Math" alttext="\mathcal{U}_{f}=\sum_{m=1}^{M}\log p(\mathbf{x}^{m},a^{m}|\mathbf{i}^{m})" display="inline"><semantics id="S2.SS2.p10.3.m3.2a"><mrow id="S2.SS2.p10.3.m3.2.2" xref="S2.SS2.p10.3.m3.2.2.cmml"><msub id="S2.SS2.p10.3.m3.2.2.4" xref="S2.SS2.p10.3.m3.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p10.3.m3.2.2.4.2" xref="S2.SS2.p10.3.m3.2.2.4.2.cmml">𝒰</mi><mi id="S2.SS2.p10.3.m3.2.2.4.3" xref="S2.SS2.p10.3.m3.2.2.4.3.cmml">f</mi></msub><mo rspace="0.111em" id="S2.SS2.p10.3.m3.2.2.3" xref="S2.SS2.p10.3.m3.2.2.3.cmml">=</mo><mrow id="S2.SS2.p10.3.m3.2.2.2" xref="S2.SS2.p10.3.m3.2.2.2.cmml"><msubsup id="S2.SS2.p10.3.m3.2.2.2.3" xref="S2.SS2.p10.3.m3.2.2.2.3.cmml"><mo id="S2.SS2.p10.3.m3.2.2.2.3.2.2" xref="S2.SS2.p10.3.m3.2.2.2.3.2.2.cmml">∑</mo><mrow id="S2.SS2.p10.3.m3.2.2.2.3.2.3" xref="S2.SS2.p10.3.m3.2.2.2.3.2.3.cmml"><mi id="S2.SS2.p10.3.m3.2.2.2.3.2.3.2" xref="S2.SS2.p10.3.m3.2.2.2.3.2.3.2.cmml">m</mi><mo id="S2.SS2.p10.3.m3.2.2.2.3.2.3.1" xref="S2.SS2.p10.3.m3.2.2.2.3.2.3.1.cmml">=</mo><mn id="S2.SS2.p10.3.m3.2.2.2.3.2.3.3" xref="S2.SS2.p10.3.m3.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.SS2.p10.3.m3.2.2.2.3.3" xref="S2.SS2.p10.3.m3.2.2.2.3.3.cmml">M</mi></msubsup><mrow id="S2.SS2.p10.3.m3.2.2.2.2" xref="S2.SS2.p10.3.m3.2.2.2.2.cmml"><mrow id="S2.SS2.p10.3.m3.2.2.2.2.4" xref="S2.SS2.p10.3.m3.2.2.2.2.4.cmml"><mi id="S2.SS2.p10.3.m3.2.2.2.2.4.1" xref="S2.SS2.p10.3.m3.2.2.2.2.4.1.cmml">log</mi><mo lspace="0.167em" id="S2.SS2.p10.3.m3.2.2.2.2.4a" xref="S2.SS2.p10.3.m3.2.2.2.2.4.cmml">⁡</mo><mi id="S2.SS2.p10.3.m3.2.2.2.2.4.2" xref="S2.SS2.p10.3.m3.2.2.2.2.4.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p10.3.m3.2.2.2.2.3" xref="S2.SS2.p10.3.m3.2.2.2.2.3.cmml">​</mo><mrow id="S2.SS2.p10.3.m3.2.2.2.2.2.2" xref="S2.SS2.p10.3.m3.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.p10.3.m3.2.2.2.2.2.2.3" xref="S2.SS2.p10.3.m3.2.2.2.2.2.3.cmml">(</mo><msup id="S2.SS2.p10.3.m3.1.1.1.1.1.1.1" xref="S2.SS2.p10.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p10.3.m3.1.1.1.1.1.1.1.2" xref="S2.SS2.p10.3.m3.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS2.p10.3.m3.1.1.1.1.1.1.1.3" xref="S2.SS2.p10.3.m3.1.1.1.1.1.1.1.3.cmml">m</mi></msup><mo id="S2.SS2.p10.3.m3.2.2.2.2.2.2.4" xref="S2.SS2.p10.3.m3.2.2.2.2.2.3.cmml">,</mo><mrow id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.cmml"><msup id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2.cmml"><mi id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2.2" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2.3" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2.3.cmml">m</mi></msup><mo fence="false" id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.1" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.1.cmml">|</mo><msup id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3.cmml"><mi id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3.2" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3.2.cmml">𝐢</mi><mi id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3.3" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3.3.cmml">m</mi></msup></mrow><mo stretchy="false" id="S2.SS2.p10.3.m3.2.2.2.2.2.2.5" xref="S2.SS2.p10.3.m3.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p10.3.m3.2b"><apply id="S2.SS2.p10.3.m3.2.2.cmml" xref="S2.SS2.p10.3.m3.2.2"><eq id="S2.SS2.p10.3.m3.2.2.3.cmml" xref="S2.SS2.p10.3.m3.2.2.3"></eq><apply id="S2.SS2.p10.3.m3.2.2.4.cmml" xref="S2.SS2.p10.3.m3.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.p10.3.m3.2.2.4.1.cmml" xref="S2.SS2.p10.3.m3.2.2.4">subscript</csymbol><ci id="S2.SS2.p10.3.m3.2.2.4.2.cmml" xref="S2.SS2.p10.3.m3.2.2.4.2">𝒰</ci><ci id="S2.SS2.p10.3.m3.2.2.4.3.cmml" xref="S2.SS2.p10.3.m3.2.2.4.3">𝑓</ci></apply><apply id="S2.SS2.p10.3.m3.2.2.2.cmml" xref="S2.SS2.p10.3.m3.2.2.2"><apply id="S2.SS2.p10.3.m3.2.2.2.3.cmml" xref="S2.SS2.p10.3.m3.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p10.3.m3.2.2.2.3.1.cmml" xref="S2.SS2.p10.3.m3.2.2.2.3">superscript</csymbol><apply id="S2.SS2.p10.3.m3.2.2.2.3.2.cmml" xref="S2.SS2.p10.3.m3.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p10.3.m3.2.2.2.3.2.1.cmml" xref="S2.SS2.p10.3.m3.2.2.2.3">subscript</csymbol><sum id="S2.SS2.p10.3.m3.2.2.2.3.2.2.cmml" xref="S2.SS2.p10.3.m3.2.2.2.3.2.2"></sum><apply id="S2.SS2.p10.3.m3.2.2.2.3.2.3.cmml" xref="S2.SS2.p10.3.m3.2.2.2.3.2.3"><eq id="S2.SS2.p10.3.m3.2.2.2.3.2.3.1.cmml" xref="S2.SS2.p10.3.m3.2.2.2.3.2.3.1"></eq><ci id="S2.SS2.p10.3.m3.2.2.2.3.2.3.2.cmml" xref="S2.SS2.p10.3.m3.2.2.2.3.2.3.2">𝑚</ci><cn type="integer" id="S2.SS2.p10.3.m3.2.2.2.3.2.3.3.cmml" xref="S2.SS2.p10.3.m3.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.SS2.p10.3.m3.2.2.2.3.3.cmml" xref="S2.SS2.p10.3.m3.2.2.2.3.3">𝑀</ci></apply><apply id="S2.SS2.p10.3.m3.2.2.2.2.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2"><times id="S2.SS2.p10.3.m3.2.2.2.2.3.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.3"></times><apply id="S2.SS2.p10.3.m3.2.2.2.2.4.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.4"><log id="S2.SS2.p10.3.m3.2.2.2.2.4.1.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.4.1"></log><ci id="S2.SS2.p10.3.m3.2.2.2.2.4.2.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.4.2">𝑝</ci></apply><interval closure="open" id="S2.SS2.p10.3.m3.2.2.2.2.2.3.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2"><apply id="S2.SS2.p10.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p10.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p10.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p10.3.m3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p10.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p10.3.m3.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS2.p10.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p10.3.m3.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2"><csymbol cd="latexml" id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.1.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.1">conditional</csymbol><apply id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2.1.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2">superscript</csymbol><ci id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2.2">𝑎</ci><ci id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.2.3">𝑚</ci></apply><apply id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3.1.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3">superscript</csymbol><ci id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3.2.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3.2">𝐢</ci><ci id="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3.3.cmml" xref="S2.SS2.p10.3.m3.2.2.2.2.2.2.2.3.3">𝑚</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p10.3.m3.2c">\mathcal{U}_{f}=\sum_{m=1}^{M}\log p(\mathbf{x}^{m},a^{m}|\mathbf{i}^{m})</annotation></semantics></math>
and <math id="S2.SS2.p10.4.m4.2" class="ltx_Math" alttext="\mathcal{L}=\sum_{n=1}^{N}\log p(\mathbf{x}^{n},\mathbf{z}^{n})" display="inline"><semantics id="S2.SS2.p10.4.m4.2a"><mrow id="S2.SS2.p10.4.m4.2.2" xref="S2.SS2.p10.4.m4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p10.4.m4.2.2.4" xref="S2.SS2.p10.4.m4.2.2.4.cmml">ℒ</mi><mo rspace="0.111em" id="S2.SS2.p10.4.m4.2.2.3" xref="S2.SS2.p10.4.m4.2.2.3.cmml">=</mo><mrow id="S2.SS2.p10.4.m4.2.2.2" xref="S2.SS2.p10.4.m4.2.2.2.cmml"><msubsup id="S2.SS2.p10.4.m4.2.2.2.3" xref="S2.SS2.p10.4.m4.2.2.2.3.cmml"><mo id="S2.SS2.p10.4.m4.2.2.2.3.2.2" xref="S2.SS2.p10.4.m4.2.2.2.3.2.2.cmml">∑</mo><mrow id="S2.SS2.p10.4.m4.2.2.2.3.2.3" xref="S2.SS2.p10.4.m4.2.2.2.3.2.3.cmml"><mi id="S2.SS2.p10.4.m4.2.2.2.3.2.3.2" xref="S2.SS2.p10.4.m4.2.2.2.3.2.3.2.cmml">n</mi><mo id="S2.SS2.p10.4.m4.2.2.2.3.2.3.1" xref="S2.SS2.p10.4.m4.2.2.2.3.2.3.1.cmml">=</mo><mn id="S2.SS2.p10.4.m4.2.2.2.3.2.3.3" xref="S2.SS2.p10.4.m4.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.SS2.p10.4.m4.2.2.2.3.3" xref="S2.SS2.p10.4.m4.2.2.2.3.3.cmml">N</mi></msubsup><mrow id="S2.SS2.p10.4.m4.2.2.2.2" xref="S2.SS2.p10.4.m4.2.2.2.2.cmml"><mrow id="S2.SS2.p10.4.m4.2.2.2.2.4" xref="S2.SS2.p10.4.m4.2.2.2.2.4.cmml"><mi id="S2.SS2.p10.4.m4.2.2.2.2.4.1" xref="S2.SS2.p10.4.m4.2.2.2.2.4.1.cmml">log</mi><mo lspace="0.167em" id="S2.SS2.p10.4.m4.2.2.2.2.4a" xref="S2.SS2.p10.4.m4.2.2.2.2.4.cmml">⁡</mo><mi id="S2.SS2.p10.4.m4.2.2.2.2.4.2" xref="S2.SS2.p10.4.m4.2.2.2.2.4.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.p10.4.m4.2.2.2.2.3" xref="S2.SS2.p10.4.m4.2.2.2.2.3.cmml">​</mo><mrow id="S2.SS2.p10.4.m4.2.2.2.2.2.2" xref="S2.SS2.p10.4.m4.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.p10.4.m4.2.2.2.2.2.2.3" xref="S2.SS2.p10.4.m4.2.2.2.2.2.3.cmml">(</mo><msup id="S2.SS2.p10.4.m4.1.1.1.1.1.1.1" xref="S2.SS2.p10.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p10.4.m4.1.1.1.1.1.1.1.2" xref="S2.SS2.p10.4.m4.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S2.SS2.p10.4.m4.1.1.1.1.1.1.1.3" xref="S2.SS2.p10.4.m4.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo id="S2.SS2.p10.4.m4.2.2.2.2.2.2.4" xref="S2.SS2.p10.4.m4.2.2.2.2.2.3.cmml">,</mo><msup id="S2.SS2.p10.4.m4.2.2.2.2.2.2.2" xref="S2.SS2.p10.4.m4.2.2.2.2.2.2.2.cmml"><mi id="S2.SS2.p10.4.m4.2.2.2.2.2.2.2.2" xref="S2.SS2.p10.4.m4.2.2.2.2.2.2.2.2.cmml">𝐳</mi><mi id="S2.SS2.p10.4.m4.2.2.2.2.2.2.2.3" xref="S2.SS2.p10.4.m4.2.2.2.2.2.2.2.3.cmml">n</mi></msup><mo stretchy="false" id="S2.SS2.p10.4.m4.2.2.2.2.2.2.5" xref="S2.SS2.p10.4.m4.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p10.4.m4.2b"><apply id="S2.SS2.p10.4.m4.2.2.cmml" xref="S2.SS2.p10.4.m4.2.2"><eq id="S2.SS2.p10.4.m4.2.2.3.cmml" xref="S2.SS2.p10.4.m4.2.2.3"></eq><ci id="S2.SS2.p10.4.m4.2.2.4.cmml" xref="S2.SS2.p10.4.m4.2.2.4">ℒ</ci><apply id="S2.SS2.p10.4.m4.2.2.2.cmml" xref="S2.SS2.p10.4.m4.2.2.2"><apply id="S2.SS2.p10.4.m4.2.2.2.3.cmml" xref="S2.SS2.p10.4.m4.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p10.4.m4.2.2.2.3.1.cmml" xref="S2.SS2.p10.4.m4.2.2.2.3">superscript</csymbol><apply id="S2.SS2.p10.4.m4.2.2.2.3.2.cmml" xref="S2.SS2.p10.4.m4.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p10.4.m4.2.2.2.3.2.1.cmml" xref="S2.SS2.p10.4.m4.2.2.2.3">subscript</csymbol><sum id="S2.SS2.p10.4.m4.2.2.2.3.2.2.cmml" xref="S2.SS2.p10.4.m4.2.2.2.3.2.2"></sum><apply id="S2.SS2.p10.4.m4.2.2.2.3.2.3.cmml" xref="S2.SS2.p10.4.m4.2.2.2.3.2.3"><eq id="S2.SS2.p10.4.m4.2.2.2.3.2.3.1.cmml" xref="S2.SS2.p10.4.m4.2.2.2.3.2.3.1"></eq><ci id="S2.SS2.p10.4.m4.2.2.2.3.2.3.2.cmml" xref="S2.SS2.p10.4.m4.2.2.2.3.2.3.2">𝑛</ci><cn type="integer" id="S2.SS2.p10.4.m4.2.2.2.3.2.3.3.cmml" xref="S2.SS2.p10.4.m4.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.SS2.p10.4.m4.2.2.2.3.3.cmml" xref="S2.SS2.p10.4.m4.2.2.2.3.3">𝑁</ci></apply><apply id="S2.SS2.p10.4.m4.2.2.2.2.cmml" xref="S2.SS2.p10.4.m4.2.2.2.2"><times id="S2.SS2.p10.4.m4.2.2.2.2.3.cmml" xref="S2.SS2.p10.4.m4.2.2.2.2.3"></times><apply id="S2.SS2.p10.4.m4.2.2.2.2.4.cmml" xref="S2.SS2.p10.4.m4.2.2.2.2.4"><log id="S2.SS2.p10.4.m4.2.2.2.2.4.1.cmml" xref="S2.SS2.p10.4.m4.2.2.2.2.4.1"></log><ci id="S2.SS2.p10.4.m4.2.2.2.2.4.2.cmml" xref="S2.SS2.p10.4.m4.2.2.2.2.4.2">𝑝</ci></apply><interval closure="open" id="S2.SS2.p10.4.m4.2.2.2.2.2.3.cmml" xref="S2.SS2.p10.4.m4.2.2.2.2.2.2"><apply id="S2.SS2.p10.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p10.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p10.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p10.4.m4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.p10.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p10.4.m4.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S2.SS2.p10.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p10.4.m4.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S2.SS2.p10.4.m4.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p10.4.m4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p10.4.m4.2.2.2.2.2.2.2.1.cmml" xref="S2.SS2.p10.4.m4.2.2.2.2.2.2.2">superscript</csymbol><ci id="S2.SS2.p10.4.m4.2.2.2.2.2.2.2.2.cmml" xref="S2.SS2.p10.4.m4.2.2.2.2.2.2.2.2">𝐳</ci><ci id="S2.SS2.p10.4.m4.2.2.2.2.2.2.2.3.cmml" xref="S2.SS2.p10.4.m4.2.2.2.2.2.2.2.3">𝑛</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p10.4.m4.2c">\mathcal{L}=\sum_{n=1}^{N}\log p(\mathbf{x}^{n},\mathbf{z}^{n})</annotation></semantics></math>. Similar to the previous
section, one can derive a variational lower bound <cite class="ltx_cite ltx_citemacro_citep">(Jordan et al., <a href="#bib.bib20" title="" class="ltx_ref">1999</a>)</cite>
on <math id="S2.SS2.p10.5.m5.1" class="ltx_Math" alttext="\mathcal{U}_{f}" display="inline"><semantics id="S2.SS2.p10.5.m5.1a"><msub id="S2.SS2.p10.5.m5.1.1" xref="S2.SS2.p10.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p10.5.m5.1.1.2" xref="S2.SS2.p10.5.m5.1.1.2.cmml">𝒰</mi><mi id="S2.SS2.p10.5.m5.1.1.3" xref="S2.SS2.p10.5.m5.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p10.5.m5.1b"><apply id="S2.SS2.p10.5.m5.1.1.cmml" xref="S2.SS2.p10.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p10.5.m5.1.1.1.cmml" xref="S2.SS2.p10.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p10.5.m5.1.1.2.cmml" xref="S2.SS2.p10.5.m5.1.1.2">𝒰</ci><ci id="S2.SS2.p10.5.m5.1.1.3.cmml" xref="S2.SS2.p10.5.m5.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p10.5.m5.1c">\mathcal{U}_{f}</annotation></semantics></math> (c.f. <cite class="ltx_cite ltx_citemacro_citep">(Vedantam et al., <a href="#bib.bib47" title="" class="ltx_ref">2018</a>; Suzuki et al., <a href="#bib.bib42" title="" class="ltx_ref">2017</a>)</cite>):</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.52" class="ltx_math_unparsed" alttext="\mathcal{U}_{f}\geq\sum_{m=1}^{M}E_{\mathbf{z}\sim q_{\phi}(\mathbf{z}|\mathbf{x}^{m})}[\log p(a^{m}|\mathbf{i}^{m};\theta_{\mathbf{z}})+\\
\log p_{\sigma}(\mathbf{x}^{m}|\mathbf{z})]-\mathbb{KL}\left({q_{\phi}(\mathbf{z}|\mathbf{x}^{m})}||{\log p(\mathbf{z})}\right)" display="block"><semantics id="S2.E4.m1.52a"><mtable displaystyle="true" rowspacing="0pt" id="S2.E4.m1.52.52"><mtr id="S2.E4.m1.52.52a"><mtd class="ltx_align_left" columnalign="left" id="S2.E4.m1.52.52b"><mrow id="S2.E4.m1.22.22.22.22.22"><msub id="S2.E4.m1.22.22.22.22.22.23"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.1.1.1.1.1.1">𝒰</mi><mi id="S2.E4.m1.2.2.2.2.2.2.1">f</mi></msub><mo rspace="0.111em" id="S2.E4.m1.3.3.3.3.3.3">≥</mo><munderover id="S2.E4.m1.22.22.22.22.22.24"><mo movablelimits="false" id="S2.E4.m1.4.4.4.4.4.4">∑</mo><mrow id="S2.E4.m1.5.5.5.5.5.5.1"><mi id="S2.E4.m1.5.5.5.5.5.5.1.2">m</mi><mo id="S2.E4.m1.5.5.5.5.5.5.1.1">=</mo><mn id="S2.E4.m1.5.5.5.5.5.5.1.3">1</mn></mrow><mi id="S2.E4.m1.6.6.6.6.6.6.1">M</mi></munderover><msub id="S2.E4.m1.22.22.22.22.22.25"><mi id="S2.E4.m1.7.7.7.7.7.7">E</mi><mrow id="S2.E4.m1.8.8.8.8.8.8.1"><mi id="S2.E4.m1.8.8.8.8.8.8.1.3">𝐳</mi><mo id="S2.E4.m1.8.8.8.8.8.8.1.2">∼</mo><mrow id="S2.E4.m1.8.8.8.8.8.8.1.1"><msub id="S2.E4.m1.8.8.8.8.8.8.1.1.3"><mi id="S2.E4.m1.8.8.8.8.8.8.1.1.3.2">q</mi><mi id="S2.E4.m1.8.8.8.8.8.8.1.1.3.3">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.8.8.8.8.8.8.1.1.2">​</mo><mrow id="S2.E4.m1.8.8.8.8.8.8.1.1.1.1"><mo stretchy="false" id="S2.E4.m1.8.8.8.8.8.8.1.1.1.1.2">(</mo><mrow id="S2.E4.m1.8.8.8.8.8.8.1.1.1.1.1"><mi id="S2.E4.m1.8.8.8.8.8.8.1.1.1.1.1.2">𝐳</mi><mo fence="false" id="S2.E4.m1.8.8.8.8.8.8.1.1.1.1.1.1">|</mo><msup id="S2.E4.m1.8.8.8.8.8.8.1.1.1.1.1.3"><mi id="S2.E4.m1.8.8.8.8.8.8.1.1.1.1.1.3.2">𝐱</mi><mi id="S2.E4.m1.8.8.8.8.8.8.1.1.1.1.1.3.3">m</mi></msup></mrow><mo stretchy="false" id="S2.E4.m1.8.8.8.8.8.8.1.1.1.1.3">)</mo></mrow></mrow></mrow></msub><mrow id="S2.E4.m1.22.22.22.22.22.26"><mo stretchy="false" id="S2.E4.m1.9.9.9.9.9.9">[</mo><mi id="S2.E4.m1.10.10.10.10.10.10">log</mi><mi id="S2.E4.m1.11.11.11.11.11.11">p</mi><mrow id="S2.E4.m1.22.22.22.22.22.26.1"><mo stretchy="false" id="S2.E4.m1.12.12.12.12.12.12">(</mo><msup id="S2.E4.m1.22.22.22.22.22.26.1.1"><mi id="S2.E4.m1.13.13.13.13.13.13">a</mi><mi id="S2.E4.m1.14.14.14.14.14.14.1">m</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E4.m1.15.15.15.15.15.15">|</mo><msup id="S2.E4.m1.22.22.22.22.22.26.1.2"><mi id="S2.E4.m1.16.16.16.16.16.16">𝐢</mi><mi id="S2.E4.m1.17.17.17.17.17.17.1">m</mi></msup><mo id="S2.E4.m1.18.18.18.18.18.18">;</mo><msub id="S2.E4.m1.22.22.22.22.22.26.1.3"><mi id="S2.E4.m1.19.19.19.19.19.19">θ</mi><mi id="S2.E4.m1.20.20.20.20.20.20.1">𝐳</mi></msub><mo stretchy="false" id="S2.E4.m1.21.21.21.21.21.21">)</mo></mrow><mo id="S2.E4.m1.22.22.22.22.22.22">+</mo></mrow></mrow></mtd></mtr><mtr id="S2.E4.m1.52.52c"><mtd class="ltx_align_right" columnalign="right" id="S2.E4.m1.52.52d"><mrow id="S2.E4.m1.52.52.52.30.30"><mi id="S2.E4.m1.23.23.23.1.1.1">log</mi><msub id="S2.E4.m1.52.52.52.30.30.31"><mi id="S2.E4.m1.24.24.24.2.2.2">p</mi><mi id="S2.E4.m1.25.25.25.3.3.3.1">σ</mi></msub><mrow id="S2.E4.m1.52.52.52.30.30.32"><mo stretchy="false" id="S2.E4.m1.26.26.26.4.4.4">(</mo><msup id="S2.E4.m1.52.52.52.30.30.32.1"><mi id="S2.E4.m1.27.27.27.5.5.5">𝐱</mi><mi id="S2.E4.m1.28.28.28.6.6.6.1">m</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E4.m1.29.29.29.7.7.7">|</mo><mi id="S2.E4.m1.30.30.30.8.8.8">𝐳</mi><mo stretchy="false" id="S2.E4.m1.31.31.31.9.9.9">)</mo></mrow><mo stretchy="false" id="S2.E4.m1.32.32.32.10.10.10">]</mo><mo id="S2.E4.m1.33.33.33.11.11.11">−</mo><mi id="S2.E4.m1.34.34.34.12.12.12">𝕂</mi><mi id="S2.E4.m1.35.35.35.13.13.13">𝕃</mi><mo id="S2.E4.m1.36.36.36.14.14.14">(</mo><msub id="S2.E4.m1.52.52.52.30.30.33"><mi id="S2.E4.m1.37.37.37.15.15.15">q</mi><mi id="S2.E4.m1.38.38.38.16.16.16.1">ϕ</mi></msub><mrow id="S2.E4.m1.52.52.52.30.30.34"><mo stretchy="false" id="S2.E4.m1.39.39.39.17.17.17">(</mo><mi id="S2.E4.m1.40.40.40.18.18.18">𝐳</mi><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E4.m1.41.41.41.19.19.19">|</mo><msup id="S2.E4.m1.52.52.52.30.30.34.1"><mi id="S2.E4.m1.42.42.42.20.20.20">𝐱</mi><mi id="S2.E4.m1.43.43.43.21.21.21.1">m</mi></msup><mo stretchy="false" id="S2.E4.m1.44.44.44.22.22.22">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E4.m1.45.45.45.23.23.23">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E4.m1.46.46.46.24.24.24">|</mo><mi id="S2.E4.m1.47.47.47.25.25.25">log</mi><mi id="S2.E4.m1.48.48.48.26.26.26">p</mi><mrow id="S2.E4.m1.52.52.52.30.30.35"><mo stretchy="false" id="S2.E4.m1.49.49.49.27.27.27">(</mo><mi id="S2.E4.m1.50.50.50.28.28.28">𝐳</mi><mo stretchy="false" id="S2.E4.m1.51.51.51.29.29.29">)</mo></mrow><mo id="S2.E4.m1.52.52.52.30.30.30">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S2.E4.m1.52b">\mathcal{U}_{f}\geq\sum_{m=1}^{M}E_{\mathbf{z}\sim q_{\phi}(\mathbf{z}|\mathbf{x}^{m})}[\log p(a^{m}|\mathbf{i}^{m};\theta_{\mathbf{z}})+\\
\log p_{\sigma}(\mathbf{x}^{m}|\mathbf{z})]-\mathbb{KL}\left({q_{\phi}(\mathbf{z}|\mathbf{x}^{m})}||{\log p(\mathbf{z})}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS2.p11" class="ltx_para">
<p id="S2.SS2.p11.1" class="ltx_p"><span id="S2.SS2.p11.1.1" class="ltx_text ltx_font_bold">Module Training.</span>
During module training, first we optimize the model only w.r.t the parameters responsible for
neural execution of the symbolic programs, namely <math id="S2.SS2.p11.1.m1.1" class="ltx_Math" alttext="\theta_{\mathcal{Z}}" display="inline"><semantics id="S2.SS2.p11.1.m1.1a"><msub id="S2.SS2.p11.1.m1.1.1" xref="S2.SS2.p11.1.m1.1.1.cmml"><mi id="S2.SS2.p11.1.m1.1.1.2" xref="S2.SS2.p11.1.m1.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p11.1.m1.1.1.3" xref="S2.SS2.p11.1.m1.1.1.3.cmml">𝒵</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p11.1.m1.1b"><apply id="S2.SS2.p11.1.m1.1.1.cmml" xref="S2.SS2.p11.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p11.1.m1.1.1.1.cmml" xref="S2.SS2.p11.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p11.1.m1.1.1.2.cmml" xref="S2.SS2.p11.1.m1.1.1.2">𝜃</ci><ci id="S2.SS2.p11.1.m1.1.1.3.cmml" xref="S2.SS2.p11.1.m1.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p11.1.m1.1c">\theta_{\mathcal{Z}}</annotation></semantics></math>.
Concretely, we maximize:</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.3" class="ltx_Math" alttext="\max_{\theta_{\mathcal{Z}}}\sum_{m=1}^{M}E_{z\sim q(\mathbf{z}|\mathbf{x}^{m})}[\log p_{\theta_{z}}(a^{m}|\mathbf{z},\mathbf{i}^{m})]" display="block"><semantics id="S2.E5.m1.3a"><mrow id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml"><munder id="S2.E5.m1.3.3.3" xref="S2.E5.m1.3.3.3.cmml"><mi id="S2.E5.m1.3.3.3.2" xref="S2.E5.m1.3.3.3.2.cmml">max</mi><msub id="S2.E5.m1.3.3.3.3" xref="S2.E5.m1.3.3.3.3.cmml"><mi id="S2.E5.m1.3.3.3.3.2" xref="S2.E5.m1.3.3.3.3.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.3.3.3.3.3" xref="S2.E5.m1.3.3.3.3.3.cmml">𝒵</mi></msub></munder><mo lspace="0em" rspace="0em" id="S2.E5.m1.3.3.2" xref="S2.E5.m1.3.3.2.cmml">​</mo><mrow id="S2.E5.m1.3.3.1" xref="S2.E5.m1.3.3.1.cmml"><munderover id="S2.E5.m1.3.3.1.2" xref="S2.E5.m1.3.3.1.2.cmml"><mo movablelimits="false" id="S2.E5.m1.3.3.1.2.2.2" xref="S2.E5.m1.3.3.1.2.2.2.cmml">∑</mo><mrow id="S2.E5.m1.3.3.1.2.2.3" xref="S2.E5.m1.3.3.1.2.2.3.cmml"><mi id="S2.E5.m1.3.3.1.2.2.3.2" xref="S2.E5.m1.3.3.1.2.2.3.2.cmml">m</mi><mo id="S2.E5.m1.3.3.1.2.2.3.1" xref="S2.E5.m1.3.3.1.2.2.3.1.cmml">=</mo><mn id="S2.E5.m1.3.3.1.2.2.3.3" xref="S2.E5.m1.3.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E5.m1.3.3.1.2.3" xref="S2.E5.m1.3.3.1.2.3.cmml">M</mi></munderover><mrow id="S2.E5.m1.3.3.1.1" xref="S2.E5.m1.3.3.1.1.cmml"><msub id="S2.E5.m1.3.3.1.1.3" xref="S2.E5.m1.3.3.1.1.3.cmml"><mi id="S2.E5.m1.3.3.1.1.3.2" xref="S2.E5.m1.3.3.1.1.3.2.cmml">E</mi><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.3" xref="S2.E5.m1.1.1.1.3.cmml">z</mi><mo id="S2.E5.m1.1.1.1.2" xref="S2.E5.m1.1.1.1.2.cmml">∼</mo><mrow id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S2.E5.m1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml">|</mo><msup id="S2.E5.m1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S2.E5.m1.1.1.1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.1.1.1.3.3.cmml">m</mi></msup></mrow><mo stretchy="false" id="S2.E5.m1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E5.m1.3.3.1.1.2" xref="S2.E5.m1.3.3.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.3.3.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S2.E5.m1.3.3.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.2.1.cmml">[</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.cmml"><mrow id="S2.E5.m1.3.3.1.1.1.1.1.3" xref="S2.E5.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.3.3.1.1.1.1.1.3.1" xref="S2.E5.m1.3.3.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E5.m1.3.3.1.1.1.1.1.3a" xref="S2.E5.m1.3.3.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E5.m1.3.3.1.1.1.1.1.3.2" xref="S2.E5.m1.3.3.1.1.1.1.1.3.2.cmml"><mi id="S2.E5.m1.3.3.1.1.1.1.1.3.2.2" xref="S2.E5.m1.3.3.1.1.1.1.1.3.2.2.cmml">p</mi><msub id="S2.E5.m1.3.3.1.1.1.1.1.3.2.3" xref="S2.E5.m1.3.3.1.1.1.1.1.3.2.3.cmml"><mi id="S2.E5.m1.3.3.1.1.1.1.1.3.2.3.2" xref="S2.E5.m1.3.3.1.1.1.1.1.3.2.3.2.cmml">θ</mi><mi id="S2.E5.m1.3.3.1.1.1.1.1.3.2.3.3" xref="S2.E5.m1.3.3.1.1.1.1.1.3.2.3.3.cmml">z</mi></msub></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E5.m1.3.3.1.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msup id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">a</mi><mi id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">m</mi></msup><mo fence="false" id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml">𝐳</mi><mo id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msup id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐢</mi><mi id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></msup></mrow></mrow><mo stretchy="false" id="S2.E5.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E5.m1.3.3.1.1.1.1.3" xref="S2.E5.m1.3.3.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.3b"><apply id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3"><times id="S2.E5.m1.3.3.2.cmml" xref="S2.E5.m1.3.3.2"></times><apply id="S2.E5.m1.3.3.3.cmml" xref="S2.E5.m1.3.3.3"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.3.1.cmml" xref="S2.E5.m1.3.3.3">subscript</csymbol><max id="S2.E5.m1.3.3.3.2.cmml" xref="S2.E5.m1.3.3.3.2"></max><apply id="S2.E5.m1.3.3.3.3.cmml" xref="S2.E5.m1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.3.3.1.cmml" xref="S2.E5.m1.3.3.3.3">subscript</csymbol><ci id="S2.E5.m1.3.3.3.3.2.cmml" xref="S2.E5.m1.3.3.3.3.2">𝜃</ci><ci id="S2.E5.m1.3.3.3.3.3.cmml" xref="S2.E5.m1.3.3.3.3.3">𝒵</ci></apply></apply><apply id="S2.E5.m1.3.3.1.cmml" xref="S2.E5.m1.3.3.1"><apply id="S2.E5.m1.3.3.1.2.cmml" xref="S2.E5.m1.3.3.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.2.1.cmml" xref="S2.E5.m1.3.3.1.2">superscript</csymbol><apply id="S2.E5.m1.3.3.1.2.2.cmml" xref="S2.E5.m1.3.3.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.2.2.1.cmml" xref="S2.E5.m1.3.3.1.2">subscript</csymbol><sum id="S2.E5.m1.3.3.1.2.2.2.cmml" xref="S2.E5.m1.3.3.1.2.2.2"></sum><apply id="S2.E5.m1.3.3.1.2.2.3.cmml" xref="S2.E5.m1.3.3.1.2.2.3"><eq id="S2.E5.m1.3.3.1.2.2.3.1.cmml" xref="S2.E5.m1.3.3.1.2.2.3.1"></eq><ci id="S2.E5.m1.3.3.1.2.2.3.2.cmml" xref="S2.E5.m1.3.3.1.2.2.3.2">𝑚</ci><cn type="integer" id="S2.E5.m1.3.3.1.2.2.3.3.cmml" xref="S2.E5.m1.3.3.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E5.m1.3.3.1.2.3.cmml" xref="S2.E5.m1.3.3.1.2.3">𝑀</ci></apply><apply id="S2.E5.m1.3.3.1.1.cmml" xref="S2.E5.m1.3.3.1.1"><times id="S2.E5.m1.3.3.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.2"></times><apply id="S2.E5.m1.3.3.1.1.3.cmml" xref="S2.E5.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.1.3.1.cmml" xref="S2.E5.m1.3.3.1.1.3">subscript</csymbol><ci id="S2.E5.m1.3.3.1.1.3.2.cmml" xref="S2.E5.m1.3.3.1.1.3.2">𝐸</ci><apply id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.2">similar-to</csymbol><ci id="S2.E5.m1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.3">𝑧</ci><apply id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1"><times id="S2.E5.m1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.2"></times><ci id="S2.E5.m1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.3">𝑞</ci><apply id="S2.E5.m1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.2">𝐳</ci><apply id="S2.E5.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.3.2">𝐱</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply></apply></apply><apply id="S2.E5.m1.3.3.1.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.3.3.1.1.1.2.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E5.m1.3.3.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1"><times id="S2.E5.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.2"></times><apply id="S2.E5.m1.3.3.1.1.1.1.1.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.3"><log id="S2.E5.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.3.1"></log><apply id="S2.E5.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.1.1.1.1.3.2.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E5.m1.3.3.1.1.1.1.1.3.2.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.3.2.2">𝑝</ci><apply id="S2.E5.m1.3.3.1.1.1.1.1.3.2.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.1.1.1.1.3.2.3.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E5.m1.3.3.1.1.1.1.1.3.2.3.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.3.2.3.2">𝜃</ci><ci id="S2.E5.m1.3.3.1.1.1.1.1.3.2.3.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.3.2.3.3">𝑧</ci></apply></apply></apply><apply id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3.2">𝑎</ci><ci id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3">𝑚</ci></apply><list id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1"><ci id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2">𝐳</ci><apply id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝐢</ci><ci id="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.3c">\max_{\theta_{\mathcal{Z}}}\sum_{m=1}^{M}E_{z\sim q(\mathbf{z}|\mathbf{x}^{m})}[\log p_{\theta_{z}}(a^{m}|\mathbf{z},\mathbf{i}^{m})]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p11.3" class="ltx_p">The goal is to find a good initialization of the module parameters, say
<math id="S2.SS2.p11.2.m1.1" class="ltx_Math" alttext="\theta_{\texttt{find[green]}}" display="inline"><semantics id="S2.SS2.p11.2.m1.1a"><msub id="S2.SS2.p11.2.m1.1.1" xref="S2.SS2.p11.2.m1.1.1.cmml"><mi id="S2.SS2.p11.2.m1.1.1.2" xref="S2.SS2.p11.2.m1.1.1.2.cmml">θ</mi><mtext class="ltx_mathvariant_monospace" id="S2.SS2.p11.2.m1.1.1.3" xref="S2.SS2.p11.2.m1.1.1.3a.cmml">find[green]</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p11.2.m1.1b"><apply id="S2.SS2.p11.2.m1.1.1.cmml" xref="S2.SS2.p11.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p11.2.m1.1.1.1.cmml" xref="S2.SS2.p11.2.m1.1.1">subscript</csymbol><ci id="S2.SS2.p11.2.m1.1.1.2.cmml" xref="S2.SS2.p11.2.m1.1.1.2">𝜃</ci><ci id="S2.SS2.p11.2.m1.1.1.3a.cmml" xref="S2.SS2.p11.2.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S2.SS2.p11.2.m1.1.1.3.cmml" xref="S2.SS2.p11.2.m1.1.1.3">find[green]</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p11.2.m1.1c">\theta_{\texttt{find[green]}}</annotation></semantics></math> that binds the execution to the computations
expected for the symbol <span id="S2.SS2.p11.3.1" class="ltx_text ltx_markedasmath ltx_font_typewriter">find[green]</span> (namely the neural module network).</p>
</div>
<div id="S2.SS2.p12" class="ltx_para ltx_noindent">
<p id="S2.SS2.p12.5" class="ltx_p"><span id="S2.SS2.p12.5.1" class="ltx_text ltx_font_bold">Joint Training.</span>
Having trained the question code and the neural module
network parameters, we train all terms jointly, optimizing the complete evidence
with the lower bound <math id="S2.SS2.p12.1.m1.1" class="ltx_Math" alttext="\mathcal{L}+\mathcal{U}_{f}" display="inline"><semantics id="S2.SS2.p12.1.m1.1a"><mrow id="S2.SS2.p12.1.m1.1.1" xref="S2.SS2.p12.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p12.1.m1.1.1.2" xref="S2.SS2.p12.1.m1.1.1.2.cmml">ℒ</mi><mo id="S2.SS2.p12.1.m1.1.1.1" xref="S2.SS2.p12.1.m1.1.1.1.cmml">+</mo><msub id="S2.SS2.p12.1.m1.1.1.3" xref="S2.SS2.p12.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p12.1.m1.1.1.3.2" xref="S2.SS2.p12.1.m1.1.1.3.2.cmml">𝒰</mi><mi id="S2.SS2.p12.1.m1.1.1.3.3" xref="S2.SS2.p12.1.m1.1.1.3.3.cmml">f</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.1.m1.1b"><apply id="S2.SS2.p12.1.m1.1.1.cmml" xref="S2.SS2.p12.1.m1.1.1"><plus id="S2.SS2.p12.1.m1.1.1.1.cmml" xref="S2.SS2.p12.1.m1.1.1.1"></plus><ci id="S2.SS2.p12.1.m1.1.1.2.cmml" xref="S2.SS2.p12.1.m1.1.1.2">ℒ</ci><apply id="S2.SS2.p12.1.m1.1.1.3.cmml" xref="S2.SS2.p12.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p12.1.m1.1.1.3.1.cmml" xref="S2.SS2.p12.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS2.p12.1.m1.1.1.3.2.cmml" xref="S2.SS2.p12.1.m1.1.1.3.2">𝒰</ci><ci id="S2.SS2.p12.1.m1.1.1.3.3.cmml" xref="S2.SS2.p12.1.m1.1.1.3.3">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.1.m1.1c">\mathcal{L}+\mathcal{U}_{f}</annotation></semantics></math>.
We make changes to the above objective (across all the stages), by adding in
scaling factors <math id="S2.SS2.p12.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.SS2.p12.2.m2.1a"><mi id="S2.SS2.p12.2.m2.1.1" xref="S2.SS2.p12.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.2.m2.1b"><ci id="S2.SS2.p12.2.m2.1.1.cmml" xref="S2.SS2.p12.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.2.m2.1c">\alpha</annotation></semantics></math>, <math id="S2.SS2.p12.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S2.SS2.p12.3.m3.1a"><mi id="S2.SS2.p12.3.m3.1.1" xref="S2.SS2.p12.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.3.m3.1b"><ci id="S2.SS2.p12.3.m3.1.1.cmml" xref="S2.SS2.p12.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.3.m3.1c">\beta</annotation></semantics></math> and <math id="S2.SS2.p12.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S2.SS2.p12.4.m4.1a"><mi id="S2.SS2.p12.4.m4.1.1" xref="S2.SS2.p12.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.4.m4.1b"><ci id="S2.SS2.p12.4.m4.1.1.cmml" xref="S2.SS2.p12.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.4.m4.1c">\gamma</annotation></semantics></math> for corresponding terms in the
objective, and write out the <math id="S2.SS2.p12.5.m5.1" class="ltx_Math" alttext="\mathrm{KL}" display="inline"><semantics id="S2.SS2.p12.5.m5.1a"><mi id="S2.SS2.p12.5.m5.1.1" xref="S2.SS2.p12.5.m5.1.1.cmml">KL</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.5.m5.1b"><ci id="S2.SS2.p12.5.m5.1.1.cmml" xref="S2.SS2.p12.5.m5.1.1">KL</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.5.m5.1c">\mathrm{KL}</annotation></semantics></math> term (<a href="#S2.E4" title="In 2.2 Learning ‣ 2 Methods ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">4</span></a>),
subsuming it into the expectation:</p>
<table id="S2.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E6.m1.84" class="ltx_Math" alttext="\mathcal{L}+\mathcal{U}_{f}\approx\sum_{m=1}^{M}E_{\mathbf{z}\sim q_{\phi}(\mathbf{z}|\mathbf{x}^{m})}[\gamma\log p(a^{m}|\mathbf{i}^{m};\theta_{\mathbf{z}})+\\
\log p_{\sigma}(\mathbf{x}^{m}|\mathbf{z})-\beta\log q_{\phi}(\mathbf{z}|\mathbf{x}^{m})+\beta\log p(\mathbf{z})]+\\
\sum_{n=1}^{N}\left[\alpha\log q_{\phi}(\mathbf{z}^{n}|\mathbf{x}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})\right]" display="block"><semantics id="S2.E6.m1.84a"><mtable displaystyle="true" rowspacing="0pt" id="S2.E6.m1.84.84.3" xref="S2.E6.m1.83.83.2.cmml"><mtr id="S2.E6.m1.84.84.3a" xref="S2.E6.m1.83.83.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E6.m1.84.84.3b" xref="S2.E6.m1.83.83.2.cmml"><mrow id="S2.E6.m1.25.25.25.25.25" xref="S2.E6.m1.83.83.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.cmml">ℒ</mi><mo id="S2.E6.m1.2.2.2.2.2.2" xref="S2.E6.m1.2.2.2.2.2.2.cmml">+</mo><msub id="S2.E6.m1.25.25.25.25.25.26" xref="S2.E6.m1.83.83.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.3.3.3.3.3.3" xref="S2.E6.m1.3.3.3.3.3.3.cmml">𝒰</mi><mi id="S2.E6.m1.4.4.4.4.4.4.1" xref="S2.E6.m1.4.4.4.4.4.4.1.cmml">f</mi></msub><mo rspace="0.111em" id="S2.E6.m1.5.5.5.5.5.5" xref="S2.E6.m1.5.5.5.5.5.5.cmml">≈</mo><munderover id="S2.E6.m1.25.25.25.25.25.27" xref="S2.E6.m1.83.83.2.cmml"><mo movablelimits="false" id="S2.E6.m1.6.6.6.6.6.6" xref="S2.E6.m1.6.6.6.6.6.6.cmml">∑</mo><mrow id="S2.E6.m1.7.7.7.7.7.7.1" xref="S2.E6.m1.7.7.7.7.7.7.1.cmml"><mi id="S2.E6.m1.7.7.7.7.7.7.1.2" xref="S2.E6.m1.7.7.7.7.7.7.1.2.cmml">m</mi><mo id="S2.E6.m1.7.7.7.7.7.7.1.1" xref="S2.E6.m1.7.7.7.7.7.7.1.1.cmml">=</mo><mn id="S2.E6.m1.7.7.7.7.7.7.1.3" xref="S2.E6.m1.7.7.7.7.7.7.1.3.cmml">1</mn></mrow><mi id="S2.E6.m1.8.8.8.8.8.8.1" xref="S2.E6.m1.8.8.8.8.8.8.1.cmml">M</mi></munderover><msub id="S2.E6.m1.25.25.25.25.25.28" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.9.9.9.9.9.9" xref="S2.E6.m1.9.9.9.9.9.9.cmml">E</mi><mrow id="S2.E6.m1.10.10.10.10.10.10.1" xref="S2.E6.m1.10.10.10.10.10.10.1.cmml"><mi id="S2.E6.m1.10.10.10.10.10.10.1.3" xref="S2.E6.m1.10.10.10.10.10.10.1.3.cmml">𝐳</mi><mo id="S2.E6.m1.10.10.10.10.10.10.1.2" xref="S2.E6.m1.10.10.10.10.10.10.1.2.cmml">∼</mo><mrow id="S2.E6.m1.10.10.10.10.10.10.1.1" xref="S2.E6.m1.10.10.10.10.10.10.1.1.cmml"><msub id="S2.E6.m1.10.10.10.10.10.10.1.1.3" xref="S2.E6.m1.10.10.10.10.10.10.1.1.3.cmml"><mi id="S2.E6.m1.10.10.10.10.10.10.1.1.3.2" xref="S2.E6.m1.10.10.10.10.10.10.1.1.3.2.cmml">q</mi><mi id="S2.E6.m1.10.10.10.10.10.10.1.1.3.3" xref="S2.E6.m1.10.10.10.10.10.10.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.E6.m1.10.10.10.10.10.10.1.1.2" xref="S2.E6.m1.10.10.10.10.10.10.1.1.2.cmml">​</mo><mrow id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.2" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.cmml"><mi id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.2" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.1" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.1.cmml">|</mo><msup id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3.cmml"><mi id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3.2" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3.3" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3.3.cmml">m</mi></msup></mrow><mo stretchy="false" id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.3" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mrow id="S2.E6.m1.25.25.25.25.25.29" xref="S2.E6.m1.83.83.2.cmml"><mo stretchy="false" id="S2.E6.m1.11.11.11.11.11.11" xref="S2.E6.m1.83.83.2.cmml">[</mo><mi id="S2.E6.m1.12.12.12.12.12.12" xref="S2.E6.m1.12.12.12.12.12.12.cmml">γ</mi><mi id="S2.E6.m1.13.13.13.13.13.13" xref="S2.E6.m1.13.13.13.13.13.13.cmml">log</mi><mi id="S2.E6.m1.14.14.14.14.14.14" xref="S2.E6.m1.14.14.14.14.14.14.cmml">p</mi><mrow id="S2.E6.m1.25.25.25.25.25.29.1" xref="S2.E6.m1.83.83.2.cmml"><mo stretchy="false" id="S2.E6.m1.15.15.15.15.15.15" xref="S2.E6.m1.83.83.2.cmml">(</mo><msup id="S2.E6.m1.25.25.25.25.25.29.1.1" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.16.16.16.16.16.16" xref="S2.E6.m1.16.16.16.16.16.16.cmml">a</mi><mi id="S2.E6.m1.17.17.17.17.17.17.1" xref="S2.E6.m1.17.17.17.17.17.17.1.cmml">m</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E6.m1.18.18.18.18.18.18" xref="S2.E6.m1.18.18.18.18.18.18.cmml">|</mo><msup id="S2.E6.m1.25.25.25.25.25.29.1.2" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.19.19.19.19.19.19" xref="S2.E6.m1.19.19.19.19.19.19.cmml">𝐢</mi><mi id="S2.E6.m1.20.20.20.20.20.20.1" xref="S2.E6.m1.20.20.20.20.20.20.1.cmml">m</mi></msup><mo id="S2.E6.m1.21.21.21.21.21.21" xref="S2.E6.m1.83.83.2.cmml">;</mo><msub id="S2.E6.m1.25.25.25.25.25.29.1.3" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.22.22.22.22.22.22" xref="S2.E6.m1.22.22.22.22.22.22.cmml">θ</mi><mi id="S2.E6.m1.23.23.23.23.23.23.1" xref="S2.E6.m1.23.23.23.23.23.23.1.cmml">𝐳</mi></msub><mo stretchy="false" id="S2.E6.m1.24.24.24.24.24.24" xref="S2.E6.m1.83.83.2.cmml">)</mo></mrow><mo id="S2.E6.m1.25.25.25.25.25.25" xref="S2.E6.m1.25.25.25.25.25.25.cmml">+</mo></mrow></mrow></mtd></mtr><mtr id="S2.E6.m1.84.84.3c" xref="S2.E6.m1.83.83.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S2.E6.m1.84.84.3d" xref="S2.E6.m1.83.83.2.cmml"><mrow id="S2.E6.m1.54.54.54.29.29" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.26.26.26.1.1.1" xref="S2.E6.m1.26.26.26.1.1.1.cmml">log</mi><msub id="S2.E6.m1.54.54.54.29.29.30" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.27.27.27.2.2.2" xref="S2.E6.m1.27.27.27.2.2.2.cmml">p</mi><mi id="S2.E6.m1.28.28.28.3.3.3.1" xref="S2.E6.m1.28.28.28.3.3.3.1.cmml">σ</mi></msub><mrow id="S2.E6.m1.54.54.54.29.29.31" xref="S2.E6.m1.83.83.2.cmml"><mo stretchy="false" id="S2.E6.m1.29.29.29.4.4.4" xref="S2.E6.m1.83.83.2.cmml">(</mo><msup id="S2.E6.m1.54.54.54.29.29.31.1" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.30.30.30.5.5.5" xref="S2.E6.m1.30.30.30.5.5.5.cmml">𝐱</mi><mi id="S2.E6.m1.31.31.31.6.6.6.1" xref="S2.E6.m1.31.31.31.6.6.6.1.cmml">m</mi></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E6.m1.32.32.32.7.7.7" xref="S2.E6.m1.32.32.32.7.7.7.cmml">|</mo><mi id="S2.E6.m1.33.33.33.8.8.8" xref="S2.E6.m1.33.33.33.8.8.8.cmml">𝐳</mi><mo stretchy="false" id="S2.E6.m1.34.34.34.9.9.9" xref="S2.E6.m1.83.83.2.cmml">)</mo></mrow><mo id="S2.E6.m1.35.35.35.10.10.10" xref="S2.E6.m1.35.35.35.10.10.10.cmml">−</mo><mi id="S2.E6.m1.36.36.36.11.11.11" xref="S2.E6.m1.36.36.36.11.11.11.cmml">β</mi><mi id="S2.E6.m1.37.37.37.12.12.12" xref="S2.E6.m1.37.37.37.12.12.12.cmml">log</mi><msub id="S2.E6.m1.54.54.54.29.29.32" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.38.38.38.13.13.13" xref="S2.E6.m1.38.38.38.13.13.13.cmml">q</mi><mi id="S2.E6.m1.39.39.39.14.14.14.1" xref="S2.E6.m1.39.39.39.14.14.14.1.cmml">ϕ</mi></msub><mrow id="S2.E6.m1.54.54.54.29.29.33" xref="S2.E6.m1.83.83.2.cmml"><mo stretchy="false" id="S2.E6.m1.40.40.40.15.15.15" xref="S2.E6.m1.83.83.2.cmml">(</mo><mi id="S2.E6.m1.41.41.41.16.16.16" xref="S2.E6.m1.41.41.41.16.16.16.cmml">𝐳</mi><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E6.m1.42.42.42.17.17.17" xref="S2.E6.m1.42.42.42.17.17.17.cmml">|</mo><msup id="S2.E6.m1.54.54.54.29.29.33.1" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.43.43.43.18.18.18" xref="S2.E6.m1.43.43.43.18.18.18.cmml">𝐱</mi><mi id="S2.E6.m1.44.44.44.19.19.19.1" xref="S2.E6.m1.44.44.44.19.19.19.1.cmml">m</mi></msup><mo stretchy="false" id="S2.E6.m1.45.45.45.20.20.20" xref="S2.E6.m1.83.83.2.cmml">)</mo></mrow><mo id="S2.E6.m1.46.46.46.21.21.21" xref="S2.E6.m1.46.46.46.21.21.21.cmml">+</mo><mi id="S2.E6.m1.47.47.47.22.22.22" xref="S2.E6.m1.47.47.47.22.22.22.cmml">β</mi><mi id="S2.E6.m1.48.48.48.23.23.23" xref="S2.E6.m1.48.48.48.23.23.23.cmml">log</mi><mi id="S2.E6.m1.49.49.49.24.24.24" xref="S2.E6.m1.49.49.49.24.24.24.cmml">p</mi><mrow id="S2.E6.m1.54.54.54.29.29.34" xref="S2.E6.m1.83.83.2.cmml"><mo stretchy="false" id="S2.E6.m1.50.50.50.25.25.25" xref="S2.E6.m1.83.83.2.cmml">(</mo><mi id="S2.E6.m1.51.51.51.26.26.26" xref="S2.E6.m1.51.51.51.26.26.26.cmml">𝐳</mi><mo stretchy="false" id="S2.E6.m1.52.52.52.27.27.27" xref="S2.E6.m1.83.83.2.cmml">)</mo></mrow><mo stretchy="false" id="S2.E6.m1.53.53.53.28.28.28" xref="S2.E6.m1.83.83.2.cmml">]</mo><mo id="S2.E6.m1.54.54.54.29.29.29" xref="S2.E6.m1.54.54.54.29.29.29.cmml">+</mo></mrow></mtd></mtr><mtr id="S2.E6.m1.84.84.3e" xref="S2.E6.m1.83.83.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S2.E6.m1.84.84.3f" xref="S2.E6.m1.83.83.2.cmml"><mrow id="S2.E6.m1.84.84.3.82.28.28" xref="S2.E6.m1.83.83.2.cmml"><munderover id="S2.E6.m1.84.84.3.82.28.28.29" xref="S2.E6.m1.83.83.2.cmml"><mo movablelimits="false" id="S2.E6.m1.55.55.55.1.1.1" xref="S2.E6.m1.55.55.55.1.1.1.cmml">∑</mo><mrow id="S2.E6.m1.56.56.56.2.2.2.1" xref="S2.E6.m1.56.56.56.2.2.2.1.cmml"><mi id="S2.E6.m1.56.56.56.2.2.2.1.2" xref="S2.E6.m1.56.56.56.2.2.2.1.2.cmml">n</mi><mo id="S2.E6.m1.56.56.56.2.2.2.1.1" xref="S2.E6.m1.56.56.56.2.2.2.1.1.cmml">=</mo><mn id="S2.E6.m1.56.56.56.2.2.2.1.3" xref="S2.E6.m1.56.56.56.2.2.2.1.3.cmml">1</mn></mrow><mi id="S2.E6.m1.57.57.57.3.3.3.1" xref="S2.E6.m1.57.57.57.3.3.3.1.cmml">N</mi></munderover><mrow id="S2.E6.m1.84.84.3.82.28.28.28.1" xref="S2.E6.m1.83.83.2.cmml"><mo lspace="0em" id="S2.E6.m1.58.58.58.4.4.4" xref="S2.E6.m1.83.83.2.cmml">[</mo><mrow id="S2.E6.m1.84.84.3.82.28.28.28.1.1" xref="S2.E6.m1.83.83.2.cmml"><mrow id="S2.E6.m1.84.84.3.82.28.28.28.1.1.1" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.59.59.59.5.5.5" xref="S2.E6.m1.59.59.59.5.5.5.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="S2.E6.m1.84.84.3.82.28.28.28.1.1.1.2" xref="S2.E6.m1.83.83.2.cmml">​</mo><mrow id="S2.E6.m1.84.84.3.82.28.28.28.1.1.1.3" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.60.60.60.6.6.6" xref="S2.E6.m1.60.60.60.6.6.6.cmml">log</mi><mo lspace="0.167em" id="S2.E6.m1.84.84.3.82.28.28.28.1.1.1.3a" xref="S2.E6.m1.83.83.2.cmml">⁡</mo><msub id="S2.E6.m1.84.84.3.82.28.28.28.1.1.1.3.1" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.61.61.61.7.7.7" xref="S2.E6.m1.61.61.61.7.7.7.cmml">q</mi><mi id="S2.E6.m1.62.62.62.8.8.8.1" xref="S2.E6.m1.62.62.62.8.8.8.1.cmml">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E6.m1.84.84.3.82.28.28.28.1.1.1.2a" xref="S2.E6.m1.83.83.2.cmml">​</mo><mrow id="S2.E6.m1.84.84.3.82.28.28.28.1.1.1.1.1" xref="S2.E6.m1.83.83.2.cmml"><mo stretchy="false" id="S2.E6.m1.63.63.63.9.9.9" xref="S2.E6.m1.83.83.2.cmml">(</mo><mrow id="S2.E6.m1.84.84.3.82.28.28.28.1.1.1.1.1.1" xref="S2.E6.m1.83.83.2.cmml"><msup id="S2.E6.m1.84.84.3.82.28.28.28.1.1.1.1.1.1.1" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.64.64.64.10.10.10" xref="S2.E6.m1.64.64.64.10.10.10.cmml">𝐳</mi><mi id="S2.E6.m1.65.65.65.11.11.11.1" xref="S2.E6.m1.65.65.65.11.11.11.1.cmml">n</mi></msup><mo fence="false" id="S2.E6.m1.66.66.66.12.12.12" xref="S2.E6.m1.66.66.66.12.12.12.cmml">|</mo><msup id="S2.E6.m1.84.84.3.82.28.28.28.1.1.1.1.1.1.2" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.67.67.67.13.13.13" xref="S2.E6.m1.67.67.67.13.13.13.cmml">𝐱</mi><mi id="S2.E6.m1.68.68.68.14.14.14.1" xref="S2.E6.m1.68.68.68.14.14.14.1.cmml">n</mi></msup></mrow><mo stretchy="false" id="S2.E6.m1.69.69.69.15.15.15" xref="S2.E6.m1.83.83.2.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.70.70.70.16.16.16" xref="S2.E6.m1.70.70.70.16.16.16.cmml">+</mo><mrow id="S2.E6.m1.84.84.3.82.28.28.28.1.1.2" xref="S2.E6.m1.83.83.2.cmml"><mrow id="S2.E6.m1.84.84.3.82.28.28.28.1.1.2.3" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.71.71.71.17.17.17" xref="S2.E6.m1.71.71.71.17.17.17.cmml">log</mi><mo lspace="0.167em" id="S2.E6.m1.84.84.3.82.28.28.28.1.1.2.3a" xref="S2.E6.m1.83.83.2.cmml">⁡</mo><msub id="S2.E6.m1.84.84.3.82.28.28.28.1.1.2.3.1" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.72.72.72.18.18.18" xref="S2.E6.m1.72.72.72.18.18.18.cmml">p</mi><mi id="S2.E6.m1.73.73.73.19.19.19.1" xref="S2.E6.m1.73.73.73.19.19.19.1.cmml">σ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E6.m1.84.84.3.82.28.28.28.1.1.2.2" xref="S2.E6.m1.83.83.2.cmml">​</mo><mrow id="S2.E6.m1.84.84.3.82.28.28.28.1.1.2.1.1" xref="S2.E6.m1.83.83.2.cmml"><mo stretchy="false" id="S2.E6.m1.74.74.74.20.20.20" xref="S2.E6.m1.83.83.2.cmml">(</mo><mrow id="S2.E6.m1.84.84.3.82.28.28.28.1.1.2.1.1.1" xref="S2.E6.m1.83.83.2.cmml"><msup id="S2.E6.m1.84.84.3.82.28.28.28.1.1.2.1.1.1.1" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.75.75.75.21.21.21" xref="S2.E6.m1.75.75.75.21.21.21.cmml">𝐱</mi><mi id="S2.E6.m1.76.76.76.22.22.22.1" xref="S2.E6.m1.76.76.76.22.22.22.1.cmml">n</mi></msup><mo fence="false" id="S2.E6.m1.77.77.77.23.23.23" xref="S2.E6.m1.77.77.77.23.23.23.cmml">|</mo><msup id="S2.E6.m1.84.84.3.82.28.28.28.1.1.2.1.1.1.2" xref="S2.E6.m1.83.83.2.cmml"><mi id="S2.E6.m1.78.78.78.24.24.24" xref="S2.E6.m1.78.78.78.24.24.24.cmml">𝐳</mi><mi id="S2.E6.m1.79.79.79.25.25.25.1" xref="S2.E6.m1.79.79.79.25.25.25.1.cmml">n</mi></msup></mrow><mo stretchy="false" id="S2.E6.m1.80.80.80.26.26.26" xref="S2.E6.m1.83.83.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m1.81.81.81.27.27.27" xref="S2.E6.m1.83.83.2.cmml">]</mo></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.E6.m1.84b"><apply id="S2.E6.m1.83.83.2.cmml" xref="S2.E6.m1.84.84.3"><approx id="S2.E6.m1.5.5.5.5.5.5.cmml" xref="S2.E6.m1.5.5.5.5.5.5"></approx><apply id="S2.E6.m1.83.83.2.4.cmml" xref="S2.E6.m1.84.84.3"><plus id="S2.E6.m1.2.2.2.2.2.2.cmml" xref="S2.E6.m1.2.2.2.2.2.2"></plus><ci id="S2.E6.m1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1">ℒ</ci><apply id="S2.E6.m1.83.83.2.4.3.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.83.83.2.4.3.1.cmml" xref="S2.E6.m1.84.84.3">subscript</csymbol><ci id="S2.E6.m1.3.3.3.3.3.3.cmml" xref="S2.E6.m1.3.3.3.3.3.3">𝒰</ci><ci id="S2.E6.m1.4.4.4.4.4.4.1.cmml" xref="S2.E6.m1.4.4.4.4.4.4.1">𝑓</ci></apply></apply><apply id="S2.E6.m1.83.83.2.2.cmml" xref="S2.E6.m1.84.84.3"><plus id="S2.E6.m1.54.54.54.29.29.29.cmml" xref="S2.E6.m1.54.54.54.29.29.29"></plus><apply id="S2.E6.m1.82.82.1.1.1.cmml" xref="S2.E6.m1.84.84.3"><apply id="S2.E6.m1.82.82.1.1.1.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.82.82.1.1.1.2.1.cmml" xref="S2.E6.m1.84.84.3">superscript</csymbol><apply id="S2.E6.m1.82.82.1.1.1.2.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.82.82.1.1.1.2.2.1.cmml" xref="S2.E6.m1.84.84.3">subscript</csymbol><sum id="S2.E6.m1.6.6.6.6.6.6.cmml" xref="S2.E6.m1.6.6.6.6.6.6"></sum><apply id="S2.E6.m1.7.7.7.7.7.7.1.cmml" xref="S2.E6.m1.7.7.7.7.7.7.1"><eq id="S2.E6.m1.7.7.7.7.7.7.1.1.cmml" xref="S2.E6.m1.7.7.7.7.7.7.1.1"></eq><ci id="S2.E6.m1.7.7.7.7.7.7.1.2.cmml" xref="S2.E6.m1.7.7.7.7.7.7.1.2">𝑚</ci><cn type="integer" id="S2.E6.m1.7.7.7.7.7.7.1.3.cmml" xref="S2.E6.m1.7.7.7.7.7.7.1.3">1</cn></apply></apply><ci id="S2.E6.m1.8.8.8.8.8.8.1.cmml" xref="S2.E6.m1.8.8.8.8.8.8.1">𝑀</ci></apply><apply id="S2.E6.m1.82.82.1.1.1.1.cmml" xref="S2.E6.m1.84.84.3"><times id="S2.E6.m1.82.82.1.1.1.1.2.cmml" xref="S2.E6.m1.84.84.3"></times><apply id="S2.E6.m1.82.82.1.1.1.1.3.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.82.82.1.1.1.1.3.1.cmml" xref="S2.E6.m1.84.84.3">subscript</csymbol><ci id="S2.E6.m1.9.9.9.9.9.9.cmml" xref="S2.E6.m1.9.9.9.9.9.9">𝐸</ci><apply id="S2.E6.m1.10.10.10.10.10.10.1.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1"><csymbol cd="latexml" id="S2.E6.m1.10.10.10.10.10.10.1.2.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.2">similar-to</csymbol><ci id="S2.E6.m1.10.10.10.10.10.10.1.3.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.3">𝐳</ci><apply id="S2.E6.m1.10.10.10.10.10.10.1.1.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1"><times id="S2.E6.m1.10.10.10.10.10.10.1.1.2.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1.2"></times><apply id="S2.E6.m1.10.10.10.10.10.10.1.1.3.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.10.10.10.10.10.10.1.1.3.1.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1.3">subscript</csymbol><ci id="S2.E6.m1.10.10.10.10.10.10.1.1.3.2.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1.3.2">𝑞</ci><ci id="S2.E6.m1.10.10.10.10.10.10.1.1.3.3.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1.3.3">italic-ϕ</ci></apply><apply id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.1.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.1">conditional</csymbol><ci id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.2.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.2">𝐳</ci><apply id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3.2">𝐱</ci><ci id="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3.3.cmml" xref="S2.E6.m1.10.10.10.10.10.10.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply></apply></apply><apply id="S2.E6.m1.82.82.1.1.1.1.1.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="latexml" id="S2.E6.m1.82.82.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.84.84.3">delimited-[]</csymbol><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.84.84.3"><plus id="S2.E6.m1.46.46.46.21.21.21.cmml" xref="S2.E6.m1.46.46.46.21.21.21"></plus><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.84.84.3"><minus id="S2.E6.m1.35.35.35.10.10.10.cmml" xref="S2.E6.m1.35.35.35.10.10.10"></minus><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.84.84.3"><plus id="S2.E6.m1.25.25.25.25.25.25.cmml" xref="S2.E6.m1.25.25.25.25.25.25"></plus><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.84.84.3"><times id="S2.E6.m1.82.82.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.84.84.3"></times><ci id="S2.E6.m1.12.12.12.12.12.12.cmml" xref="S2.E6.m1.12.12.12.12.12.12">𝛾</ci><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E6.m1.84.84.3"><log id="S2.E6.m1.13.13.13.13.13.13.cmml" xref="S2.E6.m1.13.13.13.13.13.13"></log><ci id="S2.E6.m1.14.14.14.14.14.14.cmml" xref="S2.E6.m1.14.14.14.14.14.14">𝑝</ci></apply><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.84.84.3"><ci id="S2.E6.m1.18.18.18.18.18.18.cmml" xref="S2.E6.m1.18.18.18.18.18.18">|</ci><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E6.m1.84.84.3">superscript</csymbol><ci id="S2.E6.m1.16.16.16.16.16.16.cmml" xref="S2.E6.m1.16.16.16.16.16.16">𝑎</ci><ci id="S2.E6.m1.17.17.17.17.17.17.1.cmml" xref="S2.E6.m1.17.17.17.17.17.17.1">𝑚</ci></apply><list id="S2.E6.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.84.84.3"><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.84.84.3">superscript</csymbol><ci id="S2.E6.m1.19.19.19.19.19.19.cmml" xref="S2.E6.m1.19.19.19.19.19.19">𝐢</ci><ci id="S2.E6.m1.20.20.20.20.20.20.1.cmml" xref="S2.E6.m1.20.20.20.20.20.20.1">𝑚</ci></apply><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.82.82.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E6.m1.84.84.3">subscript</csymbol><ci id="S2.E6.m1.22.22.22.22.22.22.cmml" xref="S2.E6.m1.22.22.22.22.22.22">𝜃</ci><ci id="S2.E6.m1.23.23.23.23.23.23.1.cmml" xref="S2.E6.m1.23.23.23.23.23.23.1">𝐳</ci></apply></list></apply></apply><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E6.m1.84.84.3"><times id="S2.E6.m1.82.82.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E6.m1.84.84.3"></times><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E6.m1.84.84.3"><log id="S2.E6.m1.26.26.26.1.1.1.cmml" xref="S2.E6.m1.26.26.26.1.1.1"></log><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.82.82.1.1.1.1.1.1.1.2.2.2.3.2.1.cmml" xref="S2.E6.m1.84.84.3">subscript</csymbol><ci id="S2.E6.m1.27.27.27.2.2.2.cmml" xref="S2.E6.m1.27.27.27.2.2.2">𝑝</ci><ci id="S2.E6.m1.28.28.28.3.3.3.1.cmml" xref="S2.E6.m1.28.28.28.3.3.3.1">𝜎</ci></apply></apply><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S2.E6.m1.84.84.3"><ci id="S2.E6.m1.32.32.32.7.7.7.cmml" xref="S2.E6.m1.32.32.32.7.7.7">|</ci><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.82.82.1.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="S2.E6.m1.84.84.3">superscript</csymbol><ci id="S2.E6.m1.30.30.30.5.5.5.cmml" xref="S2.E6.m1.30.30.30.5.5.5">𝐱</ci><ci id="S2.E6.m1.31.31.31.6.6.6.1.cmml" xref="S2.E6.m1.31.31.31.6.6.6.1">𝑚</ci></apply><ci id="S2.E6.m1.33.33.33.8.8.8.cmml" xref="S2.E6.m1.33.33.33.8.8.8">𝐳</ci></apply></apply></apply><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E6.m1.84.84.3"><times id="S2.E6.m1.82.82.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E6.m1.84.84.3"></times><ci id="S2.E6.m1.36.36.36.11.11.11.cmml" xref="S2.E6.m1.36.36.36.11.11.11">𝛽</ci><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.3.3.4.cmml" xref="S2.E6.m1.84.84.3"><log id="S2.E6.m1.37.37.37.12.12.12.cmml" xref="S2.E6.m1.37.37.37.12.12.12"></log><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.3.3.4.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.82.82.1.1.1.1.1.1.1.3.3.4.2.1.cmml" xref="S2.E6.m1.84.84.3">subscript</csymbol><ci id="S2.E6.m1.38.38.38.13.13.13.cmml" xref="S2.E6.m1.38.38.38.13.13.13">𝑞</ci><ci id="S2.E6.m1.39.39.39.14.14.14.1.cmml" xref="S2.E6.m1.39.39.39.14.14.14.1">italic-ϕ</ci></apply></apply><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.3.3.1.1.1.cmml" xref="S2.E6.m1.84.84.3"><ci id="S2.E6.m1.42.42.42.17.17.17.cmml" xref="S2.E6.m1.42.42.42.17.17.17">|</ci><ci id="S2.E6.m1.41.41.41.16.16.16.cmml" xref="S2.E6.m1.41.41.41.16.16.16">𝐳</ci><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.3.3.1.1.1.3.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.82.82.1.1.1.1.1.1.1.3.3.1.1.1.3.1.cmml" xref="S2.E6.m1.84.84.3">superscript</csymbol><ci id="S2.E6.m1.43.43.43.18.18.18.cmml" xref="S2.E6.m1.43.43.43.18.18.18">𝐱</ci><ci id="S2.E6.m1.44.44.44.19.19.19.1.cmml" xref="S2.E6.m1.44.44.44.19.19.19.1">𝑚</ci></apply></apply></apply></apply><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.5.cmml" xref="S2.E6.m1.84.84.3"><times id="S2.E6.m1.82.82.1.1.1.1.1.1.1.5.1.cmml" xref="S2.E6.m1.84.84.3"></times><ci id="S2.E6.m1.47.47.47.22.22.22.cmml" xref="S2.E6.m1.47.47.47.22.22.22">𝛽</ci><apply id="S2.E6.m1.82.82.1.1.1.1.1.1.1.5.3.cmml" xref="S2.E6.m1.84.84.3"><log id="S2.E6.m1.48.48.48.23.23.23.cmml" xref="S2.E6.m1.48.48.48.23.23.23"></log><ci id="S2.E6.m1.49.49.49.24.24.24.cmml" xref="S2.E6.m1.49.49.49.24.24.24">𝑝</ci></apply><ci id="S2.E6.m1.51.51.51.26.26.26.cmml" xref="S2.E6.m1.51.51.51.26.26.26">𝐳</ci></apply></apply></apply></apply></apply><apply id="S2.E6.m1.83.83.2.2.2.cmml" xref="S2.E6.m1.84.84.3"><apply id="S2.E6.m1.83.83.2.2.2.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.83.83.2.2.2.2.1.cmml" xref="S2.E6.m1.84.84.3">superscript</csymbol><apply id="S2.E6.m1.83.83.2.2.2.2.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.83.83.2.2.2.2.2.1.cmml" xref="S2.E6.m1.84.84.3">subscript</csymbol><sum id="S2.E6.m1.55.55.55.1.1.1.cmml" xref="S2.E6.m1.55.55.55.1.1.1"></sum><apply id="S2.E6.m1.56.56.56.2.2.2.1.cmml" xref="S2.E6.m1.56.56.56.2.2.2.1"><eq id="S2.E6.m1.56.56.56.2.2.2.1.1.cmml" xref="S2.E6.m1.56.56.56.2.2.2.1.1"></eq><ci id="S2.E6.m1.56.56.56.2.2.2.1.2.cmml" xref="S2.E6.m1.56.56.56.2.2.2.1.2">𝑛</ci><cn type="integer" id="S2.E6.m1.56.56.56.2.2.2.1.3.cmml" xref="S2.E6.m1.56.56.56.2.2.2.1.3">1</cn></apply></apply><ci id="S2.E6.m1.57.57.57.3.3.3.1.cmml" xref="S2.E6.m1.57.57.57.3.3.3.1">𝑁</ci></apply><apply id="S2.E6.m1.83.83.2.2.2.1.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="latexml" id="S2.E6.m1.83.83.2.2.2.1.2.1.cmml" xref="S2.E6.m1.84.84.3">delimited-[]</csymbol><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.cmml" xref="S2.E6.m1.84.84.3"><plus id="S2.E6.m1.70.70.70.16.16.16.cmml" xref="S2.E6.m1.70.70.70.16.16.16"></plus><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.1.cmml" xref="S2.E6.m1.84.84.3"><times id="S2.E6.m1.83.83.2.2.2.1.1.1.1.2.cmml" xref="S2.E6.m1.84.84.3"></times><ci id="S2.E6.m1.59.59.59.5.5.5.cmml" xref="S2.E6.m1.59.59.59.5.5.5">𝛼</ci><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.1.4.cmml" xref="S2.E6.m1.84.84.3"><log id="S2.E6.m1.60.60.60.6.6.6.cmml" xref="S2.E6.m1.60.60.60.6.6.6"></log><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.1.4.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.83.83.2.2.2.1.1.1.1.4.2.1.cmml" xref="S2.E6.m1.84.84.3">subscript</csymbol><ci id="S2.E6.m1.61.61.61.7.7.7.cmml" xref="S2.E6.m1.61.61.61.7.7.7">𝑞</ci><ci id="S2.E6.m1.62.62.62.8.8.8.1.cmml" xref="S2.E6.m1.62.62.62.8.8.8.1">italic-ϕ</ci></apply></apply><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="latexml" id="S2.E6.m1.66.66.66.12.12.12.cmml" xref="S2.E6.m1.66.66.66.12.12.12">conditional</csymbol><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.83.83.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.84.84.3">superscript</csymbol><ci id="S2.E6.m1.64.64.64.10.10.10.cmml" xref="S2.E6.m1.64.64.64.10.10.10">𝐳</ci><ci id="S2.E6.m1.65.65.65.11.11.11.1.cmml" xref="S2.E6.m1.65.65.65.11.11.11.1">𝑛</ci></apply><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.83.83.2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.84.84.3">superscript</csymbol><ci id="S2.E6.m1.67.67.67.13.13.13.cmml" xref="S2.E6.m1.67.67.67.13.13.13">𝐱</ci><ci id="S2.E6.m1.68.68.68.14.14.14.1.cmml" xref="S2.E6.m1.68.68.68.14.14.14.1">𝑛</ci></apply></apply></apply><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.2.cmml" xref="S2.E6.m1.84.84.3"><times id="S2.E6.m1.83.83.2.2.2.1.1.1.2.2.cmml" xref="S2.E6.m1.84.84.3"></times><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.2.3.cmml" xref="S2.E6.m1.84.84.3"><log id="S2.E6.m1.71.71.71.17.17.17.cmml" xref="S2.E6.m1.71.71.71.17.17.17"></log><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.2.3.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.83.83.2.2.2.1.1.1.2.3.2.1.cmml" xref="S2.E6.m1.84.84.3">subscript</csymbol><ci id="S2.E6.m1.72.72.72.18.18.18.cmml" xref="S2.E6.m1.72.72.72.18.18.18">𝑝</ci><ci id="S2.E6.m1.73.73.73.19.19.19.1.cmml" xref="S2.E6.m1.73.73.73.19.19.19.1">𝜎</ci></apply></apply><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.2.1.1.1.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="latexml" id="S2.E6.m1.77.77.77.23.23.23.cmml" xref="S2.E6.m1.77.77.77.23.23.23">conditional</csymbol><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.2.1.1.1.2.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.83.83.2.2.2.1.1.1.2.1.1.1.2.1.cmml" xref="S2.E6.m1.84.84.3">superscript</csymbol><ci id="S2.E6.m1.75.75.75.21.21.21.cmml" xref="S2.E6.m1.75.75.75.21.21.21">𝐱</ci><ci id="S2.E6.m1.76.76.76.22.22.22.1.cmml" xref="S2.E6.m1.76.76.76.22.22.22.1">𝑛</ci></apply><apply id="S2.E6.m1.83.83.2.2.2.1.1.1.2.1.1.1.3.cmml" xref="S2.E6.m1.84.84.3"><csymbol cd="ambiguous" id="S2.E6.m1.83.83.2.2.2.1.1.1.2.1.1.1.3.1.cmml" xref="S2.E6.m1.84.84.3">superscript</csymbol><ci id="S2.E6.m1.78.78.78.24.24.24.cmml" xref="S2.E6.m1.78.78.78.24.24.24">𝐳</ci><ci id="S2.E6.m1.79.79.79.25.25.25.1.cmml" xref="S2.E6.m1.79.79.79.25.25.25.1">𝑛</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.84c">\mathcal{L}+\mathcal{U}_{f}\approx\sum_{m=1}^{M}E_{\mathbf{z}\sim q_{\phi}(\mathbf{z}|\mathbf{x}^{m})}[\gamma\log p(a^{m}|\mathbf{i}^{m};\theta_{\mathbf{z}})+\\
\log p_{\sigma}(\mathbf{x}^{m}|\mathbf{z})-\beta\log q_{\phi}(\mathbf{z}|\mathbf{x}^{m})+\beta\log p(\mathbf{z})]+\\
\sum_{n=1}^{N}\left[\alpha\log q_{\phi}(\mathbf{z}^{n}|\mathbf{x}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p12.10" class="ltx_p"><span id="S2.SS2.p12.8.3" class="ltx_text" style="color:#000000;">where <math id="S2.SS2.p12.6.1.m1.1" class="ltx_Math" alttext="\gamma&gt;1" display="inline"><semantics id="S2.SS2.p12.6.1.m1.1a"><mrow id="S2.SS2.p12.6.1.m1.1.1" xref="S2.SS2.p12.6.1.m1.1.1.cmml"><mi mathcolor="#000000" id="S2.SS2.p12.6.1.m1.1.1.2" xref="S2.SS2.p12.6.1.m1.1.1.2.cmml">γ</mi><mo mathcolor="#000000" id="S2.SS2.p12.6.1.m1.1.1.1" xref="S2.SS2.p12.6.1.m1.1.1.1.cmml">&gt;</mo><mn mathcolor="#000000" id="S2.SS2.p12.6.1.m1.1.1.3" xref="S2.SS2.p12.6.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.6.1.m1.1b"><apply id="S2.SS2.p12.6.1.m1.1.1.cmml" xref="S2.SS2.p12.6.1.m1.1.1"><gt id="S2.SS2.p12.6.1.m1.1.1.1.cmml" xref="S2.SS2.p12.6.1.m1.1.1.1"></gt><ci id="S2.SS2.p12.6.1.m1.1.1.2.cmml" xref="S2.SS2.p12.6.1.m1.1.1.2">𝛾</ci><cn type="integer" id="S2.SS2.p12.6.1.m1.1.1.3.cmml" xref="S2.SS2.p12.6.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.6.1.m1.1c">\gamma&gt;1</annotation></semantics></math> is a scaling factor on the answer likelihood, which has fewer bits
of information than the question. For answers <math id="S2.SS2.p12.7.2.m2.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S2.SS2.p12.7.2.m2.1a"><mi mathcolor="#000000" id="S2.SS2.p12.7.2.m2.1.1" xref="S2.SS2.p12.7.2.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.7.2.m2.1b"><ci id="S2.SS2.p12.7.2.m2.1.1.cmml" xref="S2.SS2.p12.7.2.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.7.2.m2.1c">a</annotation></semantics></math>, which have probability
mass functions, <math id="S2.SS2.p12.8.3.m3.1" class="ltx_Math" alttext="\gamma&gt;1" display="inline"><semantics id="S2.SS2.p12.8.3.m3.1a"><mrow id="S2.SS2.p12.8.3.m3.1.1" xref="S2.SS2.p12.8.3.m3.1.1.cmml"><mi mathcolor="#000000" id="S2.SS2.p12.8.3.m3.1.1.2" xref="S2.SS2.p12.8.3.m3.1.1.2.cmml">γ</mi><mo mathcolor="#000000" id="S2.SS2.p12.8.3.m3.1.1.1" xref="S2.SS2.p12.8.3.m3.1.1.1.cmml">&gt;</mo><mn mathcolor="#000000" id="S2.SS2.p12.8.3.m3.1.1.3" xref="S2.SS2.p12.8.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.8.3.m3.1b"><apply id="S2.SS2.p12.8.3.m3.1.1.cmml" xref="S2.SS2.p12.8.3.m3.1.1"><gt id="S2.SS2.p12.8.3.m3.1.1.1.cmml" xref="S2.SS2.p12.8.3.m3.1.1.1"></gt><ci id="S2.SS2.p12.8.3.m3.1.1.2.cmml" xref="S2.SS2.p12.8.3.m3.1.1.2">𝛾</ci><cn type="integer" id="S2.SS2.p12.8.3.m3.1.1.3.cmml" xref="S2.SS2.p12.8.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.8.3.m3.1c">\gamma&gt;1</annotation></semantics></math> still gives us a valid lower bound<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note"><span id="footnote3.1.1.1" class="ltx_text" style="color:#000000;">3</span></span><span id="footnote3.9" class="ltx_text" style="color:#000000;">Similar scaling
factors have been found to be useful in prior work </span><cite class="ltx_cite ltx_citemacro_citep"><span id="footnote3.10.1" class="ltx_text" style="color:#000000;">(</span>Vedantam et al.<span id="footnote3.11.2.1.1" class="ltx_text" style="color:#000000;">, </span><a href="#bib.bib47" title="" class="ltx_ref">2018</a><span id="footnote3.12.3" class="ltx_text" style="color:#000000;">)</span></cite><span id="footnote3.13" class="ltx_text" style="color:#000000;"> (Appendix A.3)
in terms of shaping the latent space.</span></span></span></span></span>. The same values of <math id="S2.SS2.p12.9.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S2.SS2.p12.9.m1.1a"><mi id="S2.SS2.p12.9.m1.1.1" xref="S2.SS2.p12.9.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.9.m1.1b"><ci id="S2.SS2.p12.9.m1.1.1.cmml" xref="S2.SS2.p12.9.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.9.m1.1c">\beta</annotation></semantics></math> and <math id="S2.SS2.p12.10.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.SS2.p12.10.m2.1a"><mi id="S2.SS2.p12.10.m2.1.1" xref="S2.SS2.p12.10.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p12.10.m2.1b"><ci id="S2.SS2.p12.10.m2.1.1.cmml" xref="S2.SS2.p12.10.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p12.10.m2.1c">\alpha</annotation></semantics></math> are used
as in question coding (and for the same reasons <span id="S2.SS2.p12.10.4" class="ltx_text" style="color:#000000;">explained above</span>).</p>
</div>
<div id="S2.SS2.p13" class="ltx_para">
<p id="S2.SS2.p13.3" class="ltx_p"><span id="S2.SS2.p13.2.2" class="ltx_text" style="color:#000000;">The first term, with expectation over <math id="S2.SS2.p13.1.1.m1.1" class="ltx_Math" alttext="\mathbf{z}\sim q_{\phi}(\cdot)" display="inline"><semantics id="S2.SS2.p13.1.1.m1.1a"><mrow id="S2.SS2.p13.1.1.m1.1.2" xref="S2.SS2.p13.1.1.m1.1.2.cmml"><mi mathcolor="#000000" id="S2.SS2.p13.1.1.m1.1.2.2" xref="S2.SS2.p13.1.1.m1.1.2.2.cmml">𝐳</mi><mo mathcolor="#000000" id="S2.SS2.p13.1.1.m1.1.2.1" xref="S2.SS2.p13.1.1.m1.1.2.1.cmml">∼</mo><mrow id="S2.SS2.p13.1.1.m1.1.2.3" xref="S2.SS2.p13.1.1.m1.1.2.3.cmml"><msub id="S2.SS2.p13.1.1.m1.1.2.3.2" xref="S2.SS2.p13.1.1.m1.1.2.3.2.cmml"><mi mathcolor="#000000" id="S2.SS2.p13.1.1.m1.1.2.3.2.2" xref="S2.SS2.p13.1.1.m1.1.2.3.2.2.cmml">q</mi><mi mathcolor="#000000" id="S2.SS2.p13.1.1.m1.1.2.3.2.3" xref="S2.SS2.p13.1.1.m1.1.2.3.2.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p13.1.1.m1.1.2.3.1" xref="S2.SS2.p13.1.1.m1.1.2.3.1.cmml">​</mo><mrow id="S2.SS2.p13.1.1.m1.1.2.3.3.2" xref="S2.SS2.p13.1.1.m1.1.2.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p13.1.1.m1.1.2.3.3.2.1" xref="S2.SS2.p13.1.1.m1.1.2.3.cmml">(</mo><mo lspace="0em" mathcolor="#000000" rspace="0em" id="S2.SS2.p13.1.1.m1.1.1" xref="S2.SS2.p13.1.1.m1.1.1.cmml">⋅</mo><mo mathcolor="#000000" stretchy="false" id="S2.SS2.p13.1.1.m1.1.2.3.3.2.2" xref="S2.SS2.p13.1.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p13.1.1.m1.1b"><apply id="S2.SS2.p13.1.1.m1.1.2.cmml" xref="S2.SS2.p13.1.1.m1.1.2"><csymbol cd="latexml" id="S2.SS2.p13.1.1.m1.1.2.1.cmml" xref="S2.SS2.p13.1.1.m1.1.2.1">similar-to</csymbol><ci id="S2.SS2.p13.1.1.m1.1.2.2.cmml" xref="S2.SS2.p13.1.1.m1.1.2.2">𝐳</ci><apply id="S2.SS2.p13.1.1.m1.1.2.3.cmml" xref="S2.SS2.p13.1.1.m1.1.2.3"><times id="S2.SS2.p13.1.1.m1.1.2.3.1.cmml" xref="S2.SS2.p13.1.1.m1.1.2.3.1"></times><apply id="S2.SS2.p13.1.1.m1.1.2.3.2.cmml" xref="S2.SS2.p13.1.1.m1.1.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p13.1.1.m1.1.2.3.2.1.cmml" xref="S2.SS2.p13.1.1.m1.1.2.3.2">subscript</csymbol><ci id="S2.SS2.p13.1.1.m1.1.2.3.2.2.cmml" xref="S2.SS2.p13.1.1.m1.1.2.3.2.2">𝑞</ci><ci id="S2.SS2.p13.1.1.m1.1.2.3.2.3.cmml" xref="S2.SS2.p13.1.1.m1.1.2.3.2.3">italic-ϕ</ci></apply><ci id="S2.SS2.p13.1.1.m1.1.1.cmml" xref="S2.SS2.p13.1.1.m1.1.1">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p13.1.1.m1.1c">\mathbf{z}\sim q_{\phi}(\cdot)</annotation></semantics></math>
is not differentiable with respect to <math id="S2.SS2.p13.2.2.m2.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S2.SS2.p13.2.2.m2.1a"><mi mathcolor="#000000" id="S2.SS2.p13.2.2.m2.1.1" xref="S2.SS2.p13.2.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p13.2.2.m2.1b"><ci id="S2.SS2.p13.2.2.m2.1.1.cmml" xref="S2.SS2.p13.2.2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p13.2.2.m2.1c">\phi</annotation></semantics></math>. Thus we use the</span> REINFORCE <cite class="ltx_cite ltx_citemacro_citep">(Williams, <a href="#bib.bib50" title="" class="ltx_ref">1992</a>)</cite>
estimator with a moving
average baseline <span id="S2.SS2.p13.3.3" class="ltx_text" style="color:#000000;">to get a gradient estimate
for <math id="S2.SS2.p13.3.3.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S2.SS2.p13.3.3.m1.1a"><mi mathcolor="#000000" id="S2.SS2.p13.3.3.m1.1.1" xref="S2.SS2.p13.3.3.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p13.3.3.m1.1b"><ci id="S2.SS2.p13.3.3.m1.1.1.cmml" xref="S2.SS2.p13.3.3.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p13.3.3.m1.1c">\phi</annotation></semantics></math> (see Appendix for more details.)</span>.
<span id="S2.SS2.p13.3.4" class="ltx_text" style="color:#000000;">We take the gradients (where available) for updating the
rest of the parameters.</span></p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Benefits of Three Stage Training</h3>

<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.5.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Prob-NMN Training Procedure</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.6" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Given:</span> <math id="alg1.l1.m1.5" class="ltx_Math" alttext="\mathcal{D}=\{\mathbf{x}^{n},\mathbf{z}^{n}\}_{n=1}^{N}\cup\{\mathbf{x}^{m},a^{m},\mathbf{i}^{m}\}_{m=1}^{M}" display="inline"><semantics id="alg1.l1.m1.5a"><mrow id="alg1.l1.m1.5.5" xref="alg1.l1.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.5.5.7" xref="alg1.l1.m1.5.5.7.cmml">𝒟</mi><mo id="alg1.l1.m1.5.5.6" xref="alg1.l1.m1.5.5.6.cmml">=</mo><mrow id="alg1.l1.m1.5.5.5" xref="alg1.l1.m1.5.5.5.cmml"><msubsup id="alg1.l1.m1.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.cmml"><mrow id="alg1.l1.m1.2.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l1.m1.2.2.2.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.2.2.3.cmml">{</mo><msup id="alg1.l1.m1.1.1.1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="alg1.l1.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo id="alg1.l1.m1.2.2.2.2.2.2.2.4" xref="alg1.l1.m1.2.2.2.2.2.2.3.cmml">,</mo><msup id="alg1.l1.m1.2.2.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.2.2.cmml"><mi id="alg1.l1.m1.2.2.2.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.2.2.2.cmml">𝐳</mi><mi id="alg1.l1.m1.2.2.2.2.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.2.2.2.2.3.cmml">n</mi></msup><mo stretchy="false" id="alg1.l1.m1.2.2.2.2.2.2.2.5" xref="alg1.l1.m1.2.2.2.2.2.2.3.cmml">}</mo></mrow><mrow id="alg1.l1.m1.2.2.2.2.2.4" xref="alg1.l1.m1.2.2.2.2.2.4.cmml"><mi id="alg1.l1.m1.2.2.2.2.2.4.2" xref="alg1.l1.m1.2.2.2.2.2.4.2.cmml">n</mi><mo id="alg1.l1.m1.2.2.2.2.2.4.1" xref="alg1.l1.m1.2.2.2.2.2.4.1.cmml">=</mo><mn id="alg1.l1.m1.2.2.2.2.2.4.3" xref="alg1.l1.m1.2.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="alg1.l1.m1.2.2.2.2.4" xref="alg1.l1.m1.2.2.2.2.4.cmml">N</mi></msubsup><mo id="alg1.l1.m1.5.5.5.6" xref="alg1.l1.m1.5.5.5.6.cmml">∪</mo><msubsup id="alg1.l1.m1.5.5.5.5" xref="alg1.l1.m1.5.5.5.5.cmml"><mrow id="alg1.l1.m1.5.5.5.5.3.3.3" xref="alg1.l1.m1.5.5.5.5.3.3.4.cmml"><mo stretchy="false" id="alg1.l1.m1.5.5.5.5.3.3.3.4" xref="alg1.l1.m1.5.5.5.5.3.3.4.cmml">{</mo><msup id="alg1.l1.m1.3.3.3.3.1.1.1.1" xref="alg1.l1.m1.3.3.3.3.1.1.1.1.cmml"><mi id="alg1.l1.m1.3.3.3.3.1.1.1.1.2" xref="alg1.l1.m1.3.3.3.3.1.1.1.1.2.cmml">𝐱</mi><mi id="alg1.l1.m1.3.3.3.3.1.1.1.1.3" xref="alg1.l1.m1.3.3.3.3.1.1.1.1.3.cmml">m</mi></msup><mo id="alg1.l1.m1.5.5.5.5.3.3.3.5" xref="alg1.l1.m1.5.5.5.5.3.3.4.cmml">,</mo><msup id="alg1.l1.m1.4.4.4.4.2.2.2.2" xref="alg1.l1.m1.4.4.4.4.2.2.2.2.cmml"><mi id="alg1.l1.m1.4.4.4.4.2.2.2.2.2" xref="alg1.l1.m1.4.4.4.4.2.2.2.2.2.cmml">a</mi><mi id="alg1.l1.m1.4.4.4.4.2.2.2.2.3" xref="alg1.l1.m1.4.4.4.4.2.2.2.2.3.cmml">m</mi></msup><mo id="alg1.l1.m1.5.5.5.5.3.3.3.6" xref="alg1.l1.m1.5.5.5.5.3.3.4.cmml">,</mo><msup id="alg1.l1.m1.5.5.5.5.3.3.3.3" xref="alg1.l1.m1.5.5.5.5.3.3.3.3.cmml"><mi id="alg1.l1.m1.5.5.5.5.3.3.3.3.2" xref="alg1.l1.m1.5.5.5.5.3.3.3.3.2.cmml">𝐢</mi><mi id="alg1.l1.m1.5.5.5.5.3.3.3.3.3" xref="alg1.l1.m1.5.5.5.5.3.3.3.3.3.cmml">m</mi></msup><mo stretchy="false" id="alg1.l1.m1.5.5.5.5.3.3.3.7" xref="alg1.l1.m1.5.5.5.5.3.3.4.cmml">}</mo></mrow><mrow id="alg1.l1.m1.5.5.5.5.3.5" xref="alg1.l1.m1.5.5.5.5.3.5.cmml"><mi id="alg1.l1.m1.5.5.5.5.3.5.2" xref="alg1.l1.m1.5.5.5.5.3.5.2.cmml">m</mi><mo id="alg1.l1.m1.5.5.5.5.3.5.1" xref="alg1.l1.m1.5.5.5.5.3.5.1.cmml">=</mo><mn id="alg1.l1.m1.5.5.5.5.3.5.3" xref="alg1.l1.m1.5.5.5.5.3.5.3.cmml">1</mn></mrow><mi id="alg1.l1.m1.5.5.5.5.5" xref="alg1.l1.m1.5.5.5.5.5.cmml">M</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.5b"><apply id="alg1.l1.m1.5.5.cmml" xref="alg1.l1.m1.5.5"><eq id="alg1.l1.m1.5.5.6.cmml" xref="alg1.l1.m1.5.5.6"></eq><ci id="alg1.l1.m1.5.5.7.cmml" xref="alg1.l1.m1.5.5.7">𝒟</ci><apply id="alg1.l1.m1.5.5.5.cmml" xref="alg1.l1.m1.5.5.5"><union id="alg1.l1.m1.5.5.5.6.cmml" xref="alg1.l1.m1.5.5.5.6"></union><apply id="alg1.l1.m1.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2">superscript</csymbol><apply id="alg1.l1.m1.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2">subscript</csymbol><set id="alg1.l1.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2"><apply id="alg1.l1.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="alg1.l1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="alg1.l1.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2.2">superscript</csymbol><ci id="alg1.l1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2.2.2">𝐳</ci><ci id="alg1.l1.m1.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.2.2.2.2.3">𝑛</ci></apply></set><apply id="alg1.l1.m1.2.2.2.2.2.4.cmml" xref="alg1.l1.m1.2.2.2.2.2.4"><eq id="alg1.l1.m1.2.2.2.2.2.4.1.cmml" xref="alg1.l1.m1.2.2.2.2.2.4.1"></eq><ci id="alg1.l1.m1.2.2.2.2.2.4.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.4.2">𝑛</ci><cn type="integer" id="alg1.l1.m1.2.2.2.2.2.4.3.cmml" xref="alg1.l1.m1.2.2.2.2.2.4.3">1</cn></apply></apply><ci id="alg1.l1.m1.2.2.2.2.4.cmml" xref="alg1.l1.m1.2.2.2.2.4">𝑁</ci></apply><apply id="alg1.l1.m1.5.5.5.5.cmml" xref="alg1.l1.m1.5.5.5.5"><csymbol cd="ambiguous" id="alg1.l1.m1.5.5.5.5.4.cmml" xref="alg1.l1.m1.5.5.5.5">superscript</csymbol><apply id="alg1.l1.m1.5.5.5.5.3.cmml" xref="alg1.l1.m1.5.5.5.5"><csymbol cd="ambiguous" id="alg1.l1.m1.5.5.5.5.3.4.cmml" xref="alg1.l1.m1.5.5.5.5">subscript</csymbol><set id="alg1.l1.m1.5.5.5.5.3.3.4.cmml" xref="alg1.l1.m1.5.5.5.5.3.3.3"><apply id="alg1.l1.m1.3.3.3.3.1.1.1.1.cmml" xref="alg1.l1.m1.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.3.3.1.1.1.1.1.cmml" xref="alg1.l1.m1.3.3.3.3.1.1.1.1">superscript</csymbol><ci id="alg1.l1.m1.3.3.3.3.1.1.1.1.2.cmml" xref="alg1.l1.m1.3.3.3.3.1.1.1.1.2">𝐱</ci><ci id="alg1.l1.m1.3.3.3.3.1.1.1.1.3.cmml" xref="alg1.l1.m1.3.3.3.3.1.1.1.1.3">𝑚</ci></apply><apply id="alg1.l1.m1.4.4.4.4.2.2.2.2.cmml" xref="alg1.l1.m1.4.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.4.4.4.4.2.2.2.2.1.cmml" xref="alg1.l1.m1.4.4.4.4.2.2.2.2">superscript</csymbol><ci id="alg1.l1.m1.4.4.4.4.2.2.2.2.2.cmml" xref="alg1.l1.m1.4.4.4.4.2.2.2.2.2">𝑎</ci><ci id="alg1.l1.m1.4.4.4.4.2.2.2.2.3.cmml" xref="alg1.l1.m1.4.4.4.4.2.2.2.2.3">𝑚</ci></apply><apply id="alg1.l1.m1.5.5.5.5.3.3.3.3.cmml" xref="alg1.l1.m1.5.5.5.5.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.5.5.5.5.3.3.3.3.1.cmml" xref="alg1.l1.m1.5.5.5.5.3.3.3.3">superscript</csymbol><ci id="alg1.l1.m1.5.5.5.5.3.3.3.3.2.cmml" xref="alg1.l1.m1.5.5.5.5.3.3.3.3.2">𝐢</ci><ci id="alg1.l1.m1.5.5.5.5.3.3.3.3.3.cmml" xref="alg1.l1.m1.5.5.5.5.3.3.3.3.3">𝑚</ci></apply></set><apply id="alg1.l1.m1.5.5.5.5.3.5.cmml" xref="alg1.l1.m1.5.5.5.5.3.5"><eq id="alg1.l1.m1.5.5.5.5.3.5.1.cmml" xref="alg1.l1.m1.5.5.5.5.3.5.1"></eq><ci id="alg1.l1.m1.5.5.5.5.3.5.2.cmml" xref="alg1.l1.m1.5.5.5.5.3.5.2">𝑚</ci><cn type="integer" id="alg1.l1.m1.5.5.5.5.3.5.3.cmml" xref="alg1.l1.m1.5.5.5.5.3.5.3">1</cn></apply></apply><ci id="alg1.l1.m1.5.5.5.5.5.cmml" xref="alg1.l1.m1.5.5.5.5.5">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.5c">\mathcal{D}=\{\mathbf{x}^{n},\mathbf{z}^{n}\}_{n=1}^{N}\cup\{\mathbf{x}^{m},a^{m},\mathbf{i}^{m}\}_{m=1}^{M}</annotation></semantics></math>, <math id="alg1.l1.m2.1" class="ltx_Math" alttext="p(\mathbf{z})" display="inline"><semantics id="alg1.l1.m2.1a"><mrow id="alg1.l1.m2.1.2" xref="alg1.l1.m2.1.2.cmml"><mi id="alg1.l1.m2.1.2.2" xref="alg1.l1.m2.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m2.1.2.1" xref="alg1.l1.m2.1.2.1.cmml">​</mo><mrow id="alg1.l1.m2.1.2.3.2" xref="alg1.l1.m2.1.2.cmml"><mo stretchy="false" id="alg1.l1.m2.1.2.3.2.1" xref="alg1.l1.m2.1.2.cmml">(</mo><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">𝐳</mi><mo stretchy="false" id="alg1.l1.m2.1.2.3.2.2" xref="alg1.l1.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.2.cmml" xref="alg1.l1.m2.1.2"><times id="alg1.l1.m2.1.2.1.cmml" xref="alg1.l1.m2.1.2.1"></times><ci id="alg1.l1.m2.1.2.2.cmml" xref="alg1.l1.m2.1.2.2">𝑝</ci><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">p(\mathbf{z})</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">Initialize:</span> <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\theta_{\mathcal{Z}}" display="inline"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">𝒵</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝜃</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\theta_{\mathcal{Z}}</annotation></semantics></math>, <math id="alg1.l2.m2.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">\sigma</annotation></semantics></math>, <math id="alg1.l2.m3.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="alg1.l2.m3.1a"><mi id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><ci id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">\phi</annotation></semantics></math>
</div>
<div id="alg1.l3" class="ltx_listingline">  <span id="alg1.l3.3" class="ltx_text ltx_font_bold">Set:</span> <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\beta&lt;1" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi mathcolor="#000000" id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">β</mi><mo mathcolor="#000000" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">&lt;</mo><mn mathcolor="#000000" id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><lt id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></lt><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝛽</ci><cn type="integer" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\beta&lt;1</annotation></semantics></math><span id="alg1.l3.2" class="ltx_text" style="color:#000000;">, <math id="alg1.l3.1.m1.1" class="ltx_Math" alttext="\alpha&gt;1" display="inline"><semantics id="alg1.l3.1.m1.1a"><mrow id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml"><mi mathcolor="#000000" id="alg1.l3.1.m1.1.1.2" xref="alg1.l3.1.m1.1.1.2.cmml">α</mi><mo mathcolor="#000000" id="alg1.l3.1.m1.1.1.1" xref="alg1.l3.1.m1.1.1.1.cmml">&gt;</mo><mn mathcolor="#000000" id="alg1.l3.1.m1.1.1.3" xref="alg1.l3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><apply id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1"><gt id="alg1.l3.1.m1.1.1.1.cmml" xref="alg1.l3.1.m1.1.1.1"></gt><ci id="alg1.l3.1.m1.1.1.2.cmml" xref="alg1.l3.1.m1.1.1.2">𝛼</ci><cn type="integer" id="alg1.l3.1.m1.1.1.3.cmml" xref="alg1.l3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\alpha&gt;1</annotation></semantics></math>, <math id="alg1.l3.2.m2.1" class="ltx_Math" alttext="\gamma&gt;1" display="inline"><semantics id="alg1.l3.2.m2.1a"><mrow id="alg1.l3.2.m2.1.1" xref="alg1.l3.2.m2.1.1.cmml"><mi mathcolor="#000000" id="alg1.l3.2.m2.1.1.2" xref="alg1.l3.2.m2.1.1.2.cmml">γ</mi><mo mathcolor="#000000" id="alg1.l3.2.m2.1.1.1" xref="alg1.l3.2.m2.1.1.1.cmml">&gt;</mo><mn mathcolor="#000000" id="alg1.l3.2.m2.1.1.3" xref="alg1.l3.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.2.m2.1b"><apply id="alg1.l3.2.m2.1.1.cmml" xref="alg1.l3.2.m2.1.1"><gt id="alg1.l3.2.m2.1.1.1.cmml" xref="alg1.l3.2.m2.1.1.1"></gt><ci id="alg1.l3.2.m2.1.1.2.cmml" xref="alg1.l3.2.m2.1.1.2">𝛾</ci><cn type="integer" id="alg1.l3.2.m2.1.1.3.cmml" xref="alg1.l3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.2.m2.1c">\gamma&gt;1</annotation></semantics></math></span><span id="alg1.l3.4" class="ltx_text ltx_font_bold">Question Coding</span>

</div>
<div id="alg1.l4" class="ltx_listingline">  Estimate <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\sigma</annotation></semantics></math>, <math id="alg1.l4.m2.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="alg1.l4.m2.1a"><mi id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\phi</annotation></semantics></math> optimizing <a href="#S2.E1" title="In 2.2 Learning ‣ 2 Methods ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">1</span></a> <math id="alg1.l4.m3.1" class="ltx_Math" alttext="+" display="inline"><semantics id="alg1.l4.m3.1a"><mo id="alg1.l4.m3.1.1" xref="alg1.l4.m3.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.m3.1b"><plus id="alg1.l4.m3.1.1.cmml" xref="alg1.l4.m3.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m3.1c">+</annotation></semantics></math> <a href="#S2.E3" title="In 2.2 Learning ‣ 2 Methods ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">3</span></a><span id="alg1.l4.1" class="ltx_text ltx_font_bold">Module Training</span>

</div>
<div id="alg1.l5" class="ltx_listingline">  Estimate <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\theta_{\mathcal{Z}}" display="inline"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">𝒵</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝜃</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\theta_{\mathcal{Z}}</annotation></semantics></math> optimizing <a href="#S2.E5" title="In 2.2 Learning ‣ 2 Methods ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">5</span></a><span id="alg1.l5.1" class="ltx_text ltx_font_bold">Joint Training</span>

</div>
<div id="alg1.l6" class="ltx_listingline">  Estimate <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\theta_{\mathcal{Z}}" display="inline"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">𝒵</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝜃</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\theta_{\mathcal{Z}}</annotation></semantics></math>, <math id="alg1.l6.m2.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="alg1.l6.m2.1a"><mi id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><ci id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">\sigma</annotation></semantics></math>, <math id="alg1.l6.m3.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="alg1.l6.m3.1a"><mi id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b"><ci id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.1c">\phi</annotation></semantics></math> <span id="alg1.l6.1" class="ltx_text" style="color:#000000;">optimizing <a href="#S2.E6" title="In 2.2 Learning ‣ 2 Methods ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">6</span></a></span>

</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.3" class="ltx_p ltx_figure_panel"><span id="alg1.3.1" class="ltx_text ltx_font_bold">Note:</span> Updates to <math id="alg1.1.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">\phi</annotation></semantics></math> from <a href="#S2.E1" title="In 2.2 Learning ‣ 2 Methods ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S2.E4" title="In 2.2 Learning ‣ 2 Methods ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">4</span></a>
happen via. score function estimator, and the path derivative.
Updates to <math id="alg1.2.m2.1" class="ltx_Math" alttext="\theta_{\mathcal{Z}}" display="inline"><semantics id="alg1.2.m2.1a"><msub id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml"><mi id="alg1.2.m2.1.1.2" xref="alg1.2.m2.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="alg1.2.m2.1.1.3" xref="alg1.2.m2.1.1.3.cmml">𝒵</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><apply id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.2.m2.1.1.1.cmml" xref="alg1.2.m2.1.1">subscript</csymbol><ci id="alg1.2.m2.1.1.2.cmml" xref="alg1.2.m2.1.1.2">𝜃</ci><ci id="alg1.2.m2.1.1.3.cmml" xref="alg1.2.m2.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">\theta_{\mathcal{Z}}</annotation></semantics></math>, <math id="alg1.3.m3.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="alg1.3.m3.1a"><mi id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">\sigma</annotation></semantics></math> are computed using the gradient.</p>
</div>
</div>
</figure>
<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.6" class="ltx_p">In this section, we outline the difficulties that arise when we try to optimize
 <a href="#S2.E6" title="In 2.2 Learning ‣ 2 Methods ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">6</span></a> directly, without following the three stage procedure.
Let us consider question coding – if we do not do question coding independently
of the answer, learning the parameters <math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="\theta_{z}" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><msub id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">θ</mi><mi id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝜃</ci><ci id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">\theta_{z}</annotation></semantics></math> of the neural module network becomes
difficult, especially when <math id="S2.SS3.p1.2.m2.1" class="ltx_Math" alttext="N&lt;&lt;M" display="inline"><semantics id="S2.SS3.p1.2.m2.1a"><mrow id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mi id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml">N</mi><mo id="S2.SS3.p1.2.m2.1.1.1" xref="S2.SS3.p1.2.m2.1.1.1.cmml">&lt;&lt;</mo><mi id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><csymbol cd="latexml" id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1.1">much-less-than</csymbol><ci id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2">𝑁</ci><ci id="S2.SS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">N&lt;&lt;M</annotation></semantics></math> as the mapping <math id="S2.SS3.p1.3.m3.3" class="ltx_Math" alttext="p(a|\mathbf{z},\mathbf{i})" display="inline"><semantics id="S2.SS3.p1.3.m3.3a"><mrow id="S2.SS3.p1.3.m3.3.3" xref="S2.SS3.p1.3.m3.3.3.cmml"><mi id="S2.SS3.p1.3.m3.3.3.3" xref="S2.SS3.p1.3.m3.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p1.3.m3.3.3.2" xref="S2.SS3.p1.3.m3.3.3.2.cmml">​</mo><mrow id="S2.SS3.p1.3.m3.3.3.1.1" xref="S2.SS3.p1.3.m3.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.p1.3.m3.3.3.1.1.2" xref="S2.SS3.p1.3.m3.3.3.1.1.1.cmml">(</mo><mrow id="S2.SS3.p1.3.m3.3.3.1.1.1" xref="S2.SS3.p1.3.m3.3.3.1.1.1.cmml"><mi id="S2.SS3.p1.3.m3.3.3.1.1.1.2" xref="S2.SS3.p1.3.m3.3.3.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.SS3.p1.3.m3.3.3.1.1.1.1" xref="S2.SS3.p1.3.m3.3.3.1.1.1.1.cmml">|</mo><mrow id="S2.SS3.p1.3.m3.3.3.1.1.1.3.2" xref="S2.SS3.p1.3.m3.3.3.1.1.1.3.1.cmml"><mi id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml">𝐳</mi><mo id="S2.SS3.p1.3.m3.3.3.1.1.1.3.2.1" xref="S2.SS3.p1.3.m3.3.3.1.1.1.3.1.cmml">,</mo><mi id="S2.SS3.p1.3.m3.2.2" xref="S2.SS3.p1.3.m3.2.2.cmml">𝐢</mi></mrow></mrow><mo stretchy="false" id="S2.SS3.p1.3.m3.3.3.1.1.3" xref="S2.SS3.p1.3.m3.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.3b"><apply id="S2.SS3.p1.3.m3.3.3.cmml" xref="S2.SS3.p1.3.m3.3.3"><times id="S2.SS3.p1.3.m3.3.3.2.cmml" xref="S2.SS3.p1.3.m3.3.3.2"></times><ci id="S2.SS3.p1.3.m3.3.3.3.cmml" xref="S2.SS3.p1.3.m3.3.3.3">𝑝</ci><apply id="S2.SS3.p1.3.m3.3.3.1.1.1.cmml" xref="S2.SS3.p1.3.m3.3.3.1.1"><csymbol cd="latexml" id="S2.SS3.p1.3.m3.3.3.1.1.1.1.cmml" xref="S2.SS3.p1.3.m3.3.3.1.1.1.1">conditional</csymbol><ci id="S2.SS3.p1.3.m3.3.3.1.1.1.2.cmml" xref="S2.SS3.p1.3.m3.3.3.1.1.1.2">𝑎</ci><list id="S2.SS3.p1.3.m3.3.3.1.1.1.3.1.cmml" xref="S2.SS3.p1.3.m3.3.3.1.1.1.3.2"><ci id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1">𝐳</ci><ci id="S2.SS3.p1.3.m3.2.2.cmml" xref="S2.SS3.p1.3.m3.2.2">𝐢</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.3c">p(a|\mathbf{z},\mathbf{i})</annotation></semantics></math>
is implemented using neural modules <math id="S2.SS3.p1.4.m4.1" class="ltx_Math" alttext="p_{\theta_{z}}(a|\mathbf{i})" display="inline"><semantics id="S2.SS3.p1.4.m4.1a"><mrow id="S2.SS3.p1.4.m4.1.1" xref="S2.SS3.p1.4.m4.1.1.cmml"><msub id="S2.SS3.p1.4.m4.1.1.3" xref="S2.SS3.p1.4.m4.1.1.3.cmml"><mi id="S2.SS3.p1.4.m4.1.1.3.2" xref="S2.SS3.p1.4.m4.1.1.3.2.cmml">p</mi><msub id="S2.SS3.p1.4.m4.1.1.3.3" xref="S2.SS3.p1.4.m4.1.1.3.3.cmml"><mi id="S2.SS3.p1.4.m4.1.1.3.3.2" xref="S2.SS3.p1.4.m4.1.1.3.3.2.cmml">θ</mi><mi id="S2.SS3.p1.4.m4.1.1.3.3.3" xref="S2.SS3.p1.4.m4.1.1.3.3.3.cmml">z</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.4.m4.1.1.2" xref="S2.SS3.p1.4.m4.1.1.2.cmml">​</mo><mrow id="S2.SS3.p1.4.m4.1.1.1.1" xref="S2.SS3.p1.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.p1.4.m4.1.1.1.1.2" xref="S2.SS3.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p1.4.m4.1.1.1.1.1" xref="S2.SS3.p1.4.m4.1.1.1.1.1.cmml"><mi id="S2.SS3.p1.4.m4.1.1.1.1.1.2" xref="S2.SS3.p1.4.m4.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.SS3.p1.4.m4.1.1.1.1.1.1" xref="S2.SS3.p1.4.m4.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS3.p1.4.m4.1.1.1.1.1.3" xref="S2.SS3.p1.4.m4.1.1.1.1.1.3.cmml">𝐢</mi></mrow><mo stretchy="false" id="S2.SS3.p1.4.m4.1.1.1.1.3" xref="S2.SS3.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m4.1b"><apply id="S2.SS3.p1.4.m4.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1"><times id="S2.SS3.p1.4.m4.1.1.2.cmml" xref="S2.SS3.p1.4.m4.1.1.2"></times><apply id="S2.SS3.p1.4.m4.1.1.3.cmml" xref="S2.SS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.1.3.1.cmml" xref="S2.SS3.p1.4.m4.1.1.3">subscript</csymbol><ci id="S2.SS3.p1.4.m4.1.1.3.2.cmml" xref="S2.SS3.p1.4.m4.1.1.3.2">𝑝</ci><apply id="S2.SS3.p1.4.m4.1.1.3.3.cmml" xref="S2.SS3.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.1.1.3.3.1.cmml" xref="S2.SS3.p1.4.m4.1.1.3.3">subscript</csymbol><ci id="S2.SS3.p1.4.m4.1.1.3.3.2.cmml" xref="S2.SS3.p1.4.m4.1.1.3.3.2">𝜃</ci><ci id="S2.SS3.p1.4.m4.1.1.3.3.3.cmml" xref="S2.SS3.p1.4.m4.1.1.3.3.3">𝑧</ci></apply></apply><apply id="S2.SS3.p1.4.m4.1.1.1.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1.1.1"><csymbol cd="latexml" id="S2.SS3.p1.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS3.p1.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS3.p1.4.m4.1.1.1.1.1.2">𝑎</ci><ci id="S2.SS3.p1.4.m4.1.1.1.1.1.3.cmml" xref="S2.SS3.p1.4.m4.1.1.1.1.1.3">𝐢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m4.1c">p_{\theta_{z}}(a|\mathbf{i})</annotation></semantics></math>. This optimization
is discrete in the program choices, which hurts when <math id="S2.SS3.p1.5.m5.1" class="ltx_Math" alttext="q_{\phi}" display="inline"><semantics id="S2.SS3.p1.5.m5.1a"><msub id="S2.SS3.p1.5.m5.1.1" xref="S2.SS3.p1.5.m5.1.1.cmml"><mi id="S2.SS3.p1.5.m5.1.1.2" xref="S2.SS3.p1.5.m5.1.1.2.cmml">q</mi><mi id="S2.SS3.p1.5.m5.1.1.3" xref="S2.SS3.p1.5.m5.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m5.1b"><apply id="S2.SS3.p1.5.m5.1.1.cmml" xref="S2.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.5.m5.1.1.1.cmml" xref="S2.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS3.p1.5.m5.1.1.2.cmml" xref="S2.SS3.p1.5.m5.1.1.2">𝑞</ci><ci id="S2.SS3.p1.5.m5.1.1.3.cmml" xref="S2.SS3.p1.5.m5.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m5.1c">q_{\phi}</annotation></semantics></math> is
uncertain (or has not converged). Next, training the joint model without
first running module training is possible, but trickier, because
the gradient from an untrained neural module network would pass
into the <math id="S2.SS3.p1.6.m6.1" class="ltx_Math" alttext="q_{\phi}(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S2.SS3.p1.6.m6.1a"><mrow id="S2.SS3.p1.6.m6.1.1" xref="S2.SS3.p1.6.m6.1.1.cmml"><msub id="S2.SS3.p1.6.m6.1.1.3" xref="S2.SS3.p1.6.m6.1.1.3.cmml"><mi id="S2.SS3.p1.6.m6.1.1.3.2" xref="S2.SS3.p1.6.m6.1.1.3.2.cmml">q</mi><mi id="S2.SS3.p1.6.m6.1.1.3.3" xref="S2.SS3.p1.6.m6.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.6.m6.1.1.2" xref="S2.SS3.p1.6.m6.1.1.2.cmml">​</mo><mrow id="S2.SS3.p1.6.m6.1.1.1.1" xref="S2.SS3.p1.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.p1.6.m6.1.1.1.1.2" xref="S2.SS3.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p1.6.m6.1.1.1.1.1" xref="S2.SS3.p1.6.m6.1.1.1.1.1.cmml"><mi id="S2.SS3.p1.6.m6.1.1.1.1.1.2" xref="S2.SS3.p1.6.m6.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S2.SS3.p1.6.m6.1.1.1.1.1.1" xref="S2.SS3.p1.6.m6.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS3.p1.6.m6.1.1.1.1.1.3" xref="S2.SS3.p1.6.m6.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S2.SS3.p1.6.m6.1.1.1.1.3" xref="S2.SS3.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m6.1b"><apply id="S2.SS3.p1.6.m6.1.1.cmml" xref="S2.SS3.p1.6.m6.1.1"><times id="S2.SS3.p1.6.m6.1.1.2.cmml" xref="S2.SS3.p1.6.m6.1.1.2"></times><apply id="S2.SS3.p1.6.m6.1.1.3.cmml" xref="S2.SS3.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.6.m6.1.1.3.1.cmml" xref="S2.SS3.p1.6.m6.1.1.3">subscript</csymbol><ci id="S2.SS3.p1.6.m6.1.1.3.2.cmml" xref="S2.SS3.p1.6.m6.1.1.3.2">𝑞</ci><ci id="S2.SS3.p1.6.m6.1.1.3.3.cmml" xref="S2.SS3.p1.6.m6.1.1.3.3">italic-ϕ</ci></apply><apply id="S2.SS3.p1.6.m6.1.1.1.1.1.cmml" xref="S2.SS3.p1.6.m6.1.1.1.1"><csymbol cd="latexml" id="S2.SS3.p1.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS3.p1.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS3.p1.6.m6.1.1.1.1.1.2">𝐳</ci><ci id="S2.SS3.p1.6.m6.1.1.1.1.1.3.cmml" xref="S2.SS3.p1.6.m6.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.6.m6.1c">q_{\phi}(\mathbf{z}|\mathbf{x})</annotation></semantics></math> inference network, adding noise to the updates.
Indeed, we find that inference often deteriorates when trained with
REINFORCE on a reward computed from an untrained network (<a href="#S5.T1" title="In 5 Results ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Related Work</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We first explain differences with other discrete structured latent variable
models proposed in the literature. We then connect our work to the broader
context of research in reasoning and visual question answering (VQA)
and conclude by discussing interpretability in the context of VQA.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p"><span id="S3.p2.1.2" class="ltx_text ltx_font_bold">Discrete Structured Latent Variables.</span>
<span id="S3.p2.1.3" class="ltx_text" style="color:#000000;">Previous works have applied amortized variational inference <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Welling, <a href="#bib.bib22" title="" class="ltx_ref">2014</a>; Rezende et al., <a href="#bib.bib38" title="" class="ltx_ref">2014</a>)</cite>
to build discrete, structured latent variable models, where the observations as well as the latents are either
sequences <cite class="ltx_cite ltx_citemacro_citep">(Miao &amp; Blunsom, <a href="#bib.bib32" title="" class="ltx_ref">2016</a>)</cite> or tree structured programs <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a href="#bib.bib53" title="" class="ltx_ref">2018</a>)</cite>.</span> While <cite class="ltx_cite ltx_citemacro_citet">Yin et al. (<a href="#bib.bib53" title="" class="ltx_ref">2018</a>)</cite> consider the
problem of parsing text into programs, <cite class="ltx_cite ltx_citemacro_citet">Miao &amp; Blunsom (<a href="#bib.bib32" title="" class="ltx_ref">2016</a>)</cite>
generate (textual) summaries using a latent variable <cite class="ltx_cite ltx_citemacro_citep">(Miao &amp; Blunsom, <a href="#bib.bib32" title="" class="ltx_ref">2016</a>)</cite>. In contrast,
<span id="S3.p2.1.1" class="ltx_text" style="color:#000000;">our joint model
is richer since in addition to parsing, we also learn to decode a latent program
into answers by executing neural modules <math id="S3.p2.1.1.m1.1" class="ltx_Math" alttext="\theta_{\mathbf{z}}" display="inline"><semantics id="S3.p2.1.1.m1.1a"><msub id="S3.p2.1.1.m1.1.1" xref="S3.p2.1.1.m1.1.1.cmml"><mi mathcolor="#000000" id="S3.p2.1.1.m1.1.1.2" xref="S3.p2.1.1.m1.1.1.2.cmml">θ</mi><mi mathcolor="#000000" id="S3.p2.1.1.m1.1.1.3" xref="S3.p2.1.1.m1.1.1.3.cmml">𝐳</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.1.m1.1b"><apply id="S3.p2.1.1.m1.1.1.cmml" xref="S3.p2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.1.m1.1.1.1.cmml" xref="S3.p2.1.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.1.m1.1.1.2.cmml" xref="S3.p2.1.1.m1.1.1.2">𝜃</ci><ci id="S3.p2.1.1.m1.1.1.3.cmml" xref="S3.p2.1.1.m1.1.1.3">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.1.m1.1c">\theta_{\mathbf{z}}</annotation></semantics></math>.</span> Finally,
as discussed in <a href="#S2" title="2 Methods ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">2</span></a>, our derivation for the lower bound
on the question-program evidence provides some understanding of the objectives used
in these prior works for semi-supervised learning <cite class="ltx_cite ltx_citemacro_citep">(Yin et al., <a href="#bib.bib53" title="" class="ltx_ref">2018</a>; Miao &amp; Blunsom, <a href="#bib.bib32" title="" class="ltx_ref">2016</a>)</cite>.</p>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.2" class="ltx_p"><span id="S3.p3.2.1" class="ltx_text ltx_font_bold">Visual Question Answering and Reasoning.</span> A number of approaches have studied
visual question answering, motivated to study multi-hop reasoning
 <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>, <a href="#bib.bib17" title="" class="ltx_ref">2018</a>; Hudson &amp; Manning, <a href="#bib.bib18" title="" class="ltx_ref">2018</a>; Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>; Perez et al., <a href="#bib.bib37" title="" class="ltx_ref">2018</a>; Santoro et al., <a href="#bib.bib39" title="" class="ltx_ref">2017</a>; Yi et al., <a href="#bib.bib52" title="" class="ltx_ref">2018</a>)</cite>. Some of these
works build in implicit, non-symbolic inductive biases to support compositional
reasoning into the network <cite class="ltx_cite ltx_citemacro_citep">(Hudson &amp; Manning, <a href="#bib.bib18" title="" class="ltx_ref">2018</a>; Hu et al., <a href="#bib.bib17" title="" class="ltx_ref">2018</a>; Perez et al., <a href="#bib.bib37" title="" class="ltx_ref">2018</a>)</cite>, while others
take a more explicit symbolic approach <cite class="ltx_cite ltx_citemacro_citep">(Yi et al., <a href="#bib.bib52" title="" class="ltx_ref">2018</a>; Hu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>; Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>; Mascharka et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>; Yi et al., <a href="#bib.bib52" title="" class="ltx_ref">2018</a>)</cite>.
Our high level goal is centered around providing legible explanations and reasoning
traces for programs, and thus, we adopt a symbolic approach. Even in the realm of symbols,
different approaches utilize different kind of inductive biases in the mapping from
symbols (programs) to answer. While <cite class="ltx_cite ltx_citemacro_citet">Yi et al. (<a href="#bib.bib52" title="" class="ltx_ref">2018</a>)</cite> favor an approach that represents
objects in a scene with a vectorized representation, and compute various operations
as manipulations of the vectors, other works take a more modular approach
 <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>; Hu et al., <a href="#bib.bib17" title="" class="ltx_ref">2018</a>; Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>; Mascharka et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite> where a set of symbols <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\{z\}" display="inline"><semantics id="S3.p3.1.m1.1a"><mrow id="S3.p3.1.m1.1.2.2" xref="S3.p3.1.m1.1.2.1.cmml"><mo stretchy="false" id="S3.p3.1.m1.1.2.2.1" xref="S3.p3.1.m1.1.2.1.cmml">{</mo><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">z</mi><mo stretchy="false" id="S3.p3.1.m1.1.2.2.2" xref="S3.p3.1.m1.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><set id="S3.p3.1.m1.1.2.1.cmml" xref="S3.p3.1.m1.1.2.2"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝑧</ci></set></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\{z\}</annotation></semantics></math>
intsantiate neural networks with parameters <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="\theta_{\{z\}}" display="inline"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.2" xref="S3.p3.2.m2.1.2.cmml"><mi id="S3.p3.2.m2.1.2.2" xref="S3.p3.2.m2.1.2.2.cmml">θ</mi><mrow id="S3.p3.2.m2.1.1.1.3" xref="S3.p3.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.p3.2.m2.1.1.1.3.1" xref="S3.p3.2.m2.1.1.1.2.cmml">{</mo><mi id="S3.p3.2.m2.1.1.1.1" xref="S3.p3.2.m2.1.1.1.1.cmml">z</mi><mo stretchy="false" id="S3.p3.2.m2.1.1.1.3.2" xref="S3.p3.2.m2.1.1.1.2.cmml">}</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.2.cmml" xref="S3.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.2.1.cmml" xref="S3.p3.2.m2.1.2">subscript</csymbol><ci id="S3.p3.2.m2.1.2.2.cmml" xref="S3.p3.2.m2.1.2.2">𝜃</ci><set id="S3.p3.2.m2.1.1.1.2.cmml" xref="S3.p3.2.m2.1.1.1.3"><ci id="S3.p3.2.m2.1.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1.1">𝑧</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\theta_{\{z\}}</annotation></semantics></math>. We study the latter
approach since it is arguably more general and could conceivably transfer better
to other tasks such as planning and control <cite class="ltx_cite ltx_citemacro_citep">(Das et al., <a href="#bib.bib10" title="" class="ltx_ref">2018</a>)</cite>, lifelong learning
 <cite class="ltx_cite ltx_citemacro_citep">(Gaunt et al., <a href="#bib.bib13" title="" class="ltx_ref">2017</a>; Valkov et al., <a href="#bib.bib45" title="" class="ltx_ref">2018</a>)</cite> <em id="S3.p3.2.2" class="ltx_emph ltx_font_italic">etc.</em></p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.1" class="ltx_p">Different from all these
prior works, we provide a probabilistic scaffolding that embeds previous neural-symbolic
models, which we conceptualize should lead to better data-efficient legibility and
the ability to debug coherence and sensitivity in reasoning. <span id="S3.p4.1.1" class="ltx_text" style="color:#000000;">
We are not aware of any prior work on VQA where it is possible to reason about
coherence or sensitivity of the reasoning performed by the model.</span></p>
</div>
<div id="S3.p5" class="ltx_para ltx_noindent">
<p id="S3.p5.1" class="ltx_p"><span id="S3.p5.1.1" class="ltx_text ltx_font_bold">Interpretable VQA.</span> Given its importance as a scene understanding task, and as
a general benchmark for reasoning, there has been a lot of work in trying to interpret
VQA systems and explain their decisions <cite class="ltx_cite ltx_citemacro_citep">(Das et al., <a href="#bib.bib9" title="" class="ltx_ref">2016</a>; Lu et al., <a href="#bib.bib28" title="" class="ltx_ref">2016</a>; Park et al., <a href="#bib.bib36" title="" class="ltx_ref">2018</a>; Selvaraju et al., <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite>.
Interpretability approaches typically either perform some kind of explicit attention <cite class="ltx_cite ltx_citemacro_citep">(Bahdanau et al., <a href="#bib.bib6" title="" class="ltx_ref">2015</a>)</cite>
over the question or the image <cite class="ltx_cite ltx_citemacro_citep">(Lu et al., <a href="#bib.bib28" title="" class="ltx_ref">2016</a>)</cite> to explain with a heat map the regions or parts
of the question the model used to arrive at an answer. Some other works develop post-hoc attribution
techniques <cite class="ltx_cite ltx_citemacro_citep">(Mudrakarta et al., <a href="#bib.bib34" title="" class="ltx_ref">2018</a>; Selvaraju et al., <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite> for providing explanations.
In this work, we are interested in an orthogonal
notion of interpretability, in terms of the legibility of the reasoning process used by the network given
symbolic instructions for a subset of examples.
More similar to our high-level motivation are approaches which take
a neural-symbolic approach, providing explanations in terms of programs used for reasoning about a question
 <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>; Hu et al., <a href="#bib.bib17" title="" class="ltx_ref">2018</a>)</cite>, optionally including a spatial attention over the image to localize the
function of the modules <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>; Hu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>; Mascharka et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite>. In this work we augment the legibility
of the programs/reasoning from these approaches.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Setup</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text ltx_font_bold">Dataset.</span> We report our results on the <span id="S4.p1.1.2" class="ltx_text" style="color:#000000;">CLEVR <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite> dataset</span>
and the SHAPES datasets
 <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>)</cite>. <span id="S4.p1.1.3" class="ltx_text" style="color:#000000;">The CLEVR dataset has been extensively used as a benchmark for
testing reasoning in VQA models in various prior
works <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>, <a href="#bib.bib17" title="" class="ltx_ref">2018</a>; Hudson &amp; Manning, <a href="#bib.bib18" title="" class="ltx_ref">2018</a>; Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>; Perez et al., <a href="#bib.bib37" title="" class="ltx_ref">2018</a>; Santoro et al., <a href="#bib.bib39" title="" class="ltx_ref">2017</a>)</cite>
and is composed of 70,000 images and around 700K questions, answers and functional programs in the training set,
and 15,000 images and 150K questions in the validation set.
We choose first 20K examples from CLEVR v1.0 validation set and
use it as our val set. We report results on CLEVR v1.0 test set using the CLEVR evaluation
server on EvalAI <cite class="ltx_cite ltx_citemacro_citep">(Yadav et al., <a href="#bib.bib51" title="" class="ltx_ref">2019</a>)</cite>. The longest questions in the dataset are of
length 44 while the longest programs are of length 25. The question vocabulary has 89 tokens
while the program vocabulary has 40 tokens, with 28 possible answers.</span></p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.3" class="ltx_p">We investigate our design choices on the smaller
SHAPES dataset proposed in previous works <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>; Hu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>)</cite> for
visual question answering. The dataset is explicitly designed to test
for compositional reasoning, and contains compositionally novel questions
that the model must demonstrate generalization to
at test time. Overall there are 244 unique
questions with <span id="S4.p2.3.1" class="ltx_text ltx_font_typewriter">yes</span>/<span id="S4.p2.3.2" class="ltx_text ltx_font_typewriter">no</span> answers and 15,616 images <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>)</cite>.
The dataset
also has annotated programs for each of the questions.
We use train, val, and test splits of 13,568, 1,024, and 1,024
<math id="S4.p2.1.m1.4" class="ltx_Math" alttext="(\mathbf{x},\mathbf{z},\mathbf{i},\mathbf{a})" display="inline"><semantics id="S4.p2.1.m1.4a"><mrow id="S4.p2.1.m1.4.5.2" xref="S4.p2.1.m1.4.5.1.cmml"><mo stretchy="false" id="S4.p2.1.m1.4.5.2.1" xref="S4.p2.1.m1.4.5.1.cmml">(</mo><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">𝐱</mi><mo id="S4.p2.1.m1.4.5.2.2" xref="S4.p2.1.m1.4.5.1.cmml">,</mo><mi id="S4.p2.1.m1.2.2" xref="S4.p2.1.m1.2.2.cmml">𝐳</mi><mo id="S4.p2.1.m1.4.5.2.3" xref="S4.p2.1.m1.4.5.1.cmml">,</mo><mi id="S4.p2.1.m1.3.3" xref="S4.p2.1.m1.3.3.cmml">𝐢</mi><mo id="S4.p2.1.m1.4.5.2.4" xref="S4.p2.1.m1.4.5.1.cmml">,</mo><mi id="S4.p2.1.m1.4.4" xref="S4.p2.1.m1.4.4.cmml">𝐚</mi><mo stretchy="false" id="S4.p2.1.m1.4.5.2.5" xref="S4.p2.1.m1.4.5.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.4b"><vector id="S4.p2.1.m1.4.5.1.cmml" xref="S4.p2.1.m1.4.5.2"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝐱</ci><ci id="S4.p2.1.m1.2.2.cmml" xref="S4.p2.1.m1.2.2">𝐳</ci><ci id="S4.p2.1.m1.3.3.cmml" xref="S4.p2.1.m1.3.3">𝐢</ci><ci id="S4.p2.1.m1.4.4.cmml" xref="S4.p2.1.m1.4.4">𝐚</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.4c">(\mathbf{x},\mathbf{z},\mathbf{i},\mathbf{a})</annotation></semantics></math> triplets respectively.
The longest questions in the dataset are of length 11 and shortest
are of length 4, while the longest programs are of length 6 and shortest
programs are of length 4. The size of the question vocabulary <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S4.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><ci id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">\mathcal{X}</annotation></semantics></math> is
14 and the program vocabulary <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S4.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><ci id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">\mathcal{Z}</annotation></semantics></math> is 12.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.1" class="ltx_p"><span id="S4.p3.1.1" class="ltx_text ltx_font_bold">Training.</span> On SHAPES, to simulate a data-sparse regime,
we restrict the set of question-aligned programs to
5, 10, 15, or 20% of unique questions – such that even
at the highest level of supervision, programs for
80% of unique questions have never been seen during training.
We train our program prior using a set of 1848 unique
programs simulated from the syntax (more details of this can be seen in the
Appendix).</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.2" class="ltx_p">In general, we find that performance at a given amount of supervision can be quite
variable. In addition, we also find
question coding, and module training stages tend to show
a fair amount of variance across multiple runs. To make fair comparisons, for every
experiment, we run question coding across 5 different runs, pick the best performing
model, and then run module training (updating <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="\theta_{\mathcal{Z}}" display="inline"><semantics id="S4.p4.1.m1.1a"><msub id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml"><mi id="S4.p4.1.m1.1.1.2" xref="S4.p4.1.m1.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.p4.1.m1.1.1.3" xref="S4.p4.1.m1.1.1.3.cmml">𝒵</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p4.1.m1.1.1.1.cmml" xref="S4.p4.1.m1.1.1">subscript</csymbol><ci id="S4.p4.1.m1.1.1.2.cmml" xref="S4.p4.1.m1.1.1.2">𝜃</ci><ci id="S4.p4.1.m1.1.1.3.cmml" xref="S4.p4.1.m1.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">\theta_{\mathcal{Z}}</annotation></semantics></math>) across 10 different
runs. Next, we run the best model from this stage for joint training (sweeping across
values of <math id="S4.p4.2.m2.3" class="ltx_Math" alttext="\gamma\in\{1,10,100\}" display="inline"><semantics id="S4.p4.2.m2.3a"><mrow id="S4.p4.2.m2.3.4" xref="S4.p4.2.m2.3.4.cmml"><mi id="S4.p4.2.m2.3.4.2" xref="S4.p4.2.m2.3.4.2.cmml">γ</mi><mo id="S4.p4.2.m2.3.4.1" xref="S4.p4.2.m2.3.4.1.cmml">∈</mo><mrow id="S4.p4.2.m2.3.4.3.2" xref="S4.p4.2.m2.3.4.3.1.cmml"><mo stretchy="false" id="S4.p4.2.m2.3.4.3.2.1" xref="S4.p4.2.m2.3.4.3.1.cmml">{</mo><mn id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml">1</mn><mo id="S4.p4.2.m2.3.4.3.2.2" xref="S4.p4.2.m2.3.4.3.1.cmml">,</mo><mn id="S4.p4.2.m2.2.2" xref="S4.p4.2.m2.2.2.cmml">10</mn><mo id="S4.p4.2.m2.3.4.3.2.3" xref="S4.p4.2.m2.3.4.3.1.cmml">,</mo><mn id="S4.p4.2.m2.3.3" xref="S4.p4.2.m2.3.3.cmml">100</mn><mo stretchy="false" id="S4.p4.2.m2.3.4.3.2.4" xref="S4.p4.2.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.3b"><apply id="S4.p4.2.m2.3.4.cmml" xref="S4.p4.2.m2.3.4"><in id="S4.p4.2.m2.3.4.1.cmml" xref="S4.p4.2.m2.3.4.1"></in><ci id="S4.p4.2.m2.3.4.2.cmml" xref="S4.p4.2.m2.3.4.2">𝛾</ci><set id="S4.p4.2.m2.3.4.3.1.cmml" xref="S4.p4.2.m2.3.4.3.2"><cn type="integer" id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1">1</cn><cn type="integer" id="S4.p4.2.m2.2.2.cmml" xref="S4.p4.2.m2.2.2">10</cn><cn type="integer" id="S4.p4.2.m2.3.3.cmml" xref="S4.p4.2.m2.3.3">100</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.3c">\gamma\in\{1,10,100\}</annotation></semantics></math>). Finally, at the end of this process we have the best
model for an entire training run. We repeat this process across five random
datasets and report mean and variance at a given level of supervision.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.1" class="ltx_p"><span id="S4.p5.1.1" class="ltx_text" style="color:#000000;">With CLEVR, we report results when we train on 1000 question-program supervision
pairs (this is <math id="S4.p5.1.1.m1.1" class="ltx_Math" alttext="0.143" display="inline"><semantics id="S4.p5.1.1.m1.1a"><mn mathcolor="#000000" id="S4.p5.1.1.m1.1.1" xref="S4.p5.1.1.m1.1.1.cmml">0.143</mn><annotation-xml encoding="MathML-Content" id="S4.p5.1.1.m1.1b"><cn type="float" id="S4.p5.1.1.m1.1.1.cmml" xref="S4.p5.1.1.m1.1.1">0.143</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.1.m1.1c">0.143</annotation></semantics></math>% of all question-program pairs), along with the rest of the question,
image answer pairs (dropping the corresponding
programs). Similar to SHAPES, we report our results across 20 different choices of the subset
of 1000 questions to estimate statistical significance. In general, the CLEVR dataset
has question lengths with really large variance, and we select the subset of 1000 questions
with length at most 40. We do this to stabilize training (for both our
method as well as the baseline) and also to simulate a realistic scenario where an end
user would not want to annotate really long programs. For each choice of a subset of
1000 questions, we run our entire training pipeline (across the question coding,
module training and joint training stages) and report results on the top 15 runs
out of the 20 (for all comparisons reported in the paper), based on question coding
accuracy (see metrics below).</span></p>
</div>
<div id="S4.p6" class="ltx_para ltx_noindent">
<p id="S4.p6.1" class="ltx_p"><span id="S4.p6.1.1" class="ltx_text ltx_font_bold">Metrics.</span> For question coding, we report the accuracy of the programs
predicted by the <math id="S4.p6.1.m1.1" class="ltx_Math" alttext="q_{\phi}(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S4.p6.1.m1.1a"><mrow id="S4.p6.1.m1.1.1" xref="S4.p6.1.m1.1.1.cmml"><msub id="S4.p6.1.m1.1.1.3" xref="S4.p6.1.m1.1.1.3.cmml"><mi id="S4.p6.1.m1.1.1.3.2" xref="S4.p6.1.m1.1.1.3.2.cmml">q</mi><mi id="S4.p6.1.m1.1.1.3.3" xref="S4.p6.1.m1.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S4.p6.1.m1.1.1.2" xref="S4.p6.1.m1.1.1.2.cmml">​</mo><mrow id="S4.p6.1.m1.1.1.1.1" xref="S4.p6.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p6.1.m1.1.1.1.1.2" xref="S4.p6.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p6.1.m1.1.1.1.1.1" xref="S4.p6.1.m1.1.1.1.1.1.cmml"><mi id="S4.p6.1.m1.1.1.1.1.1.2" xref="S4.p6.1.m1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S4.p6.1.m1.1.1.1.1.1.1" xref="S4.p6.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.p6.1.m1.1.1.1.1.1.3" xref="S4.p6.1.m1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.p6.1.m1.1.1.1.1.3" xref="S4.p6.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.1.m1.1b"><apply id="S4.p6.1.m1.1.1.cmml" xref="S4.p6.1.m1.1.1"><times id="S4.p6.1.m1.1.1.2.cmml" xref="S4.p6.1.m1.1.1.2"></times><apply id="S4.p6.1.m1.1.1.3.cmml" xref="S4.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.p6.1.m1.1.1.3.1.cmml" xref="S4.p6.1.m1.1.1.3">subscript</csymbol><ci id="S4.p6.1.m1.1.1.3.2.cmml" xref="S4.p6.1.m1.1.1.3.2">𝑞</ci><ci id="S4.p6.1.m1.1.1.3.3.cmml" xref="S4.p6.1.m1.1.1.3.3">italic-ϕ</ci></apply><apply id="S4.p6.1.m1.1.1.1.1.1.cmml" xref="S4.p6.1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.p6.1.m1.1.1.1.1.1.1.cmml" xref="S4.p6.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.p6.1.m1.1.1.1.1.1.2.cmml" xref="S4.p6.1.m1.1.1.1.1.1.2">𝐳</ci><ci id="S4.p6.1.m1.1.1.1.1.1.3.cmml" xref="S4.p6.1.m1.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.1.m1.1c">q_{\phi}(\mathbf{z}|\mathbf{x})</annotation></semantics></math> model (determined with exact string match),
since we are interested in the legibility
of the generated programs. In module training, we report the VQA accuracy obtained by the
model, and finally, in joint training, we report both, VQA and program
prediction accuracy since we are interested in both, getting the right answers and the legibility of the model’s reasoning trace.</p>
</div>
<div id="S4.p7" class="ltx_para ltx_noindent">
<p id="S4.p7.1" class="ltx_p"><span id="S4.p7.1.1" class="ltx_text ltx_font_bold" style="color:#000000;">Prior.</span><span id="S4.p7.1.2" class="ltx_text" style="color:#000000;"> On SHAPES, we train the program prior </span><math id="S4.p7.1.m1.1" class="ltx_Math" alttext="p(\mathbf{z})" display="inline"><semantics id="S4.p7.1.m1.1a"><mrow id="S4.p7.1.m1.1.2" xref="S4.p7.1.m1.1.2.cmml"><mi mathcolor="#000000" id="S4.p7.1.m1.1.2.2" xref="S4.p7.1.m1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.p7.1.m1.1.2.1" xref="S4.p7.1.m1.1.2.1.cmml">​</mo><mrow id="S4.p7.1.m1.1.2.3.2" xref="S4.p7.1.m1.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S4.p7.1.m1.1.2.3.2.1" xref="S4.p7.1.m1.1.2.cmml">(</mo><mi mathcolor="#000000" id="S4.p7.1.m1.1.1" xref="S4.p7.1.m1.1.1.cmml">𝐳</mi><mo mathcolor="#000000" stretchy="false" id="S4.p7.1.m1.1.2.3.2.2" xref="S4.p7.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p7.1.m1.1b"><apply id="S4.p7.1.m1.1.2.cmml" xref="S4.p7.1.m1.1.2"><times id="S4.p7.1.m1.1.2.1.cmml" xref="S4.p7.1.m1.1.2.1"></times><ci id="S4.p7.1.m1.1.2.2.cmml" xref="S4.p7.1.m1.1.2.2">𝑝</ci><ci id="S4.p7.1.m1.1.1.cmml" xref="S4.p7.1.m1.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.1.m1.1c">p(\mathbf{z})</annotation></semantics></math><span id="S4.p7.1.3" class="ltx_text" style="color:#000000;"> using programs simulated
using syntax (more details in the Appendix). On CLEVR, we train using
all the programs in the training set, while restricting the number of paired
questions and programs to 1000 (as explained above).</span><span id="S4.p7.1.4" class="ltx_text"></span></p>
</div>
<div id="S4.p8" class="ltx_para ltx_noindent">
<p id="S4.p8.8" class="ltx_p"><span id="S4.p8.8.1" class="ltx_text ltx_font_bold">Baselines.</span>
We compare against adaptation of a state-of-the-art semi-supervised learning approach
proposed for neural module networks by <cite class="ltx_cite ltx_citemacro_citet">Johnson et al. (<a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>. <cite class="ltx_cite ltx_citemacro_citeauthor"><a href="#bib.bib19" title="" class="ltx_ref">Johnson et al.</a></cite> fit
the terms corresponding to <math id="S4.p8.1.m1.1" class="ltx_Math" alttext="q_{\phi}(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S4.p8.1.m1.1a"><mrow id="S4.p8.1.m1.1.1" xref="S4.p8.1.m1.1.1.cmml"><msub id="S4.p8.1.m1.1.1.3" xref="S4.p8.1.m1.1.1.3.cmml"><mi id="S4.p8.1.m1.1.1.3.2" xref="S4.p8.1.m1.1.1.3.2.cmml">q</mi><mi id="S4.p8.1.m1.1.1.3.3" xref="S4.p8.1.m1.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S4.p8.1.m1.1.1.2" xref="S4.p8.1.m1.1.1.2.cmml">​</mo><mrow id="S4.p8.1.m1.1.1.1.1" xref="S4.p8.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p8.1.m1.1.1.1.1.2" xref="S4.p8.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p8.1.m1.1.1.1.1.1" xref="S4.p8.1.m1.1.1.1.1.1.cmml"><mi id="S4.p8.1.m1.1.1.1.1.1.2" xref="S4.p8.1.m1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S4.p8.1.m1.1.1.1.1.1.1" xref="S4.p8.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.p8.1.m1.1.1.1.1.1.3" xref="S4.p8.1.m1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S4.p8.1.m1.1.1.1.1.3" xref="S4.p8.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.1.m1.1b"><apply id="S4.p8.1.m1.1.1.cmml" xref="S4.p8.1.m1.1.1"><times id="S4.p8.1.m1.1.1.2.cmml" xref="S4.p8.1.m1.1.1.2"></times><apply id="S4.p8.1.m1.1.1.3.cmml" xref="S4.p8.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.p8.1.m1.1.1.3.1.cmml" xref="S4.p8.1.m1.1.1.3">subscript</csymbol><ci id="S4.p8.1.m1.1.1.3.2.cmml" xref="S4.p8.1.m1.1.1.3.2">𝑞</ci><ci id="S4.p8.1.m1.1.1.3.3.cmml" xref="S4.p8.1.m1.1.1.3.3">italic-ϕ</ci></apply><apply id="S4.p8.1.m1.1.1.1.1.1.cmml" xref="S4.p8.1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.p8.1.m1.1.1.1.1.1.1.cmml" xref="S4.p8.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.p8.1.m1.1.1.1.1.1.2.cmml" xref="S4.p8.1.m1.1.1.1.1.1.2">𝐳</ci><ci id="S4.p8.1.m1.1.1.1.1.1.3.cmml" xref="S4.p8.1.m1.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.1.m1.1c">q_{\phi}(\mathbf{z}|\mathbf{x})</annotation></semantics></math> and <math id="S4.p8.2.m2.2" class="ltx_Math" alttext="p(a|\mathbf{i};\theta_{\mathbf{z}})" display="inline"><semantics id="S4.p8.2.m2.2a"><mrow id="S4.p8.2.m2.2.2" xref="S4.p8.2.m2.2.2.cmml"><mi id="S4.p8.2.m2.2.2.3" xref="S4.p8.2.m2.2.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.p8.2.m2.2.2.2" xref="S4.p8.2.m2.2.2.2.cmml">​</mo><mrow id="S4.p8.2.m2.2.2.1.1" xref="S4.p8.2.m2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.p8.2.m2.2.2.1.1.2" xref="S4.p8.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="S4.p8.2.m2.2.2.1.1.1" xref="S4.p8.2.m2.2.2.1.1.1.cmml"><mi id="S4.p8.2.m2.2.2.1.1.1.3" xref="S4.p8.2.m2.2.2.1.1.1.3.cmml">a</mi><mo fence="false" id="S4.p8.2.m2.2.2.1.1.1.2" xref="S4.p8.2.m2.2.2.1.1.1.2.cmml">|</mo><mrow id="S4.p8.2.m2.2.2.1.1.1.1.1" xref="S4.p8.2.m2.2.2.1.1.1.1.2.cmml"><mi id="S4.p8.2.m2.1.1" xref="S4.p8.2.m2.1.1.cmml">𝐢</mi><mo id="S4.p8.2.m2.2.2.1.1.1.1.1.2" xref="S4.p8.2.m2.2.2.1.1.1.1.2.cmml">;</mo><msub id="S4.p8.2.m2.2.2.1.1.1.1.1.1" xref="S4.p8.2.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.p8.2.m2.2.2.1.1.1.1.1.1.2" xref="S4.p8.2.m2.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.p8.2.m2.2.2.1.1.1.1.1.1.3" xref="S4.p8.2.m2.2.2.1.1.1.1.1.1.3.cmml">𝐳</mi></msub></mrow></mrow><mo stretchy="false" id="S4.p8.2.m2.2.2.1.1.3" xref="S4.p8.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.2.m2.2b"><apply id="S4.p8.2.m2.2.2.cmml" xref="S4.p8.2.m2.2.2"><times id="S4.p8.2.m2.2.2.2.cmml" xref="S4.p8.2.m2.2.2.2"></times><ci id="S4.p8.2.m2.2.2.3.cmml" xref="S4.p8.2.m2.2.2.3">𝑝</ci><apply id="S4.p8.2.m2.2.2.1.1.1.cmml" xref="S4.p8.2.m2.2.2.1.1"><csymbol cd="latexml" id="S4.p8.2.m2.2.2.1.1.1.2.cmml" xref="S4.p8.2.m2.2.2.1.1.1.2">conditional</csymbol><ci id="S4.p8.2.m2.2.2.1.1.1.3.cmml" xref="S4.p8.2.m2.2.2.1.1.1.3">𝑎</ci><list id="S4.p8.2.m2.2.2.1.1.1.1.2.cmml" xref="S4.p8.2.m2.2.2.1.1.1.1.1"><ci id="S4.p8.2.m2.1.1.cmml" xref="S4.p8.2.m2.1.1">𝐢</ci><apply id="S4.p8.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S4.p8.2.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p8.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.p8.2.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.p8.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.p8.2.m2.2.2.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.p8.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.p8.2.m2.2.2.1.1.1.1.1.1.3">𝐳</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.2.m2.2c">p(a|\mathbf{i};\theta_{\mathbf{z}})</annotation></semantics></math>
in our model. Specifically, in question coding, they optimize
<math id="S4.p8.3.m3.1" class="ltx_Math" alttext="\max_{\phi}\sum_{n}\log q_{\phi}(\mathbf{x}^{n}|\mathbf{z}^{n})" display="inline"><semantics id="S4.p8.3.m3.1a"><mrow id="S4.p8.3.m3.1.1" xref="S4.p8.3.m3.1.1.cmml"><msub id="S4.p8.3.m3.1.1.3" xref="S4.p8.3.m3.1.1.3.cmml"><mi id="S4.p8.3.m3.1.1.3.2" xref="S4.p8.3.m3.1.1.3.2.cmml">max</mi><mi id="S4.p8.3.m3.1.1.3.3" xref="S4.p8.3.m3.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S4.p8.3.m3.1.1.2" xref="S4.p8.3.m3.1.1.2.cmml">​</mo><mrow id="S4.p8.3.m3.1.1.1" xref="S4.p8.3.m3.1.1.1.cmml"><msub id="S4.p8.3.m3.1.1.1.2" xref="S4.p8.3.m3.1.1.1.2.cmml"><mo id="S4.p8.3.m3.1.1.1.2.2" xref="S4.p8.3.m3.1.1.1.2.2.cmml">∑</mo><mi id="S4.p8.3.m3.1.1.1.2.3" xref="S4.p8.3.m3.1.1.1.2.3.cmml">n</mi></msub><mrow id="S4.p8.3.m3.1.1.1.1" xref="S4.p8.3.m3.1.1.1.1.cmml"><mrow id="S4.p8.3.m3.1.1.1.1.3" xref="S4.p8.3.m3.1.1.1.1.3.cmml"><mi id="S4.p8.3.m3.1.1.1.1.3.1" xref="S4.p8.3.m3.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.p8.3.m3.1.1.1.1.3a" xref="S4.p8.3.m3.1.1.1.1.3.cmml">⁡</mo><msub id="S4.p8.3.m3.1.1.1.1.3.2" xref="S4.p8.3.m3.1.1.1.1.3.2.cmml"><mi id="S4.p8.3.m3.1.1.1.1.3.2.2" xref="S4.p8.3.m3.1.1.1.1.3.2.2.cmml">q</mi><mi id="S4.p8.3.m3.1.1.1.1.3.2.3" xref="S4.p8.3.m3.1.1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.p8.3.m3.1.1.1.1.2" xref="S4.p8.3.m3.1.1.1.1.2.cmml">​</mo><mrow id="S4.p8.3.m3.1.1.1.1.1.1" xref="S4.p8.3.m3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p8.3.m3.1.1.1.1.1.1.2" xref="S4.p8.3.m3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p8.3.m3.1.1.1.1.1.1.1" xref="S4.p8.3.m3.1.1.1.1.1.1.1.cmml"><msup id="S4.p8.3.m3.1.1.1.1.1.1.1.2" xref="S4.p8.3.m3.1.1.1.1.1.1.1.2.cmml"><mi id="S4.p8.3.m3.1.1.1.1.1.1.1.2.2" xref="S4.p8.3.m3.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S4.p8.3.m3.1.1.1.1.1.1.1.2.3" xref="S4.p8.3.m3.1.1.1.1.1.1.1.2.3.cmml">n</mi></msup><mo fence="false" id="S4.p8.3.m3.1.1.1.1.1.1.1.1" xref="S4.p8.3.m3.1.1.1.1.1.1.1.1.cmml">|</mo><msup id="S4.p8.3.m3.1.1.1.1.1.1.1.3" xref="S4.p8.3.m3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.p8.3.m3.1.1.1.1.1.1.1.3.2" xref="S4.p8.3.m3.1.1.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S4.p8.3.m3.1.1.1.1.1.1.1.3.3" xref="S4.p8.3.m3.1.1.1.1.1.1.1.3.3.cmml">n</mi></msup></mrow><mo stretchy="false" id="S4.p8.3.m3.1.1.1.1.1.1.3" xref="S4.p8.3.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.3.m3.1b"><apply id="S4.p8.3.m3.1.1.cmml" xref="S4.p8.3.m3.1.1"><times id="S4.p8.3.m3.1.1.2.cmml" xref="S4.p8.3.m3.1.1.2"></times><apply id="S4.p8.3.m3.1.1.3.cmml" xref="S4.p8.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.p8.3.m3.1.1.3.1.cmml" xref="S4.p8.3.m3.1.1.3">subscript</csymbol><max id="S4.p8.3.m3.1.1.3.2.cmml" xref="S4.p8.3.m3.1.1.3.2"></max><ci id="S4.p8.3.m3.1.1.3.3.cmml" xref="S4.p8.3.m3.1.1.3.3">italic-ϕ</ci></apply><apply id="S4.p8.3.m3.1.1.1.cmml" xref="S4.p8.3.m3.1.1.1"><apply id="S4.p8.3.m3.1.1.1.2.cmml" xref="S4.p8.3.m3.1.1.1.2"><csymbol cd="ambiguous" id="S4.p8.3.m3.1.1.1.2.1.cmml" xref="S4.p8.3.m3.1.1.1.2">subscript</csymbol><sum id="S4.p8.3.m3.1.1.1.2.2.cmml" xref="S4.p8.3.m3.1.1.1.2.2"></sum><ci id="S4.p8.3.m3.1.1.1.2.3.cmml" xref="S4.p8.3.m3.1.1.1.2.3">𝑛</ci></apply><apply id="S4.p8.3.m3.1.1.1.1.cmml" xref="S4.p8.3.m3.1.1.1.1"><times id="S4.p8.3.m3.1.1.1.1.2.cmml" xref="S4.p8.3.m3.1.1.1.1.2"></times><apply id="S4.p8.3.m3.1.1.1.1.3.cmml" xref="S4.p8.3.m3.1.1.1.1.3"><log id="S4.p8.3.m3.1.1.1.1.3.1.cmml" xref="S4.p8.3.m3.1.1.1.1.3.1"></log><apply id="S4.p8.3.m3.1.1.1.1.3.2.cmml" xref="S4.p8.3.m3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.p8.3.m3.1.1.1.1.3.2.1.cmml" xref="S4.p8.3.m3.1.1.1.1.3.2">subscript</csymbol><ci id="S4.p8.3.m3.1.1.1.1.3.2.2.cmml" xref="S4.p8.3.m3.1.1.1.1.3.2.2">𝑞</ci><ci id="S4.p8.3.m3.1.1.1.1.3.2.3.cmml" xref="S4.p8.3.m3.1.1.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S4.p8.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.p8.3.m3.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.p8.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S4.p8.3.m3.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.p8.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S4.p8.3.m3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p8.3.m3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.p8.3.m3.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.p8.3.m3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.p8.3.m3.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S4.p8.3.m3.1.1.1.1.1.1.1.2.3.cmml" xref="S4.p8.3.m3.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S4.p8.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S4.p8.3.m3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p8.3.m3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.p8.3.m3.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.p8.3.m3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.p8.3.m3.1.1.1.1.1.1.1.3.2">𝐳</ci><ci id="S4.p8.3.m3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.p8.3.m3.1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.3.m3.1c">\max_{\phi}\sum_{n}\log q_{\phi}(\mathbf{x}^{n}|\mathbf{z}^{n})</annotation></semantics></math> (where <math id="S4.p8.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.p8.4.m4.1a"><mi id="S4.p8.4.m4.1.1" xref="S4.p8.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.p8.4.m4.1b"><ci id="S4.p8.4.m4.1.1.cmml" xref="S4.p8.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.4.m4.1c">n</annotation></semantics></math> indexes data points
with associated questions, <em id="S4.p8.8.2" class="ltx_emph ltx_font_italic">i.e.</em> the approach does not make use of “unlabelled” data).
Next, in module training
they optimize
<math id="S4.p8.5.m5.2" class="ltx_Math" alttext="\max_{\theta_{\mathcal{Z}}}\sum_{m=1}^{M}E_{z\sim q(\mathbf{z}|\mathbf{x}^{m})}\left[\log p(a^{m}|\mathbf{i}^{m};\theta_{\mathbf{z}})\right]" display="inline"><semantics id="S4.p8.5.m5.2a"><mrow id="S4.p8.5.m5.2.2" xref="S4.p8.5.m5.2.2.cmml"><msub id="S4.p8.5.m5.2.2.3" xref="S4.p8.5.m5.2.2.3.cmml"><mi id="S4.p8.5.m5.2.2.3.2" xref="S4.p8.5.m5.2.2.3.2.cmml">max</mi><msub id="S4.p8.5.m5.2.2.3.3" xref="S4.p8.5.m5.2.2.3.3.cmml"><mi id="S4.p8.5.m5.2.2.3.3.2" xref="S4.p8.5.m5.2.2.3.3.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.p8.5.m5.2.2.3.3.3" xref="S4.p8.5.m5.2.2.3.3.3.cmml">𝒵</mi></msub></msub><mo lspace="0em" rspace="0em" id="S4.p8.5.m5.2.2.2" xref="S4.p8.5.m5.2.2.2.cmml">​</mo><mrow id="S4.p8.5.m5.2.2.1" xref="S4.p8.5.m5.2.2.1.cmml"><msubsup id="S4.p8.5.m5.2.2.1.2" xref="S4.p8.5.m5.2.2.1.2.cmml"><mo id="S4.p8.5.m5.2.2.1.2.2.2" xref="S4.p8.5.m5.2.2.1.2.2.2.cmml">∑</mo><mrow id="S4.p8.5.m5.2.2.1.2.2.3" xref="S4.p8.5.m5.2.2.1.2.2.3.cmml"><mi id="S4.p8.5.m5.2.2.1.2.2.3.2" xref="S4.p8.5.m5.2.2.1.2.2.3.2.cmml">m</mi><mo id="S4.p8.5.m5.2.2.1.2.2.3.1" xref="S4.p8.5.m5.2.2.1.2.2.3.1.cmml">=</mo><mn id="S4.p8.5.m5.2.2.1.2.2.3.3" xref="S4.p8.5.m5.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.p8.5.m5.2.2.1.2.3" xref="S4.p8.5.m5.2.2.1.2.3.cmml">M</mi></msubsup><mrow id="S4.p8.5.m5.2.2.1.1" xref="S4.p8.5.m5.2.2.1.1.cmml"><msub id="S4.p8.5.m5.2.2.1.1.3" xref="S4.p8.5.m5.2.2.1.1.3.cmml"><mi id="S4.p8.5.m5.2.2.1.1.3.2" xref="S4.p8.5.m5.2.2.1.1.3.2.cmml">E</mi><mrow id="S4.p8.5.m5.1.1.1" xref="S4.p8.5.m5.1.1.1.cmml"><mi id="S4.p8.5.m5.1.1.1.3" xref="S4.p8.5.m5.1.1.1.3.cmml">z</mi><mo id="S4.p8.5.m5.1.1.1.2" xref="S4.p8.5.m5.1.1.1.2.cmml">∼</mo><mrow id="S4.p8.5.m5.1.1.1.1" xref="S4.p8.5.m5.1.1.1.1.cmml"><mi id="S4.p8.5.m5.1.1.1.1.3" xref="S4.p8.5.m5.1.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S4.p8.5.m5.1.1.1.1.2" xref="S4.p8.5.m5.1.1.1.1.2.cmml">​</mo><mrow id="S4.p8.5.m5.1.1.1.1.1.1" xref="S4.p8.5.m5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p8.5.m5.1.1.1.1.1.1.2" xref="S4.p8.5.m5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p8.5.m5.1.1.1.1.1.1.1" xref="S4.p8.5.m5.1.1.1.1.1.1.1.cmml"><mi id="S4.p8.5.m5.1.1.1.1.1.1.1.2" xref="S4.p8.5.m5.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S4.p8.5.m5.1.1.1.1.1.1.1.1" xref="S4.p8.5.m5.1.1.1.1.1.1.1.1.cmml">|</mo><msup id="S4.p8.5.m5.1.1.1.1.1.1.1.3" xref="S4.p8.5.m5.1.1.1.1.1.1.1.3.cmml"><mi id="S4.p8.5.m5.1.1.1.1.1.1.1.3.2" xref="S4.p8.5.m5.1.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S4.p8.5.m5.1.1.1.1.1.1.1.3.3" xref="S4.p8.5.m5.1.1.1.1.1.1.1.3.3.cmml">m</mi></msup></mrow><mo stretchy="false" id="S4.p8.5.m5.1.1.1.1.1.1.3" xref="S4.p8.5.m5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S4.p8.5.m5.2.2.1.1.2" xref="S4.p8.5.m5.2.2.1.1.2.cmml">​</mo><mrow id="S4.p8.5.m5.2.2.1.1.1.1" xref="S4.p8.5.m5.2.2.1.1.1.2.cmml"><mo id="S4.p8.5.m5.2.2.1.1.1.1.2" xref="S4.p8.5.m5.2.2.1.1.1.2.1.cmml">[</mo><mrow id="S4.p8.5.m5.2.2.1.1.1.1.1" xref="S4.p8.5.m5.2.2.1.1.1.1.1.cmml"><mrow id="S4.p8.5.m5.2.2.1.1.1.1.1.3" xref="S4.p8.5.m5.2.2.1.1.1.1.1.3.cmml"><mi id="S4.p8.5.m5.2.2.1.1.1.1.1.3.1" xref="S4.p8.5.m5.2.2.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.p8.5.m5.2.2.1.1.1.1.1.3a" xref="S4.p8.5.m5.2.2.1.1.1.1.1.3.cmml">⁡</mo><mi id="S4.p8.5.m5.2.2.1.1.1.1.1.3.2" xref="S4.p8.5.m5.2.2.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S4.p8.5.m5.2.2.1.1.1.1.1.2" xref="S4.p8.5.m5.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.2" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.cmml"><msup id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4.cmml"><mi id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4.2" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.cmml">a</mi><mi id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4.3" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4.3.cmml">m</mi></msup><mo fence="false" id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.3" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><msup id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐢</mi><mi id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></msup><mo id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml">𝐳</mi></msub></mrow></mrow><mo stretchy="false" id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.3" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p8.5.m5.2.2.1.1.1.1.3" xref="S4.p8.5.m5.2.2.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.5.m5.2b"><apply id="S4.p8.5.m5.2.2.cmml" xref="S4.p8.5.m5.2.2"><times id="S4.p8.5.m5.2.2.2.cmml" xref="S4.p8.5.m5.2.2.2"></times><apply id="S4.p8.5.m5.2.2.3.cmml" xref="S4.p8.5.m5.2.2.3"><csymbol cd="ambiguous" id="S4.p8.5.m5.2.2.3.1.cmml" xref="S4.p8.5.m5.2.2.3">subscript</csymbol><max id="S4.p8.5.m5.2.2.3.2.cmml" xref="S4.p8.5.m5.2.2.3.2"></max><apply id="S4.p8.5.m5.2.2.3.3.cmml" xref="S4.p8.5.m5.2.2.3.3"><csymbol cd="ambiguous" id="S4.p8.5.m5.2.2.3.3.1.cmml" xref="S4.p8.5.m5.2.2.3.3">subscript</csymbol><ci id="S4.p8.5.m5.2.2.3.3.2.cmml" xref="S4.p8.5.m5.2.2.3.3.2">𝜃</ci><ci id="S4.p8.5.m5.2.2.3.3.3.cmml" xref="S4.p8.5.m5.2.2.3.3.3">𝒵</ci></apply></apply><apply id="S4.p8.5.m5.2.2.1.cmml" xref="S4.p8.5.m5.2.2.1"><apply id="S4.p8.5.m5.2.2.1.2.cmml" xref="S4.p8.5.m5.2.2.1.2"><csymbol cd="ambiguous" id="S4.p8.5.m5.2.2.1.2.1.cmml" xref="S4.p8.5.m5.2.2.1.2">superscript</csymbol><apply id="S4.p8.5.m5.2.2.1.2.2.cmml" xref="S4.p8.5.m5.2.2.1.2"><csymbol cd="ambiguous" id="S4.p8.5.m5.2.2.1.2.2.1.cmml" xref="S4.p8.5.m5.2.2.1.2">subscript</csymbol><sum id="S4.p8.5.m5.2.2.1.2.2.2.cmml" xref="S4.p8.5.m5.2.2.1.2.2.2"></sum><apply id="S4.p8.5.m5.2.2.1.2.2.3.cmml" xref="S4.p8.5.m5.2.2.1.2.2.3"><eq id="S4.p8.5.m5.2.2.1.2.2.3.1.cmml" xref="S4.p8.5.m5.2.2.1.2.2.3.1"></eq><ci id="S4.p8.5.m5.2.2.1.2.2.3.2.cmml" xref="S4.p8.5.m5.2.2.1.2.2.3.2">𝑚</ci><cn type="integer" id="S4.p8.5.m5.2.2.1.2.2.3.3.cmml" xref="S4.p8.5.m5.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S4.p8.5.m5.2.2.1.2.3.cmml" xref="S4.p8.5.m5.2.2.1.2.3">𝑀</ci></apply><apply id="S4.p8.5.m5.2.2.1.1.cmml" xref="S4.p8.5.m5.2.2.1.1"><times id="S4.p8.5.m5.2.2.1.1.2.cmml" xref="S4.p8.5.m5.2.2.1.1.2"></times><apply id="S4.p8.5.m5.2.2.1.1.3.cmml" xref="S4.p8.5.m5.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.p8.5.m5.2.2.1.1.3.1.cmml" xref="S4.p8.5.m5.2.2.1.1.3">subscript</csymbol><ci id="S4.p8.5.m5.2.2.1.1.3.2.cmml" xref="S4.p8.5.m5.2.2.1.1.3.2">𝐸</ci><apply id="S4.p8.5.m5.1.1.1.cmml" xref="S4.p8.5.m5.1.1.1"><csymbol cd="latexml" id="S4.p8.5.m5.1.1.1.2.cmml" xref="S4.p8.5.m5.1.1.1.2">similar-to</csymbol><ci id="S4.p8.5.m5.1.1.1.3.cmml" xref="S4.p8.5.m5.1.1.1.3">𝑧</ci><apply id="S4.p8.5.m5.1.1.1.1.cmml" xref="S4.p8.5.m5.1.1.1.1"><times id="S4.p8.5.m5.1.1.1.1.2.cmml" xref="S4.p8.5.m5.1.1.1.1.2"></times><ci id="S4.p8.5.m5.1.1.1.1.3.cmml" xref="S4.p8.5.m5.1.1.1.1.3">𝑞</ci><apply id="S4.p8.5.m5.1.1.1.1.1.1.1.cmml" xref="S4.p8.5.m5.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.p8.5.m5.1.1.1.1.1.1.1.1.cmml" xref="S4.p8.5.m5.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.p8.5.m5.1.1.1.1.1.1.1.2.cmml" xref="S4.p8.5.m5.1.1.1.1.1.1.1.2">𝐳</ci><apply id="S4.p8.5.m5.1.1.1.1.1.1.1.3.cmml" xref="S4.p8.5.m5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p8.5.m5.1.1.1.1.1.1.1.3.1.cmml" xref="S4.p8.5.m5.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.p8.5.m5.1.1.1.1.1.1.1.3.2.cmml" xref="S4.p8.5.m5.1.1.1.1.1.1.1.3.2">𝐱</ci><ci id="S4.p8.5.m5.1.1.1.1.1.1.1.3.3.cmml" xref="S4.p8.5.m5.1.1.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply></apply></apply><apply id="S4.p8.5.m5.2.2.1.1.1.2.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1"><csymbol cd="latexml" id="S4.p8.5.m5.2.2.1.1.1.2.1.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.p8.5.m5.2.2.1.1.1.1.1.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1"><times id="S4.p8.5.m5.2.2.1.1.1.1.1.2.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.2"></times><apply id="S4.p8.5.m5.2.2.1.1.1.1.1.3.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.3"><log id="S4.p8.5.m5.2.2.1.1.1.1.1.3.1.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.3.1"></log><ci id="S4.p8.5.m5.2.2.1.1.1.1.1.3.2.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4.2">𝑎</ci><ci id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4.3.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.4.3">𝑚</ci></apply><list id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2"><apply id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝐢</ci><ci id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.p8.5.m5.2.2.1.1.1.1.1.1.1.1.2.2.2.3">𝐳</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.5.m5.2c">\max_{\theta_{\mathcal{Z}}}\sum_{m=1}^{M}E_{z\sim q(\mathbf{z}|\mathbf{x}^{m})}\left[\log p(a^{m}|\mathbf{i}^{m};\theta_{\mathbf{z}})\right]</annotation></semantics></math>.
In joint training, they optimize the same objective with respect to the parameters
<math id="S4.p8.6.m6.1" class="ltx_Math" alttext="\theta_{\mathcal{Z}}" display="inline"><semantics id="S4.p8.6.m6.1a"><msub id="S4.p8.6.m6.1.1" xref="S4.p8.6.m6.1.1.cmml"><mi id="S4.p8.6.m6.1.1.2" xref="S4.p8.6.m6.1.1.2.cmml">θ</mi><mi class="ltx_font_mathcaligraphic" id="S4.p8.6.m6.1.1.3" xref="S4.p8.6.m6.1.1.3.cmml">𝒵</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p8.6.m6.1b"><apply id="S4.p8.6.m6.1.1.cmml" xref="S4.p8.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p8.6.m6.1.1.1.cmml" xref="S4.p8.6.m6.1.1">subscript</csymbol><ci id="S4.p8.6.m6.1.1.2.cmml" xref="S4.p8.6.m6.1.1.2">𝜃</ci><ci id="S4.p8.6.m6.1.1.3.cmml" xref="S4.p8.6.m6.1.1.3">𝒵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.6.m6.1c">\theta_{\mathcal{Z}}</annotation></semantics></math> as well as <math id="S4.p8.7.m7.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S4.p8.7.m7.1a"><mi id="S4.p8.7.m7.1.1" xref="S4.p8.7.m7.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.p8.7.m7.1b"><ci id="S4.p8.7.m7.1.1.cmml" xref="S4.p8.7.m7.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.7.m7.1c">\phi</annotation></semantics></math>, using the REINFORCE gradient estimator:
<math id="S4.p8.8.m8.3" class="ltx_Math" alttext="\nabla_{\phi}=\frac{1}{M}\sum_{m}[\log p(a|\mathbf{i};\theta_{\mathbf{z}})-B]\nabla_{\phi}\log q_{\phi}(\mathbf{z}|\mathbf{x}^{m})" display="inline"><semantics id="S4.p8.8.m8.3a"><mrow id="S4.p8.8.m8.3.3" xref="S4.p8.8.m8.3.3.cmml"><msub id="S4.p8.8.m8.3.3.4" xref="S4.p8.8.m8.3.3.4.cmml"><mo id="S4.p8.8.m8.3.3.4.2" xref="S4.p8.8.m8.3.3.4.2.cmml">∇</mo><mi id="S4.p8.8.m8.3.3.4.3" xref="S4.p8.8.m8.3.3.4.3.cmml">ϕ</mi></msub><mo id="S4.p8.8.m8.3.3.3" xref="S4.p8.8.m8.3.3.3.cmml">=</mo><mrow id="S4.p8.8.m8.3.3.2" xref="S4.p8.8.m8.3.3.2.cmml"><mfrac id="S4.p8.8.m8.3.3.2.4" xref="S4.p8.8.m8.3.3.2.4.cmml"><mn id="S4.p8.8.m8.3.3.2.4.2" xref="S4.p8.8.m8.3.3.2.4.2.cmml">1</mn><mi id="S4.p8.8.m8.3.3.2.4.3" xref="S4.p8.8.m8.3.3.2.4.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.p8.8.m8.3.3.2.3" xref="S4.p8.8.m8.3.3.2.3.cmml">​</mo><mrow id="S4.p8.8.m8.3.3.2.2" xref="S4.p8.8.m8.3.3.2.2.cmml"><msub id="S4.p8.8.m8.3.3.2.2.3" xref="S4.p8.8.m8.3.3.2.2.3.cmml"><mo rspace="0em" id="S4.p8.8.m8.3.3.2.2.3.2" xref="S4.p8.8.m8.3.3.2.2.3.2.cmml">∑</mo><mi id="S4.p8.8.m8.3.3.2.2.3.3" xref="S4.p8.8.m8.3.3.2.2.3.3.cmml">m</mi></msub><mrow id="S4.p8.8.m8.3.3.2.2.2" xref="S4.p8.8.m8.3.3.2.2.2.cmml"><mrow id="S4.p8.8.m8.2.2.1.1.1.1.1" xref="S4.p8.8.m8.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.p8.8.m8.2.2.1.1.1.1.1.2" xref="S4.p8.8.m8.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.p8.8.m8.2.2.1.1.1.1.1.1" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.cmml"><mrow id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3.1" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3a" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3.2" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.2" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">a</mi><mo fence="false" id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.p8.8.m8.1.1" xref="S4.p8.8.m8.1.1.cmml">𝐢</mi><mo id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐳</mi></msub></mrow></mrow><mo stretchy="false" id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p8.8.m8.2.2.1.1.1.1.1.1.2" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.2.cmml">−</mo><mi id="S4.p8.8.m8.2.2.1.1.1.1.1.1.3" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.3.cmml">B</mi></mrow><mo stretchy="false" id="S4.p8.8.m8.2.2.1.1.1.1.1.3" xref="S4.p8.8.m8.2.2.1.1.1.1.2.1.cmml">]</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.p8.8.m8.3.3.2.2.2.3" xref="S4.p8.8.m8.3.3.2.2.2.3.cmml">​</mo><mrow id="S4.p8.8.m8.3.3.2.2.2.4" xref="S4.p8.8.m8.3.3.2.2.2.4.cmml"><mrow id="S4.p8.8.m8.3.3.2.2.2.4.1" xref="S4.p8.8.m8.3.3.2.2.2.4.1.cmml"><msub id="S4.p8.8.m8.3.3.2.2.2.4.1.1" xref="S4.p8.8.m8.3.3.2.2.2.4.1.1.cmml"><mo rspace="0.167em" id="S4.p8.8.m8.3.3.2.2.2.4.1.1.2" xref="S4.p8.8.m8.3.3.2.2.2.4.1.1.2.cmml">∇</mo><mi id="S4.p8.8.m8.3.3.2.2.2.4.1.1.3" xref="S4.p8.8.m8.3.3.2.2.2.4.1.1.3.cmml">ϕ</mi></msub><mi id="S4.p8.8.m8.3.3.2.2.2.4.1.2" xref="S4.p8.8.m8.3.3.2.2.2.4.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S4.p8.8.m8.3.3.2.2.2.4a" xref="S4.p8.8.m8.3.3.2.2.2.4.cmml">⁡</mo><msub id="S4.p8.8.m8.3.3.2.2.2.4.2" xref="S4.p8.8.m8.3.3.2.2.2.4.2.cmml"><mi id="S4.p8.8.m8.3.3.2.2.2.4.2.2" xref="S4.p8.8.m8.3.3.2.2.2.4.2.2.cmml">q</mi><mi id="S4.p8.8.m8.3.3.2.2.2.4.2.3" xref="S4.p8.8.m8.3.3.2.2.2.4.2.3.cmml">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.p8.8.m8.3.3.2.2.2.3a" xref="S4.p8.8.m8.3.3.2.2.2.3.cmml">​</mo><mrow id="S4.p8.8.m8.3.3.2.2.2.2.1" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S4.p8.8.m8.3.3.2.2.2.2.1.2" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.p8.8.m8.3.3.2.2.2.2.1.1" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.cmml"><mi id="S4.p8.8.m8.3.3.2.2.2.2.1.1.2" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.2.cmml">𝐳</mi><mo fence="false" id="S4.p8.8.m8.3.3.2.2.2.2.1.1.1" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.1.cmml">|</mo><msup id="S4.p8.8.m8.3.3.2.2.2.2.1.1.3" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.3.cmml"><mi id="S4.p8.8.m8.3.3.2.2.2.2.1.1.3.2" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.3.2.cmml">𝐱</mi><mi id="S4.p8.8.m8.3.3.2.2.2.2.1.1.3.3" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.3.3.cmml">m</mi></msup></mrow><mo stretchy="false" id="S4.p8.8.m8.3.3.2.2.2.2.1.3" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.8.m8.3b"><apply id="S4.p8.8.m8.3.3.cmml" xref="S4.p8.8.m8.3.3"><eq id="S4.p8.8.m8.3.3.3.cmml" xref="S4.p8.8.m8.3.3.3"></eq><apply id="S4.p8.8.m8.3.3.4.cmml" xref="S4.p8.8.m8.3.3.4"><csymbol cd="ambiguous" id="S4.p8.8.m8.3.3.4.1.cmml" xref="S4.p8.8.m8.3.3.4">subscript</csymbol><ci id="S4.p8.8.m8.3.3.4.2.cmml" xref="S4.p8.8.m8.3.3.4.2">∇</ci><ci id="S4.p8.8.m8.3.3.4.3.cmml" xref="S4.p8.8.m8.3.3.4.3">italic-ϕ</ci></apply><apply id="S4.p8.8.m8.3.3.2.cmml" xref="S4.p8.8.m8.3.3.2"><times id="S4.p8.8.m8.3.3.2.3.cmml" xref="S4.p8.8.m8.3.3.2.3"></times><apply id="S4.p8.8.m8.3.3.2.4.cmml" xref="S4.p8.8.m8.3.3.2.4"><divide id="S4.p8.8.m8.3.3.2.4.1.cmml" xref="S4.p8.8.m8.3.3.2.4"></divide><cn type="integer" id="S4.p8.8.m8.3.3.2.4.2.cmml" xref="S4.p8.8.m8.3.3.2.4.2">1</cn><ci id="S4.p8.8.m8.3.3.2.4.3.cmml" xref="S4.p8.8.m8.3.3.2.4.3">𝑀</ci></apply><apply id="S4.p8.8.m8.3.3.2.2.cmml" xref="S4.p8.8.m8.3.3.2.2"><apply id="S4.p8.8.m8.3.3.2.2.3.cmml" xref="S4.p8.8.m8.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.p8.8.m8.3.3.2.2.3.1.cmml" xref="S4.p8.8.m8.3.3.2.2.3">subscript</csymbol><sum id="S4.p8.8.m8.3.3.2.2.3.2.cmml" xref="S4.p8.8.m8.3.3.2.2.3.2"></sum><ci id="S4.p8.8.m8.3.3.2.2.3.3.cmml" xref="S4.p8.8.m8.3.3.2.2.3.3">𝑚</ci></apply><apply id="S4.p8.8.m8.3.3.2.2.2.cmml" xref="S4.p8.8.m8.3.3.2.2.2"><times id="S4.p8.8.m8.3.3.2.2.2.3.cmml" xref="S4.p8.8.m8.3.3.2.2.2.3"></times><apply id="S4.p8.8.m8.2.2.1.1.1.1.2.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.p8.8.m8.2.2.1.1.1.1.2.1.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.p8.8.m8.2.2.1.1.1.1.1.1.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1"><minus id="S4.p8.8.m8.2.2.1.1.1.1.1.1.2.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.2"></minus><apply id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1"><times id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.2"></times><apply id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3"><log id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3.1"></log><ci id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.2">conditional</csymbol><ci id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑎</ci><list id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><ci id="S4.p8.8.m8.1.1.cmml" xref="S4.p8.8.m8.1.1">𝐢</ci><apply id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝐳</ci></apply></list></apply></apply><ci id="S4.p8.8.m8.2.2.1.1.1.1.1.1.3.cmml" xref="S4.p8.8.m8.2.2.1.1.1.1.1.1.3">𝐵</ci></apply></apply><apply id="S4.p8.8.m8.3.3.2.2.2.4.cmml" xref="S4.p8.8.m8.3.3.2.2.2.4"><apply id="S4.p8.8.m8.3.3.2.2.2.4.1.cmml" xref="S4.p8.8.m8.3.3.2.2.2.4.1"><apply id="S4.p8.8.m8.3.3.2.2.2.4.1.1.cmml" xref="S4.p8.8.m8.3.3.2.2.2.4.1.1"><csymbol cd="ambiguous" id="S4.p8.8.m8.3.3.2.2.2.4.1.1.1.cmml" xref="S4.p8.8.m8.3.3.2.2.2.4.1.1">subscript</csymbol><ci id="S4.p8.8.m8.3.3.2.2.2.4.1.1.2.cmml" xref="S4.p8.8.m8.3.3.2.2.2.4.1.1.2">∇</ci><ci id="S4.p8.8.m8.3.3.2.2.2.4.1.1.3.cmml" xref="S4.p8.8.m8.3.3.2.2.2.4.1.1.3">italic-ϕ</ci></apply><log id="S4.p8.8.m8.3.3.2.2.2.4.1.2.cmml" xref="S4.p8.8.m8.3.3.2.2.2.4.1.2"></log></apply><apply id="S4.p8.8.m8.3.3.2.2.2.4.2.cmml" xref="S4.p8.8.m8.3.3.2.2.2.4.2"><csymbol cd="ambiguous" id="S4.p8.8.m8.3.3.2.2.2.4.2.1.cmml" xref="S4.p8.8.m8.3.3.2.2.2.4.2">subscript</csymbol><ci id="S4.p8.8.m8.3.3.2.2.2.4.2.2.cmml" xref="S4.p8.8.m8.3.3.2.2.2.4.2.2">𝑞</ci><ci id="S4.p8.8.m8.3.3.2.2.2.4.2.3.cmml" xref="S4.p8.8.m8.3.3.2.2.2.4.2.3">italic-ϕ</ci></apply></apply><apply id="S4.p8.8.m8.3.3.2.2.2.2.1.1.cmml" xref="S4.p8.8.m8.3.3.2.2.2.2.1"><csymbol cd="latexml" id="S4.p8.8.m8.3.3.2.2.2.2.1.1.1.cmml" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.1">conditional</csymbol><ci id="S4.p8.8.m8.3.3.2.2.2.2.1.1.2.cmml" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.2">𝐳</ci><apply id="S4.p8.8.m8.3.3.2.2.2.2.1.1.3.cmml" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.p8.8.m8.3.3.2.2.2.2.1.1.3.1.cmml" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.3">superscript</csymbol><ci id="S4.p8.8.m8.3.3.2.2.2.2.1.1.3.2.cmml" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.3.2">𝐱</ci><ci id="S4.p8.8.m8.3.3.2.2.2.2.1.1.3.3.cmml" xref="S4.p8.8.m8.3.3.2.2.2.2.1.1.3.3">𝑚</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.8.m8.3c">\nabla_{\phi}=\frac{1}{M}\sum_{m}[\log p(a|\mathbf{i};\theta_{\mathbf{z}})-B]\nabla_{\phi}\log q_{\phi}(\mathbf{z}|\mathbf{x}^{m})</annotation></semantics></math>,
where B is a baseline.
In contrast, we follow Algorithm 1 and maximize the corresponding evidence at every
stage of training.
We also report other baselines which are either ablations of our model or deterministic
variants of our full model. See Appendix for the exact setting of the hyperparameters.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p"><span id="S5.p1.1.1" class="ltx_text ltx_font_bold">SHAPES results.</span>
We focus on evaluating approaches by varying
the fraction of question-aligned programs
(which we denote <math id="S5.p1.1.m1.1" class="ltx_math_unparsed" alttext="\%\mathbf{x}\leftrightarrow\mathbf{z}" display="inline"><semantics id="S5.p1.1.m1.1a"><mrow id="S5.p1.1.m1.1b"><mo id="S5.p1.1.m1.1.1">%</mo><mi id="S5.p1.1.m1.1.2">𝐱</mi><mo stretchy="false" id="S5.p1.1.m1.1.3">↔</mo><mi id="S5.p1.1.m1.1.4">𝐳</mi></mrow><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">\%\mathbf{x}\leftrightarrow\mathbf{z}</annotation></semantics></math>) in <a href="#S5.T1" title="In 5 Results ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>.
To put the numbers in context, a baseline LSTM + image model, which
does not use module networks, gets an accuracy of 63.0%
on Test (see <cite class="ltx_cite ltx_citemacro_citet">Andreas et al. (<a href="#bib.bib3" title="" class="ltx_ref">2016</a>)</cite>; Table 2). This indicates that SHAPES
has highly compositional questions which is challenging to model
via conventional methods for Visual Question Answering <cite class="ltx_cite ltx_citemacro_citep">(Agrawal et al., <a href="#bib.bib1" title="" class="ltx_ref">2015</a>)</cite>.
Overall, we make the following observations:</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"> -</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Our Prob-NMN approach consistently improves performance in data-sparse regimes.</span> While both methods tend to improve with greater program supervision,
Prob-NMN quickly outpaces NMN <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>, achieving test VQA accuracies 30-35% points higher for <math id="S5.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="{&gt;}5\%" display="inline"><semantics id="S5.I1.i1.p1.1.m1.1a"><mrow id="S5.I1.i1.p1.1.m1.1.1" xref="S5.I1.i1.p1.1.m1.1.1.cmml"><mi id="S5.I1.i1.p1.1.m1.1.1.2" xref="S5.I1.i1.p1.1.m1.1.1.2.cmml"></mi><mo id="S5.I1.i1.p1.1.m1.1.1.1" xref="S5.I1.i1.p1.1.m1.1.1.1.cmml">&gt;</mo><mrow id="S5.I1.i1.p1.1.m1.1.1.3" xref="S5.I1.i1.p1.1.m1.1.1.3.cmml"><mn id="S5.I1.i1.p1.1.m1.1.1.3.2" xref="S5.I1.i1.p1.1.m1.1.1.3.2.cmml">5</mn><mo id="S5.I1.i1.p1.1.m1.1.1.3.1" xref="S5.I1.i1.p1.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.1.m1.1b"><apply id="S5.I1.i1.p1.1.m1.1.1.cmml" xref="S5.I1.i1.p1.1.m1.1.1"><gt id="S5.I1.i1.p1.1.m1.1.1.1.cmml" xref="S5.I1.i1.p1.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S5.I1.i1.p1.1.m1.1.1.2.cmml" xref="S5.I1.i1.p1.1.m1.1.1.2">absent</csymbol><apply id="S5.I1.i1.p1.1.m1.1.1.3.cmml" xref="S5.I1.i1.p1.1.m1.1.1.3"><csymbol cd="latexml" id="S5.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="S5.I1.i1.p1.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S5.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="S5.I1.i1.p1.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.1.m1.1c">{&gt;}5\%</annotation></semantics></math> program supervision.
Notably, both methods perform similarly poorly on the test set given 5% program supervision, suggesting this may be too few examples to learn compositional reasoning.
<span id="S5.I1.i1.p1.1.2" class="ltx_text" style="color:#000000;">Similarly, we see that the program prediction accuracy is also significantly higher
for our approach at the end of joint training,
meaning that Prob-NMN is right for the right reasons.</span></p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"> -</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p"><span id="S5.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Our question coding stage greatly improves initial program prediction.</span>
Our Prob-NMN approach to question coding gets approximately
double the question coding (program prediction) accuracy
as the NMN approach (col 1, question coding). This means that it effectively
propagates groundings from question-aligned
programs during the coding phase. Thus the initial programs produced by our approach are more legible at a lower amount of supervision
than NMN.
Further, we also see improved VQA performance
after the module and joint training stages which are
based on predicted programs.</p>
</div>
<figure id="S5.F2" class="ltx_figure"><img src="/html/1902.07864/assets/x2.png" id="S5.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="189" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S5.F2.2.1" class="ltx_text ltx_font_bold">Data-efficient Legibility:</span> Image with the corresponding question, ground truth
program, and ground truth answer (top left). Predicted programs and answers of
different models (NMN in white, Prob-NMN in gray) and reconstructed question (Prob-NMN) for variable amount of supervision.
We find Prob-NMN finds
the right answer as well as the program more often than NMN <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>.</figcaption>
</figure>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"> -</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p"><span id="S5.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Successful joint training improves program prediction.</span>
<span id="S5.I1.i3.p1.1.2" class="ltx_text" style="color:#000000;">In general, we find that the accuracies obtained on program prediction deteriorate when the module training
stage is weak (row 1). On the other hand, higher program prediction accuracies generally lead to better module training,
which further improves the program prediction performance.</span></p>
</div>
</li>
</ul>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">Figure <a href="#S5.F2" title="Figure 2 ‣ 2nd item ‣ 5 Results ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows sample programs for each model. We see the limited supervision
negatively affects NMN program prediction,
with the 5% model resorting to simple <span id="S5.p2.1.1" class="ltx_text ltx_font_typewriter">Find[X]<math id="S5.p2.1.1.m1.1" class="ltx_Math" alttext="{\rightarrow}" display="inline"><semantics id="S5.p2.1.1.m1.1a"><mo stretchy="false" id="S5.p2.1.1.m1.1.1" xref="S5.p2.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S5.p2.1.1.m1.1b"><ci id="S5.p2.1.1.m1.1.1.cmml" xref="S5.p2.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.1.m1.1c">{\rightarrow}</annotation></semantics></math>Answer</span> structures.
Interestingly, we find that the mistakes made by the Prob-NMN model,
<em id="S5.p2.1.2" class="ltx_emph ltx_font_italic">e.g.</em>, green in 5% supervision (top-right) are also made when reconstructing
the question (also substituting green for blue). Further, when the token does get corrected to blue, the question also
eventually gets reconstructed (partially correctly (10%) and then fully (15%)),
and the program produces the correct answer.
This indicates that there is high fidelity between the learnt question space, the
answer space and the latent space.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Results (in percentage) on the SHAPES dataset with varying amounts of question-program supervision (<math id="S5.T1.3.m1.1" class="ltx_math_unparsed" alttext="\%\mathbf{x}\leftrightarrow\mathbf{z}" display="inline"><semantics id="S5.T1.3.m1.1b"><mrow id="S5.T1.3.m1.1c"><mo id="S5.T1.3.m1.1.1">%</mo><mi id="S5.T1.3.m1.1.2">𝐱</mi><mo stretchy="false" id="S5.T1.3.m1.1.3">↔</mo><mi id="S5.T1.3.m1.1.4">𝐳</mi></mrow><annotation encoding="application/x-tex" id="S5.T1.3.m1.1d">\%\mathbf{x}\leftrightarrow\mathbf{z}</annotation></semantics></math>), <math id="S5.T1.4.m2.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="S5.T1.4.m2.1b"><mrow id="S5.T1.4.m2.1.1" xref="S5.T1.4.m2.1.1.cmml"><mi id="S5.T1.4.m2.1.1.2" xref="S5.T1.4.m2.1.1.2.cmml">β</mi><mo id="S5.T1.4.m2.1.1.1" xref="S5.T1.4.m2.1.1.1.cmml">=</mo><mn id="S5.T1.4.m2.1.1.3" xref="S5.T1.4.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.4.m2.1c"><apply id="S5.T1.4.m2.1.1.cmml" xref="S5.T1.4.m2.1.1"><eq id="S5.T1.4.m2.1.1.1.cmml" xref="S5.T1.4.m2.1.1.1"></eq><ci id="S5.T1.4.m2.1.1.2.cmml" xref="S5.T1.4.m2.1.1.2">𝛽</ci><cn type="float" id="S5.T1.4.m2.1.1.3.cmml" xref="S5.T1.4.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.m2.1d">\beta=0.1</annotation></semantics></math>.</figcaption>
<div id="S5.T1.49" class="ltx_inline-block ltx_transformed_outer" style="width:411.9pt;height:149pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-82.5pt,29.7pt) scale(0.714118439281205,0.714118439281205) ;">
<table id="S5.T1.49.45" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.5.1.1" class="ltx_tr">
<th id="S5.T1.5.1.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<td id="S5.T1.5.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;" rowspan="3"><span id="S5.T1.5.1.1.1.1" class="ltx_text"><math id="S5.T1.5.1.1.1.1.m1.1" class="ltx_math_unparsed" alttext="\%\mathbf{x}\leftrightarrow\mathbf{z}" display="inline"><semantics id="S5.T1.5.1.1.1.1.m1.1a"><mrow id="S5.T1.5.1.1.1.1.m1.1b"><mo id="S5.T1.5.1.1.1.1.m1.1.1">%</mo><mi id="S5.T1.5.1.1.1.1.m1.1.2">𝐱</mi><mo stretchy="false" id="S5.T1.5.1.1.1.1.m1.1.3">↔</mo><mi id="S5.T1.5.1.1.1.1.m1.1.4">𝐳</mi></mrow><annotation encoding="application/x-tex" id="S5.T1.5.1.1.1.1.m1.1c">\%\mathbf{x}\leftrightarrow\mathbf{z}</annotation></semantics></math></span></td>
<td id="S5.T1.5.1.1.3" class="ltx_td ltx_align_top ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.5.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;" colspan="5">Validation During Training Stages</td>
<td id="S5.T1.5.1.1.5" class="ltx_td ltx_align_top ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.5.1.1.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;" rowspan="2"><span id="S5.T1.5.1.1.6.1" class="ltx_text">
<span id="S5.T1.5.1.1.6.1.1" class="ltx_inline-block ltx_align_center">
<span id="S5.T1.5.1.1.6.1.1.1" class="ltx_p"></span>
<span id="S5.T1.5.1.1.6.1.1.2" class="ltx_p">Test</span>
<span id="S5.T1.5.1.1.6.1.1.3" class="ltx_p">Accuracy</span>
</span></span></td>
</tr>
<tr id="S5.T1.49.45.46.1" class="ltx_tr">
<th id="S5.T1.49.45.46.1.1" class="ltx_td ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<td id="S5.T1.49.45.46.1.2" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.49.45.46.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;" colspan="2"><span id="S5.T1.49.45.46.1.3.1" class="ltx_text" style="font-size:80%;">[I] Question Coding</span></td>
<td id="S5.T1.49.45.46.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S5.T1.49.45.46.1.4.1" class="ltx_text" style="font-size:80%;">[II] Module Training</span></td>
<td id="S5.T1.49.45.46.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;" colspan="2"><span id="S5.T1.49.45.46.1.5.1" class="ltx_text" style="font-size:80%;">[III] Joint Training</span></td>
<td id="S5.T1.49.45.46.1.6" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr id="S5.T1.49.45.47.2" class="ltx_tr">
<th id="S5.T1.49.45.47.2.1" class="ltx_td ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<td id="S5.T1.49.45.47.2.2" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.49.45.47.2.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S5.T1.49.45.47.2.3.1" class="ltx_text" style="font-size:70%;">(Reconstruction)</span></td>
<td id="S5.T1.49.45.47.2.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">
<span id="S5.T1.49.45.47.2.4.1" class="ltx_inline-block ltx_align_center">
<span id="S5.T1.49.45.47.2.4.1.1" class="ltx_p"><span id="S5.T1.49.45.47.2.4.1.1.1" class="ltx_text" style="font-size:70%;">(Program Prediction)</span></span>
</span>
</td>
<td id="S5.T1.49.45.47.2.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S5.T1.49.45.47.2.5.1" class="ltx_text" style="font-size:70%;">(VQA Accuracy)</span></td>
<td id="S5.T1.49.45.47.2.6" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S5.T1.49.45.47.2.6.1" class="ltx_text" style="font-size:70%;">(Program Prediction)</span></td>
<td id="S5.T1.49.45.47.2.7" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S5.T1.49.45.47.2.7.1" class="ltx_text" style="font-size:70%;">(VQA Accuracy)</span></td>
<td id="S5.T1.49.45.47.2.8" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.49.45.47.2.9" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S5.T1.49.45.47.2.9.1" class="ltx_text" style="font-size:70%;">(VQA Accuracy)</span></td>
</tr>
<tr id="S5.T1.10.6.6" class="ltx_tr">
<th id="S5.T1.10.6.6.6" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">NMN <cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T1.10.6.6.6.1.1" class="ltx_text" style="font-size:50%;">(</span>Johnson et al.<span id="S5.T1.10.6.6.6.2.2.1.1" class="ltx_text" style="font-size:50%;">, </span><a href="#bib.bib19" title="" class="ltx_ref">2017</a><span id="S5.T1.10.6.6.6.3.3" class="ltx_text" style="font-size:50%;">)</span></cite>
</th>
<td id="S5.T1.10.6.6.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;" rowspan="2"><span id="S5.T1.10.6.6.7.1" class="ltx_text">5</span></td>
<td id="S5.T1.10.6.6.8" class="ltx_td ltx_align_top ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.10.6.6.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">-</td>
<td id="S5.T1.6.2.2.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">  9.28<math id="S5.T1.6.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.6.2.2.1.m1.1a"><mo mathsize="70%" id="S5.T1.6.2.2.1.m1.1.1" xref="S5.T1.6.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.6.2.2.1.m1.1b"><csymbol cd="latexml" id="S5.T1.6.2.2.1.m1.1.1.cmml" xref="S5.T1.6.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.2.2.1.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.6.2.2.1.1" class="ltx_text" style="font-size:70%;">1.91</span>
</td>
<td id="S5.T1.7.3.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">61.56<math id="S5.T1.7.3.3.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.7.3.3.2.m1.1a"><mo mathsize="70%" id="S5.T1.7.3.3.2.m1.1.1" xref="S5.T1.7.3.3.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.7.3.3.2.m1.1b"><csymbol cd="latexml" id="S5.T1.7.3.3.2.m1.1.1.cmml" xref="S5.T1.7.3.3.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.3.3.2.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.7.3.3.2.1" class="ltx_text" style="font-size:70%;">3.59</span>
</td>
<td id="S5.T1.8.4.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">0.0 <math id="S5.T1.8.4.4.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.8.4.4.3.m1.1a"><mo mathsize="70%" id="S5.T1.8.4.4.3.m1.1.1" xref="S5.T1.8.4.4.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.8.4.4.3.m1.1b"><csymbol cd="latexml" id="S5.T1.8.4.4.3.m1.1.1.cmml" xref="S5.T1.8.4.4.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.8.4.4.3.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.8.4.4.3.1" class="ltx_text" style="font-size:70%;">0.0</span>
</td>
<td id="S5.T1.9.5.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">63.08<math id="S5.T1.9.5.5.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.9.5.5.4.m1.1a"><mo mathsize="70%" id="S5.T1.9.5.5.4.m1.1.1" xref="S5.T1.9.5.5.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.9.5.5.4.m1.1b"><csymbol cd="latexml" id="S5.T1.9.5.5.4.m1.1.1.cmml" xref="S5.T1.9.5.5.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.9.5.5.4.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.9.5.5.4.1" class="ltx_text" style="font-size:70%;">0.78</span>
</td>
<td id="S5.T1.10.6.6.10" class="ltx_td ltx_align_top ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.10.6.6.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">60.06<math id="S5.T1.10.6.6.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.10.6.6.5.m1.1a"><mo mathsize="70%" id="S5.T1.10.6.6.5.m1.1.1" xref="S5.T1.10.6.6.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.10.6.6.5.m1.1b"><csymbol cd="latexml" id="S5.T1.10.6.6.5.m1.1.1.cmml" xref="S5.T1.10.6.6.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.10.6.6.5.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.10.6.6.5.1" class="ltx_text" style="font-size:70%;">3.88</span>
</td>
</tr>
<tr id="S5.T1.16.12.12" class="ltx_tr">
<th id="S5.T1.16.12.12.7" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">Prob-NMN<span id="S5.T1.16.12.12.7.1" class="ltx_text" style="font-size:50%;">(Ours)</span>
</th>
<td id="S5.T1.16.12.12.8" class="ltx_td ltx_align_top" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.11.7.7.1" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">62.86<math id="S5.T1.11.7.7.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.11.7.7.1.m1.1a"><mo mathsize="70%" id="S5.T1.11.7.7.1.m1.1.1" xref="S5.T1.11.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.11.7.7.1.m1.1b"><csymbol cd="latexml" id="S5.T1.11.7.7.1.m1.1.1.cmml" xref="S5.T1.11.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.11.7.7.1.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.11.7.7.1.1" class="ltx_text" style="font-size:70%;">5.31</span>
</td>
<td id="S5.T1.12.8.8.2" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">17.12<math id="S5.T1.12.8.8.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.12.8.8.2.m1.1a"><mo mathsize="70%" id="S5.T1.12.8.8.2.m1.1.1" xref="S5.T1.12.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.12.8.8.2.m1.1b"><csymbol cd="latexml" id="S5.T1.12.8.8.2.m1.1.1.cmml" xref="S5.T1.12.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.12.8.8.2.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.12.8.8.2.1" class="ltx_text" style="font-size:70%;">5.28</span>
</td>
<td id="S5.T1.13.9.9.3" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">54.55<math id="S5.T1.13.9.9.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.13.9.9.3.m1.1a"><mo mathsize="70%" id="S5.T1.13.9.9.3.m1.1.1" xref="S5.T1.13.9.9.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.13.9.9.3.m1.1b"><csymbol cd="latexml" id="S5.T1.13.9.9.3.m1.1.1.cmml" xref="S5.T1.13.9.9.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.13.9.9.3.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.13.9.9.3.1" class="ltx_text" style="font-size:70%;">11.31</span>
</td>
<td id="S5.T1.14.10.10.4" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">28.12 <math id="S5.T1.14.10.10.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.14.10.10.4.m1.1a"><mo mathsize="70%" id="S5.T1.14.10.10.4.m1.1.1" xref="S5.T1.14.10.10.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.14.10.10.4.m1.1b"><csymbol cd="latexml" id="S5.T1.14.10.10.4.m1.1.1.cmml" xref="S5.T1.14.10.10.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.14.10.10.4.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.14.10.10.4.1" class="ltx_text" style="font-size:70%;">28.12</span>
</td>
<td id="S5.T1.15.11.11.5" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">72.50<math id="S5.T1.15.11.11.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.15.11.11.5.m1.1a"><mo mathsize="70%" id="S5.T1.15.11.11.5.m1.1.1" xref="S5.T1.15.11.11.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.15.11.11.5.m1.1b"><csymbol cd="latexml" id="S5.T1.15.11.11.5.m1.1.1.cmml" xref="S5.T1.15.11.11.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.15.11.11.5.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.15.11.11.5.1" class="ltx_text" style="font-size:70%;">8.35</span>
</td>
<td id="S5.T1.16.12.12.9" class="ltx_td ltx_align_top" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.16.12.12.6" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">71.95<math id="S5.T1.16.12.12.6.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.16.12.12.6.m1.1a"><mo mathsize="70%" id="S5.T1.16.12.12.6.m1.1.1" xref="S5.T1.16.12.12.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.16.12.12.6.m1.1b"><csymbol cd="latexml" id="S5.T1.16.12.12.6.m1.1.1.cmml" xref="S5.T1.16.12.12.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.16.12.12.6.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.16.12.12.6.1" class="ltx_text" style="font-size:70%;">11.15</span>
</td>
</tr>
<tr id="S5.T1.21.17.17" class="ltx_tr">
<th id="S5.T1.21.17.17.6" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">NMN <cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T1.21.17.17.6.1.1" class="ltx_text" style="font-size:50%;">(</span>Johnson et al.<span id="S5.T1.21.17.17.6.2.2.1.1" class="ltx_text" style="font-size:50%;">, </span><a href="#bib.bib19" title="" class="ltx_ref">2017</a><span id="S5.T1.21.17.17.6.3.3" class="ltx_text" style="font-size:50%;">)</span></cite>
</th>
<td id="S5.T1.21.17.17.7" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;" rowspan="2"><span id="S5.T1.21.17.17.7.1" class="ltx_text">10</span></td>
<td id="S5.T1.21.17.17.8" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.21.17.17.9" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">-</td>
<td id="S5.T1.17.13.13.1" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">24.30<math id="S5.T1.17.13.13.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.17.13.13.1.m1.1a"><mo mathsize="70%" id="S5.T1.17.13.13.1.m1.1.1" xref="S5.T1.17.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.17.13.13.1.m1.1b"><csymbol cd="latexml" id="S5.T1.17.13.13.1.m1.1.1.cmml" xref="S5.T1.17.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.17.13.13.1.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.17.13.13.1.1" class="ltx_text" style="font-size:70%;">2.39</span>
</td>
<td id="S5.T1.18.14.14.2" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">60.31<math id="S5.T1.18.14.14.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.18.14.14.2.m1.1a"><mo mathsize="70%" id="S5.T1.18.14.14.2.m1.1.1" xref="S5.T1.18.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.18.14.14.2.m1.1b"><csymbol cd="latexml" id="S5.T1.18.14.14.2.m1.1.1.cmml" xref="S5.T1.18.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.18.14.14.2.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.18.14.14.2.1" class="ltx_text" style="font-size:70%;">3.37</span>
</td>
<td id="S5.T1.19.15.15.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">6.25 <math id="S5.T1.19.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.19.15.15.3.m1.1a"><mo mathsize="70%" id="S5.T1.19.15.15.3.m1.1.1" xref="S5.T1.19.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.19.15.15.3.m1.1b"><csymbol cd="latexml" id="S5.T1.19.15.15.3.m1.1.1.cmml" xref="S5.T1.19.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.19.15.15.3.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.19.15.15.3.1" class="ltx_text" style="font-size:70%;">10.83</span>
</td>
<td id="S5.T1.20.16.16.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">66.51<math id="S5.T1.20.16.16.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.20.16.16.4.m1.1a"><mo mathsize="70%" id="S5.T1.20.16.16.4.m1.1.1" xref="S5.T1.20.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.20.16.16.4.m1.1b"><csymbol cd="latexml" id="S5.T1.20.16.16.4.m1.1.1.cmml" xref="S5.T1.20.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.20.16.16.4.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.20.16.16.4.1" class="ltx_text" style="font-size:70%;">4.10</span>
</td>
<td id="S5.T1.21.17.17.10" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.21.17.17.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">61.99<math id="S5.T1.21.17.17.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.21.17.17.5.m1.1a"><mo mathsize="70%" id="S5.T1.21.17.17.5.m1.1.1" xref="S5.T1.21.17.17.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.21.17.17.5.m1.1b"><csymbol cd="latexml" id="S5.T1.21.17.17.5.m1.1.1.cmml" xref="S5.T1.21.17.17.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.21.17.17.5.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.21.17.17.5.1" class="ltx_text" style="font-size:70%;">0.96</span>
</td>
</tr>
<tr id="S5.T1.27.23.23" class="ltx_tr">
<th id="S5.T1.27.23.23.7" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">Prob-NMN<span id="S5.T1.27.23.23.7.1" class="ltx_text" style="font-size:50%;">(Ours)</span>
</th>
<td id="S5.T1.27.23.23.8" class="ltx_td ltx_align_top" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.22.18.18.1" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">83.60<math id="S5.T1.22.18.18.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.22.18.18.1.m1.1a"><mo mathsize="70%" id="S5.T1.22.18.18.1.m1.1.1" xref="S5.T1.22.18.18.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.22.18.18.1.m1.1b"><csymbol cd="latexml" id="S5.T1.22.18.18.1.m1.1.1.cmml" xref="S5.T1.22.18.18.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.22.18.18.1.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.22.18.18.1.1" class="ltx_text" style="font-size:70%;">5.57</span>
</td>
<td id="S5.T1.23.19.19.2" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">60.18<math id="S5.T1.23.19.19.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.23.19.19.2.m1.1a"><mo mathsize="70%" id="S5.T1.23.19.19.2.m1.1.1" xref="S5.T1.23.19.19.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.23.19.19.2.m1.1b"><csymbol cd="latexml" id="S5.T1.23.19.19.2.m1.1.1.cmml" xref="S5.T1.23.19.19.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.23.19.19.2.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.23.19.19.2.1" class="ltx_text" style="font-size:70%;">9.56</span>
</td>
<td id="S5.T1.24.20.20.3" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">75.80<math id="S5.T1.24.20.20.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.24.20.20.3.m1.1a"><mo mathsize="70%" id="S5.T1.24.20.20.3.m1.1.1" xref="S5.T1.24.20.20.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.24.20.20.3.m1.1b"><csymbol cd="latexml" id="S5.T1.24.20.20.3.m1.1.1.cmml" xref="S5.T1.24.20.20.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.24.20.20.3.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.24.20.20.3.1" class="ltx_text" style="font-size:70%;">3.62</span>
</td>
<td id="S5.T1.25.21.21.4" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">90.62<math id="S5.T1.25.21.21.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.25.21.21.4.m1.1a"><mo mathsize="70%" id="S5.T1.25.21.21.4.m1.1.1" xref="S5.T1.25.21.21.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.25.21.21.4.m1.1b"><csymbol cd="latexml" id="S5.T1.25.21.21.4.m1.1.1.cmml" xref="S5.T1.25.21.21.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.25.21.21.4.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.25.21.21.4.1" class="ltx_text" style="font-size:70%;">6.98</span>
</td>
<td id="S5.T1.26.22.22.5" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;"> 96.86<math id="S5.T1.26.22.22.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.26.22.22.5.m1.1a"><mo mathsize="70%" id="S5.T1.26.22.22.5.m1.1.1" xref="S5.T1.26.22.22.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.26.22.22.5.m1.1b"><csymbol cd="latexml" id="S5.T1.26.22.22.5.m1.1.1.cmml" xref="S5.T1.26.22.22.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.26.22.22.5.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.26.22.22.5.1" class="ltx_text" style="font-size:70%;">2.48</span>
</td>
<td id="S5.T1.27.23.23.9" class="ltx_td ltx_align_top" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.27.23.23.6" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;"> 94.53<math id="S5.T1.27.23.23.6.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.27.23.23.6.m1.1a"><mo mathsize="70%" id="S5.T1.27.23.23.6.m1.1.1" xref="S5.T1.27.23.23.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.27.23.23.6.m1.1b"><csymbol cd="latexml" id="S5.T1.27.23.23.6.m1.1.1.cmml" xref="S5.T1.27.23.23.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.27.23.23.6.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.27.23.23.6.1" class="ltx_text" style="font-size:70%;">2.06</span>
</td>
</tr>
<tr id="S5.T1.32.28.28" class="ltx_tr">
<th id="S5.T1.32.28.28.6" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">NMN <cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T1.32.28.28.6.1.1" class="ltx_text" style="font-size:50%;">(</span>Johnson et al.<span id="S5.T1.32.28.28.6.2.2.1.1" class="ltx_text" style="font-size:50%;">, </span><a href="#bib.bib19" title="" class="ltx_ref">2017</a><span id="S5.T1.32.28.28.6.3.3" class="ltx_text" style="font-size:50%;">)</span></cite>
</th>
<td id="S5.T1.32.28.28.7" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;" rowspan="2"><span id="S5.T1.32.28.28.7.1" class="ltx_text">15</span></td>
<td id="S5.T1.32.28.28.8" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.32.28.28.9" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">-</td>
<td id="S5.T1.28.24.24.1" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">47.67<math id="S5.T1.28.24.24.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.28.24.24.1.m1.1a"><mo mathsize="70%" id="S5.T1.28.24.24.1.m1.1.1" xref="S5.T1.28.24.24.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.28.24.24.1.m1.1b"><csymbol cd="latexml" id="S5.T1.28.24.24.1.m1.1.1.cmml" xref="S5.T1.28.24.24.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.28.24.24.1.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.28.24.24.1.1" class="ltx_text" style="font-size:70%;">5.02</span>
</td>
<td id="S5.T1.29.25.25.2" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">69.47<math id="S5.T1.29.25.25.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.29.25.25.2.m1.1a"><mo mathsize="70%" id="S5.T1.29.25.25.2.m1.1.1" xref="S5.T1.29.25.25.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.29.25.25.2.m1.1b"><csymbol cd="latexml" id="S5.T1.29.25.25.2.m1.1.1.cmml" xref="S5.T1.29.25.25.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.29.25.25.2.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.29.25.25.2.1" class="ltx_text" style="font-size:70%;">9.87</span>
</td>
<td id="S5.T1.30.26.26.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">0.0 <math id="S5.T1.30.26.26.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.30.26.26.3.m1.1a"><mo mathsize="70%" id="S5.T1.30.26.26.3.m1.1.1" xref="S5.T1.30.26.26.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.30.26.26.3.m1.1b"><csymbol cd="latexml" id="S5.T1.30.26.26.3.m1.1.1.cmml" xref="S5.T1.30.26.26.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.30.26.26.3.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.30.26.26.3.1" class="ltx_text" style="font-size:70%;">0.0</span>
</td>
<td id="S5.T1.31.27.27.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">62.43<math id="S5.T1.31.27.27.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.31.27.27.4.m1.1a"><mo mathsize="70%" id="S5.T1.31.27.27.4.m1.1.1" xref="S5.T1.31.27.27.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.31.27.27.4.m1.1b"><csymbol cd="latexml" id="S5.T1.31.27.27.4.m1.1.1.cmml" xref="S5.T1.31.27.27.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.31.27.27.4.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.31.27.27.4.1" class="ltx_text" style="font-size:70%;">0.49</span>
</td>
<td id="S5.T1.32.28.28.10" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.32.28.28.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">61.32<math id="S5.T1.32.28.28.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.32.28.28.5.m1.1a"><mo mathsize="70%" id="S5.T1.32.28.28.5.m1.1.1" xref="S5.T1.32.28.28.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.32.28.28.5.m1.1b"><csymbol cd="latexml" id="S5.T1.32.28.28.5.m1.1.1.cmml" xref="S5.T1.32.28.28.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.32.28.28.5.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.32.28.28.5.1" class="ltx_text" style="font-size:70%;">2.36</span>
</td>
</tr>
<tr id="S5.T1.38.34.34" class="ltx_tr">
<th id="S5.T1.38.34.34.7" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">Prob-NMN<span id="S5.T1.38.34.34.7.1" class="ltx_text" style="font-size:50%;">(Ours)</span>
</th>
<td id="S5.T1.38.34.34.8" class="ltx_td ltx_align_top" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.33.29.29.1" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">95.86<math id="S5.T1.33.29.29.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.33.29.29.1.m1.1a"><mo mathsize="70%" id="S5.T1.33.29.29.1.m1.1.1" xref="S5.T1.33.29.29.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.33.29.29.1.m1.1b"><csymbol cd="latexml" id="S5.T1.33.29.29.1.m1.1.1.cmml" xref="S5.T1.33.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.33.29.29.1.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.33.29.29.1.1" class="ltx_text" style="font-size:70%;">0.20</span>
</td>
<td id="S5.T1.34.30.30.2" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">84.85<math id="S5.T1.34.30.30.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.34.30.30.2.m1.1a"><mo mathsize="70%" id="S5.T1.34.30.30.2.m1.1.1" xref="S5.T1.34.30.30.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.34.30.30.2.m1.1b"><csymbol cd="latexml" id="S5.T1.34.30.30.2.m1.1.1.cmml" xref="S5.T1.34.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.34.30.30.2.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.34.30.30.2.1" class="ltx_text" style="font-size:70%;">6.25</span>
</td>
<td id="S5.T1.35.31.31.3" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">90.57<math id="S5.T1.35.31.31.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.35.31.31.3.m1.1a"><mo mathsize="70%" id="S5.T1.35.31.31.3.m1.1.1" xref="S5.T1.35.31.31.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.35.31.31.3.m1.1b"><csymbol cd="latexml" id="S5.T1.35.31.31.3.m1.1.1.cmml" xref="S5.T1.35.31.31.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.35.31.31.3.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.35.31.31.3.1" class="ltx_text" style="font-size:70%;">3.44</span>
</td>
<td id="S5.T1.36.32.32.4" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">95.31 <math id="S5.T1.36.32.32.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.36.32.32.4.m1.1a"><mo mathsize="70%" id="S5.T1.36.32.32.4.m1.1.1" xref="S5.T1.36.32.32.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.36.32.32.4.m1.1b"><csymbol cd="latexml" id="S5.T1.36.32.32.4.m1.1.1.cmml" xref="S5.T1.36.32.32.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.36.32.32.4.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.36.32.32.4.1" class="ltx_text" style="font-size:70%;">5.18</span>
</td>
<td id="S5.T1.37.33.33.5" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">98.40<math id="S5.T1.37.33.33.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.37.33.33.5.m1.1a"><mo mathsize="70%" id="S5.T1.37.33.33.5.m1.1.1" xref="S5.T1.37.33.33.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.37.33.33.5.m1.1b"><csymbol cd="latexml" id="S5.T1.37.33.33.5.m1.1.1.cmml" xref="S5.T1.37.33.33.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.37.33.33.5.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.37.33.33.5.1" class="ltx_text" style="font-size:70%;">1.63</span>
</td>
<td id="S5.T1.38.34.34.9" class="ltx_td ltx_align_top" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.38.34.34.6" class="ltx_td ltx_align_center" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">97.02<math id="S5.T1.38.34.34.6.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.38.34.34.6.m1.1a"><mo mathsize="70%" id="S5.T1.38.34.34.6.m1.1.1" xref="S5.T1.38.34.34.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.38.34.34.6.m1.1b"><csymbol cd="latexml" id="S5.T1.38.34.34.6.m1.1.1.cmml" xref="S5.T1.38.34.34.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.38.34.34.6.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.38.34.34.6.1" class="ltx_text" style="font-size:70%;">0.84</span>
</td>
</tr>
<tr id="S5.T1.43.39.39" class="ltx_tr">
<th id="S5.T1.43.39.39.6" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:3.0pt;padding-right:3.0pt;">NMN <cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T1.43.39.39.6.1.1" class="ltx_text" style="font-size:50%;">(</span>Johnson et al.<span id="S5.T1.43.39.39.6.2.2.1.1" class="ltx_text" style="font-size:50%;">, </span><a href="#bib.bib19" title="" class="ltx_ref">2017</a><span id="S5.T1.43.39.39.6.3.3" class="ltx_text" style="font-size:50%;">)</span></cite>
</th>
<td id="S5.T1.43.39.39.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;" rowspan="2"><span id="S5.T1.43.39.39.7.1" class="ltx_text">20</span></td>
<td id="S5.T1.43.39.39.8" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.43.39.39.9" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">-</td>
<td id="S5.T1.39.35.35.1" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">58.37<math id="S5.T1.39.35.35.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.39.35.35.1.m1.1a"><mo mathsize="70%" id="S5.T1.39.35.35.1.m1.1.1" xref="S5.T1.39.35.35.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.39.35.35.1.m1.1b"><csymbol cd="latexml" id="S5.T1.39.35.35.1.m1.1.1.cmml" xref="S5.T1.39.35.35.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.39.35.35.1.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.39.35.35.1.1" class="ltx_text" style="font-size:70%;">3.30</span>
</td>
<td id="S5.T1.40.36.36.2" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">66.17<math id="S5.T1.40.36.36.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.40.36.36.2.m1.1a"><mo mathsize="70%" id="S5.T1.40.36.36.2.m1.1.1" xref="S5.T1.40.36.36.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.40.36.36.2.m1.1b"><csymbol cd="latexml" id="S5.T1.40.36.36.2.m1.1.1.cmml" xref="S5.T1.40.36.36.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.40.36.36.2.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.40.36.36.2.1" class="ltx_text" style="font-size:70%;">7.02</span>
</td>
<td id="S5.T1.41.37.37.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">43.75 <math id="S5.T1.41.37.37.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.41.37.37.3.m1.1a"><mo mathsize="70%" id="S5.T1.41.37.37.3.m1.1.1" xref="S5.T1.41.37.37.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.41.37.37.3.m1.1b"><csymbol cd="latexml" id="S5.T1.41.37.37.3.m1.1.1.cmml" xref="S5.T1.41.37.37.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.41.37.37.3.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.41.37.37.3.1" class="ltx_text" style="font-size:70%;">43.75</span>
</td>
<td id="S5.T1.42.38.38.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">80.68<math id="S5.T1.42.38.38.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.42.38.38.4.m1.1a"><mo mathsize="70%" id="S5.T1.42.38.38.4.m1.1.1" xref="S5.T1.42.38.38.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.42.38.38.4.m1.1b"><csymbol cd="latexml" id="S5.T1.42.38.38.4.m1.1.1.cmml" xref="S5.T1.42.38.38.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.42.38.38.4.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.42.38.38.4.1" class="ltx_text" style="font-size:70%;">18.00</span>
</td>
<td id="S5.T1.43.39.39.10" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.43.39.39.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"> 78.59<math id="S5.T1.43.39.39.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.43.39.39.5.m1.1a"><mo mathsize="70%" id="S5.T1.43.39.39.5.m1.1.1" xref="S5.T1.43.39.39.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.43.39.39.5.m1.1b"><csymbol cd="latexml" id="S5.T1.43.39.39.5.m1.1.1.cmml" xref="S5.T1.43.39.39.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.43.39.39.5.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.43.39.39.5.1" class="ltx_text" style="font-size:70%;">19.27</span>
</td>
</tr>
<tr id="S5.T1.49.45.45" class="ltx_tr">
<th id="S5.T1.49.45.45.7" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">Prob-NMN<span id="S5.T1.49.45.45.7.1" class="ltx_text" style="font-size:50%;">(Ours)</span>
</th>
<td id="S5.T1.49.45.45.8" class="ltx_td ltx_align_top ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.44.40.40.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">96.10<math id="S5.T1.44.40.40.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.44.40.40.1.m1.1a"><mo mathsize="70%" id="S5.T1.44.40.40.1.m1.1.1" xref="S5.T1.44.40.40.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.44.40.40.1.m1.1b"><csymbol cd="latexml" id="S5.T1.44.40.40.1.m1.1.1.cmml" xref="S5.T1.44.40.40.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.44.40.40.1.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.44.40.40.1.1" class="ltx_text" style="font-size:70%;">0.27</span>
</td>
<td id="S5.T1.45.41.41.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">90.22<math id="S5.T1.45.41.41.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.45.41.41.2.m1.1a"><mo mathsize="70%" id="S5.T1.45.41.41.2.m1.1.1" xref="S5.T1.45.41.41.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.45.41.41.2.m1.1b"><csymbol cd="latexml" id="S5.T1.45.41.41.2.m1.1.1.cmml" xref="S5.T1.45.41.41.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.45.41.41.2.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.45.41.41.2.1" class="ltx_text" style="font-size:70%;">1.63</span>
</td>
<td id="S5.T1.46.42.42.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">91.81<math id="S5.T1.46.42.42.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.46.42.42.3.m1.1a"><mo mathsize="70%" id="S5.T1.46.42.42.3.m1.1.1" xref="S5.T1.46.42.42.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.46.42.42.3.m1.1b"><csymbol cd="latexml" id="S5.T1.46.42.42.3.m1.1.1.cmml" xref="S5.T1.46.42.42.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.46.42.42.3.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.46.42.42.3.1" class="ltx_text" style="font-size:70%;">1.58</span>
</td>
<td id="S5.T1.47.43.43.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">96.87 <math id="S5.T1.47.43.43.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.47.43.43.4.m1.1a"><mo mathsize="70%" id="S5.T1.47.43.43.4.m1.1.1" xref="S5.T1.47.43.43.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.47.43.43.4.m1.1b"><csymbol cd="latexml" id="S5.T1.47.43.43.4.m1.1.1.cmml" xref="S5.T1.47.43.43.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.47.43.43.4.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.47.43.43.4.1" class="ltx_text" style="font-size:70%;">5.41</span>
</td>
<td id="S5.T1.48.44.44.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">99.43<math id="S5.T1.48.44.44.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.48.44.44.5.m1.1a"><mo mathsize="70%" id="S5.T1.48.44.44.5.m1.1.1" xref="S5.T1.48.44.44.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.48.44.44.5.m1.1b"><csymbol cd="latexml" id="S5.T1.48.44.44.5.m1.1.1.cmml" xref="S5.T1.48.44.44.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.48.44.44.5.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.48.44.44.5.1" class="ltx_text" style="font-size:70%;">0.61</span>
</td>
<td id="S5.T1.49.45.45.9" class="ltx_td ltx_align_top ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T1.49.45.45.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.0pt;padding-right:3.0pt;">96.97<math id="S5.T1.49.45.45.6.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.49.45.45.6.m1.1a"><mo mathsize="70%" id="S5.T1.49.45.45.6.m1.1.1" xref="S5.T1.49.45.45.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.49.45.45.6.m1.1b"><csymbol cd="latexml" id="S5.T1.49.45.45.6.m1.1.1.cmml" xref="S5.T1.49.45.45.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.49.45.45.6.m1.1c">\pm</annotation></semantics></math><span id="S5.T1.49.45.45.6.1" class="ltx_text" style="font-size:70%;">1.30</span>
</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results (in percentage) on the CLEVR dataset with <math id="S5.T2.4.m1.1" class="ltx_Math" alttext="0.143" display="inline"><semantics id="S5.T2.4.m1.1b"><mn id="S5.T2.4.m1.1.1" xref="S5.T2.4.m1.1.1.cmml">0.143</mn><annotation-xml encoding="MathML-Content" id="S5.T2.4.m1.1c"><cn type="float" id="S5.T2.4.m1.1.1.cmml" xref="S5.T2.4.m1.1.1">0.143</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.m1.1d">0.143</annotation></semantics></math> % <math id="S5.T2.5.m2.1" class="ltx_Math" alttext="\mathbf{x}\leftrightarrow\mathbf{z}" display="inline"><semantics id="S5.T2.5.m2.1b"><mrow id="S5.T2.5.m2.1.1" xref="S5.T2.5.m2.1.1.cmml"><mi id="S5.T2.5.m2.1.1.2" xref="S5.T2.5.m2.1.1.2.cmml">𝐱</mi><mo stretchy="false" id="S5.T2.5.m2.1.1.1" xref="S5.T2.5.m2.1.1.1.cmml">↔</mo><mi id="S5.T2.5.m2.1.1.3" xref="S5.T2.5.m2.1.1.3.cmml">𝐳</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.5.m2.1c"><apply id="S5.T2.5.m2.1.1.cmml" xref="S5.T2.5.m2.1.1"><ci id="S5.T2.5.m2.1.1.1.cmml" xref="S5.T2.5.m2.1.1.1">↔</ci><ci id="S5.T2.5.m2.1.1.2.cmml" xref="S5.T2.5.m2.1.1.2">𝐱</ci><ci id="S5.T2.5.m2.1.1.3.cmml" xref="S5.T2.5.m2.1.1.3">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.m2.1d">\mathbf{x}\leftrightarrow\mathbf{z}</annotation></semantics></math>, <math id="S5.T2.6.m3.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="S5.T2.6.m3.1b"><mrow id="S5.T2.6.m3.1.1" xref="S5.T2.6.m3.1.1.cmml"><mi id="S5.T2.6.m3.1.1.2" xref="S5.T2.6.m3.1.1.2.cmml">β</mi><mo id="S5.T2.6.m3.1.1.1" xref="S5.T2.6.m3.1.1.1.cmml">=</mo><mn id="S5.T2.6.m3.1.1.3" xref="S5.T2.6.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.6.m3.1c"><apply id="S5.T2.6.m3.1.1.cmml" xref="S5.T2.6.m3.1.1"><eq id="S5.T2.6.m3.1.1.1.cmml" xref="S5.T2.6.m3.1.1.1"></eq><ci id="S5.T2.6.m3.1.1.2.cmml" xref="S5.T2.6.m3.1.1.2">𝛽</ci><cn type="float" id="S5.T2.6.m3.1.1.3.cmml" xref="S5.T2.6.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.m3.1d">\beta=0.1</annotation></semantics></math>. Validation metrics are calculated on a set of 20K examples out of CLEVR v1.0 validation split, across 15 random seeds. Test metrics are calculated on CLEVR v1.0 test split, and correspond to the best performing checkpoint across 15 random seeds.</figcaption>
<div id="S5.T2.15" class="ltx_inline-block ltx_transformed_outer" style="width:411.9pt;height:71.8pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-82.5pt,14.2pt) scale(0.714118439281205,0.714118439281205) ;">
<table id="S5.T2.15.9" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.7.1.1" class="ltx_tr">
<td id="S5.T2.7.1.1.2" class="ltx_td ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<th id="S5.T2.7.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;" rowspan="3"><span id="S5.T2.7.1.1.1.1" class="ltx_text"><math id="S5.T2.7.1.1.1.1.m1.1" class="ltx_math_unparsed" alttext="\%\mathbf{x}\leftrightarrow\mathbf{z}" display="inline"><semantics id="S5.T2.7.1.1.1.1.m1.1a"><mrow id="S5.T2.7.1.1.1.1.m1.1b"><mo id="S5.T2.7.1.1.1.1.m1.1.1">%</mo><mi id="S5.T2.7.1.1.1.1.m1.1.2">𝐱</mi><mo stretchy="false" id="S5.T2.7.1.1.1.1.m1.1.3">↔</mo><mi id="S5.T2.7.1.1.1.1.m1.1.4">𝐳</mi></mrow><annotation encoding="application/x-tex" id="S5.T2.7.1.1.1.1.m1.1c">\%\mathbf{x}\leftrightarrow\mathbf{z}</annotation></semantics></math></span></th>
<th id="S5.T2.7.1.1.3" class="ltx_td ltx_align_top ltx_th ltx_th_column ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<th id="S5.T2.7.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;" colspan="5">Validation During Training Stages</th>
<th id="S5.T2.7.1.1.5" class="ltx_td ltx_align_top ltx_th ltx_th_column ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<th id="S5.T2.7.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:3.0pt;padding-right:3.0pt;" rowspan="2"><span id="S5.T2.7.1.1.6.1" class="ltx_text">
<span id="S5.T2.7.1.1.6.1.1" class="ltx_inline-block ltx_align_center">
<span id="S5.T2.7.1.1.6.1.1.1" class="ltx_p"></span>
<span id="S5.T2.7.1.1.6.1.1.2" class="ltx_p">Test</span>
<span id="S5.T2.7.1.1.6.1.1.3" class="ltx_p">Accuracy</span>
</span></span></th>
</tr>
<tr id="S5.T2.15.9.10.1" class="ltx_tr">
<td id="S5.T2.15.9.10.1.1" class="ltx_td" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T2.15.9.10.1.2" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T2.15.9.10.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;" colspan="2"><span id="S5.T2.15.9.10.1.3.1" class="ltx_text" style="font-size:80%;">[I] Question Coding</span></td>
<td id="S5.T2.15.9.10.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S5.T2.15.9.10.1.4.1" class="ltx_text" style="font-size:80%;">[II] Module Training</span></td>
<td id="S5.T2.15.9.10.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;" colspan="2"><span id="S5.T2.15.9.10.1.5.1" class="ltx_text" style="font-size:80%;">[III] Joint Training</span></td>
<td id="S5.T2.15.9.10.1.6" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
</tr>
<tr id="S5.T2.15.9.11.2" class="ltx_tr">
<td id="S5.T2.15.9.11.2.1" class="ltx_td" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T2.15.9.11.2.2" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T2.15.9.11.2.3" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S5.T2.15.9.11.2.3.1" class="ltx_text" style="font-size:70%;">(Reconstruction)</span></td>
<td id="S5.T2.15.9.11.2.4" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;">
<span id="S5.T2.15.9.11.2.4.1" class="ltx_inline-block ltx_align_center">
<span id="S5.T2.15.9.11.2.4.1.1" class="ltx_p"><span id="S5.T2.15.9.11.2.4.1.1.1" class="ltx_text" style="font-size:70%;">(Program Prediction)</span></span>
</span>
</td>
<td id="S5.T2.15.9.11.2.5" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S5.T2.15.9.11.2.5.1" class="ltx_text" style="font-size:70%;">(VQA Accuracy)</span></td>
<td id="S5.T2.15.9.11.2.6" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S5.T2.15.9.11.2.6.1" class="ltx_text" style="font-size:70%;">(Program Prediction)</span></td>
<td id="S5.T2.15.9.11.2.7" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S5.T2.15.9.11.2.7.1" class="ltx_text" style="font-size:70%;">(VQA Accuracy)</span></td>
<td id="S5.T2.15.9.11.2.8" class="ltx_td ltx_align_top" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T2.15.9.11.2.9" class="ltx_td ltx_align_center" style="padding-left:3.0pt;padding-right:3.0pt;"><span id="S5.T2.15.9.11.2.9.1" class="ltx_text" style="font-size:70%;">(VQA Accuracy)</span></td>
</tr>
<tr id="S5.T2.11.5.5" class="ltx_tr">
<td id="S5.T2.11.5.5.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">NMN <cite class="ltx_cite ltx_citemacro_citep"><span id="S5.T2.11.5.5.5.1.1" class="ltx_text" style="font-size:50%;">(</span>Johnson et al.<span id="S5.T2.11.5.5.5.2.2.1.1" class="ltx_text" style="font-size:50%;">, </span><a href="#bib.bib19" title="" class="ltx_ref">2017</a><span id="S5.T2.11.5.5.5.3.3" class="ltx_text" style="font-size:50%;">)</span></cite>
</td>
<td id="S5.T2.11.5.5.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;" rowspan="2"><span id="S5.T2.11.5.5.6.1" class="ltx_text">0.143</span></td>
<td id="S5.T2.11.5.5.7" class="ltx_td ltx_align_top ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T2.11.5.5.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">-</td>
<td id="S5.T2.8.2.2.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">62.47<math id="S5.T2.8.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.8.2.2.1.m1.1a"><mo mathsize="70%" id="S5.T2.8.2.2.1.m1.1.1" xref="S5.T2.8.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.2.2.1.m1.1b"><csymbol cd="latexml" id="S5.T2.8.2.2.1.m1.1.1.cmml" xref="S5.T2.8.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.2.2.1.m1.1c">\pm</annotation></semantics></math><span id="S5.T2.8.2.2.1.1" class="ltx_text" style="font-size:70%;">9.82</span>
</td>
<td id="S5.T2.9.3.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">79.26<math id="S5.T2.9.3.3.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.9.3.3.2.m1.1a"><mo mathsize="70%" id="S5.T2.9.3.3.2.m1.1.1" xref="S5.T2.9.3.3.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.9.3.3.2.m1.1b"><csymbol cd="latexml" id="S5.T2.9.3.3.2.m1.1.1.cmml" xref="S5.T2.9.3.3.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.3.3.2.m1.1c">\pm</annotation></semantics></math><span id="S5.T2.9.3.3.2.1" class="ltx_text" style="font-size:70%;">4.03</span>
</td>
<td id="S5.T2.10.4.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">63.08 <math id="S5.T2.10.4.4.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.10.4.4.3.m1.1a"><mo mathsize="70%" id="S5.T2.10.4.4.3.m1.1.1" xref="S5.T2.10.4.4.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.10.4.4.3.m1.1b"><csymbol cd="latexml" id="S5.T2.10.4.4.3.m1.1.1.cmml" xref="S5.T2.10.4.4.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.4.4.3.m1.1c">\pm</annotation></semantics></math><span id="S5.T2.10.4.4.3.1" class="ltx_text" style="font-size:70%;">9.91</span>
</td>
<td id="S5.T2.11.5.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">79.38<math id="S5.T2.11.5.5.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.11.5.5.4.m1.1a"><mo mathsize="70%" id="S5.T2.11.5.5.4.m1.1.1" xref="S5.T2.11.5.5.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.11.5.5.4.m1.1b"><csymbol cd="latexml" id="S5.T2.11.5.5.4.m1.1.1.cmml" xref="S5.T2.11.5.5.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.5.5.4.m1.1c">\pm</annotation></semantics></math><span id="S5.T2.11.5.5.4.1" class="ltx_text" style="font-size:70%;">4.21</span>
</td>
<td id="S5.T2.11.5.5.9" class="ltx_td ltx_align_top ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T2.11.5.5.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.0pt;padding-right:3.0pt;">75.71</td>
</tr>
<tr id="S5.T2.15.9.9" class="ltx_tr">
<td id="S5.T2.15.9.9.5" class="ltx_td ltx_align_left ltx_border_bb" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">Prob-NMN<span id="S5.T2.15.9.9.5.1" class="ltx_text" style="font-size:50%;">(Ours)</span>
</td>
<td id="S5.T2.15.9.9.6" class="ltx_td ltx_align_top ltx_border_bb" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T2.15.9.9.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">-</td>
<td id="S5.T2.12.6.6.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">93.15<math id="S5.T2.12.6.6.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.12.6.6.1.m1.1a"><mo mathsize="70%" id="S5.T2.12.6.6.1.m1.1.1" xref="S5.T2.12.6.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.12.6.6.1.m1.1b"><csymbol cd="latexml" id="S5.T2.12.6.6.1.m1.1.1.cmml" xref="S5.T2.12.6.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.6.6.1.m1.1c">\pm</annotation></semantics></math><span id="S5.T2.12.6.6.1.1" class="ltx_text" style="font-size:70%;">8.61</span>
</td>
<td id="S5.T2.13.7.7.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">94.42<math id="S5.T2.13.7.7.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.13.7.7.2.m1.1a"><mo mathsize="70%" id="S5.T2.13.7.7.2.m1.1.1" xref="S5.T2.13.7.7.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.13.7.7.2.m1.1b"><csymbol cd="latexml" id="S5.T2.13.7.7.2.m1.1.1.cmml" xref="S5.T2.13.7.7.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.7.7.2.m1.1c">\pm</annotation></semantics></math><span id="S5.T2.13.7.7.2.1" class="ltx_text" style="font-size:70%;">3.77</span>
</td>
<td id="S5.T2.14.8.8.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">93.87 <math id="S5.T2.14.8.8.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.14.8.8.3.m1.1a"><mo mathsize="70%" id="S5.T2.14.8.8.3.m1.1.1" xref="S5.T2.14.8.8.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.14.8.8.3.m1.1b"><csymbol cd="latexml" id="S5.T2.14.8.8.3.m1.1.1.cmml" xref="S5.T2.14.8.8.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.8.8.3.m1.1c">\pm</annotation></semantics></math><span id="S5.T2.14.8.8.3.1" class="ltx_text" style="font-size:70%;">8.73</span>
</td>
<td id="S5.T2.15.9.9.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">95.52<math id="S5.T2.15.9.9.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.15.9.9.4.m1.1a"><mo mathsize="70%" id="S5.T2.15.9.9.4.m1.1.1" xref="S5.T2.15.9.9.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.15.9.9.4.m1.1b"><csymbol cd="latexml" id="S5.T2.15.9.9.4.m1.1.1.cmml" xref="S5.T2.15.9.9.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.9.9.4.m1.1c">\pm</annotation></semantics></math><span id="S5.T2.15.9.9.4.1" class="ltx_text" style="font-size:70%;">4.15</span>
</td>
<td id="S5.T2.15.9.9.8" class="ltx_td ltx_align_top ltx_border_bb" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;"></td>
<td id="S5.T2.15.9.9.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-bottom:6.0pt;padding-left:3.0pt;padding-right:3.0pt;">97.73</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">Finally, the N2NMN approach <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>)</cite> evaluates their question-attention based module networks in the fully unsupervised setting,
getting to 96.19% on TEST. However, the programs in this case
become non-compositional (see <a href="#S3" title="3 Related Work ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3</span></a>), as the model leaks information from questions to answers via attention,
meaning that programs no longer carry the burden of explaining the observed answers. This makes the modules illegible. In general,
our approach makes the right independence assumptions (<math id="S5.p3.1.m1.2" class="ltx_Math" alttext="a\perp\mathbf{x}|\mathbf{i},\mathbf{z}" display="inline"><semantics id="S5.p3.1.m1.2a"><mrow id="S5.p3.1.m1.2.3" xref="S5.p3.1.m1.2.3.cmml"><mi id="S5.p3.1.m1.2.3.2" xref="S5.p3.1.m1.2.3.2.cmml">a</mi><mo id="S5.p3.1.m1.2.3.1" xref="S5.p3.1.m1.2.3.1.cmml">⟂</mo><mrow id="S5.p3.1.m1.2.3.3" xref="S5.p3.1.m1.2.3.3.cmml"><mi id="S5.p3.1.m1.2.3.3.2" xref="S5.p3.1.m1.2.3.3.2.cmml">𝐱</mi><mo fence="false" id="S5.p3.1.m1.2.3.3.1" xref="S5.p3.1.m1.2.3.3.1.cmml">|</mo><mrow id="S5.p3.1.m1.2.3.3.3.2" xref="S5.p3.1.m1.2.3.3.3.1.cmml"><mi id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml">𝐢</mi><mo id="S5.p3.1.m1.2.3.3.3.2.1" xref="S5.p3.1.m1.2.3.3.3.1.cmml">,</mo><mi id="S5.p3.1.m1.2.2" xref="S5.p3.1.m1.2.2.cmml">𝐳</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.2b"><apply id="S5.p3.1.m1.2.3.cmml" xref="S5.p3.1.m1.2.3"><csymbol cd="latexml" id="S5.p3.1.m1.2.3.1.cmml" xref="S5.p3.1.m1.2.3.1">perpendicular-to</csymbol><ci id="S5.p3.1.m1.2.3.2.cmml" xref="S5.p3.1.m1.2.3.2">𝑎</ci><apply id="S5.p3.1.m1.2.3.3.cmml" xref="S5.p3.1.m1.2.3.3"><csymbol cd="latexml" id="S5.p3.1.m1.2.3.3.1.cmml" xref="S5.p3.1.m1.2.3.3.1">conditional</csymbol><ci id="S5.p3.1.m1.2.3.3.2.cmml" xref="S5.p3.1.m1.2.3.3.2">𝐱</ci><list id="S5.p3.1.m1.2.3.3.3.1.cmml" xref="S5.p3.1.m1.2.3.3.3.2"><ci id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1">𝐢</ci><ci id="S5.p3.1.m1.2.2.cmml" xref="S5.p3.1.m1.2.2">𝐳</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.2c">a\perp\mathbf{x}|\mathbf{i},\mathbf{z}</annotation></semantics></math>) which helps legibility to emerge, along with our
careful design of the three stage optimization procedure.</p>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.1" class="ltx_p"><span id="S5.p4.1.1" class="ltx_text" style="color:#000000;">In the Appendix, we show additional
comparisons to a deterministic variant of our model (with <math id="S5.p4.1.1.m1.1" class="ltx_Math" alttext="\beta=0" display="inline"><semantics id="S5.p4.1.1.m1.1a"><mrow id="S5.p4.1.1.m1.1.1" xref="S5.p4.1.1.m1.1.1.cmml"><mi mathcolor="#000000" id="S5.p4.1.1.m1.1.1.2" xref="S5.p4.1.1.m1.1.1.2.cmml">β</mi><mo mathcolor="#000000" id="S5.p4.1.1.m1.1.1.1" xref="S5.p4.1.1.m1.1.1.1.cmml">=</mo><mn mathcolor="#000000" id="S5.p4.1.1.m1.1.1.3" xref="S5.p4.1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p4.1.1.m1.1b"><apply id="S5.p4.1.1.m1.1.1.cmml" xref="S5.p4.1.1.m1.1.1"><eq id="S5.p4.1.1.m1.1.1.1.cmml" xref="S5.p4.1.1.m1.1.1.1"></eq><ci id="S5.p4.1.1.m1.1.1.2.cmml" xref="S5.p4.1.1.m1.1.1.2">𝛽</ci><cn type="integer" id="S5.p4.1.1.m1.1.1.3.cmml" xref="S5.p4.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.1.1.m1.1c">\beta=0</annotation></semantics></math>), and study the effect of optimizing the true ELBO.</span></p>
</div>
<div id="S5.p5" class="ltx_para ltx_noindent">
<p id="S5.p5.8" class="ltx_p"><span id="S5.p5.8.1" class="ltx_text ltx_font_bold">CLEVR Results.</span> Our results on the CLEVR dataset <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite> reflect similar trends as the results
on SHAPES (<a href="#S5.T2" title="In 5 Results ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">2</span></a>). As explained in <a href="#S4" title="4 Experimental Setup ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4</span></a>, we work with 1000 supervised question
program examples from the CLEVR dataset (0.143% of all question program pairs).
With this, at the end of question coding, Prob-NMN gets to an accuracy of 93.15 <math id="S5.p5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.p5.1.m1.1a"><mo id="S5.p5.1.m1.1.1" xref="S5.p5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.p5.1.m1.1b"><csymbol cd="latexml" id="S5.p5.1.m1.1.1.cmml" xref="S5.p5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.1.m1.1c">\pm</annotation></semantics></math> 8.61,
while the baseline NMN approach gets to an accuracy of 62.47 <math id="S5.p5.2.m2.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.p5.2.m2.1a"><mo id="S5.p5.2.m2.1.1" xref="S5.p5.2.m2.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.p5.2.m2.1b"><csymbol cd="latexml" id="S5.p5.2.m2.1.1.cmml" xref="S5.p5.2.m2.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.2.m2.1c">\pm</annotation></semantics></math> 9.82.
These gains for the Prob-NMN model are reflected
in module training, where the Prob-NMN approach gets to an accuracy of 94.42 <math id="S5.p5.3.m3.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.p5.3.m3.1a"><mo id="S5.p5.3.m3.1.1" xref="S5.p5.3.m3.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.p5.3.m3.1b"><csymbol cd="latexml" id="S5.p5.3.m3.1.1.cmml" xref="S5.p5.3.m3.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.3.m3.1c">\pm</annotation></semantics></math> 3.77,
while the baseline is at 79.26 <math id="S5.p5.4.m4.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.p5.4.m4.1a"><mo id="S5.p5.4.m4.1.1" xref="S5.p5.4.m4.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.p5.4.m4.1b"><csymbol cd="latexml" id="S5.p5.4.m4.1.1.cmml" xref="S5.p5.4.m4.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.4.m4.1c">\pm</annotation></semantics></math> 4.03. At the end of joint training these improve
marginally to 95.52 <math id="S5.p5.5.m5.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.p5.5.m5.1a"><mo id="S5.p5.5.m5.1.1" xref="S5.p5.5.m5.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.p5.5.m5.1b"><csymbol cd="latexml" id="S5.p5.5.m5.1.1.cmml" xref="S5.p5.5.m5.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.5.m5.1c">\pm</annotation></semantics></math> 4.15 and 79.38 <math id="S5.p5.6.m6.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.p5.6.m6.1a"><mo id="S5.p5.6.m6.1.1" xref="S5.p5.6.m6.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.p5.6.m6.1b"><csymbol cd="latexml" id="S5.p5.6.m6.1.1.cmml" xref="S5.p5.6.m6.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.6.m6.1c">\pm</annotation></semantics></math> 4.21 respectively. Crucially, this is achieved
with a program generation accuracy of 93.87 <math id="S5.p5.7.m7.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.p5.7.m7.1a"><mo id="S5.p5.7.m7.1.1" xref="S5.p5.7.m7.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.p5.7.m7.1b"><csymbol cd="latexml" id="S5.p5.7.m7.1.1.cmml" xref="S5.p5.7.m7.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.7.m7.1c">\pm</annotation></semantics></math> 8.73 by our approach compared to a baseline
accuracy of 63.08 <math id="S5.p5.8.m8.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.p5.8.m8.1a"><mo id="S5.p5.8.m8.1.1" xref="S5.p5.8.m8.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.p5.8.m8.1b"><csymbol cd="latexml" id="S5.p5.8.m8.1.1.cmml" xref="S5.p5.8.m8.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.8.m8.1c">\pm</annotation></semantics></math> 9.91. Thus, the programs generated by the Prob-NMN model are more
legible than those by the semi-supervised NMN approach <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>. Finally, the same
trends are reflected on the CLEVR test set as well, with Prob-NMN outperforming NMN.
We refer to the Appendix for more details of the training regime and architectural choices
<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>We find the question reconstruction accuracy is close to zero, since
the model often decodes to a semantically equivalent question string which an exact match
does not recover, thus omit that number from <a href="#S5.T2" title="In 5 Results ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">2</span></a>.”</span></span></span>.</p>
</div>
<div id="S5.p6" class="ltx_para ltx_noindent">
<p id="S5.p6.1" class="ltx_p"><span id="S5.p6.1.1" class="ltx_text ltx_font_bold">Coherence and Sensitivity in Reasoning.</span>
Next we show that the probabilistic formulation can be used to
check a model’s coherence in reasoning (see <a href="#S5.F3" title="In 5 Results ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a>, top). Given
the image and the answer <span id="S5.p6.1.2" class="ltx_text ltx_font_typewriter">yes</span>, we observe that one is able to generate multiple,
diverse reasoning patterns which lead to the answer, by sampling <math id="S5.p6.1.m1.3" class="ltx_Math" alttext="\mathbf{z}\sim p(\mathbf{z}|a,\mathbf{i})" display="inline"><semantics id="S5.p6.1.m1.3a"><mrow id="S5.p6.1.m1.3.3" xref="S5.p6.1.m1.3.3.cmml"><mi id="S5.p6.1.m1.3.3.3" xref="S5.p6.1.m1.3.3.3.cmml">𝐳</mi><mo id="S5.p6.1.m1.3.3.2" xref="S5.p6.1.m1.3.3.2.cmml">∼</mo><mrow id="S5.p6.1.m1.3.3.1" xref="S5.p6.1.m1.3.3.1.cmml"><mi id="S5.p6.1.m1.3.3.1.3" xref="S5.p6.1.m1.3.3.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S5.p6.1.m1.3.3.1.2" xref="S5.p6.1.m1.3.3.1.2.cmml">​</mo><mrow id="S5.p6.1.m1.3.3.1.1.1" xref="S5.p6.1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S5.p6.1.m1.3.3.1.1.1.2" xref="S5.p6.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S5.p6.1.m1.3.3.1.1.1.1" xref="S5.p6.1.m1.3.3.1.1.1.1.cmml"><mi id="S5.p6.1.m1.3.3.1.1.1.1.2" xref="S5.p6.1.m1.3.3.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S5.p6.1.m1.3.3.1.1.1.1.1" xref="S5.p6.1.m1.3.3.1.1.1.1.1.cmml">|</mo><mrow id="S5.p6.1.m1.3.3.1.1.1.1.3.2" xref="S5.p6.1.m1.3.3.1.1.1.1.3.1.cmml"><mi id="S5.p6.1.m1.1.1" xref="S5.p6.1.m1.1.1.cmml">a</mi><mo id="S5.p6.1.m1.3.3.1.1.1.1.3.2.1" xref="S5.p6.1.m1.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="S5.p6.1.m1.2.2" xref="S5.p6.1.m1.2.2.cmml">𝐢</mi></mrow></mrow><mo stretchy="false" id="S5.p6.1.m1.3.3.1.1.1.3" xref="S5.p6.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p6.1.m1.3b"><apply id="S5.p6.1.m1.3.3.cmml" xref="S5.p6.1.m1.3.3"><csymbol cd="latexml" id="S5.p6.1.m1.3.3.2.cmml" xref="S5.p6.1.m1.3.3.2">similar-to</csymbol><ci id="S5.p6.1.m1.3.3.3.cmml" xref="S5.p6.1.m1.3.3.3">𝐳</ci><apply id="S5.p6.1.m1.3.3.1.cmml" xref="S5.p6.1.m1.3.3.1"><times id="S5.p6.1.m1.3.3.1.2.cmml" xref="S5.p6.1.m1.3.3.1.2"></times><ci id="S5.p6.1.m1.3.3.1.3.cmml" xref="S5.p6.1.m1.3.3.1.3">𝑝</ci><apply id="S5.p6.1.m1.3.3.1.1.1.1.cmml" xref="S5.p6.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S5.p6.1.m1.3.3.1.1.1.1.1.cmml" xref="S5.p6.1.m1.3.3.1.1.1.1.1">conditional</csymbol><ci id="S5.p6.1.m1.3.3.1.1.1.1.2.cmml" xref="S5.p6.1.m1.3.3.1.1.1.1.2">𝐳</ci><list id="S5.p6.1.m1.3.3.1.1.1.1.3.1.cmml" xref="S5.p6.1.m1.3.3.1.1.1.1.3.2"><ci id="S5.p6.1.m1.1.1.cmml" xref="S5.p6.1.m1.1.1">𝑎</ci><ci id="S5.p6.1.m1.2.2.cmml" xref="S5.p6.1.m1.2.2">𝐢</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.1.m1.3c">\mathbf{z}\sim p(\mathbf{z}|a,\mathbf{i})</annotation></semantics></math>,
showing a kind of systematicity in reasoning <cite class="ltx_cite ltx_citemacro_citep">(Lake et al., <a href="#bib.bib26" title="" class="ltx_ref">2017</a>)</cite>. On the other hand,
when we change the answer to <span id="S5.p6.1.3" class="ltx_text ltx_font_typewriter">no</span> (see <a href="#S5.F3" title="In 5 Results ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a>, bottom),
keeping the image the same, we observe
that the reasoning pattern changes meaningfully, yielding a program that evaluates
to the desired answer. See Appendix for a description of how we do the sampling and results
on CLEVR.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/1902.07864/assets/x3.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="368" height="313" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S5.F3.2.1" class="ltx_text ltx_font_bold">Coherence and Sensitivity</span>: Image and a correponding answer are specified,
and the model is asked to produce programs it believes should
lead to the particular answer for the given image. One can notice that the generated
programs are consistent with each other, and evaluate to
the specified answer. Results are shown for a Prob-NMN model
trained with 20% program supervision on SHAPES.</figcaption>
</figure>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussion and Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this work, we discussed a probabilistic, sequential latent variable model for visual question answering, that jointly learns to parse
questions into programs, reasons about abstract programs,
and learns to execute them on images using modular neural networks.
We demonstrate that the probabilistic model endows the model with desirable properties
for interpretable reasoning systems, such as the reasoning being clearly legible given minimal number of teaching examples, and
the ability to probe into the reasoning patterns of the model, by testing their coherence (how consistent are the reasoning
patterns which lead to the same decision?) and sensitivity (how sensitive is the decision to the reasoning pattern?).
We test our model on the <span id="S6.p1.1.1" class="ltx_text" style="color:#000000;">CLEVR dataset as well as a dataset of compositional questions</span>
about SHAPES and find that handling stochasticity enables better generalization
to compositionally novel inputs.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agrawal et al. (2015)</span>
<span class="ltx_bibblock">
Agrawal, A., Lu, J., Antol, S., Mitchell, M., Lawrence Zitnick, C., Batra, D.,
and Parikh, D.

</span>
<span class="ltx_bibblock">VQA: Visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Intl. Conf. on Computer Vision</em>, May 2015.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alemi et al. (2018)</span>
<span class="ltx_bibblock">
Alemi, A. A., Poole, B., Fischer, I., Dillon, J. V., Saurous, R. A., and
Murphy, K.

</span>
<span class="ltx_bibblock">Fixing a broken ELBO.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andreas et al. (2016)</span>
<span class="ltx_bibblock">
Andreas, J., Rohrbach, M., Darrell, T., and Klein, D.

</span>
<span class="ltx_bibblock">Neural module networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2016.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andreas et al. (2017)</span>
<span class="ltx_bibblock">
Andreas, J., Klein, D., and Levine, S.

</span>
<span class="ltx_bibblock">Modular multitask reinforcement learning with policy sketches.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2017.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bader &amp; Hitzler (2005)</span>
<span class="ltx_bibblock">
Bader, S. and Hitzler, P.

</span>
<span class="ltx_bibblock">Dimensions of neural-symbolic integration - a structured survey.

</span>
<span class="ltx_bibblock">November 2005.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bahdanau et al. (2015)</span>
<span class="ltx_bibblock">
Bahdanau, D., Cho, K., and Bengio, Y.

</span>
<span class="ltx_bibblock">Neural machine translation by jointly learning to align and
translate.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2015.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bottou (2011)</span>
<span class="ltx_bibblock">
Bottou, L.

</span>
<span class="ltx_bibblock">From machine learning to machine reasoning.

</span>
<span class="ltx_bibblock">February 2011.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bowman et al. (2016)</span>
<span class="ltx_bibblock">
Bowman, S. R., Vilnis, L., Vinyals, O., Dai, A. M., Jozefowicz, R., and Bengio,
S.

</span>
<span class="ltx_bibblock">Generating sentences from a continuous space.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proc. Conf. Natural Language Learning (CoNLL)</em>, 2016.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1511.06349" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1511.06349</a>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Das et al. (2016)</span>
<span class="ltx_bibblock">
Das, A., Agrawal, H., Lawrence Zitnick, C., Parikh, D., and Batra, D.

</span>
<span class="ltx_bibblock">Human attention in visual question answering: Do humans and deep
networks look at the same regions?

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proc. Empirical Methods in Natural Language Processing</em>,
2016.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Das et al. (2018)</span>
<span class="ltx_bibblock">
Das, A., Gkioxari, G., Lee, S., Parikh, D., and Batra, D.

</span>
<span class="ltx_bibblock">Neural modular control for embodied question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Conference on Robot Learning</em>, 2018.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dragan et al. (2013)</span>
<span class="ltx_bibblock">
Dragan, A. D., Lee, K. C. T., and Srinivasa, S. S.

</span>
<span class="ltx_bibblock">Legibility and predictability of robot motion.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 8th ACM/IEEE International Conference
on Human-robot Interaction</em>, HRI ’13, pp.  301–308, Piscataway, NJ, USA,
2013. IEEE Press.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Evans et al. (2018)</span>
<span class="ltx_bibblock">
Evans, R., Saxton, D., Amos, D., Kohli, P., and Grefenstette, E.

</span>
<span class="ltx_bibblock">Can neural networks understand logical entailment?

</span>
<span class="ltx_bibblock">February 2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gaunt et al. (2017)</span>
<span class="ltx_bibblock">
Gaunt, A. L., Brockschmidt, M., Kushman, N., and others.

</span>
<span class="ltx_bibblock">Lifelong perceptual programming by example.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2017.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., and Sun, J.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2016.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter &amp; Schmidhuber (1997)</span>
<span class="ltx_bibblock">
Hochreiter, S. and Schmidhuber, J.

</span>
<span class="ltx_bibblock">Long Short-Term memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Neural Comput.</em>, 9(8):1735–1780, November
1997.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2017)</span>
<span class="ltx_bibblock">
Hu, R., Andreas, J., Rohrbach, M., Darrell, T., and Saenko, K.

</span>
<span class="ltx_bibblock">Learning to reason: End-to-End module networks for visual question
answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2018)</span>
<span class="ltx_bibblock">
Hu, R., Andreas, J., Darrell, T., and Saenko, K.

</span>
<span class="ltx_bibblock">Explainable neural computation via stack neural module networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2018.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson &amp; Manning (2018)</span>
<span class="ltx_bibblock">
Hudson, D. A. and Manning, C. D.

</span>
<span class="ltx_bibblock">Compositional attention networks for machine reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2018.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al. (2017)</span>
<span class="ltx_bibblock">
Johnson, J., Hariharan, B., van der Maaten, L., Hoffman, J., Fei-Fei, L.,
Lawrence Zitnick, C., and Girshick, R.

</span>
<span class="ltx_bibblock">Inferring and executing programs for visual reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Intl. Conf. on Computer Vision</em>, 2017.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jordan et al. (1999)</span>
<span class="ltx_bibblock">
Jordan, M. I., Ghahramani, Z., Jaakkola, T. S., and Saul, L. K.

</span>
<span class="ltx_bibblock">An introduction to variational methods for graphical models.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">J. of Machine Learning Research</em>, 37(2):183–233, November 1999.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Keng (2017)</span>
<span class="ltx_bibblock">
Keng, B.

</span>
<span class="ltx_bibblock">Semi-supervised learning with variational autoencoders, September
2017.

</span>
<span class="ltx_bibblock">Accessed: 2019-1-14.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Welling (2014)</span>
<span class="ltx_bibblock">
Kingma, D. P. and Welling, M.

</span>
<span class="ltx_bibblock">Auto-Encoding variational bayes.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2014.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma et al. (2014)</span>
<span class="ltx_bibblock">
Kingma, D. P., Rezende, D. J., Mohamed, S., and Welling, M.

</span>
<span class="ltx_bibblock">Semi-supervised learning with deep generative models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2014.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2012)</span>
<span class="ltx_bibblock">
Krizhevsky, A., Sutskever, I., and Hinton, G. E.

</span>
<span class="ltx_bibblock">ImageNet classification with deep convolutional neural networks.

</span>
<span class="ltx_bibblock">In Pereira, F., Burges, C. J. C., Bottou, L., and Weinberger, K. Q.
(eds.), <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 25</em>, pp. 1097–1105. Curran Associates, Inc., 2012.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lake &amp; Baroni (2018)</span>
<span class="ltx_bibblock">
Lake, B. M. and Baroni, M.

</span>
<span class="ltx_bibblock">Generalization without systematicity: On the compositional skills of
sequence-to-sequence recurrent networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2018.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lake et al. (2017)</span>
<span class="ltx_bibblock">
Lake, B. M., Ullman, T. D., Tenenbaum, J. B., and Gershman, S. J.

</span>
<span class="ltx_bibblock">Building machines that learn and think like people.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Behav. Brain Sci.</em>, 40:e253, January 2017.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">LeCun et al. (2015)</span>
<span class="ltx_bibblock">
LeCun, Y., Bengio, Y., and Hinton, G.

</span>
<span class="ltx_bibblock">Deep learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Nature</em>, 521(7553):436–444, May 2015.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2016)</span>
<span class="ltx_bibblock">
Lu, J., Yang, J., Batra, D., and Parikh, D.

</span>
<span class="ltx_bibblock">Hierarchical Question-Image Co-Attention for visual question
answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2016.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2017)</span>
<span class="ltx_bibblock">
Lu, J., Xiong, C., Parikh, D., and Socher, R.

</span>
<span class="ltx_bibblock">Knowing when to look: Adaptive attention via a visual sentinel for
image captioning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mao et al. (2019)</span>
<span class="ltx_bibblock">
Mao, J., Gan, C., Kohli, P., Tenenbaum, J. B., and Wu, J.

</span>
<span class="ltx_bibblock">The Neuro-Symbolic concept learner: Interpreting scenes, words, and
sentences from natural supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mascharka et al. (2018)</span>
<span class="ltx_bibblock">
Mascharka, D., Tran, P., Soklaski, R., and Majumdar, A.

</span>
<span class="ltx_bibblock">Transparency by design: Closing the gap between performance and
interpretability in visual reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2018.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miao &amp; Blunsom (2016)</span>
<span class="ltx_bibblock">
Miao, Y. and Blunsom, P.

</span>
<span class="ltx_bibblock">Language as a latent variable: Discrete generative models for
sentence compression.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proc. Empirical Methods in Natural Language Processing</em>,
2016.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1609.07317" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1609.07317</a>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mnih et al. (2015)</span>
<span class="ltx_bibblock">
Mnih, V., Kavukcuoglu, K., Silver, D., Rusu, A. A., Veness, J., Bellemare,
M. G., Graves, A., Riedmiller, M., Fidjeland, A. K., Ostrovski, G., Petersen,
S., Beattie, C., Sadik, A., Antonoglou, I., King, H., Kumaran, D., Wierstra,
D., Legg, S., and Hassabis, D.

</span>
<span class="ltx_bibblock">Human-level control through deep reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Nature</em>, 518:529, February 2015.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mudrakarta et al. (2018)</span>
<span class="ltx_bibblock">
Mudrakarta, P. K., Taly, A., Sundararajan, M., and Dhamdhere, K.

</span>
<span class="ltx_bibblock">Did the model understand the question?

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proc. ACL</em>, 2018.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Newell &amp; Simon (1976)</span>
<span class="ltx_bibblock">
Newell, A. and Simon, H. A.

</span>
<span class="ltx_bibblock">Computer science as empirical inquiry: Symbols and search.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Commun. ACM</em>, 19(3):113–126, March 1976.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park et al. (2018)</span>
<span class="ltx_bibblock">
Park, D. H., Hendricks, L. A., Akata, Z., Rohrbach, A., Schiele, B., Darrell,
T., and Rohrbach, M.

</span>
<span class="ltx_bibblock">Multimodal explanations: Justifying decisions and pointing to the
evidence.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2018.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Perez et al. (2018)</span>
<span class="ltx_bibblock">
Perez, E., Strub, F., de Vries, H., Dumoulin, V., and Courville, A.

</span>
<span class="ltx_bibblock">FiLM: Visual reasoning with a general conditioning layer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">AAAI</em>, 2018.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rezende et al. (2014)</span>
<span class="ltx_bibblock">
Rezende, D. J., Mohamed, S., and Wierstra, D.

</span>
<span class="ltx_bibblock">Stochastic backpropagation and approximate inference in deep
generative models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2014.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Santoro et al. (2017)</span>
<span class="ltx_bibblock">
Santoro, A., Raposo, D., Barrett, D. G. T., Malinowski, M., Pascanu, R.,
Battaglia, P., and Lillicrap, T.

</span>
<span class="ltx_bibblock">A simple neural network module for relational reasoning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2017.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Selvaraju et al. (2017)</span>
<span class="ltx_bibblock">
Selvaraju, R. R., Cogswell, M., Das, A., Vedantam, R., Parikh, D., and Batra,
D.

</span>
<span class="ltx_bibblock">Grad-CAM: Visual explanations from deep networks via gradient-based
localization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Intl. Conf. on Computer Vision</em>, 2017.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutskever et al. (2014)</span>
<span class="ltx_bibblock">
Sutskever, I., Vinyals, O., and Le, Q. V.

</span>
<span class="ltx_bibblock">Sequence to sequence learning with neural networks.

</span>
<span class="ltx_bibblock">In Ghahramani, Z., Welling, M., Cortes, C., Lawrence, N. D., and
Weinberger, K. Q. (eds.), <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems 27</em>, pp.  3104–3112. Curran Associates, Inc., 2014.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Suzuki et al. (2017)</span>
<span class="ltx_bibblock">
Suzuki, M., Nakayama, K., and Matsuo, Y.

</span>
<span class="ltx_bibblock">Joint multimodal learning with deep generative models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">ICLR Workshop</em>, 2017.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tenenbaum (1999)</span>
<span class="ltx_bibblock">
Tenenbaum, J. B. j. B.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">A Bayesian framework for concept learning</em>.

</span>
<span class="ltx_bibblock">PhD thesis, Massachusetts Institute of Technology, 1999.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Valiant (2003)</span>
<span class="ltx_bibblock">
Valiant, L. G.

</span>
<span class="ltx_bibblock">Three problems in computer science.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">J. ACM</em>, 50(1):96–99, January 2003.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Valkov et al. (2018)</span>
<span class="ltx_bibblock">
Valkov, L., Chaudhari, D., Srivastava, A., Sutton, C., and Chaudhuri, S.

</span>
<span class="ltx_bibblock">HOUDINI: Lifelong learning as program synthesis.

</span>
<span class="ltx_bibblock">In Bengio, S., Wallach, H., Larochelle, H., Grauman, K.,
Cesa-Bianchi, N., and Garnett, R. (eds.), <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">NIPS</em>. 2018.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van den Oord et al. (2016)</span>
<span class="ltx_bibblock">
van den Oord, A., Dieleman, S., Zen, H., Simonyan, K., Vinyals, O., Graves, A.,
Kalchbrenner, N., Senior, A., and Kavukcuoglu, K.

</span>
<span class="ltx_bibblock">WaveNet: A generative model for raw audio.

</span>
<span class="ltx_bibblock">September 2016.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vedantam et al. (2018)</span>
<span class="ltx_bibblock">
Vedantam, R., Fischer, I., Huang, J., and Murphy, K.

</span>
<span class="ltx_bibblock">Generative models of visually grounded imagination.

</span>
<span class="ltx_bibblock">In <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2018.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vinyals et al. (2015)</span>
<span class="ltx_bibblock">
Vinyals, O., Toshev, A., Bengio, S., and Erhan, D.

</span>
<span class="ltx_bibblock">Show and tell: A neural image caption generator.

</span>
<span class="ltx_bibblock">In <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2015.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weston et al. (2016)</span>
<span class="ltx_bibblock">
Weston, J., Bordes, A., Chopra, S., Rush, A. M., van Merrienboer, B., Joulin,
A., and Mikolov, T.

</span>
<span class="ltx_bibblock">Towards AI-Complete question answering: A set of prerequisite toy
tasks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2016.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams (1992)</span>
<span class="ltx_bibblock">
Williams, R. J.

</span>
<span class="ltx_bibblock">Simple statistical gradient-following algorithms for connectionist
reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Mach. Learn.</em>, 8(3):229–256, May 1992.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yadav et al. (2019)</span>
<span class="ltx_bibblock">
Yadav, D., Jain, R., Agrawal, H., Chattopadhyay, P., Singh, T., Jain, A.,
Singh, S. B., Lee, S., and Batra, D.

</span>
<span class="ltx_bibblock">Evalai: Towards better evaluation systems for ai agents.

</span>
<span class="ltx_bibblock">2019.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yi et al. (2018)</span>
<span class="ltx_bibblock">
Yi, K., Wu, J., Gan, C., Torralba, A., Kohli, P., and Tenenbaum, J. B.

</span>
<span class="ltx_bibblock">Neural-Symbolic VQA: Disentangling reasoning from vision and
language understanding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2018.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2018)</span>
<span class="ltx_bibblock">
Yin, P., Zhou, C., He, J., and Neubig, G.

</span>
<span class="ltx_bibblock">StructVAE: Tree-structured latent variable models for
semi-supervised semantic parsing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">Proc. ACL</em>, 2018.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>A variational lower bound on the evidence for sequential latent variable models</h2>

<div id="Thmnonumlemmax1" class="ltx_theorem ltx_theorem_nonumlemma">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmnonumlemmax1.1.1.1" class="ltx_text ltx_font_bold">Lemma</span></span><span id="Thmnonumlemmax1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmnonumlemmax1.p1" class="ltx_para">
<p id="Thmnonumlemmax1.p1.9" class="ltx_p"><span id="Thmnonumlemmax1.p1.9.9" class="ltx_text ltx_font_italic">Given observations <math id="Thmnonumlemmax1.p1.1.1.m1.2" class="ltx_Math" alttext="\{\mathbf{x}^{n},\mathbf{z}^{n}\}" display="inline"><semantics id="Thmnonumlemmax1.p1.1.1.m1.2a"><mrow id="Thmnonumlemmax1.p1.1.1.m1.2.2.2" xref="Thmnonumlemmax1.p1.1.1.m1.2.2.3.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.1.1.m1.2.2.2.3" xref="Thmnonumlemmax1.p1.1.1.m1.2.2.3.cmml">{</mo><msup id="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1" xref="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1.cmml"><mi id="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1.2" xref="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1.2.cmml">𝐱</mi><mi id="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1.3" xref="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1.3.cmml">n</mi></msup><mo id="Thmnonumlemmax1.p1.1.1.m1.2.2.2.4" xref="Thmnonumlemmax1.p1.1.1.m1.2.2.3.cmml">,</mo><msup id="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2" xref="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2.cmml"><mi id="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2.2" xref="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2.2.cmml">𝐳</mi><mi id="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2.3" xref="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2.3.cmml">n</mi></msup><mo stretchy="false" id="Thmnonumlemmax1.p1.1.1.m1.2.2.2.5" xref="Thmnonumlemmax1.p1.1.1.m1.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.1.1.m1.2b"><set id="Thmnonumlemmax1.p1.1.1.m1.2.2.3.cmml" xref="Thmnonumlemmax1.p1.1.1.m1.2.2.2"><apply id="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1">superscript</csymbol><ci id="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1.2">𝐱</ci><ci id="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.1.1.m1.1.1.1.1.3">𝑛</ci></apply><apply id="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2.cmml" xref="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2.1.cmml" xref="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2">superscript</csymbol><ci id="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2.2.cmml" xref="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2.2">𝐳</ci><ci id="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2.3.cmml" xref="Thmnonumlemmax1.p1.1.1.m1.2.2.2.2.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.1.1.m1.2c">\{\mathbf{x}^{n},\mathbf{z}^{n}\}</annotation></semantics></math> and <math id="Thmnonumlemmax1.p1.2.2.m2.4" class="ltx_Math" alttext="p(\mathbf{x},\mathbf{z})=p(\mathbf{z})p_{\sigma}(\mathbf{x}|\mathbf{z})" display="inline"><semantics id="Thmnonumlemmax1.p1.2.2.m2.4a"><mrow id="Thmnonumlemmax1.p1.2.2.m2.4.4" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.cmml"><mrow id="Thmnonumlemmax1.p1.2.2.m2.4.4.3" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.3.cmml"><mi id="Thmnonumlemmax1.p1.2.2.m2.4.4.3.2" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.2.2.m2.4.4.3.1" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.3.1.cmml">​</mo><mrow id="Thmnonumlemmax1.p1.2.2.m2.4.4.3.3.2" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.3.3.1.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.2.2.m2.4.4.3.3.2.1" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.3.3.1.cmml">(</mo><mi id="Thmnonumlemmax1.p1.2.2.m2.1.1" xref="Thmnonumlemmax1.p1.2.2.m2.1.1.cmml">𝐱</mi><mo id="Thmnonumlemmax1.p1.2.2.m2.4.4.3.3.2.2" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.3.3.1.cmml">,</mo><mi id="Thmnonumlemmax1.p1.2.2.m2.2.2" xref="Thmnonumlemmax1.p1.2.2.m2.2.2.cmml">𝐳</mi><mo stretchy="false" id="Thmnonumlemmax1.p1.2.2.m2.4.4.3.3.2.3" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo id="Thmnonumlemmax1.p1.2.2.m2.4.4.2" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.2.cmml">=</mo><mrow id="Thmnonumlemmax1.p1.2.2.m2.4.4.1" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.cmml"><mi id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.3" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.2" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.2.cmml">​</mo><mrow id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.4.2" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.4.2.1" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.cmml">(</mo><mi id="Thmnonumlemmax1.p1.2.2.m2.3.3" xref="Thmnonumlemmax1.p1.2.2.m2.3.3.cmml">𝐳</mi><mo stretchy="false" id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.4.2.2" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.2a" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.2.cmml">​</mo><msub id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5.cmml"><mi id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5.2" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5.2.cmml">p</mi><mi id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5.3" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5.3.cmml">σ</mi></msub><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.2b" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.2.cmml">​</mo><mrow id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.2" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.cmml">(</mo><mrow id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.cmml"><mi id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.2" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.1" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.1.cmml">|</mo><mi id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.3" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.3.cmml">𝐳</mi></mrow><mo stretchy="false" id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.3" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.2.2.m2.4b"><apply id="Thmnonumlemmax1.p1.2.2.m2.4.4.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4"><eq id="Thmnonumlemmax1.p1.2.2.m2.4.4.2.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.2"></eq><apply id="Thmnonumlemmax1.p1.2.2.m2.4.4.3.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.3"><times id="Thmnonumlemmax1.p1.2.2.m2.4.4.3.1.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.3.1"></times><ci id="Thmnonumlemmax1.p1.2.2.m2.4.4.3.2.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.3.2">𝑝</ci><interval closure="open" id="Thmnonumlemmax1.p1.2.2.m2.4.4.3.3.1.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.3.3.2"><ci id="Thmnonumlemmax1.p1.2.2.m2.1.1.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.1.1">𝐱</ci><ci id="Thmnonumlemmax1.p1.2.2.m2.2.2.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.2.2">𝐳</ci></interval></apply><apply id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1"><times id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.2.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.2"></times><ci id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.3.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.3">𝑝</ci><ci id="Thmnonumlemmax1.p1.2.2.m2.3.3.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.3.3">𝐳</ci><apply id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5.1.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5">subscript</csymbol><ci id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5.2.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5.2">𝑝</ci><ci id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5.3.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.5.3">𝜎</ci></apply><apply id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1"><csymbol cd="latexml" id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.1">conditional</csymbol><ci id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.2">𝐱</ci><ci id="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.2.2.m2.4.4.1.1.1.1.3">𝐳</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.2.2.m2.4c">p(\mathbf{x},\mathbf{z})=p(\mathbf{z})p_{\sigma}(\mathbf{x}|\mathbf{z})</annotation></semantics></math>,
let <math id="Thmnonumlemmax1.p1.3.3.m3.1" class="ltx_Math" alttext="z_{t}" display="inline"><semantics id="Thmnonumlemmax1.p1.3.3.m3.1a"><msub id="Thmnonumlemmax1.p1.3.3.m3.1.1" xref="Thmnonumlemmax1.p1.3.3.m3.1.1.cmml"><mi id="Thmnonumlemmax1.p1.3.3.m3.1.1.2" xref="Thmnonumlemmax1.p1.3.3.m3.1.1.2.cmml">z</mi><mi id="Thmnonumlemmax1.p1.3.3.m3.1.1.3" xref="Thmnonumlemmax1.p1.3.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.3.3.m3.1b"><apply id="Thmnonumlemmax1.p1.3.3.m3.1.1.cmml" xref="Thmnonumlemmax1.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.3.3.m3.1.1.1.cmml" xref="Thmnonumlemmax1.p1.3.3.m3.1.1">subscript</csymbol><ci id="Thmnonumlemmax1.p1.3.3.m3.1.1.2.cmml" xref="Thmnonumlemmax1.p1.3.3.m3.1.1.2">𝑧</ci><ci id="Thmnonumlemmax1.p1.3.3.m3.1.1.3.cmml" xref="Thmnonumlemmax1.p1.3.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.3.3.m3.1c">z_{t}</annotation></semantics></math>, the token at the <math id="Thmnonumlemmax1.p1.4.4.m4.1" class="ltx_Math" alttext="t^{th}" display="inline"><semantics id="Thmnonumlemmax1.p1.4.4.m4.1a"><msup id="Thmnonumlemmax1.p1.4.4.m4.1.1" xref="Thmnonumlemmax1.p1.4.4.m4.1.1.cmml"><mi id="Thmnonumlemmax1.p1.4.4.m4.1.1.2" xref="Thmnonumlemmax1.p1.4.4.m4.1.1.2.cmml">t</mi><mrow id="Thmnonumlemmax1.p1.4.4.m4.1.1.3" xref="Thmnonumlemmax1.p1.4.4.m4.1.1.3.cmml"><mi id="Thmnonumlemmax1.p1.4.4.m4.1.1.3.2" xref="Thmnonumlemmax1.p1.4.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.4.4.m4.1.1.3.1" xref="Thmnonumlemmax1.p1.4.4.m4.1.1.3.1.cmml">​</mo><mi id="Thmnonumlemmax1.p1.4.4.m4.1.1.3.3" xref="Thmnonumlemmax1.p1.4.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.4.4.m4.1b"><apply id="Thmnonumlemmax1.p1.4.4.m4.1.1.cmml" xref="Thmnonumlemmax1.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.4.4.m4.1.1.1.cmml" xref="Thmnonumlemmax1.p1.4.4.m4.1.1">superscript</csymbol><ci id="Thmnonumlemmax1.p1.4.4.m4.1.1.2.cmml" xref="Thmnonumlemmax1.p1.4.4.m4.1.1.2">𝑡</ci><apply id="Thmnonumlemmax1.p1.4.4.m4.1.1.3.cmml" xref="Thmnonumlemmax1.p1.4.4.m4.1.1.3"><times id="Thmnonumlemmax1.p1.4.4.m4.1.1.3.1.cmml" xref="Thmnonumlemmax1.p1.4.4.m4.1.1.3.1"></times><ci id="Thmnonumlemmax1.p1.4.4.m4.1.1.3.2.cmml" xref="Thmnonumlemmax1.p1.4.4.m4.1.1.3.2">𝑡</ci><ci id="Thmnonumlemmax1.p1.4.4.m4.1.1.3.3.cmml" xref="Thmnonumlemmax1.p1.4.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.4.4.m4.1c">t^{th}</annotation></semantics></math> timestep in a sequence <math id="Thmnonumlemmax1.p1.5.5.m5.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="Thmnonumlemmax1.p1.5.5.m5.1a"><mi id="Thmnonumlemmax1.p1.5.5.m5.1.1" xref="Thmnonumlemmax1.p1.5.5.m5.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.5.5.m5.1b"><ci id="Thmnonumlemmax1.p1.5.5.m5.1.1.cmml" xref="Thmnonumlemmax1.p1.5.5.m5.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.5.5.m5.1c">\mathbf{z}</annotation></semantics></math> be distributed
as a categorical with parameters <math id="Thmnonumlemmax1.p1.6.6.m6.1" class="ltx_Math" alttext="\pi_{t}" display="inline"><semantics id="Thmnonumlemmax1.p1.6.6.m6.1a"><msub id="Thmnonumlemmax1.p1.6.6.m6.1.1" xref="Thmnonumlemmax1.p1.6.6.m6.1.1.cmml"><mi id="Thmnonumlemmax1.p1.6.6.m6.1.1.2" xref="Thmnonumlemmax1.p1.6.6.m6.1.1.2.cmml">π</mi><mi id="Thmnonumlemmax1.p1.6.6.m6.1.1.3" xref="Thmnonumlemmax1.p1.6.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.6.6.m6.1b"><apply id="Thmnonumlemmax1.p1.6.6.m6.1.1.cmml" xref="Thmnonumlemmax1.p1.6.6.m6.1.1"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.6.6.m6.1.1.1.cmml" xref="Thmnonumlemmax1.p1.6.6.m6.1.1">subscript</csymbol><ci id="Thmnonumlemmax1.p1.6.6.m6.1.1.2.cmml" xref="Thmnonumlemmax1.p1.6.6.m6.1.1.2">𝜋</ci><ci id="Thmnonumlemmax1.p1.6.6.m6.1.1.3.cmml" xref="Thmnonumlemmax1.p1.6.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.6.6.m6.1c">\pi_{t}</annotation></semantics></math>. Let us denote
<math id="Thmnonumlemmax1.p1.7.7.m7.1" class="ltx_Math" alttext="\Pi=\{\pi_{t}\}_{t=1}^{T}" display="inline"><semantics id="Thmnonumlemmax1.p1.7.7.m7.1a"><mrow id="Thmnonumlemmax1.p1.7.7.m7.1.1" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.cmml"><mi mathvariant="normal" id="Thmnonumlemmax1.p1.7.7.m7.1.1.3" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.3.cmml">Π</mi><mo id="Thmnonumlemmax1.p1.7.7.m7.1.1.2" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.2.cmml">=</mo><msubsup id="Thmnonumlemmax1.p1.7.7.m7.1.1.1" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.cmml"><mrow id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.2" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.2.cmml">{</mo><msub id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1.cmml"><mi id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1.2" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1.2.cmml">π</mi><mi id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1.3" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.3" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.cmml"><mi id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.2" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.2.cmml">t</mi><mo id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.1" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.1.cmml">=</mo><mn id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.3" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.3" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.3.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.7.7.m7.1b"><apply id="Thmnonumlemmax1.p1.7.7.m7.1.1.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1"><eq id="Thmnonumlemmax1.p1.7.7.m7.1.1.2.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.2"></eq><ci id="Thmnonumlemmax1.p1.7.7.m7.1.1.3.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.3">Π</ci><apply id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1">superscript</csymbol><apply id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1">subscript</csymbol><set id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1"><apply id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1">subscript</csymbol><ci id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1.2">𝜋</ci><ci id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3"><eq id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.1.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.1"></eq><ci id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.2.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.3.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.1.3.3">1</cn></apply></apply><ci id="Thmnonumlemmax1.p1.7.7.m7.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.7.7.m7.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.7.7.m7.1c">\Pi=\{\pi_{t}\}_{t=1}^{T}</annotation></semantics></math>, the joint random variable over all <math id="Thmnonumlemmax1.p1.8.8.m8.1" class="ltx_Math" alttext="\pi_{t}" display="inline"><semantics id="Thmnonumlemmax1.p1.8.8.m8.1a"><msub id="Thmnonumlemmax1.p1.8.8.m8.1.1" xref="Thmnonumlemmax1.p1.8.8.m8.1.1.cmml"><mi id="Thmnonumlemmax1.p1.8.8.m8.1.1.2" xref="Thmnonumlemmax1.p1.8.8.m8.1.1.2.cmml">π</mi><mi id="Thmnonumlemmax1.p1.8.8.m8.1.1.3" xref="Thmnonumlemmax1.p1.8.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.8.8.m8.1b"><apply id="Thmnonumlemmax1.p1.8.8.m8.1.1.cmml" xref="Thmnonumlemmax1.p1.8.8.m8.1.1"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.8.8.m8.1.1.1.cmml" xref="Thmnonumlemmax1.p1.8.8.m8.1.1">subscript</csymbol><ci id="Thmnonumlemmax1.p1.8.8.m8.1.1.2.cmml" xref="Thmnonumlemmax1.p1.8.8.m8.1.1.2">𝜋</ci><ci id="Thmnonumlemmax1.p1.8.8.m8.1.1.3.cmml" xref="Thmnonumlemmax1.p1.8.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.8.8.m8.1c">\pi_{t}</annotation></semantics></math>. Then,
the following is a lower bound on the joint evidence <math id="Thmnonumlemmax1.p1.9.9.m9.2" class="ltx_Math" alttext="\mathcal{L}=\sum_{n}\log p(\mathbf{z}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})" display="inline"><semantics id="Thmnonumlemmax1.p1.9.9.m9.2a"><mrow id="Thmnonumlemmax1.p1.9.9.m9.2.2" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmnonumlemmax1.p1.9.9.m9.2.2.4" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.4.cmml">ℒ</mi><mo rspace="0.111em" id="Thmnonumlemmax1.p1.9.9.m9.2.2.3" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.3.cmml">=</mo><mrow id="Thmnonumlemmax1.p1.9.9.m9.2.2.2" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.cmml"><mrow id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.cmml"><msub id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2.cmml"><mo id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2.2" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2.2.cmml">∑</mo><mi id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2.3" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2.3.cmml">n</mi></msub><mrow id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.cmml"><mrow id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3.cmml"><mi id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3.1" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3a" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3.cmml">⁡</mo><mi id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3.2" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.2" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.2.cmml">​</mo><mrow id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.2" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.cmml"><mi id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.2" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.3" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo stretchy="false" id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.3" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.3" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.3.cmml">+</mo><mrow id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.cmml"><mrow id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.cmml"><mi id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.1" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3a" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.cmml">⁡</mo><msub id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2.cmml"><mi id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2.2" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2.2.cmml">p</mi><mi id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2.3" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2.3.cmml">σ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.2" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.2.cmml">​</mo><mrow id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.2" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.cmml">(</mo><mrow id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.cmml"><msup id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2.cmml"><mi id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2.2" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2.2.cmml">𝐱</mi><mi id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2.3" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2.3.cmml">n</mi></msup><mo fence="false" id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.1" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.1.cmml">|</mo><msup id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3.cmml"><mi id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3.2" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3.2.cmml">𝐳</mi><mi id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3.3" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3.3.cmml">n</mi></msup></mrow><mo stretchy="false" id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.3" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.9.9.m9.2b"><apply id="Thmnonumlemmax1.p1.9.9.m9.2.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2"><eq id="Thmnonumlemmax1.p1.9.9.m9.2.2.3.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.3"></eq><ci id="Thmnonumlemmax1.p1.9.9.m9.2.2.4.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.4">ℒ</ci><apply id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2"><plus id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.3.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.3"></plus><apply id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1"><apply id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2.1.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2">subscript</csymbol><sum id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2.2"></sum><ci id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2.3.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.2.3">𝑛</ci></apply><apply id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1"><times id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.2"></times><apply id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3"><log id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3.1.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3.1"></log><ci id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1">superscript</csymbol><ci id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2"><times id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.2"></times><apply id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3"><log id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.1.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.1"></log><apply id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2.1.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2">subscript</csymbol><ci id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2.2">𝑝</ci><ci id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2.3.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.3.2.3">𝜎</ci></apply></apply><apply id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1"><csymbol cd="latexml" id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.1">conditional</csymbol><apply id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2.1.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2.2">𝐱</ci><ci id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2.3.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.2.3">𝑛</ci></apply><apply id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3.1.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3.2.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3.2">𝐳</ci><ci id="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3.3.cmml" xref="Thmnonumlemmax1.p1.9.9.m9.2.2.2.2.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.9.9.m9.2c">\mathcal{L}=\sum_{n}\log p(\mathbf{z}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})</annotation></semantics></math>:</span></p>
<table id="S7.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.E7.m1.49" class="ltx_math_unparsed" alttext="\mathcal{L}\geq\sum_{n=1}^{N}\log q_{\phi}(\mathbf{z}^{n}|\mathbf{x}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})-\\
\mathbb{KL}\left({q(\Pi|\mathbf{z}^{n},\mathbf{x}^{n})}||{p(\Pi)}\right)" display="block"><semantics id="S7.E7.m1.49a"><mtable displaystyle="true" rowspacing="0pt" id="S7.E7.m1.49.49.2"><mtr id="S7.E7.m1.49.49.2a"><mtd class="ltx_align_left" columnalign="left" id="S7.E7.m1.49.49.2b"><mrow id="S7.E7.m1.49.49.2.49.29.29"><mi class="ltx_font_mathcaligraphic" id="S7.E7.m1.1.1.1.1.1.1">ℒ</mi><mo rspace="0.111em" id="S7.E7.m1.2.2.2.2.2.2">≥</mo><mrow id="S7.E7.m1.49.49.2.49.29.29.29"><mrow id="S7.E7.m1.48.48.1.48.28.28.28.1"><munderover id="S7.E7.m1.48.48.1.48.28.28.28.1.2"><mo movablelimits="false" id="S7.E7.m1.3.3.3.3.3.3">∑</mo><mrow id="S7.E7.m1.4.4.4.4.4.4.1"><mi id="S7.E7.m1.4.4.4.4.4.4.1.2">n</mi><mo id="S7.E7.m1.4.4.4.4.4.4.1.1">=</mo><mn id="S7.E7.m1.4.4.4.4.4.4.1.3">1</mn></mrow><mi id="S7.E7.m1.5.5.5.5.5.5.1">N</mi></munderover><mrow id="S7.E7.m1.48.48.1.48.28.28.28.1.1"><mrow id="S7.E7.m1.48.48.1.48.28.28.28.1.1.3"><mi id="S7.E7.m1.6.6.6.6.6.6">log</mi><mo lspace="0.167em" id="S7.E7.m1.48.48.1.48.28.28.28.1.1.3a">⁡</mo><msub id="S7.E7.m1.48.48.1.48.28.28.28.1.1.3.1"><mi id="S7.E7.m1.7.7.7.7.7.7">q</mi><mi id="S7.E7.m1.8.8.8.8.8.8.1">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S7.E7.m1.48.48.1.48.28.28.28.1.1.2">​</mo><mrow id="S7.E7.m1.48.48.1.48.28.28.28.1.1.1.1"><mo stretchy="false" id="S7.E7.m1.9.9.9.9.9.9">(</mo><mrow id="S7.E7.m1.48.48.1.48.28.28.28.1.1.1.1.1"><msup id="S7.E7.m1.48.48.1.48.28.28.28.1.1.1.1.1.1"><mi id="S7.E7.m1.10.10.10.10.10.10">𝐳</mi><mi id="S7.E7.m1.11.11.11.11.11.11.1">n</mi></msup><mo fence="false" id="S7.E7.m1.12.12.12.12.12.12">|</mo><msup id="S7.E7.m1.48.48.1.48.28.28.28.1.1.1.1.1.2"><mi id="S7.E7.m1.13.13.13.13.13.13">𝐱</mi><mi id="S7.E7.m1.14.14.14.14.14.14.1">n</mi></msup></mrow><mo stretchy="false" id="S7.E7.m1.15.15.15.15.15.15">)</mo></mrow></mrow></mrow><mo id="S7.E7.m1.16.16.16.16.16.16">+</mo><mrow id="S7.E7.m1.49.49.2.49.29.29.29.2"><mrow id="S7.E7.m1.49.49.2.49.29.29.29.2.1"><mrow id="S7.E7.m1.49.49.2.49.29.29.29.2.1.3"><mi id="S7.E7.m1.17.17.17.17.17.17">log</mi><mo lspace="0.167em" id="S7.E7.m1.49.49.2.49.29.29.29.2.1.3a">⁡</mo><msub id="S7.E7.m1.49.49.2.49.29.29.29.2.1.3.1"><mi id="S7.E7.m1.18.18.18.18.18.18">p</mi><mi id="S7.E7.m1.19.19.19.19.19.19.1">σ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S7.E7.m1.49.49.2.49.29.29.29.2.1.2">​</mo><mrow id="S7.E7.m1.49.49.2.49.29.29.29.2.1.1.1"><mo stretchy="false" id="S7.E7.m1.20.20.20.20.20.20">(</mo><mrow id="S7.E7.m1.49.49.2.49.29.29.29.2.1.1.1.1"><msup id="S7.E7.m1.49.49.2.49.29.29.29.2.1.1.1.1.1"><mi id="S7.E7.m1.21.21.21.21.21.21">𝐱</mi><mi id="S7.E7.m1.22.22.22.22.22.22.1">n</mi></msup><mo fence="false" id="S7.E7.m1.23.23.23.23.23.23">|</mo><msup id="S7.E7.m1.49.49.2.49.29.29.29.2.1.1.1.1.2"><mi id="S7.E7.m1.24.24.24.24.24.24">𝐳</mi><mi id="S7.E7.m1.25.25.25.25.25.25.1">n</mi></msup></mrow><mo stretchy="false" id="S7.E7.m1.26.26.26.26.26.26">)</mo></mrow></mrow><mo id="S7.E7.m1.27.27.27.27.27.27">−</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S7.E7.m1.49.49.2c"><mtd class="ltx_align_right" columnalign="right" id="S7.E7.m1.49.49.2d"><mrow id="S7.E7.m1.47.47.47.20.20"><mi id="S7.E7.m1.28.28.28.1.1.1">𝕂</mi><mi id="S7.E7.m1.29.29.29.2.2.2">𝕃</mi><mrow id="S7.E7.m1.47.47.47.20.20.21"><mo id="S7.E7.m1.30.30.30.3.3.3">(</mo><mi id="S7.E7.m1.31.31.31.4.4.4">q</mi><mrow id="S7.E7.m1.47.47.47.20.20.21.1"><mo stretchy="false" id="S7.E7.m1.32.32.32.5.5.5">(</mo><mi mathvariant="normal" id="S7.E7.m1.33.33.33.6.6.6">Π</mi><mo fence="false" rspace="0.167em" stretchy="false" id="S7.E7.m1.34.34.34.7.7.7">|</mo><msup id="S7.E7.m1.47.47.47.20.20.21.1.1"><mi id="S7.E7.m1.35.35.35.8.8.8">𝐳</mi><mi id="S7.E7.m1.36.36.36.9.9.9.1">n</mi></msup><mo id="S7.E7.m1.37.37.37.10.10.10">,</mo><msup id="S7.E7.m1.47.47.47.20.20.21.1.2"><mi id="S7.E7.m1.38.38.38.11.11.11">𝐱</mi><mi id="S7.E7.m1.39.39.39.12.12.12.1">n</mi></msup><mo stretchy="false" id="S7.E7.m1.40.40.40.13.13.13">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="S7.E7.m1.41.41.41.14.14.14">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S7.E7.m1.42.42.42.15.15.15">|</mo><mi id="S7.E7.m1.43.43.43.16.16.16">p</mi><mrow id="S7.E7.m1.47.47.47.20.20.21.2"><mo stretchy="false" id="S7.E7.m1.44.44.44.17.17.17">(</mo><mi mathvariant="normal" id="S7.E7.m1.45.45.45.18.18.18">Π</mi><mo stretchy="false" id="S7.E7.m1.46.46.46.19.19.19">)</mo></mrow><mo id="S7.E7.m1.47.47.47.20.20.20">)</mo></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S7.E7.m1.49b">\mathcal{L}\geq\sum_{n=1}^{N}\log q_{\phi}(\mathbf{z}^{n}|\mathbf{x}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})-\\
\mathbb{KL}\left({q(\Pi|\mathbf{z}^{n},\mathbf{x}^{n})}||{p(\Pi)}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="Thmnonumlemmax1.p1.13" class="ltx_p"><span id="Thmnonumlemmax1.p1.13.4" class="ltx_text ltx_font_italic">where <math id="Thmnonumlemmax1.p1.10.1.m1.1" class="ltx_Math" alttext="p(\Pi)" display="inline"><semantics id="Thmnonumlemmax1.p1.10.1.m1.1a"><mrow id="Thmnonumlemmax1.p1.10.1.m1.1.2" xref="Thmnonumlemmax1.p1.10.1.m1.1.2.cmml"><mi id="Thmnonumlemmax1.p1.10.1.m1.1.2.2" xref="Thmnonumlemmax1.p1.10.1.m1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.10.1.m1.1.2.1" xref="Thmnonumlemmax1.p1.10.1.m1.1.2.1.cmml">​</mo><mrow id="Thmnonumlemmax1.p1.10.1.m1.1.2.3.2" xref="Thmnonumlemmax1.p1.10.1.m1.1.2.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.10.1.m1.1.2.3.2.1" xref="Thmnonumlemmax1.p1.10.1.m1.1.2.cmml">(</mo><mi mathvariant="normal" id="Thmnonumlemmax1.p1.10.1.m1.1.1" xref="Thmnonumlemmax1.p1.10.1.m1.1.1.cmml">Π</mi><mo stretchy="false" id="Thmnonumlemmax1.p1.10.1.m1.1.2.3.2.2" xref="Thmnonumlemmax1.p1.10.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.10.1.m1.1b"><apply id="Thmnonumlemmax1.p1.10.1.m1.1.2.cmml" xref="Thmnonumlemmax1.p1.10.1.m1.1.2"><times id="Thmnonumlemmax1.p1.10.1.m1.1.2.1.cmml" xref="Thmnonumlemmax1.p1.10.1.m1.1.2.1"></times><ci id="Thmnonumlemmax1.p1.10.1.m1.1.2.2.cmml" xref="Thmnonumlemmax1.p1.10.1.m1.1.2.2">𝑝</ci><ci id="Thmnonumlemmax1.p1.10.1.m1.1.1.cmml" xref="Thmnonumlemmax1.p1.10.1.m1.1.1">Π</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.10.1.m1.1c">p(\Pi)</annotation></semantics></math> is a distribution over the sampling distributions implied by the prior <math id="Thmnonumlemmax1.p1.11.2.m2.1" class="ltx_Math" alttext="p(\mathbf{z})" display="inline"><semantics id="Thmnonumlemmax1.p1.11.2.m2.1a"><mrow id="Thmnonumlemmax1.p1.11.2.m2.1.2" xref="Thmnonumlemmax1.p1.11.2.m2.1.2.cmml"><mi id="Thmnonumlemmax1.p1.11.2.m2.1.2.2" xref="Thmnonumlemmax1.p1.11.2.m2.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.11.2.m2.1.2.1" xref="Thmnonumlemmax1.p1.11.2.m2.1.2.1.cmml">​</mo><mrow id="Thmnonumlemmax1.p1.11.2.m2.1.2.3.2" xref="Thmnonumlemmax1.p1.11.2.m2.1.2.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.11.2.m2.1.2.3.2.1" xref="Thmnonumlemmax1.p1.11.2.m2.1.2.cmml">(</mo><mi id="Thmnonumlemmax1.p1.11.2.m2.1.1" xref="Thmnonumlemmax1.p1.11.2.m2.1.1.cmml">𝐳</mi><mo stretchy="false" id="Thmnonumlemmax1.p1.11.2.m2.1.2.3.2.2" xref="Thmnonumlemmax1.p1.11.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.11.2.m2.1b"><apply id="Thmnonumlemmax1.p1.11.2.m2.1.2.cmml" xref="Thmnonumlemmax1.p1.11.2.m2.1.2"><times id="Thmnonumlemmax1.p1.11.2.m2.1.2.1.cmml" xref="Thmnonumlemmax1.p1.11.2.m2.1.2.1"></times><ci id="Thmnonumlemmax1.p1.11.2.m2.1.2.2.cmml" xref="Thmnonumlemmax1.p1.11.2.m2.1.2.2">𝑝</ci><ci id="Thmnonumlemmax1.p1.11.2.m2.1.1.cmml" xref="Thmnonumlemmax1.p1.11.2.m2.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.11.2.m2.1c">p(\mathbf{z})</annotation></semantics></math>
and <math id="Thmnonumlemmax1.p1.12.3.m3.4" class="ltx_Math" alttext="q(\Pi|\mathbf{x}^{n},\mathbf{z}^{n})=q(\pi_{0})\prod_{t=1}^{T}q(\pi_{t}|\mathbf{x}^{n},z_{0}^{n},\cdots,z_{t-1}^{n})" display="inline"><semantics id="Thmnonumlemmax1.p1.12.3.m3.4a"><mrow id="Thmnonumlemmax1.p1.12.3.m3.4.4" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.cmml"><mrow id="Thmnonumlemmax1.p1.12.3.m3.2.2.1" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.cmml"><mi id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.3" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.2" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.2.cmml">​</mo><mrow id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.2" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.cmml">(</mo><mrow id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.cmml"><mi mathvariant="normal" id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.4" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.4.cmml">Π</mi><mo fence="false" id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.3" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.3.cmml">|</mo><mrow id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.3.cmml"><msup id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.cmml"><mi id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.2" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.3" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.3" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.3.cmml">,</mo><msup id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.cmml"><mi id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.2" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.2.cmml">𝐳</mi><mi id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.3" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.3.cmml">n</mi></msup></mrow></mrow><mo stretchy="false" id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.3" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmnonumlemmax1.p1.12.3.m3.4.4.4" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.4.cmml">=</mo><mrow id="Thmnonumlemmax1.p1.12.3.m3.4.4.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.cmml"><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.4" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.4.cmml">q</mi><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.3.cmml">​</mo><mrow id="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1" xref="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.2" xref="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.cmml">(</mo><msub id="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1" xref="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.cmml"><mi id="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.2" xref="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.2.cmml">π</mi><mn id="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.3" xref="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.3.cmml">0</mn></msub><mo stretchy="false" id="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.3" xref="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.3a" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.3.cmml">​</mo><mrow id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.cmml"><msubsup id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.cmml"><mo id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.2" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.2.cmml">∏</mo><mrow id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.cmml"><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.2" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.2.cmml">t</mi><mo id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.1" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.1.cmml">=</mo><mn id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.3.cmml">1</mn></mrow><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.3.cmml">T</mi></msubsup><mrow id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.cmml"><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.2" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.2.cmml">​</mo><mrow id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.2" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.cmml">(</mo><mrow id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.cmml"><msub id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.cmml"><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.2" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.2.cmml">π</mi><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.3.cmml">t</mi></msub><mo fence="false" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.4" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.4.cmml">|</mo><mrow id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.4.cmml"><msup id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.cmml"><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.2" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.4" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.4.cmml">,</mo><msubsup id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.cmml"><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.2" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.2.cmml">z</mi><mn id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.3.cmml">0</mn><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.3.cmml">n</mi></msubsup><mo id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.5" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="Thmnonumlemmax1.p1.12.3.m3.1.1" xref="Thmnonumlemmax1.p1.12.3.m3.1.1.cmml">⋯</mi><mo id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.6" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.4.cmml">,</mo><msubsup id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.cmml"><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.2" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.2.cmml">z</mi><mrow id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.cmml"><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.2" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.2.cmml">t</mi><mo id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.1" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.1.cmml">−</mo><mn id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.3.cmml">1</mn></mrow><mi id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.3.cmml">n</mi></msubsup></mrow></mrow><mo stretchy="false" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.3" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.12.3.m3.4b"><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4"><eq id="Thmnonumlemmax1.p1.12.3.m3.4.4.4.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.4"></eq><apply id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1"><times id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.2"></times><ci id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.3">𝑞</ci><apply id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1"><csymbol cd="latexml" id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.3">conditional</csymbol><ci id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.4.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.4">Π</ci><list id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2"><apply id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.2">𝐱</ci><ci id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.2">𝐳</ci><ci id="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.2.2.1.1.1.1.2.2.2.3">𝑛</ci></apply></list></apply></apply><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3"><times id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.3"></times><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.4.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.4">𝑞</ci><apply id="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1">subscript</csymbol><ci id="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.2">𝜋</ci><cn type="integer" id="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.3.3.2.1.1.1.3">0</cn></apply><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2"><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2">superscript</csymbol><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2">subscript</csymbol><csymbol cd="latexml" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.2">product</csymbol><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3"><eq id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.1"></eq><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.2">𝑡</ci><cn type="integer" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.2.3.3">1</cn></apply></apply><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.2.3">𝑇</ci></apply><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1"><times id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.2"></times><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.3">𝑞</ci><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1"><csymbol cd="latexml" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.4.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.4">conditional</csymbol><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5">subscript</csymbol><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.2">𝜋</ci><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.5.3">𝑡</ci></apply><list id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.4.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3"><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.2">𝐱</ci><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2">superscript</csymbol><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.2">𝑧</ci><cn type="integer" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.2.3">0</cn></apply><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.2.2.2.3">𝑛</ci></apply><ci id="Thmnonumlemmax1.p1.12.3.m3.1.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.1.1">⋯</ci><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3">superscript</csymbol><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3">subscript</csymbol><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.2">𝑧</ci><apply id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3"><minus id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.1.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.1"></minus><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.2.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.2">𝑡</ci><cn type="integer" id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.2.3.3">1</cn></apply></apply><ci id="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.3.cmml" xref="Thmnonumlemmax1.p1.12.3.m3.4.4.3.2.1.1.1.1.3.3.3.3">𝑛</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.12.3.m3.4c">q(\Pi|\mathbf{x}^{n},\mathbf{z}^{n})=q(\pi_{0})\prod_{t=1}^{T}q(\pi_{t}|\mathbf{x}^{n},z_{0}^{n},\cdots,z_{t-1}^{n})</annotation></semantics></math>, where
each <math id="Thmnonumlemmax1.p1.13.4.m4.1" class="ltx_Math" alttext="q(\pi_{t}|\cdot)" display="inline"><semantics id="Thmnonumlemmax1.p1.13.4.m4.1a"><mrow id="Thmnonumlemmax1.p1.13.4.m4.1.1" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.cmml"><mi id="Thmnonumlemmax1.p1.13.4.m4.1.1.3" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.13.4.m4.1.1.2" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.2.cmml">​</mo><mrow id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.2" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.cmml"><msub id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2.cmml"><mi id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2.2" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2.2.cmml">π</mi><mi id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2.3" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" rspace="0em" id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.1" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.1.cmml">|</mo><mo lspace="0em" rspace="0em" id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.3" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.3.cmml">⋅</mo></mrow><mo stretchy="false" id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.3" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmnonumlemmax1.p1.13.4.m4.1b"><apply id="Thmnonumlemmax1.p1.13.4.m4.1.1.cmml" xref="Thmnonumlemmax1.p1.13.4.m4.1.1"><times id="Thmnonumlemmax1.p1.13.4.m4.1.1.2.cmml" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.2"></times><ci id="Thmnonumlemmax1.p1.13.4.m4.1.1.3.cmml" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.3">𝑞</ci><apply id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1"><csymbol cd="latexml" id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.1.cmml" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.1">conditional</csymbol><apply id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2.cmml" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2.1.cmml" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2">subscript</csymbol><ci id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2.2.cmml" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2.2">𝜋</ci><ci id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2.3.cmml" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.3.cmml" xref="Thmnonumlemmax1.p1.13.4.m4.1.1.1.1.1.3">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmnonumlemmax1.p1.13.4.m4.1c">q(\pi_{t}|\cdot)</annotation></semantics></math> is a delta distribution on the probability simplex.</span></p>
</div>
</div>
<div id="S7.13" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="S7.1.p1" class="ltx_para">
<p id="S7.1.p1.2" class="ltx_p">We provide a proof for the lemma stated in the main paper, which explains
how to obtain a lower bound on the evidence <math id="S7.1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S7.1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S7.1.p1.1.m1.1.1" xref="S7.1.p1.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S7.1.p1.1.m1.1b"><ci id="S7.1.p1.1.m1.1.1.cmml" xref="S7.1.p1.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.1.p1.1.m1.1c">\mathcal{L}</annotation></semantics></math> for the data
samples <math id="S7.1.p1.2.m2.2" class="ltx_Math" alttext="\{\mathbf{x}^{n},\mathbf{z}^{n}\}_{n=1}^{N}" display="inline"><semantics id="S7.1.p1.2.m2.2a"><msubsup id="S7.1.p1.2.m2.2.2" xref="S7.1.p1.2.m2.2.2.cmml"><mrow id="S7.1.p1.2.m2.2.2.2.2.2" xref="S7.1.p1.2.m2.2.2.2.2.3.cmml"><mo stretchy="false" id="S7.1.p1.2.m2.2.2.2.2.2.3" xref="S7.1.p1.2.m2.2.2.2.2.3.cmml">{</mo><msup id="S7.1.p1.2.m2.1.1.1.1.1.1" xref="S7.1.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S7.1.p1.2.m2.1.1.1.1.1.1.2" xref="S7.1.p1.2.m2.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S7.1.p1.2.m2.1.1.1.1.1.1.3" xref="S7.1.p1.2.m2.1.1.1.1.1.1.3.cmml">n</mi></msup><mo id="S7.1.p1.2.m2.2.2.2.2.2.4" xref="S7.1.p1.2.m2.2.2.2.2.3.cmml">,</mo><msup id="S7.1.p1.2.m2.2.2.2.2.2.2" xref="S7.1.p1.2.m2.2.2.2.2.2.2.cmml"><mi id="S7.1.p1.2.m2.2.2.2.2.2.2.2" xref="S7.1.p1.2.m2.2.2.2.2.2.2.2.cmml">𝐳</mi><mi id="S7.1.p1.2.m2.2.2.2.2.2.2.3" xref="S7.1.p1.2.m2.2.2.2.2.2.2.3.cmml">n</mi></msup><mo stretchy="false" id="S7.1.p1.2.m2.2.2.2.2.2.5" xref="S7.1.p1.2.m2.2.2.2.2.3.cmml">}</mo></mrow><mrow id="S7.1.p1.2.m2.2.2.2.4" xref="S7.1.p1.2.m2.2.2.2.4.cmml"><mi id="S7.1.p1.2.m2.2.2.2.4.2" xref="S7.1.p1.2.m2.2.2.2.4.2.cmml">n</mi><mo id="S7.1.p1.2.m2.2.2.2.4.1" xref="S7.1.p1.2.m2.2.2.2.4.1.cmml">=</mo><mn id="S7.1.p1.2.m2.2.2.2.4.3" xref="S7.1.p1.2.m2.2.2.2.4.3.cmml">1</mn></mrow><mi id="S7.1.p1.2.m2.2.2.4" xref="S7.1.p1.2.m2.2.2.4.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S7.1.p1.2.m2.2b"><apply id="S7.1.p1.2.m2.2.2.cmml" xref="S7.1.p1.2.m2.2.2"><csymbol cd="ambiguous" id="S7.1.p1.2.m2.2.2.3.cmml" xref="S7.1.p1.2.m2.2.2">superscript</csymbol><apply id="S7.1.p1.2.m2.2.2.2.cmml" xref="S7.1.p1.2.m2.2.2"><csymbol cd="ambiguous" id="S7.1.p1.2.m2.2.2.2.3.cmml" xref="S7.1.p1.2.m2.2.2">subscript</csymbol><set id="S7.1.p1.2.m2.2.2.2.2.3.cmml" xref="S7.1.p1.2.m2.2.2.2.2.2"><apply id="S7.1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S7.1.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S7.1.p1.2.m2.1.1.1.1.1.1">superscript</csymbol><ci id="S7.1.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S7.1.p1.2.m2.1.1.1.1.1.1.2">𝐱</ci><ci id="S7.1.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S7.1.p1.2.m2.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S7.1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S7.1.p1.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S7.1.p1.2.m2.2.2.2.2.2.2.1.cmml" xref="S7.1.p1.2.m2.2.2.2.2.2.2">superscript</csymbol><ci id="S7.1.p1.2.m2.2.2.2.2.2.2.2.cmml" xref="S7.1.p1.2.m2.2.2.2.2.2.2.2">𝐳</ci><ci id="S7.1.p1.2.m2.2.2.2.2.2.2.3.cmml" xref="S7.1.p1.2.m2.2.2.2.2.2.2.3">𝑛</ci></apply></set><apply id="S7.1.p1.2.m2.2.2.2.4.cmml" xref="S7.1.p1.2.m2.2.2.2.4"><eq id="S7.1.p1.2.m2.2.2.2.4.1.cmml" xref="S7.1.p1.2.m2.2.2.2.4.1"></eq><ci id="S7.1.p1.2.m2.2.2.2.4.2.cmml" xref="S7.1.p1.2.m2.2.2.2.4.2">𝑛</ci><cn type="integer" id="S7.1.p1.2.m2.2.2.2.4.3.cmml" xref="S7.1.p1.2.m2.2.2.2.4.3">1</cn></apply></apply><ci id="S7.1.p1.2.m2.2.2.4.cmml" xref="S7.1.p1.2.m2.2.2.4">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.1.p1.2.m2.2c">\{\mathbf{x}^{n},\mathbf{z}^{n}\}_{n=1}^{N}</annotation></semantics></math>.</p>
</div>
<div id="S7.2.p2" class="ltx_para">
<p id="S7.2.p2.10" class="ltx_p">Let us first focus on the prior on (serialized) programs, <math id="S7.2.p2.1.m1.1" class="ltx_Math" alttext="\log p(\mathbf{z})" display="inline"><semantics id="S7.2.p2.1.m1.1a"><mrow id="S7.2.p2.1.m1.1.2" xref="S7.2.p2.1.m1.1.2.cmml"><mrow id="S7.2.p2.1.m1.1.2.2" xref="S7.2.p2.1.m1.1.2.2.cmml"><mi id="S7.2.p2.1.m1.1.2.2.1" xref="S7.2.p2.1.m1.1.2.2.1.cmml">log</mi><mo lspace="0.167em" id="S7.2.p2.1.m1.1.2.2a" xref="S7.2.p2.1.m1.1.2.2.cmml">⁡</mo><mi id="S7.2.p2.1.m1.1.2.2.2" xref="S7.2.p2.1.m1.1.2.2.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.2.p2.1.m1.1.2.1" xref="S7.2.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S7.2.p2.1.m1.1.2.3.2" xref="S7.2.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S7.2.p2.1.m1.1.2.3.2.1" xref="S7.2.p2.1.m1.1.2.cmml">(</mo><mi id="S7.2.p2.1.m1.1.1" xref="S7.2.p2.1.m1.1.1.cmml">𝐳</mi><mo stretchy="false" id="S7.2.p2.1.m1.1.2.3.2.2" xref="S7.2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.2.p2.1.m1.1b"><apply id="S7.2.p2.1.m1.1.2.cmml" xref="S7.2.p2.1.m1.1.2"><times id="S7.2.p2.1.m1.1.2.1.cmml" xref="S7.2.p2.1.m1.1.2.1"></times><apply id="S7.2.p2.1.m1.1.2.2.cmml" xref="S7.2.p2.1.m1.1.2.2"><log id="S7.2.p2.1.m1.1.2.2.1.cmml" xref="S7.2.p2.1.m1.1.2.2.1"></log><ci id="S7.2.p2.1.m1.1.2.2.2.cmml" xref="S7.2.p2.1.m1.1.2.2.2">𝑝</ci></apply><ci id="S7.2.p2.1.m1.1.1.cmml" xref="S7.2.p2.1.m1.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.2.p2.1.m1.1c">\log p(\mathbf{z})</annotation></semantics></math>.
This is a sequence model, which factorizes as,
<math id="S7.2.p2.2.m2.3" class="ltx_Math" alttext="\log p(\mathbf{z})=\log p(z_{1})+\sum_{t=2}^{T}\log p(z_{t}|\{z_{i}\}_{i=1}^{t-1})" display="inline"><semantics id="S7.2.p2.2.m2.3a"><mrow id="S7.2.p2.2.m2.3.3" xref="S7.2.p2.2.m2.3.3.cmml"><mrow id="S7.2.p2.2.m2.3.3.4" xref="S7.2.p2.2.m2.3.3.4.cmml"><mrow id="S7.2.p2.2.m2.3.3.4.2" xref="S7.2.p2.2.m2.3.3.4.2.cmml"><mi id="S7.2.p2.2.m2.3.3.4.2.1" xref="S7.2.p2.2.m2.3.3.4.2.1.cmml">log</mi><mo lspace="0.167em" id="S7.2.p2.2.m2.3.3.4.2a" xref="S7.2.p2.2.m2.3.3.4.2.cmml">⁡</mo><mi id="S7.2.p2.2.m2.3.3.4.2.2" xref="S7.2.p2.2.m2.3.3.4.2.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.2.p2.2.m2.3.3.4.1" xref="S7.2.p2.2.m2.3.3.4.1.cmml">​</mo><mrow id="S7.2.p2.2.m2.3.3.4.3.2" xref="S7.2.p2.2.m2.3.3.4.cmml"><mo stretchy="false" id="S7.2.p2.2.m2.3.3.4.3.2.1" xref="S7.2.p2.2.m2.3.3.4.cmml">(</mo><mi id="S7.2.p2.2.m2.1.1" xref="S7.2.p2.2.m2.1.1.cmml">𝐳</mi><mo stretchy="false" id="S7.2.p2.2.m2.3.3.4.3.2.2" xref="S7.2.p2.2.m2.3.3.4.cmml">)</mo></mrow></mrow><mo id="S7.2.p2.2.m2.3.3.3" xref="S7.2.p2.2.m2.3.3.3.cmml">=</mo><mrow id="S7.2.p2.2.m2.3.3.2" xref="S7.2.p2.2.m2.3.3.2.cmml"><mrow id="S7.2.p2.2.m2.2.2.1.1" xref="S7.2.p2.2.m2.2.2.1.1.cmml"><mrow id="S7.2.p2.2.m2.2.2.1.1.3" xref="S7.2.p2.2.m2.2.2.1.1.3.cmml"><mi id="S7.2.p2.2.m2.2.2.1.1.3.1" xref="S7.2.p2.2.m2.2.2.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S7.2.p2.2.m2.2.2.1.1.3a" xref="S7.2.p2.2.m2.2.2.1.1.3.cmml">⁡</mo><mi id="S7.2.p2.2.m2.2.2.1.1.3.2" xref="S7.2.p2.2.m2.2.2.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.2.p2.2.m2.2.2.1.1.2" xref="S7.2.p2.2.m2.2.2.1.1.2.cmml">​</mo><mrow id="S7.2.p2.2.m2.2.2.1.1.1.1" xref="S7.2.p2.2.m2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.2.p2.2.m2.2.2.1.1.1.1.2" xref="S7.2.p2.2.m2.2.2.1.1.1.1.1.cmml">(</mo><msub id="S7.2.p2.2.m2.2.2.1.1.1.1.1" xref="S7.2.p2.2.m2.2.2.1.1.1.1.1.cmml"><mi id="S7.2.p2.2.m2.2.2.1.1.1.1.1.2" xref="S7.2.p2.2.m2.2.2.1.1.1.1.1.2.cmml">z</mi><mn id="S7.2.p2.2.m2.2.2.1.1.1.1.1.3" xref="S7.2.p2.2.m2.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S7.2.p2.2.m2.2.2.1.1.1.1.3" xref="S7.2.p2.2.m2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="S7.2.p2.2.m2.3.3.2.3" xref="S7.2.p2.2.m2.3.3.2.3.cmml">+</mo><mrow id="S7.2.p2.2.m2.3.3.2.2" xref="S7.2.p2.2.m2.3.3.2.2.cmml"><msubsup id="S7.2.p2.2.m2.3.3.2.2.2" xref="S7.2.p2.2.m2.3.3.2.2.2.cmml"><mo id="S7.2.p2.2.m2.3.3.2.2.2.2.2" xref="S7.2.p2.2.m2.3.3.2.2.2.2.2.cmml">∑</mo><mrow id="S7.2.p2.2.m2.3.3.2.2.2.2.3" xref="S7.2.p2.2.m2.3.3.2.2.2.2.3.cmml"><mi id="S7.2.p2.2.m2.3.3.2.2.2.2.3.2" xref="S7.2.p2.2.m2.3.3.2.2.2.2.3.2.cmml">t</mi><mo id="S7.2.p2.2.m2.3.3.2.2.2.2.3.1" xref="S7.2.p2.2.m2.3.3.2.2.2.2.3.1.cmml">=</mo><mn id="S7.2.p2.2.m2.3.3.2.2.2.2.3.3" xref="S7.2.p2.2.m2.3.3.2.2.2.2.3.3.cmml">2</mn></mrow><mi id="S7.2.p2.2.m2.3.3.2.2.2.3" xref="S7.2.p2.2.m2.3.3.2.2.2.3.cmml">T</mi></msubsup><mrow id="S7.2.p2.2.m2.3.3.2.2.1" xref="S7.2.p2.2.m2.3.3.2.2.1.cmml"><mrow id="S7.2.p2.2.m2.3.3.2.2.1.3" xref="S7.2.p2.2.m2.3.3.2.2.1.3.cmml"><mi id="S7.2.p2.2.m2.3.3.2.2.1.3.1" xref="S7.2.p2.2.m2.3.3.2.2.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S7.2.p2.2.m2.3.3.2.2.1.3a" xref="S7.2.p2.2.m2.3.3.2.2.1.3.cmml">⁡</mo><mi id="S7.2.p2.2.m2.3.3.2.2.1.3.2" xref="S7.2.p2.2.m2.3.3.2.2.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.2.p2.2.m2.3.3.2.2.1.2" xref="S7.2.p2.2.m2.3.3.2.2.1.2.cmml">​</mo><mrow id="S7.2.p2.2.m2.3.3.2.2.1.1.1" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S7.2.p2.2.m2.3.3.2.2.1.1.1.2" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.cmml">(</mo><mrow id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.cmml"><msub id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3.cmml"><mi id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3.2" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3.2.cmml">z</mi><mi id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3.3" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.2" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.2.cmml">|</mo><msubsup id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.cmml"><mrow id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.2" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1.2" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1.3" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.3" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.cmml"><mi id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.2" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.1" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.3" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.cmml"><mi id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.2" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.1" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.1.cmml">−</mo><mn id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.3" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup></mrow><mo stretchy="false" id="S7.2.p2.2.m2.3.3.2.2.1.1.1.3" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.2.p2.2.m2.3b"><apply id="S7.2.p2.2.m2.3.3.cmml" xref="S7.2.p2.2.m2.3.3"><eq id="S7.2.p2.2.m2.3.3.3.cmml" xref="S7.2.p2.2.m2.3.3.3"></eq><apply id="S7.2.p2.2.m2.3.3.4.cmml" xref="S7.2.p2.2.m2.3.3.4"><times id="S7.2.p2.2.m2.3.3.4.1.cmml" xref="S7.2.p2.2.m2.3.3.4.1"></times><apply id="S7.2.p2.2.m2.3.3.4.2.cmml" xref="S7.2.p2.2.m2.3.3.4.2"><log id="S7.2.p2.2.m2.3.3.4.2.1.cmml" xref="S7.2.p2.2.m2.3.3.4.2.1"></log><ci id="S7.2.p2.2.m2.3.3.4.2.2.cmml" xref="S7.2.p2.2.m2.3.3.4.2.2">𝑝</ci></apply><ci id="S7.2.p2.2.m2.1.1.cmml" xref="S7.2.p2.2.m2.1.1">𝐳</ci></apply><apply id="S7.2.p2.2.m2.3.3.2.cmml" xref="S7.2.p2.2.m2.3.3.2"><plus id="S7.2.p2.2.m2.3.3.2.3.cmml" xref="S7.2.p2.2.m2.3.3.2.3"></plus><apply id="S7.2.p2.2.m2.2.2.1.1.cmml" xref="S7.2.p2.2.m2.2.2.1.1"><times id="S7.2.p2.2.m2.2.2.1.1.2.cmml" xref="S7.2.p2.2.m2.2.2.1.1.2"></times><apply id="S7.2.p2.2.m2.2.2.1.1.3.cmml" xref="S7.2.p2.2.m2.2.2.1.1.3"><log id="S7.2.p2.2.m2.2.2.1.1.3.1.cmml" xref="S7.2.p2.2.m2.2.2.1.1.3.1"></log><ci id="S7.2.p2.2.m2.2.2.1.1.3.2.cmml" xref="S7.2.p2.2.m2.2.2.1.1.3.2">𝑝</ci></apply><apply id="S7.2.p2.2.m2.2.2.1.1.1.1.1.cmml" xref="S7.2.p2.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S7.2.p2.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S7.2.p2.2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S7.2.p2.2.m2.2.2.1.1.1.1.1.2.cmml" xref="S7.2.p2.2.m2.2.2.1.1.1.1.1.2">𝑧</ci><cn type="integer" id="S7.2.p2.2.m2.2.2.1.1.1.1.1.3.cmml" xref="S7.2.p2.2.m2.2.2.1.1.1.1.1.3">1</cn></apply></apply><apply id="S7.2.p2.2.m2.3.3.2.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2"><apply id="S7.2.p2.2.m2.3.3.2.2.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S7.2.p2.2.m2.3.3.2.2.2.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.2">superscript</csymbol><apply id="S7.2.p2.2.m2.3.3.2.2.2.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S7.2.p2.2.m2.3.3.2.2.2.2.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.2">subscript</csymbol><sum id="S7.2.p2.2.m2.3.3.2.2.2.2.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.2.2.2"></sum><apply id="S7.2.p2.2.m2.3.3.2.2.2.2.3.cmml" xref="S7.2.p2.2.m2.3.3.2.2.2.2.3"><eq id="S7.2.p2.2.m2.3.3.2.2.2.2.3.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.2.2.3.1"></eq><ci id="S7.2.p2.2.m2.3.3.2.2.2.2.3.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S7.2.p2.2.m2.3.3.2.2.2.2.3.3.cmml" xref="S7.2.p2.2.m2.3.3.2.2.2.2.3.3">2</cn></apply></apply><ci id="S7.2.p2.2.m2.3.3.2.2.2.3.cmml" xref="S7.2.p2.2.m2.3.3.2.2.2.3">𝑇</ci></apply><apply id="S7.2.p2.2.m2.3.3.2.2.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1"><times id="S7.2.p2.2.m2.3.3.2.2.1.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.2"></times><apply id="S7.2.p2.2.m2.3.3.2.2.1.3.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.3"><log id="S7.2.p2.2.m2.3.3.2.2.1.3.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.3.1"></log><ci id="S7.2.p2.2.m2.3.3.2.2.1.3.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.3.2">𝑝</ci></apply><apply id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1"><csymbol cd="latexml" id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.2">conditional</csymbol><apply id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3">subscript</csymbol><ci id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3.2">𝑧</ci><ci id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3.3.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.3.3">𝑡</ci></apply><apply id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1">superscript</csymbol><apply id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1">subscript</csymbol><set id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1"><apply id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3"><eq id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.1"></eq><ci id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.3.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3"><minus id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.1.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.1"></minus><ci id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.2.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.3.cmml" xref="S7.2.p2.2.m2.3.3.2.2.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.2.p2.2.m2.3c">\log p(\mathbf{z})=\log p(z_{1})+\sum_{t=2}^{T}\log p(z_{t}|\{z_{i}\}_{i=1}^{t-1})</annotation></semantics></math>, where
<math id="S7.2.p2.3.m3.2" class="ltx_Math" alttext="p(z_{t}|\cdot)\sim Cat(\pi_{t})" display="inline"><semantics id="S7.2.p2.3.m3.2a"><mrow id="S7.2.p2.3.m3.2.2" xref="S7.2.p2.3.m3.2.2.cmml"><mrow id="S7.2.p2.3.m3.1.1.1" xref="S7.2.p2.3.m3.1.1.1.cmml"><mi id="S7.2.p2.3.m3.1.1.1.3" xref="S7.2.p2.3.m3.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S7.2.p2.3.m3.1.1.1.2" xref="S7.2.p2.3.m3.1.1.1.2.cmml">​</mo><mrow id="S7.2.p2.3.m3.1.1.1.1.1" xref="S7.2.p2.3.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.2.p2.3.m3.1.1.1.1.1.2" xref="S7.2.p2.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.2.p2.3.m3.1.1.1.1.1.1" xref="S7.2.p2.3.m3.1.1.1.1.1.1.cmml"><msub id="S7.2.p2.3.m3.1.1.1.1.1.1.2" xref="S7.2.p2.3.m3.1.1.1.1.1.1.2.cmml"><mi id="S7.2.p2.3.m3.1.1.1.1.1.1.2.2" xref="S7.2.p2.3.m3.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S7.2.p2.3.m3.1.1.1.1.1.1.2.3" xref="S7.2.p2.3.m3.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" rspace="0em" id="S7.2.p2.3.m3.1.1.1.1.1.1.1" xref="S7.2.p2.3.m3.1.1.1.1.1.1.1.cmml">|</mo><mo lspace="0em" rspace="0em" id="S7.2.p2.3.m3.1.1.1.1.1.1.3" xref="S7.2.p2.3.m3.1.1.1.1.1.1.3.cmml">⋅</mo></mrow><mo stretchy="false" id="S7.2.p2.3.m3.1.1.1.1.1.3" xref="S7.2.p2.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.2.p2.3.m3.2.2.3" xref="S7.2.p2.3.m3.2.2.3.cmml">∼</mo><mrow id="S7.2.p2.3.m3.2.2.2" xref="S7.2.p2.3.m3.2.2.2.cmml"><mi id="S7.2.p2.3.m3.2.2.2.3" xref="S7.2.p2.3.m3.2.2.2.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S7.2.p2.3.m3.2.2.2.2" xref="S7.2.p2.3.m3.2.2.2.2.cmml">​</mo><mi id="S7.2.p2.3.m3.2.2.2.4" xref="S7.2.p2.3.m3.2.2.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S7.2.p2.3.m3.2.2.2.2a" xref="S7.2.p2.3.m3.2.2.2.2.cmml">​</mo><mi id="S7.2.p2.3.m3.2.2.2.5" xref="S7.2.p2.3.m3.2.2.2.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S7.2.p2.3.m3.2.2.2.2b" xref="S7.2.p2.3.m3.2.2.2.2.cmml">​</mo><mrow id="S7.2.p2.3.m3.2.2.2.1.1" xref="S7.2.p2.3.m3.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S7.2.p2.3.m3.2.2.2.1.1.2" xref="S7.2.p2.3.m3.2.2.2.1.1.1.cmml">(</mo><msub id="S7.2.p2.3.m3.2.2.2.1.1.1" xref="S7.2.p2.3.m3.2.2.2.1.1.1.cmml"><mi id="S7.2.p2.3.m3.2.2.2.1.1.1.2" xref="S7.2.p2.3.m3.2.2.2.1.1.1.2.cmml">π</mi><mi id="S7.2.p2.3.m3.2.2.2.1.1.1.3" xref="S7.2.p2.3.m3.2.2.2.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S7.2.p2.3.m3.2.2.2.1.1.3" xref="S7.2.p2.3.m3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.2.p2.3.m3.2b"><apply id="S7.2.p2.3.m3.2.2.cmml" xref="S7.2.p2.3.m3.2.2"><csymbol cd="latexml" id="S7.2.p2.3.m3.2.2.3.cmml" xref="S7.2.p2.3.m3.2.2.3">similar-to</csymbol><apply id="S7.2.p2.3.m3.1.1.1.cmml" xref="S7.2.p2.3.m3.1.1.1"><times id="S7.2.p2.3.m3.1.1.1.2.cmml" xref="S7.2.p2.3.m3.1.1.1.2"></times><ci id="S7.2.p2.3.m3.1.1.1.3.cmml" xref="S7.2.p2.3.m3.1.1.1.3">𝑝</ci><apply id="S7.2.p2.3.m3.1.1.1.1.1.1.cmml" xref="S7.2.p2.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="S7.2.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S7.2.p2.3.m3.1.1.1.1.1.1.1">conditional</csymbol><apply id="S7.2.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S7.2.p2.3.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.2.p2.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S7.2.p2.3.m3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S7.2.p2.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S7.2.p2.3.m3.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S7.2.p2.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S7.2.p2.3.m3.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S7.2.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="S7.2.p2.3.m3.1.1.1.1.1.1.3">⋅</ci></apply></apply><apply id="S7.2.p2.3.m3.2.2.2.cmml" xref="S7.2.p2.3.m3.2.2.2"><times id="S7.2.p2.3.m3.2.2.2.2.cmml" xref="S7.2.p2.3.m3.2.2.2.2"></times><ci id="S7.2.p2.3.m3.2.2.2.3.cmml" xref="S7.2.p2.3.m3.2.2.2.3">𝐶</ci><ci id="S7.2.p2.3.m3.2.2.2.4.cmml" xref="S7.2.p2.3.m3.2.2.2.4">𝑎</ci><ci id="S7.2.p2.3.m3.2.2.2.5.cmml" xref="S7.2.p2.3.m3.2.2.2.5">𝑡</ci><apply id="S7.2.p2.3.m3.2.2.2.1.1.1.cmml" xref="S7.2.p2.3.m3.2.2.2.1.1"><csymbol cd="ambiguous" id="S7.2.p2.3.m3.2.2.2.1.1.1.1.cmml" xref="S7.2.p2.3.m3.2.2.2.1.1">subscript</csymbol><ci id="S7.2.p2.3.m3.2.2.2.1.1.1.2.cmml" xref="S7.2.p2.3.m3.2.2.2.1.1.1.2">𝜋</ci><ci id="S7.2.p2.3.m3.2.2.2.1.1.1.3.cmml" xref="S7.2.p2.3.m3.2.2.2.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.2.p2.3.m3.2c">p(z_{t}|\cdot)\sim Cat(\pi_{t})</annotation></semantics></math>. We learn point estimates of the parameters for the prior
(in a regular sequence model), however, the every sequence has an implicit distribution
on <math id="S7.2.p2.4.m4.1" class="ltx_Math" alttext="p(\pi_{t})" display="inline"><semantics id="S7.2.p2.4.m4.1a"><mrow id="S7.2.p2.4.m4.1.1" xref="S7.2.p2.4.m4.1.1.cmml"><mi id="S7.2.p2.4.m4.1.1.3" xref="S7.2.p2.4.m4.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S7.2.p2.4.m4.1.1.2" xref="S7.2.p2.4.m4.1.1.2.cmml">​</mo><mrow id="S7.2.p2.4.m4.1.1.1.1" xref="S7.2.p2.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.2.p2.4.m4.1.1.1.1.2" xref="S7.2.p2.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S7.2.p2.4.m4.1.1.1.1.1" xref="S7.2.p2.4.m4.1.1.1.1.1.cmml"><mi id="S7.2.p2.4.m4.1.1.1.1.1.2" xref="S7.2.p2.4.m4.1.1.1.1.1.2.cmml">π</mi><mi id="S7.2.p2.4.m4.1.1.1.1.1.3" xref="S7.2.p2.4.m4.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S7.2.p2.4.m4.1.1.1.1.3" xref="S7.2.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.2.p2.4.m4.1b"><apply id="S7.2.p2.4.m4.1.1.cmml" xref="S7.2.p2.4.m4.1.1"><times id="S7.2.p2.4.m4.1.1.2.cmml" xref="S7.2.p2.4.m4.1.1.2"></times><ci id="S7.2.p2.4.m4.1.1.3.cmml" xref="S7.2.p2.4.m4.1.1.3">𝑝</ci><apply id="S7.2.p2.4.m4.1.1.1.1.1.cmml" xref="S7.2.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S7.2.p2.4.m4.1.1.1.1.1.1.cmml" xref="S7.2.p2.4.m4.1.1.1.1">subscript</csymbol><ci id="S7.2.p2.4.m4.1.1.1.1.1.2.cmml" xref="S7.2.p2.4.m4.1.1.1.1.1.2">𝜋</ci><ci id="S7.2.p2.4.m4.1.1.1.1.1.3.cmml" xref="S7.2.p2.4.m4.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.2.p2.4.m4.1c">p(\pi_{t})</annotation></semantics></math>. To see this, note that at every timestep (other than <math id="S7.2.p2.5.m5.1" class="ltx_Math" alttext="t=1" display="inline"><semantics id="S7.2.p2.5.m5.1a"><mrow id="S7.2.p2.5.m5.1.1" xref="S7.2.p2.5.m5.1.1.cmml"><mi id="S7.2.p2.5.m5.1.1.2" xref="S7.2.p2.5.m5.1.1.2.cmml">t</mi><mo id="S7.2.p2.5.m5.1.1.1" xref="S7.2.p2.5.m5.1.1.1.cmml">=</mo><mn id="S7.2.p2.5.m5.1.1.3" xref="S7.2.p2.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.2.p2.5.m5.1b"><apply id="S7.2.p2.5.m5.1.1.cmml" xref="S7.2.p2.5.m5.1.1"><eq id="S7.2.p2.5.m5.1.1.1.cmml" xref="S7.2.p2.5.m5.1.1.1"></eq><ci id="S7.2.p2.5.m5.1.1.2.cmml" xref="S7.2.p2.5.m5.1.1.2">𝑡</ci><cn type="integer" id="S7.2.p2.5.m5.1.1.3.cmml" xref="S7.2.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.2.p2.5.m5.1c">t=1</annotation></semantics></math>), the sampling
distribution depends upon <math id="S7.2.p2.6.m6.1" class="ltx_Math" alttext="\{z_{i}\}_{i=1}^{T}" display="inline"><semantics id="S7.2.p2.6.m6.1a"><msubsup id="S7.2.p2.6.m6.1.1" xref="S7.2.p2.6.m6.1.1.cmml"><mrow id="S7.2.p2.6.m6.1.1.1.1.1" xref="S7.2.p2.6.m6.1.1.1.1.2.cmml"><mo stretchy="false" id="S7.2.p2.6.m6.1.1.1.1.1.2" xref="S7.2.p2.6.m6.1.1.1.1.2.cmml">{</mo><msub id="S7.2.p2.6.m6.1.1.1.1.1.1" xref="S7.2.p2.6.m6.1.1.1.1.1.1.cmml"><mi id="S7.2.p2.6.m6.1.1.1.1.1.1.2" xref="S7.2.p2.6.m6.1.1.1.1.1.1.2.cmml">z</mi><mi id="S7.2.p2.6.m6.1.1.1.1.1.1.3" xref="S7.2.p2.6.m6.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S7.2.p2.6.m6.1.1.1.1.1.3" xref="S7.2.p2.6.m6.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S7.2.p2.6.m6.1.1.1.3" xref="S7.2.p2.6.m6.1.1.1.3.cmml"><mi id="S7.2.p2.6.m6.1.1.1.3.2" xref="S7.2.p2.6.m6.1.1.1.3.2.cmml">i</mi><mo id="S7.2.p2.6.m6.1.1.1.3.1" xref="S7.2.p2.6.m6.1.1.1.3.1.cmml">=</mo><mn id="S7.2.p2.6.m6.1.1.1.3.3" xref="S7.2.p2.6.m6.1.1.1.3.3.cmml">1</mn></mrow><mi id="S7.2.p2.6.m6.1.1.3" xref="S7.2.p2.6.m6.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S7.2.p2.6.m6.1b"><apply id="S7.2.p2.6.m6.1.1.cmml" xref="S7.2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S7.2.p2.6.m6.1.1.2.cmml" xref="S7.2.p2.6.m6.1.1">superscript</csymbol><apply id="S7.2.p2.6.m6.1.1.1.cmml" xref="S7.2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S7.2.p2.6.m6.1.1.1.2.cmml" xref="S7.2.p2.6.m6.1.1">subscript</csymbol><set id="S7.2.p2.6.m6.1.1.1.1.2.cmml" xref="S7.2.p2.6.m6.1.1.1.1.1"><apply id="S7.2.p2.6.m6.1.1.1.1.1.1.cmml" xref="S7.2.p2.6.m6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.2.p2.6.m6.1.1.1.1.1.1.1.cmml" xref="S7.2.p2.6.m6.1.1.1.1.1.1">subscript</csymbol><ci id="S7.2.p2.6.m6.1.1.1.1.1.1.2.cmml" xref="S7.2.p2.6.m6.1.1.1.1.1.1.2">𝑧</ci><ci id="S7.2.p2.6.m6.1.1.1.1.1.1.3.cmml" xref="S7.2.p2.6.m6.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S7.2.p2.6.m6.1.1.1.3.cmml" xref="S7.2.p2.6.m6.1.1.1.3"><eq id="S7.2.p2.6.m6.1.1.1.3.1.cmml" xref="S7.2.p2.6.m6.1.1.1.3.1"></eq><ci id="S7.2.p2.6.m6.1.1.1.3.2.cmml" xref="S7.2.p2.6.m6.1.1.1.3.2">𝑖</ci><cn type="integer" id="S7.2.p2.6.m6.1.1.1.3.3.cmml" xref="S7.2.p2.6.m6.1.1.1.3.3">1</cn></apply></apply><ci id="S7.2.p2.6.m6.1.1.3.cmml" xref="S7.2.p2.6.m6.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.2.p2.6.m6.1c">\{z_{i}\}_{i=1}^{T}</annotation></semantics></math>, which is set of random variables.
Let <math id="S7.2.p2.7.m7.2" class="ltx_Math" alttext="p(\Pi,\mathbf{z})" display="inline"><semantics id="S7.2.p2.7.m7.2a"><mrow id="S7.2.p2.7.m7.2.3" xref="S7.2.p2.7.m7.2.3.cmml"><mi id="S7.2.p2.7.m7.2.3.2" xref="S7.2.p2.7.m7.2.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S7.2.p2.7.m7.2.3.1" xref="S7.2.p2.7.m7.2.3.1.cmml">​</mo><mrow id="S7.2.p2.7.m7.2.3.3.2" xref="S7.2.p2.7.m7.2.3.3.1.cmml"><mo stretchy="false" id="S7.2.p2.7.m7.2.3.3.2.1" xref="S7.2.p2.7.m7.2.3.3.1.cmml">(</mo><mi mathvariant="normal" id="S7.2.p2.7.m7.1.1" xref="S7.2.p2.7.m7.1.1.cmml">Π</mi><mo id="S7.2.p2.7.m7.2.3.3.2.2" xref="S7.2.p2.7.m7.2.3.3.1.cmml">,</mo><mi id="S7.2.p2.7.m7.2.2" xref="S7.2.p2.7.m7.2.2.cmml">𝐳</mi><mo stretchy="false" id="S7.2.p2.7.m7.2.3.3.2.3" xref="S7.2.p2.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.2.p2.7.m7.2b"><apply id="S7.2.p2.7.m7.2.3.cmml" xref="S7.2.p2.7.m7.2.3"><times id="S7.2.p2.7.m7.2.3.1.cmml" xref="S7.2.p2.7.m7.2.3.1"></times><ci id="S7.2.p2.7.m7.2.3.2.cmml" xref="S7.2.p2.7.m7.2.3.2">𝑝</ci><interval closure="open" id="S7.2.p2.7.m7.2.3.3.1.cmml" xref="S7.2.p2.7.m7.2.3.3.2"><ci id="S7.2.p2.7.m7.1.1.cmml" xref="S7.2.p2.7.m7.1.1">Π</ci><ci id="S7.2.p2.7.m7.2.2.cmml" xref="S7.2.p2.7.m7.2.2">𝐳</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.2.p2.7.m7.2c">p(\Pi,\mathbf{z})</annotation></semantics></math> denote the joint distribution of all the sampling distributions
across multiple timesteps <math id="S7.2.p2.8.m8.3" class="ltx_Math" alttext="\Pi=(\pi_{1},\cdots,\pi_{T})" display="inline"><semantics id="S7.2.p2.8.m8.3a"><mrow id="S7.2.p2.8.m8.3.3" xref="S7.2.p2.8.m8.3.3.cmml"><mi mathvariant="normal" id="S7.2.p2.8.m8.3.3.4" xref="S7.2.p2.8.m8.3.3.4.cmml">Π</mi><mo id="S7.2.p2.8.m8.3.3.3" xref="S7.2.p2.8.m8.3.3.3.cmml">=</mo><mrow id="S7.2.p2.8.m8.3.3.2.2" xref="S7.2.p2.8.m8.3.3.2.3.cmml"><mo stretchy="false" id="S7.2.p2.8.m8.3.3.2.2.3" xref="S7.2.p2.8.m8.3.3.2.3.cmml">(</mo><msub id="S7.2.p2.8.m8.2.2.1.1.1" xref="S7.2.p2.8.m8.2.2.1.1.1.cmml"><mi id="S7.2.p2.8.m8.2.2.1.1.1.2" xref="S7.2.p2.8.m8.2.2.1.1.1.2.cmml">π</mi><mn id="S7.2.p2.8.m8.2.2.1.1.1.3" xref="S7.2.p2.8.m8.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S7.2.p2.8.m8.3.3.2.2.4" xref="S7.2.p2.8.m8.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S7.2.p2.8.m8.1.1" xref="S7.2.p2.8.m8.1.1.cmml">⋯</mi><mo id="S7.2.p2.8.m8.3.3.2.2.5" xref="S7.2.p2.8.m8.3.3.2.3.cmml">,</mo><msub id="S7.2.p2.8.m8.3.3.2.2.2" xref="S7.2.p2.8.m8.3.3.2.2.2.cmml"><mi id="S7.2.p2.8.m8.3.3.2.2.2.2" xref="S7.2.p2.8.m8.3.3.2.2.2.2.cmml">π</mi><mi id="S7.2.p2.8.m8.3.3.2.2.2.3" xref="S7.2.p2.8.m8.3.3.2.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="S7.2.p2.8.m8.3.3.2.2.6" xref="S7.2.p2.8.m8.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.2.p2.8.m8.3b"><apply id="S7.2.p2.8.m8.3.3.cmml" xref="S7.2.p2.8.m8.3.3"><eq id="S7.2.p2.8.m8.3.3.3.cmml" xref="S7.2.p2.8.m8.3.3.3"></eq><ci id="S7.2.p2.8.m8.3.3.4.cmml" xref="S7.2.p2.8.m8.3.3.4">Π</ci><vector id="S7.2.p2.8.m8.3.3.2.3.cmml" xref="S7.2.p2.8.m8.3.3.2.2"><apply id="S7.2.p2.8.m8.2.2.1.1.1.cmml" xref="S7.2.p2.8.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="S7.2.p2.8.m8.2.2.1.1.1.1.cmml" xref="S7.2.p2.8.m8.2.2.1.1.1">subscript</csymbol><ci id="S7.2.p2.8.m8.2.2.1.1.1.2.cmml" xref="S7.2.p2.8.m8.2.2.1.1.1.2">𝜋</ci><cn type="integer" id="S7.2.p2.8.m8.2.2.1.1.1.3.cmml" xref="S7.2.p2.8.m8.2.2.1.1.1.3">1</cn></apply><ci id="S7.2.p2.8.m8.1.1.cmml" xref="S7.2.p2.8.m8.1.1">⋯</ci><apply id="S7.2.p2.8.m8.3.3.2.2.2.cmml" xref="S7.2.p2.8.m8.3.3.2.2.2"><csymbol cd="ambiguous" id="S7.2.p2.8.m8.3.3.2.2.2.1.cmml" xref="S7.2.p2.8.m8.3.3.2.2.2">subscript</csymbol><ci id="S7.2.p2.8.m8.3.3.2.2.2.2.cmml" xref="S7.2.p2.8.m8.3.3.2.2.2.2">𝜋</ci><ci id="S7.2.p2.8.m8.3.3.2.2.2.3.cmml" xref="S7.2.p2.8.m8.3.3.2.2.2.3">𝑇</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.2.p2.8.m8.3c">\Pi=(\pi_{1},\cdots,\pi_{T})</annotation></semantics></math> and <math id="S7.2.p2.9.m9.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S7.2.p2.9.m9.1a"><mi id="S7.2.p2.9.m9.1.1" xref="S7.2.p2.9.m9.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S7.2.p2.9.m9.1b"><ci id="S7.2.p2.9.m9.1.1.cmml" xref="S7.2.p2.9.m9.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.2.p2.9.m9.1c">\mathbf{z}</annotation></semantics></math>, the realized
programs from the distribution. Let <math id="S7.2.p2.10.m10.2" class="ltx_Math" alttext="\mathcal{G}=\{\pi_{i},\mathbf{z}_{i}\}_{i=1}^{T}" display="inline"><semantics id="S7.2.p2.10.m10.2a"><mrow id="S7.2.p2.10.m10.2.2" xref="S7.2.p2.10.m10.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.2.p2.10.m10.2.2.4" xref="S7.2.p2.10.m10.2.2.4.cmml">𝒢</mi><mo id="S7.2.p2.10.m10.2.2.3" xref="S7.2.p2.10.m10.2.2.3.cmml">=</mo><msubsup id="S7.2.p2.10.m10.2.2.2" xref="S7.2.p2.10.m10.2.2.2.cmml"><mrow id="S7.2.p2.10.m10.2.2.2.2.2.2" xref="S7.2.p2.10.m10.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S7.2.p2.10.m10.2.2.2.2.2.2.3" xref="S7.2.p2.10.m10.2.2.2.2.2.3.cmml">{</mo><msub id="S7.2.p2.10.m10.1.1.1.1.1.1.1" xref="S7.2.p2.10.m10.1.1.1.1.1.1.1.cmml"><mi id="S7.2.p2.10.m10.1.1.1.1.1.1.1.2" xref="S7.2.p2.10.m10.1.1.1.1.1.1.1.2.cmml">π</mi><mi id="S7.2.p2.10.m10.1.1.1.1.1.1.1.3" xref="S7.2.p2.10.m10.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S7.2.p2.10.m10.2.2.2.2.2.2.4" xref="S7.2.p2.10.m10.2.2.2.2.2.3.cmml">,</mo><msub id="S7.2.p2.10.m10.2.2.2.2.2.2.2" xref="S7.2.p2.10.m10.2.2.2.2.2.2.2.cmml"><mi id="S7.2.p2.10.m10.2.2.2.2.2.2.2.2" xref="S7.2.p2.10.m10.2.2.2.2.2.2.2.2.cmml">𝐳</mi><mi id="S7.2.p2.10.m10.2.2.2.2.2.2.2.3" xref="S7.2.p2.10.m10.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S7.2.p2.10.m10.2.2.2.2.2.2.5" xref="S7.2.p2.10.m10.2.2.2.2.2.3.cmml">}</mo></mrow><mrow id="S7.2.p2.10.m10.2.2.2.2.4" xref="S7.2.p2.10.m10.2.2.2.2.4.cmml"><mi id="S7.2.p2.10.m10.2.2.2.2.4.2" xref="S7.2.p2.10.m10.2.2.2.2.4.2.cmml">i</mi><mo id="S7.2.p2.10.m10.2.2.2.2.4.1" xref="S7.2.p2.10.m10.2.2.2.2.4.1.cmml">=</mo><mn id="S7.2.p2.10.m10.2.2.2.2.4.3" xref="S7.2.p2.10.m10.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="S7.2.p2.10.m10.2.2.2.4" xref="S7.2.p2.10.m10.2.2.2.4.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S7.2.p2.10.m10.2b"><apply id="S7.2.p2.10.m10.2.2.cmml" xref="S7.2.p2.10.m10.2.2"><eq id="S7.2.p2.10.m10.2.2.3.cmml" xref="S7.2.p2.10.m10.2.2.3"></eq><ci id="S7.2.p2.10.m10.2.2.4.cmml" xref="S7.2.p2.10.m10.2.2.4">𝒢</ci><apply id="S7.2.p2.10.m10.2.2.2.cmml" xref="S7.2.p2.10.m10.2.2.2"><csymbol cd="ambiguous" id="S7.2.p2.10.m10.2.2.2.3.cmml" xref="S7.2.p2.10.m10.2.2.2">superscript</csymbol><apply id="S7.2.p2.10.m10.2.2.2.2.cmml" xref="S7.2.p2.10.m10.2.2.2"><csymbol cd="ambiguous" id="S7.2.p2.10.m10.2.2.2.2.3.cmml" xref="S7.2.p2.10.m10.2.2.2">subscript</csymbol><set id="S7.2.p2.10.m10.2.2.2.2.2.3.cmml" xref="S7.2.p2.10.m10.2.2.2.2.2.2"><apply id="S7.2.p2.10.m10.1.1.1.1.1.1.1.cmml" xref="S7.2.p2.10.m10.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.2.p2.10.m10.1.1.1.1.1.1.1.1.cmml" xref="S7.2.p2.10.m10.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.2.p2.10.m10.1.1.1.1.1.1.1.2.cmml" xref="S7.2.p2.10.m10.1.1.1.1.1.1.1.2">𝜋</ci><ci id="S7.2.p2.10.m10.1.1.1.1.1.1.1.3.cmml" xref="S7.2.p2.10.m10.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S7.2.p2.10.m10.2.2.2.2.2.2.2.cmml" xref="S7.2.p2.10.m10.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S7.2.p2.10.m10.2.2.2.2.2.2.2.1.cmml" xref="S7.2.p2.10.m10.2.2.2.2.2.2.2">subscript</csymbol><ci id="S7.2.p2.10.m10.2.2.2.2.2.2.2.2.cmml" xref="S7.2.p2.10.m10.2.2.2.2.2.2.2.2">𝐳</ci><ci id="S7.2.p2.10.m10.2.2.2.2.2.2.2.3.cmml" xref="S7.2.p2.10.m10.2.2.2.2.2.2.2.3">𝑖</ci></apply></set><apply id="S7.2.p2.10.m10.2.2.2.2.4.cmml" xref="S7.2.p2.10.m10.2.2.2.2.4"><eq id="S7.2.p2.10.m10.2.2.2.2.4.1.cmml" xref="S7.2.p2.10.m10.2.2.2.2.4.1"></eq><ci id="S7.2.p2.10.m10.2.2.2.2.4.2.cmml" xref="S7.2.p2.10.m10.2.2.2.2.4.2">𝑖</ci><cn type="integer" id="S7.2.p2.10.m10.2.2.2.2.4.3.cmml" xref="S7.2.p2.10.m10.2.2.2.2.4.3">1</cn></apply></apply><ci id="S7.2.p2.10.m10.2.2.2.4.cmml" xref="S7.2.p2.10.m10.2.2.2.4">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.2.p2.10.m10.2c">\mathcal{G}=\{\pi_{i},\mathbf{z}_{i}\}_{i=1}^{T}</annotation></semantics></math></p>
</div>
<div id="S7.3.p3" class="ltx_para">
<p id="S7.3.p3.6" class="ltx_p">Since <math id="S7.3.p3.1.m1.1" class="ltx_Math" alttext="\pi_{t}" display="inline"><semantics id="S7.3.p3.1.m1.1a"><msub id="S7.3.p3.1.m1.1.1" xref="S7.3.p3.1.m1.1.1.cmml"><mi id="S7.3.p3.1.m1.1.1.2" xref="S7.3.p3.1.m1.1.1.2.cmml">π</mi><mi id="S7.3.p3.1.m1.1.1.3" xref="S7.3.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S7.3.p3.1.m1.1b"><apply id="S7.3.p3.1.m1.1.1.cmml" xref="S7.3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S7.3.p3.1.m1.1.1.1.cmml" xref="S7.3.p3.1.m1.1.1">subscript</csymbol><ci id="S7.3.p3.1.m1.1.1.2.cmml" xref="S7.3.p3.1.m1.1.1.2">𝜋</ci><ci id="S7.3.p3.1.m1.1.1.3.cmml" xref="S7.3.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.3.p3.1.m1.1c">\pi_{t}</annotation></semantics></math> refers to the sampling distribution for <math id="S7.3.p3.2.m2.1" class="ltx_Math" alttext="z_{t}" display="inline"><semantics id="S7.3.p3.2.m2.1a"><msub id="S7.3.p3.2.m2.1.1" xref="S7.3.p3.2.m2.1.1.cmml"><mi id="S7.3.p3.2.m2.1.1.2" xref="S7.3.p3.2.m2.1.1.2.cmml">z</mi><mi id="S7.3.p3.2.m2.1.1.3" xref="S7.3.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S7.3.p3.2.m2.1b"><apply id="S7.3.p3.2.m2.1.1.cmml" xref="S7.3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S7.3.p3.2.m2.1.1.1.cmml" xref="S7.3.p3.2.m2.1.1">subscript</csymbol><ci id="S7.3.p3.2.m2.1.1.2.cmml" xref="S7.3.p3.2.m2.1.1.2">𝑧</ci><ci id="S7.3.p3.2.m2.1.1.3.cmml" xref="S7.3.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.3.p3.2.m2.1c">z_{t}</annotation></semantics></math>, we immediately
notice that <math id="S7.3.p3.3.m3.1" class="ltx_Math" alttext="z_{t}\perp\mathcal{G}/\pi_{t}|\pi_{t}" display="inline"><semantics id="S7.3.p3.3.m3.1a"><mrow id="S7.3.p3.3.m3.1.1" xref="S7.3.p3.3.m3.1.1.cmml"><msub id="S7.3.p3.3.m3.1.1.2" xref="S7.3.p3.3.m3.1.1.2.cmml"><mi id="S7.3.p3.3.m3.1.1.2.2" xref="S7.3.p3.3.m3.1.1.2.2.cmml">z</mi><mi id="S7.3.p3.3.m3.1.1.2.3" xref="S7.3.p3.3.m3.1.1.2.3.cmml">t</mi></msub><mo id="S7.3.p3.3.m3.1.1.1" xref="S7.3.p3.3.m3.1.1.1.cmml">⟂</mo><mrow id="S7.3.p3.3.m3.1.1.3" xref="S7.3.p3.3.m3.1.1.3.cmml"><mrow id="S7.3.p3.3.m3.1.1.3.2" xref="S7.3.p3.3.m3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.3.p3.3.m3.1.1.3.2.2" xref="S7.3.p3.3.m3.1.1.3.2.2.cmml">𝒢</mi><mo id="S7.3.p3.3.m3.1.1.3.2.1" xref="S7.3.p3.3.m3.1.1.3.2.1.cmml">/</mo><msub id="S7.3.p3.3.m3.1.1.3.2.3" xref="S7.3.p3.3.m3.1.1.3.2.3.cmml"><mi id="S7.3.p3.3.m3.1.1.3.2.3.2" xref="S7.3.p3.3.m3.1.1.3.2.3.2.cmml">π</mi><mi id="S7.3.p3.3.m3.1.1.3.2.3.3" xref="S7.3.p3.3.m3.1.1.3.2.3.3.cmml">t</mi></msub></mrow><mo fence="false" id="S7.3.p3.3.m3.1.1.3.1" xref="S7.3.p3.3.m3.1.1.3.1.cmml">|</mo><msub id="S7.3.p3.3.m3.1.1.3.3" xref="S7.3.p3.3.m3.1.1.3.3.cmml"><mi id="S7.3.p3.3.m3.1.1.3.3.2" xref="S7.3.p3.3.m3.1.1.3.3.2.cmml">π</mi><mi id="S7.3.p3.3.m3.1.1.3.3.3" xref="S7.3.p3.3.m3.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.3.p3.3.m3.1b"><apply id="S7.3.p3.3.m3.1.1.cmml" xref="S7.3.p3.3.m3.1.1"><csymbol cd="latexml" id="S7.3.p3.3.m3.1.1.1.cmml" xref="S7.3.p3.3.m3.1.1.1">perpendicular-to</csymbol><apply id="S7.3.p3.3.m3.1.1.2.cmml" xref="S7.3.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S7.3.p3.3.m3.1.1.2.1.cmml" xref="S7.3.p3.3.m3.1.1.2">subscript</csymbol><ci id="S7.3.p3.3.m3.1.1.2.2.cmml" xref="S7.3.p3.3.m3.1.1.2.2">𝑧</ci><ci id="S7.3.p3.3.m3.1.1.2.3.cmml" xref="S7.3.p3.3.m3.1.1.2.3">𝑡</ci></apply><apply id="S7.3.p3.3.m3.1.1.3.cmml" xref="S7.3.p3.3.m3.1.1.3"><csymbol cd="latexml" id="S7.3.p3.3.m3.1.1.3.1.cmml" xref="S7.3.p3.3.m3.1.1.3.1">conditional</csymbol><apply id="S7.3.p3.3.m3.1.1.3.2.cmml" xref="S7.3.p3.3.m3.1.1.3.2"><divide id="S7.3.p3.3.m3.1.1.3.2.1.cmml" xref="S7.3.p3.3.m3.1.1.3.2.1"></divide><ci id="S7.3.p3.3.m3.1.1.3.2.2.cmml" xref="S7.3.p3.3.m3.1.1.3.2.2">𝒢</ci><apply id="S7.3.p3.3.m3.1.1.3.2.3.cmml" xref="S7.3.p3.3.m3.1.1.3.2.3"><csymbol cd="ambiguous" id="S7.3.p3.3.m3.1.1.3.2.3.1.cmml" xref="S7.3.p3.3.m3.1.1.3.2.3">subscript</csymbol><ci id="S7.3.p3.3.m3.1.1.3.2.3.2.cmml" xref="S7.3.p3.3.m3.1.1.3.2.3.2">𝜋</ci><ci id="S7.3.p3.3.m3.1.1.3.2.3.3.cmml" xref="S7.3.p3.3.m3.1.1.3.2.3.3">𝑡</ci></apply></apply><apply id="S7.3.p3.3.m3.1.1.3.3.cmml" xref="S7.3.p3.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S7.3.p3.3.m3.1.1.3.3.1.cmml" xref="S7.3.p3.3.m3.1.1.3.3">subscript</csymbol><ci id="S7.3.p3.3.m3.1.1.3.3.2.cmml" xref="S7.3.p3.3.m3.1.1.3.3.2">𝜋</ci><ci id="S7.3.p3.3.m3.1.1.3.3.3.cmml" xref="S7.3.p3.3.m3.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.3.p3.3.m3.1c">z_{t}\perp\mathcal{G}/\pi_{t}|\pi_{t}</annotation></semantics></math>. That is, <math id="S7.3.p3.4.m4.1" class="ltx_Math" alttext="z_{t}" display="inline"><semantics id="S7.3.p3.4.m4.1a"><msub id="S7.3.p3.4.m4.1.1" xref="S7.3.p3.4.m4.1.1.cmml"><mi id="S7.3.p3.4.m4.1.1.2" xref="S7.3.p3.4.m4.1.1.2.cmml">z</mi><mi id="S7.3.p3.4.m4.1.1.3" xref="S7.3.p3.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S7.3.p3.4.m4.1b"><apply id="S7.3.p3.4.m4.1.1.cmml" xref="S7.3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S7.3.p3.4.m4.1.1.1.cmml" xref="S7.3.p3.4.m4.1.1">subscript</csymbol><ci id="S7.3.p3.4.m4.1.1.2.cmml" xref="S7.3.p3.4.m4.1.1.2">𝑧</ci><ci id="S7.3.p3.4.m4.1.1.3.cmml" xref="S7.3.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.3.p3.4.m4.1c">z_{t}</annotation></semantics></math> only
depends on the sampling distribution at time <math id="S7.3.p3.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S7.3.p3.5.m5.1a"><mi id="S7.3.p3.5.m5.1.1" xref="S7.3.p3.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S7.3.p3.5.m5.1b"><ci id="S7.3.p3.5.m5.1.1.cmml" xref="S7.3.p3.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.3.p3.5.m5.1c">t</annotation></semantics></math>, meaning that
<math id="S7.3.p3.6.m6.2" class="ltx_Math" alttext="\log p(\mathbf{z}|\Pi)=\sum_{t=1}^{T}\log p(z_{t}|\pi_{t})" display="inline"><semantics id="S7.3.p3.6.m6.2a"><mrow id="S7.3.p3.6.m6.2.2" xref="S7.3.p3.6.m6.2.2.cmml"><mrow id="S7.3.p3.6.m6.1.1.1" xref="S7.3.p3.6.m6.1.1.1.cmml"><mrow id="S7.3.p3.6.m6.1.1.1.3" xref="S7.3.p3.6.m6.1.1.1.3.cmml"><mi id="S7.3.p3.6.m6.1.1.1.3.1" xref="S7.3.p3.6.m6.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S7.3.p3.6.m6.1.1.1.3a" xref="S7.3.p3.6.m6.1.1.1.3.cmml">⁡</mo><mi id="S7.3.p3.6.m6.1.1.1.3.2" xref="S7.3.p3.6.m6.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.3.p3.6.m6.1.1.1.2" xref="S7.3.p3.6.m6.1.1.1.2.cmml">​</mo><mrow id="S7.3.p3.6.m6.1.1.1.1.1" xref="S7.3.p3.6.m6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.3.p3.6.m6.1.1.1.1.1.2" xref="S7.3.p3.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.3.p3.6.m6.1.1.1.1.1.1" xref="S7.3.p3.6.m6.1.1.1.1.1.1.cmml"><mi id="S7.3.p3.6.m6.1.1.1.1.1.1.2" xref="S7.3.p3.6.m6.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S7.3.p3.6.m6.1.1.1.1.1.1.1" xref="S7.3.p3.6.m6.1.1.1.1.1.1.1.cmml">|</mo><mi mathvariant="normal" id="S7.3.p3.6.m6.1.1.1.1.1.1.3" xref="S7.3.p3.6.m6.1.1.1.1.1.1.3.cmml">Π</mi></mrow><mo stretchy="false" id="S7.3.p3.6.m6.1.1.1.1.1.3" xref="S7.3.p3.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S7.3.p3.6.m6.2.2.3" xref="S7.3.p3.6.m6.2.2.3.cmml">=</mo><mrow id="S7.3.p3.6.m6.2.2.2" xref="S7.3.p3.6.m6.2.2.2.cmml"><msubsup id="S7.3.p3.6.m6.2.2.2.2" xref="S7.3.p3.6.m6.2.2.2.2.cmml"><mo id="S7.3.p3.6.m6.2.2.2.2.2.2" xref="S7.3.p3.6.m6.2.2.2.2.2.2.cmml">∑</mo><mrow id="S7.3.p3.6.m6.2.2.2.2.2.3" xref="S7.3.p3.6.m6.2.2.2.2.2.3.cmml"><mi id="S7.3.p3.6.m6.2.2.2.2.2.3.2" xref="S7.3.p3.6.m6.2.2.2.2.2.3.2.cmml">t</mi><mo id="S7.3.p3.6.m6.2.2.2.2.2.3.1" xref="S7.3.p3.6.m6.2.2.2.2.2.3.1.cmml">=</mo><mn id="S7.3.p3.6.m6.2.2.2.2.2.3.3" xref="S7.3.p3.6.m6.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S7.3.p3.6.m6.2.2.2.2.3" xref="S7.3.p3.6.m6.2.2.2.2.3.cmml">T</mi></msubsup><mrow id="S7.3.p3.6.m6.2.2.2.1" xref="S7.3.p3.6.m6.2.2.2.1.cmml"><mrow id="S7.3.p3.6.m6.2.2.2.1.3" xref="S7.3.p3.6.m6.2.2.2.1.3.cmml"><mi id="S7.3.p3.6.m6.2.2.2.1.3.1" xref="S7.3.p3.6.m6.2.2.2.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S7.3.p3.6.m6.2.2.2.1.3a" xref="S7.3.p3.6.m6.2.2.2.1.3.cmml">⁡</mo><mi id="S7.3.p3.6.m6.2.2.2.1.3.2" xref="S7.3.p3.6.m6.2.2.2.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.3.p3.6.m6.2.2.2.1.2" xref="S7.3.p3.6.m6.2.2.2.1.2.cmml">​</mo><mrow id="S7.3.p3.6.m6.2.2.2.1.1.1" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S7.3.p3.6.m6.2.2.2.1.1.1.2" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S7.3.p3.6.m6.2.2.2.1.1.1.1" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.cmml"><msub id="S7.3.p3.6.m6.2.2.2.1.1.1.1.2" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.2.cmml"><mi id="S7.3.p3.6.m6.2.2.2.1.1.1.1.2.2" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.2.2.cmml">z</mi><mi id="S7.3.p3.6.m6.2.2.2.1.1.1.1.2.3" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S7.3.p3.6.m6.2.2.2.1.1.1.1.1" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.1.cmml">|</mo><msub id="S7.3.p3.6.m6.2.2.2.1.1.1.1.3" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.3.cmml"><mi id="S7.3.p3.6.m6.2.2.2.1.1.1.1.3.2" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.3.2.cmml">π</mi><mi id="S7.3.p3.6.m6.2.2.2.1.1.1.1.3.3" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S7.3.p3.6.m6.2.2.2.1.1.1.3" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.3.p3.6.m6.2b"><apply id="S7.3.p3.6.m6.2.2.cmml" xref="S7.3.p3.6.m6.2.2"><eq id="S7.3.p3.6.m6.2.2.3.cmml" xref="S7.3.p3.6.m6.2.2.3"></eq><apply id="S7.3.p3.6.m6.1.1.1.cmml" xref="S7.3.p3.6.m6.1.1.1"><times id="S7.3.p3.6.m6.1.1.1.2.cmml" xref="S7.3.p3.6.m6.1.1.1.2"></times><apply id="S7.3.p3.6.m6.1.1.1.3.cmml" xref="S7.3.p3.6.m6.1.1.1.3"><log id="S7.3.p3.6.m6.1.1.1.3.1.cmml" xref="S7.3.p3.6.m6.1.1.1.3.1"></log><ci id="S7.3.p3.6.m6.1.1.1.3.2.cmml" xref="S7.3.p3.6.m6.1.1.1.3.2">𝑝</ci></apply><apply id="S7.3.p3.6.m6.1.1.1.1.1.1.cmml" xref="S7.3.p3.6.m6.1.1.1.1.1"><csymbol cd="latexml" id="S7.3.p3.6.m6.1.1.1.1.1.1.1.cmml" xref="S7.3.p3.6.m6.1.1.1.1.1.1.1">conditional</csymbol><ci id="S7.3.p3.6.m6.1.1.1.1.1.1.2.cmml" xref="S7.3.p3.6.m6.1.1.1.1.1.1.2">𝐳</ci><ci id="S7.3.p3.6.m6.1.1.1.1.1.1.3.cmml" xref="S7.3.p3.6.m6.1.1.1.1.1.1.3">Π</ci></apply></apply><apply id="S7.3.p3.6.m6.2.2.2.cmml" xref="S7.3.p3.6.m6.2.2.2"><apply id="S7.3.p3.6.m6.2.2.2.2.cmml" xref="S7.3.p3.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S7.3.p3.6.m6.2.2.2.2.1.cmml" xref="S7.3.p3.6.m6.2.2.2.2">superscript</csymbol><apply id="S7.3.p3.6.m6.2.2.2.2.2.cmml" xref="S7.3.p3.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S7.3.p3.6.m6.2.2.2.2.2.1.cmml" xref="S7.3.p3.6.m6.2.2.2.2">subscript</csymbol><sum id="S7.3.p3.6.m6.2.2.2.2.2.2.cmml" xref="S7.3.p3.6.m6.2.2.2.2.2.2"></sum><apply id="S7.3.p3.6.m6.2.2.2.2.2.3.cmml" xref="S7.3.p3.6.m6.2.2.2.2.2.3"><eq id="S7.3.p3.6.m6.2.2.2.2.2.3.1.cmml" xref="S7.3.p3.6.m6.2.2.2.2.2.3.1"></eq><ci id="S7.3.p3.6.m6.2.2.2.2.2.3.2.cmml" xref="S7.3.p3.6.m6.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S7.3.p3.6.m6.2.2.2.2.2.3.3.cmml" xref="S7.3.p3.6.m6.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S7.3.p3.6.m6.2.2.2.2.3.cmml" xref="S7.3.p3.6.m6.2.2.2.2.3">𝑇</ci></apply><apply id="S7.3.p3.6.m6.2.2.2.1.cmml" xref="S7.3.p3.6.m6.2.2.2.1"><times id="S7.3.p3.6.m6.2.2.2.1.2.cmml" xref="S7.3.p3.6.m6.2.2.2.1.2"></times><apply id="S7.3.p3.6.m6.2.2.2.1.3.cmml" xref="S7.3.p3.6.m6.2.2.2.1.3"><log id="S7.3.p3.6.m6.2.2.2.1.3.1.cmml" xref="S7.3.p3.6.m6.2.2.2.1.3.1"></log><ci id="S7.3.p3.6.m6.2.2.2.1.3.2.cmml" xref="S7.3.p3.6.m6.2.2.2.1.3.2">𝑝</ci></apply><apply id="S7.3.p3.6.m6.2.2.2.1.1.1.1.cmml" xref="S7.3.p3.6.m6.2.2.2.1.1.1"><csymbol cd="latexml" id="S7.3.p3.6.m6.2.2.2.1.1.1.1.1.cmml" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.1">conditional</csymbol><apply id="S7.3.p3.6.m6.2.2.2.1.1.1.1.2.cmml" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.3.p3.6.m6.2.2.2.1.1.1.1.2.1.cmml" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S7.3.p3.6.m6.2.2.2.1.1.1.1.2.2.cmml" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.2.2">𝑧</ci><ci id="S7.3.p3.6.m6.2.2.2.1.1.1.1.2.3.cmml" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="S7.3.p3.6.m6.2.2.2.1.1.1.1.3.cmml" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.3.p3.6.m6.2.2.2.1.1.1.1.3.1.cmml" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S7.3.p3.6.m6.2.2.2.1.1.1.1.3.2.cmml" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.3.2">𝜋</ci><ci id="S7.3.p3.6.m6.2.2.2.1.1.1.1.3.3.cmml" xref="S7.3.p3.6.m6.2.2.2.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.3.p3.6.m6.2c">\log p(\mathbf{z}|\Pi)=\sum_{t=1}^{T}\log p(z_{t}|\pi_{t})</annotation></semantics></math>.</p>
</div>
<div id="S7.4.p4" class="ltx_para">
<p id="S7.4.p4.2" class="ltx_p">With this (stochastic) prior parameterization, we can factorize the full
graphical model now as follows: <math id="S7.4.p4.1.m1.6" class="ltx_Math" alttext="p(\mathbf{x},\mathbf{z},\Pi)=p(\Pi)p(\mathbf{z}|\Pi)p_{\sigma}(\mathbf{x}|\mathbf{z})" display="inline"><semantics id="S7.4.p4.1.m1.6a"><mrow id="S7.4.p4.1.m1.6.6" xref="S7.4.p4.1.m1.6.6.cmml"><mrow id="S7.4.p4.1.m1.6.6.4" xref="S7.4.p4.1.m1.6.6.4.cmml"><mi id="S7.4.p4.1.m1.6.6.4.2" xref="S7.4.p4.1.m1.6.6.4.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S7.4.p4.1.m1.6.6.4.1" xref="S7.4.p4.1.m1.6.6.4.1.cmml">​</mo><mrow id="S7.4.p4.1.m1.6.6.4.3.2" xref="S7.4.p4.1.m1.6.6.4.3.1.cmml"><mo stretchy="false" id="S7.4.p4.1.m1.6.6.4.3.2.1" xref="S7.4.p4.1.m1.6.6.4.3.1.cmml">(</mo><mi id="S7.4.p4.1.m1.1.1" xref="S7.4.p4.1.m1.1.1.cmml">𝐱</mi><mo id="S7.4.p4.1.m1.6.6.4.3.2.2" xref="S7.4.p4.1.m1.6.6.4.3.1.cmml">,</mo><mi id="S7.4.p4.1.m1.2.2" xref="S7.4.p4.1.m1.2.2.cmml">𝐳</mi><mo id="S7.4.p4.1.m1.6.6.4.3.2.3" xref="S7.4.p4.1.m1.6.6.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S7.4.p4.1.m1.3.3" xref="S7.4.p4.1.m1.3.3.cmml">Π</mi><mo stretchy="false" id="S7.4.p4.1.m1.6.6.4.3.2.4" xref="S7.4.p4.1.m1.6.6.4.3.1.cmml">)</mo></mrow></mrow><mo id="S7.4.p4.1.m1.6.6.3" xref="S7.4.p4.1.m1.6.6.3.cmml">=</mo><mrow id="S7.4.p4.1.m1.6.6.2" xref="S7.4.p4.1.m1.6.6.2.cmml"><mi id="S7.4.p4.1.m1.6.6.2.4" xref="S7.4.p4.1.m1.6.6.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S7.4.p4.1.m1.6.6.2.3" xref="S7.4.p4.1.m1.6.6.2.3.cmml">​</mo><mrow id="S7.4.p4.1.m1.6.6.2.5.2" xref="S7.4.p4.1.m1.6.6.2.cmml"><mo stretchy="false" id="S7.4.p4.1.m1.6.6.2.5.2.1" xref="S7.4.p4.1.m1.6.6.2.cmml">(</mo><mi mathvariant="normal" id="S7.4.p4.1.m1.4.4" xref="S7.4.p4.1.m1.4.4.cmml">Π</mi><mo stretchy="false" id="S7.4.p4.1.m1.6.6.2.5.2.2" xref="S7.4.p4.1.m1.6.6.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S7.4.p4.1.m1.6.6.2.3a" xref="S7.4.p4.1.m1.6.6.2.3.cmml">​</mo><mi id="S7.4.p4.1.m1.6.6.2.6" xref="S7.4.p4.1.m1.6.6.2.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="S7.4.p4.1.m1.6.6.2.3b" xref="S7.4.p4.1.m1.6.6.2.3.cmml">​</mo><mrow id="S7.4.p4.1.m1.5.5.1.1.1" xref="S7.4.p4.1.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S7.4.p4.1.m1.5.5.1.1.1.2" xref="S7.4.p4.1.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S7.4.p4.1.m1.5.5.1.1.1.1" xref="S7.4.p4.1.m1.5.5.1.1.1.1.cmml"><mi id="S7.4.p4.1.m1.5.5.1.1.1.1.2" xref="S7.4.p4.1.m1.5.5.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S7.4.p4.1.m1.5.5.1.1.1.1.1" xref="S7.4.p4.1.m1.5.5.1.1.1.1.1.cmml">|</mo><mi mathvariant="normal" id="S7.4.p4.1.m1.5.5.1.1.1.1.3" xref="S7.4.p4.1.m1.5.5.1.1.1.1.3.cmml">Π</mi></mrow><mo stretchy="false" id="S7.4.p4.1.m1.5.5.1.1.1.3" xref="S7.4.p4.1.m1.5.5.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S7.4.p4.1.m1.6.6.2.3c" xref="S7.4.p4.1.m1.6.6.2.3.cmml">​</mo><msub id="S7.4.p4.1.m1.6.6.2.7" xref="S7.4.p4.1.m1.6.6.2.7.cmml"><mi id="S7.4.p4.1.m1.6.6.2.7.2" xref="S7.4.p4.1.m1.6.6.2.7.2.cmml">p</mi><mi id="S7.4.p4.1.m1.6.6.2.7.3" xref="S7.4.p4.1.m1.6.6.2.7.3.cmml">σ</mi></msub><mo lspace="0em" rspace="0em" id="S7.4.p4.1.m1.6.6.2.3d" xref="S7.4.p4.1.m1.6.6.2.3.cmml">​</mo><mrow id="S7.4.p4.1.m1.6.6.2.2.1" xref="S7.4.p4.1.m1.6.6.2.2.1.1.cmml"><mo stretchy="false" id="S7.4.p4.1.m1.6.6.2.2.1.2" xref="S7.4.p4.1.m1.6.6.2.2.1.1.cmml">(</mo><mrow id="S7.4.p4.1.m1.6.6.2.2.1.1" xref="S7.4.p4.1.m1.6.6.2.2.1.1.cmml"><mi id="S7.4.p4.1.m1.6.6.2.2.1.1.2" xref="S7.4.p4.1.m1.6.6.2.2.1.1.2.cmml">𝐱</mi><mo fence="false" id="S7.4.p4.1.m1.6.6.2.2.1.1.1" xref="S7.4.p4.1.m1.6.6.2.2.1.1.1.cmml">|</mo><mi id="S7.4.p4.1.m1.6.6.2.2.1.1.3" xref="S7.4.p4.1.m1.6.6.2.2.1.1.3.cmml">𝐳</mi></mrow><mo stretchy="false" id="S7.4.p4.1.m1.6.6.2.2.1.3" xref="S7.4.p4.1.m1.6.6.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.4.p4.1.m1.6b"><apply id="S7.4.p4.1.m1.6.6.cmml" xref="S7.4.p4.1.m1.6.6"><eq id="S7.4.p4.1.m1.6.6.3.cmml" xref="S7.4.p4.1.m1.6.6.3"></eq><apply id="S7.4.p4.1.m1.6.6.4.cmml" xref="S7.4.p4.1.m1.6.6.4"><times id="S7.4.p4.1.m1.6.6.4.1.cmml" xref="S7.4.p4.1.m1.6.6.4.1"></times><ci id="S7.4.p4.1.m1.6.6.4.2.cmml" xref="S7.4.p4.1.m1.6.6.4.2">𝑝</ci><vector id="S7.4.p4.1.m1.6.6.4.3.1.cmml" xref="S7.4.p4.1.m1.6.6.4.3.2"><ci id="S7.4.p4.1.m1.1.1.cmml" xref="S7.4.p4.1.m1.1.1">𝐱</ci><ci id="S7.4.p4.1.m1.2.2.cmml" xref="S7.4.p4.1.m1.2.2">𝐳</ci><ci id="S7.4.p4.1.m1.3.3.cmml" xref="S7.4.p4.1.m1.3.3">Π</ci></vector></apply><apply id="S7.4.p4.1.m1.6.6.2.cmml" xref="S7.4.p4.1.m1.6.6.2"><times id="S7.4.p4.1.m1.6.6.2.3.cmml" xref="S7.4.p4.1.m1.6.6.2.3"></times><ci id="S7.4.p4.1.m1.6.6.2.4.cmml" xref="S7.4.p4.1.m1.6.6.2.4">𝑝</ci><ci id="S7.4.p4.1.m1.4.4.cmml" xref="S7.4.p4.1.m1.4.4">Π</ci><ci id="S7.4.p4.1.m1.6.6.2.6.cmml" xref="S7.4.p4.1.m1.6.6.2.6">𝑝</ci><apply id="S7.4.p4.1.m1.5.5.1.1.1.1.cmml" xref="S7.4.p4.1.m1.5.5.1.1.1"><csymbol cd="latexml" id="S7.4.p4.1.m1.5.5.1.1.1.1.1.cmml" xref="S7.4.p4.1.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S7.4.p4.1.m1.5.5.1.1.1.1.2.cmml" xref="S7.4.p4.1.m1.5.5.1.1.1.1.2">𝐳</ci><ci id="S7.4.p4.1.m1.5.5.1.1.1.1.3.cmml" xref="S7.4.p4.1.m1.5.5.1.1.1.1.3">Π</ci></apply><apply id="S7.4.p4.1.m1.6.6.2.7.cmml" xref="S7.4.p4.1.m1.6.6.2.7"><csymbol cd="ambiguous" id="S7.4.p4.1.m1.6.6.2.7.1.cmml" xref="S7.4.p4.1.m1.6.6.2.7">subscript</csymbol><ci id="S7.4.p4.1.m1.6.6.2.7.2.cmml" xref="S7.4.p4.1.m1.6.6.2.7.2">𝑝</ci><ci id="S7.4.p4.1.m1.6.6.2.7.3.cmml" xref="S7.4.p4.1.m1.6.6.2.7.3">𝜎</ci></apply><apply id="S7.4.p4.1.m1.6.6.2.2.1.1.cmml" xref="S7.4.p4.1.m1.6.6.2.2.1"><csymbol cd="latexml" id="S7.4.p4.1.m1.6.6.2.2.1.1.1.cmml" xref="S7.4.p4.1.m1.6.6.2.2.1.1.1">conditional</csymbol><ci id="S7.4.p4.1.m1.6.6.2.2.1.1.2.cmml" xref="S7.4.p4.1.m1.6.6.2.2.1.1.2">𝐱</ci><ci id="S7.4.p4.1.m1.6.6.2.2.1.1.3.cmml" xref="S7.4.p4.1.m1.6.6.2.2.1.1.3">𝐳</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.4.p4.1.m1.6c">p(\mathbf{x},\mathbf{z},\Pi)=p(\Pi)p(\mathbf{z}|\Pi)p_{\sigma}(\mathbf{x}|\mathbf{z})</annotation></semantics></math>.
We treat <math id="S7.4.p4.2.m2.1" class="ltx_Math" alttext="\Pi" display="inline"><semantics id="S7.4.p4.2.m2.1a"><mi mathvariant="normal" id="S7.4.p4.2.m2.1.1" xref="S7.4.p4.2.m2.1.1.cmml">Π</mi><annotation-xml encoding="MathML-Content" id="S7.4.p4.2.m2.1b"><ci id="S7.4.p4.2.m2.1.1.cmml" xref="S7.4.p4.2.m2.1.1">Π</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.4.p4.2.m2.1c">\Pi</annotation></semantics></math> as a latent
variable. Then, the marginal likelihood for this model is:</p>
</div>
<div id="S7.5.p5" class="ltx_para">
<table id="S7.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.E8.m1.2" class="ltx_Math" alttext="\mathcal{L}=\sum_{n=1}^{N}\log p(\mathbf{z}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})" display="block"><semantics id="S7.E8.m1.2a"><mrow id="S7.E8.m1.2.2" xref="S7.E8.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E8.m1.2.2.4" xref="S7.E8.m1.2.2.4.cmml">ℒ</mi><mo rspace="0.111em" id="S7.E8.m1.2.2.3" xref="S7.E8.m1.2.2.3.cmml">=</mo><mrow id="S7.E8.m1.2.2.2" xref="S7.E8.m1.2.2.2.cmml"><mrow id="S7.E8.m1.1.1.1.1" xref="S7.E8.m1.1.1.1.1.cmml"><munderover id="S7.E8.m1.1.1.1.1.2" xref="S7.E8.m1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S7.E8.m1.1.1.1.1.2.2.2" xref="S7.E8.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S7.E8.m1.1.1.1.1.2.2.3" xref="S7.E8.m1.1.1.1.1.2.2.3.cmml"><mi id="S7.E8.m1.1.1.1.1.2.2.3.2" xref="S7.E8.m1.1.1.1.1.2.2.3.2.cmml">n</mi><mo id="S7.E8.m1.1.1.1.1.2.2.3.1" xref="S7.E8.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S7.E8.m1.1.1.1.1.2.2.3.3" xref="S7.E8.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S7.E8.m1.1.1.1.1.2.3" xref="S7.E8.m1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S7.E8.m1.1.1.1.1.1" xref="S7.E8.m1.1.1.1.1.1.cmml"><mrow id="S7.E8.m1.1.1.1.1.1.3" xref="S7.E8.m1.1.1.1.1.1.3.cmml"><mi id="S7.E8.m1.1.1.1.1.1.3.1" xref="S7.E8.m1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S7.E8.m1.1.1.1.1.1.3a" xref="S7.E8.m1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S7.E8.m1.1.1.1.1.1.3.2" xref="S7.E8.m1.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.E8.m1.1.1.1.1.1.2" xref="S7.E8.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S7.E8.m1.1.1.1.1.1.1.1" xref="S7.E8.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.E8.m1.1.1.1.1.1.1.1.2" xref="S7.E8.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S7.E8.m1.1.1.1.1.1.1.1.1" xref="S7.E8.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.E8.m1.1.1.1.1.1.1.1.1.2" xref="S7.E8.m1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S7.E8.m1.1.1.1.1.1.1.1.1.3" xref="S7.E8.m1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo stretchy="false" id="S7.E8.m1.1.1.1.1.1.1.1.3" xref="S7.E8.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S7.E8.m1.2.2.2.3" xref="S7.E8.m1.2.2.2.3.cmml">+</mo><mrow id="S7.E8.m1.2.2.2.2" xref="S7.E8.m1.2.2.2.2.cmml"><mrow id="S7.E8.m1.2.2.2.2.3" xref="S7.E8.m1.2.2.2.2.3.cmml"><mi id="S7.E8.m1.2.2.2.2.3.1" xref="S7.E8.m1.2.2.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S7.E8.m1.2.2.2.2.3a" xref="S7.E8.m1.2.2.2.2.3.cmml">⁡</mo><msub id="S7.E8.m1.2.2.2.2.3.2" xref="S7.E8.m1.2.2.2.2.3.2.cmml"><mi id="S7.E8.m1.2.2.2.2.3.2.2" xref="S7.E8.m1.2.2.2.2.3.2.2.cmml">p</mi><mi id="S7.E8.m1.2.2.2.2.3.2.3" xref="S7.E8.m1.2.2.2.2.3.2.3.cmml">σ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S7.E8.m1.2.2.2.2.2" xref="S7.E8.m1.2.2.2.2.2.cmml">​</mo><mrow id="S7.E8.m1.2.2.2.2.1.1" xref="S7.E8.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S7.E8.m1.2.2.2.2.1.1.2" xref="S7.E8.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S7.E8.m1.2.2.2.2.1.1.1" xref="S7.E8.m1.2.2.2.2.1.1.1.cmml"><msup id="S7.E8.m1.2.2.2.2.1.1.1.2" xref="S7.E8.m1.2.2.2.2.1.1.1.2.cmml"><mi id="S7.E8.m1.2.2.2.2.1.1.1.2.2" xref="S7.E8.m1.2.2.2.2.1.1.1.2.2.cmml">𝐱</mi><mi id="S7.E8.m1.2.2.2.2.1.1.1.2.3" xref="S7.E8.m1.2.2.2.2.1.1.1.2.3.cmml">n</mi></msup><mo fence="false" id="S7.E8.m1.2.2.2.2.1.1.1.1" xref="S7.E8.m1.2.2.2.2.1.1.1.1.cmml">|</mo><msup id="S7.E8.m1.2.2.2.2.1.1.1.3" xref="S7.E8.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S7.E8.m1.2.2.2.2.1.1.1.3.2" xref="S7.E8.m1.2.2.2.2.1.1.1.3.2.cmml">𝐳</mi><mi id="S7.E8.m1.2.2.2.2.1.1.1.3.3" xref="S7.E8.m1.2.2.2.2.1.1.1.3.3.cmml">n</mi></msup></mrow><mo stretchy="false" id="S7.E8.m1.2.2.2.2.1.1.3" xref="S7.E8.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.E8.m1.2b"><apply id="S7.E8.m1.2.2.cmml" xref="S7.E8.m1.2.2"><eq id="S7.E8.m1.2.2.3.cmml" xref="S7.E8.m1.2.2.3"></eq><ci id="S7.E8.m1.2.2.4.cmml" xref="S7.E8.m1.2.2.4">ℒ</ci><apply id="S7.E8.m1.2.2.2.cmml" xref="S7.E8.m1.2.2.2"><plus id="S7.E8.m1.2.2.2.3.cmml" xref="S7.E8.m1.2.2.2.3"></plus><apply id="S7.E8.m1.1.1.1.1.cmml" xref="S7.E8.m1.1.1.1.1"><apply id="S7.E8.m1.1.1.1.1.2.cmml" xref="S7.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.E8.m1.1.1.1.1.2.1.cmml" xref="S7.E8.m1.1.1.1.1.2">superscript</csymbol><apply id="S7.E8.m1.1.1.1.1.2.2.cmml" xref="S7.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.E8.m1.1.1.1.1.2.2.1.cmml" xref="S7.E8.m1.1.1.1.1.2">subscript</csymbol><sum id="S7.E8.m1.1.1.1.1.2.2.2.cmml" xref="S7.E8.m1.1.1.1.1.2.2.2"></sum><apply id="S7.E8.m1.1.1.1.1.2.2.3.cmml" xref="S7.E8.m1.1.1.1.1.2.2.3"><eq id="S7.E8.m1.1.1.1.1.2.2.3.1.cmml" xref="S7.E8.m1.1.1.1.1.2.2.3.1"></eq><ci id="S7.E8.m1.1.1.1.1.2.2.3.2.cmml" xref="S7.E8.m1.1.1.1.1.2.2.3.2">𝑛</ci><cn type="integer" id="S7.E8.m1.1.1.1.1.2.2.3.3.cmml" xref="S7.E8.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S7.E8.m1.1.1.1.1.2.3.cmml" xref="S7.E8.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S7.E8.m1.1.1.1.1.1.cmml" xref="S7.E8.m1.1.1.1.1.1"><times id="S7.E8.m1.1.1.1.1.1.2.cmml" xref="S7.E8.m1.1.1.1.1.1.2"></times><apply id="S7.E8.m1.1.1.1.1.1.3.cmml" xref="S7.E8.m1.1.1.1.1.1.3"><log id="S7.E8.m1.1.1.1.1.1.3.1.cmml" xref="S7.E8.m1.1.1.1.1.1.3.1"></log><ci id="S7.E8.m1.1.1.1.1.1.3.2.cmml" xref="S7.E8.m1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="S7.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.E8.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E8.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S7.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E8.m1.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S7.E8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.E8.m1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="S7.E8.m1.2.2.2.2.cmml" xref="S7.E8.m1.2.2.2.2"><times id="S7.E8.m1.2.2.2.2.2.cmml" xref="S7.E8.m1.2.2.2.2.2"></times><apply id="S7.E8.m1.2.2.2.2.3.cmml" xref="S7.E8.m1.2.2.2.2.3"><log id="S7.E8.m1.2.2.2.2.3.1.cmml" xref="S7.E8.m1.2.2.2.2.3.1"></log><apply id="S7.E8.m1.2.2.2.2.3.2.cmml" xref="S7.E8.m1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S7.E8.m1.2.2.2.2.3.2.1.cmml" xref="S7.E8.m1.2.2.2.2.3.2">subscript</csymbol><ci id="S7.E8.m1.2.2.2.2.3.2.2.cmml" xref="S7.E8.m1.2.2.2.2.3.2.2">𝑝</ci><ci id="S7.E8.m1.2.2.2.2.3.2.3.cmml" xref="S7.E8.m1.2.2.2.2.3.2.3">𝜎</ci></apply></apply><apply id="S7.E8.m1.2.2.2.2.1.1.1.cmml" xref="S7.E8.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="S7.E8.m1.2.2.2.2.1.1.1.1.cmml" xref="S7.E8.m1.2.2.2.2.1.1.1.1">conditional</csymbol><apply id="S7.E8.m1.2.2.2.2.1.1.1.2.cmml" xref="S7.E8.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S7.E8.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S7.E8.m1.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="S7.E8.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S7.E8.m1.2.2.2.2.1.1.1.2.2">𝐱</ci><ci id="S7.E8.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S7.E8.m1.2.2.2.2.1.1.1.2.3">𝑛</ci></apply><apply id="S7.E8.m1.2.2.2.2.1.1.1.3.cmml" xref="S7.E8.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S7.E8.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S7.E8.m1.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S7.E8.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S7.E8.m1.2.2.2.2.1.1.1.3.2">𝐳</ci><ci id="S7.E8.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S7.E8.m1.2.2.2.2.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E8.m1.2c">\mathcal{L}=\sum_{n=1}^{N}\log p(\mathbf{z}^{n})+\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S7.6.p6" class="ltx_para">
<p id="S7.6.p6.3" class="ltx_p">Notice that this equals the evidence for the original, graphical model
of our interest. Next, we write, for a single data instance:</p>
<table id="S15.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S7.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S7.Ex1.m1.2" class="ltx_Math" alttext="\displaystyle\log p(\mathbf{x},\mathbf{z})" display="inline"><semantics id="S7.Ex1.m1.2a"><mrow id="S7.Ex1.m1.2.3" xref="S7.Ex1.m1.2.3.cmml"><mrow id="S7.Ex1.m1.2.3.2" xref="S7.Ex1.m1.2.3.2.cmml"><mi id="S7.Ex1.m1.2.3.2.1" xref="S7.Ex1.m1.2.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S7.Ex1.m1.2.3.2a" xref="S7.Ex1.m1.2.3.2.cmml">⁡</mo><mi id="S7.Ex1.m1.2.3.2.2" xref="S7.Ex1.m1.2.3.2.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.Ex1.m1.2.3.1" xref="S7.Ex1.m1.2.3.1.cmml">​</mo><mrow id="S7.Ex1.m1.2.3.3.2" xref="S7.Ex1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S7.Ex1.m1.2.3.3.2.1" xref="S7.Ex1.m1.2.3.3.1.cmml">(</mo><mi id="S7.Ex1.m1.1.1" xref="S7.Ex1.m1.1.1.cmml">𝐱</mi><mo id="S7.Ex1.m1.2.3.3.2.2" xref="S7.Ex1.m1.2.3.3.1.cmml">,</mo><mi id="S7.Ex1.m1.2.2" xref="S7.Ex1.m1.2.2.cmml">𝐳</mi><mo stretchy="false" id="S7.Ex1.m1.2.3.3.2.3" xref="S7.Ex1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex1.m1.2b"><apply id="S7.Ex1.m1.2.3.cmml" xref="S7.Ex1.m1.2.3"><times id="S7.Ex1.m1.2.3.1.cmml" xref="S7.Ex1.m1.2.3.1"></times><apply id="S7.Ex1.m1.2.3.2.cmml" xref="S7.Ex1.m1.2.3.2"><log id="S7.Ex1.m1.2.3.2.1.cmml" xref="S7.Ex1.m1.2.3.2.1"></log><ci id="S7.Ex1.m1.2.3.2.2.cmml" xref="S7.Ex1.m1.2.3.2.2">𝑝</ci></apply><interval closure="open" id="S7.Ex1.m1.2.3.3.1.cmml" xref="S7.Ex1.m1.2.3.3.2"><ci id="S7.Ex1.m1.1.1.cmml" xref="S7.Ex1.m1.1.1">𝐱</ci><ci id="S7.Ex1.m1.2.2.cmml" xref="S7.Ex1.m1.2.2">𝐳</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex1.m1.2c">\displaystyle\log p(\mathbf{x},\mathbf{z})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S7.Ex1.m2.3" class="ltx_Math" alttext="\displaystyle=\log\int d\Pi p(\mathbf{x},\mathbf{z},\Pi)" display="inline"><semantics id="S7.Ex1.m2.3a"><mrow id="S7.Ex1.m2.3.4" xref="S7.Ex1.m2.3.4.cmml"><mi id="S7.Ex1.m2.3.4.2" xref="S7.Ex1.m2.3.4.2.cmml"></mi><mo id="S7.Ex1.m2.3.4.1" xref="S7.Ex1.m2.3.4.1.cmml">=</mo><mrow id="S7.Ex1.m2.3.4.3" xref="S7.Ex1.m2.3.4.3.cmml"><mi id="S7.Ex1.m2.3.4.3.2" xref="S7.Ex1.m2.3.4.3.2.cmml">log</mi><mo lspace="0.167em" rspace="0em" id="S7.Ex1.m2.3.4.3.1" xref="S7.Ex1.m2.3.4.3.1.cmml">​</mo><mstyle displaystyle="true" id="S7.Ex1.m2.3.4.3.3" xref="S7.Ex1.m2.3.4.3.3.cmml"><mrow id="S7.Ex1.m2.3.4.3.3a" xref="S7.Ex1.m2.3.4.3.3.cmml"><mo id="S7.Ex1.m2.3.4.3.3.1" xref="S7.Ex1.m2.3.4.3.3.1.cmml">∫</mo><mrow id="S7.Ex1.m2.3.4.3.3.2" xref="S7.Ex1.m2.3.4.3.3.2.cmml"><mrow id="S7.Ex1.m2.3.4.3.3.2.2" xref="S7.Ex1.m2.3.4.3.3.2.2.cmml"><mo lspace="0em" rspace="0em" id="S7.Ex1.m2.3.4.3.3.2.2.1" xref="S7.Ex1.m2.3.4.3.3.2.2.1.cmml">𝑑</mo><mi mathvariant="normal" id="S7.Ex1.m2.3.4.3.3.2.2.2" xref="S7.Ex1.m2.3.4.3.3.2.2.2.cmml">Π</mi></mrow><mo lspace="0em" rspace="0em" id="S7.Ex1.m2.3.4.3.3.2.1" xref="S7.Ex1.m2.3.4.3.3.2.1.cmml">​</mo><mi id="S7.Ex1.m2.3.4.3.3.2.3" xref="S7.Ex1.m2.3.4.3.3.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S7.Ex1.m2.3.4.3.3.2.1a" xref="S7.Ex1.m2.3.4.3.3.2.1.cmml">​</mo><mrow id="S7.Ex1.m2.3.4.3.3.2.4.2" xref="S7.Ex1.m2.3.4.3.3.2.4.1.cmml"><mo stretchy="false" id="S7.Ex1.m2.3.4.3.3.2.4.2.1" xref="S7.Ex1.m2.3.4.3.3.2.4.1.cmml">(</mo><mi id="S7.Ex1.m2.1.1" xref="S7.Ex1.m2.1.1.cmml">𝐱</mi><mo id="S7.Ex1.m2.3.4.3.3.2.4.2.2" xref="S7.Ex1.m2.3.4.3.3.2.4.1.cmml">,</mo><mi id="S7.Ex1.m2.2.2" xref="S7.Ex1.m2.2.2.cmml">𝐳</mi><mo id="S7.Ex1.m2.3.4.3.3.2.4.2.3" xref="S7.Ex1.m2.3.4.3.3.2.4.1.cmml">,</mo><mi mathvariant="normal" id="S7.Ex1.m2.3.3" xref="S7.Ex1.m2.3.3.cmml">Π</mi><mo stretchy="false" id="S7.Ex1.m2.3.4.3.3.2.4.2.4" xref="S7.Ex1.m2.3.4.3.3.2.4.1.cmml">)</mo></mrow></mrow></mrow></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex1.m2.3b"><apply id="S7.Ex1.m2.3.4.cmml" xref="S7.Ex1.m2.3.4"><eq id="S7.Ex1.m2.3.4.1.cmml" xref="S7.Ex1.m2.3.4.1"></eq><csymbol cd="latexml" id="S7.Ex1.m2.3.4.2.cmml" xref="S7.Ex1.m2.3.4.2">absent</csymbol><apply id="S7.Ex1.m2.3.4.3.cmml" xref="S7.Ex1.m2.3.4.3"><times id="S7.Ex1.m2.3.4.3.1.cmml" xref="S7.Ex1.m2.3.4.3.1"></times><log id="S7.Ex1.m2.3.4.3.2.cmml" xref="S7.Ex1.m2.3.4.3.2"></log><apply id="S7.Ex1.m2.3.4.3.3.cmml" xref="S7.Ex1.m2.3.4.3.3"><int id="S7.Ex1.m2.3.4.3.3.1.cmml" xref="S7.Ex1.m2.3.4.3.3.1"></int><apply id="S7.Ex1.m2.3.4.3.3.2.cmml" xref="S7.Ex1.m2.3.4.3.3.2"><times id="S7.Ex1.m2.3.4.3.3.2.1.cmml" xref="S7.Ex1.m2.3.4.3.3.2.1"></times><apply id="S7.Ex1.m2.3.4.3.3.2.2.cmml" xref="S7.Ex1.m2.3.4.3.3.2.2"><csymbol cd="latexml" id="S7.Ex1.m2.3.4.3.3.2.2.1.cmml" xref="S7.Ex1.m2.3.4.3.3.2.2.1">differential-d</csymbol><ci id="S7.Ex1.m2.3.4.3.3.2.2.2.cmml" xref="S7.Ex1.m2.3.4.3.3.2.2.2">Π</ci></apply><ci id="S7.Ex1.m2.3.4.3.3.2.3.cmml" xref="S7.Ex1.m2.3.4.3.3.2.3">𝑝</ci><vector id="S7.Ex1.m2.3.4.3.3.2.4.1.cmml" xref="S7.Ex1.m2.3.4.3.3.2.4.2"><ci id="S7.Ex1.m2.1.1.cmml" xref="S7.Ex1.m2.1.1">𝐱</ci><ci id="S7.Ex1.m2.2.2.cmml" xref="S7.Ex1.m2.2.2">𝐳</ci><ci id="S7.Ex1.m2.3.3.cmml" xref="S7.Ex1.m2.3.3">Π</ci></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex1.m2.3c">\displaystyle=\log\int d\Pi p(\mathbf{x},\mathbf{z},\Pi)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S7.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S7.Ex2.m1.3" class="ltx_Math" alttext="\displaystyle=\log\int d\Pi p(\Pi)p(\mathbf{z}|\Pi)p_{\sigma}(\mathbf{x}|\mathbf{z})" display="inline"><semantics id="S7.Ex2.m1.3a"><mrow id="S7.Ex2.m1.3.3" xref="S7.Ex2.m1.3.3.cmml"><mi id="S7.Ex2.m1.3.3.4" xref="S7.Ex2.m1.3.3.4.cmml"></mi><mo id="S7.Ex2.m1.3.3.3" xref="S7.Ex2.m1.3.3.3.cmml">=</mo><mrow id="S7.Ex2.m1.3.3.2" xref="S7.Ex2.m1.3.3.2.cmml"><mi id="S7.Ex2.m1.3.3.2.4" xref="S7.Ex2.m1.3.3.2.4.cmml">log</mi><mo lspace="0.167em" rspace="0em" id="S7.Ex2.m1.3.3.2.3" xref="S7.Ex2.m1.3.3.2.3.cmml">​</mo><mstyle displaystyle="true" id="S7.Ex2.m1.3.3.2.2" xref="S7.Ex2.m1.3.3.2.2.cmml"><mrow id="S7.Ex2.m1.3.3.2.2a" xref="S7.Ex2.m1.3.3.2.2.cmml"><mo id="S7.Ex2.m1.3.3.2.2.3" xref="S7.Ex2.m1.3.3.2.2.3.cmml">∫</mo><mrow id="S7.Ex2.m1.3.3.2.2.2" xref="S7.Ex2.m1.3.3.2.2.2.cmml"><mrow id="S7.Ex2.m1.3.3.2.2.2.4" xref="S7.Ex2.m1.3.3.2.2.2.4.cmml"><mo lspace="0em" rspace="0em" id="S7.Ex2.m1.3.3.2.2.2.4.1" xref="S7.Ex2.m1.3.3.2.2.2.4.1.cmml">𝑑</mo><mi mathvariant="normal" id="S7.Ex2.m1.3.3.2.2.2.4.2" xref="S7.Ex2.m1.3.3.2.2.2.4.2.cmml">Π</mi></mrow><mo lspace="0em" rspace="0em" id="S7.Ex2.m1.3.3.2.2.2.3" xref="S7.Ex2.m1.3.3.2.2.2.3.cmml">​</mo><mi id="S7.Ex2.m1.3.3.2.2.2.5" xref="S7.Ex2.m1.3.3.2.2.2.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S7.Ex2.m1.3.3.2.2.2.3a" xref="S7.Ex2.m1.3.3.2.2.2.3.cmml">​</mo><mrow id="S7.Ex2.m1.3.3.2.2.2.6.2" xref="S7.Ex2.m1.3.3.2.2.2.cmml"><mo stretchy="false" id="S7.Ex2.m1.3.3.2.2.2.6.2.1" xref="S7.Ex2.m1.3.3.2.2.2.cmml">(</mo><mi mathvariant="normal" id="S7.Ex2.m1.1.1" xref="S7.Ex2.m1.1.1.cmml">Π</mi><mo stretchy="false" id="S7.Ex2.m1.3.3.2.2.2.6.2.2" xref="S7.Ex2.m1.3.3.2.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S7.Ex2.m1.3.3.2.2.2.3b" xref="S7.Ex2.m1.3.3.2.2.2.3.cmml">​</mo><mi id="S7.Ex2.m1.3.3.2.2.2.7" xref="S7.Ex2.m1.3.3.2.2.2.7.cmml">p</mi><mo lspace="0em" rspace="0em" id="S7.Ex2.m1.3.3.2.2.2.3c" xref="S7.Ex2.m1.3.3.2.2.2.3.cmml">​</mo><mrow id="S7.Ex2.m1.2.2.1.1.1.1.1" xref="S7.Ex2.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.Ex2.m1.2.2.1.1.1.1.1.2" xref="S7.Ex2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.Ex2.m1.2.2.1.1.1.1.1.1" xref="S7.Ex2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S7.Ex2.m1.2.2.1.1.1.1.1.1.2" xref="S7.Ex2.m1.2.2.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S7.Ex2.m1.2.2.1.1.1.1.1.1.1" xref="S7.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml">|</mo><mi mathvariant="normal" id="S7.Ex2.m1.2.2.1.1.1.1.1.1.3" xref="S7.Ex2.m1.2.2.1.1.1.1.1.1.3.cmml">Π</mi></mrow><mo stretchy="false" id="S7.Ex2.m1.2.2.1.1.1.1.1.3" xref="S7.Ex2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S7.Ex2.m1.3.3.2.2.2.3d" xref="S7.Ex2.m1.3.3.2.2.2.3.cmml">​</mo><msub id="S7.Ex2.m1.3.3.2.2.2.8" xref="S7.Ex2.m1.3.3.2.2.2.8.cmml"><mi id="S7.Ex2.m1.3.3.2.2.2.8.2" xref="S7.Ex2.m1.3.3.2.2.2.8.2.cmml">p</mi><mi id="S7.Ex2.m1.3.3.2.2.2.8.3" xref="S7.Ex2.m1.3.3.2.2.2.8.3.cmml">σ</mi></msub><mo lspace="0em" rspace="0em" id="S7.Ex2.m1.3.3.2.2.2.3e" xref="S7.Ex2.m1.3.3.2.2.2.3.cmml">​</mo><mrow id="S7.Ex2.m1.3.3.2.2.2.2.1" xref="S7.Ex2.m1.3.3.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S7.Ex2.m1.3.3.2.2.2.2.1.2" xref="S7.Ex2.m1.3.3.2.2.2.2.1.1.cmml">(</mo><mrow id="S7.Ex2.m1.3.3.2.2.2.2.1.1" xref="S7.Ex2.m1.3.3.2.2.2.2.1.1.cmml"><mi id="S7.Ex2.m1.3.3.2.2.2.2.1.1.2" xref="S7.Ex2.m1.3.3.2.2.2.2.1.1.2.cmml">𝐱</mi><mo fence="false" id="S7.Ex2.m1.3.3.2.2.2.2.1.1.1" xref="S7.Ex2.m1.3.3.2.2.2.2.1.1.1.cmml">|</mo><mi id="S7.Ex2.m1.3.3.2.2.2.2.1.1.3" xref="S7.Ex2.m1.3.3.2.2.2.2.1.1.3.cmml">𝐳</mi></mrow><mo stretchy="false" id="S7.Ex2.m1.3.3.2.2.2.2.1.3" xref="S7.Ex2.m1.3.3.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex2.m1.3b"><apply id="S7.Ex2.m1.3.3.cmml" xref="S7.Ex2.m1.3.3"><eq id="S7.Ex2.m1.3.3.3.cmml" xref="S7.Ex2.m1.3.3.3"></eq><csymbol cd="latexml" id="S7.Ex2.m1.3.3.4.cmml" xref="S7.Ex2.m1.3.3.4">absent</csymbol><apply id="S7.Ex2.m1.3.3.2.cmml" xref="S7.Ex2.m1.3.3.2"><times id="S7.Ex2.m1.3.3.2.3.cmml" xref="S7.Ex2.m1.3.3.2.3"></times><log id="S7.Ex2.m1.3.3.2.4.cmml" xref="S7.Ex2.m1.3.3.2.4"></log><apply id="S7.Ex2.m1.3.3.2.2.cmml" xref="S7.Ex2.m1.3.3.2.2"><int id="S7.Ex2.m1.3.3.2.2.3.cmml" xref="S7.Ex2.m1.3.3.2.2.3"></int><apply id="S7.Ex2.m1.3.3.2.2.2.cmml" xref="S7.Ex2.m1.3.3.2.2.2"><times id="S7.Ex2.m1.3.3.2.2.2.3.cmml" xref="S7.Ex2.m1.3.3.2.2.2.3"></times><apply id="S7.Ex2.m1.3.3.2.2.2.4.cmml" xref="S7.Ex2.m1.3.3.2.2.2.4"><csymbol cd="latexml" id="S7.Ex2.m1.3.3.2.2.2.4.1.cmml" xref="S7.Ex2.m1.3.3.2.2.2.4.1">differential-d</csymbol><ci id="S7.Ex2.m1.3.3.2.2.2.4.2.cmml" xref="S7.Ex2.m1.3.3.2.2.2.4.2">Π</ci></apply><ci id="S7.Ex2.m1.3.3.2.2.2.5.cmml" xref="S7.Ex2.m1.3.3.2.2.2.5">𝑝</ci><ci id="S7.Ex2.m1.1.1.cmml" xref="S7.Ex2.m1.1.1">Π</ci><ci id="S7.Ex2.m1.3.3.2.2.2.7.cmml" xref="S7.Ex2.m1.3.3.2.2.2.7">𝑝</ci><apply id="S7.Ex2.m1.2.2.1.1.1.1.1.1.cmml" xref="S7.Ex2.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S7.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S7.Ex2.m1.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S7.Ex2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S7.Ex2.m1.2.2.1.1.1.1.1.1.2">𝐳</ci><ci id="S7.Ex2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S7.Ex2.m1.2.2.1.1.1.1.1.1.3">Π</ci></apply><apply id="S7.Ex2.m1.3.3.2.2.2.8.cmml" xref="S7.Ex2.m1.3.3.2.2.2.8"><csymbol cd="ambiguous" id="S7.Ex2.m1.3.3.2.2.2.8.1.cmml" xref="S7.Ex2.m1.3.3.2.2.2.8">subscript</csymbol><ci id="S7.Ex2.m1.3.3.2.2.2.8.2.cmml" xref="S7.Ex2.m1.3.3.2.2.2.8.2">𝑝</ci><ci id="S7.Ex2.m1.3.3.2.2.2.8.3.cmml" xref="S7.Ex2.m1.3.3.2.2.2.8.3">𝜎</ci></apply><apply id="S7.Ex2.m1.3.3.2.2.2.2.1.1.cmml" xref="S7.Ex2.m1.3.3.2.2.2.2.1"><csymbol cd="latexml" id="S7.Ex2.m1.3.3.2.2.2.2.1.1.1.cmml" xref="S7.Ex2.m1.3.3.2.2.2.2.1.1.1">conditional</csymbol><ci id="S7.Ex2.m1.3.3.2.2.2.2.1.1.2.cmml" xref="S7.Ex2.m1.3.3.2.2.2.2.1.1.2">𝐱</ci><ci id="S7.Ex2.m1.3.3.2.2.2.2.1.1.3.cmml" xref="S7.Ex2.m1.3.3.2.2.2.2.1.1.3">𝐳</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex2.m1.3c">\displaystyle=\log\int d\Pi p(\Pi)p(\mathbf{z}|\Pi)p_{\sigma}(\mathbf{x}|\mathbf{z})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S7.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S7.Ex3.m1.9" class="ltx_Math" alttext="\displaystyle=\log\int d\Pi\frac{p(\Pi)}{q(\Pi|\mathbf{z},\mathbf{x})}p(\mathbf{z}|\Pi)p_{\sigma}(\mathbf{x}|\mathbf{z})q(\Pi|\mathbf{z},\mathbf{x})" display="inline"><semantics id="S7.Ex3.m1.9a"><mrow id="S7.Ex3.m1.9.9" xref="S7.Ex3.m1.9.9.cmml"><mi id="S7.Ex3.m1.9.9.5" xref="S7.Ex3.m1.9.9.5.cmml"></mi><mo id="S7.Ex3.m1.9.9.4" xref="S7.Ex3.m1.9.9.4.cmml">=</mo><mrow id="S7.Ex3.m1.9.9.3" xref="S7.Ex3.m1.9.9.3.cmml"><mi id="S7.Ex3.m1.9.9.3.5" xref="S7.Ex3.m1.9.9.3.5.cmml">log</mi><mo lspace="0.167em" rspace="0em" id="S7.Ex3.m1.9.9.3.4" xref="S7.Ex3.m1.9.9.3.4.cmml">​</mo><mstyle displaystyle="true" id="S7.Ex3.m1.9.9.3.3" xref="S7.Ex3.m1.9.9.3.3.cmml"><mrow id="S7.Ex3.m1.9.9.3.3a" xref="S7.Ex3.m1.9.9.3.3.cmml"><mo id="S7.Ex3.m1.9.9.3.3.4" xref="S7.Ex3.m1.9.9.3.3.4.cmml">∫</mo><mrow id="S7.Ex3.m1.9.9.3.3.3" xref="S7.Ex3.m1.9.9.3.3.3.cmml"><mrow id="S7.Ex3.m1.9.9.3.3.3.5" xref="S7.Ex3.m1.9.9.3.3.3.5.cmml"><mo lspace="0em" rspace="0em" id="S7.Ex3.m1.9.9.3.3.3.5.1" xref="S7.Ex3.m1.9.9.3.3.3.5.1.cmml">𝑑</mo><mi mathvariant="normal" id="S7.Ex3.m1.9.9.3.3.3.5.2" xref="S7.Ex3.m1.9.9.3.3.3.5.2.cmml">Π</mi></mrow><mo lspace="0em" rspace="0em" id="S7.Ex3.m1.9.9.3.3.3.4" xref="S7.Ex3.m1.9.9.3.3.3.4.cmml">​</mo><mfrac id="S7.Ex3.m1.4.4" xref="S7.Ex3.m1.4.4.cmml"><mrow id="S7.Ex3.m1.1.1.1" xref="S7.Ex3.m1.1.1.1.cmml"><mi id="S7.Ex3.m1.1.1.1.3" xref="S7.Ex3.m1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S7.Ex3.m1.1.1.1.2" xref="S7.Ex3.m1.1.1.1.2.cmml">​</mo><mrow id="S7.Ex3.m1.1.1.1.4.2" xref="S7.Ex3.m1.1.1.1.cmml"><mo stretchy="false" id="S7.Ex3.m1.1.1.1.4.2.1" xref="S7.Ex3.m1.1.1.1.cmml">(</mo><mi mathvariant="normal" id="S7.Ex3.m1.1.1.1.1" xref="S7.Ex3.m1.1.1.1.1.cmml">Π</mi><mo stretchy="false" id="S7.Ex3.m1.1.1.1.4.2.2" xref="S7.Ex3.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S7.Ex3.m1.4.4.4" xref="S7.Ex3.m1.4.4.4.cmml"><mi id="S7.Ex3.m1.4.4.4.5" xref="S7.Ex3.m1.4.4.4.5.cmml">q</mi><mo lspace="0em" rspace="0em" id="S7.Ex3.m1.4.4.4.4" xref="S7.Ex3.m1.4.4.4.4.cmml">​</mo><mrow id="S7.Ex3.m1.4.4.4.3.1" xref="S7.Ex3.m1.4.4.4.3.1.1.cmml"><mo stretchy="false" id="S7.Ex3.m1.4.4.4.3.1.2" xref="S7.Ex3.m1.4.4.4.3.1.1.cmml">(</mo><mrow id="S7.Ex3.m1.4.4.4.3.1.1" xref="S7.Ex3.m1.4.4.4.3.1.1.cmml"><mi mathvariant="normal" id="S7.Ex3.m1.4.4.4.3.1.1.2" xref="S7.Ex3.m1.4.4.4.3.1.1.2.cmml">Π</mi><mo fence="false" id="S7.Ex3.m1.4.4.4.3.1.1.1" xref="S7.Ex3.m1.4.4.4.3.1.1.1.cmml">|</mo><mrow id="S7.Ex3.m1.4.4.4.3.1.1.3.2" xref="S7.Ex3.m1.4.4.4.3.1.1.3.1.cmml"><mi id="S7.Ex3.m1.2.2.2.1" xref="S7.Ex3.m1.2.2.2.1.cmml">𝐳</mi><mo id="S7.Ex3.m1.4.4.4.3.1.1.3.2.1" xref="S7.Ex3.m1.4.4.4.3.1.1.3.1.cmml">,</mo><mi id="S7.Ex3.m1.3.3.3.2" xref="S7.Ex3.m1.3.3.3.2.cmml">𝐱</mi></mrow></mrow><mo stretchy="false" id="S7.Ex3.m1.4.4.4.3.1.3" xref="S7.Ex3.m1.4.4.4.3.1.1.cmml">)</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em" id="S7.Ex3.m1.9.9.3.3.3.4a" xref="S7.Ex3.m1.9.9.3.3.3.4.cmml">​</mo><mi id="S7.Ex3.m1.9.9.3.3.3.6" xref="S7.Ex3.m1.9.9.3.3.3.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="S7.Ex3.m1.9.9.3.3.3.4b" xref="S7.Ex3.m1.9.9.3.3.3.4.cmml">​</mo><mrow id="S7.Ex3.m1.7.7.1.1.1.1.1" xref="S7.Ex3.m1.7.7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.Ex3.m1.7.7.1.1.1.1.1.2" xref="S7.Ex3.m1.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.Ex3.m1.7.7.1.1.1.1.1.1" xref="S7.Ex3.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S7.Ex3.m1.7.7.1.1.1.1.1.1.2" xref="S7.Ex3.m1.7.7.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S7.Ex3.m1.7.7.1.1.1.1.1.1.1" xref="S7.Ex3.m1.7.7.1.1.1.1.1.1.1.cmml">|</mo><mi mathvariant="normal" id="S7.Ex3.m1.7.7.1.1.1.1.1.1.3" xref="S7.Ex3.m1.7.7.1.1.1.1.1.1.3.cmml">Π</mi></mrow><mo stretchy="false" id="S7.Ex3.m1.7.7.1.1.1.1.1.3" xref="S7.Ex3.m1.7.7.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S7.Ex3.m1.9.9.3.3.3.4c" xref="S7.Ex3.m1.9.9.3.3.3.4.cmml">​</mo><msub id="S7.Ex3.m1.9.9.3.3.3.7" xref="S7.Ex3.m1.9.9.3.3.3.7.cmml"><mi id="S7.Ex3.m1.9.9.3.3.3.7.2" xref="S7.Ex3.m1.9.9.3.3.3.7.2.cmml">p</mi><mi id="S7.Ex3.m1.9.9.3.3.3.7.3" xref="S7.Ex3.m1.9.9.3.3.3.7.3.cmml">σ</mi></msub><mo lspace="0em" rspace="0em" id="S7.Ex3.m1.9.9.3.3.3.4d" xref="S7.Ex3.m1.9.9.3.3.3.4.cmml">​</mo><mrow id="S7.Ex3.m1.8.8.2.2.2.2.1" xref="S7.Ex3.m1.8.8.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S7.Ex3.m1.8.8.2.2.2.2.1.2" xref="S7.Ex3.m1.8.8.2.2.2.2.1.1.cmml">(</mo><mrow id="S7.Ex3.m1.8.8.2.2.2.2.1.1" xref="S7.Ex3.m1.8.8.2.2.2.2.1.1.cmml"><mi id="S7.Ex3.m1.8.8.2.2.2.2.1.1.2" xref="S7.Ex3.m1.8.8.2.2.2.2.1.1.2.cmml">𝐱</mi><mo fence="false" id="S7.Ex3.m1.8.8.2.2.2.2.1.1.1" xref="S7.Ex3.m1.8.8.2.2.2.2.1.1.1.cmml">|</mo><mi id="S7.Ex3.m1.8.8.2.2.2.2.1.1.3" xref="S7.Ex3.m1.8.8.2.2.2.2.1.1.3.cmml">𝐳</mi></mrow><mo stretchy="false" id="S7.Ex3.m1.8.8.2.2.2.2.1.3" xref="S7.Ex3.m1.8.8.2.2.2.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S7.Ex3.m1.9.9.3.3.3.4e" xref="S7.Ex3.m1.9.9.3.3.3.4.cmml">​</mo><mi id="S7.Ex3.m1.9.9.3.3.3.8" xref="S7.Ex3.m1.9.9.3.3.3.8.cmml">q</mi><mo lspace="0em" rspace="0em" id="S7.Ex3.m1.9.9.3.3.3.4f" xref="S7.Ex3.m1.9.9.3.3.3.4.cmml">​</mo><mrow id="S7.Ex3.m1.9.9.3.3.3.3.1" xref="S7.Ex3.m1.9.9.3.3.3.3.1.1.cmml"><mo stretchy="false" id="S7.Ex3.m1.9.9.3.3.3.3.1.2" xref="S7.Ex3.m1.9.9.3.3.3.3.1.1.cmml">(</mo><mrow id="S7.Ex3.m1.9.9.3.3.3.3.1.1" xref="S7.Ex3.m1.9.9.3.3.3.3.1.1.cmml"><mi mathvariant="normal" id="S7.Ex3.m1.9.9.3.3.3.3.1.1.2" xref="S7.Ex3.m1.9.9.3.3.3.3.1.1.2.cmml">Π</mi><mo fence="false" id="S7.Ex3.m1.9.9.3.3.3.3.1.1.1" xref="S7.Ex3.m1.9.9.3.3.3.3.1.1.1.cmml">|</mo><mrow id="S7.Ex3.m1.9.9.3.3.3.3.1.1.3.2" xref="S7.Ex3.m1.9.9.3.3.3.3.1.1.3.1.cmml"><mi id="S7.Ex3.m1.5.5" xref="S7.Ex3.m1.5.5.cmml">𝐳</mi><mo id="S7.Ex3.m1.9.9.3.3.3.3.1.1.3.2.1" xref="S7.Ex3.m1.9.9.3.3.3.3.1.1.3.1.cmml">,</mo><mi id="S7.Ex3.m1.6.6" xref="S7.Ex3.m1.6.6.cmml">𝐱</mi></mrow></mrow><mo stretchy="false" id="S7.Ex3.m1.9.9.3.3.3.3.1.3" xref="S7.Ex3.m1.9.9.3.3.3.3.1.1.cmml">)</mo></mrow></mrow></mrow></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex3.m1.9b"><apply id="S7.Ex3.m1.9.9.cmml" xref="S7.Ex3.m1.9.9"><eq id="S7.Ex3.m1.9.9.4.cmml" xref="S7.Ex3.m1.9.9.4"></eq><csymbol cd="latexml" id="S7.Ex3.m1.9.9.5.cmml" xref="S7.Ex3.m1.9.9.5">absent</csymbol><apply id="S7.Ex3.m1.9.9.3.cmml" xref="S7.Ex3.m1.9.9.3"><times id="S7.Ex3.m1.9.9.3.4.cmml" xref="S7.Ex3.m1.9.9.3.4"></times><log id="S7.Ex3.m1.9.9.3.5.cmml" xref="S7.Ex3.m1.9.9.3.5"></log><apply id="S7.Ex3.m1.9.9.3.3.cmml" xref="S7.Ex3.m1.9.9.3.3"><int id="S7.Ex3.m1.9.9.3.3.4.cmml" xref="S7.Ex3.m1.9.9.3.3.4"></int><apply id="S7.Ex3.m1.9.9.3.3.3.cmml" xref="S7.Ex3.m1.9.9.3.3.3"><times id="S7.Ex3.m1.9.9.3.3.3.4.cmml" xref="S7.Ex3.m1.9.9.3.3.3.4"></times><apply id="S7.Ex3.m1.9.9.3.3.3.5.cmml" xref="S7.Ex3.m1.9.9.3.3.3.5"><csymbol cd="latexml" id="S7.Ex3.m1.9.9.3.3.3.5.1.cmml" xref="S7.Ex3.m1.9.9.3.3.3.5.1">differential-d</csymbol><ci id="S7.Ex3.m1.9.9.3.3.3.5.2.cmml" xref="S7.Ex3.m1.9.9.3.3.3.5.2">Π</ci></apply><apply id="S7.Ex3.m1.4.4.cmml" xref="S7.Ex3.m1.4.4"><divide id="S7.Ex3.m1.4.4.5.cmml" xref="S7.Ex3.m1.4.4"></divide><apply id="S7.Ex3.m1.1.1.1.cmml" xref="S7.Ex3.m1.1.1.1"><times id="S7.Ex3.m1.1.1.1.2.cmml" xref="S7.Ex3.m1.1.1.1.2"></times><ci id="S7.Ex3.m1.1.1.1.3.cmml" xref="S7.Ex3.m1.1.1.1.3">𝑝</ci><ci id="S7.Ex3.m1.1.1.1.1.cmml" xref="S7.Ex3.m1.1.1.1.1">Π</ci></apply><apply id="S7.Ex3.m1.4.4.4.cmml" xref="S7.Ex3.m1.4.4.4"><times id="S7.Ex3.m1.4.4.4.4.cmml" xref="S7.Ex3.m1.4.4.4.4"></times><ci id="S7.Ex3.m1.4.4.4.5.cmml" xref="S7.Ex3.m1.4.4.4.5">𝑞</ci><apply id="S7.Ex3.m1.4.4.4.3.1.1.cmml" xref="S7.Ex3.m1.4.4.4.3.1"><csymbol cd="latexml" id="S7.Ex3.m1.4.4.4.3.1.1.1.cmml" xref="S7.Ex3.m1.4.4.4.3.1.1.1">conditional</csymbol><ci id="S7.Ex3.m1.4.4.4.3.1.1.2.cmml" xref="S7.Ex3.m1.4.4.4.3.1.1.2">Π</ci><list id="S7.Ex3.m1.4.4.4.3.1.1.3.1.cmml" xref="S7.Ex3.m1.4.4.4.3.1.1.3.2"><ci id="S7.Ex3.m1.2.2.2.1.cmml" xref="S7.Ex3.m1.2.2.2.1">𝐳</ci><ci id="S7.Ex3.m1.3.3.3.2.cmml" xref="S7.Ex3.m1.3.3.3.2">𝐱</ci></list></apply></apply></apply><ci id="S7.Ex3.m1.9.9.3.3.3.6.cmml" xref="S7.Ex3.m1.9.9.3.3.3.6">𝑝</ci><apply id="S7.Ex3.m1.7.7.1.1.1.1.1.1.cmml" xref="S7.Ex3.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S7.Ex3.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S7.Ex3.m1.7.7.1.1.1.1.1.1.1">conditional</csymbol><ci id="S7.Ex3.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S7.Ex3.m1.7.7.1.1.1.1.1.1.2">𝐳</ci><ci id="S7.Ex3.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S7.Ex3.m1.7.7.1.1.1.1.1.1.3">Π</ci></apply><apply id="S7.Ex3.m1.9.9.3.3.3.7.cmml" xref="S7.Ex3.m1.9.9.3.3.3.7"><csymbol cd="ambiguous" id="S7.Ex3.m1.9.9.3.3.3.7.1.cmml" xref="S7.Ex3.m1.9.9.3.3.3.7">subscript</csymbol><ci id="S7.Ex3.m1.9.9.3.3.3.7.2.cmml" xref="S7.Ex3.m1.9.9.3.3.3.7.2">𝑝</ci><ci id="S7.Ex3.m1.9.9.3.3.3.7.3.cmml" xref="S7.Ex3.m1.9.9.3.3.3.7.3">𝜎</ci></apply><apply id="S7.Ex3.m1.8.8.2.2.2.2.1.1.cmml" xref="S7.Ex3.m1.8.8.2.2.2.2.1"><csymbol cd="latexml" id="S7.Ex3.m1.8.8.2.2.2.2.1.1.1.cmml" xref="S7.Ex3.m1.8.8.2.2.2.2.1.1.1">conditional</csymbol><ci id="S7.Ex3.m1.8.8.2.2.2.2.1.1.2.cmml" xref="S7.Ex3.m1.8.8.2.2.2.2.1.1.2">𝐱</ci><ci id="S7.Ex3.m1.8.8.2.2.2.2.1.1.3.cmml" xref="S7.Ex3.m1.8.8.2.2.2.2.1.1.3">𝐳</ci></apply><ci id="S7.Ex3.m1.9.9.3.3.3.8.cmml" xref="S7.Ex3.m1.9.9.3.3.3.8">𝑞</ci><apply id="S7.Ex3.m1.9.9.3.3.3.3.1.1.cmml" xref="S7.Ex3.m1.9.9.3.3.3.3.1"><csymbol cd="latexml" id="S7.Ex3.m1.9.9.3.3.3.3.1.1.1.cmml" xref="S7.Ex3.m1.9.9.3.3.3.3.1.1.1">conditional</csymbol><ci id="S7.Ex3.m1.9.9.3.3.3.3.1.1.2.cmml" xref="S7.Ex3.m1.9.9.3.3.3.3.1.1.2">Π</ci><list id="S7.Ex3.m1.9.9.3.3.3.3.1.1.3.1.cmml" xref="S7.Ex3.m1.9.9.3.3.3.3.1.1.3.2"><ci id="S7.Ex3.m1.5.5.cmml" xref="S7.Ex3.m1.5.5">𝐳</ci><ci id="S7.Ex3.m1.6.6.cmml" xref="S7.Ex3.m1.6.6">𝐱</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex3.m1.9c">\displaystyle=\log\int d\Pi\frac{p(\Pi)}{q(\Pi|\mathbf{z},\mathbf{x})}p(\mathbf{z}|\Pi)p_{\sigma}(\mathbf{x}|\mathbf{z})q(\Pi|\mathbf{z},\mathbf{x})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S7.6.p6.2" class="ltx_p">where we multiply and divided by a variational approximation <math id="S7.6.p6.1.m1.3" class="ltx_Math" alttext="q(\Pi|\mathbf{z},\mathbf{x})" display="inline"><semantics id="S7.6.p6.1.m1.3a"><mrow id="S7.6.p6.1.m1.3.3" xref="S7.6.p6.1.m1.3.3.cmml"><mi id="S7.6.p6.1.m1.3.3.3" xref="S7.6.p6.1.m1.3.3.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S7.6.p6.1.m1.3.3.2" xref="S7.6.p6.1.m1.3.3.2.cmml">​</mo><mrow id="S7.6.p6.1.m1.3.3.1.1" xref="S7.6.p6.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S7.6.p6.1.m1.3.3.1.1.2" xref="S7.6.p6.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S7.6.p6.1.m1.3.3.1.1.1" xref="S7.6.p6.1.m1.3.3.1.1.1.cmml"><mi mathvariant="normal" id="S7.6.p6.1.m1.3.3.1.1.1.2" xref="S7.6.p6.1.m1.3.3.1.1.1.2.cmml">Π</mi><mo fence="false" id="S7.6.p6.1.m1.3.3.1.1.1.1" xref="S7.6.p6.1.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S7.6.p6.1.m1.3.3.1.1.1.3.2" xref="S7.6.p6.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S7.6.p6.1.m1.1.1" xref="S7.6.p6.1.m1.1.1.cmml">𝐳</mi><mo id="S7.6.p6.1.m1.3.3.1.1.1.3.2.1" xref="S7.6.p6.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S7.6.p6.1.m1.2.2" xref="S7.6.p6.1.m1.2.2.cmml">𝐱</mi></mrow></mrow><mo stretchy="false" id="S7.6.p6.1.m1.3.3.1.1.3" xref="S7.6.p6.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.6.p6.1.m1.3b"><apply id="S7.6.p6.1.m1.3.3.cmml" xref="S7.6.p6.1.m1.3.3"><times id="S7.6.p6.1.m1.3.3.2.cmml" xref="S7.6.p6.1.m1.3.3.2"></times><ci id="S7.6.p6.1.m1.3.3.3.cmml" xref="S7.6.p6.1.m1.3.3.3">𝑞</ci><apply id="S7.6.p6.1.m1.3.3.1.1.1.cmml" xref="S7.6.p6.1.m1.3.3.1.1"><csymbol cd="latexml" id="S7.6.p6.1.m1.3.3.1.1.1.1.cmml" xref="S7.6.p6.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S7.6.p6.1.m1.3.3.1.1.1.2.cmml" xref="S7.6.p6.1.m1.3.3.1.1.1.2">Π</ci><list id="S7.6.p6.1.m1.3.3.1.1.1.3.1.cmml" xref="S7.6.p6.1.m1.3.3.1.1.1.3.2"><ci id="S7.6.p6.1.m1.1.1.cmml" xref="S7.6.p6.1.m1.1.1">𝐳</ci><ci id="S7.6.p6.1.m1.2.2.cmml" xref="S7.6.p6.1.m1.2.2">𝐱</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.6.p6.1.m1.3c">q(\Pi|\mathbf{z},\mathbf{x})</annotation></semantics></math> and apply
Jensen’s inequality (due to concavity of <math id="S7.6.p6.2.m2.1" class="ltx_Math" alttext="\log" display="inline"><semantics id="S7.6.p6.2.m2.1a"><mi id="S7.6.p6.2.m2.1.1" xref="S7.6.p6.2.m2.1.1.cmml">log</mi><annotation-xml encoding="MathML-Content" id="S7.6.p6.2.m2.1b"><log id="S7.6.p6.2.m2.1.1.cmml" xref="S7.6.p6.2.m2.1.1"></log></annotation-xml><annotation encoding="application/x-tex" id="S7.6.p6.2.m2.1c">\log</annotation></semantics></math>) to get the following variational lower bound:</p>
</div>
<div id="S7.7.p7" class="ltx_para">
<table id="S7.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.E9.m1.58" class="ltx_math_unparsed" alttext="\log p(\mathbf{x},\mathbf{z})\geq\int d\Pi q(\Pi|\mathbf{z},\mathbf{x})\left[\log p(\mathbf{z}|\Pi)+\log p_{\sigma}(\mathbf{x}|\mathbf{z})\right]\\
-\mathbb{KL}\left({q(\Pi|\mathbf{z},\mathbf{x})}||{p(\Pi)}\right)" display="block"><semantics id="S7.E9.m1.58a"><mtable displaystyle="true" rowspacing="0pt" id="S7.E9.m1.58.58.2"><mtr id="S7.E9.m1.58.58.2a"><mtd class="ltx_align_left" columnalign="left" id="S7.E9.m1.58.58.2b"><mrow id="S7.E9.m1.58.58.2.58.39.39"><mrow id="S7.E9.m1.58.58.2.58.39.39.40"><mrow id="S7.E9.m1.58.58.2.58.39.39.40.2"><mi id="S7.E9.m1.1.1.1.1.1.1">log</mi><mo lspace="0.167em" id="S7.E9.m1.58.58.2.58.39.39.40.2a">⁡</mo><mi id="S7.E9.m1.2.2.2.2.2.2">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.E9.m1.58.58.2.58.39.39.40.1">​</mo><mrow id="S7.E9.m1.58.58.2.58.39.39.40.3"><mo stretchy="false" id="S7.E9.m1.3.3.3.3.3.3">(</mo><mi id="S7.E9.m1.4.4.4.4.4.4">𝐱</mi><mo id="S7.E9.m1.5.5.5.5.5.5">,</mo><mi id="S7.E9.m1.6.6.6.6.6.6">𝐳</mi><mo stretchy="false" id="S7.E9.m1.7.7.7.7.7.7">)</mo></mrow></mrow><mo rspace="0.111em" id="S7.E9.m1.8.8.8.8.8.8">≥</mo><mrow id="S7.E9.m1.58.58.2.58.39.39.39"><mo id="S7.E9.m1.9.9.9.9.9.9">∫</mo><mrow id="S7.E9.m1.58.58.2.58.39.39.39.2"><mrow id="S7.E9.m1.58.58.2.58.39.39.39.2.4"><mo lspace="0em" rspace="0em" id="S7.E9.m1.10.10.10.10.10.10">𝑑</mo><mi mathvariant="normal" id="S7.E9.m1.11.11.11.11.11.11">Π</mi></mrow><mo lspace="0em" rspace="0em" id="S7.E9.m1.58.58.2.58.39.39.39.2.3">​</mo><mi id="S7.E9.m1.12.12.12.12.12.12">q</mi><mo lspace="0em" rspace="0em" id="S7.E9.m1.58.58.2.58.39.39.39.2.3a">​</mo><mrow id="S7.E9.m1.57.57.1.57.38.38.38.1.1.1"><mo stretchy="false" id="S7.E9.m1.13.13.13.13.13.13">(</mo><mrow id="S7.E9.m1.57.57.1.57.38.38.38.1.1.1.1"><mi mathvariant="normal" id="S7.E9.m1.14.14.14.14.14.14">Π</mi><mo fence="false" id="S7.E9.m1.15.15.15.15.15.15">|</mo><mrow id="S7.E9.m1.57.57.1.57.38.38.38.1.1.1.1.1"><mi id="S7.E9.m1.16.16.16.16.16.16">𝐳</mi><mo id="S7.E9.m1.17.17.17.17.17.17">,</mo><mi id="S7.E9.m1.18.18.18.18.18.18">𝐱</mi></mrow></mrow><mo stretchy="false" id="S7.E9.m1.19.19.19.19.19.19">)</mo></mrow><mo lspace="0em" rspace="0em" id="S7.E9.m1.58.58.2.58.39.39.39.2.3b">​</mo><mrow id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1"><mo id="S7.E9.m1.20.20.20.20.20.20">[</mo><mrow id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1"><mrow id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.1"><mrow id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.1.3"><mi id="S7.E9.m1.21.21.21.21.21.21">log</mi><mo lspace="0.167em" id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.1.3a">⁡</mo><mi id="S7.E9.m1.22.22.22.22.22.22">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.1.2">​</mo><mrow id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.1.1.1"><mo stretchy="false" id="S7.E9.m1.23.23.23.23.23.23">(</mo><mrow id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.1.1.1.1"><mi id="S7.E9.m1.24.24.24.24.24.24">𝐳</mi><mo fence="false" id="S7.E9.m1.25.25.25.25.25.25">|</mo><mi mathvariant="normal" id="S7.E9.m1.26.26.26.26.26.26">Π</mi></mrow><mo stretchy="false" id="S7.E9.m1.27.27.27.27.27.27">)</mo></mrow></mrow><mo id="S7.E9.m1.28.28.28.28.28.28">+</mo><mrow id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.2"><mrow id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.2.3"><mi id="S7.E9.m1.29.29.29.29.29.29">log</mi><mo lspace="0.167em" id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.2.3a">⁡</mo><msub id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.2.3.1"><mi id="S7.E9.m1.30.30.30.30.30.30">p</mi><mi id="S7.E9.m1.31.31.31.31.31.31.1">σ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.2.2">​</mo><mrow id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.2.1.1"><mo stretchy="false" id="S7.E9.m1.32.32.32.32.32.32">(</mo><mrow id="S7.E9.m1.58.58.2.58.39.39.39.2.2.1.1.2.1.1.1"><mi id="S7.E9.m1.33.33.33.33.33.33">𝐱</mi><mo fence="false" id="S7.E9.m1.34.34.34.34.34.34">|</mo><mi id="S7.E9.m1.35.35.35.35.35.35">𝐳</mi></mrow><mo stretchy="false" id="S7.E9.m1.36.36.36.36.36.36">)</mo></mrow></mrow></mrow><mo id="S7.E9.m1.37.37.37.37.37.37">]</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S7.E9.m1.58.58.2c"><mtd class="ltx_align_right" columnalign="right" id="S7.E9.m1.58.58.2d"><mrow id="S7.E9.m1.56.56.56.19.19"><mo id="S7.E9.m1.38.38.38.1.1.1">−</mo><mi id="S7.E9.m1.39.39.39.2.2.2">𝕂</mi><mi id="S7.E9.m1.40.40.40.3.3.3">𝕃</mi><mrow id="S7.E9.m1.56.56.56.19.19.20"><mo id="S7.E9.m1.41.41.41.4.4.4">(</mo><mi id="S7.E9.m1.42.42.42.5.5.5">q</mi><mrow id="S7.E9.m1.56.56.56.19.19.20.1"><mo stretchy="false" id="S7.E9.m1.43.43.43.6.6.6">(</mo><mi mathvariant="normal" id="S7.E9.m1.44.44.44.7.7.7">Π</mi><mo fence="false" rspace="0.167em" stretchy="false" id="S7.E9.m1.45.45.45.8.8.8">|</mo><mi id="S7.E9.m1.46.46.46.9.9.9">𝐳</mi><mo id="S7.E9.m1.47.47.47.10.10.10">,</mo><mi id="S7.E9.m1.48.48.48.11.11.11">𝐱</mi><mo stretchy="false" id="S7.E9.m1.49.49.49.12.12.12">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="S7.E9.m1.50.50.50.13.13.13">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S7.E9.m1.51.51.51.14.14.14">|</mo><mi id="S7.E9.m1.52.52.52.15.15.15">p</mi><mrow id="S7.E9.m1.56.56.56.19.19.20.2"><mo stretchy="false" id="S7.E9.m1.53.53.53.16.16.16">(</mo><mi mathvariant="normal" id="S7.E9.m1.54.54.54.17.17.17">Π</mi><mo stretchy="false" id="S7.E9.m1.55.55.55.18.18.18">)</mo></mrow><mo id="S7.E9.m1.56.56.56.19.19.19">)</mo></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S7.E9.m1.58b">\log p(\mathbf{x},\mathbf{z})\geq\int d\Pi q(\Pi|\mathbf{z},\mathbf{x})\left[\log p(\mathbf{z}|\Pi)+\log p_{\sigma}(\mathbf{x}|\mathbf{z})\right]\\
-\mathbb{KL}\left({q(\Pi|\mathbf{z},\mathbf{x})}||{p(\Pi)}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="S7.8.p8" class="ltx_para">
<p id="S7.8.p8.5" class="ltx_p">Next, we explain how to parametrize the prior, which is the key assumption
for deriving the result. Let <math id="S7.8.p8.1.m1.2" class="ltx_Math" alttext="\hat{\pi}_{t}=f(\mathbf{x},\{\mathbf{z}_{i}\}_{i=1}^{t-1})" display="inline"><semantics id="S7.8.p8.1.m1.2a"><mrow id="S7.8.p8.1.m1.2.2" xref="S7.8.p8.1.m1.2.2.cmml"><msub id="S7.8.p8.1.m1.2.2.3" xref="S7.8.p8.1.m1.2.2.3.cmml"><mover accent="true" id="S7.8.p8.1.m1.2.2.3.2" xref="S7.8.p8.1.m1.2.2.3.2.cmml"><mi id="S7.8.p8.1.m1.2.2.3.2.2" xref="S7.8.p8.1.m1.2.2.3.2.2.cmml">π</mi><mo id="S7.8.p8.1.m1.2.2.3.2.1" xref="S7.8.p8.1.m1.2.2.3.2.1.cmml">^</mo></mover><mi id="S7.8.p8.1.m1.2.2.3.3" xref="S7.8.p8.1.m1.2.2.3.3.cmml">t</mi></msub><mo id="S7.8.p8.1.m1.2.2.2" xref="S7.8.p8.1.m1.2.2.2.cmml">=</mo><mrow id="S7.8.p8.1.m1.2.2.1" xref="S7.8.p8.1.m1.2.2.1.cmml"><mi id="S7.8.p8.1.m1.2.2.1.3" xref="S7.8.p8.1.m1.2.2.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S7.8.p8.1.m1.2.2.1.2" xref="S7.8.p8.1.m1.2.2.1.2.cmml">​</mo><mrow id="S7.8.p8.1.m1.2.2.1.1.1" xref="S7.8.p8.1.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S7.8.p8.1.m1.2.2.1.1.1.2" xref="S7.8.p8.1.m1.2.2.1.1.2.cmml">(</mo><mi id="S7.8.p8.1.m1.1.1" xref="S7.8.p8.1.m1.1.1.cmml">𝐱</mi><mo id="S7.8.p8.1.m1.2.2.1.1.1.3" xref="S7.8.p8.1.m1.2.2.1.1.2.cmml">,</mo><msubsup id="S7.8.p8.1.m1.2.2.1.1.1.1" xref="S7.8.p8.1.m1.2.2.1.1.1.1.cmml"><mrow id="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.2.cmml">{</mo><msub id="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S7.8.p8.1.m1.2.2.1.1.1.1.1.3" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.2" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.2.cmml">i</mi><mo id="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.1" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.1.cmml">=</mo><mn id="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.3" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S7.8.p8.1.m1.2.2.1.1.1.1.3" xref="S7.8.p8.1.m1.2.2.1.1.1.1.3.cmml"><mi id="S7.8.p8.1.m1.2.2.1.1.1.1.3.2" xref="S7.8.p8.1.m1.2.2.1.1.1.1.3.2.cmml">t</mi><mo id="S7.8.p8.1.m1.2.2.1.1.1.1.3.1" xref="S7.8.p8.1.m1.2.2.1.1.1.1.3.1.cmml">−</mo><mn id="S7.8.p8.1.m1.2.2.1.1.1.1.3.3" xref="S7.8.p8.1.m1.2.2.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="S7.8.p8.1.m1.2.2.1.1.1.4" xref="S7.8.p8.1.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.8.p8.1.m1.2b"><apply id="S7.8.p8.1.m1.2.2.cmml" xref="S7.8.p8.1.m1.2.2"><eq id="S7.8.p8.1.m1.2.2.2.cmml" xref="S7.8.p8.1.m1.2.2.2"></eq><apply id="S7.8.p8.1.m1.2.2.3.cmml" xref="S7.8.p8.1.m1.2.2.3"><csymbol cd="ambiguous" id="S7.8.p8.1.m1.2.2.3.1.cmml" xref="S7.8.p8.1.m1.2.2.3">subscript</csymbol><apply id="S7.8.p8.1.m1.2.2.3.2.cmml" xref="S7.8.p8.1.m1.2.2.3.2"><ci id="S7.8.p8.1.m1.2.2.3.2.1.cmml" xref="S7.8.p8.1.m1.2.2.3.2.1">^</ci><ci id="S7.8.p8.1.m1.2.2.3.2.2.cmml" xref="S7.8.p8.1.m1.2.2.3.2.2">𝜋</ci></apply><ci id="S7.8.p8.1.m1.2.2.3.3.cmml" xref="S7.8.p8.1.m1.2.2.3.3">𝑡</ci></apply><apply id="S7.8.p8.1.m1.2.2.1.cmml" xref="S7.8.p8.1.m1.2.2.1"><times id="S7.8.p8.1.m1.2.2.1.2.cmml" xref="S7.8.p8.1.m1.2.2.1.2"></times><ci id="S7.8.p8.1.m1.2.2.1.3.cmml" xref="S7.8.p8.1.m1.2.2.1.3">𝑓</ci><interval closure="open" id="S7.8.p8.1.m1.2.2.1.1.2.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1"><ci id="S7.8.p8.1.m1.1.1.cmml" xref="S7.8.p8.1.m1.1.1">𝐱</ci><apply id="S7.8.p8.1.m1.2.2.1.1.1.1.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S7.8.p8.1.m1.2.2.1.1.1.1.2.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S7.8.p8.1.m1.2.2.1.1.1.1.1.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S7.8.p8.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1">subscript</csymbol><set id="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1"><apply id="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.3"><eq id="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.1"></eq><ci id="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S7.8.p8.1.m1.2.2.1.1.1.1.3.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.3"><minus id="S7.8.p8.1.m1.2.2.1.1.1.1.3.1.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.3.1"></minus><ci id="S7.8.p8.1.m1.2.2.1.1.1.1.3.2.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S7.8.p8.1.m1.2.2.1.1.1.1.3.3.cmml" xref="S7.8.p8.1.m1.2.2.1.1.1.1.3.3">1</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.8.p8.1.m1.2c">\hat{\pi}_{t}=f(\mathbf{x},\{\mathbf{z}_{i}\}_{i=1}^{t-1})</annotation></semantics></math> be the
inferred distribution for <math id="S7.8.p8.2.m2.1" class="ltx_Math" alttext="\mathbf{z}_{t}" display="inline"><semantics id="S7.8.p8.2.m2.1a"><msub id="S7.8.p8.2.m2.1.1" xref="S7.8.p8.2.m2.1.1.cmml"><mi id="S7.8.p8.2.m2.1.1.2" xref="S7.8.p8.2.m2.1.1.2.cmml">𝐳</mi><mi id="S7.8.p8.2.m2.1.1.3" xref="S7.8.p8.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S7.8.p8.2.m2.1b"><apply id="S7.8.p8.2.m2.1.1.cmml" xref="S7.8.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S7.8.p8.2.m2.1.1.1.cmml" xref="S7.8.p8.2.m2.1.1">subscript</csymbol><ci id="S7.8.p8.2.m2.1.1.2.cmml" xref="S7.8.p8.2.m2.1.1.2">𝐳</ci><ci id="S7.8.p8.2.m2.1.1.3.cmml" xref="S7.8.p8.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.8.p8.2.m2.1c">\mathbf{z}_{t}</annotation></semantics></math>. That is, <math id="S7.8.p8.3.m3.1" class="ltx_Math" alttext="\mathbf{z}_{t}=Cat(\hat{\pi_{t}})" display="inline"><semantics id="S7.8.p8.3.m3.1a"><mrow id="S7.8.p8.3.m3.1.2" xref="S7.8.p8.3.m3.1.2.cmml"><msub id="S7.8.p8.3.m3.1.2.2" xref="S7.8.p8.3.m3.1.2.2.cmml"><mi id="S7.8.p8.3.m3.1.2.2.2" xref="S7.8.p8.3.m3.1.2.2.2.cmml">𝐳</mi><mi id="S7.8.p8.3.m3.1.2.2.3" xref="S7.8.p8.3.m3.1.2.2.3.cmml">t</mi></msub><mo id="S7.8.p8.3.m3.1.2.1" xref="S7.8.p8.3.m3.1.2.1.cmml">=</mo><mrow id="S7.8.p8.3.m3.1.2.3" xref="S7.8.p8.3.m3.1.2.3.cmml"><mi id="S7.8.p8.3.m3.1.2.3.2" xref="S7.8.p8.3.m3.1.2.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S7.8.p8.3.m3.1.2.3.1" xref="S7.8.p8.3.m3.1.2.3.1.cmml">​</mo><mi id="S7.8.p8.3.m3.1.2.3.3" xref="S7.8.p8.3.m3.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S7.8.p8.3.m3.1.2.3.1a" xref="S7.8.p8.3.m3.1.2.3.1.cmml">​</mo><mi id="S7.8.p8.3.m3.1.2.3.4" xref="S7.8.p8.3.m3.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S7.8.p8.3.m3.1.2.3.1b" xref="S7.8.p8.3.m3.1.2.3.1.cmml">​</mo><mrow id="S7.8.p8.3.m3.1.2.3.5.2" xref="S7.8.p8.3.m3.1.1.cmml"><mo stretchy="false" id="S7.8.p8.3.m3.1.2.3.5.2.1" xref="S7.8.p8.3.m3.1.1.cmml">(</mo><mover accent="true" id="S7.8.p8.3.m3.1.1" xref="S7.8.p8.3.m3.1.1.cmml"><msub id="S7.8.p8.3.m3.1.1.2" xref="S7.8.p8.3.m3.1.1.2.cmml"><mi id="S7.8.p8.3.m3.1.1.2.2" xref="S7.8.p8.3.m3.1.1.2.2.cmml">π</mi><mi id="S7.8.p8.3.m3.1.1.2.3" xref="S7.8.p8.3.m3.1.1.2.3.cmml">t</mi></msub><mo id="S7.8.p8.3.m3.1.1.1" xref="S7.8.p8.3.m3.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S7.8.p8.3.m3.1.2.3.5.2.2" xref="S7.8.p8.3.m3.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.8.p8.3.m3.1b"><apply id="S7.8.p8.3.m3.1.2.cmml" xref="S7.8.p8.3.m3.1.2"><eq id="S7.8.p8.3.m3.1.2.1.cmml" xref="S7.8.p8.3.m3.1.2.1"></eq><apply id="S7.8.p8.3.m3.1.2.2.cmml" xref="S7.8.p8.3.m3.1.2.2"><csymbol cd="ambiguous" id="S7.8.p8.3.m3.1.2.2.1.cmml" xref="S7.8.p8.3.m3.1.2.2">subscript</csymbol><ci id="S7.8.p8.3.m3.1.2.2.2.cmml" xref="S7.8.p8.3.m3.1.2.2.2">𝐳</ci><ci id="S7.8.p8.3.m3.1.2.2.3.cmml" xref="S7.8.p8.3.m3.1.2.2.3">𝑡</ci></apply><apply id="S7.8.p8.3.m3.1.2.3.cmml" xref="S7.8.p8.3.m3.1.2.3"><times id="S7.8.p8.3.m3.1.2.3.1.cmml" xref="S7.8.p8.3.m3.1.2.3.1"></times><ci id="S7.8.p8.3.m3.1.2.3.2.cmml" xref="S7.8.p8.3.m3.1.2.3.2">𝐶</ci><ci id="S7.8.p8.3.m3.1.2.3.3.cmml" xref="S7.8.p8.3.m3.1.2.3.3">𝑎</ci><ci id="S7.8.p8.3.m3.1.2.3.4.cmml" xref="S7.8.p8.3.m3.1.2.3.4">𝑡</ci><apply id="S7.8.p8.3.m3.1.1.cmml" xref="S7.8.p8.3.m3.1.2.3.5.2"><ci id="S7.8.p8.3.m3.1.1.1.cmml" xref="S7.8.p8.3.m3.1.1.1">^</ci><apply id="S7.8.p8.3.m3.1.1.2.cmml" xref="S7.8.p8.3.m3.1.1.2"><csymbol cd="ambiguous" id="S7.8.p8.3.m3.1.1.2.1.cmml" xref="S7.8.p8.3.m3.1.1.2">subscript</csymbol><ci id="S7.8.p8.3.m3.1.1.2.2.cmml" xref="S7.8.p8.3.m3.1.1.2.2">𝜋</ci><ci id="S7.8.p8.3.m3.1.1.2.3.cmml" xref="S7.8.p8.3.m3.1.1.2.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.8.p8.3.m3.1c">\mathbf{z}_{t}=Cat(\hat{\pi_{t}})</annotation></semantics></math>. Then,
let <math id="S7.8.p8.4.m4.3" class="ltx_Math" alttext="q_{\phi}(\pi_{t}|\mathbf{x},\{\mathbf{z}_{i}\}_{i=1}^{t-1})=\delta(\pi_{t}-\hat{\pi}_{t})" display="inline"><semantics id="S7.8.p8.4.m4.3a"><mrow id="S7.8.p8.4.m4.3.3" xref="S7.8.p8.4.m4.3.3.cmml"><mrow id="S7.8.p8.4.m4.2.2.1" xref="S7.8.p8.4.m4.2.2.1.cmml"><msub id="S7.8.p8.4.m4.2.2.1.3" xref="S7.8.p8.4.m4.2.2.1.3.cmml"><mi id="S7.8.p8.4.m4.2.2.1.3.2" xref="S7.8.p8.4.m4.2.2.1.3.2.cmml">q</mi><mi id="S7.8.p8.4.m4.2.2.1.3.3" xref="S7.8.p8.4.m4.2.2.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S7.8.p8.4.m4.2.2.1.2" xref="S7.8.p8.4.m4.2.2.1.2.cmml">​</mo><mrow id="S7.8.p8.4.m4.2.2.1.1.1" xref="S7.8.p8.4.m4.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S7.8.p8.4.m4.2.2.1.1.1.2" xref="S7.8.p8.4.m4.2.2.1.1.1.1.cmml">(</mo><mrow id="S7.8.p8.4.m4.2.2.1.1.1.1" xref="S7.8.p8.4.m4.2.2.1.1.1.1.cmml"><msub id="S7.8.p8.4.m4.2.2.1.1.1.1.3" xref="S7.8.p8.4.m4.2.2.1.1.1.1.3.cmml"><mi id="S7.8.p8.4.m4.2.2.1.1.1.1.3.2" xref="S7.8.p8.4.m4.2.2.1.1.1.1.3.2.cmml">π</mi><mi id="S7.8.p8.4.m4.2.2.1.1.1.1.3.3" xref="S7.8.p8.4.m4.2.2.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S7.8.p8.4.m4.2.2.1.1.1.1.2" xref="S7.8.p8.4.m4.2.2.1.1.1.1.2.cmml">|</mo><mrow id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.2.cmml"><mi id="S7.8.p8.4.m4.1.1" xref="S7.8.p8.4.m4.1.1.cmml">𝐱</mi><mo id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.2" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.2.cmml">,</mo><msubsup id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.2" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.1" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.3" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.2" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.1" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.3" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><mo stretchy="false" id="S7.8.p8.4.m4.2.2.1.1.1.3" xref="S7.8.p8.4.m4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.8.p8.4.m4.3.3.3" xref="S7.8.p8.4.m4.3.3.3.cmml">=</mo><mrow id="S7.8.p8.4.m4.3.3.2" xref="S7.8.p8.4.m4.3.3.2.cmml"><mi id="S7.8.p8.4.m4.3.3.2.3" xref="S7.8.p8.4.m4.3.3.2.3.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S7.8.p8.4.m4.3.3.2.2" xref="S7.8.p8.4.m4.3.3.2.2.cmml">​</mo><mrow id="S7.8.p8.4.m4.3.3.2.1.1" xref="S7.8.p8.4.m4.3.3.2.1.1.1.cmml"><mo stretchy="false" id="S7.8.p8.4.m4.3.3.2.1.1.2" xref="S7.8.p8.4.m4.3.3.2.1.1.1.cmml">(</mo><mrow id="S7.8.p8.4.m4.3.3.2.1.1.1" xref="S7.8.p8.4.m4.3.3.2.1.1.1.cmml"><msub id="S7.8.p8.4.m4.3.3.2.1.1.1.2" xref="S7.8.p8.4.m4.3.3.2.1.1.1.2.cmml"><mi id="S7.8.p8.4.m4.3.3.2.1.1.1.2.2" xref="S7.8.p8.4.m4.3.3.2.1.1.1.2.2.cmml">π</mi><mi id="S7.8.p8.4.m4.3.3.2.1.1.1.2.3" xref="S7.8.p8.4.m4.3.3.2.1.1.1.2.3.cmml">t</mi></msub><mo id="S7.8.p8.4.m4.3.3.2.1.1.1.1" xref="S7.8.p8.4.m4.3.3.2.1.1.1.1.cmml">−</mo><msub id="S7.8.p8.4.m4.3.3.2.1.1.1.3" xref="S7.8.p8.4.m4.3.3.2.1.1.1.3.cmml"><mover accent="true" id="S7.8.p8.4.m4.3.3.2.1.1.1.3.2" xref="S7.8.p8.4.m4.3.3.2.1.1.1.3.2.cmml"><mi id="S7.8.p8.4.m4.3.3.2.1.1.1.3.2.2" xref="S7.8.p8.4.m4.3.3.2.1.1.1.3.2.2.cmml">π</mi><mo id="S7.8.p8.4.m4.3.3.2.1.1.1.3.2.1" xref="S7.8.p8.4.m4.3.3.2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S7.8.p8.4.m4.3.3.2.1.1.1.3.3" xref="S7.8.p8.4.m4.3.3.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S7.8.p8.4.m4.3.3.2.1.1.3" xref="S7.8.p8.4.m4.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.8.p8.4.m4.3b"><apply id="S7.8.p8.4.m4.3.3.cmml" xref="S7.8.p8.4.m4.3.3"><eq id="S7.8.p8.4.m4.3.3.3.cmml" xref="S7.8.p8.4.m4.3.3.3"></eq><apply id="S7.8.p8.4.m4.2.2.1.cmml" xref="S7.8.p8.4.m4.2.2.1"><times id="S7.8.p8.4.m4.2.2.1.2.cmml" xref="S7.8.p8.4.m4.2.2.1.2"></times><apply id="S7.8.p8.4.m4.2.2.1.3.cmml" xref="S7.8.p8.4.m4.2.2.1.3"><csymbol cd="ambiguous" id="S7.8.p8.4.m4.2.2.1.3.1.cmml" xref="S7.8.p8.4.m4.2.2.1.3">subscript</csymbol><ci id="S7.8.p8.4.m4.2.2.1.3.2.cmml" xref="S7.8.p8.4.m4.2.2.1.3.2">𝑞</ci><ci id="S7.8.p8.4.m4.2.2.1.3.3.cmml" xref="S7.8.p8.4.m4.2.2.1.3.3">italic-ϕ</ci></apply><apply id="S7.8.p8.4.m4.2.2.1.1.1.1.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1"><csymbol cd="latexml" id="S7.8.p8.4.m4.2.2.1.1.1.1.2.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.2">conditional</csymbol><apply id="S7.8.p8.4.m4.2.2.1.1.1.1.3.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.8.p8.4.m4.2.2.1.1.1.1.3.1.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.3">subscript</csymbol><ci id="S7.8.p8.4.m4.2.2.1.1.1.1.3.2.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.3.2">𝜋</ci><ci id="S7.8.p8.4.m4.2.2.1.1.1.1.3.3.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.3.3">𝑡</ci></apply><list id="S7.8.p8.4.m4.2.2.1.1.1.1.1.2.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1"><ci id="S7.8.p8.4.m4.1.1.cmml" xref="S7.8.p8.4.m4.1.1">𝐱</ci><apply id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.2.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1">subscript</csymbol><set id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1"><apply id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3"><eq id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.1"></eq><ci id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3"><minus id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.1"></minus><ci id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S7.8.p8.4.m4.2.2.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></list></apply></apply><apply id="S7.8.p8.4.m4.3.3.2.cmml" xref="S7.8.p8.4.m4.3.3.2"><times id="S7.8.p8.4.m4.3.3.2.2.cmml" xref="S7.8.p8.4.m4.3.3.2.2"></times><ci id="S7.8.p8.4.m4.3.3.2.3.cmml" xref="S7.8.p8.4.m4.3.3.2.3">𝛿</ci><apply id="S7.8.p8.4.m4.3.3.2.1.1.1.cmml" xref="S7.8.p8.4.m4.3.3.2.1.1"><minus id="S7.8.p8.4.m4.3.3.2.1.1.1.1.cmml" xref="S7.8.p8.4.m4.3.3.2.1.1.1.1"></minus><apply id="S7.8.p8.4.m4.3.3.2.1.1.1.2.cmml" xref="S7.8.p8.4.m4.3.3.2.1.1.1.2"><csymbol cd="ambiguous" id="S7.8.p8.4.m4.3.3.2.1.1.1.2.1.cmml" xref="S7.8.p8.4.m4.3.3.2.1.1.1.2">subscript</csymbol><ci id="S7.8.p8.4.m4.3.3.2.1.1.1.2.2.cmml" xref="S7.8.p8.4.m4.3.3.2.1.1.1.2.2">𝜋</ci><ci id="S7.8.p8.4.m4.3.3.2.1.1.1.2.3.cmml" xref="S7.8.p8.4.m4.3.3.2.1.1.1.2.3">𝑡</ci></apply><apply id="S7.8.p8.4.m4.3.3.2.1.1.1.3.cmml" xref="S7.8.p8.4.m4.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S7.8.p8.4.m4.3.3.2.1.1.1.3.1.cmml" xref="S7.8.p8.4.m4.3.3.2.1.1.1.3">subscript</csymbol><apply id="S7.8.p8.4.m4.3.3.2.1.1.1.3.2.cmml" xref="S7.8.p8.4.m4.3.3.2.1.1.1.3.2"><ci id="S7.8.p8.4.m4.3.3.2.1.1.1.3.2.1.cmml" xref="S7.8.p8.4.m4.3.3.2.1.1.1.3.2.1">^</ci><ci id="S7.8.p8.4.m4.3.3.2.1.1.1.3.2.2.cmml" xref="S7.8.p8.4.m4.3.3.2.1.1.1.3.2.2">𝜋</ci></apply><ci id="S7.8.p8.4.m4.3.3.2.1.1.1.3.3.cmml" xref="S7.8.p8.4.m4.3.3.2.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.8.p8.4.m4.3c">q_{\phi}(\pi_{t}|\mathbf{x},\{\mathbf{z}_{i}\}_{i=1}^{t-1})=\delta(\pi_{t}-\hat{\pi}_{t})</annotation></semantics></math>, that is,
a Dirac delta function at <math id="S7.8.p8.5.m5.1" class="ltx_Math" alttext="\hat{\pi}_{t}" display="inline"><semantics id="S7.8.p8.5.m5.1a"><msub id="S7.8.p8.5.m5.1.1" xref="S7.8.p8.5.m5.1.1.cmml"><mover accent="true" id="S7.8.p8.5.m5.1.1.2" xref="S7.8.p8.5.m5.1.1.2.cmml"><mi id="S7.8.p8.5.m5.1.1.2.2" xref="S7.8.p8.5.m5.1.1.2.2.cmml">π</mi><mo id="S7.8.p8.5.m5.1.1.2.1" xref="S7.8.p8.5.m5.1.1.2.1.cmml">^</mo></mover><mi id="S7.8.p8.5.m5.1.1.3" xref="S7.8.p8.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S7.8.p8.5.m5.1b"><apply id="S7.8.p8.5.m5.1.1.cmml" xref="S7.8.p8.5.m5.1.1"><csymbol cd="ambiguous" id="S7.8.p8.5.m5.1.1.1.cmml" xref="S7.8.p8.5.m5.1.1">subscript</csymbol><apply id="S7.8.p8.5.m5.1.1.2.cmml" xref="S7.8.p8.5.m5.1.1.2"><ci id="S7.8.p8.5.m5.1.1.2.1.cmml" xref="S7.8.p8.5.m5.1.1.2.1">^</ci><ci id="S7.8.p8.5.m5.1.1.2.2.cmml" xref="S7.8.p8.5.m5.1.1.2.2">𝜋</ci></apply><ci id="S7.8.p8.5.m5.1.1.3.cmml" xref="S7.8.p8.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.8.p8.5.m5.1c">\hat{\pi}_{t}</annotation></semantics></math>.</p>
</div>
<div id="S7.9.p9" class="ltx_para">
<p id="S7.9.p9.1" class="ltx_p">Further, note that we can write the second term
<math id="S7.9.p9.1.m1.4" class="ltx_Math" alttext="E_{q(\Pi|\mathbf{z},\mathbf{x})}\left[\log p(\mathbf{z}|\Pi)\right]" display="inline"><semantics id="S7.9.p9.1.m1.4a"><mrow id="S7.9.p9.1.m1.4.4" xref="S7.9.p9.1.m1.4.4.cmml"><msub id="S7.9.p9.1.m1.4.4.3" xref="S7.9.p9.1.m1.4.4.3.cmml"><mi id="S7.9.p9.1.m1.4.4.3.2" xref="S7.9.p9.1.m1.4.4.3.2.cmml">E</mi><mrow id="S7.9.p9.1.m1.3.3.3" xref="S7.9.p9.1.m1.3.3.3.cmml"><mi id="S7.9.p9.1.m1.3.3.3.5" xref="S7.9.p9.1.m1.3.3.3.5.cmml">q</mi><mo lspace="0em" rspace="0em" id="S7.9.p9.1.m1.3.3.3.4" xref="S7.9.p9.1.m1.3.3.3.4.cmml">​</mo><mrow id="S7.9.p9.1.m1.3.3.3.3.1" xref="S7.9.p9.1.m1.3.3.3.3.1.1.cmml"><mo stretchy="false" id="S7.9.p9.1.m1.3.3.3.3.1.2" xref="S7.9.p9.1.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S7.9.p9.1.m1.3.3.3.3.1.1" xref="S7.9.p9.1.m1.3.3.3.3.1.1.cmml"><mi mathvariant="normal" id="S7.9.p9.1.m1.3.3.3.3.1.1.2" xref="S7.9.p9.1.m1.3.3.3.3.1.1.2.cmml">Π</mi><mo fence="false" id="S7.9.p9.1.m1.3.3.3.3.1.1.1" xref="S7.9.p9.1.m1.3.3.3.3.1.1.1.cmml">|</mo><mrow id="S7.9.p9.1.m1.3.3.3.3.1.1.3.2" xref="S7.9.p9.1.m1.3.3.3.3.1.1.3.1.cmml"><mi id="S7.9.p9.1.m1.1.1.1.1" xref="S7.9.p9.1.m1.1.1.1.1.cmml">𝐳</mi><mo id="S7.9.p9.1.m1.3.3.3.3.1.1.3.2.1" xref="S7.9.p9.1.m1.3.3.3.3.1.1.3.1.cmml">,</mo><mi id="S7.9.p9.1.m1.2.2.2.2" xref="S7.9.p9.1.m1.2.2.2.2.cmml">𝐱</mi></mrow></mrow><mo stretchy="false" id="S7.9.p9.1.m1.3.3.3.3.1.3" xref="S7.9.p9.1.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S7.9.p9.1.m1.4.4.2" xref="S7.9.p9.1.m1.4.4.2.cmml">​</mo><mrow id="S7.9.p9.1.m1.4.4.1.1" xref="S7.9.p9.1.m1.4.4.1.2.cmml"><mo id="S7.9.p9.1.m1.4.4.1.1.2" xref="S7.9.p9.1.m1.4.4.1.2.1.cmml">[</mo><mrow id="S7.9.p9.1.m1.4.4.1.1.1" xref="S7.9.p9.1.m1.4.4.1.1.1.cmml"><mrow id="S7.9.p9.1.m1.4.4.1.1.1.3" xref="S7.9.p9.1.m1.4.4.1.1.1.3.cmml"><mi id="S7.9.p9.1.m1.4.4.1.1.1.3.1" xref="S7.9.p9.1.m1.4.4.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S7.9.p9.1.m1.4.4.1.1.1.3a" xref="S7.9.p9.1.m1.4.4.1.1.1.3.cmml">⁡</mo><mi id="S7.9.p9.1.m1.4.4.1.1.1.3.2" xref="S7.9.p9.1.m1.4.4.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.9.p9.1.m1.4.4.1.1.1.2" xref="S7.9.p9.1.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S7.9.p9.1.m1.4.4.1.1.1.1.1" xref="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.9.p9.1.m1.4.4.1.1.1.1.1.2" xref="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.9.p9.1.m1.4.4.1.1.1.1.1.1" xref="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.2" xref="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.1" xref="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.1.cmml">|</mo><mi mathvariant="normal" id="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.3" xref="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.3.cmml">Π</mi></mrow><mo stretchy="false" id="S7.9.p9.1.m1.4.4.1.1.1.1.1.3" xref="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.9.p9.1.m1.4.4.1.1.3" xref="S7.9.p9.1.m1.4.4.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.9.p9.1.m1.4b"><apply id="S7.9.p9.1.m1.4.4.cmml" xref="S7.9.p9.1.m1.4.4"><times id="S7.9.p9.1.m1.4.4.2.cmml" xref="S7.9.p9.1.m1.4.4.2"></times><apply id="S7.9.p9.1.m1.4.4.3.cmml" xref="S7.9.p9.1.m1.4.4.3"><csymbol cd="ambiguous" id="S7.9.p9.1.m1.4.4.3.1.cmml" xref="S7.9.p9.1.m1.4.4.3">subscript</csymbol><ci id="S7.9.p9.1.m1.4.4.3.2.cmml" xref="S7.9.p9.1.m1.4.4.3.2">𝐸</ci><apply id="S7.9.p9.1.m1.3.3.3.cmml" xref="S7.9.p9.1.m1.3.3.3"><times id="S7.9.p9.1.m1.3.3.3.4.cmml" xref="S7.9.p9.1.m1.3.3.3.4"></times><ci id="S7.9.p9.1.m1.3.3.3.5.cmml" xref="S7.9.p9.1.m1.3.3.3.5">𝑞</ci><apply id="S7.9.p9.1.m1.3.3.3.3.1.1.cmml" xref="S7.9.p9.1.m1.3.3.3.3.1"><csymbol cd="latexml" id="S7.9.p9.1.m1.3.3.3.3.1.1.1.cmml" xref="S7.9.p9.1.m1.3.3.3.3.1.1.1">conditional</csymbol><ci id="S7.9.p9.1.m1.3.3.3.3.1.1.2.cmml" xref="S7.9.p9.1.m1.3.3.3.3.1.1.2">Π</ci><list id="S7.9.p9.1.m1.3.3.3.3.1.1.3.1.cmml" xref="S7.9.p9.1.m1.3.3.3.3.1.1.3.2"><ci id="S7.9.p9.1.m1.1.1.1.1.cmml" xref="S7.9.p9.1.m1.1.1.1.1">𝐳</ci><ci id="S7.9.p9.1.m1.2.2.2.2.cmml" xref="S7.9.p9.1.m1.2.2.2.2">𝐱</ci></list></apply></apply></apply><apply id="S7.9.p9.1.m1.4.4.1.2.cmml" xref="S7.9.p9.1.m1.4.4.1.1"><csymbol cd="latexml" id="S7.9.p9.1.m1.4.4.1.2.1.cmml" xref="S7.9.p9.1.m1.4.4.1.1.2">delimited-[]</csymbol><apply id="S7.9.p9.1.m1.4.4.1.1.1.cmml" xref="S7.9.p9.1.m1.4.4.1.1.1"><times id="S7.9.p9.1.m1.4.4.1.1.1.2.cmml" xref="S7.9.p9.1.m1.4.4.1.1.1.2"></times><apply id="S7.9.p9.1.m1.4.4.1.1.1.3.cmml" xref="S7.9.p9.1.m1.4.4.1.1.1.3"><log id="S7.9.p9.1.m1.4.4.1.1.1.3.1.cmml" xref="S7.9.p9.1.m1.4.4.1.1.1.3.1"></log><ci id="S7.9.p9.1.m1.4.4.1.1.1.3.2.cmml" xref="S7.9.p9.1.m1.4.4.1.1.1.3.2">𝑝</ci></apply><apply id="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.cmml" xref="S7.9.p9.1.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.1">conditional</csymbol><ci id="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.2">𝐳</ci><ci id="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S7.9.p9.1.m1.4.4.1.1.1.1.1.1.3">Π</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.9.p9.1.m1.4c">E_{q(\Pi|\mathbf{z},\mathbf{x})}\left[\log p(\mathbf{z}|\Pi)\right]</annotation></semantics></math> as follows:</p>
</div>
<div id="S7.10.p10" class="ltx_para">
<table id="S15.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S7.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S7.E10.m2.4" class="ltx_Math" alttext="\displaystyle\int d\Pi q(\Pi|\mathbf{z},\mathbf{x})\log p(\mathbf{z}|\Pi)" display="inline"><semantics id="S7.E10.m2.4a"><mstyle displaystyle="true" id="S7.E10.m2.4.4" xref="S7.E10.m2.4.4.cmml"><mrow id="S7.E10.m2.4.4a" xref="S7.E10.m2.4.4.cmml"><mo id="S7.E10.m2.4.4.3" xref="S7.E10.m2.4.4.3.cmml">∫</mo><mrow id="S7.E10.m2.4.4.2" xref="S7.E10.m2.4.4.2.cmml"><mrow id="S7.E10.m2.4.4.2.4" xref="S7.E10.m2.4.4.2.4.cmml"><mo lspace="0em" rspace="0em" id="S7.E10.m2.4.4.2.4.1" xref="S7.E10.m2.4.4.2.4.1.cmml">𝑑</mo><mi mathvariant="normal" id="S7.E10.m2.4.4.2.4.2" xref="S7.E10.m2.4.4.2.4.2.cmml">Π</mi></mrow><mo lspace="0em" rspace="0em" id="S7.E10.m2.4.4.2.3" xref="S7.E10.m2.4.4.2.3.cmml">​</mo><mi id="S7.E10.m2.4.4.2.5" xref="S7.E10.m2.4.4.2.5.cmml">q</mi><mo lspace="0em" rspace="0em" id="S7.E10.m2.4.4.2.3a" xref="S7.E10.m2.4.4.2.3.cmml">​</mo><mrow id="S7.E10.m2.3.3.1.1.1" xref="S7.E10.m2.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S7.E10.m2.3.3.1.1.1.2" xref="S7.E10.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S7.E10.m2.3.3.1.1.1.1" xref="S7.E10.m2.3.3.1.1.1.1.cmml"><mi mathvariant="normal" id="S7.E10.m2.3.3.1.1.1.1.2" xref="S7.E10.m2.3.3.1.1.1.1.2.cmml">Π</mi><mo fence="false" id="S7.E10.m2.3.3.1.1.1.1.1" xref="S7.E10.m2.3.3.1.1.1.1.1.cmml">|</mo><mrow id="S7.E10.m2.3.3.1.1.1.1.3.2" xref="S7.E10.m2.3.3.1.1.1.1.3.1.cmml"><mi id="S7.E10.m2.1.1" xref="S7.E10.m2.1.1.cmml">𝐳</mi><mo id="S7.E10.m2.3.3.1.1.1.1.3.2.1" xref="S7.E10.m2.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="S7.E10.m2.2.2" xref="S7.E10.m2.2.2.cmml">𝐱</mi></mrow></mrow><mo stretchy="false" id="S7.E10.m2.3.3.1.1.1.3" xref="S7.E10.m2.3.3.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S7.E10.m2.4.4.2.3b" xref="S7.E10.m2.4.4.2.3.cmml">​</mo><mrow id="S7.E10.m2.4.4.2.6" xref="S7.E10.m2.4.4.2.6.cmml"><mi id="S7.E10.m2.4.4.2.6.1" xref="S7.E10.m2.4.4.2.6.1.cmml">log</mi><mo lspace="0.167em" id="S7.E10.m2.4.4.2.6a" xref="S7.E10.m2.4.4.2.6.cmml">⁡</mo><mi id="S7.E10.m2.4.4.2.6.2" xref="S7.E10.m2.4.4.2.6.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.E10.m2.4.4.2.3c" xref="S7.E10.m2.4.4.2.3.cmml">​</mo><mrow id="S7.E10.m2.4.4.2.2.1" xref="S7.E10.m2.4.4.2.2.1.1.cmml"><mo stretchy="false" id="S7.E10.m2.4.4.2.2.1.2" xref="S7.E10.m2.4.4.2.2.1.1.cmml">(</mo><mrow id="S7.E10.m2.4.4.2.2.1.1" xref="S7.E10.m2.4.4.2.2.1.1.cmml"><mi id="S7.E10.m2.4.4.2.2.1.1.2" xref="S7.E10.m2.4.4.2.2.1.1.2.cmml">𝐳</mi><mo fence="false" id="S7.E10.m2.4.4.2.2.1.1.1" xref="S7.E10.m2.4.4.2.2.1.1.1.cmml">|</mo><mi mathvariant="normal" id="S7.E10.m2.4.4.2.2.1.1.3" xref="S7.E10.m2.4.4.2.2.1.1.3.cmml">Π</mi></mrow><mo stretchy="false" id="S7.E10.m2.4.4.2.2.1.3" xref="S7.E10.m2.4.4.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mstyle><annotation-xml encoding="MathML-Content" id="S7.E10.m2.4b"><apply id="S7.E10.m2.4.4.cmml" xref="S7.E10.m2.4.4"><int id="S7.E10.m2.4.4.3.cmml" xref="S7.E10.m2.4.4.3"></int><apply id="S7.E10.m2.4.4.2.cmml" xref="S7.E10.m2.4.4.2"><times id="S7.E10.m2.4.4.2.3.cmml" xref="S7.E10.m2.4.4.2.3"></times><apply id="S7.E10.m2.4.4.2.4.cmml" xref="S7.E10.m2.4.4.2.4"><csymbol cd="latexml" id="S7.E10.m2.4.4.2.4.1.cmml" xref="S7.E10.m2.4.4.2.4.1">differential-d</csymbol><ci id="S7.E10.m2.4.4.2.4.2.cmml" xref="S7.E10.m2.4.4.2.4.2">Π</ci></apply><ci id="S7.E10.m2.4.4.2.5.cmml" xref="S7.E10.m2.4.4.2.5">𝑞</ci><apply id="S7.E10.m2.3.3.1.1.1.1.cmml" xref="S7.E10.m2.3.3.1.1.1"><csymbol cd="latexml" id="S7.E10.m2.3.3.1.1.1.1.1.cmml" xref="S7.E10.m2.3.3.1.1.1.1.1">conditional</csymbol><ci id="S7.E10.m2.3.3.1.1.1.1.2.cmml" xref="S7.E10.m2.3.3.1.1.1.1.2">Π</ci><list id="S7.E10.m2.3.3.1.1.1.1.3.1.cmml" xref="S7.E10.m2.3.3.1.1.1.1.3.2"><ci id="S7.E10.m2.1.1.cmml" xref="S7.E10.m2.1.1">𝐳</ci><ci id="S7.E10.m2.2.2.cmml" xref="S7.E10.m2.2.2">𝐱</ci></list></apply><apply id="S7.E10.m2.4.4.2.6.cmml" xref="S7.E10.m2.4.4.2.6"><log id="S7.E10.m2.4.4.2.6.1.cmml" xref="S7.E10.m2.4.4.2.6.1"></log><ci id="S7.E10.m2.4.4.2.6.2.cmml" xref="S7.E10.m2.4.4.2.6.2">𝑝</ci></apply><apply id="S7.E10.m2.4.4.2.2.1.1.cmml" xref="S7.E10.m2.4.4.2.2.1"><csymbol cd="latexml" id="S7.E10.m2.4.4.2.2.1.1.1.cmml" xref="S7.E10.m2.4.4.2.2.1.1.1">conditional</csymbol><ci id="S7.E10.m2.4.4.2.2.1.1.2.cmml" xref="S7.E10.m2.4.4.2.2.1.1.2">𝐳</ci><ci id="S7.E10.m2.4.4.2.2.1.1.3.cmml" xref="S7.E10.m2.4.4.2.2.1.1.3">Π</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E10.m2.4c">\displaystyle\int d\Pi q(\Pi|\mathbf{z},\mathbf{x})\log p(\mathbf{z}|\Pi)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S7.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S7.E11.m1.3" class="ltx_Math" alttext="\displaystyle=\sum_{t=1}^{T}\int d\pi_{t}q(\pi_{t}|\{z_{i}\}_{i=1}^{t-1},\mathbf{x})\log p(z_{t}|\pi_{t})" display="inline"><semantics id="S7.E11.m1.3a"><mrow id="S7.E11.m1.3.3" xref="S7.E11.m1.3.3.cmml"><mi id="S7.E11.m1.3.3.4" xref="S7.E11.m1.3.3.4.cmml"></mi><mo id="S7.E11.m1.3.3.3" xref="S7.E11.m1.3.3.3.cmml">=</mo><mrow id="S7.E11.m1.3.3.2" xref="S7.E11.m1.3.3.2.cmml"><mstyle displaystyle="true" id="S7.E11.m1.3.3.2.3" xref="S7.E11.m1.3.3.2.3.cmml"><munderover id="S7.E11.m1.3.3.2.3a" xref="S7.E11.m1.3.3.2.3.cmml"><mo movablelimits="false" id="S7.E11.m1.3.3.2.3.2.2" xref="S7.E11.m1.3.3.2.3.2.2.cmml">∑</mo><mrow id="S7.E11.m1.3.3.2.3.2.3" xref="S7.E11.m1.3.3.2.3.2.3.cmml"><mi id="S7.E11.m1.3.3.2.3.2.3.2" xref="S7.E11.m1.3.3.2.3.2.3.2.cmml">t</mi><mo id="S7.E11.m1.3.3.2.3.2.3.1" xref="S7.E11.m1.3.3.2.3.2.3.1.cmml">=</mo><mn id="S7.E11.m1.3.3.2.3.2.3.3" xref="S7.E11.m1.3.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="S7.E11.m1.3.3.2.3.3" xref="S7.E11.m1.3.3.2.3.3.cmml">T</mi></munderover></mstyle><mstyle displaystyle="true" id="S7.E11.m1.3.3.2.2" xref="S7.E11.m1.3.3.2.2.cmml"><mrow id="S7.E11.m1.3.3.2.2a" xref="S7.E11.m1.3.3.2.2.cmml"><mo id="S7.E11.m1.3.3.2.2.3" xref="S7.E11.m1.3.3.2.2.3.cmml">∫</mo><mrow id="S7.E11.m1.3.3.2.2.2" xref="S7.E11.m1.3.3.2.2.2.cmml"><mrow id="S7.E11.m1.3.3.2.2.2.4" xref="S7.E11.m1.3.3.2.2.2.4.cmml"><mo lspace="0em" rspace="0em" id="S7.E11.m1.3.3.2.2.2.4.1" xref="S7.E11.m1.3.3.2.2.2.4.1.cmml">𝑑</mo><msub id="S7.E11.m1.3.3.2.2.2.4.2" xref="S7.E11.m1.3.3.2.2.2.4.2.cmml"><mi id="S7.E11.m1.3.3.2.2.2.4.2.2" xref="S7.E11.m1.3.3.2.2.2.4.2.2.cmml">π</mi><mi id="S7.E11.m1.3.3.2.2.2.4.2.3" xref="S7.E11.m1.3.3.2.2.2.4.2.3.cmml">t</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S7.E11.m1.3.3.2.2.2.3" xref="S7.E11.m1.3.3.2.2.2.3.cmml">​</mo><mi id="S7.E11.m1.3.3.2.2.2.5" xref="S7.E11.m1.3.3.2.2.2.5.cmml">q</mi><mo lspace="0em" rspace="0em" id="S7.E11.m1.3.3.2.2.2.3a" xref="S7.E11.m1.3.3.2.2.2.3.cmml">​</mo><mrow id="S7.E11.m1.2.2.1.1.1.1.1" xref="S7.E11.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.E11.m1.2.2.1.1.1.1.1.2" xref="S7.E11.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.E11.m1.2.2.1.1.1.1.1.1" xref="S7.E11.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S7.E11.m1.2.2.1.1.1.1.1.1.3" xref="S7.E11.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S7.E11.m1.2.2.1.1.1.1.1.1.3.2" xref="S7.E11.m1.2.2.1.1.1.1.1.1.3.2.cmml">π</mi><mi id="S7.E11.m1.2.2.1.1.1.1.1.1.3.3" xref="S7.E11.m1.2.2.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S7.E11.m1.2.2.1.1.1.1.1.1.2" xref="S7.E11.m1.2.2.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml"><msubsup id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S7.E11.m1.1.1" xref="S7.E11.m1.1.1.cmml">𝐱</mi></mrow></mrow><mo stretchy="false" id="S7.E11.m1.2.2.1.1.1.1.1.3" xref="S7.E11.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S7.E11.m1.3.3.2.2.2.3b" xref="S7.E11.m1.3.3.2.2.2.3.cmml">​</mo><mrow id="S7.E11.m1.3.3.2.2.2.6" xref="S7.E11.m1.3.3.2.2.2.6.cmml"><mi id="S7.E11.m1.3.3.2.2.2.6.1" xref="S7.E11.m1.3.3.2.2.2.6.1.cmml">log</mi><mo lspace="0.167em" id="S7.E11.m1.3.3.2.2.2.6a" xref="S7.E11.m1.3.3.2.2.2.6.cmml">⁡</mo><mi id="S7.E11.m1.3.3.2.2.2.6.2" xref="S7.E11.m1.3.3.2.2.2.6.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.E11.m1.3.3.2.2.2.3c" xref="S7.E11.m1.3.3.2.2.2.3.cmml">​</mo><mrow id="S7.E11.m1.3.3.2.2.2.2.1" xref="S7.E11.m1.3.3.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S7.E11.m1.3.3.2.2.2.2.1.2" xref="S7.E11.m1.3.3.2.2.2.2.1.1.cmml">(</mo><mrow id="S7.E11.m1.3.3.2.2.2.2.1.1" xref="S7.E11.m1.3.3.2.2.2.2.1.1.cmml"><msub id="S7.E11.m1.3.3.2.2.2.2.1.1.2" xref="S7.E11.m1.3.3.2.2.2.2.1.1.2.cmml"><mi id="S7.E11.m1.3.3.2.2.2.2.1.1.2.2" xref="S7.E11.m1.3.3.2.2.2.2.1.1.2.2.cmml">z</mi><mi id="S7.E11.m1.3.3.2.2.2.2.1.1.2.3" xref="S7.E11.m1.3.3.2.2.2.2.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S7.E11.m1.3.3.2.2.2.2.1.1.1" xref="S7.E11.m1.3.3.2.2.2.2.1.1.1.cmml">|</mo><msub id="S7.E11.m1.3.3.2.2.2.2.1.1.3" xref="S7.E11.m1.3.3.2.2.2.2.1.1.3.cmml"><mi id="S7.E11.m1.3.3.2.2.2.2.1.1.3.2" xref="S7.E11.m1.3.3.2.2.2.2.1.1.3.2.cmml">π</mi><mi id="S7.E11.m1.3.3.2.2.2.2.1.1.3.3" xref="S7.E11.m1.3.3.2.2.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S7.E11.m1.3.3.2.2.2.2.1.3" xref="S7.E11.m1.3.3.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.E11.m1.3b"><apply id="S7.E11.m1.3.3.cmml" xref="S7.E11.m1.3.3"><eq id="S7.E11.m1.3.3.3.cmml" xref="S7.E11.m1.3.3.3"></eq><csymbol cd="latexml" id="S7.E11.m1.3.3.4.cmml" xref="S7.E11.m1.3.3.4">absent</csymbol><apply id="S7.E11.m1.3.3.2.cmml" xref="S7.E11.m1.3.3.2"><apply id="S7.E11.m1.3.3.2.3.cmml" xref="S7.E11.m1.3.3.2.3"><csymbol cd="ambiguous" id="S7.E11.m1.3.3.2.3.1.cmml" xref="S7.E11.m1.3.3.2.3">superscript</csymbol><apply id="S7.E11.m1.3.3.2.3.2.cmml" xref="S7.E11.m1.3.3.2.3"><csymbol cd="ambiguous" id="S7.E11.m1.3.3.2.3.2.1.cmml" xref="S7.E11.m1.3.3.2.3">subscript</csymbol><sum id="S7.E11.m1.3.3.2.3.2.2.cmml" xref="S7.E11.m1.3.3.2.3.2.2"></sum><apply id="S7.E11.m1.3.3.2.3.2.3.cmml" xref="S7.E11.m1.3.3.2.3.2.3"><eq id="S7.E11.m1.3.3.2.3.2.3.1.cmml" xref="S7.E11.m1.3.3.2.3.2.3.1"></eq><ci id="S7.E11.m1.3.3.2.3.2.3.2.cmml" xref="S7.E11.m1.3.3.2.3.2.3.2">𝑡</ci><cn type="integer" id="S7.E11.m1.3.3.2.3.2.3.3.cmml" xref="S7.E11.m1.3.3.2.3.2.3.3">1</cn></apply></apply><ci id="S7.E11.m1.3.3.2.3.3.cmml" xref="S7.E11.m1.3.3.2.3.3">𝑇</ci></apply><apply id="S7.E11.m1.3.3.2.2.cmml" xref="S7.E11.m1.3.3.2.2"><int id="S7.E11.m1.3.3.2.2.3.cmml" xref="S7.E11.m1.3.3.2.2.3"></int><apply id="S7.E11.m1.3.3.2.2.2.cmml" xref="S7.E11.m1.3.3.2.2.2"><times id="S7.E11.m1.3.3.2.2.2.3.cmml" xref="S7.E11.m1.3.3.2.2.2.3"></times><apply id="S7.E11.m1.3.3.2.2.2.4.cmml" xref="S7.E11.m1.3.3.2.2.2.4"><csymbol cd="latexml" id="S7.E11.m1.3.3.2.2.2.4.1.cmml" xref="S7.E11.m1.3.3.2.2.2.4.1">differential-d</csymbol><apply id="S7.E11.m1.3.3.2.2.2.4.2.cmml" xref="S7.E11.m1.3.3.2.2.2.4.2"><csymbol cd="ambiguous" id="S7.E11.m1.3.3.2.2.2.4.2.1.cmml" xref="S7.E11.m1.3.3.2.2.2.4.2">subscript</csymbol><ci id="S7.E11.m1.3.3.2.2.2.4.2.2.cmml" xref="S7.E11.m1.3.3.2.2.2.4.2.2">𝜋</ci><ci id="S7.E11.m1.3.3.2.2.2.4.2.3.cmml" xref="S7.E11.m1.3.3.2.2.2.4.2.3">𝑡</ci></apply></apply><ci id="S7.E11.m1.3.3.2.2.2.5.cmml" xref="S7.E11.m1.3.3.2.2.2.5">𝑞</ci><apply id="S7.E11.m1.2.2.1.1.1.1.1.1.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S7.E11.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.2">conditional</csymbol><apply id="S7.E11.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.E11.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S7.E11.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.3.2">𝜋</ci><ci id="S7.E11.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.3.3">𝑡</ci></apply><list id="S7.E11.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1"><apply id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><set id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><eq id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1"></eq><ci id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3"><minus id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S7.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S7.E11.m1.1.1.cmml" xref="S7.E11.m1.1.1">𝐱</ci></list></apply><apply id="S7.E11.m1.3.3.2.2.2.6.cmml" xref="S7.E11.m1.3.3.2.2.2.6"><log id="S7.E11.m1.3.3.2.2.2.6.1.cmml" xref="S7.E11.m1.3.3.2.2.2.6.1"></log><ci id="S7.E11.m1.3.3.2.2.2.6.2.cmml" xref="S7.E11.m1.3.3.2.2.2.6.2">𝑝</ci></apply><apply id="S7.E11.m1.3.3.2.2.2.2.1.1.cmml" xref="S7.E11.m1.3.3.2.2.2.2.1"><csymbol cd="latexml" id="S7.E11.m1.3.3.2.2.2.2.1.1.1.cmml" xref="S7.E11.m1.3.3.2.2.2.2.1.1.1">conditional</csymbol><apply id="S7.E11.m1.3.3.2.2.2.2.1.1.2.cmml" xref="S7.E11.m1.3.3.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S7.E11.m1.3.3.2.2.2.2.1.1.2.1.cmml" xref="S7.E11.m1.3.3.2.2.2.2.1.1.2">subscript</csymbol><ci id="S7.E11.m1.3.3.2.2.2.2.1.1.2.2.cmml" xref="S7.E11.m1.3.3.2.2.2.2.1.1.2.2">𝑧</ci><ci id="S7.E11.m1.3.3.2.2.2.2.1.1.2.3.cmml" xref="S7.E11.m1.3.3.2.2.2.2.1.1.2.3">𝑡</ci></apply><apply id="S7.E11.m1.3.3.2.2.2.2.1.1.3.cmml" xref="S7.E11.m1.3.3.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S7.E11.m1.3.3.2.2.2.2.1.1.3.1.cmml" xref="S7.E11.m1.3.3.2.2.2.2.1.1.3">subscript</csymbol><ci id="S7.E11.m1.3.3.2.2.2.2.1.1.3.2.cmml" xref="S7.E11.m1.3.3.2.2.2.2.1.1.3.2">𝜋</ci><ci id="S7.E11.m1.3.3.2.2.2.2.1.1.3.3.cmml" xref="S7.E11.m1.3.3.2.2.2.2.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.E11.m1.3c">\displaystyle=\sum_{t=1}^{T}\int d\pi_{t}q(\pi_{t}|\{z_{i}\}_{i=1}^{t-1},\mathbf{x})\log p(z_{t}|\pi_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div id="S7.11.p11" class="ltx_para">
<p id="S7.11.p11.1" class="ltx_p">Each integral in the sum above can be simplified as follows:</p>
<table id="S15.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S7.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S7.Ex4.m1.3" class="ltx_Math" alttext="\displaystyle\int d\pi q(\pi_{t}|\{z_{i}\}_{i=1}^{t-1},\mathbf{x})\log p(z_{t}|\pi_{t})" display="inline"><semantics id="S7.Ex4.m1.3a"><mstyle displaystyle="true" id="S7.Ex4.m1.3.3" xref="S7.Ex4.m1.3.3.cmml"><mrow id="S7.Ex4.m1.3.3a" xref="S7.Ex4.m1.3.3.cmml"><mo id="S7.Ex4.m1.3.3.3" xref="S7.Ex4.m1.3.3.3.cmml">∫</mo><mrow id="S7.Ex4.m1.3.3.2" xref="S7.Ex4.m1.3.3.2.cmml"><mrow id="S7.Ex4.m1.3.3.2.4" xref="S7.Ex4.m1.3.3.2.4.cmml"><mo lspace="0em" rspace="0em" id="S7.Ex4.m1.3.3.2.4.1" xref="S7.Ex4.m1.3.3.2.4.1.cmml">𝑑</mo><mi id="S7.Ex4.m1.3.3.2.4.2" xref="S7.Ex4.m1.3.3.2.4.2.cmml">π</mi></mrow><mo lspace="0em" rspace="0em" id="S7.Ex4.m1.3.3.2.3" xref="S7.Ex4.m1.3.3.2.3.cmml">​</mo><mi id="S7.Ex4.m1.3.3.2.5" xref="S7.Ex4.m1.3.3.2.5.cmml">q</mi><mo lspace="0em" rspace="0em" id="S7.Ex4.m1.3.3.2.3a" xref="S7.Ex4.m1.3.3.2.3.cmml">​</mo><mrow id="S7.Ex4.m1.2.2.1.1.1" xref="S7.Ex4.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S7.Ex4.m1.2.2.1.1.1.2" xref="S7.Ex4.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S7.Ex4.m1.2.2.1.1.1.1" xref="S7.Ex4.m1.2.2.1.1.1.1.cmml"><msub id="S7.Ex4.m1.2.2.1.1.1.1.3" xref="S7.Ex4.m1.2.2.1.1.1.1.3.cmml"><mi id="S7.Ex4.m1.2.2.1.1.1.1.3.2" xref="S7.Ex4.m1.2.2.1.1.1.1.3.2.cmml">π</mi><mi id="S7.Ex4.m1.2.2.1.1.1.1.3.3" xref="S7.Ex4.m1.2.2.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S7.Ex4.m1.2.2.1.1.1.1.2" xref="S7.Ex4.m1.2.2.1.1.1.1.2.cmml">|</mo><mrow id="S7.Ex4.m1.2.2.1.1.1.1.1.1" xref="S7.Ex4.m1.2.2.1.1.1.1.1.2.cmml"><msubsup id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.1" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.1" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S7.Ex4.m1.2.2.1.1.1.1.1.1.2" xref="S7.Ex4.m1.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="S7.Ex4.m1.1.1" xref="S7.Ex4.m1.1.1.cmml">𝐱</mi></mrow></mrow><mo stretchy="false" id="S7.Ex4.m1.2.2.1.1.1.3" xref="S7.Ex4.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S7.Ex4.m1.3.3.2.3b" xref="S7.Ex4.m1.3.3.2.3.cmml">​</mo><mrow id="S7.Ex4.m1.3.3.2.6" xref="S7.Ex4.m1.3.3.2.6.cmml"><mi id="S7.Ex4.m1.3.3.2.6.1" xref="S7.Ex4.m1.3.3.2.6.1.cmml">log</mi><mo lspace="0.167em" id="S7.Ex4.m1.3.3.2.6a" xref="S7.Ex4.m1.3.3.2.6.cmml">⁡</mo><mi id="S7.Ex4.m1.3.3.2.6.2" xref="S7.Ex4.m1.3.3.2.6.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.Ex4.m1.3.3.2.3c" xref="S7.Ex4.m1.3.3.2.3.cmml">​</mo><mrow id="S7.Ex4.m1.3.3.2.2.1" xref="S7.Ex4.m1.3.3.2.2.1.1.cmml"><mo stretchy="false" id="S7.Ex4.m1.3.3.2.2.1.2" xref="S7.Ex4.m1.3.3.2.2.1.1.cmml">(</mo><mrow id="S7.Ex4.m1.3.3.2.2.1.1" xref="S7.Ex4.m1.3.3.2.2.1.1.cmml"><msub id="S7.Ex4.m1.3.3.2.2.1.1.2" xref="S7.Ex4.m1.3.3.2.2.1.1.2.cmml"><mi id="S7.Ex4.m1.3.3.2.2.1.1.2.2" xref="S7.Ex4.m1.3.3.2.2.1.1.2.2.cmml">z</mi><mi id="S7.Ex4.m1.3.3.2.2.1.1.2.3" xref="S7.Ex4.m1.3.3.2.2.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S7.Ex4.m1.3.3.2.2.1.1.1" xref="S7.Ex4.m1.3.3.2.2.1.1.1.cmml">|</mo><msub id="S7.Ex4.m1.3.3.2.2.1.1.3" xref="S7.Ex4.m1.3.3.2.2.1.1.3.cmml"><mi id="S7.Ex4.m1.3.3.2.2.1.1.3.2" xref="S7.Ex4.m1.3.3.2.2.1.1.3.2.cmml">π</mi><mi id="S7.Ex4.m1.3.3.2.2.1.1.3.3" xref="S7.Ex4.m1.3.3.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S7.Ex4.m1.3.3.2.2.1.3" xref="S7.Ex4.m1.3.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mstyle><annotation-xml encoding="MathML-Content" id="S7.Ex4.m1.3b"><apply id="S7.Ex4.m1.3.3.cmml" xref="S7.Ex4.m1.3.3"><int id="S7.Ex4.m1.3.3.3.cmml" xref="S7.Ex4.m1.3.3.3"></int><apply id="S7.Ex4.m1.3.3.2.cmml" xref="S7.Ex4.m1.3.3.2"><times id="S7.Ex4.m1.3.3.2.3.cmml" xref="S7.Ex4.m1.3.3.2.3"></times><apply id="S7.Ex4.m1.3.3.2.4.cmml" xref="S7.Ex4.m1.3.3.2.4"><csymbol cd="latexml" id="S7.Ex4.m1.3.3.2.4.1.cmml" xref="S7.Ex4.m1.3.3.2.4.1">differential-d</csymbol><ci id="S7.Ex4.m1.3.3.2.4.2.cmml" xref="S7.Ex4.m1.3.3.2.4.2">𝜋</ci></apply><ci id="S7.Ex4.m1.3.3.2.5.cmml" xref="S7.Ex4.m1.3.3.2.5">𝑞</ci><apply id="S7.Ex4.m1.2.2.1.1.1.1.cmml" xref="S7.Ex4.m1.2.2.1.1.1"><csymbol cd="latexml" id="S7.Ex4.m1.2.2.1.1.1.1.2.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.2">conditional</csymbol><apply id="S7.Ex4.m1.2.2.1.1.1.1.3.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex4.m1.2.2.1.1.1.1.3.1.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex4.m1.2.2.1.1.1.1.3.2.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.3.2">𝜋</ci><ci id="S7.Ex4.m1.2.2.1.1.1.1.3.3.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.3.3">𝑡</ci></apply><list id="S7.Ex4.m1.2.2.1.1.1.1.1.2.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1"><apply id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><set id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1"><apply id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3"><eq id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.1"></eq><ci id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3"><minus id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.1"></minus><ci id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S7.Ex4.m1.2.2.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S7.Ex4.m1.1.1.cmml" xref="S7.Ex4.m1.1.1">𝐱</ci></list></apply><apply id="S7.Ex4.m1.3.3.2.6.cmml" xref="S7.Ex4.m1.3.3.2.6"><log id="S7.Ex4.m1.3.3.2.6.1.cmml" xref="S7.Ex4.m1.3.3.2.6.1"></log><ci id="S7.Ex4.m1.3.3.2.6.2.cmml" xref="S7.Ex4.m1.3.3.2.6.2">𝑝</ci></apply><apply id="S7.Ex4.m1.3.3.2.2.1.1.cmml" xref="S7.Ex4.m1.3.3.2.2.1"><csymbol cd="latexml" id="S7.Ex4.m1.3.3.2.2.1.1.1.cmml" xref="S7.Ex4.m1.3.3.2.2.1.1.1">conditional</csymbol><apply id="S7.Ex4.m1.3.3.2.2.1.1.2.cmml" xref="S7.Ex4.m1.3.3.2.2.1.1.2"><csymbol cd="ambiguous" id="S7.Ex4.m1.3.3.2.2.1.1.2.1.cmml" xref="S7.Ex4.m1.3.3.2.2.1.1.2">subscript</csymbol><ci id="S7.Ex4.m1.3.3.2.2.1.1.2.2.cmml" xref="S7.Ex4.m1.3.3.2.2.1.1.2.2">𝑧</ci><ci id="S7.Ex4.m1.3.3.2.2.1.1.2.3.cmml" xref="S7.Ex4.m1.3.3.2.2.1.1.2.3">𝑡</ci></apply><apply id="S7.Ex4.m1.3.3.2.2.1.1.3.cmml" xref="S7.Ex4.m1.3.3.2.2.1.1.3"><csymbol cd="ambiguous" id="S7.Ex4.m1.3.3.2.2.1.1.3.1.cmml" xref="S7.Ex4.m1.3.3.2.2.1.1.3">subscript</csymbol><ci id="S7.Ex4.m1.3.3.2.2.1.1.3.2.cmml" xref="S7.Ex4.m1.3.3.2.2.1.1.3.2">𝜋</ci><ci id="S7.Ex4.m1.3.3.2.2.1.1.3.3.cmml" xref="S7.Ex4.m1.3.3.2.2.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex4.m1.3c">\displaystyle\int d\pi q(\pi_{t}|\{z_{i}\}_{i=1}^{t-1},\mathbf{x})\log p(z_{t}|\pi_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S7.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S7.Ex5.m1.2" class="ltx_Math" alttext="\displaystyle=\int d\pi\delta(\pi_{t}-\hat{\pi}_{t})\log p(z_{t}|\pi_{t})" display="inline"><semantics id="S7.Ex5.m1.2a"><mrow id="S7.Ex5.m1.2.2" xref="S7.Ex5.m1.2.2.cmml"><mi id="S7.Ex5.m1.2.2.4" xref="S7.Ex5.m1.2.2.4.cmml"></mi><mo id="S7.Ex5.m1.2.2.3" xref="S7.Ex5.m1.2.2.3.cmml">=</mo><mstyle displaystyle="true" id="S7.Ex5.m1.2.2.2" xref="S7.Ex5.m1.2.2.2.cmml"><mrow id="S7.Ex5.m1.2.2.2a" xref="S7.Ex5.m1.2.2.2.cmml"><mo id="S7.Ex5.m1.2.2.2.3" xref="S7.Ex5.m1.2.2.2.3.cmml">∫</mo><mrow id="S7.Ex5.m1.2.2.2.2" xref="S7.Ex5.m1.2.2.2.2.cmml"><mrow id="S7.Ex5.m1.2.2.2.2.4" xref="S7.Ex5.m1.2.2.2.2.4.cmml"><mo lspace="0em" rspace="0em" id="S7.Ex5.m1.2.2.2.2.4.1" xref="S7.Ex5.m1.2.2.2.2.4.1.cmml">𝑑</mo><mi id="S7.Ex5.m1.2.2.2.2.4.2" xref="S7.Ex5.m1.2.2.2.2.4.2.cmml">π</mi></mrow><mo lspace="0em" rspace="0em" id="S7.Ex5.m1.2.2.2.2.3" xref="S7.Ex5.m1.2.2.2.2.3.cmml">​</mo><mi id="S7.Ex5.m1.2.2.2.2.5" xref="S7.Ex5.m1.2.2.2.2.5.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S7.Ex5.m1.2.2.2.2.3a" xref="S7.Ex5.m1.2.2.2.2.3.cmml">​</mo><mrow id="S7.Ex5.m1.1.1.1.1.1.1" xref="S7.Ex5.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.Ex5.m1.1.1.1.1.1.1.2" xref="S7.Ex5.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.Ex5.m1.1.1.1.1.1.1.1" xref="S7.Ex5.m1.1.1.1.1.1.1.1.cmml"><msub id="S7.Ex5.m1.1.1.1.1.1.1.1.2" xref="S7.Ex5.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S7.Ex5.m1.1.1.1.1.1.1.1.2.2" xref="S7.Ex5.m1.1.1.1.1.1.1.1.2.2.cmml">π</mi><mi id="S7.Ex5.m1.1.1.1.1.1.1.1.2.3" xref="S7.Ex5.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S7.Ex5.m1.1.1.1.1.1.1.1.1" xref="S7.Ex5.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S7.Ex5.m1.1.1.1.1.1.1.1.3" xref="S7.Ex5.m1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S7.Ex5.m1.1.1.1.1.1.1.1.3.2" xref="S7.Ex5.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S7.Ex5.m1.1.1.1.1.1.1.1.3.2.2" xref="S7.Ex5.m1.1.1.1.1.1.1.1.3.2.2.cmml">π</mi><mo id="S7.Ex5.m1.1.1.1.1.1.1.1.3.2.1" xref="S7.Ex5.m1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S7.Ex5.m1.1.1.1.1.1.1.1.3.3" xref="S7.Ex5.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S7.Ex5.m1.1.1.1.1.1.1.3" xref="S7.Ex5.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S7.Ex5.m1.2.2.2.2.3b" xref="S7.Ex5.m1.2.2.2.2.3.cmml">​</mo><mrow id="S7.Ex5.m1.2.2.2.2.6" xref="S7.Ex5.m1.2.2.2.2.6.cmml"><mi id="S7.Ex5.m1.2.2.2.2.6.1" xref="S7.Ex5.m1.2.2.2.2.6.1.cmml">log</mi><mo lspace="0.167em" id="S7.Ex5.m1.2.2.2.2.6a" xref="S7.Ex5.m1.2.2.2.2.6.cmml">⁡</mo><mi id="S7.Ex5.m1.2.2.2.2.6.2" xref="S7.Ex5.m1.2.2.2.2.6.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.Ex5.m1.2.2.2.2.3c" xref="S7.Ex5.m1.2.2.2.2.3.cmml">​</mo><mrow id="S7.Ex5.m1.2.2.2.2.2.1" xref="S7.Ex5.m1.2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S7.Ex5.m1.2.2.2.2.2.1.2" xref="S7.Ex5.m1.2.2.2.2.2.1.1.cmml">(</mo><mrow id="S7.Ex5.m1.2.2.2.2.2.1.1" xref="S7.Ex5.m1.2.2.2.2.2.1.1.cmml"><msub id="S7.Ex5.m1.2.2.2.2.2.1.1.2" xref="S7.Ex5.m1.2.2.2.2.2.1.1.2.cmml"><mi id="S7.Ex5.m1.2.2.2.2.2.1.1.2.2" xref="S7.Ex5.m1.2.2.2.2.2.1.1.2.2.cmml">z</mi><mi id="S7.Ex5.m1.2.2.2.2.2.1.1.2.3" xref="S7.Ex5.m1.2.2.2.2.2.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S7.Ex5.m1.2.2.2.2.2.1.1.1" xref="S7.Ex5.m1.2.2.2.2.2.1.1.1.cmml">|</mo><msub id="S7.Ex5.m1.2.2.2.2.2.1.1.3" xref="S7.Ex5.m1.2.2.2.2.2.1.1.3.cmml"><mi id="S7.Ex5.m1.2.2.2.2.2.1.1.3.2" xref="S7.Ex5.m1.2.2.2.2.2.1.1.3.2.cmml">π</mi><mi id="S7.Ex5.m1.2.2.2.2.2.1.1.3.3" xref="S7.Ex5.m1.2.2.2.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S7.Ex5.m1.2.2.2.2.2.1.3" xref="S7.Ex5.m1.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex5.m1.2b"><apply id="S7.Ex5.m1.2.2.cmml" xref="S7.Ex5.m1.2.2"><eq id="S7.Ex5.m1.2.2.3.cmml" xref="S7.Ex5.m1.2.2.3"></eq><csymbol cd="latexml" id="S7.Ex5.m1.2.2.4.cmml" xref="S7.Ex5.m1.2.2.4">absent</csymbol><apply id="S7.Ex5.m1.2.2.2.cmml" xref="S7.Ex5.m1.2.2.2"><int id="S7.Ex5.m1.2.2.2.3.cmml" xref="S7.Ex5.m1.2.2.2.3"></int><apply id="S7.Ex5.m1.2.2.2.2.cmml" xref="S7.Ex5.m1.2.2.2.2"><times id="S7.Ex5.m1.2.2.2.2.3.cmml" xref="S7.Ex5.m1.2.2.2.2.3"></times><apply id="S7.Ex5.m1.2.2.2.2.4.cmml" xref="S7.Ex5.m1.2.2.2.2.4"><csymbol cd="latexml" id="S7.Ex5.m1.2.2.2.2.4.1.cmml" xref="S7.Ex5.m1.2.2.2.2.4.1">differential-d</csymbol><ci id="S7.Ex5.m1.2.2.2.2.4.2.cmml" xref="S7.Ex5.m1.2.2.2.2.4.2">𝜋</ci></apply><ci id="S7.Ex5.m1.2.2.2.2.5.cmml" xref="S7.Ex5.m1.2.2.2.2.5">𝛿</ci><apply id="S7.Ex5.m1.1.1.1.1.1.1.1.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1"><minus id="S7.Ex5.m1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.1.1"></minus><apply id="S7.Ex5.m1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.Ex5.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S7.Ex5.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.1.2.2">𝜋</ci><ci id="S7.Ex5.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S7.Ex5.m1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex5.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S7.Ex5.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.1.3.2"><ci id="S7.Ex5.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S7.Ex5.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.1.3.2.2">𝜋</ci></apply><ci id="S7.Ex5.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S7.Ex5.m1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S7.Ex5.m1.2.2.2.2.6.cmml" xref="S7.Ex5.m1.2.2.2.2.6"><log id="S7.Ex5.m1.2.2.2.2.6.1.cmml" xref="S7.Ex5.m1.2.2.2.2.6.1"></log><ci id="S7.Ex5.m1.2.2.2.2.6.2.cmml" xref="S7.Ex5.m1.2.2.2.2.6.2">𝑝</ci></apply><apply id="S7.Ex5.m1.2.2.2.2.2.1.1.cmml" xref="S7.Ex5.m1.2.2.2.2.2.1"><csymbol cd="latexml" id="S7.Ex5.m1.2.2.2.2.2.1.1.1.cmml" xref="S7.Ex5.m1.2.2.2.2.2.1.1.1">conditional</csymbol><apply id="S7.Ex5.m1.2.2.2.2.2.1.1.2.cmml" xref="S7.Ex5.m1.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S7.Ex5.m1.2.2.2.2.2.1.1.2.1.cmml" xref="S7.Ex5.m1.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="S7.Ex5.m1.2.2.2.2.2.1.1.2.2.cmml" xref="S7.Ex5.m1.2.2.2.2.2.1.1.2.2">𝑧</ci><ci id="S7.Ex5.m1.2.2.2.2.2.1.1.2.3.cmml" xref="S7.Ex5.m1.2.2.2.2.2.1.1.2.3">𝑡</ci></apply><apply id="S7.Ex5.m1.2.2.2.2.2.1.1.3.cmml" xref="S7.Ex5.m1.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S7.Ex5.m1.2.2.2.2.2.1.1.3.1.cmml" xref="S7.Ex5.m1.2.2.2.2.2.1.1.3">subscript</csymbol><ci id="S7.Ex5.m1.2.2.2.2.2.1.1.3.2.cmml" xref="S7.Ex5.m1.2.2.2.2.2.1.1.3.2">𝜋</ci><ci id="S7.Ex5.m1.2.2.2.2.2.1.1.3.3.cmml" xref="S7.Ex5.m1.2.2.2.2.2.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex5.m1.2c">\displaystyle=\int d\pi\delta(\pi_{t}-\hat{\pi}_{t})\log p(z_{t}|\pi_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S7.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S7.Ex6.m1.1" class="ltx_Math" alttext="\displaystyle=\log p(z_{t}|\hat{\pi}_{t})" display="inline"><semantics id="S7.Ex6.m1.1a"><mrow id="S7.Ex6.m1.1.1" xref="S7.Ex6.m1.1.1.cmml"><mi id="S7.Ex6.m1.1.1.3" xref="S7.Ex6.m1.1.1.3.cmml"></mi><mo id="S7.Ex6.m1.1.1.2" xref="S7.Ex6.m1.1.1.2.cmml">=</mo><mrow id="S7.Ex6.m1.1.1.1" xref="S7.Ex6.m1.1.1.1.cmml"><mrow id="S7.Ex6.m1.1.1.1.3" xref="S7.Ex6.m1.1.1.1.3.cmml"><mi id="S7.Ex6.m1.1.1.1.3.1" xref="S7.Ex6.m1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S7.Ex6.m1.1.1.1.3a" xref="S7.Ex6.m1.1.1.1.3.cmml">⁡</mo><mi id="S7.Ex6.m1.1.1.1.3.2" xref="S7.Ex6.m1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S7.Ex6.m1.1.1.1.2" xref="S7.Ex6.m1.1.1.1.2.cmml">​</mo><mrow id="S7.Ex6.m1.1.1.1.1.1" xref="S7.Ex6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.Ex6.m1.1.1.1.1.1.2" xref="S7.Ex6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.Ex6.m1.1.1.1.1.1.1" xref="S7.Ex6.m1.1.1.1.1.1.1.cmml"><msub id="S7.Ex6.m1.1.1.1.1.1.1.2" xref="S7.Ex6.m1.1.1.1.1.1.1.2.cmml"><mi id="S7.Ex6.m1.1.1.1.1.1.1.2.2" xref="S7.Ex6.m1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S7.Ex6.m1.1.1.1.1.1.1.2.3" xref="S7.Ex6.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S7.Ex6.m1.1.1.1.1.1.1.1" xref="S7.Ex6.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S7.Ex6.m1.1.1.1.1.1.1.3" xref="S7.Ex6.m1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S7.Ex6.m1.1.1.1.1.1.1.3.2" xref="S7.Ex6.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S7.Ex6.m1.1.1.1.1.1.1.3.2.2" xref="S7.Ex6.m1.1.1.1.1.1.1.3.2.2.cmml">π</mi><mo id="S7.Ex6.m1.1.1.1.1.1.1.3.2.1" xref="S7.Ex6.m1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S7.Ex6.m1.1.1.1.1.1.1.3.3" xref="S7.Ex6.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S7.Ex6.m1.1.1.1.1.1.3" xref="S7.Ex6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex6.m1.1b"><apply id="S7.Ex6.m1.1.1.cmml" xref="S7.Ex6.m1.1.1"><eq id="S7.Ex6.m1.1.1.2.cmml" xref="S7.Ex6.m1.1.1.2"></eq><csymbol cd="latexml" id="S7.Ex6.m1.1.1.3.cmml" xref="S7.Ex6.m1.1.1.3">absent</csymbol><apply id="S7.Ex6.m1.1.1.1.cmml" xref="S7.Ex6.m1.1.1.1"><times id="S7.Ex6.m1.1.1.1.2.cmml" xref="S7.Ex6.m1.1.1.1.2"></times><apply id="S7.Ex6.m1.1.1.1.3.cmml" xref="S7.Ex6.m1.1.1.1.3"><log id="S7.Ex6.m1.1.1.1.3.1.cmml" xref="S7.Ex6.m1.1.1.1.3.1"></log><ci id="S7.Ex6.m1.1.1.1.3.2.cmml" xref="S7.Ex6.m1.1.1.1.3.2">𝑝</ci></apply><apply id="S7.Ex6.m1.1.1.1.1.1.1.cmml" xref="S7.Ex6.m1.1.1.1.1.1"><csymbol cd="latexml" id="S7.Ex6.m1.1.1.1.1.1.1.1.cmml" xref="S7.Ex6.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S7.Ex6.m1.1.1.1.1.1.1.2.cmml" xref="S7.Ex6.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S7.Ex6.m1.1.1.1.1.1.1.2.1.cmml" xref="S7.Ex6.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S7.Ex6.m1.1.1.1.1.1.1.2.2.cmml" xref="S7.Ex6.m1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S7.Ex6.m1.1.1.1.1.1.1.2.3.cmml" xref="S7.Ex6.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S7.Ex6.m1.1.1.1.1.1.1.3.cmml" xref="S7.Ex6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex6.m1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex6.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S7.Ex6.m1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex6.m1.1.1.1.1.1.1.3.2"><ci id="S7.Ex6.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S7.Ex6.m1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S7.Ex6.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S7.Ex6.m1.1.1.1.1.1.1.3.2.2">𝜋</ci></apply><ci id="S7.Ex6.m1.1.1.1.1.1.1.3.3.cmml" xref="S7.Ex6.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex6.m1.1c">\displaystyle=\log p(z_{t}|\hat{\pi}_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S7.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S7.Ex7.m1.2" class="ltx_Math" alttext="\displaystyle=\log q_{\phi}(z_{t}|\{z_{i}\}_{i=1}^{t-1},\mathbf{x})\texttt{ [by definition]}" display="inline"><semantics id="S7.Ex7.m1.2a"><mrow id="S7.Ex7.m1.2.2" xref="S7.Ex7.m1.2.2.cmml"><mi id="S7.Ex7.m1.2.2.3" xref="S7.Ex7.m1.2.2.3.cmml"></mi><mo id="S7.Ex7.m1.2.2.2" xref="S7.Ex7.m1.2.2.2.cmml">=</mo><mrow id="S7.Ex7.m1.2.2.1" xref="S7.Ex7.m1.2.2.1.cmml"><mrow id="S7.Ex7.m1.2.2.1.3" xref="S7.Ex7.m1.2.2.1.3.cmml"><mi id="S7.Ex7.m1.2.2.1.3.1" xref="S7.Ex7.m1.2.2.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S7.Ex7.m1.2.2.1.3a" xref="S7.Ex7.m1.2.2.1.3.cmml">⁡</mo><msub id="S7.Ex7.m1.2.2.1.3.2" xref="S7.Ex7.m1.2.2.1.3.2.cmml"><mi id="S7.Ex7.m1.2.2.1.3.2.2" xref="S7.Ex7.m1.2.2.1.3.2.2.cmml">q</mi><mi id="S7.Ex7.m1.2.2.1.3.2.3" xref="S7.Ex7.m1.2.2.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S7.Ex7.m1.2.2.1.2" xref="S7.Ex7.m1.2.2.1.2.cmml">​</mo><mrow id="S7.Ex7.m1.2.2.1.1.1" xref="S7.Ex7.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S7.Ex7.m1.2.2.1.1.1.2" xref="S7.Ex7.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S7.Ex7.m1.2.2.1.1.1.1" xref="S7.Ex7.m1.2.2.1.1.1.1.cmml"><msub id="S7.Ex7.m1.2.2.1.1.1.1.3" xref="S7.Ex7.m1.2.2.1.1.1.1.3.cmml"><mi id="S7.Ex7.m1.2.2.1.1.1.1.3.2" xref="S7.Ex7.m1.2.2.1.1.1.1.3.2.cmml">z</mi><mi id="S7.Ex7.m1.2.2.1.1.1.1.3.3" xref="S7.Ex7.m1.2.2.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S7.Ex7.m1.2.2.1.1.1.1.2" xref="S7.Ex7.m1.2.2.1.1.1.1.2.cmml">|</mo><mrow id="S7.Ex7.m1.2.2.1.1.1.1.1.1" xref="S7.Ex7.m1.2.2.1.1.1.1.1.2.cmml"><msubsup id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.1" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.1" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S7.Ex7.m1.2.2.1.1.1.1.1.1.2" xref="S7.Ex7.m1.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="S7.Ex7.m1.1.1" xref="S7.Ex7.m1.1.1.cmml">𝐱</mi></mrow></mrow><mo stretchy="false" id="S7.Ex7.m1.2.2.1.1.1.3" xref="S7.Ex7.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S7.Ex7.m1.2.2.1.2a" xref="S7.Ex7.m1.2.2.1.2.cmml">​</mo><mtext class="ltx_mathvariant_monospace" id="S7.Ex7.m1.2.2.1.4" xref="S7.Ex7.m1.2.2.1.4a.cmml"> [by definition]</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex7.m1.2b"><apply id="S7.Ex7.m1.2.2.cmml" xref="S7.Ex7.m1.2.2"><eq id="S7.Ex7.m1.2.2.2.cmml" xref="S7.Ex7.m1.2.2.2"></eq><csymbol cd="latexml" id="S7.Ex7.m1.2.2.3.cmml" xref="S7.Ex7.m1.2.2.3">absent</csymbol><apply id="S7.Ex7.m1.2.2.1.cmml" xref="S7.Ex7.m1.2.2.1"><times id="S7.Ex7.m1.2.2.1.2.cmml" xref="S7.Ex7.m1.2.2.1.2"></times><apply id="S7.Ex7.m1.2.2.1.3.cmml" xref="S7.Ex7.m1.2.2.1.3"><log id="S7.Ex7.m1.2.2.1.3.1.cmml" xref="S7.Ex7.m1.2.2.1.3.1"></log><apply id="S7.Ex7.m1.2.2.1.3.2.cmml" xref="S7.Ex7.m1.2.2.1.3.2"><csymbol cd="ambiguous" id="S7.Ex7.m1.2.2.1.3.2.1.cmml" xref="S7.Ex7.m1.2.2.1.3.2">subscript</csymbol><ci id="S7.Ex7.m1.2.2.1.3.2.2.cmml" xref="S7.Ex7.m1.2.2.1.3.2.2">𝑞</ci><ci id="S7.Ex7.m1.2.2.1.3.2.3.cmml" xref="S7.Ex7.m1.2.2.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S7.Ex7.m1.2.2.1.1.1.1.cmml" xref="S7.Ex7.m1.2.2.1.1.1"><csymbol cd="latexml" id="S7.Ex7.m1.2.2.1.1.1.1.2.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.2">conditional</csymbol><apply id="S7.Ex7.m1.2.2.1.1.1.1.3.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex7.m1.2.2.1.1.1.1.3.1.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex7.m1.2.2.1.1.1.1.3.2.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.3.2">𝑧</ci><ci id="S7.Ex7.m1.2.2.1.1.1.1.3.3.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.3.3">𝑡</ci></apply><list id="S7.Ex7.m1.2.2.1.1.1.1.1.2.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1"><apply id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><set id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1"><apply id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3"><eq id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.1"></eq><ci id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3"><minus id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.1"></minus><ci id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S7.Ex7.m1.2.2.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S7.Ex7.m1.1.1.cmml" xref="S7.Ex7.m1.1.1">𝐱</ci></list></apply><ci id="S7.Ex7.m1.2.2.1.4a.cmml" xref="S7.Ex7.m1.2.2.1.4"><mtext class="ltx_mathvariant_monospace" id="S7.Ex7.m1.2.2.1.4.cmml" xref="S7.Ex7.m1.2.2.1.4"> [by definition]</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex7.m1.2c">\displaystyle=\log q_{\phi}(z_{t}|\{z_{i}\}_{i=1}^{t-1},\mathbf{x})\texttt{ [by definition]}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S7.12.p12" class="ltx_para">
<p id="S7.12.p12.1" class="ltx_p">Substituting into <a href="#S7.E10" title="In Proof. ‣ 7 A variational lower bound on the evidence for sequential latent variable models ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">10</span></a>, we get:</p>
<table id="S15.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S7.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S7.Ex8.m1.3" class="ltx_Math" alttext="\displaystyle\sum_{t=1}^{T}\int d\pi_{t}q(\pi_{t}|\{z_{i}\}_{i=1}^{t-1},\mathbf{x})\log p_{\sigma}(z_{t}|\pi_{t})" display="inline"><semantics id="S7.Ex8.m1.3a"><mrow id="S7.Ex8.m1.3.3" xref="S7.Ex8.m1.3.3.cmml"><mstyle displaystyle="true" id="S7.Ex8.m1.3.3.3" xref="S7.Ex8.m1.3.3.3.cmml"><munderover id="S7.Ex8.m1.3.3.3a" xref="S7.Ex8.m1.3.3.3.cmml"><mo movablelimits="false" id="S7.Ex8.m1.3.3.3.2.2" xref="S7.Ex8.m1.3.3.3.2.2.cmml">∑</mo><mrow id="S7.Ex8.m1.3.3.3.2.3" xref="S7.Ex8.m1.3.3.3.2.3.cmml"><mi id="S7.Ex8.m1.3.3.3.2.3.2" xref="S7.Ex8.m1.3.3.3.2.3.2.cmml">t</mi><mo id="S7.Ex8.m1.3.3.3.2.3.1" xref="S7.Ex8.m1.3.3.3.2.3.1.cmml">=</mo><mn id="S7.Ex8.m1.3.3.3.2.3.3" xref="S7.Ex8.m1.3.3.3.2.3.3.cmml">1</mn></mrow><mi id="S7.Ex8.m1.3.3.3.3" xref="S7.Ex8.m1.3.3.3.3.cmml">T</mi></munderover></mstyle><mstyle displaystyle="true" id="S7.Ex8.m1.3.3.2" xref="S7.Ex8.m1.3.3.2.cmml"><mrow id="S7.Ex8.m1.3.3.2a" xref="S7.Ex8.m1.3.3.2.cmml"><mo id="S7.Ex8.m1.3.3.2.3" xref="S7.Ex8.m1.3.3.2.3.cmml">∫</mo><mrow id="S7.Ex8.m1.3.3.2.2" xref="S7.Ex8.m1.3.3.2.2.cmml"><mrow id="S7.Ex8.m1.3.3.2.2.4" xref="S7.Ex8.m1.3.3.2.2.4.cmml"><mo lspace="0em" rspace="0em" id="S7.Ex8.m1.3.3.2.2.4.1" xref="S7.Ex8.m1.3.3.2.2.4.1.cmml">𝑑</mo><msub id="S7.Ex8.m1.3.3.2.2.4.2" xref="S7.Ex8.m1.3.3.2.2.4.2.cmml"><mi id="S7.Ex8.m1.3.3.2.2.4.2.2" xref="S7.Ex8.m1.3.3.2.2.4.2.2.cmml">π</mi><mi id="S7.Ex8.m1.3.3.2.2.4.2.3" xref="S7.Ex8.m1.3.3.2.2.4.2.3.cmml">t</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S7.Ex8.m1.3.3.2.2.3" xref="S7.Ex8.m1.3.3.2.2.3.cmml">​</mo><mi id="S7.Ex8.m1.3.3.2.2.5" xref="S7.Ex8.m1.3.3.2.2.5.cmml">q</mi><mo lspace="0em" rspace="0em" id="S7.Ex8.m1.3.3.2.2.3a" xref="S7.Ex8.m1.3.3.2.2.3.cmml">​</mo><mrow id="S7.Ex8.m1.2.2.1.1.1.1" xref="S7.Ex8.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.Ex8.m1.2.2.1.1.1.1.2" xref="S7.Ex8.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S7.Ex8.m1.2.2.1.1.1.1.1" xref="S7.Ex8.m1.2.2.1.1.1.1.1.cmml"><msub id="S7.Ex8.m1.2.2.1.1.1.1.1.3" xref="S7.Ex8.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S7.Ex8.m1.2.2.1.1.1.1.1.3.2" xref="S7.Ex8.m1.2.2.1.1.1.1.1.3.2.cmml">π</mi><mi id="S7.Ex8.m1.2.2.1.1.1.1.1.3.3" xref="S7.Ex8.m1.2.2.1.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S7.Ex8.m1.2.2.1.1.1.1.1.2" xref="S7.Ex8.m1.2.2.1.1.1.1.1.2.cmml">|</mo><mrow id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.2.cmml"><msubsup id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.1" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.2" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.2.cmml">,</mo><mi id="S7.Ex8.m1.1.1" xref="S7.Ex8.m1.1.1.cmml">𝐱</mi></mrow></mrow><mo stretchy="false" id="S7.Ex8.m1.2.2.1.1.1.1.3" xref="S7.Ex8.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S7.Ex8.m1.3.3.2.2.3b" xref="S7.Ex8.m1.3.3.2.2.3.cmml">​</mo><mrow id="S7.Ex8.m1.3.3.2.2.6" xref="S7.Ex8.m1.3.3.2.2.6.cmml"><mi id="S7.Ex8.m1.3.3.2.2.6.1" xref="S7.Ex8.m1.3.3.2.2.6.1.cmml">log</mi><mo lspace="0.167em" id="S7.Ex8.m1.3.3.2.2.6a" xref="S7.Ex8.m1.3.3.2.2.6.cmml">⁡</mo><msub id="S7.Ex8.m1.3.3.2.2.6.2" xref="S7.Ex8.m1.3.3.2.2.6.2.cmml"><mi id="S7.Ex8.m1.3.3.2.2.6.2.2" xref="S7.Ex8.m1.3.3.2.2.6.2.2.cmml">p</mi><mi id="S7.Ex8.m1.3.3.2.2.6.2.3" xref="S7.Ex8.m1.3.3.2.2.6.2.3.cmml">σ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S7.Ex8.m1.3.3.2.2.3c" xref="S7.Ex8.m1.3.3.2.2.3.cmml">​</mo><mrow id="S7.Ex8.m1.3.3.2.2.2.1" xref="S7.Ex8.m1.3.3.2.2.2.1.1.cmml"><mo stretchy="false" id="S7.Ex8.m1.3.3.2.2.2.1.2" xref="S7.Ex8.m1.3.3.2.2.2.1.1.cmml">(</mo><mrow id="S7.Ex8.m1.3.3.2.2.2.1.1" xref="S7.Ex8.m1.3.3.2.2.2.1.1.cmml"><msub id="S7.Ex8.m1.3.3.2.2.2.1.1.2" xref="S7.Ex8.m1.3.3.2.2.2.1.1.2.cmml"><mi id="S7.Ex8.m1.3.3.2.2.2.1.1.2.2" xref="S7.Ex8.m1.3.3.2.2.2.1.1.2.2.cmml">z</mi><mi id="S7.Ex8.m1.3.3.2.2.2.1.1.2.3" xref="S7.Ex8.m1.3.3.2.2.2.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S7.Ex8.m1.3.3.2.2.2.1.1.1" xref="S7.Ex8.m1.3.3.2.2.2.1.1.1.cmml">|</mo><msub id="S7.Ex8.m1.3.3.2.2.2.1.1.3" xref="S7.Ex8.m1.3.3.2.2.2.1.1.3.cmml"><mi id="S7.Ex8.m1.3.3.2.2.2.1.1.3.2" xref="S7.Ex8.m1.3.3.2.2.2.1.1.3.2.cmml">π</mi><mi id="S7.Ex8.m1.3.3.2.2.2.1.1.3.3" xref="S7.Ex8.m1.3.3.2.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S7.Ex8.m1.3.3.2.2.2.1.3" xref="S7.Ex8.m1.3.3.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex8.m1.3b"><apply id="S7.Ex8.m1.3.3.cmml" xref="S7.Ex8.m1.3.3"><apply id="S7.Ex8.m1.3.3.3.cmml" xref="S7.Ex8.m1.3.3.3"><csymbol cd="ambiguous" id="S7.Ex8.m1.3.3.3.1.cmml" xref="S7.Ex8.m1.3.3.3">superscript</csymbol><apply id="S7.Ex8.m1.3.3.3.2.cmml" xref="S7.Ex8.m1.3.3.3"><csymbol cd="ambiguous" id="S7.Ex8.m1.3.3.3.2.1.cmml" xref="S7.Ex8.m1.3.3.3">subscript</csymbol><sum id="S7.Ex8.m1.3.3.3.2.2.cmml" xref="S7.Ex8.m1.3.3.3.2.2"></sum><apply id="S7.Ex8.m1.3.3.3.2.3.cmml" xref="S7.Ex8.m1.3.3.3.2.3"><eq id="S7.Ex8.m1.3.3.3.2.3.1.cmml" xref="S7.Ex8.m1.3.3.3.2.3.1"></eq><ci id="S7.Ex8.m1.3.3.3.2.3.2.cmml" xref="S7.Ex8.m1.3.3.3.2.3.2">𝑡</ci><cn type="integer" id="S7.Ex8.m1.3.3.3.2.3.3.cmml" xref="S7.Ex8.m1.3.3.3.2.3.3">1</cn></apply></apply><ci id="S7.Ex8.m1.3.3.3.3.cmml" xref="S7.Ex8.m1.3.3.3.3">𝑇</ci></apply><apply id="S7.Ex8.m1.3.3.2.cmml" xref="S7.Ex8.m1.3.3.2"><int id="S7.Ex8.m1.3.3.2.3.cmml" xref="S7.Ex8.m1.3.3.2.3"></int><apply id="S7.Ex8.m1.3.3.2.2.cmml" xref="S7.Ex8.m1.3.3.2.2"><times id="S7.Ex8.m1.3.3.2.2.3.cmml" xref="S7.Ex8.m1.3.3.2.2.3"></times><apply id="S7.Ex8.m1.3.3.2.2.4.cmml" xref="S7.Ex8.m1.3.3.2.2.4"><csymbol cd="latexml" id="S7.Ex8.m1.3.3.2.2.4.1.cmml" xref="S7.Ex8.m1.3.3.2.2.4.1">differential-d</csymbol><apply id="S7.Ex8.m1.3.3.2.2.4.2.cmml" xref="S7.Ex8.m1.3.3.2.2.4.2"><csymbol cd="ambiguous" id="S7.Ex8.m1.3.3.2.2.4.2.1.cmml" xref="S7.Ex8.m1.3.3.2.2.4.2">subscript</csymbol><ci id="S7.Ex8.m1.3.3.2.2.4.2.2.cmml" xref="S7.Ex8.m1.3.3.2.2.4.2.2">𝜋</ci><ci id="S7.Ex8.m1.3.3.2.2.4.2.3.cmml" xref="S7.Ex8.m1.3.3.2.2.4.2.3">𝑡</ci></apply></apply><ci id="S7.Ex8.m1.3.3.2.2.5.cmml" xref="S7.Ex8.m1.3.3.2.2.5">𝑞</ci><apply id="S7.Ex8.m1.2.2.1.1.1.1.1.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S7.Ex8.m1.2.2.1.1.1.1.1.2.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.2">conditional</csymbol><apply id="S7.Ex8.m1.2.2.1.1.1.1.1.3.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex8.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex8.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.3.2">𝜋</ci><ci id="S7.Ex8.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.3.3">𝑡</ci></apply><list id="S7.Ex8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1"><apply id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><set id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><apply id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3"><eq id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.1"></eq><ci id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3"><minus id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S7.Ex8.m1.2.2.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S7.Ex8.m1.1.1.cmml" xref="S7.Ex8.m1.1.1">𝐱</ci></list></apply><apply id="S7.Ex8.m1.3.3.2.2.6.cmml" xref="S7.Ex8.m1.3.3.2.2.6"><log id="S7.Ex8.m1.3.3.2.2.6.1.cmml" xref="S7.Ex8.m1.3.3.2.2.6.1"></log><apply id="S7.Ex8.m1.3.3.2.2.6.2.cmml" xref="S7.Ex8.m1.3.3.2.2.6.2"><csymbol cd="ambiguous" id="S7.Ex8.m1.3.3.2.2.6.2.1.cmml" xref="S7.Ex8.m1.3.3.2.2.6.2">subscript</csymbol><ci id="S7.Ex8.m1.3.3.2.2.6.2.2.cmml" xref="S7.Ex8.m1.3.3.2.2.6.2.2">𝑝</ci><ci id="S7.Ex8.m1.3.3.2.2.6.2.3.cmml" xref="S7.Ex8.m1.3.3.2.2.6.2.3">𝜎</ci></apply></apply><apply id="S7.Ex8.m1.3.3.2.2.2.1.1.cmml" xref="S7.Ex8.m1.3.3.2.2.2.1"><csymbol cd="latexml" id="S7.Ex8.m1.3.3.2.2.2.1.1.1.cmml" xref="S7.Ex8.m1.3.3.2.2.2.1.1.1">conditional</csymbol><apply id="S7.Ex8.m1.3.3.2.2.2.1.1.2.cmml" xref="S7.Ex8.m1.3.3.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S7.Ex8.m1.3.3.2.2.2.1.1.2.1.cmml" xref="S7.Ex8.m1.3.3.2.2.2.1.1.2">subscript</csymbol><ci id="S7.Ex8.m1.3.3.2.2.2.1.1.2.2.cmml" xref="S7.Ex8.m1.3.3.2.2.2.1.1.2.2">𝑧</ci><ci id="S7.Ex8.m1.3.3.2.2.2.1.1.2.3.cmml" xref="S7.Ex8.m1.3.3.2.2.2.1.1.2.3">𝑡</ci></apply><apply id="S7.Ex8.m1.3.3.2.2.2.1.1.3.cmml" xref="S7.Ex8.m1.3.3.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S7.Ex8.m1.3.3.2.2.2.1.1.3.1.cmml" xref="S7.Ex8.m1.3.3.2.2.2.1.1.3">subscript</csymbol><ci id="S7.Ex8.m1.3.3.2.2.2.1.1.3.2.cmml" xref="S7.Ex8.m1.3.3.2.2.2.1.1.3.2">𝜋</ci><ci id="S7.Ex8.m1.3.3.2.2.2.1.1.3.3.cmml" xref="S7.Ex8.m1.3.3.2.2.2.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex8.m1.3c">\displaystyle\sum_{t=1}^{T}\int d\pi_{t}q(\pi_{t}|\{z_{i}\}_{i=1}^{t-1},\mathbf{x})\log p_{\sigma}(z_{t}|\pi_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S7.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S7.Ex9.m1.2" class="ltx_Math" alttext="\displaystyle=\sum_{t=1}^{T}\log q_{\phi}(z_{t}|\{z_{i}\}_{i=1}^{t-1},\mathbf{x})" display="inline"><semantics id="S7.Ex9.m1.2a"><mrow id="S7.Ex9.m1.2.2" xref="S7.Ex9.m1.2.2.cmml"><mi id="S7.Ex9.m1.2.2.3" xref="S7.Ex9.m1.2.2.3.cmml"></mi><mo id="S7.Ex9.m1.2.2.2" xref="S7.Ex9.m1.2.2.2.cmml">=</mo><mrow id="S7.Ex9.m1.2.2.1" xref="S7.Ex9.m1.2.2.1.cmml"><mstyle displaystyle="true" id="S7.Ex9.m1.2.2.1.2" xref="S7.Ex9.m1.2.2.1.2.cmml"><munderover id="S7.Ex9.m1.2.2.1.2a" xref="S7.Ex9.m1.2.2.1.2.cmml"><mo movablelimits="false" id="S7.Ex9.m1.2.2.1.2.2.2" xref="S7.Ex9.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="S7.Ex9.m1.2.2.1.2.2.3" xref="S7.Ex9.m1.2.2.1.2.2.3.cmml"><mi id="S7.Ex9.m1.2.2.1.2.2.3.2" xref="S7.Ex9.m1.2.2.1.2.2.3.2.cmml">t</mi><mo id="S7.Ex9.m1.2.2.1.2.2.3.1" xref="S7.Ex9.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="S7.Ex9.m1.2.2.1.2.2.3.3" xref="S7.Ex9.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S7.Ex9.m1.2.2.1.2.3" xref="S7.Ex9.m1.2.2.1.2.3.cmml">T</mi></munderover></mstyle><mrow id="S7.Ex9.m1.2.2.1.1" xref="S7.Ex9.m1.2.2.1.1.cmml"><mrow id="S7.Ex9.m1.2.2.1.1.3" xref="S7.Ex9.m1.2.2.1.1.3.cmml"><mi id="S7.Ex9.m1.2.2.1.1.3.1" xref="S7.Ex9.m1.2.2.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S7.Ex9.m1.2.2.1.1.3a" xref="S7.Ex9.m1.2.2.1.1.3.cmml">⁡</mo><msub id="S7.Ex9.m1.2.2.1.1.3.2" xref="S7.Ex9.m1.2.2.1.1.3.2.cmml"><mi id="S7.Ex9.m1.2.2.1.1.3.2.2" xref="S7.Ex9.m1.2.2.1.1.3.2.2.cmml">q</mi><mi id="S7.Ex9.m1.2.2.1.1.3.2.3" xref="S7.Ex9.m1.2.2.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S7.Ex9.m1.2.2.1.1.2" xref="S7.Ex9.m1.2.2.1.1.2.cmml">​</mo><mrow id="S7.Ex9.m1.2.2.1.1.1.1" xref="S7.Ex9.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.Ex9.m1.2.2.1.1.1.1.2" xref="S7.Ex9.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S7.Ex9.m1.2.2.1.1.1.1.1" xref="S7.Ex9.m1.2.2.1.1.1.1.1.cmml"><msub id="S7.Ex9.m1.2.2.1.1.1.1.1.3" xref="S7.Ex9.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S7.Ex9.m1.2.2.1.1.1.1.1.3.2" xref="S7.Ex9.m1.2.2.1.1.1.1.1.3.2.cmml">z</mi><mi id="S7.Ex9.m1.2.2.1.1.1.1.1.3.3" xref="S7.Ex9.m1.2.2.1.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S7.Ex9.m1.2.2.1.1.1.1.1.2" xref="S7.Ex9.m1.2.2.1.1.1.1.1.2.cmml">|</mo><mrow id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.2.cmml"><msubsup id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.1" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.2" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.2.cmml">,</mo><mi id="S7.Ex9.m1.1.1" xref="S7.Ex9.m1.1.1.cmml">𝐱</mi></mrow></mrow><mo stretchy="false" id="S7.Ex9.m1.2.2.1.1.1.1.3" xref="S7.Ex9.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex9.m1.2b"><apply id="S7.Ex9.m1.2.2.cmml" xref="S7.Ex9.m1.2.2"><eq id="S7.Ex9.m1.2.2.2.cmml" xref="S7.Ex9.m1.2.2.2"></eq><csymbol cd="latexml" id="S7.Ex9.m1.2.2.3.cmml" xref="S7.Ex9.m1.2.2.3">absent</csymbol><apply id="S7.Ex9.m1.2.2.1.cmml" xref="S7.Ex9.m1.2.2.1"><apply id="S7.Ex9.m1.2.2.1.2.cmml" xref="S7.Ex9.m1.2.2.1.2"><csymbol cd="ambiguous" id="S7.Ex9.m1.2.2.1.2.1.cmml" xref="S7.Ex9.m1.2.2.1.2">superscript</csymbol><apply id="S7.Ex9.m1.2.2.1.2.2.cmml" xref="S7.Ex9.m1.2.2.1.2"><csymbol cd="ambiguous" id="S7.Ex9.m1.2.2.1.2.2.1.cmml" xref="S7.Ex9.m1.2.2.1.2">subscript</csymbol><sum id="S7.Ex9.m1.2.2.1.2.2.2.cmml" xref="S7.Ex9.m1.2.2.1.2.2.2"></sum><apply id="S7.Ex9.m1.2.2.1.2.2.3.cmml" xref="S7.Ex9.m1.2.2.1.2.2.3"><eq id="S7.Ex9.m1.2.2.1.2.2.3.1.cmml" xref="S7.Ex9.m1.2.2.1.2.2.3.1"></eq><ci id="S7.Ex9.m1.2.2.1.2.2.3.2.cmml" xref="S7.Ex9.m1.2.2.1.2.2.3.2">𝑡</ci><cn type="integer" id="S7.Ex9.m1.2.2.1.2.2.3.3.cmml" xref="S7.Ex9.m1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S7.Ex9.m1.2.2.1.2.3.cmml" xref="S7.Ex9.m1.2.2.1.2.3">𝑇</ci></apply><apply id="S7.Ex9.m1.2.2.1.1.cmml" xref="S7.Ex9.m1.2.2.1.1"><times id="S7.Ex9.m1.2.2.1.1.2.cmml" xref="S7.Ex9.m1.2.2.1.1.2"></times><apply id="S7.Ex9.m1.2.2.1.1.3.cmml" xref="S7.Ex9.m1.2.2.1.1.3"><log id="S7.Ex9.m1.2.2.1.1.3.1.cmml" xref="S7.Ex9.m1.2.2.1.1.3.1"></log><apply id="S7.Ex9.m1.2.2.1.1.3.2.cmml" xref="S7.Ex9.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S7.Ex9.m1.2.2.1.1.3.2.1.cmml" xref="S7.Ex9.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S7.Ex9.m1.2.2.1.1.3.2.2.cmml" xref="S7.Ex9.m1.2.2.1.1.3.2.2">𝑞</ci><ci id="S7.Ex9.m1.2.2.1.1.3.2.3.cmml" xref="S7.Ex9.m1.2.2.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S7.Ex9.m1.2.2.1.1.1.1.1.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S7.Ex9.m1.2.2.1.1.1.1.1.2.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.2">conditional</csymbol><apply id="S7.Ex9.m1.2.2.1.1.1.1.1.3.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S7.Ex9.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S7.Ex9.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.3.2">𝑧</ci><ci id="S7.Ex9.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.3.3">𝑡</ci></apply><list id="S7.Ex9.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1"><apply id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><set id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><apply id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3"><eq id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.1"></eq><ci id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3"><minus id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S7.Ex9.m1.2.2.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S7.Ex9.m1.1.1.cmml" xref="S7.Ex9.m1.1.1">𝐱</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex9.m1.2c">\displaystyle=\sum_{t=1}^{T}\log q_{\phi}(z_{t}|\{z_{i}\}_{i=1}^{t-1},\mathbf{x})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S7.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S7.Ex10.m1.1" class="ltx_Math" alttext="\displaystyle=\log q_{\phi}(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S7.Ex10.m1.1a"><mrow id="S7.Ex10.m1.1.1" xref="S7.Ex10.m1.1.1.cmml"><mi id="S7.Ex10.m1.1.1.3" xref="S7.Ex10.m1.1.1.3.cmml"></mi><mo id="S7.Ex10.m1.1.1.2" xref="S7.Ex10.m1.1.1.2.cmml">=</mo><mrow id="S7.Ex10.m1.1.1.1" xref="S7.Ex10.m1.1.1.1.cmml"><mrow id="S7.Ex10.m1.1.1.1.3" xref="S7.Ex10.m1.1.1.1.3.cmml"><mi id="S7.Ex10.m1.1.1.1.3.1" xref="S7.Ex10.m1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S7.Ex10.m1.1.1.1.3a" xref="S7.Ex10.m1.1.1.1.3.cmml">⁡</mo><msub id="S7.Ex10.m1.1.1.1.3.2" xref="S7.Ex10.m1.1.1.1.3.2.cmml"><mi id="S7.Ex10.m1.1.1.1.3.2.2" xref="S7.Ex10.m1.1.1.1.3.2.2.cmml">q</mi><mi id="S7.Ex10.m1.1.1.1.3.2.3" xref="S7.Ex10.m1.1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S7.Ex10.m1.1.1.1.2" xref="S7.Ex10.m1.1.1.1.2.cmml">​</mo><mrow id="S7.Ex10.m1.1.1.1.1.1" xref="S7.Ex10.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.Ex10.m1.1.1.1.1.1.2" xref="S7.Ex10.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.Ex10.m1.1.1.1.1.1.1" xref="S7.Ex10.m1.1.1.1.1.1.1.cmml"><mi id="S7.Ex10.m1.1.1.1.1.1.1.2" xref="S7.Ex10.m1.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S7.Ex10.m1.1.1.1.1.1.1.1" xref="S7.Ex10.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S7.Ex10.m1.1.1.1.1.1.1.3" xref="S7.Ex10.m1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S7.Ex10.m1.1.1.1.1.1.3" xref="S7.Ex10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.Ex10.m1.1b"><apply id="S7.Ex10.m1.1.1.cmml" xref="S7.Ex10.m1.1.1"><eq id="S7.Ex10.m1.1.1.2.cmml" xref="S7.Ex10.m1.1.1.2"></eq><csymbol cd="latexml" id="S7.Ex10.m1.1.1.3.cmml" xref="S7.Ex10.m1.1.1.3">absent</csymbol><apply id="S7.Ex10.m1.1.1.1.cmml" xref="S7.Ex10.m1.1.1.1"><times id="S7.Ex10.m1.1.1.1.2.cmml" xref="S7.Ex10.m1.1.1.1.2"></times><apply id="S7.Ex10.m1.1.1.1.3.cmml" xref="S7.Ex10.m1.1.1.1.3"><log id="S7.Ex10.m1.1.1.1.3.1.cmml" xref="S7.Ex10.m1.1.1.1.3.1"></log><apply id="S7.Ex10.m1.1.1.1.3.2.cmml" xref="S7.Ex10.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S7.Ex10.m1.1.1.1.3.2.1.cmml" xref="S7.Ex10.m1.1.1.1.3.2">subscript</csymbol><ci id="S7.Ex10.m1.1.1.1.3.2.2.cmml" xref="S7.Ex10.m1.1.1.1.3.2.2">𝑞</ci><ci id="S7.Ex10.m1.1.1.1.3.2.3.cmml" xref="S7.Ex10.m1.1.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S7.Ex10.m1.1.1.1.1.1.1.cmml" xref="S7.Ex10.m1.1.1.1.1.1"><csymbol cd="latexml" id="S7.Ex10.m1.1.1.1.1.1.1.1.cmml" xref="S7.Ex10.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S7.Ex10.m1.1.1.1.1.1.1.2.cmml" xref="S7.Ex10.m1.1.1.1.1.1.1.2">𝐳</ci><ci id="S7.Ex10.m1.1.1.1.1.1.1.3.cmml" xref="S7.Ex10.m1.1.1.1.1.1.1.3">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.Ex10.m1.1c">\displaystyle=\log q_{\phi}(\mathbf{z}|\mathbf{x})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S7.13.p13" class="ltx_para">
<p id="S7.13.p13.1" class="ltx_p">This gives us the final bound, written over all the observed data points:</p>
<table id="S7.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.E12.m1.47" class="ltx_math_unparsed" alttext="\mathcal{L}\geq\sum_{n=1}^{N}\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})+\log q_{\phi}(\mathbf{z}^{n}|\mathbf{x}^{n})\\
-\mathbb{KL}\left({q(\Pi|\mathbf{x},\mathbf{z})}||{p(\Pi)}\right)" display="block"><semantics id="S7.E12.m1.47a"><mtable displaystyle="true" rowspacing="0pt" id="S7.E12.m1.47.47.2"><mtr id="S7.E12.m1.47.47.2a"><mtd class="ltx_align_left" columnalign="left" id="S7.E12.m1.47.47.2b"><mrow id="S7.E12.m1.47.47.2.47.28.28"><mi class="ltx_font_mathcaligraphic" id="S7.E12.m1.1.1.1.1.1.1">ℒ</mi><mo rspace="0.111em" id="S7.E12.m1.2.2.2.2.2.2">≥</mo><mrow id="S7.E12.m1.47.47.2.47.28.28.28"><mrow id="S7.E12.m1.46.46.1.46.27.27.27.1"><munderover id="S7.E12.m1.46.46.1.46.27.27.27.1.2"><mo movablelimits="false" id="S7.E12.m1.3.3.3.3.3.3">∑</mo><mrow id="S7.E12.m1.4.4.4.4.4.4.1"><mi id="S7.E12.m1.4.4.4.4.4.4.1.2">n</mi><mo id="S7.E12.m1.4.4.4.4.4.4.1.1">=</mo><mn id="S7.E12.m1.4.4.4.4.4.4.1.3">1</mn></mrow><mi id="S7.E12.m1.5.5.5.5.5.5.1">N</mi></munderover><mrow id="S7.E12.m1.46.46.1.46.27.27.27.1.1"><mrow id="S7.E12.m1.46.46.1.46.27.27.27.1.1.3"><mi id="S7.E12.m1.6.6.6.6.6.6">log</mi><mo lspace="0.167em" id="S7.E12.m1.46.46.1.46.27.27.27.1.1.3a">⁡</mo><msub id="S7.E12.m1.46.46.1.46.27.27.27.1.1.3.1"><mi id="S7.E12.m1.7.7.7.7.7.7">p</mi><mi id="S7.E12.m1.8.8.8.8.8.8.1">σ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S7.E12.m1.46.46.1.46.27.27.27.1.1.2">​</mo><mrow id="S7.E12.m1.46.46.1.46.27.27.27.1.1.1.1"><mo stretchy="false" id="S7.E12.m1.9.9.9.9.9.9">(</mo><mrow id="S7.E12.m1.46.46.1.46.27.27.27.1.1.1.1.1"><msup id="S7.E12.m1.46.46.1.46.27.27.27.1.1.1.1.1.1"><mi id="S7.E12.m1.10.10.10.10.10.10">𝐱</mi><mi id="S7.E12.m1.11.11.11.11.11.11.1">n</mi></msup><mo fence="false" id="S7.E12.m1.12.12.12.12.12.12">|</mo><msup id="S7.E12.m1.46.46.1.46.27.27.27.1.1.1.1.1.2"><mi id="S7.E12.m1.13.13.13.13.13.13">𝐳</mi><mi id="S7.E12.m1.14.14.14.14.14.14.1">n</mi></msup></mrow><mo stretchy="false" id="S7.E12.m1.15.15.15.15.15.15">)</mo></mrow></mrow></mrow><mo id="S7.E12.m1.16.16.16.16.16.16">+</mo><mrow id="S7.E12.m1.47.47.2.47.28.28.28.2"><mrow id="S7.E12.m1.47.47.2.47.28.28.28.2.3"><mi id="S7.E12.m1.17.17.17.17.17.17">log</mi><mo lspace="0.167em" id="S7.E12.m1.47.47.2.47.28.28.28.2.3a">⁡</mo><msub id="S7.E12.m1.47.47.2.47.28.28.28.2.3.1"><mi id="S7.E12.m1.18.18.18.18.18.18">q</mi><mi id="S7.E12.m1.19.19.19.19.19.19.1">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S7.E12.m1.47.47.2.47.28.28.28.2.2">​</mo><mrow id="S7.E12.m1.47.47.2.47.28.28.28.2.1.1"><mo stretchy="false" id="S7.E12.m1.20.20.20.20.20.20">(</mo><mrow id="S7.E12.m1.47.47.2.47.28.28.28.2.1.1.1"><msup id="S7.E12.m1.47.47.2.47.28.28.28.2.1.1.1.1"><mi id="S7.E12.m1.21.21.21.21.21.21">𝐳</mi><mi id="S7.E12.m1.22.22.22.22.22.22.1">n</mi></msup><mo fence="false" id="S7.E12.m1.23.23.23.23.23.23">|</mo><msup id="S7.E12.m1.47.47.2.47.28.28.28.2.1.1.1.2"><mi id="S7.E12.m1.24.24.24.24.24.24">𝐱</mi><mi id="S7.E12.m1.25.25.25.25.25.25.1">n</mi></msup></mrow><mo stretchy="false" id="S7.E12.m1.26.26.26.26.26.26">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S7.E12.m1.47.47.2c"><mtd class="ltx_align_right" columnalign="right" id="S7.E12.m1.47.47.2d"><mrow id="S7.E12.m1.45.45.45.19.19"><mo id="S7.E12.m1.27.27.27.1.1.1">−</mo><mi id="S7.E12.m1.28.28.28.2.2.2">𝕂</mi><mi id="S7.E12.m1.29.29.29.3.3.3">𝕃</mi><mrow id="S7.E12.m1.45.45.45.19.19.20"><mo id="S7.E12.m1.30.30.30.4.4.4">(</mo><mi id="S7.E12.m1.31.31.31.5.5.5">q</mi><mrow id="S7.E12.m1.45.45.45.19.19.20.1"><mo stretchy="false" id="S7.E12.m1.32.32.32.6.6.6">(</mo><mi mathvariant="normal" id="S7.E12.m1.33.33.33.7.7.7">Π</mi><mo fence="false" rspace="0.167em" stretchy="false" id="S7.E12.m1.34.34.34.8.8.8">|</mo><mi id="S7.E12.m1.35.35.35.9.9.9">𝐱</mi><mo id="S7.E12.m1.36.36.36.10.10.10">,</mo><mi id="S7.E12.m1.37.37.37.11.11.11">𝐳</mi><mo stretchy="false" id="S7.E12.m1.38.38.38.12.12.12">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="S7.E12.m1.39.39.39.13.13.13">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S7.E12.m1.40.40.40.14.14.14">|</mo><mi id="S7.E12.m1.41.41.41.15.15.15">p</mi><mrow id="S7.E12.m1.45.45.45.19.19.20.2"><mo stretchy="false" id="S7.E12.m1.42.42.42.16.16.16">(</mo><mi mathvariant="normal" id="S7.E12.m1.43.43.43.17.17.17">Π</mi><mo stretchy="false" id="S7.E12.m1.44.44.44.18.18.18">)</mo></mrow><mo id="S7.E12.m1.45.45.45.19.19.19">)</mo></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex" id="S7.E12.m1.47b">\mathcal{L}\geq\sum_{n=1}^{N}\log p_{\sigma}(\mathbf{x}^{n}|\mathbf{z}^{n})+\log q_{\phi}(\mathbf{z}^{n}|\mathbf{x}^{n})\\
-\mathbb{KL}\left({q(\Pi|\mathbf{x},\mathbf{z})}||{p(\Pi)}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S7.13.p13.2" class="ltx_p">∎</p>
</div>
</div>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Justification for <math id="S8.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S8.1.m1.1b"><mi id="S8.1.m1.1.1" xref="S8.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S8.1.m1.1c"><ci id="S8.1.m1.1.1.cmml" xref="S8.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.1.m1.1d">\alpha</annotation></semantics></math>
</h2>

<div id="S8.p1" class="ltx_para">
<p id="S8.p1.8" class="ltx_p">We optimize the full evidence lower bound <math id="S8.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{qc}+\mathcal{U}_{qc}" display="inline"><semantics id="S8.p1.1.m1.1a"><mrow id="S8.p1.1.m1.1.1" xref="S8.p1.1.m1.1.1.cmml"><msub id="S8.p1.1.m1.1.1.2" xref="S8.p1.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S8.p1.1.m1.1.1.2.2" xref="S8.p1.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S8.p1.1.m1.1.1.2.3" xref="S8.p1.1.m1.1.1.2.3.cmml"><mi id="S8.p1.1.m1.1.1.2.3.2" xref="S8.p1.1.m1.1.1.2.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S8.p1.1.m1.1.1.2.3.1" xref="S8.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S8.p1.1.m1.1.1.2.3.3" xref="S8.p1.1.m1.1.1.2.3.3.cmml">c</mi></mrow></msub><mo id="S8.p1.1.m1.1.1.1" xref="S8.p1.1.m1.1.1.1.cmml">+</mo><msub id="S8.p1.1.m1.1.1.3" xref="S8.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S8.p1.1.m1.1.1.3.2" xref="S8.p1.1.m1.1.1.3.2.cmml">𝒰</mi><mrow id="S8.p1.1.m1.1.1.3.3" xref="S8.p1.1.m1.1.1.3.3.cmml"><mi id="S8.p1.1.m1.1.1.3.3.2" xref="S8.p1.1.m1.1.1.3.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S8.p1.1.m1.1.1.3.3.1" xref="S8.p1.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S8.p1.1.m1.1.1.3.3.3" xref="S8.p1.1.m1.1.1.3.3.3.cmml">c</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S8.p1.1.m1.1b"><apply id="S8.p1.1.m1.1.1.cmml" xref="S8.p1.1.m1.1.1"><plus id="S8.p1.1.m1.1.1.1.cmml" xref="S8.p1.1.m1.1.1.1"></plus><apply id="S8.p1.1.m1.1.1.2.cmml" xref="S8.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S8.p1.1.m1.1.1.2.1.cmml" xref="S8.p1.1.m1.1.1.2">subscript</csymbol><ci id="S8.p1.1.m1.1.1.2.2.cmml" xref="S8.p1.1.m1.1.1.2.2">ℒ</ci><apply id="S8.p1.1.m1.1.1.2.3.cmml" xref="S8.p1.1.m1.1.1.2.3"><times id="S8.p1.1.m1.1.1.2.3.1.cmml" xref="S8.p1.1.m1.1.1.2.3.1"></times><ci id="S8.p1.1.m1.1.1.2.3.2.cmml" xref="S8.p1.1.m1.1.1.2.3.2">𝑞</ci><ci id="S8.p1.1.m1.1.1.2.3.3.cmml" xref="S8.p1.1.m1.1.1.2.3.3">𝑐</ci></apply></apply><apply id="S8.p1.1.m1.1.1.3.cmml" xref="S8.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S8.p1.1.m1.1.1.3.1.cmml" xref="S8.p1.1.m1.1.1.3">subscript</csymbol><ci id="S8.p1.1.m1.1.1.3.2.cmml" xref="S8.p1.1.m1.1.1.3.2">𝒰</ci><apply id="S8.p1.1.m1.1.1.3.3.cmml" xref="S8.p1.1.m1.1.1.3.3"><times id="S8.p1.1.m1.1.1.3.3.1.cmml" xref="S8.p1.1.m1.1.1.3.3.1"></times><ci id="S8.p1.1.m1.1.1.3.3.2.cmml" xref="S8.p1.1.m1.1.1.3.3.2">𝑞</ci><ci id="S8.p1.1.m1.1.1.3.3.3.cmml" xref="S8.p1.1.m1.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.1.m1.1c">\mathcal{L}_{qc}+\mathcal{U}_{qc}</annotation></semantics></math> using supervised learning
for <math id="S8.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{qc}" display="inline"><semantics id="S8.p1.2.m2.1a"><msub id="S8.p1.2.m2.1.1" xref="S8.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S8.p1.2.m2.1.1.2" xref="S8.p1.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S8.p1.2.m2.1.1.3" xref="S8.p1.2.m2.1.1.3.cmml"><mi id="S8.p1.2.m2.1.1.3.2" xref="S8.p1.2.m2.1.1.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S8.p1.2.m2.1.1.3.1" xref="S8.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S8.p1.2.m2.1.1.3.3" xref="S8.p1.2.m2.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S8.p1.2.m2.1b"><apply id="S8.p1.2.m2.1.1.cmml" xref="S8.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S8.p1.2.m2.1.1.1.cmml" xref="S8.p1.2.m2.1.1">subscript</csymbol><ci id="S8.p1.2.m2.1.1.2.cmml" xref="S8.p1.2.m2.1.1.2">ℒ</ci><apply id="S8.p1.2.m2.1.1.3.cmml" xref="S8.p1.2.m2.1.1.3"><times id="S8.p1.2.m2.1.1.3.1.cmml" xref="S8.p1.2.m2.1.1.3.1"></times><ci id="S8.p1.2.m2.1.1.3.2.cmml" xref="S8.p1.2.m2.1.1.3.2">𝑞</ci><ci id="S8.p1.2.m2.1.1.3.3.cmml" xref="S8.p1.2.m2.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.2.m2.1c">\mathcal{L}_{qc}</annotation></semantics></math> and REINFORCE for <math id="S8.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{U}_{qc}" display="inline"><semantics id="S8.p1.3.m3.1a"><msub id="S8.p1.3.m3.1.1" xref="S8.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S8.p1.3.m3.1.1.2" xref="S8.p1.3.m3.1.1.2.cmml">𝒰</mi><mrow id="S8.p1.3.m3.1.1.3" xref="S8.p1.3.m3.1.1.3.cmml"><mi id="S8.p1.3.m3.1.1.3.2" xref="S8.p1.3.m3.1.1.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S8.p1.3.m3.1.1.3.1" xref="S8.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S8.p1.3.m3.1.1.3.3" xref="S8.p1.3.m3.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S8.p1.3.m3.1b"><apply id="S8.p1.3.m3.1.1.cmml" xref="S8.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S8.p1.3.m3.1.1.1.cmml" xref="S8.p1.3.m3.1.1">subscript</csymbol><ci id="S8.p1.3.m3.1.1.2.cmml" xref="S8.p1.3.m3.1.1.2">𝒰</ci><apply id="S8.p1.3.m3.1.1.3.cmml" xref="S8.p1.3.m3.1.1.3"><times id="S8.p1.3.m3.1.1.3.1.cmml" xref="S8.p1.3.m3.1.1.3.1"></times><ci id="S8.p1.3.m3.1.1.3.2.cmml" xref="S8.p1.3.m3.1.1.3.2">𝑞</ci><ci id="S8.p1.3.m3.1.1.3.3.cmml" xref="S8.p1.3.m3.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.3.m3.1c">\mathcal{U}_{qc}</annotation></semantics></math>.
When using REINFORCE, notice that <math id="S8.p1.4.m4.2" class="ltx_Math" alttext="\nabla_{\phi}\mathcal{U}_{qc}=\nabla_{\phi}\log q(\mathbf{z}|\mathbf{x}^{m})[R_{qc}-B]" display="inline"><semantics id="S8.p1.4.m4.2a"><mrow id="S8.p1.4.m4.2.2" xref="S8.p1.4.m4.2.2.cmml"><mrow id="S8.p1.4.m4.2.2.4" xref="S8.p1.4.m4.2.2.4.cmml"><msub id="S8.p1.4.m4.2.2.4.1" xref="S8.p1.4.m4.2.2.4.1.cmml"><mo id="S8.p1.4.m4.2.2.4.1.2" xref="S8.p1.4.m4.2.2.4.1.2.cmml">∇</mo><mi id="S8.p1.4.m4.2.2.4.1.3" xref="S8.p1.4.m4.2.2.4.1.3.cmml">ϕ</mi></msub><msub id="S8.p1.4.m4.2.2.4.2" xref="S8.p1.4.m4.2.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S8.p1.4.m4.2.2.4.2.2" xref="S8.p1.4.m4.2.2.4.2.2.cmml">𝒰</mi><mrow id="S8.p1.4.m4.2.2.4.2.3" xref="S8.p1.4.m4.2.2.4.2.3.cmml"><mi id="S8.p1.4.m4.2.2.4.2.3.2" xref="S8.p1.4.m4.2.2.4.2.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S8.p1.4.m4.2.2.4.2.3.1" xref="S8.p1.4.m4.2.2.4.2.3.1.cmml">​</mo><mi id="S8.p1.4.m4.2.2.4.2.3.3" xref="S8.p1.4.m4.2.2.4.2.3.3.cmml">c</mi></mrow></msub></mrow><mo id="S8.p1.4.m4.2.2.3" xref="S8.p1.4.m4.2.2.3.cmml">=</mo><mrow id="S8.p1.4.m4.2.2.2" xref="S8.p1.4.m4.2.2.2.cmml"><mrow id="S8.p1.4.m4.2.2.2.4" xref="S8.p1.4.m4.2.2.2.4.cmml"><mrow id="S8.p1.4.m4.2.2.2.4.1" xref="S8.p1.4.m4.2.2.2.4.1.cmml"><msub id="S8.p1.4.m4.2.2.2.4.1.1" xref="S8.p1.4.m4.2.2.2.4.1.1.cmml"><mo rspace="0.167em" id="S8.p1.4.m4.2.2.2.4.1.1.2" xref="S8.p1.4.m4.2.2.2.4.1.1.2.cmml">∇</mo><mi id="S8.p1.4.m4.2.2.2.4.1.1.3" xref="S8.p1.4.m4.2.2.2.4.1.1.3.cmml">ϕ</mi></msub><mi id="S8.p1.4.m4.2.2.2.4.1.2" xref="S8.p1.4.m4.2.2.2.4.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S8.p1.4.m4.2.2.2.4a" xref="S8.p1.4.m4.2.2.2.4.cmml">⁡</mo><mi id="S8.p1.4.m4.2.2.2.4.2" xref="S8.p1.4.m4.2.2.2.4.2.cmml">q</mi></mrow><mo lspace="0em" rspace="0em" id="S8.p1.4.m4.2.2.2.3" xref="S8.p1.4.m4.2.2.2.3.cmml">​</mo><mrow id="S8.p1.4.m4.1.1.1.1.1" xref="S8.p1.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S8.p1.4.m4.1.1.1.1.1.2" xref="S8.p1.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S8.p1.4.m4.1.1.1.1.1.1" xref="S8.p1.4.m4.1.1.1.1.1.1.cmml"><mi id="S8.p1.4.m4.1.1.1.1.1.1.2" xref="S8.p1.4.m4.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S8.p1.4.m4.1.1.1.1.1.1.1" xref="S8.p1.4.m4.1.1.1.1.1.1.1.cmml">|</mo><msup id="S8.p1.4.m4.1.1.1.1.1.1.3" xref="S8.p1.4.m4.1.1.1.1.1.1.3.cmml"><mi id="S8.p1.4.m4.1.1.1.1.1.1.3.2" xref="S8.p1.4.m4.1.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S8.p1.4.m4.1.1.1.1.1.1.3.3" xref="S8.p1.4.m4.1.1.1.1.1.1.3.3.cmml">m</mi></msup></mrow><mo stretchy="false" id="S8.p1.4.m4.1.1.1.1.1.3" xref="S8.p1.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S8.p1.4.m4.2.2.2.3a" xref="S8.p1.4.m4.2.2.2.3.cmml">​</mo><mrow id="S8.p1.4.m4.2.2.2.2.1" xref="S8.p1.4.m4.2.2.2.2.2.cmml"><mo stretchy="false" id="S8.p1.4.m4.2.2.2.2.1.2" xref="S8.p1.4.m4.2.2.2.2.2.1.cmml">[</mo><mrow id="S8.p1.4.m4.2.2.2.2.1.1" xref="S8.p1.4.m4.2.2.2.2.1.1.cmml"><msub id="S8.p1.4.m4.2.2.2.2.1.1.2" xref="S8.p1.4.m4.2.2.2.2.1.1.2.cmml"><mi id="S8.p1.4.m4.2.2.2.2.1.1.2.2" xref="S8.p1.4.m4.2.2.2.2.1.1.2.2.cmml">R</mi><mrow id="S8.p1.4.m4.2.2.2.2.1.1.2.3" xref="S8.p1.4.m4.2.2.2.2.1.1.2.3.cmml"><mi id="S8.p1.4.m4.2.2.2.2.1.1.2.3.2" xref="S8.p1.4.m4.2.2.2.2.1.1.2.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S8.p1.4.m4.2.2.2.2.1.1.2.3.1" xref="S8.p1.4.m4.2.2.2.2.1.1.2.3.1.cmml">​</mo><mi id="S8.p1.4.m4.2.2.2.2.1.1.2.3.3" xref="S8.p1.4.m4.2.2.2.2.1.1.2.3.3.cmml">c</mi></mrow></msub><mo id="S8.p1.4.m4.2.2.2.2.1.1.1" xref="S8.p1.4.m4.2.2.2.2.1.1.1.cmml">−</mo><mi id="S8.p1.4.m4.2.2.2.2.1.1.3" xref="S8.p1.4.m4.2.2.2.2.1.1.3.cmml">B</mi></mrow><mo stretchy="false" id="S8.p1.4.m4.2.2.2.2.1.3" xref="S8.p1.4.m4.2.2.2.2.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S8.p1.4.m4.2b"><apply id="S8.p1.4.m4.2.2.cmml" xref="S8.p1.4.m4.2.2"><eq id="S8.p1.4.m4.2.2.3.cmml" xref="S8.p1.4.m4.2.2.3"></eq><apply id="S8.p1.4.m4.2.2.4.cmml" xref="S8.p1.4.m4.2.2.4"><apply id="S8.p1.4.m4.2.2.4.1.cmml" xref="S8.p1.4.m4.2.2.4.1"><csymbol cd="ambiguous" id="S8.p1.4.m4.2.2.4.1.1.cmml" xref="S8.p1.4.m4.2.2.4.1">subscript</csymbol><ci id="S8.p1.4.m4.2.2.4.1.2.cmml" xref="S8.p1.4.m4.2.2.4.1.2">∇</ci><ci id="S8.p1.4.m4.2.2.4.1.3.cmml" xref="S8.p1.4.m4.2.2.4.1.3">italic-ϕ</ci></apply><apply id="S8.p1.4.m4.2.2.4.2.cmml" xref="S8.p1.4.m4.2.2.4.2"><csymbol cd="ambiguous" id="S8.p1.4.m4.2.2.4.2.1.cmml" xref="S8.p1.4.m4.2.2.4.2">subscript</csymbol><ci id="S8.p1.4.m4.2.2.4.2.2.cmml" xref="S8.p1.4.m4.2.2.4.2.2">𝒰</ci><apply id="S8.p1.4.m4.2.2.4.2.3.cmml" xref="S8.p1.4.m4.2.2.4.2.3"><times id="S8.p1.4.m4.2.2.4.2.3.1.cmml" xref="S8.p1.4.m4.2.2.4.2.3.1"></times><ci id="S8.p1.4.m4.2.2.4.2.3.2.cmml" xref="S8.p1.4.m4.2.2.4.2.3.2">𝑞</ci><ci id="S8.p1.4.m4.2.2.4.2.3.3.cmml" xref="S8.p1.4.m4.2.2.4.2.3.3">𝑐</ci></apply></apply></apply><apply id="S8.p1.4.m4.2.2.2.cmml" xref="S8.p1.4.m4.2.2.2"><times id="S8.p1.4.m4.2.2.2.3.cmml" xref="S8.p1.4.m4.2.2.2.3"></times><apply id="S8.p1.4.m4.2.2.2.4.cmml" xref="S8.p1.4.m4.2.2.2.4"><apply id="S8.p1.4.m4.2.2.2.4.1.cmml" xref="S8.p1.4.m4.2.2.2.4.1"><apply id="S8.p1.4.m4.2.2.2.4.1.1.cmml" xref="S8.p1.4.m4.2.2.2.4.1.1"><csymbol cd="ambiguous" id="S8.p1.4.m4.2.2.2.4.1.1.1.cmml" xref="S8.p1.4.m4.2.2.2.4.1.1">subscript</csymbol><ci id="S8.p1.4.m4.2.2.2.4.1.1.2.cmml" xref="S8.p1.4.m4.2.2.2.4.1.1.2">∇</ci><ci id="S8.p1.4.m4.2.2.2.4.1.1.3.cmml" xref="S8.p1.4.m4.2.2.2.4.1.1.3">italic-ϕ</ci></apply><log id="S8.p1.4.m4.2.2.2.4.1.2.cmml" xref="S8.p1.4.m4.2.2.2.4.1.2"></log></apply><ci id="S8.p1.4.m4.2.2.2.4.2.cmml" xref="S8.p1.4.m4.2.2.2.4.2">𝑞</ci></apply><apply id="S8.p1.4.m4.1.1.1.1.1.1.cmml" xref="S8.p1.4.m4.1.1.1.1.1"><csymbol cd="latexml" id="S8.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S8.p1.4.m4.1.1.1.1.1.1.1">conditional</csymbol><ci id="S8.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S8.p1.4.m4.1.1.1.1.1.1.2">𝐳</ci><apply id="S8.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S8.p1.4.m4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S8.p1.4.m4.1.1.1.1.1.1.3.1.cmml" xref="S8.p1.4.m4.1.1.1.1.1.1.3">superscript</csymbol><ci id="S8.p1.4.m4.1.1.1.1.1.1.3.2.cmml" xref="S8.p1.4.m4.1.1.1.1.1.1.3.2">𝐱</ci><ci id="S8.p1.4.m4.1.1.1.1.1.1.3.3.cmml" xref="S8.p1.4.m4.1.1.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S8.p1.4.m4.2.2.2.2.2.cmml" xref="S8.p1.4.m4.2.2.2.2.1"><csymbol cd="latexml" id="S8.p1.4.m4.2.2.2.2.2.1.cmml" xref="S8.p1.4.m4.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S8.p1.4.m4.2.2.2.2.1.1.cmml" xref="S8.p1.4.m4.2.2.2.2.1.1"><minus id="S8.p1.4.m4.2.2.2.2.1.1.1.cmml" xref="S8.p1.4.m4.2.2.2.2.1.1.1"></minus><apply id="S8.p1.4.m4.2.2.2.2.1.1.2.cmml" xref="S8.p1.4.m4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S8.p1.4.m4.2.2.2.2.1.1.2.1.cmml" xref="S8.p1.4.m4.2.2.2.2.1.1.2">subscript</csymbol><ci id="S8.p1.4.m4.2.2.2.2.1.1.2.2.cmml" xref="S8.p1.4.m4.2.2.2.2.1.1.2.2">𝑅</ci><apply id="S8.p1.4.m4.2.2.2.2.1.1.2.3.cmml" xref="S8.p1.4.m4.2.2.2.2.1.1.2.3"><times id="S8.p1.4.m4.2.2.2.2.1.1.2.3.1.cmml" xref="S8.p1.4.m4.2.2.2.2.1.1.2.3.1"></times><ci id="S8.p1.4.m4.2.2.2.2.1.1.2.3.2.cmml" xref="S8.p1.4.m4.2.2.2.2.1.1.2.3.2">𝑞</ci><ci id="S8.p1.4.m4.2.2.2.2.1.1.2.3.3.cmml" xref="S8.p1.4.m4.2.2.2.2.1.1.2.3.3">𝑐</ci></apply></apply><ci id="S8.p1.4.m4.2.2.2.2.1.1.3.cmml" xref="S8.p1.4.m4.2.2.2.2.1.1.3">𝐵</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.4.m4.2c">\nabla_{\phi}\mathcal{U}_{qc}=\nabla_{\phi}\log q(\mathbf{z}|\mathbf{x}^{m})[R_{qc}-B]</annotation></semantics></math>,
where <math id="S8.p1.5.m5.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S8.p1.5.m5.1a"><mi id="S8.p1.5.m5.1.1" xref="S8.p1.5.m5.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S8.p1.5.m5.1b"><ci id="S8.p1.5.m5.1.1.cmml" xref="S8.p1.5.m5.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.5.m5.1c">B</annotation></semantics></math> is a baseline.
For the lower bound on <math id="S8.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{L}_{qc}" display="inline"><semantics id="S8.p1.6.m6.1a"><msub id="S8.p1.6.m6.1.1" xref="S8.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S8.p1.6.m6.1.1.2" xref="S8.p1.6.m6.1.1.2.cmml">ℒ</mi><mrow id="S8.p1.6.m6.1.1.3" xref="S8.p1.6.m6.1.1.3.cmml"><mi id="S8.p1.6.m6.1.1.3.2" xref="S8.p1.6.m6.1.1.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S8.p1.6.m6.1.1.3.1" xref="S8.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S8.p1.6.m6.1.1.3.3" xref="S8.p1.6.m6.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S8.p1.6.m6.1b"><apply id="S8.p1.6.m6.1.1.cmml" xref="S8.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S8.p1.6.m6.1.1.1.cmml" xref="S8.p1.6.m6.1.1">subscript</csymbol><ci id="S8.p1.6.m6.1.1.2.cmml" xref="S8.p1.6.m6.1.1.2">ℒ</ci><apply id="S8.p1.6.m6.1.1.3.cmml" xref="S8.p1.6.m6.1.1.3"><times id="S8.p1.6.m6.1.1.3.1.cmml" xref="S8.p1.6.m6.1.1.3.1"></times><ci id="S8.p1.6.m6.1.1.3.2.cmml" xref="S8.p1.6.m6.1.1.3.2">𝑞</ci><ci id="S8.p1.6.m6.1.1.3.3.cmml" xref="S8.p1.6.m6.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.6.m6.1c">\mathcal{L}_{qc}</annotation></semantics></math>, the gradient is <math id="S8.p1.7.m7.1" class="ltx_Math" alttext="\nabla_{\phi}\log q(\mathbf{z}^{n}|\mathbf{x}^{n})" display="inline"><semantics id="S8.p1.7.m7.1a"><mrow id="S8.p1.7.m7.1.1" xref="S8.p1.7.m7.1.1.cmml"><mrow id="S8.p1.7.m7.1.1.3" xref="S8.p1.7.m7.1.1.3.cmml"><mrow id="S8.p1.7.m7.1.1.3.1" xref="S8.p1.7.m7.1.1.3.1.cmml"><msub id="S8.p1.7.m7.1.1.3.1.1" xref="S8.p1.7.m7.1.1.3.1.1.cmml"><mo id="S8.p1.7.m7.1.1.3.1.1.2" xref="S8.p1.7.m7.1.1.3.1.1.2.cmml">∇</mo><mi id="S8.p1.7.m7.1.1.3.1.1.3" xref="S8.p1.7.m7.1.1.3.1.1.3.cmml">ϕ</mi></msub><mi id="S8.p1.7.m7.1.1.3.1.2" xref="S8.p1.7.m7.1.1.3.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S8.p1.7.m7.1.1.3a" xref="S8.p1.7.m7.1.1.3.cmml">⁡</mo><mi id="S8.p1.7.m7.1.1.3.2" xref="S8.p1.7.m7.1.1.3.2.cmml">q</mi></mrow><mo lspace="0em" rspace="0em" id="S8.p1.7.m7.1.1.2" xref="S8.p1.7.m7.1.1.2.cmml">​</mo><mrow id="S8.p1.7.m7.1.1.1.1" xref="S8.p1.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S8.p1.7.m7.1.1.1.1.2" xref="S8.p1.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S8.p1.7.m7.1.1.1.1.1" xref="S8.p1.7.m7.1.1.1.1.1.cmml"><msup id="S8.p1.7.m7.1.1.1.1.1.2" xref="S8.p1.7.m7.1.1.1.1.1.2.cmml"><mi id="S8.p1.7.m7.1.1.1.1.1.2.2" xref="S8.p1.7.m7.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="S8.p1.7.m7.1.1.1.1.1.2.3" xref="S8.p1.7.m7.1.1.1.1.1.2.3.cmml">n</mi></msup><mo fence="false" id="S8.p1.7.m7.1.1.1.1.1.1" xref="S8.p1.7.m7.1.1.1.1.1.1.cmml">|</mo><msup id="S8.p1.7.m7.1.1.1.1.1.3" xref="S8.p1.7.m7.1.1.1.1.1.3.cmml"><mi id="S8.p1.7.m7.1.1.1.1.1.3.2" xref="S8.p1.7.m7.1.1.1.1.1.3.2.cmml">𝐱</mi><mi id="S8.p1.7.m7.1.1.1.1.1.3.3" xref="S8.p1.7.m7.1.1.1.1.1.3.3.cmml">n</mi></msup></mrow><mo stretchy="false" id="S8.p1.7.m7.1.1.1.1.3" xref="S8.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S8.p1.7.m7.1b"><apply id="S8.p1.7.m7.1.1.cmml" xref="S8.p1.7.m7.1.1"><times id="S8.p1.7.m7.1.1.2.cmml" xref="S8.p1.7.m7.1.1.2"></times><apply id="S8.p1.7.m7.1.1.3.cmml" xref="S8.p1.7.m7.1.1.3"><apply id="S8.p1.7.m7.1.1.3.1.cmml" xref="S8.p1.7.m7.1.1.3.1"><apply id="S8.p1.7.m7.1.1.3.1.1.cmml" xref="S8.p1.7.m7.1.1.3.1.1"><csymbol cd="ambiguous" id="S8.p1.7.m7.1.1.3.1.1.1.cmml" xref="S8.p1.7.m7.1.1.3.1.1">subscript</csymbol><ci id="S8.p1.7.m7.1.1.3.1.1.2.cmml" xref="S8.p1.7.m7.1.1.3.1.1.2">∇</ci><ci id="S8.p1.7.m7.1.1.3.1.1.3.cmml" xref="S8.p1.7.m7.1.1.3.1.1.3">italic-ϕ</ci></apply><log id="S8.p1.7.m7.1.1.3.1.2.cmml" xref="S8.p1.7.m7.1.1.3.1.2"></log></apply><ci id="S8.p1.7.m7.1.1.3.2.cmml" xref="S8.p1.7.m7.1.1.3.2">𝑞</ci></apply><apply id="S8.p1.7.m7.1.1.1.1.1.cmml" xref="S8.p1.7.m7.1.1.1.1"><csymbol cd="latexml" id="S8.p1.7.m7.1.1.1.1.1.1.cmml" xref="S8.p1.7.m7.1.1.1.1.1.1">conditional</csymbol><apply id="S8.p1.7.m7.1.1.1.1.1.2.cmml" xref="S8.p1.7.m7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S8.p1.7.m7.1.1.1.1.1.2.1.cmml" xref="S8.p1.7.m7.1.1.1.1.1.2">superscript</csymbol><ci id="S8.p1.7.m7.1.1.1.1.1.2.2.cmml" xref="S8.p1.7.m7.1.1.1.1.1.2.2">𝐳</ci><ci id="S8.p1.7.m7.1.1.1.1.1.2.3.cmml" xref="S8.p1.7.m7.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S8.p1.7.m7.1.1.1.1.1.3.cmml" xref="S8.p1.7.m7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S8.p1.7.m7.1.1.1.1.1.3.1.cmml" xref="S8.p1.7.m7.1.1.1.1.1.3">superscript</csymbol><ci id="S8.p1.7.m7.1.1.1.1.1.3.2.cmml" xref="S8.p1.7.m7.1.1.1.1.1.3.2">𝐱</ci><ci id="S8.p1.7.m7.1.1.1.1.1.3.3.cmml" xref="S8.p1.7.m7.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.7.m7.1c">\nabla_{\phi}\log q(\mathbf{z}^{n}|\mathbf{x}^{n})</annotation></semantics></math>.
Notice that the scales of the gradients from the two terms are very different, since the order
of <math id="S8.p1.8.m8.1" class="ltx_Math" alttext="R_{qc}" display="inline"><semantics id="S8.p1.8.m8.1a"><msub id="S8.p1.8.m8.1.1" xref="S8.p1.8.m8.1.1.cmml"><mi id="S8.p1.8.m8.1.1.2" xref="S8.p1.8.m8.1.1.2.cmml">R</mi><mrow id="S8.p1.8.m8.1.1.3" xref="S8.p1.8.m8.1.1.3.cmml"><mi id="S8.p1.8.m8.1.1.3.2" xref="S8.p1.8.m8.1.1.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S8.p1.8.m8.1.1.3.1" xref="S8.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S8.p1.8.m8.1.1.3.3" xref="S8.p1.8.m8.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S8.p1.8.m8.1b"><apply id="S8.p1.8.m8.1.1.cmml" xref="S8.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S8.p1.8.m8.1.1.1.cmml" xref="S8.p1.8.m8.1.1">subscript</csymbol><ci id="S8.p1.8.m8.1.1.2.cmml" xref="S8.p1.8.m8.1.1.2">𝑅</ci><apply id="S8.p1.8.m8.1.1.3.cmml" xref="S8.p1.8.m8.1.1.3"><times id="S8.p1.8.m8.1.1.3.1.cmml" xref="S8.p1.8.m8.1.1.3.1"></times><ci id="S8.p1.8.m8.1.1.3.2.cmml" xref="S8.p1.8.m8.1.1.3.2">𝑞</ci><ci id="S8.p1.8.m8.1.1.3.3.cmml" xref="S8.p1.8.m8.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.p1.8.m8.1c">R_{qc}</annotation></semantics></math> is around the number of bits in a program, making it dominate in the early stages of
training.</p>
</div>
</section>
<section id="S9" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9 </span>Justifications for <math id="S9.1.m1.1" class="ltx_Math" alttext="\beta&lt;1" display="inline"><semantics id="S9.1.m1.1b"><mrow id="S9.1.m1.1.1" xref="S9.1.m1.1.1.cmml"><mi id="S9.1.m1.1.1.2" xref="S9.1.m1.1.1.2.cmml">β</mi><mo id="S9.1.m1.1.1.1" xref="S9.1.m1.1.1.1.cmml">&lt;</mo><mn id="S9.1.m1.1.1.3" xref="S9.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.1.m1.1c"><apply id="S9.1.m1.1.1.cmml" xref="S9.1.m1.1.1"><lt id="S9.1.m1.1.1.1.cmml" xref="S9.1.m1.1.1.1"></lt><ci id="S9.1.m1.1.1.2.cmml" xref="S9.1.m1.1.1.2">𝛽</ci><cn type="integer" id="S9.1.m1.1.1.3.cmml" xref="S9.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.1.m1.1d">\beta&lt;1</annotation></semantics></math>
</h2>

<div id="S9.p1" class="ltx_para">
<p id="S9.p1.6" class="ltx_p">During question coding, we learn a latent representation of programs in presence of a question reconstructor.
Our reconstructor is a sequence model, which can maximize the likelihood of reconstructed question without
learning meaningful latent representation of programs. Recent theory from <cite class="ltx_cite ltx_citemacro_citet">Alemi et al. (<a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite> prescribes
changes to the ELBO, setting <math id="S9.p1.1.m1.1" class="ltx_Math" alttext="\beta&lt;1" display="inline"><semantics id="S9.p1.1.m1.1a"><mrow id="S9.p1.1.m1.1.1" xref="S9.p1.1.m1.1.1.cmml"><mi id="S9.p1.1.m1.1.1.2" xref="S9.p1.1.m1.1.1.2.cmml">β</mi><mo id="S9.p1.1.m1.1.1.1" xref="S9.p1.1.m1.1.1.1.cmml">&lt;</mo><mn id="S9.p1.1.m1.1.1.3" xref="S9.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.p1.1.m1.1b"><apply id="S9.p1.1.m1.1.1.cmml" xref="S9.p1.1.m1.1.1"><lt id="S9.p1.1.m1.1.1.1.cmml" xref="S9.p1.1.m1.1.1.1"></lt><ci id="S9.p1.1.m1.1.1.2.cmml" xref="S9.p1.1.m1.1.1.2">𝛽</ci><cn type="integer" id="S9.p1.1.m1.1.1.3.cmml" xref="S9.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.1.m1.1c">\beta&lt;1</annotation></semantics></math> as a recipe to learn representations which avoid learning degenerate
latent representations in the presence of powerful decoders.
<span id="S9.p1.6.5" class="ltx_text" style="color:#000000;">Essentially, <cite class="ltx_cite ltx_citemacro_citet">Alemi et al. (<a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite> identify that up to a constant factor,
the negative log-marginal likelihood term <math id="S9.p1.2.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S9.p1.2.1.m1.1a"><mi mathcolor="#000000" id="S9.p1.2.1.m1.1.1" xref="S9.p1.2.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S9.p1.2.1.m1.1b"><ci id="S9.p1.2.1.m1.1.1.cmml" xref="S9.p1.2.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.2.1.m1.1c">D</annotation></semantics></math>=<math id="S9.p1.3.2.m2.2" class="ltx_Math" alttext="-E_{z\sim q_{\phi}(\mathbf{z}|\mathbf{x})}[\log p_{\sigma}(\mathbf{x}|\mathbf{z})]" display="inline"><semantics id="S9.p1.3.2.m2.2a"><mrow id="S9.p1.3.2.m2.2.2" xref="S9.p1.3.2.m2.2.2.cmml"><mo mathcolor="#000000" id="S9.p1.3.2.m2.2.2a" xref="S9.p1.3.2.m2.2.2.cmml">−</mo><mrow id="S9.p1.3.2.m2.2.2.1" xref="S9.p1.3.2.m2.2.2.1.cmml"><msub id="S9.p1.3.2.m2.2.2.1.3" xref="S9.p1.3.2.m2.2.2.1.3.cmml"><mi mathcolor="#000000" id="S9.p1.3.2.m2.2.2.1.3.2" xref="S9.p1.3.2.m2.2.2.1.3.2.cmml">E</mi><mrow id="S9.p1.3.2.m2.1.1.1" xref="S9.p1.3.2.m2.1.1.1.cmml"><mi mathcolor="#000000" id="S9.p1.3.2.m2.1.1.1.3" xref="S9.p1.3.2.m2.1.1.1.3.cmml">z</mi><mo mathcolor="#000000" id="S9.p1.3.2.m2.1.1.1.2" xref="S9.p1.3.2.m2.1.1.1.2.cmml">∼</mo><mrow id="S9.p1.3.2.m2.1.1.1.1" xref="S9.p1.3.2.m2.1.1.1.1.cmml"><msub id="S9.p1.3.2.m2.1.1.1.1.3" xref="S9.p1.3.2.m2.1.1.1.1.3.cmml"><mi mathcolor="#000000" id="S9.p1.3.2.m2.1.1.1.1.3.2" xref="S9.p1.3.2.m2.1.1.1.1.3.2.cmml">q</mi><mi mathcolor="#000000" id="S9.p1.3.2.m2.1.1.1.1.3.3" xref="S9.p1.3.2.m2.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S9.p1.3.2.m2.1.1.1.1.2" xref="S9.p1.3.2.m2.1.1.1.1.2.cmml">​</mo><mrow id="S9.p1.3.2.m2.1.1.1.1.1.1" xref="S9.p1.3.2.m2.1.1.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S9.p1.3.2.m2.1.1.1.1.1.1.2" xref="S9.p1.3.2.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S9.p1.3.2.m2.1.1.1.1.1.1.1" xref="S9.p1.3.2.m2.1.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S9.p1.3.2.m2.1.1.1.1.1.1.1.2" xref="S9.p1.3.2.m2.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" mathcolor="#000000" id="S9.p1.3.2.m2.1.1.1.1.1.1.1.1" xref="S9.p1.3.2.m2.1.1.1.1.1.1.1.1.cmml">|</mo><mi mathcolor="#000000" id="S9.p1.3.2.m2.1.1.1.1.1.1.1.3" xref="S9.p1.3.2.m2.1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S9.p1.3.2.m2.1.1.1.1.1.1.3" xref="S9.p1.3.2.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S9.p1.3.2.m2.2.2.1.2" xref="S9.p1.3.2.m2.2.2.1.2.cmml">​</mo><mrow id="S9.p1.3.2.m2.2.2.1.1.1" xref="S9.p1.3.2.m2.2.2.1.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S9.p1.3.2.m2.2.2.1.1.1.2" xref="S9.p1.3.2.m2.2.2.1.1.2.1.cmml">[</mo><mrow id="S9.p1.3.2.m2.2.2.1.1.1.1" xref="S9.p1.3.2.m2.2.2.1.1.1.1.cmml"><mrow id="S9.p1.3.2.m2.2.2.1.1.1.1.3" xref="S9.p1.3.2.m2.2.2.1.1.1.1.3.cmml"><mi mathcolor="#000000" id="S9.p1.3.2.m2.2.2.1.1.1.1.3.1" xref="S9.p1.3.2.m2.2.2.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S9.p1.3.2.m2.2.2.1.1.1.1.3a" xref="S9.p1.3.2.m2.2.2.1.1.1.1.3.cmml">⁡</mo><msub id="S9.p1.3.2.m2.2.2.1.1.1.1.3.2" xref="S9.p1.3.2.m2.2.2.1.1.1.1.3.2.cmml"><mi mathcolor="#000000" id="S9.p1.3.2.m2.2.2.1.1.1.1.3.2.2" xref="S9.p1.3.2.m2.2.2.1.1.1.1.3.2.2.cmml">p</mi><mi mathcolor="#000000" id="S9.p1.3.2.m2.2.2.1.1.1.1.3.2.3" xref="S9.p1.3.2.m2.2.2.1.1.1.1.3.2.3.cmml">σ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S9.p1.3.2.m2.2.2.1.1.1.1.2" xref="S9.p1.3.2.m2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S9.p1.3.2.m2.2.2.1.1.1.1.1.1" xref="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.2" xref="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1" xref="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.2" xref="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" mathcolor="#000000" id="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.1" xref="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.1.cmml">|</mo><mi mathcolor="#000000" id="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.3" xref="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.3.cmml">𝐳</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.3" xref="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathcolor="#000000" stretchy="false" id="S9.p1.3.2.m2.2.2.1.1.1.3" xref="S9.p1.3.2.m2.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S9.p1.3.2.m2.2b"><apply id="S9.p1.3.2.m2.2.2.cmml" xref="S9.p1.3.2.m2.2.2"><minus id="S9.p1.3.2.m2.2.2.2.cmml" xref="S9.p1.3.2.m2.2.2"></minus><apply id="S9.p1.3.2.m2.2.2.1.cmml" xref="S9.p1.3.2.m2.2.2.1"><times id="S9.p1.3.2.m2.2.2.1.2.cmml" xref="S9.p1.3.2.m2.2.2.1.2"></times><apply id="S9.p1.3.2.m2.2.2.1.3.cmml" xref="S9.p1.3.2.m2.2.2.1.3"><csymbol cd="ambiguous" id="S9.p1.3.2.m2.2.2.1.3.1.cmml" xref="S9.p1.3.2.m2.2.2.1.3">subscript</csymbol><ci id="S9.p1.3.2.m2.2.2.1.3.2.cmml" xref="S9.p1.3.2.m2.2.2.1.3.2">𝐸</ci><apply id="S9.p1.3.2.m2.1.1.1.cmml" xref="S9.p1.3.2.m2.1.1.1"><csymbol cd="latexml" id="S9.p1.3.2.m2.1.1.1.2.cmml" xref="S9.p1.3.2.m2.1.1.1.2">similar-to</csymbol><ci id="S9.p1.3.2.m2.1.1.1.3.cmml" xref="S9.p1.3.2.m2.1.1.1.3">𝑧</ci><apply id="S9.p1.3.2.m2.1.1.1.1.cmml" xref="S9.p1.3.2.m2.1.1.1.1"><times id="S9.p1.3.2.m2.1.1.1.1.2.cmml" xref="S9.p1.3.2.m2.1.1.1.1.2"></times><apply id="S9.p1.3.2.m2.1.1.1.1.3.cmml" xref="S9.p1.3.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S9.p1.3.2.m2.1.1.1.1.3.1.cmml" xref="S9.p1.3.2.m2.1.1.1.1.3">subscript</csymbol><ci id="S9.p1.3.2.m2.1.1.1.1.3.2.cmml" xref="S9.p1.3.2.m2.1.1.1.1.3.2">𝑞</ci><ci id="S9.p1.3.2.m2.1.1.1.1.3.3.cmml" xref="S9.p1.3.2.m2.1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S9.p1.3.2.m2.1.1.1.1.1.1.1.cmml" xref="S9.p1.3.2.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S9.p1.3.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S9.p1.3.2.m2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S9.p1.3.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S9.p1.3.2.m2.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S9.p1.3.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S9.p1.3.2.m2.1.1.1.1.1.1.1.3">𝐱</ci></apply></apply></apply></apply><apply id="S9.p1.3.2.m2.2.2.1.1.2.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1"><csymbol cd="latexml" id="S9.p1.3.2.m2.2.2.1.1.2.1.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S9.p1.3.2.m2.2.2.1.1.1.1.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.1"><times id="S9.p1.3.2.m2.2.2.1.1.1.1.2.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.1.2"></times><apply id="S9.p1.3.2.m2.2.2.1.1.1.1.3.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.1.3"><log id="S9.p1.3.2.m2.2.2.1.1.1.1.3.1.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.1.3.1"></log><apply id="S9.p1.3.2.m2.2.2.1.1.1.1.3.2.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S9.p1.3.2.m2.2.2.1.1.1.1.3.2.1.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S9.p1.3.2.m2.2.2.1.1.1.1.3.2.2.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.1.3.2.2">𝑝</ci><ci id="S9.p1.3.2.m2.2.2.1.1.1.1.3.2.3.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.1.3.2.3">𝜎</ci></apply></apply><apply id="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S9.p1.3.2.m2.2.2.1.1.1.1.1.1.1.3">𝐳</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.3.2.m2.2c">-E_{z\sim q_{\phi}(\mathbf{z}|\mathbf{x})}[\log p_{\sigma}(\mathbf{x}|\mathbf{z})]</annotation></semantics></math>, and the KL divergence term <math id="S9.p1.4.3.m3.3" class="ltx_Math" alttext="R=\mathrm{KL}(q_{\phi}(\mathbf{z}|\mathbf{x}),p(\mathbf{z}))" display="inline"><semantics id="S9.p1.4.3.m3.3a"><mrow id="S9.p1.4.3.m3.3.3" xref="S9.p1.4.3.m3.3.3.cmml"><mi mathcolor="#000000" id="S9.p1.4.3.m3.3.3.4" xref="S9.p1.4.3.m3.3.3.4.cmml">R</mi><mo mathcolor="#000000" id="S9.p1.4.3.m3.3.3.3" xref="S9.p1.4.3.m3.3.3.3.cmml">=</mo><mrow id="S9.p1.4.3.m3.3.3.2" xref="S9.p1.4.3.m3.3.3.2.cmml"><mi mathcolor="#000000" id="S9.p1.4.3.m3.3.3.2.4" xref="S9.p1.4.3.m3.3.3.2.4.cmml">KL</mi><mo lspace="0em" rspace="0em" id="S9.p1.4.3.m3.3.3.2.3" xref="S9.p1.4.3.m3.3.3.2.3.cmml">​</mo><mrow id="S9.p1.4.3.m3.3.3.2.2.2" xref="S9.p1.4.3.m3.3.3.2.2.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S9.p1.4.3.m3.3.3.2.2.2.3" xref="S9.p1.4.3.m3.3.3.2.2.3.cmml">(</mo><mrow id="S9.p1.4.3.m3.2.2.1.1.1.1" xref="S9.p1.4.3.m3.2.2.1.1.1.1.cmml"><msub id="S9.p1.4.3.m3.2.2.1.1.1.1.3" xref="S9.p1.4.3.m3.2.2.1.1.1.1.3.cmml"><mi mathcolor="#000000" id="S9.p1.4.3.m3.2.2.1.1.1.1.3.2" xref="S9.p1.4.3.m3.2.2.1.1.1.1.3.2.cmml">q</mi><mi mathcolor="#000000" id="S9.p1.4.3.m3.2.2.1.1.1.1.3.3" xref="S9.p1.4.3.m3.2.2.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S9.p1.4.3.m3.2.2.1.1.1.1.2" xref="S9.p1.4.3.m3.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S9.p1.4.3.m3.2.2.1.1.1.1.1.1" xref="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.2" xref="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1" xref="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.2" xref="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" mathcolor="#000000" id="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.1" xref="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.1.cmml">|</mo><mi mathcolor="#000000" id="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.3" xref="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.3" xref="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathcolor="#000000" id="S9.p1.4.3.m3.3.3.2.2.2.4" xref="S9.p1.4.3.m3.3.3.2.2.3.cmml">,</mo><mrow id="S9.p1.4.3.m3.3.3.2.2.2.2" xref="S9.p1.4.3.m3.3.3.2.2.2.2.cmml"><mi mathcolor="#000000" id="S9.p1.4.3.m3.3.3.2.2.2.2.2" xref="S9.p1.4.3.m3.3.3.2.2.2.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S9.p1.4.3.m3.3.3.2.2.2.2.1" xref="S9.p1.4.3.m3.3.3.2.2.2.2.1.cmml">​</mo><mrow id="S9.p1.4.3.m3.3.3.2.2.2.2.3.2" xref="S9.p1.4.3.m3.3.3.2.2.2.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S9.p1.4.3.m3.3.3.2.2.2.2.3.2.1" xref="S9.p1.4.3.m3.3.3.2.2.2.2.cmml">(</mo><mi mathcolor="#000000" id="S9.p1.4.3.m3.1.1" xref="S9.p1.4.3.m3.1.1.cmml">𝐳</mi><mo mathcolor="#000000" stretchy="false" id="S9.p1.4.3.m3.3.3.2.2.2.2.3.2.2" xref="S9.p1.4.3.m3.3.3.2.2.2.2.cmml">)</mo></mrow></mrow><mo mathcolor="#000000" stretchy="false" id="S9.p1.4.3.m3.3.3.2.2.2.5" xref="S9.p1.4.3.m3.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S9.p1.4.3.m3.3b"><apply id="S9.p1.4.3.m3.3.3.cmml" xref="S9.p1.4.3.m3.3.3"><eq id="S9.p1.4.3.m3.3.3.3.cmml" xref="S9.p1.4.3.m3.3.3.3"></eq><ci id="S9.p1.4.3.m3.3.3.4.cmml" xref="S9.p1.4.3.m3.3.3.4">𝑅</ci><apply id="S9.p1.4.3.m3.3.3.2.cmml" xref="S9.p1.4.3.m3.3.3.2"><times id="S9.p1.4.3.m3.3.3.2.3.cmml" xref="S9.p1.4.3.m3.3.3.2.3"></times><ci id="S9.p1.4.3.m3.3.3.2.4.cmml" xref="S9.p1.4.3.m3.3.3.2.4">KL</ci><interval closure="open" id="S9.p1.4.3.m3.3.3.2.2.3.cmml" xref="S9.p1.4.3.m3.3.3.2.2.2"><apply id="S9.p1.4.3.m3.2.2.1.1.1.1.cmml" xref="S9.p1.4.3.m3.2.2.1.1.1.1"><times id="S9.p1.4.3.m3.2.2.1.1.1.1.2.cmml" xref="S9.p1.4.3.m3.2.2.1.1.1.1.2"></times><apply id="S9.p1.4.3.m3.2.2.1.1.1.1.3.cmml" xref="S9.p1.4.3.m3.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S9.p1.4.3.m3.2.2.1.1.1.1.3.1.cmml" xref="S9.p1.4.3.m3.2.2.1.1.1.1.3">subscript</csymbol><ci id="S9.p1.4.3.m3.2.2.1.1.1.1.3.2.cmml" xref="S9.p1.4.3.m3.2.2.1.1.1.1.3.2">𝑞</ci><ci id="S9.p1.4.3.m3.2.2.1.1.1.1.3.3.cmml" xref="S9.p1.4.3.m3.2.2.1.1.1.1.3.3">italic-ϕ</ci></apply><apply id="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S9.p1.4.3.m3.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.1.cmml" xref="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.2.cmml" xref="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.3.cmml" xref="S9.p1.4.3.m3.2.2.1.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S9.p1.4.3.m3.3.3.2.2.2.2.cmml" xref="S9.p1.4.3.m3.3.3.2.2.2.2"><times id="S9.p1.4.3.m3.3.3.2.2.2.2.1.cmml" xref="S9.p1.4.3.m3.3.3.2.2.2.2.1"></times><ci id="S9.p1.4.3.m3.3.3.2.2.2.2.2.cmml" xref="S9.p1.4.3.m3.3.3.2.2.2.2.2">𝑝</ci><ci id="S9.p1.4.3.m3.1.1.cmml" xref="S9.p1.4.3.m3.1.1">𝐳</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.4.3.m3.3c">R=\mathrm{KL}(q_{\phi}(\mathbf{z}|\mathbf{x}),p(\mathbf{z}))</annotation></semantics></math>
bound the mutual information between the data <math id="S9.p1.5.4.m4.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S9.p1.5.4.m4.1a"><mi mathcolor="#000000" id="S9.p1.5.4.m4.1.1" xref="S9.p1.5.4.m4.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S9.p1.5.4.m4.1b"><ci id="S9.p1.5.4.m4.1.1.cmml" xref="S9.p1.5.4.m4.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.5.4.m4.1c">\mathbf{x}</annotation></semantics></math> and the latent variable <math id="S9.p1.6.5.m5.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S9.p1.6.5.m5.1a"><mi mathcolor="#000000" id="S9.p1.6.5.m5.1.1" xref="S9.p1.6.5.m5.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S9.p1.6.5.m5.1b"><ci id="S9.p1.6.5.m5.1.1.cmml" xref="S9.p1.6.5.m5.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.6.5.m5.1c">\mathbf{z}</annotation></semantics></math> as follows:</span></p>
<table id="S9.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S9.E13.m1.2" class="ltx_Math" alttext="{\color[rgb]{0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}\pgfsys@color@gray@stroke{0}\pgfsys@color@gray@fill{0}H-D\leq I(\mathbf{x},\mathbf{z})\leq R}" display="block"><semantics id="S9.E13.m1.2a"><mrow id="S9.E13.m1.2.3" xref="S9.E13.m1.2.3.cmml"><mrow id="S9.E13.m1.2.3.2" xref="S9.E13.m1.2.3.2.cmml"><mi mathcolor="#000000" id="S9.E13.m1.2.3.2.2" xref="S9.E13.m1.2.3.2.2.cmml">H</mi><mo mathcolor="#000000" id="S9.E13.m1.2.3.2.1" xref="S9.E13.m1.2.3.2.1.cmml">−</mo><mi mathcolor="#000000" id="S9.E13.m1.2.3.2.3" xref="S9.E13.m1.2.3.2.3.cmml">D</mi></mrow><mo mathcolor="#000000" id="S9.E13.m1.2.3.3" xref="S9.E13.m1.2.3.3.cmml">≤</mo><mrow id="S9.E13.m1.2.3.4" xref="S9.E13.m1.2.3.4.cmml"><mi mathcolor="#000000" id="S9.E13.m1.2.3.4.2" xref="S9.E13.m1.2.3.4.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="S9.E13.m1.2.3.4.1" xref="S9.E13.m1.2.3.4.1.cmml">​</mo><mrow id="S9.E13.m1.2.3.4.3.2" xref="S9.E13.m1.2.3.4.3.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S9.E13.m1.2.3.4.3.2.1" xref="S9.E13.m1.2.3.4.3.1.cmml">(</mo><mi mathcolor="#000000" id="S9.E13.m1.1.1" xref="S9.E13.m1.1.1.cmml">𝐱</mi><mo mathcolor="#000000" id="S9.E13.m1.2.3.4.3.2.2" xref="S9.E13.m1.2.3.4.3.1.cmml">,</mo><mi mathcolor="#000000" id="S9.E13.m1.2.2" xref="S9.E13.m1.2.2.cmml">𝐳</mi><mo mathcolor="#000000" stretchy="false" id="S9.E13.m1.2.3.4.3.2.3" xref="S9.E13.m1.2.3.4.3.1.cmml">)</mo></mrow></mrow><mo mathcolor="#000000" id="S9.E13.m1.2.3.5" xref="S9.E13.m1.2.3.5.cmml">≤</mo><mi mathcolor="#000000" id="S9.E13.m1.2.3.6" xref="S9.E13.m1.2.3.6.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="S9.E13.m1.2b"><apply id="S9.E13.m1.2.3.cmml" xref="S9.E13.m1.2.3"><and id="S9.E13.m1.2.3a.cmml" xref="S9.E13.m1.2.3"></and><apply id="S9.E13.m1.2.3b.cmml" xref="S9.E13.m1.2.3"><leq id="S9.E13.m1.2.3.3.cmml" xref="S9.E13.m1.2.3.3"></leq><apply id="S9.E13.m1.2.3.2.cmml" xref="S9.E13.m1.2.3.2"><minus id="S9.E13.m1.2.3.2.1.cmml" xref="S9.E13.m1.2.3.2.1"></minus><ci id="S9.E13.m1.2.3.2.2.cmml" xref="S9.E13.m1.2.3.2.2">𝐻</ci><ci id="S9.E13.m1.2.3.2.3.cmml" xref="S9.E13.m1.2.3.2.3">𝐷</ci></apply><apply id="S9.E13.m1.2.3.4.cmml" xref="S9.E13.m1.2.3.4"><times id="S9.E13.m1.2.3.4.1.cmml" xref="S9.E13.m1.2.3.4.1"></times><ci id="S9.E13.m1.2.3.4.2.cmml" xref="S9.E13.m1.2.3.4.2">𝐼</ci><interval closure="open" id="S9.E13.m1.2.3.4.3.1.cmml" xref="S9.E13.m1.2.3.4.3.2"><ci id="S9.E13.m1.1.1.cmml" xref="S9.E13.m1.1.1">𝐱</ci><ci id="S9.E13.m1.2.2.cmml" xref="S9.E13.m1.2.2">𝐳</ci></interval></apply></apply><apply id="S9.E13.m1.2.3c.cmml" xref="S9.E13.m1.2.3"><leq id="S9.E13.m1.2.3.5.cmml" xref="S9.E13.m1.2.3.5"></leq><share href="#S9.E13.m1.2.3.4.cmml" id="S9.E13.m1.2.3d.cmml" xref="S9.E13.m1.2.3"></share><ci id="S9.E13.m1.2.3.6.cmml" xref="S9.E13.m1.2.3.6">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.E13.m1.2c">{\color[rgb]{0,0,0}\definecolor[named]{pgfstrokecolor}{rgb}{0,0,0}\pgfsys@color@gray@stroke{0}\pgfsys@color@gray@fill{0}H-D\leq I(\mathbf{x},\mathbf{z})\leq R}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S9.p1.15" class="ltx_p"><span id="S9.p1.14.8" class="ltx_text" style="color:#000000;">where <math id="S9.p1.7.1.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S9.p1.7.1.m1.1a"><mi mathcolor="#000000" id="S9.p1.7.1.m1.1.1" xref="S9.p1.7.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S9.p1.7.1.m1.1b"><ci id="S9.p1.7.1.m1.1.1.cmml" xref="S9.p1.7.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.7.1.m1.1c">H</annotation></semantics></math> is the entropy of the data, which is a constant.
One can immediately notice that the standard <math id="S9.p1.8.2.m2.1" class="ltx_Math" alttext="\mathrm{elbo}=-D-R" display="inline"><semantics id="S9.p1.8.2.m2.1a"><mrow id="S9.p1.8.2.m2.1.1" xref="S9.p1.8.2.m2.1.1.cmml"><mi mathcolor="#000000" id="S9.p1.8.2.m2.1.1.2" xref="S9.p1.8.2.m2.1.1.2.cmml">elbo</mi><mo mathcolor="#000000" id="S9.p1.8.2.m2.1.1.1" xref="S9.p1.8.2.m2.1.1.1.cmml">=</mo><mrow id="S9.p1.8.2.m2.1.1.3" xref="S9.p1.8.2.m2.1.1.3.cmml"><mrow id="S9.p1.8.2.m2.1.1.3.2" xref="S9.p1.8.2.m2.1.1.3.2.cmml"><mo mathcolor="#000000" id="S9.p1.8.2.m2.1.1.3.2a" xref="S9.p1.8.2.m2.1.1.3.2.cmml">−</mo><mi mathcolor="#000000" id="S9.p1.8.2.m2.1.1.3.2.2" xref="S9.p1.8.2.m2.1.1.3.2.2.cmml">D</mi></mrow><mo mathcolor="#000000" id="S9.p1.8.2.m2.1.1.3.1" xref="S9.p1.8.2.m2.1.1.3.1.cmml">−</mo><mi mathcolor="#000000" id="S9.p1.8.2.m2.1.1.3.3" xref="S9.p1.8.2.m2.1.1.3.3.cmml">R</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S9.p1.8.2.m2.1b"><apply id="S9.p1.8.2.m2.1.1.cmml" xref="S9.p1.8.2.m2.1.1"><eq id="S9.p1.8.2.m2.1.1.1.cmml" xref="S9.p1.8.2.m2.1.1.1"></eq><ci id="S9.p1.8.2.m2.1.1.2.cmml" xref="S9.p1.8.2.m2.1.1.2">elbo</ci><apply id="S9.p1.8.2.m2.1.1.3.cmml" xref="S9.p1.8.2.m2.1.1.3"><minus id="S9.p1.8.2.m2.1.1.3.1.cmml" xref="S9.p1.8.2.m2.1.1.3.1"></minus><apply id="S9.p1.8.2.m2.1.1.3.2.cmml" xref="S9.p1.8.2.m2.1.1.3.2"><minus id="S9.p1.8.2.m2.1.1.3.2.1.cmml" xref="S9.p1.8.2.m2.1.1.3.2"></minus><ci id="S9.p1.8.2.m2.1.1.3.2.2.cmml" xref="S9.p1.8.2.m2.1.1.3.2.2">𝐷</ci></apply><ci id="S9.p1.8.2.m2.1.1.3.3.cmml" xref="S9.p1.8.2.m2.1.1.3.3">𝑅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.8.2.m2.1c">\mathrm{elbo}=-D-R</annotation></semantics></math>. This means that for the same
value of the <math id="S9.p1.9.3.m3.1" class="ltx_Math" alttext="\mathrm{elbo}" display="inline"><semantics id="S9.p1.9.3.m3.1a"><mi mathcolor="#000000" id="S9.p1.9.3.m3.1.1" xref="S9.p1.9.3.m3.1.1.cmml">elbo</mi><annotation-xml encoding="MathML-Content" id="S9.p1.9.3.m3.1b"><ci id="S9.p1.9.3.m3.1.1.cmml" xref="S9.p1.9.3.m3.1.1">elbo</ci></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.9.3.m3.1c">\mathrm{elbo}</annotation></semantics></math> one can get different models which make drastically different usage of the
latent variable (based on the achieved values of <math id="S9.p1.10.4.m4.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S9.p1.10.4.m4.1a"><mi mathcolor="#000000" id="S9.p1.10.4.m4.1.1" xref="S9.p1.10.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S9.p1.10.4.m4.1b"><ci id="S9.p1.10.4.m4.1.1.cmml" xref="S9.p1.10.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.10.4.m4.1c">D</annotation></semantics></math> and <math id="S9.p1.11.5.m5.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S9.p1.11.5.m5.1a"><mi mathcolor="#000000" id="S9.p1.11.5.m5.1.1" xref="S9.p1.11.5.m5.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S9.p1.11.5.m5.1b"><ci id="S9.p1.11.5.m5.1.1.cmml" xref="S9.p1.11.5.m5.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.11.5.m5.1c">R</annotation></semantics></math>). Thus, one way to achieve
a desired behavior (of say high mutual information <math id="S9.p1.12.6.m6.2" class="ltx_Math" alttext="I(\mathbf{x},\mathbf{z})" display="inline"><semantics id="S9.p1.12.6.m6.2a"><mrow id="S9.p1.12.6.m6.2.3" xref="S9.p1.12.6.m6.2.3.cmml"><mi mathcolor="#000000" id="S9.p1.12.6.m6.2.3.2" xref="S9.p1.12.6.m6.2.3.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="S9.p1.12.6.m6.2.3.1" xref="S9.p1.12.6.m6.2.3.1.cmml">​</mo><mrow id="S9.p1.12.6.m6.2.3.3.2" xref="S9.p1.12.6.m6.2.3.3.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S9.p1.12.6.m6.2.3.3.2.1" xref="S9.p1.12.6.m6.2.3.3.1.cmml">(</mo><mi mathcolor="#000000" id="S9.p1.12.6.m6.1.1" xref="S9.p1.12.6.m6.1.1.cmml">𝐱</mi><mo mathcolor="#000000" id="S9.p1.12.6.m6.2.3.3.2.2" xref="S9.p1.12.6.m6.2.3.3.1.cmml">,</mo><mi mathcolor="#000000" id="S9.p1.12.6.m6.2.2" xref="S9.p1.12.6.m6.2.2.cmml">𝐳</mi><mo mathcolor="#000000" stretchy="false" id="S9.p1.12.6.m6.2.3.3.2.3" xref="S9.p1.12.6.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S9.p1.12.6.m6.2b"><apply id="S9.p1.12.6.m6.2.3.cmml" xref="S9.p1.12.6.m6.2.3"><times id="S9.p1.12.6.m6.2.3.1.cmml" xref="S9.p1.12.6.m6.2.3.1"></times><ci id="S9.p1.12.6.m6.2.3.2.cmml" xref="S9.p1.12.6.m6.2.3.2">𝐼</ci><interval closure="open" id="S9.p1.12.6.m6.2.3.3.1.cmml" xref="S9.p1.12.6.m6.2.3.3.2"><ci id="S9.p1.12.6.m6.1.1.cmml" xref="S9.p1.12.6.m6.1.1">𝐱</ci><ci id="S9.p1.12.6.m6.2.2.cmml" xref="S9.p1.12.6.m6.2.2">𝐳</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.12.6.m6.2c">I(\mathbf{x},\mathbf{z})</annotation></semantics></math>), is to set <math id="S9.p1.13.7.m7.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S9.p1.13.7.m7.1a"><mi mathcolor="#000000" id="S9.p1.13.7.m7.1.1" xref="S9.p1.13.7.m7.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S9.p1.13.7.m7.1b"><ci id="S9.p1.13.7.m7.1.1.cmml" xref="S9.p1.13.7.m7.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.13.7.m7.1c">\beta</annotation></semantics></math> to a lower
value than the standard <math id="S9.p1.14.8.m8.1" class="ltx_Math" alttext="\mathrm{elbo}" display="inline"><semantics id="S9.p1.14.8.m8.1a"><mi mathcolor="#000000" id="S9.p1.14.8.m8.1.1" xref="S9.p1.14.8.m8.1.1.cmml">elbo</mi><annotation-xml encoding="MathML-Content" id="S9.p1.14.8.m8.1b"><ci id="S9.p1.14.8.m8.1.1.cmml" xref="S9.p1.14.8.m8.1.1">elbo</ci></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.14.8.m8.1c">\mathrm{elbo}</annotation></semantics></math> (c.f. Eqn. 6 in <cite class="ltx_cite ltx_citemacro_citet">Alemi et al. (<a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>.)</span>
This aligns with our goal in question coding, and so we use <math id="S9.p1.15.m1.1" class="ltx_Math" alttext="\beta&lt;1" display="inline"><semantics id="S9.p1.15.m1.1a"><mrow id="S9.p1.15.m1.1.1" xref="S9.p1.15.m1.1.1.cmml"><mi id="S9.p1.15.m1.1.1.2" xref="S9.p1.15.m1.1.1.2.cmml">β</mi><mo id="S9.p1.15.m1.1.1.1" xref="S9.p1.15.m1.1.1.1.cmml">&lt;</mo><mn id="S9.p1.15.m1.1.1.3" xref="S9.p1.15.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S9.p1.15.m1.1b"><apply id="S9.p1.15.m1.1.1.cmml" xref="S9.p1.15.m1.1.1"><lt id="S9.p1.15.m1.1.1.1.cmml" xref="S9.p1.15.m1.1.1.1"></lt><ci id="S9.p1.15.m1.1.1.2.cmml" xref="S9.p1.15.m1.1.1.2">𝛽</ci><cn type="integer" id="S9.p1.15.m1.1.1.3.cmml" xref="S9.p1.15.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.p1.15.m1.1c">\beta&lt;1</annotation></semantics></math>.</p>
</div>
</section>
<section id="S10" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">10 </span>Implementation Details for SHAPES</h2>

<div id="S10.p1" class="ltx_para">
<p id="S10.p1.1" class="ltx_p">We provide more details on the modeling choices and hyperparameters used to
optimize the models in the main paper.</p>
</div>
<div id="S10.p2" class="ltx_para ltx_noindent">
<p id="S10.p2.1" class="ltx_p"><span id="S10.p2.1.1" class="ltx_text ltx_font_bold">Sequence to Sequence Models:</span> <span id="S10.p2.1.2" class="ltx_text" style="color:#000000;">All our sequence to sequence models described in the main paper (Section. 2)
are based on LSTM cells with a hidden state of 128 units, single layer depth,
and have a word embedding of 32 dimensions for both the question as well
as the program vocabulary.</span></p>
</div>
<div id="S10.p3" class="ltx_para">
<p id="S10.p3.1" class="ltx_p">The when sampling from a model, we sample till the maximum sequence length
of 15 for questions and 7 for programs.</p>
</div>
<div id="S10.p4" class="ltx_para ltx_noindent">
<p id="S10.p4.1" class="ltx_p"><span id="S10.p4.1.1" class="ltx_text ltx_font_bold">Image CNN:</span> The SHAPES images are of <span id="S10.p4.1.2" class="ltx_text ltx_font_typewriter">30x30</span>
in size and are processed by a two layered convolutional neural network,
which in its first layer has a <span id="S10.p4.1.3" class="ltx_text ltx_font_typewriter">10x10</span> filters applied at a stride
of 10, and in the second layer, it does <span id="S10.p4.1.4" class="ltx_text ltx_font_typewriter">1x1</span> convolution applied
at a stride of 1. Channel widths for both the layers are 64 dimensional.</p>
</div>
<div id="S10.p5" class="ltx_para ltx_noindent">
<p id="S10.p5.3" class="ltx_p"><span id="S10.p5.3.1" class="ltx_text ltx_font_bold">Moving average baseline:</span> For a reward <math id="S10.p5.1.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="S10.p5.1.m1.1a"><mi id="S10.p5.1.m1.1.1" xref="S10.p5.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S10.p5.1.m1.1b"><ci id="S10.p5.1.m1.1.1.cmml" xref="S10.p5.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S10.p5.1.m1.1c">R</annotation></semantics></math>, we use an
action independent baseline <math id="S10.p5.2.m2.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S10.p5.2.m2.1a"><mi id="S10.p5.2.m2.1.1" xref="S10.p5.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S10.p5.2.m2.1b"><ci id="S10.p5.2.m2.1.1.cmml" xref="S10.p5.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S10.p5.2.m2.1c">b</annotation></semantics></math> to reduce variance, which tracks the moving average of the
rewards seen so far during training. Concretely, the form for
the <math id="S10.p5.3.m3.1" class="ltx_Math" alttext="q(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S10.p5.3.m3.1a"><mrow id="S10.p5.3.m3.1.1" xref="S10.p5.3.m3.1.1.cmml"><mi id="S10.p5.3.m3.1.1.3" xref="S10.p5.3.m3.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S10.p5.3.m3.1.1.2" xref="S10.p5.3.m3.1.1.2.cmml">​</mo><mrow id="S10.p5.3.m3.1.1.1.1" xref="S10.p5.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S10.p5.3.m3.1.1.1.1.2" xref="S10.p5.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S10.p5.3.m3.1.1.1.1.1" xref="S10.p5.3.m3.1.1.1.1.1.cmml"><mi id="S10.p5.3.m3.1.1.1.1.1.2" xref="S10.p5.3.m3.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S10.p5.3.m3.1.1.1.1.1.1" xref="S10.p5.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S10.p5.3.m3.1.1.1.1.1.3" xref="S10.p5.3.m3.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S10.p5.3.m3.1.1.1.1.3" xref="S10.p5.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S10.p5.3.m3.1b"><apply id="S10.p5.3.m3.1.1.cmml" xref="S10.p5.3.m3.1.1"><times id="S10.p5.3.m3.1.1.2.cmml" xref="S10.p5.3.m3.1.1.2"></times><ci id="S10.p5.3.m3.1.1.3.cmml" xref="S10.p5.3.m3.1.1.3">𝑞</ci><apply id="S10.p5.3.m3.1.1.1.1.1.cmml" xref="S10.p5.3.m3.1.1.1.1"><csymbol cd="latexml" id="S10.p5.3.m3.1.1.1.1.1.1.cmml" xref="S10.p5.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S10.p5.3.m3.1.1.1.1.1.2.cmml" xref="S10.p5.3.m3.1.1.1.1.1.2">𝐳</ci><ci id="S10.p5.3.m3.1.1.1.1.1.3.cmml" xref="S10.p5.3.m3.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.p5.3.m3.1c">q(\mathbf{z}|\mathbf{x})</annotation></semantics></math> network is:</p>
<table id="S10.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S10.E14.m1.3" class="ltx_Math" alttext="\nabla J(\theta)=\mathbf{E}_{\mathbf{z}\sim q(\mathbf{z}|\mathbf{x})}[(R-b_{t})\nabla\log q(\mathbf{z}|\mathbf{x})]" display="block"><semantics id="S10.E14.m1.3a"><mrow id="S10.E14.m1.3.3" xref="S10.E14.m1.3.3.cmml"><mrow id="S10.E14.m1.3.3.3" xref="S10.E14.m1.3.3.3.cmml"><mrow id="S10.E14.m1.3.3.3.2" xref="S10.E14.m1.3.3.3.2.cmml"><mo rspace="0.167em" id="S10.E14.m1.3.3.3.2.1" xref="S10.E14.m1.3.3.3.2.1.cmml">∇</mo><mi id="S10.E14.m1.3.3.3.2.2" xref="S10.E14.m1.3.3.3.2.2.cmml">J</mi></mrow><mo lspace="0em" rspace="0em" id="S10.E14.m1.3.3.3.1" xref="S10.E14.m1.3.3.3.1.cmml">​</mo><mrow id="S10.E14.m1.3.3.3.3.2" xref="S10.E14.m1.3.3.3.cmml"><mo stretchy="false" id="S10.E14.m1.3.3.3.3.2.1" xref="S10.E14.m1.3.3.3.cmml">(</mo><mi id="S10.E14.m1.2.2" xref="S10.E14.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S10.E14.m1.3.3.3.3.2.2" xref="S10.E14.m1.3.3.3.cmml">)</mo></mrow></mrow><mo id="S10.E14.m1.3.3.2" xref="S10.E14.m1.3.3.2.cmml">=</mo><mrow id="S10.E14.m1.3.3.1" xref="S10.E14.m1.3.3.1.cmml"><msub id="S10.E14.m1.3.3.1.3" xref="S10.E14.m1.3.3.1.3.cmml"><mi id="S10.E14.m1.3.3.1.3.2" xref="S10.E14.m1.3.3.1.3.2.cmml">𝐄</mi><mrow id="S10.E14.m1.1.1.1" xref="S10.E14.m1.1.1.1.cmml"><mi id="S10.E14.m1.1.1.1.3" xref="S10.E14.m1.1.1.1.3.cmml">𝐳</mi><mo id="S10.E14.m1.1.1.1.2" xref="S10.E14.m1.1.1.1.2.cmml">∼</mo><mrow id="S10.E14.m1.1.1.1.1" xref="S10.E14.m1.1.1.1.1.cmml"><mi id="S10.E14.m1.1.1.1.1.3" xref="S10.E14.m1.1.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S10.E14.m1.1.1.1.1.2" xref="S10.E14.m1.1.1.1.1.2.cmml">​</mo><mrow id="S10.E14.m1.1.1.1.1.1.1" xref="S10.E14.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S10.E14.m1.1.1.1.1.1.1.2" xref="S10.E14.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S10.E14.m1.1.1.1.1.1.1.1" xref="S10.E14.m1.1.1.1.1.1.1.1.cmml"><mi id="S10.E14.m1.1.1.1.1.1.1.1.2" xref="S10.E14.m1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S10.E14.m1.1.1.1.1.1.1.1.1" xref="S10.E14.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S10.E14.m1.1.1.1.1.1.1.1.3" xref="S10.E14.m1.1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S10.E14.m1.1.1.1.1.1.1.3" xref="S10.E14.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S10.E14.m1.3.3.1.2" xref="S10.E14.m1.3.3.1.2.cmml">​</mo><mrow id="S10.E14.m1.3.3.1.1.1" xref="S10.E14.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S10.E14.m1.3.3.1.1.1.2" xref="S10.E14.m1.3.3.1.1.2.1.cmml">[</mo><mrow id="S10.E14.m1.3.3.1.1.1.1" xref="S10.E14.m1.3.3.1.1.1.1.cmml"><mrow id="S10.E14.m1.3.3.1.1.1.1.1.1" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S10.E14.m1.3.3.1.1.1.1.1.1.2" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S10.E14.m1.3.3.1.1.1.1.1.1.1" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S10.E14.m1.3.3.1.1.1.1.1.1.1.2" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.2.cmml">R</mi><mo id="S10.E14.m1.3.3.1.1.1.1.1.1.1.1" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S10.E14.m1.3.3.1.1.1.1.1.1.1.3" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S10.E14.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S10.E14.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S10.E14.m1.3.3.1.1.1.1.1.1.3" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S10.E14.m1.3.3.1.1.1.1.3" xref="S10.E14.m1.3.3.1.1.1.1.3.cmml">​</mo><mrow id="S10.E14.m1.3.3.1.1.1.1.4" xref="S10.E14.m1.3.3.1.1.1.1.4.cmml"><mrow id="S10.E14.m1.3.3.1.1.1.1.4.1" xref="S10.E14.m1.3.3.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S10.E14.m1.3.3.1.1.1.1.4.1.1" xref="S10.E14.m1.3.3.1.1.1.1.4.1.1.cmml">∇</mo><mi id="S10.E14.m1.3.3.1.1.1.1.4.1.2" xref="S10.E14.m1.3.3.1.1.1.1.4.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S10.E14.m1.3.3.1.1.1.1.4a" xref="S10.E14.m1.3.3.1.1.1.1.4.cmml">⁡</mo><mi id="S10.E14.m1.3.3.1.1.1.1.4.2" xref="S10.E14.m1.3.3.1.1.1.1.4.2.cmml">q</mi></mrow><mo lspace="0em" rspace="0em" id="S10.E14.m1.3.3.1.1.1.1.3a" xref="S10.E14.m1.3.3.1.1.1.1.3.cmml">​</mo><mrow id="S10.E14.m1.3.3.1.1.1.1.2.1" xref="S10.E14.m1.3.3.1.1.1.1.2.1.1.cmml"><mo stretchy="false" id="S10.E14.m1.3.3.1.1.1.1.2.1.2" xref="S10.E14.m1.3.3.1.1.1.1.2.1.1.cmml">(</mo><mrow id="S10.E14.m1.3.3.1.1.1.1.2.1.1" xref="S10.E14.m1.3.3.1.1.1.1.2.1.1.cmml"><mi id="S10.E14.m1.3.3.1.1.1.1.2.1.1.2" xref="S10.E14.m1.3.3.1.1.1.1.2.1.1.2.cmml">𝐳</mi><mo fence="false" id="S10.E14.m1.3.3.1.1.1.1.2.1.1.1" xref="S10.E14.m1.3.3.1.1.1.1.2.1.1.1.cmml">|</mo><mi id="S10.E14.m1.3.3.1.1.1.1.2.1.1.3" xref="S10.E14.m1.3.3.1.1.1.1.2.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S10.E14.m1.3.3.1.1.1.1.2.1.3" xref="S10.E14.m1.3.3.1.1.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S10.E14.m1.3.3.1.1.1.3" xref="S10.E14.m1.3.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S10.E14.m1.3b"><apply id="S10.E14.m1.3.3.cmml" xref="S10.E14.m1.3.3"><eq id="S10.E14.m1.3.3.2.cmml" xref="S10.E14.m1.3.3.2"></eq><apply id="S10.E14.m1.3.3.3.cmml" xref="S10.E14.m1.3.3.3"><times id="S10.E14.m1.3.3.3.1.cmml" xref="S10.E14.m1.3.3.3.1"></times><apply id="S10.E14.m1.3.3.3.2.cmml" xref="S10.E14.m1.3.3.3.2"><ci id="S10.E14.m1.3.3.3.2.1.cmml" xref="S10.E14.m1.3.3.3.2.1">∇</ci><ci id="S10.E14.m1.3.3.3.2.2.cmml" xref="S10.E14.m1.3.3.3.2.2">𝐽</ci></apply><ci id="S10.E14.m1.2.2.cmml" xref="S10.E14.m1.2.2">𝜃</ci></apply><apply id="S10.E14.m1.3.3.1.cmml" xref="S10.E14.m1.3.3.1"><times id="S10.E14.m1.3.3.1.2.cmml" xref="S10.E14.m1.3.3.1.2"></times><apply id="S10.E14.m1.3.3.1.3.cmml" xref="S10.E14.m1.3.3.1.3"><csymbol cd="ambiguous" id="S10.E14.m1.3.3.1.3.1.cmml" xref="S10.E14.m1.3.3.1.3">subscript</csymbol><ci id="S10.E14.m1.3.3.1.3.2.cmml" xref="S10.E14.m1.3.3.1.3.2">𝐄</ci><apply id="S10.E14.m1.1.1.1.cmml" xref="S10.E14.m1.1.1.1"><csymbol cd="latexml" id="S10.E14.m1.1.1.1.2.cmml" xref="S10.E14.m1.1.1.1.2">similar-to</csymbol><ci id="S10.E14.m1.1.1.1.3.cmml" xref="S10.E14.m1.1.1.1.3">𝐳</ci><apply id="S10.E14.m1.1.1.1.1.cmml" xref="S10.E14.m1.1.1.1.1"><times id="S10.E14.m1.1.1.1.1.2.cmml" xref="S10.E14.m1.1.1.1.1.2"></times><ci id="S10.E14.m1.1.1.1.1.3.cmml" xref="S10.E14.m1.1.1.1.1.3">𝑞</ci><apply id="S10.E14.m1.1.1.1.1.1.1.1.cmml" xref="S10.E14.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S10.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="S10.E14.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S10.E14.m1.1.1.1.1.1.1.1.2.cmml" xref="S10.E14.m1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S10.E14.m1.1.1.1.1.1.1.1.3.cmml" xref="S10.E14.m1.1.1.1.1.1.1.1.3">𝐱</ci></apply></apply></apply></apply><apply id="S10.E14.m1.3.3.1.1.2.cmml" xref="S10.E14.m1.3.3.1.1.1"><csymbol cd="latexml" id="S10.E14.m1.3.3.1.1.2.1.cmml" xref="S10.E14.m1.3.3.1.1.1.2">delimited-[]</csymbol><apply id="S10.E14.m1.3.3.1.1.1.1.cmml" xref="S10.E14.m1.3.3.1.1.1.1"><times id="S10.E14.m1.3.3.1.1.1.1.3.cmml" xref="S10.E14.m1.3.3.1.1.1.1.3"></times><apply id="S10.E14.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S10.E14.m1.3.3.1.1.1.1.1.1"><minus id="S10.E14.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.1"></minus><ci id="S10.E14.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.2">𝑅</ci><apply id="S10.E14.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S10.E14.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S10.E14.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S10.E14.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S10.E14.m1.3.3.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S10.E14.m1.3.3.1.1.1.1.4.cmml" xref="S10.E14.m1.3.3.1.1.1.1.4"><apply id="S10.E14.m1.3.3.1.1.1.1.4.1.cmml" xref="S10.E14.m1.3.3.1.1.1.1.4.1"><ci id="S10.E14.m1.3.3.1.1.1.1.4.1.1.cmml" xref="S10.E14.m1.3.3.1.1.1.1.4.1.1">∇</ci><log id="S10.E14.m1.3.3.1.1.1.1.4.1.2.cmml" xref="S10.E14.m1.3.3.1.1.1.1.4.1.2"></log></apply><ci id="S10.E14.m1.3.3.1.1.1.1.4.2.cmml" xref="S10.E14.m1.3.3.1.1.1.1.4.2">𝑞</ci></apply><apply id="S10.E14.m1.3.3.1.1.1.1.2.1.1.cmml" xref="S10.E14.m1.3.3.1.1.1.1.2.1"><csymbol cd="latexml" id="S10.E14.m1.3.3.1.1.1.1.2.1.1.1.cmml" xref="S10.E14.m1.3.3.1.1.1.1.2.1.1.1">conditional</csymbol><ci id="S10.E14.m1.3.3.1.1.1.1.2.1.1.2.cmml" xref="S10.E14.m1.3.3.1.1.1.1.2.1.1.2">𝐳</ci><ci id="S10.E14.m1.3.3.1.1.1.1.2.1.1.3.cmml" xref="S10.E14.m1.3.3.1.1.1.1.2.1.1.3">𝐱</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.E14.m1.3c">\nabla J(\theta)=\mathbf{E}_{\mathbf{z}\sim q(\mathbf{z}|\mathbf{x})}[(R-b_{t})\nabla\log q(\mathbf{z}|\mathbf{x})]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S10.p5.4" class="ltx_p">where, given <math id="S10.p5.4.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S10.p5.4.m1.1a"><mi id="S10.p5.4.m1.1.1" xref="S10.p5.4.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S10.p5.4.m1.1b"><ci id="S10.p5.4.m1.1.1.cmml" xref="S10.p5.4.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S10.p5.4.m1.1c">D</annotation></semantics></math> as the decay rate for the baseline,</p>
<table id="S10.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S10.E15.m1.1" class="ltx_Math" alttext="b_{t}=b_{t-1}+D*(R-b_{t-1})" display="block"><semantics id="S10.E15.m1.1a"><mrow id="S10.E15.m1.1.1" xref="S10.E15.m1.1.1.cmml"><msub id="S10.E15.m1.1.1.3" xref="S10.E15.m1.1.1.3.cmml"><mi id="S10.E15.m1.1.1.3.2" xref="S10.E15.m1.1.1.3.2.cmml">b</mi><mi id="S10.E15.m1.1.1.3.3" xref="S10.E15.m1.1.1.3.3.cmml">t</mi></msub><mo id="S10.E15.m1.1.1.2" xref="S10.E15.m1.1.1.2.cmml">=</mo><mrow id="S10.E15.m1.1.1.1" xref="S10.E15.m1.1.1.1.cmml"><msub id="S10.E15.m1.1.1.1.3" xref="S10.E15.m1.1.1.1.3.cmml"><mi id="S10.E15.m1.1.1.1.3.2" xref="S10.E15.m1.1.1.1.3.2.cmml">b</mi><mrow id="S10.E15.m1.1.1.1.3.3" xref="S10.E15.m1.1.1.1.3.3.cmml"><mi id="S10.E15.m1.1.1.1.3.3.2" xref="S10.E15.m1.1.1.1.3.3.2.cmml">t</mi><mo id="S10.E15.m1.1.1.1.3.3.1" xref="S10.E15.m1.1.1.1.3.3.1.cmml">−</mo><mn id="S10.E15.m1.1.1.1.3.3.3" xref="S10.E15.m1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S10.E15.m1.1.1.1.2" xref="S10.E15.m1.1.1.1.2.cmml">+</mo><mrow id="S10.E15.m1.1.1.1.1" xref="S10.E15.m1.1.1.1.1.cmml"><mi id="S10.E15.m1.1.1.1.1.3" xref="S10.E15.m1.1.1.1.1.3.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="S10.E15.m1.1.1.1.1.2" xref="S10.E15.m1.1.1.1.1.2.cmml">∗</mo><mrow id="S10.E15.m1.1.1.1.1.1.1" xref="S10.E15.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S10.E15.m1.1.1.1.1.1.1.2" xref="S10.E15.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S10.E15.m1.1.1.1.1.1.1.1" xref="S10.E15.m1.1.1.1.1.1.1.1.cmml"><mi id="S10.E15.m1.1.1.1.1.1.1.1.2" xref="S10.E15.m1.1.1.1.1.1.1.1.2.cmml">R</mi><mo id="S10.E15.m1.1.1.1.1.1.1.1.1" xref="S10.E15.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S10.E15.m1.1.1.1.1.1.1.1.3" xref="S10.E15.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S10.E15.m1.1.1.1.1.1.1.1.3.2" xref="S10.E15.m1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mrow id="S10.E15.m1.1.1.1.1.1.1.1.3.3" xref="S10.E15.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S10.E15.m1.1.1.1.1.1.1.1.3.3.2" xref="S10.E15.m1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S10.E15.m1.1.1.1.1.1.1.1.3.3.1" xref="S10.E15.m1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S10.E15.m1.1.1.1.1.1.1.1.3.3.3" xref="S10.E15.m1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S10.E15.m1.1.1.1.1.1.1.3" xref="S10.E15.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S10.E15.m1.1b"><apply id="S10.E15.m1.1.1.cmml" xref="S10.E15.m1.1.1"><eq id="S10.E15.m1.1.1.2.cmml" xref="S10.E15.m1.1.1.2"></eq><apply id="S10.E15.m1.1.1.3.cmml" xref="S10.E15.m1.1.1.3"><csymbol cd="ambiguous" id="S10.E15.m1.1.1.3.1.cmml" xref="S10.E15.m1.1.1.3">subscript</csymbol><ci id="S10.E15.m1.1.1.3.2.cmml" xref="S10.E15.m1.1.1.3.2">𝑏</ci><ci id="S10.E15.m1.1.1.3.3.cmml" xref="S10.E15.m1.1.1.3.3">𝑡</ci></apply><apply id="S10.E15.m1.1.1.1.cmml" xref="S10.E15.m1.1.1.1"><plus id="S10.E15.m1.1.1.1.2.cmml" xref="S10.E15.m1.1.1.1.2"></plus><apply id="S10.E15.m1.1.1.1.3.cmml" xref="S10.E15.m1.1.1.1.3"><csymbol cd="ambiguous" id="S10.E15.m1.1.1.1.3.1.cmml" xref="S10.E15.m1.1.1.1.3">subscript</csymbol><ci id="S10.E15.m1.1.1.1.3.2.cmml" xref="S10.E15.m1.1.1.1.3.2">𝑏</ci><apply id="S10.E15.m1.1.1.1.3.3.cmml" xref="S10.E15.m1.1.1.1.3.3"><minus id="S10.E15.m1.1.1.1.3.3.1.cmml" xref="S10.E15.m1.1.1.1.3.3.1"></minus><ci id="S10.E15.m1.1.1.1.3.3.2.cmml" xref="S10.E15.m1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S10.E15.m1.1.1.1.3.3.3.cmml" xref="S10.E15.m1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S10.E15.m1.1.1.1.1.cmml" xref="S10.E15.m1.1.1.1.1"><times id="S10.E15.m1.1.1.1.1.2.cmml" xref="S10.E15.m1.1.1.1.1.2"></times><ci id="S10.E15.m1.1.1.1.1.3.cmml" xref="S10.E15.m1.1.1.1.1.3">𝐷</ci><apply id="S10.E15.m1.1.1.1.1.1.1.1.cmml" xref="S10.E15.m1.1.1.1.1.1.1"><minus id="S10.E15.m1.1.1.1.1.1.1.1.1.cmml" xref="S10.E15.m1.1.1.1.1.1.1.1.1"></minus><ci id="S10.E15.m1.1.1.1.1.1.1.1.2.cmml" xref="S10.E15.m1.1.1.1.1.1.1.1.2">𝑅</ci><apply id="S10.E15.m1.1.1.1.1.1.1.1.3.cmml" xref="S10.E15.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S10.E15.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S10.E15.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S10.E15.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S10.E15.m1.1.1.1.1.1.1.1.3.2">𝑏</ci><apply id="S10.E15.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S10.E15.m1.1.1.1.1.1.1.1.3.3"><minus id="S10.E15.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S10.E15.m1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S10.E15.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S10.E15.m1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S10.E15.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S10.E15.m1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.E15.m1.1c">b_{t}=b_{t-1}+D*(R-b_{t-1})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S10.p5.5" class="ltx_p">is the update on the baseline performed at every step of training.</p>
</div>
<div id="S10.p6" class="ltx_para">
<p id="S10.p6.2" class="ltx_p">In addition, the variational parameters <math id="S10.p6.1.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S10.p6.1.m1.1a"><mi id="S10.p6.1.m1.1.1" xref="S10.p6.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S10.p6.1.m1.1b"><ci id="S10.p6.1.m1.1.1.cmml" xref="S10.p6.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S10.p6.1.m1.1c">\phi</annotation></semantics></math> are also updated via. the path
derivative <math id="S10.p6.2.m2.1" class="ltx_Math" alttext="\nabla_{\phi}\log q_{\phi}(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S10.p6.2.m2.1a"><mrow id="S10.p6.2.m2.1.1" xref="S10.p6.2.m2.1.1.cmml"><mrow id="S10.p6.2.m2.1.1.3" xref="S10.p6.2.m2.1.1.3.cmml"><mrow id="S10.p6.2.m2.1.1.3.1" xref="S10.p6.2.m2.1.1.3.1.cmml"><msub id="S10.p6.2.m2.1.1.3.1.1" xref="S10.p6.2.m2.1.1.3.1.1.cmml"><mo id="S10.p6.2.m2.1.1.3.1.1.2" xref="S10.p6.2.m2.1.1.3.1.1.2.cmml">∇</mo><mi id="S10.p6.2.m2.1.1.3.1.1.3" xref="S10.p6.2.m2.1.1.3.1.1.3.cmml">ϕ</mi></msub><mi id="S10.p6.2.m2.1.1.3.1.2" xref="S10.p6.2.m2.1.1.3.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S10.p6.2.m2.1.1.3a" xref="S10.p6.2.m2.1.1.3.cmml">⁡</mo><msub id="S10.p6.2.m2.1.1.3.2" xref="S10.p6.2.m2.1.1.3.2.cmml"><mi id="S10.p6.2.m2.1.1.3.2.2" xref="S10.p6.2.m2.1.1.3.2.2.cmml">q</mi><mi id="S10.p6.2.m2.1.1.3.2.3" xref="S10.p6.2.m2.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S10.p6.2.m2.1.1.2" xref="S10.p6.2.m2.1.1.2.cmml">​</mo><mrow id="S10.p6.2.m2.1.1.1.1" xref="S10.p6.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S10.p6.2.m2.1.1.1.1.2" xref="S10.p6.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S10.p6.2.m2.1.1.1.1.1" xref="S10.p6.2.m2.1.1.1.1.1.cmml"><mi id="S10.p6.2.m2.1.1.1.1.1.2" xref="S10.p6.2.m2.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S10.p6.2.m2.1.1.1.1.1.1" xref="S10.p6.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S10.p6.2.m2.1.1.1.1.1.3" xref="S10.p6.2.m2.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S10.p6.2.m2.1.1.1.1.3" xref="S10.p6.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S10.p6.2.m2.1b"><apply id="S10.p6.2.m2.1.1.cmml" xref="S10.p6.2.m2.1.1"><times id="S10.p6.2.m2.1.1.2.cmml" xref="S10.p6.2.m2.1.1.2"></times><apply id="S10.p6.2.m2.1.1.3.cmml" xref="S10.p6.2.m2.1.1.3"><apply id="S10.p6.2.m2.1.1.3.1.cmml" xref="S10.p6.2.m2.1.1.3.1"><apply id="S10.p6.2.m2.1.1.3.1.1.cmml" xref="S10.p6.2.m2.1.1.3.1.1"><csymbol cd="ambiguous" id="S10.p6.2.m2.1.1.3.1.1.1.cmml" xref="S10.p6.2.m2.1.1.3.1.1">subscript</csymbol><ci id="S10.p6.2.m2.1.1.3.1.1.2.cmml" xref="S10.p6.2.m2.1.1.3.1.1.2">∇</ci><ci id="S10.p6.2.m2.1.1.3.1.1.3.cmml" xref="S10.p6.2.m2.1.1.3.1.1.3">italic-ϕ</ci></apply><log id="S10.p6.2.m2.1.1.3.1.2.cmml" xref="S10.p6.2.m2.1.1.3.1.2"></log></apply><apply id="S10.p6.2.m2.1.1.3.2.cmml" xref="S10.p6.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S10.p6.2.m2.1.1.3.2.1.cmml" xref="S10.p6.2.m2.1.1.3.2">subscript</csymbol><ci id="S10.p6.2.m2.1.1.3.2.2.cmml" xref="S10.p6.2.m2.1.1.3.2.2">𝑞</ci><ci id="S10.p6.2.m2.1.1.3.2.3.cmml" xref="S10.p6.2.m2.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S10.p6.2.m2.1.1.1.1.1.cmml" xref="S10.p6.2.m2.1.1.1.1"><csymbol cd="latexml" id="S10.p6.2.m2.1.1.1.1.1.1.cmml" xref="S10.p6.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S10.p6.2.m2.1.1.1.1.1.2.cmml" xref="S10.p6.2.m2.1.1.1.1.1.2">𝐳</ci><ci id="S10.p6.2.m2.1.1.1.1.1.3.cmml" xref="S10.p6.2.m2.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S10.p6.2.m2.1c">\nabla_{\phi}\log q_{\phi}(\mathbf{z}|\mathbf{x})</annotation></semantics></math>.</p>
</div>
<div id="S10.p7" class="ltx_para ltx_noindent">
<p id="S10.p7.3" class="ltx_p"><span id="S10.p7.3.1" class="ltx_text ltx_font_bold">Training Details:</span> We use the ADAM
optimizer with a learning rate of <span id="S10.p7.3.2" class="ltx_text ltx_font_typewriter">1e-3</span>, a minibatch
size of 576, and use a moving average baseline for REINFORCE,
with a decay factor of 0.99. Typical values
of <math id="S10.p7.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S10.p7.1.m1.1a"><mi id="S10.p7.1.m1.1.1" xref="S10.p7.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S10.p7.1.m1.1b"><ci id="S10.p7.1.m1.1.1.cmml" xref="S10.p7.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S10.p7.1.m1.1c">\beta</annotation></semantics></math> are set to 0.1, <math id="S10.p7.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S10.p7.2.m2.1a"><mi id="S10.p7.2.m2.1.1" xref="S10.p7.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S10.p7.2.m2.1b"><ci id="S10.p7.2.m2.1.1.cmml" xref="S10.p7.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S10.p7.2.m2.1c">\alpha</annotation></semantics></math> is set to 100 and <math id="S10.p7.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S10.p7.3.m3.1a"><mi id="S10.p7.3.m3.1.1" xref="S10.p7.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S10.p7.3.m3.1b"><ci id="S10.p7.3.m3.1.1.cmml" xref="S10.p7.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S10.p7.3.m3.1c">\gamma</annotation></semantics></math> is chosen
on a validation set among <span id="S10.p7.3.3" class="ltx_text" style="color:#000000;">(1.0, 10.0, 100.0)</span>.</p>
</div>
<div id="S10.p8" class="ltx_para ltx_noindent">
<p id="S10.p8.1" class="ltx_p"><span id="S10.p8.1.1" class="ltx_text ltx_font_bold">Simulating programs from known syntax:</span> We follow a simple
two-stage heuristic procedure for generating a set of samples to train
the program prior in our model. Firstly, we build a list of possible
future tokens given a current token, and sample a random token from that
list, and repeat the procedure for the new token to get a large set of
possible valid sequences – we then pass the set of candidate sampled
sequences through a second stage of filtering based on constraints
from the work of <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
</section>
<section id="S11" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">11 </span>Additional Results on SHAPES</h2>

<div id="S11.p1" class="ltx_para ltx_noindent">
<p id="S11.p1.5" class="ltx_p"><span id="S11.p1.5.6" class="ltx_text ltx_font_bold">Empirical <em id="S11.p1.5.6.1" class="ltx_emph ltx_font_italic">vs.</em> syntactic priors.</span>
<span id="S11.p1.5.5" class="ltx_text" style="color:#000000;">While our default choice of the prior <math id="S11.p1.1.1.m1.1" class="ltx_Math" alttext="p(\mathbf{z})" display="inline"><semantics id="S11.p1.1.1.m1.1a"><mrow id="S11.p1.1.1.m1.1.2" xref="S11.p1.1.1.m1.1.2.cmml"><mi mathcolor="#000000" id="S11.p1.1.1.m1.1.2.2" xref="S11.p1.1.1.m1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S11.p1.1.1.m1.1.2.1" xref="S11.p1.1.1.m1.1.2.1.cmml">​</mo><mrow id="S11.p1.1.1.m1.1.2.3.2" xref="S11.p1.1.1.m1.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S11.p1.1.1.m1.1.2.3.2.1" xref="S11.p1.1.1.m1.1.2.cmml">(</mo><mi mathcolor="#000000" id="S11.p1.1.1.m1.1.1" xref="S11.p1.1.1.m1.1.1.cmml">𝐳</mi><mo mathcolor="#000000" stretchy="false" id="S11.p1.1.1.m1.1.2.3.2.2" xref="S11.p1.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p1.1.1.m1.1b"><apply id="S11.p1.1.1.m1.1.2.cmml" xref="S11.p1.1.1.m1.1.2"><times id="S11.p1.1.1.m1.1.2.1.cmml" xref="S11.p1.1.1.m1.1.2.1"></times><ci id="S11.p1.1.1.m1.1.2.2.cmml" xref="S11.p1.1.1.m1.1.2.2">𝑝</ci><ci id="S11.p1.1.1.m1.1.1.cmml" xref="S11.p1.1.1.m1.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.1.1.m1.1c">p(\mathbf{z})</annotation></semantics></math> is from programs simulated
from the known syntax, it might not be possible to exhaustively enumerate
all valid program strings in general. Here, we consider the special
case where we train the prior on a set of <em id="S11.p1.5.5.1" class="ltx_emph ltx_font_italic">unaligned</em>,
ground truth programs
from the dataset. Interestingly, we find that the performance of the question
coding stage, especially at reconstructing the questions improves significantly
when we have the syntactic prior as opposed to the empirical prior (from
38.39 <math id="S11.p1.2.2.m2.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S11.p1.2.2.m2.1a"><mo mathcolor="#000000" id="S11.p1.2.2.m2.1.1" xref="S11.p1.2.2.m2.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S11.p1.2.2.m2.1b"><csymbol cd="latexml" id="S11.p1.2.2.m2.1.1.cmml" xref="S11.p1.2.2.m2.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.2.2.m2.1c">\pm</annotation></semantics></math> 11.92% to 54.86 <math id="S11.p1.3.3.m3.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S11.p1.3.3.m3.1a"><mo mathcolor="#000000" id="S11.p1.3.3.m3.1.1" xref="S11.p1.3.3.m3.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S11.p1.3.3.m3.1b"><csymbol cd="latexml" id="S11.p1.3.3.m3.1.1.cmml" xref="S11.p1.3.3.m3.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.3.3.m3.1c">\pm</annotation></semantics></math> 6.75% for 5% program supervision). In terms
of program prediction accuracy, we also observe marginal improvements in the
cases where we have 5% and 10% supervision respectively, from 56.23 <math id="S11.p1.4.4.m4.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S11.p1.4.4.m4.1a"><mo mathcolor="#000000" id="S11.p1.4.4.m4.1.1" xref="S11.p1.4.4.m4.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S11.p1.4.4.m4.1b"><csymbol cd="latexml" id="S11.p1.4.4.m4.1.1.cmml" xref="S11.p1.4.4.m4.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.4.4.m4.1c">\pm</annotation></semantics></math> 2.81%
to 65.45 <math id="S11.p1.5.5.m5.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S11.p1.5.5.m5.1a"><mo mathcolor="#000000" id="S11.p1.5.5.m5.1.1" xref="S11.p1.5.5.m5.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S11.p1.5.5.m5.1b"><csymbol cd="latexml" id="S11.p1.5.5.m5.1.1.cmml" xref="S11.p1.5.5.m5.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S11.p1.5.5.m5.1c">\pm</annotation></semantics></math> 11.88%. When more supervision is available, regularizing with
respect to the broader, syntactic prior hurts performance marginally, which
makes sense, as one can just treat program supervision as a supervised
learning problem in this setting.</span></p>
</div>
<div id="S11.p2" class="ltx_para ltx_noindent">
<p id="S11.p2.5" class="ltx_p"><span id="S11.p2.5.6" class="ltx_text ltx_font_bold">Predicate Factoring.</span> <span id="S11.p2.5.5" class="ltx_text" style="color:#000000;">We choose to parameterize a <span id="S11.p2.5.5.1" class="ltx_text ltx_font_typewriter">find[green]</span>
operation with its own individual parameters <math id="S11.p2.1.1.m1.1" class="ltx_Math" alttext="\theta_{\texttt{find[green]}}" display="inline"><semantics id="S11.p2.1.1.m1.1a"><msub id="S11.p2.1.1.m1.1.1" xref="S11.p2.1.1.m1.1.1.cmml"><mi mathcolor="#000000" id="S11.p2.1.1.m1.1.1.2" xref="S11.p2.1.1.m1.1.1.2.cmml">θ</mi><mtext class="ltx_mathvariant_monospace" mathcolor="#000000" id="S11.p2.1.1.m1.1.1.3" xref="S11.p2.1.1.m1.1.1.3a.cmml">find[green]</mtext></msub><annotation-xml encoding="MathML-Content" id="S11.p2.1.1.m1.1b"><apply id="S11.p2.1.1.m1.1.1.cmml" xref="S11.p2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S11.p2.1.1.m1.1.1.1.cmml" xref="S11.p2.1.1.m1.1.1">subscript</csymbol><ci id="S11.p2.1.1.m1.1.1.2.cmml" xref="S11.p2.1.1.m1.1.1.2">𝜃</ci><ci id="S11.p2.1.1.m1.1.1.3a.cmml" xref="S11.p2.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" mathcolor="#000000" mathsize="70%" id="S11.p2.1.1.m1.1.1.3.cmml" xref="S11.p2.1.1.m1.1.1.3">find[green]</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.1.1.m1.1c">\theta_{\texttt{find[green]}}</annotation></semantics></math>
instead of having a parameterization for <math id="S11.p2.2.2.m2.1" class="ltx_Math" alttext="\theta_{\texttt{find}}" display="inline"><semantics id="S11.p2.2.2.m2.1a"><msub id="S11.p2.2.2.m2.1.1" xref="S11.p2.2.2.m2.1.1.cmml"><mi mathcolor="#000000" id="S11.p2.2.2.m2.1.1.2" xref="S11.p2.2.2.m2.1.1.2.cmml">θ</mi><mtext class="ltx_mathvariant_monospace" mathcolor="#000000" id="S11.p2.2.2.m2.1.1.3" xref="S11.p2.2.2.m2.1.1.3a.cmml">find</mtext></msub><annotation-xml encoding="MathML-Content" id="S11.p2.2.2.m2.1b"><apply id="S11.p2.2.2.m2.1.1.cmml" xref="S11.p2.2.2.m2.1.1"><csymbol cd="ambiguous" id="S11.p2.2.2.m2.1.1.1.cmml" xref="S11.p2.2.2.m2.1.1">subscript</csymbol><ci id="S11.p2.2.2.m2.1.1.2.cmml" xref="S11.p2.2.2.m2.1.1.2">𝜃</ci><ci id="S11.p2.2.2.m2.1.1.3a.cmml" xref="S11.p2.2.2.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" mathcolor="#000000" mathsize="70%" id="S11.p2.2.2.m2.1.1.3.cmml" xref="S11.p2.2.2.m2.1.1.3">find</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.2.2.m2.1c">\theta_{\texttt{find}}</annotation></semantics></math> with <span id="S11.p2.5.5.2" class="ltx_text ltx_markedasmath ltx_font_typewriter">green</span>
supplied as an argument to the neural module network. In doing so we followed prior
work <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite>. However, we also note that other work <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>)</cite> has
explored the second parameterization.
Conceptually, choice of either is orthogonal to the benefits from our
probabilistic formulation. However, for completeness we implemented argument
based modules on SHAPES – getting similar accuracy as atomic modules
(for both Prob-NMN and NMN). For example, at 15% supervision, Prob-NMN gets to a
joint training VQA accuracy on (SHAPES-Val) of 97.53 (<math id="S11.p2.4.4.m4.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S11.p2.4.4.m4.1a"><mo mathcolor="#000000" id="S11.p2.4.4.m4.1.1" xref="S11.p2.4.4.m4.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S11.p2.4.4.m4.1b"><csymbol cd="latexml" id="S11.p2.4.4.m4.1.1.cmml" xref="S11.p2.4.4.m4.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.4.4.m4.1c">\pm</annotation></semantics></math> 1.23) [Prob-NMN] <em id="S11.p2.5.5.3" class="ltx_emph ltx_font_italic">vs.</em> 80.78
(<math id="S11.p2.5.5.m5.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S11.p2.5.5.m5.1a"><mo mathcolor="#000000" id="S11.p2.5.5.m5.1.1" xref="S11.p2.5.5.m5.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S11.p2.5.5.m5.1b"><csymbol cd="latexml" id="S11.p2.5.5.m5.1.1.cmml" xref="S11.p2.5.5.m5.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S11.p2.5.5.m5.1c">\pm</annotation></semantics></math> 11.75) for NMN. Thus, this design choice does not seem to have an impact
on the relative performance of Prob-NMN and the NMN baseline.</span></p>
</div>
<div id="S11.p3" class="ltx_para ltx_noindent">
<p id="S11.p3.14" class="ltx_p"><span id="S11.p3.1.1" class="ltx_text ltx_font_bold">Effect of the Program Prior <math id="S11.p3.1.1.m1.1" class="ltx_Math" alttext="\mathbf{p(\mathbf{z})}" display="inline"><semantics id="S11.p3.1.1.m1.1a"><mrow id="S11.p3.1.1.m1.1.2" xref="S11.p3.1.1.m1.1.2.cmml"><mi id="S11.p3.1.1.m1.1.2.2" xref="S11.p3.1.1.m1.1.2.2.cmml">𝐩</mi><mo lspace="0em" rspace="0em" id="S11.p3.1.1.m1.1.2.1" xref="S11.p3.1.1.m1.1.2.1.cmml">​</mo><mrow id="S11.p3.1.1.m1.1.2.3.2" xref="S11.p3.1.1.m1.1.2.cmml"><mo stretchy="false" id="S11.p3.1.1.m1.1.2.3.2.1" xref="S11.p3.1.1.m1.1.2.cmml">(</mo><mi id="S11.p3.1.1.m1.1.1" xref="S11.p3.1.1.m1.1.1.cmml">𝐳</mi><mo stretchy="false" id="S11.p3.1.1.m1.1.2.3.2.2" xref="S11.p3.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p3.1.1.m1.1b"><apply id="S11.p3.1.1.m1.1.2.cmml" xref="S11.p3.1.1.m1.1.2"><times id="S11.p3.1.1.m1.1.2.1.cmml" xref="S11.p3.1.1.m1.1.2.1"></times><ci id="S11.p3.1.1.m1.1.2.2.cmml" xref="S11.p3.1.1.m1.1.2.2">𝐩</ci><ci id="S11.p3.1.1.m1.1.1.cmml" xref="S11.p3.1.1.m1.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.1.1.m1.1c">\mathbf{p(\mathbf{z})}</annotation></semantics></math>.</span>
Next, we explore the impact of regularizing the program posterior to be close to the prior <math id="S11.p3.2.m1.1" class="ltx_Math" alttext="p(\mathbf{z})" display="inline"><semantics id="S11.p3.2.m1.1a"><mrow id="S11.p3.2.m1.1.2" xref="S11.p3.2.m1.1.2.cmml"><mi id="S11.p3.2.m1.1.2.2" xref="S11.p3.2.m1.1.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S11.p3.2.m1.1.2.1" xref="S11.p3.2.m1.1.2.1.cmml">​</mo><mrow id="S11.p3.2.m1.1.2.3.2" xref="S11.p3.2.m1.1.2.cmml"><mo stretchy="false" id="S11.p3.2.m1.1.2.3.2.1" xref="S11.p3.2.m1.1.2.cmml">(</mo><mi id="S11.p3.2.m1.1.1" xref="S11.p3.2.m1.1.1.cmml">𝐳</mi><mo stretchy="false" id="S11.p3.2.m1.1.2.3.2.2" xref="S11.p3.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p3.2.m1.1b"><apply id="S11.p3.2.m1.1.2.cmml" xref="S11.p3.2.m1.1.2"><times id="S11.p3.2.m1.1.2.1.cmml" xref="S11.p3.2.m1.1.2.1"></times><ci id="S11.p3.2.m1.1.2.2.cmml" xref="S11.p3.2.m1.1.2.2">𝑝</ci><ci id="S11.p3.2.m1.1.1.cmml" xref="S11.p3.2.m1.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.2.m1.1c">p(\mathbf{z})</annotation></semantics></math>,
for different choices of the
prior.
Firstly, we disable the KL-divergence term by setting <math id="S11.p3.3.m2.1" class="ltx_Math" alttext="\beta=0" display="inline"><semantics id="S11.p3.3.m2.1a"><mrow id="S11.p3.3.m2.1.1" xref="S11.p3.3.m2.1.1.cmml"><mi id="S11.p3.3.m2.1.1.2" xref="S11.p3.3.m2.1.1.2.cmml">β</mi><mo id="S11.p3.3.m2.1.1.1" xref="S11.p3.3.m2.1.1.1.cmml">=</mo><mn id="S11.p3.3.m2.1.1.3" xref="S11.p3.3.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S11.p3.3.m2.1b"><apply id="S11.p3.3.m2.1.1.cmml" xref="S11.p3.3.m2.1.1"><eq id="S11.p3.3.m2.1.1.1.cmml" xref="S11.p3.3.m2.1.1.1"></eq><ci id="S11.p3.3.m2.1.1.2.cmml" xref="S11.p3.3.m2.1.1.2">𝛽</ci><cn type="integer" id="S11.p3.3.m2.1.1.3.cmml" xref="S11.p3.3.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.3.m2.1c">\beta=0</annotation></semantics></math> in
Equation (6), recovering a deterministic version of
our model, that still learns to reconstruct the question <math id="S11.p3.4.m3.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S11.p3.4.m3.1a"><mi id="S11.p3.4.m3.1.1" xref="S11.p3.4.m3.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S11.p3.4.m3.1b"><ci id="S11.p3.4.m3.1.1.cmml" xref="S11.p3.4.m3.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.4.m3.1c">\mathbf{x}</annotation></semantics></math> given a sampled
program <math id="S11.p3.5.m4.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S11.p3.5.m4.1a"><mi id="S11.p3.5.m4.1.1" xref="S11.p3.5.m4.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S11.p3.5.m4.1b"><ci id="S11.p3.5.m4.1.1.cmml" xref="S11.p3.5.m4.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.5.m4.1c">\mathbf{z}</annotation></semantics></math>. Compared to our full model at 10% supervision,
the performance on question coding drops to
23.14 <math id="S11.p3.6.m5.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S11.p3.6.m5.1a"><mo id="S11.p3.6.m5.1.1" xref="S11.p3.6.m5.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S11.p3.6.m5.1b"><csymbol cd="latexml" id="S11.p3.6.m5.1.1.cmml" xref="S11.p3.6.m5.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.6.m5.1c">\pm</annotation></semantics></math> 6.1% program prediction accuracy (from 60.18 <math id="S11.p3.7.m6.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S11.p3.7.m6.1a"><mo id="S11.p3.7.m6.1.1" xref="S11.p3.7.m6.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S11.p3.7.m6.1b"><csymbol cd="latexml" id="S11.p3.7.m6.1.1.cmml" xref="S11.p3.7.m6.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.7.m6.1c">\pm</annotation></semantics></math> 9.56%).
Interestingly, the <math id="S11.p3.8.m7.1" class="ltx_Math" alttext="\beta=0" display="inline"><semantics id="S11.p3.8.m7.1a"><mrow id="S11.p3.8.m7.1.1" xref="S11.p3.8.m7.1.1.cmml"><mi id="S11.p3.8.m7.1.1.2" xref="S11.p3.8.m7.1.1.2.cmml">β</mi><mo id="S11.p3.8.m7.1.1.1" xref="S11.p3.8.m7.1.1.1.cmml">=</mo><mn id="S11.p3.8.m7.1.1.3" xref="S11.p3.8.m7.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S11.p3.8.m7.1b"><apply id="S11.p3.8.m7.1.1.cmml" xref="S11.p3.8.m7.1.1"><eq id="S11.p3.8.m7.1.1.1.cmml" xref="S11.p3.8.m7.1.1.1"></eq><ci id="S11.p3.8.m7.1.1.2.cmml" xref="S11.p3.8.m7.1.1.2">𝛽</ci><cn type="integer" id="S11.p3.8.m7.1.1.3.cmml" xref="S11.p3.8.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.8.m7.1c">\beta=0</annotation></semantics></math> model has a better
performance on question reconstruction, which improves from
83.60 <math id="S11.p3.9.m8.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S11.p3.9.m8.1a"><mo id="S11.p3.9.m8.1.1" xref="S11.p3.9.m8.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S11.p3.9.m8.1b"><csymbol cd="latexml" id="S11.p3.9.m8.1.1.cmml" xref="S11.p3.9.m8.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.9.m8.1c">\pm</annotation></semantics></math> 5.57 % to 94.3 <math id="S11.p3.10.m9.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S11.p3.10.m9.1a"><mo id="S11.p3.10.m9.1.1" xref="S11.p3.10.m9.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S11.p3.10.m9.1b"><csymbol cd="latexml" id="S11.p3.10.m9.1.1.cmml" xref="S11.p3.10.m9.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.10.m9.1c">\pm</annotation></semantics></math> 1.85%.
This seems to indicate that, without the <math id="S11.p3.11.m10.1" class="ltx_Math" alttext="\mathrm{KL}" display="inline"><semantics id="S11.p3.11.m10.1a"><mi id="S11.p3.11.m10.1.1" xref="S11.p3.11.m10.1.1.cmml">KL</mi><annotation-xml encoding="MathML-Content" id="S11.p3.11.m10.1b"><ci id="S11.p3.11.m10.1.1.cmml" xref="S11.p3.11.m10.1.1">KL</ci></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.11.m10.1c">\mathrm{KL}</annotation></semantics></math> term, the model focuses solely on reconstruction and fails to learn compositionality in
the latent <math id="S11.p3.12.m11.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S11.p3.12.m11.1a"><mi id="S11.p3.12.m11.1.1" xref="S11.p3.12.m11.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S11.p3.12.m11.1b"><ci id="S11.p3.12.m11.1.1.cmml" xref="S11.p3.12.m11.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.12.m11.1c">\mathbf{z}</annotation></semantics></math> space, such that supervised grounding are poorly propagated to unsupervised questions as evidenced by
the drop in program prediction accuracy. Thus, the probabilistic model helps better achieve our high-level goal of
data-efficient legibility in the reasoning process.
In terms of the VQA accuracy on validation (at the end of joint training)
we see a drop in performance from <math id="S11.p3.13.m12.1" class="ltx_Math" alttext="96.86\pm 2.48" display="inline"><semantics id="S11.p3.13.m12.1a"><mrow id="S11.p3.13.m12.1.1" xref="S11.p3.13.m12.1.1.cmml"><mn id="S11.p3.13.m12.1.1.2" xref="S11.p3.13.m12.1.1.2.cmml">96.86</mn><mo id="S11.p3.13.m12.1.1.1" xref="S11.p3.13.m12.1.1.1.cmml">±</mo><mn id="S11.p3.13.m12.1.1.3" xref="S11.p3.13.m12.1.1.3.cmml">2.48</mn></mrow><annotation-xml encoding="MathML-Content" id="S11.p3.13.m12.1b"><apply id="S11.p3.13.m12.1.1.cmml" xref="S11.p3.13.m12.1.1"><csymbol cd="latexml" id="S11.p3.13.m12.1.1.1.cmml" xref="S11.p3.13.m12.1.1.1">plus-or-minus</csymbol><cn type="float" id="S11.p3.13.m12.1.1.2.cmml" xref="S11.p3.13.m12.1.1.2">96.86</cn><cn type="float" id="S11.p3.13.m12.1.1.3.cmml" xref="S11.p3.13.m12.1.1.3">2.48</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.13.m12.1c">96.86\pm 2.48</annotation></semantics></math> to <math id="S11.p3.14.m13.1" class="ltx_Math" alttext="74.82\pm 17.88" display="inline"><semantics id="S11.p3.14.m13.1a"><mrow id="S11.p3.14.m13.1.1" xref="S11.p3.14.m13.1.1.cmml"><mn id="S11.p3.14.m13.1.1.2" xref="S11.p3.14.m13.1.1.2.cmml">74.82</mn><mo id="S11.p3.14.m13.1.1.1" xref="S11.p3.14.m13.1.1.1.cmml">±</mo><mn id="S11.p3.14.m13.1.1.3" xref="S11.p3.14.m13.1.1.3.cmml">17.88</mn></mrow><annotation-xml encoding="MathML-Content" id="S11.p3.14.m13.1b"><apply id="S11.p3.14.m13.1.1.cmml" xref="S11.p3.14.m13.1.1"><csymbol cd="latexml" id="S11.p3.14.m13.1.1.1.cmml" xref="S11.p3.14.m13.1.1.1">plus-or-minus</csymbol><cn type="float" id="S11.p3.14.m13.1.1.2.cmml" xref="S11.p3.14.m13.1.1.2">74.82</cn><cn type="float" id="S11.p3.14.m13.1.1.3.cmml" xref="S11.p3.14.m13.1.1.3">17.88</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p3.14.m13.1c">74.82\pm 17.88</annotation></semantics></math>.</p>
</div>
<div id="S11.p4" class="ltx_para ltx_noindent">
<p id="S11.p4.6" class="ltx_p"><span id="S11.p4.1.1" class="ltx_text ltx_font_bold">Effect of Optimizing the True ELBO, <math id="S11.p4.1.1.m1.1" class="ltx_Math" alttext="\beta=1" display="inline"><semantics id="S11.p4.1.1.m1.1a"><mrow id="S11.p4.1.1.m1.1.1" xref="S11.p4.1.1.m1.1.1.cmml"><mi id="S11.p4.1.1.m1.1.1.2" xref="S11.p4.1.1.m1.1.1.2.cmml">β</mi><mo id="S11.p4.1.1.m1.1.1.1" xref="S11.p4.1.1.m1.1.1.1.cmml">=</mo><mn id="S11.p4.1.1.m1.1.1.3" xref="S11.p4.1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S11.p4.1.1.m1.1b"><apply id="S11.p4.1.1.m1.1.1.cmml" xref="S11.p4.1.1.m1.1.1"><eq id="S11.p4.1.1.m1.1.1.1.cmml" xref="S11.p4.1.1.m1.1.1.1"></eq><ci id="S11.p4.1.1.m1.1.1.2.cmml" xref="S11.p4.1.1.m1.1.1.2">𝛽</ci><cn type="integer" id="S11.p4.1.1.m1.1.1.3.cmml" xref="S11.p4.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p4.1.1.m1.1c">\beta=1</annotation></semantics></math>.</span>
Next, we empirically validate the intuition that for the semi-supervised setting,
approximate inference <math id="S11.p4.2.m1.1" class="ltx_Math" alttext="q_{\phi}(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S11.p4.2.m1.1a"><mrow id="S11.p4.2.m1.1.1" xref="S11.p4.2.m1.1.1.cmml"><msub id="S11.p4.2.m1.1.1.3" xref="S11.p4.2.m1.1.1.3.cmml"><mi id="S11.p4.2.m1.1.1.3.2" xref="S11.p4.2.m1.1.1.3.2.cmml">q</mi><mi id="S11.p4.2.m1.1.1.3.3" xref="S11.p4.2.m1.1.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S11.p4.2.m1.1.1.2" xref="S11.p4.2.m1.1.1.2.cmml">​</mo><mrow id="S11.p4.2.m1.1.1.1.1" xref="S11.p4.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S11.p4.2.m1.1.1.1.1.2" xref="S11.p4.2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S11.p4.2.m1.1.1.1.1.1" xref="S11.p4.2.m1.1.1.1.1.1.cmml"><mi id="S11.p4.2.m1.1.1.1.1.1.2" xref="S11.p4.2.m1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S11.p4.2.m1.1.1.1.1.1.1" xref="S11.p4.2.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S11.p4.2.m1.1.1.1.1.1.3" xref="S11.p4.2.m1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo stretchy="false" id="S11.p4.2.m1.1.1.1.1.3" xref="S11.p4.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S11.p4.2.m1.1b"><apply id="S11.p4.2.m1.1.1.cmml" xref="S11.p4.2.m1.1.1"><times id="S11.p4.2.m1.1.1.2.cmml" xref="S11.p4.2.m1.1.1.2"></times><apply id="S11.p4.2.m1.1.1.3.cmml" xref="S11.p4.2.m1.1.1.3"><csymbol cd="ambiguous" id="S11.p4.2.m1.1.1.3.1.cmml" xref="S11.p4.2.m1.1.1.3">subscript</csymbol><ci id="S11.p4.2.m1.1.1.3.2.cmml" xref="S11.p4.2.m1.1.1.3.2">𝑞</ci><ci id="S11.p4.2.m1.1.1.3.3.cmml" xref="S11.p4.2.m1.1.1.3.3">italic-ϕ</ci></apply><apply id="S11.p4.2.m1.1.1.1.1.1.cmml" xref="S11.p4.2.m1.1.1.1.1"><csymbol cd="latexml" id="S11.p4.2.m1.1.1.1.1.1.1.cmml" xref="S11.p4.2.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S11.p4.2.m1.1.1.1.1.1.2.cmml" xref="S11.p4.2.m1.1.1.1.1.1.2">𝐳</ci><ci id="S11.p4.2.m1.1.1.1.1.1.3.cmml" xref="S11.p4.2.m1.1.1.1.1.1.3">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p4.2.m1.1c">q_{\phi}(\mathbf{z}|\mathbf{x})</annotation></semantics></math>
learned using Equation (1) for sequence models often leads to solutions that do not make
meaningful use of the latent variable. For example, we find that at <math id="S11.p4.3.m2.1" class="ltx_Math" alttext="\beta=1" display="inline"><semantics id="S11.p4.3.m2.1a"><mrow id="S11.p4.3.m2.1.1" xref="S11.p4.3.m2.1.1.cmml"><mi id="S11.p4.3.m2.1.1.2" xref="S11.p4.3.m2.1.1.2.cmml">β</mi><mo id="S11.p4.3.m2.1.1.1" xref="S11.p4.3.m2.1.1.1.cmml">=</mo><mn id="S11.p4.3.m2.1.1.3" xref="S11.p4.3.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S11.p4.3.m2.1b"><apply id="S11.p4.3.m2.1.1.cmml" xref="S11.p4.3.m2.1.1"><eq id="S11.p4.3.m2.1.1.1.cmml" xref="S11.p4.3.m2.1.1.1"></eq><ci id="S11.p4.3.m2.1.1.2.cmml" xref="S11.p4.3.m2.1.1.2">𝛽</ci><cn type="integer" id="S11.p4.3.m2.1.1.3.cmml" xref="S11.p4.3.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p4.3.m2.1c">\beta=1</annotation></semantics></math> (and 10% supervision),
training the true
evidence lower bound on <math id="S11.p4.4.m3.1" class="ltx_Math" alttext="\mathcal{U}_{qc}" display="inline"><semantics id="S11.p4.4.m3.1a"><msub id="S11.p4.4.m3.1.1" xref="S11.p4.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S11.p4.4.m3.1.1.2" xref="S11.p4.4.m3.1.1.2.cmml">𝒰</mi><mrow id="S11.p4.4.m3.1.1.3" xref="S11.p4.4.m3.1.1.3.cmml"><mi id="S11.p4.4.m3.1.1.3.2" xref="S11.p4.4.m3.1.1.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S11.p4.4.m3.1.1.3.1" xref="S11.p4.4.m3.1.1.3.1.cmml">​</mo><mi id="S11.p4.4.m3.1.1.3.3" xref="S11.p4.4.m3.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S11.p4.4.m3.1b"><apply id="S11.p4.4.m3.1.1.cmml" xref="S11.p4.4.m3.1.1"><csymbol cd="ambiguous" id="S11.p4.4.m3.1.1.1.cmml" xref="S11.p4.4.m3.1.1">subscript</csymbol><ci id="S11.p4.4.m3.1.1.2.cmml" xref="S11.p4.4.m3.1.1.2">𝒰</ci><apply id="S11.p4.4.m3.1.1.3.cmml" xref="S11.p4.4.m3.1.1.3"><times id="S11.p4.4.m3.1.1.3.1.cmml" xref="S11.p4.4.m3.1.1.3.1"></times><ci id="S11.p4.4.m3.1.1.3.2.cmml" xref="S11.p4.4.m3.1.1.3.2">𝑞</ci><ci id="S11.p4.4.m3.1.1.3.3.cmml" xref="S11.p4.4.m3.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p4.4.m3.1c">\mathcal{U}_{qc}</annotation></semantics></math> deteriorates the question reconstruction accuracy
from 83.60 % to 8.74% causing a large distortion in the original question, as predicted
by the results from <cite class="ltx_cite ltx_citemacro_citet">Alemi et al. (<a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>. Overall, in this setting the final accuracy on VQA
at the end of joint training is <math id="S11.p4.5.m4.1" class="ltx_Math" alttext="74.45\pm 15.58" display="inline"><semantics id="S11.p4.5.m4.1a"><mrow id="S11.p4.5.m4.1.1" xref="S11.p4.5.m4.1.1.cmml"><mn id="S11.p4.5.m4.1.1.2" xref="S11.p4.5.m4.1.1.2.cmml">74.45</mn><mo id="S11.p4.5.m4.1.1.1" xref="S11.p4.5.m4.1.1.1.cmml">±</mo><mn id="S11.p4.5.m4.1.1.3" xref="S11.p4.5.m4.1.1.3.cmml">15.58</mn></mrow><annotation-xml encoding="MathML-Content" id="S11.p4.5.m4.1b"><apply id="S11.p4.5.m4.1.1.cmml" xref="S11.p4.5.m4.1.1"><csymbol cd="latexml" id="S11.p4.5.m4.1.1.1.cmml" xref="S11.p4.5.m4.1.1.1">plus-or-minus</csymbol><cn type="float" id="S11.p4.5.m4.1.1.2.cmml" xref="S11.p4.5.m4.1.1.2">74.45</cn><cn type="float" id="S11.p4.5.m4.1.1.3.cmml" xref="S11.p4.5.m4.1.1.3">15.58</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S11.p4.5.m4.1c">74.45\pm 15.58</annotation></semantics></math>, a drop of <math id="S11.p4.6.m5.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S11.p4.6.m5.1a"><mo id="S11.p4.6.m5.1.1" xref="S11.p4.6.m5.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S11.p4.6.m5.1b"><gt id="S11.p4.6.m5.1.1.cmml" xref="S11.p4.6.m5.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S11.p4.6.m5.1c">&gt;</annotation></semantics></math> 20 % accuracy.</p>
</div>
<figure id="S11.F4" class="ltx_figure"><img src="/html/1902.07864/assets/x4.png" id="S11.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="242" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S11.F4.3.1" class="ltx_text ltx_font_bold">Coherence and Sensitivity</span>: <span id="S11.F4.4.2" class="ltx_text" style="color:#000000;">Image and a correponding answer are specified,
and the model is asked to produce programs it believes should
lead to the particular answer for the given image. One can notice that the generated
programs are consistent with each other, and evaluate to
the specified answer. Results are shown for a Prob-NMN model
trained with 0.143% supervision on CLEVR.</span></figcaption>
</figure>
</section>
<section id="S12" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">12 </span>Coherence and Sensitivity Sampling</h2>

<div id="S12.p1" class="ltx_para">
<p id="S12.p1.6" class="ltx_p">Our goal is to sample from the posterior <math id="S12.p1.1.m1.3" class="ltx_Math" alttext="p(\mathbf{z}|a,\mathbf{i})" display="inline"><semantics id="S12.p1.1.m1.3a"><mrow id="S12.p1.1.m1.3.3" xref="S12.p1.1.m1.3.3.cmml"><mi id="S12.p1.1.m1.3.3.3" xref="S12.p1.1.m1.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S12.p1.1.m1.3.3.2" xref="S12.p1.1.m1.3.3.2.cmml">​</mo><mrow id="S12.p1.1.m1.3.3.1.1" xref="S12.p1.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S12.p1.1.m1.3.3.1.1.2" xref="S12.p1.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S12.p1.1.m1.3.3.1.1.1" xref="S12.p1.1.m1.3.3.1.1.1.cmml"><mi id="S12.p1.1.m1.3.3.1.1.1.2" xref="S12.p1.1.m1.3.3.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S12.p1.1.m1.3.3.1.1.1.1" xref="S12.p1.1.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S12.p1.1.m1.3.3.1.1.1.3.2" xref="S12.p1.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S12.p1.1.m1.1.1" xref="S12.p1.1.m1.1.1.cmml">a</mi><mo id="S12.p1.1.m1.3.3.1.1.1.3.2.1" xref="S12.p1.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S12.p1.1.m1.2.2" xref="S12.p1.1.m1.2.2.cmml">𝐢</mi></mrow></mrow><mo stretchy="false" id="S12.p1.1.m1.3.3.1.1.3" xref="S12.p1.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S12.p1.1.m1.3b"><apply id="S12.p1.1.m1.3.3.cmml" xref="S12.p1.1.m1.3.3"><times id="S12.p1.1.m1.3.3.2.cmml" xref="S12.p1.1.m1.3.3.2"></times><ci id="S12.p1.1.m1.3.3.3.cmml" xref="S12.p1.1.m1.3.3.3">𝑝</ci><apply id="S12.p1.1.m1.3.3.1.1.1.cmml" xref="S12.p1.1.m1.3.3.1.1"><csymbol cd="latexml" id="S12.p1.1.m1.3.3.1.1.1.1.cmml" xref="S12.p1.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S12.p1.1.m1.3.3.1.1.1.2.cmml" xref="S12.p1.1.m1.3.3.1.1.1.2">𝐳</ci><list id="S12.p1.1.m1.3.3.1.1.1.3.1.cmml" xref="S12.p1.1.m1.3.3.1.1.1.3.2"><ci id="S12.p1.1.m1.1.1.cmml" xref="S12.p1.1.m1.1.1">𝑎</ci><ci id="S12.p1.1.m1.2.2.cmml" xref="S12.p1.1.m1.2.2">𝐢</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.p1.1.m1.3c">p(\mathbf{z}|a,\mathbf{i})</annotation></semantics></math>, which we accomplish
by sampling from the unnormalized joint distribution
<math id="S12.p1.2.m2.7" class="ltx_Math" alttext="p(\mathbf{z}|a,\mathbf{i})\propto p(\mathbf{z})p(a|\mathbf{z},\mathbf{i})" display="inline"><semantics id="S12.p1.2.m2.7a"><mrow id="S12.p1.2.m2.7.7" xref="S12.p1.2.m2.7.7.cmml"><mrow id="S12.p1.2.m2.6.6.1" xref="S12.p1.2.m2.6.6.1.cmml"><mi id="S12.p1.2.m2.6.6.1.3" xref="S12.p1.2.m2.6.6.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S12.p1.2.m2.6.6.1.2" xref="S12.p1.2.m2.6.6.1.2.cmml">​</mo><mrow id="S12.p1.2.m2.6.6.1.1.1" xref="S12.p1.2.m2.6.6.1.1.1.1.cmml"><mo stretchy="false" id="S12.p1.2.m2.6.6.1.1.1.2" xref="S12.p1.2.m2.6.6.1.1.1.1.cmml">(</mo><mrow id="S12.p1.2.m2.6.6.1.1.1.1" xref="S12.p1.2.m2.6.6.1.1.1.1.cmml"><mi id="S12.p1.2.m2.6.6.1.1.1.1.2" xref="S12.p1.2.m2.6.6.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S12.p1.2.m2.6.6.1.1.1.1.1" xref="S12.p1.2.m2.6.6.1.1.1.1.1.cmml">|</mo><mrow id="S12.p1.2.m2.6.6.1.1.1.1.3.2" xref="S12.p1.2.m2.6.6.1.1.1.1.3.1.cmml"><mi id="S12.p1.2.m2.1.1" xref="S12.p1.2.m2.1.1.cmml">a</mi><mo id="S12.p1.2.m2.6.6.1.1.1.1.3.2.1" xref="S12.p1.2.m2.6.6.1.1.1.1.3.1.cmml">,</mo><mi id="S12.p1.2.m2.2.2" xref="S12.p1.2.m2.2.2.cmml">𝐢</mi></mrow></mrow><mo stretchy="false" id="S12.p1.2.m2.6.6.1.1.1.3" xref="S12.p1.2.m2.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S12.p1.2.m2.7.7.3" xref="S12.p1.2.m2.7.7.3.cmml">∝</mo><mrow id="S12.p1.2.m2.7.7.2" xref="S12.p1.2.m2.7.7.2.cmml"><mi id="S12.p1.2.m2.7.7.2.3" xref="S12.p1.2.m2.7.7.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S12.p1.2.m2.7.7.2.2" xref="S12.p1.2.m2.7.7.2.2.cmml">​</mo><mrow id="S12.p1.2.m2.7.7.2.4.2" xref="S12.p1.2.m2.7.7.2.cmml"><mo stretchy="false" id="S12.p1.2.m2.7.7.2.4.2.1" xref="S12.p1.2.m2.7.7.2.cmml">(</mo><mi id="S12.p1.2.m2.3.3" xref="S12.p1.2.m2.3.3.cmml">𝐳</mi><mo stretchy="false" id="S12.p1.2.m2.7.7.2.4.2.2" xref="S12.p1.2.m2.7.7.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S12.p1.2.m2.7.7.2.2a" xref="S12.p1.2.m2.7.7.2.2.cmml">​</mo><mi id="S12.p1.2.m2.7.7.2.5" xref="S12.p1.2.m2.7.7.2.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S12.p1.2.m2.7.7.2.2b" xref="S12.p1.2.m2.7.7.2.2.cmml">​</mo><mrow id="S12.p1.2.m2.7.7.2.1.1" xref="S12.p1.2.m2.7.7.2.1.1.1.cmml"><mo stretchy="false" id="S12.p1.2.m2.7.7.2.1.1.2" xref="S12.p1.2.m2.7.7.2.1.1.1.cmml">(</mo><mrow id="S12.p1.2.m2.7.7.2.1.1.1" xref="S12.p1.2.m2.7.7.2.1.1.1.cmml"><mi id="S12.p1.2.m2.7.7.2.1.1.1.2" xref="S12.p1.2.m2.7.7.2.1.1.1.2.cmml">a</mi><mo fence="false" id="S12.p1.2.m2.7.7.2.1.1.1.1" xref="S12.p1.2.m2.7.7.2.1.1.1.1.cmml">|</mo><mrow id="S12.p1.2.m2.7.7.2.1.1.1.3.2" xref="S12.p1.2.m2.7.7.2.1.1.1.3.1.cmml"><mi id="S12.p1.2.m2.4.4" xref="S12.p1.2.m2.4.4.cmml">𝐳</mi><mo id="S12.p1.2.m2.7.7.2.1.1.1.3.2.1" xref="S12.p1.2.m2.7.7.2.1.1.1.3.1.cmml">,</mo><mi id="S12.p1.2.m2.5.5" xref="S12.p1.2.m2.5.5.cmml">𝐢</mi></mrow></mrow><mo stretchy="false" id="S12.p1.2.m2.7.7.2.1.1.3" xref="S12.p1.2.m2.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S12.p1.2.m2.7b"><apply id="S12.p1.2.m2.7.7.cmml" xref="S12.p1.2.m2.7.7"><csymbol cd="latexml" id="S12.p1.2.m2.7.7.3.cmml" xref="S12.p1.2.m2.7.7.3">proportional-to</csymbol><apply id="S12.p1.2.m2.6.6.1.cmml" xref="S12.p1.2.m2.6.6.1"><times id="S12.p1.2.m2.6.6.1.2.cmml" xref="S12.p1.2.m2.6.6.1.2"></times><ci id="S12.p1.2.m2.6.6.1.3.cmml" xref="S12.p1.2.m2.6.6.1.3">𝑝</ci><apply id="S12.p1.2.m2.6.6.1.1.1.1.cmml" xref="S12.p1.2.m2.6.6.1.1.1"><csymbol cd="latexml" id="S12.p1.2.m2.6.6.1.1.1.1.1.cmml" xref="S12.p1.2.m2.6.6.1.1.1.1.1">conditional</csymbol><ci id="S12.p1.2.m2.6.6.1.1.1.1.2.cmml" xref="S12.p1.2.m2.6.6.1.1.1.1.2">𝐳</ci><list id="S12.p1.2.m2.6.6.1.1.1.1.3.1.cmml" xref="S12.p1.2.m2.6.6.1.1.1.1.3.2"><ci id="S12.p1.2.m2.1.1.cmml" xref="S12.p1.2.m2.1.1">𝑎</ci><ci id="S12.p1.2.m2.2.2.cmml" xref="S12.p1.2.m2.2.2">𝐢</ci></list></apply></apply><apply id="S12.p1.2.m2.7.7.2.cmml" xref="S12.p1.2.m2.7.7.2"><times id="S12.p1.2.m2.7.7.2.2.cmml" xref="S12.p1.2.m2.7.7.2.2"></times><ci id="S12.p1.2.m2.7.7.2.3.cmml" xref="S12.p1.2.m2.7.7.2.3">𝑝</ci><ci id="S12.p1.2.m2.3.3.cmml" xref="S12.p1.2.m2.3.3">𝐳</ci><ci id="S12.p1.2.m2.7.7.2.5.cmml" xref="S12.p1.2.m2.7.7.2.5">𝑝</ci><apply id="S12.p1.2.m2.7.7.2.1.1.1.cmml" xref="S12.p1.2.m2.7.7.2.1.1"><csymbol cd="latexml" id="S12.p1.2.m2.7.7.2.1.1.1.1.cmml" xref="S12.p1.2.m2.7.7.2.1.1.1.1">conditional</csymbol><ci id="S12.p1.2.m2.7.7.2.1.1.1.2.cmml" xref="S12.p1.2.m2.7.7.2.1.1.1.2">𝑎</ci><list id="S12.p1.2.m2.7.7.2.1.1.1.3.1.cmml" xref="S12.p1.2.m2.7.7.2.1.1.1.3.2"><ci id="S12.p1.2.m2.4.4.cmml" xref="S12.p1.2.m2.4.4">𝐳</ci><ci id="S12.p1.2.m2.5.5.cmml" xref="S12.p1.2.m2.5.5">𝐢</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.p1.2.m2.7c">p(\mathbf{z}|a,\mathbf{i})\propto p(\mathbf{z})p(a|\mathbf{z},\mathbf{i})</annotation></semantics></math>.
To answer a query conditioned on an answer <math id="S12.p1.3.m3.1" class="ltx_Math" alttext="\hat{a}" display="inline"><semantics id="S12.p1.3.m3.1a"><mover accent="true" id="S12.p1.3.m3.1.1" xref="S12.p1.3.m3.1.1.cmml"><mi id="S12.p1.3.m3.1.1.2" xref="S12.p1.3.m3.1.1.2.cmml">a</mi><mo id="S12.p1.3.m3.1.1.1" xref="S12.p1.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S12.p1.3.m3.1b"><apply id="S12.p1.3.m3.1.1.cmml" xref="S12.p1.3.m3.1.1"><ci id="S12.p1.3.m3.1.1.1.cmml" xref="S12.p1.3.m3.1.1.1">^</ci><ci id="S12.p1.3.m3.1.1.2.cmml" xref="S12.p1.3.m3.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.p1.3.m3.1c">\hat{a}</annotation></semantics></math>,
one can simply filter out samples which have <math id="S12.p1.4.m4.1" class="ltx_Math" alttext="a=\hat{a}" display="inline"><semantics id="S12.p1.4.m4.1a"><mrow id="S12.p1.4.m4.1.1" xref="S12.p1.4.m4.1.1.cmml"><mi id="S12.p1.4.m4.1.1.2" xref="S12.p1.4.m4.1.1.2.cmml">a</mi><mo id="S12.p1.4.m4.1.1.1" xref="S12.p1.4.m4.1.1.1.cmml">=</mo><mover accent="true" id="S12.p1.4.m4.1.1.3" xref="S12.p1.4.m4.1.1.3.cmml"><mi id="S12.p1.4.m4.1.1.3.2" xref="S12.p1.4.m4.1.1.3.2.cmml">a</mi><mo id="S12.p1.4.m4.1.1.3.1" xref="S12.p1.4.m4.1.1.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S12.p1.4.m4.1b"><apply id="S12.p1.4.m4.1.1.cmml" xref="S12.p1.4.m4.1.1"><eq id="S12.p1.4.m4.1.1.1.cmml" xref="S12.p1.4.m4.1.1.1"></eq><ci id="S12.p1.4.m4.1.1.2.cmml" xref="S12.p1.4.m4.1.1.2">𝑎</ci><apply id="S12.p1.4.m4.1.1.3.cmml" xref="S12.p1.4.m4.1.1.3"><ci id="S12.p1.4.m4.1.1.3.1.cmml" xref="S12.p1.4.m4.1.1.3.1">^</ci><ci id="S12.p1.4.m4.1.1.3.2.cmml" xref="S12.p1.4.m4.1.1.3.2">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.p1.4.m4.1c">a=\hat{a}</annotation></semantics></math>, and
produce the sample programs as the program, and decode the program <math id="S12.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{x}^{i}\sim p(\mathbf{x}|\mathbf{z}^{i})" display="inline"><semantics id="S12.p1.5.m5.1a"><mrow id="S12.p1.5.m5.1.1" xref="S12.p1.5.m5.1.1.cmml"><msup id="S12.p1.5.m5.1.1.3" xref="S12.p1.5.m5.1.1.3.cmml"><mi id="S12.p1.5.m5.1.1.3.2" xref="S12.p1.5.m5.1.1.3.2.cmml">𝐱</mi><mi id="S12.p1.5.m5.1.1.3.3" xref="S12.p1.5.m5.1.1.3.3.cmml">i</mi></msup><mo id="S12.p1.5.m5.1.1.2" xref="S12.p1.5.m5.1.1.2.cmml">∼</mo><mrow id="S12.p1.5.m5.1.1.1" xref="S12.p1.5.m5.1.1.1.cmml"><mi id="S12.p1.5.m5.1.1.1.3" xref="S12.p1.5.m5.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S12.p1.5.m5.1.1.1.2" xref="S12.p1.5.m5.1.1.1.2.cmml">​</mo><mrow id="S12.p1.5.m5.1.1.1.1.1" xref="S12.p1.5.m5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S12.p1.5.m5.1.1.1.1.1.2" xref="S12.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S12.p1.5.m5.1.1.1.1.1.1" xref="S12.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="S12.p1.5.m5.1.1.1.1.1.1.2" xref="S12.p1.5.m5.1.1.1.1.1.1.2.cmml">𝐱</mi><mo fence="false" id="S12.p1.5.m5.1.1.1.1.1.1.1" xref="S12.p1.5.m5.1.1.1.1.1.1.1.cmml">|</mo><msup id="S12.p1.5.m5.1.1.1.1.1.1.3" xref="S12.p1.5.m5.1.1.1.1.1.1.3.cmml"><mi id="S12.p1.5.m5.1.1.1.1.1.1.3.2" xref="S12.p1.5.m5.1.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S12.p1.5.m5.1.1.1.1.1.1.3.3" xref="S12.p1.5.m5.1.1.1.1.1.1.3.3.cmml">i</mi></msup></mrow><mo stretchy="false" id="S12.p1.5.m5.1.1.1.1.1.3" xref="S12.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S12.p1.5.m5.1b"><apply id="S12.p1.5.m5.1.1.cmml" xref="S12.p1.5.m5.1.1"><csymbol cd="latexml" id="S12.p1.5.m5.1.1.2.cmml" xref="S12.p1.5.m5.1.1.2">similar-to</csymbol><apply id="S12.p1.5.m5.1.1.3.cmml" xref="S12.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S12.p1.5.m5.1.1.3.1.cmml" xref="S12.p1.5.m5.1.1.3">superscript</csymbol><ci id="S12.p1.5.m5.1.1.3.2.cmml" xref="S12.p1.5.m5.1.1.3.2">𝐱</ci><ci id="S12.p1.5.m5.1.1.3.3.cmml" xref="S12.p1.5.m5.1.1.3.3">𝑖</ci></apply><apply id="S12.p1.5.m5.1.1.1.cmml" xref="S12.p1.5.m5.1.1.1"><times id="S12.p1.5.m5.1.1.1.2.cmml" xref="S12.p1.5.m5.1.1.1.2"></times><ci id="S12.p1.5.m5.1.1.1.3.cmml" xref="S12.p1.5.m5.1.1.1.3">𝑝</ci><apply id="S12.p1.5.m5.1.1.1.1.1.1.cmml" xref="S12.p1.5.m5.1.1.1.1.1"><csymbol cd="latexml" id="S12.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S12.p1.5.m5.1.1.1.1.1.1.1">conditional</csymbol><ci id="S12.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S12.p1.5.m5.1.1.1.1.1.1.2">𝐱</ci><apply id="S12.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S12.p1.5.m5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S12.p1.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S12.p1.5.m5.1.1.1.1.1.1.3">superscript</csymbol><ci id="S12.p1.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S12.p1.5.m5.1.1.1.1.1.1.3.2">𝐳</ci><ci id="S12.p1.5.m5.1.1.1.1.1.1.3.3.cmml" xref="S12.p1.5.m5.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.p1.5.m5.1c">\mathbf{x}^{i}\sim p(\mathbf{x}|\mathbf{z}^{i})</annotation></semantics></math>
to produce the corresponding question. Note that it is also possible
to fit a (more scalable) variational
approximation <math id="S12.p1.6.m6.3" class="ltx_Math" alttext="q_{\sigma}(\mathbf{z}|a,\mathbf{i})" display="inline"><semantics id="S12.p1.6.m6.3a"><mrow id="S12.p1.6.m6.3.3" xref="S12.p1.6.m6.3.3.cmml"><msub id="S12.p1.6.m6.3.3.3" xref="S12.p1.6.m6.3.3.3.cmml"><mi id="S12.p1.6.m6.3.3.3.2" xref="S12.p1.6.m6.3.3.3.2.cmml">q</mi><mi id="S12.p1.6.m6.3.3.3.3" xref="S12.p1.6.m6.3.3.3.3.cmml">σ</mi></msub><mo lspace="0em" rspace="0em" id="S12.p1.6.m6.3.3.2" xref="S12.p1.6.m6.3.3.2.cmml">​</mo><mrow id="S12.p1.6.m6.3.3.1.1" xref="S12.p1.6.m6.3.3.1.1.1.cmml"><mo stretchy="false" id="S12.p1.6.m6.3.3.1.1.2" xref="S12.p1.6.m6.3.3.1.1.1.cmml">(</mo><mrow id="S12.p1.6.m6.3.3.1.1.1" xref="S12.p1.6.m6.3.3.1.1.1.cmml"><mi id="S12.p1.6.m6.3.3.1.1.1.2" xref="S12.p1.6.m6.3.3.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S12.p1.6.m6.3.3.1.1.1.1" xref="S12.p1.6.m6.3.3.1.1.1.1.cmml">|</mo><mrow id="S12.p1.6.m6.3.3.1.1.1.3.2" xref="S12.p1.6.m6.3.3.1.1.1.3.1.cmml"><mi id="S12.p1.6.m6.1.1" xref="S12.p1.6.m6.1.1.cmml">a</mi><mo id="S12.p1.6.m6.3.3.1.1.1.3.2.1" xref="S12.p1.6.m6.3.3.1.1.1.3.1.cmml">,</mo><mi id="S12.p1.6.m6.2.2" xref="S12.p1.6.m6.2.2.cmml">𝐢</mi></mrow></mrow><mo stretchy="false" id="S12.p1.6.m6.3.3.1.1.3" xref="S12.p1.6.m6.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S12.p1.6.m6.3b"><apply id="S12.p1.6.m6.3.3.cmml" xref="S12.p1.6.m6.3.3"><times id="S12.p1.6.m6.3.3.2.cmml" xref="S12.p1.6.m6.3.3.2"></times><apply id="S12.p1.6.m6.3.3.3.cmml" xref="S12.p1.6.m6.3.3.3"><csymbol cd="ambiguous" id="S12.p1.6.m6.3.3.3.1.cmml" xref="S12.p1.6.m6.3.3.3">subscript</csymbol><ci id="S12.p1.6.m6.3.3.3.2.cmml" xref="S12.p1.6.m6.3.3.3.2">𝑞</ci><ci id="S12.p1.6.m6.3.3.3.3.cmml" xref="S12.p1.6.m6.3.3.3.3">𝜎</ci></apply><apply id="S12.p1.6.m6.3.3.1.1.1.cmml" xref="S12.p1.6.m6.3.3.1.1"><csymbol cd="latexml" id="S12.p1.6.m6.3.3.1.1.1.1.cmml" xref="S12.p1.6.m6.3.3.1.1.1.1">conditional</csymbol><ci id="S12.p1.6.m6.3.3.1.1.1.2.cmml" xref="S12.p1.6.m6.3.3.1.1.1.2">𝐳</ci><list id="S12.p1.6.m6.3.3.1.1.1.3.1.cmml" xref="S12.p1.6.m6.3.3.1.1.1.3.2"><ci id="S12.p1.6.m6.1.1.cmml" xref="S12.p1.6.m6.1.1">𝑎</ci><ci id="S12.p1.6.m6.2.2.cmml" xref="S12.p1.6.m6.2.2">𝐢</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S12.p1.6.m6.3c">q_{\sigma}(\mathbf{z}|a,\mathbf{i})</annotation></semantics></math> having trained
the generative model retrospectively, following results from <cite class="ltx_cite ltx_citemacro_citet">Vedantam et al. (<a href="#bib.bib47" title="" class="ltx_ref">2018</a>)</cite>
However, for the current purposes we found the above sampling procedure to be sufficient.</p>
</div>
</section>
<section id="S13" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">13 </span>Implementation Details on CLEVR</h2>

<div id="S13.p1" class="ltx_para">
<p id="S13.p1.1" class="ltx_p">CLEVR dataset is an order of magnitude larger than SHAPES, with larger vocabulary, longer sequences and images with higher visual complexity. We take this scale-up into account, and make suitable architectural modifications in comparison to SHAPES.</p>
</div>
<div id="S13.p2" class="ltx_para ltx_noindent">
<p id="S13.p2.1" class="ltx_p"><span id="S13.p2.1.1" class="ltx_text ltx_font_bold">Sequence to Sequence Models:</span> The encoders of our sequence-to-sequence models (program generator and question reconstructor) are based on LSTM cells with a hidden state of 256 units, a depth of two layers, and accept input word embeddings of 256 dimensions for both question and program vocabulary. We follow the same architecture for our program prior sequence model. Our decoders are similar to encoders, only with a modification of having single layer depth. When sampling from the model, we sample till the maximum sequence length in observed training data – this results in program sequences of maximum length 28, and question sequences of maximum length 44.</p>
</div>
<div id="S13.p3" class="ltx_para ltx_noindent">
<p id="S13.p3.1" class="ltx_p"><span id="S13.p3.1.1" class="ltx_text ltx_font_bold">Image CNN:</span> We resize the CLEVR images to <span id="S13.p3.1.2" class="ltx_text ltx_font_typewriter">224x224</span> dimensions and pass them through an ImageNet pre-trained ResNet-101, and obtain features from
its ‘third stage’, which results in features of dimensions <span id="S13.p3.1.3" class="ltx_text ltx_font_typewriter">1024x14x14</span>. These features are used as input to the Neural Module Network.</p>
</div>
<div id="S13.p4" class="ltx_para ltx_noindent">
<p id="S13.p4.6" class="ltx_p"><span id="S13.p4.6.2" class="ltx_text ltx_font_bold">Training Details</span> In order to get stable training with
sequence-to-sequence models on CLEVR, we found it useful to
average the log-probabilities across multiple timesteps. Without this,
in presence of a large variance in sentence lengths, we find that the model
focuses on generating the longer sequences, which is usually hard without
first understanding the structure in shorter sequences. Averaging (across) the
<math id="S13.p4.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S13.p4.1.m1.1a"><mi id="S13.p4.1.m1.1.1" xref="S13.p4.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S13.p4.1.m1.1b"><ci id="S13.p4.1.m1.1.1.cmml" xref="S13.p4.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S13.p4.1.m1.1c">T</annotation></semantics></math> dimension helps with this. <span id="S13.p4.6.3" class="ltx_text" style="color:#000000;">This is also common practice when working with sequence
models and has been done in numerous prior works <cite class="ltx_cite ltx_citemacro_citep">(Vinyals et al., <a href="#bib.bib48" title="" class="ltx_ref">2015</a>; Johnson et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>; Hu et al., <a href="#bib.bib16" title="" class="ltx_ref">2017</a>; Lu et al., <a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite> <em id="S13.p4.6.3.1" class="ltx_emph ltx_font_italic">etc.</em></span>. With higher linguistic variation in CLEVR questions, learning question reconstruction is difficult at the start of training when the latent program space isn’t learned properly. To make learning easier, we increase the influence of teaching examples by also scaling question reconstruction loss with <math id="S13.p4.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S13.p4.2.m2.1a"><mi id="S13.p4.2.m2.1.1" xref="S13.p4.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S13.p4.2.m2.1b"><ci id="S13.p4.2.m2.1.1.cmml" xref="S13.p4.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S13.p4.2.m2.1c">\alpha</annotation></semantics></math> in Equation (3). We use the ADAM
optimizer with a learning rate of <span id="S13.p4.6.4" class="ltx_text ltx_font_typewriter">1e-3</span> for Question Coding, <span id="S13.p4.6.5" class="ltx_text ltx_font_typewriter">1e-4</span> for Module Training and <span id="S13.p4.6.6" class="ltx_text ltx_font_typewriter">1e-5</span> for Joint Training. We do not introduce any weight decay. We use a batch size of 256 across all stages, and a moving average baseline for REINFORCE with decay factor of 0.99, similar to SHAPES. We set <math id="S13.p4.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S13.p4.3.m3.1a"><mi id="S13.p4.3.m3.1.1" xref="S13.p4.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S13.p4.3.m3.1b"><ci id="S13.p4.3.m3.1.1.cmml" xref="S13.p4.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S13.p4.3.m3.1c">\alpha</annotation></semantics></math> as 100, <math id="S13.p4.4.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S13.p4.4.m4.1a"><mi id="S13.p4.4.m4.1.1" xref="S13.p4.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S13.p4.4.m4.1b"><ci id="S13.p4.4.m4.1.1.cmml" xref="S13.p4.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S13.p4.4.m4.1c">\beta</annotation></semantics></math> as 0.1 and <math id="S13.p4.5.m5.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S13.p4.5.m5.1a"><mi id="S13.p4.5.m5.1.1" xref="S13.p4.5.m5.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S13.p4.5.m5.1b"><ci id="S13.p4.5.m5.1.1.cmml" xref="S13.p4.5.m5.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S13.p4.5.m5.1c">\gamma</annotation></semantics></math> as 10. <span id="S13.p4.6.1" class="ltx_text" style="color:#000000;">We validate every 500 iterations for question coding and joint training, and every 2000 iterations for module training. We drop the learning rate to half when our primary metric (either program prediction accuracy or VQA accuracy, in respective stages) does not improve within next 3 validations. We use the code and module design choices of the state of the art TbD nets <cite class="ltx_cite ltx_citemacro_citep">(Mascharka et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite> to implement the <math id="S13.p4.6.1.m1.1" class="ltx_Math" alttext="p_{\theta_{\mathbf{z}}}(a|\mathbf{i})" display="inline"><semantics id="S13.p4.6.1.m1.1a"><mrow id="S13.p4.6.1.m1.1.1" xref="S13.p4.6.1.m1.1.1.cmml"><msub id="S13.p4.6.1.m1.1.1.3" xref="S13.p4.6.1.m1.1.1.3.cmml"><mi mathcolor="#000000" id="S13.p4.6.1.m1.1.1.3.2" xref="S13.p4.6.1.m1.1.1.3.2.cmml">p</mi><msub id="S13.p4.6.1.m1.1.1.3.3" xref="S13.p4.6.1.m1.1.1.3.3.cmml"><mi mathcolor="#000000" id="S13.p4.6.1.m1.1.1.3.3.2" xref="S13.p4.6.1.m1.1.1.3.3.2.cmml">θ</mi><mi mathcolor="#000000" id="S13.p4.6.1.m1.1.1.3.3.3" xref="S13.p4.6.1.m1.1.1.3.3.3.cmml">𝐳</mi></msub></msub><mo lspace="0em" rspace="0em" id="S13.p4.6.1.m1.1.1.2" xref="S13.p4.6.1.m1.1.1.2.cmml">​</mo><mrow id="S13.p4.6.1.m1.1.1.1.1" xref="S13.p4.6.1.m1.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S13.p4.6.1.m1.1.1.1.1.2" xref="S13.p4.6.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S13.p4.6.1.m1.1.1.1.1.1" xref="S13.p4.6.1.m1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S13.p4.6.1.m1.1.1.1.1.1.2" xref="S13.p4.6.1.m1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" mathcolor="#000000" id="S13.p4.6.1.m1.1.1.1.1.1.1" xref="S13.p4.6.1.m1.1.1.1.1.1.1.cmml">|</mo><mi mathcolor="#000000" id="S13.p4.6.1.m1.1.1.1.1.1.3" xref="S13.p4.6.1.m1.1.1.1.1.1.3.cmml">𝐢</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S13.p4.6.1.m1.1.1.1.1.3" xref="S13.p4.6.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S13.p4.6.1.m1.1b"><apply id="S13.p4.6.1.m1.1.1.cmml" xref="S13.p4.6.1.m1.1.1"><times id="S13.p4.6.1.m1.1.1.2.cmml" xref="S13.p4.6.1.m1.1.1.2"></times><apply id="S13.p4.6.1.m1.1.1.3.cmml" xref="S13.p4.6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S13.p4.6.1.m1.1.1.3.1.cmml" xref="S13.p4.6.1.m1.1.1.3">subscript</csymbol><ci id="S13.p4.6.1.m1.1.1.3.2.cmml" xref="S13.p4.6.1.m1.1.1.3.2">𝑝</ci><apply id="S13.p4.6.1.m1.1.1.3.3.cmml" xref="S13.p4.6.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S13.p4.6.1.m1.1.1.3.3.1.cmml" xref="S13.p4.6.1.m1.1.1.3.3">subscript</csymbol><ci id="S13.p4.6.1.m1.1.1.3.3.2.cmml" xref="S13.p4.6.1.m1.1.1.3.3.2">𝜃</ci><ci id="S13.p4.6.1.m1.1.1.3.3.3.cmml" xref="S13.p4.6.1.m1.1.1.3.3.3">𝐳</ci></apply></apply><apply id="S13.p4.6.1.m1.1.1.1.1.1.cmml" xref="S13.p4.6.1.m1.1.1.1.1"><csymbol cd="latexml" id="S13.p4.6.1.m1.1.1.1.1.1.1.cmml" xref="S13.p4.6.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S13.p4.6.1.m1.1.1.1.1.1.2.cmml" xref="S13.p4.6.1.m1.1.1.1.1.1.2">𝑎</ci><ci id="S13.p4.6.1.m1.1.1.1.1.1.3.cmml" xref="S13.p4.6.1.m1.1.1.1.1.1.3">𝐢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S13.p4.6.1.m1.1c">p_{\theta_{\mathbf{z}}}(a|\mathbf{i})</annotation></semantics></math> mapping in our model.</span></p>
</div>
</section>
<section id="S14" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">14 </span>Results on CLEVR-Humans dataset</h2>

<div id="S14.p1" class="ltx_para">
<p id="S14.p1.8" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">Johnson et al. <span id="S14.p1.8.9.1.1.1" class="ltx_text" style="color:#000000;">(</span><a href="#bib.bib19" title="" class="ltx_ref">2017</a><span id="S14.p1.8.10.2.2.1" class="ltx_text" style="color:#000000;">)</span></cite><span id="S14.p1.8.8" class="ltx_text" style="color:#000000;"> also collect a dataset of questions asked by humans
on the images in the CLEVR dataset, which is called CLEVR-humans. CLEVR-humans
is out of distribution data for both NMN and Prob-NMN. We train the models
on the regular CLEVR dataset (with 0.143 % question-program supervision)
and evaluate the checkpoints on the CLEVR-human validation set which contains
7202 questions. We find that the gains on the regular CLEVR setup for
Prob-NMN also translate to the CLEVR-humans setting, with Prob-NMN getting
to an accuracy of 50.81 <math id="S14.p1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S14.p1.1.1.m1.1a"><mo mathcolor="#000000" id="S14.p1.1.1.m1.1.1" xref="S14.p1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S14.p1.1.1.m1.1b"><csymbol cd="latexml" id="S14.p1.1.1.m1.1.1.cmml" xref="S14.p1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S14.p1.1.1.m1.1c">\pm</annotation></semantics></math> 1.93 <em id="S14.p1.8.8.1" class="ltx_emph ltx_font_italic">vs.</em> 45.45 % for NMN. Both approaches
perform better than chance accuracy of 15.66% computed by picking
the most frequent answer from the training set.
We compute <math id="S14.p1.2.2.m2.5" class="ltx_Math" alttext="p(a|\mathbf{x},\mathbf{i})\approx\frac{1}{N}\sum_{n}p(a|\mathbf{z}^{n},\mathbf{i})" display="inline"><semantics id="S14.p1.2.2.m2.5a"><mrow id="S14.p1.2.2.m2.5.5" xref="S14.p1.2.2.m2.5.5.cmml"><mrow id="S14.p1.2.2.m2.4.4.1" xref="S14.p1.2.2.m2.4.4.1.cmml"><mi mathcolor="#000000" id="S14.p1.2.2.m2.4.4.1.3" xref="S14.p1.2.2.m2.4.4.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S14.p1.2.2.m2.4.4.1.2" xref="S14.p1.2.2.m2.4.4.1.2.cmml">​</mo><mrow id="S14.p1.2.2.m2.4.4.1.1.1" xref="S14.p1.2.2.m2.4.4.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S14.p1.2.2.m2.4.4.1.1.1.2" xref="S14.p1.2.2.m2.4.4.1.1.1.1.cmml">(</mo><mrow id="S14.p1.2.2.m2.4.4.1.1.1.1" xref="S14.p1.2.2.m2.4.4.1.1.1.1.cmml"><mi mathcolor="#000000" id="S14.p1.2.2.m2.4.4.1.1.1.1.2" xref="S14.p1.2.2.m2.4.4.1.1.1.1.2.cmml">a</mi><mo fence="false" mathcolor="#000000" id="S14.p1.2.2.m2.4.4.1.1.1.1.1" xref="S14.p1.2.2.m2.4.4.1.1.1.1.1.cmml">|</mo><mrow id="S14.p1.2.2.m2.4.4.1.1.1.1.3.2" xref="S14.p1.2.2.m2.4.4.1.1.1.1.3.1.cmml"><mi mathcolor="#000000" id="S14.p1.2.2.m2.1.1" xref="S14.p1.2.2.m2.1.1.cmml">𝐱</mi><mo mathcolor="#000000" id="S14.p1.2.2.m2.4.4.1.1.1.1.3.2.1" xref="S14.p1.2.2.m2.4.4.1.1.1.1.3.1.cmml">,</mo><mi mathcolor="#000000" id="S14.p1.2.2.m2.2.2" xref="S14.p1.2.2.m2.2.2.cmml">𝐢</mi></mrow></mrow><mo mathcolor="#000000" stretchy="false" id="S14.p1.2.2.m2.4.4.1.1.1.3" xref="S14.p1.2.2.m2.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathcolor="#000000" id="S14.p1.2.2.m2.5.5.3" xref="S14.p1.2.2.m2.5.5.3.cmml">≈</mo><mrow id="S14.p1.2.2.m2.5.5.2" xref="S14.p1.2.2.m2.5.5.2.cmml"><mfrac mathcolor="#000000" id="S14.p1.2.2.m2.5.5.2.3" xref="S14.p1.2.2.m2.5.5.2.3.cmml"><mn mathcolor="#000000" id="S14.p1.2.2.m2.5.5.2.3.2" xref="S14.p1.2.2.m2.5.5.2.3.2.cmml">1</mn><mi mathcolor="#000000" id="S14.p1.2.2.m2.5.5.2.3.3" xref="S14.p1.2.2.m2.5.5.2.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S14.p1.2.2.m2.5.5.2.2" xref="S14.p1.2.2.m2.5.5.2.2.cmml">​</mo><mrow id="S14.p1.2.2.m2.5.5.2.1" xref="S14.p1.2.2.m2.5.5.2.1.cmml"><msub id="S14.p1.2.2.m2.5.5.2.1.2" xref="S14.p1.2.2.m2.5.5.2.1.2.cmml"><mo mathcolor="#000000" id="S14.p1.2.2.m2.5.5.2.1.2.2" xref="S14.p1.2.2.m2.5.5.2.1.2.2.cmml">∑</mo><mi mathcolor="#000000" id="S14.p1.2.2.m2.5.5.2.1.2.3" xref="S14.p1.2.2.m2.5.5.2.1.2.3.cmml">n</mi></msub><mrow id="S14.p1.2.2.m2.5.5.2.1.1" xref="S14.p1.2.2.m2.5.5.2.1.1.cmml"><mi mathcolor="#000000" id="S14.p1.2.2.m2.5.5.2.1.1.3" xref="S14.p1.2.2.m2.5.5.2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S14.p1.2.2.m2.5.5.2.1.1.2" xref="S14.p1.2.2.m2.5.5.2.1.1.2.cmml">​</mo><mrow id="S14.p1.2.2.m2.5.5.2.1.1.1.1" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S14.p1.2.2.m2.5.5.2.1.1.1.1.2" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.cmml">(</mo><mrow id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.3" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.3.cmml">a</mi><mo fence="false" mathcolor="#000000" id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.2" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.2.cmml">|</mo><mrow id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.2.cmml"><msup id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1.2" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi mathcolor="#000000" id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1.3" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo mathcolor="#000000" id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.2" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.2.cmml">,</mo><mi mathcolor="#000000" id="S14.p1.2.2.m2.3.3" xref="S14.p1.2.2.m2.3.3.cmml">𝐢</mi></mrow></mrow><mo mathcolor="#000000" stretchy="false" id="S14.p1.2.2.m2.5.5.2.1.1.1.1.3" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S14.p1.2.2.m2.5b"><apply id="S14.p1.2.2.m2.5.5.cmml" xref="S14.p1.2.2.m2.5.5"><approx id="S14.p1.2.2.m2.5.5.3.cmml" xref="S14.p1.2.2.m2.5.5.3"></approx><apply id="S14.p1.2.2.m2.4.4.1.cmml" xref="S14.p1.2.2.m2.4.4.1"><times id="S14.p1.2.2.m2.4.4.1.2.cmml" xref="S14.p1.2.2.m2.4.4.1.2"></times><ci id="S14.p1.2.2.m2.4.4.1.3.cmml" xref="S14.p1.2.2.m2.4.4.1.3">𝑝</ci><apply id="S14.p1.2.2.m2.4.4.1.1.1.1.cmml" xref="S14.p1.2.2.m2.4.4.1.1.1"><csymbol cd="latexml" id="S14.p1.2.2.m2.4.4.1.1.1.1.1.cmml" xref="S14.p1.2.2.m2.4.4.1.1.1.1.1">conditional</csymbol><ci id="S14.p1.2.2.m2.4.4.1.1.1.1.2.cmml" xref="S14.p1.2.2.m2.4.4.1.1.1.1.2">𝑎</ci><list id="S14.p1.2.2.m2.4.4.1.1.1.1.3.1.cmml" xref="S14.p1.2.2.m2.4.4.1.1.1.1.3.2"><ci id="S14.p1.2.2.m2.1.1.cmml" xref="S14.p1.2.2.m2.1.1">𝐱</ci><ci id="S14.p1.2.2.m2.2.2.cmml" xref="S14.p1.2.2.m2.2.2">𝐢</ci></list></apply></apply><apply id="S14.p1.2.2.m2.5.5.2.cmml" xref="S14.p1.2.2.m2.5.5.2"><times id="S14.p1.2.2.m2.5.5.2.2.cmml" xref="S14.p1.2.2.m2.5.5.2.2"></times><apply id="S14.p1.2.2.m2.5.5.2.3.cmml" xref="S14.p1.2.2.m2.5.5.2.3"><divide id="S14.p1.2.2.m2.5.5.2.3.1.cmml" xref="S14.p1.2.2.m2.5.5.2.3"></divide><cn type="integer" id="S14.p1.2.2.m2.5.5.2.3.2.cmml" xref="S14.p1.2.2.m2.5.5.2.3.2">1</cn><ci id="S14.p1.2.2.m2.5.5.2.3.3.cmml" xref="S14.p1.2.2.m2.5.5.2.3.3">𝑁</ci></apply><apply id="S14.p1.2.2.m2.5.5.2.1.cmml" xref="S14.p1.2.2.m2.5.5.2.1"><apply id="S14.p1.2.2.m2.5.5.2.1.2.cmml" xref="S14.p1.2.2.m2.5.5.2.1.2"><csymbol cd="ambiguous" id="S14.p1.2.2.m2.5.5.2.1.2.1.cmml" xref="S14.p1.2.2.m2.5.5.2.1.2">subscript</csymbol><sum id="S14.p1.2.2.m2.5.5.2.1.2.2.cmml" xref="S14.p1.2.2.m2.5.5.2.1.2.2"></sum><ci id="S14.p1.2.2.m2.5.5.2.1.2.3.cmml" xref="S14.p1.2.2.m2.5.5.2.1.2.3">𝑛</ci></apply><apply id="S14.p1.2.2.m2.5.5.2.1.1.cmml" xref="S14.p1.2.2.m2.5.5.2.1.1"><times id="S14.p1.2.2.m2.5.5.2.1.1.2.cmml" xref="S14.p1.2.2.m2.5.5.2.1.1.2"></times><ci id="S14.p1.2.2.m2.5.5.2.1.1.3.cmml" xref="S14.p1.2.2.m2.5.5.2.1.1.3">𝑝</ci><apply id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.cmml" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1"><csymbol cd="latexml" id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.2.cmml" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.2">conditional</csymbol><ci id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.3.cmml" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.3">𝑎</ci><list id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.2.cmml" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1"><apply id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1.cmml" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1.1.cmml" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1.2.cmml" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1.3.cmml" xref="S14.p1.2.2.m2.5.5.2.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><ci id="S14.p1.2.2.m2.3.3.cmml" xref="S14.p1.2.2.m2.3.3">𝐢</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S14.p1.2.2.m2.5c">p(a|\mathbf{x},\mathbf{i})\approx\frac{1}{N}\sum_{n}p(a|\mathbf{z}^{n},\mathbf{i})</annotation></semantics></math>,
where <math id="S14.p1.3.3.m3.1" class="ltx_Math" alttext="\mathbf{z}^{n}\sim q(\mathbf{z}|\mathbf{x})" display="inline"><semantics id="S14.p1.3.3.m3.1a"><mrow id="S14.p1.3.3.m3.1.1" xref="S14.p1.3.3.m3.1.1.cmml"><msup id="S14.p1.3.3.m3.1.1.3" xref="S14.p1.3.3.m3.1.1.3.cmml"><mi mathcolor="#000000" id="S14.p1.3.3.m3.1.1.3.2" xref="S14.p1.3.3.m3.1.1.3.2.cmml">𝐳</mi><mi mathcolor="#000000" id="S14.p1.3.3.m3.1.1.3.3" xref="S14.p1.3.3.m3.1.1.3.3.cmml">n</mi></msup><mo mathcolor="#000000" id="S14.p1.3.3.m3.1.1.2" xref="S14.p1.3.3.m3.1.1.2.cmml">∼</mo><mrow id="S14.p1.3.3.m3.1.1.1" xref="S14.p1.3.3.m3.1.1.1.cmml"><mi mathcolor="#000000" id="S14.p1.3.3.m3.1.1.1.3" xref="S14.p1.3.3.m3.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S14.p1.3.3.m3.1.1.1.2" xref="S14.p1.3.3.m3.1.1.1.2.cmml">​</mo><mrow id="S14.p1.3.3.m3.1.1.1.1.1" xref="S14.p1.3.3.m3.1.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S14.p1.3.3.m3.1.1.1.1.1.2" xref="S14.p1.3.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S14.p1.3.3.m3.1.1.1.1.1.1" xref="S14.p1.3.3.m3.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S14.p1.3.3.m3.1.1.1.1.1.1.2" xref="S14.p1.3.3.m3.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" mathcolor="#000000" id="S14.p1.3.3.m3.1.1.1.1.1.1.1" xref="S14.p1.3.3.m3.1.1.1.1.1.1.1.cmml">|</mo><mi mathcolor="#000000" id="S14.p1.3.3.m3.1.1.1.1.1.1.3" xref="S14.p1.3.3.m3.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo mathcolor="#000000" stretchy="false" id="S14.p1.3.3.m3.1.1.1.1.1.3" xref="S14.p1.3.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S14.p1.3.3.m3.1b"><apply id="S14.p1.3.3.m3.1.1.cmml" xref="S14.p1.3.3.m3.1.1"><csymbol cd="latexml" id="S14.p1.3.3.m3.1.1.2.cmml" xref="S14.p1.3.3.m3.1.1.2">similar-to</csymbol><apply id="S14.p1.3.3.m3.1.1.3.cmml" xref="S14.p1.3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S14.p1.3.3.m3.1.1.3.1.cmml" xref="S14.p1.3.3.m3.1.1.3">superscript</csymbol><ci id="S14.p1.3.3.m3.1.1.3.2.cmml" xref="S14.p1.3.3.m3.1.1.3.2">𝐳</ci><ci id="S14.p1.3.3.m3.1.1.3.3.cmml" xref="S14.p1.3.3.m3.1.1.3.3">𝑛</ci></apply><apply id="S14.p1.3.3.m3.1.1.1.cmml" xref="S14.p1.3.3.m3.1.1.1"><times id="S14.p1.3.3.m3.1.1.1.2.cmml" xref="S14.p1.3.3.m3.1.1.1.2"></times><ci id="S14.p1.3.3.m3.1.1.1.3.cmml" xref="S14.p1.3.3.m3.1.1.1.3">𝑞</ci><apply id="S14.p1.3.3.m3.1.1.1.1.1.1.cmml" xref="S14.p1.3.3.m3.1.1.1.1.1"><csymbol cd="latexml" id="S14.p1.3.3.m3.1.1.1.1.1.1.1.cmml" xref="S14.p1.3.3.m3.1.1.1.1.1.1.1">conditional</csymbol><ci id="S14.p1.3.3.m3.1.1.1.1.1.1.2.cmml" xref="S14.p1.3.3.m3.1.1.1.1.1.1.2">𝐳</ci><ci id="S14.p1.3.3.m3.1.1.1.1.1.1.3.cmml" xref="S14.p1.3.3.m3.1.1.1.1.1.1.3">𝐱</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S14.p1.3.3.m3.1c">\mathbf{z}^{n}\sim q(\mathbf{z}|\mathbf{x})</annotation></semantics></math> for this analysis, drawing <math id="S14.p1.4.4.m4.1" class="ltx_Math" alttext="n=20" display="inline"><semantics id="S14.p1.4.4.m4.1a"><mrow id="S14.p1.4.4.m4.1.1" xref="S14.p1.4.4.m4.1.1.cmml"><mi mathcolor="#000000" id="S14.p1.4.4.m4.1.1.2" xref="S14.p1.4.4.m4.1.1.2.cmml">n</mi><mo mathcolor="#000000" id="S14.p1.4.4.m4.1.1.1" xref="S14.p1.4.4.m4.1.1.1.cmml">=</mo><mn mathcolor="#000000" id="S14.p1.4.4.m4.1.1.3" xref="S14.p1.4.4.m4.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S14.p1.4.4.m4.1b"><apply id="S14.p1.4.4.m4.1.1.cmml" xref="S14.p1.4.4.m4.1.1"><eq id="S14.p1.4.4.m4.1.1.1.cmml" xref="S14.p1.4.4.m4.1.1.1"></eq><ci id="S14.p1.4.4.m4.1.1.2.cmml" xref="S14.p1.4.4.m4.1.1.2">𝑛</ci><cn type="integer" id="S14.p1.4.4.m4.1.1.3.cmml" xref="S14.p1.4.4.m4.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S14.p1.4.4.m4.1c">n=20</annotation></semantics></math> samples.
Next we were interested in understanding if modeling the uncertainty via. Prob-NMN
helped more with out of distribution questions (such as CLEVR-humans) –
this phenomena is also called aleatoric uncertaintly. For
this, we varied the number of samples we drew, sweeping from <math id="S14.p1.5.5.m5.1" class="ltx_Math" alttext="n=1" display="inline"><semantics id="S14.p1.5.5.m5.1a"><mrow id="S14.p1.5.5.m5.1.1" xref="S14.p1.5.5.m5.1.1.cmml"><mi mathcolor="#000000" id="S14.p1.5.5.m5.1.1.2" xref="S14.p1.5.5.m5.1.1.2.cmml">n</mi><mo mathcolor="#000000" id="S14.p1.5.5.m5.1.1.1" xref="S14.p1.5.5.m5.1.1.1.cmml">=</mo><mn mathcolor="#000000" id="S14.p1.5.5.m5.1.1.3" xref="S14.p1.5.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S14.p1.5.5.m5.1b"><apply id="S14.p1.5.5.m5.1.1.cmml" xref="S14.p1.5.5.m5.1.1"><eq id="S14.p1.5.5.m5.1.1.1.cmml" xref="S14.p1.5.5.m5.1.1.1"></eq><ci id="S14.p1.5.5.m5.1.1.2.cmml" xref="S14.p1.5.5.m5.1.1.2">𝑛</ci><cn type="integer" id="S14.p1.5.5.m5.1.1.3.cmml" xref="S14.p1.5.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S14.p1.5.5.m5.1c">n=1</annotation></semantics></math> to <math id="S14.p1.6.6.m6.1" class="ltx_Math" alttext="n=20" display="inline"><semantics id="S14.p1.6.6.m6.1a"><mrow id="S14.p1.6.6.m6.1.1" xref="S14.p1.6.6.m6.1.1.cmml"><mi mathcolor="#000000" id="S14.p1.6.6.m6.1.1.2" xref="S14.p1.6.6.m6.1.1.2.cmml">n</mi><mo mathcolor="#000000" id="S14.p1.6.6.m6.1.1.1" xref="S14.p1.6.6.m6.1.1.1.cmml">=</mo><mn mathcolor="#000000" id="S14.p1.6.6.m6.1.1.3" xref="S14.p1.6.6.m6.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S14.p1.6.6.m6.1b"><apply id="S14.p1.6.6.m6.1.1.cmml" xref="S14.p1.6.6.m6.1.1"><eq id="S14.p1.6.6.m6.1.1.1.cmml" xref="S14.p1.6.6.m6.1.1.1"></eq><ci id="S14.p1.6.6.m6.1.1.2.cmml" xref="S14.p1.6.6.m6.1.1.2">𝑛</ci><cn type="integer" id="S14.p1.6.6.m6.1.1.3.cmml" xref="S14.p1.6.6.m6.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S14.p1.6.6.m6.1c">n=20</annotation></semantics></math>.
For a single sample, we found that the performance drop for both NMN
as well as Prob-NMN was somewhat similar, <em id="S14.p1.8.8.2" class="ltx_emph ltx_font_italic">i.e.</em> the NMN performance dropped
to 44.98 <math id="S14.p1.7.7.m7.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S14.p1.7.7.m7.1a"><mo mathcolor="#000000" id="S14.p1.7.7.m7.1.1" xref="S14.p1.7.7.m7.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S14.p1.7.7.m7.1b"><csymbol cd="latexml" id="S14.p1.7.7.m7.1.1.cmml" xref="S14.p1.7.7.m7.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S14.p1.7.7.m7.1c">\pm</annotation></semantics></math> 2.67 while Prob-NMN dropped to 50.26 <math id="S14.p1.8.8.m8.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S14.p1.8.8.m8.1a"><mo mathcolor="#000000" id="S14.p1.8.8.m8.1.1" xref="S14.p1.8.8.m8.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S14.p1.8.8.m8.1b"><csymbol cd="latexml" id="S14.p1.8.8.m8.1.1.cmml" xref="S14.p1.8.8.m8.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S14.p1.8.8.m8.1c">\pm</annotation></semantics></math> 2.01.
In general, we do not see a greater benefit of handling aleatoric uncertaintly via.
averaging for Prob-NMN over NMN when tested in the out-of-domain CLEVR-humans
dataset. Our hypothesis for this is that amortized inference is not handling
aleatoric uncertainty as well as we desire in our application.</span></p>
</div>
</section>
<section id="S15" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">15 </span>Coherence and Sensitivity results on CLEVR</h2>

<div id="S15.p1" class="ltx_para">
<p id="S15.p1.3" class="ltx_p"><span id="S15.p1.3.3" class="ltx_text" style="color:#000000;">We repeat the same procedure used for the SHAPES dataset on the CLEVR
dataset to analyze the coherence and sensitivity in the reasoning
performed by the Prob-NMN model. Given an image and a candidate answer,
say “yes” as input, we find that multiple sample programs drawn from
the model are coherent with respect to each other. In <a href="#S11.F4" title="In 11 Additional Results on SHAPES ‣ Probabilistic Neural-symbolic Models for Interpretable Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a>
we show a sorted list of such programs ranked by log-probability of programs, <math id="S15.p1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S15.p1.1.1.m1.1a"><mi mathcolor="#000000" id="S15.p1.1.1.m1.1.1" xref="S15.p1.1.1.m1.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S15.p1.1.1.m1.1b"><ci id="S15.p1.1.1.m1.1.1.cmml" xref="S15.p1.1.1.m1.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S15.p1.1.1.m1.1c">\mathbf{z}</annotation></semantics></math>. Next,
when we switch the answer to “no”, we find that the program changes in a
sensible manner, yeilding something that should correctly evaluate to the specified
answer. However, in general we find that the results are not as interpretable
for non “yes”/“no” answers. For example, when conditioning on “small”, we find
that the model makes a mistake of asking for the object in front of “large brown
metal” object in stead of “large brown” object. This might be because
the proposed model does not take into account question premise (i.e. does not
have an arrow from <math id="S15.p1.2.2.m2.1" class="ltx_Math" alttext="\mathbf{i}" display="inline"><semantics id="S15.p1.2.2.m2.1a"><mi mathcolor="#000000" id="S15.p1.2.2.m2.1.1" xref="S15.p1.2.2.m2.1.1.cmml">𝐢</mi><annotation-xml encoding="MathML-Content" id="S15.p1.2.2.m2.1b"><ci id="S15.p1.2.2.m2.1.1.cmml" xref="S15.p1.2.2.m2.1.1">𝐢</ci></annotation-xml><annotation encoding="application/x-tex" id="S15.p1.2.2.m2.1c">\mathbf{i}</annotation></semantics></math> to <math id="S15.p1.3.3.m3.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S15.p1.3.3.m3.1a"><mi mathcolor="#000000" id="S15.p1.3.3.m3.1.1" xref="S15.p1.3.3.m3.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S15.p1.3.3.m3.1b"><ci id="S15.p1.3.3.m3.1.1.cmml" xref="S15.p1.3.3.m3.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S15.p1.3.3.m3.1c">\mathbf{z}</annotation></semantics></math>) meaning that a question about a large brown
metal object would never be asked about this image, since it is not present in
it.</span></p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1902.07863" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1902.07864" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1902.07864">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1902.07864" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1902.07865" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar 16 20:25:37 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
