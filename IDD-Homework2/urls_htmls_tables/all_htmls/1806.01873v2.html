<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1806.01873] Focal Visual-Text Attention for Visual Question Answering</title><meta property="og:description" content="Recent insights on language and vision with neural networks have been successfully applied to simple single-image visual question answering. However, to tackle real-life question answering problems on multimedia collec…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Focal Visual-Text Attention for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Focal Visual-Text Attention for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1806.01873">

<!--Generated on Fri Mar  8 08:36:23 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
Focal Visual-Text Attention for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Junwei Liang<sup id="id1.1.id1" class="ltx_sup">1</sup>   Lu Jiang<sup id="id2.2.id2" class="ltx_sup">2</sup>   Liangliang Cao<sup id="id3.3.id3" class="ltx_sup">3</sup>   Li-Jia Li<sup id="id4.4.id4" class="ltx_sup">2</sup>   Alexander Hauptmann<sup id="id5.5.id5" class="ltx_sup">1</sup> 
<br class="ltx_break"><sup id="id6.6.id6" class="ltx_sup">1</sup>Carnegie Mellon University     <sup id="id7.7.id7" class="ltx_sup">2</sup>Google Inc.     <sup id="id8.8.id8" class="ltx_sup">3</sup>HelloVera AI
<br class="ltx_break"><span id="id9.9.id9" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{junweil,alex}@cs.cmu.edu, {lujiang,lijiali}@google.com, liangliang.cao@gmail.com</span>

<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id10.id1" class="ltx_p">Recent insights on language and vision with neural networks have been successfully applied to simple single-image visual question answering. However, to tackle real-life question answering problems on multimedia collections such as personal photos, we have to look at whole collections with sequences of photos or videos. When answering questions from a large collection, a natural problem is to identify snippets to support the answer. In this paper, we describe a novel neural network called Focal Visual-Text Attention network (FVTA) for collective reasoning in visual question answering, where both visual and text sequence information such as images and text metadata are presented. FVTA introduces an end-to-end approach that makes use of a hierarchical process to dynamically determine what media and what time to focus on in the sequential data to answer the question. FVTA can not only answer the questions well but also provides the justifications which the system results are based upon to get the answers. FVTA achieves state-of-the-art performance on the MemexQA dataset and competitive results on the MovieQA dataset.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Language and vision have emerged as a popular research area in computer vision. Visual question answering (VQA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> is a successful direction utilizing both computer vision and natural language processing techniques to solve an interesting problem: given a pair of image and a question (in natural language), the goal is to learn an inference model that can the answer questions according to cues discovered from the image. A variety of methods have been proposed to address the challenges from different aspects <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, with remarkable progress on answering about a single image.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1806.01873/assets/memexqa_p1_2.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="322" height="223" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Focal Visual-Text Attention (FVTA) Mechanism. Given the visual-text sequences input and the question, our temporal visual-text attention tensor captures the temporal constraint in the question and emphasizes the most recent image with ”bar” scene visible. Then FVTA selects the appropriate attention region (the “date”) and finds the correct answer.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Extending from VQA on a single image,
this paper considers the following problem: Suppose a user’s photos and videos are organized in a sequence ordered by their creation time. Some photos or videos may be associated with meta labels or annotations such as time, GPS, captions, comments, and meaningful title. We are interested in training a model to answer questions about these images and texts, <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S1.p2.1.2" class="ltx_text"></span> “when was the last time I went to a bar?” or “what did my son do after his 2017 Halloween dinner party?”</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">There are two challenges to solve the above problem.
First, the input is provided in an unstructured form. The question is associated with multiple sequences, in the form of videos or images. Such sequences are temporally ordered, and each sequence contains multiple time steps. At each time there are visual data, text annotations and other metadata. In this paper, we call the format <span id="S1.p3.1.1" class="ltx_text ltx_font_bold ltx_font_italic">visual-text sequence</span> data. Note that not all the photos and videos are annotated, which requires a robust method to leverage inconsistently available multimodal data.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The second challenge requires interpretable justifications in addition to direct answer based on sequence data. To help users with a lot of photos and videos,
a natural requirement is to identify the supporting evidence for the answer. An example question
as shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, is “when was the last time I went to a bar?” From the users’ viewpoint, a good QA system should not only give a definite answer (<em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S1.p4.1.2" class="ltx_text"></span>, January 20, 2016), but also
ground evidential images or text snippets in the input sequence to justify the reasoning process. Given imperfect VQA models, humans often want to verify the answer. The inspection process may be trivial for a single image but can take a significant amount of time to examine every image and the complete text words.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To address these two challenges, we propose a focal visual-text attention (FVTA) model for sequential data <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Code and models are released at <a target="_blank" href="https://memexqa.cs.cmu.edu/fvta.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://memexqa.cs.cmu.edu/fvta.html</a></span></span></span>.
Our model is motivated by the reasoning process of humans. In order to answer a question, a human would first quickly skim the input and then focus on a few, small temporal regions in the visual-text sequences to derive an answer. In fact, statistics suggest that, on average, humans only need 1.5 images to answer a question after the skimming <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. Inspired by this process, FVTA first learns to localize relevant information within <em id="S1.p5.1.1" class="ltx_emph ltx_font_italic">a few, small, temporally consecutive regions</em> over the input sequences, and learns to infer an answer based on the cross-modal statistics pooled from these regions. FVTA proposes a novel kernel to compute the attention tensor that jointly models the latent information in three sources: 1) answer-signaling words in the question, 2) temporal correlation within a sequence, and 3) cross-modal interaction between the text and image. FVTA attention allows for collective reasoning by the attention kernel learned over a few, small, consecutive sub-sequences of text and image. It can also produce a list of evidential images/texts to justify the reasoning. As shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the highlighted cubes are regions of high activations in the proposed FVTA. To summarize, the contribution of this paper is threefold:</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/1806.01873/assets/memexqa_p2_2.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="665" height="212" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>An overview of Focal Visual-Text Attention (FVTA) model. For visual-text embedding, we use a pre-trained convolutional neural network to embed the photos and pre-trained word vectors to embed the words. We use a bi-directional LSTM as the sequence encoder. All hidden states from the question and the context are used to calculate the FVTA tensor.
Based on the FVTA attention, both question and the context are summarized into single vectors for the output layer to produce final answer. The output layer is used for multiple choice question classification. The text embedding of the answer choice is also used as the input. This input is not shown in the figure.
</figcaption>
</figure>
<div id="S1.p6" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a novel attention kernel for VQA on visual-text data. Experiments show that it outperforms existing attention methods.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">The proposed attention tensor can be used to localize evidential image and text snippets to explain the reasoning process. We quantitatively verify that the evidence produced by our method are more correlated to that of human annotators.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Our method achieves the state-of-the-art results on two VQA benchmarks.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Visual Question Answering.</span>
Image-based visual question answering has received a large amount of interest in the computer vision community.
A lot of efforts have been conducted on single image QA datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, where a common practice is to train a classifier by combining both question feature and visual features.
A recent direction is on the
question answering based on videos, which is more relevant to this work.
A number of research studies have been carried on MovieQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, with movie clips, scripts, and descriptions.
Because it is expensive to annotate the video-based QA datasets,
some research studies generate QA datasets by harvesting online videos and descriptions
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, while a recent study <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> considers question answering using animated GIFs.
This work differs from the existing video-based QA in two aspects: (1) video-based QA is to answer questions based on a single video, while our work can handle general visual-text sequences, where one user may have more than one video or albums of photos. (2) most existing video-based QA methods map one video sequence with text into a context feature vector, while our work explores a more fine-grained model by modeling the correlation between query and sequence data at every time step. To this end, we experiment on the MemexQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. The sequential data in MemexQA involves multiple modalities, including titles, timestamps, GPS and visual content, render it an ideal test bed for QA research over visual-text sequence data. Unlike the model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, our method also uses the text embedding of the answer choices as the input to answer a question.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Attention Mechanism.</span>
This work can be viewed as a novel attention model for multiple variable-length sequential inputs, to take into account not only the visual-text information but also the temporal dependency.
Our work extends the previous studies of using attention model for Image QA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.
A key difference between our method and classical attention model lies in the fact we are modeling the correlation at every time step, across multiple sequences. Existing attention mechanisms for VQA mainly focus on attention within spatial regions of an image <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> or within a single sequence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, and hence, may not fully exploit the multiple sequences and multiple time steps nature. As Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.2 Intra-sequence temporal dependency ‣ 4 Focal Visual-Text Attention ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows, our attention is applied to a three-dimensional tensor, while the classic soft attention model is applied to a vector or matrix.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Approach</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Formulation</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.12" class="ltx_p">We start the discussion by formally defining the problem. Let <math id="S3.SS1.p1.1.m1.3" class="ltx_Math" alttext="Q=q_{1},\cdots,q_{M}" display="inline"><semantics id="S3.SS1.p1.1.m1.3a"><mrow id="S3.SS1.p1.1.m1.3.3" xref="S3.SS1.p1.1.m1.3.3.cmml"><mi id="S3.SS1.p1.1.m1.3.3.4" xref="S3.SS1.p1.1.m1.3.3.4.cmml">Q</mi><mo id="S3.SS1.p1.1.m1.3.3.3" xref="S3.SS1.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.3.3.2.2" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml"><msub id="S3.SS1.p1.1.m1.2.2.1.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.2.2.1.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml">q</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.3.3.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.1.m1.3.3.2.2.4" xref="S3.SS1.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml">q</mi><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">M</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.3b"><apply id="S3.SS1.p1.1.m1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3"><eq id="S3.SS1.p1.1.m1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3.3"></eq><ci id="S3.SS1.p1.1.m1.3.3.4.cmml" xref="S3.SS1.p1.1.m1.3.3.4">𝑄</ci><list id="S3.SS1.p1.1.m1.3.3.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2"><apply id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2">𝑞</ci><cn type="integer" id="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">⋯</ci><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2">𝑞</ci><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3">𝑀</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.3c">Q=q_{1},\cdots,q_{M}</annotation></semantics></math> represent a question of <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">M</annotation></semantics></math> words <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="Q\in\mathbb{Z}^{M}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">Q</mi><mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">ℤ</mi><mi id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml">M</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><in id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></in><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑄</ci><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">ℤ</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">Q\in\mathbb{Z}^{M}</annotation></semantics></math>, where each word is an integer index in the vocabulary. Define a context visual-text sequence of <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">T</annotation></semantics></math> examples <math id="S3.SS1.p1.5.m5.3" class="ltx_Math" alttext="\mathbf{X}=\mathbf{x}_{1},\cdots,\mathbf{x}_{T}" display="inline"><semantics id="S3.SS1.p1.5.m5.3a"><mrow id="S3.SS1.p1.5.m5.3.3" xref="S3.SS1.p1.5.m5.3.3.cmml"><mi id="S3.SS1.p1.5.m5.3.3.4" xref="S3.SS1.p1.5.m5.3.3.4.cmml">𝐗</mi><mo id="S3.SS1.p1.5.m5.3.3.3" xref="S3.SS1.p1.5.m5.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.5.m5.3.3.2.2" xref="S3.SS1.p1.5.m5.3.3.2.3.cmml"><msub id="S3.SS1.p1.5.m5.2.2.1.1.1" xref="S3.SS1.p1.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.5.m5.2.2.1.1.1.2" xref="S3.SS1.p1.5.m5.2.2.1.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p1.5.m5.2.2.1.1.1.3" xref="S3.SS1.p1.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.5.m5.3.3.2.2.3" xref="S3.SS1.p1.5.m5.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.5.m5.3.3.2.2.4" xref="S3.SS1.p1.5.m5.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.5.m5.3.3.2.2.2" xref="S3.SS1.p1.5.m5.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.5.m5.3.3.2.2.2.2" xref="S3.SS1.p1.5.m5.3.3.2.2.2.2.cmml">𝐱</mi><mi id="S3.SS1.p1.5.m5.3.3.2.2.2.3" xref="S3.SS1.p1.5.m5.3.3.2.2.2.3.cmml">T</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.3b"><apply id="S3.SS1.p1.5.m5.3.3.cmml" xref="S3.SS1.p1.5.m5.3.3"><eq id="S3.SS1.p1.5.m5.3.3.3.cmml" xref="S3.SS1.p1.5.m5.3.3.3"></eq><ci id="S3.SS1.p1.5.m5.3.3.4.cmml" xref="S3.SS1.p1.5.m5.3.3.4">𝐗</ci><list id="S3.SS1.p1.5.m5.3.3.2.3.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2"><apply id="S3.SS1.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1.2">𝐱</ci><cn type="integer" id="S3.SS1.p1.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">⋯</ci><apply id="S3.SS1.p1.5.m5.3.3.2.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2.2">𝐱</ci><ci id="S3.SS1.p1.5.m5.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.3c">\mathbf{X}=\mathbf{x}_{1},\cdots,\mathbf{x}_{T}</annotation></semantics></math>, where for each example, <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{x}_{t}^{img}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msubsup id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2.2" xref="S3.SS1.p1.6.m6.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS1.p1.6.m6.1.1.2.3" xref="S3.SS1.p1.6.m6.1.1.2.3.cmml">t</mi><mrow id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.3.1" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.3.1a" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.3.4" xref="S3.SS1.p1.6.m6.1.1.3.4.cmml">g</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">superscript</csymbol><apply id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2.2">𝐱</ci><ci id="S3.SS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><times id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1"></times><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">𝑖</ci><ci id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3">𝑚</ci><ci id="S3.SS1.p1.6.m6.1.1.3.4.cmml" xref="S3.SS1.p1.6.m6.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathbf{x}_{t}^{img}</annotation></semantics></math> represents an image. <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathbf{x}_{t}^{txt}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><msubsup id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2.2" xref="S3.SS1.p1.7.m7.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS1.p1.7.m7.1.1.2.3" xref="S3.SS1.p1.7.m7.1.1.2.3.cmml">t</mi><mrow id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m7.1.1.3.1" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m7.1.1.3.1a" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.7.m7.1.1.3.4" xref="S3.SS1.p1.7.m7.1.1.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">superscript</csymbol><apply id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2.2">𝐱</ci><ci id="S3.SS1.p1.7.m7.1.1.2.3.cmml" xref="S3.SS1.p1.7.m7.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><times id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.1"></times><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">𝑡</ci><ci id="S3.SS1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3">𝑥</ci><ci id="S3.SS1.p1.7.m7.1.1.3.4.cmml" xref="S3.SS1.p1.7.m7.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\mathbf{x}_{t}^{txt}</annotation></semantics></math> is its corresponding text sentence, where its <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">i</annotation></semantics></math>-th word is indexed by <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{x}_{ti}^{txt}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><msubsup id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2.2" xref="S3.SS1.p1.9.m9.1.1.2.2.cmml">𝐱</mi><mrow id="S3.SS1.p1.9.m9.1.1.2.3" xref="S3.SS1.p1.9.m9.1.1.2.3.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2.3.2" xref="S3.SS1.p1.9.m9.1.1.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.1.1.2.3.1" xref="S3.SS1.p1.9.m9.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.1.1.2.3.3" xref="S3.SS1.p1.9.m9.1.1.2.3.3.cmml">i</mi></mrow><mrow id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml"><mi id="S3.SS1.p1.9.m9.1.1.3.2" xref="S3.SS1.p1.9.m9.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.1.1.3.1" xref="S3.SS1.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.1.1.3.3" xref="S3.SS1.p1.9.m9.1.1.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.1.1.3.1a" xref="S3.SS1.p1.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.9.m9.1.1.3.4" xref="S3.SS1.p1.9.m9.1.1.3.4.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">superscript</csymbol><apply id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2.2">𝐱</ci><apply id="S3.SS1.p1.9.m9.1.1.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.2.3"><times id="S3.SS1.p1.9.m9.1.1.2.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.2.3.1"></times><ci id="S3.SS1.p1.9.m9.1.1.2.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2.3.2">𝑡</ci><ci id="S3.SS1.p1.9.m9.1.1.2.3.3.cmml" xref="S3.SS1.p1.9.m9.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3"><times id="S3.SS1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1"></times><ci id="S3.SS1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2">𝑡</ci><ci id="S3.SS1.p1.9.m9.1.1.3.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.3">𝑥</ci><ci id="S3.SS1.p1.9.m9.1.1.3.4.cmml" xref="S3.SS1.p1.9.m9.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\mathbf{x}_{ti}^{txt}</annotation></semantics></math>. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, the answer to a question is an integer <math id="S3.SS1.p1.10.m10.2" class="ltx_Math" alttext="y\in[1,L]" display="inline"><semantics id="S3.SS1.p1.10.m10.2a"><mrow id="S3.SS1.p1.10.m10.2.3" xref="S3.SS1.p1.10.m10.2.3.cmml"><mi id="S3.SS1.p1.10.m10.2.3.2" xref="S3.SS1.p1.10.m10.2.3.2.cmml">y</mi><mo id="S3.SS1.p1.10.m10.2.3.1" xref="S3.SS1.p1.10.m10.2.3.1.cmml">∈</mo><mrow id="S3.SS1.p1.10.m10.2.3.3.2" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.10.m10.2.3.3.2.1" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml">[</mo><mn id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">1</mn><mo id="S3.SS1.p1.10.m10.2.3.3.2.2" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.10.m10.2.2" xref="S3.SS1.p1.10.m10.2.2.cmml">L</mi><mo stretchy="false" id="S3.SS1.p1.10.m10.2.3.3.2.3" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.2b"><apply id="S3.SS1.p1.10.m10.2.3.cmml" xref="S3.SS1.p1.10.m10.2.3"><in id="S3.SS1.p1.10.m10.2.3.1.cmml" xref="S3.SS1.p1.10.m10.2.3.1"></in><ci id="S3.SS1.p1.10.m10.2.3.2.cmml" xref="S3.SS1.p1.10.m10.2.3.2">𝑦</ci><interval closure="closed" id="S3.SS1.p1.10.m10.2.3.3.1.cmml" xref="S3.SS1.p1.10.m10.2.3.3.2"><cn type="integer" id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">1</cn><ci id="S3.SS1.p1.10.m10.2.2.cmml" xref="S3.SS1.p1.10.m10.2.2">𝐿</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.2c">y\in[1,L]</annotation></semantics></math> over the answer vocabulary of size <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">L</annotation></semantics></math>. Given a collection of <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><mi id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">n</annotation></semantics></math> questions and their context sequences, we are interested in learning a model maximizing the following likelihood:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.2" class="ltx_Math" alttext="\operatorname*{argmax}_{\Theta}\sum_{i=1}^{n}\log P(y_{i}|Q_{i},\mathbf{X}_{i};\Theta)" display="block"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><munder id="S3.E1.m1.2.2.3" xref="S3.E1.m1.2.2.3.cmml"><mo id="S3.E1.m1.2.2.3.2" xref="S3.E1.m1.2.2.3.2.cmml">argmax</mo><mi mathvariant="normal" id="S3.E1.m1.2.2.3.3" xref="S3.E1.m1.2.2.3.3.cmml">Θ</mi></munder><mo lspace="0.167em" rspace="0em" id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml">​</mo><mrow id="S3.E1.m1.2.2.1" xref="S3.E1.m1.2.2.1.cmml"><munderover id="S3.E1.m1.2.2.1.2" xref="S3.E1.m1.2.2.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.2.2.1.2.2.2" xref="S3.E1.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.2.2.1.2.2.3" xref="S3.E1.m1.2.2.1.2.2.3.cmml"><mi id="S3.E1.m1.2.2.1.2.2.3.2" xref="S3.E1.m1.2.2.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.2.2.1.2.2.3.1" xref="S3.E1.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.2.2.1.2.2.3.3" xref="S3.E1.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.2.2.1.2.3" xref="S3.E1.m1.2.2.1.2.3.cmml">n</mi></munderover><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1.3" xref="S3.E1.m1.2.2.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.3.1" xref="S3.E1.m1.2.2.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E1.m1.2.2.1.1.3a" xref="S3.E1.m1.2.2.1.1.3.cmml">⁡</mo><mi id="S3.E1.m1.2.2.1.1.3.2" xref="S3.E1.m1.2.2.1.1.3.2.cmml">P</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.2.2.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.E1.m1.2.2.1.1.1.1.1.4" xref="S3.E1.m1.2.2.1.1.1.1.1.4.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.4.2" xref="S3.E1.m1.2.2.1.1.1.1.1.4.2.cmml">y</mi><mi id="S3.E1.m1.2.2.1.1.1.1.1.4.3" xref="S3.E1.m1.2.2.1.1.1.1.1.4.3.cmml">i</mi></msub><mo fence="false" id="S3.E1.m1.2.2.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E1.m1.2.2.1.1.1.1.1.2.2" xref="S3.E1.m1.2.2.1.1.1.1.1.2.3.cmml"><msub id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">Q</mi><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.2.2.1.1.1.1.1.2.2.3" xref="S3.E1.m1.2.2.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E1.m1.2.2.1.1.1.1.1.2.2.2" xref="S3.E1.m1.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml">𝐗</mi><mi id="S3.E1.m1.2.2.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.2.2.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.2.2.1.1.1.1.1.2.2.4" xref="S3.E1.m1.2.2.1.1.1.1.1.2.3.cmml">;</mo><mi mathvariant="normal" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">Θ</mi></mrow></mrow><mo stretchy="false" id="S3.E1.m1.2.2.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><times id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"></times><apply id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.3.1.cmml" xref="S3.E1.m1.2.2.3">subscript</csymbol><ci id="S3.E1.m1.2.2.3.2.cmml" xref="S3.E1.m1.2.2.3.2">argmax</ci><ci id="S3.E1.m1.2.2.3.3.cmml" xref="S3.E1.m1.2.2.3.3">Θ</ci></apply><apply id="S3.E1.m1.2.2.1.cmml" xref="S3.E1.m1.2.2.1"><apply id="S3.E1.m1.2.2.1.2.cmml" xref="S3.E1.m1.2.2.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.2.1.cmml" xref="S3.E1.m1.2.2.1.2">superscript</csymbol><apply id="S3.E1.m1.2.2.1.2.2.cmml" xref="S3.E1.m1.2.2.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.2.2.1.cmml" xref="S3.E1.m1.2.2.1.2">subscript</csymbol><sum id="S3.E1.m1.2.2.1.2.2.2.cmml" xref="S3.E1.m1.2.2.1.2.2.2"></sum><apply id="S3.E1.m1.2.2.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.2.2.3"><eq id="S3.E1.m1.2.2.1.2.2.3.1.cmml" xref="S3.E1.m1.2.2.1.2.2.3.1"></eq><ci id="S3.E1.m1.2.2.1.2.2.3.2.cmml" xref="S3.E1.m1.2.2.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.2.2.1.2.2.3.3.cmml" xref="S3.E1.m1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.2.2.1.2.3.cmml" xref="S3.E1.m1.2.2.1.2.3">𝑛</ci></apply><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1.1"><times id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2"></times><apply id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.3"><log id="S3.E1.m1.2.2.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1"></log><ci id="S3.E1.m1.2.2.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.3.2">𝑃</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E1.m1.2.2.1.1.1.1.1.4.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.4.2">𝑦</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.4.3">𝑖</ci></apply><list id="S3.E1.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.2.2"><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.2">𝑄</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.2.2.2.2">𝐗</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">Θ</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">\operatorname*{argmax}_{\Theta}\sum_{i=1}^{n}\log P(y_{i}|Q_{i},\mathbf{X}_{i};\Theta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.14" class="ltx_p">where <math id="S3.SS1.p1.13.m1.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S3.SS1.p1.13.m1.1a"><mi mathvariant="normal" id="S3.SS1.p1.13.m1.1.1" xref="S3.SS1.p1.13.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m1.1b"><ci id="S3.SS1.p1.13.m1.1.1.cmml" xref="S3.SS1.p1.13.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m1.1c">\Theta</annotation></semantics></math> represents the model parameters. Given the visual-text sequence input <math id="S3.SS1.p1.14.m2.2" class="ltx_Math" alttext="\mathbf{X}^{img},\mathbf{X}^{txt}" display="inline"><semantics id="S3.SS1.p1.14.m2.2a"><mrow id="S3.SS1.p1.14.m2.2.2.2" xref="S3.SS1.p1.14.m2.2.2.3.cmml"><msup id="S3.SS1.p1.14.m2.1.1.1.1" xref="S3.SS1.p1.14.m2.1.1.1.1.cmml"><mi id="S3.SS1.p1.14.m2.1.1.1.1.2" xref="S3.SS1.p1.14.m2.1.1.1.1.2.cmml">𝐗</mi><mrow id="S3.SS1.p1.14.m2.1.1.1.1.3" xref="S3.SS1.p1.14.m2.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.14.m2.1.1.1.1.3.2" xref="S3.SS1.p1.14.m2.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m2.1.1.1.1.3.1" xref="S3.SS1.p1.14.m2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.14.m2.1.1.1.1.3.3" xref="S3.SS1.p1.14.m2.1.1.1.1.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m2.1.1.1.1.3.1a" xref="S3.SS1.p1.14.m2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.14.m2.1.1.1.1.3.4" xref="S3.SS1.p1.14.m2.1.1.1.1.3.4.cmml">g</mi></mrow></msup><mo id="S3.SS1.p1.14.m2.2.2.2.3" xref="S3.SS1.p1.14.m2.2.2.3.cmml">,</mo><msup id="S3.SS1.p1.14.m2.2.2.2.2" xref="S3.SS1.p1.14.m2.2.2.2.2.cmml"><mi id="S3.SS1.p1.14.m2.2.2.2.2.2" xref="S3.SS1.p1.14.m2.2.2.2.2.2.cmml">𝐗</mi><mrow id="S3.SS1.p1.14.m2.2.2.2.2.3" xref="S3.SS1.p1.14.m2.2.2.2.2.3.cmml"><mi id="S3.SS1.p1.14.m2.2.2.2.2.3.2" xref="S3.SS1.p1.14.m2.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m2.2.2.2.2.3.1" xref="S3.SS1.p1.14.m2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.14.m2.2.2.2.2.3.3" xref="S3.SS1.p1.14.m2.2.2.2.2.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m2.2.2.2.2.3.1a" xref="S3.SS1.p1.14.m2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.14.m2.2.2.2.2.3.4" xref="S3.SS1.p1.14.m2.2.2.2.2.3.4.cmml">t</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m2.2b"><list id="S3.SS1.p1.14.m2.2.2.3.cmml" xref="S3.SS1.p1.14.m2.2.2.2"><apply id="S3.SS1.p1.14.m2.1.1.1.1.cmml" xref="S3.SS1.p1.14.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m2.1.1.1.1.1.cmml" xref="S3.SS1.p1.14.m2.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.14.m2.1.1.1.1.2.cmml" xref="S3.SS1.p1.14.m2.1.1.1.1.2">𝐗</ci><apply id="S3.SS1.p1.14.m2.1.1.1.1.3.cmml" xref="S3.SS1.p1.14.m2.1.1.1.1.3"><times id="S3.SS1.p1.14.m2.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.14.m2.1.1.1.1.3.1"></times><ci id="S3.SS1.p1.14.m2.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.14.m2.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p1.14.m2.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.14.m2.1.1.1.1.3.3">𝑚</ci><ci id="S3.SS1.p1.14.m2.1.1.1.1.3.4.cmml" xref="S3.SS1.p1.14.m2.1.1.1.1.3.4">𝑔</ci></apply></apply><apply id="S3.SS1.p1.14.m2.2.2.2.2.cmml" xref="S3.SS1.p1.14.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m2.2.2.2.2.1.cmml" xref="S3.SS1.p1.14.m2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.p1.14.m2.2.2.2.2.2.cmml" xref="S3.SS1.p1.14.m2.2.2.2.2.2">𝐗</ci><apply id="S3.SS1.p1.14.m2.2.2.2.2.3.cmml" xref="S3.SS1.p1.14.m2.2.2.2.2.3"><times id="S3.SS1.p1.14.m2.2.2.2.2.3.1.cmml" xref="S3.SS1.p1.14.m2.2.2.2.2.3.1"></times><ci id="S3.SS1.p1.14.m2.2.2.2.2.3.2.cmml" xref="S3.SS1.p1.14.m2.2.2.2.2.3.2">𝑡</ci><ci id="S3.SS1.p1.14.m2.2.2.2.2.3.3.cmml" xref="S3.SS1.p1.14.m2.2.2.2.2.3.3">𝑥</ci><ci id="S3.SS1.p1.14.m2.2.2.2.2.3.4.cmml" xref="S3.SS1.p1.14.m2.2.2.2.2.3.4">𝑡</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m2.2c">\mathbf{X}^{img},\mathbf{X}^{txt}</annotation></semantics></math>, we obtain a good joint representation by attention model. With FVTA attention, the model takes into account of the sequential dependency in image or text sequence, respectively, and cross-modal visual-text correlations. Meanwhile, the computed attention weights over input sequences can be utilized to derive meaningful justifications.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Network Architecture</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">This subsection discusses our overall neural network architecture.
As shown in Fig. <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the proposed network consists of the following layers.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.1" class="ltx_p"><span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_bold">Visual-Text Embedding</span> Every image or video frame is encoded
with a pre-trained Convolutional Neural Network.
Both word-level and character level embedding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> are used to represent the word in text and question.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.7" class="ltx_p"><span id="S3.SS2.p3.7.1" class="ltx_text ltx_font_bold">Sequence Encoder</span>
We use separate LSTM networks to encode visual and text sequences, respectively, to capture the temporal dependency within each individual sequence. The inputs to the LSTM units are image/text embedding produced by the previous layer. Let <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">d</annotation></semantics></math> denote the size of the hidden state of the LSTM unit; the question <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">Q</annotation></semantics></math> is represented as a matrix <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\mathbf{Q}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\mathbf{Q}</annotation></semantics></math> of concatenated bi-directional LSTM outputs at each step, <em id="S3.SS2.p3.7.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS2.p3.7.3" class="ltx_text"></span>, <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="\mathbf{Q}\in\mathbb{R}^{2d\times M}" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><mrow id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">𝐐</mi><mo id="S3.SS2.p3.4.m4.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.3.2" xref="S3.SS2.p3.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.4.m4.1.1.3.3" xref="S3.SS2.p3.4.m4.1.1.3.3.cmml"><mrow id="S3.SS2.p3.4.m4.1.1.3.3.2" xref="S3.SS2.p3.4.m4.1.1.3.3.2.cmml"><mn id="S3.SS2.p3.4.m4.1.1.3.3.2.2" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS2.p3.4.m4.1.1.3.3.2.1" xref="S3.SS2.p3.4.m4.1.1.3.3.2.1.cmml">​</mo><mi id="S3.SS2.p3.4.m4.1.1.3.3.2.3" xref="S3.SS2.p3.4.m4.1.1.3.3.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.4.m4.1.1.3.3.1" xref="S3.SS2.p3.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.4.m4.1.1.3.3.3" xref="S3.SS2.p3.4.m4.1.1.3.3.3.cmml">M</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><in id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1"></in><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">𝐐</ci><apply id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS2.p3.4.m4.1.1.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3"><times id="S3.SS2.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1"></times><apply id="S3.SS2.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2"><times id="S3.SS2.p3.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2.1"></times><cn type="integer" id="S3.SS2.p3.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2">2</cn><ci id="S3.SS2.p3.4.m4.1.1.3.3.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2.3">𝑑</ci></apply><ci id="S3.SS2.p3.4.m4.1.1.3.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\mathbf{Q}\in\mathbb{R}^{2d\times M}</annotation></semantics></math>, where <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">M</annotation></semantics></math> is the maximum length of the question. Likewise, The sequentially encoded text and images are represented by <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="\mathbf{H}\in\mathbb{R}^{2d\times T\times 2}" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><mrow id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">𝐇</mi><mo id="S3.SS2.p3.6.m6.1.1.1" xref="S3.SS2.p3.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3.cmml"><mi id="S3.SS2.p3.6.m6.1.1.3.2" xref="S3.SS2.p3.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.6.m6.1.1.3.3" xref="S3.SS2.p3.6.m6.1.1.3.3.cmml"><mrow id="S3.SS2.p3.6.m6.1.1.3.3.2" xref="S3.SS2.p3.6.m6.1.1.3.3.2.cmml"><mn id="S3.SS2.p3.6.m6.1.1.3.3.2.2" xref="S3.SS2.p3.6.m6.1.1.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS2.p3.6.m6.1.1.3.3.2.1" xref="S3.SS2.p3.6.m6.1.1.3.3.2.1.cmml">​</mo><mi id="S3.SS2.p3.6.m6.1.1.3.3.2.3" xref="S3.SS2.p3.6.m6.1.1.3.3.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.6.m6.1.1.3.3.1" xref="S3.SS2.p3.6.m6.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p3.6.m6.1.1.3.3.3" xref="S3.SS2.p3.6.m6.1.1.3.3.3.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.6.m6.1.1.3.3.1a" xref="S3.SS2.p3.6.m6.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.p3.6.m6.1.1.3.3.4" xref="S3.SS2.p3.6.m6.1.1.3.3.4.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><in id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1.1"></in><ci id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">𝐇</ci><apply id="S3.SS2.p3.6.m6.1.1.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.3.1.cmml" xref="S3.SS2.p3.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.3.2.cmml" xref="S3.SS2.p3.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS2.p3.6.m6.1.1.3.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3.3"><times id="S3.SS2.p3.6.m6.1.1.3.3.1.cmml" xref="S3.SS2.p3.6.m6.1.1.3.3.1"></times><apply id="S3.SS2.p3.6.m6.1.1.3.3.2.cmml" xref="S3.SS2.p3.6.m6.1.1.3.3.2"><times id="S3.SS2.p3.6.m6.1.1.3.3.2.1.cmml" xref="S3.SS2.p3.6.m6.1.1.3.3.2.1"></times><cn type="integer" id="S3.SS2.p3.6.m6.1.1.3.3.2.2.cmml" xref="S3.SS2.p3.6.m6.1.1.3.3.2.2">2</cn><ci id="S3.SS2.p3.6.m6.1.1.3.3.2.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3.3.2.3">𝑑</ci></apply><ci id="S3.SS2.p3.6.m6.1.1.3.3.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3.3.3">𝑇</ci><cn type="integer" id="S3.SS2.p3.6.m6.1.1.3.3.4.cmml" xref="S3.SS2.p3.6.m6.1.1.3.3.4">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">\mathbf{H}\in\mathbb{R}^{2d\times T\times 2}</annotation></semantics></math>, where <math id="S3.SS2.p3.7.m7.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.p3.7.m7.1a"><mi id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><ci id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">T</annotation></semantics></math> is the maximum length of the sequence.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para ltx_noindent">
<p id="S3.SS2.p4.2" class="ltx_p"><span id="S3.SS2.p4.2.1" class="ltx_text ltx_font_bold">Focal Visual-Text Attention</span>
The FVTA is a novel layer to implement the proposed attention mechanism. It represents a network layer that models the correlations between questions and multi-dimensional context and produces the summarized input to the final output layer, <span id="S3.SS2.p4.2.2" class="ltx_text ltx_font_italic">i.e.</span>, <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{\tilde{h}}\in\mathbb{R}^{2d}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mover accent="true" id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2.2" xref="S3.SS2.p4.1.m1.1.1.2.2.cmml">𝐡</mi><mo id="S3.SS2.p4.1.m1.1.1.2.1" xref="S3.SS2.p4.1.m1.1.1.2.1.cmml">~</mo></mover><mo id="S3.SS2.p4.1.m1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3.2" xref="S3.SS2.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.1.m1.1.1.3.3" xref="S3.SS2.p4.1.m1.1.1.3.3.cmml"><mn id="S3.SS2.p4.1.m1.1.1.3.3.2" xref="S3.SS2.p4.1.m1.1.1.3.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS2.p4.1.m1.1.1.3.3.1" xref="S3.SS2.p4.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS2.p4.1.m1.1.1.3.3.3" xref="S3.SS2.p4.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><in id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1"></in><apply id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2"><ci id="S3.SS2.p4.1.m1.1.1.2.1.cmml" xref="S3.SS2.p4.1.m1.1.1.2.1">~</ci><ci id="S3.SS2.p4.1.m1.1.1.2.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2.2">𝐡</ci></apply><apply id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3"><times id="S3.SS2.p4.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3.1"></times><cn type="integer" id="S3.SS2.p4.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3.2">2</cn><ci id="S3.SS2.p4.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\mathbf{\tilde{h}}\in\mathbb{R}^{2d}</annotation></semantics></math> and <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{\tilde{q}}\in\mathbb{R}^{2d}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><mrow id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mover accent="true" id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2.2" xref="S3.SS2.p4.2.m2.1.1.2.2.cmml">𝐪</mi><mo id="S3.SS2.p4.2.m2.1.1.2.1" xref="S3.SS2.p4.2.m2.1.1.2.1.cmml">~</mo></mover><mo id="S3.SS2.p4.2.m2.1.1.1" xref="S3.SS2.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml"><mi id="S3.SS2.p4.2.m2.1.1.3.2" xref="S3.SS2.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.2.m2.1.1.3.3" xref="S3.SS2.p4.2.m2.1.1.3.3.cmml"><mn id="S3.SS2.p4.2.m2.1.1.3.3.2" xref="S3.SS2.p4.2.m2.1.1.3.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.3.3.1" xref="S3.SS2.p4.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m2.1.1.3.3.3" xref="S3.SS2.p4.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><in id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1"></in><apply id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2"><ci id="S3.SS2.p4.2.m2.1.1.2.1.cmml" xref="S3.SS2.p4.2.m2.1.1.2.1">~</ci><ci id="S3.SS2.p4.2.m2.1.1.2.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2.2">𝐪</ci></apply><apply id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p4.2.m2.1.1.3.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3"><times id="S3.SS2.p4.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.1"></times><cn type="integer" id="S3.SS2.p4.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.2">2</cn><ci id="S3.SS2.p4.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">\mathbf{\tilde{q}}\in\mathbb{R}^{2d}</annotation></semantics></math>. We will discuss FVTA in the next section.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para ltx_noindent">
<p id="S3.SS2.p5.7" class="ltx_p"><span id="S3.SS2.p5.7.1" class="ltx_text ltx_font_bold">Output Layer</span>
After summarizing the input using the FVTA attention, we use a feed-forward layer to obtain the answer candidate. For multiple-choices questions, the task is to select one answer from a few candidate choices given the context and the question. Let <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mi id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">k</annotation></semantics></math> denote the number of candidate answers, we utilize the bi-directional LSTM to encode each of the answer choice and use the last hidden state as the representation for answers <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="\mathbf{E}\in\mathbb{R}^{k\times 2d}" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mrow id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">𝐄</mi><mo id="S3.SS2.p5.2.m2.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p5.2.m2.1.1.3.3" xref="S3.SS2.p5.2.m2.1.1.3.3.cmml"><mrow id="S3.SS2.p5.2.m2.1.1.3.3.2" xref="S3.SS2.p5.2.m2.1.1.3.3.2.cmml"><mi id="S3.SS2.p5.2.m2.1.1.3.3.2.2" xref="S3.SS2.p5.2.m2.1.1.3.3.2.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p5.2.m2.1.1.3.3.2.1" xref="S3.SS2.p5.2.m2.1.1.3.3.2.1.cmml">×</mo><mn id="S3.SS2.p5.2.m2.1.1.3.3.2.3" xref="S3.SS2.p5.2.m2.1.1.3.3.2.3.cmml">2</mn></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p5.2.m2.1.1.3.3.1" xref="S3.SS2.p5.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S3.SS2.p5.2.m2.1.1.3.3.3" xref="S3.SS2.p5.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><in id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1"></in><ci id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2">𝐄</ci><apply id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p5.2.m2.1.1.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3"><times id="S3.SS2.p5.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3.1"></times><apply id="S3.SS2.p5.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3.2"><times id="S3.SS2.p5.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3.2.1"></times><ci id="S3.SS2.p5.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3.2.2">𝑘</ci><cn type="integer" id="S3.SS2.p5.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3.2.3">2</cn></apply><ci id="S3.SS2.p5.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">\mathbf{E}\in\mathbb{R}^{k\times 2d}</annotation></semantics></math>. We tile the context representation <math id="S3.SS2.p5.3.m3.1" class="ltx_Math" alttext="\mathbf{\tilde{h}}" display="inline"><semantics id="S3.SS2.p5.3.m3.1a"><mover accent="true" id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">𝐡</mi><mo id="S3.SS2.p5.3.m3.1.1.1" xref="S3.SS2.p5.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><ci id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1.1">~</ci><ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">𝐡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">\mathbf{\tilde{h}}</annotation></semantics></math> and attended question representation, <math id="S3.SS2.p5.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p5.4.m4.1a"><mi id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><ci id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">k</annotation></semantics></math> times into <math id="S3.SS2.p5.5.m5.1" class="ltx_Math" alttext="\mathbf{\tilde{H}}\in\mathbb{R}^{k\times 2d}" display="inline"><semantics id="S3.SS2.p5.5.m5.1a"><mrow id="S3.SS2.p5.5.m5.1.1" xref="S3.SS2.p5.5.m5.1.1.cmml"><mover accent="true" id="S3.SS2.p5.5.m5.1.1.2" xref="S3.SS2.p5.5.m5.1.1.2.cmml"><mi id="S3.SS2.p5.5.m5.1.1.2.2" xref="S3.SS2.p5.5.m5.1.1.2.2.cmml">𝐇</mi><mo id="S3.SS2.p5.5.m5.1.1.2.1" xref="S3.SS2.p5.5.m5.1.1.2.1.cmml">~</mo></mover><mo id="S3.SS2.p5.5.m5.1.1.1" xref="S3.SS2.p5.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS2.p5.5.m5.1.1.3" xref="S3.SS2.p5.5.m5.1.1.3.cmml"><mi id="S3.SS2.p5.5.m5.1.1.3.2" xref="S3.SS2.p5.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p5.5.m5.1.1.3.3" xref="S3.SS2.p5.5.m5.1.1.3.3.cmml"><mrow id="S3.SS2.p5.5.m5.1.1.3.3.2" xref="S3.SS2.p5.5.m5.1.1.3.3.2.cmml"><mi id="S3.SS2.p5.5.m5.1.1.3.3.2.2" xref="S3.SS2.p5.5.m5.1.1.3.3.2.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p5.5.m5.1.1.3.3.2.1" xref="S3.SS2.p5.5.m5.1.1.3.3.2.1.cmml">×</mo><mn id="S3.SS2.p5.5.m5.1.1.3.3.2.3" xref="S3.SS2.p5.5.m5.1.1.3.3.2.3.cmml">2</mn></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p5.5.m5.1.1.3.3.1" xref="S3.SS2.p5.5.m5.1.1.3.3.1.cmml">​</mo><mi id="S3.SS2.p5.5.m5.1.1.3.3.3" xref="S3.SS2.p5.5.m5.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m5.1b"><apply id="S3.SS2.p5.5.m5.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1"><in id="S3.SS2.p5.5.m5.1.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1.1"></in><apply id="S3.SS2.p5.5.m5.1.1.2.cmml" xref="S3.SS2.p5.5.m5.1.1.2"><ci id="S3.SS2.p5.5.m5.1.1.2.1.cmml" xref="S3.SS2.p5.5.m5.1.1.2.1">~</ci><ci id="S3.SS2.p5.5.m5.1.1.2.2.cmml" xref="S3.SS2.p5.5.m5.1.1.2.2">𝐇</ci></apply><apply id="S3.SS2.p5.5.m5.1.1.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m5.1.1.3.1.cmml" xref="S3.SS2.p5.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS2.p5.5.m5.1.1.3.2.cmml" xref="S3.SS2.p5.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS2.p5.5.m5.1.1.3.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3.3"><times id="S3.SS2.p5.5.m5.1.1.3.3.1.cmml" xref="S3.SS2.p5.5.m5.1.1.3.3.1"></times><apply id="S3.SS2.p5.5.m5.1.1.3.3.2.cmml" xref="S3.SS2.p5.5.m5.1.1.3.3.2"><times id="S3.SS2.p5.5.m5.1.1.3.3.2.1.cmml" xref="S3.SS2.p5.5.m5.1.1.3.3.2.1"></times><ci id="S3.SS2.p5.5.m5.1.1.3.3.2.2.cmml" xref="S3.SS2.p5.5.m5.1.1.3.3.2.2">𝑘</ci><cn type="integer" id="S3.SS2.p5.5.m5.1.1.3.3.2.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3.3.2.3">2</cn></apply><ci id="S3.SS2.p5.5.m5.1.1.3.3.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m5.1c">\mathbf{\tilde{H}}\in\mathbb{R}^{k\times 2d}</annotation></semantics></math> and <math id="S3.SS2.p5.6.m6.1" class="ltx_Math" alttext="\mathbf{\tilde{Q}}\in\mathbb{R}^{k\times 2d}" display="inline"><semantics id="S3.SS2.p5.6.m6.1a"><mrow id="S3.SS2.p5.6.m6.1.1" xref="S3.SS2.p5.6.m6.1.1.cmml"><mover accent="true" id="S3.SS2.p5.6.m6.1.1.2" xref="S3.SS2.p5.6.m6.1.1.2.cmml"><mi id="S3.SS2.p5.6.m6.1.1.2.2" xref="S3.SS2.p5.6.m6.1.1.2.2.cmml">𝐐</mi><mo id="S3.SS2.p5.6.m6.1.1.2.1" xref="S3.SS2.p5.6.m6.1.1.2.1.cmml">~</mo></mover><mo id="S3.SS2.p5.6.m6.1.1.1" xref="S3.SS2.p5.6.m6.1.1.1.cmml">∈</mo><msup id="S3.SS2.p5.6.m6.1.1.3" xref="S3.SS2.p5.6.m6.1.1.3.cmml"><mi id="S3.SS2.p5.6.m6.1.1.3.2" xref="S3.SS2.p5.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p5.6.m6.1.1.3.3" xref="S3.SS2.p5.6.m6.1.1.3.3.cmml"><mrow id="S3.SS2.p5.6.m6.1.1.3.3.2" xref="S3.SS2.p5.6.m6.1.1.3.3.2.cmml"><mi id="S3.SS2.p5.6.m6.1.1.3.3.2.2" xref="S3.SS2.p5.6.m6.1.1.3.3.2.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p5.6.m6.1.1.3.3.2.1" xref="S3.SS2.p5.6.m6.1.1.3.3.2.1.cmml">×</mo><mn id="S3.SS2.p5.6.m6.1.1.3.3.2.3" xref="S3.SS2.p5.6.m6.1.1.3.3.2.3.cmml">2</mn></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p5.6.m6.1.1.3.3.1" xref="S3.SS2.p5.6.m6.1.1.3.3.1.cmml">​</mo><mi id="S3.SS2.p5.6.m6.1.1.3.3.3" xref="S3.SS2.p5.6.m6.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m6.1b"><apply id="S3.SS2.p5.6.m6.1.1.cmml" xref="S3.SS2.p5.6.m6.1.1"><in id="S3.SS2.p5.6.m6.1.1.1.cmml" xref="S3.SS2.p5.6.m6.1.1.1"></in><apply id="S3.SS2.p5.6.m6.1.1.2.cmml" xref="S3.SS2.p5.6.m6.1.1.2"><ci id="S3.SS2.p5.6.m6.1.1.2.1.cmml" xref="S3.SS2.p5.6.m6.1.1.2.1">~</ci><ci id="S3.SS2.p5.6.m6.1.1.2.2.cmml" xref="S3.SS2.p5.6.m6.1.1.2.2">𝐐</ci></apply><apply id="S3.SS2.p5.6.m6.1.1.3.cmml" xref="S3.SS2.p5.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.6.m6.1.1.3.1.cmml" xref="S3.SS2.p5.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS2.p5.6.m6.1.1.3.2.cmml" xref="S3.SS2.p5.6.m6.1.1.3.2">ℝ</ci><apply id="S3.SS2.p5.6.m6.1.1.3.3.cmml" xref="S3.SS2.p5.6.m6.1.1.3.3"><times id="S3.SS2.p5.6.m6.1.1.3.3.1.cmml" xref="S3.SS2.p5.6.m6.1.1.3.3.1"></times><apply id="S3.SS2.p5.6.m6.1.1.3.3.2.cmml" xref="S3.SS2.p5.6.m6.1.1.3.3.2"><times id="S3.SS2.p5.6.m6.1.1.3.3.2.1.cmml" xref="S3.SS2.p5.6.m6.1.1.3.3.2.1"></times><ci id="S3.SS2.p5.6.m6.1.1.3.3.2.2.cmml" xref="S3.SS2.p5.6.m6.1.1.3.3.2.2">𝑘</ci><cn type="integer" id="S3.SS2.p5.6.m6.1.1.3.3.2.3.cmml" xref="S3.SS2.p5.6.m6.1.1.3.3.2.3">2</cn></apply><ci id="S3.SS2.p5.6.m6.1.1.3.3.3.cmml" xref="S3.SS2.p5.6.m6.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.6.m6.1c">\mathbf{\tilde{Q}}\in\mathbb{R}^{k\times 2d}</annotation></semantics></math> to compute
the classification probability of <math id="S3.SS2.p5.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p5.7.m7.1a"><mi id="S3.SS2.p5.7.m7.1.1" xref="S3.SS2.p5.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.7.m7.1b"><ci id="S3.SS2.p5.7.m7.1.1.cmml" xref="S3.SS2.p5.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.7.m7.1c">k</annotation></semantics></math> choices. In practice we find the following simple equation works better than fully connected layer or straightforward concatenation:</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\mathbf{p}=softmax(\mathbf{w_{p}^{T}}[\mathbf{\tilde{Q}};\mathbf{\tilde{H}};\mathbf{E};\mathbf{\tilde{Q}}\odot\mathbf{E};\mathbf{\tilde{H}}\odot\mathbf{E}])\vspace{1mm}" display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><mi id="S3.E2.m1.4.4.3" xref="S3.E2.m1.4.4.3.cmml">𝐩</mi><mo id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.2.cmml">=</mo><mrow id="S3.E2.m1.4.4.1" xref="S3.E2.m1.4.4.1.cmml"><mi id="S3.E2.m1.4.4.1.3" xref="S3.E2.m1.4.4.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.2" xref="S3.E2.m1.4.4.1.2.cmml">​</mo><mi id="S3.E2.m1.4.4.1.4" xref="S3.E2.m1.4.4.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.2a" xref="S3.E2.m1.4.4.1.2.cmml">​</mo><mi id="S3.E2.m1.4.4.1.5" xref="S3.E2.m1.4.4.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.2b" xref="S3.E2.m1.4.4.1.2.cmml">​</mo><mi id="S3.E2.m1.4.4.1.6" xref="S3.E2.m1.4.4.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.2c" xref="S3.E2.m1.4.4.1.2.cmml">​</mo><mi id="S3.E2.m1.4.4.1.7" xref="S3.E2.m1.4.4.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.2d" xref="S3.E2.m1.4.4.1.2.cmml">​</mo><mi id="S3.E2.m1.4.4.1.8" xref="S3.E2.m1.4.4.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.2e" xref="S3.E2.m1.4.4.1.2.cmml">​</mo><mi id="S3.E2.m1.4.4.1.9" xref="S3.E2.m1.4.4.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.2f" xref="S3.E2.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.4.4.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.cmml"><msubsup id="S3.E2.m1.4.4.1.1.1.1.4" xref="S3.E2.m1.4.4.1.1.1.1.4.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.4.2.2" xref="S3.E2.m1.4.4.1.1.1.1.4.2.2.cmml">𝐰</mi><mi id="S3.E2.m1.4.4.1.1.1.1.4.2.3" xref="S3.E2.m1.4.4.1.1.1.1.4.2.3.cmml">𝐩</mi><mi id="S3.E2.m1.4.4.1.1.1.1.4.3" xref="S3.E2.m1.4.4.1.1.1.1.4.3.cmml">𝐓</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.3.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.2.2" xref="S3.E2.m1.4.4.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.1.1.1.2.2.3" xref="S3.E2.m1.4.4.1.1.1.1.2.3.cmml">[</mo><mover accent="true" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">𝐐</mi><mo id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml">~</mo></mover><mo id="S3.E2.m1.4.4.1.1.1.1.2.2.4" xref="S3.E2.m1.4.4.1.1.1.1.2.3.cmml">;</mo><mover accent="true" id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mi id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml">𝐇</mi><mo id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.cmml">~</mo></mover><mo id="S3.E2.m1.4.4.1.1.1.1.2.2.5" xref="S3.E2.m1.4.4.1.1.1.1.2.3.cmml">;</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">𝐄</mi><mo id="S3.E2.m1.4.4.1.1.1.1.2.2.6" xref="S3.E2.m1.4.4.1.1.1.1.2.3.cmml">;</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">𝐐</mi><mo id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.cmml">⊙</mo><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.cmml">𝐄</mi></mrow><mo id="S3.E2.m1.4.4.1.1.1.1.2.2.7" xref="S3.E2.m1.4.4.1.1.1.1.2.3.cmml">;</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.2.2.2" xref="S3.E2.m1.4.4.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E2.m1.4.4.1.1.1.1.2.2.2.2" xref="S3.E2.m1.4.4.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.2.2.2.2.2" xref="S3.E2.m1.4.4.1.1.1.1.2.2.2.2.2.cmml">𝐇</mi><mo id="S3.E2.m1.4.4.1.1.1.1.2.2.2.2.1" xref="S3.E2.m1.4.4.1.1.1.1.2.2.2.2.1.cmml">~</mo></mover><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.4.4.1.1.1.1.2.2.2.1" xref="S3.E2.m1.4.4.1.1.1.1.2.2.2.1.cmml">⊙</mo><mi id="S3.E2.m1.4.4.1.1.1.1.2.2.2.3" xref="S3.E2.m1.4.4.1.1.1.1.2.2.2.3.cmml">𝐄</mi></mrow><mo stretchy="false" id="S3.E2.m1.4.4.1.1.1.1.2.2.8" xref="S3.E2.m1.4.4.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.4.4.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"><eq id="S3.E2.m1.4.4.2.cmml" xref="S3.E2.m1.4.4.2"></eq><ci id="S3.E2.m1.4.4.3.cmml" xref="S3.E2.m1.4.4.3">𝐩</ci><apply id="S3.E2.m1.4.4.1.cmml" xref="S3.E2.m1.4.4.1"><times id="S3.E2.m1.4.4.1.2.cmml" xref="S3.E2.m1.4.4.1.2"></times><ci id="S3.E2.m1.4.4.1.3.cmml" xref="S3.E2.m1.4.4.1.3">𝑠</ci><ci id="S3.E2.m1.4.4.1.4.cmml" xref="S3.E2.m1.4.4.1.4">𝑜</ci><ci id="S3.E2.m1.4.4.1.5.cmml" xref="S3.E2.m1.4.4.1.5">𝑓</ci><ci id="S3.E2.m1.4.4.1.6.cmml" xref="S3.E2.m1.4.4.1.6">𝑡</ci><ci id="S3.E2.m1.4.4.1.7.cmml" xref="S3.E2.m1.4.4.1.7">𝑚</ci><ci id="S3.E2.m1.4.4.1.8.cmml" xref="S3.E2.m1.4.4.1.8">𝑎</ci><ci id="S3.E2.m1.4.4.1.9.cmml" xref="S3.E2.m1.4.4.1.9">𝑥</ci><apply id="S3.E2.m1.4.4.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1"><times id="S3.E2.m1.4.4.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3"></times><apply id="S3.E2.m1.4.4.1.1.1.1.4.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.4.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4">superscript</csymbol><apply id="S3.E2.m1.4.4.1.1.1.1.4.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.4.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.4.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.2.2">𝐰</ci><ci id="S3.E2.m1.4.4.1.1.1.1.4.2.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.2.3">𝐩</ci></apply><ci id="S3.E2.m1.4.4.1.1.1.1.4.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.4.3">𝐓</ci></apply><list id="S3.E2.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2.2"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><ci id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1">~</ci><ci id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">𝐐</ci></apply><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><ci id="S3.E2.m1.2.2.1.cmml" xref="S3.E2.m1.2.2.1">~</ci><ci id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2">𝐇</ci></apply><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝐄</ci><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1">direct-product</csymbol><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2"><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.2">𝐐</ci></apply><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.3">𝐄</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S3.E2.m1.4.4.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2.2.2.1">direct-product</csymbol><apply id="S3.E2.m1.4.4.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2.2.2.2"><ci id="S3.E2.m1.4.4.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2.2.2.2.1">~</ci><ci id="S3.E2.m1.4.4.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2.2.2.2.2">𝐇</ci></apply><ci id="S3.E2.m1.4.4.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2.2.2.3">𝐄</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\mathbf{p}=softmax(\mathbf{w_{p}^{T}}[\mathbf{\tilde{Q}};\mathbf{\tilde{H}};\mathbf{E};\mathbf{\tilde{Q}}\odot\mathbf{E};\mathbf{\tilde{H}}\odot\mathbf{E}])\vspace{1mm}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p6.4" class="ltx_p">where the operator <math id="S3.SS2.p6.1.m1.2" class="ltx_Math" alttext="[\cdot;\cdot]" display="inline"><semantics id="S3.SS2.p6.1.m1.2a"><mrow id="S3.SS2.p6.1.m1.2.3.2" xref="S3.SS2.p6.1.m1.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p6.1.m1.2.3.2.1" xref="S3.SS2.p6.1.m1.2.3.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS2.p6.1.m1.2.3.2.2" xref="S3.SS2.p6.1.m1.2.3.1.cmml">;</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p6.1.m1.2.2" xref="S3.SS2.p6.1.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p6.1.m1.2.3.2.3" xref="S3.SS2.p6.1.m1.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.2b"><list id="S3.SS2.p6.1.m1.2.3.1.cmml" xref="S3.SS2.p6.1.m1.2.3.2"><ci id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">⋅</ci><ci id="S3.SS2.p6.1.m1.2.2.cmml" xref="S3.SS2.p6.1.m1.2.2">⋅</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.2c">[\cdot;\cdot]</annotation></semantics></math> represents the concatenation of two matrices along the last dimension. <math id="S3.SS2.p6.2.m2.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS2.p6.2.m2.1a"><mo id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><csymbol cd="latexml" id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">\odot</annotation></semantics></math> is the element-wise multiplication, <math id="S3.SS2.p6.3.m3.1" class="ltx_Math" alttext="\mathbf{w_{p}}" display="inline"><semantics id="S3.SS2.p6.3.m3.1a"><msub id="S3.SS2.p6.3.m3.1.1" xref="S3.SS2.p6.3.m3.1.1.cmml"><mi id="S3.SS2.p6.3.m3.1.1.2" xref="S3.SS2.p6.3.m3.1.1.2.cmml">𝐰</mi><mi id="S3.SS2.p6.3.m3.1.1.3" xref="S3.SS2.p6.3.m3.1.1.3.cmml">𝐩</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.3.m3.1b"><apply id="S3.SS2.p6.3.m3.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.3.m3.1.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p6.3.m3.1.1.2.cmml" xref="S3.SS2.p6.3.m3.1.1.2">𝐰</ci><ci id="S3.SS2.p6.3.m3.1.1.3.cmml" xref="S3.SS2.p6.3.m3.1.1.3">𝐩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.3.m3.1c">\mathbf{w_{p}}</annotation></semantics></math> is the weight vector to learn and <math id="S3.SS2.p6.4.m4.1" class="ltx_Math" alttext="\mathbf{p}" display="inline"><semantics id="S3.SS2.p6.4.m4.1a"><mi id="S3.SS2.p6.4.m4.1.1" xref="S3.SS2.p6.4.m4.1.1.cmml">𝐩</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.4.m4.1b"><ci id="S3.SS2.p6.4.m4.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1">𝐩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.4.m4.1c">\mathbf{p}</annotation></semantics></math> is a vector of classification probability. After obtaining the answer probability, the model can be trained end-to-end using cross-entropy loss function.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Focal Visual-Text Attention</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">This section discusses the details of FVTA model as the key module in our VQA system. We first introduce similarity metric between visual and text features, then discuss constructing the attention tensor that captures both intra-sequence dependency and inter-sequence interaction.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Similarity between visual and text features</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p">To compute the similarity across different modalities, <em id="S4.SS1.p1.2.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS1.p1.2.2" class="ltx_text"></span> visual and text, we first encode every modality by the LSTM networks with the same size of hidden states. Then we measure the differences between these hidden state variables. Following the study in text sequence matching <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, we aggregate both the cosine similarity and Euclidean distance to compare the features. Moreover, we choose to keep the vector information instead of summing up after the operation. The vector representation can be used as the input of a learning model, whose inner product represents the similarity between these features.
More specifically, we use the following equation to compute the similarity representation between two hidden state vectors <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{v}_{1}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">𝐯</mi><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝐯</ci><cn type="integer" id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\mathbf{v}_{1}</annotation></semantics></math> and <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{v}_{2}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">𝐯</mi><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝐯</ci><cn type="integer" id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mathbf{v}_{2}</annotation></semantics></math>. The result is a vector of twice the hidden size:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.1" class="ltx_Math" alttext="\mathbf{s}(\mathbf{v}_{1},\mathbf{v}_{2})=[(\mathbf{v_{1}}\odot\mathbf{v}_{2});(\mathbf{v}_{1}-\mathbf{v}_{2})\odot(\mathbf{v}_{1}-\mathbf{v}_{2})]." display="block"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.2.cmml"><mi id="S4.E3.m1.1.1.1.1.2.4" xref="S4.E3.m1.1.1.1.1.2.4.cmml">𝐬</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E3.m1.1.1.1.1.2.2.2" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.2.2.2.3" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E3.m1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mn id="S4.E3.m1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.E3.m1.1.1.1.1.2.2.2.4" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E3.m1.1.1.1.1.2.2.2.2" xref="S4.E3.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E3.m1.1.1.1.1.2.2.2.2.2" xref="S4.E3.m1.1.1.1.1.2.2.2.2.2.cmml">𝐯</mi><mn id="S4.E3.m1.1.1.1.1.2.2.2.2.3" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S4.E3.m1.1.1.1.1.2.2.2.5" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.1.1.1.1.5" xref="S4.E3.m1.1.1.1.1.5.cmml">=</mo><mrow id="S4.E3.m1.1.1.1.1.4.2" xref="S4.E3.m1.1.1.1.1.4.3.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.4.2.3" xref="S4.E3.m1.1.1.1.1.4.3.cmml">[</mo><mrow id="S4.E3.m1.1.1.1.1.3.1.1.1" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.3.1.1.1.2" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.3.1.1.1.1" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.cmml"><msub id="S4.E3.m1.1.1.1.1.3.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.cmml"><mi id="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.2" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.2.cmml">𝐯</mi><mn id="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.3.cmml">𝟏</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E3.m1.1.1.1.1.3.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.1.cmml">⊙</mo><msub id="S4.E3.m1.1.1.1.1.3.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.2.cmml">𝐯</mi><mn id="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S4.E3.m1.1.1.1.1.3.1.1.1.3" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E3.m1.1.1.1.1.4.2.4" xref="S4.E3.m1.1.1.1.1.4.3.cmml">;</mo><mrow id="S4.E3.m1.1.1.1.1.4.2.2" xref="S4.E3.m1.1.1.1.1.4.2.2.cmml"><mrow id="S4.E3.m1.1.1.1.1.4.2.2.1.1" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.4.2.2.1.1.2" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.cmml"><msub id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2.cmml"><mi id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2.2" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2.2.cmml">𝐯</mi><mn id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.1" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.1.cmml">−</mo><msub id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3.2" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3.2.cmml">𝐯</mi><mn id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3.3.cmml">2</mn></msub></mrow><mo rspace="0.055em" stretchy="false" id="S4.E3.m1.1.1.1.1.4.2.2.1.1.3" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.E3.m1.1.1.1.1.4.2.2.3" xref="S4.E3.m1.1.1.1.1.4.2.2.3.cmml">⊙</mo><mrow id="S4.E3.m1.1.1.1.1.4.2.2.2.1" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.4.2.2.2.1.2" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.cmml"><msub id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2.cmml"><mi id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2.2" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2.2.cmml">𝐯</mi><mn id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2.3" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2.3.cmml">1</mn></msub><mo id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.1" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.1.cmml">−</mo><msub id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3.2" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3.2.cmml">𝐯</mi><mn id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3.3" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S4.E3.m1.1.1.1.1.4.2.2.2.1.3" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E3.m1.1.1.1.1.4.2.5" xref="S4.E3.m1.1.1.1.1.4.3.cmml">]</mo></mrow></mrow><mo lspace="0em" id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><eq id="S4.E3.m1.1.1.1.1.5.cmml" xref="S4.E3.m1.1.1.1.1.5"></eq><apply id="S4.E3.m1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.2"><times id="S4.E3.m1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.3"></times><ci id="S4.E3.m1.1.1.1.1.2.4.cmml" xref="S4.E3.m1.1.1.1.1.2.4">𝐬</ci><interval closure="open" id="S4.E3.m1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2"><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2">𝐯</ci><cn type="integer" id="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E3.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2.2">𝐯</ci><cn type="integer" id="S4.E3.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3">2</cn></apply></interval></apply><list id="S4.E3.m1.1.1.1.1.4.3.cmml" xref="S4.E3.m1.1.1.1.1.4.2"><apply id="S4.E3.m1.1.1.1.1.3.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.1.1.1.1.3.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.1">direct-product</csymbol><apply id="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.2">𝐯</ci><cn type="integer" id="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.3">1</cn></apply><apply id="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.2">𝐯</ci><cn type="integer" id="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.3">2</cn></apply></apply><apply id="S4.E3.m1.1.1.1.1.4.2.2.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2"><csymbol cd="latexml" id="S4.E3.m1.1.1.1.1.4.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.3">direct-product</csymbol><apply id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1"><minus id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.1"></minus><apply id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2.2">𝐯</ci><cn type="integer" id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.2.3">1</cn></apply><apply id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3.2">𝐯</ci><cn type="integer" id="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.1.1.1.3.3">2</cn></apply></apply><apply id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1"><minus id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.1"></minus><apply id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2.2">𝐯</ci><cn type="integer" id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.2.3">1</cn></apply><apply id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3.2">𝐯</ci><cn type="integer" id="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.4.2.2.2.1.1.3.3">2</cn></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\mathbf{s}(\mathbf{v}_{1},\mathbf{v}_{2})=[(\mathbf{v_{1}}\odot\mathbf{v}_{2});(\mathbf{v}_{1}-\mathbf{v}_{2})\odot(\mathbf{v}_{1}-\mathbf{v}_{2})].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Intra-sequence temporal dependency</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Our visual-text attention layer is designed to let the model select related visual-text region or timestep based on each word of the question. Such fine-grained attention is in general nontrivial to learn. Meanwhile, most answers for visual-text sequence inputs may be constrained and restricted in a short temporal period.
We learn such localized representation, called focal context representation, to emphasize relevant context states based on the question.
</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.14" class="ltx_p">First, we introduce a temporal <span id="S4.SS2.p2.14.1" class="ltx_text ltx_font_italic">correlation matrix</span>, <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{C}\in\mathbb{R}^{T\times T}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">𝐂</mi><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p2.1.m1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.3.2" xref="S4.SS2.p2.1.m1.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.1.m1.1.1.3.3.1" xref="S4.SS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p2.1.m1.1.1.3.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.3.cmml">T</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><in id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></in><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝐂</ci><apply id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3"><times id="S4.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.1"></times><ci id="S4.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.2">𝑇</ci><ci id="S4.SS2.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\mathbf{C}\in\mathbb{R}^{T\times T}</annotation></semantics></math>, a symmetric matrix where each entry <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="c_{ij}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><msub id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">c</mi><mrow id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.3.1" xref="S4.SS2.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝑐</ci><apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><times id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.1"></times><ci id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">𝑖</ci><ci id="S4.SS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">c_{ij}</annotation></semantics></math> measures the correlation between context’s the <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">i</annotation></semantics></math>-th step and the <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">j</annotation></semantics></math>-th step for a question. Let <math id="S4.SS2.p2.5.m5.2" class="ltx_Math" alttext="\mathbf{h}_{i}=\mathbf{H}_{:i:}\in\mathbb{R}^{2d\times 2}" display="inline"><semantics id="S4.SS2.p2.5.m5.2a"><mrow id="S4.SS2.p2.5.m5.2.3" xref="S4.SS2.p2.5.m5.2.3.cmml"><msub id="S4.SS2.p2.5.m5.2.3.2" xref="S4.SS2.p2.5.m5.2.3.2.cmml"><mi id="S4.SS2.p2.5.m5.2.3.2.2" xref="S4.SS2.p2.5.m5.2.3.2.2.cmml">𝐡</mi><mi id="S4.SS2.p2.5.m5.2.3.2.3" xref="S4.SS2.p2.5.m5.2.3.2.3.cmml">i</mi></msub><mo id="S4.SS2.p2.5.m5.2.3.3" xref="S4.SS2.p2.5.m5.2.3.3.cmml">=</mo><msub id="S4.SS2.p2.5.m5.2.3.4" xref="S4.SS2.p2.5.m5.2.3.4.cmml"><mi id="S4.SS2.p2.5.m5.2.3.4.2" xref="S4.SS2.p2.5.m5.2.3.4.2.cmml">𝐇</mi><mrow id="S4.SS2.p2.5.m5.2.2.2.2" xref="S4.SS2.p2.5.m5.2.2.2.3.cmml"><mrow id="S4.SS2.p2.5.m5.2.2.2.2.1" xref="S4.SS2.p2.5.m5.2.2.2.2.1.cmml"><mi id="S4.SS2.p2.5.m5.2.2.2.2.1.2" xref="S4.SS2.p2.5.m5.2.2.2.2.1.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p2.5.m5.2.2.2.2.1.1" xref="S4.SS2.p2.5.m5.2.2.2.2.1.1.cmml">:</mo><mi id="S4.SS2.p2.5.m5.2.2.2.2.1.3" xref="S4.SS2.p2.5.m5.2.2.2.2.1.3.cmml">i</mi></mrow><mo lspace="0.278em" id="S4.SS2.p2.5.m5.2.2.2.2.2" xref="S4.SS2.p2.5.m5.2.2.2.3.cmml">⁣</mo><mo id="S4.SS2.p2.5.m5.1.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.1.cmml">:</mo></mrow></msub><mo id="S4.SS2.p2.5.m5.2.3.5" xref="S4.SS2.p2.5.m5.2.3.5.cmml">∈</mo><msup id="S4.SS2.p2.5.m5.2.3.6" xref="S4.SS2.p2.5.m5.2.3.6.cmml"><mi id="S4.SS2.p2.5.m5.2.3.6.2" xref="S4.SS2.p2.5.m5.2.3.6.2.cmml">ℝ</mi><mrow id="S4.SS2.p2.5.m5.2.3.6.3" xref="S4.SS2.p2.5.m5.2.3.6.3.cmml"><mrow id="S4.SS2.p2.5.m5.2.3.6.3.2" xref="S4.SS2.p2.5.m5.2.3.6.3.2.cmml"><mn id="S4.SS2.p2.5.m5.2.3.6.3.2.2" xref="S4.SS2.p2.5.m5.2.3.6.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.2.3.6.3.2.1" xref="S4.SS2.p2.5.m5.2.3.6.3.2.1.cmml">​</mo><mi id="S4.SS2.p2.5.m5.2.3.6.3.2.3" xref="S4.SS2.p2.5.m5.2.3.6.3.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.5.m5.2.3.6.3.1" xref="S4.SS2.p2.5.m5.2.3.6.3.1.cmml">×</mo><mn id="S4.SS2.p2.5.m5.2.3.6.3.3" xref="S4.SS2.p2.5.m5.2.3.6.3.3.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.2b"><apply id="S4.SS2.p2.5.m5.2.3.cmml" xref="S4.SS2.p2.5.m5.2.3"><and id="S4.SS2.p2.5.m5.2.3a.cmml" xref="S4.SS2.p2.5.m5.2.3"></and><apply id="S4.SS2.p2.5.m5.2.3b.cmml" xref="S4.SS2.p2.5.m5.2.3"><eq id="S4.SS2.p2.5.m5.2.3.3.cmml" xref="S4.SS2.p2.5.m5.2.3.3"></eq><apply id="S4.SS2.p2.5.m5.2.3.2.cmml" xref="S4.SS2.p2.5.m5.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.3.2.1.cmml" xref="S4.SS2.p2.5.m5.2.3.2">subscript</csymbol><ci id="S4.SS2.p2.5.m5.2.3.2.2.cmml" xref="S4.SS2.p2.5.m5.2.3.2.2">𝐡</ci><ci id="S4.SS2.p2.5.m5.2.3.2.3.cmml" xref="S4.SS2.p2.5.m5.2.3.2.3">𝑖</ci></apply><apply id="S4.SS2.p2.5.m5.2.3.4.cmml" xref="S4.SS2.p2.5.m5.2.3.4"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.3.4.1.cmml" xref="S4.SS2.p2.5.m5.2.3.4">subscript</csymbol><ci id="S4.SS2.p2.5.m5.2.3.4.2.cmml" xref="S4.SS2.p2.5.m5.2.3.4.2">𝐇</ci><list id="S4.SS2.p2.5.m5.2.2.2.3.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2"><apply id="S4.SS2.p2.5.m5.2.2.2.2.1.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.1"><ci id="S4.SS2.p2.5.m5.2.2.2.2.1.1.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.1.1">:</ci><csymbol cd="latexml" id="S4.SS2.p2.5.m5.2.2.2.2.1.2.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.1.2">absent</csymbol><ci id="S4.SS2.p2.5.m5.2.2.2.2.1.3.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.1.3">𝑖</ci></apply><ci id="S4.SS2.p2.5.m5.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1">:</ci></list></apply></apply><apply id="S4.SS2.p2.5.m5.2.3c.cmml" xref="S4.SS2.p2.5.m5.2.3"><in id="S4.SS2.p2.5.m5.2.3.5.cmml" xref="S4.SS2.p2.5.m5.2.3.5"></in><share href="#S4.SS2.p2.5.m5.2.3.4.cmml" id="S4.SS2.p2.5.m5.2.3d.cmml" xref="S4.SS2.p2.5.m5.2.3"></share><apply id="S4.SS2.p2.5.m5.2.3.6.cmml" xref="S4.SS2.p2.5.m5.2.3.6"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.3.6.1.cmml" xref="S4.SS2.p2.5.m5.2.3.6">superscript</csymbol><ci id="S4.SS2.p2.5.m5.2.3.6.2.cmml" xref="S4.SS2.p2.5.m5.2.3.6.2">ℝ</ci><apply id="S4.SS2.p2.5.m5.2.3.6.3.cmml" xref="S4.SS2.p2.5.m5.2.3.6.3"><times id="S4.SS2.p2.5.m5.2.3.6.3.1.cmml" xref="S4.SS2.p2.5.m5.2.3.6.3.1"></times><apply id="S4.SS2.p2.5.m5.2.3.6.3.2.cmml" xref="S4.SS2.p2.5.m5.2.3.6.3.2"><times id="S4.SS2.p2.5.m5.2.3.6.3.2.1.cmml" xref="S4.SS2.p2.5.m5.2.3.6.3.2.1"></times><cn type="integer" id="S4.SS2.p2.5.m5.2.3.6.3.2.2.cmml" xref="S4.SS2.p2.5.m5.2.3.6.3.2.2">2</cn><ci id="S4.SS2.p2.5.m5.2.3.6.3.2.3.cmml" xref="S4.SS2.p2.5.m5.2.3.6.3.2.3">𝑑</ci></apply><cn type="integer" id="S4.SS2.p2.5.m5.2.3.6.3.3.cmml" xref="S4.SS2.p2.5.m5.2.3.6.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.2c">\mathbf{h}_{i}=\mathbf{H}_{:i:}\in\mathbb{R}^{2d\times 2}</annotation></semantics></math> denote the visual/text representation for the <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mi id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><ci id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">i</annotation></semantics></math>-th timestep in <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="\mathbf{H}" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><mi id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><ci id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">\mathbf{H}</annotation></semantics></math>. For notation convenience, <math id="S4.SS2.p2.8.m8.1" class="ltx_Math" alttext=":" display="inline"><semantics id="S4.SS2.p2.8.m8.1a"><mo id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml">:</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><ci id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1">:</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">:</annotation></semantics></math> is a slicing operator to extracts all elements from a dimension.
For example, <math id="S4.SS2.p2.9.m9.1" class="ltx_Math" alttext="\mathbf{h}_{i1}=\mathbf{H}_{:i1}" display="inline"><semantics id="S4.SS2.p2.9.m9.1a"><mrow id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml"><msub id="S4.SS2.p2.9.m9.1.1.2" xref="S4.SS2.p2.9.m9.1.1.2.cmml"><mi id="S4.SS2.p2.9.m9.1.1.2.2" xref="S4.SS2.p2.9.m9.1.1.2.2.cmml">𝐡</mi><mrow id="S4.SS2.p2.9.m9.1.1.2.3" xref="S4.SS2.p2.9.m9.1.1.2.3.cmml"><mi id="S4.SS2.p2.9.m9.1.1.2.3.2" xref="S4.SS2.p2.9.m9.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.9.m9.1.1.2.3.1" xref="S4.SS2.p2.9.m9.1.1.2.3.1.cmml">​</mo><mn id="S4.SS2.p2.9.m9.1.1.2.3.3" xref="S4.SS2.p2.9.m9.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS2.p2.9.m9.1.1.1" xref="S4.SS2.p2.9.m9.1.1.1.cmml">=</mo><msub id="S4.SS2.p2.9.m9.1.1.3" xref="S4.SS2.p2.9.m9.1.1.3.cmml"><mi id="S4.SS2.p2.9.m9.1.1.3.2" xref="S4.SS2.p2.9.m9.1.1.3.2.cmml">𝐇</mi><mrow id="S4.SS2.p2.9.m9.1.1.3.3" xref="S4.SS2.p2.9.m9.1.1.3.3.cmml"><mi id="S4.SS2.p2.9.m9.1.1.3.3.2" xref="S4.SS2.p2.9.m9.1.1.3.3.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p2.9.m9.1.1.3.3.1" xref="S4.SS2.p2.9.m9.1.1.3.3.1.cmml">:</mo><mrow id="S4.SS2.p2.9.m9.1.1.3.3.3" xref="S4.SS2.p2.9.m9.1.1.3.3.3.cmml"><mi id="S4.SS2.p2.9.m9.1.1.3.3.3.2" xref="S4.SS2.p2.9.m9.1.1.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.9.m9.1.1.3.3.3.1" xref="S4.SS2.p2.9.m9.1.1.3.3.3.1.cmml">​</mo><mn id="S4.SS2.p2.9.m9.1.1.3.3.3.3" xref="S4.SS2.p2.9.m9.1.1.3.3.3.3.cmml">1</mn></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><apply id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1"><eq id="S4.SS2.p2.9.m9.1.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1.1"></eq><apply id="S4.SS2.p2.9.m9.1.1.2.cmml" xref="S4.SS2.p2.9.m9.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m9.1.1.2.1.cmml" xref="S4.SS2.p2.9.m9.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.9.m9.1.1.2.2.cmml" xref="S4.SS2.p2.9.m9.1.1.2.2">𝐡</ci><apply id="S4.SS2.p2.9.m9.1.1.2.3.cmml" xref="S4.SS2.p2.9.m9.1.1.2.3"><times id="S4.SS2.p2.9.m9.1.1.2.3.1.cmml" xref="S4.SS2.p2.9.m9.1.1.2.3.1"></times><ci id="S4.SS2.p2.9.m9.1.1.2.3.2.cmml" xref="S4.SS2.p2.9.m9.1.1.2.3.2">𝑖</ci><cn type="integer" id="S4.SS2.p2.9.m9.1.1.2.3.3.cmml" xref="S4.SS2.p2.9.m9.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p2.9.m9.1.1.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m9.1.1.3.1.cmml" xref="S4.SS2.p2.9.m9.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.9.m9.1.1.3.2.cmml" xref="S4.SS2.p2.9.m9.1.1.3.2">𝐇</ci><apply id="S4.SS2.p2.9.m9.1.1.3.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3"><ci id="S4.SS2.p2.9.m9.1.1.3.3.1.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.1">:</ci><csymbol cd="latexml" id="S4.SS2.p2.9.m9.1.1.3.3.2.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.2">absent</csymbol><apply id="S4.SS2.p2.9.m9.1.1.3.3.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.3"><times id="S4.SS2.p2.9.m9.1.1.3.3.3.1.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.3.1"></times><ci id="S4.SS2.p2.9.m9.1.1.3.3.3.2.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.3.2">𝑖</ci><cn type="integer" id="S4.SS2.p2.9.m9.1.1.3.3.3.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">\mathbf{h}_{i1}=\mathbf{H}_{:i1}</annotation></semantics></math> represents the vector representation of the <math id="S4.SS2.p2.10.m10.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p2.10.m10.1a"><mi id="S4.SS2.p2.10.m10.1.1" xref="S4.SS2.p2.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m10.1b"><ci id="S4.SS2.p2.10.m10.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m10.1c">i</annotation></semantics></math>-th timestep of the visual sequence.
Here we denote the last index <math id="S4.SS2.p2.11.m11.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS2.p2.11.m11.1a"><mn id="S4.SS2.p2.11.m11.1.1" xref="S4.SS2.p2.11.m11.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m11.1b"><cn type="integer" id="S4.SS2.p2.11.m11.1.1.cmml" xref="S4.SS2.p2.11.m11.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m11.1c">1</annotation></semantics></math> for visual and <math id="S4.SS2.p2.12.m12.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S4.SS2.p2.12.m12.1a"><mn id="S4.SS2.p2.12.m12.1.1" xref="S4.SS2.p2.12.m12.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.12.m12.1b"><cn type="integer" id="S4.SS2.p2.12.m12.1.1.cmml" xref="S4.SS2.p2.12.m12.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.12.m12.1c">2</annotation></semantics></math> for textual modality.
Each entry <math id="S4.SS2.p2.13.m13.1" class="ltx_Math" alttext="\mathbf{C}_{ij}" display="inline"><semantics id="S4.SS2.p2.13.m13.1a"><msub id="S4.SS2.p2.13.m13.1.1" xref="S4.SS2.p2.13.m13.1.1.cmml"><mi id="S4.SS2.p2.13.m13.1.1.2" xref="S4.SS2.p2.13.m13.1.1.2.cmml">𝐂</mi><mrow id="S4.SS2.p2.13.m13.1.1.3" xref="S4.SS2.p2.13.m13.1.1.3.cmml"><mi id="S4.SS2.p2.13.m13.1.1.3.2" xref="S4.SS2.p2.13.m13.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.13.m13.1.1.3.1" xref="S4.SS2.p2.13.m13.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.13.m13.1.1.3.3" xref="S4.SS2.p2.13.m13.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.13.m13.1b"><apply id="S4.SS2.p2.13.m13.1.1.cmml" xref="S4.SS2.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.13.m13.1.1.1.cmml" xref="S4.SS2.p2.13.m13.1.1">subscript</csymbol><ci id="S4.SS2.p2.13.m13.1.1.2.cmml" xref="S4.SS2.p2.13.m13.1.1.2">𝐂</ci><apply id="S4.SS2.p2.13.m13.1.1.3.cmml" xref="S4.SS2.p2.13.m13.1.1.3"><times id="S4.SS2.p2.13.m13.1.1.3.1.cmml" xref="S4.SS2.p2.13.m13.1.1.3.1"></times><ci id="S4.SS2.p2.13.m13.1.1.3.2.cmml" xref="S4.SS2.p2.13.m13.1.1.3.2">𝑖</ci><ci id="S4.SS2.p2.13.m13.1.1.3.3.cmml" xref="S4.SS2.p2.13.m13.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.13.m13.1c">\mathbf{C}_{ij}</annotation></semantics></math> (<math id="S4.SS2.p2.14.m14.4" class="ltx_Math" alttext="\forall i,j\in[1,T]" display="inline"><semantics id="S4.SS2.p2.14.m14.4a"><mrow id="S4.SS2.p2.14.m14.4.4" xref="S4.SS2.p2.14.m14.4.4.cmml"><mrow id="S4.SS2.p2.14.m14.4.4.1.1" xref="S4.SS2.p2.14.m14.4.4.1.2.cmml"><mrow id="S4.SS2.p2.14.m14.4.4.1.1.1" xref="S4.SS2.p2.14.m14.4.4.1.1.1.cmml"><mo rspace="0.167em" id="S4.SS2.p2.14.m14.4.4.1.1.1.1" xref="S4.SS2.p2.14.m14.4.4.1.1.1.1.cmml">∀</mo><mi id="S4.SS2.p2.14.m14.4.4.1.1.1.2" xref="S4.SS2.p2.14.m14.4.4.1.1.1.2.cmml">i</mi></mrow><mo id="S4.SS2.p2.14.m14.4.4.1.1.2" xref="S4.SS2.p2.14.m14.4.4.1.2.cmml">,</mo><mi id="S4.SS2.p2.14.m14.3.3" xref="S4.SS2.p2.14.m14.3.3.cmml">j</mi></mrow><mo id="S4.SS2.p2.14.m14.4.4.2" xref="S4.SS2.p2.14.m14.4.4.2.cmml">∈</mo><mrow id="S4.SS2.p2.14.m14.4.4.3.2" xref="S4.SS2.p2.14.m14.4.4.3.1.cmml"><mo stretchy="false" id="S4.SS2.p2.14.m14.4.4.3.2.1" xref="S4.SS2.p2.14.m14.4.4.3.1.cmml">[</mo><mn id="S4.SS2.p2.14.m14.1.1" xref="S4.SS2.p2.14.m14.1.1.cmml">1</mn><mo id="S4.SS2.p2.14.m14.4.4.3.2.2" xref="S4.SS2.p2.14.m14.4.4.3.1.cmml">,</mo><mi id="S4.SS2.p2.14.m14.2.2" xref="S4.SS2.p2.14.m14.2.2.cmml">T</mi><mo stretchy="false" id="S4.SS2.p2.14.m14.4.4.3.2.3" xref="S4.SS2.p2.14.m14.4.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.14.m14.4b"><apply id="S4.SS2.p2.14.m14.4.4.cmml" xref="S4.SS2.p2.14.m14.4.4"><in id="S4.SS2.p2.14.m14.4.4.2.cmml" xref="S4.SS2.p2.14.m14.4.4.2"></in><list id="S4.SS2.p2.14.m14.4.4.1.2.cmml" xref="S4.SS2.p2.14.m14.4.4.1.1"><apply id="S4.SS2.p2.14.m14.4.4.1.1.1.cmml" xref="S4.SS2.p2.14.m14.4.4.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.14.m14.4.4.1.1.1.1.cmml" xref="S4.SS2.p2.14.m14.4.4.1.1.1.1">for-all</csymbol><ci id="S4.SS2.p2.14.m14.4.4.1.1.1.2.cmml" xref="S4.SS2.p2.14.m14.4.4.1.1.1.2">𝑖</ci></apply><ci id="S4.SS2.p2.14.m14.3.3.cmml" xref="S4.SS2.p2.14.m14.3.3">𝑗</ci></list><interval closure="closed" id="S4.SS2.p2.14.m14.4.4.3.1.cmml" xref="S4.SS2.p2.14.m14.4.4.3.2"><cn type="integer" id="S4.SS2.p2.14.m14.1.1.cmml" xref="S4.SS2.p2.14.m14.1.1">1</cn><ci id="S4.SS2.p2.14.m14.2.2.cmml" xref="S4.SS2.p2.14.m14.2.2">𝑇</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.14.m14.4c">\forall i,j\in[1,T]</annotation></semantics></math>) is then calculated by:</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.28" class="ltx_Math" alttext="\begin{split}\mathbf{C}_{ij}=\tanh\sum_{k=1}^{2}\mathbf{w}_{c}^{\top}(\mathbf{w}^{\top}_{h}\mathbf{s}(\mathbf{h}_{ik},\mathbf{h}_{jk})+\mathbf{Q}_{:M})\end{split}" display="block"><semantics id="S4.E4.m1.28a"><mtable displaystyle="true" id="S4.E4.m1.28.28.2" xref="S4.E4.m1.27.27.1.cmml"><mtr id="S4.E4.m1.28.28.2a" xref="S4.E4.m1.27.27.1.cmml"><mtd class="ltx_align_right" columnalign="right" id="S4.E4.m1.28.28.2b" xref="S4.E4.m1.27.27.1.cmml"><mrow id="S4.E4.m1.28.28.2.27.27.27" xref="S4.E4.m1.27.27.1.cmml"><msub id="S4.E4.m1.28.28.2.27.27.27.28" xref="S4.E4.m1.27.27.1.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml">𝐂</mi><mrow id="S4.E4.m1.2.2.2.2.2.2.1" xref="S4.E4.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.E4.m1.2.2.2.2.2.2.1.2" xref="S4.E4.m1.2.2.2.2.2.2.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.2.2.2.1.1" xref="S4.E4.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E4.m1.2.2.2.2.2.2.1.3" xref="S4.E4.m1.2.2.2.2.2.2.1.3.cmml">j</mi></mrow></msub><mo id="S4.E4.m1.3.3.3.3.3.3" xref="S4.E4.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S4.E4.m1.28.28.2.27.27.27.27" xref="S4.E4.m1.27.27.1.cmml"><mi id="S4.E4.m1.4.4.4.4.4.4" xref="S4.E4.m1.4.4.4.4.4.4.cmml">tanh</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.28.28.2.27.27.27.27.2" xref="S4.E4.m1.27.27.1.cmml">​</mo><mrow id="S4.E4.m1.28.28.2.27.27.27.27.1" xref="S4.E4.m1.27.27.1.cmml"><munderover id="S4.E4.m1.28.28.2.27.27.27.27.1.2" xref="S4.E4.m1.27.27.1.cmml"><mo movablelimits="false" id="S4.E4.m1.5.5.5.5.5.5" xref="S4.E4.m1.5.5.5.5.5.5.cmml">∑</mo><mrow id="S4.E4.m1.6.6.6.6.6.6.1" xref="S4.E4.m1.6.6.6.6.6.6.1.cmml"><mi id="S4.E4.m1.6.6.6.6.6.6.1.2" xref="S4.E4.m1.6.6.6.6.6.6.1.2.cmml">k</mi><mo id="S4.E4.m1.6.6.6.6.6.6.1.1" xref="S4.E4.m1.6.6.6.6.6.6.1.1.cmml">=</mo><mn id="S4.E4.m1.6.6.6.6.6.6.1.3" xref="S4.E4.m1.6.6.6.6.6.6.1.3.cmml">1</mn></mrow><mn id="S4.E4.m1.7.7.7.7.7.7.1" xref="S4.E4.m1.7.7.7.7.7.7.1.cmml">2</mn></munderover><mrow id="S4.E4.m1.28.28.2.27.27.27.27.1.1" xref="S4.E4.m1.27.27.1.cmml"><msubsup id="S4.E4.m1.28.28.2.27.27.27.27.1.1.3" xref="S4.E4.m1.27.27.1.cmml"><mi id="S4.E4.m1.8.8.8.8.8.8" xref="S4.E4.m1.8.8.8.8.8.8.cmml">𝐰</mi><mi id="S4.E4.m1.9.9.9.9.9.9.1" xref="S4.E4.m1.9.9.9.9.9.9.1.cmml">c</mi><mo id="S4.E4.m1.10.10.10.10.10.10.1" xref="S4.E4.m1.10.10.10.10.10.10.1.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S4.E4.m1.28.28.2.27.27.27.27.1.1.2" xref="S4.E4.m1.27.27.1.cmml">​</mo><mrow id="S4.E4.m1.28.28.2.27.27.27.27.1.1.1.1" xref="S4.E4.m1.27.27.1.cmml"><mo stretchy="false" id="S4.E4.m1.11.11.11.11.11.11" xref="S4.E4.m1.27.27.1.cmml">(</mo><mrow id="S4.E4.m1.28.28.2.27.27.27.27.1.1.1.1.1" xref="S4.E4.m1.27.27.1.cmml"><mrow id="S4.E4.m1.28.28.2.27.27.27.27.1.1.1.1.1.2" xref="S4.E4.m1.27.27.1.cmml"><msubsup id="S4.E4.m1.28.28.2.27.27.27.27.1.1.1.1.1.2.4" xref="S4.E4.m1.27.27.1.cmml"><mi id="S4.E4.m1.12.12.12.12.12.12" xref="S4.E4.m1.12.12.12.12.12.12.cmml">𝐰</mi><mi id="S4.E4.m1.14.14.14.14.14.14.1" xref="S4.E4.m1.14.14.14.14.14.14.1.cmml">h</mi><mo id="S4.E4.m1.13.13.13.13.13.13.1" xref="S4.E4.m1.13.13.13.13.13.13.1.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S4.E4.m1.28.28.2.27.27.27.27.1.1.1.1.1.2.3" xref="S4.E4.m1.27.27.1.cmml">​</mo><mi id="S4.E4.m1.15.15.15.15.15.15" xref="S4.E4.m1.15.15.15.15.15.15.cmml">𝐬</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.28.28.2.27.27.27.27.1.1.1.1.1.2.3a" xref="S4.E4.m1.27.27.1.cmml">​</mo><mrow id="S4.E4.m1.28.28.2.27.27.27.27.1.1.1.1.1.2.2.2" xref="S4.E4.m1.27.27.1.cmml"><mo stretchy="false" id="S4.E4.m1.16.16.16.16.16.16" xref="S4.E4.m1.27.27.1.cmml">(</mo><msub id="S4.E4.m1.28.28.2.27.27.27.27.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.27.27.1.cmml"><mi id="S4.E4.m1.17.17.17.17.17.17" xref="S4.E4.m1.17.17.17.17.17.17.cmml">𝐡</mi><mrow id="S4.E4.m1.18.18.18.18.18.18.1" xref="S4.E4.m1.18.18.18.18.18.18.1.cmml"><mi id="S4.E4.m1.18.18.18.18.18.18.1.2" xref="S4.E4.m1.18.18.18.18.18.18.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.18.18.18.18.18.18.1.1" xref="S4.E4.m1.18.18.18.18.18.18.1.1.cmml">​</mo><mi id="S4.E4.m1.18.18.18.18.18.18.1.3" xref="S4.E4.m1.18.18.18.18.18.18.1.3.cmml">k</mi></mrow></msub><mo id="S4.E4.m1.19.19.19.19.19.19" xref="S4.E4.m1.27.27.1.cmml">,</mo><msub id="S4.E4.m1.28.28.2.27.27.27.27.1.1.1.1.1.2.2.2.2" xref="S4.E4.m1.27.27.1.cmml"><mi id="S4.E4.m1.20.20.20.20.20.20" xref="S4.E4.m1.20.20.20.20.20.20.cmml">𝐡</mi><mrow id="S4.E4.m1.21.21.21.21.21.21.1" xref="S4.E4.m1.21.21.21.21.21.21.1.cmml"><mi id="S4.E4.m1.21.21.21.21.21.21.1.2" xref="S4.E4.m1.21.21.21.21.21.21.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.21.21.21.21.21.21.1.1" xref="S4.E4.m1.21.21.21.21.21.21.1.1.cmml">​</mo><mi id="S4.E4.m1.21.21.21.21.21.21.1.3" xref="S4.E4.m1.21.21.21.21.21.21.1.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="S4.E4.m1.22.22.22.22.22.22" xref="S4.E4.m1.27.27.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.23.23.23.23.23.23" xref="S4.E4.m1.23.23.23.23.23.23.cmml">+</mo><msub id="S4.E4.m1.28.28.2.27.27.27.27.1.1.1.1.1.3" xref="S4.E4.m1.27.27.1.cmml"><mi id="S4.E4.m1.24.24.24.24.24.24" xref="S4.E4.m1.24.24.24.24.24.24.cmml">𝐐</mi><mrow id="S4.E4.m1.25.25.25.25.25.25.1" xref="S4.E4.m1.25.25.25.25.25.25.1.cmml"><mi id="S4.E4.m1.25.25.25.25.25.25.1.2" xref="S4.E4.m1.25.25.25.25.25.25.1.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S4.E4.m1.25.25.25.25.25.25.1.1" xref="S4.E4.m1.25.25.25.25.25.25.1.1.cmml">:</mo><mi id="S4.E4.m1.25.25.25.25.25.25.1.3" xref="S4.E4.m1.25.25.25.25.25.25.1.3.cmml">M</mi></mrow></msub></mrow><mo stretchy="false" id="S4.E4.m1.26.26.26.26.26.26" xref="S4.E4.m1.27.27.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E4.m1.28b"><apply id="S4.E4.m1.27.27.1.cmml" xref="S4.E4.m1.28.28.2"><eq id="S4.E4.m1.3.3.3.3.3.3.cmml" xref="S4.E4.m1.3.3.3.3.3.3"></eq><apply id="S4.E4.m1.27.27.1.3.cmml" xref="S4.E4.m1.28.28.2"><csymbol cd="ambiguous" id="S4.E4.m1.27.27.1.3.1.cmml" xref="S4.E4.m1.28.28.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1">𝐂</ci><apply id="S4.E4.m1.2.2.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1"><times id="S4.E4.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.1"></times><ci id="S4.E4.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.2">𝑖</ci><ci id="S4.E4.m1.2.2.2.2.2.2.1.3.cmml" xref="S4.E4.m1.2.2.2.2.2.2.1.3">𝑗</ci></apply></apply><apply id="S4.E4.m1.27.27.1.1.cmml" xref="S4.E4.m1.28.28.2"><times id="S4.E4.m1.27.27.1.1.2.cmml" xref="S4.E4.m1.28.28.2"></times><tanh id="S4.E4.m1.4.4.4.4.4.4.cmml" xref="S4.E4.m1.4.4.4.4.4.4"></tanh><apply id="S4.E4.m1.27.27.1.1.1.cmml" xref="S4.E4.m1.28.28.2"><apply id="S4.E4.m1.27.27.1.1.1.2.cmml" xref="S4.E4.m1.28.28.2"><csymbol cd="ambiguous" id="S4.E4.m1.27.27.1.1.1.2.1.cmml" xref="S4.E4.m1.28.28.2">superscript</csymbol><apply id="S4.E4.m1.27.27.1.1.1.2.2.cmml" xref="S4.E4.m1.28.28.2"><csymbol cd="ambiguous" id="S4.E4.m1.27.27.1.1.1.2.2.1.cmml" xref="S4.E4.m1.28.28.2">subscript</csymbol><sum id="S4.E4.m1.5.5.5.5.5.5.cmml" xref="S4.E4.m1.5.5.5.5.5.5"></sum><apply id="S4.E4.m1.6.6.6.6.6.6.1.cmml" xref="S4.E4.m1.6.6.6.6.6.6.1"><eq id="S4.E4.m1.6.6.6.6.6.6.1.1.cmml" xref="S4.E4.m1.6.6.6.6.6.6.1.1"></eq><ci id="S4.E4.m1.6.6.6.6.6.6.1.2.cmml" xref="S4.E4.m1.6.6.6.6.6.6.1.2">𝑘</ci><cn type="integer" id="S4.E4.m1.6.6.6.6.6.6.1.3.cmml" xref="S4.E4.m1.6.6.6.6.6.6.1.3">1</cn></apply></apply><cn type="integer" id="S4.E4.m1.7.7.7.7.7.7.1.cmml" xref="S4.E4.m1.7.7.7.7.7.7.1">2</cn></apply><apply id="S4.E4.m1.27.27.1.1.1.1.cmml" xref="S4.E4.m1.28.28.2"><times id="S4.E4.m1.27.27.1.1.1.1.2.cmml" xref="S4.E4.m1.28.28.2"></times><apply id="S4.E4.m1.27.27.1.1.1.1.3.cmml" xref="S4.E4.m1.28.28.2"><csymbol cd="ambiguous" id="S4.E4.m1.27.27.1.1.1.1.3.1.cmml" xref="S4.E4.m1.28.28.2">superscript</csymbol><apply id="S4.E4.m1.27.27.1.1.1.1.3.2.cmml" xref="S4.E4.m1.28.28.2"><csymbol cd="ambiguous" id="S4.E4.m1.27.27.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.28.28.2">subscript</csymbol><ci id="S4.E4.m1.8.8.8.8.8.8.cmml" xref="S4.E4.m1.8.8.8.8.8.8">𝐰</ci><ci id="S4.E4.m1.9.9.9.9.9.9.1.cmml" xref="S4.E4.m1.9.9.9.9.9.9.1">𝑐</ci></apply><csymbol cd="latexml" id="S4.E4.m1.10.10.10.10.10.10.1.cmml" xref="S4.E4.m1.10.10.10.10.10.10.1">top</csymbol></apply><apply id="S4.E4.m1.27.27.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.28.28.2"><plus id="S4.E4.m1.23.23.23.23.23.23.cmml" xref="S4.E4.m1.23.23.23.23.23.23"></plus><apply id="S4.E4.m1.27.27.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.28.28.2"><times id="S4.E4.m1.27.27.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.28.28.2"></times><apply id="S4.E4.m1.27.27.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E4.m1.28.28.2"><csymbol cd="ambiguous" id="S4.E4.m1.27.27.1.1.1.1.1.1.1.2.4.1.cmml" xref="S4.E4.m1.28.28.2">subscript</csymbol><apply id="S4.E4.m1.27.27.1.1.1.1.1.1.1.2.4.2.cmml" xref="S4.E4.m1.28.28.2"><csymbol cd="ambiguous" id="S4.E4.m1.27.27.1.1.1.1.1.1.1.2.4.2.1.cmml" xref="S4.E4.m1.28.28.2">superscript</csymbol><ci id="S4.E4.m1.12.12.12.12.12.12.cmml" xref="S4.E4.m1.12.12.12.12.12.12">𝐰</ci><csymbol cd="latexml" id="S4.E4.m1.13.13.13.13.13.13.1.cmml" xref="S4.E4.m1.13.13.13.13.13.13.1">top</csymbol></apply><ci id="S4.E4.m1.14.14.14.14.14.14.1.cmml" xref="S4.E4.m1.14.14.14.14.14.14.1">ℎ</ci></apply><ci id="S4.E4.m1.15.15.15.15.15.15.cmml" xref="S4.E4.m1.15.15.15.15.15.15">𝐬</ci><interval closure="open" id="S4.E4.m1.27.27.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.28.28.2"><apply id="S4.E4.m1.27.27.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.28.28.2"><csymbol cd="ambiguous" id="S4.E4.m1.27.27.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.28.28.2">subscript</csymbol><ci id="S4.E4.m1.17.17.17.17.17.17.cmml" xref="S4.E4.m1.17.17.17.17.17.17">𝐡</ci><apply id="S4.E4.m1.18.18.18.18.18.18.1.cmml" xref="S4.E4.m1.18.18.18.18.18.18.1"><times id="S4.E4.m1.18.18.18.18.18.18.1.1.cmml" xref="S4.E4.m1.18.18.18.18.18.18.1.1"></times><ci id="S4.E4.m1.18.18.18.18.18.18.1.2.cmml" xref="S4.E4.m1.18.18.18.18.18.18.1.2">𝑖</ci><ci id="S4.E4.m1.18.18.18.18.18.18.1.3.cmml" xref="S4.E4.m1.18.18.18.18.18.18.1.3">𝑘</ci></apply></apply><apply id="S4.E4.m1.27.27.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E4.m1.28.28.2"><csymbol cd="ambiguous" id="S4.E4.m1.27.27.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E4.m1.28.28.2">subscript</csymbol><ci id="S4.E4.m1.20.20.20.20.20.20.cmml" xref="S4.E4.m1.20.20.20.20.20.20">𝐡</ci><apply id="S4.E4.m1.21.21.21.21.21.21.1.cmml" xref="S4.E4.m1.21.21.21.21.21.21.1"><times id="S4.E4.m1.21.21.21.21.21.21.1.1.cmml" xref="S4.E4.m1.21.21.21.21.21.21.1.1"></times><ci id="S4.E4.m1.21.21.21.21.21.21.1.2.cmml" xref="S4.E4.m1.21.21.21.21.21.21.1.2">𝑗</ci><ci id="S4.E4.m1.21.21.21.21.21.21.1.3.cmml" xref="S4.E4.m1.21.21.21.21.21.21.1.3">𝑘</ci></apply></apply></interval></apply><apply id="S4.E4.m1.27.27.1.1.1.1.1.1.1.4.cmml" xref="S4.E4.m1.28.28.2"><csymbol cd="ambiguous" id="S4.E4.m1.27.27.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E4.m1.28.28.2">subscript</csymbol><ci id="S4.E4.m1.24.24.24.24.24.24.cmml" xref="S4.E4.m1.24.24.24.24.24.24">𝐐</ci><apply id="S4.E4.m1.25.25.25.25.25.25.1.cmml" xref="S4.E4.m1.25.25.25.25.25.25.1"><ci id="S4.E4.m1.25.25.25.25.25.25.1.1.cmml" xref="S4.E4.m1.25.25.25.25.25.25.1.1">:</ci><csymbol cd="latexml" id="S4.E4.m1.25.25.25.25.25.25.1.2.cmml" xref="S4.E4.m1.25.25.25.25.25.25.1.2">absent</csymbol><ci id="S4.E4.m1.25.25.25.25.25.25.1.3.cmml" xref="S4.E4.m1.25.25.25.25.25.25.1.3">𝑀</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.28c">\begin{split}\mathbf{C}_{ij}=\tanh\sum_{k=1}^{2}\mathbf{w}_{c}^{\top}(\mathbf{w}^{\top}_{h}\mathbf{s}(\mathbf{h}_{ik},\mathbf{h}_{jk})+\mathbf{Q}_{:M})\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.16" class="ltx_p">where <math id="S4.SS2.p2.15.m1.1" class="ltx_Math" alttext="\mathbf{w}_{c}\in\mathbb{R}^{2d\times 1}" display="inline"><semantics id="S4.SS2.p2.15.m1.1a"><mrow id="S4.SS2.p2.15.m1.1.1" xref="S4.SS2.p2.15.m1.1.1.cmml"><msub id="S4.SS2.p2.15.m1.1.1.2" xref="S4.SS2.p2.15.m1.1.1.2.cmml"><mi id="S4.SS2.p2.15.m1.1.1.2.2" xref="S4.SS2.p2.15.m1.1.1.2.2.cmml">𝐰</mi><mi id="S4.SS2.p2.15.m1.1.1.2.3" xref="S4.SS2.p2.15.m1.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS2.p2.15.m1.1.1.1" xref="S4.SS2.p2.15.m1.1.1.1.cmml">∈</mo><msup id="S4.SS2.p2.15.m1.1.1.3" xref="S4.SS2.p2.15.m1.1.1.3.cmml"><mi id="S4.SS2.p2.15.m1.1.1.3.2" xref="S4.SS2.p2.15.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p2.15.m1.1.1.3.3" xref="S4.SS2.p2.15.m1.1.1.3.3.cmml"><mrow id="S4.SS2.p2.15.m1.1.1.3.3.2" xref="S4.SS2.p2.15.m1.1.1.3.3.2.cmml"><mn id="S4.SS2.p2.15.m1.1.1.3.3.2.2" xref="S4.SS2.p2.15.m1.1.1.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p2.15.m1.1.1.3.3.2.1" xref="S4.SS2.p2.15.m1.1.1.3.3.2.1.cmml">​</mo><mi id="S4.SS2.p2.15.m1.1.1.3.3.2.3" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.15.m1.1.1.3.3.1" xref="S4.SS2.p2.15.m1.1.1.3.3.1.cmml">×</mo><mn id="S4.SS2.p2.15.m1.1.1.3.3.3" xref="S4.SS2.p2.15.m1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.15.m1.1b"><apply id="S4.SS2.p2.15.m1.1.1.cmml" xref="S4.SS2.p2.15.m1.1.1"><in id="S4.SS2.p2.15.m1.1.1.1.cmml" xref="S4.SS2.p2.15.m1.1.1.1"></in><apply id="S4.SS2.p2.15.m1.1.1.2.cmml" xref="S4.SS2.p2.15.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m1.1.1.2.1.cmml" xref="S4.SS2.p2.15.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.15.m1.1.1.2.2.cmml" xref="S4.SS2.p2.15.m1.1.1.2.2">𝐰</ci><ci id="S4.SS2.p2.15.m1.1.1.2.3.cmml" xref="S4.SS2.p2.15.m1.1.1.2.3">𝑐</ci></apply><apply id="S4.SS2.p2.15.m1.1.1.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m1.1.1.3.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.15.m1.1.1.3.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.2">ℝ</ci><apply id="S4.SS2.p2.15.m1.1.1.3.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3"><times id="S4.SS2.p2.15.m1.1.1.3.3.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.1"></times><apply id="S4.SS2.p2.15.m1.1.1.3.3.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2"><times id="S4.SS2.p2.15.m1.1.1.3.3.2.1.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2.1"></times><cn type="integer" id="S4.SS2.p2.15.m1.1.1.3.3.2.2.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2.2">2</cn><ci id="S4.SS2.p2.15.m1.1.1.3.3.2.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.2.3">𝑑</ci></apply><cn type="integer" id="S4.SS2.p2.15.m1.1.1.3.3.3.cmml" xref="S4.SS2.p2.15.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.15.m1.1c">\mathbf{w}_{c}\in\mathbb{R}^{2d\times 1}</annotation></semantics></math> and <math id="S4.SS2.p2.16.m2.1" class="ltx_Math" alttext="\mathbf{w}_{h}\in\mathbb{R}^{4d\times 2d}" display="inline"><semantics id="S4.SS2.p2.16.m2.1a"><mrow id="S4.SS2.p2.16.m2.1.1" xref="S4.SS2.p2.16.m2.1.1.cmml"><msub id="S4.SS2.p2.16.m2.1.1.2" xref="S4.SS2.p2.16.m2.1.1.2.cmml"><mi id="S4.SS2.p2.16.m2.1.1.2.2" xref="S4.SS2.p2.16.m2.1.1.2.2.cmml">𝐰</mi><mi id="S4.SS2.p2.16.m2.1.1.2.3" xref="S4.SS2.p2.16.m2.1.1.2.3.cmml">h</mi></msub><mo id="S4.SS2.p2.16.m2.1.1.1" xref="S4.SS2.p2.16.m2.1.1.1.cmml">∈</mo><msup id="S4.SS2.p2.16.m2.1.1.3" xref="S4.SS2.p2.16.m2.1.1.3.cmml"><mi id="S4.SS2.p2.16.m2.1.1.3.2" xref="S4.SS2.p2.16.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p2.16.m2.1.1.3.3" xref="S4.SS2.p2.16.m2.1.1.3.3.cmml"><mrow id="S4.SS2.p2.16.m2.1.1.3.3.2" xref="S4.SS2.p2.16.m2.1.1.3.3.2.cmml"><mrow id="S4.SS2.p2.16.m2.1.1.3.3.2.2" xref="S4.SS2.p2.16.m2.1.1.3.3.2.2.cmml"><mn id="S4.SS2.p2.16.m2.1.1.3.3.2.2.2" xref="S4.SS2.p2.16.m2.1.1.3.3.2.2.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p2.16.m2.1.1.3.3.2.2.1" xref="S4.SS2.p2.16.m2.1.1.3.3.2.2.1.cmml">​</mo><mi id="S4.SS2.p2.16.m2.1.1.3.3.2.2.3" xref="S4.SS2.p2.16.m2.1.1.3.3.2.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.16.m2.1.1.3.3.2.1" xref="S4.SS2.p2.16.m2.1.1.3.3.2.1.cmml">×</mo><mn id="S4.SS2.p2.16.m2.1.1.3.3.2.3" xref="S4.SS2.p2.16.m2.1.1.3.3.2.3.cmml">2</mn></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.p2.16.m2.1.1.3.3.1" xref="S4.SS2.p2.16.m2.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.16.m2.1.1.3.3.3" xref="S4.SS2.p2.16.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.16.m2.1b"><apply id="S4.SS2.p2.16.m2.1.1.cmml" xref="S4.SS2.p2.16.m2.1.1"><in id="S4.SS2.p2.16.m2.1.1.1.cmml" xref="S4.SS2.p2.16.m2.1.1.1"></in><apply id="S4.SS2.p2.16.m2.1.1.2.cmml" xref="S4.SS2.p2.16.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.16.m2.1.1.2.1.cmml" xref="S4.SS2.p2.16.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.16.m2.1.1.2.2.cmml" xref="S4.SS2.p2.16.m2.1.1.2.2">𝐰</ci><ci id="S4.SS2.p2.16.m2.1.1.2.3.cmml" xref="S4.SS2.p2.16.m2.1.1.2.3">ℎ</ci></apply><apply id="S4.SS2.p2.16.m2.1.1.3.cmml" xref="S4.SS2.p2.16.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.16.m2.1.1.3.1.cmml" xref="S4.SS2.p2.16.m2.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.16.m2.1.1.3.2.cmml" xref="S4.SS2.p2.16.m2.1.1.3.2">ℝ</ci><apply id="S4.SS2.p2.16.m2.1.1.3.3.cmml" xref="S4.SS2.p2.16.m2.1.1.3.3"><times id="S4.SS2.p2.16.m2.1.1.3.3.1.cmml" xref="S4.SS2.p2.16.m2.1.1.3.3.1"></times><apply id="S4.SS2.p2.16.m2.1.1.3.3.2.cmml" xref="S4.SS2.p2.16.m2.1.1.3.3.2"><times id="S4.SS2.p2.16.m2.1.1.3.3.2.1.cmml" xref="S4.SS2.p2.16.m2.1.1.3.3.2.1"></times><apply id="S4.SS2.p2.16.m2.1.1.3.3.2.2.cmml" xref="S4.SS2.p2.16.m2.1.1.3.3.2.2"><times id="S4.SS2.p2.16.m2.1.1.3.3.2.2.1.cmml" xref="S4.SS2.p2.16.m2.1.1.3.3.2.2.1"></times><cn type="integer" id="S4.SS2.p2.16.m2.1.1.3.3.2.2.2.cmml" xref="S4.SS2.p2.16.m2.1.1.3.3.2.2.2">4</cn><ci id="S4.SS2.p2.16.m2.1.1.3.3.2.2.3.cmml" xref="S4.SS2.p2.16.m2.1.1.3.3.2.2.3">𝑑</ci></apply><cn type="integer" id="S4.SS2.p2.16.m2.1.1.3.3.2.3.cmml" xref="S4.SS2.p2.16.m2.1.1.3.3.2.3">2</cn></apply><ci id="S4.SS2.p2.16.m2.1.1.3.3.3.cmml" xref="S4.SS2.p2.16.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.16.m2.1c">\mathbf{w}_{h}\in\mathbb{R}^{4d\times 2d}</annotation></semantics></math>are parameters to learn. The temporal correlation matrix captures the temporal dependency of question, image and text sequence.
</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.7" class="ltx_p">To allow the model to capture the context between timesteps based on the question, we introduce temporal focal pooling to connect neighboring time hidden states if they are related to the question.
For example, it can capture the relevance between the moment ”dinner” and the moment later, ”Went dancing”, given the question ”What did we do after the dinner on Ben’s birthday?”.
Formally, given the time correlation matrix <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{C}" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">𝐂</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝐂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\mathbf{C}</annotation></semantics></math> and the context representation <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{H}" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\mathbf{H}</annotation></semantics></math>, we introduce a <span id="S4.SS2.p3.7.1" class="ltx_text ltx_font_italic">temporal focal pooling function</span> <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">g</annotation></semantics></math> to obtain the focal representation <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="\mathbf{F}\in\mathbb{R}^{2d\times T\times 2}" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mrow id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mi id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml">𝐅</mi><mo id="S4.SS2.p3.4.m4.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml"><mi id="S4.SS2.p3.4.m4.1.1.3.2" xref="S4.SS2.p3.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p3.4.m4.1.1.3.3" xref="S4.SS2.p3.4.m4.1.1.3.3.cmml"><mrow id="S4.SS2.p3.4.m4.1.1.3.3.2" xref="S4.SS2.p3.4.m4.1.1.3.3.2.cmml"><mn id="S4.SS2.p3.4.m4.1.1.3.3.2.2" xref="S4.SS2.p3.4.m4.1.1.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p3.4.m4.1.1.3.3.2.1" xref="S4.SS2.p3.4.m4.1.1.3.3.2.1.cmml">​</mo><mi id="S4.SS2.p3.4.m4.1.1.3.3.2.3" xref="S4.SS2.p3.4.m4.1.1.3.3.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p3.4.m4.1.1.3.3.1" xref="S4.SS2.p3.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p3.4.m4.1.1.3.3.3" xref="S4.SS2.p3.4.m4.1.1.3.3.3.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p3.4.m4.1.1.3.3.1a" xref="S4.SS2.p3.4.m4.1.1.3.3.1.cmml">×</mo><mn id="S4.SS2.p3.4.m4.1.1.3.3.4" xref="S4.SS2.p3.4.m4.1.1.3.3.4.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><in id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1"></in><ci id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2">𝐅</ci><apply id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.2">ℝ</ci><apply id="S4.SS2.p3.4.m4.1.1.3.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3"><times id="S4.SS2.p3.4.m4.1.1.3.3.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.1"></times><apply id="S4.SS2.p3.4.m4.1.1.3.3.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.2"><times id="S4.SS2.p3.4.m4.1.1.3.3.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.2.1"></times><cn type="integer" id="S4.SS2.p3.4.m4.1.1.3.3.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.2.2">2</cn><ci id="S4.SS2.p3.4.m4.1.1.3.3.2.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.2.3">𝑑</ci></apply><ci id="S4.SS2.p3.4.m4.1.1.3.3.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.3">𝑇</ci><cn type="integer" id="S4.SS2.p3.4.m4.1.1.3.3.4.cmml" xref="S4.SS2.p3.4.m4.1.1.3.3.4">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\mathbf{F}\in\mathbb{R}^{2d\times T\times 2}</annotation></semantics></math>. Each vector entry <math id="S4.SS2.p3.5.m5.1" class="ltx_Math" alttext="\mathbf{F}_{:tk}" display="inline"><semantics id="S4.SS2.p3.5.m5.1a"><msub id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml"><mi id="S4.SS2.p3.5.m5.1.1.2" xref="S4.SS2.p3.5.m5.1.1.2.cmml">𝐅</mi><mrow id="S4.SS2.p3.5.m5.1.1.3" xref="S4.SS2.p3.5.m5.1.1.3.cmml"><mi id="S4.SS2.p3.5.m5.1.1.3.2" xref="S4.SS2.p3.5.m5.1.1.3.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p3.5.m5.1.1.3.1" xref="S4.SS2.p3.5.m5.1.1.3.1.cmml">:</mo><mrow id="S4.SS2.p3.5.m5.1.1.3.3" xref="S4.SS2.p3.5.m5.1.1.3.3.cmml"><mi id="S4.SS2.p3.5.m5.1.1.3.3.2" xref="S4.SS2.p3.5.m5.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.5.m5.1.1.3.3.1" xref="S4.SS2.p3.5.m5.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p3.5.m5.1.1.3.3.3" xref="S4.SS2.p3.5.m5.1.1.3.3.3.cmml">k</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><apply id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2">𝐅</ci><apply id="S4.SS2.p3.5.m5.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3"><ci id="S4.SS2.p3.5.m5.1.1.3.1.cmml" xref="S4.SS2.p3.5.m5.1.1.3.1">:</ci><csymbol cd="latexml" id="S4.SS2.p3.5.m5.1.1.3.2.cmml" xref="S4.SS2.p3.5.m5.1.1.3.2">absent</csymbol><apply id="S4.SS2.p3.5.m5.1.1.3.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3.3"><times id="S4.SS2.p3.5.m5.1.1.3.3.1.cmml" xref="S4.SS2.p3.5.m5.1.1.3.3.1"></times><ci id="S4.SS2.p3.5.m5.1.1.3.3.2.cmml" xref="S4.SS2.p3.5.m5.1.1.3.3.2">𝑡</ci><ci id="S4.SS2.p3.5.m5.1.1.3.3.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">\mathbf{F}_{:tk}</annotation></semantics></math> (<math id="S4.SS2.p3.6.m6.6" class="ltx_Math" alttext="\forall t\in[1,T],\forall k\in[1,2]" display="inline"><semantics id="S4.SS2.p3.6.m6.6a"><mrow id="S4.SS2.p3.6.m6.6.6.2" xref="S4.SS2.p3.6.m6.6.6.3.cmml"><mrow id="S4.SS2.p3.6.m6.5.5.1.1" xref="S4.SS2.p3.6.m6.5.5.1.1.cmml"><mrow id="S4.SS2.p3.6.m6.5.5.1.1.2" xref="S4.SS2.p3.6.m6.5.5.1.1.2.cmml"><mo rspace="0.167em" id="S4.SS2.p3.6.m6.5.5.1.1.2.1" xref="S4.SS2.p3.6.m6.5.5.1.1.2.1.cmml">∀</mo><mi id="S4.SS2.p3.6.m6.5.5.1.1.2.2" xref="S4.SS2.p3.6.m6.5.5.1.1.2.2.cmml">t</mi></mrow><mo id="S4.SS2.p3.6.m6.5.5.1.1.1" xref="S4.SS2.p3.6.m6.5.5.1.1.1.cmml">∈</mo><mrow id="S4.SS2.p3.6.m6.5.5.1.1.3.2" xref="S4.SS2.p3.6.m6.5.5.1.1.3.1.cmml"><mo stretchy="false" id="S4.SS2.p3.6.m6.5.5.1.1.3.2.1" xref="S4.SS2.p3.6.m6.5.5.1.1.3.1.cmml">[</mo><mn id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml">1</mn><mo id="S4.SS2.p3.6.m6.5.5.1.1.3.2.2" xref="S4.SS2.p3.6.m6.5.5.1.1.3.1.cmml">,</mo><mi id="S4.SS2.p3.6.m6.2.2" xref="S4.SS2.p3.6.m6.2.2.cmml">T</mi><mo stretchy="false" id="S4.SS2.p3.6.m6.5.5.1.1.3.2.3" xref="S4.SS2.p3.6.m6.5.5.1.1.3.1.cmml">]</mo></mrow></mrow><mo id="S4.SS2.p3.6.m6.6.6.2.3" xref="S4.SS2.p3.6.m6.6.6.3a.cmml">,</mo><mrow id="S4.SS2.p3.6.m6.6.6.2.2" xref="S4.SS2.p3.6.m6.6.6.2.2.cmml"><mrow id="S4.SS2.p3.6.m6.6.6.2.2.2" xref="S4.SS2.p3.6.m6.6.6.2.2.2.cmml"><mo rspace="0.167em" id="S4.SS2.p3.6.m6.6.6.2.2.2.1" xref="S4.SS2.p3.6.m6.6.6.2.2.2.1.cmml">∀</mo><mi id="S4.SS2.p3.6.m6.6.6.2.2.2.2" xref="S4.SS2.p3.6.m6.6.6.2.2.2.2.cmml">k</mi></mrow><mo id="S4.SS2.p3.6.m6.6.6.2.2.1" xref="S4.SS2.p3.6.m6.6.6.2.2.1.cmml">∈</mo><mrow id="S4.SS2.p3.6.m6.6.6.2.2.3.2" xref="S4.SS2.p3.6.m6.6.6.2.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.p3.6.m6.6.6.2.2.3.2.1" xref="S4.SS2.p3.6.m6.6.6.2.2.3.1.cmml">[</mo><mn id="S4.SS2.p3.6.m6.3.3" xref="S4.SS2.p3.6.m6.3.3.cmml">1</mn><mo id="S4.SS2.p3.6.m6.6.6.2.2.3.2.2" xref="S4.SS2.p3.6.m6.6.6.2.2.3.1.cmml">,</mo><mn id="S4.SS2.p3.6.m6.4.4" xref="S4.SS2.p3.6.m6.4.4.cmml">2</mn><mo stretchy="false" id="S4.SS2.p3.6.m6.6.6.2.2.3.2.3" xref="S4.SS2.p3.6.m6.6.6.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.6b"><apply id="S4.SS2.p3.6.m6.6.6.3.cmml" xref="S4.SS2.p3.6.m6.6.6.2"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.6.6.3a.cmml" xref="S4.SS2.p3.6.m6.6.6.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p3.6.m6.5.5.1.1.cmml" xref="S4.SS2.p3.6.m6.5.5.1.1"><in id="S4.SS2.p3.6.m6.5.5.1.1.1.cmml" xref="S4.SS2.p3.6.m6.5.5.1.1.1"></in><apply id="S4.SS2.p3.6.m6.5.5.1.1.2.cmml" xref="S4.SS2.p3.6.m6.5.5.1.1.2"><csymbol cd="latexml" id="S4.SS2.p3.6.m6.5.5.1.1.2.1.cmml" xref="S4.SS2.p3.6.m6.5.5.1.1.2.1">for-all</csymbol><ci id="S4.SS2.p3.6.m6.5.5.1.1.2.2.cmml" xref="S4.SS2.p3.6.m6.5.5.1.1.2.2">𝑡</ci></apply><interval closure="closed" id="S4.SS2.p3.6.m6.5.5.1.1.3.1.cmml" xref="S4.SS2.p3.6.m6.5.5.1.1.3.2"><cn type="integer" id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1">1</cn><ci id="S4.SS2.p3.6.m6.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2">𝑇</ci></interval></apply><apply id="S4.SS2.p3.6.m6.6.6.2.2.cmml" xref="S4.SS2.p3.6.m6.6.6.2.2"><in id="S4.SS2.p3.6.m6.6.6.2.2.1.cmml" xref="S4.SS2.p3.6.m6.6.6.2.2.1"></in><apply id="S4.SS2.p3.6.m6.6.6.2.2.2.cmml" xref="S4.SS2.p3.6.m6.6.6.2.2.2"><csymbol cd="latexml" id="S4.SS2.p3.6.m6.6.6.2.2.2.1.cmml" xref="S4.SS2.p3.6.m6.6.6.2.2.2.1">for-all</csymbol><ci id="S4.SS2.p3.6.m6.6.6.2.2.2.2.cmml" xref="S4.SS2.p3.6.m6.6.6.2.2.2.2">𝑘</ci></apply><interval closure="closed" id="S4.SS2.p3.6.m6.6.6.2.2.3.1.cmml" xref="S4.SS2.p3.6.m6.6.6.2.2.3.2"><cn type="integer" id="S4.SS2.p3.6.m6.3.3.cmml" xref="S4.SS2.p3.6.m6.3.3">1</cn><cn type="integer" id="S4.SS2.p3.6.m6.4.4.cmml" xref="S4.SS2.p3.6.m6.4.4">2</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.6c">\forall t\in[1,T],\forall k\in[1,2]</annotation></semantics></math>) in <math id="S4.SS2.p3.7.m7.1" class="ltx_Math" alttext="\mathbf{F}" display="inline"><semantics id="S4.SS2.p3.7.m7.1a"><mi id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.1b"><ci id="S4.SS2.p3.7.m7.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.1c">\mathbf{F}</annotation></semantics></math> is calculated by:</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.5" class="ltx_Math" alttext="\mathbf{F}_{:tk}=g(\mathbf{H};\mathbf{C},t,k)\in\mathbb{R}^{2d}," display="block"><semantics id="S4.E5.m1.5a"><mrow id="S4.E5.m1.5.5.1" xref="S4.E5.m1.5.5.1.1.cmml"><mrow id="S4.E5.m1.5.5.1.1" xref="S4.E5.m1.5.5.1.1.cmml"><msub id="S4.E5.m1.5.5.1.1.2" xref="S4.E5.m1.5.5.1.1.2.cmml"><mi id="S4.E5.m1.5.5.1.1.2.2" xref="S4.E5.m1.5.5.1.1.2.2.cmml">𝐅</mi><mrow id="S4.E5.m1.5.5.1.1.2.3" xref="S4.E5.m1.5.5.1.1.2.3.cmml"><mi id="S4.E5.m1.5.5.1.1.2.3.2" xref="S4.E5.m1.5.5.1.1.2.3.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S4.E5.m1.5.5.1.1.2.3.1" xref="S4.E5.m1.5.5.1.1.2.3.1.cmml">:</mo><mrow id="S4.E5.m1.5.5.1.1.2.3.3" xref="S4.E5.m1.5.5.1.1.2.3.3.cmml"><mi id="S4.E5.m1.5.5.1.1.2.3.3.2" xref="S4.E5.m1.5.5.1.1.2.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.5.5.1.1.2.3.3.1" xref="S4.E5.m1.5.5.1.1.2.3.3.1.cmml">​</mo><mi id="S4.E5.m1.5.5.1.1.2.3.3.3" xref="S4.E5.m1.5.5.1.1.2.3.3.3.cmml">k</mi></mrow></mrow></msub><mo id="S4.E5.m1.5.5.1.1.3" xref="S4.E5.m1.5.5.1.1.3.cmml">=</mo><mrow id="S4.E5.m1.5.5.1.1.4" xref="S4.E5.m1.5.5.1.1.4.cmml"><mi id="S4.E5.m1.5.5.1.1.4.2" xref="S4.E5.m1.5.5.1.1.4.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.5.5.1.1.4.1" xref="S4.E5.m1.5.5.1.1.4.1.cmml">​</mo><mrow id="S4.E5.m1.5.5.1.1.4.3.2" xref="S4.E5.m1.5.5.1.1.4.3.1.cmml"><mo stretchy="false" id="S4.E5.m1.5.5.1.1.4.3.2.1" xref="S4.E5.m1.5.5.1.1.4.3.1.cmml">(</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">𝐇</mi><mo id="S4.E5.m1.5.5.1.1.4.3.2.2" xref="S4.E5.m1.5.5.1.1.4.3.1.cmml">;</mo><mi id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">𝐂</mi><mo id="S4.E5.m1.5.5.1.1.4.3.2.3" xref="S4.E5.m1.5.5.1.1.4.3.1.cmml">,</mo><mi id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml">t</mi><mo id="S4.E5.m1.5.5.1.1.4.3.2.4" xref="S4.E5.m1.5.5.1.1.4.3.1.cmml">,</mo><mi id="S4.E5.m1.4.4" xref="S4.E5.m1.4.4.cmml">k</mi><mo stretchy="false" id="S4.E5.m1.5.5.1.1.4.3.2.5" xref="S4.E5.m1.5.5.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.5.5.1.1.5" xref="S4.E5.m1.5.5.1.1.5.cmml">∈</mo><msup id="S4.E5.m1.5.5.1.1.6" xref="S4.E5.m1.5.5.1.1.6.cmml"><mi id="S4.E5.m1.5.5.1.1.6.2" xref="S4.E5.m1.5.5.1.1.6.2.cmml">ℝ</mi><mrow id="S4.E5.m1.5.5.1.1.6.3" xref="S4.E5.m1.5.5.1.1.6.3.cmml"><mn id="S4.E5.m1.5.5.1.1.6.3.2" xref="S4.E5.m1.5.5.1.1.6.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.E5.m1.5.5.1.1.6.3.1" xref="S4.E5.m1.5.5.1.1.6.3.1.cmml">​</mo><mi id="S4.E5.m1.5.5.1.1.6.3.3" xref="S4.E5.m1.5.5.1.1.6.3.3.cmml">d</mi></mrow></msup></mrow><mo id="S4.E5.m1.5.5.1.2" xref="S4.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.5b"><apply id="S4.E5.m1.5.5.1.1.cmml" xref="S4.E5.m1.5.5.1"><and id="S4.E5.m1.5.5.1.1a.cmml" xref="S4.E5.m1.5.5.1"></and><apply id="S4.E5.m1.5.5.1.1b.cmml" xref="S4.E5.m1.5.5.1"><eq id="S4.E5.m1.5.5.1.1.3.cmml" xref="S4.E5.m1.5.5.1.1.3"></eq><apply id="S4.E5.m1.5.5.1.1.2.cmml" xref="S4.E5.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.2.1.cmml" xref="S4.E5.m1.5.5.1.1.2">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2">𝐅</ci><apply id="S4.E5.m1.5.5.1.1.2.3.cmml" xref="S4.E5.m1.5.5.1.1.2.3"><ci id="S4.E5.m1.5.5.1.1.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.2.3.1">:</ci><csymbol cd="latexml" id="S4.E5.m1.5.5.1.1.2.3.2.cmml" xref="S4.E5.m1.5.5.1.1.2.3.2">absent</csymbol><apply id="S4.E5.m1.5.5.1.1.2.3.3.cmml" xref="S4.E5.m1.5.5.1.1.2.3.3"><times id="S4.E5.m1.5.5.1.1.2.3.3.1.cmml" xref="S4.E5.m1.5.5.1.1.2.3.3.1"></times><ci id="S4.E5.m1.5.5.1.1.2.3.3.2.cmml" xref="S4.E5.m1.5.5.1.1.2.3.3.2">𝑡</ci><ci id="S4.E5.m1.5.5.1.1.2.3.3.3.cmml" xref="S4.E5.m1.5.5.1.1.2.3.3.3">𝑘</ci></apply></apply></apply><apply id="S4.E5.m1.5.5.1.1.4.cmml" xref="S4.E5.m1.5.5.1.1.4"><times id="S4.E5.m1.5.5.1.1.4.1.cmml" xref="S4.E5.m1.5.5.1.1.4.1"></times><ci id="S4.E5.m1.5.5.1.1.4.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2">𝑔</ci><list id="S4.E5.m1.5.5.1.1.4.3.1.cmml" xref="S4.E5.m1.5.5.1.1.4.3.2"><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝐇</ci><ci id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">𝐂</ci><ci id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3">𝑡</ci><ci id="S4.E5.m1.4.4.cmml" xref="S4.E5.m1.4.4">𝑘</ci></list></apply></apply><apply id="S4.E5.m1.5.5.1.1c.cmml" xref="S4.E5.m1.5.5.1"><in id="S4.E5.m1.5.5.1.1.5.cmml" xref="S4.E5.m1.5.5.1.1.5"></in><share href="#S4.E5.m1.5.5.1.1.4.cmml" id="S4.E5.m1.5.5.1.1d.cmml" xref="S4.E5.m1.5.5.1"></share><apply id="S4.E5.m1.5.5.1.1.6.cmml" xref="S4.E5.m1.5.5.1.1.6"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.6.1.cmml" xref="S4.E5.m1.5.5.1.1.6">superscript</csymbol><ci id="S4.E5.m1.5.5.1.1.6.2.cmml" xref="S4.E5.m1.5.5.1.1.6.2">ℝ</ci><apply id="S4.E5.m1.5.5.1.1.6.3.cmml" xref="S4.E5.m1.5.5.1.1.6.3"><times id="S4.E5.m1.5.5.1.1.6.3.1.cmml" xref="S4.E5.m1.5.5.1.1.6.3.1"></times><cn type="integer" id="S4.E5.m1.5.5.1.1.6.3.2.cmml" xref="S4.E5.m1.5.5.1.1.6.3.2">2</cn><ci id="S4.E5.m1.5.5.1.1.6.3.3.cmml" xref="S4.E5.m1.5.5.1.1.6.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.5c">\mathbf{F}_{:tk}=g(\mathbf{H};\mathbf{C},t,k)\in\mathbb{R}^{2d},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.5" class="ltx_Math" alttext="g(\mathbf{H};\mathbf{C},t,k)=\sum_{s=1}^{T}\mathbbm{1}[s\in[t-c,t+c]]\mathbf{C}_{st}\mathbf{h}_{sk},\vspace{-1mm}" display="block"><semantics id="S4.E6.m1.5a"><mrow id="S4.E6.m1.5.5.1" xref="S4.E6.m1.5.5.1.1.cmml"><mrow id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.1.cmml"><mrow id="S4.E6.m1.5.5.1.1.3" xref="S4.E6.m1.5.5.1.1.3.cmml"><mi id="S4.E6.m1.5.5.1.1.3.2" xref="S4.E6.m1.5.5.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.3.1" xref="S4.E6.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="S4.E6.m1.5.5.1.1.3.3.2" xref="S4.E6.m1.5.5.1.1.3.3.1.cmml"><mo stretchy="false" id="S4.E6.m1.5.5.1.1.3.3.2.1" xref="S4.E6.m1.5.5.1.1.3.3.1.cmml">(</mo><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">𝐇</mi><mo id="S4.E6.m1.5.5.1.1.3.3.2.2" xref="S4.E6.m1.5.5.1.1.3.3.1.cmml">;</mo><mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">𝐂</mi><mo id="S4.E6.m1.5.5.1.1.3.3.2.3" xref="S4.E6.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml">t</mi><mo id="S4.E6.m1.5.5.1.1.3.3.2.4" xref="S4.E6.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S4.E6.m1.4.4" xref="S4.E6.m1.4.4.cmml">k</mi><mo stretchy="false" id="S4.E6.m1.5.5.1.1.3.3.2.5" xref="S4.E6.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S4.E6.m1.5.5.1.1.2" xref="S4.E6.m1.5.5.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.5.5.1.1.1" xref="S4.E6.m1.5.5.1.1.1.cmml"><munderover id="S4.E6.m1.5.5.1.1.1.2" xref="S4.E6.m1.5.5.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E6.m1.5.5.1.1.1.2.2.2" xref="S4.E6.m1.5.5.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E6.m1.5.5.1.1.1.2.2.3" xref="S4.E6.m1.5.5.1.1.1.2.2.3.cmml"><mi id="S4.E6.m1.5.5.1.1.1.2.2.3.2" xref="S4.E6.m1.5.5.1.1.1.2.2.3.2.cmml">s</mi><mo id="S4.E6.m1.5.5.1.1.1.2.2.3.1" xref="S4.E6.m1.5.5.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E6.m1.5.5.1.1.1.2.2.3.3" xref="S4.E6.m1.5.5.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E6.m1.5.5.1.1.1.2.3" xref="S4.E6.m1.5.5.1.1.1.2.3.cmml">T</mi></munderover><mrow id="S4.E6.m1.5.5.1.1.1.1" xref="S4.E6.m1.5.5.1.1.1.1.cmml"><mn id="S4.E6.m1.5.5.1.1.1.1.3" xref="S4.E6.m1.5.5.1.1.1.1.3.cmml">𝟙</mn><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.1.1.2" xref="S4.E6.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.5.5.1.1.1.1.1.1" xref="S4.E6.m1.5.5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.5.5.1.1.1.1.1.1.2" xref="S4.E6.m1.5.5.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E6.m1.5.5.1.1.1.1.1.1.1" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.5.5.1.1.1.1.1.1.1.4" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.4.cmml">s</mi><mo id="S4.E6.m1.5.5.1.1.1.1.1.1.1.3" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.3.cmml">∈</mo><mrow id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.3" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">[</mo><mrow id="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.4" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.2.cmml">t</mi><mo id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.1" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.cmml">+</mo><mi id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.3.cmml">c</mi></mrow><mo stretchy="false" id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.5" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S4.E6.m1.5.5.1.1.1.1.1.1.3" xref="S4.E6.m1.5.5.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.1.1.2a" xref="S4.E6.m1.5.5.1.1.1.1.2.cmml">​</mo><msub id="S4.E6.m1.5.5.1.1.1.1.4" xref="S4.E6.m1.5.5.1.1.1.1.4.cmml"><mi id="S4.E6.m1.5.5.1.1.1.1.4.2" xref="S4.E6.m1.5.5.1.1.1.1.4.2.cmml">𝐂</mi><mrow id="S4.E6.m1.5.5.1.1.1.1.4.3" xref="S4.E6.m1.5.5.1.1.1.1.4.3.cmml"><mi id="S4.E6.m1.5.5.1.1.1.1.4.3.2" xref="S4.E6.m1.5.5.1.1.1.1.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.1.1.4.3.1" xref="S4.E6.m1.5.5.1.1.1.1.4.3.1.cmml">​</mo><mi id="S4.E6.m1.5.5.1.1.1.1.4.3.3" xref="S4.E6.m1.5.5.1.1.1.1.4.3.3.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.1.1.2b" xref="S4.E6.m1.5.5.1.1.1.1.2.cmml">​</mo><msub id="S4.E6.m1.5.5.1.1.1.1.5" xref="S4.E6.m1.5.5.1.1.1.1.5.cmml"><mi id="S4.E6.m1.5.5.1.1.1.1.5.2" xref="S4.E6.m1.5.5.1.1.1.1.5.2.cmml">𝐡</mi><mrow id="S4.E6.m1.5.5.1.1.1.1.5.3" xref="S4.E6.m1.5.5.1.1.1.1.5.3.cmml"><mi id="S4.E6.m1.5.5.1.1.1.1.5.3.2" xref="S4.E6.m1.5.5.1.1.1.1.5.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.1.1.1.1.5.3.1" xref="S4.E6.m1.5.5.1.1.1.1.5.3.1.cmml">​</mo><mi id="S4.E6.m1.5.5.1.1.1.1.5.3.3" xref="S4.E6.m1.5.5.1.1.1.1.5.3.3.cmml">k</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.E6.m1.5.5.1.2" xref="S4.E6.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.5b"><apply id="S4.E6.m1.5.5.1.1.cmml" xref="S4.E6.m1.5.5.1"><eq id="S4.E6.m1.5.5.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2"></eq><apply id="S4.E6.m1.5.5.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.3"><times id="S4.E6.m1.5.5.1.1.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.1"></times><ci id="S4.E6.m1.5.5.1.1.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2">𝑔</ci><list id="S4.E6.m1.5.5.1.1.3.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3.3.2"><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">𝐇</ci><ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">𝐂</ci><ci id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.3.3">𝑡</ci><ci id="S4.E6.m1.4.4.cmml" xref="S4.E6.m1.4.4">𝑘</ci></list></apply><apply id="S4.E6.m1.5.5.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1"><apply id="S4.E6.m1.5.5.1.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.1.2">superscript</csymbol><apply id="S4.E6.m1.5.5.1.1.1.2.2.cmml" xref="S4.E6.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.1.2.2.1.cmml" xref="S4.E6.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S4.E6.m1.5.5.1.1.1.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.1.2.2.2"></sum><apply id="S4.E6.m1.5.5.1.1.1.2.2.3.cmml" xref="S4.E6.m1.5.5.1.1.1.2.2.3"><eq id="S4.E6.m1.5.5.1.1.1.2.2.3.1.cmml" xref="S4.E6.m1.5.5.1.1.1.2.2.3.1"></eq><ci id="S4.E6.m1.5.5.1.1.1.2.2.3.2.cmml" xref="S4.E6.m1.5.5.1.1.1.2.2.3.2">𝑠</ci><cn type="integer" id="S4.E6.m1.5.5.1.1.1.2.2.3.3.cmml" xref="S4.E6.m1.5.5.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E6.m1.5.5.1.1.1.2.3.cmml" xref="S4.E6.m1.5.5.1.1.1.2.3">𝑇</ci></apply><apply id="S4.E6.m1.5.5.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1"><times id="S4.E6.m1.5.5.1.1.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1.2"></times><cn type="integer" id="S4.E6.m1.5.5.1.1.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.1.1.3">1</cn><apply id="S4.E6.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E6.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1"><in id="S4.E6.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.3"></in><ci id="S4.E6.m1.5.5.1.1.1.1.1.1.1.4.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.4">𝑠</ci><interval closure="closed" id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2"><apply id="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1"><minus id="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.2">𝑡</ci><ci id="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2"><plus id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.1"></plus><ci id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.2">𝑡</ci><ci id="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E6.m1.5.5.1.1.1.1.1.1.1.2.2.2.3">𝑐</ci></apply></interval></apply></apply><apply id="S4.E6.m1.5.5.1.1.1.1.4.cmml" xref="S4.E6.m1.5.5.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.1.1.4.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.4">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.1.1.4.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1.4.2">𝐂</ci><apply id="S4.E6.m1.5.5.1.1.1.1.4.3.cmml" xref="S4.E6.m1.5.5.1.1.1.1.4.3"><times id="S4.E6.m1.5.5.1.1.1.1.4.3.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.4.3.1"></times><ci id="S4.E6.m1.5.5.1.1.1.1.4.3.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1.4.3.2">𝑠</ci><ci id="S4.E6.m1.5.5.1.1.1.1.4.3.3.cmml" xref="S4.E6.m1.5.5.1.1.1.1.4.3.3">𝑡</ci></apply></apply><apply id="S4.E6.m1.5.5.1.1.1.1.5.cmml" xref="S4.E6.m1.5.5.1.1.1.1.5"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.1.1.5.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.5">subscript</csymbol><ci id="S4.E6.m1.5.5.1.1.1.1.5.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1.5.2">𝐡</ci><apply id="S4.E6.m1.5.5.1.1.1.1.5.3.cmml" xref="S4.E6.m1.5.5.1.1.1.1.5.3"><times id="S4.E6.m1.5.5.1.1.1.1.5.3.1.cmml" xref="S4.E6.m1.5.5.1.1.1.1.5.3.1"></times><ci id="S4.E6.m1.5.5.1.1.1.1.5.3.2.cmml" xref="S4.E6.m1.5.5.1.1.1.1.5.3.2">𝑠</ci><ci id="S4.E6.m1.5.5.1.1.1.1.5.3.3.cmml" xref="S4.E6.m1.5.5.1.1.1.1.5.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.5c">g(\mathbf{H};\mathbf{C},t,k)=\sum_{s=1}^{T}\mathbbm{1}[s\in[t-c,t+c]]\mathbf{C}_{st}\mathbf{h}_{sk},\vspace{-1mm}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p3.14" class="ltx_p">where <math id="S4.SS2.p3.8.m1.1" class="ltx_Math" alttext="\mathbf{F}_{:tk}" display="inline"><semantics id="S4.SS2.p3.8.m1.1a"><msub id="S4.SS2.p3.8.m1.1.1" xref="S4.SS2.p3.8.m1.1.1.cmml"><mi id="S4.SS2.p3.8.m1.1.1.2" xref="S4.SS2.p3.8.m1.1.1.2.cmml">𝐅</mi><mrow id="S4.SS2.p3.8.m1.1.1.3" xref="S4.SS2.p3.8.m1.1.1.3.cmml"><mi id="S4.SS2.p3.8.m1.1.1.3.2" xref="S4.SS2.p3.8.m1.1.1.3.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p3.8.m1.1.1.3.1" xref="S4.SS2.p3.8.m1.1.1.3.1.cmml">:</mo><mrow id="S4.SS2.p3.8.m1.1.1.3.3" xref="S4.SS2.p3.8.m1.1.1.3.3.cmml"><mi id="S4.SS2.p3.8.m1.1.1.3.3.2" xref="S4.SS2.p3.8.m1.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.8.m1.1.1.3.3.1" xref="S4.SS2.p3.8.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p3.8.m1.1.1.3.3.3" xref="S4.SS2.p3.8.m1.1.1.3.3.3.cmml">k</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m1.1b"><apply id="S4.SS2.p3.8.m1.1.1.cmml" xref="S4.SS2.p3.8.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.8.m1.1.1.1.cmml" xref="S4.SS2.p3.8.m1.1.1">subscript</csymbol><ci id="S4.SS2.p3.8.m1.1.1.2.cmml" xref="S4.SS2.p3.8.m1.1.1.2">𝐅</ci><apply id="S4.SS2.p3.8.m1.1.1.3.cmml" xref="S4.SS2.p3.8.m1.1.1.3"><ci id="S4.SS2.p3.8.m1.1.1.3.1.cmml" xref="S4.SS2.p3.8.m1.1.1.3.1">:</ci><csymbol cd="latexml" id="S4.SS2.p3.8.m1.1.1.3.2.cmml" xref="S4.SS2.p3.8.m1.1.1.3.2">absent</csymbol><apply id="S4.SS2.p3.8.m1.1.1.3.3.cmml" xref="S4.SS2.p3.8.m1.1.1.3.3"><times id="S4.SS2.p3.8.m1.1.1.3.3.1.cmml" xref="S4.SS2.p3.8.m1.1.1.3.3.1"></times><ci id="S4.SS2.p3.8.m1.1.1.3.3.2.cmml" xref="S4.SS2.p3.8.m1.1.1.3.3.2">𝑡</ci><ci id="S4.SS2.p3.8.m1.1.1.3.3.3.cmml" xref="S4.SS2.p3.8.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.8.m1.1c">\mathbf{F}_{:tk}</annotation></semantics></math> is the focal context representation at <math id="S4.SS2.p3.9.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.p3.9.m2.1a"><mi id="S4.SS2.p3.9.m2.1.1" xref="S4.SS2.p3.9.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.9.m2.1b"><ci id="S4.SS2.p3.9.m2.1.1.cmml" xref="S4.SS2.p3.9.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.9.m2.1c">t</annotation></semantics></math>-th timestep for visual (<math id="S4.SS2.p3.10.m3.1" class="ltx_Math" alttext="k=1" display="inline"><semantics id="S4.SS2.p3.10.m3.1a"><mrow id="S4.SS2.p3.10.m3.1.1" xref="S4.SS2.p3.10.m3.1.1.cmml"><mi id="S4.SS2.p3.10.m3.1.1.2" xref="S4.SS2.p3.10.m3.1.1.2.cmml">k</mi><mo id="S4.SS2.p3.10.m3.1.1.1" xref="S4.SS2.p3.10.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.10.m3.1.1.3" xref="S4.SS2.p3.10.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.10.m3.1b"><apply id="S4.SS2.p3.10.m3.1.1.cmml" xref="S4.SS2.p3.10.m3.1.1"><eq id="S4.SS2.p3.10.m3.1.1.1.cmml" xref="S4.SS2.p3.10.m3.1.1.1"></eq><ci id="S4.SS2.p3.10.m3.1.1.2.cmml" xref="S4.SS2.p3.10.m3.1.1.2">𝑘</ci><cn type="integer" id="S4.SS2.p3.10.m3.1.1.3.cmml" xref="S4.SS2.p3.10.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.10.m3.1c">k=1</annotation></semantics></math>) or text (<math id="S4.SS2.p3.11.m4.1" class="ltx_Math" alttext="k=2" display="inline"><semantics id="S4.SS2.p3.11.m4.1a"><mrow id="S4.SS2.p3.11.m4.1.1" xref="S4.SS2.p3.11.m4.1.1.cmml"><mi id="S4.SS2.p3.11.m4.1.1.2" xref="S4.SS2.p3.11.m4.1.1.2.cmml">k</mi><mo id="S4.SS2.p3.11.m4.1.1.1" xref="S4.SS2.p3.11.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.11.m4.1.1.3" xref="S4.SS2.p3.11.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.11.m4.1b"><apply id="S4.SS2.p3.11.m4.1.1.cmml" xref="S4.SS2.p3.11.m4.1.1"><eq id="S4.SS2.p3.11.m4.1.1.1.cmml" xref="S4.SS2.p3.11.m4.1.1.1"></eq><ci id="S4.SS2.p3.11.m4.1.1.2.cmml" xref="S4.SS2.p3.11.m4.1.1.2">𝑘</ci><cn type="integer" id="S4.SS2.p3.11.m4.1.1.3.cmml" xref="S4.SS2.p3.11.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.11.m4.1c">k=2</annotation></semantics></math>). <math id="S4.SS2.p3.12.m5.1" class="ltx_Math" alttext="\mathbbm{1}" display="inline"><semantics id="S4.SS2.p3.12.m5.1a"><mn id="S4.SS2.p3.12.m5.1.1" xref="S4.SS2.p3.12.m5.1.1.cmml">𝟙</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.12.m5.1b"><cn type="integer" id="S4.SS2.p3.12.m5.1.1.cmml" xref="S4.SS2.p3.12.m5.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.12.m5.1c">\mathbbm{1}</annotation></semantics></math> is the indicator function. <math id="S4.SS2.p3.13.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.p3.13.m6.1a"><mi id="S4.SS2.p3.13.m6.1.1" xref="S4.SS2.p3.13.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.13.m6.1b"><ci id="S4.SS2.p3.13.m6.1.1.cmml" xref="S4.SS2.p3.13.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.13.m6.1c">c</annotation></semantics></math> stands for the size of the temporal window) that is end-to-end learned with other parameters. We constrain the model to focus on a few small temporal context windows of learnable window size <math id="S4.SS2.p3.14.m7.1" class="ltx_Math" alttext="2c+1" display="inline"><semantics id="S4.SS2.p3.14.m7.1a"><mrow id="S4.SS2.p3.14.m7.1.1" xref="S4.SS2.p3.14.m7.1.1.cmml"><mrow id="S4.SS2.p3.14.m7.1.1.2" xref="S4.SS2.p3.14.m7.1.1.2.cmml"><mn id="S4.SS2.p3.14.m7.1.1.2.2" xref="S4.SS2.p3.14.m7.1.1.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.SS2.p3.14.m7.1.1.2.1" xref="S4.SS2.p3.14.m7.1.1.2.1.cmml">​</mo><mi id="S4.SS2.p3.14.m7.1.1.2.3" xref="S4.SS2.p3.14.m7.1.1.2.3.cmml">c</mi></mrow><mo id="S4.SS2.p3.14.m7.1.1.1" xref="S4.SS2.p3.14.m7.1.1.1.cmml">+</mo><mn id="S4.SS2.p3.14.m7.1.1.3" xref="S4.SS2.p3.14.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.14.m7.1b"><apply id="S4.SS2.p3.14.m7.1.1.cmml" xref="S4.SS2.p3.14.m7.1.1"><plus id="S4.SS2.p3.14.m7.1.1.1.cmml" xref="S4.SS2.p3.14.m7.1.1.1"></plus><apply id="S4.SS2.p3.14.m7.1.1.2.cmml" xref="S4.SS2.p3.14.m7.1.1.2"><times id="S4.SS2.p3.14.m7.1.1.2.1.cmml" xref="S4.SS2.p3.14.m7.1.1.2.1"></times><cn type="integer" id="S4.SS2.p3.14.m7.1.1.2.2.cmml" xref="S4.SS2.p3.14.m7.1.1.2.2">2</cn><ci id="S4.SS2.p3.14.m7.1.1.2.3.cmml" xref="S4.SS2.p3.14.m7.1.1.2.3">𝑐</ci></apply><cn type="integer" id="S4.SS2.p3.14.m7.1.1.3.cmml" xref="S4.SS2.p3.14.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.14.m7.1c">2c+1</annotation></semantics></math>.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/1806.01873/assets/tmm_comp_1dim_v2.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="309" height="352" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Comparison of our FVTA and classical VQA attention mechanism. FVTA considers both visual-text intra-sequence correlations and cross sequence interaction, and focuses on a few, small regions. In FVTA, the multi-modal feature representation in the sequence data is preserved without losing information.</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Cross Sequence Interaction</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.12" class="ltx_p">In this section, we introduce the attention mechanism to capture the important correlation between visual and textual sequences.
We apply attention over the focal context representation to summarize important information for answering the question.
We obtain the attention weights based on a correlation tensor <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{S}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\mathbf{S}</annotation></semantics></math> between each word of the question and each timestep of the visual-text sequences.
The attention at each timestep only considers the context and the question, and does not depend on the attention at previous timestep. The intuition of using such a memory-less attention mechanism is that it simplifies the attention and let the model focus on learning the correlation between context and question. Such mechanism has been proven useful in text question answering <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
We computes a <span id="S4.SS3.p1.12.1" class="ltx_text ltx_font_italic">kernel tensor</span>, <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{S}\in\mathbb{R}^{M\times T\times 2}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">𝐒</mi><mo id="S4.SS3.p1.2.m2.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3.2" xref="S4.SS3.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.2.m2.1.1.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3.3.2" xref="S4.SS3.p1.2.m2.1.1.3.3.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p1.2.m2.1.1.3.3.1" xref="S4.SS3.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS3.p1.2.m2.1.1.3.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.3.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p1.2.m2.1.1.3.3.1a" xref="S4.SS3.p1.2.m2.1.1.3.3.1.cmml">×</mo><mn id="S4.SS3.p1.2.m2.1.1.3.3.4" xref="S4.SS3.p1.2.m2.1.1.3.3.4.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><in id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1"></in><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝐒</ci><apply id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3"><times id="S4.SS3.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3.1"></times><ci id="S4.SS3.p1.2.m2.1.1.3.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3.2">𝑀</ci><ci id="S4.SS3.p1.2.m2.1.1.3.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3.3">𝑇</ci><cn type="integer" id="S4.SS3.p1.2.m2.1.1.3.3.4.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3.4">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\mathbf{S}\in\mathbb{R}^{M\times T\times 2}</annotation></semantics></math>, between the input question and the focal context representation <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{F}" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">\mathbf{F}</annotation></semantics></math>, where each entry in the kernel <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="s_{mtk}" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><msub id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">s</mi><mrow id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml"><mi id="S4.SS3.p1.4.m4.1.1.3.2" xref="S4.SS3.p1.4.m4.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m4.1.1.3.1" xref="S4.SS3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.4.m4.1.1.3.3" xref="S4.SS3.p1.4.m4.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.4.m4.1.1.3.1a" xref="S4.SS3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.4.m4.1.1.3.4" xref="S4.SS3.p1.4.m4.1.1.3.4.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">𝑠</ci><apply id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3"><times id="S4.SS3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3.1"></times><ci id="S4.SS3.p1.4.m4.1.1.3.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.2">𝑚</ci><ci id="S4.SS3.p1.4.m4.1.1.3.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3">𝑡</ci><ci id="S4.SS3.p1.4.m4.1.1.3.4.cmml" xref="S4.SS3.p1.4.m4.1.1.3.4">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">s_{mtk}</annotation></semantics></math> models the correlation between the <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mi id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><ci id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">m</annotation></semantics></math>-th word in question and at <math id="S4.SS3.p1.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS3.p1.6.m6.1a"><mi id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><ci id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">t</annotation></semantics></math>-th timestep over the modal <math id="S4.SS3.p1.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.p1.7.m7.1a"><mi id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.1b"><ci id="S4.SS3.p1.7.m7.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.1c">k</annotation></semantics></math> (images or text words). Let <math id="S4.SS3.p1.8.m8.1" class="ltx_Math" alttext="\mathbf{v}_{tk}" display="inline"><semantics id="S4.SS3.p1.8.m8.1a"><msub id="S4.SS3.p1.8.m8.1.1" xref="S4.SS3.p1.8.m8.1.1.cmml"><mi id="S4.SS3.p1.8.m8.1.1.2" xref="S4.SS3.p1.8.m8.1.1.2.cmml">𝐯</mi><mrow id="S4.SS3.p1.8.m8.1.1.3" xref="S4.SS3.p1.8.m8.1.1.3.cmml"><mi id="S4.SS3.p1.8.m8.1.1.3.2" xref="S4.SS3.p1.8.m8.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.8.m8.1.1.3.1" xref="S4.SS3.p1.8.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.8.m8.1.1.3.3" xref="S4.SS3.p1.8.m8.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m8.1b"><apply id="S4.SS3.p1.8.m8.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS3.p1.8.m8.1.1.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2">𝐯</ci><apply id="S4.SS3.p1.8.m8.1.1.3.cmml" xref="S4.SS3.p1.8.m8.1.1.3"><times id="S4.SS3.p1.8.m8.1.1.3.1.cmml" xref="S4.SS3.p1.8.m8.1.1.3.1"></times><ci id="S4.SS3.p1.8.m8.1.1.3.2.cmml" xref="S4.SS3.p1.8.m8.1.1.3.2">𝑡</ci><ci id="S4.SS3.p1.8.m8.1.1.3.3.cmml" xref="S4.SS3.p1.8.m8.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m8.1c">\mathbf{v}_{tk}</annotation></semantics></math> denote the focal context representation <math id="S4.SS3.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{F}_{:tk}" display="inline"><semantics id="S4.SS3.p1.9.m9.1a"><msub id="S4.SS3.p1.9.m9.1.1" xref="S4.SS3.p1.9.m9.1.1.cmml"><mi id="S4.SS3.p1.9.m9.1.1.2" xref="S4.SS3.p1.9.m9.1.1.2.cmml">𝐅</mi><mrow id="S4.SS3.p1.9.m9.1.1.3" xref="S4.SS3.p1.9.m9.1.1.3.cmml"><mi id="S4.SS3.p1.9.m9.1.1.3.2" xref="S4.SS3.p1.9.m9.1.1.3.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.9.m9.1.1.3.1" xref="S4.SS3.p1.9.m9.1.1.3.1.cmml">:</mo><mrow id="S4.SS3.p1.9.m9.1.1.3.3" xref="S4.SS3.p1.9.m9.1.1.3.3.cmml"><mi id="S4.SS3.p1.9.m9.1.1.3.3.2" xref="S4.SS3.p1.9.m9.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.9.m9.1.1.3.3.1" xref="S4.SS3.p1.9.m9.1.1.3.3.1.cmml">​</mo><mi id="S4.SS3.p1.9.m9.1.1.3.3.3" xref="S4.SS3.p1.9.m9.1.1.3.3.3.cmml">k</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m9.1b"><apply id="S4.SS3.p1.9.m9.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1">subscript</csymbol><ci id="S4.SS3.p1.9.m9.1.1.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2">𝐅</ci><apply id="S4.SS3.p1.9.m9.1.1.3.cmml" xref="S4.SS3.p1.9.m9.1.1.3"><ci id="S4.SS3.p1.9.m9.1.1.3.1.cmml" xref="S4.SS3.p1.9.m9.1.1.3.1">:</ci><csymbol cd="latexml" id="S4.SS3.p1.9.m9.1.1.3.2.cmml" xref="S4.SS3.p1.9.m9.1.1.3.2">absent</csymbol><apply id="S4.SS3.p1.9.m9.1.1.3.3.cmml" xref="S4.SS3.p1.9.m9.1.1.3.3"><times id="S4.SS3.p1.9.m9.1.1.3.3.1.cmml" xref="S4.SS3.p1.9.m9.1.1.3.3.1"></times><ci id="S4.SS3.p1.9.m9.1.1.3.3.2.cmml" xref="S4.SS3.p1.9.m9.1.1.3.3.2">𝑡</ci><ci id="S4.SS3.p1.9.m9.1.1.3.3.3.cmml" xref="S4.SS3.p1.9.m9.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m9.1c">\mathbf{F}_{:tk}</annotation></semantics></math> at <math id="S4.SS3.p1.10.m10.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS3.p1.10.m10.1a"><mi id="S4.SS3.p1.10.m10.1.1" xref="S4.SS3.p1.10.m10.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m10.1b"><ci id="S4.SS3.p1.10.m10.1.1.cmml" xref="S4.SS3.p1.10.m10.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m10.1c">t</annotation></semantics></math>-th timestep for visual or text. Each entry <math id="S4.SS3.p1.11.m11.1" class="ltx_Math" alttext="s_{mtk}" display="inline"><semantics id="S4.SS3.p1.11.m11.1a"><msub id="S4.SS3.p1.11.m11.1.1" xref="S4.SS3.p1.11.m11.1.1.cmml"><mi id="S4.SS3.p1.11.m11.1.1.2" xref="S4.SS3.p1.11.m11.1.1.2.cmml">s</mi><mrow id="S4.SS3.p1.11.m11.1.1.3" xref="S4.SS3.p1.11.m11.1.1.3.cmml"><mi id="S4.SS3.p1.11.m11.1.1.3.2" xref="S4.SS3.p1.11.m11.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.11.m11.1.1.3.1" xref="S4.SS3.p1.11.m11.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.11.m11.1.1.3.3" xref="S4.SS3.p1.11.m11.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.11.m11.1.1.3.1a" xref="S4.SS3.p1.11.m11.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p1.11.m11.1.1.3.4" xref="S4.SS3.p1.11.m11.1.1.3.4.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m11.1b"><apply id="S4.SS3.p1.11.m11.1.1.cmml" xref="S4.SS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.11.m11.1.1.1.cmml" xref="S4.SS3.p1.11.m11.1.1">subscript</csymbol><ci id="S4.SS3.p1.11.m11.1.1.2.cmml" xref="S4.SS3.p1.11.m11.1.1.2">𝑠</ci><apply id="S4.SS3.p1.11.m11.1.1.3.cmml" xref="S4.SS3.p1.11.m11.1.1.3"><times id="S4.SS3.p1.11.m11.1.1.3.1.cmml" xref="S4.SS3.p1.11.m11.1.1.3.1"></times><ci id="S4.SS3.p1.11.m11.1.1.3.2.cmml" xref="S4.SS3.p1.11.m11.1.1.3.2">𝑚</ci><ci id="S4.SS3.p1.11.m11.1.1.3.3.cmml" xref="S4.SS3.p1.11.m11.1.1.3.3">𝑡</ci><ci id="S4.SS3.p1.11.m11.1.1.3.4.cmml" xref="S4.SS3.p1.11.m11.1.1.3.4">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.11.m11.1c">s_{mtk}</annotation></semantics></math> in <math id="S4.SS3.p1.12.m12.1" class="ltx_Math" alttext="\mathbf{S}" display="inline"><semantics id="S4.SS3.p1.12.m12.1a"><mi id="S4.SS3.p1.12.m12.1.1" xref="S4.SS3.p1.12.m12.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.12.m12.1b"><ci id="S4.SS3.p1.12.m12.1.1.cmml" xref="S4.SS3.p1.12.m12.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.12.m12.1c">\mathbf{S}</annotation></semantics></math> is calculated by:</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.44" class="ltx_Math" alttext="\begin{split}s_{mtk}&amp;=\kappa(\mathbf{F}_{:tk},\mathbf{Q}_{:m})=\kappa(\mathbf{v}_{tk},\mathbf{q})\\
&amp;=\tanh(\mathbf{w^{\top}_{s}}\mathbf{s}(\mathbf{v}_{tk},\mathbf{q})+\mathbf{b}_{s})\end{split}" display="block"><semantics id="S4.E7.m1.44a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S4.E7.m1.44.44.8" xref="S4.E7.m1.40.40.4.cmml"><mtr id="S4.E7.m1.44.44.8a" xref="S4.E7.m1.40.40.4.cmml"><mtd class="ltx_align_right" columnalign="right" id="S4.E7.m1.44.44.8b" xref="S4.E7.m1.40.40.4.cmml"><msub id="S4.E7.m1.2.2.2.2.2" xref="S4.E7.m1.40.40.4.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml">s</mi><mrow id="S4.E7.m1.2.2.2.2.2.2.1" xref="S4.E7.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.E7.m1.2.2.2.2.2.2.1.2" xref="S4.E7.m1.2.2.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.2.2.2.2.2.2.1.1" xref="S4.E7.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E7.m1.2.2.2.2.2.2.1.3" xref="S4.E7.m1.2.2.2.2.2.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.2.2.2.2.2.2.1.1a" xref="S4.E7.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E7.m1.2.2.2.2.2.2.1.4" xref="S4.E7.m1.2.2.2.2.2.2.1.4.cmml">k</mi></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E7.m1.44.44.8c" xref="S4.E7.m1.40.40.4.cmml"><mrow id="S4.E7.m1.43.43.7.39.22.20" xref="S4.E7.m1.40.40.4.cmml"><mi id="S4.E7.m1.43.43.7.39.22.20.22" xref="S4.E7.m1.40.40.4a.cmml"></mi><mo id="S4.E7.m1.3.3.3.3.1.1" xref="S4.E7.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S4.E7.m1.42.42.6.38.21.19.19" xref="S4.E7.m1.40.40.4.cmml"><mi id="S4.E7.m1.4.4.4.4.2.2" xref="S4.E7.m1.4.4.4.4.2.2.cmml">κ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.42.42.6.38.21.19.19.3" xref="S4.E7.m1.40.40.4a.cmml">​</mo><mrow id="S4.E7.m1.42.42.6.38.21.19.19.2.2" xref="S4.E7.m1.40.40.4.cmml"><mo stretchy="false" id="S4.E7.m1.5.5.5.5.3.3" xref="S4.E7.m1.40.40.4a.cmml">(</mo><msub id="S4.E7.m1.41.41.5.37.20.18.18.1.1.1" xref="S4.E7.m1.40.40.4.cmml"><mi id="S4.E7.m1.6.6.6.6.4.4" xref="S4.E7.m1.6.6.6.6.4.4.cmml">𝐅</mi><mrow id="S4.E7.m1.7.7.7.7.5.5.1" xref="S4.E7.m1.7.7.7.7.5.5.1.cmml"><mi id="S4.E7.m1.7.7.7.7.5.5.1.2" xref="S4.E7.m1.7.7.7.7.5.5.1.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S4.E7.m1.7.7.7.7.5.5.1.1" xref="S4.E7.m1.7.7.7.7.5.5.1.1.cmml">:</mo><mrow id="S4.E7.m1.7.7.7.7.5.5.1.3" xref="S4.E7.m1.7.7.7.7.5.5.1.3.cmml"><mi id="S4.E7.m1.7.7.7.7.5.5.1.3.2" xref="S4.E7.m1.7.7.7.7.5.5.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.7.7.7.7.5.5.1.3.1" xref="S4.E7.m1.7.7.7.7.5.5.1.3.1.cmml">​</mo><mi id="S4.E7.m1.7.7.7.7.5.5.1.3.3" xref="S4.E7.m1.7.7.7.7.5.5.1.3.3.cmml">k</mi></mrow></mrow></msub><mo id="S4.E7.m1.8.8.8.8.6.6" xref="S4.E7.m1.40.40.4a.cmml">,</mo><msub id="S4.E7.m1.42.42.6.38.21.19.19.2.2.2" xref="S4.E7.m1.40.40.4.cmml"><mi id="S4.E7.m1.9.9.9.9.7.7" xref="S4.E7.m1.9.9.9.9.7.7.cmml">𝐐</mi><mrow id="S4.E7.m1.10.10.10.10.8.8.1" xref="S4.E7.m1.10.10.10.10.8.8.1.cmml"><mi id="S4.E7.m1.10.10.10.10.8.8.1.2" xref="S4.E7.m1.10.10.10.10.8.8.1.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S4.E7.m1.10.10.10.10.8.8.1.1" xref="S4.E7.m1.10.10.10.10.8.8.1.1.cmml">:</mo><mi id="S4.E7.m1.10.10.10.10.8.8.1.3" xref="S4.E7.m1.10.10.10.10.8.8.1.3.cmml">m</mi></mrow></msub><mo stretchy="false" id="S4.E7.m1.11.11.11.11.9.9" xref="S4.E7.m1.40.40.4a.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.12.12.12.12.10.10" xref="S4.E7.m1.12.12.12.12.10.10.cmml">=</mo><mrow id="S4.E7.m1.43.43.7.39.22.20.20" xref="S4.E7.m1.40.40.4.cmml"><mi id="S4.E7.m1.13.13.13.13.11.11" xref="S4.E7.m1.13.13.13.13.11.11.cmml">κ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.43.43.7.39.22.20.20.2" xref="S4.E7.m1.40.40.4a.cmml">​</mo><mrow id="S4.E7.m1.43.43.7.39.22.20.20.1.1" xref="S4.E7.m1.40.40.4.cmml"><mo stretchy="false" id="S4.E7.m1.14.14.14.14.12.12" xref="S4.E7.m1.40.40.4a.cmml">(</mo><msub id="S4.E7.m1.43.43.7.39.22.20.20.1.1.1" xref="S4.E7.m1.40.40.4.cmml"><mi id="S4.E7.m1.15.15.15.15.13.13" xref="S4.E7.m1.15.15.15.15.13.13.cmml">𝐯</mi><mrow id="S4.E7.m1.16.16.16.16.14.14.1" xref="S4.E7.m1.16.16.16.16.14.14.1.cmml"><mi id="S4.E7.m1.16.16.16.16.14.14.1.2" xref="S4.E7.m1.16.16.16.16.14.14.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.16.16.16.16.14.14.1.1" xref="S4.E7.m1.16.16.16.16.14.14.1.1.cmml">​</mo><mi id="S4.E7.m1.16.16.16.16.14.14.1.3" xref="S4.E7.m1.16.16.16.16.14.14.1.3.cmml">k</mi></mrow></msub><mo id="S4.E7.m1.17.17.17.17.15.15" xref="S4.E7.m1.40.40.4a.cmml">,</mo><mi id="S4.E7.m1.18.18.18.18.16.16" xref="S4.E7.m1.18.18.18.18.16.16.cmml">𝐪</mi><mo stretchy="false" id="S4.E7.m1.19.19.19.19.17.17" xref="S4.E7.m1.40.40.4a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E7.m1.44.44.8d" xref="S4.E7.m1.40.40.4.cmml"><mtd id="S4.E7.m1.44.44.8e" xref="S4.E7.m1.40.40.4a.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E7.m1.44.44.8f" xref="S4.E7.m1.40.40.4.cmml"><mrow id="S4.E7.m1.44.44.8.40.18.18" xref="S4.E7.m1.40.40.4.cmml"><mi id="S4.E7.m1.44.44.8.40.18.18.19" xref="S4.E7.m1.40.40.4a.cmml"></mi><mo id="S4.E7.m1.20.20.20.1.1.1" xref="S4.E7.m1.20.20.20.1.1.1.cmml">=</mo><mrow id="S4.E7.m1.44.44.8.40.18.18.18.1" xref="S4.E7.m1.40.40.4.cmml"><mi id="S4.E7.m1.21.21.21.2.2.2" xref="S4.E7.m1.21.21.21.2.2.2.cmml">tanh</mi><mo id="S4.E7.m1.44.44.8.40.18.18.18.1a" xref="S4.E7.m1.40.40.4a.cmml">⁡</mo><mrow id="S4.E7.m1.44.44.8.40.18.18.18.1.1" xref="S4.E7.m1.40.40.4.cmml"><mo stretchy="false" id="S4.E7.m1.22.22.22.3.3.3" xref="S4.E7.m1.40.40.4a.cmml">(</mo><mrow id="S4.E7.m1.44.44.8.40.18.18.18.1.1.1" xref="S4.E7.m1.40.40.4.cmml"><mrow id="S4.E7.m1.44.44.8.40.18.18.18.1.1.1.1" xref="S4.E7.m1.40.40.4.cmml"><msubsup id="S4.E7.m1.44.44.8.40.18.18.18.1.1.1.1.3" xref="S4.E7.m1.40.40.4.cmml"><mi id="S4.E7.m1.23.23.23.4.4.4" xref="S4.E7.m1.23.23.23.4.4.4.cmml">𝐰</mi><mi id="S4.E7.m1.25.25.25.6.6.6.1" xref="S4.E7.m1.25.25.25.6.6.6.1.cmml">𝐬</mi><mo id="S4.E7.m1.24.24.24.5.5.5.1" xref="S4.E7.m1.24.24.24.5.5.5.1.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S4.E7.m1.44.44.8.40.18.18.18.1.1.1.1.2" xref="S4.E7.m1.40.40.4a.cmml">​</mo><mi id="S4.E7.m1.26.26.26.7.7.7" xref="S4.E7.m1.26.26.26.7.7.7.cmml">𝐬</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.44.44.8.40.18.18.18.1.1.1.1.2a" xref="S4.E7.m1.40.40.4a.cmml">​</mo><mrow id="S4.E7.m1.44.44.8.40.18.18.18.1.1.1.1.1.1" xref="S4.E7.m1.40.40.4.cmml"><mo stretchy="false" id="S4.E7.m1.27.27.27.8.8.8" xref="S4.E7.m1.40.40.4a.cmml">(</mo><msub id="S4.E7.m1.44.44.8.40.18.18.18.1.1.1.1.1.1.1" xref="S4.E7.m1.40.40.4.cmml"><mi id="S4.E7.m1.28.28.28.9.9.9" xref="S4.E7.m1.28.28.28.9.9.9.cmml">𝐯</mi><mrow id="S4.E7.m1.29.29.29.10.10.10.1" xref="S4.E7.m1.29.29.29.10.10.10.1.cmml"><mi id="S4.E7.m1.29.29.29.10.10.10.1.2" xref="S4.E7.m1.29.29.29.10.10.10.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.29.29.29.10.10.10.1.1" xref="S4.E7.m1.29.29.29.10.10.10.1.1.cmml">​</mo><mi id="S4.E7.m1.29.29.29.10.10.10.1.3" xref="S4.E7.m1.29.29.29.10.10.10.1.3.cmml">k</mi></mrow></msub><mo id="S4.E7.m1.30.30.30.11.11.11" xref="S4.E7.m1.40.40.4a.cmml">,</mo><mi id="S4.E7.m1.31.31.31.12.12.12" xref="S4.E7.m1.31.31.31.12.12.12.cmml">𝐪</mi><mo stretchy="false" id="S4.E7.m1.32.32.32.13.13.13" xref="S4.E7.m1.40.40.4a.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.33.33.33.14.14.14" xref="S4.E7.m1.33.33.33.14.14.14.cmml">+</mo><msub id="S4.E7.m1.44.44.8.40.18.18.18.1.1.1.2" xref="S4.E7.m1.40.40.4.cmml"><mi id="S4.E7.m1.34.34.34.15.15.15" xref="S4.E7.m1.34.34.34.15.15.15.cmml">𝐛</mi><mi id="S4.E7.m1.35.35.35.16.16.16.1" xref="S4.E7.m1.35.35.35.16.16.16.1.cmml">s</mi></msub></mrow><mo stretchy="false" id="S4.E7.m1.36.36.36.17.17.17" xref="S4.E7.m1.40.40.4a.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E7.m1.44b"><apply id="S4.E7.m1.40.40.4.cmml" xref="S4.E7.m1.44.44.8"><and id="S4.E7.m1.40.40.4a.cmml" xref="S4.E7.m1.43.43.7.39.22.20.22"></and><apply id="S4.E7.m1.40.40.4b.cmml" xref="S4.E7.m1.44.44.8"><eq id="S4.E7.m1.3.3.3.3.1.1.cmml" xref="S4.E7.m1.3.3.3.3.1.1"></eq><apply id="S4.E7.m1.40.40.4.6.cmml" xref="S4.E7.m1.44.44.8"><csymbol cd="ambiguous" id="S4.E7.m1.40.40.4.6.1.cmml" xref="S4.E7.m1.43.43.7.39.22.20.22">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1">𝑠</ci><apply id="S4.E7.m1.2.2.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1"><times id="S4.E7.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.1"></times><ci id="S4.E7.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.2">𝑚</ci><ci id="S4.E7.m1.2.2.2.2.2.2.1.3.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.3">𝑡</ci><ci id="S4.E7.m1.2.2.2.2.2.2.1.4.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1.4">𝑘</ci></apply></apply><apply id="S4.E7.m1.38.38.2.2.cmml" xref="S4.E7.m1.44.44.8"><times id="S4.E7.m1.38.38.2.2.3.cmml" xref="S4.E7.m1.43.43.7.39.22.20.22"></times><ci id="S4.E7.m1.4.4.4.4.2.2.cmml" xref="S4.E7.m1.4.4.4.4.2.2">𝜅</ci><interval closure="open" id="S4.E7.m1.38.38.2.2.2.3.cmml" xref="S4.E7.m1.44.44.8"><apply id="S4.E7.m1.37.37.1.1.1.1.1.cmml" xref="S4.E7.m1.44.44.8"><csymbol cd="ambiguous" id="S4.E7.m1.37.37.1.1.1.1.1.1.cmml" xref="S4.E7.m1.44.44.8">subscript</csymbol><ci id="S4.E7.m1.6.6.6.6.4.4.cmml" xref="S4.E7.m1.6.6.6.6.4.4">𝐅</ci><apply id="S4.E7.m1.7.7.7.7.5.5.1.cmml" xref="S4.E7.m1.7.7.7.7.5.5.1"><ci id="S4.E7.m1.7.7.7.7.5.5.1.1.cmml" xref="S4.E7.m1.7.7.7.7.5.5.1.1">:</ci><csymbol cd="latexml" id="S4.E7.m1.7.7.7.7.5.5.1.2.cmml" xref="S4.E7.m1.7.7.7.7.5.5.1.2">absent</csymbol><apply id="S4.E7.m1.7.7.7.7.5.5.1.3.cmml" xref="S4.E7.m1.7.7.7.7.5.5.1.3"><times id="S4.E7.m1.7.7.7.7.5.5.1.3.1.cmml" xref="S4.E7.m1.7.7.7.7.5.5.1.3.1"></times><ci id="S4.E7.m1.7.7.7.7.5.5.1.3.2.cmml" xref="S4.E7.m1.7.7.7.7.5.5.1.3.2">𝑡</ci><ci id="S4.E7.m1.7.7.7.7.5.5.1.3.3.cmml" xref="S4.E7.m1.7.7.7.7.5.5.1.3.3">𝑘</ci></apply></apply></apply><apply id="S4.E7.m1.38.38.2.2.2.2.2.cmml" xref="S4.E7.m1.44.44.8"><csymbol cd="ambiguous" id="S4.E7.m1.38.38.2.2.2.2.2.1.cmml" xref="S4.E7.m1.44.44.8">subscript</csymbol><ci id="S4.E7.m1.9.9.9.9.7.7.cmml" xref="S4.E7.m1.9.9.9.9.7.7">𝐐</ci><apply id="S4.E7.m1.10.10.10.10.8.8.1.cmml" xref="S4.E7.m1.10.10.10.10.8.8.1"><ci id="S4.E7.m1.10.10.10.10.8.8.1.1.cmml" xref="S4.E7.m1.10.10.10.10.8.8.1.1">:</ci><csymbol cd="latexml" id="S4.E7.m1.10.10.10.10.8.8.1.2.cmml" xref="S4.E7.m1.10.10.10.10.8.8.1.2">absent</csymbol><ci id="S4.E7.m1.10.10.10.10.8.8.1.3.cmml" xref="S4.E7.m1.10.10.10.10.8.8.1.3">𝑚</ci></apply></apply></interval></apply></apply><apply id="S4.E7.m1.40.40.4c.cmml" xref="S4.E7.m1.44.44.8"><eq id="S4.E7.m1.12.12.12.12.10.10.cmml" xref="S4.E7.m1.12.12.12.12.10.10"></eq><share href="#S4.E7.m1.38.38.2.2.cmml" id="S4.E7.m1.40.40.4d.cmml" xref="S4.E7.m1.43.43.7.39.22.20.22"></share><apply id="S4.E7.m1.39.39.3.3.cmml" xref="S4.E7.m1.44.44.8"><times id="S4.E7.m1.39.39.3.3.2.cmml" xref="S4.E7.m1.43.43.7.39.22.20.22"></times><ci id="S4.E7.m1.13.13.13.13.11.11.cmml" xref="S4.E7.m1.13.13.13.13.11.11">𝜅</ci><interval closure="open" id="S4.E7.m1.39.39.3.3.1.2.cmml" xref="S4.E7.m1.44.44.8"><apply id="S4.E7.m1.39.39.3.3.1.1.1.cmml" xref="S4.E7.m1.44.44.8"><csymbol cd="ambiguous" id="S4.E7.m1.39.39.3.3.1.1.1.1.cmml" xref="S4.E7.m1.44.44.8">subscript</csymbol><ci id="S4.E7.m1.15.15.15.15.13.13.cmml" xref="S4.E7.m1.15.15.15.15.13.13">𝐯</ci><apply id="S4.E7.m1.16.16.16.16.14.14.1.cmml" xref="S4.E7.m1.16.16.16.16.14.14.1"><times id="S4.E7.m1.16.16.16.16.14.14.1.1.cmml" xref="S4.E7.m1.16.16.16.16.14.14.1.1"></times><ci id="S4.E7.m1.16.16.16.16.14.14.1.2.cmml" xref="S4.E7.m1.16.16.16.16.14.14.1.2">𝑡</ci><ci id="S4.E7.m1.16.16.16.16.14.14.1.3.cmml" xref="S4.E7.m1.16.16.16.16.14.14.1.3">𝑘</ci></apply></apply><ci id="S4.E7.m1.18.18.18.18.16.16.cmml" xref="S4.E7.m1.18.18.18.18.16.16">𝐪</ci></interval></apply></apply><apply id="S4.E7.m1.40.40.4e.cmml" xref="S4.E7.m1.44.44.8"><eq id="S4.E7.m1.20.20.20.1.1.1.cmml" xref="S4.E7.m1.20.20.20.1.1.1"></eq><share href="#S4.E7.m1.39.39.3.3.cmml" id="S4.E7.m1.40.40.4f.cmml" xref="S4.E7.m1.43.43.7.39.22.20.22"></share><apply id="S4.E7.m1.40.40.4.4.2.cmml" xref="S4.E7.m1.44.44.8"><tanh id="S4.E7.m1.21.21.21.2.2.2.cmml" xref="S4.E7.m1.21.21.21.2.2.2"></tanh><apply id="S4.E7.m1.40.40.4.4.1.1.1.cmml" xref="S4.E7.m1.44.44.8"><plus id="S4.E7.m1.33.33.33.14.14.14.cmml" xref="S4.E7.m1.33.33.33.14.14.14"></plus><apply id="S4.E7.m1.40.40.4.4.1.1.1.1.cmml" xref="S4.E7.m1.44.44.8"><times id="S4.E7.m1.40.40.4.4.1.1.1.1.2.cmml" xref="S4.E7.m1.44.44.8"></times><apply id="S4.E7.m1.40.40.4.4.1.1.1.1.3.cmml" xref="S4.E7.m1.44.44.8"><csymbol cd="ambiguous" id="S4.E7.m1.40.40.4.4.1.1.1.1.3.1.cmml" xref="S4.E7.m1.44.44.8">subscript</csymbol><apply id="S4.E7.m1.40.40.4.4.1.1.1.1.3.2.cmml" xref="S4.E7.m1.44.44.8"><csymbol cd="ambiguous" id="S4.E7.m1.40.40.4.4.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.44.44.8">superscript</csymbol><ci id="S4.E7.m1.23.23.23.4.4.4.cmml" xref="S4.E7.m1.23.23.23.4.4.4">𝐰</ci><csymbol cd="latexml" id="S4.E7.m1.24.24.24.5.5.5.1.cmml" xref="S4.E7.m1.24.24.24.5.5.5.1">top</csymbol></apply><ci id="S4.E7.m1.25.25.25.6.6.6.1.cmml" xref="S4.E7.m1.25.25.25.6.6.6.1">𝐬</ci></apply><ci id="S4.E7.m1.26.26.26.7.7.7.cmml" xref="S4.E7.m1.26.26.26.7.7.7">𝐬</ci><interval closure="open" id="S4.E7.m1.40.40.4.4.1.1.1.1.1.2.cmml" xref="S4.E7.m1.44.44.8"><apply id="S4.E7.m1.40.40.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.44.44.8"><csymbol cd="ambiguous" id="S4.E7.m1.40.40.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.44.44.8">subscript</csymbol><ci id="S4.E7.m1.28.28.28.9.9.9.cmml" xref="S4.E7.m1.28.28.28.9.9.9">𝐯</ci><apply id="S4.E7.m1.29.29.29.10.10.10.1.cmml" xref="S4.E7.m1.29.29.29.10.10.10.1"><times id="S4.E7.m1.29.29.29.10.10.10.1.1.cmml" xref="S4.E7.m1.29.29.29.10.10.10.1.1"></times><ci id="S4.E7.m1.29.29.29.10.10.10.1.2.cmml" xref="S4.E7.m1.29.29.29.10.10.10.1.2">𝑡</ci><ci id="S4.E7.m1.29.29.29.10.10.10.1.3.cmml" xref="S4.E7.m1.29.29.29.10.10.10.1.3">𝑘</ci></apply></apply><ci id="S4.E7.m1.31.31.31.12.12.12.cmml" xref="S4.E7.m1.31.31.31.12.12.12">𝐪</ci></interval></apply><apply id="S4.E7.m1.40.40.4.4.1.1.1.3.cmml" xref="S4.E7.m1.44.44.8"><csymbol cd="ambiguous" id="S4.E7.m1.40.40.4.4.1.1.1.3.1.cmml" xref="S4.E7.m1.44.44.8">subscript</csymbol><ci id="S4.E7.m1.34.34.34.15.15.15.cmml" xref="S4.E7.m1.34.34.34.15.15.15">𝐛</ci><ci id="S4.E7.m1.35.35.35.16.16.16.1.cmml" xref="S4.E7.m1.35.35.35.16.16.16.1">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.44c">\begin{split}s_{mtk}&amp;=\kappa(\mathbf{F}_{:tk},\mathbf{Q}_{:m})=\kappa(\mathbf{v}_{tk},\mathbf{q})\\
&amp;=\tanh(\mathbf{w^{\top}_{s}}\mathbf{s}(\mathbf{v}_{tk},\mathbf{q})+\mathbf{b}_{s})\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.21" class="ltx_p">where <math id="S4.SS3.p1.13.m1.1" class="ltx_Math" alttext="\kappa" display="inline"><semantics id="S4.SS3.p1.13.m1.1a"><mi id="S4.SS3.p1.13.m1.1.1" xref="S4.SS3.p1.13.m1.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.13.m1.1b"><ci id="S4.SS3.p1.13.m1.1.1.cmml" xref="S4.SS3.p1.13.m1.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.13.m1.1c">\kappa</annotation></semantics></math> is a function to compute the correlation between question and context, <math id="S4.SS3.p1.14.m2.1" class="ltx_Math" alttext="\mathbf{w}_{s}\in\mathbb{R}^{4d\times 1}" display="inline"><semantics id="S4.SS3.p1.14.m2.1a"><mrow id="S4.SS3.p1.14.m2.1.1" xref="S4.SS3.p1.14.m2.1.1.cmml"><msub id="S4.SS3.p1.14.m2.1.1.2" xref="S4.SS3.p1.14.m2.1.1.2.cmml"><mi id="S4.SS3.p1.14.m2.1.1.2.2" xref="S4.SS3.p1.14.m2.1.1.2.2.cmml">𝐰</mi><mi id="S4.SS3.p1.14.m2.1.1.2.3" xref="S4.SS3.p1.14.m2.1.1.2.3.cmml">s</mi></msub><mo id="S4.SS3.p1.14.m2.1.1.1" xref="S4.SS3.p1.14.m2.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.14.m2.1.1.3" xref="S4.SS3.p1.14.m2.1.1.3.cmml"><mi id="S4.SS3.p1.14.m2.1.1.3.2" xref="S4.SS3.p1.14.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.14.m2.1.1.3.3" xref="S4.SS3.p1.14.m2.1.1.3.3.cmml"><mrow id="S4.SS3.p1.14.m2.1.1.3.3.2" xref="S4.SS3.p1.14.m2.1.1.3.3.2.cmml"><mn id="S4.SS3.p1.14.m2.1.1.3.3.2.2" xref="S4.SS3.p1.14.m2.1.1.3.3.2.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S4.SS3.p1.14.m2.1.1.3.3.2.1" xref="S4.SS3.p1.14.m2.1.1.3.3.2.1.cmml">​</mo><mi id="S4.SS3.p1.14.m2.1.1.3.3.2.3" xref="S4.SS3.p1.14.m2.1.1.3.3.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p1.14.m2.1.1.3.3.1" xref="S4.SS3.p1.14.m2.1.1.3.3.1.cmml">×</mo><mn id="S4.SS3.p1.14.m2.1.1.3.3.3" xref="S4.SS3.p1.14.m2.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.14.m2.1b"><apply id="S4.SS3.p1.14.m2.1.1.cmml" xref="S4.SS3.p1.14.m2.1.1"><in id="S4.SS3.p1.14.m2.1.1.1.cmml" xref="S4.SS3.p1.14.m2.1.1.1"></in><apply id="S4.SS3.p1.14.m2.1.1.2.cmml" xref="S4.SS3.p1.14.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.14.m2.1.1.2.1.cmml" xref="S4.SS3.p1.14.m2.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.14.m2.1.1.2.2.cmml" xref="S4.SS3.p1.14.m2.1.1.2.2">𝐰</ci><ci id="S4.SS3.p1.14.m2.1.1.2.3.cmml" xref="S4.SS3.p1.14.m2.1.1.2.3">𝑠</ci></apply><apply id="S4.SS3.p1.14.m2.1.1.3.cmml" xref="S4.SS3.p1.14.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.14.m2.1.1.3.1.cmml" xref="S4.SS3.p1.14.m2.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.14.m2.1.1.3.2.cmml" xref="S4.SS3.p1.14.m2.1.1.3.2">ℝ</ci><apply id="S4.SS3.p1.14.m2.1.1.3.3.cmml" xref="S4.SS3.p1.14.m2.1.1.3.3"><times id="S4.SS3.p1.14.m2.1.1.3.3.1.cmml" xref="S4.SS3.p1.14.m2.1.1.3.3.1"></times><apply id="S4.SS3.p1.14.m2.1.1.3.3.2.cmml" xref="S4.SS3.p1.14.m2.1.1.3.3.2"><times id="S4.SS3.p1.14.m2.1.1.3.3.2.1.cmml" xref="S4.SS3.p1.14.m2.1.1.3.3.2.1"></times><cn type="integer" id="S4.SS3.p1.14.m2.1.1.3.3.2.2.cmml" xref="S4.SS3.p1.14.m2.1.1.3.3.2.2">4</cn><ci id="S4.SS3.p1.14.m2.1.1.3.3.2.3.cmml" xref="S4.SS3.p1.14.m2.1.1.3.3.2.3">𝑑</ci></apply><cn type="integer" id="S4.SS3.p1.14.m2.1.1.3.3.3.cmml" xref="S4.SS3.p1.14.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.14.m2.1c">\mathbf{w}_{s}\in\mathbb{R}^{4d\times 1}</annotation></semantics></math> is the learned weights and <math id="S4.SS3.p1.15.m3.1" class="ltx_Math" alttext="\mathbf{b}_{s}" display="inline"><semantics id="S4.SS3.p1.15.m3.1a"><msub id="S4.SS3.p1.15.m3.1.1" xref="S4.SS3.p1.15.m3.1.1.cmml"><mi id="S4.SS3.p1.15.m3.1.1.2" xref="S4.SS3.p1.15.m3.1.1.2.cmml">𝐛</mi><mi id="S4.SS3.p1.15.m3.1.1.3" xref="S4.SS3.p1.15.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.15.m3.1b"><apply id="S4.SS3.p1.15.m3.1.1.cmml" xref="S4.SS3.p1.15.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.15.m3.1.1.1.cmml" xref="S4.SS3.p1.15.m3.1.1">subscript</csymbol><ci id="S4.SS3.p1.15.m3.1.1.2.cmml" xref="S4.SS3.p1.15.m3.1.1.2">𝐛</ci><ci id="S4.SS3.p1.15.m3.1.1.3.cmml" xref="S4.SS3.p1.15.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.15.m3.1c">\mathbf{b}_{s}</annotation></semantics></math> is the bias term. <math id="S4.SS3.p1.16.m4.1" class="ltx_Math" alttext="\mathbf{s}" display="inline"><semantics id="S4.SS3.p1.16.m4.1a"><mi id="S4.SS3.p1.16.m4.1.1" xref="S4.SS3.p1.16.m4.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.16.m4.1b"><ci id="S4.SS3.p1.16.m4.1.1.cmml" xref="S4.SS3.p1.16.m4.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.16.m4.1c">\mathbf{s}</annotation></semantics></math> is the mapping defined in (<a href="#S4.E3" title="In 4.1 Similarity between visual and text features ‣ 4 Focal Visual-Text Attention ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
As explained for Eq. (<a href="#S4.E4" title="In 4.2 Intra-sequence temporal dependency ‣ 4 Focal Visual-Text Attention ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), we use such similarity representations since they capture both the cosine similarity and Euclidean distance information.
We obtain the visual-text sequence attention matrix <math id="S4.SS3.p1.17.m5.1" class="ltx_Math" alttext="\mathbf{A}\in\mathbb{R}^{T\times 2}" display="inline"><semantics id="S4.SS3.p1.17.m5.1a"><mrow id="S4.SS3.p1.17.m5.1.1" xref="S4.SS3.p1.17.m5.1.1.cmml"><mi id="S4.SS3.p1.17.m5.1.1.2" xref="S4.SS3.p1.17.m5.1.1.2.cmml">𝐀</mi><mo id="S4.SS3.p1.17.m5.1.1.1" xref="S4.SS3.p1.17.m5.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.17.m5.1.1.3" xref="S4.SS3.p1.17.m5.1.1.3.cmml"><mi id="S4.SS3.p1.17.m5.1.1.3.2" xref="S4.SS3.p1.17.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p1.17.m5.1.1.3.3" xref="S4.SS3.p1.17.m5.1.1.3.3.cmml"><mi id="S4.SS3.p1.17.m5.1.1.3.3.2" xref="S4.SS3.p1.17.m5.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.p1.17.m5.1.1.3.3.1" xref="S4.SS3.p1.17.m5.1.1.3.3.1.cmml">×</mo><mn id="S4.SS3.p1.17.m5.1.1.3.3.3" xref="S4.SS3.p1.17.m5.1.1.3.3.3.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.17.m5.1b"><apply id="S4.SS3.p1.17.m5.1.1.cmml" xref="S4.SS3.p1.17.m5.1.1"><in id="S4.SS3.p1.17.m5.1.1.1.cmml" xref="S4.SS3.p1.17.m5.1.1.1"></in><ci id="S4.SS3.p1.17.m5.1.1.2.cmml" xref="S4.SS3.p1.17.m5.1.1.2">𝐀</ci><apply id="S4.SS3.p1.17.m5.1.1.3.cmml" xref="S4.SS3.p1.17.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.17.m5.1.1.3.1.cmml" xref="S4.SS3.p1.17.m5.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.17.m5.1.1.3.2.cmml" xref="S4.SS3.p1.17.m5.1.1.3.2">ℝ</ci><apply id="S4.SS3.p1.17.m5.1.1.3.3.cmml" xref="S4.SS3.p1.17.m5.1.1.3.3"><times id="S4.SS3.p1.17.m5.1.1.3.3.1.cmml" xref="S4.SS3.p1.17.m5.1.1.3.3.1"></times><ci id="S4.SS3.p1.17.m5.1.1.3.3.2.cmml" xref="S4.SS3.p1.17.m5.1.1.3.3.2">𝑇</ci><cn type="integer" id="S4.SS3.p1.17.m5.1.1.3.3.3.cmml" xref="S4.SS3.p1.17.m5.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.17.m5.1c">\mathbf{A}\in\mathbb{R}^{T\times 2}</annotation></semantics></math> by <math id="S4.SS3.p1.18.m6.1" class="ltx_Math" alttext="\mathbf{A}=softmax(\max_{i=1}^{M}(\mathbf{S}_{i::}))" display="inline"><semantics id="S4.SS3.p1.18.m6.1a"><mrow id="S4.SS3.p1.18.m6.1.1" xref="S4.SS3.p1.18.m6.1.1.cmml"><mi id="S4.SS3.p1.18.m6.1.1.3" xref="S4.SS3.p1.18.m6.1.1.3.cmml">𝐀</mi><mo id="S4.SS3.p1.18.m6.1.1.2" xref="S4.SS3.p1.18.m6.1.1.2.cmml">=</mo><mrow id="S4.SS3.p1.18.m6.1.1.1" xref="S4.SS3.p1.18.m6.1.1.1.cmml"><mi id="S4.SS3.p1.18.m6.1.1.1.3" xref="S4.SS3.p1.18.m6.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.18.m6.1.1.1.2" xref="S4.SS3.p1.18.m6.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.18.m6.1.1.1.4" xref="S4.SS3.p1.18.m6.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.18.m6.1.1.1.2a" xref="S4.SS3.p1.18.m6.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.18.m6.1.1.1.5" xref="S4.SS3.p1.18.m6.1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.18.m6.1.1.1.2b" xref="S4.SS3.p1.18.m6.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.18.m6.1.1.1.6" xref="S4.SS3.p1.18.m6.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.18.m6.1.1.1.2c" xref="S4.SS3.p1.18.m6.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.18.m6.1.1.1.7" xref="S4.SS3.p1.18.m6.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.18.m6.1.1.1.2d" xref="S4.SS3.p1.18.m6.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.18.m6.1.1.1.8" xref="S4.SS3.p1.18.m6.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.18.m6.1.1.1.2e" xref="S4.SS3.p1.18.m6.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.18.m6.1.1.1.9" xref="S4.SS3.p1.18.m6.1.1.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.18.m6.1.1.1.2f" xref="S4.SS3.p1.18.m6.1.1.1.2.cmml">​</mo><mrow id="S4.SS3.p1.18.m6.1.1.1.1.1" xref="S4.SS3.p1.18.m6.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p1.18.m6.1.1.1.1.1.2" xref="S4.SS3.p1.18.m6.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.3.cmml"><msubsup id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.2" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.2.cmml">max</mi><mrow id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.2" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.1" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.3" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.3" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.3.cmml">M</mi></msubsup><mo id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2a" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.2" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.3.cmml">(</mo><msub id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.cmml"><mi id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.2" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.2.cmml">𝐒</mi><mrow id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.cmml"><mi id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.2" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.2.cmml">i</mi><mo lspace="0.278em" rspace="0em" id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.1" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.1.cmml">:</mo><mo id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.3" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.3.cmml">:</mo></mrow></msub><mo stretchy="false" id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.3" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS3.p1.18.m6.1.1.1.1.1.3" xref="S4.SS3.p1.18.m6.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.18.m6.1b"><apply id="S4.SS3.p1.18.m6.1.1.cmml" xref="S4.SS3.p1.18.m6.1.1"><eq id="S4.SS3.p1.18.m6.1.1.2.cmml" xref="S4.SS3.p1.18.m6.1.1.2"></eq><ci id="S4.SS3.p1.18.m6.1.1.3.cmml" xref="S4.SS3.p1.18.m6.1.1.3">𝐀</ci><apply id="S4.SS3.p1.18.m6.1.1.1.cmml" xref="S4.SS3.p1.18.m6.1.1.1"><times id="S4.SS3.p1.18.m6.1.1.1.2.cmml" xref="S4.SS3.p1.18.m6.1.1.1.2"></times><ci id="S4.SS3.p1.18.m6.1.1.1.3.cmml" xref="S4.SS3.p1.18.m6.1.1.1.3">𝑠</ci><ci id="S4.SS3.p1.18.m6.1.1.1.4.cmml" xref="S4.SS3.p1.18.m6.1.1.1.4">𝑜</ci><ci id="S4.SS3.p1.18.m6.1.1.1.5.cmml" xref="S4.SS3.p1.18.m6.1.1.1.5">𝑓</ci><ci id="S4.SS3.p1.18.m6.1.1.1.6.cmml" xref="S4.SS3.p1.18.m6.1.1.1.6">𝑡</ci><ci id="S4.SS3.p1.18.m6.1.1.1.7.cmml" xref="S4.SS3.p1.18.m6.1.1.1.7">𝑚</ci><ci id="S4.SS3.p1.18.m6.1.1.1.8.cmml" xref="S4.SS3.p1.18.m6.1.1.1.8">𝑎</ci><ci id="S4.SS3.p1.18.m6.1.1.1.9.cmml" xref="S4.SS3.p1.18.m6.1.1.1.9">𝑥</ci><apply id="S4.SS3.p1.18.m6.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2"><apply id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1">subscript</csymbol><max id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.2"></max><apply id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3"><eq id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.1.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1">subscript</csymbol><ci id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.2.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.2">𝐒</ci><apply id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3"><ci id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.1.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.1">:</ci><ci id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.2.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.2">𝑖</ci><ci id="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.3.cmml" xref="S4.SS3.p1.18.m6.1.1.1.1.1.1.2.2.1.3.3">:</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.18.m6.1c">\mathbf{A}=softmax(\max_{i=1}^{M}(\mathbf{S}_{i::}))</annotation></semantics></math> and the visual-text attention vector <math id="S4.SS3.p1.19.m7.1" class="ltx_Math" alttext="\mathbf{B}\in\mathbb{R}^{2}" display="inline"><semantics id="S4.SS3.p1.19.m7.1a"><mrow id="S4.SS3.p1.19.m7.1.1" xref="S4.SS3.p1.19.m7.1.1.cmml"><mi id="S4.SS3.p1.19.m7.1.1.2" xref="S4.SS3.p1.19.m7.1.1.2.cmml">𝐁</mi><mo id="S4.SS3.p1.19.m7.1.1.1" xref="S4.SS3.p1.19.m7.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.19.m7.1.1.3" xref="S4.SS3.p1.19.m7.1.1.3.cmml"><mi id="S4.SS3.p1.19.m7.1.1.3.2" xref="S4.SS3.p1.19.m7.1.1.3.2.cmml">ℝ</mi><mn id="S4.SS3.p1.19.m7.1.1.3.3" xref="S4.SS3.p1.19.m7.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.19.m7.1b"><apply id="S4.SS3.p1.19.m7.1.1.cmml" xref="S4.SS3.p1.19.m7.1.1"><in id="S4.SS3.p1.19.m7.1.1.1.cmml" xref="S4.SS3.p1.19.m7.1.1.1"></in><ci id="S4.SS3.p1.19.m7.1.1.2.cmml" xref="S4.SS3.p1.19.m7.1.1.2">𝐁</ci><apply id="S4.SS3.p1.19.m7.1.1.3.cmml" xref="S4.SS3.p1.19.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.19.m7.1.1.3.1.cmml" xref="S4.SS3.p1.19.m7.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.19.m7.1.1.3.2.cmml" xref="S4.SS3.p1.19.m7.1.1.3.2">ℝ</ci><cn type="integer" id="S4.SS3.p1.19.m7.1.1.3.3.cmml" xref="S4.SS3.p1.19.m7.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.19.m7.1c">\mathbf{B}\in\mathbb{R}^{2}</annotation></semantics></math> by <math id="S4.SS3.p1.20.m8.1" class="ltx_Math" alttext="\mathbf{B}=softmax(\max_{i=1}^{T}\max_{j=1}^{M}(\mathbf{S}_{ji:}))" display="inline"><semantics id="S4.SS3.p1.20.m8.1a"><mrow id="S4.SS3.p1.20.m8.1.1" xref="S4.SS3.p1.20.m8.1.1.cmml"><mi id="S4.SS3.p1.20.m8.1.1.3" xref="S4.SS3.p1.20.m8.1.1.3.cmml">𝐁</mi><mo id="S4.SS3.p1.20.m8.1.1.2" xref="S4.SS3.p1.20.m8.1.1.2.cmml">=</mo><mrow id="S4.SS3.p1.20.m8.1.1.1" xref="S4.SS3.p1.20.m8.1.1.1.cmml"><mi id="S4.SS3.p1.20.m8.1.1.1.3" xref="S4.SS3.p1.20.m8.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.20.m8.1.1.1.2" xref="S4.SS3.p1.20.m8.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.20.m8.1.1.1.4" xref="S4.SS3.p1.20.m8.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.20.m8.1.1.1.2a" xref="S4.SS3.p1.20.m8.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.20.m8.1.1.1.5" xref="S4.SS3.p1.20.m8.1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.20.m8.1.1.1.2b" xref="S4.SS3.p1.20.m8.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.20.m8.1.1.1.6" xref="S4.SS3.p1.20.m8.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.20.m8.1.1.1.2c" xref="S4.SS3.p1.20.m8.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.20.m8.1.1.1.7" xref="S4.SS3.p1.20.m8.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.20.m8.1.1.1.2d" xref="S4.SS3.p1.20.m8.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.20.m8.1.1.1.8" xref="S4.SS3.p1.20.m8.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.20.m8.1.1.1.2e" xref="S4.SS3.p1.20.m8.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.20.m8.1.1.1.9" xref="S4.SS3.p1.20.m8.1.1.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.20.m8.1.1.1.2f" xref="S4.SS3.p1.20.m8.1.1.1.2.cmml">​</mo><mrow id="S4.SS3.p1.20.m8.1.1.1.1.1" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p1.20.m8.1.1.1.1.1.2" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.20.m8.1.1.1.1.1.1" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.cmml"><msubsup id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.2" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.2.cmml">max</mi><mrow id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.2" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.2.cmml">i</mi><mo id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.1" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.1.cmml">=</mo><mn id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.3" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.3" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.3.cmml">T</mi></msubsup><mo lspace="0.167em" id="S4.SS3.p1.20.m8.1.1.1.1.1.1a" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.3.cmml"><msubsup id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.2" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.2.cmml">max</mi><mrow id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.3" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></msubsup><mo id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2a" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.2" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.2" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.2.cmml">𝐒</mi><mrow id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.cmml"><mrow id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.cmml"><mi id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.2" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.1" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.1.cmml">​</mo><mi id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.3" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.3.cmml">i</mi></mrow><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.1" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.1.cmml">:</mo><mi id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.3" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.3.cmml"></mi></mrow></msub><mo stretchy="false" id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.3" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.SS3.p1.20.m8.1.1.1.1.1.3" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.20.m8.1b"><apply id="S4.SS3.p1.20.m8.1.1.cmml" xref="S4.SS3.p1.20.m8.1.1"><eq id="S4.SS3.p1.20.m8.1.1.2.cmml" xref="S4.SS3.p1.20.m8.1.1.2"></eq><ci id="S4.SS3.p1.20.m8.1.1.3.cmml" xref="S4.SS3.p1.20.m8.1.1.3">𝐁</ci><apply id="S4.SS3.p1.20.m8.1.1.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1"><times id="S4.SS3.p1.20.m8.1.1.1.2.cmml" xref="S4.SS3.p1.20.m8.1.1.1.2"></times><ci id="S4.SS3.p1.20.m8.1.1.1.3.cmml" xref="S4.SS3.p1.20.m8.1.1.1.3">𝑠</ci><ci id="S4.SS3.p1.20.m8.1.1.1.4.cmml" xref="S4.SS3.p1.20.m8.1.1.1.4">𝑜</ci><ci id="S4.SS3.p1.20.m8.1.1.1.5.cmml" xref="S4.SS3.p1.20.m8.1.1.1.5">𝑓</ci><ci id="S4.SS3.p1.20.m8.1.1.1.6.cmml" xref="S4.SS3.p1.20.m8.1.1.1.6">𝑡</ci><ci id="S4.SS3.p1.20.m8.1.1.1.7.cmml" xref="S4.SS3.p1.20.m8.1.1.1.7">𝑚</ci><ci id="S4.SS3.p1.20.m8.1.1.1.8.cmml" xref="S4.SS3.p1.20.m8.1.1.1.8">𝑎</ci><ci id="S4.SS3.p1.20.m8.1.1.1.9.cmml" xref="S4.SS3.p1.20.m8.1.1.1.9">𝑥</ci><apply id="S4.SS3.p1.20.m8.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1"><apply id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3">subscript</csymbol><max id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.2"></max><apply id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3"><eq id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.1"></eq><ci id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.2">𝑖</ci><cn type="integer" id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.3.3">𝑇</ci></apply><apply id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2"><apply id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1">subscript</csymbol><max id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.2"></max><apply id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3"><eq id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply><apply id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.2">𝐒</ci><apply id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3"><ci id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.1">:</ci><apply id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2"><times id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.1.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.1"></times><ci id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.2.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.2">𝑗</ci><ci id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.3.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.2.3">𝑖</ci></apply><csymbol cd="latexml" id="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.3.cmml" xref="S4.SS3.p1.20.m8.1.1.1.1.1.1.2.2.2.1.3.3">absent</csymbol></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.20.m8.1c">\mathbf{B}=softmax(\max_{i=1}^{T}\max_{j=1}^{M}(\mathbf{S}_{ji:}))</annotation></semantics></math>, where the softmax operation is applied to the first dimension.
The maximum function <math id="S4.SS3.p1.21.m9.1" class="ltx_Math" alttext="\max_{i}" display="inline"><semantics id="S4.SS3.p1.21.m9.1a"><msub id="S4.SS3.p1.21.m9.1.1" xref="S4.SS3.p1.21.m9.1.1.cmml"><mi id="S4.SS3.p1.21.m9.1.1.2" xref="S4.SS3.p1.21.m9.1.1.2.cmml">max</mi><mi id="S4.SS3.p1.21.m9.1.1.3" xref="S4.SS3.p1.21.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.21.m9.1b"><apply id="S4.SS3.p1.21.m9.1.1.cmml" xref="S4.SS3.p1.21.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.21.m9.1.1.1.cmml" xref="S4.SS3.p1.21.m9.1.1">subscript</csymbol><max id="S4.SS3.p1.21.m9.1.1.2.cmml" xref="S4.SS3.p1.21.m9.1.1.2"></max><ci id="S4.SS3.p1.21.m9.1.1.3.cmml" xref="S4.SS3.p1.21.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.21.m9.1c">\max_{i}</annotation></semantics></math> is used reduce the first dimension of the high-dimensional tensor. Then the attended context vector is given by:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.1" class="ltx_Math" alttext="\mathbf{\tilde{h}}=\sum_{k=1}^{2}\mathbf{B}_{k}\sum_{t=1}^{T}\mathbf{A}_{tk}\mathbf{F}_{:tk}\in\mathbb{R}^{2d}" display="block"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><mover accent="true" id="S4.E8.m1.1.1.2" xref="S4.E8.m1.1.1.2.cmml"><mi id="S4.E8.m1.1.1.2.2" xref="S4.E8.m1.1.1.2.2.cmml">𝐡</mi><mo id="S4.E8.m1.1.1.2.1" xref="S4.E8.m1.1.1.2.1.cmml">~</mo></mover><mo rspace="0.111em" id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3.cmml">=</mo><mrow id="S4.E8.m1.1.1.4" xref="S4.E8.m1.1.1.4.cmml"><munderover id="S4.E8.m1.1.1.4.1" xref="S4.E8.m1.1.1.4.1.cmml"><mo movablelimits="false" id="S4.E8.m1.1.1.4.1.2.2" xref="S4.E8.m1.1.1.4.1.2.2.cmml">∑</mo><mrow id="S4.E8.m1.1.1.4.1.2.3" xref="S4.E8.m1.1.1.4.1.2.3.cmml"><mi id="S4.E8.m1.1.1.4.1.2.3.2" xref="S4.E8.m1.1.1.4.1.2.3.2.cmml">k</mi><mo id="S4.E8.m1.1.1.4.1.2.3.1" xref="S4.E8.m1.1.1.4.1.2.3.1.cmml">=</mo><mn id="S4.E8.m1.1.1.4.1.2.3.3" xref="S4.E8.m1.1.1.4.1.2.3.3.cmml">1</mn></mrow><mn id="S4.E8.m1.1.1.4.1.3" xref="S4.E8.m1.1.1.4.1.3.cmml">2</mn></munderover><mrow id="S4.E8.m1.1.1.4.2" xref="S4.E8.m1.1.1.4.2.cmml"><msub id="S4.E8.m1.1.1.4.2.2" xref="S4.E8.m1.1.1.4.2.2.cmml"><mi id="S4.E8.m1.1.1.4.2.2.2" xref="S4.E8.m1.1.1.4.2.2.2.cmml">𝐁</mi><mi id="S4.E8.m1.1.1.4.2.2.3" xref="S4.E8.m1.1.1.4.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.4.2.1" xref="S4.E8.m1.1.1.4.2.1.cmml">​</mo><mrow id="S4.E8.m1.1.1.4.2.3" xref="S4.E8.m1.1.1.4.2.3.cmml"><munderover id="S4.E8.m1.1.1.4.2.3.1" xref="S4.E8.m1.1.1.4.2.3.1.cmml"><mo movablelimits="false" id="S4.E8.m1.1.1.4.2.3.1.2.2" xref="S4.E8.m1.1.1.4.2.3.1.2.2.cmml">∑</mo><mrow id="S4.E8.m1.1.1.4.2.3.1.2.3" xref="S4.E8.m1.1.1.4.2.3.1.2.3.cmml"><mi id="S4.E8.m1.1.1.4.2.3.1.2.3.2" xref="S4.E8.m1.1.1.4.2.3.1.2.3.2.cmml">t</mi><mo id="S4.E8.m1.1.1.4.2.3.1.2.3.1" xref="S4.E8.m1.1.1.4.2.3.1.2.3.1.cmml">=</mo><mn id="S4.E8.m1.1.1.4.2.3.1.2.3.3" xref="S4.E8.m1.1.1.4.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E8.m1.1.1.4.2.3.1.3" xref="S4.E8.m1.1.1.4.2.3.1.3.cmml">T</mi></munderover><mrow id="S4.E8.m1.1.1.4.2.3.2" xref="S4.E8.m1.1.1.4.2.3.2.cmml"><msub id="S4.E8.m1.1.1.4.2.3.2.2" xref="S4.E8.m1.1.1.4.2.3.2.2.cmml"><mi id="S4.E8.m1.1.1.4.2.3.2.2.2" xref="S4.E8.m1.1.1.4.2.3.2.2.2.cmml">𝐀</mi><mrow id="S4.E8.m1.1.1.4.2.3.2.2.3" xref="S4.E8.m1.1.1.4.2.3.2.2.3.cmml"><mi id="S4.E8.m1.1.1.4.2.3.2.2.3.2" xref="S4.E8.m1.1.1.4.2.3.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.4.2.3.2.2.3.1" xref="S4.E8.m1.1.1.4.2.3.2.2.3.1.cmml">​</mo><mi id="S4.E8.m1.1.1.4.2.3.2.2.3.3" xref="S4.E8.m1.1.1.4.2.3.2.2.3.3.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.4.2.3.2.1" xref="S4.E8.m1.1.1.4.2.3.2.1.cmml">​</mo><msub id="S4.E8.m1.1.1.4.2.3.2.3" xref="S4.E8.m1.1.1.4.2.3.2.3.cmml"><mi id="S4.E8.m1.1.1.4.2.3.2.3.2" xref="S4.E8.m1.1.1.4.2.3.2.3.2.cmml">𝐅</mi><mrow id="S4.E8.m1.1.1.4.2.3.2.3.3" xref="S4.E8.m1.1.1.4.2.3.2.3.3.cmml"><mi id="S4.E8.m1.1.1.4.2.3.2.3.3.2" xref="S4.E8.m1.1.1.4.2.3.2.3.3.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S4.E8.m1.1.1.4.2.3.2.3.3.1" xref="S4.E8.m1.1.1.4.2.3.2.3.3.1.cmml">:</mo><mrow id="S4.E8.m1.1.1.4.2.3.2.3.3.3" xref="S4.E8.m1.1.1.4.2.3.2.3.3.3.cmml"><mi id="S4.E8.m1.1.1.4.2.3.2.3.3.3.2" xref="S4.E8.m1.1.1.4.2.3.2.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.4.2.3.2.3.3.3.1" xref="S4.E8.m1.1.1.4.2.3.2.3.3.3.1.cmml">​</mo><mi id="S4.E8.m1.1.1.4.2.3.2.3.3.3.3" xref="S4.E8.m1.1.1.4.2.3.2.3.3.3.3.cmml">k</mi></mrow></mrow></msub></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.1.1.5" xref="S4.E8.m1.1.1.5.cmml">∈</mo><msup id="S4.E8.m1.1.1.6" xref="S4.E8.m1.1.1.6.cmml"><mi id="S4.E8.m1.1.1.6.2" xref="S4.E8.m1.1.1.6.2.cmml">ℝ</mi><mrow id="S4.E8.m1.1.1.6.3" xref="S4.E8.m1.1.1.6.3.cmml"><mn id="S4.E8.m1.1.1.6.3.2" xref="S4.E8.m1.1.1.6.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.6.3.1" xref="S4.E8.m1.1.1.6.3.1.cmml">​</mo><mi id="S4.E8.m1.1.1.6.3.3" xref="S4.E8.m1.1.1.6.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><and id="S4.E8.m1.1.1a.cmml" xref="S4.E8.m1.1.1"></and><apply id="S4.E8.m1.1.1b.cmml" xref="S4.E8.m1.1.1"><eq id="S4.E8.m1.1.1.3.cmml" xref="S4.E8.m1.1.1.3"></eq><apply id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1.2"><ci id="S4.E8.m1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.2.1">~</ci><ci id="S4.E8.m1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.2.2">𝐡</ci></apply><apply id="S4.E8.m1.1.1.4.cmml" xref="S4.E8.m1.1.1.4"><apply id="S4.E8.m1.1.1.4.1.cmml" xref="S4.E8.m1.1.1.4.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.4.1.1.cmml" xref="S4.E8.m1.1.1.4.1">superscript</csymbol><apply id="S4.E8.m1.1.1.4.1.2.cmml" xref="S4.E8.m1.1.1.4.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.4.1.2.1.cmml" xref="S4.E8.m1.1.1.4.1">subscript</csymbol><sum id="S4.E8.m1.1.1.4.1.2.2.cmml" xref="S4.E8.m1.1.1.4.1.2.2"></sum><apply id="S4.E8.m1.1.1.4.1.2.3.cmml" xref="S4.E8.m1.1.1.4.1.2.3"><eq id="S4.E8.m1.1.1.4.1.2.3.1.cmml" xref="S4.E8.m1.1.1.4.1.2.3.1"></eq><ci id="S4.E8.m1.1.1.4.1.2.3.2.cmml" xref="S4.E8.m1.1.1.4.1.2.3.2">𝑘</ci><cn type="integer" id="S4.E8.m1.1.1.4.1.2.3.3.cmml" xref="S4.E8.m1.1.1.4.1.2.3.3">1</cn></apply></apply><cn type="integer" id="S4.E8.m1.1.1.4.1.3.cmml" xref="S4.E8.m1.1.1.4.1.3">2</cn></apply><apply id="S4.E8.m1.1.1.4.2.cmml" xref="S4.E8.m1.1.1.4.2"><times id="S4.E8.m1.1.1.4.2.1.cmml" xref="S4.E8.m1.1.1.4.2.1"></times><apply id="S4.E8.m1.1.1.4.2.2.cmml" xref="S4.E8.m1.1.1.4.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.4.2.2.1.cmml" xref="S4.E8.m1.1.1.4.2.2">subscript</csymbol><ci id="S4.E8.m1.1.1.4.2.2.2.cmml" xref="S4.E8.m1.1.1.4.2.2.2">𝐁</ci><ci id="S4.E8.m1.1.1.4.2.2.3.cmml" xref="S4.E8.m1.1.1.4.2.2.3">𝑘</ci></apply><apply id="S4.E8.m1.1.1.4.2.3.cmml" xref="S4.E8.m1.1.1.4.2.3"><apply id="S4.E8.m1.1.1.4.2.3.1.cmml" xref="S4.E8.m1.1.1.4.2.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.4.2.3.1.1.cmml" xref="S4.E8.m1.1.1.4.2.3.1">superscript</csymbol><apply id="S4.E8.m1.1.1.4.2.3.1.2.cmml" xref="S4.E8.m1.1.1.4.2.3.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.4.2.3.1.2.1.cmml" xref="S4.E8.m1.1.1.4.2.3.1">subscript</csymbol><sum id="S4.E8.m1.1.1.4.2.3.1.2.2.cmml" xref="S4.E8.m1.1.1.4.2.3.1.2.2"></sum><apply id="S4.E8.m1.1.1.4.2.3.1.2.3.cmml" xref="S4.E8.m1.1.1.4.2.3.1.2.3"><eq id="S4.E8.m1.1.1.4.2.3.1.2.3.1.cmml" xref="S4.E8.m1.1.1.4.2.3.1.2.3.1"></eq><ci id="S4.E8.m1.1.1.4.2.3.1.2.3.2.cmml" xref="S4.E8.m1.1.1.4.2.3.1.2.3.2">𝑡</ci><cn type="integer" id="S4.E8.m1.1.1.4.2.3.1.2.3.3.cmml" xref="S4.E8.m1.1.1.4.2.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E8.m1.1.1.4.2.3.1.3.cmml" xref="S4.E8.m1.1.1.4.2.3.1.3">𝑇</ci></apply><apply id="S4.E8.m1.1.1.4.2.3.2.cmml" xref="S4.E8.m1.1.1.4.2.3.2"><times id="S4.E8.m1.1.1.4.2.3.2.1.cmml" xref="S4.E8.m1.1.1.4.2.3.2.1"></times><apply id="S4.E8.m1.1.1.4.2.3.2.2.cmml" xref="S4.E8.m1.1.1.4.2.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.4.2.3.2.2.1.cmml" xref="S4.E8.m1.1.1.4.2.3.2.2">subscript</csymbol><ci id="S4.E8.m1.1.1.4.2.3.2.2.2.cmml" xref="S4.E8.m1.1.1.4.2.3.2.2.2">𝐀</ci><apply id="S4.E8.m1.1.1.4.2.3.2.2.3.cmml" xref="S4.E8.m1.1.1.4.2.3.2.2.3"><times id="S4.E8.m1.1.1.4.2.3.2.2.3.1.cmml" xref="S4.E8.m1.1.1.4.2.3.2.2.3.1"></times><ci id="S4.E8.m1.1.1.4.2.3.2.2.3.2.cmml" xref="S4.E8.m1.1.1.4.2.3.2.2.3.2">𝑡</ci><ci id="S4.E8.m1.1.1.4.2.3.2.2.3.3.cmml" xref="S4.E8.m1.1.1.4.2.3.2.2.3.3">𝑘</ci></apply></apply><apply id="S4.E8.m1.1.1.4.2.3.2.3.cmml" xref="S4.E8.m1.1.1.4.2.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.4.2.3.2.3.1.cmml" xref="S4.E8.m1.1.1.4.2.3.2.3">subscript</csymbol><ci id="S4.E8.m1.1.1.4.2.3.2.3.2.cmml" xref="S4.E8.m1.1.1.4.2.3.2.3.2">𝐅</ci><apply id="S4.E8.m1.1.1.4.2.3.2.3.3.cmml" xref="S4.E8.m1.1.1.4.2.3.2.3.3"><ci id="S4.E8.m1.1.1.4.2.3.2.3.3.1.cmml" xref="S4.E8.m1.1.1.4.2.3.2.3.3.1">:</ci><csymbol cd="latexml" id="S4.E8.m1.1.1.4.2.3.2.3.3.2.cmml" xref="S4.E8.m1.1.1.4.2.3.2.3.3.2">absent</csymbol><apply id="S4.E8.m1.1.1.4.2.3.2.3.3.3.cmml" xref="S4.E8.m1.1.1.4.2.3.2.3.3.3"><times id="S4.E8.m1.1.1.4.2.3.2.3.3.3.1.cmml" xref="S4.E8.m1.1.1.4.2.3.2.3.3.3.1"></times><ci id="S4.E8.m1.1.1.4.2.3.2.3.3.3.2.cmml" xref="S4.E8.m1.1.1.4.2.3.2.3.3.3.2">𝑡</ci><ci id="S4.E8.m1.1.1.4.2.3.2.3.3.3.3.cmml" xref="S4.E8.m1.1.1.4.2.3.2.3.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply><apply id="S4.E8.m1.1.1c.cmml" xref="S4.E8.m1.1.1"><in id="S4.E8.m1.1.1.5.cmml" xref="S4.E8.m1.1.1.5"></in><share href="#S4.E8.m1.1.1.4.cmml" id="S4.E8.m1.1.1d.cmml" xref="S4.E8.m1.1.1"></share><apply id="S4.E8.m1.1.1.6.cmml" xref="S4.E8.m1.1.1.6"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.6.1.cmml" xref="S4.E8.m1.1.1.6">superscript</csymbol><ci id="S4.E8.m1.1.1.6.2.cmml" xref="S4.E8.m1.1.1.6.2">ℝ</ci><apply id="S4.E8.m1.1.1.6.3.cmml" xref="S4.E8.m1.1.1.6.3"><times id="S4.E8.m1.1.1.6.3.1.cmml" xref="S4.E8.m1.1.1.6.3.1"></times><cn type="integer" id="S4.E8.m1.1.1.6.3.2.cmml" xref="S4.E8.m1.1.1.6.3.2">2</cn><ci id="S4.E8.m1.1.1.6.3.3.cmml" xref="S4.E8.m1.1.1.6.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\mathbf{\tilde{h}}=\sum_{k=1}^{2}\mathbf{B}_{k}\sum_{t=1}^{T}\mathbf{A}_{tk}\mathbf{F}_{:tk}\in\mathbb{R}^{2d}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.23" class="ltx_p">The visual-text attention is computed based on the correlation between question and the focal context attention, which aligns with our observation that questions often provide constrains of a limited time window for the answers.
Similarly, we compute the question attention <math id="S4.SS3.p1.22.m1.1" class="ltx_Math" alttext="\mathbf{D}\in\mathbb{R}^{M}" display="inline"><semantics id="S4.SS3.p1.22.m1.1a"><mrow id="S4.SS3.p1.22.m1.1.1" xref="S4.SS3.p1.22.m1.1.1.cmml"><mi id="S4.SS3.p1.22.m1.1.1.2" xref="S4.SS3.p1.22.m1.1.1.2.cmml">𝐃</mi><mo id="S4.SS3.p1.22.m1.1.1.1" xref="S4.SS3.p1.22.m1.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.22.m1.1.1.3" xref="S4.SS3.p1.22.m1.1.1.3.cmml"><mi id="S4.SS3.p1.22.m1.1.1.3.2" xref="S4.SS3.p1.22.m1.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS3.p1.22.m1.1.1.3.3" xref="S4.SS3.p1.22.m1.1.1.3.3.cmml">M</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.22.m1.1b"><apply id="S4.SS3.p1.22.m1.1.1.cmml" xref="S4.SS3.p1.22.m1.1.1"><in id="S4.SS3.p1.22.m1.1.1.1.cmml" xref="S4.SS3.p1.22.m1.1.1.1"></in><ci id="S4.SS3.p1.22.m1.1.1.2.cmml" xref="S4.SS3.p1.22.m1.1.1.2">𝐃</ci><apply id="S4.SS3.p1.22.m1.1.1.3.cmml" xref="S4.SS3.p1.22.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.22.m1.1.1.3.1.cmml" xref="S4.SS3.p1.22.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.22.m1.1.1.3.2.cmml" xref="S4.SS3.p1.22.m1.1.1.3.2">ℝ</ci><ci id="S4.SS3.p1.22.m1.1.1.3.3.cmml" xref="S4.SS3.p1.22.m1.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.22.m1.1c">\mathbf{D}\in\mathbb{R}^{M}</annotation></semantics></math> by <math id="S4.SS3.p1.23.m2.1" class="ltx_Math" alttext="\mathbf{D}=softmax(\max_{i=1}^{T}\max_{j=1}^{2}(\mathbf{S}_{:ij}))" display="inline"><semantics id="S4.SS3.p1.23.m2.1a"><mrow id="S4.SS3.p1.23.m2.1.1" xref="S4.SS3.p1.23.m2.1.1.cmml"><mi id="S4.SS3.p1.23.m2.1.1.3" xref="S4.SS3.p1.23.m2.1.1.3.cmml">𝐃</mi><mo id="S4.SS3.p1.23.m2.1.1.2" xref="S4.SS3.p1.23.m2.1.1.2.cmml">=</mo><mrow id="S4.SS3.p1.23.m2.1.1.1" xref="S4.SS3.p1.23.m2.1.1.1.cmml"><mi id="S4.SS3.p1.23.m2.1.1.1.3" xref="S4.SS3.p1.23.m2.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.23.m2.1.1.1.2" xref="S4.SS3.p1.23.m2.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.23.m2.1.1.1.4" xref="S4.SS3.p1.23.m2.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.23.m2.1.1.1.2a" xref="S4.SS3.p1.23.m2.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.23.m2.1.1.1.5" xref="S4.SS3.p1.23.m2.1.1.1.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.23.m2.1.1.1.2b" xref="S4.SS3.p1.23.m2.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.23.m2.1.1.1.6" xref="S4.SS3.p1.23.m2.1.1.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.23.m2.1.1.1.2c" xref="S4.SS3.p1.23.m2.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.23.m2.1.1.1.7" xref="S4.SS3.p1.23.m2.1.1.1.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.23.m2.1.1.1.2d" xref="S4.SS3.p1.23.m2.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.23.m2.1.1.1.8" xref="S4.SS3.p1.23.m2.1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.23.m2.1.1.1.2e" xref="S4.SS3.p1.23.m2.1.1.1.2.cmml">​</mo><mi id="S4.SS3.p1.23.m2.1.1.1.9" xref="S4.SS3.p1.23.m2.1.1.1.9.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.23.m2.1.1.1.2f" xref="S4.SS3.p1.23.m2.1.1.1.2.cmml">​</mo><mrow id="S4.SS3.p1.23.m2.1.1.1.1.1" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p1.23.m2.1.1.1.1.1.2" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.23.m2.1.1.1.1.1.1" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.cmml"><msubsup id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.2" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.2.cmml">max</mi><mrow id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.2" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.2.cmml">i</mi><mo id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.1" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.1.cmml">=</mo><mn id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.3" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.3" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.3.cmml">T</mi></msubsup><mo lspace="0.167em" id="S4.SS3.p1.23.m2.1.1.1.1.1.1a" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.3.cmml"><msubsup id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.2" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">max</mi><mrow id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mn id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.3" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2a" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.2" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.2" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.2.cmml">𝐒</mi><mrow id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.cmml"><mi id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.2" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.1" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.1.cmml">:</mo><mrow id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.cmml"><mi id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.2" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.1" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.1.cmml">​</mo><mi id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.3" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.3.cmml">j</mi></mrow></mrow></msub><mo stretchy="false" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.3" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.SS3.p1.23.m2.1.1.1.1.1.3" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.23.m2.1b"><apply id="S4.SS3.p1.23.m2.1.1.cmml" xref="S4.SS3.p1.23.m2.1.1"><eq id="S4.SS3.p1.23.m2.1.1.2.cmml" xref="S4.SS3.p1.23.m2.1.1.2"></eq><ci id="S4.SS3.p1.23.m2.1.1.3.cmml" xref="S4.SS3.p1.23.m2.1.1.3">𝐃</ci><apply id="S4.SS3.p1.23.m2.1.1.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1"><times id="S4.SS3.p1.23.m2.1.1.1.2.cmml" xref="S4.SS3.p1.23.m2.1.1.1.2"></times><ci id="S4.SS3.p1.23.m2.1.1.1.3.cmml" xref="S4.SS3.p1.23.m2.1.1.1.3">𝑠</ci><ci id="S4.SS3.p1.23.m2.1.1.1.4.cmml" xref="S4.SS3.p1.23.m2.1.1.1.4">𝑜</ci><ci id="S4.SS3.p1.23.m2.1.1.1.5.cmml" xref="S4.SS3.p1.23.m2.1.1.1.5">𝑓</ci><ci id="S4.SS3.p1.23.m2.1.1.1.6.cmml" xref="S4.SS3.p1.23.m2.1.1.1.6">𝑡</ci><ci id="S4.SS3.p1.23.m2.1.1.1.7.cmml" xref="S4.SS3.p1.23.m2.1.1.1.7">𝑚</ci><ci id="S4.SS3.p1.23.m2.1.1.1.8.cmml" xref="S4.SS3.p1.23.m2.1.1.1.8">𝑎</ci><ci id="S4.SS3.p1.23.m2.1.1.1.9.cmml" xref="S4.SS3.p1.23.m2.1.1.1.9">𝑥</ci><apply id="S4.SS3.p1.23.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1"><apply id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3">subscript</csymbol><max id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.2"></max><apply id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3"><eq id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.1"></eq><ci id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.2">𝑖</ci><cn type="integer" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.3.3">𝑇</ci></apply><apply id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2"><apply id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><max id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.2"></max><apply id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3"><eq id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn type="integer" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><cn type="integer" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.2">𝐒</ci><apply id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3"><ci id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.1">:</ci><csymbol cd="latexml" id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.2.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.2">absent</csymbol><apply id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3"><times id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.1.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.1"></times><ci id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.2.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.2">𝑖</ci><ci id="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.3.cmml" xref="S4.SS3.p1.23.m2.1.1.1.1.1.1.2.2.2.1.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.23.m2.1c">\mathbf{D}=softmax(\max_{i=1}^{T}\max_{j=1}^{2}(\mathbf{S}_{:ij}))</annotation></semantics></math> and the summarized question vector is given by:</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.1" class="ltx_Math" alttext="\mathbf{\tilde{q}}=\sum_{m=1}^{M}\mathbf{D}_{m}\mathbf{Q}_{:m}\in\mathbb{R}^{2d}" display="block"><semantics id="S4.E9.m1.1a"><mrow id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml"><mover accent="true" id="S4.E9.m1.1.1.2" xref="S4.E9.m1.1.1.2.cmml"><mi id="S4.E9.m1.1.1.2.2" xref="S4.E9.m1.1.1.2.2.cmml">𝐪</mi><mo id="S4.E9.m1.1.1.2.1" xref="S4.E9.m1.1.1.2.1.cmml">~</mo></mover><mo rspace="0.111em" id="S4.E9.m1.1.1.3" xref="S4.E9.m1.1.1.3.cmml">=</mo><mrow id="S4.E9.m1.1.1.4" xref="S4.E9.m1.1.1.4.cmml"><munderover id="S4.E9.m1.1.1.4.1" xref="S4.E9.m1.1.1.4.1.cmml"><mo movablelimits="false" id="S4.E9.m1.1.1.4.1.2.2" xref="S4.E9.m1.1.1.4.1.2.2.cmml">∑</mo><mrow id="S4.E9.m1.1.1.4.1.2.3" xref="S4.E9.m1.1.1.4.1.2.3.cmml"><mi id="S4.E9.m1.1.1.4.1.2.3.2" xref="S4.E9.m1.1.1.4.1.2.3.2.cmml">m</mi><mo id="S4.E9.m1.1.1.4.1.2.3.1" xref="S4.E9.m1.1.1.4.1.2.3.1.cmml">=</mo><mn id="S4.E9.m1.1.1.4.1.2.3.3" xref="S4.E9.m1.1.1.4.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.1.1.4.1.3" xref="S4.E9.m1.1.1.4.1.3.cmml">M</mi></munderover><mrow id="S4.E9.m1.1.1.4.2" xref="S4.E9.m1.1.1.4.2.cmml"><msub id="S4.E9.m1.1.1.4.2.2" xref="S4.E9.m1.1.1.4.2.2.cmml"><mi id="S4.E9.m1.1.1.4.2.2.2" xref="S4.E9.m1.1.1.4.2.2.2.cmml">𝐃</mi><mi id="S4.E9.m1.1.1.4.2.2.3" xref="S4.E9.m1.1.1.4.2.2.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.4.2.1" xref="S4.E9.m1.1.1.4.2.1.cmml">​</mo><msub id="S4.E9.m1.1.1.4.2.3" xref="S4.E9.m1.1.1.4.2.3.cmml"><mi id="S4.E9.m1.1.1.4.2.3.2" xref="S4.E9.m1.1.1.4.2.3.2.cmml">𝐐</mi><mrow id="S4.E9.m1.1.1.4.2.3.3" xref="S4.E9.m1.1.1.4.2.3.3.cmml"><mi id="S4.E9.m1.1.1.4.2.3.3.2" xref="S4.E9.m1.1.1.4.2.3.3.2.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S4.E9.m1.1.1.4.2.3.3.1" xref="S4.E9.m1.1.1.4.2.3.3.1.cmml">:</mo><mi id="S4.E9.m1.1.1.4.2.3.3.3" xref="S4.E9.m1.1.1.4.2.3.3.3.cmml">m</mi></mrow></msub></mrow></mrow><mo id="S4.E9.m1.1.1.5" xref="S4.E9.m1.1.1.5.cmml">∈</mo><msup id="S4.E9.m1.1.1.6" xref="S4.E9.m1.1.1.6.cmml"><mi id="S4.E9.m1.1.1.6.2" xref="S4.E9.m1.1.1.6.2.cmml">ℝ</mi><mrow id="S4.E9.m1.1.1.6.3" xref="S4.E9.m1.1.1.6.3.cmml"><mn id="S4.E9.m1.1.1.6.3.2" xref="S4.E9.m1.1.1.6.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.6.3.1" xref="S4.E9.m1.1.1.6.3.1.cmml">​</mo><mi id="S4.E9.m1.1.1.6.3.3" xref="S4.E9.m1.1.1.6.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1"><and id="S4.E9.m1.1.1a.cmml" xref="S4.E9.m1.1.1"></and><apply id="S4.E9.m1.1.1b.cmml" xref="S4.E9.m1.1.1"><eq id="S4.E9.m1.1.1.3.cmml" xref="S4.E9.m1.1.1.3"></eq><apply id="S4.E9.m1.1.1.2.cmml" xref="S4.E9.m1.1.1.2"><ci id="S4.E9.m1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.2.1">~</ci><ci id="S4.E9.m1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.2.2">𝐪</ci></apply><apply id="S4.E9.m1.1.1.4.cmml" xref="S4.E9.m1.1.1.4"><apply id="S4.E9.m1.1.1.4.1.cmml" xref="S4.E9.m1.1.1.4.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.4.1.1.cmml" xref="S4.E9.m1.1.1.4.1">superscript</csymbol><apply id="S4.E9.m1.1.1.4.1.2.cmml" xref="S4.E9.m1.1.1.4.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.4.1.2.1.cmml" xref="S4.E9.m1.1.1.4.1">subscript</csymbol><sum id="S4.E9.m1.1.1.4.1.2.2.cmml" xref="S4.E9.m1.1.1.4.1.2.2"></sum><apply id="S4.E9.m1.1.1.4.1.2.3.cmml" xref="S4.E9.m1.1.1.4.1.2.3"><eq id="S4.E9.m1.1.1.4.1.2.3.1.cmml" xref="S4.E9.m1.1.1.4.1.2.3.1"></eq><ci id="S4.E9.m1.1.1.4.1.2.3.2.cmml" xref="S4.E9.m1.1.1.4.1.2.3.2">𝑚</ci><cn type="integer" id="S4.E9.m1.1.1.4.1.2.3.3.cmml" xref="S4.E9.m1.1.1.4.1.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.1.1.4.1.3.cmml" xref="S4.E9.m1.1.1.4.1.3">𝑀</ci></apply><apply id="S4.E9.m1.1.1.4.2.cmml" xref="S4.E9.m1.1.1.4.2"><times id="S4.E9.m1.1.1.4.2.1.cmml" xref="S4.E9.m1.1.1.4.2.1"></times><apply id="S4.E9.m1.1.1.4.2.2.cmml" xref="S4.E9.m1.1.1.4.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.4.2.2.1.cmml" xref="S4.E9.m1.1.1.4.2.2">subscript</csymbol><ci id="S4.E9.m1.1.1.4.2.2.2.cmml" xref="S4.E9.m1.1.1.4.2.2.2">𝐃</ci><ci id="S4.E9.m1.1.1.4.2.2.3.cmml" xref="S4.E9.m1.1.1.4.2.2.3">𝑚</ci></apply><apply id="S4.E9.m1.1.1.4.2.3.cmml" xref="S4.E9.m1.1.1.4.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.4.2.3.1.cmml" xref="S4.E9.m1.1.1.4.2.3">subscript</csymbol><ci id="S4.E9.m1.1.1.4.2.3.2.cmml" xref="S4.E9.m1.1.1.4.2.3.2">𝐐</ci><apply id="S4.E9.m1.1.1.4.2.3.3.cmml" xref="S4.E9.m1.1.1.4.2.3.3"><ci id="S4.E9.m1.1.1.4.2.3.3.1.cmml" xref="S4.E9.m1.1.1.4.2.3.3.1">:</ci><csymbol cd="latexml" id="S4.E9.m1.1.1.4.2.3.3.2.cmml" xref="S4.E9.m1.1.1.4.2.3.3.2">absent</csymbol><ci id="S4.E9.m1.1.1.4.2.3.3.3.cmml" xref="S4.E9.m1.1.1.4.2.3.3.3">𝑚</ci></apply></apply></apply></apply></apply><apply id="S4.E9.m1.1.1c.cmml" xref="S4.E9.m1.1.1"><in id="S4.E9.m1.1.1.5.cmml" xref="S4.E9.m1.1.1.5"></in><share href="#S4.E9.m1.1.1.4.cmml" id="S4.E9.m1.1.1d.cmml" xref="S4.E9.m1.1.1"></share><apply id="S4.E9.m1.1.1.6.cmml" xref="S4.E9.m1.1.1.6"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.6.1.cmml" xref="S4.E9.m1.1.1.6">superscript</csymbol><ci id="S4.E9.m1.1.1.6.2.cmml" xref="S4.E9.m1.1.1.6.2">ℝ</ci><apply id="S4.E9.m1.1.1.6.3.cmml" xref="S4.E9.m1.1.1.6.3"><times id="S4.E9.m1.1.1.6.3.1.cmml" xref="S4.E9.m1.1.1.6.3.1"></times><cn type="integer" id="S4.E9.m1.1.1.6.3.2.cmml" xref="S4.E9.m1.1.1.6.3.2">2</cn><ci id="S4.E9.m1.1.1.6.3.3.cmml" xref="S4.E9.m1.1.1.6.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">\mathbf{\tilde{q}}=\sum_{m=1}^{M}\mathbf{D}_{m}\mathbf{Q}_{:m}\in\mathbb{R}^{2d}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.24" class="ltx_p">Algorithm <a href="#algorithm1" title="In 4.3 Cross Sequence Interaction ‣ 4 Focal Visual-Text Attention ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the steps to compute the proposed FVTA attention. To obtain a final context representation, we first summarize the focal context representation separately for visual sequence and text sequence, emphasizing the most important information using the intra-sequence attention. Then, we obtain the final representation by summing the sequence vector representation based on the inter-sequence importance. Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.2 Intra-sequence temporal dependency ‣ 4 Focal Visual-Text Attention ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the difference between FVT attention tensor and one-dimensional soft attention vector. Both mechanisms compute the attention but FVTA considers both visual-text intra-sequence correlations and cross sequence interaction.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.13" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.2.2" class="ltx_listingline">


<span id="algorithm1.2.2.1" class="ltx_text ltx_font_bold">input :</span> Input visual-text sequence <math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{X}" display="inline"><semantics id="algorithm1.1.1.m1.1a"><mi id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><ci id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">\mathbf{X}</annotation></semantics></math>, Question <math id="algorithm1.2.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="algorithm1.2.2.m2.1a"><mi id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><ci id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">Q</annotation></semantics></math>
</div>
<div id="algorithm1.3.3" class="ltx_listingline">
<span id="algorithm1.3.3.1" class="ltx_text ltx_font_bold">output :</span> The FVTA vector <math id="algorithm1.3.3.m1.1" class="ltx_Math" alttext="\mathbf{\tilde{h}}" display="inline"><semantics id="algorithm1.3.3.m1.1a"><mover accent="true" id="algorithm1.3.3.m1.1.1" xref="algorithm1.3.3.m1.1.1.cmml"><mi id="algorithm1.3.3.m1.1.1.2" xref="algorithm1.3.3.m1.1.1.2.cmml">𝐡</mi><mo id="algorithm1.3.3.m1.1.1.1" xref="algorithm1.3.3.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m1.1b"><apply id="algorithm1.3.3.m1.1.1.cmml" xref="algorithm1.3.3.m1.1.1"><ci id="algorithm1.3.3.m1.1.1.1.cmml" xref="algorithm1.3.3.m1.1.1.1">~</ci><ci id="algorithm1.3.3.m1.1.1.2.cmml" xref="algorithm1.3.3.m1.1.1.2">𝐡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m1.1c">\mathbf{\tilde{h}}</annotation></semantics></math>
</div>
<div id="algorithm1.5.5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
Encode <math id="algorithm1.4.4.m1.1" class="ltx_Math" alttext="\mathbf{X}" display="inline"><semantics id="algorithm1.4.4.m1.1a"><mi id="algorithm1.4.4.m1.1.1" xref="algorithm1.4.4.m1.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m1.1b"><ci id="algorithm1.4.4.m1.1.1.cmml" xref="algorithm1.4.4.m1.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m1.1c">\mathbf{X}</annotation></semantics></math> into <math id="algorithm1.5.5.m2.1" class="ltx_Math" alttext="\mathbf{H}" display="inline"><semantics id="algorithm1.5.5.m2.1a"><mi id="algorithm1.5.5.m2.1.1" xref="algorithm1.5.5.m2.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m2.1b"><ci id="algorithm1.5.5.m2.1.1.cmml" xref="algorithm1.5.5.m2.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m2.1c">\mathbf{H}</annotation></semantics></math> by the visual-text embedding and sequence encoder in Sec. <a href="#S3.SS2" title="3.2 Network Architecture ‣ 3 Approach ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>;
</div>
<div id="algorithm1.6.6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>
Encode Q into <math id="algorithm1.6.6.m1.1" class="ltx_Math" alttext="\mathbf{Q}" display="inline"><semantics id="algorithm1.6.6.m1.1a"><mi id="algorithm1.6.6.m1.1.1" xref="algorithm1.6.6.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.1b"><ci id="algorithm1.6.6.m1.1.1.cmml" xref="algorithm1.6.6.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.1c">\mathbf{Q}</annotation></semantics></math> by the question encoder;
</div>
<div id="algorithm1.7.7" class="ltx_listingline">
Compute <math id="algorithm1.7.7.m1.1" class="ltx_Math" alttext="\mathbf{C}" display="inline"><semantics id="algorithm1.7.7.m1.1a"><mi id="algorithm1.7.7.m1.1.1" xref="algorithm1.7.7.m1.1.1.cmml">𝐂</mi><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m1.1b"><ci id="algorithm1.7.7.m1.1.1.cmml" xref="algorithm1.7.7.m1.1.1">𝐂</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.1c">\mathbf{C}</annotation></semantics></math> by Eq. (<a href="#S4.E4" title="In 4.2 Intra-sequence temporal dependency ‣ 4 Focal Visual-Text Attention ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) <span id="algorithm1.7.7.1" class="ltx_text ltx_font_typewriter" style="font-size:70%;">// </span><span id="algorithm1.7.7.2" class="ltx_text ltx_font_typewriter" style="font-size:70%;">temporal correlation </span>
</div>
<div id="algorithm1.8.8" class="ltx_listingline">
<span id="algorithm1.8.8.1" class="ltx_text">
Compute <math id="algorithm1.8.8.1.m1.1" class="ltx_Math" alttext="\mathbf{F}" display="inline"><semantics id="algorithm1.8.8.1.m1.1a"><mi id="algorithm1.8.8.1.m1.1.1" xref="algorithm1.8.8.1.m1.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.1.m1.1b"><ci id="algorithm1.8.8.1.m1.1.1.cmml" xref="algorithm1.8.8.1.m1.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.1.m1.1c">\mathbf{F}</annotation></semantics></math> by Eq. (<a href="#S4.E5" title="In 4.2 Intra-sequence temporal dependency ‣ 4 Focal Visual-Text Attention ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) <span id="algorithm1.8.8.1.1" class="ltx_text ltx_font_typewriter" style="font-size:70%;">// </span></span><span id="algorithm1.8.8.2" class="ltx_text ltx_font_typewriter" style="font-size:70%;">intra-sequence dependency </span>
</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span id="algorithm1.9.9.1" class="ltx_text">
Compute <math id="algorithm1.9.9.1.m1.1" class="ltx_Math" alttext="\mathbf{S}" display="inline"><semantics id="algorithm1.9.9.1.m1.1a"><mi id="algorithm1.9.9.1.m1.1.1" xref="algorithm1.9.9.1.m1.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.1.m1.1b"><ci id="algorithm1.9.9.1.m1.1.1.cmml" xref="algorithm1.9.9.1.m1.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.1.m1.1c">\mathbf{S}</annotation></semantics></math> by Eq. (<a href="#S4.E7" title="In 4.3 Cross Sequence Interaction ‣ 4 Focal Visual-Text Attention ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) <span id="algorithm1.9.9.1.1" class="ltx_text ltx_font_typewriter" style="font-size:70%;">// </span></span><span id="algorithm1.9.9.2" class="ltx_text ltx_font_typewriter" style="font-size:70%;">cross-sequence interaction </span>
</div>
<div id="algorithm1.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span><span id="algorithm1.12.12.3" class="ltx_text">
Reduce <math id="algorithm1.10.10.1.m1.1" class="ltx_Math" alttext="\mathbf{F}" display="inline"><semantics id="algorithm1.10.10.1.m1.1a"><mi id="algorithm1.10.10.1.m1.1.1" xref="algorithm1.10.10.1.m1.1.1.cmml">𝐅</mi><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.1.m1.1b"><ci id="algorithm1.10.10.1.m1.1.1.cmml" xref="algorithm1.10.10.1.m1.1.1">𝐅</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.1.m1.1c">\mathbf{F}</annotation></semantics></math> with <math id="algorithm1.11.11.2.m2.1" class="ltx_Math" alttext="\mathbf{S}" display="inline"><semantics id="algorithm1.11.11.2.m2.1a"><mi id="algorithm1.11.11.2.m2.1.1" xref="algorithm1.11.11.2.m2.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.2.m2.1b"><ci id="algorithm1.11.11.2.m2.1.1.cmml" xref="algorithm1.11.11.2.m2.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.2.m2.1c">\mathbf{S}</annotation></semantics></math> to the FVTA <math id="algorithm1.12.12.3.m3.1" class="ltx_Math" alttext="\mathbf{\tilde{h}}" display="inline"><semantics id="algorithm1.12.12.3.m3.1a"><mover accent="true" id="algorithm1.12.12.3.m3.1.1" xref="algorithm1.12.12.3.m3.1.1.cmml"><mi id="algorithm1.12.12.3.m3.1.1.2" xref="algorithm1.12.12.3.m3.1.1.2.cmml">𝐡</mi><mo id="algorithm1.12.12.3.m3.1.1.1" xref="algorithm1.12.12.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.3.m3.1b"><apply id="algorithm1.12.12.3.m3.1.1.cmml" xref="algorithm1.12.12.3.m3.1.1"><ci id="algorithm1.12.12.3.m3.1.1.1.cmml" xref="algorithm1.12.12.3.m3.1.1.1">~</ci><ci id="algorithm1.12.12.3.m3.1.1.2.cmml" xref="algorithm1.12.12.3.m3.1.1.2">𝐡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.3.m3.1c">\mathbf{\tilde{h}}</annotation></semantics></math> by Eq. (<a href="#S4.E8" title="In 4.3 Cross Sequence Interaction ‣ 4 Focal Visual-Text Attention ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>);</span>
</div>
<div id="algorithm1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>
<span id="algorithm1.13.13.1" class="ltx_text ltx_font_bold">return</span> <math id="algorithm1.13.13.m1.1" class="ltx_Math" alttext="\mathbf{\tilde{h}}" display="inline"><semantics id="algorithm1.13.13.m1.1a"><mover accent="true" id="algorithm1.13.13.m1.1.1" xref="algorithm1.13.13.m1.1.1.cmml"><mi id="algorithm1.13.13.m1.1.1.2" xref="algorithm1.13.13.m1.1.1.2.cmml">𝐡</mi><mo id="algorithm1.13.13.m1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><apply id="algorithm1.13.13.m1.1.1.cmml" xref="algorithm1.13.13.m1.1.1"><ci id="algorithm1.13.13.m1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1">~</ci><ci id="algorithm1.13.13.m1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.2">𝐡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">\mathbf{\tilde{h}}</annotation></semantics></math>;
</div>
<div id="algorithm1.13.14" class="ltx_listingline">

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.16.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="algorithm1.17.2" class="ltx_text" style="font-size:90%;">Computation of Focal Visual-Text Attention.</span></figcaption>
</figure>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_t">Method</th>
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">how many</th>
<th id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">what</th>
<th id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">when</th>
<th id="S4.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">where</th>
<th id="S4.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">who</th>
<th id="S4.T1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">overall</th>
</tr>
<tr id="S4.T1.1.2.2" class="ltx_tr">
<th id="S4.T1.1.2.2.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_rr"></th>
<th id="S4.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">(11.8%)</th>
<th id="S4.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">(41.9%)</th>
<th id="S4.T1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">(16.2%)</th>
<th id="S4.T1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">(17.2%)</th>
<th id="S4.T1.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">(12.9%)</th>
<th id="S4.T1.1.2.2.7" class="ltx_td ltx_th ltx_th_column"></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.3.1" class="ltx_tr">
<th id="S4.T1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_tt">Logistic Regression</th>
<td id="S4.T1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.645</td>
<td id="S4.T1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.241</td>
<td id="S4.T1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.217</td>
<td id="S4.T1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.277</td>
<td id="S4.T1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.260</td>
<td id="S4.T1.1.3.1.7" class="ltx_td ltx_align_center ltx_border_tt">0.295</td>
</tr>
<tr id="S4.T1.1.4.2" class="ltx_tr">
<th id="S4.T1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">Embedding + LSTM</th>
<td id="S4.T1.1.4.2.2" class="ltx_td ltx_align_center ltx_border_r">0.771</td>
<td id="S4.T1.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r">0.564</td>
<td id="S4.T1.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r">0.349</td>
<td id="S4.T1.1.4.2.5" class="ltx_td ltx_align_center ltx_border_r">0.314</td>
<td id="S4.T1.1.4.2.6" class="ltx_td ltx_align_center ltx_border_r">0.310</td>
<td id="S4.T1.1.4.2.7" class="ltx_td ltx_align_center">0.478</td>
</tr>
<tr id="S4.T1.1.5.3" class="ltx_tr">
<th id="S4.T1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">Embedding + LSTM + Concat</th>
<td id="S4.T1.1.5.3.2" class="ltx_td ltx_align_center ltx_border_r">0.776</td>
<td id="S4.T1.1.5.3.3" class="ltx_td ltx_align_center ltx_border_r">0.668</td>
<td id="S4.T1.1.5.3.4" class="ltx_td ltx_align_center ltx_border_r">0.398</td>
<td id="S4.T1.1.5.3.5" class="ltx_td ltx_align_center ltx_border_r">0.433</td>
<td id="S4.T1.1.5.3.6" class="ltx_td ltx_align_center ltx_border_r">0.409</td>
<td id="S4.T1.1.5.3.7" class="ltx_td ltx_align_center">0.563</td>
</tr>
<tr id="S4.T1.1.6.4" class="ltx_tr">
<th id="S4.T1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t">DMN+ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</th>
<td id="S4.T1.1.6.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.792</td>
<td id="S4.T1.1.6.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.616</td>
<td id="S4.T1.1.6.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.346</td>
<td id="S4.T1.1.6.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.248</td>
<td id="S4.T1.1.6.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.224</td>
<td id="S4.T1.1.6.4.7" class="ltx_td ltx_align_center ltx_border_t">0.480</td>
</tr>
<tr id="S4.T1.1.7.5" class="ltx_tr">
<th id="S4.T1.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">Multimodal Compact Bilinear Pooling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>
</th>
<td id="S4.T1.1.7.5.2" class="ltx_td ltx_align_center ltx_border_r">0.773</td>
<td id="S4.T1.1.7.5.3" class="ltx_td ltx_align_center ltx_border_r">0.618</td>
<td id="S4.T1.1.7.5.4" class="ltx_td ltx_align_center ltx_border_r">0.250</td>
<td id="S4.T1.1.7.5.5" class="ltx_td ltx_align_center ltx_border_r">0.229</td>
<td id="S4.T1.1.7.5.6" class="ltx_td ltx_align_center ltx_border_r">0.248</td>
<td id="S4.T1.1.7.5.7" class="ltx_td ltx_align_center">0.462</td>
</tr>
<tr id="S4.T1.1.8.6" class="ltx_tr">
<th id="S4.T1.1.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">Bi-directional Attention Flow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>
</th>
<td id="S4.T1.1.8.6.2" class="ltx_td ltx_align_center ltx_border_r">0.790</td>
<td id="S4.T1.1.8.6.3" class="ltx_td ltx_align_center ltx_border_r">0.689</td>
<td id="S4.T1.1.8.6.4" class="ltx_td ltx_align_center ltx_border_r">0.356</td>
<td id="S4.T1.1.8.6.5" class="ltx_td ltx_align_center ltx_border_r">0.567</td>
<td id="S4.T1.1.8.6.6" class="ltx_td ltx_align_center ltx_border_r">0.468</td>
<td id="S4.T1.1.8.6.7" class="ltx_td ltx_align_center">0.598</td>
</tr>
<tr id="S4.T1.1.9.7" class="ltx_tr">
<th id="S4.T1.1.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">Soft Attention</th>
<td id="S4.T1.1.9.7.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.1.9.7.2.1" class="ltx_text ltx_font_bold">0.795</span></td>
<td id="S4.T1.1.9.7.3" class="ltx_td ltx_align_center ltx_border_r">0.697</td>
<td id="S4.T1.1.9.7.4" class="ltx_td ltx_align_center ltx_border_r">0.346</td>
<td id="S4.T1.1.9.7.5" class="ltx_td ltx_align_center ltx_border_r">0.604</td>
<td id="S4.T1.1.9.7.6" class="ltx_td ltx_align_center ltx_border_r">0.582</td>
<td id="S4.T1.1.9.7.7" class="ltx_td ltx_align_center">0.621</td>
</tr>
<tr id="S4.T1.1.10.8" class="ltx_tr">
<th id="S4.T1.1.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">TGIF Temporal Attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</th>
<td id="S4.T1.1.10.8.2" class="ltx_td ltx_align_center ltx_border_r">0.761</td>
<td id="S4.T1.1.10.8.3" class="ltx_td ltx_align_center ltx_border_r">0.700</td>
<td id="S4.T1.1.10.8.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.1.10.8.4.1" class="ltx_text ltx_font_bold">0.522</span></td>
<td id="S4.T1.1.10.8.5" class="ltx_td ltx_align_center ltx_border_r">0.582</td>
<td id="S4.T1.1.10.8.6" class="ltx_td ltx_align_center ltx_border_r">0.477</td>
<td id="S4.T1.1.10.8.7" class="ltx_td ltx_align_center">0.630</td>
</tr>
<tr id="S4.T1.1.11.9" class="ltx_tr">
<th id="S4.T1.1.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_rr">FVTA</th>
<td id="S4.T1.1.11.9.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0.761</td>
<td id="S4.T1.1.11.9.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.1.11.9.3.1" class="ltx_text ltx_font_bold">0.714</span></td>
<td id="S4.T1.1.11.9.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0.476</td>
<td id="S4.T1.1.11.9.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.1.11.9.5.1" class="ltx_text ltx_font_bold">0.676</span></td>
<td id="S4.T1.1.11.9.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T1.1.11.9.6.1" class="ltx_text ltx_font_bold">0.668</span></td>
<td id="S4.T1.1.11.9.7" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T1.1.11.9.7.1" class="ltx_text ltx_font_bold">0.669</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of different methods on MemexQA by question type. The first three methods do not use the attention mechanism.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>MemexQA</h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.1" class="ltx_p"><span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_bold">Dataset</span>
MemexQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> is a recently proposed visual-text question answering dataset. The dataset consists of 20,860 questions about 13,591 personal photos belonging to 101 real Flickr users. These personal photos capture a variety of key moments of their lives such as a trip to Japan, wedding ceremonies, family parties, etc. Each album and photo come with comprehensive visual-text information, including a timestamp, GPS, a photo title, an album title and description. The metadata is incomplete and GPS, the photo title, the album title and description may not present in every photo.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">MemexQA provides 4 answer choices and only one correct answer for each question. The dataset also provides more than one ground truth grounding images for each question. There are five types of questions corresponding to the frequent search terms discovered in the Flickr search logs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
The input visual-text sequence length varies for questions. Some questions are about images taken on a certain date <em id="S5.SS1.p2.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS1.p2.1.2" class="ltx_text"></span> “what did we do after 2006 Halloween party?”; others are about all images <em id="S5.SS1.p2.1.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS1.p2.1.4" class="ltx_text"></span> “what was the last time we drove to a bar?”.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para ltx_noindent">
<p id="S5.SS1.p3.1" class="ltx_p"><span id="S5.SS1.p3.1.1" class="ltx_text ltx_font_bold">Baseline Methods</span> A large proportion of the existing solutions is to project image or videos into an embedding space, and train a classification model using these embeddings. We implement the following methods as baselines: <span id="S5.SS1.p3.1.2" class="ltx_text ltx_font_bold ltx_font_italic">Logistic Regression</span> predicts the answer with concatenated image, question and metadata features as reported in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. <span id="S5.SS1.p3.1.3" class="ltx_text ltx_font_bold ltx_font_italic">Embedding + LSTM</span> utilizes word embeddings and character embeddings, along with the same visual embeddings used in FVTA. Embeddings are encoded by LSTM and averaged to get the final context representation. <span id="S5.SS1.p3.1.4" class="ltx_text ltx_font_bold ltx_font_italic">Embedding + LSTM + Concat</span> concatenates the last LSTM output from different modalities to produce the final output. On the other hand, we compare the proposed model to a rich collection of VQA attention models: <span id="S5.SS1.p3.1.5" class="ltx_text ltx_font_bold ltx_font_italic">Classic Soft Attention</span> uses classic one dimensional question-to-context attention to summarize context for question answering. A correlation matrix between each question word and context is used to compute the attention as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. <span id="S5.SS1.p3.1.6" class="ltx_text ltx_font_bold ltx_font_italic">DMN+</span> is the improved dynamic memory networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, which is one of the representative architectures that achieve good performance on the VQA Task. We implement the DMN+ network with each sentence and each photo representation used in our proposed network as supporting facts input. <span id="S5.SS1.p3.1.7" class="ltx_text ltx_font_bold ltx_font_italic">Multimodal Compact Bilinear Pooling<cite class="ltx_cite ltx_citemacro_cite"><span id="S5.SS1.p3.1.7.1.1" class="ltx_text ltx_font_medium ltx_font_upright">[</span><a href="#bib.bib5" title="" class="ltx_ref">5</a><span id="S5.SS1.p3.1.7.2.2" class="ltx_text ltx_font_medium ltx_font_upright">]</span></cite></span> is the state-of-the-art method on VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> dataset. The spatial attention in the original model is directly used on the sequential images input. The hyperparameters including the output dimension of MCB and hidden size of LSTM are selected based on the validation results.
<span id="S5.SS1.p3.1.8" class="ltx_text ltx_font_bold ltx_font_italic">Bi-directional Attention Flow</span> implements the single-modal attention flow model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> over all concatenated context representations with embeddings as in FVTA network. <span id="S5.SS1.p3.1.9" class="ltx_text ltx_font_bold ltx_font_italic">TGIF Temporal Attention</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> is a recently proposed spatial-temporal reasoning network on sequential animated image QA. Since other baseline methods do not use spatial attention, we compare the TGIF network with temporal attention only. TGIF temporal attention uses a simple MLP to compute the attention and only the last hidden state of the question is considered. We compute the attention following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and use the same output layer in our method.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para ltx_noindent">
<p id="S5.SS1.p4.8" class="ltx_p"><span id="S5.SS1.p4.8.1" class="ltx_text ltx_font_bold">Implementation Details</span>

In MemexQA dataset, each question is asked to a sequence of photos organized in albums. A photo might have 5 types of textual metadata, including the <span id="S5.SS1.p4.8.2" class="ltx_text ltx_font_italic">album title</span>, <span id="S5.SS1.p4.8.3" class="ltx_text ltx_font_italic">album descriptions</span>, <span id="S5.SS1.p4.8.4" class="ltx_text ltx_font_italic">GPS Locations</span>, <span id="S5.SS1.p4.8.5" class="ltx_text ltx_font_italic">timestamp</span> and a <span id="S5.SS1.p4.8.6" class="ltx_text ltx_font_italic">title</span>. We use <math id="S5.SS1.p4.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S5.SS1.p4.1.m1.1a"><mi id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><ci id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">N</annotation></semantics></math> to denote the maximum number of albums, <math id="S5.SS1.p4.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS1.p4.2.m2.1a"><mi id="S5.SS1.p4.2.m2.1.1" xref="S5.SS1.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.2.m2.1b"><ci id="S5.SS1.p4.2.m2.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.2.m2.1c">K</annotation></semantics></math> for the maximum number of photos in an album and <math id="S5.SS1.p4.3.m3.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S5.SS1.p4.3.m3.1a"><mi id="S5.SS1.p4.3.m3.1.1" xref="S5.SS1.p4.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.3.m3.1b"><ci id="S5.SS1.p4.3.m3.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.3.m3.1c">V</annotation></semantics></math> for the maximum words. For album-level textual sequences like album titles and descriptions, the <math id="S5.SS1.p4.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS1.p4.4.m4.1a"><mi id="S5.SS1.p4.4.m4.1.1" xref="S5.SS1.p4.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.4.m4.1b"><ci id="S5.SS1.p4.4.m4.1.1.cmml" xref="S5.SS1.p4.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.4.m4.1c">K</annotation></semantics></math> dimension only has one item and others are zero-padded. We also use zeros to pad those positions with no word/image.
We encode GPS locations using words.
The photos and their corresponding metadata form the visual-text sequences. All questions, textual context and answers are tokenized using the Stanford word tokenizer. We use pre-trained GloVe word embeddings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, which is fixed during training.
For image/video embedding, we extract fixed-size features using the pre-trained CNN model, Inception-ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, by concatenating the pool5 layer and classification layer’s output before softmax. We then use a linear transformation to compress the image feature into 100 dimensional.
Then a bi-directional LSTM is used for each modality to obtain contextual representations. Given a hidden state size of <math id="S5.SS1.p4.5.m5.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S5.SS1.p4.5.m5.1a"><mi id="S5.SS1.p4.5.m5.1.1" xref="S5.SS1.p4.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.5.m5.1b"><ci id="S5.SS1.p4.5.m5.1.1.cmml" xref="S5.SS1.p4.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.5.m5.1c">d</annotation></semantics></math>, which is set to 50, we concatenate the output of both directions of the LSTM and get a question matrix <math id="S5.SS1.p4.6.m6.1" class="ltx_Math" alttext="\mathbf{Q}\in\mathbb{R}^{2d\times M}" display="inline"><semantics id="S5.SS1.p4.6.m6.1a"><mrow id="S5.SS1.p4.6.m6.1.1" xref="S5.SS1.p4.6.m6.1.1.cmml"><mi id="S5.SS1.p4.6.m6.1.1.2" xref="S5.SS1.p4.6.m6.1.1.2.cmml">𝐐</mi><mo id="S5.SS1.p4.6.m6.1.1.1" xref="S5.SS1.p4.6.m6.1.1.1.cmml">∈</mo><msup id="S5.SS1.p4.6.m6.1.1.3" xref="S5.SS1.p4.6.m6.1.1.3.cmml"><mi id="S5.SS1.p4.6.m6.1.1.3.2" xref="S5.SS1.p4.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S5.SS1.p4.6.m6.1.1.3.3" xref="S5.SS1.p4.6.m6.1.1.3.3.cmml"><mrow id="S5.SS1.p4.6.m6.1.1.3.3.2" xref="S5.SS1.p4.6.m6.1.1.3.3.2.cmml"><mn id="S5.SS1.p4.6.m6.1.1.3.3.2.2" xref="S5.SS1.p4.6.m6.1.1.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S5.SS1.p4.6.m6.1.1.3.3.2.1" xref="S5.SS1.p4.6.m6.1.1.3.3.2.1.cmml">​</mo><mi id="S5.SS1.p4.6.m6.1.1.3.3.2.3" xref="S5.SS1.p4.6.m6.1.1.3.3.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p4.6.m6.1.1.3.3.1" xref="S5.SS1.p4.6.m6.1.1.3.3.1.cmml">×</mo><mi id="S5.SS1.p4.6.m6.1.1.3.3.3" xref="S5.SS1.p4.6.m6.1.1.3.3.3.cmml">M</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.6.m6.1b"><apply id="S5.SS1.p4.6.m6.1.1.cmml" xref="S5.SS1.p4.6.m6.1.1"><in id="S5.SS1.p4.6.m6.1.1.1.cmml" xref="S5.SS1.p4.6.m6.1.1.1"></in><ci id="S5.SS1.p4.6.m6.1.1.2.cmml" xref="S5.SS1.p4.6.m6.1.1.2">𝐐</ci><apply id="S5.SS1.p4.6.m6.1.1.3.cmml" xref="S5.SS1.p4.6.m6.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p4.6.m6.1.1.3.1.cmml" xref="S5.SS1.p4.6.m6.1.1.3">superscript</csymbol><ci id="S5.SS1.p4.6.m6.1.1.3.2.cmml" xref="S5.SS1.p4.6.m6.1.1.3.2">ℝ</ci><apply id="S5.SS1.p4.6.m6.1.1.3.3.cmml" xref="S5.SS1.p4.6.m6.1.1.3.3"><times id="S5.SS1.p4.6.m6.1.1.3.3.1.cmml" xref="S5.SS1.p4.6.m6.1.1.3.3.1"></times><apply id="S5.SS1.p4.6.m6.1.1.3.3.2.cmml" xref="S5.SS1.p4.6.m6.1.1.3.3.2"><times id="S5.SS1.p4.6.m6.1.1.3.3.2.1.cmml" xref="S5.SS1.p4.6.m6.1.1.3.3.2.1"></times><cn type="integer" id="S5.SS1.p4.6.m6.1.1.3.3.2.2.cmml" xref="S5.SS1.p4.6.m6.1.1.3.3.2.2">2</cn><ci id="S5.SS1.p4.6.m6.1.1.3.3.2.3.cmml" xref="S5.SS1.p4.6.m6.1.1.3.3.2.3">𝑑</ci></apply><ci id="S5.SS1.p4.6.m6.1.1.3.3.3.cmml" xref="S5.SS1.p4.6.m6.1.1.3.3.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.6.m6.1c">\mathbf{Q}\in\mathbb{R}^{2d\times M}</annotation></semantics></math>
and context tensor <math id="S5.SS1.p4.7.m7.1" class="ltx_Math" alttext="\mathbf{H}\in\mathbb{R}^{2d\times V\times K\times N\times 6}" display="inline"><semantics id="S5.SS1.p4.7.m7.1a"><mrow id="S5.SS1.p4.7.m7.1.1" xref="S5.SS1.p4.7.m7.1.1.cmml"><mi id="S5.SS1.p4.7.m7.1.1.2" xref="S5.SS1.p4.7.m7.1.1.2.cmml">𝐇</mi><mo id="S5.SS1.p4.7.m7.1.1.1" xref="S5.SS1.p4.7.m7.1.1.1.cmml">∈</mo><msup id="S5.SS1.p4.7.m7.1.1.3" xref="S5.SS1.p4.7.m7.1.1.3.cmml"><mi id="S5.SS1.p4.7.m7.1.1.3.2" xref="S5.SS1.p4.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S5.SS1.p4.7.m7.1.1.3.3" xref="S5.SS1.p4.7.m7.1.1.3.3.cmml"><mrow id="S5.SS1.p4.7.m7.1.1.3.3.2" xref="S5.SS1.p4.7.m7.1.1.3.3.2.cmml"><mn id="S5.SS1.p4.7.m7.1.1.3.3.2.2" xref="S5.SS1.p4.7.m7.1.1.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S5.SS1.p4.7.m7.1.1.3.3.2.1" xref="S5.SS1.p4.7.m7.1.1.3.3.2.1.cmml">​</mo><mi id="S5.SS1.p4.7.m7.1.1.3.3.2.3" xref="S5.SS1.p4.7.m7.1.1.3.3.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p4.7.m7.1.1.3.3.1" xref="S5.SS1.p4.7.m7.1.1.3.3.1.cmml">×</mo><mi id="S5.SS1.p4.7.m7.1.1.3.3.3" xref="S5.SS1.p4.7.m7.1.1.3.3.3.cmml">V</mi><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p4.7.m7.1.1.3.3.1a" xref="S5.SS1.p4.7.m7.1.1.3.3.1.cmml">×</mo><mi id="S5.SS1.p4.7.m7.1.1.3.3.4" xref="S5.SS1.p4.7.m7.1.1.3.3.4.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p4.7.m7.1.1.3.3.1b" xref="S5.SS1.p4.7.m7.1.1.3.3.1.cmml">×</mo><mi id="S5.SS1.p4.7.m7.1.1.3.3.5" xref="S5.SS1.p4.7.m7.1.1.3.3.5.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p4.7.m7.1.1.3.3.1c" xref="S5.SS1.p4.7.m7.1.1.3.3.1.cmml">×</mo><mn id="S5.SS1.p4.7.m7.1.1.3.3.6" xref="S5.SS1.p4.7.m7.1.1.3.3.6.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.7.m7.1b"><apply id="S5.SS1.p4.7.m7.1.1.cmml" xref="S5.SS1.p4.7.m7.1.1"><in id="S5.SS1.p4.7.m7.1.1.1.cmml" xref="S5.SS1.p4.7.m7.1.1.1"></in><ci id="S5.SS1.p4.7.m7.1.1.2.cmml" xref="S5.SS1.p4.7.m7.1.1.2">𝐇</ci><apply id="S5.SS1.p4.7.m7.1.1.3.cmml" xref="S5.SS1.p4.7.m7.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p4.7.m7.1.1.3.1.cmml" xref="S5.SS1.p4.7.m7.1.1.3">superscript</csymbol><ci id="S5.SS1.p4.7.m7.1.1.3.2.cmml" xref="S5.SS1.p4.7.m7.1.1.3.2">ℝ</ci><apply id="S5.SS1.p4.7.m7.1.1.3.3.cmml" xref="S5.SS1.p4.7.m7.1.1.3.3"><times id="S5.SS1.p4.7.m7.1.1.3.3.1.cmml" xref="S5.SS1.p4.7.m7.1.1.3.3.1"></times><apply id="S5.SS1.p4.7.m7.1.1.3.3.2.cmml" xref="S5.SS1.p4.7.m7.1.1.3.3.2"><times id="S5.SS1.p4.7.m7.1.1.3.3.2.1.cmml" xref="S5.SS1.p4.7.m7.1.1.3.3.2.1"></times><cn type="integer" id="S5.SS1.p4.7.m7.1.1.3.3.2.2.cmml" xref="S5.SS1.p4.7.m7.1.1.3.3.2.2">2</cn><ci id="S5.SS1.p4.7.m7.1.1.3.3.2.3.cmml" xref="S5.SS1.p4.7.m7.1.1.3.3.2.3">𝑑</ci></apply><ci id="S5.SS1.p4.7.m7.1.1.3.3.3.cmml" xref="S5.SS1.p4.7.m7.1.1.3.3.3">𝑉</ci><ci id="S5.SS1.p4.7.m7.1.1.3.3.4.cmml" xref="S5.SS1.p4.7.m7.1.1.3.3.4">𝐾</ci><ci id="S5.SS1.p4.7.m7.1.1.3.3.5.cmml" xref="S5.SS1.p4.7.m7.1.1.3.3.5">𝑁</ci><cn type="integer" id="S5.SS1.p4.7.m7.1.1.3.3.6.cmml" xref="S5.SS1.p4.7.m7.1.1.3.3.6">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.7.m7.1c">\mathbf{H}\in\mathbb{R}^{2d\times V\times K\times N\times 6}</annotation></semantics></math> for all media documents.
We reshape the context tensor into <math id="S5.SS1.p4.8.m8.1" class="ltx_Math" alttext="\mathbf{H}\in\mathbb{R}^{2d\times T\times 6}" display="inline"><semantics id="S5.SS1.p4.8.m8.1a"><mrow id="S5.SS1.p4.8.m8.1.1" xref="S5.SS1.p4.8.m8.1.1.cmml"><mi id="S5.SS1.p4.8.m8.1.1.2" xref="S5.SS1.p4.8.m8.1.1.2.cmml">𝐇</mi><mo id="S5.SS1.p4.8.m8.1.1.1" xref="S5.SS1.p4.8.m8.1.1.1.cmml">∈</mo><msup id="S5.SS1.p4.8.m8.1.1.3" xref="S5.SS1.p4.8.m8.1.1.3.cmml"><mi id="S5.SS1.p4.8.m8.1.1.3.2" xref="S5.SS1.p4.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S5.SS1.p4.8.m8.1.1.3.3" xref="S5.SS1.p4.8.m8.1.1.3.3.cmml"><mrow id="S5.SS1.p4.8.m8.1.1.3.3.2" xref="S5.SS1.p4.8.m8.1.1.3.3.2.cmml"><mn id="S5.SS1.p4.8.m8.1.1.3.3.2.2" xref="S5.SS1.p4.8.m8.1.1.3.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S5.SS1.p4.8.m8.1.1.3.3.2.1" xref="S5.SS1.p4.8.m8.1.1.3.3.2.1.cmml">​</mo><mi id="S5.SS1.p4.8.m8.1.1.3.3.2.3" xref="S5.SS1.p4.8.m8.1.1.3.3.2.3.cmml">d</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p4.8.m8.1.1.3.3.1" xref="S5.SS1.p4.8.m8.1.1.3.3.1.cmml">×</mo><mi id="S5.SS1.p4.8.m8.1.1.3.3.3" xref="S5.SS1.p4.8.m8.1.1.3.3.3.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p4.8.m8.1.1.3.3.1a" xref="S5.SS1.p4.8.m8.1.1.3.3.1.cmml">×</mo><mn id="S5.SS1.p4.8.m8.1.1.3.3.4" xref="S5.SS1.p4.8.m8.1.1.3.3.4.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.8.m8.1b"><apply id="S5.SS1.p4.8.m8.1.1.cmml" xref="S5.SS1.p4.8.m8.1.1"><in id="S5.SS1.p4.8.m8.1.1.1.cmml" xref="S5.SS1.p4.8.m8.1.1.1"></in><ci id="S5.SS1.p4.8.m8.1.1.2.cmml" xref="S5.SS1.p4.8.m8.1.1.2">𝐇</ci><apply id="S5.SS1.p4.8.m8.1.1.3.cmml" xref="S5.SS1.p4.8.m8.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p4.8.m8.1.1.3.1.cmml" xref="S5.SS1.p4.8.m8.1.1.3">superscript</csymbol><ci id="S5.SS1.p4.8.m8.1.1.3.2.cmml" xref="S5.SS1.p4.8.m8.1.1.3.2">ℝ</ci><apply id="S5.SS1.p4.8.m8.1.1.3.3.cmml" xref="S5.SS1.p4.8.m8.1.1.3.3"><times id="S5.SS1.p4.8.m8.1.1.3.3.1.cmml" xref="S5.SS1.p4.8.m8.1.1.3.3.1"></times><apply id="S5.SS1.p4.8.m8.1.1.3.3.2.cmml" xref="S5.SS1.p4.8.m8.1.1.3.3.2"><times id="S5.SS1.p4.8.m8.1.1.3.3.2.1.cmml" xref="S5.SS1.p4.8.m8.1.1.3.3.2.1"></times><cn type="integer" id="S5.SS1.p4.8.m8.1.1.3.3.2.2.cmml" xref="S5.SS1.p4.8.m8.1.1.3.3.2.2">2</cn><ci id="S5.SS1.p4.8.m8.1.1.3.3.2.3.cmml" xref="S5.SS1.p4.8.m8.1.1.3.3.2.3">𝑑</ci></apply><ci id="S5.SS1.p4.8.m8.1.1.3.3.3.cmml" xref="S5.SS1.p4.8.m8.1.1.3.3.3">𝑇</ci><cn type="integer" id="S5.SS1.p4.8.m8.1.1.3.3.4.cmml" xref="S5.SS1.p4.8.m8.1.1.3.3.4">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.8.m8.1c">\mathbf{H}\in\mathbb{R}^{2d\times T\times 6}</annotation></semantics></math>.
To select the best hyperparmeters, we randomly select 20% of the official training set as the validation set.
We use the AdaDelta <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> optimizer and an initial learning rate of 0.5 to train for 200 epochs with a dropout rate of 0.3.</p>
</div>
<section id="S5.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Comparison to the state-of-the-art</h4>

<div id="S5.SS1.SSS1.p1" class="ltx_para">
<p id="S5.SS1.SSS1.p1.1" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4.3 Cross Sequence Interaction ‣ 4 Focal Visual-Text Attention ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> compares the accuracy on the MemexQA. As we see, the proposed method consistently outperforms the baseline methods and achieves the state-of-the-art accuracy on this dataset. The first 3 methods in the table show the performance of embedding methods without any attentions. Although embedding methods are relatively simple to implement, their performance is much lower than the proposed FVTA model. The experiment results advocate the attention model among images and image sequences. Compare to previous attention models, our FVTA network significantly outperforms other methods, which proves the efficacy of the proposed method.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.4.5.1" class="ltx_tr">
<th id="S5.T2.4.5.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_t"></th>
<th id="S5.T2.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">HIT@1</th>
<th id="S5.T2.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">HIT@3</th>
<th id="S5.T2.4.5.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">mAP</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.1.1" class="ltx_tr">
<th id="S5.T2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_tt">Soft Attention</th>
<td id="S5.T2.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">1.16%</td>
<td id="S5.T2.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">12.60%</td>
<td id="S5.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">0.168<math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mo id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\pm</annotation></semantics></math>0.002</td>
</tr>
<tr id="S5.T2.2.2" class="ltx_tr">
<th id="S5.T2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">MCB</th>
<td id="S5.T2.2.2.3" class="ltx_td ltx_align_center ltx_border_r">11.98%</td>
<td id="S5.T2.2.2.4" class="ltx_td ltx_align_center ltx_border_r">30.54%</td>
<td id="S5.T2.2.2.1" class="ltx_td ltx_align_center">0.269<math id="S5.T2.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.2.2.1.m1.1a"><mo id="S5.T2.2.2.1.m1.1.1" xref="S5.T2.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.1.m1.1b"><csymbol cd="latexml" id="S5.T2.2.2.1.m1.1.1.cmml" xref="S5.T2.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.1.m1.1c">\pm</annotation></semantics></math>0.005</td>
</tr>
<tr id="S5.T2.3.3" class="ltx_tr">
<th id="S5.T2.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">TGIF Temporal</th>
<td id="S5.T2.3.3.3" class="ltx_td ltx_align_center ltx_border_r">13.28%</td>
<td id="S5.T2.3.3.4" class="ltx_td ltx_align_center ltx_border_r">32.83%</td>
<td id="S5.T2.3.3.1" class="ltx_td ltx_align_center">0.289<math id="S5.T2.3.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.3.3.1.m1.1a"><mo id="S5.T2.3.3.1.m1.1.1" xref="S5.T2.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.1.m1.1b"><csymbol cd="latexml" id="S5.T2.3.3.1.m1.1.1.cmml" xref="S5.T2.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.1.m1.1c">\pm</annotation></semantics></math>0.005</td>
</tr>
<tr id="S5.T2.4.4" class="ltx_tr">
<th id="S5.T2.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_rr">FVTA</th>
<td id="S5.T2.4.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">
<span id="S5.T2.4.4.3.1" class="ltx_text ltx_font_bold">15.48</span>%</td>
<td id="S5.T2.4.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">
<span id="S5.T2.4.4.4.1" class="ltx_text ltx_font_bold">35.66</span>%</td>
<td id="S5.T2.4.4.1" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T2.4.4.1.1" class="ltx_text ltx_font_bold">0.312<math id="S5.T2.4.4.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.4.4.1.1.m1.1a"><mo id="S5.T2.4.4.1.1.m1.1.1" xref="S5.T2.4.4.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.4.4.1.1.m1.1.1.cmml" xref="S5.T2.4.4.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.1.1.m1.1c">\pm</annotation></semantics></math>0.005</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>The quality comparison of the learned FVTA and classic attention. We compare the image of the highest activation in a leaned attention to the ground truth evidence photos which human used to answer the question. HIT@1 means the rate of the top attended images being found in the ground truth evidence photos. AP is computed on the photo ranked by their attention activation.</figcaption>
</figure>
<div id="S5.SS1.SSS1.p2" class="ltx_para">
<p id="S5.SS1.SSS1.p2.1" class="ltx_p">The MemexQA dataset provides ground truth evidence photos for every question. We can compare the correlation between the photos of the highest attention weights and the ground truth photos to correctly answer a question. An ideal VQA model should not only enjoy a high accuracy in answering a question (Table <a href="#S4.T1" title="Table 1 ‣ 4.3 Cross Sequence Interaction ‣ 4 Focal Visual-Text Attention ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) but also can find images that are highly correlated to the ground-truth evidence photos. Table <a href="#S5.T2" title="Table 2 ‣ 5.1.1 Comparison to the state-of-the-art ‣ 5.1 MemexQA ‣ 5 Experiments ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> lists the accuracy to examine whether a model puts focus on the correct photos. FVTA outperforms other attention models on finding the relevant photos for the question. The results show that the proposed attention can capture salient information for answering the question. For qualitative comparison, we select some representative questions and show both the answer and the retrieved top images based on the attention weights in Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.1.2 Ablation Study ‣ 5.1 MemexQA ‣ 5 Experiments ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
As shown in the first example, the system has to find the correct photo and visually identify the object to answer the question ”what did the daughter eat while her dad was watching during the trip in June 2010?”. FVTA attention puts a high weight on the correct photo of the girl eating a corn, which leads to correctly answering the question. Whereas for soft attention, the one-dimensional attention network outputs the wrong image and gets the wrong answer.
This example shows the advantage of FVTA modeling the correlation at every time step, across visual-text sequences over the traditional dimensional attention.</p>
</div>
</section>
<section id="S5.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Ablation Study</h4>

<div id="S5.SS1.SSS2.p1" class="ltx_para">
<p id="S5.SS1.SSS2.p1.1" class="ltx_p">Table <a href="#S5.T3" title="Table 3 ‣ 5.1.2 Ablation Study ‣ 5.1 MemexQA ‣ 5 Experiments ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the performance of FVTA mechanism and its ablations on the MemexQA dataset.
To evaluate the FVTA attention mechanism, we first replace our kernel tensor with simple cosine similarity function. Results show that standard cosine similarity is inferior to our similarity function.
For ablating intra-sequence dependency, we use the representations from the last timestep of each context document. For ablating cross sequence interaction, we average all attended context representation from different modalities to get the final context vector.
Both aspects of correlation of the FVTA attention tensor contribute towards the model’s performance, while intra-sequence dependency shows more importance in this experiment. We compare the effectiveness of context-aware question attention by removing the question attention and use the last timestep of the LSTM output from the question as the question representation. It shows the question attention provides slight improvement. Finally, we train FVTA without photos to see the contribution of visual information. The result is quite good but it is perhaps not surprising due to the language bias in the questions and answers of the dataset, which is not uncommon in VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and in Visual7W <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. This also leaves significant rooms of improvement with visual information.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<table id="S5.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.1.1" class="ltx_tr">
<th id="S5.T3.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_t">Ablations</th>
<th id="S5.T3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Accuracy</th>
<th id="S5.T3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S5.T3.1.1.1.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S5.T3.1.1.1.m1.1a"><mi mathvariant="normal" id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.1c">\Delta</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.1.2.1" class="ltx_tr">
<th id="S5.T3.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_tt">FVTA w/ Cosine Similarity</th>
<td id="S5.T3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.619</td>
<td id="S5.T3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_tt">-4.9%</td>
</tr>
<tr id="S5.T3.1.3.2" class="ltx_tr">
<th id="S5.T3.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">FVTA w/o Intra-seq</th>
<td id="S5.T3.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">0.569</td>
<td id="S5.T3.1.3.2.3" class="ltx_td ltx_align_center">-10.0%</td>
</tr>
<tr id="S5.T3.1.4.3" class="ltx_tr">
<th id="S5.T3.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">FVTA w/o Cross-seq</th>
<td id="S5.T3.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r">0.604</td>
<td id="S5.T3.1.4.3.3" class="ltx_td ltx_align_center">-6.5%</td>
</tr>
<tr id="S5.T3.1.5.4" class="ltx_tr">
<th id="S5.T3.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">FVTA w/o Question Attention</th>
<td id="S5.T3.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r">0.629</td>
<td id="S5.T3.1.5.4.3" class="ltx_td ltx_align_center">-4.0%</td>
</tr>
<tr id="S5.T3.1.6.5" class="ltx_tr">
<th id="S5.T3.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_rr">FVTA w/o Photos</th>
<td id="S5.T3.1.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0.577</td>
<td id="S5.T3.1.6.5.3" class="ltx_td ltx_align_center ltx_border_b">-9.1%</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Ablation studies of the proposed FVTA method on the MemexQA dataset.
The last column shows the performance drop.</figcaption>
</figure>
<figure id="S5.F4" class="ltx_figure"><img src="/html/1806.01873/assets/all4_small_2.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="679" height="346" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>
Qualitative comparison of FVTA model and other attention models on the MemexQA dataset. For each question, we show the answer and the images of the highest attention weights. Images are ranked from left to right based on the attention weights. The correct images and answers have green border whereas the incorrect ones are surrounded by the red border. </figcaption>
</figure>
<figure id="S5.F5" class="ltx_figure"><img src="/html/1806.01873/assets/movieqaQual.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="679" height="169" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>
Qualitative analysis of FVTA on the MovieQA dataset. It shows the visual justification (movie clip frames) and text justification (subtitles) based on the top attention activation. Both justifications provide supporting evidence for the system to get the correct answer.
</figcaption>
</figure>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>MovieQA</h3>

<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.p1.1" class="ltx_p"><span id="S5.SS2.p1.1.1" class="ltx_text ltx_font_bold">Dataset</span>
The MovieQA dataset consists of 140 movies and 6,462 multiple choice QA pair. Each QA pair contains five answer choices with only one correct answer. Systems are required to answer the questions given a number of movie clips from the same movie and the corresponding subtitles.
More details of the dataset can be viewed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.p2.5" class="ltx_p"><span id="S5.SS2.p2.5.1" class="ltx_text ltx_font_bold">Implementation Details</span>

In the MovieQA dataset, each QA is given a set of <math id="S5.SS2.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S5.SS2.p2.1.m1.1a"><mi id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><ci id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">N</annotation></semantics></math> movie clips of the same movie, and each clip comes with subtitles. We implement FVTA network for MovieQA task with modality number of 2 (video &amp; text).
We set the maximum number of movie clips per question to <math id="S5.SS2.p2.2.m2.1" class="ltx_Math" alttext="N=20" display="inline"><semantics id="S5.SS2.p2.2.m2.1a"><mrow id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml"><mi id="S5.SS2.p2.2.m2.1.1.2" xref="S5.SS2.p2.2.m2.1.1.2.cmml">N</mi><mo id="S5.SS2.p2.2.m2.1.1.1" xref="S5.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.p2.2.m2.1.1.3" xref="S5.SS2.p2.2.m2.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><apply id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1"><eq id="S5.SS2.p2.2.m2.1.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1.1"></eq><ci id="S5.SS2.p2.2.m2.1.1.2.cmml" xref="S5.SS2.p2.2.m2.1.1.2">𝑁</ci><cn type="integer" id="S5.SS2.p2.2.m2.1.1.3.cmml" xref="S5.SS2.p2.2.m2.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">N=20</annotation></semantics></math>, the maximum number of frames to consider to <math id="S5.SS2.p2.3.m3.1" class="ltx_Math" alttext="F=10" display="inline"><semantics id="S5.SS2.p2.3.m3.1a"><mrow id="S5.SS2.p2.3.m3.1.1" xref="S5.SS2.p2.3.m3.1.1.cmml"><mi id="S5.SS2.p2.3.m3.1.1.2" xref="S5.SS2.p2.3.m3.1.1.2.cmml">F</mi><mo id="S5.SS2.p2.3.m3.1.1.1" xref="S5.SS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS2.p2.3.m3.1.1.3" xref="S5.SS2.p2.3.m3.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.1b"><apply id="S5.SS2.p2.3.m3.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1"><eq id="S5.SS2.p2.3.m3.1.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1.1"></eq><ci id="S5.SS2.p2.3.m3.1.1.2.cmml" xref="S5.SS2.p2.3.m3.1.1.2">𝐹</ci><cn type="integer" id="S5.SS2.p2.3.m3.1.1.3.cmml" xref="S5.SS2.p2.3.m3.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.1c">F=10</annotation></semantics></math>, the maximum number of subtitle sentences in a clip to <math id="S5.SS2.p2.4.m4.1" class="ltx_Math" alttext="K=100" display="inline"><semantics id="S5.SS2.p2.4.m4.1a"><mrow id="S5.SS2.p2.4.m4.1.1" xref="S5.SS2.p2.4.m4.1.1.cmml"><mi id="S5.SS2.p2.4.m4.1.1.2" xref="S5.SS2.p2.4.m4.1.1.2.cmml">K</mi><mo id="S5.SS2.p2.4.m4.1.1.1" xref="S5.SS2.p2.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS2.p2.4.m4.1.1.3" xref="S5.SS2.p2.4.m4.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.4.m4.1b"><apply id="S5.SS2.p2.4.m4.1.1.cmml" xref="S5.SS2.p2.4.m4.1.1"><eq id="S5.SS2.p2.4.m4.1.1.1.cmml" xref="S5.SS2.p2.4.m4.1.1.1"></eq><ci id="S5.SS2.p2.4.m4.1.1.2.cmml" xref="S5.SS2.p2.4.m4.1.1.2">𝐾</ci><cn type="integer" id="S5.SS2.p2.4.m4.1.1.3.cmml" xref="S5.SS2.p2.4.m4.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.4.m4.1c">K=100</annotation></semantics></math> and the maximum words to <math id="S5.SS2.p2.5.m5.1" class="ltx_Math" alttext="V=10" display="inline"><semantics id="S5.SS2.p2.5.m5.1a"><mrow id="S5.SS2.p2.5.m5.1.1" xref="S5.SS2.p2.5.m5.1.1.cmml"><mi id="S5.SS2.p2.5.m5.1.1.2" xref="S5.SS2.p2.5.m5.1.1.2.cmml">V</mi><mo id="S5.SS2.p2.5.m5.1.1.1" xref="S5.SS2.p2.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS2.p2.5.m5.1.1.3" xref="S5.SS2.p2.5.m5.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.5.m5.1b"><apply id="S5.SS2.p2.5.m5.1.1.cmml" xref="S5.SS2.p2.5.m5.1.1"><eq id="S5.SS2.p2.5.m5.1.1.1.cmml" xref="S5.SS2.p2.5.m5.1.1.1"></eq><ci id="S5.SS2.p2.5.m5.1.1.2.cmml" xref="S5.SS2.p2.5.m5.1.1.2">𝑉</ci><cn type="integer" id="S5.SS2.p2.5.m5.1.1.3.cmml" xref="S5.SS2.p2.5.m5.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.5.m5.1c">V=10</annotation></semantics></math>. Visual and text sequences are encoded the same way as in the MemexQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> experiment.
We use the AdaDelta <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> optimizer with a minibatch of 16 and an initial learning rate of 0.5 to trained for 300 epochs. A dropout rate is set at 0.2 during training.
The official training/validation/test split is used in our experiments.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<table id="S5.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.1.1.1" class="ltx_tr">
<th id="S5.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_t">Method</th>
<th id="S5.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Val</th>
<th id="S5.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Test</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.1.2.1" class="ltx_tr">
<th id="S5.T4.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_tt">SSCB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>
</th>
<td id="S5.T4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.219</td>
<td id="S5.T4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_tt">-</td>
</tr>
<tr id="S5.T4.1.3.2" class="ltx_tr">
<th id="S5.T4.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">MemN2N <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>
</th>
<td id="S5.T4.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">0.342</td>
<td id="S5.T4.1.3.2.3" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S5.T4.1.4.3" class="ltx_tr">
<th id="S5.T4.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">DEMN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</th>
<td id="S5.T4.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S5.T4.1.4.3.3" class="ltx_td ltx_align_center">0.300</td>
</tr>
<tr id="S5.T4.1.5.4" class="ltx_tr">
<th id="S5.T4.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">Soft Attention</th>
<td id="S5.T4.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r">0.321</td>
<td id="S5.T4.1.5.4.3" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S5.T4.1.6.5" class="ltx_tr">
<th id="S5.T4.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">MCB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>
</th>
<td id="S5.T4.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r">0.362</td>
<td id="S5.T4.1.6.5.3" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S5.T4.1.7.6" class="ltx_tr">
<th id="S5.T4.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">TGIF Temporal <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</th>
<td id="S5.T4.1.7.6.2" class="ltx_td ltx_align_center ltx_border_r">0.371</td>
<td id="S5.T4.1.7.6.3" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S5.T4.1.8.7" class="ltx_tr">
<th id="S5.T4.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">RWMN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</th>
<td id="S5.T4.1.8.7.2" class="ltx_td ltx_align_center ltx_border_r">0.387</td>
<td id="S5.T4.1.8.7.3" class="ltx_td ltx_align_center">0.363</td>
</tr>
<tr id="S5.T4.1.9.8" class="ltx_tr">
<th id="S5.T4.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_rr">FVTA</th>
<td id="S5.T4.1.9.8.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S5.T4.1.9.8.2.1" class="ltx_text ltx_font_bold">0.410</span></td>
<td id="S5.T4.1.9.8.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T4.1.9.8.3.1" class="ltx_text ltx_font_bold">0.373</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Accuracy comparison on the test and the validation set of the MovieQA dataset. The test set performance can only be evaluated on the MovieQA server, and thus not all the studies provide the accuracy on Test set.
</figcaption>
</figure>
<div id="S5.SS2.p3" class="ltx_para ltx_noindent">
<p id="S5.SS2.p3.1" class="ltx_p"><span id="S5.SS2.p3.1.1" class="ltx_text ltx_font_bold">Experimental Results</span>
We compare FVTA with recent results on MovieQA dataset, including End-to-End Memory Network (MemN2N) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, Deep Embedded Memory Network (DEMN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, and Read-Write Memory Network (RWMN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.
Table <a href="#S5.T4" title="Table 4 ‣ 5.2 MovieQA ‣ 5 Experiments ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the detailed comparison of MovieQA results using both videos and subtitles. FVTA model outperforms all baseline methods and achieves comparable performance to the state-of-the-art result <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>The best test accuracy on the leaderboard by the time of paper submission (Nov. 2017) is 0.39 (Layered Memory Networks). It is not included in the table as there is no publication to cite.</span></span></span> on the MovieQA test server. Notably, RWMN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> is a very recent work that uses memory net to cache sequential input, with a high capacity and flexibility due to the read and write networks. Our accuracy is 0.410 (vs 0.387 by RWMN) on the validation set and 0.373 (vs 0.363) on the test set. Benefiting from such modeling ability,
FVTA consistently outperforms the classical attention models including soft attention, MCB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> and TGIF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. The result demonstrates the consistent advantages of FVTA over other attention models in question-answering for multiple sequence data.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p">Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.1.2 Ablation Study ‣ 5.1 MemexQA ‣ 5 Experiments ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> illustrates the output of our FVTA model. FVTA can not only predict the correct answer, but also identify the most relevant subtitle description as well as the movie clip frames. As shown in Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.1.2 Ablation Study ‣ 5.1 MemexQA ‣ 5 Experiments ‣ Focal Visual-Text Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, FVTA can provide fine-grained level justifications such as the most informative movie frames or subtitle sentences, whereas most of existing methods cannot find fine-grained justifications from the attention computed at the movie clip level. We believe the results show the benefits and potentials of FVTA model.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions and future work</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we introduced a novel neural network model called Focal Visual-Text Attention network for answering questions over visual-text sequences. FVTA employed a hierarchical process to dynamically determine which modality and snippets to focus on in the sequential data to answer the question, and hence can not only predict the correct answers but also find the correct supporting justifications to help users verify the system’s results.
The comprehensive experimental results demonstrated that FVTA achieves comparable or even better than state-of-the-art results on two major question answering benchmarks of sequential visual-text data. Our future work includes extending FVTA to large scale long visual-text sequences and removing the use of answer choice embeddings as the input.</p>
</div>
<div id="S6.p2" class="ltx_para ltx_noindent">
<p id="S6.p2.1" class="ltx_p"><span id="S6.p2.1.1" class="ltx_text ltx_font_bold">Acknowledgements</span> We would like to thank anonymous reviewers for useful comments and Google Cloud for providing GCP research credits.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
J. Andreas, M. Rohrbach, T. Darrell, and D. Klein.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Learning to compose neural networks for question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1601.01705</span><span id="bib.bib1.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
S. Antol, A. Agrawal, J. Lu, M. Mitchell, D. Batra, C. Lawrence Zitnick, and
D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Vqa: Visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
H. Ben-younes, R. Cadene, M. Cord, and N. Thome.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Mutan: Multimodal tucker fusion for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1705.06676</span><span id="bib.bib3.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
A. Das, H. Agrawal, L. Zitnick, D. Parikh, and D. Batra.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Human attention in visual question answering: Do humans and deep
networks look at the same regions?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision and Image Understanding</span><span id="bib.bib4.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
A. Fukui, D. H. Park, D. Yang, A. Rohrbach, T. Darrell, and M. Rohrbach.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Multimodal compact bilinear pooling for visual question answering and
visual grounding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1606.01847</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
K. M. Hermann, T. Kočiský, E. Grefenstette, L. Espeholt, W. Kay,
M. Suleyman, and P. Blunsom.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Teaching machines to read and comprehend.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Y. Jang, Y. Song, Y. Yu, Y. Kim, and G. Kim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Tgif-qa: Toward spatio-temporal reasoning in visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib7.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
L. Jiang, Y. Kalantidis, L. Cao, S. Farfade, J. Tang, and A. G. Hauptmann.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Delving deep into personal photo and video search.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">WSDM</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
L. Jiang, J. Liang, L. Cao, Y. Kalantidis, S. Farfade, and A. G. Hauptmann.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Memexqa: Visual memex question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv:1708.01336</span><span id="bib.bib9.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
K.-M. Kim, M.-O. Heo, S.-H. Choi, and B.-T. Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Deepstory: video story qa by deep embedded memory networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1707.00836</span><span id="bib.bib10.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Y. Kim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Convolutional neural networks for sentence classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1408.5882</span><span id="bib.bib11.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
R. Krishna, Y. Zhu, O. Groth, J. Johnson, K. Hata, J. Kravitz, S. Chen,
Y. Kalantidis, L.-J. Li, D. A. Shamma, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Visual genome: Connecting language and vision using crowdsourced
dense image annotations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">International Journal of Computer Vision</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">, 123(1):32–73, 2017.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
J. Lu, J. Yang, D. Batra, and D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Hierarchical question-image co-attention for visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
M. Malinowski, M. Rohrbach, and M. Fritz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Ask your neurons: A neural-based approach to answering questions
about images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
S. Na, S. Lee, J. Kim, and G. Kim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">A read-write memory network for movie story understanding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1709.09345</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
H. Nam, J.-W. Ha, and J. Kim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Dual attention networks for multimodal reasoning and matching.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1611.00471</span><span id="bib.bib16.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
H. Noh, P. Hongsuck Seo, and B. Han.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Image question answering using convolutional neural network with
dynamic parameter prediction.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
J. Pennington, R. Socher, and C. D. Manning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Glove: Global vectors for word representation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">EMNLP</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
M. Seo, A. Kembhavi, A. Farhadi, and H. Hajishirzi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Bidirectional attention flow for machine comprehension.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1611.01603</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
K. J. Shih, S. Singh, and D. Hoiem.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Where to look: Focus regions for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
C. Szegedy, S. Ioffe, V. Vanhoucke, and A. A. Alemi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Inception-v4, inception-resnet and the impact of residual connections
on learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AAAI</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
M. Tapaswi, Y. Zhu, R. Stiefelhagen, A. Torralba, R. Urtasun, and S. Fidler.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Movieqa: Understanding stories in movies through question-answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
M. Tapaswi, Y. Zhu, R. Stiefelhagen, A. Torralba, R. Urtasun, and S. Fidler.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Movieqa: Understanding stories in movies through question-answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
S. Wang and J. Jiang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">A compare-aggregate model for matching text sequences.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1611.01747</span><span id="bib.bib24.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
C. Xiong, S. Merity, and R. Socher.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Dynamic memory networks for visual and textual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
H. Xu and K. Saenko.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Ask, attend and answer: Exploring question-guided spatial attention
for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Z. Yang, X. He, J. Gao, L. Deng, and A. Smola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Stacked attention networks for image question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
M. D. Zeiler.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Adadelta: an adaptive learning rate method.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1212.5701</span><span id="bib.bib28.4.2" class="ltx_text" style="font-size:90%;">, 2012.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
K.-H. Zeng, T.-H. Chen, C.-Y. Chuang, Y.-H. Liao, J. C. Niebles, and M. Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Leveraging video descriptions to learn video question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AAAI</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
L. Zhu, Z. Xu, Y. Yang, and A. G. Hauptmann.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Uncovering temporal context for video question and answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1511.04670</span><span id="bib.bib30.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Y. Zhu, O. Groth, M. Bernstein, and L. Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Visual7w: Grounded question answering in images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1806.01872" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1806.01873" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1806.01873">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1806.01873" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1806.01874" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  8 08:36:23 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
