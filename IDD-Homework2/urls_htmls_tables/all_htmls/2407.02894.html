<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation</title>
<!--Generated on Wed Jul  3 07:55:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2407.02894v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S1" title="In Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S2" title="In Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S3" title="In Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Our Model</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S3.SS1" title="In 3 Our Model ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Model Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S3.SS2" title="In 3 Our Model ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Model Training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S4" title="In Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S4.SS1" title="In 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S4.SS2" title="In 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S4.SS3" title="In 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Study</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S4.SS4" title="In 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Case Study</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S4.SS5" title="In 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>The Effectiveness on Alleviating Error Propagation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S4.SS6" title="In 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Evaluation on Other Language Pairs</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S5" title="In 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A1" title="In Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>The effectiveness of the training objective with balancing coefficients</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A2" title="In Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Data Examples</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A3" title="In Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Baseline Architecture Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A4" title="In Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Structure-BLEU</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A5" title="In Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Comparison of BLEU and SSIM</span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Translatotron-V(ison): An End-to-End Model for 
<br class="ltx_break"/>In-Image Machine Translation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Zhibin Lan<sup class="ltx_sup" id="id1.1.id1">1,3</sup>,
Liqiang Niu<sup class="ltx_sup" id="id2.2.id2">2</sup>,
Fandong Meng<sup class="ltx_sup" id="id3.3.id3">2</sup>,
Jie Zhou<sup class="ltx_sup" id="id4.4.id4">2</sup>,
Min Zhang<sup class="ltx_sup" id="id5.5.id5">4</sup>,
Jinsong Su<sup class="ltx_sup" id="id6.6.id6">1,3</sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id7.7.id7">1</sup>School of Informatics, Xiamen University, China
<br class="ltx_break"/><sup class="ltx_sup" id="id8.8.id8">2</sup>Pattern Recognition Center, WeChat AI, Tencent Inc, China
<br class="ltx_break"/><sup class="ltx_sup" id="id9.9.id9">3</sup>Key Laboratory of Digital Protection and Intelligent Processing of Intangible Cultural Heritage 
<br class="ltx_break"/>of Fujian and Taiwan (Xiamen University), Ministry of Culture and Tourism, China
<br class="ltx_break"/><sup class="ltx_sup" id="id10.10.id10">4</sup>Institute of Computer Science and Technology, Soochow University, China
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id11.11.id11">lanzhibin@stu.xmu.edu.cn
</span>  
<span class="ltx_text ltx_font_typewriter" id="id12.12.id12">jssu@xmu.edu.cn
</span>
</span><span class="ltx_author_notes">  Work was done when Zhibin Lan was interning at Pattern Recognition Center, WeChat AI, Tencent Inc, China.  Corresponding author.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id13.id1">In-image machine translation (IIMT) aims to translate an image containing texts in source language into an image containing translations in target language. In this regard,
conventional cascaded methods suffer from issues such as error propagation, massive parameters, and difficulties in deployment and
retaining visual characteristics of the input image.
Thus, constructing end-to-end models has become an option, which, however, faces two main challenges: 1) the huge modeling burden, as it is required to simultaneously learn alignment across languages and preserve the visual characteristics of the input image; 2) the difficulties of directly predicting excessively lengthy pixel sequences.
In this paper, we propose <span class="ltx_text ltx_font_italic" id="id13.id1.1">Translatotron-V(ision)</span>, an end-to-end IIMT model consisting of four modules. In addition to an image encoder, and an image decoder, our model contains a target text decoder and an image tokenizer. Among them, the target text decoder is used to alleviate the language alignment burden, and the image tokenizer converts long sequences of pixels into shorter sequences of visual tokens, preventing the model from focusing on low-level visual features. Besides, we present a two-stage training framework for our model to assist the model in learning alignment across modalities and languages. Finally, we propose a location-aware evaluation metric called Structure-BLEU to assess the translation quality of the generated images. Experimental results demonstrate that our model achieves competitive performance compared to cascaded models with only 70.9% of parameters, and significantly outperforms the pixel-level end-to-end IIMT model.<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Our code and dataset can be found at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/DeepLearnXMU/translatotron-v" title="">https://github.com/DeepLearnXMU/translatotron-v</a>.</span></span></span></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In recent years, significant advancements have been achieved in natural language processing (NLP) and computer vision (CV), largely due to the evolution of deep learning. As a combined direction of these two fields, in-image machine translation (IIMT) aims to covert an image containing texts in source language into another image containing the translations in target language, which has significant research value and practical applications. It not only helps us understand the fusion mechanism of multimodal and multilingual information, but also finds widespread applications in daily life. For instance, IIMT can effortlessly enable foreign travelers to read signs written in other languages.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="199" id="S1.F1.g1" src="extracted/5707577/figures/task_example.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The illustration of two paradigms of IIMT.</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a>, current IIMT systems are divided into two paradigms: cascaded and end-to-end. The first one relies on cascading multiple models, including an optical character recognition (OCR) model, a machine translation (MT) model, and a text-to-image (T2I) model. However, this paradigm suffers from error propagation, massive parameters, and difficulties in deployment and retaining visual characteristics of the input image.
By contrast, end-to-end methods <cite class="ltx_cite ltx_citemacro_cite">Mansimov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib23" title="">2020</a>); Tian et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib31" title="">2023</a>)</cite> integrate different models into one IIMT model and conduct end-to-end training.
Thus, they have potential advantages over cascaded systems in aspects of avoiding error propagation, reduced parameters, and ease of deployment.
Particularly, they are naturally capable of retaining visual characteristics from the input image during translation, e.g. maintaining background, text location, font, etc.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Despite the above advantages, the end-to-end IIMT models still face two major challenges: 1) the huge modeling burden, since they are required to not only learn alignment between two languages but also the visual characteristics of the input image; 2) the difficulties of directly predicting excessively lengthy pixel sequences, which are low-level and involve a large search space <cite class="ltx_cite ltx_citemacro_cite">Ramesh et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib26" title="">2021</a>); Yu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib42" title="">2022b</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To the best of our knowledge, <cite class="ltx_cite ltx_citemacro_cite">Mansimov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib23" title="">2020</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Tian et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib31" title="">2023</a>)</cite> are the only two attempts to explore end-to-end IIMT. However, the former is directly based on pixel prediction, resulting in significantly lower translation quality compared to the cascaded models, while the latter requires converting RGB images to grayscale ones, losing visual characteristics. Besides, both of them can only handle images containing single-line text. These defects make them still far from real-world applications.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In this paper, we propose <span class="ltx_text ltx_font_italic" id="S1.p5.1.1">Translatotron-V(ision)</span>, the first end-to-end IIMT model capable of generating RGB images, achieving comparable performance to cascaded models with only 70.9% of parameters. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a>, our model consists of four modules: 1) an <span class="ltx_text ltx_font_italic" id="S1.p5.1.2">image encoder</span> that represents the semantics of the image as a sequence of visual vectors; 2) a <span class="ltx_text ltx_font_italic" id="S1.p5.1.3">target text decoder</span> that utilizes the visual vector sequence to predict the text translation, which can effectively reduce the modeling burden on the image decoder; 3) an <span class="ltx_text ltx_font_italic" id="S1.p5.1.4">image decoder</span> that generates the visual tokens of the target image based on the visual and linguistic information generated from the image encoder and target text decoder, respectively; 4) an <span class="ltx_text ltx_font_italic" id="S1.p5.1.5">image tokenizer</span> that converts the image into discrete visual tokens and can reconstruct the image from these visual tokens. By converting the image into visual tokens, the image decoder only needs to predict visual tokens, rather than excessively lengthy pixel sequences, which allows the model to avoid spending too much capacity capturing low-level visual features.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Furthermore, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S3.F3" title="Figure 3 ‣ 3.1 Model Architecture ‣ 3 Our Model ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">3</span></a>, we propose a training framework for our model, consisting of two stages. First, we utilize large-scale unlabeled images to train the image tokenizer through an image reconstruction task. Then, we freeze the image tokenizer and train other modules using IIMT dataset. Inspired by end-to-end speech translation <cite class="ltx_cite ltx_citemacro_cite">Jia et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib13" title="">2019</a>)</cite>, we introduce multi-task learning at this stage. The auxiliary tasks include OCR and text image translation (TIT), assisting the model in learning alignment across different modalities and languages. Particularly, we introduce a knowledge distillation method to reduce the difficulty of the end-to-end model directly learning from ground-truth labels.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Due to the absence of publicly available IIMT datasets, we use IWSLT14 German-English <cite class="ltx_cite ltx_citemacro_cite">Cettolo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib4" title="">2014</a>)</cite> to synthesize a dataset for this task. Note that unlike previous works <cite class="ltx_cite ltx_citemacro_cite">Mansimov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib23" title="">2020</a>); Tian et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib31" title="">2023</a>)</cite> only focus on images containing single-line text, the images in our dataset are more complex, featuring multiple lines of text, as well as text rotation and translation. Furthermore, since the conventional BLEU <cite class="ltx_cite ltx_citemacro_cite">Papineni et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib24" title="">2002</a>)</cite> is not applicable to image evaluation, we extend BLEU to Structure-BLEU that considers text location information to better evaluate the quality of text translations within images.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">To summarize, we have the following major contributions in this work:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a novel end-to-end IIMT model named Translatotron-V. More importantly, it introduces two crucial modules to address major challenges in end-to-end IIMT: 1) target text decoder used to alleviate the modeling burden; 2) image tokenizer preventing the model from directly predicting pixels.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We present a two-stage training framework for Translatotron-V, which fully exploits unlabeled images, OCR, and TIT data to refine the model training.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We propose Structure-BLEU, an evaluation metric that considers text location information for IIMT.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">Experimental results demonstrate that Translatotron-V not only significantly outperforms the pixel-level end-to-end IIMT model, but also achieves comparable performance with fewer parameters to cascaded models.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">To achieve high-performance IIMT, previous research mainly focuses on text image translation (TIT), which is a subtask of IIMT <cite class="ltx_cite ltx_citemacro_cite">Watanabe et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib36" title="">1998</a>); Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib38" title="">2002</a>); Du et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib8" title="">2011</a>); Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib5" title="">2015</a>); Afli and Way (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib1" title="">2016</a>); Lan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib15" title="">2023</a>)</cite>. Unlike conventional multimodal machine translation <cite class="ltx_cite ltx_citemacro_cite">Elliott et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib9" title="">2016</a>); Yin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib39" title="">2020</a>); Lin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib17" title="">2020</a>); Su et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib28" title="">2021a</a>); Yin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib40" title="">2023</a>); Kang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib14" title="">2023</a>)</cite>, TIT aims to translate source language texts in images into target language. In this regard, dominant studies resort to the cascading method, which uses an OCR model to obtain the recognized source language texts and then feed them into an MT model for translation <cite class="ltx_cite ltx_citemacro_cite">Goodfellow et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib10" title="">2014</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib43" title="">2016</a>); Gu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib11" title="">2018</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">Afterwards, due to the advantages of mitigating error propagation, the end-to-end TIT attracts increasing attention.
<cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib6" title="">Chen et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib6" title="">2020</a></cite>) adopt multi-task learning framework that integrates OCR as an auxiliary task. Along this line, <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib19" title="">Ma et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib19" title="">2022</a></cite>) incorporating MT into the multi-task learning framework. Unlike previous studies, both <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib29" title="">Su et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib29" title="">2021b</a></cite>) and <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib21" title="">Ma et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib21" title="">2023b</a></cite>) employ an adapter to combine individual pretrained OCR and MT modules in a TIT model. Furthermore, <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib22" title="">Ma et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib22" title="">2023c</a></cite>) apply knowledge distillation to effectively distillate the knowledge of OCR and MT models into the end-to-end TIT model. <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib44" title="">Zhu et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib44" title="">2023</a></cite>) explore an end-to-end TIT model with an aligner and a regularizer to reduce the modality gap. To explicitly exploit guidance from recognized texts, <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib20" title="">Ma et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib20" title="">2023a</a></cite>) incorporate recognized text information into the TIT decoder through interactive attention. Differing from the above studies focusing on model design, <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib27" title="">Salesky et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib27" title="">2021</a></cite>) analyze the effect of visual text representation, and find that it exhibits significant robustness to various types of noise.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">However, none of the aforementioned works consider generating the image with target translations, which is a common requirement in real-world scenarios. To this end, <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib23" title="">Mansimov et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib23" title="">2020</a></cite>) first explore the IIMT task. They introduce an end-to-end model that contains a self-attention encoder, two convolutional encoders, and a convolutional decoder to generate target images at the pixel level. Nonetheless, their model significantly lags behind cascaded models, suffering from issues such as character omission and artifacts. Recently, <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib31" title="">Tian et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib31" title="">2023</a></cite>) convert pixels into characters, thereby transforming the IIMT task into a conventional sequence-to-sequence text generation task. However, this method can only generate grayscale images, losing visual characteristics. <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib30" title="">Susladkar et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib30" title="">2023</a></cite>) present a conditional diffusion-based image editing model, which replaces text in the input image with a given translation while preserving the visual characteristics of origin image. However, this model can only perform single-word editing, which makes its application very limited.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">Different from these studies, we propose an end-to-end IIMT model that can generate RGB images with multiple lines of text while preserving the visual features of the input image, and achieve comparable performance to the cascaded model.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="194" id="S2.F2.g1" src="extracted/5707577/figures/model.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of our model.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Our Model</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Model Architecture</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a>, our model consists of four modules: an image encoder, a target text decoder, an image decoder, and an image tokenizer. All of those modules will be elaborated in the following.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">Image Encoder</span>. This module converts the input image into a sequence of visual vectors.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.8">We use ViT <cite class="ltx_cite ltx_citemacro_cite">Dosovitskiy et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib7" title="">2021</a>)</cite> as the backbone of the image encoder. In order to convert a 2D image into a 1D sequence that can be handled by Transformer, we first split the input image <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">bold_x</annotation></semantics></math> into <math alttext="N=HW/P^{2}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">N</mi><mo id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.cmml">=</mo><mrow id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml"><mrow id="S3.SS1.p3.2.m2.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.3.2.cmml"><mi id="S3.SS1.p3.2.m2.1.1.3.2.2" xref="S3.SS1.p3.2.m2.1.1.3.2.2.cmml">H</mi><mo id="S3.SS1.p3.2.m2.1.1.3.2.1" xref="S3.SS1.p3.2.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S3.SS1.p3.2.m2.1.1.3.2.3" xref="S3.SS1.p3.2.m2.1.1.3.2.3.cmml">W</mi></mrow><mo id="S3.SS1.p3.2.m2.1.1.3.1" xref="S3.SS1.p3.2.m2.1.1.3.1.cmml">/</mo><msup id="S3.SS1.p3.2.m2.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.3.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.3.3.2" xref="S3.SS1.p3.2.m2.1.1.3.3.2.cmml">P</mi><mn id="S3.SS1.p3.2.m2.1.1.3.3.3" xref="S3.SS1.p3.2.m2.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><eq id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1"></eq><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝑁</ci><apply id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3"><divide id="S3.SS1.p3.2.m2.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.3.1"></divide><apply id="S3.SS1.p3.2.m2.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.3.2"><times id="S3.SS1.p3.2.m2.1.1.3.2.1.cmml" xref="S3.SS1.p3.2.m2.1.1.3.2.1"></times><ci id="S3.SS1.p3.2.m2.1.1.3.2.2.cmml" xref="S3.SS1.p3.2.m2.1.1.3.2.2">𝐻</ci><ci id="S3.SS1.p3.2.m2.1.1.3.2.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3.2.3">𝑊</ci></apply><apply id="S3.SS1.p3.2.m2.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3">superscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3.2">𝑃</ci><cn id="S3.SS1.p3.2.m2.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.p3.2.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">N=HW/P^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_N = italic_H italic_W / italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> image patches <math alttext="\{x_{i}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><msubsup id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mrow id="S3.SS1.p3.3.m3.1.1.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.1.2.cmml"><mo id="S3.SS1.p3.3.m3.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.3.m3.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p3.3.m3.1.1.1.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.1.1.1.1.2" xref="S3.SS1.p3.3.m3.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p3.3.m3.1.1.1.1.1.1.3" xref="S3.SS1.p3.3.m3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p3.3.m3.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p3.3.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p3.3.m3.1.1.1.3" xref="S3.SS1.p3.3.m3.1.1.1.3.cmml"><mi id="S3.SS1.p3.3.m3.1.1.1.3.2" xref="S3.SS1.p3.3.m3.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p3.3.m3.1.1.1.3.1" xref="S3.SS1.p3.3.m3.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p3.3.m3.1.1.1.3.3" xref="S3.SS1.p3.3.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1">superscript</csymbol><apply id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1">subscript</csymbol><set id="S3.SS1.p3.3.m3.1.1.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.1.1.1"><apply id="S3.SS1.p3.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p3.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.p3.3.m3.1.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.1.3"><eq id="S3.SS1.p3.3.m3.1.1.1.3.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1.3.1"></eq><ci id="S3.SS1.p3.3.m3.1.1.1.3.2.cmml" xref="S3.SS1.p3.3.m3.1.1.1.3.2">𝑖</ci><cn id="S3.SS1.p3.3.m3.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p3.3.m3.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\{x_{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">{ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="(H,W)" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.2"><semantics id="S3.SS1.p3.4.m4.2a"><mrow id="S3.SS1.p3.4.m4.2.3.2" xref="S3.SS1.p3.4.m4.2.3.1.cmml"><mo id="S3.SS1.p3.4.m4.2.3.2.1" stretchy="false" xref="S3.SS1.p3.4.m4.2.3.1.cmml">(</mo><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">H</mi><mo id="S3.SS1.p3.4.m4.2.3.2.2" xref="S3.SS1.p3.4.m4.2.3.1.cmml">,</mo><mi id="S3.SS1.p3.4.m4.2.2" xref="S3.SS1.p3.4.m4.2.2.cmml">W</mi><mo id="S3.SS1.p3.4.m4.2.3.2.3" stretchy="false" xref="S3.SS1.p3.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.2b"><interval closure="open" id="S3.SS1.p3.4.m4.2.3.1.cmml" xref="S3.SS1.p3.4.m4.2.3.2"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝐻</ci><ci id="S3.SS1.p3.4.m4.2.2.cmml" xref="S3.SS1.p3.4.m4.2.2">𝑊</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.2c">(H,W)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.2d">( italic_H , italic_W )</annotation></semantics></math> is the resolution of the input image, and <math alttext="(P,P)" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m5.2"><semantics id="S3.SS1.p3.5.m5.2a"><mrow id="S3.SS1.p3.5.m5.2.3.2" xref="S3.SS1.p3.5.m5.2.3.1.cmml"><mo id="S3.SS1.p3.5.m5.2.3.2.1" stretchy="false" xref="S3.SS1.p3.5.m5.2.3.1.cmml">(</mo><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">P</mi><mo id="S3.SS1.p3.5.m5.2.3.2.2" xref="S3.SS1.p3.5.m5.2.3.1.cmml">,</mo><mi id="S3.SS1.p3.5.m5.2.2" xref="S3.SS1.p3.5.m5.2.2.cmml">P</mi><mo id="S3.SS1.p3.5.m5.2.3.2.3" stretchy="false" xref="S3.SS1.p3.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.2b"><interval closure="open" id="S3.SS1.p3.5.m5.2.3.1.cmml" xref="S3.SS1.p3.5.m5.2.3.2"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝑃</ci><ci id="S3.SS1.p3.5.m5.2.2.cmml" xref="S3.SS1.p3.5.m5.2.2">𝑃</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.2c">(P,P)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m5.2d">( italic_P , italic_P )</annotation></semantics></math> is the resolution of each patch. Then we apply a linear projection matrix <math alttext="\mathbf{W}_{e}" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m6.1"><semantics id="S3.SS1.p3.6.m6.1a"><msub id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml"><mi id="S3.SS1.p3.6.m6.1.1.2" xref="S3.SS1.p3.6.m6.1.1.2.cmml">𝐖</mi><mi id="S3.SS1.p3.6.m6.1.1.3" xref="S3.SS1.p3.6.m6.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p3.6.m6.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2">𝐖</ci><ci id="S3.SS1.p3.6.m6.1.1.3.cmml" xref="S3.SS1.p3.6.m6.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">\mathbf{W}_{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m6.1d">bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> to transform image patches into patch embeddings, and use a standard learnable positional embedding matrix <math alttext="\mathbf{E}_{pos}" class="ltx_Math" display="inline" id="S3.SS1.p3.7.m7.1"><semantics id="S3.SS1.p3.7.m7.1a"><msub id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml"><mi id="S3.SS1.p3.7.m7.1.1.2" xref="S3.SS1.p3.7.m7.1.1.2.cmml">𝐄</mi><mrow id="S3.SS1.p3.7.m7.1.1.3" xref="S3.SS1.p3.7.m7.1.1.3.cmml"><mi id="S3.SS1.p3.7.m7.1.1.3.2" xref="S3.SS1.p3.7.m7.1.1.3.2.cmml">p</mi><mo id="S3.SS1.p3.7.m7.1.1.3.1" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.7.m7.1.1.3.3" xref="S3.SS1.p3.7.m7.1.1.3.3.cmml">o</mi><mo id="S3.SS1.p3.7.m7.1.1.3.1a" xref="S3.SS1.p3.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.7.m7.1.1.3.4" xref="S3.SS1.p3.7.m7.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2">𝐄</ci><apply id="S3.SS1.p3.7.m7.1.1.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3"><times id="S3.SS1.p3.7.m7.1.1.3.1.cmml" xref="S3.SS1.p3.7.m7.1.1.3.1"></times><ci id="S3.SS1.p3.7.m7.1.1.3.2.cmml" xref="S3.SS1.p3.7.m7.1.1.3.2">𝑝</ci><ci id="S3.SS1.p3.7.m7.1.1.3.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3.3">𝑜</ci><ci id="S3.SS1.p3.7.m7.1.1.3.4.cmml" xref="S3.SS1.p3.7.m7.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">\mathbf{E}_{pos}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m7.1d">bold_E start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT</annotation></semantics></math> to further optimize these patch embeddings. Formally, the initial hidden states <math alttext="\mathbf{H}_{ie}^{0}" class="ltx_Math" display="inline" id="S3.SS1.p3.8.m8.1"><semantics id="S3.SS1.p3.8.m8.1a"><msubsup id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml"><mi id="S3.SS1.p3.8.m8.1.1.2.2" xref="S3.SS1.p3.8.m8.1.1.2.2.cmml">𝐇</mi><mrow id="S3.SS1.p3.8.m8.1.1.2.3" xref="S3.SS1.p3.8.m8.1.1.2.3.cmml"><mi id="S3.SS1.p3.8.m8.1.1.2.3.2" xref="S3.SS1.p3.8.m8.1.1.2.3.2.cmml">i</mi><mo id="S3.SS1.p3.8.m8.1.1.2.3.1" xref="S3.SS1.p3.8.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.8.m8.1.1.2.3.3" xref="S3.SS1.p3.8.m8.1.1.2.3.3.cmml">e</mi></mrow><mn id="S3.SS1.p3.8.m8.1.1.3" xref="S3.SS1.p3.8.m8.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><apply id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">superscript</csymbol><apply id="S3.SS1.p3.8.m8.1.1.2.cmml" xref="S3.SS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.8.m8.1.1.2.1.cmml" xref="S3.SS1.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p3.8.m8.1.1.2.2.cmml" xref="S3.SS1.p3.8.m8.1.1.2.2">𝐇</ci><apply id="S3.SS1.p3.8.m8.1.1.2.3.cmml" xref="S3.SS1.p3.8.m8.1.1.2.3"><times id="S3.SS1.p3.8.m8.1.1.2.3.1.cmml" xref="S3.SS1.p3.8.m8.1.1.2.3.1"></times><ci id="S3.SS1.p3.8.m8.1.1.2.3.2.cmml" xref="S3.SS1.p3.8.m8.1.1.2.3.2">𝑖</ci><ci id="S3.SS1.p3.8.m8.1.1.2.3.3.cmml" xref="S3.SS1.p3.8.m8.1.1.2.3.3">𝑒</ci></apply></apply><cn id="S3.SS1.p3.8.m8.1.1.3.cmml" type="integer" xref="S3.SS1.p3.8.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">\mathbf{H}_{ie}^{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.8.m8.1d">bold_H start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math> of the image encoder can be formulated as</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{H}_{ie}^{(0)}=[x_{0};\mathbf{W}_{e}x_{1};\mathbf{W}_{e}x_{2};...;%
\mathbf{W}_{e}x_{N}]+\mathbf{E}_{pos}," class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><msubsup id="S3.E1.m1.3.3.1.1.6" xref="S3.E1.m1.3.3.1.1.6.cmml"><mi id="S3.E1.m1.3.3.1.1.6.2.2" xref="S3.E1.m1.3.3.1.1.6.2.2.cmml">𝐇</mi><mrow id="S3.E1.m1.3.3.1.1.6.2.3" xref="S3.E1.m1.3.3.1.1.6.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.6.2.3.2" xref="S3.E1.m1.3.3.1.1.6.2.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.6.2.3.1" xref="S3.E1.m1.3.3.1.1.6.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.6.2.3.3" xref="S3.E1.m1.3.3.1.1.6.2.3.3.cmml">e</mi></mrow><mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.6.cmml"><mo id="S3.E1.m1.1.1.1.3.1" stretchy="false" xref="S3.E1.m1.3.3.1.1.6.cmml">(</mo><mn id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">0</mn><mo id="S3.E1.m1.1.1.1.3.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.6.cmml">)</mo></mrow></msubsup><mo id="S3.E1.m1.3.3.1.1.5" xref="S3.E1.m1.3.3.1.1.5.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.4" xref="S3.E1.m1.3.3.1.1.4.cmml"><mrow id="S3.E1.m1.3.3.1.1.4.4.4" xref="S3.E1.m1.3.3.1.1.4.4.5.cmml"><mo id="S3.E1.m1.3.3.1.1.4.4.4.5" stretchy="false" xref="S3.E1.m1.3.3.1.1.4.4.5.cmml">[</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml">x</mi><mn id="S3.E1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E1.m1.3.3.1.1.4.4.4.6" xref="S3.E1.m1.3.3.1.1.4.4.5.cmml">;</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.cmml"><msub id="S3.E1.m1.3.3.1.1.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml">𝐖</mi><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.cmml">e</mi></msub><mo id="S3.E1.m1.3.3.1.1.2.2.2.2.1" xref="S3.E1.m1.3.3.1.1.2.2.2.2.1.cmml">⁢</mo><msub id="S3.E1.m1.3.3.1.1.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.cmml">x</mi><mn id="S3.E1.m1.3.3.1.1.2.2.2.2.3.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.cmml">1</mn></msub></mrow><mo id="S3.E1.m1.3.3.1.1.4.4.4.7" xref="S3.E1.m1.3.3.1.1.4.4.5.cmml">;</mo><mrow id="S3.E1.m1.3.3.1.1.3.3.3.3" xref="S3.E1.m1.3.3.1.1.3.3.3.3.cmml"><msub id="S3.E1.m1.3.3.1.1.3.3.3.3.2" xref="S3.E1.m1.3.3.1.1.3.3.3.3.2.cmml"><mi id="S3.E1.m1.3.3.1.1.3.3.3.3.2.2" xref="S3.E1.m1.3.3.1.1.3.3.3.3.2.2.cmml">𝐖</mi><mi id="S3.E1.m1.3.3.1.1.3.3.3.3.2.3" xref="S3.E1.m1.3.3.1.1.3.3.3.3.2.3.cmml">e</mi></msub><mo id="S3.E1.m1.3.3.1.1.3.3.3.3.1" xref="S3.E1.m1.3.3.1.1.3.3.3.3.1.cmml">⁢</mo><msub id="S3.E1.m1.3.3.1.1.3.3.3.3.3" xref="S3.E1.m1.3.3.1.1.3.3.3.3.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.3.3.3.3.2" xref="S3.E1.m1.3.3.1.1.3.3.3.3.3.2.cmml">x</mi><mn id="S3.E1.m1.3.3.1.1.3.3.3.3.3.3" xref="S3.E1.m1.3.3.1.1.3.3.3.3.3.3.cmml">2</mn></msub></mrow><mo id="S3.E1.m1.3.3.1.1.4.4.4.8" xref="S3.E1.m1.3.3.1.1.4.4.5.cmml">;</mo><mi id="S3.E1.m1.2.2" mathvariant="normal" xref="S3.E1.m1.2.2.cmml">…</mi><mo id="S3.E1.m1.3.3.1.1.4.4.4.9" xref="S3.E1.m1.3.3.1.1.4.4.5.cmml">;</mo><mrow id="S3.E1.m1.3.3.1.1.4.4.4.4" xref="S3.E1.m1.3.3.1.1.4.4.4.4.cmml"><msub id="S3.E1.m1.3.3.1.1.4.4.4.4.2" xref="S3.E1.m1.3.3.1.1.4.4.4.4.2.cmml"><mi id="S3.E1.m1.3.3.1.1.4.4.4.4.2.2" xref="S3.E1.m1.3.3.1.1.4.4.4.4.2.2.cmml">𝐖</mi><mi id="S3.E1.m1.3.3.1.1.4.4.4.4.2.3" xref="S3.E1.m1.3.3.1.1.4.4.4.4.2.3.cmml">e</mi></msub><mo id="S3.E1.m1.3.3.1.1.4.4.4.4.1" xref="S3.E1.m1.3.3.1.1.4.4.4.4.1.cmml">⁢</mo><msub id="S3.E1.m1.3.3.1.1.4.4.4.4.3" xref="S3.E1.m1.3.3.1.1.4.4.4.4.3.cmml"><mi id="S3.E1.m1.3.3.1.1.4.4.4.4.3.2" xref="S3.E1.m1.3.3.1.1.4.4.4.4.3.2.cmml">x</mi><mi id="S3.E1.m1.3.3.1.1.4.4.4.4.3.3" xref="S3.E1.m1.3.3.1.1.4.4.4.4.3.3.cmml">N</mi></msub></mrow><mo id="S3.E1.m1.3.3.1.1.4.4.4.10" stretchy="false" xref="S3.E1.m1.3.3.1.1.4.4.5.cmml">]</mo></mrow><mo id="S3.E1.m1.3.3.1.1.4.5" xref="S3.E1.m1.3.3.1.1.4.5.cmml">+</mo><msub id="S3.E1.m1.3.3.1.1.4.6" xref="S3.E1.m1.3.3.1.1.4.6.cmml"><mi id="S3.E1.m1.3.3.1.1.4.6.2" xref="S3.E1.m1.3.3.1.1.4.6.2.cmml">𝐄</mi><mrow id="S3.E1.m1.3.3.1.1.4.6.3" xref="S3.E1.m1.3.3.1.1.4.6.3.cmml"><mi id="S3.E1.m1.3.3.1.1.4.6.3.2" xref="S3.E1.m1.3.3.1.1.4.6.3.2.cmml">p</mi><mo id="S3.E1.m1.3.3.1.1.4.6.3.1" xref="S3.E1.m1.3.3.1.1.4.6.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.4.6.3.3" xref="S3.E1.m1.3.3.1.1.4.6.3.3.cmml">o</mi><mo id="S3.E1.m1.3.3.1.1.4.6.3.1a" xref="S3.E1.m1.3.3.1.1.4.6.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.4.6.3.4" xref="S3.E1.m1.3.3.1.1.4.6.3.4.cmml">s</mi></mrow></msub></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.5.cmml" xref="S3.E1.m1.3.3.1.1.5"></eq><apply id="S3.E1.m1.3.3.1.1.6.cmml" xref="S3.E1.m1.3.3.1.1.6"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.6.1.cmml" xref="S3.E1.m1.3.3.1.1.6">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.6.2.cmml" xref="S3.E1.m1.3.3.1.1.6"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.6.2.1.cmml" xref="S3.E1.m1.3.3.1.1.6">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.6.2.2.cmml" xref="S3.E1.m1.3.3.1.1.6.2.2">𝐇</ci><apply id="S3.E1.m1.3.3.1.1.6.2.3.cmml" xref="S3.E1.m1.3.3.1.1.6.2.3"><times id="S3.E1.m1.3.3.1.1.6.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.6.2.3.1"></times><ci id="S3.E1.m1.3.3.1.1.6.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.6.2.3.2">𝑖</ci><ci id="S3.E1.m1.3.3.1.1.6.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.6.2.3.3">𝑒</ci></apply></apply><cn id="S3.E1.m1.1.1.1.1.cmml" type="integer" xref="S3.E1.m1.1.1.1.1">0</cn></apply><apply id="S3.E1.m1.3.3.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.4"><plus id="S3.E1.m1.3.3.1.1.4.5.cmml" xref="S3.E1.m1.3.3.1.1.4.5"></plus><list id="S3.E1.m1.3.3.1.1.4.4.5.cmml" xref="S3.E1.m1.3.3.1.1.4.4.4"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2">𝑥</ci><cn id="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3">0</cn></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2"><times id="S3.E1.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.1"></times><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2">𝐖</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3">𝑒</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.2">𝑥</ci><cn id="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.3.3.1.1.3.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3.3"><times id="S3.E1.m1.3.3.1.1.3.3.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3.3.1"></times><apply id="S3.E1.m1.3.3.1.1.3.3.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.3.3.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3.3.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.3.3.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3.3.2.2">𝐖</ci><ci id="S3.E1.m1.3.3.1.1.3.3.3.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3.3.2.3">𝑒</ci></apply><apply id="S3.E1.m1.3.3.1.1.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.3.3.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.3.3.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.3.3.3.2">𝑥</ci><cn id="S3.E1.m1.3.3.1.1.3.3.3.3.3.3.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.3.3.3.3.3.3">2</cn></apply></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">…</ci><apply id="S3.E1.m1.3.3.1.1.4.4.4.4.cmml" xref="S3.E1.m1.3.3.1.1.4.4.4.4"><times id="S3.E1.m1.3.3.1.1.4.4.4.4.1.cmml" xref="S3.E1.m1.3.3.1.1.4.4.4.4.1"></times><apply id="S3.E1.m1.3.3.1.1.4.4.4.4.2.cmml" xref="S3.E1.m1.3.3.1.1.4.4.4.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.4.4.4.4.2.1.cmml" xref="S3.E1.m1.3.3.1.1.4.4.4.4.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.4.4.4.4.2.2.cmml" xref="S3.E1.m1.3.3.1.1.4.4.4.4.2.2">𝐖</ci><ci id="S3.E1.m1.3.3.1.1.4.4.4.4.2.3.cmml" xref="S3.E1.m1.3.3.1.1.4.4.4.4.2.3">𝑒</ci></apply><apply id="S3.E1.m1.3.3.1.1.4.4.4.4.3.cmml" xref="S3.E1.m1.3.3.1.1.4.4.4.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.4.4.4.4.3.1.cmml" xref="S3.E1.m1.3.3.1.1.4.4.4.4.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.4.4.4.4.3.2.cmml" xref="S3.E1.m1.3.3.1.1.4.4.4.4.3.2">𝑥</ci><ci id="S3.E1.m1.3.3.1.1.4.4.4.4.3.3.cmml" xref="S3.E1.m1.3.3.1.1.4.4.4.4.3.3">𝑁</ci></apply></apply></list><apply id="S3.E1.m1.3.3.1.1.4.6.cmml" xref="S3.E1.m1.3.3.1.1.4.6"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.4.6.1.cmml" xref="S3.E1.m1.3.3.1.1.4.6">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.4.6.2.cmml" xref="S3.E1.m1.3.3.1.1.4.6.2">𝐄</ci><apply id="S3.E1.m1.3.3.1.1.4.6.3.cmml" xref="S3.E1.m1.3.3.1.1.4.6.3"><times id="S3.E1.m1.3.3.1.1.4.6.3.1.cmml" xref="S3.E1.m1.3.3.1.1.4.6.3.1"></times><ci id="S3.E1.m1.3.3.1.1.4.6.3.2.cmml" xref="S3.E1.m1.3.3.1.1.4.6.3.2">𝑝</ci><ci id="S3.E1.m1.3.3.1.1.4.6.3.3.cmml" xref="S3.E1.m1.3.3.1.1.4.6.3.3">𝑜</ci><ci id="S3.E1.m1.3.3.1.1.4.6.3.4.cmml" xref="S3.E1.m1.3.3.1.1.4.6.3.4">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\mathbf{H}_{ie}^{(0)}=[x_{0};\mathbf{W}_{e}x_{1};\mathbf{W}_{e}x_{2};...;%
\mathbf{W}_{e}x_{N}]+\mathbf{E}_{pos},</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">bold_H start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT = [ italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ; bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ; … ; bold_W start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] + bold_E start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.9">where <math alttext="x_{0}" class="ltx_Math" display="inline" id="S3.SS1.p3.9.m1.1"><semantics id="S3.SS1.p3.9.m1.1a"><msub id="S3.SS1.p3.9.m1.1.1" xref="S3.SS1.p3.9.m1.1.1.cmml"><mi id="S3.SS1.p3.9.m1.1.1.2" xref="S3.SS1.p3.9.m1.1.1.2.cmml">x</mi><mn id="S3.SS1.p3.9.m1.1.1.3" xref="S3.SS1.p3.9.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m1.1b"><apply id="S3.SS1.p3.9.m1.1.1.cmml" xref="S3.SS1.p3.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.9.m1.1.1.1.cmml" xref="S3.SS1.p3.9.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.9.m1.1.1.2.cmml" xref="S3.SS1.p3.9.m1.1.1.2">𝑥</ci><cn id="S3.SS1.p3.9.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p3.9.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m1.1c">x_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.9.m1.1d">italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is the special token prepended to the input sequence.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.2">Afterwards, we process these patch embeddings using a Transformer encoder with multiple layers. Each Transformer encoder layer is composed of a self-attention sub-layer and a feed-forward network (FFN) sub-layer. Layernorm (LN) is applied before each sub-layer, and residual connections after each sub-layer <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib34" title="">2019</a>)</cite>. The hidden states <math alttext="\mathbf{H}_{ie}^{(l)}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><msubsup id="S3.SS1.p4.1.m1.1.2" xref="S3.SS1.p4.1.m1.1.2.cmml"><mi id="S3.SS1.p4.1.m1.1.2.2.2" xref="S3.SS1.p4.1.m1.1.2.2.2.cmml">𝐇</mi><mrow id="S3.SS1.p4.1.m1.1.2.2.3" xref="S3.SS1.p4.1.m1.1.2.2.3.cmml"><mi id="S3.SS1.p4.1.m1.1.2.2.3.2" xref="S3.SS1.p4.1.m1.1.2.2.3.2.cmml">i</mi><mo id="S3.SS1.p4.1.m1.1.2.2.3.1" xref="S3.SS1.p4.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p4.1.m1.1.2.2.3.3" xref="S3.SS1.p4.1.m1.1.2.2.3.3.cmml">e</mi></mrow><mrow id="S3.SS1.p4.1.m1.1.1.1.3" xref="S3.SS1.p4.1.m1.1.2.cmml"><mo id="S3.SS1.p4.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p4.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p4.1.m1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p4.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p4.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.2">superscript</csymbol><apply id="S3.SS1.p4.1.m1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.2.2.1.cmml" xref="S3.SS1.p4.1.m1.1.2">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.2.2.2.cmml" xref="S3.SS1.p4.1.m1.1.2.2.2">𝐇</ci><apply id="S3.SS1.p4.1.m1.1.2.2.3.cmml" xref="S3.SS1.p4.1.m1.1.2.2.3"><times id="S3.SS1.p4.1.m1.1.2.2.3.1.cmml" xref="S3.SS1.p4.1.m1.1.2.2.3.1"></times><ci id="S3.SS1.p4.1.m1.1.2.2.3.2.cmml" xref="S3.SS1.p4.1.m1.1.2.2.3.2">𝑖</ci><ci id="S3.SS1.p4.1.m1.1.2.2.3.3.cmml" xref="S3.SS1.p4.1.m1.1.2.2.3.3">𝑒</ci></apply></apply><ci id="S3.SS1.p4.1.m1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\mathbf{H}_{ie}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">bold_H start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> of the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">italic_l</annotation></semantics></math>-th encoder layer is calculated as</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{H}_{ie}^{(l)}=\mathrm{FFN}(\mathrm{MHA}(\mathbf{H}_{ie}^{(l-1)},%
\mathbf{H}_{ie}^{(l-1)},\mathbf{H}_{ie}^{(l-1)}))," class="ltx_Math" display="block" id="S3.E2.m1.5"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml"><msubsup id="S3.E2.m1.5.5.1.1.3" xref="S3.E2.m1.5.5.1.1.3.cmml"><mi id="S3.E2.m1.5.5.1.1.3.2.2" xref="S3.E2.m1.5.5.1.1.3.2.2.cmml">𝐇</mi><mrow id="S3.E2.m1.5.5.1.1.3.2.3" xref="S3.E2.m1.5.5.1.1.3.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1.3.2.3.2" xref="S3.E2.m1.5.5.1.1.3.2.3.2.cmml">i</mi><mo id="S3.E2.m1.5.5.1.1.3.2.3.1" xref="S3.E2.m1.5.5.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.5.5.1.1.3.2.3.3" xref="S3.E2.m1.5.5.1.1.3.2.3.3.cmml">e</mi></mrow><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.3.cmml"><mo id="S3.E2.m1.1.1.1.3.1" stretchy="false" xref="S3.E2.m1.5.5.1.1.3.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">l</mi><mo id="S3.E2.m1.1.1.1.3.2" stretchy="false" xref="S3.E2.m1.5.5.1.1.3.cmml">)</mo></mrow></msubsup><mo id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.1" xref="S3.E2.m1.5.5.1.1.1.cmml"><mi id="S3.E2.m1.5.5.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.3.cmml">FFN</mi><mo id="S3.E2.m1.5.5.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.5" xref="S3.E2.m1.5.5.1.1.1.1.1.1.5.cmml">MHA</mi><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.4" xref="S3.E2.m1.5.5.1.1.1.1.1.1.4.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.4.cmml"><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.4" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.4.cmml">(</mo><msubsup id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3.cmml">e</mi></mrow><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.2.cmml">l</mi><mo id="S3.E2.m1.2.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E2.m1.2.2.1.1.3" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.5" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.4.cmml">,</mo><msubsup id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐇</mi><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.3.cmml">e</mi></mrow><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml"><mo id="S3.E2.m1.3.3.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.2.cmml">l</mi><mo id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.cmml">−</mo><mn id="S3.E2.m1.3.3.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E2.m1.3.3.1.1.3" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.6" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.4.cmml">,</mo><msubsup id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.2.cmml">𝐇</mi><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.2.cmml">i</mi><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.3.cmml">e</mi></mrow><mrow id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml"><mo id="S3.E2.m1.4.4.1.1.2" stretchy="false" xref="S3.E2.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.2.cmml">l</mi><mo id="S3.E2.m1.4.4.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.cmml">−</mo><mn id="S3.E2.m1.4.4.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E2.m1.4.4.1.1.3" stretchy="false" xref="S3.E2.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.7" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.1.2" xref="S3.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1"><eq id="S3.E2.m1.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2"></eq><apply id="S3.E2.m1.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.3">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3.2.1.cmml" xref="S3.E2.m1.5.5.1.1.3">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.3.2.2.cmml" xref="S3.E2.m1.5.5.1.1.3.2.2">𝐇</ci><apply id="S3.E2.m1.5.5.1.1.3.2.3.cmml" xref="S3.E2.m1.5.5.1.1.3.2.3"><times id="S3.E2.m1.5.5.1.1.3.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.3.2.3.1"></times><ci id="S3.E2.m1.5.5.1.1.3.2.3.2.cmml" xref="S3.E2.m1.5.5.1.1.3.2.3.2">𝑖</ci><ci id="S3.E2.m1.5.5.1.1.3.2.3.3.cmml" xref="S3.E2.m1.5.5.1.1.3.2.3.3">𝑒</ci></apply></apply><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑙</ci></apply><apply id="S3.E2.m1.5.5.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.2"></times><ci id="S3.E2.m1.5.5.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.3">FFN</ci><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.4"></times><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.5.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.5">MHA</ci><vector id="S3.E2.m1.5.5.1.1.1.1.1.1.3.4.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3"><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.2">𝐇</ci><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.3.3">𝑒</ci></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1"><minus id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1"></minus><ci id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2">𝑙</ci><cn id="S3.E2.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.2">𝐇</ci><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.2">𝑖</ci><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.3">𝑒</ci></apply></apply><apply id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1"><minus id="S3.E2.m1.3.3.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1"></minus><ci id="S3.E2.m1.3.3.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.2">𝑙</ci><cn id="S3.E2.m1.3.3.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.1.3">1</cn></apply></apply><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.2">𝐇</ci><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3"><times id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.1"></times><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.2">𝑖</ci><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.3.3.2.3.3">𝑒</ci></apply></apply><apply id="S3.E2.m1.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1"><minus id="S3.E2.m1.4.4.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1"></minus><ci id="S3.E2.m1.4.4.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.2">𝑙</ci><cn id="S3.E2.m1.4.4.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.4.4.1.1.1.3">1</cn></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\mathbf{H}_{ie}^{(l)}=\mathrm{FFN}(\mathrm{MHA}(\mathbf{H}_{ie}^{(l-1)},%
\mathbf{H}_{ie}^{(l-1)},\mathbf{H}_{ie}^{(l-1)})),</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.5d">bold_H start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = roman_FFN ( roman_MHA ( bold_H start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p4.3">where <math alttext="\mathrm{MHA}(\cdot,\cdot,\cdot)" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m1.3"><semantics id="S3.SS1.p4.3.m1.3a"><mrow id="S3.SS1.p4.3.m1.3.4" xref="S3.SS1.p4.3.m1.3.4.cmml"><mi id="S3.SS1.p4.3.m1.3.4.2" xref="S3.SS1.p4.3.m1.3.4.2.cmml">MHA</mi><mo id="S3.SS1.p4.3.m1.3.4.1" xref="S3.SS1.p4.3.m1.3.4.1.cmml">⁢</mo><mrow id="S3.SS1.p4.3.m1.3.4.3.2" xref="S3.SS1.p4.3.m1.3.4.3.1.cmml"><mo id="S3.SS1.p4.3.m1.3.4.3.2.1" stretchy="false" xref="S3.SS1.p4.3.m1.3.4.3.1.cmml">(</mo><mo id="S3.SS1.p4.3.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p4.3.m1.1.1.cmml">⋅</mo><mo id="S3.SS1.p4.3.m1.3.4.3.2.2" rspace="0em" xref="S3.SS1.p4.3.m1.3.4.3.1.cmml">,</mo><mo id="S3.SS1.p4.3.m1.2.2" lspace="0em" rspace="0em" xref="S3.SS1.p4.3.m1.2.2.cmml">⋅</mo><mo id="S3.SS1.p4.3.m1.3.4.3.2.3" rspace="0em" xref="S3.SS1.p4.3.m1.3.4.3.1.cmml">,</mo><mo id="S3.SS1.p4.3.m1.3.3" lspace="0em" rspace="0em" xref="S3.SS1.p4.3.m1.3.3.cmml">⋅</mo><mo id="S3.SS1.p4.3.m1.3.4.3.2.4" stretchy="false" xref="S3.SS1.p4.3.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m1.3b"><apply id="S3.SS1.p4.3.m1.3.4.cmml" xref="S3.SS1.p4.3.m1.3.4"><times id="S3.SS1.p4.3.m1.3.4.1.cmml" xref="S3.SS1.p4.3.m1.3.4.1"></times><ci id="S3.SS1.p4.3.m1.3.4.2.cmml" xref="S3.SS1.p4.3.m1.3.4.2">MHA</ci><vector id="S3.SS1.p4.3.m1.3.4.3.1.cmml" xref="S3.SS1.p4.3.m1.3.4.3.2"><ci id="S3.SS1.p4.3.m1.1.1.cmml" xref="S3.SS1.p4.3.m1.1.1">⋅</ci><ci id="S3.SS1.p4.3.m1.2.2.cmml" xref="S3.SS1.p4.3.m1.2.2">⋅</ci><ci id="S3.SS1.p4.3.m1.3.3.cmml" xref="S3.SS1.p4.3.m1.3.3">⋅</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m1.3c">\mathrm{MHA}(\cdot,\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m1.3d">roman_MHA ( ⋅ , ⋅ , ⋅ )</annotation></semantics></math> denotes a multi-head attention function. The residual connection and layer normalization are omitted for simplicity.</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p5.1.1">Target Text Decoder</span>. By utilizing the features generated by the image encoder, this decoder is responsible for producing text translations. In this way, it focuses on the alignment of different languages, and thus alleviates the modeling burden of the image decoder.</p>
</div>
<div class="ltx_para" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.2">When constructing our target text decoder, we employ the widely-used Transformer <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib33" title="">2017</a>)</cite> decoder as the architecture, consisting of multiple identical layers. In addition to the standard self-attention and FFN sub-layers, each decoder layer is equipped with a cross-attention sub-layer to exploit hidden states produced by the image encoder. Formally, we calculate the hidden states <math alttext="\mathbf{H}_{td}^{(l)}" class="ltx_Math" display="inline" id="S3.SS1.p6.1.m1.1"><semantics id="S3.SS1.p6.1.m1.1a"><msubsup id="S3.SS1.p6.1.m1.1.2" xref="S3.SS1.p6.1.m1.1.2.cmml"><mi id="S3.SS1.p6.1.m1.1.2.2.2" xref="S3.SS1.p6.1.m1.1.2.2.2.cmml">𝐇</mi><mrow id="S3.SS1.p6.1.m1.1.2.2.3" xref="S3.SS1.p6.1.m1.1.2.2.3.cmml"><mi id="S3.SS1.p6.1.m1.1.2.2.3.2" xref="S3.SS1.p6.1.m1.1.2.2.3.2.cmml">t</mi><mo id="S3.SS1.p6.1.m1.1.2.2.3.1" xref="S3.SS1.p6.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p6.1.m1.1.2.2.3.3" xref="S3.SS1.p6.1.m1.1.2.2.3.3.cmml">d</mi></mrow><mrow id="S3.SS1.p6.1.m1.1.1.1.3" xref="S3.SS1.p6.1.m1.1.2.cmml"><mo id="S3.SS1.p6.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p6.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p6.1.m1.1.1.1.1" xref="S3.SS1.p6.1.m1.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p6.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p6.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><apply id="S3.SS1.p6.1.m1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.2.1.cmml" xref="S3.SS1.p6.1.m1.1.2">superscript</csymbol><apply id="S3.SS1.p6.1.m1.1.2.2.cmml" xref="S3.SS1.p6.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.2.2.1.cmml" xref="S3.SS1.p6.1.m1.1.2">subscript</csymbol><ci id="S3.SS1.p6.1.m1.1.2.2.2.cmml" xref="S3.SS1.p6.1.m1.1.2.2.2">𝐇</ci><apply id="S3.SS1.p6.1.m1.1.2.2.3.cmml" xref="S3.SS1.p6.1.m1.1.2.2.3"><times id="S3.SS1.p6.1.m1.1.2.2.3.1.cmml" xref="S3.SS1.p6.1.m1.1.2.2.3.1"></times><ci id="S3.SS1.p6.1.m1.1.2.2.3.2.cmml" xref="S3.SS1.p6.1.m1.1.2.2.3.2">𝑡</ci><ci id="S3.SS1.p6.1.m1.1.2.2.3.3.cmml" xref="S3.SS1.p6.1.m1.1.2.2.3.3">𝑑</ci></apply></apply><ci id="S3.SS1.p6.1.m1.1.1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">\mathbf{H}_{td}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.1.m1.1d">bold_H start_POSTSUBSCRIPT italic_t italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> for the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.p6.2.m2.1"><semantics id="S3.SS1.p6.2.m2.1a"><mi id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><ci id="S3.SS1.p6.2.m2.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.2.m2.1d">italic_l</annotation></semantics></math>-th decoder layer using the following equations:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx1">
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{C}_{td}^{(l)}" class="ltx_Math" display="inline" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><msubsup id="S3.E3.m1.1.2" xref="S3.E3.m1.1.2.cmml"><mi id="S3.E3.m1.1.2.2.2" xref="S3.E3.m1.1.2.2.2.cmml">𝐂</mi><mrow id="S3.E3.m1.1.2.2.3" xref="S3.E3.m1.1.2.2.3.cmml"><mi id="S3.E3.m1.1.2.2.3.2" xref="S3.E3.m1.1.2.2.3.2.cmml">t</mi><mo id="S3.E3.m1.1.2.2.3.1" xref="S3.E3.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.2.2.3.3" xref="S3.E3.m1.1.2.2.3.3.cmml">d</mi></mrow><mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.2.cmml"><mo id="S3.E3.m1.1.1.1.3.1" stretchy="false" xref="S3.E3.m1.1.2.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">l</mi><mo id="S3.E3.m1.1.1.1.3.2" stretchy="false" xref="S3.E3.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.2.cmml" xref="S3.E3.m1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.1.cmml" xref="S3.E3.m1.1.2">superscript</csymbol><apply id="S3.E3.m1.1.2.2.cmml" xref="S3.E3.m1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.2.1.cmml" xref="S3.E3.m1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.2.2.2.cmml" xref="S3.E3.m1.1.2.2.2">𝐂</ci><apply id="S3.E3.m1.1.2.2.3.cmml" xref="S3.E3.m1.1.2.2.3"><times id="S3.E3.m1.1.2.2.3.1.cmml" xref="S3.E3.m1.1.2.2.3.1"></times><ci id="S3.E3.m1.1.2.2.3.2.cmml" xref="S3.E3.m1.1.2.2.3.2">𝑡</ci><ci id="S3.E3.m1.1.2.2.3.3.cmml" xref="S3.E3.m1.1.2.2.3.3">𝑑</ci></apply></apply><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle\mathbf{C}_{td}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">bold_C start_POSTSUBSCRIPT italic_t italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathrm{MHA}(\mathbf{H}_{td}^{(l-1)},\mathbf{H}_{td}^{(l-1)},%
\mathbf{H}_{td}^{(l-1)})," class="ltx_Math" display="inline" id="S3.E3.m2.4"><semantics id="S3.E3.m2.4a"><mrow id="S3.E3.m2.4.4.1" xref="S3.E3.m2.4.4.1.1.cmml"><mrow id="S3.E3.m2.4.4.1.1" xref="S3.E3.m2.4.4.1.1.cmml"><mi id="S3.E3.m2.4.4.1.1.5" xref="S3.E3.m2.4.4.1.1.5.cmml"></mi><mo id="S3.E3.m2.4.4.1.1.4" xref="S3.E3.m2.4.4.1.1.4.cmml">=</mo><mrow id="S3.E3.m2.4.4.1.1.3" xref="S3.E3.m2.4.4.1.1.3.cmml"><mi id="S3.E3.m2.4.4.1.1.3.5" xref="S3.E3.m2.4.4.1.1.3.5.cmml">MHA</mi><mo id="S3.E3.m2.4.4.1.1.3.4" xref="S3.E3.m2.4.4.1.1.3.4.cmml">⁢</mo><mrow id="S3.E3.m2.4.4.1.1.3.3.3" xref="S3.E3.m2.4.4.1.1.3.3.4.cmml"><mo id="S3.E3.m2.4.4.1.1.3.3.3.4" stretchy="false" xref="S3.E3.m2.4.4.1.1.3.3.4.cmml">(</mo><msubsup id="S3.E3.m2.4.4.1.1.1.1.1.1" xref="S3.E3.m2.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E3.m2.4.4.1.1.1.1.1.1.2.2" xref="S3.E3.m2.4.4.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mrow id="S3.E3.m2.4.4.1.1.1.1.1.1.2.3" xref="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.2" xref="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.1" xref="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.3" xref="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.3.cmml">d</mi></mrow><mrow id="S3.E3.m2.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.cmml"><mo id="S3.E3.m2.1.1.1.1.2" stretchy="false" xref="S3.E3.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m2.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.cmml"><mi id="S3.E3.m2.1.1.1.1.1.2" xref="S3.E3.m2.1.1.1.1.1.2.cmml">l</mi><mo id="S3.E3.m2.1.1.1.1.1.1" xref="S3.E3.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E3.m2.1.1.1.1.1.3" xref="S3.E3.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E3.m2.1.1.1.1.3" stretchy="false" xref="S3.E3.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E3.m2.4.4.1.1.3.3.3.5" xref="S3.E3.m2.4.4.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E3.m2.4.4.1.1.2.2.2.2" xref="S3.E3.m2.4.4.1.1.2.2.2.2.cmml"><mi id="S3.E3.m2.4.4.1.1.2.2.2.2.2.2" xref="S3.E3.m2.4.4.1.1.2.2.2.2.2.2.cmml">𝐇</mi><mrow id="S3.E3.m2.4.4.1.1.2.2.2.2.2.3" xref="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.2" xref="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.1" xref="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.3" xref="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.3.cmml">d</mi></mrow><mrow id="S3.E3.m2.2.2.1.1" xref="S3.E3.m2.2.2.1.1.1.cmml"><mo id="S3.E3.m2.2.2.1.1.2" stretchy="false" xref="S3.E3.m2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E3.m2.2.2.1.1.1" xref="S3.E3.m2.2.2.1.1.1.cmml"><mi id="S3.E3.m2.2.2.1.1.1.2" xref="S3.E3.m2.2.2.1.1.1.2.cmml">l</mi><mo id="S3.E3.m2.2.2.1.1.1.1" xref="S3.E3.m2.2.2.1.1.1.1.cmml">−</mo><mn id="S3.E3.m2.2.2.1.1.1.3" xref="S3.E3.m2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E3.m2.2.2.1.1.3" stretchy="false" xref="S3.E3.m2.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E3.m2.4.4.1.1.3.3.3.6" xref="S3.E3.m2.4.4.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E3.m2.4.4.1.1.3.3.3.3" xref="S3.E3.m2.4.4.1.1.3.3.3.3.cmml"><mi id="S3.E3.m2.4.4.1.1.3.3.3.3.2.2" xref="S3.E3.m2.4.4.1.1.3.3.3.3.2.2.cmml">𝐇</mi><mrow id="S3.E3.m2.4.4.1.1.3.3.3.3.2.3" xref="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.cmml"><mi id="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.2" xref="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.2.cmml">t</mi><mo id="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.1" xref="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.3" xref="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.3.cmml">d</mi></mrow><mrow id="S3.E3.m2.3.3.1.1" xref="S3.E3.m2.3.3.1.1.1.cmml"><mo id="S3.E3.m2.3.3.1.1.2" stretchy="false" xref="S3.E3.m2.3.3.1.1.1.cmml">(</mo><mrow id="S3.E3.m2.3.3.1.1.1" xref="S3.E3.m2.3.3.1.1.1.cmml"><mi id="S3.E3.m2.3.3.1.1.1.2" xref="S3.E3.m2.3.3.1.1.1.2.cmml">l</mi><mo id="S3.E3.m2.3.3.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.cmml">−</mo><mn id="S3.E3.m2.3.3.1.1.1.3" xref="S3.E3.m2.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E3.m2.3.3.1.1.3" stretchy="false" xref="S3.E3.m2.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E3.m2.4.4.1.1.3.3.3.7" stretchy="false" xref="S3.E3.m2.4.4.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m2.4.4.1.2" xref="S3.E3.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.4b"><apply id="S3.E3.m2.4.4.1.1.cmml" xref="S3.E3.m2.4.4.1"><eq id="S3.E3.m2.4.4.1.1.4.cmml" xref="S3.E3.m2.4.4.1.1.4"></eq><csymbol cd="latexml" id="S3.E3.m2.4.4.1.1.5.cmml" xref="S3.E3.m2.4.4.1.1.5">absent</csymbol><apply id="S3.E3.m2.4.4.1.1.3.cmml" xref="S3.E3.m2.4.4.1.1.3"><times id="S3.E3.m2.4.4.1.1.3.4.cmml" xref="S3.E3.m2.4.4.1.1.3.4"></times><ci id="S3.E3.m2.4.4.1.1.3.5.cmml" xref="S3.E3.m2.4.4.1.1.3.5">MHA</ci><vector id="S3.E3.m2.4.4.1.1.3.3.4.cmml" xref="S3.E3.m2.4.4.1.1.3.3.3"><apply id="S3.E3.m2.4.4.1.1.1.1.1.1.cmml" xref="S3.E3.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m2.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m2.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m2.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m2.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m2.4.4.1.1.1.1.1.1.2.2">𝐇</ci><apply id="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m2.4.4.1.1.1.1.1.1.2.3"><times id="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.2">𝑡</ci><ci id="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m2.4.4.1.1.1.1.1.1.2.3.3">𝑑</ci></apply></apply><apply id="S3.E3.m2.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1"><minus id="S3.E3.m2.1.1.1.1.1.1.cmml" xref="S3.E3.m2.1.1.1.1.1.1"></minus><ci id="S3.E3.m2.1.1.1.1.1.2.cmml" xref="S3.E3.m2.1.1.1.1.1.2">𝑙</ci><cn id="S3.E3.m2.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m2.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E3.m2.4.4.1.1.2.2.2.2.cmml" xref="S3.E3.m2.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m2.4.4.1.1.2.2.2.2.1.cmml" xref="S3.E3.m2.4.4.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E3.m2.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E3.m2.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m2.4.4.1.1.2.2.2.2.2.1.cmml" xref="S3.E3.m2.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m2.4.4.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m2.4.4.1.1.2.2.2.2.2.2">𝐇</ci><apply id="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.cmml" xref="S3.E3.m2.4.4.1.1.2.2.2.2.2.3"><times id="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.1"></times><ci id="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.2">𝑡</ci><ci id="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E3.m2.4.4.1.1.2.2.2.2.2.3.3">𝑑</ci></apply></apply><apply id="S3.E3.m2.2.2.1.1.1.cmml" xref="S3.E3.m2.2.2.1.1"><minus id="S3.E3.m2.2.2.1.1.1.1.cmml" xref="S3.E3.m2.2.2.1.1.1.1"></minus><ci id="S3.E3.m2.2.2.1.1.1.2.cmml" xref="S3.E3.m2.2.2.1.1.1.2">𝑙</ci><cn id="S3.E3.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.E3.m2.2.2.1.1.1.3">1</cn></apply></apply><apply id="S3.E3.m2.4.4.1.1.3.3.3.3.cmml" xref="S3.E3.m2.4.4.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m2.4.4.1.1.3.3.3.3.1.cmml" xref="S3.E3.m2.4.4.1.1.3.3.3.3">superscript</csymbol><apply id="S3.E3.m2.4.4.1.1.3.3.3.3.2.cmml" xref="S3.E3.m2.4.4.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m2.4.4.1.1.3.3.3.3.2.1.cmml" xref="S3.E3.m2.4.4.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E3.m2.4.4.1.1.3.3.3.3.2.2.cmml" xref="S3.E3.m2.4.4.1.1.3.3.3.3.2.2">𝐇</ci><apply id="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.cmml" xref="S3.E3.m2.4.4.1.1.3.3.3.3.2.3"><times id="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.1.cmml" xref="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.1"></times><ci id="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.2.cmml" xref="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.2">𝑡</ci><ci id="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.3.cmml" xref="S3.E3.m2.4.4.1.1.3.3.3.3.2.3.3">𝑑</ci></apply></apply><apply id="S3.E3.m2.3.3.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1"><minus id="S3.E3.m2.3.3.1.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1"></minus><ci id="S3.E3.m2.3.3.1.1.1.2.cmml" xref="S3.E3.m2.3.3.1.1.1.2">𝑙</ci><cn id="S3.E3.m2.3.3.1.1.1.3.cmml" type="integer" xref="S3.E3.m2.3.3.1.1.1.3">1</cn></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.4c">\displaystyle=\mathrm{MHA}(\mathbf{H}_{td}^{(l-1)},\mathbf{H}_{td}^{(l-1)},%
\mathbf{H}_{td}^{(l-1)}),</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m2.4d">= roman_MHA ( bold_H start_POSTSUBSCRIPT italic_t italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_t italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_t italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}_{td}^{(l)}" class="ltx_Math" display="inline" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><msubsup id="S3.E4.m1.1.2" xref="S3.E4.m1.1.2.cmml"><mi id="S3.E4.m1.1.2.2.2" xref="S3.E4.m1.1.2.2.2.cmml">𝐇</mi><mrow id="S3.E4.m1.1.2.2.3" xref="S3.E4.m1.1.2.2.3.cmml"><mi id="S3.E4.m1.1.2.2.3.2" xref="S3.E4.m1.1.2.2.3.2.cmml">t</mi><mo id="S3.E4.m1.1.2.2.3.1" xref="S3.E4.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.1.2.2.3.3" xref="S3.E4.m1.1.2.2.3.3.cmml">d</mi></mrow><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.1.2.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">l</mi><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.2.cmml" xref="S3.E4.m1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.1.cmml" xref="S3.E4.m1.1.2">superscript</csymbol><apply id="S3.E4.m1.1.2.2.cmml" xref="S3.E4.m1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.2.2.1.cmml" xref="S3.E4.m1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.2.2.2.cmml" xref="S3.E4.m1.1.2.2.2">𝐇</ci><apply id="S3.E4.m1.1.2.2.3.cmml" xref="S3.E4.m1.1.2.2.3"><times id="S3.E4.m1.1.2.2.3.1.cmml" xref="S3.E4.m1.1.2.2.3.1"></times><ci id="S3.E4.m1.1.2.2.3.2.cmml" xref="S3.E4.m1.1.2.2.3.2">𝑡</ci><ci id="S3.E4.m1.1.2.2.3.3.cmml" xref="S3.E4.m1.1.2.2.3.3">𝑑</ci></apply></apply><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\displaystyle\mathbf{H}_{td}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">bold_H start_POSTSUBSCRIPT italic_t italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathrm{FFN}({\mathrm{MHA}(\mathbf{C}_{td}^{(l)},\mathbf{H}_{ie}%
^{(L)},\mathbf{H}_{ie}^{(L)}))}," class="ltx_Math" display="inline" id="S3.E4.m2.4"><semantics id="S3.E4.m2.4a"><mrow id="S3.E4.m2.4.4.1" xref="S3.E4.m2.4.4.1.1.cmml"><mrow id="S3.E4.m2.4.4.1.1" xref="S3.E4.m2.4.4.1.1.cmml"><mi id="S3.E4.m2.4.4.1.1.3" xref="S3.E4.m2.4.4.1.1.3.cmml"></mi><mo id="S3.E4.m2.4.4.1.1.2" xref="S3.E4.m2.4.4.1.1.2.cmml">=</mo><mrow id="S3.E4.m2.4.4.1.1.1" xref="S3.E4.m2.4.4.1.1.1.cmml"><mi id="S3.E4.m2.4.4.1.1.1.3" xref="S3.E4.m2.4.4.1.1.1.3.cmml">FFN</mi><mo id="S3.E4.m2.4.4.1.1.1.2" xref="S3.E4.m2.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m2.4.4.1.1.1.1.1" xref="S3.E4.m2.4.4.1.1.1.1.1.1.cmml"><mo id="S3.E4.m2.4.4.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m2.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m2.4.4.1.1.1.1.1.1" xref="S3.E4.m2.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E4.m2.4.4.1.1.1.1.1.1.5" xref="S3.E4.m2.4.4.1.1.1.1.1.1.5.cmml">MHA</mi><mo id="S3.E4.m2.4.4.1.1.1.1.1.1.4" xref="S3.E4.m2.4.4.1.1.1.1.1.1.4.cmml">⁢</mo><mrow id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.4.cmml"><mo id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.4" stretchy="false" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.4.cmml">(</mo><msubsup id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐂</mi><mrow id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.3.cmml">d</mi></mrow><mrow id="S3.E4.m2.1.1.1.3" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m2.1.1.1.3.1" stretchy="false" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m2.1.1.1.1" xref="S3.E4.m2.1.1.1.1.cmml">l</mi><mo id="S3.E4.m2.1.1.1.3.2" stretchy="false" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.5" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.4.cmml">,</mo><msubsup id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐇</mi><mrow id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.2" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.1" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.3" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.3.cmml">e</mi></mrow><mrow id="S3.E4.m2.2.2.1.3" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.cmml"><mo id="S3.E4.m2.2.2.1.3.1" stretchy="false" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.cmml">(</mo><mi id="S3.E4.m2.2.2.1.1" xref="S3.E4.m2.2.2.1.1.cmml">L</mi><mo id="S3.E4.m2.2.2.1.3.2" stretchy="false" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.6" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.4.cmml">,</mo><msubsup id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.2" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.2.cmml">𝐇</mi><mrow id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.cmml"><mi id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.2" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.2.cmml">i</mi><mo id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.1" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.3" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.3.cmml">e</mi></mrow><mrow id="S3.E4.m2.3.3.1.3" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.cmml"><mo id="S3.E4.m2.3.3.1.3.1" stretchy="false" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.cmml">(</mo><mi id="S3.E4.m2.3.3.1.1" xref="S3.E4.m2.3.3.1.1.cmml">L</mi><mo id="S3.E4.m2.3.3.1.3.2" stretchy="false" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.7" stretchy="false" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E4.m2.4.4.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m2.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m2.4.4.1.2" xref="S3.E4.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m2.4b"><apply id="S3.E4.m2.4.4.1.1.cmml" xref="S3.E4.m2.4.4.1"><eq id="S3.E4.m2.4.4.1.1.2.cmml" xref="S3.E4.m2.4.4.1.1.2"></eq><csymbol cd="latexml" id="S3.E4.m2.4.4.1.1.3.cmml" xref="S3.E4.m2.4.4.1.1.3">absent</csymbol><apply id="S3.E4.m2.4.4.1.1.1.cmml" xref="S3.E4.m2.4.4.1.1.1"><times id="S3.E4.m2.4.4.1.1.1.2.cmml" xref="S3.E4.m2.4.4.1.1.1.2"></times><ci id="S3.E4.m2.4.4.1.1.1.3.cmml" xref="S3.E4.m2.4.4.1.1.1.3">FFN</ci><apply id="S3.E4.m2.4.4.1.1.1.1.1.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1"><times id="S3.E4.m2.4.4.1.1.1.1.1.1.4.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.4"></times><ci id="S3.E4.m2.4.4.1.1.1.1.1.1.5.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.5">MHA</ci><vector id="S3.E4.m2.4.4.1.1.1.1.1.1.3.4.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3"><apply id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.2">𝐂</ci><apply id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3"><times id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><ci id="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.1.1.1.2.3.3">𝑑</ci></apply></apply><ci id="S3.E4.m2.1.1.1.1.cmml" xref="S3.E4.m2.1.1.1.1">𝑙</ci></apply><apply id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.2">𝐇</ci><apply id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3"><times id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.2">𝑖</ci><ci id="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.2.2.2.2.3.3">𝑒</ci></apply></apply><ci id="S3.E4.m2.2.2.1.1.cmml" xref="S3.E4.m2.2.2.1.1">𝐿</ci></apply><apply id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3">superscript</csymbol><apply id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.2">𝐇</ci><apply id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3"><times id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.1.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.1"></times><ci id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.2.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.2">𝑖</ci><ci id="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.3.cmml" xref="S3.E4.m2.4.4.1.1.1.1.1.1.3.3.3.2.3.3">𝑒</ci></apply></apply><ci id="S3.E4.m2.3.3.1.1.cmml" xref="S3.E4.m2.3.3.1.1">𝐿</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m2.4c">\displaystyle=\mathrm{FFN}({\mathrm{MHA}(\mathbf{C}_{td}^{(l)},\mathbf{H}_{ie}%
^{(L)},\mathbf{H}_{ie}^{(L)}))},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m2.4d">= roman_FFN ( roman_MHA ( bold_C start_POSTSUBSCRIPT italic_t italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p6.4">where the initial hidden states <math alttext="\mathbf{H}_{td}^{(0)}" class="ltx_Math" display="inline" id="S3.SS1.p6.3.m1.1"><semantics id="S3.SS1.p6.3.m1.1a"><msubsup id="S3.SS1.p6.3.m1.1.2" xref="S3.SS1.p6.3.m1.1.2.cmml"><mi id="S3.SS1.p6.3.m1.1.2.2.2" xref="S3.SS1.p6.3.m1.1.2.2.2.cmml">𝐇</mi><mrow id="S3.SS1.p6.3.m1.1.2.2.3" xref="S3.SS1.p6.3.m1.1.2.2.3.cmml"><mi id="S3.SS1.p6.3.m1.1.2.2.3.2" xref="S3.SS1.p6.3.m1.1.2.2.3.2.cmml">t</mi><mo id="S3.SS1.p6.3.m1.1.2.2.3.1" xref="S3.SS1.p6.3.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p6.3.m1.1.2.2.3.3" xref="S3.SS1.p6.3.m1.1.2.2.3.3.cmml">d</mi></mrow><mrow id="S3.SS1.p6.3.m1.1.1.1.3" xref="S3.SS1.p6.3.m1.1.2.cmml"><mo id="S3.SS1.p6.3.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p6.3.m1.1.2.cmml">(</mo><mn id="S3.SS1.p6.3.m1.1.1.1.1" xref="S3.SS1.p6.3.m1.1.1.1.1.cmml">0</mn><mo id="S3.SS1.p6.3.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p6.3.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.3.m1.1b"><apply id="S3.SS1.p6.3.m1.1.2.cmml" xref="S3.SS1.p6.3.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m1.1.2.1.cmml" xref="S3.SS1.p6.3.m1.1.2">superscript</csymbol><apply id="S3.SS1.p6.3.m1.1.2.2.cmml" xref="S3.SS1.p6.3.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m1.1.2.2.1.cmml" xref="S3.SS1.p6.3.m1.1.2">subscript</csymbol><ci id="S3.SS1.p6.3.m1.1.2.2.2.cmml" xref="S3.SS1.p6.3.m1.1.2.2.2">𝐇</ci><apply id="S3.SS1.p6.3.m1.1.2.2.3.cmml" xref="S3.SS1.p6.3.m1.1.2.2.3"><times id="S3.SS1.p6.3.m1.1.2.2.3.1.cmml" xref="S3.SS1.p6.3.m1.1.2.2.3.1"></times><ci id="S3.SS1.p6.3.m1.1.2.2.3.2.cmml" xref="S3.SS1.p6.3.m1.1.2.2.3.2">𝑡</ci><ci id="S3.SS1.p6.3.m1.1.2.2.3.3.cmml" xref="S3.SS1.p6.3.m1.1.2.2.3.3">𝑑</ci></apply></apply><cn id="S3.SS1.p6.3.m1.1.1.1.1.cmml" type="integer" xref="S3.SS1.p6.3.m1.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.3.m1.1c">\mathbf{H}_{td}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.3.m1.1d">bold_H start_POSTSUBSCRIPT italic_t italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math> are computed by summing the word embeddings and position embeddings of the input sequence. Unless otherwise specified, we use <math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.p6.4.m2.1"><semantics id="S3.SS1.p6.4.m2.1a"><mi id="S3.SS1.p6.4.m2.1.1" xref="S3.SS1.p6.4.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.4.m2.1b"><ci id="S3.SS1.p6.4.m2.1.1.cmml" xref="S3.SS1.p6.4.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.4.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.4.m2.1d">italic_L</annotation></semantics></math> to represent the last layer.</p>
</div>
<div class="ltx_para" id="S3.SS1.p7">
<p class="ltx_p" id="S3.SS1.p7.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p7.1.1">Image Decoder</span>. This module is responsible for generating visual tokens based on visual and linguistic information generated from the image encoder and target text decoder, respectively.</p>
</div>
<div class="ltx_para" id="S3.SS1.p8">
<p class="ltx_p" id="S3.SS1.p8.1">The architecture of the image decoder closely resembles that of the target text decoder but with the following notable modifications. It includes two cross-attention sub-layers to gather information from both the image encoder and target text decoder, followed by a fusion sub-layer to generate intermediate representations enriched with both visual and linguistic features. Besides, we incorporate the 2D relative position encoding <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib37" title="">2021</a>)</cite> into the self-attention sub-layer to capture relative positional relationships within images.</p>
</div>
<div class="ltx_para" id="S3.SS1.p9">
<p class="ltx_p" id="S3.SS1.p9.2">Let <math alttext="\mathbf{C}_{id}^{(l)}" class="ltx_Math" display="inline" id="S3.SS1.p9.1.m1.1"><semantics id="S3.SS1.p9.1.m1.1a"><msubsup id="S3.SS1.p9.1.m1.1.2" xref="S3.SS1.p9.1.m1.1.2.cmml"><mi id="S3.SS1.p9.1.m1.1.2.2.2" xref="S3.SS1.p9.1.m1.1.2.2.2.cmml">𝐂</mi><mrow id="S3.SS1.p9.1.m1.1.2.2.3" xref="S3.SS1.p9.1.m1.1.2.2.3.cmml"><mi id="S3.SS1.p9.1.m1.1.2.2.3.2" xref="S3.SS1.p9.1.m1.1.2.2.3.2.cmml">i</mi><mo id="S3.SS1.p9.1.m1.1.2.2.3.1" xref="S3.SS1.p9.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p9.1.m1.1.2.2.3.3" xref="S3.SS1.p9.1.m1.1.2.2.3.3.cmml">d</mi></mrow><mrow id="S3.SS1.p9.1.m1.1.1.1.3" xref="S3.SS1.p9.1.m1.1.2.cmml"><mo id="S3.SS1.p9.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p9.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p9.1.m1.1.1.1.1" xref="S3.SS1.p9.1.m1.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p9.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p9.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.1.m1.1b"><apply id="S3.SS1.p9.1.m1.1.2.cmml" xref="S3.SS1.p9.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p9.1.m1.1.2.1.cmml" xref="S3.SS1.p9.1.m1.1.2">superscript</csymbol><apply id="S3.SS1.p9.1.m1.1.2.2.cmml" xref="S3.SS1.p9.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p9.1.m1.1.2.2.1.cmml" xref="S3.SS1.p9.1.m1.1.2">subscript</csymbol><ci id="S3.SS1.p9.1.m1.1.2.2.2.cmml" xref="S3.SS1.p9.1.m1.1.2.2.2">𝐂</ci><apply id="S3.SS1.p9.1.m1.1.2.2.3.cmml" xref="S3.SS1.p9.1.m1.1.2.2.3"><times id="S3.SS1.p9.1.m1.1.2.2.3.1.cmml" xref="S3.SS1.p9.1.m1.1.2.2.3.1"></times><ci id="S3.SS1.p9.1.m1.1.2.2.3.2.cmml" xref="S3.SS1.p9.1.m1.1.2.2.3.2">𝑖</ci><ci id="S3.SS1.p9.1.m1.1.2.2.3.3.cmml" xref="S3.SS1.p9.1.m1.1.2.2.3.3">𝑑</ci></apply></apply><ci id="S3.SS1.p9.1.m1.1.1.1.1.cmml" xref="S3.SS1.p9.1.m1.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.1.m1.1c">\mathbf{C}_{id}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p9.1.m1.1d">bold_C start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> denote the hidden states output by the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.p9.2.m2.1"><semantics id="S3.SS1.p9.2.m2.1a"><mi id="S3.SS1.p9.2.m2.1.1" xref="S3.SS1.p9.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.2.m2.1b"><ci id="S3.SS1.p9.2.m2.1.1.cmml" xref="S3.SS1.p9.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p9.2.m2.1d">italic_l</annotation></semantics></math>-th self-attention sub-layer, we calculate it in the following way:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{C}_{id}^{(l)}=\mathrm{MHA}(\mathbf{H}_{id}^{(l-1)},\mathbf{H}_{id}^{(l%
-1)},\mathbf{H}_{id}^{(l-1)})," class="ltx_Math" display="block" id="S3.E5.m1.5"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5.5.1" xref="S3.E5.m1.5.5.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml"><msubsup id="S3.E5.m1.5.5.1.1.5" xref="S3.E5.m1.5.5.1.1.5.cmml"><mi id="S3.E5.m1.5.5.1.1.5.2.2" xref="S3.E5.m1.5.5.1.1.5.2.2.cmml">𝐂</mi><mrow id="S3.E5.m1.5.5.1.1.5.2.3" xref="S3.E5.m1.5.5.1.1.5.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1.5.2.3.2" xref="S3.E5.m1.5.5.1.1.5.2.3.2.cmml">i</mi><mo id="S3.E5.m1.5.5.1.1.5.2.3.1" xref="S3.E5.m1.5.5.1.1.5.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.5.5.1.1.5.2.3.3" xref="S3.E5.m1.5.5.1.1.5.2.3.3.cmml">d</mi></mrow><mrow id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.5.cmml"><mo id="S3.E5.m1.1.1.1.3.1" stretchy="false" xref="S3.E5.m1.5.5.1.1.5.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">l</mi><mo id="S3.E5.m1.1.1.1.3.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.5.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.5.5.1.1.4" xref="S3.E5.m1.5.5.1.1.4.cmml">=</mo><mrow id="S3.E5.m1.5.5.1.1.3" xref="S3.E5.m1.5.5.1.1.3.cmml"><mi id="S3.E5.m1.5.5.1.1.3.5" xref="S3.E5.m1.5.5.1.1.3.5.cmml">MHA</mi><mo id="S3.E5.m1.5.5.1.1.3.4" xref="S3.E5.m1.5.5.1.1.3.4.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.1.1.3.3.3" xref="S3.E5.m1.5.5.1.1.3.3.4.cmml"><mo id="S3.E5.m1.5.5.1.1.3.3.3.4" stretchy="false" xref="S3.E5.m1.5.5.1.1.3.3.4.cmml">(</mo><msubsup id="S3.E5.m1.5.5.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.2.cmml">𝐇</mi><mrow id="S3.E5.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.3.cmml">d</mi></mrow><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mo id="S3.E5.m1.2.2.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.2.cmml">l</mi><mo id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E5.m1.2.2.1.1.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.5.5.1.1.3.3.3.5" xref="S3.E5.m1.5.5.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E5.m1.5.5.1.1.2.2.2.2" xref="S3.E5.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S3.E5.m1.5.5.1.1.2.2.2.2.2.2" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2.2.cmml">𝐇</mi><mrow id="S3.E5.m1.5.5.1.1.2.2.2.2.2.3" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.2" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.1" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.3" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.3.cmml">d</mi></mrow><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.1.cmml"><mo id="S3.E5.m1.3.3.1.1.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.2.cmml">l</mi><mo id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.cmml">−</mo><mn id="S3.E5.m1.3.3.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E5.m1.3.3.1.1.3" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.5.5.1.1.3.3.3.6" xref="S3.E5.m1.5.5.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E5.m1.5.5.1.1.3.3.3.3" xref="S3.E5.m1.5.5.1.1.3.3.3.3.cmml"><mi id="S3.E5.m1.5.5.1.1.3.3.3.3.2.2" xref="S3.E5.m1.5.5.1.1.3.3.3.3.2.2.cmml">𝐇</mi><mrow id="S3.E5.m1.5.5.1.1.3.3.3.3.2.3" xref="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.2" xref="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.2.cmml">i</mi><mo id="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.1" xref="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.3" xref="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.3.cmml">d</mi></mrow><mrow id="S3.E5.m1.4.4.1.1" xref="S3.E5.m1.4.4.1.1.1.cmml"><mo id="S3.E5.m1.4.4.1.1.2" stretchy="false" xref="S3.E5.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.4.4.1.1.1" xref="S3.E5.m1.4.4.1.1.1.cmml"><mi id="S3.E5.m1.4.4.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.2.cmml">l</mi><mo id="S3.E5.m1.4.4.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.cmml">−</mo><mn id="S3.E5.m1.4.4.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E5.m1.4.4.1.1.3" stretchy="false" xref="S3.E5.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.5.5.1.1.3.3.3.7" stretchy="false" xref="S3.E5.m1.5.5.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.5.5.1.2" xref="S3.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b"><apply id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1"><eq id="S3.E5.m1.5.5.1.1.4.cmml" xref="S3.E5.m1.5.5.1.1.4"></eq><apply id="S3.E5.m1.5.5.1.1.5.cmml" xref="S3.E5.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.5.1.cmml" xref="S3.E5.m1.5.5.1.1.5">superscript</csymbol><apply id="S3.E5.m1.5.5.1.1.5.2.cmml" xref="S3.E5.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.5.2.1.cmml" xref="S3.E5.m1.5.5.1.1.5">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.5.2.2.cmml" xref="S3.E5.m1.5.5.1.1.5.2.2">𝐂</ci><apply id="S3.E5.m1.5.5.1.1.5.2.3.cmml" xref="S3.E5.m1.5.5.1.1.5.2.3"><times id="S3.E5.m1.5.5.1.1.5.2.3.1.cmml" xref="S3.E5.m1.5.5.1.1.5.2.3.1"></times><ci id="S3.E5.m1.5.5.1.1.5.2.3.2.cmml" xref="S3.E5.m1.5.5.1.1.5.2.3.2">𝑖</ci><ci id="S3.E5.m1.5.5.1.1.5.2.3.3.cmml" xref="S3.E5.m1.5.5.1.1.5.2.3.3">𝑑</ci></apply></apply><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑙</ci></apply><apply id="S3.E5.m1.5.5.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.3"><times id="S3.E5.m1.5.5.1.1.3.4.cmml" xref="S3.E5.m1.5.5.1.1.3.4"></times><ci id="S3.E5.m1.5.5.1.1.3.5.cmml" xref="S3.E5.m1.5.5.1.1.3.5">MHA</ci><vector id="S3.E5.m1.5.5.1.1.3.3.4.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3"><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.2">𝐇</ci><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.3"><times id="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.3">𝑑</ci></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1"><minus id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"></minus><ci id="S3.E5.m1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2">𝑙</ci><cn id="S3.E5.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="S3.E5.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E5.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2.2">𝐇</ci><apply id="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2.3"><times id="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.1"></times><ci id="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.2">𝑖</ci><ci id="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E5.m1.5.5.1.1.2.2.2.2.2.3.3">𝑑</ci></apply></apply><apply id="S3.E5.m1.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1"><minus id="S3.E5.m1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1"></minus><ci id="S3.E5.m1.3.3.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.2">𝑙</ci><cn id="S3.E5.m1.3.3.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.3.3.1.1.1.3">1</cn></apply></apply><apply id="S3.E5.m1.5.5.1.1.3.3.3.3.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3">superscript</csymbol><apply id="S3.E5.m1.5.5.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.3.3.3.3.2.1.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.3.3.3.3.2.2.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3.2.2">𝐇</ci><apply id="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3.2.3"><times id="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.1.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.1"></times><ci id="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.2.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.2">𝑖</ci><ci id="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.3.cmml" xref="S3.E5.m1.5.5.1.1.3.3.3.3.2.3.3">𝑑</ci></apply></apply><apply id="S3.E5.m1.4.4.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1"><minus id="S3.E5.m1.4.4.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1"></minus><ci id="S3.E5.m1.4.4.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.2">𝑙</ci><cn id="S3.E5.m1.4.4.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.4.4.1.1.1.3">1</cn></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.5c">\mathbf{C}_{id}^{(l)}=\mathrm{MHA}(\mathbf{H}_{id}^{(l-1)},\mathbf{H}_{id}^{(l%
-1)},\mathbf{H}_{id}^{(l-1)}),</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.5d">bold_C start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = roman_MHA ( bold_H start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p9.6">where <math alttext="\mathbf{H}_{id}^{(l-1)}" class="ltx_Math" display="inline" id="S3.SS1.p9.3.m1.1"><semantics id="S3.SS1.p9.3.m1.1a"><msubsup id="S3.SS1.p9.3.m1.1.2" xref="S3.SS1.p9.3.m1.1.2.cmml"><mi id="S3.SS1.p9.3.m1.1.2.2.2" xref="S3.SS1.p9.3.m1.1.2.2.2.cmml">𝐇</mi><mrow id="S3.SS1.p9.3.m1.1.2.2.3" xref="S3.SS1.p9.3.m1.1.2.2.3.cmml"><mi id="S3.SS1.p9.3.m1.1.2.2.3.2" xref="S3.SS1.p9.3.m1.1.2.2.3.2.cmml">i</mi><mo id="S3.SS1.p9.3.m1.1.2.2.3.1" xref="S3.SS1.p9.3.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p9.3.m1.1.2.2.3.3" xref="S3.SS1.p9.3.m1.1.2.2.3.3.cmml">d</mi></mrow><mrow id="S3.SS1.p9.3.m1.1.1.1.1" xref="S3.SS1.p9.3.m1.1.1.1.1.1.cmml"><mo id="S3.SS1.p9.3.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p9.3.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p9.3.m1.1.1.1.1.1" xref="S3.SS1.p9.3.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p9.3.m1.1.1.1.1.1.2" xref="S3.SS1.p9.3.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S3.SS1.p9.3.m1.1.1.1.1.1.1" xref="S3.SS1.p9.3.m1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS1.p9.3.m1.1.1.1.1.1.3" xref="S3.SS1.p9.3.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p9.3.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p9.3.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.3.m1.1b"><apply id="S3.SS1.p9.3.m1.1.2.cmml" xref="S3.SS1.p9.3.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p9.3.m1.1.2.1.cmml" xref="S3.SS1.p9.3.m1.1.2">superscript</csymbol><apply id="S3.SS1.p9.3.m1.1.2.2.cmml" xref="S3.SS1.p9.3.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p9.3.m1.1.2.2.1.cmml" xref="S3.SS1.p9.3.m1.1.2">subscript</csymbol><ci id="S3.SS1.p9.3.m1.1.2.2.2.cmml" xref="S3.SS1.p9.3.m1.1.2.2.2">𝐇</ci><apply id="S3.SS1.p9.3.m1.1.2.2.3.cmml" xref="S3.SS1.p9.3.m1.1.2.2.3"><times id="S3.SS1.p9.3.m1.1.2.2.3.1.cmml" xref="S3.SS1.p9.3.m1.1.2.2.3.1"></times><ci id="S3.SS1.p9.3.m1.1.2.2.3.2.cmml" xref="S3.SS1.p9.3.m1.1.2.2.3.2">𝑖</ci><ci id="S3.SS1.p9.3.m1.1.2.2.3.3.cmml" xref="S3.SS1.p9.3.m1.1.2.2.3.3">𝑑</ci></apply></apply><apply id="S3.SS1.p9.3.m1.1.1.1.1.1.cmml" xref="S3.SS1.p9.3.m1.1.1.1.1"><minus id="S3.SS1.p9.3.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p9.3.m1.1.1.1.1.1.1"></minus><ci id="S3.SS1.p9.3.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p9.3.m1.1.1.1.1.1.2">𝑙</ci><cn id="S3.SS1.p9.3.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p9.3.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.3.m1.1c">\mathbf{H}_{id}^{(l-1)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p9.3.m1.1d">bold_H start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math> represents the hidden state output by the (<math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.p9.4.m2.1"><semantics id="S3.SS1.p9.4.m2.1a"><mi id="S3.SS1.p9.4.m2.1.1" xref="S3.SS1.p9.4.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.4.m2.1b"><ci id="S3.SS1.p9.4.m2.1.1.cmml" xref="S3.SS1.p9.4.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.4.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p9.4.m2.1d">italic_l</annotation></semantics></math>-1)-th image decoder layer. Subsequently, the hidden states <math alttext="\mathbf{\overline{H}}_{id}^{(l)}" class="ltx_Math" display="inline" id="S3.SS1.p9.5.m3.1"><semantics id="S3.SS1.p9.5.m3.1a"><msubsup id="S3.SS1.p9.5.m3.1.2" xref="S3.SS1.p9.5.m3.1.2.cmml"><mover accent="true" id="S3.SS1.p9.5.m3.1.2.2.2" xref="S3.SS1.p9.5.m3.1.2.2.2.cmml"><mi id="S3.SS1.p9.5.m3.1.2.2.2.2" xref="S3.SS1.p9.5.m3.1.2.2.2.2.cmml">𝐇</mi><mo id="S3.SS1.p9.5.m3.1.2.2.2.1" xref="S3.SS1.p9.5.m3.1.2.2.2.1.cmml">¯</mo></mover><mrow id="S3.SS1.p9.5.m3.1.2.2.3" xref="S3.SS1.p9.5.m3.1.2.2.3.cmml"><mi id="S3.SS1.p9.5.m3.1.2.2.3.2" xref="S3.SS1.p9.5.m3.1.2.2.3.2.cmml">i</mi><mo id="S3.SS1.p9.5.m3.1.2.2.3.1" xref="S3.SS1.p9.5.m3.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p9.5.m3.1.2.2.3.3" xref="S3.SS1.p9.5.m3.1.2.2.3.3.cmml">d</mi></mrow><mrow id="S3.SS1.p9.5.m3.1.1.1.3" xref="S3.SS1.p9.5.m3.1.2.cmml"><mo id="S3.SS1.p9.5.m3.1.1.1.3.1" stretchy="false" xref="S3.SS1.p9.5.m3.1.2.cmml">(</mo><mi id="S3.SS1.p9.5.m3.1.1.1.1" xref="S3.SS1.p9.5.m3.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p9.5.m3.1.1.1.3.2" stretchy="false" xref="S3.SS1.p9.5.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.5.m3.1b"><apply id="S3.SS1.p9.5.m3.1.2.cmml" xref="S3.SS1.p9.5.m3.1.2"><csymbol cd="ambiguous" id="S3.SS1.p9.5.m3.1.2.1.cmml" xref="S3.SS1.p9.5.m3.1.2">superscript</csymbol><apply id="S3.SS1.p9.5.m3.1.2.2.cmml" xref="S3.SS1.p9.5.m3.1.2"><csymbol cd="ambiguous" id="S3.SS1.p9.5.m3.1.2.2.1.cmml" xref="S3.SS1.p9.5.m3.1.2">subscript</csymbol><apply id="S3.SS1.p9.5.m3.1.2.2.2.cmml" xref="S3.SS1.p9.5.m3.1.2.2.2"><ci id="S3.SS1.p9.5.m3.1.2.2.2.1.cmml" xref="S3.SS1.p9.5.m3.1.2.2.2.1">¯</ci><ci id="S3.SS1.p9.5.m3.1.2.2.2.2.cmml" xref="S3.SS1.p9.5.m3.1.2.2.2.2">𝐇</ci></apply><apply id="S3.SS1.p9.5.m3.1.2.2.3.cmml" xref="S3.SS1.p9.5.m3.1.2.2.3"><times id="S3.SS1.p9.5.m3.1.2.2.3.1.cmml" xref="S3.SS1.p9.5.m3.1.2.2.3.1"></times><ci id="S3.SS1.p9.5.m3.1.2.2.3.2.cmml" xref="S3.SS1.p9.5.m3.1.2.2.3.2">𝑖</ci><ci id="S3.SS1.p9.5.m3.1.2.2.3.3.cmml" xref="S3.SS1.p9.5.m3.1.2.2.3.3">𝑑</ci></apply></apply><ci id="S3.SS1.p9.5.m3.1.1.1.1.cmml" xref="S3.SS1.p9.5.m3.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.5.m3.1c">\mathbf{\overline{H}}_{id}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p9.5.m3.1d">over¯ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{\widetilde{H}}_{id}^{(l)}" class="ltx_Math" display="inline" id="S3.SS1.p9.6.m4.1"><semantics id="S3.SS1.p9.6.m4.1a"><msubsup id="S3.SS1.p9.6.m4.1.2" xref="S3.SS1.p9.6.m4.1.2.cmml"><mover accent="true" id="S3.SS1.p9.6.m4.1.2.2.2" xref="S3.SS1.p9.6.m4.1.2.2.2.cmml"><mi id="S3.SS1.p9.6.m4.1.2.2.2.2" xref="S3.SS1.p9.6.m4.1.2.2.2.2.cmml">𝐇</mi><mo id="S3.SS1.p9.6.m4.1.2.2.2.1" xref="S3.SS1.p9.6.m4.1.2.2.2.1.cmml">~</mo></mover><mrow id="S3.SS1.p9.6.m4.1.2.2.3" xref="S3.SS1.p9.6.m4.1.2.2.3.cmml"><mi id="S3.SS1.p9.6.m4.1.2.2.3.2" xref="S3.SS1.p9.6.m4.1.2.2.3.2.cmml">i</mi><mo id="S3.SS1.p9.6.m4.1.2.2.3.1" xref="S3.SS1.p9.6.m4.1.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p9.6.m4.1.2.2.3.3" xref="S3.SS1.p9.6.m4.1.2.2.3.3.cmml">d</mi></mrow><mrow id="S3.SS1.p9.6.m4.1.1.1.3" xref="S3.SS1.p9.6.m4.1.2.cmml"><mo id="S3.SS1.p9.6.m4.1.1.1.3.1" stretchy="false" xref="S3.SS1.p9.6.m4.1.2.cmml">(</mo><mi id="S3.SS1.p9.6.m4.1.1.1.1" xref="S3.SS1.p9.6.m4.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p9.6.m4.1.1.1.3.2" stretchy="false" xref="S3.SS1.p9.6.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.6.m4.1b"><apply id="S3.SS1.p9.6.m4.1.2.cmml" xref="S3.SS1.p9.6.m4.1.2"><csymbol cd="ambiguous" id="S3.SS1.p9.6.m4.1.2.1.cmml" xref="S3.SS1.p9.6.m4.1.2">superscript</csymbol><apply id="S3.SS1.p9.6.m4.1.2.2.cmml" xref="S3.SS1.p9.6.m4.1.2"><csymbol cd="ambiguous" id="S3.SS1.p9.6.m4.1.2.2.1.cmml" xref="S3.SS1.p9.6.m4.1.2">subscript</csymbol><apply id="S3.SS1.p9.6.m4.1.2.2.2.cmml" xref="S3.SS1.p9.6.m4.1.2.2.2"><ci id="S3.SS1.p9.6.m4.1.2.2.2.1.cmml" xref="S3.SS1.p9.6.m4.1.2.2.2.1">~</ci><ci id="S3.SS1.p9.6.m4.1.2.2.2.2.cmml" xref="S3.SS1.p9.6.m4.1.2.2.2.2">𝐇</ci></apply><apply id="S3.SS1.p9.6.m4.1.2.2.3.cmml" xref="S3.SS1.p9.6.m4.1.2.2.3"><times id="S3.SS1.p9.6.m4.1.2.2.3.1.cmml" xref="S3.SS1.p9.6.m4.1.2.2.3.1"></times><ci id="S3.SS1.p9.6.m4.1.2.2.3.2.cmml" xref="S3.SS1.p9.6.m4.1.2.2.3.2">𝑖</ci><ci id="S3.SS1.p9.6.m4.1.2.2.3.3.cmml" xref="S3.SS1.p9.6.m4.1.2.2.3.3">𝑑</ci></apply></apply><ci id="S3.SS1.p9.6.m4.1.1.1.1.cmml" xref="S3.SS1.p9.6.m4.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.6.m4.1c">\mathbf{\widetilde{H}}_{id}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p9.6.m4.1d">over~ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> are computed through two cross-attention mechanisms, which attend to the image encoder and the target text decoder, respectively, as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{\overline{H}}_{id}^{(l)}=\mathrm{MHA}(\mathbf{C}_{id}^{(l)},\mathbf{H}%
_{ie}^{(L)},\mathbf{H}_{ie}^{(L)})," class="ltx_Math" display="block" id="S3.E6.m1.5"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5.1" xref="S3.E6.m1.5.5.1.1.cmml"><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml"><msubsup id="S3.E6.m1.5.5.1.1.5" xref="S3.E6.m1.5.5.1.1.5.cmml"><mover accent="true" id="S3.E6.m1.5.5.1.1.5.2.2" xref="S3.E6.m1.5.5.1.1.5.2.2.cmml"><mi id="S3.E6.m1.5.5.1.1.5.2.2.2" xref="S3.E6.m1.5.5.1.1.5.2.2.2.cmml">𝐇</mi><mo id="S3.E6.m1.5.5.1.1.5.2.2.1" xref="S3.E6.m1.5.5.1.1.5.2.2.1.cmml">¯</mo></mover><mrow id="S3.E6.m1.5.5.1.1.5.2.3" xref="S3.E6.m1.5.5.1.1.5.2.3.cmml"><mi id="S3.E6.m1.5.5.1.1.5.2.3.2" xref="S3.E6.m1.5.5.1.1.5.2.3.2.cmml">i</mi><mo id="S3.E6.m1.5.5.1.1.5.2.3.1" xref="S3.E6.m1.5.5.1.1.5.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.5.5.1.1.5.2.3.3" xref="S3.E6.m1.5.5.1.1.5.2.3.3.cmml">d</mi></mrow><mrow id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.5.cmml"><mo id="S3.E6.m1.1.1.1.3.1" stretchy="false" xref="S3.E6.m1.5.5.1.1.5.cmml">(</mo><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">l</mi><mo id="S3.E6.m1.1.1.1.3.2" stretchy="false" xref="S3.E6.m1.5.5.1.1.5.cmml">)</mo></mrow></msubsup><mo id="S3.E6.m1.5.5.1.1.4" xref="S3.E6.m1.5.5.1.1.4.cmml">=</mo><mrow id="S3.E6.m1.5.5.1.1.3" xref="S3.E6.m1.5.5.1.1.3.cmml"><mi id="S3.E6.m1.5.5.1.1.3.5" xref="S3.E6.m1.5.5.1.1.3.5.cmml">MHA</mi><mo id="S3.E6.m1.5.5.1.1.3.4" xref="S3.E6.m1.5.5.1.1.3.4.cmml">⁢</mo><mrow id="S3.E6.m1.5.5.1.1.3.3.3" xref="S3.E6.m1.5.5.1.1.3.3.4.cmml"><mo id="S3.E6.m1.5.5.1.1.3.3.3.4" stretchy="false" xref="S3.E6.m1.5.5.1.1.3.3.4.cmml">(</mo><msubsup id="S3.E6.m1.5.5.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.cmml">𝐂</mi><mrow id="S3.E6.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.3.cmml">d</mi></mrow><mrow id="S3.E6.m1.2.2.1.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.2.2.1.3.1" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml">l</mi><mo id="S3.E6.m1.2.2.1.3.2" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E6.m1.5.5.1.1.3.3.3.5" xref="S3.E6.m1.5.5.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E6.m1.5.5.1.1.2.2.2.2" xref="S3.E6.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S3.E6.m1.5.5.1.1.2.2.2.2.2.2" xref="S3.E6.m1.5.5.1.1.2.2.2.2.2.2.cmml">𝐇</mi><mrow id="S3.E6.m1.5.5.1.1.2.2.2.2.2.3" xref="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.2" xref="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.1" xref="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.3" xref="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.3.cmml">e</mi></mrow><mrow id="S3.E6.m1.3.3.1.3" xref="S3.E6.m1.5.5.1.1.2.2.2.2.cmml"><mo id="S3.E6.m1.3.3.1.3.1" stretchy="false" xref="S3.E6.m1.5.5.1.1.2.2.2.2.cmml">(</mo><mi id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml">L</mi><mo id="S3.E6.m1.3.3.1.3.2" stretchy="false" xref="S3.E6.m1.5.5.1.1.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.E6.m1.5.5.1.1.3.3.3.6" xref="S3.E6.m1.5.5.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E6.m1.5.5.1.1.3.3.3.3" xref="S3.E6.m1.5.5.1.1.3.3.3.3.cmml"><mi id="S3.E6.m1.5.5.1.1.3.3.3.3.2.2" xref="S3.E6.m1.5.5.1.1.3.3.3.3.2.2.cmml">𝐇</mi><mrow id="S3.E6.m1.5.5.1.1.3.3.3.3.2.3" xref="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.cmml"><mi id="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.2" xref="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.2.cmml">i</mi><mo id="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.1" xref="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.3" xref="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.3.cmml">e</mi></mrow><mrow id="S3.E6.m1.4.4.1.3" xref="S3.E6.m1.5.5.1.1.3.3.3.3.cmml"><mo id="S3.E6.m1.4.4.1.3.1" stretchy="false" xref="S3.E6.m1.5.5.1.1.3.3.3.3.cmml">(</mo><mi id="S3.E6.m1.4.4.1.1" xref="S3.E6.m1.4.4.1.1.cmml">L</mi><mo id="S3.E6.m1.4.4.1.3.2" stretchy="false" xref="S3.E6.m1.5.5.1.1.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.E6.m1.5.5.1.1.3.3.3.7" stretchy="false" xref="S3.E6.m1.5.5.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.5.5.1.2" xref="S3.E6.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1"><eq id="S3.E6.m1.5.5.1.1.4.cmml" xref="S3.E6.m1.5.5.1.1.4"></eq><apply id="S3.E6.m1.5.5.1.1.5.cmml" xref="S3.E6.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.5.1.cmml" xref="S3.E6.m1.5.5.1.1.5">superscript</csymbol><apply id="S3.E6.m1.5.5.1.1.5.2.cmml" xref="S3.E6.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.5.2.1.cmml" xref="S3.E6.m1.5.5.1.1.5">subscript</csymbol><apply id="S3.E6.m1.5.5.1.1.5.2.2.cmml" xref="S3.E6.m1.5.5.1.1.5.2.2"><ci id="S3.E6.m1.5.5.1.1.5.2.2.1.cmml" xref="S3.E6.m1.5.5.1.1.5.2.2.1">¯</ci><ci id="S3.E6.m1.5.5.1.1.5.2.2.2.cmml" xref="S3.E6.m1.5.5.1.1.5.2.2.2">𝐇</ci></apply><apply id="S3.E6.m1.5.5.1.1.5.2.3.cmml" xref="S3.E6.m1.5.5.1.1.5.2.3"><times id="S3.E6.m1.5.5.1.1.5.2.3.1.cmml" xref="S3.E6.m1.5.5.1.1.5.2.3.1"></times><ci id="S3.E6.m1.5.5.1.1.5.2.3.2.cmml" xref="S3.E6.m1.5.5.1.1.5.2.3.2">𝑖</ci><ci id="S3.E6.m1.5.5.1.1.5.2.3.3.cmml" xref="S3.E6.m1.5.5.1.1.5.2.3.3">𝑑</ci></apply></apply><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑙</ci></apply><apply id="S3.E6.m1.5.5.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.3"><times id="S3.E6.m1.5.5.1.1.3.4.cmml" xref="S3.E6.m1.5.5.1.1.3.4"></times><ci id="S3.E6.m1.5.5.1.1.3.5.cmml" xref="S3.E6.m1.5.5.1.1.3.5">MHA</ci><vector id="S3.E6.m1.5.5.1.1.3.3.4.cmml" xref="S3.E6.m1.5.5.1.1.3.3.3"><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.2">𝐂</ci><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.3"><times id="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.3.3">𝑑</ci></apply></apply><ci id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1.1">𝑙</ci></apply><apply id="S3.E6.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E6.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.5.5.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E6.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S3.E6.m1.5.5.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.5.5.1.1.2.2.2.2.2.2">𝐇</ci><apply id="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.5.5.1.1.2.2.2.2.2.3"><times id="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.1"></times><ci id="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.2">𝑖</ci><ci id="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E6.m1.5.5.1.1.2.2.2.2.2.3.3">𝑒</ci></apply></apply><ci id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1">𝐿</ci></apply><apply id="S3.E6.m1.5.5.1.1.3.3.3.3.cmml" xref="S3.E6.m1.5.5.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.3.3.3.3.1.cmml" xref="S3.E6.m1.5.5.1.1.3.3.3.3">superscript</csymbol><apply id="S3.E6.m1.5.5.1.1.3.3.3.3.2.cmml" xref="S3.E6.m1.5.5.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.3.3.3.3.2.1.cmml" xref="S3.E6.m1.5.5.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.3.3.3.3.2.2.cmml" xref="S3.E6.m1.5.5.1.1.3.3.3.3.2.2">𝐇</ci><apply id="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.cmml" xref="S3.E6.m1.5.5.1.1.3.3.3.3.2.3"><times id="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.1.cmml" xref="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.1"></times><ci id="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.2.cmml" xref="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.2">𝑖</ci><ci id="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.3.cmml" xref="S3.E6.m1.5.5.1.1.3.3.3.3.2.3.3">𝑒</ci></apply></apply><ci id="S3.E6.m1.4.4.1.1.cmml" xref="S3.E6.m1.4.4.1.1">𝐿</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">\mathbf{\overline{H}}_{id}^{(l)}=\mathrm{MHA}(\mathbf{C}_{id}^{(l)},\mathbf{H}%
_{ie}^{(L)},\mathbf{H}_{ie}^{(L)}),</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.5d">over¯ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = roman_MHA ( bold_C start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{\widetilde{H}}_{id}^{(l)}=\mathrm{MHA}(\mathbf{C}_{id}^{(l)},\mathbf{H%
}_{td}^{(L)},\mathbf{H}_{td}^{(L)})." class="ltx_Math" display="block" id="S3.E7.m1.5"><semantics id="S3.E7.m1.5a"><mrow id="S3.E7.m1.5.5.1" xref="S3.E7.m1.5.5.1.1.cmml"><mrow id="S3.E7.m1.5.5.1.1" xref="S3.E7.m1.5.5.1.1.cmml"><msubsup id="S3.E7.m1.5.5.1.1.5" xref="S3.E7.m1.5.5.1.1.5.cmml"><mover accent="true" id="S3.E7.m1.5.5.1.1.5.2.2" xref="S3.E7.m1.5.5.1.1.5.2.2.cmml"><mi id="S3.E7.m1.5.5.1.1.5.2.2.2" xref="S3.E7.m1.5.5.1.1.5.2.2.2.cmml">𝐇</mi><mo id="S3.E7.m1.5.5.1.1.5.2.2.1" xref="S3.E7.m1.5.5.1.1.5.2.2.1.cmml">~</mo></mover><mrow id="S3.E7.m1.5.5.1.1.5.2.3" xref="S3.E7.m1.5.5.1.1.5.2.3.cmml"><mi id="S3.E7.m1.5.5.1.1.5.2.3.2" xref="S3.E7.m1.5.5.1.1.5.2.3.2.cmml">i</mi><mo id="S3.E7.m1.5.5.1.1.5.2.3.1" xref="S3.E7.m1.5.5.1.1.5.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.5.5.1.1.5.2.3.3" xref="S3.E7.m1.5.5.1.1.5.2.3.3.cmml">d</mi></mrow><mrow id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.5.cmml"><mo id="S3.E7.m1.1.1.1.3.1" stretchy="false" xref="S3.E7.m1.5.5.1.1.5.cmml">(</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">l</mi><mo id="S3.E7.m1.1.1.1.3.2" stretchy="false" xref="S3.E7.m1.5.5.1.1.5.cmml">)</mo></mrow></msubsup><mo id="S3.E7.m1.5.5.1.1.4" xref="S3.E7.m1.5.5.1.1.4.cmml">=</mo><mrow id="S3.E7.m1.5.5.1.1.3" xref="S3.E7.m1.5.5.1.1.3.cmml"><mi id="S3.E7.m1.5.5.1.1.3.5" xref="S3.E7.m1.5.5.1.1.3.5.cmml">MHA</mi><mo id="S3.E7.m1.5.5.1.1.3.4" xref="S3.E7.m1.5.5.1.1.3.4.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.3.3.3" xref="S3.E7.m1.5.5.1.1.3.3.4.cmml"><mo id="S3.E7.m1.5.5.1.1.3.3.3.4" stretchy="false" xref="S3.E7.m1.5.5.1.1.3.3.4.cmml">(</mo><msubsup id="S3.E7.m1.5.5.1.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.cmml">𝐂</mi><mrow id="S3.E7.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.1" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.3.cmml">d</mi></mrow><mrow id="S3.E7.m1.2.2.1.3" xref="S3.E7.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.2.2.1.3.1" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml">l</mi><mo id="S3.E7.m1.2.2.1.3.2" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E7.m1.5.5.1.1.3.3.3.5" xref="S3.E7.m1.5.5.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E7.m1.5.5.1.1.2.2.2.2" xref="S3.E7.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S3.E7.m1.5.5.1.1.2.2.2.2.2.2" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2.2.cmml">𝐇</mi><mrow id="S3.E7.m1.5.5.1.1.2.2.2.2.2.3" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.2" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.1" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.3" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.3.cmml">d</mi></mrow><mrow id="S3.E7.m1.3.3.1.3" xref="S3.E7.m1.5.5.1.1.2.2.2.2.cmml"><mo id="S3.E7.m1.3.3.1.3.1" stretchy="false" xref="S3.E7.m1.5.5.1.1.2.2.2.2.cmml">(</mo><mi id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml">L</mi><mo id="S3.E7.m1.3.3.1.3.2" stretchy="false" xref="S3.E7.m1.5.5.1.1.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.E7.m1.5.5.1.1.3.3.3.6" xref="S3.E7.m1.5.5.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E7.m1.5.5.1.1.3.3.3.3" xref="S3.E7.m1.5.5.1.1.3.3.3.3.cmml"><mi id="S3.E7.m1.5.5.1.1.3.3.3.3.2.2" xref="S3.E7.m1.5.5.1.1.3.3.3.3.2.2.cmml">𝐇</mi><mrow id="S3.E7.m1.5.5.1.1.3.3.3.3.2.3" xref="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.cmml"><mi id="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.2" xref="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.2.cmml">t</mi><mo id="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.1" xref="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.3" xref="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.3.cmml">d</mi></mrow><mrow id="S3.E7.m1.4.4.1.3" xref="S3.E7.m1.5.5.1.1.3.3.3.3.cmml"><mo id="S3.E7.m1.4.4.1.3.1" stretchy="false" xref="S3.E7.m1.5.5.1.1.3.3.3.3.cmml">(</mo><mi id="S3.E7.m1.4.4.1.1" xref="S3.E7.m1.4.4.1.1.cmml">L</mi><mo id="S3.E7.m1.4.4.1.3.2" stretchy="false" xref="S3.E7.m1.5.5.1.1.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.E7.m1.5.5.1.1.3.3.3.7" stretchy="false" xref="S3.E7.m1.5.5.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.5.5.1.2" lspace="0em" xref="S3.E7.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.5b"><apply id="S3.E7.m1.5.5.1.1.cmml" xref="S3.E7.m1.5.5.1"><eq id="S3.E7.m1.5.5.1.1.4.cmml" xref="S3.E7.m1.5.5.1.1.4"></eq><apply id="S3.E7.m1.5.5.1.1.5.cmml" xref="S3.E7.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.5.1.cmml" xref="S3.E7.m1.5.5.1.1.5">superscript</csymbol><apply id="S3.E7.m1.5.5.1.1.5.2.cmml" xref="S3.E7.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.5.2.1.cmml" xref="S3.E7.m1.5.5.1.1.5">subscript</csymbol><apply id="S3.E7.m1.5.5.1.1.5.2.2.cmml" xref="S3.E7.m1.5.5.1.1.5.2.2"><ci id="S3.E7.m1.5.5.1.1.5.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.5.2.2.1">~</ci><ci id="S3.E7.m1.5.5.1.1.5.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.5.2.2.2">𝐇</ci></apply><apply id="S3.E7.m1.5.5.1.1.5.2.3.cmml" xref="S3.E7.m1.5.5.1.1.5.2.3"><times id="S3.E7.m1.5.5.1.1.5.2.3.1.cmml" xref="S3.E7.m1.5.5.1.1.5.2.3.1"></times><ci id="S3.E7.m1.5.5.1.1.5.2.3.2.cmml" xref="S3.E7.m1.5.5.1.1.5.2.3.2">𝑖</ci><ci id="S3.E7.m1.5.5.1.1.5.2.3.3.cmml" xref="S3.E7.m1.5.5.1.1.5.2.3.3">𝑑</ci></apply></apply><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑙</ci></apply><apply id="S3.E7.m1.5.5.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.3"><times id="S3.E7.m1.5.5.1.1.3.4.cmml" xref="S3.E7.m1.5.5.1.1.3.4"></times><ci id="S3.E7.m1.5.5.1.1.3.5.cmml" xref="S3.E7.m1.5.5.1.1.3.5">MHA</ci><vector id="S3.E7.m1.5.5.1.1.3.3.4.cmml" xref="S3.E7.m1.5.5.1.1.3.3.3"><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.2">𝐂</ci><apply id="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.3"><times id="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1.1.2.3.3">𝑑</ci></apply></apply><ci id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1.1">𝑙</ci></apply><apply id="S3.E7.m1.5.5.1.1.2.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E7.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2.2">𝐇</ci><apply id="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2.3"><times id="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.1"></times><ci id="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.2">𝑡</ci><ci id="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E7.m1.5.5.1.1.2.2.2.2.2.3.3">𝑑</ci></apply></apply><ci id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1">𝐿</ci></apply><apply id="S3.E7.m1.5.5.1.1.3.3.3.3.cmml" xref="S3.E7.m1.5.5.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.3.3.3.3.1.cmml" xref="S3.E7.m1.5.5.1.1.3.3.3.3">superscript</csymbol><apply id="S3.E7.m1.5.5.1.1.3.3.3.3.2.cmml" xref="S3.E7.m1.5.5.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.3.3.3.3.2.1.cmml" xref="S3.E7.m1.5.5.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.3.3.3.3.2.2.cmml" xref="S3.E7.m1.5.5.1.1.3.3.3.3.2.2">𝐇</ci><apply id="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.cmml" xref="S3.E7.m1.5.5.1.1.3.3.3.3.2.3"><times id="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.1.cmml" xref="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.1"></times><ci id="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.2.cmml" xref="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.2">𝑡</ci><ci id="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.3.cmml" xref="S3.E7.m1.5.5.1.1.3.3.3.3.2.3.3">𝑑</ci></apply></apply><ci id="S3.E7.m1.4.4.1.1.cmml" xref="S3.E7.m1.4.4.1.1">𝐿</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.5c">\mathbf{\widetilde{H}}_{id}^{(l)}=\mathrm{MHA}(\mathbf{C}_{id}^{(l)},\mathbf{H%
}_{td}^{(L)},\mathbf{H}_{td}^{(L)}).</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.5d">over~ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = roman_MHA ( bold_C start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_t italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT , bold_H start_POSTSUBSCRIPT italic_t italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_L ) end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p10">
<p class="ltx_p" id="S3.SS1.p10.1">Finally, the hidden states of the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.p10.1.m1.1"><semantics id="S3.SS1.p10.1.m1.1a"><mi id="S3.SS1.p10.1.m1.1.1" xref="S3.SS1.p10.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.1.m1.1b"><ci id="S3.SS1.p10.1.m1.1.1.cmml" xref="S3.SS1.p10.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.1.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p10.1.m1.1d">italic_l</annotation></semantics></math>-th image decoder layer are obtained through a gated fusion mechanism, which is calculated using the following equations:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A5.EGx2">
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\Lambda" class="ltx_Math" display="inline" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mi id="S3.E8.m1.1.1" mathvariant="normal" xref="S3.E8.m1.1.1.cmml">Λ</mi><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">Λ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle\Lambda</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">roman_Λ</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathrm{sigmoid}(\mathbf{W}_{\Lambda}\mathbf{\overline{H}}_{id}^%
{(l)}+\mathbf{U}_{\Lambda}\mathbf{\widetilde{H}}_{id}^{(l)})," class="ltx_Math" display="inline" id="S3.E8.m2.3"><semantics id="S3.E8.m2.3a"><mrow id="S3.E8.m2.3.3.1" xref="S3.E8.m2.3.3.1.1.cmml"><mrow id="S3.E8.m2.3.3.1.1" xref="S3.E8.m2.3.3.1.1.cmml"><mi id="S3.E8.m2.3.3.1.1.3" xref="S3.E8.m2.3.3.1.1.3.cmml"></mi><mo id="S3.E8.m2.3.3.1.1.2" xref="S3.E8.m2.3.3.1.1.2.cmml">=</mo><mrow id="S3.E8.m2.3.3.1.1.1" xref="S3.E8.m2.3.3.1.1.1.cmml"><mi id="S3.E8.m2.3.3.1.1.1.3" xref="S3.E8.m2.3.3.1.1.1.3.cmml">sigmoid</mi><mo id="S3.E8.m2.3.3.1.1.1.2" xref="S3.E8.m2.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m2.3.3.1.1.1.1.1" xref="S3.E8.m2.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E8.m2.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m2.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m2.3.3.1.1.1.1.1.1" xref="S3.E8.m2.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E8.m2.3.3.1.1.1.1.1.1.2" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.cmml"><msub id="S3.E8.m2.3.3.1.1.1.1.1.1.2.2" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E8.m2.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.E8.m2.3.3.1.1.1.1.1.1.2.2.3" mathvariant="normal" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.2.3.cmml">Λ</mi></msub><mo id="S3.E8.m2.3.3.1.1.1.1.1.1.2.1" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.cmml"><mover accent="true" id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.2" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.2.cmml"><mi id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.2.2" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.2.2.cmml">𝐇</mi><mo id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.2.1" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.2.1.cmml">¯</mo></mover><mrow id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.cmml"><mi id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.2" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.2.cmml">i</mi><mo id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.1" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.3" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.3.cmml">d</mi></mrow><mrow id="S3.E8.m2.1.1.1.3" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E8.m2.1.1.1.3.1" stretchy="false" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.cmml">(</mo><mi id="S3.E8.m2.1.1.1.1" xref="S3.E8.m2.1.1.1.1.cmml">l</mi><mo id="S3.E8.m2.1.1.1.3.2" stretchy="false" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E8.m2.3.3.1.1.1.1.1.1.1" xref="S3.E8.m2.3.3.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E8.m2.3.3.1.1.1.1.1.1.3" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.cmml"><msub id="S3.E8.m2.3.3.1.1.1.1.1.1.3.2" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E8.m2.3.3.1.1.1.1.1.1.3.2.2" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.2.2.cmml">𝐔</mi><mi id="S3.E8.m2.3.3.1.1.1.1.1.1.3.2.3" mathvariant="normal" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.2.3.cmml">Λ</mi></msub><mo id="S3.E8.m2.3.3.1.1.1.1.1.1.3.1" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.cmml"><mover accent="true" id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.2" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.2.2" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.2.2.cmml">𝐇</mi><mo id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.2.1" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.2.1.cmml">~</mo></mover><mrow id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.2" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.2.cmml">i</mi><mo id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.1" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.3" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.3.cmml">d</mi></mrow><mrow id="S3.E8.m2.2.2.1.3" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.cmml"><mo id="S3.E8.m2.2.2.1.3.1" stretchy="false" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.cmml">(</mo><mi id="S3.E8.m2.2.2.1.1" xref="S3.E8.m2.2.2.1.1.cmml">l</mi><mo id="S3.E8.m2.2.2.1.3.2" stretchy="false" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S3.E8.m2.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m2.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m2.3.3.1.2" xref="S3.E8.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m2.3b"><apply id="S3.E8.m2.3.3.1.1.cmml" xref="S3.E8.m2.3.3.1"><eq id="S3.E8.m2.3.3.1.1.2.cmml" xref="S3.E8.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="S3.E8.m2.3.3.1.1.3.cmml" xref="S3.E8.m2.3.3.1.1.3">absent</csymbol><apply id="S3.E8.m2.3.3.1.1.1.cmml" xref="S3.E8.m2.3.3.1.1.1"><times id="S3.E8.m2.3.3.1.1.1.2.cmml" xref="S3.E8.m2.3.3.1.1.1.2"></times><ci id="S3.E8.m2.3.3.1.1.1.3.cmml" xref="S3.E8.m2.3.3.1.1.1.3">sigmoid</ci><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1"><plus id="S3.E8.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.1"></plus><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2"><times id="S3.E8.m2.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.1"></times><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m2.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E8.m2.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.2.2">𝐖</ci><ci id="S3.E8.m2.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.2.3">Λ</ci></apply><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3">subscript</csymbol><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.2"><ci id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.2.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.2.1">¯</ci><ci id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.2.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.2.2">𝐇</ci></apply><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3"><times id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.1"></times><ci id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.2">𝑖</ci><ci id="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.3.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.2.3.2.3.3">𝑑</ci></apply></apply><ci id="S3.E8.m2.1.1.1.1.cmml" xref="S3.E8.m2.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3"><times id="S3.E8.m2.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.1"></times><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m2.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m2.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.2.2">𝐔</ci><ci id="S3.E8.m2.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.2.3">Λ</ci></apply><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.2"><ci id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.2.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.2.1">~</ci><ci id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.2.2">𝐇</ci></apply><apply id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3"><times id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.1"></times><ci id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.2">𝑖</ci><ci id="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E8.m2.3.3.1.1.1.1.1.1.3.3.2.3.3">𝑑</ci></apply></apply><ci id="S3.E8.m2.2.2.1.1.cmml" xref="S3.E8.m2.2.2.1.1">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m2.3c">\displaystyle=\mathrm{sigmoid}(\mathbf{W}_{\Lambda}\mathbf{\overline{H}}_{id}^%
{(l)}+\mathbf{U}_{\Lambda}\mathbf{\widetilde{H}}_{id}^{(l)}),</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m2.3d">= roman_sigmoid ( bold_W start_POSTSUBSCRIPT roman_Λ end_POSTSUBSCRIPT over¯ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT + bold_U start_POSTSUBSCRIPT roman_Λ end_POSTSUBSCRIPT over~ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{H}_{id}^{(l)}" class="ltx_Math" display="inline" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><msubsup id="S3.E9.m1.1.2" xref="S3.E9.m1.1.2.cmml"><mi id="S3.E9.m1.1.2.2.2" xref="S3.E9.m1.1.2.2.2.cmml">𝐇</mi><mrow id="S3.E9.m1.1.2.2.3" xref="S3.E9.m1.1.2.2.3.cmml"><mi id="S3.E9.m1.1.2.2.3.2" xref="S3.E9.m1.1.2.2.3.2.cmml">i</mi><mo id="S3.E9.m1.1.2.2.3.1" xref="S3.E9.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.E9.m1.1.2.2.3.3" xref="S3.E9.m1.1.2.2.3.3.cmml">d</mi></mrow><mrow id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.1.2.cmml"><mo id="S3.E9.m1.1.1.1.3.1" stretchy="false" xref="S3.E9.m1.1.2.cmml">(</mo><mi id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">l</mi><mo id="S3.E9.m1.1.1.1.3.2" stretchy="false" xref="S3.E9.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.2.cmml" xref="S3.E9.m1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.2.1.cmml" xref="S3.E9.m1.1.2">superscript</csymbol><apply id="S3.E9.m1.1.2.2.cmml" xref="S3.E9.m1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.2.2.1.cmml" xref="S3.E9.m1.1.2">subscript</csymbol><ci id="S3.E9.m1.1.2.2.2.cmml" xref="S3.E9.m1.1.2.2.2">𝐇</ci><apply id="S3.E9.m1.1.2.2.3.cmml" xref="S3.E9.m1.1.2.2.3"><times id="S3.E9.m1.1.2.2.3.1.cmml" xref="S3.E9.m1.1.2.2.3.1"></times><ci id="S3.E9.m1.1.2.2.3.2.cmml" xref="S3.E9.m1.1.2.2.3.2">𝑖</ci><ci id="S3.E9.m1.1.2.2.3.3.cmml" xref="S3.E9.m1.1.2.2.3.3">𝑑</ci></apply></apply><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\displaystyle\mathbf{H}_{id}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">bold_H start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\Lambda\mathbf{\overline{H}}_{id}^{(l)}+(1-\Lambda)\mathbf{%
\widetilde{H}}_{id}^{(l)}," class="ltx_Math" display="inline" id="S3.E9.m2.3"><semantics id="S3.E9.m2.3a"><mrow id="S3.E9.m2.3.3.1" xref="S3.E9.m2.3.3.1.1.cmml"><mrow id="S3.E9.m2.3.3.1.1" xref="S3.E9.m2.3.3.1.1.cmml"><mi id="S3.E9.m2.3.3.1.1.3" xref="S3.E9.m2.3.3.1.1.3.cmml"></mi><mo id="S3.E9.m2.3.3.1.1.2" xref="S3.E9.m2.3.3.1.1.2.cmml">=</mo><mrow id="S3.E9.m2.3.3.1.1.1" xref="S3.E9.m2.3.3.1.1.1.cmml"><mrow id="S3.E9.m2.3.3.1.1.1.3" xref="S3.E9.m2.3.3.1.1.1.3.cmml"><mi id="S3.E9.m2.3.3.1.1.1.3.2" mathvariant="normal" xref="S3.E9.m2.3.3.1.1.1.3.2.cmml">Λ</mi><mo id="S3.E9.m2.3.3.1.1.1.3.1" xref="S3.E9.m2.3.3.1.1.1.3.1.cmml">⁢</mo><msubsup id="S3.E9.m2.3.3.1.1.1.3.3" xref="S3.E9.m2.3.3.1.1.1.3.3.cmml"><mover accent="true" id="S3.E9.m2.3.3.1.1.1.3.3.2.2" xref="S3.E9.m2.3.3.1.1.1.3.3.2.2.cmml"><mi id="S3.E9.m2.3.3.1.1.1.3.3.2.2.2" xref="S3.E9.m2.3.3.1.1.1.3.3.2.2.2.cmml">𝐇</mi><mo id="S3.E9.m2.3.3.1.1.1.3.3.2.2.1" xref="S3.E9.m2.3.3.1.1.1.3.3.2.2.1.cmml">¯</mo></mover><mrow id="S3.E9.m2.3.3.1.1.1.3.3.2.3" xref="S3.E9.m2.3.3.1.1.1.3.3.2.3.cmml"><mi id="S3.E9.m2.3.3.1.1.1.3.3.2.3.2" xref="S3.E9.m2.3.3.1.1.1.3.3.2.3.2.cmml">i</mi><mo id="S3.E9.m2.3.3.1.1.1.3.3.2.3.1" xref="S3.E9.m2.3.3.1.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S3.E9.m2.3.3.1.1.1.3.3.2.3.3" xref="S3.E9.m2.3.3.1.1.1.3.3.2.3.3.cmml">d</mi></mrow><mrow id="S3.E9.m2.1.1.1.3" xref="S3.E9.m2.3.3.1.1.1.3.3.cmml"><mo id="S3.E9.m2.1.1.1.3.1" stretchy="false" xref="S3.E9.m2.3.3.1.1.1.3.3.cmml">(</mo><mi id="S3.E9.m2.1.1.1.1" xref="S3.E9.m2.1.1.1.1.cmml">l</mi><mo id="S3.E9.m2.1.1.1.3.2" stretchy="false" xref="S3.E9.m2.3.3.1.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E9.m2.3.3.1.1.1.2" xref="S3.E9.m2.3.3.1.1.1.2.cmml">+</mo><mrow id="S3.E9.m2.3.3.1.1.1.1" xref="S3.E9.m2.3.3.1.1.1.1.cmml"><mrow id="S3.E9.m2.3.3.1.1.1.1.1.1" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m2.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m2.3.3.1.1.1.1.1.1.1" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.cmml"><mn id="S3.E9.m2.3.3.1.1.1.1.1.1.1.2" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E9.m2.3.3.1.1.1.1.1.1.1.1" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E9.m2.3.3.1.1.1.1.1.1.1.3" mathvariant="normal" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.3.cmml">Λ</mi></mrow><mo id="S3.E9.m2.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E9.m2.3.3.1.1.1.1.2" xref="S3.E9.m2.3.3.1.1.1.1.2.cmml">⁢</mo><msubsup id="S3.E9.m2.3.3.1.1.1.1.3" xref="S3.E9.m2.3.3.1.1.1.1.3.cmml"><mover accent="true" id="S3.E9.m2.3.3.1.1.1.1.3.2.2" xref="S3.E9.m2.3.3.1.1.1.1.3.2.2.cmml"><mi id="S3.E9.m2.3.3.1.1.1.1.3.2.2.2" xref="S3.E9.m2.3.3.1.1.1.1.3.2.2.2.cmml">𝐇</mi><mo id="S3.E9.m2.3.3.1.1.1.1.3.2.2.1" xref="S3.E9.m2.3.3.1.1.1.1.3.2.2.1.cmml">~</mo></mover><mrow id="S3.E9.m2.3.3.1.1.1.1.3.2.3" xref="S3.E9.m2.3.3.1.1.1.1.3.2.3.cmml"><mi id="S3.E9.m2.3.3.1.1.1.1.3.2.3.2" xref="S3.E9.m2.3.3.1.1.1.1.3.2.3.2.cmml">i</mi><mo id="S3.E9.m2.3.3.1.1.1.1.3.2.3.1" xref="S3.E9.m2.3.3.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E9.m2.3.3.1.1.1.1.3.2.3.3" xref="S3.E9.m2.3.3.1.1.1.1.3.2.3.3.cmml">d</mi></mrow><mrow id="S3.E9.m2.2.2.1.3" xref="S3.E9.m2.3.3.1.1.1.1.3.cmml"><mo id="S3.E9.m2.2.2.1.3.1" stretchy="false" xref="S3.E9.m2.3.3.1.1.1.1.3.cmml">(</mo><mi id="S3.E9.m2.2.2.1.1" xref="S3.E9.m2.2.2.1.1.cmml">l</mi><mo id="S3.E9.m2.2.2.1.3.2" stretchy="false" xref="S3.E9.m2.3.3.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S3.E9.m2.3.3.1.2" xref="S3.E9.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m2.3b"><apply id="S3.E9.m2.3.3.1.1.cmml" xref="S3.E9.m2.3.3.1"><eq id="S3.E9.m2.3.3.1.1.2.cmml" xref="S3.E9.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="S3.E9.m2.3.3.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.3">absent</csymbol><apply id="S3.E9.m2.3.3.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.1"><plus id="S3.E9.m2.3.3.1.1.1.2.cmml" xref="S3.E9.m2.3.3.1.1.1.2"></plus><apply id="S3.E9.m2.3.3.1.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.1.3"><times id="S3.E9.m2.3.3.1.1.1.3.1.cmml" xref="S3.E9.m2.3.3.1.1.1.3.1"></times><ci id="S3.E9.m2.3.3.1.1.1.3.2.cmml" xref="S3.E9.m2.3.3.1.1.1.3.2">Λ</ci><apply id="S3.E9.m2.3.3.1.1.1.3.3.cmml" xref="S3.E9.m2.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.1.3.3.1.cmml" xref="S3.E9.m2.3.3.1.1.1.3.3">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.1.3.3.2.cmml" xref="S3.E9.m2.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.1.3.3.2.1.cmml" xref="S3.E9.m2.3.3.1.1.1.3.3">subscript</csymbol><apply id="S3.E9.m2.3.3.1.1.1.3.3.2.2.cmml" xref="S3.E9.m2.3.3.1.1.1.3.3.2.2"><ci id="S3.E9.m2.3.3.1.1.1.3.3.2.2.1.cmml" xref="S3.E9.m2.3.3.1.1.1.3.3.2.2.1">¯</ci><ci id="S3.E9.m2.3.3.1.1.1.3.3.2.2.2.cmml" xref="S3.E9.m2.3.3.1.1.1.3.3.2.2.2">𝐇</ci></apply><apply id="S3.E9.m2.3.3.1.1.1.3.3.2.3.cmml" xref="S3.E9.m2.3.3.1.1.1.3.3.2.3"><times id="S3.E9.m2.3.3.1.1.1.3.3.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.1.3.3.2.3.1"></times><ci id="S3.E9.m2.3.3.1.1.1.3.3.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.1.3.3.2.3.2">𝑖</ci><ci id="S3.E9.m2.3.3.1.1.1.3.3.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.1.3.3.2.3.3">𝑑</ci></apply></apply><ci id="S3.E9.m2.1.1.1.1.cmml" xref="S3.E9.m2.1.1.1.1">𝑙</ci></apply></apply><apply id="S3.E9.m2.3.3.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1"><times id="S3.E9.m2.3.3.1.1.1.1.2.cmml" xref="S3.E9.m2.3.3.1.1.1.1.2"></times><apply id="S3.E9.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1"><minus id="S3.E9.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.1"></minus><cn id="S3.E9.m2.3.3.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E9.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.1.1.1.1.1.3">Λ</ci></apply><apply id="S3.E9.m2.3.3.1.1.1.1.3.cmml" xref="S3.E9.m2.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.1.1.3.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1.3">superscript</csymbol><apply id="S3.E9.m2.3.3.1.1.1.1.3.2.cmml" xref="S3.E9.m2.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m2.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1.3">subscript</csymbol><apply id="S3.E9.m2.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E9.m2.3.3.1.1.1.1.3.2.2"><ci id="S3.E9.m2.3.3.1.1.1.1.3.2.2.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1.3.2.2.1">~</ci><ci id="S3.E9.m2.3.3.1.1.1.1.3.2.2.2.cmml" xref="S3.E9.m2.3.3.1.1.1.1.3.2.2.2">𝐇</ci></apply><apply id="S3.E9.m2.3.3.1.1.1.1.3.2.3.cmml" xref="S3.E9.m2.3.3.1.1.1.1.3.2.3"><times id="S3.E9.m2.3.3.1.1.1.1.3.2.3.1.cmml" xref="S3.E9.m2.3.3.1.1.1.1.3.2.3.1"></times><ci id="S3.E9.m2.3.3.1.1.1.1.3.2.3.2.cmml" xref="S3.E9.m2.3.3.1.1.1.1.3.2.3.2">𝑖</ci><ci id="S3.E9.m2.3.3.1.1.1.1.3.2.3.3.cmml" xref="S3.E9.m2.3.3.1.1.1.1.3.2.3.3">𝑑</ci></apply></apply><ci id="S3.E9.m2.2.2.1.1.cmml" xref="S3.E9.m2.2.2.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m2.3c">\displaystyle=\Lambda\mathbf{\overline{H}}_{id}^{(l)}+(1-\Lambda)\mathbf{%
\widetilde{H}}_{id}^{(l)},</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m2.3d">= roman_Λ over¯ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT + ( 1 - roman_Λ ) over~ start_ARG bold_H end_ARG start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p10.4">where <math alttext="\mathbf{W}_{\Lambda}" class="ltx_Math" display="inline" id="S3.SS1.p10.2.m1.1"><semantics id="S3.SS1.p10.2.m1.1a"><msub id="S3.SS1.p10.2.m1.1.1" xref="S3.SS1.p10.2.m1.1.1.cmml"><mi id="S3.SS1.p10.2.m1.1.1.2" xref="S3.SS1.p10.2.m1.1.1.2.cmml">𝐖</mi><mi id="S3.SS1.p10.2.m1.1.1.3" mathvariant="normal" xref="S3.SS1.p10.2.m1.1.1.3.cmml">Λ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.2.m1.1b"><apply id="S3.SS1.p10.2.m1.1.1.cmml" xref="S3.SS1.p10.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p10.2.m1.1.1.1.cmml" xref="S3.SS1.p10.2.m1.1.1">subscript</csymbol><ci id="S3.SS1.p10.2.m1.1.1.2.cmml" xref="S3.SS1.p10.2.m1.1.1.2">𝐖</ci><ci id="S3.SS1.p10.2.m1.1.1.3.cmml" xref="S3.SS1.p10.2.m1.1.1.3">Λ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.2.m1.1c">\mathbf{W}_{\Lambda}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p10.2.m1.1d">bold_W start_POSTSUBSCRIPT roman_Λ end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{U}_{\Lambda}" class="ltx_Math" display="inline" id="S3.SS1.p10.3.m2.1"><semantics id="S3.SS1.p10.3.m2.1a"><msub id="S3.SS1.p10.3.m2.1.1" xref="S3.SS1.p10.3.m2.1.1.cmml"><mi id="S3.SS1.p10.3.m2.1.1.2" xref="S3.SS1.p10.3.m2.1.1.2.cmml">𝐔</mi><mi id="S3.SS1.p10.3.m2.1.1.3" mathvariant="normal" xref="S3.SS1.p10.3.m2.1.1.3.cmml">Λ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.3.m2.1b"><apply id="S3.SS1.p10.3.m2.1.1.cmml" xref="S3.SS1.p10.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p10.3.m2.1.1.1.cmml" xref="S3.SS1.p10.3.m2.1.1">subscript</csymbol><ci id="S3.SS1.p10.3.m2.1.1.2.cmml" xref="S3.SS1.p10.3.m2.1.1.2">𝐔</ci><ci id="S3.SS1.p10.3.m2.1.1.3.cmml" xref="S3.SS1.p10.3.m2.1.1.3">Λ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.3.m2.1c">\mathbf{U}_{\Lambda}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p10.3.m2.1d">bold_U start_POSTSUBSCRIPT roman_Λ end_POSTSUBSCRIPT</annotation></semantics></math> are projection matrices, and <math alttext="\Lambda" class="ltx_Math" display="inline" id="S3.SS1.p10.4.m3.1"><semantics id="S3.SS1.p10.4.m3.1a"><mi id="S3.SS1.p10.4.m3.1.1" mathvariant="normal" xref="S3.SS1.p10.4.m3.1.1.cmml">Λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.4.m3.1b"><ci id="S3.SS1.p10.4.m3.1.1.cmml" xref="S3.SS1.p10.4.m3.1.1">Λ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.4.m3.1c">\Lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p10.4.m3.1d">roman_Λ</annotation></semantics></math> is a gated matrix featuring values ranging from 0 to 1, serving the purpose of dynamically fusing two modalities of information.</p>
</div>
<div class="ltx_para" id="S3.SS1.p11">
<p class="ltx_p" id="S3.SS1.p11.2"><span class="ltx_text ltx_font_bold" id="S3.SS1.p11.2.1">Image Tokenizer</span>. It is used to perform the conversion between an image and a sequence of discrete visual tokens. By introducing this module, we allow the image decoder only to predict visual tokens, preventing it from modeling excessively lengthy sequences. For instance, a 256<math alttext="\times" class="ltx_Math" display="inline" id="S3.SS1.p11.1.m1.1"><semantics id="S3.SS1.p11.1.m1.1a"><mo id="S3.SS1.p11.1.m1.1.1" xref="S3.SS1.p11.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p11.1.m1.1b"><times id="S3.SS1.p11.1.m1.1.1.cmml" xref="S3.SS1.p11.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p11.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p11.1.m1.1d">×</annotation></semantics></math>256<math alttext="\times" class="ltx_Math" display="inline" id="S3.SS1.p11.2.m2.1"><semantics id="S3.SS1.p11.2.m2.1a"><mo id="S3.SS1.p11.2.m2.1.1" xref="S3.SS1.p11.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p11.2.m2.1b"><times id="S3.SS1.p11.2.m2.1.1.cmml" xref="S3.SS1.p11.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p11.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p11.2.m2.1d">×</annotation></semantics></math>3 RGB image results in 196,608 rasterized values.</p>
</div>
<div class="ltx_para" id="S3.SS1.p12">
<p class="ltx_p" id="S3.SS1.p12.3">Our image tokenizer follows the architecture of ViT-VQGAN <cite class="ltx_cite ltx_citemacro_cite">Yu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib41" title="">2022a</a>)</cite>, which includes a Vison Transformer (ViT) <cite class="ltx_cite ltx_citemacro_cite">Dosovitskiy et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib7" title="">2021</a>)</cite> based encoder and decoder. The encoder <math alttext="E" class="ltx_Math" display="inline" id="S3.SS1.p12.1.m1.1"><semantics id="S3.SS1.p12.1.m1.1a"><mi id="S3.SS1.p12.1.m1.1.1" xref="S3.SS1.p12.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p12.1.m1.1b"><ci id="S3.SS1.p12.1.m1.1.1.cmml" xref="S3.SS1.p12.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p12.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p12.1.m1.1d">italic_E</annotation></semantics></math> of the image tokenizer is used to tokenize the image into <math alttext="\mathbf{z}=(z_{1},...,z_{N})" class="ltx_Math" display="inline" id="S3.SS1.p12.2.m2.3"><semantics id="S3.SS1.p12.2.m2.3a"><mrow id="S3.SS1.p12.2.m2.3.3" xref="S3.SS1.p12.2.m2.3.3.cmml"><mi id="S3.SS1.p12.2.m2.3.3.4" xref="S3.SS1.p12.2.m2.3.3.4.cmml">𝐳</mi><mo id="S3.SS1.p12.2.m2.3.3.3" xref="S3.SS1.p12.2.m2.3.3.3.cmml">=</mo><mrow id="S3.SS1.p12.2.m2.3.3.2.2" xref="S3.SS1.p12.2.m2.3.3.2.3.cmml"><mo id="S3.SS1.p12.2.m2.3.3.2.2.3" stretchy="false" xref="S3.SS1.p12.2.m2.3.3.2.3.cmml">(</mo><msub id="S3.SS1.p12.2.m2.2.2.1.1.1" xref="S3.SS1.p12.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.p12.2.m2.2.2.1.1.1.2" xref="S3.SS1.p12.2.m2.2.2.1.1.1.2.cmml">z</mi><mn id="S3.SS1.p12.2.m2.2.2.1.1.1.3" xref="S3.SS1.p12.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p12.2.m2.3.3.2.2.4" xref="S3.SS1.p12.2.m2.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p12.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p12.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p12.2.m2.3.3.2.2.5" xref="S3.SS1.p12.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p12.2.m2.3.3.2.2.2" xref="S3.SS1.p12.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS1.p12.2.m2.3.3.2.2.2.2" xref="S3.SS1.p12.2.m2.3.3.2.2.2.2.cmml">z</mi><mi id="S3.SS1.p12.2.m2.3.3.2.2.2.3" xref="S3.SS1.p12.2.m2.3.3.2.2.2.3.cmml">N</mi></msub><mo id="S3.SS1.p12.2.m2.3.3.2.2.6" stretchy="false" xref="S3.SS1.p12.2.m2.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p12.2.m2.3b"><apply id="S3.SS1.p12.2.m2.3.3.cmml" xref="S3.SS1.p12.2.m2.3.3"><eq id="S3.SS1.p12.2.m2.3.3.3.cmml" xref="S3.SS1.p12.2.m2.3.3.3"></eq><ci id="S3.SS1.p12.2.m2.3.3.4.cmml" xref="S3.SS1.p12.2.m2.3.3.4">𝐳</ci><vector id="S3.SS1.p12.2.m2.3.3.2.3.cmml" xref="S3.SS1.p12.2.m2.3.3.2.2"><apply id="S3.SS1.p12.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p12.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p12.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p12.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p12.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p12.2.m2.2.2.1.1.1.2">𝑧</ci><cn id="S3.SS1.p12.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p12.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p12.2.m2.1.1.cmml" xref="S3.SS1.p12.2.m2.1.1">…</ci><apply id="S3.SS1.p12.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p12.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p12.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.p12.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p12.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p12.2.m2.3.3.2.2.2.2">𝑧</ci><ci id="S3.SS1.p12.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS1.p12.2.m2.3.3.2.2.2.3">𝑁</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p12.2.m2.3c">\mathbf{z}=(z_{1},...,z_{N})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p12.2.m2.3d">bold_z = ( italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_z start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT )</annotation></semantics></math> through a quantizer <math alttext="q(\cdot)" class="ltx_Math" display="inline" id="S3.SS1.p12.3.m3.1"><semantics id="S3.SS1.p12.3.m3.1a"><mrow id="S3.SS1.p12.3.m3.1.2" xref="S3.SS1.p12.3.m3.1.2.cmml"><mi id="S3.SS1.p12.3.m3.1.2.2" xref="S3.SS1.p12.3.m3.1.2.2.cmml">q</mi><mo id="S3.SS1.p12.3.m3.1.2.1" xref="S3.SS1.p12.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p12.3.m3.1.2.3.2" xref="S3.SS1.p12.3.m3.1.2.cmml"><mo id="S3.SS1.p12.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS1.p12.3.m3.1.2.cmml">(</mo><mo id="S3.SS1.p12.3.m3.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p12.3.m3.1.1.cmml">⋅</mo><mo id="S3.SS1.p12.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS1.p12.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p12.3.m3.1b"><apply id="S3.SS1.p12.3.m3.1.2.cmml" xref="S3.SS1.p12.3.m3.1.2"><times id="S3.SS1.p12.3.m3.1.2.1.cmml" xref="S3.SS1.p12.3.m3.1.2.1"></times><ci id="S3.SS1.p12.3.m3.1.2.2.cmml" xref="S3.SS1.p12.3.m3.1.2.2">𝑞</ci><ci id="S3.SS1.p12.3.m3.1.1.cmml" xref="S3.SS1.p12.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p12.3.m3.1c">q(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p12.3.m3.1d">italic_q ( ⋅ )</annotation></semantics></math>. Formally, the quantizer looks up the nearest visual token for each input, as shown in the following:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="z_{i}=q(E(x_{i}))=\mathop{\mathrm{argmin}}\limits_{e_{k}\in\mathcal{V}}||E(x_{%
i})-e_{k}||_{2}," class="ltx_Math" display="block" id="S3.E10.m1.1"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><msub id="S3.E10.m1.1.1.1.1.4" xref="S3.E10.m1.1.1.1.1.4.cmml"><mi id="S3.E10.m1.1.1.1.1.4.2" xref="S3.E10.m1.1.1.1.1.4.2.cmml">z</mi><mi id="S3.E10.m1.1.1.1.1.4.3" xref="S3.E10.m1.1.1.1.1.4.3.cmml">i</mi></msub><mo id="S3.E10.m1.1.1.1.1.5" xref="S3.E10.m1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.3.cmml">q</mi><mo id="S3.E10.m1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml">E</mi><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.1.1.1.1.6" rspace="0.1389em" xref="S3.E10.m1.1.1.1.1.6.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml"><munder id="S3.E10.m1.1.1.1.1.2.2" xref="S3.E10.m1.1.1.1.1.2.2.cmml"><mo id="S3.E10.m1.1.1.1.1.2.2.2" lspace="0.1389em" movablelimits="false" rspace="0em" xref="S3.E10.m1.1.1.1.1.2.2.2.cmml">argmin</mo><mrow id="S3.E10.m1.1.1.1.1.2.2.3" xref="S3.E10.m1.1.1.1.1.2.2.3.cmml"><msub id="S3.E10.m1.1.1.1.1.2.2.3.2" xref="S3.E10.m1.1.1.1.1.2.2.3.2.cmml"><mi id="S3.E10.m1.1.1.1.1.2.2.3.2.2" xref="S3.E10.m1.1.1.1.1.2.2.3.2.2.cmml">e</mi><mi id="S3.E10.m1.1.1.1.1.2.2.3.2.3" xref="S3.E10.m1.1.1.1.1.2.2.3.2.3.cmml">k</mi></msub><mo id="S3.E10.m1.1.1.1.1.2.2.3.1" xref="S3.E10.m1.1.1.1.1.2.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.1.1.1.1.2.2.3.3" xref="S3.E10.m1.1.1.1.1.2.2.3.3.cmml">𝒱</mi></mrow></munder><msub id="S3.E10.m1.1.1.1.1.2.1" xref="S3.E10.m1.1.1.1.1.2.1.cmml"><mrow id="S3.E10.m1.1.1.1.1.2.1.1.1" xref="S3.E10.m1.1.1.1.1.2.1.1.2.cmml"><mo id="S3.E10.m1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.2.1.1.2.1.cmml">‖</mo><mrow id="S3.E10.m1.1.1.1.1.2.1.1.1.1" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.3.cmml">E</mi><mo id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.1.1.1.1.2.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.2.cmml">−</mo><msub id="S3.E10.m1.1.1.1.1.2.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.2.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.3.2.cmml">e</mi><mi id="S3.E10.m1.1.1.1.1.2.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E10.m1.1.1.1.1.2.1.1.1.3" stretchy="false" xref="S3.E10.m1.1.1.1.1.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E10.m1.1.1.1.1.2.1.3" xref="S3.E10.m1.1.1.1.1.2.1.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><and id="S3.E10.m1.1.1.1.1a.cmml" xref="S3.E10.m1.1.1.1"></and><apply id="S3.E10.m1.1.1.1.1b.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.5.cmml" xref="S3.E10.m1.1.1.1.1.5"></eq><apply id="S3.E10.m1.1.1.1.1.4.cmml" xref="S3.E10.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.4.1.cmml" xref="S3.E10.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.4.2.cmml" xref="S3.E10.m1.1.1.1.1.4.2">𝑧</ci><ci id="S3.E10.m1.1.1.1.1.4.3.cmml" xref="S3.E10.m1.1.1.1.1.4.3">𝑖</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.2"></times><ci id="S3.E10.m1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.3">𝑞</ci><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3">𝐸</ci><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E10.m1.1.1.1.1c.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.6.cmml" xref="S3.E10.m1.1.1.1.1.6"></eq><share href="https://arxiv.org/html/2407.02894v1#S3.E10.m1.1.1.1.1.1.cmml" id="S3.E10.m1.1.1.1.1d.cmml" xref="S3.E10.m1.1.1.1"></share><apply id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"><apply id="S3.E10.m1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.2.2.2">argmin</ci><apply id="S3.E10.m1.1.1.1.1.2.2.3.cmml" xref="S3.E10.m1.1.1.1.1.2.2.3"><in id="S3.E10.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E10.m1.1.1.1.1.2.2.3.1"></in><apply id="S3.E10.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E10.m1.1.1.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E10.m1.1.1.1.1.2.2.3.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E10.m1.1.1.1.1.2.2.3.2.2">𝑒</ci><ci id="S3.E10.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E10.m1.1.1.1.1.2.2.3.2.3">𝑘</ci></apply><ci id="S3.E10.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E10.m1.1.1.1.1.2.2.3.3">𝒱</ci></apply></apply><apply id="S3.E10.m1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2.1">subscript</csymbol><apply id="S3.E10.m1.1.1.1.1.2.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E10.m1.1.1.1.1.2.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.2">norm</csymbol><apply id="S3.E10.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1"><minus id="S3.E10.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.2"></minus><apply id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.2"></times><ci id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.3">𝐸</ci><apply id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E10.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.3.2">𝑒</ci><ci id="S3.E10.m1.1.1.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><cn id="S3.E10.m1.1.1.1.1.2.1.3.cmml" type="integer" xref="S3.E10.m1.1.1.1.1.2.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">z_{i}=q(E(x_{i}))=\mathop{\mathrm{argmin}}\limits_{e_{k}\in\mathcal{V}}||E(x_{%
i})-e_{k}||_{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.1d">italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_q ( italic_E ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) = roman_argmin start_POSTSUBSCRIPT italic_e start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ caligraphic_V end_POSTSUBSCRIPT | | italic_E ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - italic_e start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p12.4">where <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS1.p12.4.m1.1"><semantics id="S3.SS1.p12.4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p12.4.m1.1.1" xref="S3.SS1.p12.4.m1.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p12.4.m1.1b"><ci id="S3.SS1.p12.4.m1.1.1.cmml" xref="S3.SS1.p12.4.m1.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p12.4.m1.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p12.4.m1.1d">caligraphic_V</annotation></semantics></math> is the image vocabulary containing visual tokens.</p>
</div>
<div class="ltx_para" id="S3.SS1.p13">
<p class="ltx_p" id="S3.SS1.p13.2">Conversely, the decoder <math alttext="G" class="ltx_Math" display="inline" id="S3.SS1.p13.1.m1.1"><semantics id="S3.SS1.p13.1.m1.1a"><mi id="S3.SS1.p13.1.m1.1.1" xref="S3.SS1.p13.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p13.1.m1.1b"><ci id="S3.SS1.p13.1.m1.1.1.cmml" xref="S3.SS1.p13.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p13.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p13.1.m1.1d">italic_G</annotation></semantics></math> of the image tokenizer reconstructs the input image based on the visual tokens generated by <math alttext="E" class="ltx_Math" display="inline" id="S3.SS1.p13.2.m2.1"><semantics id="S3.SS1.p13.2.m2.1a"><mi id="S3.SS1.p13.2.m2.1.1" xref="S3.SS1.p13.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p13.2.m2.1b"><ci id="S3.SS1.p13.2.m2.1.1.cmml" xref="S3.SS1.p13.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p13.2.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p13.2.m2.1d">italic_E</annotation></semantics></math>, formulated as</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathbf{x}}=G(q(E(\mathbf{x})))." class="ltx_Math" display="block" id="S3.E11.m1.2"><semantics id="S3.E11.m1.2a"><mrow id="S3.E11.m1.2.2.1" xref="S3.E11.m1.2.2.1.1.cmml"><mrow id="S3.E11.m1.2.2.1.1" xref="S3.E11.m1.2.2.1.1.cmml"><mover accent="true" id="S3.E11.m1.2.2.1.1.3" xref="S3.E11.m1.2.2.1.1.3.cmml"><mi id="S3.E11.m1.2.2.1.1.3.2" xref="S3.E11.m1.2.2.1.1.3.2.cmml">𝐱</mi><mo id="S3.E11.m1.2.2.1.1.3.1" xref="S3.E11.m1.2.2.1.1.3.1.cmml">^</mo></mover><mo id="S3.E11.m1.2.2.1.1.2" xref="S3.E11.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E11.m1.2.2.1.1.1" xref="S3.E11.m1.2.2.1.1.1.cmml"><mi id="S3.E11.m1.2.2.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.3.cmml">G</mi><mo id="S3.E11.m1.2.2.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.2.2.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.2.2.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.1.1.1.3.cmml">q</mi><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">E</mi><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">𝐱</mi><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E11.m1.2.2.1.2" lspace="0em" xref="S3.E11.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.2b"><apply id="S3.E11.m1.2.2.1.1.cmml" xref="S3.E11.m1.2.2.1"><eq id="S3.E11.m1.2.2.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.2"></eq><apply id="S3.E11.m1.2.2.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.3"><ci id="S3.E11.m1.2.2.1.1.3.1.cmml" xref="S3.E11.m1.2.2.1.1.3.1">^</ci><ci id="S3.E11.m1.2.2.1.1.3.2.cmml" xref="S3.E11.m1.2.2.1.1.3.2">𝐱</ci></apply><apply id="S3.E11.m1.2.2.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1"><times id="S3.E11.m1.2.2.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.2"></times><ci id="S3.E11.m1.2.2.1.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.1.3">𝐺</ci><apply id="S3.E11.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1"><times id="S3.E11.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2"></times><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.3">𝑞</ci><apply id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝐸</ci><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.2c">\hat{\mathbf{x}}=G(q(E(\mathbf{x}))).</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.2d">over^ start_ARG bold_x end_ARG = italic_G ( italic_q ( italic_E ( bold_x ) ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p14">
<p class="ltx_p" id="S3.SS1.p14.1">Please note that during training, we use the encoder to obtain visual tokens of the target image as labels. During inference, the decoder converts visual tokens generated by the image decoder into the target image.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="307" id="S3.F3.g1" src="extracted/5707577/figures/training.png" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Overview of our two-stage training framework. The
modules enclosed by dotted lines will be removed during inference.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Model Training</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">We provide a detailed description of the training procedures for our model, which consists of two stages, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S3.F3" title="Figure 3 ‣ 3.1 Model Architecture ‣ 3 Our Model ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">Stage 1</span>. At this stage, we train the image tokenizer using a large-scale unlabeled image dataset <math alttext="D_{v}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">D</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝐷</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">D_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_D start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> in the same way as ViT-VQGAN <cite class="ltx_cite ltx_citemacro_cite">Yu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib41" title="">2022a</a>)</cite>, where we convert the input image into visual tokens and then reconstruct the image from these visual tokens.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.2">Given an image <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">bold_x</annotation></semantics></math> from the unlabeled image dataset <math alttext="D_{v}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">D</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝐷</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">D_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_D start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>, we define the training objective of this stage as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E12">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E12X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{1}=||\hat{\mathbf{x}}-\mathbf{x}||^{2}" class="ltx_Math" display="inline" id="S3.E12X.2.1.1.m1.1"><semantics id="S3.E12X.2.1.1.m1.1a"><mrow id="S3.E12X.2.1.1.m1.1.1" xref="S3.E12X.2.1.1.m1.1.1.cmml"><msub id="S3.E12X.2.1.1.m1.1.1.3" xref="S3.E12X.2.1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12X.2.1.1.m1.1.1.3.2" xref="S3.E12X.2.1.1.m1.1.1.3.2.cmml">ℒ</mi><mn id="S3.E12X.2.1.1.m1.1.1.3.3" xref="S3.E12X.2.1.1.m1.1.1.3.3.cmml">1</mn></msub><mo id="S3.E12X.2.1.1.m1.1.1.2" xref="S3.E12X.2.1.1.m1.1.1.2.cmml">=</mo><msup id="S3.E12X.2.1.1.m1.1.1.1" xref="S3.E12X.2.1.1.m1.1.1.1.cmml"><mrow id="S3.E12X.2.1.1.m1.1.1.1.1.1" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.cmml"><mo id="S3.E12X.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E12X.2.1.1.m1.1.1.1.1.1.1" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2.2" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mo id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2.1" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S3.E12X.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E12X.2.1.1.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E12X.2.1.1.m1.1.1.1.3" xref="S3.E12X.2.1.1.m1.1.1.1.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E12X.2.1.1.m1.1b"><apply id="S3.E12X.2.1.1.m1.1.1.cmml" xref="S3.E12X.2.1.1.m1.1.1"><eq id="S3.E12X.2.1.1.m1.1.1.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.2"></eq><apply id="S3.E12X.2.1.1.m1.1.1.3.cmml" xref="S3.E12X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E12X.2.1.1.m1.1.1.3.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S3.E12X.2.1.1.m1.1.1.3.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.3.2">ℒ</ci><cn id="S3.E12X.2.1.1.m1.1.1.3.3.cmml" type="integer" xref="S3.E12X.2.1.1.m1.1.1.3.3">1</cn></apply><apply id="S3.E12X.2.1.1.m1.1.1.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E12X.2.1.1.m1.1.1.1.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.1">superscript</csymbol><apply id="S3.E12X.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E12X.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1"><minus id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.1"></minus><apply id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2"><ci id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.2.2">𝐱</ci></apply><ci id="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E12X.2.1.1.m1.1.1.1.1.1.1.3">𝐱</ci></apply></apply><cn id="S3.E12X.2.1.1.m1.1.1.1.3.cmml" type="integer" xref="S3.E12X.2.1.1.m1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12X.2.1.1.m1.1c">\displaystyle\mathcal{L}_{1}=||\hat{\mathbf{x}}-\mathbf{x}||^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E12X.2.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = | | over^ start_ARG bold_x end_ARG - bold_x | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+||\mathrm{sg}(E(\mathbf{x}))-\mathbf{z}||_{2}^{2}" class="ltx_Math" display="inline" id="S3.E12X.3.2.2.m1.2"><semantics id="S3.E12X.3.2.2.m1.2a"><mrow id="S3.E12X.3.2.2.m1.2.2" xref="S3.E12X.3.2.2.m1.2.2.cmml"><mo id="S3.E12X.3.2.2.m1.2.2a" xref="S3.E12X.3.2.2.m1.2.2.cmml">+</mo><msubsup id="S3.E12X.3.2.2.m1.2.2.1" xref="S3.E12X.3.2.2.m1.2.2.1.cmml"><mrow id="S3.E12X.3.2.2.m1.2.2.1.1.1.1" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.2.cmml"><mo id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.2" stretchy="false" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml">sg</mi><mo id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">E</mi><mo id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E12X.3.2.2.m1.1.1" xref="S3.E12X.3.2.2.m1.1.1.cmml">𝐱</mi><mo id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml">−</mo><mi id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml">𝐳</mi></mrow><mo id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.3" stretchy="false" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E12X.3.2.2.m1.2.2.1.1.3" xref="S3.E12X.3.2.2.m1.2.2.1.1.3.cmml">2</mn><mn id="S3.E12X.3.2.2.m1.2.2.1.3" xref="S3.E12X.3.2.2.m1.2.2.1.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.E12X.3.2.2.m1.2b"><apply id="S3.E12X.3.2.2.m1.2.2.cmml" xref="S3.E12X.3.2.2.m1.2.2"><plus id="S3.E12X.3.2.2.m1.2.2.2.cmml" xref="S3.E12X.3.2.2.m1.2.2"></plus><apply id="S3.E12X.3.2.2.m1.2.2.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.1"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.2.2.1.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.1">superscript</csymbol><apply id="S3.E12X.3.2.2.m1.2.2.1.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.1"><csymbol cd="ambiguous" id="S3.E12X.3.2.2.m1.2.2.1.1.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.1">subscript</csymbol><apply id="S3.E12X.3.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E12X.3.2.2.m1.2.2.1.1.1.2.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.2">norm</csymbol><apply id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1"><minus id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.2"></minus><apply id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1"><times id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.2"></times><ci id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.3">sg</ci><apply id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝐸</ci><ci id="S3.E12X.3.2.2.m1.1.1.cmml" xref="S3.E12X.3.2.2.m1.1.1">𝐱</ci></apply></apply><ci id="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E12X.3.2.2.m1.2.2.1.1.1.1.1.3">𝐳</ci></apply></apply><cn id="S3.E12X.3.2.2.m1.2.2.1.1.3.cmml" type="integer" xref="S3.E12X.3.2.2.m1.2.2.1.1.3">2</cn></apply><cn id="S3.E12X.3.2.2.m1.2.2.1.3.cmml" type="integer" xref="S3.E12X.3.2.2.m1.2.2.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12X.3.2.2.m1.2c">\displaystyle+||\mathrm{sg}(E(\mathbf{x}))-\mathbf{z}||_{2}^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E12X.3.2.2.m1.2d">+ | | roman_sg ( italic_E ( bold_x ) ) - bold_z | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(12)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E12Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+\beta||E(\mathbf{x})-\mathrm{sg}(\mathbf{z})||_{2}^{2}." class="ltx_Math" display="inline" id="S3.E12Xa.2.1.1.m1.3"><semantics id="S3.E12Xa.2.1.1.m1.3a"><mrow id="S3.E12Xa.2.1.1.m1.3.3.1" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.E12Xa.2.1.1.m1.3.3.1.1" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.cmml"><mo id="S3.E12Xa.2.1.1.m1.3.3.1.1a" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.cmml">+</mo><mrow id="S3.E12Xa.2.1.1.m1.3.3.1.1.1" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.cmml"><mi id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.3" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.3.cmml">β</mi><mo id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.2" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.2.cmml">⁢</mo><msubsup id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml">E</mi><mo id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.1" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E12Xa.2.1.1.m1.1.1" xref="S3.E12Xa.2.1.1.m1.1.1.cmml">𝐱</mi><mo id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">sg</mi><mo id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.1" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mo id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E12Xa.2.1.1.m1.2.2" xref="S3.E12Xa.2.1.1.m1.2.2.cmml">𝐳</mi><mo id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.3" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S3.E12Xa.2.1.1.m1.3.3.1.2" lspace="0em" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12Xa.2.1.1.m1.3b"><apply id="S3.E12Xa.2.1.1.m1.3.3.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1"><plus id="S3.E12Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1"></plus><apply id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1"><times id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.2"></times><ci id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.3.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.3">𝛽</ci><apply id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1">superscript</csymbol><apply id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1">subscript</csymbol><apply id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1"><minus id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2"><times id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.1"></times><ci id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2.2">𝐸</ci><ci id="S3.E12Xa.2.1.1.m1.1.1.cmml" xref="S3.E12Xa.2.1.1.m1.1.1">𝐱</ci></apply><apply id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3"><times id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3.2">sg</ci><ci id="S3.E12Xa.2.1.1.m1.2.2.cmml" xref="S3.E12Xa.2.1.1.m1.2.2">𝐳</ci></apply></apply></apply><cn id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.1.3">2</cn></apply><cn id="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="S3.E12Xa.2.1.1.m1.3.3.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12Xa.2.1.1.m1.3c">\displaystyle+\beta||E(\mathbf{x})-\mathrm{sg}(\mathbf{z})||_{2}^{2}.</annotation><annotation encoding="application/x-llamapun" id="S3.E12Xa.2.1.1.m1.3d">+ italic_β | | italic_E ( bold_x ) - roman_sg ( bold_z ) | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.4">Here, the first item is the reconstruction loss optimizing the encoder and decoder, the middle item is the vector-quantization loss used to update the visual tokens, the last item is the so-called “commitment loss” for the encoder which prevents its output fluctuating frequently from one visual token to another, <math alttext="\mathrm{sg}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m1.1"><semantics id="S3.SS2.p3.3.m1.1a"><mrow id="S3.SS2.p3.3.m1.1.2" xref="S3.SS2.p3.3.m1.1.2.cmml"><mi id="S3.SS2.p3.3.m1.1.2.2" xref="S3.SS2.p3.3.m1.1.2.2.cmml">sg</mi><mo id="S3.SS2.p3.3.m1.1.2.1" xref="S3.SS2.p3.3.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p3.3.m1.1.2.3.2" xref="S3.SS2.p3.3.m1.1.2.cmml"><mo id="S3.SS2.p3.3.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p3.3.m1.1.2.cmml">(</mo><mo id="S3.SS2.p3.3.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p3.3.m1.1.1.cmml">⋅</mo><mo id="S3.SS2.p3.3.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p3.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m1.1b"><apply id="S3.SS2.p3.3.m1.1.2.cmml" xref="S3.SS2.p3.3.m1.1.2"><times id="S3.SS2.p3.3.m1.1.2.1.cmml" xref="S3.SS2.p3.3.m1.1.2.1"></times><ci id="S3.SS2.p3.3.m1.1.2.2.cmml" xref="S3.SS2.p3.3.m1.1.2.2">sg</ci><ci id="S3.SS2.p3.3.m1.1.1.cmml" xref="S3.SS2.p3.3.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m1.1c">\mathrm{sg}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m1.1d">roman_sg ( ⋅ )</annotation></semantics></math> denotes the stop-gradient operation, and <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m2.1"><semantics id="S3.SS2.p3.4.m2.1a"><mi id="S3.SS2.p3.4.m2.1.1" xref="S3.SS2.p3.4.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m2.1b"><ci id="S3.SS2.p3.4.m2.1.1.cmml" xref="S3.SS2.p3.4.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m2.1d">italic_β</annotation></semantics></math> is the weighting factor set to 0.25 following <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib32" title="">van den Oord et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib32" title="">2017</a></cite>).<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Note that we also include other loss terms as presented in <cite class="ltx_cite ltx_citemacro_cite">Yu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib41" title="">2022a</a>)</cite>, but omit the descriptions for brevity. Please refer to <cite class="ltx_cite ltx_citemacro_cite">Yu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib41" title="">2022a</a>)</cite> for more details.</span></span></span></p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p4.1.1">Stage 2</span>. Using an IIMT dataset, we then adopt multi-task learning and knowledge distillation to train the image encoder, target text decoder, and image decoder.</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.5">Overall, the training objective at this stage is defined as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{2}=\mathcal{L}_{iimt}+\mathcal{L}_{ocr}+\mathcal{L}_{tit}+%
\mathcal{L}_{kd}." class="ltx_Math" display="block" id="S3.E13.m1.1"><semantics id="S3.E13.m1.1a"><mrow id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><mrow id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><msub id="S3.E13.m1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.2.2" xref="S3.E13.m1.1.1.1.1.2.2.cmml">ℒ</mi><mn id="S3.E13.m1.1.1.1.1.2.3" xref="S3.E13.m1.1.1.1.1.2.3.cmml">2</mn></msub><mo id="S3.E13.m1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E13.m1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.3.cmml"><msub id="S3.E13.m1.1.1.1.1.3.2" xref="S3.E13.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.3.2.2" xref="S3.E13.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.1.1.3.2.3" xref="S3.E13.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E13.m1.1.1.1.1.3.2.3.2" xref="S3.E13.m1.1.1.1.1.3.2.3.2.cmml">i</mi><mo id="S3.E13.m1.1.1.1.1.3.2.3.1" xref="S3.E13.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E13.m1.1.1.1.1.3.2.3.3" xref="S3.E13.m1.1.1.1.1.3.2.3.3.cmml">i</mi><mo id="S3.E13.m1.1.1.1.1.3.2.3.1a" xref="S3.E13.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E13.m1.1.1.1.1.3.2.3.4" xref="S3.E13.m1.1.1.1.1.3.2.3.4.cmml">m</mi><mo id="S3.E13.m1.1.1.1.1.3.2.3.1b" xref="S3.E13.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E13.m1.1.1.1.1.3.2.3.5" xref="S3.E13.m1.1.1.1.1.3.2.3.5.cmml">t</mi></mrow></msub><mo id="S3.E13.m1.1.1.1.1.3.1" xref="S3.E13.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E13.m1.1.1.1.1.3.3" xref="S3.E13.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.3.3.2" xref="S3.E13.m1.1.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.1.1.3.3.3" xref="S3.E13.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E13.m1.1.1.1.1.3.3.3.2" xref="S3.E13.m1.1.1.1.1.3.3.3.2.cmml">o</mi><mo id="S3.E13.m1.1.1.1.1.3.3.3.1" xref="S3.E13.m1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.E13.m1.1.1.1.1.3.3.3.3" xref="S3.E13.m1.1.1.1.1.3.3.3.3.cmml">c</mi><mo id="S3.E13.m1.1.1.1.1.3.3.3.1a" xref="S3.E13.m1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.E13.m1.1.1.1.1.3.3.3.4" xref="S3.E13.m1.1.1.1.1.3.3.3.4.cmml">r</mi></mrow></msub><mo id="S3.E13.m1.1.1.1.1.3.1a" xref="S3.E13.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E13.m1.1.1.1.1.3.4" xref="S3.E13.m1.1.1.1.1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.3.4.2" xref="S3.E13.m1.1.1.1.1.3.4.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.1.1.3.4.3" xref="S3.E13.m1.1.1.1.1.3.4.3.cmml"><mi id="S3.E13.m1.1.1.1.1.3.4.3.2" xref="S3.E13.m1.1.1.1.1.3.4.3.2.cmml">t</mi><mo id="S3.E13.m1.1.1.1.1.3.4.3.1" xref="S3.E13.m1.1.1.1.1.3.4.3.1.cmml">⁢</mo><mi id="S3.E13.m1.1.1.1.1.3.4.3.3" xref="S3.E13.m1.1.1.1.1.3.4.3.3.cmml">i</mi><mo id="S3.E13.m1.1.1.1.1.3.4.3.1a" xref="S3.E13.m1.1.1.1.1.3.4.3.1.cmml">⁢</mo><mi id="S3.E13.m1.1.1.1.1.3.4.3.4" xref="S3.E13.m1.1.1.1.1.3.4.3.4.cmml">t</mi></mrow></msub><mo id="S3.E13.m1.1.1.1.1.3.1b" xref="S3.E13.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E13.m1.1.1.1.1.3.5" xref="S3.E13.m1.1.1.1.1.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.3.5.2" xref="S3.E13.m1.1.1.1.1.3.5.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.1.1.3.5.3" xref="S3.E13.m1.1.1.1.1.3.5.3.cmml"><mi id="S3.E13.m1.1.1.1.1.3.5.3.2" xref="S3.E13.m1.1.1.1.1.3.5.3.2.cmml">k</mi><mo id="S3.E13.m1.1.1.1.1.3.5.3.1" xref="S3.E13.m1.1.1.1.1.3.5.3.1.cmml">⁢</mo><mi id="S3.E13.m1.1.1.1.1.3.5.3.3" xref="S3.E13.m1.1.1.1.1.3.5.3.3.cmml">d</mi></mrow></msub></mrow></mrow><mo id="S3.E13.m1.1.1.1.2" lspace="0em" xref="S3.E13.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1"><eq id="S3.E13.m1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1"></eq><apply id="S3.E13.m1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.1.1.1.1.2.2">ℒ</ci><cn id="S3.E13.m1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E13.m1.1.1.1.1.2.3">2</cn></apply><apply id="S3.E13.m1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.3"><plus id="S3.E13.m1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.1"></plus><apply id="S3.E13.m1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.2.1.cmml" xref="S3.E13.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.2.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.2.3.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3"><times id="S3.E13.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3.2">𝑖</ci><ci id="S3.E13.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3.3">𝑖</ci><ci id="S3.E13.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3.4">𝑚</ci><ci id="S3.E13.m1.1.1.1.1.3.2.3.5.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3.5">𝑡</ci></apply></apply><apply id="S3.E13.m1.1.1.1.1.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.3.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3"><times id="S3.E13.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.2">𝑜</ci><ci id="S3.E13.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.3">𝑐</ci><ci id="S3.E13.m1.1.1.1.1.3.3.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.4">𝑟</ci></apply></apply><apply id="S3.E13.m1.1.1.1.1.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.4.1.cmml" xref="S3.E13.m1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.4.2.cmml" xref="S3.E13.m1.1.1.1.1.3.4.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.4.3.cmml" xref="S3.E13.m1.1.1.1.1.3.4.3"><times id="S3.E13.m1.1.1.1.1.3.4.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.4.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.4.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.4.3.2">𝑡</ci><ci id="S3.E13.m1.1.1.1.1.3.4.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.4.3.3">𝑖</ci><ci id="S3.E13.m1.1.1.1.1.3.4.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.4.3.4">𝑡</ci></apply></apply><apply id="S3.E13.m1.1.1.1.1.3.5.cmml" xref="S3.E13.m1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.5.1.cmml" xref="S3.E13.m1.1.1.1.1.3.5">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.5.2.cmml" xref="S3.E13.m1.1.1.1.1.3.5.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.5.3.cmml" xref="S3.E13.m1.1.1.1.1.3.5.3"><times id="S3.E13.m1.1.1.1.1.3.5.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.5.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.5.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.5.3.2">𝑘</ci><ci id="S3.E13.m1.1.1.1.1.3.5.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.5.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\mathcal{L}_{2}=\mathcal{L}_{iimt}+\mathcal{L}_{ocr}+\mathcal{L}_{tit}+%
\mathcal{L}_{kd}.</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_i italic_i italic_m italic_t end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT italic_o italic_c italic_r end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT italic_t italic_i italic_t end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT italic_k italic_d end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p5.4">where <math alttext="\mathcal{L}_{iimt}" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><msub id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml"><mi id="S3.SS2.p5.1.m1.1.1.3.2" xref="S3.SS2.p5.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p5.1.m1.1.1.3.1" xref="S3.SS2.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.1.m1.1.1.3.3" xref="S3.SS2.p5.1.m1.1.1.3.3.cmml">i</mi><mo id="S3.SS2.p5.1.m1.1.1.3.1a" xref="S3.SS2.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.1.m1.1.1.3.4" xref="S3.SS2.p5.1.m1.1.1.3.4.cmml">m</mi><mo id="S3.SS2.p5.1.m1.1.1.3.1b" xref="S3.SS2.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.1.m1.1.1.3.5" xref="S3.SS2.p5.1.m1.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">ℒ</ci><apply id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3"><times id="S3.SS2.p5.1.m1.1.1.3.1.cmml" xref="S3.SS2.p5.1.m1.1.1.3.1"></times><ci id="S3.SS2.p5.1.m1.1.1.3.2.cmml" xref="S3.SS2.p5.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS2.p5.1.m1.1.1.3.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3">𝑖</ci><ci id="S3.SS2.p5.1.m1.1.1.3.4.cmml" xref="S3.SS2.p5.1.m1.1.1.3.4">𝑚</ci><ci id="S3.SS2.p5.1.m1.1.1.3.5.cmml" xref="S3.SS2.p5.1.m1.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\mathcal{L}_{iimt}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_i italic_i italic_m italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathcal{L}_{ocr}" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.1"><semantics id="S3.SS2.p5.2.m2.1a"><msub id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.3.2.cmml">o</mi><mo id="S3.SS2.p5.2.m2.1.1.3.1" xref="S3.SS2.p5.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.2.m2.1.1.3.3" xref="S3.SS2.p5.2.m2.1.1.3.3.cmml">c</mi><mo id="S3.SS2.p5.2.m2.1.1.3.1a" xref="S3.SS2.p5.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.2.m2.1.1.3.4" xref="S3.SS2.p5.2.m2.1.1.3.4.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2">ℒ</ci><apply id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3"><times id="S3.SS2.p5.2.m2.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3.1"></times><ci id="S3.SS2.p5.2.m2.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.2">𝑜</ci><ci id="S3.SS2.p5.2.m2.1.1.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3">𝑐</ci><ci id="S3.SS2.p5.2.m2.1.1.3.4.cmml" xref="S3.SS2.p5.2.m2.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">\mathcal{L}_{ocr}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_o italic_c italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathcal{L}_{tit}" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m3.1"><semantics id="S3.SS2.p5.3.m3.1a"><msub id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml"><mi id="S3.SS2.p5.3.m3.1.1.3.2" xref="S3.SS2.p5.3.m3.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p5.3.m3.1.1.3.1" xref="S3.SS2.p5.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.3.m3.1.1.3.3" xref="S3.SS2.p5.3.m3.1.1.3.3.cmml">i</mi><mo id="S3.SS2.p5.3.m3.1.1.3.1a" xref="S3.SS2.p5.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.3.m3.1.1.3.4" xref="S3.SS2.p5.3.m3.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">ℒ</ci><apply id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3"><times id="S3.SS2.p5.3.m3.1.1.3.1.cmml" xref="S3.SS2.p5.3.m3.1.1.3.1"></times><ci id="S3.SS2.p5.3.m3.1.1.3.2.cmml" xref="S3.SS2.p5.3.m3.1.1.3.2">𝑡</ci><ci id="S3.SS2.p5.3.m3.1.1.3.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3.3">𝑖</ci><ci id="S3.SS2.p5.3.m3.1.1.3.4.cmml" xref="S3.SS2.p5.3.m3.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">\mathcal{L}_{tit}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_t italic_i italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\mathcal{L}_{kd}" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m4.1"><semantics id="S3.SS2.p5.4.m4.1a"><msub id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml">ℒ</mi><mrow id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml"><mi id="S3.SS2.p5.4.m4.1.1.3.2" xref="S3.SS2.p5.4.m4.1.1.3.2.cmml">k</mi><mo id="S3.SS2.p5.4.m4.1.1.3.1" xref="S3.SS2.p5.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.4.m4.1.1.3.3" xref="S3.SS2.p5.4.m4.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2">ℒ</ci><apply id="S3.SS2.p5.4.m4.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3"><times id="S3.SS2.p5.4.m4.1.1.3.1.cmml" xref="S3.SS2.p5.4.m4.1.1.3.1"></times><ci id="S3.SS2.p5.4.m4.1.1.3.2.cmml" xref="S3.SS2.p5.4.m4.1.1.3.2">𝑘</ci><ci id="S3.SS2.p5.4.m4.1.1.3.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">\mathcal{L}_{kd}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT italic_k italic_d end_POSTSUBSCRIPT</annotation></semantics></math> denote the IIMT task loss, OCR auxiliary task loss, TIT auxiliary task loss, and knowledge distillation loss, respectively. <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>We also explore the balance of different training objectives. Experimental results in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A1" title="Appendix A The effectiveness of the training objective with balancing coefficients ‣ Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">A</span></a> show that we do not need to introduce additional hyperparameters to balance different objectives.</span></span></span></p>
</div>
<div class="ltx_para" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.7">Given an IIMT training instance <math alttext="(\mathbf{x},\mathbf{y},\mathbf{s},\mathbf{t})" class="ltx_Math" display="inline" id="S3.SS2.p6.1.m1.4"><semantics id="S3.SS2.p6.1.m1.4a"><mrow id="S3.SS2.p6.1.m1.4.5.2" xref="S3.SS2.p6.1.m1.4.5.1.cmml"><mo id="S3.SS2.p6.1.m1.4.5.2.1" stretchy="false" xref="S3.SS2.p6.1.m1.4.5.1.cmml">(</mo><mi id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml">𝐱</mi><mo id="S3.SS2.p6.1.m1.4.5.2.2" xref="S3.SS2.p6.1.m1.4.5.1.cmml">,</mo><mi id="S3.SS2.p6.1.m1.2.2" xref="S3.SS2.p6.1.m1.2.2.cmml">𝐲</mi><mo id="S3.SS2.p6.1.m1.4.5.2.3" xref="S3.SS2.p6.1.m1.4.5.1.cmml">,</mo><mi id="S3.SS2.p6.1.m1.3.3" xref="S3.SS2.p6.1.m1.3.3.cmml">𝐬</mi><mo id="S3.SS2.p6.1.m1.4.5.2.4" xref="S3.SS2.p6.1.m1.4.5.1.cmml">,</mo><mi id="S3.SS2.p6.1.m1.4.4" xref="S3.SS2.p6.1.m1.4.4.cmml">𝐭</mi><mo id="S3.SS2.p6.1.m1.4.5.2.5" stretchy="false" xref="S3.SS2.p6.1.m1.4.5.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.4b"><vector id="S3.SS2.p6.1.m1.4.5.1.cmml" xref="S3.SS2.p6.1.m1.4.5.2"><ci id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">𝐱</ci><ci id="S3.SS2.p6.1.m1.2.2.cmml" xref="S3.SS2.p6.1.m1.2.2">𝐲</ci><ci id="S3.SS2.p6.1.m1.3.3.cmml" xref="S3.SS2.p6.1.m1.3.3">𝐬</ci><ci id="S3.SS2.p6.1.m1.4.4.cmml" xref="S3.SS2.p6.1.m1.4.4">𝐭</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.4c">(\mathbf{x},\mathbf{y},\mathbf{s},\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.1.m1.4d">( bold_x , bold_y , bold_s , bold_t )</annotation></semantics></math> from the IIMT dataset <math alttext="D_{iimt}" class="ltx_Math" display="inline" id="S3.SS2.p6.2.m2.1"><semantics id="S3.SS2.p6.2.m2.1a"><msub id="S3.SS2.p6.2.m2.1.1" xref="S3.SS2.p6.2.m2.1.1.cmml"><mi id="S3.SS2.p6.2.m2.1.1.2" xref="S3.SS2.p6.2.m2.1.1.2.cmml">D</mi><mrow id="S3.SS2.p6.2.m2.1.1.3" xref="S3.SS2.p6.2.m2.1.1.3.cmml"><mi id="S3.SS2.p6.2.m2.1.1.3.2" xref="S3.SS2.p6.2.m2.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p6.2.m2.1.1.3.1" xref="S3.SS2.p6.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p6.2.m2.1.1.3.3" xref="S3.SS2.p6.2.m2.1.1.3.3.cmml">i</mi><mo id="S3.SS2.p6.2.m2.1.1.3.1a" xref="S3.SS2.p6.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p6.2.m2.1.1.3.4" xref="S3.SS2.p6.2.m2.1.1.3.4.cmml">m</mi><mo id="S3.SS2.p6.2.m2.1.1.3.1b" xref="S3.SS2.p6.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p6.2.m2.1.1.3.5" xref="S3.SS2.p6.2.m2.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.2.m2.1b"><apply id="S3.SS2.p6.2.m2.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.2.m2.1.1.1.cmml" xref="S3.SS2.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p6.2.m2.1.1.2.cmml" xref="S3.SS2.p6.2.m2.1.1.2">𝐷</ci><apply id="S3.SS2.p6.2.m2.1.1.3.cmml" xref="S3.SS2.p6.2.m2.1.1.3"><times id="S3.SS2.p6.2.m2.1.1.3.1.cmml" xref="S3.SS2.p6.2.m2.1.1.3.1"></times><ci id="S3.SS2.p6.2.m2.1.1.3.2.cmml" xref="S3.SS2.p6.2.m2.1.1.3.2">𝑖</ci><ci id="S3.SS2.p6.2.m2.1.1.3.3.cmml" xref="S3.SS2.p6.2.m2.1.1.3.3">𝑖</ci><ci id="S3.SS2.p6.2.m2.1.1.3.4.cmml" xref="S3.SS2.p6.2.m2.1.1.3.4">𝑚</ci><ci id="S3.SS2.p6.2.m2.1.1.3.5.cmml" xref="S3.SS2.p6.2.m2.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.2.m2.1c">D_{iimt}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.2.m2.1d">italic_D start_POSTSUBSCRIPT italic_i italic_i italic_m italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, we can utilize the image tokenizer trained in the first stage to process the target image, obtaining visual tokens denoted as <math alttext="\mathbf{z}" class="ltx_Math" display="inline" id="S3.SS2.p6.3.m3.1"><semantics id="S3.SS2.p6.3.m3.1a"><mi id="S3.SS2.p6.3.m3.1.1" xref="S3.SS2.p6.3.m3.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.3.m3.1b"><ci id="S3.SS2.p6.3.m3.1.1.cmml" xref="S3.SS2.p6.3.m3.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.3.m3.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.3.m3.1d">bold_z</annotation></semantics></math>. Here, <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS2.p6.4.m4.1"><semantics id="S3.SS2.p6.4.m4.1a"><mi id="S3.SS2.p6.4.m4.1.1" xref="S3.SS2.p6.4.m4.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.4.m4.1b"><ci id="S3.SS2.p6.4.m4.1.1.cmml" xref="S3.SS2.p6.4.m4.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.4.m4.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.4.m4.1d">bold_x</annotation></semantics></math> represents the source image, <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S3.SS2.p6.5.m5.1"><semantics id="S3.SS2.p6.5.m5.1a"><mi id="S3.SS2.p6.5.m5.1.1" xref="S3.SS2.p6.5.m5.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.5.m5.1b"><ci id="S3.SS2.p6.5.m5.1.1.cmml" xref="S3.SS2.p6.5.m5.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.5.m5.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.5.m5.1d">bold_y</annotation></semantics></math> is the target image, <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S3.SS2.p6.6.m6.1"><semantics id="S3.SS2.p6.6.m6.1a"><mi id="S3.SS2.p6.6.m6.1.1" xref="S3.SS2.p6.6.m6.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.6.m6.1b"><ci id="S3.SS2.p6.6.m6.1.1.cmml" xref="S3.SS2.p6.6.m6.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.6.m6.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.6.m6.1d">bold_s</annotation></semantics></math> denotes the source language text within the source image, and <math alttext="\mathbf{t}" class="ltx_Math" display="inline" id="S3.SS2.p6.7.m7.1"><semantics id="S3.SS2.p6.7.m7.1a"><mi id="S3.SS2.p6.7.m7.1.1" xref="S3.SS2.p6.7.m7.1.1.cmml">𝐭</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.7.m7.1b"><ci id="S3.SS2.p6.7.m7.1.1.cmml" xref="S3.SS2.p6.7.m7.1.1">𝐭</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.7.m7.1c">\mathbf{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.7.m7.1d">bold_t</annotation></semantics></math> denotes the target language text within the target image.</p>
</div>
<div class="ltx_para" id="S3.SS2.p7">
<p class="ltx_p" id="S3.SS2.p7.4">To alleviate the burden of end-to-end model training, we adopt multi-task learning, which involves not only the primary IIMT task but also two auxiliary tasks: the OCR task and the TIT task. The OCR task is employed to assist the model in recognizing texts within the image, while the TIT task further facilitates cross-lingual alignment. Formally, the training objective of the IIMT task can be formulated as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{iimt}=-\mathrm{log}p(\mathbf{z}|\mathbf{x};\theta_{ie},\theta_{%
ttd},\theta_{id})," class="ltx_Math" display="block" id="S3.E14.m1.2"><semantics id="S3.E14.m1.2a"><mrow id="S3.E14.m1.2.2.1" xref="S3.E14.m1.2.2.1.1.cmml"><mrow id="S3.E14.m1.2.2.1.1" xref="S3.E14.m1.2.2.1.1.cmml"><msub id="S3.E14.m1.2.2.1.1.3" xref="S3.E14.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.2.2.1.1.3.2" xref="S3.E14.m1.2.2.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E14.m1.2.2.1.1.3.3" xref="S3.E14.m1.2.2.1.1.3.3.cmml"><mi id="S3.E14.m1.2.2.1.1.3.3.2" xref="S3.E14.m1.2.2.1.1.3.3.2.cmml">i</mi><mo id="S3.E14.m1.2.2.1.1.3.3.1" xref="S3.E14.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E14.m1.2.2.1.1.3.3.3" xref="S3.E14.m1.2.2.1.1.3.3.3.cmml">i</mi><mo id="S3.E14.m1.2.2.1.1.3.3.1a" xref="S3.E14.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E14.m1.2.2.1.1.3.3.4" xref="S3.E14.m1.2.2.1.1.3.3.4.cmml">m</mi><mo id="S3.E14.m1.2.2.1.1.3.3.1b" xref="S3.E14.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E14.m1.2.2.1.1.3.3.5" xref="S3.E14.m1.2.2.1.1.3.3.5.cmml">t</mi></mrow></msub><mo id="S3.E14.m1.2.2.1.1.2" xref="S3.E14.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E14.m1.2.2.1.1.1" xref="S3.E14.m1.2.2.1.1.1.cmml"><mo id="S3.E14.m1.2.2.1.1.1a" xref="S3.E14.m1.2.2.1.1.1.cmml">−</mo><mrow id="S3.E14.m1.2.2.1.1.1.1" xref="S3.E14.m1.2.2.1.1.1.1.cmml"><mi id="S3.E14.m1.2.2.1.1.1.1.3" xref="S3.E14.m1.2.2.1.1.1.1.3.cmml">log</mi><mo id="S3.E14.m1.2.2.1.1.1.1.2" xref="S3.E14.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E14.m1.2.2.1.1.1.1.4" xref="S3.E14.m1.2.2.1.1.1.1.4.cmml">p</mi><mo id="S3.E14.m1.2.2.1.1.1.1.2a" xref="S3.E14.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E14.m1.2.2.1.1.1.1.1.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E14.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.2.2.1.1.1.1.1.1.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.1.5" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.5.cmml">𝐳</mi><mo fence="false" id="S3.E14.m1.2.2.1.1.1.1.1.1.1.4" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.4.cmml">|</mo><mrow id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.4.cmml"><mi id="S3.E14.m1.1.1" xref="S3.E14.m1.1.1.cmml">𝐱</mi><mo id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.4" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.4.cmml">;</mo><msub id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">e</mi></mrow></msub><mo id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.5" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.3.cmml">t</mi><mo id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1a" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.4" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.4.cmml">d</mi></mrow></msub><mo id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.6" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.2.cmml">θ</mi><mrow id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.2" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.2.cmml">i</mi><mo id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.1" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.3" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.3.cmml">d</mi></mrow></msub></mrow></mrow><mo id="S3.E14.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E14.m1.2.2.1.2" xref="S3.E14.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.2b"><apply id="S3.E14.m1.2.2.1.1.cmml" xref="S3.E14.m1.2.2.1"><eq id="S3.E14.m1.2.2.1.1.2.cmml" xref="S3.E14.m1.2.2.1.1.2"></eq><apply id="S3.E14.m1.2.2.1.1.3.cmml" xref="S3.E14.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.3.1.cmml" xref="S3.E14.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E14.m1.2.2.1.1.3.2.cmml" xref="S3.E14.m1.2.2.1.1.3.2">ℒ</ci><apply id="S3.E14.m1.2.2.1.1.3.3.cmml" xref="S3.E14.m1.2.2.1.1.3.3"><times id="S3.E14.m1.2.2.1.1.3.3.1.cmml" xref="S3.E14.m1.2.2.1.1.3.3.1"></times><ci id="S3.E14.m1.2.2.1.1.3.3.2.cmml" xref="S3.E14.m1.2.2.1.1.3.3.2">𝑖</ci><ci id="S3.E14.m1.2.2.1.1.3.3.3.cmml" xref="S3.E14.m1.2.2.1.1.3.3.3">𝑖</ci><ci id="S3.E14.m1.2.2.1.1.3.3.4.cmml" xref="S3.E14.m1.2.2.1.1.3.3.4">𝑚</ci><ci id="S3.E14.m1.2.2.1.1.3.3.5.cmml" xref="S3.E14.m1.2.2.1.1.3.3.5">𝑡</ci></apply></apply><apply id="S3.E14.m1.2.2.1.1.1.cmml" xref="S3.E14.m1.2.2.1.1.1"><minus id="S3.E14.m1.2.2.1.1.1.2.cmml" xref="S3.E14.m1.2.2.1.1.1"></minus><apply id="S3.E14.m1.2.2.1.1.1.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1"><times id="S3.E14.m1.2.2.1.1.1.1.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.2"></times><ci id="S3.E14.m1.2.2.1.1.1.1.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.3">log</ci><ci id="S3.E14.m1.2.2.1.1.1.1.4.cmml" xref="S3.E14.m1.2.2.1.1.1.1.4">𝑝</ci><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E14.m1.2.2.1.1.1.1.1.1.1.4.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.4">conditional</csymbol><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.1.5.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.5">𝐳</ci><list id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3"><ci id="S3.E14.m1.1.1.cmml" xref="S3.E14.m1.1.1">𝐱</ci><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑒</ci></apply></apply><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.2">𝜃</ci><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3"><times id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.2">𝑡</ci><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.3">𝑡</ci><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.4.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.4">𝑑</ci></apply></apply><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.2">𝜃</ci><apply id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3"><times id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.2">𝑖</ci><ci id="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E14.m1.2.2.1.1.1.1.1.1.1.3.3.3.3.3">𝑑</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.2c">\mathcal{L}_{iimt}=-\mathrm{log}p(\mathbf{z}|\mathbf{x};\theta_{ie},\theta_{%
ttd},\theta_{id}),</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_i italic_i italic_m italic_t end_POSTSUBSCRIPT = - roman_log italic_p ( bold_z | bold_x ; italic_θ start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_t italic_t italic_d end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p7.3">where <math alttext="\theta_{ie}" class="ltx_Math" display="inline" id="S3.SS2.p7.1.m1.1"><semantics id="S3.SS2.p7.1.m1.1a"><msub id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml"><mi id="S3.SS2.p7.1.m1.1.1.2" xref="S3.SS2.p7.1.m1.1.1.2.cmml">θ</mi><mrow id="S3.SS2.p7.1.m1.1.1.3" xref="S3.SS2.p7.1.m1.1.1.3.cmml"><mi id="S3.SS2.p7.1.m1.1.1.3.2" xref="S3.SS2.p7.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p7.1.m1.1.1.3.1" xref="S3.SS2.p7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p7.1.m1.1.1.3.3" xref="S3.SS2.p7.1.m1.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b"><apply id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p7.1.m1.1.1.2.cmml" xref="S3.SS2.p7.1.m1.1.1.2">𝜃</ci><apply id="S3.SS2.p7.1.m1.1.1.3.cmml" xref="S3.SS2.p7.1.m1.1.1.3"><times id="S3.SS2.p7.1.m1.1.1.3.1.cmml" xref="S3.SS2.p7.1.m1.1.1.3.1"></times><ci id="S3.SS2.p7.1.m1.1.1.3.2.cmml" xref="S3.SS2.p7.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS2.p7.1.m1.1.1.3.3.cmml" xref="S3.SS2.p7.1.m1.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">\theta_{ie}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.1.m1.1d">italic_θ start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\theta_{ttd}" class="ltx_Math" display="inline" id="S3.SS2.p7.2.m2.1"><semantics id="S3.SS2.p7.2.m2.1a"><msub id="S3.SS2.p7.2.m2.1.1" xref="S3.SS2.p7.2.m2.1.1.cmml"><mi id="S3.SS2.p7.2.m2.1.1.2" xref="S3.SS2.p7.2.m2.1.1.2.cmml">θ</mi><mrow id="S3.SS2.p7.2.m2.1.1.3" xref="S3.SS2.p7.2.m2.1.1.3.cmml"><mi id="S3.SS2.p7.2.m2.1.1.3.2" xref="S3.SS2.p7.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p7.2.m2.1.1.3.1" xref="S3.SS2.p7.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p7.2.m2.1.1.3.3" xref="S3.SS2.p7.2.m2.1.1.3.3.cmml">t</mi><mo id="S3.SS2.p7.2.m2.1.1.3.1a" xref="S3.SS2.p7.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p7.2.m2.1.1.3.4" xref="S3.SS2.p7.2.m2.1.1.3.4.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m2.1b"><apply id="S3.SS2.p7.2.m2.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.2.m2.1.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p7.2.m2.1.1.2.cmml" xref="S3.SS2.p7.2.m2.1.1.2">𝜃</ci><apply id="S3.SS2.p7.2.m2.1.1.3.cmml" xref="S3.SS2.p7.2.m2.1.1.3"><times id="S3.SS2.p7.2.m2.1.1.3.1.cmml" xref="S3.SS2.p7.2.m2.1.1.3.1"></times><ci id="S3.SS2.p7.2.m2.1.1.3.2.cmml" xref="S3.SS2.p7.2.m2.1.1.3.2">𝑡</ci><ci id="S3.SS2.p7.2.m2.1.1.3.3.cmml" xref="S3.SS2.p7.2.m2.1.1.3.3">𝑡</ci><ci id="S3.SS2.p7.2.m2.1.1.3.4.cmml" xref="S3.SS2.p7.2.m2.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.2.m2.1c">\theta_{ttd}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.2.m2.1d">italic_θ start_POSTSUBSCRIPT italic_t italic_t italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\theta_{id}" class="ltx_Math" display="inline" id="S3.SS2.p7.3.m3.1"><semantics id="S3.SS2.p7.3.m3.1a"><msub id="S3.SS2.p7.3.m3.1.1" xref="S3.SS2.p7.3.m3.1.1.cmml"><mi id="S3.SS2.p7.3.m3.1.1.2" xref="S3.SS2.p7.3.m3.1.1.2.cmml">θ</mi><mrow id="S3.SS2.p7.3.m3.1.1.3" xref="S3.SS2.p7.3.m3.1.1.3.cmml"><mi id="S3.SS2.p7.3.m3.1.1.3.2" xref="S3.SS2.p7.3.m3.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p7.3.m3.1.1.3.1" xref="S3.SS2.p7.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p7.3.m3.1.1.3.3" xref="S3.SS2.p7.3.m3.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.3.m3.1b"><apply id="S3.SS2.p7.3.m3.1.1.cmml" xref="S3.SS2.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.3.m3.1.1.1.cmml" xref="S3.SS2.p7.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p7.3.m3.1.1.2.cmml" xref="S3.SS2.p7.3.m3.1.1.2">𝜃</ci><apply id="S3.SS2.p7.3.m3.1.1.3.cmml" xref="S3.SS2.p7.3.m3.1.1.3"><times id="S3.SS2.p7.3.m3.1.1.3.1.cmml" xref="S3.SS2.p7.3.m3.1.1.3.1"></times><ci id="S3.SS2.p7.3.m3.1.1.3.2.cmml" xref="S3.SS2.p7.3.m3.1.1.3.2">𝑖</ci><ci id="S3.SS2.p7.3.m3.1.1.3.3.cmml" xref="S3.SS2.p7.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.3.m3.1c">\theta_{id}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.3.m3.1d">italic_θ start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT</annotation></semantics></math> denote the trainable parameters of the <span class="ltx_text ltx_font_bold" id="S3.SS2.p7.3.1">i</span>mage <span class="ltx_text ltx_font_bold" id="S3.SS2.p7.3.2">e</span>ncoder, <span class="ltx_text ltx_font_bold" id="S3.SS2.p7.3.3">t</span>arget <span class="ltx_text ltx_font_bold" id="S3.SS2.p7.3.4">t</span>ext <span class="ltx_text ltx_font_bold" id="S3.SS2.p7.3.5">d</span>ecoder, and <span class="ltx_text ltx_font_bold" id="S3.SS2.p7.3.6">i</span>mage <span class="ltx_text ltx_font_bold" id="S3.SS2.p7.3.7">d</span>ecoder, respectively.</p>
</div>
<div class="ltx_para" id="S3.SS2.p8">
<p class="ltx_p" id="S3.SS2.p8.2">To train our model using the OCR auxiliary task, we additionally introduce a source text decoder, which adopts the same architecture as the target text decoder. Formally, the training objectives of the OCR and TIT auxiliary tasks are defined as</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{ocr}=-\mathrm{log}p(\mathbf{s}|\mathbf{x};\theta_{ie},\theta_{std%
})," class="ltx_Math" display="block" id="S3.E15.m1.2"><semantics id="S3.E15.m1.2a"><mrow id="S3.E15.m1.2.2.1" xref="S3.E15.m1.2.2.1.1.cmml"><mrow id="S3.E15.m1.2.2.1.1" xref="S3.E15.m1.2.2.1.1.cmml"><msub id="S3.E15.m1.2.2.1.1.3" xref="S3.E15.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E15.m1.2.2.1.1.3.2" xref="S3.E15.m1.2.2.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E15.m1.2.2.1.1.3.3" xref="S3.E15.m1.2.2.1.1.3.3.cmml"><mi id="S3.E15.m1.2.2.1.1.3.3.2" xref="S3.E15.m1.2.2.1.1.3.3.2.cmml">o</mi><mo id="S3.E15.m1.2.2.1.1.3.3.1" xref="S3.E15.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E15.m1.2.2.1.1.3.3.3" xref="S3.E15.m1.2.2.1.1.3.3.3.cmml">c</mi><mo id="S3.E15.m1.2.2.1.1.3.3.1a" xref="S3.E15.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E15.m1.2.2.1.1.3.3.4" xref="S3.E15.m1.2.2.1.1.3.3.4.cmml">r</mi></mrow></msub><mo id="S3.E15.m1.2.2.1.1.2" xref="S3.E15.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E15.m1.2.2.1.1.1" xref="S3.E15.m1.2.2.1.1.1.cmml"><mo id="S3.E15.m1.2.2.1.1.1a" xref="S3.E15.m1.2.2.1.1.1.cmml">−</mo><mrow id="S3.E15.m1.2.2.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.3.cmml">log</mi><mo id="S3.E15.m1.2.2.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E15.m1.2.2.1.1.1.1.4" xref="S3.E15.m1.2.2.1.1.1.1.4.cmml">p</mi><mo id="S3.E15.m1.2.2.1.1.1.1.2a" xref="S3.E15.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E15.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.1.4" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.4.cmml">𝐬</mi><mo fence="false" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E15.m1.1.1" xref="S3.E15.m1.1.1.cmml">𝐱</mi><mo id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">e</mi></mrow></msub><mo id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.4" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.2.cmml">s</mi><mo id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.3.cmml">t</mi><mo id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1a" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.4" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.4.cmml">d</mi></mrow></msub></mrow></mrow><mo id="S3.E15.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E15.m1.2.2.1.2" xref="S3.E15.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.2b"><apply id="S3.E15.m1.2.2.1.1.cmml" xref="S3.E15.m1.2.2.1"><eq id="S3.E15.m1.2.2.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.2"></eq><apply id="S3.E15.m1.2.2.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.3.1.cmml" xref="S3.E15.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.3.2.cmml" xref="S3.E15.m1.2.2.1.1.3.2">ℒ</ci><apply id="S3.E15.m1.2.2.1.1.3.3.cmml" xref="S3.E15.m1.2.2.1.1.3.3"><times id="S3.E15.m1.2.2.1.1.3.3.1.cmml" xref="S3.E15.m1.2.2.1.1.3.3.1"></times><ci id="S3.E15.m1.2.2.1.1.3.3.2.cmml" xref="S3.E15.m1.2.2.1.1.3.3.2">𝑜</ci><ci id="S3.E15.m1.2.2.1.1.3.3.3.cmml" xref="S3.E15.m1.2.2.1.1.3.3.3">𝑐</ci><ci id="S3.E15.m1.2.2.1.1.3.3.4.cmml" xref="S3.E15.m1.2.2.1.1.3.3.4">𝑟</ci></apply></apply><apply id="S3.E15.m1.2.2.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1"><minus id="S3.E15.m1.2.2.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1"></minus><apply id="S3.E15.m1.2.2.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1"><times id="S3.E15.m1.2.2.1.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.2"></times><ci id="S3.E15.m1.2.2.1.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.3">log</ci><ci id="S3.E15.m1.2.2.1.1.1.1.4.cmml" xref="S3.E15.m1.2.2.1.1.1.1.4">𝑝</ci><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.3">conditional</csymbol><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.4.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.4">𝐬</ci><list id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2"><ci id="S3.E15.m1.1.1.cmml" xref="S3.E15.m1.1.1">𝐱</ci><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑒</ci></apply></apply><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.2">𝜃</ci><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3"><times id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.2">𝑠</ci><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.3">𝑡</ci><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.4.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.4">𝑑</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.2c">\mathcal{L}_{ocr}=-\mathrm{log}p(\mathbf{s}|\mathbf{x};\theta_{ie},\theta_{std%
}),</annotation><annotation encoding="application/x-llamapun" id="S3.E15.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_o italic_c italic_r end_POSTSUBSCRIPT = - roman_log italic_p ( bold_s | bold_x ; italic_θ start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_s italic_t italic_d end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{tit}=-\mathrm{log}p(\mathbf{t}|\mathbf{x};\theta_{ie},\theta_{ttd%
}),\vspace{-3pt}" class="ltx_Math" display="block" id="S3.E16.m1.2"><semantics id="S3.E16.m1.2a"><mrow id="S3.E16.m1.2.2.1" xref="S3.E16.m1.2.2.1.1.cmml"><mrow id="S3.E16.m1.2.2.1.1" xref="S3.E16.m1.2.2.1.1.cmml"><msub id="S3.E16.m1.2.2.1.1.3" xref="S3.E16.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E16.m1.2.2.1.1.3.2" xref="S3.E16.m1.2.2.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E16.m1.2.2.1.1.3.3" xref="S3.E16.m1.2.2.1.1.3.3.cmml"><mi id="S3.E16.m1.2.2.1.1.3.3.2" xref="S3.E16.m1.2.2.1.1.3.3.2.cmml">t</mi><mo id="S3.E16.m1.2.2.1.1.3.3.1" xref="S3.E16.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E16.m1.2.2.1.1.3.3.3" xref="S3.E16.m1.2.2.1.1.3.3.3.cmml">i</mi><mo id="S3.E16.m1.2.2.1.1.3.3.1a" xref="S3.E16.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E16.m1.2.2.1.1.3.3.4" xref="S3.E16.m1.2.2.1.1.3.3.4.cmml">t</mi></mrow></msub><mo id="S3.E16.m1.2.2.1.1.2" xref="S3.E16.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E16.m1.2.2.1.1.1" xref="S3.E16.m1.2.2.1.1.1.cmml"><mo id="S3.E16.m1.2.2.1.1.1a" xref="S3.E16.m1.2.2.1.1.1.cmml">−</mo><mrow id="S3.E16.m1.2.2.1.1.1.1" xref="S3.E16.m1.2.2.1.1.1.1.cmml"><mi id="S3.E16.m1.2.2.1.1.1.1.3" xref="S3.E16.m1.2.2.1.1.1.1.3.cmml">log</mi><mo id="S3.E16.m1.2.2.1.1.1.1.2" xref="S3.E16.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E16.m1.2.2.1.1.1.1.4" xref="S3.E16.m1.2.2.1.1.1.1.4.cmml">p</mi><mo id="S3.E16.m1.2.2.1.1.1.1.2a" xref="S3.E16.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E16.m1.2.2.1.1.1.1.1.1" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E16.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E16.m1.2.2.1.1.1.1.1.1.1" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E16.m1.2.2.1.1.1.1.1.1.1.4" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.4.cmml">𝐭</mi><mo fence="false" id="S3.E16.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E16.m1.1.1" xref="S3.E16.m1.1.1.cmml">𝐱</mi><mo id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">e</mi></mrow></msub><mo id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.4" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.3.cmml">t</mi><mo id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1a" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.4" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.4.cmml">d</mi></mrow></msub></mrow></mrow><mo id="S3.E16.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E16.m1.2.2.1.2" xref="S3.E16.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.2b"><apply id="S3.E16.m1.2.2.1.1.cmml" xref="S3.E16.m1.2.2.1"><eq id="S3.E16.m1.2.2.1.1.2.cmml" xref="S3.E16.m1.2.2.1.1.2"></eq><apply id="S3.E16.m1.2.2.1.1.3.cmml" xref="S3.E16.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m1.2.2.1.1.3.1.cmml" xref="S3.E16.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E16.m1.2.2.1.1.3.2.cmml" xref="S3.E16.m1.2.2.1.1.3.2">ℒ</ci><apply id="S3.E16.m1.2.2.1.1.3.3.cmml" xref="S3.E16.m1.2.2.1.1.3.3"><times id="S3.E16.m1.2.2.1.1.3.3.1.cmml" xref="S3.E16.m1.2.2.1.1.3.3.1"></times><ci id="S3.E16.m1.2.2.1.1.3.3.2.cmml" xref="S3.E16.m1.2.2.1.1.3.3.2">𝑡</ci><ci id="S3.E16.m1.2.2.1.1.3.3.3.cmml" xref="S3.E16.m1.2.2.1.1.3.3.3">𝑖</ci><ci id="S3.E16.m1.2.2.1.1.3.3.4.cmml" xref="S3.E16.m1.2.2.1.1.3.3.4">𝑡</ci></apply></apply><apply id="S3.E16.m1.2.2.1.1.1.cmml" xref="S3.E16.m1.2.2.1.1.1"><minus id="S3.E16.m1.2.2.1.1.1.2.cmml" xref="S3.E16.m1.2.2.1.1.1"></minus><apply id="S3.E16.m1.2.2.1.1.1.1.cmml" xref="S3.E16.m1.2.2.1.1.1.1"><times id="S3.E16.m1.2.2.1.1.1.1.2.cmml" xref="S3.E16.m1.2.2.1.1.1.1.2"></times><ci id="S3.E16.m1.2.2.1.1.1.1.3.cmml" xref="S3.E16.m1.2.2.1.1.1.1.3">log</ci><ci id="S3.E16.m1.2.2.1.1.1.1.4.cmml" xref="S3.E16.m1.2.2.1.1.1.1.4">𝑝</ci><apply id="S3.E16.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E16.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.3">conditional</csymbol><ci id="S3.E16.m1.2.2.1.1.1.1.1.1.1.4.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.4">𝐭</ci><list id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2"><ci id="S3.E16.m1.1.1.cmml" xref="S3.E16.m1.1.1">𝐱</ci><apply id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><apply id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑒</ci></apply></apply><apply id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.2">𝜃</ci><apply id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3"><times id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.2">𝑡</ci><ci id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.3">𝑡</ci><ci id="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.4.cmml" xref="S3.E16.m1.2.2.1.1.1.1.1.1.1.2.2.2.3.4">𝑑</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.2c">\mathcal{L}_{tit}=-\mathrm{log}p(\mathbf{t}|\mathbf{x};\theta_{ie},\theta_{ttd%
}),\vspace{-3pt}</annotation><annotation encoding="application/x-llamapun" id="S3.E16.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_t italic_i italic_t end_POSTSUBSCRIPT = - roman_log italic_p ( bold_t | bold_x ; italic_θ start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_t italic_t italic_d end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p8.1">where <math alttext="\theta_{std}" class="ltx_Math" display="inline" id="S3.SS2.p8.1.m1.1"><semantics id="S3.SS2.p8.1.m1.1a"><msub id="S3.SS2.p8.1.m1.1.1" xref="S3.SS2.p8.1.m1.1.1.cmml"><mi id="S3.SS2.p8.1.m1.1.1.2" xref="S3.SS2.p8.1.m1.1.1.2.cmml">θ</mi><mrow id="S3.SS2.p8.1.m1.1.1.3" xref="S3.SS2.p8.1.m1.1.1.3.cmml"><mi id="S3.SS2.p8.1.m1.1.1.3.2" xref="S3.SS2.p8.1.m1.1.1.3.2.cmml">s</mi><mo id="S3.SS2.p8.1.m1.1.1.3.1" xref="S3.SS2.p8.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p8.1.m1.1.1.3.3" xref="S3.SS2.p8.1.m1.1.1.3.3.cmml">t</mi><mo id="S3.SS2.p8.1.m1.1.1.3.1a" xref="S3.SS2.p8.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p8.1.m1.1.1.3.4" xref="S3.SS2.p8.1.m1.1.1.3.4.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.1.m1.1b"><apply id="S3.SS2.p8.1.m1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p8.1.m1.1.1.2.cmml" xref="S3.SS2.p8.1.m1.1.1.2">𝜃</ci><apply id="S3.SS2.p8.1.m1.1.1.3.cmml" xref="S3.SS2.p8.1.m1.1.1.3"><times id="S3.SS2.p8.1.m1.1.1.3.1.cmml" xref="S3.SS2.p8.1.m1.1.1.3.1"></times><ci id="S3.SS2.p8.1.m1.1.1.3.2.cmml" xref="S3.SS2.p8.1.m1.1.1.3.2">𝑠</ci><ci id="S3.SS2.p8.1.m1.1.1.3.3.cmml" xref="S3.SS2.p8.1.m1.1.1.3.3">𝑡</ci><ci id="S3.SS2.p8.1.m1.1.1.3.4.cmml" xref="S3.SS2.p8.1.m1.1.1.3.4">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.1.m1.1c">\theta_{std}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.1.m1.1d">italic_θ start_POSTSUBSCRIPT italic_s italic_t italic_d end_POSTSUBSCRIPT</annotation></semantics></math> is the parameters of the <span class="ltx_text ltx_font_bold" id="S3.SS2.p8.1.1">s</span>ource <span class="ltx_text ltx_font_bold" id="S3.SS2.p8.1.2">t</span>ext <span class="ltx_text ltx_font_bold" id="S3.SS2.p8.1.3">d</span>ecoder. Note that the source text decoder takes the intermediate hidden states of the image encoder as input. This design is based on the intuition that the shallow encoder layers represent the source visual content, while the deep layers encode more information about the target visual content.</p>
</div>
<div class="ltx_para" id="S3.SS2.p9">
<p class="ltx_p" id="S3.SS2.p9.3">Besides, training an end-to-end model is considerably more difficult than a T2I model, where the latter only needs to learn the mapping between different modalities and thus has better performance. Consequently, we introduce a T2I model as a teacher to facilitate knowledge transfer to the end-to-end model. This T2I model includes a Transformer-based text encoder, a ResNet-based image encoder <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib12" title="">2016</a>)</cite>, and an image decoder similar to our model, where the image encoder is used to preserve the features of the original image.
Denote the output distribution of the teacher model for <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p9.1.m1.1"><semantics id="S3.SS2.p9.1.m1.1a"><mi id="S3.SS2.p9.1.m1.1.1" xref="S3.SS2.p9.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.1.m1.1b"><ci id="S3.SS2.p9.1.m1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.1.m1.1d">italic_t</annotation></semantics></math>-th visual token <math alttext="z_{t}" class="ltx_Math" display="inline" id="S3.SS2.p9.2.m2.1"><semantics id="S3.SS2.p9.2.m2.1a"><msub id="S3.SS2.p9.2.m2.1.1" xref="S3.SS2.p9.2.m2.1.1.cmml"><mi id="S3.SS2.p9.2.m2.1.1.2" xref="S3.SS2.p9.2.m2.1.1.2.cmml">z</mi><mi id="S3.SS2.p9.2.m2.1.1.3" xref="S3.SS2.p9.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.2.m2.1b"><apply id="S3.SS2.p9.2.m2.1.1.cmml" xref="S3.SS2.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.2.m2.1.1.1.cmml" xref="S3.SS2.p9.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p9.2.m2.1.1.2.cmml" xref="S3.SS2.p9.2.m2.1.1.2">𝑧</ci><ci id="S3.SS2.p9.2.m2.1.1.3.cmml" xref="S3.SS2.p9.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.2.m2.1c">z_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.2.m2.1d">italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as <math alttext="q(z_{t}|\mathbf{z}_{&lt;t},\mathbf{x},\mathbf{t};\theta_{t2i})" class="ltx_Math" display="inline" id="S3.SS2.p9.3.m3.3"><semantics id="S3.SS2.p9.3.m3.3a"><mrow id="S3.SS2.p9.3.m3.3.3" xref="S3.SS2.p9.3.m3.3.3.cmml"><mi id="S3.SS2.p9.3.m3.3.3.3" xref="S3.SS2.p9.3.m3.3.3.3.cmml">q</mi><mo id="S3.SS2.p9.3.m3.3.3.2" xref="S3.SS2.p9.3.m3.3.3.2.cmml">⁢</mo><mrow id="S3.SS2.p9.3.m3.3.3.1.1" xref="S3.SS2.p9.3.m3.3.3.1.1.1.cmml"><mo id="S3.SS2.p9.3.m3.3.3.1.1.2" stretchy="false" xref="S3.SS2.p9.3.m3.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.p9.3.m3.3.3.1.1.1" xref="S3.SS2.p9.3.m3.3.3.1.1.1.cmml"><msub id="S3.SS2.p9.3.m3.3.3.1.1.1.4" xref="S3.SS2.p9.3.m3.3.3.1.1.1.4.cmml"><mi id="S3.SS2.p9.3.m3.3.3.1.1.1.4.2" xref="S3.SS2.p9.3.m3.3.3.1.1.1.4.2.cmml">z</mi><mi id="S3.SS2.p9.3.m3.3.3.1.1.1.4.3" xref="S3.SS2.p9.3.m3.3.3.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="S3.SS2.p9.3.m3.3.3.1.1.1.3" xref="S3.SS2.p9.3.m3.3.3.1.1.1.3.cmml">|</mo><mrow id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.3.cmml"><msub id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.2" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.2.cmml">𝐳</mi><mrow id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.2" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.1" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.3" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.3" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.3.cmml">,</mo><mi id="S3.SS2.p9.3.m3.1.1" xref="S3.SS2.p9.3.m3.1.1.cmml">𝐱</mi><mo id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.4" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.3.cmml">,</mo><mi id="S3.SS2.p9.3.m3.2.2" xref="S3.SS2.p9.3.m3.2.2.cmml">𝐭</mi><mo id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.5" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.3.cmml">;</mo><msub id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.cmml"><mi id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.2" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.2.cmml">θ</mi><mrow id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.cmml"><mi id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.2" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.1" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.1.cmml">⁢</mo><mn id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.3" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.3.cmml">2</mn><mo id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.1a" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.4" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.4.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S3.SS2.p9.3.m3.3.3.1.1.3" stretchy="false" xref="S3.SS2.p9.3.m3.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.3.m3.3b"><apply id="S3.SS2.p9.3.m3.3.3.cmml" xref="S3.SS2.p9.3.m3.3.3"><times id="S3.SS2.p9.3.m3.3.3.2.cmml" xref="S3.SS2.p9.3.m3.3.3.2"></times><ci id="S3.SS2.p9.3.m3.3.3.3.cmml" xref="S3.SS2.p9.3.m3.3.3.3">𝑞</ci><apply id="S3.SS2.p9.3.m3.3.3.1.1.1.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1"><csymbol cd="latexml" id="S3.SS2.p9.3.m3.3.3.1.1.1.3.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.3">conditional</csymbol><apply id="S3.SS2.p9.3.m3.3.3.1.1.1.4.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p9.3.m3.3.3.1.1.1.4.1.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.4">subscript</csymbol><ci id="S3.SS2.p9.3.m3.3.3.1.1.1.4.2.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.4.2">𝑧</ci><ci id="S3.SS2.p9.3.m3.3.3.1.1.1.4.3.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.4.3">𝑡</ci></apply><list id="S3.SS2.p9.3.m3.3.3.1.1.1.2.3.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2"><apply id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.2">𝐳</ci><apply id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3"><lt id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S3.SS2.p9.3.m3.1.1.cmml" xref="S3.SS2.p9.3.m3.1.1">𝐱</ci><ci id="S3.SS2.p9.3.m3.2.2.cmml" xref="S3.SS2.p9.3.m3.2.2">𝐭</ci><apply id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.1.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.2.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.2">𝜃</ci><apply id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3"><times id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.1.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.1"></times><ci id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.2.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.2">𝑡</ci><cn id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.3">2</cn><ci id="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.4.cmml" xref="S3.SS2.p9.3.m3.3.3.1.1.1.2.2.2.3.4">𝑖</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.3.m3.3c">q(z_{t}|\mathbf{z}_{&lt;t},\mathbf{x},\mathbf{t};\theta_{t2i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.3.m3.3d">italic_q ( italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_z start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT , bold_x , bold_t ; italic_θ start_POSTSUBSCRIPT italic_t 2 italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, we define the cross-entropy between the distributions of teacher and student as the distillation loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathcal{L}_{kd}=&amp;-\sum_{t=1}^{|\mathbf{z}|}\sum_{k=1}^{|\mathcal%
{V}|}q(z_{t}=k|\mathbf{z}_{&lt;t},\mathbf{x},\mathbf{t};\theta_{t2i})\\
&amp;\mathrm{log}p(z_{t}=k|\mathbf{z}_{&lt;t},\mathbf{x};\theta_{ie},\theta_{ttd},%
\theta_{id}),\end{split}" class="ltx_Math" display="block" id="S3.E17.m1.53"><semantics id="S3.E17.m1.53a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E17.m1.53.53.3" rowspacing="0pt"><mtr id="S3.E17.m1.53.53.3a"><mtd class="ltx_align_right" columnalign="right" id="S3.E17.m1.53.53.3b"><mrow id="S3.E17.m1.3.3.3.3.3"><msub id="S3.E17.m1.3.3.3.3.3.4"><mi class="ltx_font_mathcaligraphic" id="S3.E17.m1.1.1.1.1.1.1" xref="S3.E17.m1.1.1.1.1.1.1.cmml">ℒ</mi><mrow id="S3.E17.m1.2.2.2.2.2.2.1" xref="S3.E17.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E17.m1.2.2.2.2.2.2.1.2" xref="S3.E17.m1.2.2.2.2.2.2.1.2.cmml">k</mi><mo id="S3.E17.m1.2.2.2.2.2.2.1.1" xref="S3.E17.m1.2.2.2.2.2.2.1.1.cmml">⁢</mo><mi id="S3.E17.m1.2.2.2.2.2.2.1.3" xref="S3.E17.m1.2.2.2.2.2.2.1.3.cmml">d</mi></mrow></msub><mo id="S3.E17.m1.3.3.3.3.3.3" xref="S3.E17.m1.3.3.3.3.3.3.cmml">=</mo><mi id="S3.E17.m1.3.3.3.3.3.5" xref="S3.E17.m1.51.51.1.1.1.cmml"></mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E17.m1.53.53.3c"><mrow id="S3.E17.m1.52.52.2.51.28.25"><mo id="S3.E17.m1.52.52.2.51.28.25a" xref="S3.E17.m1.51.51.1.1.1.cmml">−</mo><mrow id="S3.E17.m1.52.52.2.51.28.25.25"><munderover id="S3.E17.m1.52.52.2.51.28.25.25.2"><mo id="S3.E17.m1.5.5.5.5.2.2" movablelimits="false" rspace="0em" xref="S3.E17.m1.5.5.5.5.2.2.cmml">∑</mo><mrow id="S3.E17.m1.6.6.6.6.3.3.1" xref="S3.E17.m1.6.6.6.6.3.3.1.cmml"><mi id="S3.E17.m1.6.6.6.6.3.3.1.2" xref="S3.E17.m1.6.6.6.6.3.3.1.2.cmml">t</mi><mo id="S3.E17.m1.6.6.6.6.3.3.1.1" xref="S3.E17.m1.6.6.6.6.3.3.1.1.cmml">=</mo><mn id="S3.E17.m1.6.6.6.6.3.3.1.3" xref="S3.E17.m1.6.6.6.6.3.3.1.3.cmml">1</mn></mrow><mrow id="S3.E17.m1.7.7.7.7.4.4.1.3" xref="S3.E17.m1.7.7.7.7.4.4.1.2.cmml"><mo id="S3.E17.m1.7.7.7.7.4.4.1.3.1" stretchy="false" xref="S3.E17.m1.7.7.7.7.4.4.1.2.1.cmml">|</mo><mi id="S3.E17.m1.7.7.7.7.4.4.1.1" xref="S3.E17.m1.7.7.7.7.4.4.1.1.cmml">𝐳</mi><mo id="S3.E17.m1.7.7.7.7.4.4.1.3.2" stretchy="false" xref="S3.E17.m1.7.7.7.7.4.4.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E17.m1.52.52.2.51.28.25.25.1"><munderover id="S3.E17.m1.52.52.2.51.28.25.25.1.2"><mo id="S3.E17.m1.8.8.8.8.5.5" movablelimits="false" xref="S3.E17.m1.8.8.8.8.5.5.cmml">∑</mo><mrow id="S3.E17.m1.9.9.9.9.6.6.1" xref="S3.E17.m1.9.9.9.9.6.6.1.cmml"><mi id="S3.E17.m1.9.9.9.9.6.6.1.2" xref="S3.E17.m1.9.9.9.9.6.6.1.2.cmml">k</mi><mo id="S3.E17.m1.9.9.9.9.6.6.1.1" xref="S3.E17.m1.9.9.9.9.6.6.1.1.cmml">=</mo><mn id="S3.E17.m1.9.9.9.9.6.6.1.3" xref="S3.E17.m1.9.9.9.9.6.6.1.3.cmml">1</mn></mrow><mrow id="S3.E17.m1.10.10.10.10.7.7.1.3" xref="S3.E17.m1.10.10.10.10.7.7.1.2.cmml"><mo id="S3.E17.m1.10.10.10.10.7.7.1.3.1" stretchy="false" xref="S3.E17.m1.10.10.10.10.7.7.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E17.m1.10.10.10.10.7.7.1.1" xref="S3.E17.m1.10.10.10.10.7.7.1.1.cmml">𝒱</mi><mo id="S3.E17.m1.10.10.10.10.7.7.1.3.2" stretchy="false" xref="S3.E17.m1.10.10.10.10.7.7.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E17.m1.52.52.2.51.28.25.25.1.1"><mi id="S3.E17.m1.11.11.11.11.8.8" xref="S3.E17.m1.11.11.11.11.8.8.cmml">q</mi><mo id="S3.E17.m1.52.52.2.51.28.25.25.1.1.2" xref="S3.E17.m1.51.51.1.1.1.cmml">⁢</mo><mrow id="S3.E17.m1.52.52.2.51.28.25.25.1.1.1.1"><mo id="S3.E17.m1.12.12.12.12.9.9" stretchy="false" xref="S3.E17.m1.51.51.1.1.1.cmml">(</mo><mrow id="S3.E17.m1.52.52.2.51.28.25.25.1.1.1.1.1"><msub id="S3.E17.m1.52.52.2.51.28.25.25.1.1.1.1.1.3"><mi id="S3.E17.m1.13.13.13.13.10.10" xref="S3.E17.m1.13.13.13.13.10.10.cmml">z</mi><mi id="S3.E17.m1.14.14.14.14.11.11.1" xref="S3.E17.m1.14.14.14.14.11.11.1.cmml">t</mi></msub><mo id="S3.E17.m1.15.15.15.15.12.12" xref="S3.E17.m1.15.15.15.15.12.12.cmml">=</mo><mrow id="S3.E17.m1.52.52.2.51.28.25.25.1.1.1.1.1.2"><mi id="S3.E17.m1.16.16.16.16.13.13" xref="S3.E17.m1.16.16.16.16.13.13.cmml">k</mi><mo fence="false" id="S3.E17.m1.17.17.17.17.14.14" xref="S3.E17.m1.17.17.17.17.14.14.cmml">|</mo><mrow id="S3.E17.m1.52.52.2.51.28.25.25.1.1.1.1.1.2.2.2"><msub id="S3.E17.m1.52.52.2.51.28.25.25.1.1.1.1.1.1.1.1.1"><mi id="S3.E17.m1.18.18.18.18.15.15" xref="S3.E17.m1.18.18.18.18.15.15.cmml">𝐳</mi><mrow id="S3.E17.m1.19.19.19.19.16.16.1" xref="S3.E17.m1.19.19.19.19.16.16.1.cmml"><mi id="S3.E17.m1.19.19.19.19.16.16.1.2" xref="S3.E17.m1.19.19.19.19.16.16.1.2.cmml"></mi><mo id="S3.E17.m1.19.19.19.19.16.16.1.1" xref="S3.E17.m1.19.19.19.19.16.16.1.1.cmml">&lt;</mo><mi id="S3.E17.m1.19.19.19.19.16.16.1.3" xref="S3.E17.m1.19.19.19.19.16.16.1.3.cmml">t</mi></mrow></msub><mo id="S3.E17.m1.20.20.20.20.17.17" xref="S3.E17.m1.51.51.1.1.1.cmml">,</mo><mi id="S3.E17.m1.21.21.21.21.18.18" xref="S3.E17.m1.21.21.21.21.18.18.cmml">𝐱</mi><mo id="S3.E17.m1.22.22.22.22.19.19" xref="S3.E17.m1.51.51.1.1.1.cmml">,</mo><mi id="S3.E17.m1.23.23.23.23.20.20" xref="S3.E17.m1.23.23.23.23.20.20.cmml">𝐭</mi><mo id="S3.E17.m1.24.24.24.24.21.21" xref="S3.E17.m1.51.51.1.1.1.cmml">;</mo><msub id="S3.E17.m1.52.52.2.51.28.25.25.1.1.1.1.1.2.2.2.2"><mi id="S3.E17.m1.25.25.25.25.22.22" xref="S3.E17.m1.25.25.25.25.22.22.cmml">θ</mi><mrow id="S3.E17.m1.26.26.26.26.23.23.1" xref="S3.E17.m1.26.26.26.26.23.23.1.cmml"><mi id="S3.E17.m1.26.26.26.26.23.23.1.2" xref="S3.E17.m1.26.26.26.26.23.23.1.2.cmml">t</mi><mo id="S3.E17.m1.26.26.26.26.23.23.1.1" xref="S3.E17.m1.26.26.26.26.23.23.1.1.cmml">⁢</mo><mn id="S3.E17.m1.26.26.26.26.23.23.1.3" xref="S3.E17.m1.26.26.26.26.23.23.1.3.cmml">2</mn><mo id="S3.E17.m1.26.26.26.26.23.23.1.1a" xref="S3.E17.m1.26.26.26.26.23.23.1.1.cmml">⁢</mo><mi id="S3.E17.m1.26.26.26.26.23.23.1.4" xref="S3.E17.m1.26.26.26.26.23.23.1.4.cmml">i</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E17.m1.27.27.27.27.24.24" stretchy="false" xref="S3.E17.m1.51.51.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E17.m1.53.53.3d"><mtd id="S3.E17.m1.53.53.3e" xref="S3.E17.m1.51.51.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E17.m1.53.53.3f"><mrow id="S3.E17.m1.53.53.3.52.24.24.24"><mrow id="S3.E17.m1.53.53.3.52.24.24.24.1"><mi id="S3.E17.m1.28.28.28.1.1.1" xref="S3.E17.m1.28.28.28.1.1.1.cmml">log</mi><mo id="S3.E17.m1.53.53.3.52.24.24.24.1.2" xref="S3.E17.m1.51.51.1.1.1.cmml">⁢</mo><mi id="S3.E17.m1.29.29.29.2.2.2" xref="S3.E17.m1.29.29.29.2.2.2.cmml">p</mi><mo id="S3.E17.m1.53.53.3.52.24.24.24.1.2a" xref="S3.E17.m1.51.51.1.1.1.cmml">⁢</mo><mrow id="S3.E17.m1.53.53.3.52.24.24.24.1.1.1"><mo id="S3.E17.m1.30.30.30.3.3.3" stretchy="false" xref="S3.E17.m1.51.51.1.1.1.cmml">(</mo><mrow id="S3.E17.m1.53.53.3.52.24.24.24.1.1.1.1"><msub id="S3.E17.m1.53.53.3.52.24.24.24.1.1.1.1.5"><mi id="S3.E17.m1.31.31.31.4.4.4" xref="S3.E17.m1.31.31.31.4.4.4.cmml">z</mi><mi id="S3.E17.m1.32.32.32.5.5.5.1" xref="S3.E17.m1.32.32.32.5.5.5.1.cmml">t</mi></msub><mo id="S3.E17.m1.33.33.33.6.6.6" xref="S3.E17.m1.33.33.33.6.6.6.cmml">=</mo><mrow id="S3.E17.m1.53.53.3.52.24.24.24.1.1.1.1.4"><mi id="S3.E17.m1.34.34.34.7.7.7" xref="S3.E17.m1.34.34.34.7.7.7.cmml">k</mi><mo fence="false" id="S3.E17.m1.35.35.35.8.8.8" xref="S3.E17.m1.35.35.35.8.8.8.cmml">|</mo><mrow id="S3.E17.m1.53.53.3.52.24.24.24.1.1.1.1.4.4.4"><msub id="S3.E17.m1.53.53.3.52.24.24.24.1.1.1.1.1.1.1.1"><mi id="S3.E17.m1.36.36.36.9.9.9" xref="S3.E17.m1.36.36.36.9.9.9.cmml">𝐳</mi><mrow id="S3.E17.m1.37.37.37.10.10.10.1" xref="S3.E17.m1.37.37.37.10.10.10.1.cmml"><mi id="S3.E17.m1.37.37.37.10.10.10.1.2" xref="S3.E17.m1.37.37.37.10.10.10.1.2.cmml"></mi><mo id="S3.E17.m1.37.37.37.10.10.10.1.1" xref="S3.E17.m1.37.37.37.10.10.10.1.1.cmml">&lt;</mo><mi id="S3.E17.m1.37.37.37.10.10.10.1.3" xref="S3.E17.m1.37.37.37.10.10.10.1.3.cmml">t</mi></mrow></msub><mo id="S3.E17.m1.38.38.38.11.11.11" xref="S3.E17.m1.51.51.1.1.1.cmml">,</mo><mi id="S3.E17.m1.39.39.39.12.12.12" xref="S3.E17.m1.39.39.39.12.12.12.cmml">𝐱</mi><mo id="S3.E17.m1.40.40.40.13.13.13" xref="S3.E17.m1.51.51.1.1.1.cmml">;</mo><msub id="S3.E17.m1.53.53.3.52.24.24.24.1.1.1.1.2.2.2.2"><mi id="S3.E17.m1.41.41.41.14.14.14" xref="S3.E17.m1.41.41.41.14.14.14.cmml">θ</mi><mrow id="S3.E17.m1.42.42.42.15.15.15.1" xref="S3.E17.m1.42.42.42.15.15.15.1.cmml"><mi id="S3.E17.m1.42.42.42.15.15.15.1.2" xref="S3.E17.m1.42.42.42.15.15.15.1.2.cmml">i</mi><mo id="S3.E17.m1.42.42.42.15.15.15.1.1" xref="S3.E17.m1.42.42.42.15.15.15.1.1.cmml">⁢</mo><mi id="S3.E17.m1.42.42.42.15.15.15.1.3" xref="S3.E17.m1.42.42.42.15.15.15.1.3.cmml">e</mi></mrow></msub><mo id="S3.E17.m1.43.43.43.16.16.16" xref="S3.E17.m1.51.51.1.1.1.cmml">,</mo><msub id="S3.E17.m1.53.53.3.52.24.24.24.1.1.1.1.3.3.3.3"><mi id="S3.E17.m1.44.44.44.17.17.17" xref="S3.E17.m1.44.44.44.17.17.17.cmml">θ</mi><mrow id="S3.E17.m1.45.45.45.18.18.18.1" xref="S3.E17.m1.45.45.45.18.18.18.1.cmml"><mi id="S3.E17.m1.45.45.45.18.18.18.1.2" xref="S3.E17.m1.45.45.45.18.18.18.1.2.cmml">t</mi><mo id="S3.E17.m1.45.45.45.18.18.18.1.1" xref="S3.E17.m1.45.45.45.18.18.18.1.1.cmml">⁢</mo><mi id="S3.E17.m1.45.45.45.18.18.18.1.3" xref="S3.E17.m1.45.45.45.18.18.18.1.3.cmml">t</mi><mo id="S3.E17.m1.45.45.45.18.18.18.1.1a" xref="S3.E17.m1.45.45.45.18.18.18.1.1.cmml">⁢</mo><mi id="S3.E17.m1.45.45.45.18.18.18.1.4" xref="S3.E17.m1.45.45.45.18.18.18.1.4.cmml">d</mi></mrow></msub><mo id="S3.E17.m1.46.46.46.19.19.19" xref="S3.E17.m1.51.51.1.1.1.cmml">,</mo><msub id="S3.E17.m1.53.53.3.52.24.24.24.1.1.1.1.4.4.4.4"><mi id="S3.E17.m1.47.47.47.20.20.20" xref="S3.E17.m1.47.47.47.20.20.20.cmml">θ</mi><mrow id="S3.E17.m1.48.48.48.21.21.21.1" xref="S3.E17.m1.48.48.48.21.21.21.1.cmml"><mi id="S3.E17.m1.48.48.48.21.21.21.1.2" xref="S3.E17.m1.48.48.48.21.21.21.1.2.cmml">i</mi><mo id="S3.E17.m1.48.48.48.21.21.21.1.1" xref="S3.E17.m1.48.48.48.21.21.21.1.1.cmml">⁢</mo><mi id="S3.E17.m1.48.48.48.21.21.21.1.3" xref="S3.E17.m1.48.48.48.21.21.21.1.3.cmml">d</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E17.m1.49.49.49.22.22.22" stretchy="false" xref="S3.E17.m1.51.51.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E17.m1.50.50.50.23.23.23" xref="S3.E17.m1.51.51.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E17.m1.53b"><apply id="S3.E17.m1.51.51.1.1.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><eq id="S3.E17.m1.3.3.3.3.3.3.cmml" xref="S3.E17.m1.3.3.3.3.3.3"></eq><apply id="S3.E17.m1.51.51.1.1.1.4.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.4.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S3.E17.m1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.1.1.1.1.1.1">ℒ</ci><apply id="S3.E17.m1.2.2.2.2.2.2.1.cmml" xref="S3.E17.m1.2.2.2.2.2.2.1"><times id="S3.E17.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E17.m1.2.2.2.2.2.2.1.1"></times><ci id="S3.E17.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E17.m1.2.2.2.2.2.2.1.2">𝑘</ci><ci id="S3.E17.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E17.m1.2.2.2.2.2.2.1.3">𝑑</ci></apply></apply><apply id="S3.E17.m1.51.51.1.1.1.2.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><minus id="S3.E17.m1.4.4.4.4.1.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5"></minus><apply id="S3.E17.m1.51.51.1.1.1.2.2.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><apply id="S3.E17.m1.51.51.1.1.1.2.2.3.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.2.2.3.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">superscript</csymbol><apply id="S3.E17.m1.51.51.1.1.1.2.2.3.2.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.2.2.3.2.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">subscript</csymbol><sum id="S3.E17.m1.5.5.5.5.2.2.cmml" xref="S3.E17.m1.5.5.5.5.2.2"></sum><apply id="S3.E17.m1.6.6.6.6.3.3.1.cmml" xref="S3.E17.m1.6.6.6.6.3.3.1"><eq id="S3.E17.m1.6.6.6.6.3.3.1.1.cmml" xref="S3.E17.m1.6.6.6.6.3.3.1.1"></eq><ci id="S3.E17.m1.6.6.6.6.3.3.1.2.cmml" xref="S3.E17.m1.6.6.6.6.3.3.1.2">𝑡</ci><cn id="S3.E17.m1.6.6.6.6.3.3.1.3.cmml" type="integer" xref="S3.E17.m1.6.6.6.6.3.3.1.3">1</cn></apply></apply><apply id="S3.E17.m1.7.7.7.7.4.4.1.2.cmml" xref="S3.E17.m1.7.7.7.7.4.4.1.3"><abs id="S3.E17.m1.7.7.7.7.4.4.1.2.1.cmml" xref="S3.E17.m1.7.7.7.7.4.4.1.3.1"></abs><ci id="S3.E17.m1.7.7.7.7.4.4.1.1.cmml" xref="S3.E17.m1.7.7.7.7.4.4.1.1">𝐳</ci></apply></apply><apply id="S3.E17.m1.51.51.1.1.1.2.2.2.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><apply id="S3.E17.m1.51.51.1.1.1.2.2.2.3.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.2.2.2.3.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">superscript</csymbol><apply id="S3.E17.m1.51.51.1.1.1.2.2.2.3.2.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.2.2.2.3.2.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">subscript</csymbol><sum id="S3.E17.m1.8.8.8.8.5.5.cmml" xref="S3.E17.m1.8.8.8.8.5.5"></sum><apply id="S3.E17.m1.9.9.9.9.6.6.1.cmml" xref="S3.E17.m1.9.9.9.9.6.6.1"><eq id="S3.E17.m1.9.9.9.9.6.6.1.1.cmml" xref="S3.E17.m1.9.9.9.9.6.6.1.1"></eq><ci id="S3.E17.m1.9.9.9.9.6.6.1.2.cmml" xref="S3.E17.m1.9.9.9.9.6.6.1.2">𝑘</ci><cn id="S3.E17.m1.9.9.9.9.6.6.1.3.cmml" type="integer" xref="S3.E17.m1.9.9.9.9.6.6.1.3">1</cn></apply></apply><apply id="S3.E17.m1.10.10.10.10.7.7.1.2.cmml" xref="S3.E17.m1.10.10.10.10.7.7.1.3"><abs id="S3.E17.m1.10.10.10.10.7.7.1.2.1.cmml" xref="S3.E17.m1.10.10.10.10.7.7.1.3.1"></abs><ci id="S3.E17.m1.10.10.10.10.7.7.1.1.cmml" xref="S3.E17.m1.10.10.10.10.7.7.1.1">𝒱</ci></apply></apply><apply id="S3.E17.m1.51.51.1.1.1.2.2.2.2.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><times id="S3.E17.m1.51.51.1.1.1.2.2.2.2.3.cmml" xref="S3.E17.m1.3.3.3.3.3.5"></times><ci id="S3.E17.m1.11.11.11.11.8.8.cmml" xref="S3.E17.m1.11.11.11.11.8.8">𝑞</ci><apply id="S3.E17.m1.51.51.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><eq id="S3.E17.m1.15.15.15.15.12.12.cmml" xref="S3.E17.m1.15.15.15.15.12.12"></eq><apply id="S3.E17.m1.51.51.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S3.E17.m1.13.13.13.13.10.10.cmml" xref="S3.E17.m1.13.13.13.13.10.10">𝑧</ci><ci id="S3.E17.m1.14.14.14.14.11.11.1.cmml" xref="S3.E17.m1.14.14.14.14.11.11.1">𝑡</ci></apply><apply id="S3.E17.m1.51.51.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="latexml" id="S3.E17.m1.17.17.17.17.14.14.cmml" xref="S3.E17.m1.17.17.17.17.14.14">conditional</csymbol><ci id="S3.E17.m1.16.16.16.16.13.13.cmml" xref="S3.E17.m1.16.16.16.16.13.13">𝑘</ci><list id="S3.E17.m1.51.51.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><apply id="S3.E17.m1.51.51.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S3.E17.m1.18.18.18.18.15.15.cmml" xref="S3.E17.m1.18.18.18.18.15.15">𝐳</ci><apply id="S3.E17.m1.19.19.19.19.16.16.1.cmml" xref="S3.E17.m1.19.19.19.19.16.16.1"><lt id="S3.E17.m1.19.19.19.19.16.16.1.1.cmml" xref="S3.E17.m1.19.19.19.19.16.16.1.1"></lt><csymbol cd="latexml" id="S3.E17.m1.19.19.19.19.16.16.1.2.cmml" xref="S3.E17.m1.19.19.19.19.16.16.1.2">absent</csymbol><ci id="S3.E17.m1.19.19.19.19.16.16.1.3.cmml" xref="S3.E17.m1.19.19.19.19.16.16.1.3">𝑡</ci></apply></apply><ci id="S3.E17.m1.21.21.21.21.18.18.cmml" xref="S3.E17.m1.21.21.21.21.18.18">𝐱</ci><ci id="S3.E17.m1.23.23.23.23.20.20.cmml" xref="S3.E17.m1.23.23.23.23.20.20">𝐭</ci><apply id="S3.E17.m1.51.51.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S3.E17.m1.25.25.25.25.22.22.cmml" xref="S3.E17.m1.25.25.25.25.22.22">𝜃</ci><apply id="S3.E17.m1.26.26.26.26.23.23.1.cmml" xref="S3.E17.m1.26.26.26.26.23.23.1"><times id="S3.E17.m1.26.26.26.26.23.23.1.1.cmml" xref="S3.E17.m1.26.26.26.26.23.23.1.1"></times><ci id="S3.E17.m1.26.26.26.26.23.23.1.2.cmml" xref="S3.E17.m1.26.26.26.26.23.23.1.2">𝑡</ci><cn id="S3.E17.m1.26.26.26.26.23.23.1.3.cmml" type="integer" xref="S3.E17.m1.26.26.26.26.23.23.1.3">2</cn><ci id="S3.E17.m1.26.26.26.26.23.23.1.4.cmml" xref="S3.E17.m1.26.26.26.26.23.23.1.4">𝑖</ci></apply></apply></list></apply></apply><ci id="S3.E17.m1.28.28.28.1.1.1.cmml" xref="S3.E17.m1.28.28.28.1.1.1">log</ci><ci id="S3.E17.m1.29.29.29.2.2.2.cmml" xref="S3.E17.m1.29.29.29.2.2.2">𝑝</ci><apply id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><eq id="S3.E17.m1.33.33.33.6.6.6.cmml" xref="S3.E17.m1.33.33.33.6.6.6"></eq><apply id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.6.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.6.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S3.E17.m1.31.31.31.4.4.4.cmml" xref="S3.E17.m1.31.31.31.4.4.4">𝑧</ci><ci id="S3.E17.m1.32.32.32.5.5.5.1.cmml" xref="S3.E17.m1.32.32.32.5.5.5.1">𝑡</ci></apply><apply id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.4.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="latexml" id="S3.E17.m1.35.35.35.8.8.8.cmml" xref="S3.E17.m1.35.35.35.8.8.8">conditional</csymbol><ci id="S3.E17.m1.34.34.34.7.7.7.cmml" xref="S3.E17.m1.34.34.34.7.7.7">𝑘</ci><list id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.4.4.5.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><apply id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S3.E17.m1.36.36.36.9.9.9.cmml" xref="S3.E17.m1.36.36.36.9.9.9">𝐳</ci><apply id="S3.E17.m1.37.37.37.10.10.10.1.cmml" xref="S3.E17.m1.37.37.37.10.10.10.1"><lt id="S3.E17.m1.37.37.37.10.10.10.1.1.cmml" xref="S3.E17.m1.37.37.37.10.10.10.1.1"></lt><csymbol cd="latexml" id="S3.E17.m1.37.37.37.10.10.10.1.2.cmml" xref="S3.E17.m1.37.37.37.10.10.10.1.2">absent</csymbol><ci id="S3.E17.m1.37.37.37.10.10.10.1.3.cmml" xref="S3.E17.m1.37.37.37.10.10.10.1.3">𝑡</ci></apply></apply><ci id="S3.E17.m1.39.39.39.12.12.12.cmml" xref="S3.E17.m1.39.39.39.12.12.12">𝐱</ci><apply id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.2.2.2.2.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S3.E17.m1.41.41.41.14.14.14.cmml" xref="S3.E17.m1.41.41.41.14.14.14">𝜃</ci><apply id="S3.E17.m1.42.42.42.15.15.15.1.cmml" xref="S3.E17.m1.42.42.42.15.15.15.1"><times id="S3.E17.m1.42.42.42.15.15.15.1.1.cmml" xref="S3.E17.m1.42.42.42.15.15.15.1.1"></times><ci id="S3.E17.m1.42.42.42.15.15.15.1.2.cmml" xref="S3.E17.m1.42.42.42.15.15.15.1.2">𝑖</ci><ci id="S3.E17.m1.42.42.42.15.15.15.1.3.cmml" xref="S3.E17.m1.42.42.42.15.15.15.1.3">𝑒</ci></apply></apply><apply id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.3.3.3.3.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.3.3.3.3.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S3.E17.m1.44.44.44.17.17.17.cmml" xref="S3.E17.m1.44.44.44.17.17.17">𝜃</ci><apply id="S3.E17.m1.45.45.45.18.18.18.1.cmml" xref="S3.E17.m1.45.45.45.18.18.18.1"><times id="S3.E17.m1.45.45.45.18.18.18.1.1.cmml" xref="S3.E17.m1.45.45.45.18.18.18.1.1"></times><ci id="S3.E17.m1.45.45.45.18.18.18.1.2.cmml" xref="S3.E17.m1.45.45.45.18.18.18.1.2">𝑡</ci><ci id="S3.E17.m1.45.45.45.18.18.18.1.3.cmml" xref="S3.E17.m1.45.45.45.18.18.18.1.3">𝑡</ci><ci id="S3.E17.m1.45.45.45.18.18.18.1.4.cmml" xref="S3.E17.m1.45.45.45.18.18.18.1.4">𝑑</ci></apply></apply><apply id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.4.4.4.4.cmml" xref="S3.E17.m1.3.3.3.3.3.5"><csymbol cd="ambiguous" id="S3.E17.m1.51.51.1.1.1.2.2.2.2.2.1.1.4.4.4.4.1.cmml" xref="S3.E17.m1.3.3.3.3.3.5">subscript</csymbol><ci id="S3.E17.m1.47.47.47.20.20.20.cmml" xref="S3.E17.m1.47.47.47.20.20.20">𝜃</ci><apply id="S3.E17.m1.48.48.48.21.21.21.1.cmml" xref="S3.E17.m1.48.48.48.21.21.21.1"><times id="S3.E17.m1.48.48.48.21.21.21.1.1.cmml" xref="S3.E17.m1.48.48.48.21.21.21.1.1"></times><ci id="S3.E17.m1.48.48.48.21.21.21.1.2.cmml" xref="S3.E17.m1.48.48.48.21.21.21.1.2">𝑖</ci><ci id="S3.E17.m1.48.48.48.21.21.21.1.3.cmml" xref="S3.E17.m1.48.48.48.21.21.21.1.3">𝑑</ci></apply></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.53c">\begin{split}\mathcal{L}_{kd}=&amp;-\sum_{t=1}^{|\mathbf{z}|}\sum_{k=1}^{|\mathcal%
{V}|}q(z_{t}=k|\mathbf{z}_{&lt;t},\mathbf{x},\mathbf{t};\theta_{t2i})\\
&amp;\mathrm{log}p(z_{t}=k|\mathbf{z}_{&lt;t},\mathbf{x};\theta_{ie},\theta_{ttd},%
\theta_{id}),\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E17.m1.53d">start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT italic_k italic_d end_POSTSUBSCRIPT = end_CELL start_CELL - ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | bold_z | end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_V | end_POSTSUPERSCRIPT italic_q ( italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_k | bold_z start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT , bold_x , bold_t ; italic_θ start_POSTSUBSCRIPT italic_t 2 italic_i end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL roman_log italic_p ( italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_k | bold_z start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT , bold_x ; italic_θ start_POSTSUBSCRIPT italic_i italic_e end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_t italic_t italic_d end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p9.4">where <math alttext="\theta_{t2i}" class="ltx_Math" display="inline" id="S3.SS2.p9.4.m1.1"><semantics id="S3.SS2.p9.4.m1.1a"><msub id="S3.SS2.p9.4.m1.1.1" xref="S3.SS2.p9.4.m1.1.1.cmml"><mi id="S3.SS2.p9.4.m1.1.1.2" xref="S3.SS2.p9.4.m1.1.1.2.cmml">θ</mi><mrow id="S3.SS2.p9.4.m1.1.1.3" xref="S3.SS2.p9.4.m1.1.1.3.cmml"><mi id="S3.SS2.p9.4.m1.1.1.3.2" xref="S3.SS2.p9.4.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p9.4.m1.1.1.3.1" xref="S3.SS2.p9.4.m1.1.1.3.1.cmml">⁢</mo><mn id="S3.SS2.p9.4.m1.1.1.3.3" xref="S3.SS2.p9.4.m1.1.1.3.3.cmml">2</mn><mo id="S3.SS2.p9.4.m1.1.1.3.1a" xref="S3.SS2.p9.4.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p9.4.m1.1.1.3.4" xref="S3.SS2.p9.4.m1.1.1.3.4.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.4.m1.1b"><apply id="S3.SS2.p9.4.m1.1.1.cmml" xref="S3.SS2.p9.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p9.4.m1.1.1.1.cmml" xref="S3.SS2.p9.4.m1.1.1">subscript</csymbol><ci id="S3.SS2.p9.4.m1.1.1.2.cmml" xref="S3.SS2.p9.4.m1.1.1.2">𝜃</ci><apply id="S3.SS2.p9.4.m1.1.1.3.cmml" xref="S3.SS2.p9.4.m1.1.1.3"><times id="S3.SS2.p9.4.m1.1.1.3.1.cmml" xref="S3.SS2.p9.4.m1.1.1.3.1"></times><ci id="S3.SS2.p9.4.m1.1.1.3.2.cmml" xref="S3.SS2.p9.4.m1.1.1.3.2">𝑡</ci><cn id="S3.SS2.p9.4.m1.1.1.3.3.cmml" type="integer" xref="S3.SS2.p9.4.m1.1.1.3.3">2</cn><ci id="S3.SS2.p9.4.m1.1.1.3.4.cmml" xref="S3.SS2.p9.4.m1.1.1.3.4">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.4.m1.1c">\theta_{t2i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p9.4.m1.1d">italic_θ start_POSTSUBSCRIPT italic_t 2 italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the parameters of the T2I model.
Note that we will remove the source text decoder and T2I model during inference.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Setup</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Dataset</span>. Due to the lack of readily available data, we utilize the widely-used IWSLT14 German-English (De-En) dataset <cite class="ltx_cite ltx_citemacro_cite">Cettolo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib4" title="">2014</a>)</cite> to synthesize paired images for this task. Concretely, we leverage the Python Pillow package<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>https://github.com/python-pillow/Pillow</span></span></span> to render texts onto images with the black Arial<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>https://learn.microsoft.com/en-us/typography/font-list/arial</span></span></span> font. The text is arranged horizontally from left to right, and vertically from top to bottom, with randomly translating and rotating. This involves shifting the text in a random direction and changing its orientation by a random angle. Additionally, the background color of the image is selected randomly and the resolution of the images is 512<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mo id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><times id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">×</annotation></semantics></math>512. Note that bilingual texts exceeding the image boundaries will be disregarded during the process of data synthesis. In contrast to prior studies <cite class="ltx_cite ltx_citemacro_cite">Mansimov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib23" title="">2020</a>); Tian et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib31" title="">2023</a>)</cite>, which focus solely on generating images with single-line text and white background, our research delves into more complex scenes. In the end, the synthesized dataset comprises 81,741 training instances, 3,765 validation instances, and 3,527 test instances. Several synthetic examples and comparisons with previous data can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A2" title="Appendix B Data Examples ‣ Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">In addition to the IIMT data, a substantial quantity of images is also indispensable for training the image tokenizer. To this end, we employ the text extracted from the WMT14 English-German (En-De) <cite class="ltx_cite ltx_citemacro_cite">Bojar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib2" title="">2014</a>)</cite> to synthesize images for training our image tokenizer.</p>
</div>
<figure class="ltx_table" id="S4.SS1.14">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="S4.SS1.8.8" style="width:867.2pt;height:249.9pt;vertical-align:-1.5pt;"><span class="ltx_transformed_inner" style="transform:translate(150.8pt,-43.2pt) scale(1.53327704751533,1.53327704751533) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.SS1.8.8.8">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.SS1.2.2.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.SS1.2.2.2.2.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.SS1.2.2.2.2.3.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.SS1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.1.1.1.1.1.1">De<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS1.1.1.1.1.1.1.m1.1"><semantics id="S4.SS1.1.1.1.1.1.1.m1.1a"><mo id="S4.SS1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.SS1.1.1.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.1.1.1.1.1.1.m1.1b"><ci id="S4.SS1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.SS1.1.1.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.1.1.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.1.1.1.1.1.1.m1.1d">→</annotation></semantics></math>En</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.SS1.2.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.SS1.2.2.2.2.2.1">En<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS1.2.2.2.2.2.1.m1.1"><semantics id="S4.SS1.2.2.2.2.2.1.m1.1a"><mo id="S4.SS1.2.2.2.2.2.1.m1.1.1" stretchy="false" xref="S4.SS1.2.2.2.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.2.2.2.2.2.1.m1.1b"><ci id="S4.SS1.2.2.2.2.2.1.m1.1.1.cmml" xref="S4.SS1.2.2.2.2.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.2.2.2.2.2.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.2.2.2.2.2.1.m1.1d">→</annotation></semantics></math>De</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.2.2.2.2.4" rowspan="2"><span class="ltx_text" id="S4.SS1.2.2.2.2.4.1">#Param</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS1.8.8.8.8">
<td class="ltx_td ltx_align_center" id="S4.SS1.3.3.3.3.1">BLEU <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS1.3.3.3.3.1.m1.1"><semantics id="S4.SS1.3.3.3.3.1.m1.1a"><mo id="S4.SS1.3.3.3.3.1.m1.1.1" stretchy="false" xref="S4.SS1.3.3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.3.3.3.3.1.m1.1b"><ci id="S4.SS1.3.3.3.3.1.m1.1.1.cmml" xref="S4.SS1.3.3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.3.3.3.3.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.3.3.3.3.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.4.4.4.4.2">Structure-BLEU <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS1.4.4.4.4.2.m1.1"><semantics id="S4.SS1.4.4.4.4.2.m1.1a"><mo id="S4.SS1.4.4.4.4.2.m1.1.1" stretchy="false" xref="S4.SS1.4.4.4.4.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.4.4.4.4.2.m1.1b"><ci id="S4.SS1.4.4.4.4.2.m1.1.1.cmml" xref="S4.SS1.4.4.4.4.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.4.4.4.4.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.4.4.4.4.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS1.5.5.5.5.3">SSIM <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS1.5.5.5.5.3.m1.1"><semantics id="S4.SS1.5.5.5.5.3.m1.1a"><mo id="S4.SS1.5.5.5.5.3.m1.1.1" stretchy="false" xref="S4.SS1.5.5.5.5.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.5.5.5.5.3.m1.1b"><ci id="S4.SS1.5.5.5.5.3.m1.1.1.cmml" xref="S4.SS1.5.5.5.5.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.5.5.5.5.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.5.5.5.5.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.6.6.6.6.4">BLEU <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS1.6.6.6.6.4.m1.1"><semantics id="S4.SS1.6.6.6.6.4.m1.1a"><mo id="S4.SS1.6.6.6.6.4.m1.1.1" stretchy="false" xref="S4.SS1.6.6.6.6.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.6.6.6.6.4.m1.1b"><ci id="S4.SS1.6.6.6.6.4.m1.1.1.cmml" xref="S4.SS1.6.6.6.6.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.6.6.6.6.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.6.6.6.6.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.7.7.7.7.5">Structure-BLEU <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS1.7.7.7.7.5.m1.1"><semantics id="S4.SS1.7.7.7.7.5.m1.1a"><mo id="S4.SS1.7.7.7.7.5.m1.1.1" stretchy="false" xref="S4.SS1.7.7.7.7.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.7.7.7.7.5.m1.1b"><ci id="S4.SS1.7.7.7.7.5.m1.1.1.cmml" xref="S4.SS1.7.7.7.7.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.7.7.7.7.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.7.7.7.7.5.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS1.8.8.8.8.6">SSIM <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS1.8.8.8.8.6.m1.1"><semantics id="S4.SS1.8.8.8.8.6.m1.1a"><mo id="S4.SS1.8.8.8.8.6.m1.1.1" stretchy="false" xref="S4.SS1.8.8.8.8.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.8.8.8.8.6.m1.1b"><ci id="S4.SS1.8.8.8.8.6.m1.1.1.cmml" xref="S4.SS1.8.8.8.8.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.8.8.8.8.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.8.8.8.8.6.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.SS1.8.8.8.9.1">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="8" id="S4.SS1.8.8.8.9.1.1"><span class="ltx_text ltx_font_italic" id="S4.SS1.8.8.8.9.1.1.1">Cascaded Models</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS1.8.8.8.10.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.SS1.8.8.8.10.2.1">OCR+MT+T2I</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.8.8.8.10.2.2">15.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.8.8.8.10.2.3">14.87</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS1.8.8.8.10.2.4">0.7785</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.8.8.8.10.2.5">13.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.8.8.8.10.2.6">12.57</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS1.8.8.8.10.2.7">0.7550</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.8.8.8.10.2.8">247M</td>
</tr>
<tr class="ltx_tr" id="S4.SS1.8.8.8.11.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.SS1.8.8.8.11.3.1">TIT+T2I</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.8.8.8.11.3.2">14.80</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.8.8.8.11.3.3">14.73</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS1.8.8.8.11.3.4">0.7812</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.8.8.8.11.3.5">12.92</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.8.8.8.11.3.6">12.74</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS1.8.8.8.11.3.7">0.7620</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.8.8.8.11.3.8">201M</td>
</tr>
<tr class="ltx_tr" id="S4.SS1.8.8.8.12.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.SS1.8.8.8.12.4.1">PEIT+T2I</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.8.8.8.12.4.2">10.91</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.8.8.8.12.4.3">10.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS1.8.8.8.12.4.4">0.7740</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.8.8.8.12.4.5">8.77</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.8.8.8.12.4.6">8.01</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS1.8.8.8.12.4.7">0.7594</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.8.8.8.12.4.8">178M</td>
</tr>
<tr class="ltx_tr" id="S4.SS1.8.8.8.13.5">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="8" id="S4.SS1.8.8.8.13.5.1"><span class="ltx_text ltx_font_italic" id="S4.SS1.8.8.8.13.5.1.1">End-to-end Models</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS1.8.8.8.14.6">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.SS1.8.8.8.14.6.1">Pixel-level Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.8.8.8.14.6.2">0.15</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.8.8.8.14.6.3">0.15</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS1.8.8.8.14.6.4">0.7538</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.8.8.8.14.6.5">1.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.8.8.8.14.6.6">1.22</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS1.8.8.8.14.6.7">0.7616</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.8.8.8.14.6.8">162M</td>
</tr>
<tr class="ltx_tr" id="S4.SS1.8.8.8.15.7">
<td class="ltx_td ltx_align_left ltx_border_b" colspan="2" id="S4.SS1.8.8.8.15.7.1">
<span class="ltx_ERROR undefined" id="S4.SS1.8.8.8.15.7.1.1">\hdashline</span>[2pt/2pt]
  Translatotron-V</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS1.8.8.8.15.7.2"><span class="ltx_text ltx_font_bold" id="S4.SS1.8.8.8.15.7.2.1">15.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS1.8.8.8.15.7.3"><span class="ltx_text ltx_font_bold" id="S4.SS1.8.8.8.15.7.3.1">15.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.SS1.8.8.8.15.7.4"><span class="ltx_text ltx_font_bold" id="S4.SS1.8.8.8.15.7.4.1">0.7832</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS1.8.8.8.15.7.5"><span class="ltx_text ltx_font_bold" id="S4.SS1.8.8.8.15.7.5.1">13.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS1.8.8.8.15.7.6"><span class="ltx_text ltx_font_bold" id="S4.SS1.8.8.8.15.7.6.1">12.92</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.SS1.8.8.8.15.7.7"><span class="ltx_text ltx_font_bold" id="S4.SS1.8.8.8.15.7.7.1">0.7629</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.SS1.8.8.8.15.7.8">175M</td>
</tr>
</tbody>
</table>
</span></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Experimental results on the De<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS1.11.11.m1.1"><semantics id="S4.SS1.11.11.m1.1b"><mo id="S4.SS1.11.11.m1.1.1" stretchy="false" xref="S4.SS1.11.11.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.11.11.m1.1c"><ci id="S4.SS1.11.11.m1.1.1.cmml" xref="S4.SS1.11.11.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.11.11.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.11.11.m1.1e">→</annotation></semantics></math>En and En<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS1.12.12.m2.1"><semantics id="S4.SS1.12.12.m2.1b"><mo id="S4.SS1.12.12.m2.1.1" stretchy="false" xref="S4.SS1.12.12.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.12.12.m2.1c"><ci id="S4.SS1.12.12.m2.1.1.cmml" xref="S4.SS1.12.12.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.12.12.m2.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.12.12.m2.1e">→</annotation></semantics></math>De IIMT tasks.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel" id="S4.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.3" style="width:433.6pt;height:159.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(70.1pt,-25.8pt) scale(1.47824747140621,1.47824747140621) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.3.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.3.3.3.4"><span class="ltx_text ltx_font_bold" id="S4.T2.3.3.3.4.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.1">BLEU</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T2.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.1.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.2.2.2.2">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.2.2.2.1">S-BLEU</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.2.2.2.2.m1.1"><semantics id="S4.T2.2.2.2.2.m1.1a"><mo id="S4.T2.2.2.2.2.m1.1.1" stretchy="false" xref="S4.T2.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><ci id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.3.3.3.3">
<span class="ltx_text ltx_font_bold" id="S4.T2.3.3.3.3.1">SSIM</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.3.3.3.3.m1.1"><semantics id="S4.T2.3.3.3.3.m1.1a"><mo id="S4.T2.3.3.3.3.m1.1.1" stretchy="false" xref="S4.T2.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.1b"><ci id="S4.T2.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.3.3.m1.1d">↑</annotation></semantics></math>
</th>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.3.3.4.1.1">Translatotron-V</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.3.3.4.1.2"><span class="ltx_text ltx_font_bold" id="S4.T2.3.3.4.1.2.1">15.39</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.3.3.4.1.3"><span class="ltx_text ltx_font_bold" id="S4.T2.3.3.4.1.3.1">15.26</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.3.3.4.1.4"><span class="ltx_text ltx_font_bold" id="S4.T2.3.3.4.1.4.1">0.7832</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.3.3.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.3.3.5.1.1">     <span class="ltx_text ltx_font_italic" id="S4.T2.3.3.5.1.1.1">w/o</span> gated fusion</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.5.1.2">14.34</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.5.1.3">14.20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.5.1.4">0.7830</td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3.6.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.3.6.2.1">     <span class="ltx_text ltx_font_italic" id="S4.T2.3.3.6.2.1.1">w/o</span> OCR auxiliary task</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.6.2.2">1.39</td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.6.2.3">1.18</td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.6.2.4">0.7277</td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3.7.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.3.3.7.3.1">     <span class="ltx_text ltx_font_italic" id="S4.T2.3.3.7.3.1.1">w/o</span> knowledge distillation</th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.7.3.2">13.35</td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.7.3.3">13.43</td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.7.3.4">0.7813</td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3.8.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T2.3.3.8.4.1">     <span class="ltx_text ltx_font_italic" id="S4.T2.3.3.8.4.1.1">w/o</span> target text decoder</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.3.3.8.4.2">0.47</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.3.3.8.4.3">0.43</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.3.3.8.4.4">0.7751</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Ablation study of Translatotron-V on the De<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.5.m1.1"><semantics id="S4.T2.5.m1.1b"><mo id="S4.T2.5.m1.1.1" stretchy="false" xref="S4.T2.5.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.m1.1c"><ci id="S4.T2.5.m1.1.1.cmml" xref="S4.T2.5.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.m1.1e">→</annotation></semantics></math>En IIMT task. S-BLEU represents Structure-BLEU.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S4.SS1.14.15"><span class="ltx_text ltx_font_bold" id="S4.SS1.14.15.1">Implementation Details</span>.
In this work, we employ the same setting as ViT-B <cite class="ltx_cite ltx_citemacro_cite">Dosovitskiy et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib7" title="">2021</a>)</cite> to construct our image encoder. Both our target text decoder and image decoder are composed of 8 layers, each of which has 512-dimensional hidden states, 8 attention heads, and 2,048 feed-forward hidden states. Besides, our image tokenizer is similar to ViT-VQGAN-SS <cite class="ltx_cite ltx_citemacro_cite">Yu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib41" title="">2022a</a>)</cite> but uses a smaller setup. It consists of 4 layers of encoder and decoder, each of which has 256-dimensional hidden states, 8 attention heads, and 1,024 feed-forward hidden states. Particularly, we use a character-level vocabulary of size 256 for the OCR and TIT auxiliary tasks, while the image vocabulary size for visual tokens is set to 8,192. Unless otherwise specified, the patch size of the image is set to 16.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S4.SS1.14.14">During the first training stage, we train the image tokenizer with a batch size of 512 for 10,000 steps, where the parameters are updated by AdamW <cite class="ltx_cite ltx_citemacro_cite">Loshchilov and Hutter (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib18" title="">2019</a>)</cite> with <math alttext="\beta_{1}=0.9,\beta_{2}=0.99" class="ltx_Math" display="inline" id="S4.SS1.13.13.m1.2"><semantics id="S4.SS1.13.13.m1.2a"><mrow id="S4.SS1.13.13.m1.2.2.2" xref="S4.SS1.13.13.m1.2.2.3.cmml"><mrow id="S4.SS1.13.13.m1.1.1.1.1" xref="S4.SS1.13.13.m1.1.1.1.1.cmml"><msub id="S4.SS1.13.13.m1.1.1.1.1.2" xref="S4.SS1.13.13.m1.1.1.1.1.2.cmml"><mi id="S4.SS1.13.13.m1.1.1.1.1.2.2" xref="S4.SS1.13.13.m1.1.1.1.1.2.2.cmml">β</mi><mn id="S4.SS1.13.13.m1.1.1.1.1.2.3" xref="S4.SS1.13.13.m1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS1.13.13.m1.1.1.1.1.1" xref="S4.SS1.13.13.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.SS1.13.13.m1.1.1.1.1.3" xref="S4.SS1.13.13.m1.1.1.1.1.3.cmml">0.9</mn></mrow><mo id="S4.SS1.13.13.m1.2.2.2.3" xref="S4.SS1.13.13.m1.2.2.3a.cmml">,</mo><mrow id="S4.SS1.13.13.m1.2.2.2.2" xref="S4.SS1.13.13.m1.2.2.2.2.cmml"><msub id="S4.SS1.13.13.m1.2.2.2.2.2" xref="S4.SS1.13.13.m1.2.2.2.2.2.cmml"><mi id="S4.SS1.13.13.m1.2.2.2.2.2.2" xref="S4.SS1.13.13.m1.2.2.2.2.2.2.cmml">β</mi><mn id="S4.SS1.13.13.m1.2.2.2.2.2.3" xref="S4.SS1.13.13.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.13.13.m1.2.2.2.2.1" xref="S4.SS1.13.13.m1.2.2.2.2.1.cmml">=</mo><mn id="S4.SS1.13.13.m1.2.2.2.2.3" xref="S4.SS1.13.13.m1.2.2.2.2.3.cmml">0.99</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.13.13.m1.2b"><apply id="S4.SS1.13.13.m1.2.2.3.cmml" xref="S4.SS1.13.13.m1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.13.13.m1.2.2.3a.cmml" xref="S4.SS1.13.13.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS1.13.13.m1.1.1.1.1.cmml" xref="S4.SS1.13.13.m1.1.1.1.1"><eq id="S4.SS1.13.13.m1.1.1.1.1.1.cmml" xref="S4.SS1.13.13.m1.1.1.1.1.1"></eq><apply id="S4.SS1.13.13.m1.1.1.1.1.2.cmml" xref="S4.SS1.13.13.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.13.13.m1.1.1.1.1.2.1.cmml" xref="S4.SS1.13.13.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.13.13.m1.1.1.1.1.2.2.cmml" xref="S4.SS1.13.13.m1.1.1.1.1.2.2">𝛽</ci><cn id="S4.SS1.13.13.m1.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.13.13.m1.1.1.1.1.2.3">1</cn></apply><cn id="S4.SS1.13.13.m1.1.1.1.1.3.cmml" type="float" xref="S4.SS1.13.13.m1.1.1.1.1.3">0.9</cn></apply><apply id="S4.SS1.13.13.m1.2.2.2.2.cmml" xref="S4.SS1.13.13.m1.2.2.2.2"><eq id="S4.SS1.13.13.m1.2.2.2.2.1.cmml" xref="S4.SS1.13.13.m1.2.2.2.2.1"></eq><apply id="S4.SS1.13.13.m1.2.2.2.2.2.cmml" xref="S4.SS1.13.13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.13.13.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.13.13.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.13.13.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.13.13.m1.2.2.2.2.2.2">𝛽</ci><cn id="S4.SS1.13.13.m1.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.13.13.m1.2.2.2.2.2.3">2</cn></apply><cn id="S4.SS1.13.13.m1.2.2.2.2.3.cmml" type="float" xref="S4.SS1.13.13.m1.2.2.2.2.3">0.99</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.13.13.m1.2c">\beta_{1}=0.9,\beta_{2}=0.99</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.13.13.m1.2d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9 , italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.99</annotation></semantics></math>. During the second stage, we train the model for 100 epochs with an early stopping patience set to 10, and a batch size set to 80. This stage of training also utilizes the AdamW optimizer (<math alttext="\beta_{1}=0.9,\beta_{2}=0.999" class="ltx_Math" display="inline" id="S4.SS1.14.14.m2.2"><semantics id="S4.SS1.14.14.m2.2a"><mrow id="S4.SS1.14.14.m2.2.2.2" xref="S4.SS1.14.14.m2.2.2.3.cmml"><mrow id="S4.SS1.14.14.m2.1.1.1.1" xref="S4.SS1.14.14.m2.1.1.1.1.cmml"><msub id="S4.SS1.14.14.m2.1.1.1.1.2" xref="S4.SS1.14.14.m2.1.1.1.1.2.cmml"><mi id="S4.SS1.14.14.m2.1.1.1.1.2.2" xref="S4.SS1.14.14.m2.1.1.1.1.2.2.cmml">β</mi><mn id="S4.SS1.14.14.m2.1.1.1.1.2.3" xref="S4.SS1.14.14.m2.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS1.14.14.m2.1.1.1.1.1" xref="S4.SS1.14.14.m2.1.1.1.1.1.cmml">=</mo><mn id="S4.SS1.14.14.m2.1.1.1.1.3" xref="S4.SS1.14.14.m2.1.1.1.1.3.cmml">0.9</mn></mrow><mo id="S4.SS1.14.14.m2.2.2.2.3" xref="S4.SS1.14.14.m2.2.2.3a.cmml">,</mo><mrow id="S4.SS1.14.14.m2.2.2.2.2" xref="S4.SS1.14.14.m2.2.2.2.2.cmml"><msub id="S4.SS1.14.14.m2.2.2.2.2.2" xref="S4.SS1.14.14.m2.2.2.2.2.2.cmml"><mi id="S4.SS1.14.14.m2.2.2.2.2.2.2" xref="S4.SS1.14.14.m2.2.2.2.2.2.2.cmml">β</mi><mn id="S4.SS1.14.14.m2.2.2.2.2.2.3" xref="S4.SS1.14.14.m2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.14.14.m2.2.2.2.2.1" xref="S4.SS1.14.14.m2.2.2.2.2.1.cmml">=</mo><mn id="S4.SS1.14.14.m2.2.2.2.2.3" xref="S4.SS1.14.14.m2.2.2.2.2.3.cmml">0.999</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.14.14.m2.2b"><apply id="S4.SS1.14.14.m2.2.2.3.cmml" xref="S4.SS1.14.14.m2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.14.14.m2.2.2.3a.cmml" xref="S4.SS1.14.14.m2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS1.14.14.m2.1.1.1.1.cmml" xref="S4.SS1.14.14.m2.1.1.1.1"><eq id="S4.SS1.14.14.m2.1.1.1.1.1.cmml" xref="S4.SS1.14.14.m2.1.1.1.1.1"></eq><apply id="S4.SS1.14.14.m2.1.1.1.1.2.cmml" xref="S4.SS1.14.14.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.14.14.m2.1.1.1.1.2.1.cmml" xref="S4.SS1.14.14.m2.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.14.14.m2.1.1.1.1.2.2.cmml" xref="S4.SS1.14.14.m2.1.1.1.1.2.2">𝛽</ci><cn id="S4.SS1.14.14.m2.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS1.14.14.m2.1.1.1.1.2.3">1</cn></apply><cn id="S4.SS1.14.14.m2.1.1.1.1.3.cmml" type="float" xref="S4.SS1.14.14.m2.1.1.1.1.3">0.9</cn></apply><apply id="S4.SS1.14.14.m2.2.2.2.2.cmml" xref="S4.SS1.14.14.m2.2.2.2.2"><eq id="S4.SS1.14.14.m2.2.2.2.2.1.cmml" xref="S4.SS1.14.14.m2.2.2.2.2.1"></eq><apply id="S4.SS1.14.14.m2.2.2.2.2.2.cmml" xref="S4.SS1.14.14.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.14.14.m2.2.2.2.2.2.1.cmml" xref="S4.SS1.14.14.m2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.14.14.m2.2.2.2.2.2.2.cmml" xref="S4.SS1.14.14.m2.2.2.2.2.2.2">𝛽</ci><cn id="S4.SS1.14.14.m2.2.2.2.2.2.3.cmml" type="integer" xref="S4.SS1.14.14.m2.2.2.2.2.2.3">2</cn></apply><cn id="S4.SS1.14.14.m2.2.2.2.2.3.cmml" type="float" xref="S4.SS1.14.14.m2.2.2.2.2.3">0.999</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.14.14.m2.2c">\beta_{1}=0.9,\beta_{2}=0.999</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.14.14.m2.2d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9 , italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.999</annotation></semantics></math>) along with weight decay of 0.001 and polynomial decay learning rate scheduling. To alleviate overfitting, we apply a dropout rate of 0.1 and incorporate the label smoothing with a coefficient of 0.1, and we average the checkpoints of the last 10 epochs for evaluation.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S4.SS1.14.16"><span class="ltx_text ltx_font_bold" id="S4.SS1.14.16.1">Baselines</span>.
We construct the following baselines: OCR+MT+T2I, TIT+T2I, PEIT+T2I, and pixel-level Transformer, all models trained using character inputs and outputs similar to our model.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S4.SS1.14.17">1) <span class="ltx_text ltx_font_italic" id="S4.SS1.14.17.1">OCR+MT+T2I</span>. This baseline cascades three models: an OCR model, an MT model, and a T2I model. Note that our teacher model has the same architecture as the T2I Model, except for reducing the hidden states from 512-dimensional to 384-dimensional. 2) <span class="ltx_text ltx_font_italic" id="S4.SS1.14.17.2">TIT+T2I</span>. We construct this baseline by cascading the TIT model and the T2I model.
Additionally, it applies both OCR and TIT tasks during training to achieve better performance. 3) <span class="ltx_text ltx_font_italic" id="S4.SS1.14.17.3">PEIT+T2I</span>. This baseline is similar to TIT+T2I but replaces the multi-line TIT model with PEIT <cite class="ltx_cite ltx_citemacro_cite">Zhu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib44" title="">2023</a>)</cite>, the state-of-the-art single-line TIT model. Since PEIT is designed for single-line TIT, during inference, we first employ the widely-used EasyOCR<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>https://github.com/JaidedAI/EasyOCR</span></span></span> as the detection model to recognize and crop each line of text from the image, and then concatenate them together into a single-line text image. 4) <span class="ltx_text ltx_font_italic" id="S4.SS1.14.17.4">Pixel-level Transformer</span>. This model uses the same structure as our model but removes the image tokenizer and directly predicts pixel values. It is trained using multi-task learning as well, with the IIMT task being optimized with a mean squared error loss due to the pixel values being of floating-point type.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S4.SS1.14.18">The detailed architecture of OCR+MT+T2I, TIT+T2I, and PEIT+T2I is described in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A3" title="Appendix C Baseline Architecture Details ‣ Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S4.SS1.14.19"><span class="ltx_text ltx_font_bold" id="S4.SS1.14.19.1">Evaluation</span>.
We evaluate the output images from both the perspectives of translation quality and image quality. We follow <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib23" title="">Mansimov et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib23" title="">2020</a></cite>) to transcribe the generated images into texts with EasyOCR toolkit and then measure the BLEU <cite class="ltx_cite ltx_citemacro_cite">Papineni et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib24" title="">2002</a>)</cite> score calculated by SacreBLEU<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>https://github.com/mjpost/sacrebleu</span></span></span> <cite class="ltx_cite ltx_citemacro_cite">Post (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib25" title="">2018</a>)</cite>. To take into account the location of texts within the generated image, we extend the conventional BLEU to Structure-BLEU. This metric first performs OCR on the generated image and the reference image separately. Then, we use the bounding boxes in the generated image and the reference image to calculate intersection over union (IoU) for text matching. Subsequently, we filter out matched text pairs with significantly different positions, specifically those with IoU values below 0.5. Finally, we calculate the BLEU score for the remaining paired texts. For more comprehensive details, please refer to the algorithm provided in the Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A4" title="Appendix D Structure-BLEU ‣ Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">D</span></a>. Besides, we evaluate the quality of the generated images via structural similarity index measure (SSIM) <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib35" title="">2004</a>)</cite>, which considers luminance, contrast, and structure to measure the similarity between two images. The comparison between SSIM and BLEU can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A5" title="Appendix E Comparison of BLEU and SSIM ‣ Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="116" id="S4.F4.g1" src="extracted/5707577/figures/case_study.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Translation examples of different models on the De<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.F4.2.m1.1"><semantics id="S4.F4.2.m1.1b"><mo id="S4.F4.2.m1.1.1" stretchy="false" xref="S4.F4.2.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.F4.2.m1.1c"><ci id="S4.F4.2.m1.1.1.cmml" xref="S4.F4.2.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.F4.2.m1.1e">→</annotation></semantics></math>En IIMT task.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="445" id="S4.F5.g1" src="extracted/5707577/figures/errpro_analysis_2.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>BLEU scores on different groups divided according to WER. We compute the WER using the text produced by the OCR toolkit.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<section class="ltx_subsection ltx_figure_panel" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S4.SS1" title="4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">4.1</span></a> shows the overall results of all models on the IWSLT14 De-En datasets, and we have the following observations. First, OCR+MT+T2I exhibits significantly better translation quality compared to TIT+T2I, but its performance of image quality is relatively poor. The underlying reason is that cascading more models may lead to more severe error propagation, thereby affecting the image quality generated by the final T2I model. Second, PEIT+T2I performs worse than other cascaded models, primarily because it heavily relies on the text detection model when handling multi-line text images. Third, the image translation quality generated by Pixel-Transformer is extremely poor, and we observe that it is essentially incapable of producing readable text. This is due to the fact that the search space of image pixel values is extremely large, which poses a challenge to the model’s optimization in generating accurate pixel values. Finally, Translatotron-V consistently achieves competitive performance with 70.9% parameters compared to cascaded baselines and significantly outperforms the pixel-level Transformer.</p>
</div>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Study</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">To explore the effectiveness of different components, we further compare Translatotron-V with its several variants, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S4.T2" title="Table 2 ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">1) <span class="ltx_text ltx_font_italic" id="S4.SS3.p2.1.1">w/o gated fusion</span>. In this variant, we remove the gated fusion mechanism of the image decoder when performing cross-attention. Consequently, the image decoder sequentially performs cross-attention over the image encoder and the target text decoder to update hidden states. The result in Line 2 indicates that this change causes a decline in translation quality, suggesting that the gated fusion mechanism is useful for fusing information from two modalities.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1">2) <span class="ltx_text ltx_font_italic" id="S4.SS3.p3.1.1">w/o OCR auxiliary task</span>. When constructing this variant, we remove the OCR auxiliary task during the model training. Upon analyzing Line 3, it becomes evident that this task can empower the model with the ability to perceive text within images, enabling the model to accomplish translation.</p>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1">3) <span class="ltx_text ltx_font_italic" id="S4.SS3.p4.1.1">w/o knowledge distillation</span>. We remove the knowledge distillation in this variant. As indicated in Line 4, there is a significant performance drop, which demonstrates that knowledge distillation effectively reduces the difficulty of training.</p>
</div>
<div class="ltx_para" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.1">4) <span class="ltx_text ltx_font_italic" id="S4.SS3.p5.1.1">w/o target text decoder</span>. In this variant, we remove the target text decoder from our model. The results reported in Line 5 demonstrate a drastic decline in performance. We can confirm that the end-to-end IIMT model imposes a substantial modeling burden. The target text decoder plays a pivotal role in mitigating the burden of achieving alignment between different languages.</p>
</div>
<figure class="ltx_table" id="S4.SS3.12">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="S4.SS3.8.8" style="width:867.2pt;height:249.9pt;vertical-align:-1.5pt;"><span class="ltx_transformed_inner" style="transform:translate(150.8pt,-43.2pt) scale(1.53327704751533,1.53327704751533) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.SS3.8.8.8">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.SS3.2.2.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.SS3.2.2.2.2.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.SS3.2.2.2.2.3.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.SS3.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.1.1.1.1.1.1">Fr<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS3.1.1.1.1.1.1.m1.1"><semantics id="S4.SS3.1.1.1.1.1.1.m1.1a"><mo id="S4.SS3.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.SS3.1.1.1.1.1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.1.1.1.1.1.1.m1.1b"><ci id="S4.SS3.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.SS3.1.1.1.1.1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.1.1.1.1.1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.1.1.1.1.1.1.m1.1d">→</annotation></semantics></math>En</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.SS3.2.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.SS3.2.2.2.2.2.1">Ro<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS3.2.2.2.2.2.1.m1.1"><semantics id="S4.SS3.2.2.2.2.2.1.m1.1a"><mo id="S4.SS3.2.2.2.2.2.1.m1.1.1" stretchy="false" xref="S4.SS3.2.2.2.2.2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.2.2.2.2.2.1.m1.1b"><ci id="S4.SS3.2.2.2.2.2.1.m1.1.1.cmml" xref="S4.SS3.2.2.2.2.2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.2.2.2.2.2.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.2.2.2.2.2.1.m1.1d">→</annotation></semantics></math>En</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.2.2.2.2.4" rowspan="2"><span class="ltx_text" id="S4.SS3.2.2.2.2.4.1">#Param</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS3.8.8.8.8">
<td class="ltx_td ltx_align_center" id="S4.SS3.3.3.3.3.1">BLEU <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS3.3.3.3.3.1.m1.1"><semantics id="S4.SS3.3.3.3.3.1.m1.1a"><mo id="S4.SS3.3.3.3.3.1.m1.1.1" stretchy="false" xref="S4.SS3.3.3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.3.3.3.3.1.m1.1b"><ci id="S4.SS3.3.3.3.3.1.m1.1.1.cmml" xref="S4.SS3.3.3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.3.3.3.3.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.3.3.3.3.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.4.4.4.4.2">Structure-BLEU <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS3.4.4.4.4.2.m1.1"><semantics id="S4.SS3.4.4.4.4.2.m1.1a"><mo id="S4.SS3.4.4.4.4.2.m1.1.1" stretchy="false" xref="S4.SS3.4.4.4.4.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.4.4.4.4.2.m1.1b"><ci id="S4.SS3.4.4.4.4.2.m1.1.1.cmml" xref="S4.SS3.4.4.4.4.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.4.4.4.4.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.4.4.4.4.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.5.5.5.5.3">SSIM <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS3.5.5.5.5.3.m1.1"><semantics id="S4.SS3.5.5.5.5.3.m1.1a"><mo id="S4.SS3.5.5.5.5.3.m1.1.1" stretchy="false" xref="S4.SS3.5.5.5.5.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.5.5.5.5.3.m1.1b"><ci id="S4.SS3.5.5.5.5.3.m1.1.1.cmml" xref="S4.SS3.5.5.5.5.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.5.5.5.5.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.5.5.5.5.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.6.6.6.6.4">BLEU <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS3.6.6.6.6.4.m1.1"><semantics id="S4.SS3.6.6.6.6.4.m1.1a"><mo id="S4.SS3.6.6.6.6.4.m1.1.1" stretchy="false" xref="S4.SS3.6.6.6.6.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.6.6.6.6.4.m1.1b"><ci id="S4.SS3.6.6.6.6.4.m1.1.1.cmml" xref="S4.SS3.6.6.6.6.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.6.6.6.6.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.6.6.6.6.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.7.7.7.7.5">Structure-BLEU <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS3.7.7.7.7.5.m1.1"><semantics id="S4.SS3.7.7.7.7.5.m1.1a"><mo id="S4.SS3.7.7.7.7.5.m1.1.1" stretchy="false" xref="S4.SS3.7.7.7.7.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.7.7.7.7.5.m1.1b"><ci id="S4.SS3.7.7.7.7.5.m1.1.1.cmml" xref="S4.SS3.7.7.7.7.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.7.7.7.7.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.7.7.7.7.5.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.8.8.8.8.6">SSIM <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.SS3.8.8.8.8.6.m1.1"><semantics id="S4.SS3.8.8.8.8.6.m1.1a"><mo id="S4.SS3.8.8.8.8.6.m1.1.1" stretchy="false" xref="S4.SS3.8.8.8.8.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.8.8.8.8.6.m1.1b"><ci id="S4.SS3.8.8.8.8.6.m1.1.1.cmml" xref="S4.SS3.8.8.8.8.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.8.8.8.8.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.8.8.8.8.6.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.8.8.8.9.1">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="8" id="S4.SS3.8.8.8.9.1.1"><span class="ltx_text ltx_font_italic" id="S4.SS3.8.8.8.9.1.1.1">Cascaded Models</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS3.8.8.8.10.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.SS3.8.8.8.10.2.1">OCR+MT+T2I</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.8.8.8.10.2.2">21.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.8.8.8.10.2.3">21.58</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS3.8.8.8.10.2.4">0.7738</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.8.8.8.10.2.5">18.34</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.8.8.8.10.2.6">18.61</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS3.8.8.8.10.2.7">0.7752</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.8.8.8.10.2.8">247M</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.8.8.8.11.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.SS3.8.8.8.11.3.1">TIT+T2I</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.8.8.8.11.3.2">21.87</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.8.8.8.11.3.3">21.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.8.8.8.11.3.4">0.7801</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.8.8.8.11.3.5">18.39</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.8.8.8.11.3.6">18.30</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.8.8.8.11.3.7">0.7764</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.8.8.8.11.3.8">201M</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.8.8.8.12.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.SS3.8.8.8.12.4.1">PEIT+T2I</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.8.8.8.12.4.2">18.51</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.8.8.8.12.4.3">18.55</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.8.8.8.12.4.4">0.7741</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.8.8.8.12.4.5">14.54</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.8.8.8.12.4.6">14.90</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS3.8.8.8.12.4.7">0.7704</td>
<td class="ltx_td ltx_align_center" id="S4.SS3.8.8.8.12.4.8">178M</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.8.8.8.13.5">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="8" id="S4.SS3.8.8.8.13.5.1"><span class="ltx_text ltx_font_italic" id="S4.SS3.8.8.8.13.5.1.1">End-to-end Models</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS3.8.8.8.14.6">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.SS3.8.8.8.14.6.1">Pixel-level Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.8.8.8.14.6.2">2.08</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.8.8.8.14.6.3">2.61</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS3.8.8.8.14.6.4">0.7753</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.8.8.8.14.6.5">1.58</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.8.8.8.14.6.6">2.11</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.SS3.8.8.8.14.6.7">0.7696</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS3.8.8.8.14.6.8">162M</td>
</tr>
<tr class="ltx_tr" id="S4.SS3.8.8.8.15.7">
<td class="ltx_td ltx_align_left ltx_border_b" colspan="2" id="S4.SS3.8.8.8.15.7.1">
<span class="ltx_ERROR undefined" id="S4.SS3.8.8.8.15.7.1.1">\hdashline</span>[2pt/2pt]
  Translatotron-V</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS3.8.8.8.15.7.2"><span class="ltx_text ltx_font_bold" id="S4.SS3.8.8.8.15.7.2.1">22.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS3.8.8.8.15.7.3"><span class="ltx_text ltx_font_bold" id="S4.SS3.8.8.8.15.7.3.1">22.17</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.SS3.8.8.8.15.7.4"><span class="ltx_text ltx_font_bold" id="S4.SS3.8.8.8.15.7.4.1">0.7811</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS3.8.8.8.15.7.5"><span class="ltx_text ltx_font_bold" id="S4.SS3.8.8.8.15.7.5.1">18.44</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.SS3.8.8.8.15.7.6"><span class="ltx_text ltx_font_bold" id="S4.SS3.8.8.8.15.7.6.1">18.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.SS3.8.8.8.15.7.7"><span class="ltx_text ltx_font_bold" id="S4.SS3.8.8.8.15.7.7.1">0.7780</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.SS3.8.8.8.15.7.8">175M</td>
</tr>
</tbody>
</table>
</span></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Experimental results on the Fr<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS3.11.11.m1.1"><semantics id="S4.SS3.11.11.m1.1b"><mo id="S4.SS3.11.11.m1.1.1" stretchy="false" xref="S4.SS3.11.11.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.11.11.m1.1c"><ci id="S4.SS3.11.11.m1.1.1.cmml" xref="S4.SS3.11.11.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.11.11.m1.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.11.11.m1.1e">→</annotation></semantics></math>En and Ro<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS3.12.12.m2.1"><semantics id="S4.SS3.12.12.m2.1b"><mo id="S4.SS3.12.12.m2.1.1" stretchy="false" xref="S4.SS3.12.12.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.12.12.m2.1c"><ci id="S4.SS3.12.12.m2.1.1.cmml" xref="S4.SS3.12.12.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.12.12.m2.1d">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.12.12.m2.1e">→</annotation></semantics></math>En IIMT tasks.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<section class="ltx_subsection ltx_figure_panel" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Case Study</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S4.F4" title="Figure 4 ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">4</span></a> displays the translation results of different models on the De<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><mo id="S4.SS4.p1.1.m1.1.1" stretchy="false" xref="S4.SS4.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">→</annotation></semantics></math>En dataset. We can observe that Translatotron-V generates the correct target image, while the strongest baseline model OCR+MT+T2I missing partial strokes for the word “<span class="ltx_text ltx_font_italic" id="S4.SS4.p1.1.1">you</span>” in the generated images. Besides, Pixel-level Transformer has issues like character omission and artifacts, making it unable to generate correct words. This result reveals that image tokenizer is important for the Translatotron-V.</p>
</div>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>The Effectiveness on Alleviating Error Propagation</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">To further investigate the impact of error propagation, we divide the test set of the De<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><mo id="S4.SS5.p1.1.m1.1.1" stretchy="false" xref="S4.SS5.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><ci id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">→</annotation></semantics></math>En dataset into different groups based on the Word Error Rate (WER) of OCR. The higher WER indicates that the image is more difficult to deal with, where potential error propagation is more severe. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S4.F5" title="Figure 5 ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">5</span></a>, the improvements of Translatotron-V over OCR+MT+T2I are more significant with the increase of WER. Thus, we confirm again that our end-to-end model has the potential advantage of alleviating error propagation.</p>
</div>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Evaluation on Other Language Pairs</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.2">In order to further validate the effectiveness of Translatotron-V, we conduct experiments on two distinct language pairs: French to English (Fr<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS6.p1.1.m1.1"><semantics id="S4.SS6.p1.1.m1.1a"><mo id="S4.SS6.p1.1.m1.1.1" stretchy="false" xref="S4.SS6.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><ci id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.1.m1.1d">→</annotation></semantics></math>En) and Romanian to English (Ro<math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS6.p1.2.m2.1"><semantics id="S4.SS6.p1.2.m2.1a"><mo id="S4.SS6.p1.2.m2.1.1" stretchy="false" xref="S4.SS6.p1.2.m2.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.m2.1b"><ci id="S4.SS6.p1.2.m2.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.2.m2.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.2.m2.1d">→</annotation></semantics></math>En). We also use the previously-described data synthesis method to convert the IWSLT17 Fr-En and Ro-En datasets <cite class="ltx_cite ltx_citemacro_cite">Cettolo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib3" title="">2017</a>)</cite> into IIMT datasets. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#S4.SS3" title="4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">4.3</span></a>, Translatotron-V still achieves competitive performance compared to cascaded models and significantly outperforms the Pixel-level Transformer across different language pairs.</p>
</div>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this work, we have proposed Translatotron-V, which is the first end-to-end IIMT model capable of generating RGB images and achieving comparable performance to the cascaded model with only 70.9% of parameters. In addition to an image encoder and an image decoder, Translatotron-V is equipped with a target text decoder and an image tokenizer, which are used to alleviate the modeling burden and prevent the model from directly predicting pixels, respectively. Moreover, we present a two-stage training framework to assist the model in learning alignment across modalities and languages. Furthermore, we introduce an evaluation metric, Structure-BLEU, which considers text location information to evaluate the quality of translations within the image. Experimental results demonstrate the effectiveness of our proposed model and training framework.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">In the future, we are interested in training models using only parallel images, which is important when texts within the image are not available.</p>
</div>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Limitations</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">Currently, the quality of generated target images depends on the quality of the image tokenizer. However, in our experiments, we find that it sometimes generates incorrect words, which may be due to its training using only images without explicitly considering linguistic information. Meanwhile, Translatotron-V does not exhibit a speed advantage over the cascaded model. This is due to the reason that visual token sequences are still much longer than text sequences, and both cascaded and end-to-end models need to spend most of their time decoding the image. A promising direction is to find coarser visual tokens with a shorter sequence length without degrading the quality of the generated images. Furthermore, the synthetic dataset is still not realistic enough. However, acquiring IIMT data from the real world is very challenging, how to create a more realistic IIMT dataset is also an important direction.</p>
</div>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>
<div class="ltx_para" id="Sx2.p1">
<p class="ltx_p" id="Sx2.p1.1">The project was supported by
National Natural Science Foundation of China (No. 62036004, No. 62276219), and the Public Technology Service Platform Project of Xiamen (No. 3502Z20231043). We also thank the reviewers for their insightful comments.</p>
</div>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Afli and Way (2016)</span>
<span class="ltx_bibblock">
Haithem Afli and Andy Way. 2016.

</span>
<span class="ltx_bibblock">Integrating optical character recognition and machine translation of
historical documents.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">COLING workshop</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bojar et al. (2014)</span>
<span class="ltx_bibblock">
Ondřej Bojar, Christian Buck, Christian Federmann, Barry Haddow, Philipp
Koehn, Christof Monz, Matt Post, and Lucia Specia, editors. 2014.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the Ninth Workshop on Statistical Machine
Translation</em>. Association for Computational Linguistics, Baltimore, Maryland,
USA.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cettolo et al. (2017)</span>
<span class="ltx_bibblock">
Mauro Cettolo, Marcello Federico, Luisa Bentivogli, Jan Niehues, Sebastian
Stüker, Katsuhito Sudoh, Koichiro Yoshino, and Christian Federmann.
2017.

</span>
<span class="ltx_bibblock">Overview of the IWSLT 2017 evaluation campaign.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">IWSLT</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cettolo et al. (2014)</span>
<span class="ltx_bibblock">
Mauro Cettolo, Jan Niehues, Sebastian Stüker, Luisa Bentivogli, and
Marcello Federico. 2014.

</span>
<span class="ltx_bibblock">Report on the 11th IWSLT evaluation campaign.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">IWSLT</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2015)</span>
<span class="ltx_bibblock">
Jinying Chen, Huaigu Cao, and Premkumar Natarajan. 2015.

</span>
<span class="ltx_bibblock">Integrating natural language processing with image document analysis:
what we learned from two real-world applications.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Int. J. Document Anal. Recognit.</em>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020)</span>
<span class="ltx_bibblock">
Zhuo Chen, Fei Yin, Xu-Yao Zhang, Qing Yang, and Cheng-Lin Liu. 2020.

</span>
<span class="ltx_bibblock">Cross-lingual text image recognition via multi-task sequence to
sequence learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">ICPR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2021)</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, Jakob Uszkoreit, and Neil Houlsby. 2021.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at
scale.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">ICLR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al. (2011)</span>
<span class="ltx_bibblock">
Jun Du, Qiang Huo, Lei Sun, and Jian Sun. 2011.

</span>
<span class="ltx_bibblock">Snap and translate using windows phone.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">ICDAR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elliott et al. (2016)</span>
<span class="ltx_bibblock">
Desmond Elliott, Stella Frank, Khalil Sima’an, and Lucia Specia. 2016.

</span>
<span class="ltx_bibblock">Multi30k: Multilingual english-german image descriptions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">ACL</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodfellow et al. (2014)</span>
<span class="ltx_bibblock">
Ian J. Goodfellow, Yaroslav Bulatov, Julian Ibarz, Sacha Arnoud, and Vinay D.
Shet. 2014.

</span>
<span class="ltx_bibblock">Multi-digit number recognition from street view imagery using deep
convolutional neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">ICLR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2018)</span>
<span class="ltx_bibblock">
Jiatao Gu, James Bradbury, Caiming Xiong, Victor O. K. Li, and Richard Socher.
2018.

</span>
<span class="ltx_bibblock">Non-autoregressive neural machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">ICLR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. 2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">CVPR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jia et al. (2019)</span>
<span class="ltx_bibblock">
Ye Jia, Ron J. Weiss, Fadi Biadsy, Wolfgang Macherey, Melvin Johnson, Zhifeng
Chen, and Yonghui Wu. 2019.

</span>
<span class="ltx_bibblock">Direct speech-to-speech translation with a sequence-to-sequence
model.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Interspeech</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang et al. (2023)</span>
<span class="ltx_bibblock">
Liyan Kang, Luyang Huang, Ningxin Peng, Peihao Zhu, Zewei Sun, Shanbo Cheng,
Mingxuan Wang, Degen Huang, and Jinsong Su. 2023.

</span>
<span class="ltx_bibblock">Bigvideo: A large-scale video subtitle translation dataset for
multimodal machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">ACL Findings</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lan et al. (2023)</span>
<span class="ltx_bibblock">
Zhibin Lan, Jiawei Yu, Xiang Li, Wen Zhang, Jian Luan, Bin Wang, Degen Huang,
and Jinsong Su. 2023.

</span>
<span class="ltx_bibblock">Exploring better text image translation with multimodal codebook.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">ACL</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Minghao Li, Tengchao Lv, Jingye Chen, Lei Cui, Yijuan Lu, Dinei A. F.
Florêncio, Cha Zhang, Zhoujun Li, and Furu Wei. 2023.

</span>
<span class="ltx_bibblock">Trocr: Transformer-based optical character recognition with
pre-trained models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">AAAI</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2020)</span>
<span class="ltx_bibblock">
Huan Lin, Fandong Meng, Jinsong Su, Yongjing Yin, Zhengyuan Yang, Yubin Ge, Jie
Zhou, and Jiebo Luo. 2020.

</span>
<span class="ltx_bibblock">Dynamic context-guided capsule network for multimodal machine
translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">ACMMM</em>, pages 1320–1329.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2019)</span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter. 2019.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">ICLR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2022)</span>
<span class="ltx_bibblock">
Cong Ma, Yaping Zhang, Mei Tu, Xu Han, Linghui Wu, Yang Zhao, and Yu Zhou.
2022.

</span>
<span class="ltx_bibblock">Improving end-to-end text image translation from the auxiliary text
translation task.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">ICPR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2023a)</span>
<span class="ltx_bibblock">
Cong Ma, Yaping Zhang, Mei Tu, Yang Zhao, Yu Zhou, and Chengqing Zong.
2023a.

</span>
<span class="ltx_bibblock">CCIM: cross-modal cross-lingual interactive image translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">EMNLP Findings</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2023b)</span>
<span class="ltx_bibblock">
Cong Ma, Yaping Zhang, Mei Tu, Yang Zhao, Yu Zhou, and Chengqing Zong.
2023b.

</span>
<span class="ltx_bibblock">E2TIMT: efficient and effective modal adapter for text image
machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">ICDAR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2023c)</span>
<span class="ltx_bibblock">
Cong Ma, Yaping Zhang, Mei Tu, Yang Zhao, Yu Zhou, and Chengqing Zong.
2023c.

</span>
<span class="ltx_bibblock">Multi-teacher knowledge distillation for end-to-end text image
machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">ICDAR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mansimov et al. (2020)</span>
<span class="ltx_bibblock">
Elman Mansimov, Mitchell Stern, Mia Xu Chen, Orhan Firat, Jakob Uszkoreit, and
Puneet Jain. 2020.

</span>
<span class="ltx_bibblock">Towards end-to-end in-image neural machine translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">CoRR</em>, abs/2010.10648.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Papineni et al. (2002)</span>
<span class="ltx_bibblock">
Kishore Papineni, Salim Roukos, Todd Ward, and Wei-Jing Zhu. 2002.

</span>
<span class="ltx_bibblock">Bleu: a method for automatic evaluation of machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">ACL</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Post (2018)</span>
<span class="ltx_bibblock">
Matt Post. 2018.

</span>
<span class="ltx_bibblock">A call for clarity in reporting BLEU scores.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">WMT</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramesh et al. (2021)</span>
<span class="ltx_bibblock">
Aditya Ramesh, Mikhail Pavlov, Gabriel Goh, Scott Gray, Chelsea Voss, Alec
Radford, Mark Chen, and Ilya Sutskever. 2021.

</span>
<span class="ltx_bibblock">Zero-shot text-to-image generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">ICML</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Salesky et al. (2021)</span>
<span class="ltx_bibblock">
Elizabeth Salesky, David Etter, and Matt Post. 2021.

</span>
<span class="ltx_bibblock">Robust open-vocabulary translation from visual text representations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">EMNLP</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. (2021a)</span>
<span class="ltx_bibblock">
Jinsong Su, Jinchang Chen, Hui Jiang, Chulun Zhou, Huan Lin, Yubin Ge,
Qingqiang Wu, and Yongxuan Lai. 2021a.

</span>
<span class="ltx_bibblock">Multi-modal neural machine translation with deep semantic
interactions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Inf. Sci.</em>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. (2021b)</span>
<span class="ltx_bibblock">
Tonghua Su, Shuchen Liu, and Shengjie Zhou. 2021b.

</span>
<span class="ltx_bibblock">Rtnet: An end-to-end method for handwritten text image translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">ICDAR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Susladkar et al. (2023)</span>
<span class="ltx_bibblock">
Onkar Susladkar, Prajwal Gatti, and Anand Mishra. 2023.

</span>
<span class="ltx_bibblock">Towards scene-text to scene-text translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">CoRR</em>, abs/2308.03024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al. (2023)</span>
<span class="ltx_bibblock">
Yanzhi Tian, Xiang Li, Zeming Liu, Yuhang Guo, and Bin Wang. 2023.

</span>
<span class="ltx_bibblock">In-image neural machine translation with segmented pixel
sequence-to-sequence model.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">EMNLP Findings</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van den Oord et al. (2017)</span>
<span class="ltx_bibblock">
Aäron van den Oord, Oriol Vinyals, and Koray Kavukcuoglu. 2017.

</span>
<span class="ltx_bibblock">Neural discrete representation learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">NeurIPS</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">NeurIPS</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Qiang Wang, Bei Li, Tong Xiao, Jingbo Zhu, Changliang Li, Derek F. Wong, and
Lidia S. Chao. 2019.

</span>
<span class="ltx_bibblock">Learning deep transformer models for machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">ACL</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2004)</span>
<span class="ltx_bibblock">
Zhou Wang, Alan C. Bovik, Hamid R. Sheikh, and Eero P. Simoncelli. 2004.

</span>
<span class="ltx_bibblock">Image quality assessment: from error visibility to structural
similarity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">IEEE Trans. Image Process.</em>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Watanabe et al. (1998)</span>
<span class="ltx_bibblock">
Yasuhiko Watanabe, Yoshihiro Okada, Yeun-Bae Kim, and Tetsuya Takeda. 1998.

</span>
<span class="ltx_bibblock">Translation camera.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">ICPR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2021)</span>
<span class="ltx_bibblock">
Kan Wu, Houwen Peng, Minghao Chen, Jianlong Fu, and Hongyang Chao. 2021.

</span>
<span class="ltx_bibblock">Rethinking and improving relative position encoding for vision
transformer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">ICCV</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2002)</span>
<span class="ltx_bibblock">
Jie Yang, Xilin Chen, Jing Zhang, Ying Zhang, and Alex Waibel. 2002.

</span>
<span class="ltx_bibblock">Automatic detection and translation of text from natural scenes.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">ICASSP</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2020)</span>
<span class="ltx_bibblock">
Yongjing Yin, Fandong Meng, Jinsong Su, Chulun Zhou, Zhengyuan Yang, Jie Zhou,
and Jiebo Luo. 2020.

</span>
<span class="ltx_bibblock">A novel graph-based multi-modal fusion encoder for neural machine
translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">ACL</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al. (2023)</span>
<span class="ltx_bibblock">
Yongjing Yin, Jiali Zeng, Jinsong Su, Chulun Zhou, Fandong Meng, Jie Zhou,
Degen Huang, and Jiebo Luo. 2023.

</span>
<span class="ltx_bibblock">Multi-modal graph contrastive encoding for neural machine
translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Artif. Intell.</em>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022a)</span>
<span class="ltx_bibblock">
Jiahui Yu, Xin Li, Jing Yu Koh, Han Zhang, Ruoming Pang, James Qin, Alexander
Ku, Yuanzhong Xu, Jason Baldridge, and Yonghui Wu. 2022a.

</span>
<span class="ltx_bibblock">Vector-quantized image modeling with improved VQGAN.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">ICLR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022b)</span>
<span class="ltx_bibblock">
Jiahui Yu, Yuanzhong Xu, Jing Yu Koh, Thang Luong, Gunjan Baid, Zirui Wang,
Vijay Vasudevan, Alexander Ku, Yinfei Yang, Burcu Karagol Ayan, Ben
Hutchinson, Wei Han, Zarana Parekh, Xin Li, Han Zhang, Jason Baldridge, and
Yonghui Wu. 2022b.

</span>
<span class="ltx_bibblock">Scaling autoregressive models for content-rich text-to-image
generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Trans. Mach. Learn. Res.</em>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2016)</span>
<span class="ltx_bibblock">
Biao Zhang, Deyi Xiong, Jinsong Su, Hong Duan, and Min Zhang. 2016.

</span>
<span class="ltx_bibblock">Variational neural machine translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">EMNLP</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2023)</span>
<span class="ltx_bibblock">
Shaolin Zhu, Shangjie Li, Yikun Lei, and Deyi Xiong. 2023.

</span>
<span class="ltx_bibblock">PEIT: bridging the modality gap with pre-trained models for
end-to-end image translation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">ACL</em>.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>The effectiveness of the training objective with balancing coefficients</h2>
<figure class="ltx_figure" id="A1.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="441" id="A1.F6.g1" src="extracted/5707577/figures/loss_weight.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>BLEU scores with different loss function coefficients.</figcaption>
</figure>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.7">To explore the impact of different weights of auxiliary task losses on model performance, we modify the training objective at the second stage as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{2}=\mathcal{L}_{iimt}+\alpha\mathcal{L}_{ocr}+\beta\mathcal{L}_{%
tit}+\gamma\mathcal{L}_{kd}." class="ltx_Math" display="block" id="A1.E18.m1.1"><semantics id="A1.E18.m1.1a"><mrow id="A1.E18.m1.1.1.1" xref="A1.E18.m1.1.1.1.1.cmml"><mrow id="A1.E18.m1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.cmml"><msub id="A1.E18.m1.1.1.1.1.2" xref="A1.E18.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E18.m1.1.1.1.1.2.2" xref="A1.E18.m1.1.1.1.1.2.2.cmml">ℒ</mi><mn id="A1.E18.m1.1.1.1.1.2.3" xref="A1.E18.m1.1.1.1.1.2.3.cmml">2</mn></msub><mo id="A1.E18.m1.1.1.1.1.1" xref="A1.E18.m1.1.1.1.1.1.cmml">=</mo><mrow id="A1.E18.m1.1.1.1.1.3" xref="A1.E18.m1.1.1.1.1.3.cmml"><msub id="A1.E18.m1.1.1.1.1.3.2" xref="A1.E18.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E18.m1.1.1.1.1.3.2.2" xref="A1.E18.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="A1.E18.m1.1.1.1.1.3.2.3" xref="A1.E18.m1.1.1.1.1.3.2.3.cmml"><mi id="A1.E18.m1.1.1.1.1.3.2.3.2" xref="A1.E18.m1.1.1.1.1.3.2.3.2.cmml">i</mi><mo id="A1.E18.m1.1.1.1.1.3.2.3.1" xref="A1.E18.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="A1.E18.m1.1.1.1.1.3.2.3.3" xref="A1.E18.m1.1.1.1.1.3.2.3.3.cmml">i</mi><mo id="A1.E18.m1.1.1.1.1.3.2.3.1a" xref="A1.E18.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="A1.E18.m1.1.1.1.1.3.2.3.4" xref="A1.E18.m1.1.1.1.1.3.2.3.4.cmml">m</mi><mo id="A1.E18.m1.1.1.1.1.3.2.3.1b" xref="A1.E18.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="A1.E18.m1.1.1.1.1.3.2.3.5" xref="A1.E18.m1.1.1.1.1.3.2.3.5.cmml">t</mi></mrow></msub><mo id="A1.E18.m1.1.1.1.1.3.1" xref="A1.E18.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="A1.E18.m1.1.1.1.1.3.3" xref="A1.E18.m1.1.1.1.1.3.3.cmml"><mi id="A1.E18.m1.1.1.1.1.3.3.2" xref="A1.E18.m1.1.1.1.1.3.3.2.cmml">α</mi><mo id="A1.E18.m1.1.1.1.1.3.3.1" xref="A1.E18.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="A1.E18.m1.1.1.1.1.3.3.3" xref="A1.E18.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E18.m1.1.1.1.1.3.3.3.2" xref="A1.E18.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="A1.E18.m1.1.1.1.1.3.3.3.3" xref="A1.E18.m1.1.1.1.1.3.3.3.3.cmml"><mi id="A1.E18.m1.1.1.1.1.3.3.3.3.2" xref="A1.E18.m1.1.1.1.1.3.3.3.3.2.cmml">o</mi><mo id="A1.E18.m1.1.1.1.1.3.3.3.3.1" xref="A1.E18.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="A1.E18.m1.1.1.1.1.3.3.3.3.3" xref="A1.E18.m1.1.1.1.1.3.3.3.3.3.cmml">c</mi><mo id="A1.E18.m1.1.1.1.1.3.3.3.3.1a" xref="A1.E18.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="A1.E18.m1.1.1.1.1.3.3.3.3.4" xref="A1.E18.m1.1.1.1.1.3.3.3.3.4.cmml">r</mi></mrow></msub></mrow><mo id="A1.E18.m1.1.1.1.1.3.1a" xref="A1.E18.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="A1.E18.m1.1.1.1.1.3.4" xref="A1.E18.m1.1.1.1.1.3.4.cmml"><mi id="A1.E18.m1.1.1.1.1.3.4.2" xref="A1.E18.m1.1.1.1.1.3.4.2.cmml">β</mi><mo id="A1.E18.m1.1.1.1.1.3.4.1" xref="A1.E18.m1.1.1.1.1.3.4.1.cmml">⁢</mo><msub id="A1.E18.m1.1.1.1.1.3.4.3" xref="A1.E18.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E18.m1.1.1.1.1.3.4.3.2" xref="A1.E18.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mrow id="A1.E18.m1.1.1.1.1.3.4.3.3" xref="A1.E18.m1.1.1.1.1.3.4.3.3.cmml"><mi id="A1.E18.m1.1.1.1.1.3.4.3.3.2" xref="A1.E18.m1.1.1.1.1.3.4.3.3.2.cmml">t</mi><mo id="A1.E18.m1.1.1.1.1.3.4.3.3.1" xref="A1.E18.m1.1.1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="A1.E18.m1.1.1.1.1.3.4.3.3.3" xref="A1.E18.m1.1.1.1.1.3.4.3.3.3.cmml">i</mi><mo id="A1.E18.m1.1.1.1.1.3.4.3.3.1a" xref="A1.E18.m1.1.1.1.1.3.4.3.3.1.cmml">⁢</mo><mi id="A1.E18.m1.1.1.1.1.3.4.3.3.4" xref="A1.E18.m1.1.1.1.1.3.4.3.3.4.cmml">t</mi></mrow></msub></mrow><mo id="A1.E18.m1.1.1.1.1.3.1b" xref="A1.E18.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="A1.E18.m1.1.1.1.1.3.5" xref="A1.E18.m1.1.1.1.1.3.5.cmml"><mi id="A1.E18.m1.1.1.1.1.3.5.2" xref="A1.E18.m1.1.1.1.1.3.5.2.cmml">γ</mi><mo id="A1.E18.m1.1.1.1.1.3.5.1" xref="A1.E18.m1.1.1.1.1.3.5.1.cmml">⁢</mo><msub id="A1.E18.m1.1.1.1.1.3.5.3" xref="A1.E18.m1.1.1.1.1.3.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E18.m1.1.1.1.1.3.5.3.2" xref="A1.E18.m1.1.1.1.1.3.5.3.2.cmml">ℒ</mi><mrow id="A1.E18.m1.1.1.1.1.3.5.3.3" xref="A1.E18.m1.1.1.1.1.3.5.3.3.cmml"><mi id="A1.E18.m1.1.1.1.1.3.5.3.3.2" xref="A1.E18.m1.1.1.1.1.3.5.3.3.2.cmml">k</mi><mo id="A1.E18.m1.1.1.1.1.3.5.3.3.1" xref="A1.E18.m1.1.1.1.1.3.5.3.3.1.cmml">⁢</mo><mi id="A1.E18.m1.1.1.1.1.3.5.3.3.3" xref="A1.E18.m1.1.1.1.1.3.5.3.3.3.cmml">d</mi></mrow></msub></mrow></mrow></mrow><mo id="A1.E18.m1.1.1.1.2" lspace="0em" xref="A1.E18.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E18.m1.1b"><apply id="A1.E18.m1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1"><eq id="A1.E18.m1.1.1.1.1.1.cmml" xref="A1.E18.m1.1.1.1.1.1"></eq><apply id="A1.E18.m1.1.1.1.1.2.cmml" xref="A1.E18.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E18.m1.1.1.1.1.2.1.cmml" xref="A1.E18.m1.1.1.1.1.2">subscript</csymbol><ci id="A1.E18.m1.1.1.1.1.2.2.cmml" xref="A1.E18.m1.1.1.1.1.2.2">ℒ</ci><cn id="A1.E18.m1.1.1.1.1.2.3.cmml" type="integer" xref="A1.E18.m1.1.1.1.1.2.3">2</cn></apply><apply id="A1.E18.m1.1.1.1.1.3.cmml" xref="A1.E18.m1.1.1.1.1.3"><plus id="A1.E18.m1.1.1.1.1.3.1.cmml" xref="A1.E18.m1.1.1.1.1.3.1"></plus><apply id="A1.E18.m1.1.1.1.1.3.2.cmml" xref="A1.E18.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E18.m1.1.1.1.1.3.2.1.cmml" xref="A1.E18.m1.1.1.1.1.3.2">subscript</csymbol><ci id="A1.E18.m1.1.1.1.1.3.2.2.cmml" xref="A1.E18.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="A1.E18.m1.1.1.1.1.3.2.3.cmml" xref="A1.E18.m1.1.1.1.1.3.2.3"><times id="A1.E18.m1.1.1.1.1.3.2.3.1.cmml" xref="A1.E18.m1.1.1.1.1.3.2.3.1"></times><ci id="A1.E18.m1.1.1.1.1.3.2.3.2.cmml" xref="A1.E18.m1.1.1.1.1.3.2.3.2">𝑖</ci><ci id="A1.E18.m1.1.1.1.1.3.2.3.3.cmml" xref="A1.E18.m1.1.1.1.1.3.2.3.3">𝑖</ci><ci id="A1.E18.m1.1.1.1.1.3.2.3.4.cmml" xref="A1.E18.m1.1.1.1.1.3.2.3.4">𝑚</ci><ci id="A1.E18.m1.1.1.1.1.3.2.3.5.cmml" xref="A1.E18.m1.1.1.1.1.3.2.3.5">𝑡</ci></apply></apply><apply id="A1.E18.m1.1.1.1.1.3.3.cmml" xref="A1.E18.m1.1.1.1.1.3.3"><times id="A1.E18.m1.1.1.1.1.3.3.1.cmml" xref="A1.E18.m1.1.1.1.1.3.3.1"></times><ci id="A1.E18.m1.1.1.1.1.3.3.2.cmml" xref="A1.E18.m1.1.1.1.1.3.3.2">𝛼</ci><apply id="A1.E18.m1.1.1.1.1.3.3.3.cmml" xref="A1.E18.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E18.m1.1.1.1.1.3.3.3.1.cmml" xref="A1.E18.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A1.E18.m1.1.1.1.1.3.3.3.2.cmml" xref="A1.E18.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="A1.E18.m1.1.1.1.1.3.3.3.3.cmml" xref="A1.E18.m1.1.1.1.1.3.3.3.3"><times id="A1.E18.m1.1.1.1.1.3.3.3.3.1.cmml" xref="A1.E18.m1.1.1.1.1.3.3.3.3.1"></times><ci id="A1.E18.m1.1.1.1.1.3.3.3.3.2.cmml" xref="A1.E18.m1.1.1.1.1.3.3.3.3.2">𝑜</ci><ci id="A1.E18.m1.1.1.1.1.3.3.3.3.3.cmml" xref="A1.E18.m1.1.1.1.1.3.3.3.3.3">𝑐</ci><ci id="A1.E18.m1.1.1.1.1.3.3.3.3.4.cmml" xref="A1.E18.m1.1.1.1.1.3.3.3.3.4">𝑟</ci></apply></apply></apply><apply id="A1.E18.m1.1.1.1.1.3.4.cmml" xref="A1.E18.m1.1.1.1.1.3.4"><times id="A1.E18.m1.1.1.1.1.3.4.1.cmml" xref="A1.E18.m1.1.1.1.1.3.4.1"></times><ci id="A1.E18.m1.1.1.1.1.3.4.2.cmml" xref="A1.E18.m1.1.1.1.1.3.4.2">𝛽</ci><apply id="A1.E18.m1.1.1.1.1.3.4.3.cmml" xref="A1.E18.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="A1.E18.m1.1.1.1.1.3.4.3.1.cmml" xref="A1.E18.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="A1.E18.m1.1.1.1.1.3.4.3.2.cmml" xref="A1.E18.m1.1.1.1.1.3.4.3.2">ℒ</ci><apply id="A1.E18.m1.1.1.1.1.3.4.3.3.cmml" xref="A1.E18.m1.1.1.1.1.3.4.3.3"><times id="A1.E18.m1.1.1.1.1.3.4.3.3.1.cmml" xref="A1.E18.m1.1.1.1.1.3.4.3.3.1"></times><ci id="A1.E18.m1.1.1.1.1.3.4.3.3.2.cmml" xref="A1.E18.m1.1.1.1.1.3.4.3.3.2">𝑡</ci><ci id="A1.E18.m1.1.1.1.1.3.4.3.3.3.cmml" xref="A1.E18.m1.1.1.1.1.3.4.3.3.3">𝑖</ci><ci id="A1.E18.m1.1.1.1.1.3.4.3.3.4.cmml" xref="A1.E18.m1.1.1.1.1.3.4.3.3.4">𝑡</ci></apply></apply></apply><apply id="A1.E18.m1.1.1.1.1.3.5.cmml" xref="A1.E18.m1.1.1.1.1.3.5"><times id="A1.E18.m1.1.1.1.1.3.5.1.cmml" xref="A1.E18.m1.1.1.1.1.3.5.1"></times><ci id="A1.E18.m1.1.1.1.1.3.5.2.cmml" xref="A1.E18.m1.1.1.1.1.3.5.2">𝛾</ci><apply id="A1.E18.m1.1.1.1.1.3.5.3.cmml" xref="A1.E18.m1.1.1.1.1.3.5.3"><csymbol cd="ambiguous" id="A1.E18.m1.1.1.1.1.3.5.3.1.cmml" xref="A1.E18.m1.1.1.1.1.3.5.3">subscript</csymbol><ci id="A1.E18.m1.1.1.1.1.3.5.3.2.cmml" xref="A1.E18.m1.1.1.1.1.3.5.3.2">ℒ</ci><apply id="A1.E18.m1.1.1.1.1.3.5.3.3.cmml" xref="A1.E18.m1.1.1.1.1.3.5.3.3"><times id="A1.E18.m1.1.1.1.1.3.5.3.3.1.cmml" xref="A1.E18.m1.1.1.1.1.3.5.3.3.1"></times><ci id="A1.E18.m1.1.1.1.1.3.5.3.3.2.cmml" xref="A1.E18.m1.1.1.1.1.3.5.3.3.2">𝑘</ci><ci id="A1.E18.m1.1.1.1.1.3.5.3.3.3.cmml" xref="A1.E18.m1.1.1.1.1.3.5.3.3.3">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E18.m1.1c">\mathcal{L}_{2}=\mathcal{L}_{iimt}+\alpha\mathcal{L}_{ocr}+\beta\mathcal{L}_{%
tit}+\gamma\mathcal{L}_{kd}.</annotation><annotation encoding="application/x-llamapun" id="A1.E18.m1.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_i italic_i italic_m italic_t end_POSTSUBSCRIPT + italic_α caligraphic_L start_POSTSUBSCRIPT italic_o italic_c italic_r end_POSTSUBSCRIPT + italic_β caligraphic_L start_POSTSUBSCRIPT italic_t italic_i italic_t end_POSTSUBSCRIPT + italic_γ caligraphic_L start_POSTSUBSCRIPT italic_k italic_d end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p1.6">where <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.p1.1.m1.1"><semantics id="A1.p1.1.m1.1a"><mi id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><ci id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">italic_α</annotation></semantics></math>, <math alttext="\beta" class="ltx_Math" display="inline" id="A1.p1.2.m2.1"><semantics id="A1.p1.2.m2.1a"><mi id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><ci id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.p1.2.m2.1d">italic_β</annotation></semantics></math>, and <math alttext="\gamma" class="ltx_Math" display="inline" id="A1.p1.3.m3.1"><semantics id="A1.p1.3.m3.1a"><mi id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><ci id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="A1.p1.3.m3.1d">italic_γ</annotation></semantics></math> are the coefficient to control OCR auxiliary task loss <math alttext="\mathcal{L}_{ocr}" class="ltx_Math" display="inline" id="A1.p1.4.m4.1"><semantics id="A1.p1.4.m4.1a"><msub id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.4.m4.1.1.2" xref="A1.p1.4.m4.1.1.2.cmml">ℒ</mi><mrow id="A1.p1.4.m4.1.1.3" xref="A1.p1.4.m4.1.1.3.cmml"><mi id="A1.p1.4.m4.1.1.3.2" xref="A1.p1.4.m4.1.1.3.2.cmml">o</mi><mo id="A1.p1.4.m4.1.1.3.1" xref="A1.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A1.p1.4.m4.1.1.3.3" xref="A1.p1.4.m4.1.1.3.3.cmml">c</mi><mo id="A1.p1.4.m4.1.1.3.1a" xref="A1.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A1.p1.4.m4.1.1.3.4" xref="A1.p1.4.m4.1.1.3.4.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b"><apply id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.p1.4.m4.1.1.1.cmml" xref="A1.p1.4.m4.1.1">subscript</csymbol><ci id="A1.p1.4.m4.1.1.2.cmml" xref="A1.p1.4.m4.1.1.2">ℒ</ci><apply id="A1.p1.4.m4.1.1.3.cmml" xref="A1.p1.4.m4.1.1.3"><times id="A1.p1.4.m4.1.1.3.1.cmml" xref="A1.p1.4.m4.1.1.3.1"></times><ci id="A1.p1.4.m4.1.1.3.2.cmml" xref="A1.p1.4.m4.1.1.3.2">𝑜</ci><ci id="A1.p1.4.m4.1.1.3.3.cmml" xref="A1.p1.4.m4.1.1.3.3">𝑐</ci><ci id="A1.p1.4.m4.1.1.3.4.cmml" xref="A1.p1.4.m4.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">\mathcal{L}_{ocr}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT italic_o italic_c italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, TIT auxiliary task loss <math alttext="\mathcal{L}_{tit}" class="ltx_Math" display="inline" id="A1.p1.5.m5.1"><semantics id="A1.p1.5.m5.1a"><msub id="A1.p1.5.m5.1.1" xref="A1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.5.m5.1.1.2" xref="A1.p1.5.m5.1.1.2.cmml">ℒ</mi><mrow id="A1.p1.5.m5.1.1.3" xref="A1.p1.5.m5.1.1.3.cmml"><mi id="A1.p1.5.m5.1.1.3.2" xref="A1.p1.5.m5.1.1.3.2.cmml">t</mi><mo id="A1.p1.5.m5.1.1.3.1" xref="A1.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="A1.p1.5.m5.1.1.3.3" xref="A1.p1.5.m5.1.1.3.3.cmml">i</mi><mo id="A1.p1.5.m5.1.1.3.1a" xref="A1.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="A1.p1.5.m5.1.1.3.4" xref="A1.p1.5.m5.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.p1.5.m5.1b"><apply id="A1.p1.5.m5.1.1.cmml" xref="A1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.p1.5.m5.1.1.1.cmml" xref="A1.p1.5.m5.1.1">subscript</csymbol><ci id="A1.p1.5.m5.1.1.2.cmml" xref="A1.p1.5.m5.1.1.2">ℒ</ci><apply id="A1.p1.5.m5.1.1.3.cmml" xref="A1.p1.5.m5.1.1.3"><times id="A1.p1.5.m5.1.1.3.1.cmml" xref="A1.p1.5.m5.1.1.3.1"></times><ci id="A1.p1.5.m5.1.1.3.2.cmml" xref="A1.p1.5.m5.1.1.3.2">𝑡</ci><ci id="A1.p1.5.m5.1.1.3.3.cmml" xref="A1.p1.5.m5.1.1.3.3">𝑖</ci><ci id="A1.p1.5.m5.1.1.3.4.cmml" xref="A1.p1.5.m5.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m5.1c">\mathcal{L}_{tit}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.5.m5.1d">caligraphic_L start_POSTSUBSCRIPT italic_t italic_i italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and knowledge distillation loss <math alttext="\mathcal{L}_{kd}" class="ltx_Math" display="inline" id="A1.p1.6.m6.1"><semantics id="A1.p1.6.m6.1a"><msub id="A1.p1.6.m6.1.1" xref="A1.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.p1.6.m6.1.1.2" xref="A1.p1.6.m6.1.1.2.cmml">ℒ</mi><mrow id="A1.p1.6.m6.1.1.3" xref="A1.p1.6.m6.1.1.3.cmml"><mi id="A1.p1.6.m6.1.1.3.2" xref="A1.p1.6.m6.1.1.3.2.cmml">k</mi><mo id="A1.p1.6.m6.1.1.3.1" xref="A1.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="A1.p1.6.m6.1.1.3.3" xref="A1.p1.6.m6.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.p1.6.m6.1b"><apply id="A1.p1.6.m6.1.1.cmml" xref="A1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A1.p1.6.m6.1.1.1.cmml" xref="A1.p1.6.m6.1.1">subscript</csymbol><ci id="A1.p1.6.m6.1.1.2.cmml" xref="A1.p1.6.m6.1.1.2">ℒ</ci><apply id="A1.p1.6.m6.1.1.3.cmml" xref="A1.p1.6.m6.1.1.3"><times id="A1.p1.6.m6.1.1.3.1.cmml" xref="A1.p1.6.m6.1.1.3.1"></times><ci id="A1.p1.6.m6.1.1.3.2.cmml" xref="A1.p1.6.m6.1.1.3.2">𝑘</ci><ci id="A1.p1.6.m6.1.1.3.3.cmml" xref="A1.p1.6.m6.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.6.m6.1c">\mathcal{L}_{kd}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.6.m6.1d">caligraphic_L start_POSTSUBSCRIPT italic_k italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, respectively.</p>
</div>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.1">Due to the high cost of grid search, when adjusting a specific coefficient, all other coefficients will be set to 1. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A1.F6" title="Figure 6 ‣ Appendix A The effectiveness of the training objective with balancing coefficients ‣ Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">6</span></a>, when all coefficients are set to 1, the model performs optimally. This result suggests that these tasks may be equally important and highly correlated. Adjusting a particular coefficient could lead the model to focus more on or neglect one task, which might not be beneficial if all tasks are equally important. This also implies that our approach does not require carefully adjusting the coefficients for different training objectives.</p>
</div>
<figure class="ltx_figure" id="A1.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="382" id="A1.F7.g1" src="extracted/5707577/figures/data_example.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Several examples of our synthetic data using IWSLT14 De-En.</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="149" id="A1.F8.g1" src="extracted/5707577/figures/data_compare.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Comparison of our IIMT data with other IIMT data used in previous work <cite class="ltx_cite ltx_citemacro_cite">Mansimov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib23" title="">2020</a>); Tian et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib31" title="">2023</a>)</cite>.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Data Examples</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A1.F7" title="Figure 7 ‣ Appendix A The effectiveness of the training objective with balancing coefficients ‣ Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">7</span></a>, we present several data examples for our synthetic data. We also show the difference between our IIMT data and previous IIMT data in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A1.F8" title="Figure 8 ‣ Appendix A The effectiveness of the training objective with balancing coefficients ‣ Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">8</span></a>. It can be observed that our data is more complex than the data used in previous work.</p>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Baseline Architecture Details</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">In this section, we provide a detailed description of the architectures of two baselines: OCR+MT+T2I and TIT+T2I.</p>
</div>
<div class="ltx_para" id="A3.p2">
<p class="ltx_p" id="A3.p2.1"><span class="ltx_text ltx_font_italic" id="A3.p2.1.1">OCR+MT+T2I</span>. This baseline cascades three models: an OCR model, an MT model, and a T2I model.
First, we follow <cite class="ltx_cite ltx_citemacro_citeauthor"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib16" title="">Li et al.</a></cite> (<cite class="ltx_cite ltx_citemacro_citeyear"><a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib16" title="">2023</a></cite>) to construct the OCR model, which consists of a ViT-B encoder and a Transformer decoder. The decoder uses the settings of Transformer Base, which contains 6 layers, 8 attention heads, 512-dimensional hidden states, and 2048 feed-forward hidden states. Second, we use the standard Transformer base<cite class="ltx_cite ltx_citemacro_cite">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib12" title="">2016</a>)</cite> as the architecture of the MT model. Third, the T2I Model includes a Transformer-based text encoder, a ResNet-based image encoder <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib12" title="">2016</a>)</cite>, an image decoder, and an image tokenizer. Both the text encoder and image decoder utilize the same settings as Transformer base. Additionally, the image encoder adopts the ResNet50 architecture, and the image tokenizer follows the configuration of our model.
It’s worth noting that our teacher model has the same structure as this T2I Model, except for reducing the hidden states from 512-dimensional to 384-dimensional.</p>
</div>
<div class="ltx_para" id="A3.p3">
<p class="ltx_p" id="A3.p3.1"><span class="ltx_text ltx_font_italic" id="A3.p3.1.1">TIT+T2I</span>. We construct this baseline by cascading the TIT model and the T2I model, where the TIT model consists of an image encoder, a source text decoder, and a target text decoder. The image encoder uses the same architecture as ViT-B, and the configuration of the source text decoder and target text decoder is consistent with Transformer Base.</p>
</div>
<div class="ltx_para" id="A3.p4">
<p class="ltx_p" id="A3.p4.1"><span class="ltx_text ltx_font_italic" id="A3.p4.1.1">PEIT+T2I</span>. This baseline replaces the multi-line TIT model in TIT+T2I with PEIT <cite class="ltx_cite ltx_citemacro_cite">Zhu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#bib.bib44" title="">2023</a>)</cite>. To ensure a fair comparison, we reimplement the model, scale its size to match our model, and do not use additional data during its multi-stage training.</p>
</div>
<figure class="ltx_figure" id="A3.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="199" id="A3.F9.g1" src="extracted/5707577/figures/s-bleu_vs_bleu.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Comparison of Structure-BLEU and BLEU. The bounding box of the text is drawn with red lines.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Structure-BLEU</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">In Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#alg1" title="Algorithm 1 ‣ Appendix D Structure-BLEU ‣ Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">1</span></a>, we provide the detailed calculation process of Structure-BLEU. Furthermore, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A3.F9" title="Figure 9 ‣ Appendix C Baseline Architecture Details ‣ Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">9</span></a>, we also provide an example to demonstrate the difference between Structure-BLEU and BLEU. We can observe that Structure-BLEU takes into account the positional information of the text in the generated image, which is crucial for user experience in real-world scenarios.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Structure-BLEU</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline">0:</span>  Generated image <math alttext="\hat{\mathbf{t}}" class="ltx_Math" display="inline" id="alg1.l0.m1.1"><semantics id="alg1.l0.m1.1a"><mover accent="true" id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml"><mi id="alg1.l0.m1.1.1.2" xref="alg1.l0.m1.1.1.2.cmml">𝐭</mi><mo id="alg1.l0.m1.1.1.1" xref="alg1.l0.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><apply id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1"><ci id="alg1.l0.m1.1.1.1.cmml" xref="alg1.l0.m1.1.1.1">^</ci><ci id="alg1.l0.m1.1.1.2.cmml" xref="alg1.l0.m1.1.1.2">𝐭</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">\hat{\mathbf{t}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.1d">over^ start_ARG bold_t end_ARG</annotation></semantics></math>, reference image <math alttext="\mathbf{t}" class="ltx_Math" display="inline" id="alg1.l0.m2.1"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">𝐭</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝐭</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">\mathbf{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.1d">bold_t</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math alttext="\mathcal{R}\leftarrow\text{OCR}(\mathbf{t})" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.2" xref="alg1.l1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.2.2" xref="alg1.l1.m1.1.2.2.cmml">ℛ</mi><mo id="alg1.l1.m1.1.2.1" stretchy="false" xref="alg1.l1.m1.1.2.1.cmml">←</mo><mrow id="alg1.l1.m1.1.2.3" xref="alg1.l1.m1.1.2.3.cmml"><mtext id="alg1.l1.m1.1.2.3.2" xref="alg1.l1.m1.1.2.3.2a.cmml">OCR</mtext><mo id="alg1.l1.m1.1.2.3.1" xref="alg1.l1.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l1.m1.1.2.3.3.2" xref="alg1.l1.m1.1.2.3.cmml"><mo id="alg1.l1.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l1.m1.1.2.3.cmml">(</mo><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">𝐭</mi><mo id="alg1.l1.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.2.cmml" xref="alg1.l1.m1.1.2"><ci id="alg1.l1.m1.1.2.1.cmml" xref="alg1.l1.m1.1.2.1">←</ci><ci id="alg1.l1.m1.1.2.2.cmml" xref="alg1.l1.m1.1.2.2">ℛ</ci><apply id="alg1.l1.m1.1.2.3.cmml" xref="alg1.l1.m1.1.2.3"><times id="alg1.l1.m1.1.2.3.1.cmml" xref="alg1.l1.m1.1.2.3.1"></times><ci id="alg1.l1.m1.1.2.3.2a.cmml" xref="alg1.l1.m1.1.2.3.2"><mtext id="alg1.l1.m1.1.2.3.2.cmml" xref="alg1.l1.m1.1.2.3.2">OCR</mtext></ci><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐭</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{R}\leftarrow\text{OCR}(\mathbf{t})</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">caligraphic_R ← OCR ( bold_t )</annotation></semantics></math> {Set of reference texts and bounding boxes}

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <math alttext="\mathcal{H}\leftarrow\text{OCR}(\hat{\mathbf{t}})" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.2" xref="alg1.l2.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m1.1.2.2" xref="alg1.l2.m1.1.2.2.cmml">ℋ</mi><mo id="alg1.l2.m1.1.2.1" stretchy="false" xref="alg1.l2.m1.1.2.1.cmml">←</mo><mrow id="alg1.l2.m1.1.2.3" xref="alg1.l2.m1.1.2.3.cmml"><mtext id="alg1.l2.m1.1.2.3.2" xref="alg1.l2.m1.1.2.3.2a.cmml">OCR</mtext><mo id="alg1.l2.m1.1.2.3.1" xref="alg1.l2.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l2.m1.1.2.3.3.2" xref="alg1.l2.m1.1.1.cmml"><mo id="alg1.l2.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l2.m1.1.1.cmml">(</mo><mover accent="true" id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">𝐭</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">^</mo></mover><mo id="alg1.l2.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l2.m1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.2.cmml" xref="alg1.l2.m1.1.2"><ci id="alg1.l2.m1.1.2.1.cmml" xref="alg1.l2.m1.1.2.1">←</ci><ci id="alg1.l2.m1.1.2.2.cmml" xref="alg1.l2.m1.1.2.2">ℋ</ci><apply id="alg1.l2.m1.1.2.3.cmml" xref="alg1.l2.m1.1.2.3"><times id="alg1.l2.m1.1.2.3.1.cmml" xref="alg1.l2.m1.1.2.3.1"></times><ci id="alg1.l2.m1.1.2.3.2a.cmml" xref="alg1.l2.m1.1.2.3.2"><mtext id="alg1.l2.m1.1.2.3.2.cmml" xref="alg1.l2.m1.1.2.3.2">OCR</mtext></ci><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.2.3.3.2"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">^</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝐭</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\mathcal{H}\leftarrow\text{OCR}(\hat{\mathbf{t}})</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">caligraphic_H ← OCR ( over^ start_ARG bold_t end_ARG )</annotation></semantics></math> {Set of generated texts and bounding boxes}

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <math alttext="\mathcal{M}\leftarrow\{\}" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">ℳ</mi><mo id="alg1.l3.m1.1.1.1" stretchy="false" xref="alg1.l3.m1.1.1.1.cmml">←</mo><mrow id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.cmml"><mo id="alg1.l3.m1.1.1.3.2.1" stretchy="false" xref="alg1.l3.m1.1.1.3.1.cmml">{</mo><mo id="alg1.l3.m1.1.1.3.2.2" stretchy="false" xref="alg1.l3.m1.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">ℳ</ci><list id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\mathcal{M}\leftarrow\{\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">caligraphic_M ← { }</annotation></semantics></math> {Set of matched text pairs}

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l4.1">for</span> each <math alttext="h\in\mathcal{H}" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">h</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">ℋ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><in id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></in><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">ℎ</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">h\in\mathcal{H}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_h ∈ caligraphic_H</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l4.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math alttext="m\leftarrow\text{None}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">m</mi><mo id="alg1.l5.m1.1.1.1" stretchy="false" xref="alg1.l5.m1.1.1.1.cmml">←</mo><mtext id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3a.cmml">None</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑚</ci><ci id="alg1.l5.m1.1.1.3a.cmml" xref="alg1.l5.m1.1.1.3"><mtext id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">None</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">m\leftarrow\text{None}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_m ← None</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math alttext="s\leftarrow 0" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">s</mi><mo id="alg1.l6.m1.1.1.1" stretchy="false" xref="alg1.l6.m1.1.1.1.cmml">←</mo><mn id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑠</ci><cn id="alg1.l6.m1.1.1.3.cmml" type="integer" xref="alg1.l6.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">s\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_s ← 0</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l7.1">for</span> each <math alttext="r\in\mathcal{R}" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">r</mi><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">ℛ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><in id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></in><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑟</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">ℛ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">r\in\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_r ∈ caligraphic_R</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l7.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>        <math alttext="\hat{s}\leftarrow\text{IOU}(h,r)" class="ltx_Math" display="inline" id="alg1.l8.m1.2"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.3" xref="alg1.l8.m1.2.3.cmml"><mover accent="true" id="alg1.l8.m1.2.3.2" xref="alg1.l8.m1.2.3.2.cmml"><mi id="alg1.l8.m1.2.3.2.2" xref="alg1.l8.m1.2.3.2.2.cmml">s</mi><mo id="alg1.l8.m1.2.3.2.1" xref="alg1.l8.m1.2.3.2.1.cmml">^</mo></mover><mo id="alg1.l8.m1.2.3.1" stretchy="false" xref="alg1.l8.m1.2.3.1.cmml">←</mo><mrow id="alg1.l8.m1.2.3.3" xref="alg1.l8.m1.2.3.3.cmml"><mtext id="alg1.l8.m1.2.3.3.2" xref="alg1.l8.m1.2.3.3.2a.cmml">IOU</mtext><mo id="alg1.l8.m1.2.3.3.1" xref="alg1.l8.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l8.m1.2.3.3.3.2" xref="alg1.l8.m1.2.3.3.3.1.cmml"><mo id="alg1.l8.m1.2.3.3.3.2.1" stretchy="false" xref="alg1.l8.m1.2.3.3.3.1.cmml">(</mo><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">h</mi><mo id="alg1.l8.m1.2.3.3.3.2.2" xref="alg1.l8.m1.2.3.3.3.1.cmml">,</mo><mi id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml">r</mi><mo id="alg1.l8.m1.2.3.3.3.2.3" stretchy="false" xref="alg1.l8.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.3.cmml" xref="alg1.l8.m1.2.3"><ci id="alg1.l8.m1.2.3.1.cmml" xref="alg1.l8.m1.2.3.1">←</ci><apply id="alg1.l8.m1.2.3.2.cmml" xref="alg1.l8.m1.2.3.2"><ci id="alg1.l8.m1.2.3.2.1.cmml" xref="alg1.l8.m1.2.3.2.1">^</ci><ci id="alg1.l8.m1.2.3.2.2.cmml" xref="alg1.l8.m1.2.3.2.2">𝑠</ci></apply><apply id="alg1.l8.m1.2.3.3.cmml" xref="alg1.l8.m1.2.3.3"><times id="alg1.l8.m1.2.3.3.1.cmml" xref="alg1.l8.m1.2.3.3.1"></times><ci id="alg1.l8.m1.2.3.3.2a.cmml" xref="alg1.l8.m1.2.3.3.2"><mtext id="alg1.l8.m1.2.3.3.2.cmml" xref="alg1.l8.m1.2.3.3.2">IOU</mtext></ci><interval closure="open" id="alg1.l8.m1.2.3.3.3.1.cmml" xref="alg1.l8.m1.2.3.3.3.2"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">ℎ</ci><ci id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2">𝑟</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">\hat{s}\leftarrow\text{IOU}(h,r)</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.2d">over^ start_ARG italic_s end_ARG ← IOU ( italic_h , italic_r )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>        <span class="ltx_text ltx_font_bold" id="alg1.l9.1">if</span> <math alttext="\hat{s}&gt;s" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mover accent="true" id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">s</mi><mo id="alg1.l9.m1.1.1.2.1" xref="alg1.l9.m1.1.1.2.1.cmml">^</mo></mover><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">&gt;</mo><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><gt id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></gt><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><ci id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2.1">^</ci><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑠</ci></apply><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\hat{s}&gt;s</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">over^ start_ARG italic_s end_ARG &gt; italic_s</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l9.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>           <math alttext="s\leftarrow\hat{s}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">s</mi><mo id="alg1.l10.m1.1.1.1" stretchy="false" xref="alg1.l10.m1.1.1.1.cmml">←</mo><mover accent="true" id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑠</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><ci id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1">^</ci><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">s\leftarrow\hat{s}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_s ← over^ start_ARG italic_s end_ARG</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>           <math alttext="m\leftarrow(h,r)" class="ltx_Math" display="inline" id="alg1.l11.m1.2"><semantics id="alg1.l11.m1.2a"><mrow id="alg1.l11.m1.2.3" xref="alg1.l11.m1.2.3.cmml"><mi id="alg1.l11.m1.2.3.2" xref="alg1.l11.m1.2.3.2.cmml">m</mi><mo id="alg1.l11.m1.2.3.1" stretchy="false" xref="alg1.l11.m1.2.3.1.cmml">←</mo><mrow id="alg1.l11.m1.2.3.3.2" xref="alg1.l11.m1.2.3.3.1.cmml"><mo id="alg1.l11.m1.2.3.3.2.1" stretchy="false" xref="alg1.l11.m1.2.3.3.1.cmml">(</mo><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">h</mi><mo id="alg1.l11.m1.2.3.3.2.2" xref="alg1.l11.m1.2.3.3.1.cmml">,</mo><mi id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml">r</mi><mo id="alg1.l11.m1.2.3.3.2.3" stretchy="false" xref="alg1.l11.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.2b"><apply id="alg1.l11.m1.2.3.cmml" xref="alg1.l11.m1.2.3"><ci id="alg1.l11.m1.2.3.1.cmml" xref="alg1.l11.m1.2.3.1">←</ci><ci id="alg1.l11.m1.2.3.2.cmml" xref="alg1.l11.m1.2.3.2">𝑚</ci><interval closure="open" id="alg1.l11.m1.2.3.3.1.cmml" xref="alg1.l11.m1.2.3.3.2"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">ℎ</ci><ci id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2">𝑟</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.2c">m\leftarrow(h,r)</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.2d">italic_m ← ( italic_h , italic_r )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>        <span class="ltx_text ltx_font_bold" id="alg1.l12.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l12.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l13.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l13.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l14.1">if</span> <math alttext="s\geq 0.5" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">s</mi><mo id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">≥</mo><mn id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><geq id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"></geq><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑠</ci><cn id="alg1.l14.m1.1.1.3.cmml" type="float" xref="alg1.l14.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">s\geq 0.5</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_s ≥ 0.5</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l14.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>        <math alttext="\mathcal{M}\leftarrow\mathcal{M}\cup\{m\}" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.2" xref="alg1.l15.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.1.2.2" xref="alg1.l15.m1.1.2.2.cmml">ℳ</mi><mo id="alg1.l15.m1.1.2.1" stretchy="false" xref="alg1.l15.m1.1.2.1.cmml">←</mo><mrow id="alg1.l15.m1.1.2.3" xref="alg1.l15.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.1.2.3.2" xref="alg1.l15.m1.1.2.3.2.cmml">ℳ</mi><mo id="alg1.l15.m1.1.2.3.1" xref="alg1.l15.m1.1.2.3.1.cmml">∪</mo><mrow id="alg1.l15.m1.1.2.3.3.2" xref="alg1.l15.m1.1.2.3.3.1.cmml"><mo id="alg1.l15.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l15.m1.1.2.3.3.1.cmml">{</mo><mi id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">m</mi><mo id="alg1.l15.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l15.m1.1.2.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.2.cmml" xref="alg1.l15.m1.1.2"><ci id="alg1.l15.m1.1.2.1.cmml" xref="alg1.l15.m1.1.2.1">←</ci><ci id="alg1.l15.m1.1.2.2.cmml" xref="alg1.l15.m1.1.2.2">ℳ</ci><apply id="alg1.l15.m1.1.2.3.cmml" xref="alg1.l15.m1.1.2.3"><union id="alg1.l15.m1.1.2.3.1.cmml" xref="alg1.l15.m1.1.2.3.1"></union><ci id="alg1.l15.m1.1.2.3.2.cmml" xref="alg1.l15.m1.1.2.3.2">ℳ</ci><set id="alg1.l15.m1.1.2.3.3.1.cmml" xref="alg1.l15.m1.1.2.3.3.2"><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">𝑚</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\mathcal{M}\leftarrow\mathcal{M}\cup\{m\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">caligraphic_M ← caligraphic_M ∪ { italic_m }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l16.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l16.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l17.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l17.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l18.1">return</span>  BLEU(<math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><ci id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">caligraphic_M</annotation></semantics></math>)

</div>
</div>
</figure>
<figure class="ltx_figure" id="A4.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="208" id="A4.F10.g1" src="extracted/5707577/figures/bleu_vs_ssim.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Comparison of BLEU and SSIM.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Comparison of BLEU and SSIM</h2>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">In this section, we provide examples illustrating the differences in focus between SSIM and BLEU evaluations. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.02894v1#A4.F10" title="Figure 10 ‣ Appendix D Structure-BLEU ‣ Acknowledgments ‣ Limitations ‣ 5 Conclusion ‣ 4.6 Evaluation on Other Language Pairs ‣ 4.5 The Effectiveness on Alleviating Error Propagation ‣ 4.4 Case Study ‣ 4.3 Ablation Study ‣ 4.2 Results ‣ 4.1 Setup ‣ 4 Experiments ‣ Translatotron-V(ison): An End-to-End Model for In-Image Machine Translation"><span class="ltx_text ltx_ref_tag">10</span></a>, even when the text in the generated image is substantially incorrect, SSIM still yields a relatively high score. The underlying reason is that SSIM is used to evaluate the visual similarity between the generated image and the reference image, considering aspects such as brightness, contrast, etc. It focuses not only on the image of text regions but also on the image of non-text regions. However, BLEU is employed to evaluate the fine-grained information in the image of text regions, such as the glyph of the character. The two metrics have different focuses and complement each other. Therefore, the model may perform well in generating visual information, while it may struggle with generating fine-grained text details, which will lead to a significant difference in BLEU scores but relatively close in SSIM scores.</p>
</div>
</section>
</section>
</section>
</section>
</section>
</section>
</section>
</div>
</div>
</figure>
</section>
</section>
</div>
</div>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Jul  3 07:55:12 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
