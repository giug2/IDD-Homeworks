<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1911.07164] Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition</title><meta property="og:description" content="One-shot fine-grained visual recognition often
suffers from the problem of training data scarcity for new fine-grained
classes. To alleviate this problem, an off-the-shelf image generator
can be applied to synthesize a…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1911.07164">

<!--Generated on Thu Mar  7 09:15:22 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line" lang="en">
<h1 class="ltx_title ltx_title_document">Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Satoshi Tsutsui
<br class="ltx_break">Indiana University
<br class="ltx_break">USA 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">stsutsui@indiana.edu</span> 
<br class="ltx_break">&amp;Yanwei Fu 
<br class="ltx_break">Fudan University 
<br class="ltx_break">China 
<br class="ltx_break"><span id="id2.2.id2" class="ltx_text ltx_font_typewriter">yanweifu@fudan.edu.cn</span> 
<br class="ltx_break">&amp;David Crandall 
<br class="ltx_break">Indiana University
<br class="ltx_break">USA 
<br class="ltx_break"><span id="id3.3.id3" class="ltx_text ltx_font_typewriter">djcran@indiana.edu</span> 
<br class="ltx_break">
</span><span class="ltx_author_notes">Y. Fu is with School of Data Science, and
MOE Frontiers Center for Brain Science, Shanghai Key Lab of Intelligent Information Processing, Fudan University. </span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p"><span id="id4.id1.1" class="ltx_text">One-shot fine-grained visual recognition often
suffers from the problem of training data scarcity for new fine-grained
classes. To alleviate this problem, an off-the-shelf image generator
can be applied to synthesize additional training images, but
these synthesized images are often not helpful for actually improving the accuracy of one-shot fine-grained
recognition. This paper proposes a meta-learning framework to
combine generated images with original images, so that the resulting “hybrid” training images
can improve one-shot learning. Specifically, the generic image
generator is updated by a few training instances of novel classes, and a
Meta Image Reinforcing Network (MetaIRNet) is proposed to conduct
one-shot fine-grained recognition as well as image reinforcement. The
model is trained in an end-to-end manner, and our experiments
demonstrate consistent improvement over baselines on one-shot
fine-grained image classification benchmarks.</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The availability of vast labeled datasets has been crucial for the
recent success of deep learning. However, there will always be
learning tasks for which labeled data is sparse. Fine-grained visual
recognition is one typical example: when images are to be
classified into many very specific categories (such as
species of birds), it may be difficult to obtain training examples for
rare classes, and producing the ground truth labels may require
significant expertise (e.g., ornithologists).
One-shot learning is thus very desirable for fine-grained visual recognition.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">A recent approach to address data scarcity is
meta-learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>,
which trains a parameterized function called a meta-learner that maps
labeled training sets to classifiers. The meta-learner is trained by
sampling small training and test sets from a large dataset of a base
class. Such a meta-learned model can be adapted to recognize novel
categories with a single training instance per class. Another way to
address data scarcity is to synthesize additional training examples,
for example by using off-the-shelf Generative Adversarial Networks
(GANs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. However, classifiers
trained from GAN-generated images are typically inferior to those
trained with real images, possibly because the distribution of
generated images may be biased towards frequent patterns (modes) of the original image distribution
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. This is especially true in one-shot
fine-grained recognition where a tiny difference
(e.g., beak of a bird) can make a large difference in class.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To address these issues, we develop an approach to apply
off-the-shelf generative models to synthesize training data in a
way that improves one-shot fine-grained classifiers. We begin by
conducting a pilot study to transfer a
generator pre-trained on ImageNet in a one-shot scenario. We show
that the generated images can indeed improve the performance of a
one-shot classifier when used with a carefully-designed rule to
combine the generated images with the originals. Based on these
preliminary results, we propose a meta-learning approach to
learn these rules to reinforce the generated images effectively for
few-shot classification.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our approach has two steps. First, an off-the-shelf generator trained
from ImageNet is updated towards the domain of novel classes by using
only a single image (Sec. <a href="#S4.SS1" title="4.1 Fine-tuning Pre-trained Generator for Target Images ‣ 4 Method ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>). Second, since previous
work and our pilot study (Sec. <a href="#S3" title="3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) suggest that
simply adding synthesized images to the training data may not improve
one-shot learning, the synthesized images are “mixed” with the
original images in order to bridge the domain gap between the two
(Sec. <a href="#S4.SS2" title="4.2 Meta Reinforced Synthetic Data for Few-shot Learning ‣ 4 Method ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>). The effective mixing strategy is learned
by a meta-learner, which essentially
boosts the performance of fine-grained categorization with
a single training instance per class. Lastly, we experimentally validate that our
approach can achieve improved performance over baselines on
fine-grained classification datasets in one-shot situations
(Sec. <a href="#S5" title="5 Experiments ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>).</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To summarize, the contributions of this paper are: (1) a method to
transfer a pre-trained generator with a single image, (2) a method to
learn to complement real images with synthetic images in a way that
benefits one-shot classifiers, and (3) to experimentally demonstrate
that these methods improve one-shot classification accuracy on
fine-grained visual recognition benchmarks.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Image Generation.</span> Learning to generate realistic
images has many potential applications, but is challenging with
typical supervised learning. Supervised learning minimizes a loss
function between the predicted output and the desired output but, for
image generation, it is not easy to design such a
perceptually-meaningful loss between images. Generative Adversarial
Networks (GANs)<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> address this issue by
learning not only a generator but also a loss function — the
discriminator — that helps the generator to synthesize images
indistinguishable from real ones.
This
adversarial learning is intuitive but is known to often be
unstable <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> in practice. Recent progress
includes better CNN
architectures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, training
stabilization
tips <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>,
and interesting applications (e.g. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>). In
particular, BigGAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> trained on ImageNet has shown
visually impressive generated images with stable performance on
generic image generation tasks. Several
studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> have explored
generating images from few examples, but their focus has not been on
one shot classification. Several
papers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>
use the idea of adjusting batch normalization layers, which helped
inspire our work. Finally, some work has investigated using GANs to
help image
classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>;
our work differs in that we apply an off-the-shelf generator
pre-trained from a large and generic dataset.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Few-shot Meta-learning.</span> Few shot
classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> is a sub-field of meta-learning
(or “learning-to-learn”) problems, in which the task is to train a
classifier with only a few examples per class. Unlike the typical
classification setup, in few-shot classification the labels in the
training and test sets have no overlapping categories. Moreover, the
model is trained and evaluated by sampling many few-shot tasks (or
episodes). For example, when training a dog breed classifier, an
episode might train to recognize five dog species with only a single training
image per class — a 5-way-1-shot setting. A meta-learning method
trains a meta-model by sampling many episodes from training classes
and is evaluated by sampling many episodes from other unseen
classes. With this episodic training, we can choose several possible
approaches to learn to learn. For example, “learning to compare”
methods learn a metric space
(e.g.,<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>),
while other approaches learn to fine-tune (e.g.,
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>)
or learn to augment data (e.g.,
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>). An
advantage of the latter type is that, since it is data augmentation,
we can use it in combination with any other approaches. Our approach
also explores data augmentation by mixing the original images with
synthesized images produced by a fine-tuned generator, but we find
that the naive approach of simply adding GAN generated images to the
training dataset does not improve performance. But by carefully
combining generated images with the original images, we find that
we can effectively synthesize examples that contribute to increasing
the performance. Thus meta-learning is employed to learn the proper
combination strategy.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Pilot Study</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">To explain how we arrived at our approach, we describe some initial
experimentation which motivated the development of our methods.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>CUB 5-way-1-shot classification accuracy (%)
using ImageNet features. Simply adding generated images to the training
set does not help, but adding hybrid images, as
in Fig. <a href="#S3.F1" title="Figure 1 ‣ 3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (h), can.</figcaption>
<table id="S3.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Training Data</th>
<th id="S3.T1.1.1.1.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_tt">Nearest Neighbor</th>
<th id="S3.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Logistic Regression</th>
<th id="S3.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Softmax Regression</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.2.1" class="ltx_tr">
<th id="S3.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Original</th>
<td id="S3.T1.1.2.1.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">69.6</td>
<td id="S3.T1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">75.0</td>
<td id="S3.T1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">74.1</td>
</tr>
<tr id="S3.T1.1.3.2" class="ltx_tr">
<th id="S3.T1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Original + Generated</th>
<td id="S3.T1.1.3.2.2" class="ltx_td ltx_nopad_l ltx_align_center">70.1</td>
<td id="S3.T1.1.3.2.3" class="ltx_td ltx_align_center">74.6</td>
<td id="S3.T1.1.3.2.4" class="ltx_td ltx_align_center">73.8</td>
</tr>
<tr id="S3.T1.1.4.3" class="ltx_tr">
<th id="S3.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Original + Mixed</th>
<td id="S3.T1.1.4.3.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb">70.6</td>
<td id="S3.T1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_bb">75.5</td>
<td id="S3.T1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_bb">74.8</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S3.F1.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1911.07164/assets/figs/original.png" id="S3.F1.1.g1" class="ltx_graphics ltx_img_square" width="60" height="60" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S3.F1.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1911.07164/assets/figs/tune-noise.png" id="S3.F1.2.g1" class="ltx_graphics ltx_img_square" width="60" height="60" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S3.F1.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1911.07164/assets/figs/tune-noise-and-weight.png" id="S3.F1.3.g1" class="ltx_graphics ltx_img_square" width="60" height="60" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S3.F1.4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1911.07164/assets/figs/tune-noise-and-scale-shift.png" id="S3.F1.4.g1" class="ltx_graphics ltx_img_square" width="60" height="60" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S3.F1.5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1911.07164/assets/figs/recon-1.png" id="S3.F1.5.g1" class="ltx_graphics ltx_img_square" width="60" height="60" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S3.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1911.07164/assets/figs/recon-1-add-noise-1.png" id="S3.F1.sf1.g1" class="ltx_graphics ltx_img_square" width="60" height="60" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F1.sf1.2.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S3.F1.sf1.3.2" class="ltx_text" style="font-size:80%;"> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S3.F1.6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1911.07164/assets/figs/block.png" id="S3.F1.6.g1" class="ltx_graphics ltx_img_square" width="60" height="60" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<figure id="S3.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1911.07164/assets/figs/combined.png" id="S3.F1.sf2.g1" class="ltx_graphics ltx_img_square" width="60" height="60" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F1.sf2.2.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S3.F1.sf2.3.2" class="ltx_text" style="font-size:80%;"> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Samples described in Sec. <a href="#S3" title="3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. (a)
Original image. (b) Result of tuning noise only. (c) Result of tuning the whole
network. (d) Result of tuning batch norm only. (e) Result of tuning batch norm with
perceptual loss. (f) Result of slightly disturbing noise from (e). (g) a
<math id="S3.F1.11.m1.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S3.F1.11.m1.1b"><mrow id="S3.F1.11.m1.1.1" xref="S3.F1.11.m1.1.1.cmml"><mn id="S3.F1.11.m1.1.1.2" xref="S3.F1.11.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S3.F1.11.m1.1.1.1" xref="S3.F1.11.m1.1.1.1.cmml">×</mo><mn id="S3.F1.11.m1.1.1.3" xref="S3.F1.11.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.11.m1.1c"><apply id="S3.F1.11.m1.1.1.cmml" xref="S3.F1.11.m1.1.1"><times id="S3.F1.11.m1.1.1.1.cmml" xref="S3.F1.11.m1.1.1.1"></times><cn type="integer" id="S3.F1.11.m1.1.1.2.cmml" xref="S3.F1.11.m1.1.1.2">3</cn><cn type="integer" id="S3.F1.11.m1.1.1.3.cmml" xref="S3.F1.11.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.11.m1.1d">3\times 3</annotation></semantics></math> block weight matrix <math id="S3.F1.12.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.F1.12.m2.1b"><mi id="S3.F1.12.m2.1.1" xref="S3.F1.12.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.F1.12.m2.1c"><ci id="S3.F1.12.m2.1.1.cmml" xref="S3.F1.12.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.12.m2.1d">w</annotation></semantics></math>. (g) Result of mixing (a) and (f) as
<math id="S3.F1.13.m3.1" class="ltx_math_unparsed" alttext="w\times" display="inline"><semantics id="S3.F1.13.m3.1b"><mrow id="S3.F1.13.m3.1c"><mi id="S3.F1.13.m3.1.1">w</mi><mo lspace="0.222em" id="S3.F1.13.m3.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S3.F1.13.m3.1d">w\times</annotation></semantics></math>(f) + <math id="S3.F1.14.m4.1" class="ltx_math_unparsed" alttext="(1-w)\times" display="inline"><semantics id="S3.F1.14.m4.1b"><mrow id="S3.F1.14.m4.1c"><mrow id="S3.F1.14.m4.1.1"><mo stretchy="false" id="S3.F1.14.m4.1.1.1">(</mo><mn id="S3.F1.14.m4.1.1.2">1</mn><mo id="S3.F1.14.m4.1.1.3">−</mo><mi id="S3.F1.14.m4.1.1.4">w</mi><mo rspace="0.055em" stretchy="false" id="S3.F1.14.m4.1.1.5">)</mo></mrow><mo id="S3.F1.14.m4.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S3.F1.14.m4.1d">(1-w)\times</annotation></semantics></math>(a).
</figcaption>
</figure>
<section id="S3.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">How can we transfer generative knowledge from
pre-trained GANs?</h5>

<div id="S3.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p1.1" class="ltx_p">We aim to quickly generate training images for
few-shot classification. Performing adversarial learning
(<em id="S3.SS0.SSS0.Px1.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>. training generator and discriminator initializing with
pre-trained weights) is not practical when we only have one or two
examples per class. Instead, we want to develop a method that does not
depend on the number of images at all; in fact, we consider the
extreme case where only a single image is available, and want to
generate variants of the image using a pre-trained GAN. We tried fixing
the generator weights and optimizing the noise so that it generates
the target image, under the assumption that sightly modifying the
optimized noise would produce a variant of the original. However,
naively implementing this idea with BigGAN did not reconstruct the
image well, as shown in the sample in
Fig. <a href="#S3.F1" title="Figure 1 ‣ 3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(b). We then tried fine-tuning the generator
weights also, but this produced even worse images stuck in a local
minima, as shown in Fig. <a href="#S3.F1" title="Figure 1 ‣ 3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(c).</p>
</div>
<div id="S3.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p2.1" class="ltx_p">We speculate that the best approach may be somewhere between the two
extremes of tuning noise only and tuning both noise and
weights. Inspired by previous
work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, we
propose to fine-tune only scale and shift parameters in the batch
normalization layers. This strategy produces better images as shown in
Fig. <a href="#S3.F1" title="Figure 1 ‣ 3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(d). Finally, again inspired by
previous work<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, we not only minimize the
pixel-level distance but also the distance of a pre-trained CNN
representation (i.e. perceptual loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>),
and we show the slightly improved results in Fig.
<a href="#S3.F1" title="Figure 1 ‣ 3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(e). We can also generate slightly
different versions by adding random perturbations to the tuned noise
(e.g., the “fattened” version of the same bird in
Fig. <a href="#S3.F1" title="Figure 1 ‣ 3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(f)). The entire training process
needs fewer than 500 iterations and takes less than 20 seconds on an
NVidia Titan Xp GPU. We explain the resulting generation strategy developed based on this pilot study in
Sec. <a href="#S4" title="4 Method ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Are generated images helpful for few shot learning?</h5>

<div id="S3.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px2.p1.1" class="ltx_p">Our goal is not to generate images, but to augment the training data
for few shot learning. A naive way to do this is to apply the above generation
technique for each training image, in order to double the training set. We
tested this idea on a validation set (split the same as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>) from
the Caltech-UCSD bird dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> and computed average accuracy on 100 episodes of
5-way-1-shot classification. We used pre-trained ImageNet features from
ResNet18 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> with nearest neighbor, one-vs-all logistic
regression, and softmax regression (or multi-class logistic regression).
As shown in Table <a href="#S3.T1" title="Table 1 ‣ 3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the accuracy actually drops for two of the three classifiers when we double
the size of our training set by generating synthetic training images, suggesting
that the
generated images are harmful for training classifiers.</p>
</div>
<div id="S3.SS0.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS0.SSS0.Px2.p2.1" class="ltx_p"><span id="S3.SS0.SSS0.Px2.p2.1.1" class="ltx_text ltx_font_bold">What is the proper way of synthesizing images to
help few-shot learning?</span> Given that the synthetic images
<span id="S3.SS0.SSS0.Px2.p2.1.2" class="ltx_text ltx_font_italic">appear</span> meaningful to humans, we conjecture that they can
benefit few shot classification when properly mixed with originals to create hybrid images. To empirically test this hypothesis, we devised a random <math id="S3.SS0.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S3.SS0.SSS0.Px2.p2.1.m1.1a"><mrow id="S3.SS0.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1.cmml"><mn id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.2" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.1" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1.1.cmml">×</mo><mn id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.3" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1"><times id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1.1"></times><cn type="integer" id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1.2">3</cn><cn type="integer" id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.1.m1.1c">3\times 3</annotation></semantics></math>
grid to combine the images. As shown in
Fig. <a href="#S3.F1" title="Figure 1 ‣ 3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(h), images (a) and (f) were combined by
taking a linear combination within each cell of the grid of (g).
Finally, we added mixed images like (h) into the training data, and
discovered that this produced a modest increase in accuracy (last row
of Table <a href="#S3.T1" title="Table 1 ‣ 3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). While the increase is marginal, these
mixing weights were binary and manually selected, and thus likely not
optimal. In Sec. <a href="#S4.SS2" title="4.2 Meta Reinforced Synthetic Data for Few-shot Learning ‣ 4 Method ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>, we show how to learn this
mixing strategy in an end-to-end manner using a meta-learning
framework.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/1911.07164/assets/x1.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="227" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S3.F2.2.1" class="ltx_text ltx_font_bold">Our Meta Image Reinforcing Network (MetaIRNet) </span> has
two modules: an image fusion network, and a one-shot classification
network. The image fusion network reinforces generated
images to try to make them beneficial for the one-shot classifier, while the
one-shot classifier learns representations that are suitable to
classify unseen examples with few examples. Both networks
are trained end-to-end, so the loss back-propagates from
classifier to the fusion network.</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The results of the pilot study in the last section suggested that
producing synthetic images could be useful for few-shot fine-grained
recognition, but only if it is done in a careful way. In this section,
we use these findings to propose a novel technique for doing this
effectively.
We
propose a GAN fine-tuning method that works with a single image
(Sec. <a href="#S4.SS1" title="4.1 Fine-tuning Pre-trained Generator for Target Images ‣ 4 Method ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>), and an effective meta-learning method to not
only learn to classify with few examples, but also to learn to
effectively reinforce the generated images
(Sec. <a href="#S4.SS2" title="4.2 Meta Reinforced Synthetic Data for Few-shot Learning ‣ 4 Method ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>).</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Fine-tuning Pre-trained Generator for Target Images</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.17" class="ltx_p">GANs typically have a generator <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">G</annotation></semantics></math> and a discriminator <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">D</annotation></semantics></math>. Given an input
signal <math id="S4.SS1.p1.3.m3.2" class="ltx_Math" alttext="z\sim\mathcal{N}(0,1)" display="inline"><semantics id="S4.SS1.p1.3.m3.2a"><mrow id="S4.SS1.p1.3.m3.2.3" xref="S4.SS1.p1.3.m3.2.3.cmml"><mi id="S4.SS1.p1.3.m3.2.3.2" xref="S4.SS1.p1.3.m3.2.3.2.cmml">z</mi><mo id="S4.SS1.p1.3.m3.2.3.1" xref="S4.SS1.p1.3.m3.2.3.1.cmml">∼</mo><mrow id="S4.SS1.p1.3.m3.2.3.3" xref="S4.SS1.p1.3.m3.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.3.m3.2.3.3.2" xref="S4.SS1.p1.3.m3.2.3.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.3.m3.2.3.3.1" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml">​</mo><mrow id="S4.SS1.p1.3.m3.2.3.3.3.2" xref="S4.SS1.p1.3.m3.2.3.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.2.3.3.3.2.1" xref="S4.SS1.p1.3.m3.2.3.3.3.1.cmml">(</mo><mn id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">0</mn><mo id="S4.SS1.p1.3.m3.2.3.3.3.2.2" xref="S4.SS1.p1.3.m3.2.3.3.3.1.cmml">,</mo><mn id="S4.SS1.p1.3.m3.2.2" xref="S4.SS1.p1.3.m3.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.p1.3.m3.2.3.3.3.2.3" xref="S4.SS1.p1.3.m3.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.2b"><apply id="S4.SS1.p1.3.m3.2.3.cmml" xref="S4.SS1.p1.3.m3.2.3"><csymbol cd="latexml" id="S4.SS1.p1.3.m3.2.3.1.cmml" xref="S4.SS1.p1.3.m3.2.3.1">similar-to</csymbol><ci id="S4.SS1.p1.3.m3.2.3.2.cmml" xref="S4.SS1.p1.3.m3.2.3.2">𝑧</ci><apply id="S4.SS1.p1.3.m3.2.3.3.cmml" xref="S4.SS1.p1.3.m3.2.3.3"><times id="S4.SS1.p1.3.m3.2.3.3.1.cmml" xref="S4.SS1.p1.3.m3.2.3.3.1"></times><ci id="S4.SS1.p1.3.m3.2.3.3.2.cmml" xref="S4.SS1.p1.3.m3.2.3.3.2">𝒩</ci><interval closure="open" id="S4.SS1.p1.3.m3.2.3.3.3.1.cmml" xref="S4.SS1.p1.3.m3.2.3.3.3.2"><cn type="integer" id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">0</cn><cn type="integer" id="S4.SS1.p1.3.m3.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.2c">z\sim\mathcal{N}(0,1)</annotation></semantics></math>, a well-trained generator synthesizes
an image <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="G(z)" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.2" xref="S4.SS1.p1.4.m4.1.2.cmml"><mi id="S4.SS1.p1.4.m4.1.2.2" xref="S4.SS1.p1.4.m4.1.2.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.1.2.1" xref="S4.SS1.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S4.SS1.p1.4.m4.1.2.3.2" xref="S4.SS1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.4.m4.1.2.3.2.1" xref="S4.SS1.p1.4.m4.1.2.cmml">(</mo><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">z</mi><mo stretchy="false" id="S4.SS1.p1.4.m4.1.2.3.2.2" xref="S4.SS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.2.cmml" xref="S4.SS1.p1.4.m4.1.2"><times id="S4.SS1.p1.4.m4.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.2.1"></times><ci id="S4.SS1.p1.4.m4.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.2.2">𝐺</ci><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">G(z)</annotation></semantics></math>. In our tasks, we adapt an off-the-shelf GAN generator
<math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">G</annotation></semantics></math> that is pre-trained on the ImageNet-2012 dataset in order to generate
more images in a target, data-scarce domain. Note that we do not use the
discriminator, since adversarial training with a few images is
unstable and may lead to model collapse. Formally, we fine-tune <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">z</annotation></semantics></math> and
the generator <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mi id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><ci id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">G</annotation></semantics></math> such that <math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mi id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><ci id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">G</annotation></semantics></math> generates an image <math id="S4.SS1.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{I}_{z}" display="inline"><semantics id="S4.SS1.p1.9.m9.1a"><msub id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml"><mi id="S4.SS1.p1.9.m9.1.1.2" xref="S4.SS1.p1.9.m9.1.1.2.cmml">𝐈</mi><mi id="S4.SS1.p1.9.m9.1.1.3" xref="S4.SS1.p1.9.m9.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><apply id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.1.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S4.SS1.p1.9.m9.1.1.2.cmml" xref="S4.SS1.p1.9.m9.1.1.2">𝐈</ci><ci id="S4.SS1.p1.9.m9.1.1.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">\mathbf{I}_{z}</annotation></semantics></math>
from an input vector <math id="S4.SS1.p1.10.m10.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS1.p1.10.m10.1a"><mi id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><ci id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">z</annotation></semantics></math> by minimizing the distance between <math id="S4.SS1.p1.11.m11.1" class="ltx_Math" alttext="G(z)" display="inline"><semantics id="S4.SS1.p1.11.m11.1a"><mrow id="S4.SS1.p1.11.m11.1.2" xref="S4.SS1.p1.11.m11.1.2.cmml"><mi id="S4.SS1.p1.11.m11.1.2.2" xref="S4.SS1.p1.11.m11.1.2.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.11.m11.1.2.1" xref="S4.SS1.p1.11.m11.1.2.1.cmml">​</mo><mrow id="S4.SS1.p1.11.m11.1.2.3.2" xref="S4.SS1.p1.11.m11.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.11.m11.1.2.3.2.1" xref="S4.SS1.p1.11.m11.1.2.cmml">(</mo><mi id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml">z</mi><mo stretchy="false" id="S4.SS1.p1.11.m11.1.2.3.2.2" xref="S4.SS1.p1.11.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><apply id="S4.SS1.p1.11.m11.1.2.cmml" xref="S4.SS1.p1.11.m11.1.2"><times id="S4.SS1.p1.11.m11.1.2.1.cmml" xref="S4.SS1.p1.11.m11.1.2.1"></times><ci id="S4.SS1.p1.11.m11.1.2.2.cmml" xref="S4.SS1.p1.11.m11.1.2.2">𝐺</ci><ci id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">G(z)</annotation></semantics></math> and
<math id="S4.SS1.p1.12.m12.1" class="ltx_Math" alttext="\mathbf{I}_{z}" display="inline"><semantics id="S4.SS1.p1.12.m12.1a"><msub id="S4.SS1.p1.12.m12.1.1" xref="S4.SS1.p1.12.m12.1.1.cmml"><mi id="S4.SS1.p1.12.m12.1.1.2" xref="S4.SS1.p1.12.m12.1.1.2.cmml">𝐈</mi><mi id="S4.SS1.p1.12.m12.1.1.3" xref="S4.SS1.p1.12.m12.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.1b"><apply id="S4.SS1.p1.12.m12.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.1.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S4.SS1.p1.12.m12.1.1.2.cmml" xref="S4.SS1.p1.12.m12.1.1.2">𝐈</ci><ci id="S4.SS1.p1.12.m12.1.1.3.cmml" xref="S4.SS1.p1.12.m12.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.1c">\mathbf{I}_{z}</annotation></semantics></math>, where the vector <math id="S4.SS1.p1.13.m13.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS1.p1.13.m13.1a"><mi id="S4.SS1.p1.13.m13.1.1" xref="S4.SS1.p1.13.m13.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.1b"><ci id="S4.SS1.p1.13.m13.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.1c">z</annotation></semantics></math> is randomly
initialized. Inspired by previous
work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>,
we minimize a loss function <math id="S4.SS1.p1.14.m14.1" class="ltx_Math" alttext="\mathcal{L}_{G}" display="inline"><semantics id="S4.SS1.p1.14.m14.1a"><msub id="S4.SS1.p1.14.m14.1.1" xref="S4.SS1.p1.14.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.14.m14.1.1.2" xref="S4.SS1.p1.14.m14.1.1.2.cmml">ℒ</mi><mi id="S4.SS1.p1.14.m14.1.1.3" xref="S4.SS1.p1.14.m14.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m14.1b"><apply id="S4.SS1.p1.14.m14.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.1.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1">subscript</csymbol><ci id="S4.SS1.p1.14.m14.1.1.2.cmml" xref="S4.SS1.p1.14.m14.1.1.2">ℒ</ci><ci id="S4.SS1.p1.14.m14.1.1.3.cmml" xref="S4.SS1.p1.14.m14.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m14.1c">\mathcal{L}_{G}</annotation></semantics></math> with
<math id="S4.SS1.p1.15.m15.1" class="ltx_Math" alttext="\mathcal{L}_{1}" display="inline"><semantics id="S4.SS1.p1.15.m15.1a"><msub id="S4.SS1.p1.15.m15.1.1" xref="S4.SS1.p1.15.m15.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.15.m15.1.1.2" xref="S4.SS1.p1.15.m15.1.1.2.cmml">ℒ</mi><mn id="S4.SS1.p1.15.m15.1.1.3" xref="S4.SS1.p1.15.m15.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.15.m15.1b"><apply id="S4.SS1.p1.15.m15.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.15.m15.1.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1">subscript</csymbol><ci id="S4.SS1.p1.15.m15.1.1.2.cmml" xref="S4.SS1.p1.15.m15.1.1.2">ℒ</ci><cn type="integer" id="S4.SS1.p1.15.m15.1.1.3.cmml" xref="S4.SS1.p1.15.m15.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.15.m15.1c">\mathcal{L}_{1}</annotation></semantics></math> distance and perceptual loss <math id="S4.SS1.p1.16.m16.1" class="ltx_Math" alttext="\mathcal{L}_{perc}" display="inline"><semantics id="S4.SS1.p1.16.m16.1a"><msub id="S4.SS1.p1.16.m16.1.1" xref="S4.SS1.p1.16.m16.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.16.m16.1.1.2" xref="S4.SS1.p1.16.m16.1.1.2.cmml">ℒ</mi><mrow id="S4.SS1.p1.16.m16.1.1.3" xref="S4.SS1.p1.16.m16.1.1.3.cmml"><mi id="S4.SS1.p1.16.m16.1.1.3.2" xref="S4.SS1.p1.16.m16.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.16.m16.1.1.3.1" xref="S4.SS1.p1.16.m16.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.16.m16.1.1.3.3" xref="S4.SS1.p1.16.m16.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.16.m16.1.1.3.1a" xref="S4.SS1.p1.16.m16.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.16.m16.1.1.3.4" xref="S4.SS1.p1.16.m16.1.1.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.16.m16.1.1.3.1b" xref="S4.SS1.p1.16.m16.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.16.m16.1.1.3.5" xref="S4.SS1.p1.16.m16.1.1.3.5.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.16.m16.1b"><apply id="S4.SS1.p1.16.m16.1.1.cmml" xref="S4.SS1.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.16.m16.1.1.1.cmml" xref="S4.SS1.p1.16.m16.1.1">subscript</csymbol><ci id="S4.SS1.p1.16.m16.1.1.2.cmml" xref="S4.SS1.p1.16.m16.1.1.2">ℒ</ci><apply id="S4.SS1.p1.16.m16.1.1.3.cmml" xref="S4.SS1.p1.16.m16.1.1.3"><times id="S4.SS1.p1.16.m16.1.1.3.1.cmml" xref="S4.SS1.p1.16.m16.1.1.3.1"></times><ci id="S4.SS1.p1.16.m16.1.1.3.2.cmml" xref="S4.SS1.p1.16.m16.1.1.3.2">𝑝</ci><ci id="S4.SS1.p1.16.m16.1.1.3.3.cmml" xref="S4.SS1.p1.16.m16.1.1.3.3">𝑒</ci><ci id="S4.SS1.p1.16.m16.1.1.3.4.cmml" xref="S4.SS1.p1.16.m16.1.1.3.4">𝑟</ci><ci id="S4.SS1.p1.16.m16.1.1.3.5.cmml" xref="S4.SS1.p1.16.m16.1.1.3.5">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.16.m16.1c">\mathcal{L}_{perc}</annotation></semantics></math>
with earth mover regularization <math id="S4.SS1.p1.17.m17.1" class="ltx_Math" alttext="\mathrm{\mathcal{L}}_{EM}" display="inline"><semantics id="S4.SS1.p1.17.m17.1a"><msub id="S4.SS1.p1.17.m17.1.1" xref="S4.SS1.p1.17.m17.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.17.m17.1.1.2" xref="S4.SS1.p1.17.m17.1.1.2.cmml">ℒ</mi><mrow id="S4.SS1.p1.17.m17.1.1.3" xref="S4.SS1.p1.17.m17.1.1.3.cmml"><mi id="S4.SS1.p1.17.m17.1.1.3.2" xref="S4.SS1.p1.17.m17.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.17.m17.1.1.3.1" xref="S4.SS1.p1.17.m17.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.17.m17.1.1.3.3" xref="S4.SS1.p1.17.m17.1.1.3.3.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.17.m17.1b"><apply id="S4.SS1.p1.17.m17.1.1.cmml" xref="S4.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.17.m17.1.1.1.cmml" xref="S4.SS1.p1.17.m17.1.1">subscript</csymbol><ci id="S4.SS1.p1.17.m17.1.1.2.cmml" xref="S4.SS1.p1.17.m17.1.1.2">ℒ</ci><apply id="S4.SS1.p1.17.m17.1.1.3.cmml" xref="S4.SS1.p1.17.m17.1.1.3"><times id="S4.SS1.p1.17.m17.1.1.3.1.cmml" xref="S4.SS1.p1.17.m17.1.1.3.1"></times><ci id="S4.SS1.p1.17.m17.1.1.3.2.cmml" xref="S4.SS1.p1.17.m17.1.1.3.2">𝐸</ci><ci id="S4.SS1.p1.17.m17.1.1.3.3.cmml" xref="S4.SS1.p1.17.m17.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.17.m17.1c">\mathrm{\mathcal{L}}_{EM}</annotation></semantics></math>,</p>
<table id="S7.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E1.m1.7" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{G}\left(G,\mathbf{I}_{z},z\right)=\mathcal{L}_{1}\left(G(z),\mathbf{I}_{z}\right)+\lambda_{p}\mathcal{L}_{perc}\left(G(z),\mathbf{I}_{z}\right)+\lambda_{z}\mathrm{\mathcal{L}}_{EM}\left(z,r\right)," display="inline"><semantics id="S4.E1.m1.7a"><mrow id="S4.E1.m1.7.7.1" xref="S4.E1.m1.7.7.1.1.cmml"><mrow id="S4.E1.m1.7.7.1.1" xref="S4.E1.m1.7.7.1.1.cmml"><mrow id="S4.E1.m1.7.7.1.1.1" xref="S4.E1.m1.7.7.1.1.1.cmml"><msub id="S4.E1.m1.7.7.1.1.1.3" xref="S4.E1.m1.7.7.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.7.7.1.1.1.3.2" xref="S4.E1.m1.7.7.1.1.1.3.2.cmml">ℒ</mi><mi id="S4.E1.m1.7.7.1.1.1.3.3" xref="S4.E1.m1.7.7.1.1.1.3.3.cmml">G</mi></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.1.1.1.2" xref="S4.E1.m1.7.7.1.1.1.2.cmml">​</mo><mrow id="S4.E1.m1.7.7.1.1.1.1.1" xref="S4.E1.m1.7.7.1.1.1.1.2.cmml"><mo id="S4.E1.m1.7.7.1.1.1.1.1.2" xref="S4.E1.m1.7.7.1.1.1.1.2.cmml">(</mo><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">G</mi><mo id="S4.E1.m1.7.7.1.1.1.1.1.3" xref="S4.E1.m1.7.7.1.1.1.1.2.cmml">,</mo><msub id="S4.E1.m1.7.7.1.1.1.1.1.1" xref="S4.E1.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.7.7.1.1.1.1.1.1.2" xref="S4.E1.m1.7.7.1.1.1.1.1.1.2.cmml">𝐈</mi><mi id="S4.E1.m1.7.7.1.1.1.1.1.1.3" xref="S4.E1.m1.7.7.1.1.1.1.1.1.3.cmml">z</mi></msub><mo id="S4.E1.m1.7.7.1.1.1.1.1.4" xref="S4.E1.m1.7.7.1.1.1.1.2.cmml">,</mo><mi id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">z</mi><mo id="S4.E1.m1.7.7.1.1.1.1.1.5" xref="S4.E1.m1.7.7.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.7.7.1.1.6" xref="S4.E1.m1.7.7.1.1.6.cmml">=</mo><mrow id="S4.E1.m1.7.7.1.1.5" xref="S4.E1.m1.7.7.1.1.5.cmml"><mrow id="S4.E1.m1.7.7.1.1.3.2" xref="S4.E1.m1.7.7.1.1.3.2.cmml"><msub id="S4.E1.m1.7.7.1.1.3.2.4" xref="S4.E1.m1.7.7.1.1.3.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.7.7.1.1.3.2.4.2" xref="S4.E1.m1.7.7.1.1.3.2.4.2.cmml">ℒ</mi><mn id="S4.E1.m1.7.7.1.1.3.2.4.3" xref="S4.E1.m1.7.7.1.1.3.2.4.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.1.1.3.2.3" xref="S4.E1.m1.7.7.1.1.3.2.3.cmml">​</mo><mrow id="S4.E1.m1.7.7.1.1.3.2.2.2" xref="S4.E1.m1.7.7.1.1.3.2.2.3.cmml"><mo id="S4.E1.m1.7.7.1.1.3.2.2.2.3" xref="S4.E1.m1.7.7.1.1.3.2.2.3.cmml">(</mo><mrow id="S4.E1.m1.7.7.1.1.2.1.1.1.1" xref="S4.E1.m1.7.7.1.1.2.1.1.1.1.cmml"><mi id="S4.E1.m1.7.7.1.1.2.1.1.1.1.2" xref="S4.E1.m1.7.7.1.1.2.1.1.1.1.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.1.1.2.1.1.1.1.1" xref="S4.E1.m1.7.7.1.1.2.1.1.1.1.1.cmml">​</mo><mrow id="S4.E1.m1.7.7.1.1.2.1.1.1.1.3.2" xref="S4.E1.m1.7.7.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.7.7.1.1.2.1.1.1.1.3.2.1" xref="S4.E1.m1.7.7.1.1.2.1.1.1.1.cmml">(</mo><mi id="S4.E1.m1.3.3" xref="S4.E1.m1.3.3.cmml">z</mi><mo stretchy="false" id="S4.E1.m1.7.7.1.1.2.1.1.1.1.3.2.2" xref="S4.E1.m1.7.7.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.7.7.1.1.3.2.2.2.4" xref="S4.E1.m1.7.7.1.1.3.2.2.3.cmml">,</mo><msub id="S4.E1.m1.7.7.1.1.3.2.2.2.2" xref="S4.E1.m1.7.7.1.1.3.2.2.2.2.cmml"><mi id="S4.E1.m1.7.7.1.1.3.2.2.2.2.2" xref="S4.E1.m1.7.7.1.1.3.2.2.2.2.2.cmml">𝐈</mi><mi id="S4.E1.m1.7.7.1.1.3.2.2.2.2.3" xref="S4.E1.m1.7.7.1.1.3.2.2.2.2.3.cmml">z</mi></msub><mo id="S4.E1.m1.7.7.1.1.3.2.2.2.5" xref="S4.E1.m1.7.7.1.1.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.7.7.1.1.5.5" xref="S4.E1.m1.7.7.1.1.5.5.cmml">+</mo><mrow id="S4.E1.m1.7.7.1.1.5.4" xref="S4.E1.m1.7.7.1.1.5.4.cmml"><msub id="S4.E1.m1.7.7.1.1.5.4.4" xref="S4.E1.m1.7.7.1.1.5.4.4.cmml"><mi id="S4.E1.m1.7.7.1.1.5.4.4.2" xref="S4.E1.m1.7.7.1.1.5.4.4.2.cmml">λ</mi><mi id="S4.E1.m1.7.7.1.1.5.4.4.3" xref="S4.E1.m1.7.7.1.1.5.4.4.3.cmml">p</mi></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.1.1.5.4.3" xref="S4.E1.m1.7.7.1.1.5.4.3.cmml">​</mo><msub id="S4.E1.m1.7.7.1.1.5.4.5" xref="S4.E1.m1.7.7.1.1.5.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.7.7.1.1.5.4.5.2" xref="S4.E1.m1.7.7.1.1.5.4.5.2.cmml">ℒ</mi><mrow id="S4.E1.m1.7.7.1.1.5.4.5.3" xref="S4.E1.m1.7.7.1.1.5.4.5.3.cmml"><mi id="S4.E1.m1.7.7.1.1.5.4.5.3.2" xref="S4.E1.m1.7.7.1.1.5.4.5.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.1.1.5.4.5.3.1" xref="S4.E1.m1.7.7.1.1.5.4.5.3.1.cmml">​</mo><mi id="S4.E1.m1.7.7.1.1.5.4.5.3.3" xref="S4.E1.m1.7.7.1.1.5.4.5.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.1.1.5.4.5.3.1a" xref="S4.E1.m1.7.7.1.1.5.4.5.3.1.cmml">​</mo><mi id="S4.E1.m1.7.7.1.1.5.4.5.3.4" xref="S4.E1.m1.7.7.1.1.5.4.5.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.1.1.5.4.5.3.1b" xref="S4.E1.m1.7.7.1.1.5.4.5.3.1.cmml">​</mo><mi id="S4.E1.m1.7.7.1.1.5.4.5.3.5" xref="S4.E1.m1.7.7.1.1.5.4.5.3.5.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.1.1.5.4.3a" xref="S4.E1.m1.7.7.1.1.5.4.3.cmml">​</mo><mrow id="S4.E1.m1.7.7.1.1.5.4.2.2" xref="S4.E1.m1.7.7.1.1.5.4.2.3.cmml"><mo id="S4.E1.m1.7.7.1.1.5.4.2.2.3" xref="S4.E1.m1.7.7.1.1.5.4.2.3.cmml">(</mo><mrow id="S4.E1.m1.7.7.1.1.4.3.1.1.1" xref="S4.E1.m1.7.7.1.1.4.3.1.1.1.cmml"><mi id="S4.E1.m1.7.7.1.1.4.3.1.1.1.2" xref="S4.E1.m1.7.7.1.1.4.3.1.1.1.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.1.1.4.3.1.1.1.1" xref="S4.E1.m1.7.7.1.1.4.3.1.1.1.1.cmml">​</mo><mrow id="S4.E1.m1.7.7.1.1.4.3.1.1.1.3.2" xref="S4.E1.m1.7.7.1.1.4.3.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.7.7.1.1.4.3.1.1.1.3.2.1" xref="S4.E1.m1.7.7.1.1.4.3.1.1.1.cmml">(</mo><mi id="S4.E1.m1.4.4" xref="S4.E1.m1.4.4.cmml">z</mi><mo stretchy="false" id="S4.E1.m1.7.7.1.1.4.3.1.1.1.3.2.2" xref="S4.E1.m1.7.7.1.1.4.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.7.7.1.1.5.4.2.2.4" xref="S4.E1.m1.7.7.1.1.5.4.2.3.cmml">,</mo><msub id="S4.E1.m1.7.7.1.1.5.4.2.2.2" xref="S4.E1.m1.7.7.1.1.5.4.2.2.2.cmml"><mi id="S4.E1.m1.7.7.1.1.5.4.2.2.2.2" xref="S4.E1.m1.7.7.1.1.5.4.2.2.2.2.cmml">𝐈</mi><mi id="S4.E1.m1.7.7.1.1.5.4.2.2.2.3" xref="S4.E1.m1.7.7.1.1.5.4.2.2.2.3.cmml">z</mi></msub><mo id="S4.E1.m1.7.7.1.1.5.4.2.2.5" xref="S4.E1.m1.7.7.1.1.5.4.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.7.7.1.1.5.5a" xref="S4.E1.m1.7.7.1.1.5.5.cmml">+</mo><mrow id="S4.E1.m1.7.7.1.1.5.6" xref="S4.E1.m1.7.7.1.1.5.6.cmml"><msub id="S4.E1.m1.7.7.1.1.5.6.2" xref="S4.E1.m1.7.7.1.1.5.6.2.cmml"><mi id="S4.E1.m1.7.7.1.1.5.6.2.2" xref="S4.E1.m1.7.7.1.1.5.6.2.2.cmml">λ</mi><mi id="S4.E1.m1.7.7.1.1.5.6.2.3" xref="S4.E1.m1.7.7.1.1.5.6.2.3.cmml">z</mi></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.1.1.5.6.1" xref="S4.E1.m1.7.7.1.1.5.6.1.cmml">​</mo><msub id="S4.E1.m1.7.7.1.1.5.6.3" xref="S4.E1.m1.7.7.1.1.5.6.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.7.7.1.1.5.6.3.2" xref="S4.E1.m1.7.7.1.1.5.6.3.2.cmml">ℒ</mi><mrow id="S4.E1.m1.7.7.1.1.5.6.3.3" xref="S4.E1.m1.7.7.1.1.5.6.3.3.cmml"><mi id="S4.E1.m1.7.7.1.1.5.6.3.3.2" xref="S4.E1.m1.7.7.1.1.5.6.3.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.1.1.5.6.3.3.1" xref="S4.E1.m1.7.7.1.1.5.6.3.3.1.cmml">​</mo><mi id="S4.E1.m1.7.7.1.1.5.6.3.3.3" xref="S4.E1.m1.7.7.1.1.5.6.3.3.3.cmml">M</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.7.7.1.1.5.6.1a" xref="S4.E1.m1.7.7.1.1.5.6.1.cmml">​</mo><mrow id="S4.E1.m1.7.7.1.1.5.6.4.2" xref="S4.E1.m1.7.7.1.1.5.6.4.1.cmml"><mo id="S4.E1.m1.7.7.1.1.5.6.4.2.1" xref="S4.E1.m1.7.7.1.1.5.6.4.1.cmml">(</mo><mi id="S4.E1.m1.5.5" xref="S4.E1.m1.5.5.cmml">z</mi><mo id="S4.E1.m1.7.7.1.1.5.6.4.2.2" xref="S4.E1.m1.7.7.1.1.5.6.4.1.cmml">,</mo><mi id="S4.E1.m1.6.6" xref="S4.E1.m1.6.6.cmml">r</mi><mo id="S4.E1.m1.7.7.1.1.5.6.4.2.3" xref="S4.E1.m1.7.7.1.1.5.6.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E1.m1.7.7.1.2" xref="S4.E1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.7b"><apply id="S4.E1.m1.7.7.1.1.cmml" xref="S4.E1.m1.7.7.1"><eq id="S4.E1.m1.7.7.1.1.6.cmml" xref="S4.E1.m1.7.7.1.1.6"></eq><apply id="S4.E1.m1.7.7.1.1.1.cmml" xref="S4.E1.m1.7.7.1.1.1"><times id="S4.E1.m1.7.7.1.1.1.2.cmml" xref="S4.E1.m1.7.7.1.1.1.2"></times><apply id="S4.E1.m1.7.7.1.1.1.3.cmml" xref="S4.E1.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.1.3.1.cmml" xref="S4.E1.m1.7.7.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.1.3.2.cmml" xref="S4.E1.m1.7.7.1.1.1.3.2">ℒ</ci><ci id="S4.E1.m1.7.7.1.1.1.3.3.cmml" xref="S4.E1.m1.7.7.1.1.1.3.3">𝐺</ci></apply><vector id="S4.E1.m1.7.7.1.1.1.1.2.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1"><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝐺</ci><apply id="S4.E1.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.2">𝐈</ci><ci id="S4.E1.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.3">𝑧</ci></apply><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">𝑧</ci></vector></apply><apply id="S4.E1.m1.7.7.1.1.5.cmml" xref="S4.E1.m1.7.7.1.1.5"><plus id="S4.E1.m1.7.7.1.1.5.5.cmml" xref="S4.E1.m1.7.7.1.1.5.5"></plus><apply id="S4.E1.m1.7.7.1.1.3.2.cmml" xref="S4.E1.m1.7.7.1.1.3.2"><times id="S4.E1.m1.7.7.1.1.3.2.3.cmml" xref="S4.E1.m1.7.7.1.1.3.2.3"></times><apply id="S4.E1.m1.7.7.1.1.3.2.4.cmml" xref="S4.E1.m1.7.7.1.1.3.2.4"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.3.2.4.1.cmml" xref="S4.E1.m1.7.7.1.1.3.2.4">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.3.2.4.2.cmml" xref="S4.E1.m1.7.7.1.1.3.2.4.2">ℒ</ci><cn type="integer" id="S4.E1.m1.7.7.1.1.3.2.4.3.cmml" xref="S4.E1.m1.7.7.1.1.3.2.4.3">1</cn></apply><interval closure="open" id="S4.E1.m1.7.7.1.1.3.2.2.3.cmml" xref="S4.E1.m1.7.7.1.1.3.2.2.2"><apply id="S4.E1.m1.7.7.1.1.2.1.1.1.1.cmml" xref="S4.E1.m1.7.7.1.1.2.1.1.1.1"><times id="S4.E1.m1.7.7.1.1.2.1.1.1.1.1.cmml" xref="S4.E1.m1.7.7.1.1.2.1.1.1.1.1"></times><ci id="S4.E1.m1.7.7.1.1.2.1.1.1.1.2.cmml" xref="S4.E1.m1.7.7.1.1.2.1.1.1.1.2">𝐺</ci><ci id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3">𝑧</ci></apply><apply id="S4.E1.m1.7.7.1.1.3.2.2.2.2.cmml" xref="S4.E1.m1.7.7.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.3.2.2.2.2.1.cmml" xref="S4.E1.m1.7.7.1.1.3.2.2.2.2">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.3.2.2.2.2.2.cmml" xref="S4.E1.m1.7.7.1.1.3.2.2.2.2.2">𝐈</ci><ci id="S4.E1.m1.7.7.1.1.3.2.2.2.2.3.cmml" xref="S4.E1.m1.7.7.1.1.3.2.2.2.2.3">𝑧</ci></apply></interval></apply><apply id="S4.E1.m1.7.7.1.1.5.4.cmml" xref="S4.E1.m1.7.7.1.1.5.4"><times id="S4.E1.m1.7.7.1.1.5.4.3.cmml" xref="S4.E1.m1.7.7.1.1.5.4.3"></times><apply id="S4.E1.m1.7.7.1.1.5.4.4.cmml" xref="S4.E1.m1.7.7.1.1.5.4.4"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.5.4.4.1.cmml" xref="S4.E1.m1.7.7.1.1.5.4.4">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.5.4.4.2.cmml" xref="S4.E1.m1.7.7.1.1.5.4.4.2">𝜆</ci><ci id="S4.E1.m1.7.7.1.1.5.4.4.3.cmml" xref="S4.E1.m1.7.7.1.1.5.4.4.3">𝑝</ci></apply><apply id="S4.E1.m1.7.7.1.1.5.4.5.cmml" xref="S4.E1.m1.7.7.1.1.5.4.5"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.5.4.5.1.cmml" xref="S4.E1.m1.7.7.1.1.5.4.5">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.5.4.5.2.cmml" xref="S4.E1.m1.7.7.1.1.5.4.5.2">ℒ</ci><apply id="S4.E1.m1.7.7.1.1.5.4.5.3.cmml" xref="S4.E1.m1.7.7.1.1.5.4.5.3"><times id="S4.E1.m1.7.7.1.1.5.4.5.3.1.cmml" xref="S4.E1.m1.7.7.1.1.5.4.5.3.1"></times><ci id="S4.E1.m1.7.7.1.1.5.4.5.3.2.cmml" xref="S4.E1.m1.7.7.1.1.5.4.5.3.2">𝑝</ci><ci id="S4.E1.m1.7.7.1.1.5.4.5.3.3.cmml" xref="S4.E1.m1.7.7.1.1.5.4.5.3.3">𝑒</ci><ci id="S4.E1.m1.7.7.1.1.5.4.5.3.4.cmml" xref="S4.E1.m1.7.7.1.1.5.4.5.3.4">𝑟</ci><ci id="S4.E1.m1.7.7.1.1.5.4.5.3.5.cmml" xref="S4.E1.m1.7.7.1.1.5.4.5.3.5">𝑐</ci></apply></apply><interval closure="open" id="S4.E1.m1.7.7.1.1.5.4.2.3.cmml" xref="S4.E1.m1.7.7.1.1.5.4.2.2"><apply id="S4.E1.m1.7.7.1.1.4.3.1.1.1.cmml" xref="S4.E1.m1.7.7.1.1.4.3.1.1.1"><times id="S4.E1.m1.7.7.1.1.4.3.1.1.1.1.cmml" xref="S4.E1.m1.7.7.1.1.4.3.1.1.1.1"></times><ci id="S4.E1.m1.7.7.1.1.4.3.1.1.1.2.cmml" xref="S4.E1.m1.7.7.1.1.4.3.1.1.1.2">𝐺</ci><ci id="S4.E1.m1.4.4.cmml" xref="S4.E1.m1.4.4">𝑧</ci></apply><apply id="S4.E1.m1.7.7.1.1.5.4.2.2.2.cmml" xref="S4.E1.m1.7.7.1.1.5.4.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.5.4.2.2.2.1.cmml" xref="S4.E1.m1.7.7.1.1.5.4.2.2.2">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.5.4.2.2.2.2.cmml" xref="S4.E1.m1.7.7.1.1.5.4.2.2.2.2">𝐈</ci><ci id="S4.E1.m1.7.7.1.1.5.4.2.2.2.3.cmml" xref="S4.E1.m1.7.7.1.1.5.4.2.2.2.3">𝑧</ci></apply></interval></apply><apply id="S4.E1.m1.7.7.1.1.5.6.cmml" xref="S4.E1.m1.7.7.1.1.5.6"><times id="S4.E1.m1.7.7.1.1.5.6.1.cmml" xref="S4.E1.m1.7.7.1.1.5.6.1"></times><apply id="S4.E1.m1.7.7.1.1.5.6.2.cmml" xref="S4.E1.m1.7.7.1.1.5.6.2"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.5.6.2.1.cmml" xref="S4.E1.m1.7.7.1.1.5.6.2">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.5.6.2.2.cmml" xref="S4.E1.m1.7.7.1.1.5.6.2.2">𝜆</ci><ci id="S4.E1.m1.7.7.1.1.5.6.2.3.cmml" xref="S4.E1.m1.7.7.1.1.5.6.2.3">𝑧</ci></apply><apply id="S4.E1.m1.7.7.1.1.5.6.3.cmml" xref="S4.E1.m1.7.7.1.1.5.6.3"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.5.6.3.1.cmml" xref="S4.E1.m1.7.7.1.1.5.6.3">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.5.6.3.2.cmml" xref="S4.E1.m1.7.7.1.1.5.6.3.2">ℒ</ci><apply id="S4.E1.m1.7.7.1.1.5.6.3.3.cmml" xref="S4.E1.m1.7.7.1.1.5.6.3.3"><times id="S4.E1.m1.7.7.1.1.5.6.3.3.1.cmml" xref="S4.E1.m1.7.7.1.1.5.6.3.3.1"></times><ci id="S4.E1.m1.7.7.1.1.5.6.3.3.2.cmml" xref="S4.E1.m1.7.7.1.1.5.6.3.3.2">𝐸</ci><ci id="S4.E1.m1.7.7.1.1.5.6.3.3.3.cmml" xref="S4.E1.m1.7.7.1.1.5.6.3.3.3">𝑀</ci></apply></apply><interval closure="open" id="S4.E1.m1.7.7.1.1.5.6.4.1.cmml" xref="S4.E1.m1.7.7.1.1.5.6.4.2"><ci id="S4.E1.m1.5.5.cmml" xref="S4.E1.m1.5.5">𝑧</ci><ci id="S4.E1.m1.6.6.cmml" xref="S4.E1.m1.6.6">𝑟</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.7c">\displaystyle\mathcal{L}_{G}\left(G,\mathbf{I}_{z},z\right)=\mathcal{L}_{1}\left(G(z),\mathbf{I}_{z}\right)+\lambda_{p}\mathcal{L}_{perc}\left(G(z),\mathbf{I}_{z}\right)+\lambda_{z}\mathrm{\mathcal{L}}_{EM}\left(z,r\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.23" class="ltx_p">where <math id="S4.SS1.p1.18.m1.1" class="ltx_Math" alttext="\mathrm{\mathcal{L}}_{EM}" display="inline"><semantics id="S4.SS1.p1.18.m1.1a"><msub id="S4.SS1.p1.18.m1.1.1" xref="S4.SS1.p1.18.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.18.m1.1.1.2" xref="S4.SS1.p1.18.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.SS1.p1.18.m1.1.1.3" xref="S4.SS1.p1.18.m1.1.1.3.cmml"><mi id="S4.SS1.p1.18.m1.1.1.3.2" xref="S4.SS1.p1.18.m1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.18.m1.1.1.3.1" xref="S4.SS1.p1.18.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.18.m1.1.1.3.3" xref="S4.SS1.p1.18.m1.1.1.3.3.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.18.m1.1b"><apply id="S4.SS1.p1.18.m1.1.1.cmml" xref="S4.SS1.p1.18.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.18.m1.1.1.1.cmml" xref="S4.SS1.p1.18.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.18.m1.1.1.2.cmml" xref="S4.SS1.p1.18.m1.1.1.2">ℒ</ci><apply id="S4.SS1.p1.18.m1.1.1.3.cmml" xref="S4.SS1.p1.18.m1.1.1.3"><times id="S4.SS1.p1.18.m1.1.1.3.1.cmml" xref="S4.SS1.p1.18.m1.1.1.3.1"></times><ci id="S4.SS1.p1.18.m1.1.1.3.2.cmml" xref="S4.SS1.p1.18.m1.1.1.3.2">𝐸</ci><ci id="S4.SS1.p1.18.m1.1.1.3.3.cmml" xref="S4.SS1.p1.18.m1.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.18.m1.1c">\mathrm{\mathcal{L}}_{EM}</annotation></semantics></math> is an earth mover distance between
<math id="S4.SS1.p1.19.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS1.p1.19.m2.1a"><mi id="S4.SS1.p1.19.m2.1.1" xref="S4.SS1.p1.19.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.19.m2.1b"><ci id="S4.SS1.p1.19.m2.1.1.cmml" xref="S4.SS1.p1.19.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.19.m2.1c">z</annotation></semantics></math> and random noise <math id="S4.SS1.p1.20.m3.2" class="ltx_Math" alttext="r\sim\mathcal{N}(0,1)" display="inline"><semantics id="S4.SS1.p1.20.m3.2a"><mrow id="S4.SS1.p1.20.m3.2.3" xref="S4.SS1.p1.20.m3.2.3.cmml"><mi id="S4.SS1.p1.20.m3.2.3.2" xref="S4.SS1.p1.20.m3.2.3.2.cmml">r</mi><mo id="S4.SS1.p1.20.m3.2.3.1" xref="S4.SS1.p1.20.m3.2.3.1.cmml">∼</mo><mrow id="S4.SS1.p1.20.m3.2.3.3" xref="S4.SS1.p1.20.m3.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.20.m3.2.3.3.2" xref="S4.SS1.p1.20.m3.2.3.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.20.m3.2.3.3.1" xref="S4.SS1.p1.20.m3.2.3.3.1.cmml">​</mo><mrow id="S4.SS1.p1.20.m3.2.3.3.3.2" xref="S4.SS1.p1.20.m3.2.3.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.20.m3.2.3.3.3.2.1" xref="S4.SS1.p1.20.m3.2.3.3.3.1.cmml">(</mo><mn id="S4.SS1.p1.20.m3.1.1" xref="S4.SS1.p1.20.m3.1.1.cmml">0</mn><mo id="S4.SS1.p1.20.m3.2.3.3.3.2.2" xref="S4.SS1.p1.20.m3.2.3.3.3.1.cmml">,</mo><mn id="S4.SS1.p1.20.m3.2.2" xref="S4.SS1.p1.20.m3.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.p1.20.m3.2.3.3.3.2.3" xref="S4.SS1.p1.20.m3.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.20.m3.2b"><apply id="S4.SS1.p1.20.m3.2.3.cmml" xref="S4.SS1.p1.20.m3.2.3"><csymbol cd="latexml" id="S4.SS1.p1.20.m3.2.3.1.cmml" xref="S4.SS1.p1.20.m3.2.3.1">similar-to</csymbol><ci id="S4.SS1.p1.20.m3.2.3.2.cmml" xref="S4.SS1.p1.20.m3.2.3.2">𝑟</ci><apply id="S4.SS1.p1.20.m3.2.3.3.cmml" xref="S4.SS1.p1.20.m3.2.3.3"><times id="S4.SS1.p1.20.m3.2.3.3.1.cmml" xref="S4.SS1.p1.20.m3.2.3.3.1"></times><ci id="S4.SS1.p1.20.m3.2.3.3.2.cmml" xref="S4.SS1.p1.20.m3.2.3.3.2">𝒩</ci><interval closure="open" id="S4.SS1.p1.20.m3.2.3.3.3.1.cmml" xref="S4.SS1.p1.20.m3.2.3.3.3.2"><cn type="integer" id="S4.SS1.p1.20.m3.1.1.cmml" xref="S4.SS1.p1.20.m3.1.1">0</cn><cn type="integer" id="S4.SS1.p1.20.m3.2.2.cmml" xref="S4.SS1.p1.20.m3.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.20.m3.2c">r\sim\mathcal{N}(0,1)</annotation></semantics></math> to regularize <math id="S4.SS1.p1.21.m4.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS1.p1.21.m4.1a"><mi id="S4.SS1.p1.21.m4.1.1" xref="S4.SS1.p1.21.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.21.m4.1b"><ci id="S4.SS1.p1.21.m4.1.1.cmml" xref="S4.SS1.p1.21.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.21.m4.1c">z</annotation></semantics></math> to
be sampled from a Gaussian, and <math id="S4.SS1.p1.22.m5.1" class="ltx_Math" alttext="\lambda_{p}" display="inline"><semantics id="S4.SS1.p1.22.m5.1a"><msub id="S4.SS1.p1.22.m5.1.1" xref="S4.SS1.p1.22.m5.1.1.cmml"><mi id="S4.SS1.p1.22.m5.1.1.2" xref="S4.SS1.p1.22.m5.1.1.2.cmml">λ</mi><mi id="S4.SS1.p1.22.m5.1.1.3" xref="S4.SS1.p1.22.m5.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.22.m5.1b"><apply id="S4.SS1.p1.22.m5.1.1.cmml" xref="S4.SS1.p1.22.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.22.m5.1.1.1.cmml" xref="S4.SS1.p1.22.m5.1.1">subscript</csymbol><ci id="S4.SS1.p1.22.m5.1.1.2.cmml" xref="S4.SS1.p1.22.m5.1.1.2">𝜆</ci><ci id="S4.SS1.p1.22.m5.1.1.3.cmml" xref="S4.SS1.p1.22.m5.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.22.m5.1c">\lambda_{p}</annotation></semantics></math> and <math id="S4.SS1.p1.23.m6.1" class="ltx_Math" alttext="\lambda_{z}" display="inline"><semantics id="S4.SS1.p1.23.m6.1a"><msub id="S4.SS1.p1.23.m6.1.1" xref="S4.SS1.p1.23.m6.1.1.cmml"><mi id="S4.SS1.p1.23.m6.1.1.2" xref="S4.SS1.p1.23.m6.1.1.2.cmml">λ</mi><mi id="S4.SS1.p1.23.m6.1.1.3" xref="S4.SS1.p1.23.m6.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.23.m6.1b"><apply id="S4.SS1.p1.23.m6.1.1.cmml" xref="S4.SS1.p1.23.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.23.m6.1.1.1.cmml" xref="S4.SS1.p1.23.m6.1.1">subscript</csymbol><ci id="S4.SS1.p1.23.m6.1.1.2.cmml" xref="S4.SS1.p1.23.m6.1.1.2">𝜆</ci><ci id="S4.SS1.p1.23.m6.1.1.3.cmml" xref="S4.SS1.p1.23.m6.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.23.m6.1c">\lambda_{z}</annotation></semantics></math>
are coefficients of each term.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.3" class="ltx_p">Since only a few training images are available in the target domain, only
scale and shift parameters of the batch normalization of <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">G</annotation></semantics></math> are updated
in practice. Specifically, only the <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\gamma</annotation></semantics></math> and <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\beta</annotation></semantics></math>
of each batch normalization layer are updated in each layer,</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.3" class="ltx_Math" alttext="\hat{x}=\frac{x-\mathrm{\mathbb{E}}(x)}{\sqrt{\mathrm{Var}(x)+\epsilon}}\qquad h=\gamma\hat{x}+\beta," display="block"><semantics id="S4.E2.m1.3a"><mrow id="S4.E2.m1.3.3.1"><mrow id="S4.E2.m1.3.3.1.1.2" xref="S4.E2.m1.3.3.1.1.3.cmml"><mrow id="S4.E2.m1.3.3.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.cmml"><mover accent="true" id="S4.E2.m1.3.3.1.1.1.1.2" xref="S4.E2.m1.3.3.1.1.1.1.2.cmml"><mi id="S4.E2.m1.3.3.1.1.1.1.2.2" xref="S4.E2.m1.3.3.1.1.1.1.2.2.cmml">x</mi><mo id="S4.E2.m1.3.3.1.1.1.1.2.1" xref="S4.E2.m1.3.3.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S4.E2.m1.3.3.1.1.1.1.1" xref="S4.E2.m1.3.3.1.1.1.1.1.cmml">=</mo><mfrac id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml"><mrow id="S4.E2.m1.1.1.1" xref="S4.E2.m1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.3" xref="S4.E2.m1.1.1.1.3.cmml">x</mi><mo id="S4.E2.m1.1.1.1.2" xref="S4.E2.m1.1.1.1.2.cmml">−</mo><mrow id="S4.E2.m1.1.1.1.4" xref="S4.E2.m1.1.1.1.4.cmml"><mi id="S4.E2.m1.1.1.1.4.2" xref="S4.E2.m1.1.1.1.4.2.cmml">𝔼</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.4.1" xref="S4.E2.m1.1.1.1.4.1.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.4.3.2" xref="S4.E2.m1.1.1.1.4.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.4.3.2.1" xref="S4.E2.m1.1.1.1.4.cmml">(</mo><mi id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E2.m1.1.1.1.4.3.2.2" xref="S4.E2.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow><msqrt id="S4.E2.m1.2.2.2" xref="S4.E2.m1.2.2.2.cmml"><mrow id="S4.E2.m1.2.2.2.1.1" xref="S4.E2.m1.2.2.2.1.1.cmml"><mrow id="S4.E2.m1.2.2.2.1.1.3" xref="S4.E2.m1.2.2.2.1.1.3.cmml"><mi id="S4.E2.m1.2.2.2.1.1.3.2" xref="S4.E2.m1.2.2.2.1.1.3.2.cmml">Var</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.1.1.3.1" xref="S4.E2.m1.2.2.2.1.1.3.1.cmml">​</mo><mrow id="S4.E2.m1.2.2.2.1.1.3.3.2" xref="S4.E2.m1.2.2.2.1.1.3.cmml"><mo stretchy="false" id="S4.E2.m1.2.2.2.1.1.3.3.2.1" xref="S4.E2.m1.2.2.2.1.1.3.cmml">(</mo><mi id="S4.E2.m1.2.2.2.1.1.1" xref="S4.E2.m1.2.2.2.1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E2.m1.2.2.2.1.1.3.3.2.2" xref="S4.E2.m1.2.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.2.2.2.1.1.2" xref="S4.E2.m1.2.2.2.1.1.2.cmml">+</mo><mi id="S4.E2.m1.2.2.2.1.1.4" xref="S4.E2.m1.2.2.2.1.1.4.cmml">ϵ</mi></mrow></msqrt></mfrac></mrow><mspace width="2em" id="S4.E2.m1.3.3.1.1.2.3" xref="S4.E2.m1.3.3.1.1.3a.cmml"></mspace><mrow id="S4.E2.m1.3.3.1.1.2.2" xref="S4.E2.m1.3.3.1.1.2.2.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.2" xref="S4.E2.m1.3.3.1.1.2.2.2.cmml">h</mi><mo id="S4.E2.m1.3.3.1.1.2.2.1" xref="S4.E2.m1.3.3.1.1.2.2.1.cmml">=</mo><mrow id="S4.E2.m1.3.3.1.1.2.2.3" xref="S4.E2.m1.3.3.1.1.2.2.3.cmml"><mrow id="S4.E2.m1.3.3.1.1.2.2.3.2" xref="S4.E2.m1.3.3.1.1.2.2.3.2.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.3.2.2" xref="S4.E2.m1.3.3.1.1.2.2.3.2.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.3.1.1.2.2.3.2.1" xref="S4.E2.m1.3.3.1.1.2.2.3.2.1.cmml">​</mo><mover accent="true" id="S4.E2.m1.3.3.1.1.2.2.3.2.3" xref="S4.E2.m1.3.3.1.1.2.2.3.2.3.cmml"><mi id="S4.E2.m1.3.3.1.1.2.2.3.2.3.2" xref="S4.E2.m1.3.3.1.1.2.2.3.2.3.2.cmml">x</mi><mo id="S4.E2.m1.3.3.1.1.2.2.3.2.3.1" xref="S4.E2.m1.3.3.1.1.2.2.3.2.3.1.cmml">^</mo></mover></mrow><mo id="S4.E2.m1.3.3.1.1.2.2.3.1" xref="S4.E2.m1.3.3.1.1.2.2.3.1.cmml">+</mo><mi id="S4.E2.m1.3.3.1.1.2.2.3.3" xref="S4.E2.m1.3.3.1.1.2.2.3.3.cmml">β</mi></mrow></mrow></mrow><mo id="S4.E2.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.3b"><apply id="S4.E2.m1.3.3.1.1.3.cmml" xref="S4.E2.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.1.1.3a.cmml" xref="S4.E2.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E2.m1.3.3.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1"><eq id="S4.E2.m1.3.3.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.1"></eq><apply id="S4.E2.m1.3.3.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.2"><ci id="S4.E2.m1.3.3.1.1.1.1.2.1.cmml" xref="S4.E2.m1.3.3.1.1.1.1.2.1">^</ci><ci id="S4.E2.m1.3.3.1.1.1.1.2.2.cmml" xref="S4.E2.m1.3.3.1.1.1.1.2.2">𝑥</ci></apply><apply id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2"><divide id="S4.E2.m1.2.2.3.cmml" xref="S4.E2.m1.2.2"></divide><apply id="S4.E2.m1.1.1.1.cmml" xref="S4.E2.m1.1.1.1"><minus id="S4.E2.m1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.2"></minus><ci id="S4.E2.m1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.3">𝑥</ci><apply id="S4.E2.m1.1.1.1.4.cmml" xref="S4.E2.m1.1.1.1.4"><times id="S4.E2.m1.1.1.1.4.1.cmml" xref="S4.E2.m1.1.1.1.4.1"></times><ci id="S4.E2.m1.1.1.1.4.2.cmml" xref="S4.E2.m1.1.1.1.4.2">𝔼</ci><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝑥</ci></apply></apply><apply id="S4.E2.m1.2.2.2.cmml" xref="S4.E2.m1.2.2.2"><root id="S4.E2.m1.2.2.2a.cmml" xref="S4.E2.m1.2.2.2"></root><apply id="S4.E2.m1.2.2.2.1.1.cmml" xref="S4.E2.m1.2.2.2.1.1"><plus id="S4.E2.m1.2.2.2.1.1.2.cmml" xref="S4.E2.m1.2.2.2.1.1.2"></plus><apply id="S4.E2.m1.2.2.2.1.1.3.cmml" xref="S4.E2.m1.2.2.2.1.1.3"><times id="S4.E2.m1.2.2.2.1.1.3.1.cmml" xref="S4.E2.m1.2.2.2.1.1.3.1"></times><ci id="S4.E2.m1.2.2.2.1.1.3.2.cmml" xref="S4.E2.m1.2.2.2.1.1.3.2">Var</ci><ci id="S4.E2.m1.2.2.2.1.1.1.cmml" xref="S4.E2.m1.2.2.2.1.1.1">𝑥</ci></apply><ci id="S4.E2.m1.2.2.2.1.1.4.cmml" xref="S4.E2.m1.2.2.2.1.1.4">italic-ϵ</ci></apply></apply></apply></apply><apply id="S4.E2.m1.3.3.1.1.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2"><eq id="S4.E2.m1.3.3.1.1.2.2.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.1"></eq><ci id="S4.E2.m1.3.3.1.1.2.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.2">ℎ</ci><apply id="S4.E2.m1.3.3.1.1.2.2.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.3"><plus id="S4.E2.m1.3.3.1.1.2.2.3.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.3.1"></plus><apply id="S4.E2.m1.3.3.1.1.2.2.3.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.3.2"><times id="S4.E2.m1.3.3.1.1.2.2.3.2.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.3.2.1"></times><ci id="S4.E2.m1.3.3.1.1.2.2.3.2.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.3.2.2">𝛾</ci><apply id="S4.E2.m1.3.3.1.1.2.2.3.2.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.3.2.3"><ci id="S4.E2.m1.3.3.1.1.2.2.3.2.3.1.cmml" xref="S4.E2.m1.3.3.1.1.2.2.3.2.3.1">^</ci><ci id="S4.E2.m1.3.3.1.1.2.2.3.2.3.2.cmml" xref="S4.E2.m1.3.3.1.1.2.2.3.2.3.2">𝑥</ci></apply></apply><ci id="S4.E2.m1.3.3.1.1.2.2.3.3.cmml" xref="S4.E2.m1.3.3.1.1.2.2.3.3">𝛽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.3c">\hat{x}=\frac{x-\mathrm{\mathbb{E}}(x)}{\sqrt{\mathrm{Var}(x)+\epsilon}}\qquad h=\gamma\hat{x}+\beta,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.16" class="ltx_p">where <math id="S4.SS1.p2.4.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p2.4.m1.1a"><mi id="S4.SS1.p2.4.m1.1.1" xref="S4.SS1.p2.4.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m1.1b"><ci id="S4.SS1.p2.4.m1.1.1.cmml" xref="S4.SS1.p2.4.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m1.1c">x</annotation></semantics></math> is the input feature from the previous layer, and <math id="S4.SS1.p2.5.m2.1" class="ltx_Math" alttext="\mathbb{E}" display="inline"><semantics id="S4.SS1.p2.5.m2.1a"><mi id="S4.SS1.p2.5.m2.1.1" xref="S4.SS1.p2.5.m2.1.1.cmml">𝔼</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m2.1b"><ci id="S4.SS1.p2.5.m2.1.1.cmml" xref="S4.SS1.p2.5.m2.1.1">𝔼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m2.1c">\mathbb{E}</annotation></semantics></math>
and <math id="S4.SS1.p2.6.m3.1" class="ltx_Math" alttext="\mathrm{Var}" display="inline"><semantics id="S4.SS1.p2.6.m3.1a"><mi id="S4.SS1.p2.6.m3.1.1" xref="S4.SS1.p2.6.m3.1.1.cmml">Var</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m3.1b"><ci id="S4.SS1.p2.6.m3.1.1.cmml" xref="S4.SS1.p2.6.m3.1.1">Var</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m3.1c">\mathrm{Var}</annotation></semantics></math> indicate the mean and variance functions, respectively. Intuitively
and in principle, updating <math id="S4.SS1.p2.7.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.p2.7.m4.1a"><mi id="S4.SS1.p2.7.m4.1.1" xref="S4.SS1.p2.7.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m4.1b"><ci id="S4.SS1.p2.7.m4.1.1.cmml" xref="S4.SS1.p2.7.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m4.1c">\gamma</annotation></semantics></math> and <math id="S4.SS1.p2.8.m5.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p2.8.m5.1a"><mi id="S4.SS1.p2.8.m5.1.1" xref="S4.SS1.p2.8.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m5.1b"><ci id="S4.SS1.p2.8.m5.1.1.cmml" xref="S4.SS1.p2.8.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m5.1c">\beta</annotation></semantics></math> only is equivalent
to adjusting the activation of each neuron in a layer. Once updated,
the <math id="S4.SS1.p2.9.m6.1" class="ltx_Math" alttext="G(z)" display="inline"><semantics id="S4.SS1.p2.9.m6.1a"><mrow id="S4.SS1.p2.9.m6.1.2" xref="S4.SS1.p2.9.m6.1.2.cmml"><mi id="S4.SS1.p2.9.m6.1.2.2" xref="S4.SS1.p2.9.m6.1.2.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.9.m6.1.2.1" xref="S4.SS1.p2.9.m6.1.2.1.cmml">​</mo><mrow id="S4.SS1.p2.9.m6.1.2.3.2" xref="S4.SS1.p2.9.m6.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.9.m6.1.2.3.2.1" xref="S4.SS1.p2.9.m6.1.2.cmml">(</mo><mi id="S4.SS1.p2.9.m6.1.1" xref="S4.SS1.p2.9.m6.1.1.cmml">z</mi><mo stretchy="false" id="S4.SS1.p2.9.m6.1.2.3.2.2" xref="S4.SS1.p2.9.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m6.1b"><apply id="S4.SS1.p2.9.m6.1.2.cmml" xref="S4.SS1.p2.9.m6.1.2"><times id="S4.SS1.p2.9.m6.1.2.1.cmml" xref="S4.SS1.p2.9.m6.1.2.1"></times><ci id="S4.SS1.p2.9.m6.1.2.2.cmml" xref="S4.SS1.p2.9.m6.1.2.2">𝐺</ci><ci id="S4.SS1.p2.9.m6.1.1.cmml" xref="S4.SS1.p2.9.m6.1.1">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m6.1c">G(z)</annotation></semantics></math> would be synthesized to reconstruct the image <math id="S4.SS1.p2.10.m7.1" class="ltx_Math" alttext="\mathbf{I}_{z}" display="inline"><semantics id="S4.SS1.p2.10.m7.1a"><msub id="S4.SS1.p2.10.m7.1.1" xref="S4.SS1.p2.10.m7.1.1.cmml"><mi id="S4.SS1.p2.10.m7.1.1.2" xref="S4.SS1.p2.10.m7.1.1.2.cmml">𝐈</mi><mi id="S4.SS1.p2.10.m7.1.1.3" xref="S4.SS1.p2.10.m7.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m7.1b"><apply id="S4.SS1.p2.10.m7.1.1.cmml" xref="S4.SS1.p2.10.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.10.m7.1.1.1.cmml" xref="S4.SS1.p2.10.m7.1.1">subscript</csymbol><ci id="S4.SS1.p2.10.m7.1.1.2.cmml" xref="S4.SS1.p2.10.m7.1.1.2">𝐈</ci><ci id="S4.SS1.p2.10.m7.1.1.3.cmml" xref="S4.SS1.p2.10.m7.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m7.1c">\mathbf{I}_{z}</annotation></semantics></math>.
Empirically, a small random perturbation <math id="S4.SS1.p2.11.m8.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS1.p2.11.m8.1a"><mi id="S4.SS1.p2.11.m8.1.1" xref="S4.SS1.p2.11.m8.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m8.1b"><ci id="S4.SS1.p2.11.m8.1.1.cmml" xref="S4.SS1.p2.11.m8.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.11.m8.1c">\epsilon</annotation></semantics></math> is added to
<math id="S4.SS1.p2.12.m9.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS1.p2.12.m9.1a"><mi id="S4.SS1.p2.12.m9.1.1" xref="S4.SS1.p2.12.m9.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.12.m9.1b"><ci id="S4.SS1.p2.12.m9.1.1.cmml" xref="S4.SS1.p2.12.m9.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.12.m9.1c">z</annotation></semantics></math> as <math id="S4.SS1.p2.13.m10.1" class="ltx_Math" alttext="G\left(z+\epsilon\right)" display="inline"><semantics id="S4.SS1.p2.13.m10.1a"><mrow id="S4.SS1.p2.13.m10.1.1" xref="S4.SS1.p2.13.m10.1.1.cmml"><mi id="S4.SS1.p2.13.m10.1.1.3" xref="S4.SS1.p2.13.m10.1.1.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.13.m10.1.1.2" xref="S4.SS1.p2.13.m10.1.1.2.cmml">​</mo><mrow id="S4.SS1.p2.13.m10.1.1.1.1" xref="S4.SS1.p2.13.m10.1.1.1.1.1.cmml"><mo id="S4.SS1.p2.13.m10.1.1.1.1.2" xref="S4.SS1.p2.13.m10.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.13.m10.1.1.1.1.1" xref="S4.SS1.p2.13.m10.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.13.m10.1.1.1.1.1.2" xref="S4.SS1.p2.13.m10.1.1.1.1.1.2.cmml">z</mi><mo id="S4.SS1.p2.13.m10.1.1.1.1.1.1" xref="S4.SS1.p2.13.m10.1.1.1.1.1.1.cmml">+</mo><mi id="S4.SS1.p2.13.m10.1.1.1.1.1.3" xref="S4.SS1.p2.13.m10.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="S4.SS1.p2.13.m10.1.1.1.1.3" xref="S4.SS1.p2.13.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.13.m10.1b"><apply id="S4.SS1.p2.13.m10.1.1.cmml" xref="S4.SS1.p2.13.m10.1.1"><times id="S4.SS1.p2.13.m10.1.1.2.cmml" xref="S4.SS1.p2.13.m10.1.1.2"></times><ci id="S4.SS1.p2.13.m10.1.1.3.cmml" xref="S4.SS1.p2.13.m10.1.1.3">𝐺</ci><apply id="S4.SS1.p2.13.m10.1.1.1.1.1.cmml" xref="S4.SS1.p2.13.m10.1.1.1.1"><plus id="S4.SS1.p2.13.m10.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.13.m10.1.1.1.1.1.1"></plus><ci id="S4.SS1.p2.13.m10.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.13.m10.1.1.1.1.1.2">𝑧</ci><ci id="S4.SS1.p2.13.m10.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.13.m10.1.1.1.1.1.3">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.13.m10.1c">G\left(z+\epsilon\right)</annotation></semantics></math>.
Examples of <math id="S4.SS1.p2.14.m11.1" class="ltx_Math" alttext="\mathbf{I}_{z}" display="inline"><semantics id="S4.SS1.p2.14.m11.1a"><msub id="S4.SS1.p2.14.m11.1.1" xref="S4.SS1.p2.14.m11.1.1.cmml"><mi id="S4.SS1.p2.14.m11.1.1.2" xref="S4.SS1.p2.14.m11.1.1.2.cmml">𝐈</mi><mi id="S4.SS1.p2.14.m11.1.1.3" xref="S4.SS1.p2.14.m11.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.14.m11.1b"><apply id="S4.SS1.p2.14.m11.1.1.cmml" xref="S4.SS1.p2.14.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.14.m11.1.1.1.cmml" xref="S4.SS1.p2.14.m11.1.1">subscript</csymbol><ci id="S4.SS1.p2.14.m11.1.1.2.cmml" xref="S4.SS1.p2.14.m11.1.1.2">𝐈</ci><ci id="S4.SS1.p2.14.m11.1.1.3.cmml" xref="S4.SS1.p2.14.m11.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.14.m11.1c">\mathbf{I}_{z}</annotation></semantics></math>, <math id="S4.SS1.p2.15.m12.1" class="ltx_Math" alttext="G(z)" display="inline"><semantics id="S4.SS1.p2.15.m12.1a"><mrow id="S4.SS1.p2.15.m12.1.2" xref="S4.SS1.p2.15.m12.1.2.cmml"><mi id="S4.SS1.p2.15.m12.1.2.2" xref="S4.SS1.p2.15.m12.1.2.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.15.m12.1.2.1" xref="S4.SS1.p2.15.m12.1.2.1.cmml">​</mo><mrow id="S4.SS1.p2.15.m12.1.2.3.2" xref="S4.SS1.p2.15.m12.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.15.m12.1.2.3.2.1" xref="S4.SS1.p2.15.m12.1.2.cmml">(</mo><mi id="S4.SS1.p2.15.m12.1.1" xref="S4.SS1.p2.15.m12.1.1.cmml">z</mi><mo stretchy="false" id="S4.SS1.p2.15.m12.1.2.3.2.2" xref="S4.SS1.p2.15.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.15.m12.1b"><apply id="S4.SS1.p2.15.m12.1.2.cmml" xref="S4.SS1.p2.15.m12.1.2"><times id="S4.SS1.p2.15.m12.1.2.1.cmml" xref="S4.SS1.p2.15.m12.1.2.1"></times><ci id="S4.SS1.p2.15.m12.1.2.2.cmml" xref="S4.SS1.p2.15.m12.1.2.2">𝐺</ci><ci id="S4.SS1.p2.15.m12.1.1.cmml" xref="S4.SS1.p2.15.m12.1.1">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.15.m12.1c">G(z)</annotation></semantics></math> and <math id="S4.SS1.p2.16.m13.1" class="ltx_Math" alttext="G\left(z+\epsilon\right)" display="inline"><semantics id="S4.SS1.p2.16.m13.1a"><mrow id="S4.SS1.p2.16.m13.1.1" xref="S4.SS1.p2.16.m13.1.1.cmml"><mi id="S4.SS1.p2.16.m13.1.1.3" xref="S4.SS1.p2.16.m13.1.1.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.16.m13.1.1.2" xref="S4.SS1.p2.16.m13.1.1.2.cmml">​</mo><mrow id="S4.SS1.p2.16.m13.1.1.1.1" xref="S4.SS1.p2.16.m13.1.1.1.1.1.cmml"><mo id="S4.SS1.p2.16.m13.1.1.1.1.2" xref="S4.SS1.p2.16.m13.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p2.16.m13.1.1.1.1.1" xref="S4.SS1.p2.16.m13.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.16.m13.1.1.1.1.1.2" xref="S4.SS1.p2.16.m13.1.1.1.1.1.2.cmml">z</mi><mo id="S4.SS1.p2.16.m13.1.1.1.1.1.1" xref="S4.SS1.p2.16.m13.1.1.1.1.1.1.cmml">+</mo><mi id="S4.SS1.p2.16.m13.1.1.1.1.1.3" xref="S4.SS1.p2.16.m13.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo id="S4.SS1.p2.16.m13.1.1.1.1.3" xref="S4.SS1.p2.16.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.16.m13.1b"><apply id="S4.SS1.p2.16.m13.1.1.cmml" xref="S4.SS1.p2.16.m13.1.1"><times id="S4.SS1.p2.16.m13.1.1.2.cmml" xref="S4.SS1.p2.16.m13.1.1.2"></times><ci id="S4.SS1.p2.16.m13.1.1.3.cmml" xref="S4.SS1.p2.16.m13.1.1.3">𝐺</ci><apply id="S4.SS1.p2.16.m13.1.1.1.1.1.cmml" xref="S4.SS1.p2.16.m13.1.1.1.1"><plus id="S4.SS1.p2.16.m13.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.16.m13.1.1.1.1.1.1"></plus><ci id="S4.SS1.p2.16.m13.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.16.m13.1.1.1.1.1.2">𝑧</ci><ci id="S4.SS1.p2.16.m13.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.16.m13.1.1.1.1.1.3">italic-ϵ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.16.m13.1c">G\left(z+\epsilon\right)</annotation></semantics></math>
are illustrated in in Fig. <a href="#S3.F1" title="Figure 1 ‣ 3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (a), (e),
and (f), respectively.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Meta Reinforced Synthetic Data for Few-shot Learning </h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We propose a meta-learning method to add synthetic data to the originals.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.21" class="ltx_p"><span id="S4.SS2.p2.21.1" class="ltx_text ltx_font_bold">One-shot Learning.</span> One-shot classification is a
meta-learning problem that divide a dataset into two sets:
meta-training (or base) set and meta-testing (or novel) set. The
classes in the base set and the novel sets are disjoint. In other
words, we have <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{base}=\left\{\left(\mathbf{I}_{i},y_{i}\right),y_{i}\in\mathcal{C}_{base}\right\}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><msub id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.1.m1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.3.2.cmml">𝒟</mi><mrow id="S4.SS2.p2.1.m1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.3.2" xref="S4.SS2.p2.1.m1.1.1.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.3.3.1" xref="S4.SS2.p2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.1.m1.1.1.3.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.3.3.1a" xref="S4.SS2.p2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.1.m1.1.1.3.3.4" xref="S4.SS2.p2.1.m1.1.1.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.3.3.1b" xref="S4.SS2.p2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.1.m1.1.1.3.3.5" xref="S4.SS2.p2.1.m1.1.1.3.3.5.cmml">e</mi></mrow></msub><mo id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">=</mo><mrow id="S4.SS2.p2.1.m1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.2.cmml"><mo id="S4.SS2.p2.1.m1.1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.1.2.cmml">{</mo><mrow id="S4.SS2.p2.1.m1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.cmml"><mrow id="S4.SS2.p2.1.m1.1.1.1.1.1.2.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.3.cmml"><mrow id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐈</mi><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.4" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.5" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow><mo id="S4.SS2.p2.1.m1.1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.3.cmml">∈</mo><msub id="S4.SS2.p2.1.m1.1.1.1.1.1.4" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.1.m1.1.1.1.1.1.4.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.2.cmml">𝒞</mi><mrow id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.1a" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.4" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.1b" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.5" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.5.cmml">e</mi></mrow></msub></mrow><mo id="S4.SS2.p2.1.m1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2"></eq><apply id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2">𝒟</ci><apply id="S4.SS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3"><times id="S4.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.1"></times><ci id="S4.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.2">𝑏</ci><ci id="S4.SS2.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.3">𝑎</ci><ci id="S4.SS2.p2.1.m1.1.1.3.3.4.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.4">𝑠</ci><ci id="S4.SS2.p2.1.m1.1.1.3.3.5.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3.5">𝑒</ci></apply></apply><set id="S4.SS2.p2.1.m1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1"><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1"><in id="S4.SS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.3"></in><list id="S4.SS2.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.2"><interval closure="open" id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2"><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2">𝐈</ci><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply></list><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.4.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.1.1.4.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.4.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.2">𝒞</ci><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3"><times id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.1"></times><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.2">𝑏</ci><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.3">𝑎</ci><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.4.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.4">𝑠</ci><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.5.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.4.3.5">𝑒</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\mathcal{D}_{base}=\left\{\left(\mathbf{I}_{i},y_{i}\right),y_{i}\in\mathcal{C}_{base}\right\}</annotation></semantics></math> and <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{novel}=\left\{\left(\mathbf{I}_{i},y_{i}\right),y_{i}\in\mathcal{C}_{novel}\right\}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><msub id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">𝒟</mi><mrow id="S4.SS2.p2.2.m2.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.3.2" xref="S4.SS2.p2.2.m2.1.1.3.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.3.3.1" xref="S4.SS2.p2.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.3.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.3.3.1a" xref="S4.SS2.p2.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.3.3.4" xref="S4.SS2.p2.2.m2.1.1.3.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.3.3.1b" xref="S4.SS2.p2.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.3.3.5" xref="S4.SS2.p2.2.m2.1.1.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.3.3.1c" xref="S4.SS2.p2.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.3.3.6" xref="S4.SS2.p2.2.m2.1.1.3.3.6.cmml">l</mi></mrow></msub><mo id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">=</mo><mrow id="S4.SS2.p2.2.m2.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.2.cmml"><mo id="S4.SS2.p2.2.m2.1.1.1.1.2" xref="S4.SS2.p2.2.m2.1.1.1.2.cmml">{</mo><mrow id="S4.SS2.p2.2.m2.1.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.1.cmml"><mrow id="S4.SS2.p2.2.m2.1.1.1.1.1.2.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.3.cmml"><mrow id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.cmml"><mo id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐈</mi><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.4" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.5" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow><mo id="S4.SS2.p2.2.m2.1.1.1.1.1.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.3.cmml">∈</mo><msub id="S4.SS2.p2.2.m2.1.1.1.1.1.4" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.2.m2.1.1.1.1.1.4.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.2.cmml">𝒞</mi><mrow id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.1" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.1a" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.4" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.1b" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.5" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.1c" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.6" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.6.cmml">l</mi></mrow></msub></mrow><mo id="S4.SS2.p2.2.m2.1.1.1.1.3" xref="S4.SS2.p2.2.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><eq id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2"></eq><apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">𝒟</ci><apply id="S4.SS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3"><times id="S4.SS2.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.1"></times><ci id="S4.SS2.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.2">𝑛</ci><ci id="S4.SS2.p2.2.m2.1.1.3.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3">𝑜</ci><ci id="S4.SS2.p2.2.m2.1.1.3.3.4.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.4">𝑣</ci><ci id="S4.SS2.p2.2.m2.1.1.3.3.5.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.5">𝑒</ci><ci id="S4.SS2.p2.2.m2.1.1.3.3.6.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.6">𝑙</ci></apply></apply><set id="S4.SS2.p2.2.m2.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1"><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1"><in id="S4.SS2.p2.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.3"></in><list id="S4.SS2.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.2"><interval closure="open" id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2"><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.2">𝐈</ci><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.2.2.3">𝑖</ci></apply></list><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.4.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.1.1.4.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.4.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.2">𝒞</ci><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3"><times id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.1"></times><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.2">𝑛</ci><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.3">𝑜</ci><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.4.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.4">𝑣</ci><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.5.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.5">𝑒</ci><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.6.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.4.3.6">𝑙</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\mathcal{D}_{novel}=\left\{\left(\mathbf{I}_{i},y_{i}\right),y_{i}\in\mathcal{C}_{novel}\right\}</annotation></semantics></math> where <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{C}_{base}\cup\mathcal{C}_{novel}=\emptyset" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mrow id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml"><msub id="S4.SS2.p2.3.m3.1.1.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.3.m3.1.1.2.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2.2.cmml">𝒞</mi><mrow id="S4.SS2.p2.3.m3.1.1.2.2.3" xref="S4.SS2.p2.3.m3.1.1.2.2.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2.2.3.2" xref="S4.SS2.p2.3.m3.1.1.2.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1.2.2.3.1" xref="S4.SS2.p2.3.m3.1.1.2.2.3.1.cmml">​</mo><mi id="S4.SS2.p2.3.m3.1.1.2.2.3.3" xref="S4.SS2.p2.3.m3.1.1.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1.2.2.3.1a" xref="S4.SS2.p2.3.m3.1.1.2.2.3.1.cmml">​</mo><mi id="S4.SS2.p2.3.m3.1.1.2.2.3.4" xref="S4.SS2.p2.3.m3.1.1.2.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1.2.2.3.1b" xref="S4.SS2.p2.3.m3.1.1.2.2.3.1.cmml">​</mo><mi id="S4.SS2.p2.3.m3.1.1.2.2.3.5" xref="S4.SS2.p2.3.m3.1.1.2.2.3.5.cmml">e</mi></mrow></msub><mo id="S4.SS2.p2.3.m3.1.1.2.1" xref="S4.SS2.p2.3.m3.1.1.2.1.cmml">∪</mo><msub id="S4.SS2.p2.3.m3.1.1.2.3" xref="S4.SS2.p2.3.m3.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.3.m3.1.1.2.3.2" xref="S4.SS2.p2.3.m3.1.1.2.3.2.cmml">𝒞</mi><mrow id="S4.SS2.p2.3.m3.1.1.2.3.3" xref="S4.SS2.p2.3.m3.1.1.2.3.3.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2.3.3.2" xref="S4.SS2.p2.3.m3.1.1.2.3.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1.2.3.3.1" xref="S4.SS2.p2.3.m3.1.1.2.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.3.m3.1.1.2.3.3.3" xref="S4.SS2.p2.3.m3.1.1.2.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1.2.3.3.1a" xref="S4.SS2.p2.3.m3.1.1.2.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.3.m3.1.1.2.3.3.4" xref="S4.SS2.p2.3.m3.1.1.2.3.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1.2.3.3.1b" xref="S4.SS2.p2.3.m3.1.1.2.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.3.m3.1.1.2.3.3.5" xref="S4.SS2.p2.3.m3.1.1.2.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.3.m3.1.1.2.3.3.1c" xref="S4.SS2.p2.3.m3.1.1.2.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.3.m3.1.1.2.3.3.6" xref="S4.SS2.p2.3.m3.1.1.2.3.3.6.cmml">l</mi></mrow></msub></mrow><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><eq id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></eq><apply id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2"><union id="S4.SS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2.1"></union><apply id="S4.SS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2.2">𝒞</ci><apply id="S4.SS2.p2.3.m3.1.1.2.2.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2.3"><times id="S4.SS2.p2.3.m3.1.1.2.2.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2.3.1"></times><ci id="S4.SS2.p2.3.m3.1.1.2.2.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2.3.2">𝑏</ci><ci id="S4.SS2.p2.3.m3.1.1.2.2.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2.3.3">𝑎</ci><ci id="S4.SS2.p2.3.m3.1.1.2.2.3.4.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2.3.4">𝑠</ci><ci id="S4.SS2.p2.3.m3.1.1.2.2.3.5.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2.3.5">𝑒</ci></apply></apply><apply id="S4.SS2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3.2">𝒞</ci><apply id="S4.SS2.p2.3.m3.1.1.2.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3.3"><times id="S4.SS2.p2.3.m3.1.1.2.3.3.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3.3.1"></times><ci id="S4.SS2.p2.3.m3.1.1.2.3.3.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3.3.2">𝑛</ci><ci id="S4.SS2.p2.3.m3.1.1.2.3.3.3.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3.3.3">𝑜</ci><ci id="S4.SS2.p2.3.m3.1.1.2.3.3.4.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3.3.4">𝑣</ci><ci id="S4.SS2.p2.3.m3.1.1.2.3.3.5.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3.3.5">𝑒</ci><ci id="S4.SS2.p2.3.m3.1.1.2.3.3.6.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3.3.6">𝑙</ci></apply></apply></apply><emptyset id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\mathcal{C}_{base}\cup\mathcal{C}_{novel}=\emptyset</annotation></semantics></math>. The task is to train a classifier on
<math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{base}" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><msub id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">𝒟</mi><mrow id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml"><mi id="S4.SS2.p2.4.m4.1.1.3.2" xref="S4.SS2.p2.4.m4.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.4.m4.1.1.3.1" xref="S4.SS2.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.4.m4.1.1.3.3" xref="S4.SS2.p2.4.m4.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.4.m4.1.1.3.1a" xref="S4.SS2.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.4.m4.1.1.3.4" xref="S4.SS2.p2.4.m4.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.4.m4.1.1.3.1b" xref="S4.SS2.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.4.m4.1.1.3.5" xref="S4.SS2.p2.4.m4.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝒟</ci><apply id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3"><times id="S4.SS2.p2.4.m4.1.1.3.1.cmml" xref="S4.SS2.p2.4.m4.1.1.3.1"></times><ci id="S4.SS2.p2.4.m4.1.1.3.2.cmml" xref="S4.SS2.p2.4.m4.1.1.3.2">𝑏</ci><ci id="S4.SS2.p2.4.m4.1.1.3.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3.3">𝑎</ci><ci id="S4.SS2.p2.4.m4.1.1.3.4.cmml" xref="S4.SS2.p2.4.m4.1.1.3.4">𝑠</ci><ci id="S4.SS2.p2.4.m4.1.1.3.5.cmml" xref="S4.SS2.p2.4.m4.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\mathcal{D}_{base}</annotation></semantics></math> that can quickly generalize to unseen classes in
<math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{C}_{novel}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><msub id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">𝒞</mi><mrow id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml"><mi id="S4.SS2.p2.5.m5.1.1.3.2" xref="S4.SS2.p2.5.m5.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.1.1.3.1" xref="S4.SS2.p2.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.5.m5.1.1.3.3" xref="S4.SS2.p2.5.m5.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.1.1.3.1a" xref="S4.SS2.p2.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.5.m5.1.1.3.4" xref="S4.SS2.p2.5.m5.1.1.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.1.1.3.1b" xref="S4.SS2.p2.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.5.m5.1.1.3.5" xref="S4.SS2.p2.5.m5.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.1.1.3.1c" xref="S4.SS2.p2.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.5.m5.1.1.3.6" xref="S4.SS2.p2.5.m5.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">𝒞</ci><apply id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3"><times id="S4.SS2.p2.5.m5.1.1.3.1.cmml" xref="S4.SS2.p2.5.m5.1.1.3.1"></times><ci id="S4.SS2.p2.5.m5.1.1.3.2.cmml" xref="S4.SS2.p2.5.m5.1.1.3.2">𝑛</ci><ci id="S4.SS2.p2.5.m5.1.1.3.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3.3">𝑜</ci><ci id="S4.SS2.p2.5.m5.1.1.3.4.cmml" xref="S4.SS2.p2.5.m5.1.1.3.4">𝑣</ci><ci id="S4.SS2.p2.5.m5.1.1.3.5.cmml" xref="S4.SS2.p2.5.m5.1.1.3.5">𝑒</ci><ci id="S4.SS2.p2.5.m5.1.1.3.6.cmml" xref="S4.SS2.p2.5.m5.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">\mathcal{C}_{novel}</annotation></semantics></math> with one or few examples. To do this, a
meta-learning algorithm performs meta-training by sampling many
one-shot tasks from <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{base}" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><msub id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">𝒟</mi><mrow id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml"><mi id="S4.SS2.p2.6.m6.1.1.3.2" xref="S4.SS2.p2.6.m6.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m6.1.1.3.1" xref="S4.SS2.p2.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.6.m6.1.1.3.3" xref="S4.SS2.p2.6.m6.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m6.1.1.3.1a" xref="S4.SS2.p2.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.6.m6.1.1.3.4" xref="S4.SS2.p2.6.m6.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.6.m6.1.1.3.1b" xref="S4.SS2.p2.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.6.m6.1.1.3.5" xref="S4.SS2.p2.6.m6.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">𝒟</ci><apply id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3"><times id="S4.SS2.p2.6.m6.1.1.3.1.cmml" xref="S4.SS2.p2.6.m6.1.1.3.1"></times><ci id="S4.SS2.p2.6.m6.1.1.3.2.cmml" xref="S4.SS2.p2.6.m6.1.1.3.2">𝑏</ci><ci id="S4.SS2.p2.6.m6.1.1.3.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3.3">𝑎</ci><ci id="S4.SS2.p2.6.m6.1.1.3.4.cmml" xref="S4.SS2.p2.6.m6.1.1.3.4">𝑠</ci><ci id="S4.SS2.p2.6.m6.1.1.3.5.cmml" xref="S4.SS2.p2.6.m6.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">\mathcal{D}_{base}</annotation></semantics></math>, and is evaluated by sampling
many similar tasks from <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="\mathcal{D}_{novel}" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><msub id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">𝒟</mi><mrow id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml"><mi id="S4.SS2.p2.7.m7.1.1.3.2" xref="S4.SS2.p2.7.m7.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.7.m7.1.1.3.1" xref="S4.SS2.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.7.m7.1.1.3.3" xref="S4.SS2.p2.7.m7.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.7.m7.1.1.3.1a" xref="S4.SS2.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.7.m7.1.1.3.4" xref="S4.SS2.p2.7.m7.1.1.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.7.m7.1.1.3.1b" xref="S4.SS2.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.7.m7.1.1.3.5" xref="S4.SS2.p2.7.m7.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.7.m7.1.1.3.1c" xref="S4.SS2.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.7.m7.1.1.3.6" xref="S4.SS2.p2.7.m7.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">𝒟</ci><apply id="S4.SS2.p2.7.m7.1.1.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3"><times id="S4.SS2.p2.7.m7.1.1.3.1.cmml" xref="S4.SS2.p2.7.m7.1.1.3.1"></times><ci id="S4.SS2.p2.7.m7.1.1.3.2.cmml" xref="S4.SS2.p2.7.m7.1.1.3.2">𝑛</ci><ci id="S4.SS2.p2.7.m7.1.1.3.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3.3">𝑜</ci><ci id="S4.SS2.p2.7.m7.1.1.3.4.cmml" xref="S4.SS2.p2.7.m7.1.1.3.4">𝑣</ci><ci id="S4.SS2.p2.7.m7.1.1.3.5.cmml" xref="S4.SS2.p2.7.m7.1.1.3.5">𝑒</ci><ci id="S4.SS2.p2.7.m7.1.1.3.6.cmml" xref="S4.SS2.p2.7.m7.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">\mathcal{D}_{novel}</annotation></semantics></math>. Each sampled task
(called an episode) is an <math id="S4.SS2.p2.8.m8.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p2.8.m8.1a"><mi id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><ci id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">n</annotation></semantics></math>-way-<math id="S4.SS2.p2.9.m9.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS2.p2.9.m9.1a"><mi id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><ci id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">m</annotation></semantics></math>-shot classification problem with
<math id="S4.SS2.p2.10.m10.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S4.SS2.p2.10.m10.1a"><mi id="S4.SS2.p2.10.m10.1.1" xref="S4.SS2.p2.10.m10.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m10.1b"><ci id="S4.SS2.p2.10.m10.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m10.1c">q</annotation></semantics></math> queries, meaning that we sample <math id="S4.SS2.p2.11.m11.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p2.11.m11.1a"><mi id="S4.SS2.p2.11.m11.1.1" xref="S4.SS2.p2.11.m11.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m11.1b"><ci id="S4.SS2.p2.11.m11.1.1.cmml" xref="S4.SS2.p2.11.m11.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m11.1c">n</annotation></semantics></math> classes with <math id="S4.SS2.p2.12.m12.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS2.p2.12.m12.1a"><mi id="S4.SS2.p2.12.m12.1.1" xref="S4.SS2.p2.12.m12.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.12.m12.1b"><ci id="S4.SS2.p2.12.m12.1.1.cmml" xref="S4.SS2.p2.12.m12.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.12.m12.1c">m</annotation></semantics></math> training and
<math id="S4.SS2.p2.13.m13.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S4.SS2.p2.13.m13.1a"><mi id="S4.SS2.p2.13.m13.1.1" xref="S4.SS2.p2.13.m13.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.13.m13.1b"><ci id="S4.SS2.p2.13.m13.1.1.cmml" xref="S4.SS2.p2.13.m13.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.13.m13.1c">q</annotation></semantics></math> test examples for each class. In other words, an episode has a
support (or training) set <math id="S4.SS2.p2.14.m14.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.SS2.p2.14.m14.1a"><mi id="S4.SS2.p2.14.m14.1.1" xref="S4.SS2.p2.14.m14.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.14.m14.1b"><ci id="S4.SS2.p2.14.m14.1.1.cmml" xref="S4.SS2.p2.14.m14.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.14.m14.1c">S</annotation></semantics></math> and a query (or test) set <math id="S4.SS2.p2.15.m15.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS2.p2.15.m15.1a"><mi id="S4.SS2.p2.15.m15.1.1" xref="S4.SS2.p2.15.m15.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.15.m15.1b"><ci id="S4.SS2.p2.15.m15.1.1.cmml" xref="S4.SS2.p2.15.m15.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.15.m15.1c">Q</annotation></semantics></math>, where
<math id="S4.SS2.p2.16.m16.1" class="ltx_Math" alttext="|S|=n\times m" display="inline"><semantics id="S4.SS2.p2.16.m16.1a"><mrow id="S4.SS2.p2.16.m16.1.2" xref="S4.SS2.p2.16.m16.1.2.cmml"><mrow id="S4.SS2.p2.16.m16.1.2.2.2" xref="S4.SS2.p2.16.m16.1.2.2.1.cmml"><mo stretchy="false" id="S4.SS2.p2.16.m16.1.2.2.2.1" xref="S4.SS2.p2.16.m16.1.2.2.1.1.cmml">|</mo><mi id="S4.SS2.p2.16.m16.1.1" xref="S4.SS2.p2.16.m16.1.1.cmml">S</mi><mo stretchy="false" id="S4.SS2.p2.16.m16.1.2.2.2.2" xref="S4.SS2.p2.16.m16.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.SS2.p2.16.m16.1.2.1" xref="S4.SS2.p2.16.m16.1.2.1.cmml">=</mo><mrow id="S4.SS2.p2.16.m16.1.2.3" xref="S4.SS2.p2.16.m16.1.2.3.cmml"><mi id="S4.SS2.p2.16.m16.1.2.3.2" xref="S4.SS2.p2.16.m16.1.2.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.16.m16.1.2.3.1" xref="S4.SS2.p2.16.m16.1.2.3.1.cmml">×</mo><mi id="S4.SS2.p2.16.m16.1.2.3.3" xref="S4.SS2.p2.16.m16.1.2.3.3.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.16.m16.1b"><apply id="S4.SS2.p2.16.m16.1.2.cmml" xref="S4.SS2.p2.16.m16.1.2"><eq id="S4.SS2.p2.16.m16.1.2.1.cmml" xref="S4.SS2.p2.16.m16.1.2.1"></eq><apply id="S4.SS2.p2.16.m16.1.2.2.1.cmml" xref="S4.SS2.p2.16.m16.1.2.2.2"><abs id="S4.SS2.p2.16.m16.1.2.2.1.1.cmml" xref="S4.SS2.p2.16.m16.1.2.2.2.1"></abs><ci id="S4.SS2.p2.16.m16.1.1.cmml" xref="S4.SS2.p2.16.m16.1.1">𝑆</ci></apply><apply id="S4.SS2.p2.16.m16.1.2.3.cmml" xref="S4.SS2.p2.16.m16.1.2.3"><times id="S4.SS2.p2.16.m16.1.2.3.1.cmml" xref="S4.SS2.p2.16.m16.1.2.3.1"></times><ci id="S4.SS2.p2.16.m16.1.2.3.2.cmml" xref="S4.SS2.p2.16.m16.1.2.3.2">𝑛</ci><ci id="S4.SS2.p2.16.m16.1.2.3.3.cmml" xref="S4.SS2.p2.16.m16.1.2.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.16.m16.1c">|S|=n\times m</annotation></semantics></math> and <math id="S4.SS2.p2.17.m17.1" class="ltx_Math" alttext="|Q|=n\times q" display="inline"><semantics id="S4.SS2.p2.17.m17.1a"><mrow id="S4.SS2.p2.17.m17.1.2" xref="S4.SS2.p2.17.m17.1.2.cmml"><mrow id="S4.SS2.p2.17.m17.1.2.2.2" xref="S4.SS2.p2.17.m17.1.2.2.1.cmml"><mo stretchy="false" id="S4.SS2.p2.17.m17.1.2.2.2.1" xref="S4.SS2.p2.17.m17.1.2.2.1.1.cmml">|</mo><mi id="S4.SS2.p2.17.m17.1.1" xref="S4.SS2.p2.17.m17.1.1.cmml">Q</mi><mo stretchy="false" id="S4.SS2.p2.17.m17.1.2.2.2.2" xref="S4.SS2.p2.17.m17.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.SS2.p2.17.m17.1.2.1" xref="S4.SS2.p2.17.m17.1.2.1.cmml">=</mo><mrow id="S4.SS2.p2.17.m17.1.2.3" xref="S4.SS2.p2.17.m17.1.2.3.cmml"><mi id="S4.SS2.p2.17.m17.1.2.3.2" xref="S4.SS2.p2.17.m17.1.2.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.17.m17.1.2.3.1" xref="S4.SS2.p2.17.m17.1.2.3.1.cmml">×</mo><mi id="S4.SS2.p2.17.m17.1.2.3.3" xref="S4.SS2.p2.17.m17.1.2.3.3.cmml">q</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.17.m17.1b"><apply id="S4.SS2.p2.17.m17.1.2.cmml" xref="S4.SS2.p2.17.m17.1.2"><eq id="S4.SS2.p2.17.m17.1.2.1.cmml" xref="S4.SS2.p2.17.m17.1.2.1"></eq><apply id="S4.SS2.p2.17.m17.1.2.2.1.cmml" xref="S4.SS2.p2.17.m17.1.2.2.2"><abs id="S4.SS2.p2.17.m17.1.2.2.1.1.cmml" xref="S4.SS2.p2.17.m17.1.2.2.2.1"></abs><ci id="S4.SS2.p2.17.m17.1.1.cmml" xref="S4.SS2.p2.17.m17.1.1">𝑄</ci></apply><apply id="S4.SS2.p2.17.m17.1.2.3.cmml" xref="S4.SS2.p2.17.m17.1.2.3"><times id="S4.SS2.p2.17.m17.1.2.3.1.cmml" xref="S4.SS2.p2.17.m17.1.2.3.1"></times><ci id="S4.SS2.p2.17.m17.1.2.3.2.cmml" xref="S4.SS2.p2.17.m17.1.2.3.2">𝑛</ci><ci id="S4.SS2.p2.17.m17.1.2.3.3.cmml" xref="S4.SS2.p2.17.m17.1.2.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.17.m17.1c">|Q|=n\times q</annotation></semantics></math>. One-shot learning means <math id="S4.SS2.p2.18.m18.1" class="ltx_Math" alttext="m=1" display="inline"><semantics id="S4.SS2.p2.18.m18.1a"><mrow id="S4.SS2.p2.18.m18.1.1" xref="S4.SS2.p2.18.m18.1.1.cmml"><mi id="S4.SS2.p2.18.m18.1.1.2" xref="S4.SS2.p2.18.m18.1.1.2.cmml">m</mi><mo id="S4.SS2.p2.18.m18.1.1.1" xref="S4.SS2.p2.18.m18.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.18.m18.1.1.3" xref="S4.SS2.p2.18.m18.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.18.m18.1b"><apply id="S4.SS2.p2.18.m18.1.1.cmml" xref="S4.SS2.p2.18.m18.1.1"><eq id="S4.SS2.p2.18.m18.1.1.1.cmml" xref="S4.SS2.p2.18.m18.1.1.1"></eq><ci id="S4.SS2.p2.18.m18.1.1.2.cmml" xref="S4.SS2.p2.18.m18.1.1.2">𝑚</ci><cn type="integer" id="S4.SS2.p2.18.m18.1.1.3.cmml" xref="S4.SS2.p2.18.m18.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.18.m18.1c">m=1</annotation></semantics></math>. The
notation <math id="S4.SS2.p2.19.m19.1" class="ltx_Math" alttext="S_{c}" display="inline"><semantics id="S4.SS2.p2.19.m19.1a"><msub id="S4.SS2.p2.19.m19.1.1" xref="S4.SS2.p2.19.m19.1.1.cmml"><mi id="S4.SS2.p2.19.m19.1.1.2" xref="S4.SS2.p2.19.m19.1.1.2.cmml">S</mi><mi id="S4.SS2.p2.19.m19.1.1.3" xref="S4.SS2.p2.19.m19.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.19.m19.1b"><apply id="S4.SS2.p2.19.m19.1.1.cmml" xref="S4.SS2.p2.19.m19.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.19.m19.1.1.1.cmml" xref="S4.SS2.p2.19.m19.1.1">subscript</csymbol><ci id="S4.SS2.p2.19.m19.1.1.2.cmml" xref="S4.SS2.p2.19.m19.1.1.2">𝑆</ci><ci id="S4.SS2.p2.19.m19.1.1.3.cmml" xref="S4.SS2.p2.19.m19.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.19.m19.1c">S_{c}</annotation></semantics></math> means the support examples only belong to the class
<math id="S4.SS2.p2.20.m20.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.p2.20.m20.1a"><mi id="S4.SS2.p2.20.m20.1.1" xref="S4.SS2.p2.20.m20.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.20.m20.1b"><ci id="S4.SS2.p2.20.m20.1.1.cmml" xref="S4.SS2.p2.20.m20.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.20.m20.1c">c</annotation></semantics></math>, so <math id="S4.SS2.p2.21.m21.1" class="ltx_Math" alttext="|S_{c}|=m" display="inline"><semantics id="S4.SS2.p2.21.m21.1a"><mrow id="S4.SS2.p2.21.m21.1.1" xref="S4.SS2.p2.21.m21.1.1.cmml"><mrow id="S4.SS2.p2.21.m21.1.1.1.1" xref="S4.SS2.p2.21.m21.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.21.m21.1.1.1.1.2" xref="S4.SS2.p2.21.m21.1.1.1.2.1.cmml">|</mo><msub id="S4.SS2.p2.21.m21.1.1.1.1.1" xref="S4.SS2.p2.21.m21.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.21.m21.1.1.1.1.1.2" xref="S4.SS2.p2.21.m21.1.1.1.1.1.2.cmml">S</mi><mi id="S4.SS2.p2.21.m21.1.1.1.1.1.3" xref="S4.SS2.p2.21.m21.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.SS2.p2.21.m21.1.1.1.1.3" xref="S4.SS2.p2.21.m21.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.SS2.p2.21.m21.1.1.2" xref="S4.SS2.p2.21.m21.1.1.2.cmml">=</mo><mi id="S4.SS2.p2.21.m21.1.1.3" xref="S4.SS2.p2.21.m21.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.21.m21.1b"><apply id="S4.SS2.p2.21.m21.1.1.cmml" xref="S4.SS2.p2.21.m21.1.1"><eq id="S4.SS2.p2.21.m21.1.1.2.cmml" xref="S4.SS2.p2.21.m21.1.1.2"></eq><apply id="S4.SS2.p2.21.m21.1.1.1.2.cmml" xref="S4.SS2.p2.21.m21.1.1.1.1"><abs id="S4.SS2.p2.21.m21.1.1.1.2.1.cmml" xref="S4.SS2.p2.21.m21.1.1.1.1.2"></abs><apply id="S4.SS2.p2.21.m21.1.1.1.1.1.cmml" xref="S4.SS2.p2.21.m21.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.21.m21.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.21.m21.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.21.m21.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.21.m21.1.1.1.1.1.2">𝑆</ci><ci id="S4.SS2.p2.21.m21.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.21.m21.1.1.1.1.1.3">𝑐</ci></apply></apply><ci id="S4.SS2.p2.21.m21.1.1.3.cmml" xref="S4.SS2.p2.21.m21.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.21.m21.1c">|S_{c}|=m</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.2" class="ltx_p"><span id="S4.SS2.p3.2.1" class="ltx_text ltx_font_bold">Meta Image Reinforcing Network (MetaIRNet).</span> We
propose a Meta Image Reinforcing Network (MetaIRNet), which not only
learns a few-shot classifier, but also learns to reinforce generated
images by combining real and
generated images. MetaIRNet is composed of two modules: an image fusion
network <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">F</annotation></semantics></math>, and a one-shot
classification network <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">C</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para ltx_noindent">
<p id="S4.SS2.p4.6" class="ltx_p"><span id="S4.SS2.p4.6.1" class="ltx_text ltx_font_italic">The Image Fusion Network</span>
<math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">F</annotation></semantics></math> combines a real image
<math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{I}" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mi id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\mathbf{I}</annotation></semantics></math> and a corresponding generated image
<math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="\mathbf{I}_{g}" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><msub id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mi id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml">𝐈</mi><mi id="S4.SS2.p4.3.m3.1.1.3" xref="S4.SS2.p4.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2">𝐈</ci><ci id="S4.SS2.p4.3.m3.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">\mathbf{I}_{g}</annotation></semantics></math> into a new image <math id="S4.SS2.p4.4.m4.2" class="ltx_Math" alttext="\mathbf{I}_{syn}=F\left(\mathbf{I},\mathbf{I}_{g}\right)" display="inline"><semantics id="S4.SS2.p4.4.m4.2a"><mrow id="S4.SS2.p4.4.m4.2.2" xref="S4.SS2.p4.4.m4.2.2.cmml"><msub id="S4.SS2.p4.4.m4.2.2.3" xref="S4.SS2.p4.4.m4.2.2.3.cmml"><mi id="S4.SS2.p4.4.m4.2.2.3.2" xref="S4.SS2.p4.4.m4.2.2.3.2.cmml">𝐈</mi><mrow id="S4.SS2.p4.4.m4.2.2.3.3" xref="S4.SS2.p4.4.m4.2.2.3.3.cmml"><mi id="S4.SS2.p4.4.m4.2.2.3.3.2" xref="S4.SS2.p4.4.m4.2.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.4.m4.2.2.3.3.1" xref="S4.SS2.p4.4.m4.2.2.3.3.1.cmml">​</mo><mi id="S4.SS2.p4.4.m4.2.2.3.3.3" xref="S4.SS2.p4.4.m4.2.2.3.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.4.m4.2.2.3.3.1a" xref="S4.SS2.p4.4.m4.2.2.3.3.1.cmml">​</mo><mi id="S4.SS2.p4.4.m4.2.2.3.3.4" xref="S4.SS2.p4.4.m4.2.2.3.3.4.cmml">n</mi></mrow></msub><mo id="S4.SS2.p4.4.m4.2.2.2" xref="S4.SS2.p4.4.m4.2.2.2.cmml">=</mo><mrow id="S4.SS2.p4.4.m4.2.2.1" xref="S4.SS2.p4.4.m4.2.2.1.cmml"><mi id="S4.SS2.p4.4.m4.2.2.1.3" xref="S4.SS2.p4.4.m4.2.2.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.4.m4.2.2.1.2" xref="S4.SS2.p4.4.m4.2.2.1.2.cmml">​</mo><mrow id="S4.SS2.p4.4.m4.2.2.1.1.1" xref="S4.SS2.p4.4.m4.2.2.1.1.2.cmml"><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.2" xref="S4.SS2.p4.4.m4.2.2.1.1.2.cmml">(</mo><mi id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml">𝐈</mi><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.3" xref="S4.SS2.p4.4.m4.2.2.1.1.2.cmml">,</mo><msub id="S4.SS2.p4.4.m4.2.2.1.1.1.1" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.cmml">𝐈</mi><mi id="S4.SS2.p4.4.m4.2.2.1.1.1.1.3" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.3.cmml">g</mi></msub><mo id="S4.SS2.p4.4.m4.2.2.1.1.1.4" xref="S4.SS2.p4.4.m4.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.2b"><apply id="S4.SS2.p4.4.m4.2.2.cmml" xref="S4.SS2.p4.4.m4.2.2"><eq id="S4.SS2.p4.4.m4.2.2.2.cmml" xref="S4.SS2.p4.4.m4.2.2.2"></eq><apply id="S4.SS2.p4.4.m4.2.2.3.cmml" xref="S4.SS2.p4.4.m4.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.2.2.3.1.cmml" xref="S4.SS2.p4.4.m4.2.2.3">subscript</csymbol><ci id="S4.SS2.p4.4.m4.2.2.3.2.cmml" xref="S4.SS2.p4.4.m4.2.2.3.2">𝐈</ci><apply id="S4.SS2.p4.4.m4.2.2.3.3.cmml" xref="S4.SS2.p4.4.m4.2.2.3.3"><times id="S4.SS2.p4.4.m4.2.2.3.3.1.cmml" xref="S4.SS2.p4.4.m4.2.2.3.3.1"></times><ci id="S4.SS2.p4.4.m4.2.2.3.3.2.cmml" xref="S4.SS2.p4.4.m4.2.2.3.3.2">𝑠</ci><ci id="S4.SS2.p4.4.m4.2.2.3.3.3.cmml" xref="S4.SS2.p4.4.m4.2.2.3.3.3">𝑦</ci><ci id="S4.SS2.p4.4.m4.2.2.3.3.4.cmml" xref="S4.SS2.p4.4.m4.2.2.3.3.4">𝑛</ci></apply></apply><apply id="S4.SS2.p4.4.m4.2.2.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1"><times id="S4.SS2.p4.4.m4.2.2.1.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.2"></times><ci id="S4.SS2.p4.4.m4.2.2.1.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.3">𝐹</ci><interval closure="open" id="S4.SS2.p4.4.m4.2.2.1.1.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1"><ci id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">𝐈</ci><apply id="S4.SS2.p4.4.m4.2.2.1.1.1.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.2">𝐈</ci><ci id="S4.SS2.p4.4.m4.2.2.1.1.1.1.3.cmml" xref="S4.SS2.p4.4.m4.2.2.1.1.1.1.3">𝑔</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.2c">\mathbf{I}_{syn}=F\left(\mathbf{I},\mathbf{I}_{g}\right)</annotation></semantics></math> that is beneficial
for training a one-shot classifier.
Among the many possible ways to synthesize images,
we were inspired by a
block augmentation method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and
use
grid-based linear combination. As shown in
Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Pilot Study ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(g), we divide the images into a
<math id="S4.SS2.p4.5.m5.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S4.SS2.p4.5.m5.1a"><mrow id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml"><mn id="S4.SS2.p4.5.m5.1.1.2" xref="S4.SS2.p4.5.m5.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p4.5.m5.1.1.1" xref="S4.SS2.p4.5.m5.1.1.1.cmml">×</mo><mn id="S4.SS2.p4.5.m5.1.1.3" xref="S4.SS2.p4.5.m5.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><apply id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1"><times id="S4.SS2.p4.5.m5.1.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1.1"></times><cn type="integer" id="S4.SS2.p4.5.m5.1.1.2.cmml" xref="S4.SS2.p4.5.m5.1.1.2">3</cn><cn type="integer" id="S4.SS2.p4.5.m5.1.1.3.cmml" xref="S4.SS2.p4.5.m5.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">3\times 3</annotation></semantics></math> grid and linearly combine the cells with the weights
<math id="S4.SS2.p4.6.m6.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S4.SS2.p4.6.m6.1a"><mi id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><ci id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">\mathbf{w}</annotation></semantics></math> produced by a CNN conditioned on the two images. That is,</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.1" class="ltx_Math" alttext="\mathbf{I}_{syn}=\mathbf{w}\odot\mathbf{I}+\left(1-\mathbf{w}\right)\odot\mathbf{I}_{g}" display="block"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml"><msub id="S4.E3.m1.1.1.3" xref="S4.E3.m1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.3.2" xref="S4.E3.m1.1.1.3.2.cmml">𝐈</mi><mrow id="S4.E3.m1.1.1.3.3" xref="S4.E3.m1.1.1.3.3.cmml"><mi id="S4.E3.m1.1.1.3.3.2" xref="S4.E3.m1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.3.3.1" xref="S4.E3.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.E3.m1.1.1.3.3.3" xref="S4.E3.m1.1.1.3.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.3.3.1a" xref="S4.E3.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.E3.m1.1.1.3.3.4" xref="S4.E3.m1.1.1.3.3.4.cmml">n</mi></mrow></msub><mo id="S4.E3.m1.1.1.2" xref="S4.E3.m1.1.1.2.cmml">=</mo><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.3" xref="S4.E3.m1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.3.2.cmml">𝐰</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E3.m1.1.1.1.3.1" xref="S4.E3.m1.1.1.1.3.1.cmml">⊙</mo><mi id="S4.E3.m1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.3.3.cmml">𝐈</mi></mrow><mo id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.2.cmml">+</mo><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml"><mn id="S4.E3.m1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E3.m1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo rspace="0.055em" id="S4.E3.m1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.E3.m1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.2.cmml">⊙</mo><msub id="S4.E3.m1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.1.3.2.cmml">𝐈</mi><mi id="S4.E3.m1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.3.3.cmml">g</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1"><eq id="S4.E3.m1.1.1.2.cmml" xref="S4.E3.m1.1.1.2"></eq><apply id="S4.E3.m1.1.1.3.cmml" xref="S4.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.3.2">𝐈</ci><apply id="S4.E3.m1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.3.3"><times id="S4.E3.m1.1.1.3.3.1.cmml" xref="S4.E3.m1.1.1.3.3.1"></times><ci id="S4.E3.m1.1.1.3.3.2.cmml" xref="S4.E3.m1.1.1.3.3.2">𝑠</ci><ci id="S4.E3.m1.1.1.3.3.3.cmml" xref="S4.E3.m1.1.1.3.3.3">𝑦</ci><ci id="S4.E3.m1.1.1.3.3.4.cmml" xref="S4.E3.m1.1.1.3.3.4">𝑛</ci></apply></apply><apply id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><plus id="S4.E3.m1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.2"></plus><apply id="S4.E3.m1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.3"><csymbol cd="latexml" id="S4.E3.m1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.3.1">direct-product</csymbol><ci id="S4.E3.m1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.3.2">𝐰</ci><ci id="S4.E3.m1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.3.3">𝐈</ci></apply><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1"><csymbol cd="latexml" id="S4.E3.m1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.2">direct-product</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1"><minus id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S4.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.3">𝐰</ci></apply><apply id="S4.E3.m1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3.2">𝐈</ci><ci id="S4.E3.m1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3">𝑔</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\mathbf{I}_{syn}=\mathbf{w}\odot\mathbf{I}+\left(1-\mathbf{w}\right)\odot\mathbf{I}_{g}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p4.17" class="ltx_p">where <math id="S4.SS2.p4.7.m1.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S4.SS2.p4.7.m1.1a"><mo id="S4.SS2.p4.7.m1.1.1" xref="S4.SS2.p4.7.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m1.1b"><csymbol cd="latexml" id="S4.SS2.p4.7.m1.1.1.cmml" xref="S4.SS2.p4.7.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m1.1c">\odot</annotation></semantics></math> is element-wise multiplication, and <math id="S4.SS2.p4.8.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S4.SS2.p4.8.m2.1a"><mi id="S4.SS2.p4.8.m2.1.1" xref="S4.SS2.p4.8.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.8.m2.1b"><ci id="S4.SS2.p4.8.m2.1.1.cmml" xref="S4.SS2.p4.8.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.8.m2.1c">\mathbf{w}</annotation></semantics></math> is
resized to the image size keeping the block structure. The CNN to produce <math id="S4.SS2.p4.9.m3.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S4.SS2.p4.9.m3.1a"><mi id="S4.SS2.p4.9.m3.1.1" xref="S4.SS2.p4.9.m3.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.9.m3.1b"><ci id="S4.SS2.p4.9.m3.1.1.cmml" xref="S4.SS2.p4.9.m3.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.9.m3.1c">\mathbf{w}</annotation></semantics></math> extracts the feature vectors of <math id="S4.SS2.p4.10.m4.1" class="ltx_Math" alttext="\mathbf{I}" display="inline"><semantics id="S4.SS2.p4.10.m4.1a"><mi id="S4.SS2.p4.10.m4.1.1" xref="S4.SS2.p4.10.m4.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.10.m4.1b"><ci id="S4.SS2.p4.10.m4.1.1.cmml" xref="S4.SS2.p4.10.m4.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.10.m4.1c">\mathbf{I}</annotation></semantics></math> and
<math id="S4.SS2.p4.11.m5.1" class="ltx_Math" alttext="\mathbf{I}_{g}" display="inline"><semantics id="S4.SS2.p4.11.m5.1a"><msub id="S4.SS2.p4.11.m5.1.1" xref="S4.SS2.p4.11.m5.1.1.cmml"><mi id="S4.SS2.p4.11.m5.1.1.2" xref="S4.SS2.p4.11.m5.1.1.2.cmml">𝐈</mi><mi id="S4.SS2.p4.11.m5.1.1.3" xref="S4.SS2.p4.11.m5.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.11.m5.1b"><apply id="S4.SS2.p4.11.m5.1.1.cmml" xref="S4.SS2.p4.11.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.11.m5.1.1.1.cmml" xref="S4.SS2.p4.11.m5.1.1">subscript</csymbol><ci id="S4.SS2.p4.11.m5.1.1.2.cmml" xref="S4.SS2.p4.11.m5.1.1.2">𝐈</ci><ci id="S4.SS2.p4.11.m5.1.1.3.cmml" xref="S4.SS2.p4.11.m5.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.11.m5.1c">\mathbf{I}_{g}</annotation></semantics></math>, concatenates them, and uses a fully-connected
layer to produce a weight corresponding to each of the nine cells in the <math id="S4.SS2.p4.12.m6.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S4.SS2.p4.12.m6.1a"><mrow id="S4.SS2.p4.12.m6.1.1" xref="S4.SS2.p4.12.m6.1.1.cmml"><mn id="S4.SS2.p4.12.m6.1.1.2" xref="S4.SS2.p4.12.m6.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p4.12.m6.1.1.1" xref="S4.SS2.p4.12.m6.1.1.1.cmml">×</mo><mn id="S4.SS2.p4.12.m6.1.1.3" xref="S4.SS2.p4.12.m6.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.12.m6.1b"><apply id="S4.SS2.p4.12.m6.1.1.cmml" xref="S4.SS2.p4.12.m6.1.1"><times id="S4.SS2.p4.12.m6.1.1.1.cmml" xref="S4.SS2.p4.12.m6.1.1.1"></times><cn type="integer" id="S4.SS2.p4.12.m6.1.1.2.cmml" xref="S4.SS2.p4.12.m6.1.1.2">3</cn><cn type="integer" id="S4.SS2.p4.12.m6.1.1.3.cmml" xref="S4.SS2.p4.12.m6.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.12.m6.1c">3\times 3</annotation></semantics></math> grid. Finally, for each real image
<math id="S4.SS2.p4.13.m7.1" class="ltx_Math" alttext="\mathbf{I}^{i}" display="inline"><semantics id="S4.SS2.p4.13.m7.1a"><msup id="S4.SS2.p4.13.m7.1.1" xref="S4.SS2.p4.13.m7.1.1.cmml"><mi id="S4.SS2.p4.13.m7.1.1.2" xref="S4.SS2.p4.13.m7.1.1.2.cmml">𝐈</mi><mi id="S4.SS2.p4.13.m7.1.1.3" xref="S4.SS2.p4.13.m7.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.13.m7.1b"><apply id="S4.SS2.p4.13.m7.1.1.cmml" xref="S4.SS2.p4.13.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.13.m7.1.1.1.cmml" xref="S4.SS2.p4.13.m7.1.1">superscript</csymbol><ci id="S4.SS2.p4.13.m7.1.1.2.cmml" xref="S4.SS2.p4.13.m7.1.1.2">𝐈</ci><ci id="S4.SS2.p4.13.m7.1.1.3.cmml" xref="S4.SS2.p4.13.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.13.m7.1c">\mathbf{I}^{i}</annotation></semantics></math>, we generate <math id="S4.SS2.p4.14.m8.1" class="ltx_Math" alttext="n_{aug}" display="inline"><semantics id="S4.SS2.p4.14.m8.1a"><msub id="S4.SS2.p4.14.m8.1.1" xref="S4.SS2.p4.14.m8.1.1.cmml"><mi id="S4.SS2.p4.14.m8.1.1.2" xref="S4.SS2.p4.14.m8.1.1.2.cmml">n</mi><mrow id="S4.SS2.p4.14.m8.1.1.3" xref="S4.SS2.p4.14.m8.1.1.3.cmml"><mi id="S4.SS2.p4.14.m8.1.1.3.2" xref="S4.SS2.p4.14.m8.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.14.m8.1.1.3.1" xref="S4.SS2.p4.14.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p4.14.m8.1.1.3.3" xref="S4.SS2.p4.14.m8.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.14.m8.1.1.3.1a" xref="S4.SS2.p4.14.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p4.14.m8.1.1.3.4" xref="S4.SS2.p4.14.m8.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.14.m8.1b"><apply id="S4.SS2.p4.14.m8.1.1.cmml" xref="S4.SS2.p4.14.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.14.m8.1.1.1.cmml" xref="S4.SS2.p4.14.m8.1.1">subscript</csymbol><ci id="S4.SS2.p4.14.m8.1.1.2.cmml" xref="S4.SS2.p4.14.m8.1.1.2">𝑛</ci><apply id="S4.SS2.p4.14.m8.1.1.3.cmml" xref="S4.SS2.p4.14.m8.1.1.3"><times id="S4.SS2.p4.14.m8.1.1.3.1.cmml" xref="S4.SS2.p4.14.m8.1.1.3.1"></times><ci id="S4.SS2.p4.14.m8.1.1.3.2.cmml" xref="S4.SS2.p4.14.m8.1.1.3.2">𝑎</ci><ci id="S4.SS2.p4.14.m8.1.1.3.3.cmml" xref="S4.SS2.p4.14.m8.1.1.3.3">𝑢</ci><ci id="S4.SS2.p4.14.m8.1.1.3.4.cmml" xref="S4.SS2.p4.14.m8.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.14.m8.1c">n_{aug}</annotation></semantics></math> images, producing <math id="S4.SS2.p4.15.m9.1" class="ltx_Math" alttext="n_{aug}" display="inline"><semantics id="S4.SS2.p4.15.m9.1a"><msub id="S4.SS2.p4.15.m9.1.1" xref="S4.SS2.p4.15.m9.1.1.cmml"><mi id="S4.SS2.p4.15.m9.1.1.2" xref="S4.SS2.p4.15.m9.1.1.2.cmml">n</mi><mrow id="S4.SS2.p4.15.m9.1.1.3" xref="S4.SS2.p4.15.m9.1.1.3.cmml"><mi id="S4.SS2.p4.15.m9.1.1.3.2" xref="S4.SS2.p4.15.m9.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.15.m9.1.1.3.1" xref="S4.SS2.p4.15.m9.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p4.15.m9.1.1.3.3" xref="S4.SS2.p4.15.m9.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.15.m9.1.1.3.1a" xref="S4.SS2.p4.15.m9.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p4.15.m9.1.1.3.4" xref="S4.SS2.p4.15.m9.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.15.m9.1b"><apply id="S4.SS2.p4.15.m9.1.1.cmml" xref="S4.SS2.p4.15.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.15.m9.1.1.1.cmml" xref="S4.SS2.p4.15.m9.1.1">subscript</csymbol><ci id="S4.SS2.p4.15.m9.1.1.2.cmml" xref="S4.SS2.p4.15.m9.1.1.2">𝑛</ci><apply id="S4.SS2.p4.15.m9.1.1.3.cmml" xref="S4.SS2.p4.15.m9.1.1.3"><times id="S4.SS2.p4.15.m9.1.1.3.1.cmml" xref="S4.SS2.p4.15.m9.1.1.3.1"></times><ci id="S4.SS2.p4.15.m9.1.1.3.2.cmml" xref="S4.SS2.p4.15.m9.1.1.3.2">𝑎</ci><ci id="S4.SS2.p4.15.m9.1.1.3.3.cmml" xref="S4.SS2.p4.15.m9.1.1.3.3">𝑢</ci><ci id="S4.SS2.p4.15.m9.1.1.3.4.cmml" xref="S4.SS2.p4.15.m9.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.15.m9.1c">n_{aug}</annotation></semantics></math>
synthetic images, and assign the same class label <math id="S4.SS2.p4.16.m10.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S4.SS2.p4.16.m10.1a"><msub id="S4.SS2.p4.16.m10.1.1" xref="S4.SS2.p4.16.m10.1.1.cmml"><mi id="S4.SS2.p4.16.m10.1.1.2" xref="S4.SS2.p4.16.m10.1.1.2.cmml">y</mi><mi id="S4.SS2.p4.16.m10.1.1.3" xref="S4.SS2.p4.16.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.16.m10.1b"><apply id="S4.SS2.p4.16.m10.1.1.cmml" xref="S4.SS2.p4.16.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.16.m10.1.1.1.cmml" xref="S4.SS2.p4.16.m10.1.1">subscript</csymbol><ci id="S4.SS2.p4.16.m10.1.1.2.cmml" xref="S4.SS2.p4.16.m10.1.1.2">𝑦</ci><ci id="S4.SS2.p4.16.m10.1.1.3.cmml" xref="S4.SS2.p4.16.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.16.m10.1c">y_{i}</annotation></semantics></math> to
each synthesized image <math id="S4.SS2.p4.17.m11.2" class="ltx_Math" alttext="\mathbf{I}_{syn}^{i,j}" display="inline"><semantics id="S4.SS2.p4.17.m11.2a"><msubsup id="S4.SS2.p4.17.m11.2.3" xref="S4.SS2.p4.17.m11.2.3.cmml"><mi id="S4.SS2.p4.17.m11.2.3.2.2" xref="S4.SS2.p4.17.m11.2.3.2.2.cmml">𝐈</mi><mrow id="S4.SS2.p4.17.m11.2.3.2.3" xref="S4.SS2.p4.17.m11.2.3.2.3.cmml"><mi id="S4.SS2.p4.17.m11.2.3.2.3.2" xref="S4.SS2.p4.17.m11.2.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.17.m11.2.3.2.3.1" xref="S4.SS2.p4.17.m11.2.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p4.17.m11.2.3.2.3.3" xref="S4.SS2.p4.17.m11.2.3.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.17.m11.2.3.2.3.1a" xref="S4.SS2.p4.17.m11.2.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p4.17.m11.2.3.2.3.4" xref="S4.SS2.p4.17.m11.2.3.2.3.4.cmml">n</mi></mrow><mrow id="S4.SS2.p4.17.m11.2.2.2.4" xref="S4.SS2.p4.17.m11.2.2.2.3.cmml"><mi id="S4.SS2.p4.17.m11.1.1.1.1" xref="S4.SS2.p4.17.m11.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p4.17.m11.2.2.2.4.1" xref="S4.SS2.p4.17.m11.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p4.17.m11.2.2.2.2" xref="S4.SS2.p4.17.m11.2.2.2.2.cmml">j</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.17.m11.2b"><apply id="S4.SS2.p4.17.m11.2.3.cmml" xref="S4.SS2.p4.17.m11.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.17.m11.2.3.1.cmml" xref="S4.SS2.p4.17.m11.2.3">superscript</csymbol><apply id="S4.SS2.p4.17.m11.2.3.2.cmml" xref="S4.SS2.p4.17.m11.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.17.m11.2.3.2.1.cmml" xref="S4.SS2.p4.17.m11.2.3">subscript</csymbol><ci id="S4.SS2.p4.17.m11.2.3.2.2.cmml" xref="S4.SS2.p4.17.m11.2.3.2.2">𝐈</ci><apply id="S4.SS2.p4.17.m11.2.3.2.3.cmml" xref="S4.SS2.p4.17.m11.2.3.2.3"><times id="S4.SS2.p4.17.m11.2.3.2.3.1.cmml" xref="S4.SS2.p4.17.m11.2.3.2.3.1"></times><ci id="S4.SS2.p4.17.m11.2.3.2.3.2.cmml" xref="S4.SS2.p4.17.m11.2.3.2.3.2">𝑠</ci><ci id="S4.SS2.p4.17.m11.2.3.2.3.3.cmml" xref="S4.SS2.p4.17.m11.2.3.2.3.3">𝑦</ci><ci id="S4.SS2.p4.17.m11.2.3.2.3.4.cmml" xref="S4.SS2.p4.17.m11.2.3.2.3.4">𝑛</ci></apply></apply><list id="S4.SS2.p4.17.m11.2.2.2.3.cmml" xref="S4.SS2.p4.17.m11.2.2.2.4"><ci id="S4.SS2.p4.17.m11.1.1.1.1.cmml" xref="S4.SS2.p4.17.m11.1.1.1.1">𝑖</ci><ci id="S4.SS2.p4.17.m11.2.2.2.2.cmml" xref="S4.SS2.p4.17.m11.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.17.m11.2c">\mathbf{I}_{syn}^{i,j}</annotation></semantics></math> to obtain an augmented
support set,</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.3" class="ltx_Math" alttext="\tilde{S}=\left\{\left(\mathbf{I}^{i},y^{i}\right),\left\{\left(\mathbf{I}_{syn}^{i,j},y^{i}\right)\right\}_{j=1}^{n_{aug}}\right\}_{i=1}^{n\times m}." display="block"><semantics id="S4.E4.m1.3a"><mrow id="S4.E4.m1.3.3.1" xref="S4.E4.m1.3.3.1.1.cmml"><mrow id="S4.E4.m1.3.3.1.1" xref="S4.E4.m1.3.3.1.1.cmml"><mover accent="true" id="S4.E4.m1.3.3.1.1.4" xref="S4.E4.m1.3.3.1.1.4.cmml"><mi id="S4.E4.m1.3.3.1.1.4.2" xref="S4.E4.m1.3.3.1.1.4.2.cmml">S</mi><mo id="S4.E4.m1.3.3.1.1.4.1" xref="S4.E4.m1.3.3.1.1.4.1.cmml">~</mo></mover><mo id="S4.E4.m1.3.3.1.1.3" xref="S4.E4.m1.3.3.1.1.3.cmml">=</mo><msubsup id="S4.E4.m1.3.3.1.1.2" xref="S4.E4.m1.3.3.1.1.2.cmml"><mrow id="S4.E4.m1.3.3.1.1.2.2.2.2" xref="S4.E4.m1.3.3.1.1.2.2.2.3.cmml"><mo id="S4.E4.m1.3.3.1.1.2.2.2.2.3" xref="S4.E4.m1.3.3.1.1.2.2.2.3.cmml">{</mo><mrow id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mo id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.3.cmml">(</mo><msup id="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">𝐈</mi><mi id="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.4" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.3.cmml">,</mo><msup id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.3" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msup><mo id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.5" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S4.E4.m1.3.3.1.1.2.2.2.2.4" xref="S4.E4.m1.3.3.1.1.2.2.2.3.cmml">,</mo><msubsup id="S4.E4.m1.3.3.1.1.2.2.2.2.2" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.cmml"><mrow id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.2.cmml"><mo id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.2" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.2.cmml">{</mo><mrow id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.3.cmml"><mo id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.3" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.3.cmml">(</mo><msubsup id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.2" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.2.cmml">𝐈</mi><mrow id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.2" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.1" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.3" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.1a" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.4" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.4.cmml">n</mi></mrow><mrow id="S4.E4.m1.2.2.2.4" xref="S4.E4.m1.2.2.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">i</mi><mo id="S4.E4.m1.2.2.2.4.1" xref="S4.E4.m1.2.2.2.3.cmml">,</mo><mi id="S4.E4.m1.2.2.2.2" xref="S4.E4.m1.2.2.2.2.cmml">j</mi></mrow></msubsup><mo id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.4" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.3.cmml">,</mo><msup id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2.cmml"><mi id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2.2" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2.2.cmml">y</mi><mi id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2.3" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2.3.cmml">i</mi></msup><mo id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.5" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.3.cmml">)</mo></mrow><mo id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.3" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.cmml"><mi id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.2" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.2.cmml">j</mi><mo id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.1" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.1.cmml">=</mo><mn id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.3" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.3.cmml">1</mn></mrow><msub id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.cmml"><mi id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.2" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.2.cmml">n</mi><mrow id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.cmml"><mi id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.2" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.1" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.1.cmml">​</mo><mi id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.3" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.1a" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.1.cmml">​</mo><mi id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.4" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.4.cmml">g</mi></mrow></msub></msubsup><mo id="S4.E4.m1.3.3.1.1.2.2.2.2.5" xref="S4.E4.m1.3.3.1.1.2.2.2.3.cmml">}</mo></mrow><mrow id="S4.E4.m1.3.3.1.1.2.2.4" xref="S4.E4.m1.3.3.1.1.2.2.4.cmml"><mi id="S4.E4.m1.3.3.1.1.2.2.4.2" xref="S4.E4.m1.3.3.1.1.2.2.4.2.cmml">i</mi><mo id="S4.E4.m1.3.3.1.1.2.2.4.1" xref="S4.E4.m1.3.3.1.1.2.2.4.1.cmml">=</mo><mn id="S4.E4.m1.3.3.1.1.2.2.4.3" xref="S4.E4.m1.3.3.1.1.2.2.4.3.cmml">1</mn></mrow><mrow id="S4.E4.m1.3.3.1.1.2.4" xref="S4.E4.m1.3.3.1.1.2.4.cmml"><mi id="S4.E4.m1.3.3.1.1.2.4.2" xref="S4.E4.m1.3.3.1.1.2.4.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E4.m1.3.3.1.1.2.4.1" xref="S4.E4.m1.3.3.1.1.2.4.1.cmml">×</mo><mi id="S4.E4.m1.3.3.1.1.2.4.3" xref="S4.E4.m1.3.3.1.1.2.4.3.cmml">m</mi></mrow></msubsup></mrow><mo lspace="0em" id="S4.E4.m1.3.3.1.2" xref="S4.E4.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.3b"><apply id="S4.E4.m1.3.3.1.1.cmml" xref="S4.E4.m1.3.3.1"><eq id="S4.E4.m1.3.3.1.1.3.cmml" xref="S4.E4.m1.3.3.1.1.3"></eq><apply id="S4.E4.m1.3.3.1.1.4.cmml" xref="S4.E4.m1.3.3.1.1.4"><ci id="S4.E4.m1.3.3.1.1.4.1.cmml" xref="S4.E4.m1.3.3.1.1.4.1">~</ci><ci id="S4.E4.m1.3.3.1.1.4.2.cmml" xref="S4.E4.m1.3.3.1.1.4.2">𝑆</ci></apply><apply id="S4.E4.m1.3.3.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.2.3.cmml" xref="S4.E4.m1.3.3.1.1.2">superscript</csymbol><apply id="S4.E4.m1.3.3.1.1.2.2.cmml" xref="S4.E4.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.2.2.3.cmml" xref="S4.E4.m1.3.3.1.1.2">subscript</csymbol><set id="S4.E4.m1.3.3.1.1.2.2.2.3.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2"><interval closure="open" id="S4.E4.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2"><apply id="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝐈</ci><ci id="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval><apply id="S4.E4.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2">superscript</csymbol><apply id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2">subscript</csymbol><set id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1"><interval closure="open" id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.3.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2"><apply id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.2">𝐈</ci><apply id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3"><times id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.3">𝑦</ci><ci id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.4.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.1.1.2.3.4">𝑛</ci></apply></apply><list id="S4.E4.m1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.4"><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝑖</ci><ci id="S4.E4.m1.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2">superscript</csymbol><ci id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2.2">𝑦</ci><ci id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3"><eq id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.1.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.1"></eq><ci id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.2">𝑗</ci><cn type="integer" id="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.3.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.1.3.3">1</cn></apply></apply><apply id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.1.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.2">𝑛</ci><apply id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3"><times id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.1.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.1"></times><ci id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.2">𝑎</ci><ci id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.3.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.3">𝑢</ci><ci id="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.4.cmml" xref="S4.E4.m1.3.3.1.1.2.2.2.2.2.3.3.4">𝑔</ci></apply></apply></apply></set><apply id="S4.E4.m1.3.3.1.1.2.2.4.cmml" xref="S4.E4.m1.3.3.1.1.2.2.4"><eq id="S4.E4.m1.3.3.1.1.2.2.4.1.cmml" xref="S4.E4.m1.3.3.1.1.2.2.4.1"></eq><ci id="S4.E4.m1.3.3.1.1.2.2.4.2.cmml" xref="S4.E4.m1.3.3.1.1.2.2.4.2">𝑖</ci><cn type="integer" id="S4.E4.m1.3.3.1.1.2.2.4.3.cmml" xref="S4.E4.m1.3.3.1.1.2.2.4.3">1</cn></apply></apply><apply id="S4.E4.m1.3.3.1.1.2.4.cmml" xref="S4.E4.m1.3.3.1.1.2.4"><times id="S4.E4.m1.3.3.1.1.2.4.1.cmml" xref="S4.E4.m1.3.3.1.1.2.4.1"></times><ci id="S4.E4.m1.3.3.1.1.2.4.2.cmml" xref="S4.E4.m1.3.3.1.1.2.4.2">𝑛</ci><ci id="S4.E4.m1.3.3.1.1.2.4.3.cmml" xref="S4.E4.m1.3.3.1.1.2.4.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.3c">\tilde{S}=\left\{\left(\mathbf{I}^{i},y^{i}\right),\left\{\left(\mathbf{I}_{syn}^{i,j},y^{i}\right)\right\}_{j=1}^{n_{aug}}\right\}_{i=1}^{n\times m}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p5" class="ltx_para ltx_noindent">
<p id="S4.SS2.p5.9" class="ltx_p">The <span id="S4.SS2.p5.9.1" class="ltx_text ltx_font_italic">One-Shot Classification Network</span>
<math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><mi id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">C</annotation></semantics></math> maps an input image <math id="S4.SS2.p5.2.m2.1" class="ltx_Math" alttext="\mathbf{I}" display="inline"><semantics id="S4.SS2.p5.2.m2.1a"><mi id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><ci id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">\mathbf{I}</annotation></semantics></math> into
feature maps <math id="S4.SS2.p5.3.m3.1" class="ltx_Math" alttext="C\left(\mathbf{I}\right)" display="inline"><semantics id="S4.SS2.p5.3.m3.1a"><mrow id="S4.SS2.p5.3.m3.1.2" xref="S4.SS2.p5.3.m3.1.2.cmml"><mi id="S4.SS2.p5.3.m3.1.2.2" xref="S4.SS2.p5.3.m3.1.2.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p5.3.m3.1.2.1" xref="S4.SS2.p5.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS2.p5.3.m3.1.2.3.2" xref="S4.SS2.p5.3.m3.1.2.cmml"><mo id="S4.SS2.p5.3.m3.1.2.3.2.1" xref="S4.SS2.p5.3.m3.1.2.cmml">(</mo><mi id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml">𝐈</mi><mo id="S4.SS2.p5.3.m3.1.2.3.2.2" xref="S4.SS2.p5.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><apply id="S4.SS2.p5.3.m3.1.2.cmml" xref="S4.SS2.p5.3.m3.1.2"><times id="S4.SS2.p5.3.m3.1.2.1.cmml" xref="S4.SS2.p5.3.m3.1.2.1"></times><ci id="S4.SS2.p5.3.m3.1.2.2.cmml" xref="S4.SS2.p5.3.m3.1.2.2">𝐶</ci><ci id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">𝐈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">C\left(\mathbf{I}\right)</annotation></semantics></math>, and performs
one-shot classification. Although any one-shot classifier can be
used, we choose the non-parametric prototype classifier
of Snell <span id="S4.SS2.p5.9.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> due to its superior performance and
simplicity. During each episode, given the sampled <math id="S4.SS2.p5.4.m4.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.SS2.p5.4.m4.1a"><mi id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><ci id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">S</annotation></semantics></math> and <math id="S4.SS2.p5.5.m5.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS2.p5.5.m5.1a"><mi id="S4.SS2.p5.5.m5.1.1" xref="S4.SS2.p5.5.m5.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.5.m5.1b"><ci id="S4.SS2.p5.5.m5.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.5.m5.1c">Q</annotation></semantics></math>,
the image fusion network produces an augmented support set
<math id="S4.SS2.p5.6.m6.1" class="ltx_Math" alttext="\tilde{S}" display="inline"><semantics id="S4.SS2.p5.6.m6.1a"><mover accent="true" id="S4.SS2.p5.6.m6.1.1" xref="S4.SS2.p5.6.m6.1.1.cmml"><mi id="S4.SS2.p5.6.m6.1.1.2" xref="S4.SS2.p5.6.m6.1.1.2.cmml">S</mi><mo id="S4.SS2.p5.6.m6.1.1.1" xref="S4.SS2.p5.6.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.6.m6.1b"><apply id="S4.SS2.p5.6.m6.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1"><ci id="S4.SS2.p5.6.m6.1.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1.1">~</ci><ci id="S4.SS2.p5.6.m6.1.1.2.cmml" xref="S4.SS2.p5.6.m6.1.1.2">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.6.m6.1c">\tilde{S}</annotation></semantics></math>. This classifier computes the prototype vector <math id="S4.SS2.p5.7.m7.1" class="ltx_Math" alttext="\mathbf{p}_{c}" display="inline"><semantics id="S4.SS2.p5.7.m7.1a"><msub id="S4.SS2.p5.7.m7.1.1" xref="S4.SS2.p5.7.m7.1.1.cmml"><mi id="S4.SS2.p5.7.m7.1.1.2" xref="S4.SS2.p5.7.m7.1.1.2.cmml">𝐩</mi><mi id="S4.SS2.p5.7.m7.1.1.3" xref="S4.SS2.p5.7.m7.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.7.m7.1b"><apply id="S4.SS2.p5.7.m7.1.1.cmml" xref="S4.SS2.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.7.m7.1.1.1.cmml" xref="S4.SS2.p5.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p5.7.m7.1.1.2.cmml" xref="S4.SS2.p5.7.m7.1.1.2">𝐩</ci><ci id="S4.SS2.p5.7.m7.1.1.3.cmml" xref="S4.SS2.p5.7.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.7.m7.1c">\mathbf{p}_{c}</annotation></semantics></math> for each class <math id="S4.SS2.p5.8.m8.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.p5.8.m8.1a"><mi id="S4.SS2.p5.8.m8.1.1" xref="S4.SS2.p5.8.m8.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.8.m8.1b"><ci id="S4.SS2.p5.8.m8.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.8.m8.1c">c</annotation></semantics></math> in <math id="S4.SS2.p5.9.m9.1" class="ltx_Math" alttext="\tilde{S}" display="inline"><semantics id="S4.SS2.p5.9.m9.1a"><mover accent="true" id="S4.SS2.p5.9.m9.1.1" xref="S4.SS2.p5.9.m9.1.1.cmml"><mi id="S4.SS2.p5.9.m9.1.1.2" xref="S4.SS2.p5.9.m9.1.1.2.cmml">S</mi><mo id="S4.SS2.p5.9.m9.1.1.1" xref="S4.SS2.p5.9.m9.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.9.m9.1b"><apply id="S4.SS2.p5.9.m9.1.1.cmml" xref="S4.SS2.p5.9.m9.1.1"><ci id="S4.SS2.p5.9.m9.1.1.1.cmml" xref="S4.SS2.p5.9.m9.1.1.1">~</ci><ci id="S4.SS2.p5.9.m9.1.1.2.cmml" xref="S4.SS2.p5.9.m9.1.1.2">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.9.m9.1c">\tilde{S}</annotation></semantics></math> as an average feature
vector,</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.4" class="ltx_Math" alttext="\mathbf{p}_{c}=\frac{1}{|\tilde{S_{c}}|}\sum_{(\mathbf{I}_{i},y_{i})\in\tilde{S_{c}}}C\left(\mathbf{I}_{i}\right)." display="block"><semantics id="S4.E5.m1.4a"><mrow id="S4.E5.m1.4.4.1" xref="S4.E5.m1.4.4.1.1.cmml"><mrow id="S4.E5.m1.4.4.1.1" xref="S4.E5.m1.4.4.1.1.cmml"><msub id="S4.E5.m1.4.4.1.1.3" xref="S4.E5.m1.4.4.1.1.3.cmml"><mi id="S4.E5.m1.4.4.1.1.3.2" xref="S4.E5.m1.4.4.1.1.3.2.cmml">𝐩</mi><mi id="S4.E5.m1.4.4.1.1.3.3" xref="S4.E5.m1.4.4.1.1.3.3.cmml">c</mi></msub><mo id="S4.E5.m1.4.4.1.1.2" xref="S4.E5.m1.4.4.1.1.2.cmml">=</mo><mrow id="S4.E5.m1.4.4.1.1.1" xref="S4.E5.m1.4.4.1.1.1.cmml"><mfrac id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml"><mn id="S4.E5.m1.1.1.3" xref="S4.E5.m1.1.1.3.cmml">1</mn><mrow id="S4.E5.m1.1.1.1.3" xref="S4.E5.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.3.1" xref="S4.E5.m1.1.1.1.2.1.cmml">|</mo><mover accent="true" id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><msub id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.cmml"><mi id="S4.E5.m1.1.1.1.1.2.2" xref="S4.E5.m1.1.1.1.1.2.2.cmml">S</mi><mi id="S4.E5.m1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="S4.E5.m1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.4.4.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.cmml"><munder id="S4.E5.m1.4.4.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E5.m1.4.4.1.1.1.1.2.2" xref="S4.E5.m1.4.4.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E5.m1.3.3.2" xref="S4.E5.m1.3.3.2.cmml"><mrow id="S4.E5.m1.3.3.2.2.2" xref="S4.E5.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="S4.E5.m1.3.3.2.2.2.3" xref="S4.E5.m1.3.3.2.2.3.cmml">(</mo><msub id="S4.E5.m1.2.2.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.cmml"><mi id="S4.E5.m1.2.2.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.2.cmml">𝐈</mi><mi id="S4.E5.m1.2.2.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E5.m1.3.3.2.2.2.4" xref="S4.E5.m1.3.3.2.2.3.cmml">,</mo><msub id="S4.E5.m1.3.3.2.2.2.2" xref="S4.E5.m1.3.3.2.2.2.2.cmml"><mi id="S4.E5.m1.3.3.2.2.2.2.2" xref="S4.E5.m1.3.3.2.2.2.2.2.cmml">y</mi><mi id="S4.E5.m1.3.3.2.2.2.2.3" xref="S4.E5.m1.3.3.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E5.m1.3.3.2.2.2.5" xref="S4.E5.m1.3.3.2.2.3.cmml">)</mo></mrow><mo id="S4.E5.m1.3.3.2.3" xref="S4.E5.m1.3.3.2.3.cmml">∈</mo><mover accent="true" id="S4.E5.m1.3.3.2.4" xref="S4.E5.m1.3.3.2.4.cmml"><msub id="S4.E5.m1.3.3.2.4.2" xref="S4.E5.m1.3.3.2.4.2.cmml"><mi id="S4.E5.m1.3.3.2.4.2.2" xref="S4.E5.m1.3.3.2.4.2.2.cmml">S</mi><mi id="S4.E5.m1.3.3.2.4.2.3" xref="S4.E5.m1.3.3.2.4.2.3.cmml">c</mi></msub><mo id="S4.E5.m1.3.3.2.4.1" xref="S4.E5.m1.3.3.2.4.1.cmml">~</mo></mover></mrow></munder><mrow id="S4.E5.m1.4.4.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.1.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">𝐈</mi><mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E5.m1.4.4.1.2" xref="S4.E5.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.4b"><apply id="S4.E5.m1.4.4.1.1.cmml" xref="S4.E5.m1.4.4.1"><eq id="S4.E5.m1.4.4.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.2"></eq><apply id="S4.E5.m1.4.4.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.3.1.cmml" xref="S4.E5.m1.4.4.1.1.3">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.3.2.cmml" xref="S4.E5.m1.4.4.1.1.3.2">𝐩</ci><ci id="S4.E5.m1.4.4.1.1.3.3.cmml" xref="S4.E5.m1.4.4.1.1.3.3">𝑐</ci></apply><apply id="S4.E5.m1.4.4.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1"><times id="S4.E5.m1.4.4.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.2"></times><apply id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"><divide id="S4.E5.m1.1.1.2.cmml" xref="S4.E5.m1.1.1"></divide><cn type="integer" id="S4.E5.m1.1.1.3.cmml" xref="S4.E5.m1.1.1.3">1</cn><apply id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.3"><abs id="S4.E5.m1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.3.1"></abs><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1"><ci id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1">~</ci><apply id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2">𝑆</ci><ci id="S4.E5.m1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.2.3">𝑐</ci></apply></apply></apply></apply><apply id="S4.E5.m1.4.4.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1"><apply id="S4.E5.m1.4.4.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.2.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.2">subscript</csymbol><sum id="S4.E5.m1.4.4.1.1.1.1.2.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.2.2"></sum><apply id="S4.E5.m1.3.3.2.cmml" xref="S4.E5.m1.3.3.2"><in id="S4.E5.m1.3.3.2.3.cmml" xref="S4.E5.m1.3.3.2.3"></in><interval closure="open" id="S4.E5.m1.3.3.2.2.3.cmml" xref="S4.E5.m1.3.3.2.2.2"><apply id="S4.E5.m1.2.2.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2">𝐈</ci><ci id="S4.E5.m1.2.2.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E5.m1.3.3.2.2.2.2.cmml" xref="S4.E5.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.2.2.2.2.1.cmml" xref="S4.E5.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S4.E5.m1.3.3.2.2.2.2.2.cmml" xref="S4.E5.m1.3.3.2.2.2.2.2">𝑦</ci><ci id="S4.E5.m1.3.3.2.2.2.2.3.cmml" xref="S4.E5.m1.3.3.2.2.2.2.3">𝑖</ci></apply></interval><apply id="S4.E5.m1.3.3.2.4.cmml" xref="S4.E5.m1.3.3.2.4"><ci id="S4.E5.m1.3.3.2.4.1.cmml" xref="S4.E5.m1.3.3.2.4.1">~</ci><apply id="S4.E5.m1.3.3.2.4.2.cmml" xref="S4.E5.m1.3.3.2.4.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.2.4.2.1.cmml" xref="S4.E5.m1.3.3.2.4.2">subscript</csymbol><ci id="S4.E5.m1.3.3.2.4.2.2.cmml" xref="S4.E5.m1.3.3.2.4.2.2">𝑆</ci><ci id="S4.E5.m1.3.3.2.4.2.3.cmml" xref="S4.E5.m1.3.3.2.4.2.3">𝑐</ci></apply></apply></apply></apply><apply id="S4.E5.m1.4.4.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1"><times id="S4.E5.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.2"></times><ci id="S4.E5.m1.4.4.1.1.1.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.3">𝐶</ci><apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.2">𝐈</ci><ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.4c">\mathbf{p}_{c}=\frac{1}{|\tilde{S_{c}}|}\sum_{(\mathbf{I}_{i},y_{i})\in\tilde{S_{c}}}C\left(\mathbf{I}_{i}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p6" class="ltx_para ltx_noindent">
<p id="S4.SS2.p6.2" class="ltx_p">For a query image <math id="S4.SS2.p6.1.m1.1" class="ltx_Math" alttext="\mathbf{I}_{i}\in Q" display="inline"><semantics id="S4.SS2.p6.1.m1.1a"><mrow id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml"><msub id="S4.SS2.p6.1.m1.1.1.2" xref="S4.SS2.p6.1.m1.1.1.2.cmml"><mi id="S4.SS2.p6.1.m1.1.1.2.2" xref="S4.SS2.p6.1.m1.1.1.2.2.cmml">𝐈</mi><mi id="S4.SS2.p6.1.m1.1.1.2.3" xref="S4.SS2.p6.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS2.p6.1.m1.1.1.1" xref="S4.SS2.p6.1.m1.1.1.1.cmml">∈</mo><mi id="S4.SS2.p6.1.m1.1.1.3" xref="S4.SS2.p6.1.m1.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><apply id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1"><in id="S4.SS2.p6.1.m1.1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1.1"></in><apply id="S4.SS2.p6.1.m1.1.1.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p6.1.m1.1.1.2.1.cmml" xref="S4.SS2.p6.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.p6.1.m1.1.1.2.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2.2">𝐈</ci><ci id="S4.SS2.p6.1.m1.1.1.2.3.cmml" xref="S4.SS2.p6.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p6.1.m1.1.1.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">\mathbf{I}_{i}\in Q</annotation></semantics></math>,
the probability of belonging to a class <math id="S4.SS2.p6.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.p6.2.m2.1a"><mi id="S4.SS2.p6.2.m2.1.1" xref="S4.SS2.p6.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.2.m2.1b"><ci id="S4.SS2.p6.2.m2.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.2.m2.1c">c</annotation></semantics></math> is estimated as,</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.4" class="ltx_Math" alttext="P\left(y_{i}=c\text{$\mid$}\mathbf{I}_{i}\right)=\frac{\mathrm{exp}\left(-\left\|C\left(\mathbf{I}_{i}\right)-\mathbf{p}_{c}\right\|\right)}{\sum_{k=1}^{n}\mathrm{exp}\left(-\left\|C\left(\mathbf{I}_{i}\right)-\mathbf{p}_{k}\right\|\right)}" display="block"><semantics id="S4.E6.m1.4a"><mrow id="S4.E6.m1.4.4" xref="S4.E6.m1.4.4.cmml"><mrow id="S4.E6.m1.4.4.1" xref="S4.E6.m1.4.4.1.cmml"><mi id="S4.E6.m1.4.4.1.3" xref="S4.E6.m1.4.4.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.4.4.1.2" xref="S4.E6.m1.4.4.1.2.cmml">​</mo><mrow id="S4.E6.m1.4.4.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.cmml"><mo id="S4.E6.m1.4.4.1.1.1.2" xref="S4.E6.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.4.4.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.cmml"><msub id="S4.E6.m1.4.4.1.1.1.1.2" xref="S4.E6.m1.4.4.1.1.1.1.2.cmml"><mi id="S4.E6.m1.4.4.1.1.1.1.2.2" xref="S4.E6.m1.4.4.1.1.1.1.2.2.cmml">y</mi><mi id="S4.E6.m1.4.4.1.1.1.1.2.3" xref="S4.E6.m1.4.4.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E6.m1.4.4.1.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.1.cmml">=</mo><mrow id="S4.E6.m1.4.4.1.1.1.1.3" xref="S4.E6.m1.4.4.1.1.1.1.3.cmml"><mi id="S4.E6.m1.4.4.1.1.1.1.3.2" xref="S4.E6.m1.4.4.1.1.1.1.3.2.cmml">c</mi><mo id="S4.E6.m1.4.4.1.1.1.1.3.1" xref="S4.E6.m1.4.4.1.1.1.1.3.1.cmml">∣</mo><msub id="S4.E6.m1.4.4.1.1.1.1.3.3" xref="S4.E6.m1.4.4.1.1.1.1.3.3.cmml"><mi id="S4.E6.m1.4.4.1.1.1.1.3.3.2" xref="S4.E6.m1.4.4.1.1.1.1.3.3.2.cmml">𝐈</mi><mi id="S4.E6.m1.4.4.1.1.1.1.3.3.3" xref="S4.E6.m1.4.4.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S4.E6.m1.4.4.1.1.1.3" xref="S4.E6.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.4.4.2" xref="S4.E6.m1.4.4.2.cmml">=</mo><mfrac id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml"><mrow id="S4.E6.m1.2.2.1" xref="S4.E6.m1.2.2.1.cmml"><mi id="S4.E6.m1.2.2.1.3" xref="S4.E6.m1.2.2.1.3.cmml">exp</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.2" xref="S4.E6.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E6.m1.2.2.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.cmml"><mo id="S4.E6.m1.2.2.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.2.2.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.cmml"><mo id="S4.E6.m1.2.2.1.1.1.1a" xref="S4.E6.m1.2.2.1.1.1.1.cmml">−</mo><mrow id="S4.E6.m1.2.2.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S4.E6.m1.2.2.1.1.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E6.m1.2.2.1.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐈</mi><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml">−</mo><msub id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">𝐩</mi><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">c</mi></msub></mrow><mo id="S4.E6.m1.2.2.1.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="S4.E6.m1.2.2.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E6.m1.3.3.2" xref="S4.E6.m1.3.3.2.cmml"><msubsup id="S4.E6.m1.3.3.2.2" xref="S4.E6.m1.3.3.2.2.cmml"><mo id="S4.E6.m1.3.3.2.2.2.2" xref="S4.E6.m1.3.3.2.2.2.2.cmml">∑</mo><mrow id="S4.E6.m1.3.3.2.2.2.3" xref="S4.E6.m1.3.3.2.2.2.3.cmml"><mi id="S4.E6.m1.3.3.2.2.2.3.2" xref="S4.E6.m1.3.3.2.2.2.3.2.cmml">k</mi><mo id="S4.E6.m1.3.3.2.2.2.3.1" xref="S4.E6.m1.3.3.2.2.2.3.1.cmml">=</mo><mn id="S4.E6.m1.3.3.2.2.2.3.3" xref="S4.E6.m1.3.3.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E6.m1.3.3.2.2.3" xref="S4.E6.m1.3.3.2.2.3.cmml">n</mi></msubsup><mrow id="S4.E6.m1.3.3.2.1" xref="S4.E6.m1.3.3.2.1.cmml"><mi id="S4.E6.m1.3.3.2.1.3" xref="S4.E6.m1.3.3.2.1.3.cmml">exp</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.3.3.2.1.2" xref="S4.E6.m1.3.3.2.1.2.cmml">​</mo><mrow id="S4.E6.m1.3.3.2.1.1.1" xref="S4.E6.m1.3.3.2.1.1.1.1.cmml"><mo id="S4.E6.m1.3.3.2.1.1.1.2" xref="S4.E6.m1.3.3.2.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.3.3.2.1.1.1.1" xref="S4.E6.m1.3.3.2.1.1.1.1.cmml"><mo id="S4.E6.m1.3.3.2.1.1.1.1a" xref="S4.E6.m1.3.3.2.1.1.1.1.cmml">−</mo><mrow id="S4.E6.m1.3.3.2.1.1.1.1.1.1" xref="S4.E6.m1.3.3.2.1.1.1.1.1.2.cmml"><mo id="S4.E6.m1.3.3.2.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mrow id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐈</mi><mi id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.2.cmml">−</mo><msub id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3.2.cmml">𝐩</mi><mi id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S4.E6.m1.3.3.2.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="S4.E6.m1.3.3.2.1.1.1.3" xref="S4.E6.m1.3.3.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.4b"><apply id="S4.E6.m1.4.4.cmml" xref="S4.E6.m1.4.4"><eq id="S4.E6.m1.4.4.2.cmml" xref="S4.E6.m1.4.4.2"></eq><apply id="S4.E6.m1.4.4.1.cmml" xref="S4.E6.m1.4.4.1"><times id="S4.E6.m1.4.4.1.2.cmml" xref="S4.E6.m1.4.4.1.2"></times><ci id="S4.E6.m1.4.4.1.3.cmml" xref="S4.E6.m1.4.4.1.3">𝑃</ci><apply id="S4.E6.m1.4.4.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1"><eq id="S4.E6.m1.4.4.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1"></eq><apply id="S4.E6.m1.4.4.1.1.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.1.1.2.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.4.4.1.1.1.1.2.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.2.2">𝑦</ci><ci id="S4.E6.m1.4.4.1.1.1.1.2.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E6.m1.4.4.1.1.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3"><csymbol cd="latexml" id="S4.E6.m1.4.4.1.1.1.1.3.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.1">conditional</csymbol><ci id="S4.E6.m1.4.4.1.1.1.1.3.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.2">𝑐</ci><apply id="S4.E6.m1.4.4.1.1.1.1.3.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E6.m1.4.4.1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.3.2">𝐈</ci><ci id="S4.E6.m1.4.4.1.1.1.1.3.3.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.3.3"><divide id="S4.E6.m1.3.3.3.cmml" xref="S4.E6.m1.3.3"></divide><apply id="S4.E6.m1.2.2.1.cmml" xref="S4.E6.m1.2.2.1"><times id="S4.E6.m1.2.2.1.2.cmml" xref="S4.E6.m1.2.2.1.2"></times><ci id="S4.E6.m1.2.2.1.3.cmml" xref="S4.E6.m1.2.2.1.3">exp</ci><apply id="S4.E6.m1.2.2.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1"><minus id="S4.E6.m1.2.2.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1"></minus><apply id="S4.E6.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1"><minus id="S4.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.2"></minus><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1"><times id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.3">𝐶</ci><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝐈</ci><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.2">𝐩</ci><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></apply></apply><apply id="S4.E6.m1.3.3.2.cmml" xref="S4.E6.m1.3.3.2"><apply id="S4.E6.m1.3.3.2.2.cmml" xref="S4.E6.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.2.2.1.cmml" xref="S4.E6.m1.3.3.2.2">superscript</csymbol><apply id="S4.E6.m1.3.3.2.2.2.cmml" xref="S4.E6.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.2.2.2.1.cmml" xref="S4.E6.m1.3.3.2.2">subscript</csymbol><sum id="S4.E6.m1.3.3.2.2.2.2.cmml" xref="S4.E6.m1.3.3.2.2.2.2"></sum><apply id="S4.E6.m1.3.3.2.2.2.3.cmml" xref="S4.E6.m1.3.3.2.2.2.3"><eq id="S4.E6.m1.3.3.2.2.2.3.1.cmml" xref="S4.E6.m1.3.3.2.2.2.3.1"></eq><ci id="S4.E6.m1.3.3.2.2.2.3.2.cmml" xref="S4.E6.m1.3.3.2.2.2.3.2">𝑘</ci><cn type="integer" id="S4.E6.m1.3.3.2.2.2.3.3.cmml" xref="S4.E6.m1.3.3.2.2.2.3.3">1</cn></apply></apply><ci id="S4.E6.m1.3.3.2.2.3.cmml" xref="S4.E6.m1.3.3.2.2.3">𝑛</ci></apply><apply id="S4.E6.m1.3.3.2.1.cmml" xref="S4.E6.m1.3.3.2.1"><times id="S4.E6.m1.3.3.2.1.2.cmml" xref="S4.E6.m1.3.3.2.1.2"></times><ci id="S4.E6.m1.3.3.2.1.3.cmml" xref="S4.E6.m1.3.3.2.1.3">exp</ci><apply id="S4.E6.m1.3.3.2.1.1.1.1.cmml" xref="S4.E6.m1.3.3.2.1.1.1"><minus id="S4.E6.m1.3.3.2.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.2.1.1.1"></minus><apply id="S4.E6.m1.3.3.2.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.3.3.2.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1"><minus id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.2"></minus><apply id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1"><times id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.3">𝐶</ci><apply id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.2">𝐈</ci><ci id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3.2">𝐩</ci><ci id="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.3.3.2.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.4c">P\left(y_{i}=c\text{$\mid$}\mathbf{I}_{i}\right)=\frac{\mathrm{exp}\left(-\left\|C\left(\mathbf{I}_{i}\right)-\mathbf{p}_{c}\right\|\right)}{\sum_{k=1}^{n}\mathrm{exp}\left(-\left\|C\left(\mathbf{I}_{i}\right)-\mathbf{p}_{k}\right\|\right)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p6.3" class="ltx_p">where <math id="S4.SS2.p6.3.m1.1" class="ltx_math_unparsed" alttext="\parallel\cdot\parallel" display="inline"><semantics id="S4.SS2.p6.3.m1.1a"><mrow id="S4.SS2.p6.3.m1.1b"><mo rspace="0em" id="S4.SS2.p6.3.m1.1.1">∥</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p6.3.m1.1.2">⋅</mo><mo lspace="0em" id="S4.SS2.p6.3.m1.1.3">∥</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.p6.3.m1.1c">\parallel\cdot\parallel</annotation></semantics></math> is the Euclidean
distance. Then, for a query image, the class with the highest
probability becomes the final prediction of the one-shot classifier.</p>
</div>
<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training</h5>

<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px1.p1.2" class="ltx_p">In the meta-training phase, we jointly train <math id="S4.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">F</annotation></semantics></math> and <math id="S4.SS2.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.2.m2.1a"><mi id="S4.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m2.1b"><ci id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m2.1c">C</annotation></semantics></math> in an end-to-end manner, minimizing a cross-entropy loss function,</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.6" class="ltx_Math" alttext="\min_{\mathbf{\theta}_{F},\mathbf{\theta}_{C}}\frac{1}{|Q|}\sum_{\left(\mathbf{I}_{i},y_{i}\right)\in Q}-\mathrm{log}P\left(y_{i}\mid\mathbf{I}_{i}\right)," display="block"><semantics id="S4.E7.m1.6a"><mrow id="S4.E7.m1.6.6.1" xref="S4.E7.m1.6.6.1.1.cmml"><mrow id="S4.E7.m1.6.6.1.1" xref="S4.E7.m1.6.6.1.1.cmml"><mrow id="S4.E7.m1.6.6.1.1.3" xref="S4.E7.m1.6.6.1.1.3.cmml"><mrow id="S4.E7.m1.6.6.1.1.3.2" xref="S4.E7.m1.6.6.1.1.3.2.cmml"><munder id="S4.E7.m1.6.6.1.1.3.2.1" xref="S4.E7.m1.6.6.1.1.3.2.1.cmml"><mi id="S4.E7.m1.6.6.1.1.3.2.1.2" xref="S4.E7.m1.6.6.1.1.3.2.1.2.cmml">min</mi><mrow id="S4.E7.m1.2.2.2.2" xref="S4.E7.m1.2.2.2.3.cmml"><msub id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E7.m1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.3.cmml">F</mi></msub><mo id="S4.E7.m1.2.2.2.2.3" xref="S4.E7.m1.2.2.2.3.cmml">,</mo><msub id="S4.E7.m1.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.cmml"><mi id="S4.E7.m1.2.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.2.cmml">θ</mi><mi id="S4.E7.m1.2.2.2.2.2.3" xref="S4.E7.m1.2.2.2.2.2.3.cmml">C</mi></msub></mrow></munder><mo lspace="0.167em" id="S4.E7.m1.6.6.1.1.3.2a" xref="S4.E7.m1.6.6.1.1.3.2.cmml">⁡</mo><mfrac id="S4.E7.m1.3.3" xref="S4.E7.m1.3.3.cmml"><mn id="S4.E7.m1.3.3.3" xref="S4.E7.m1.3.3.3.cmml">1</mn><mrow id="S4.E7.m1.3.3.1.3" xref="S4.E7.m1.3.3.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.3.3.1.3.1" xref="S4.E7.m1.3.3.1.2.1.cmml">|</mo><mi id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml">Q</mi><mo stretchy="false" id="S4.E7.m1.3.3.1.3.2" xref="S4.E7.m1.3.3.1.2.1.cmml">|</mo></mrow></mfrac></mrow><mo lspace="0em" rspace="0em" id="S4.E7.m1.6.6.1.1.3.1" xref="S4.E7.m1.6.6.1.1.3.1.cmml">​</mo><munder id="S4.E7.m1.6.6.1.1.3.3" xref="S4.E7.m1.6.6.1.1.3.3.cmml"><mo movablelimits="false" rspace="0em" id="S4.E7.m1.6.6.1.1.3.3.2" xref="S4.E7.m1.6.6.1.1.3.3.2.cmml">∑</mo><mrow id="S4.E7.m1.5.5.2" xref="S4.E7.m1.5.5.2.cmml"><mrow id="S4.E7.m1.5.5.2.2.2" xref="S4.E7.m1.5.5.2.2.3.cmml"><mo id="S4.E7.m1.5.5.2.2.2.3" xref="S4.E7.m1.5.5.2.2.3.cmml">(</mo><msub id="S4.E7.m1.4.4.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.cmml"><mi id="S4.E7.m1.4.4.1.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml">𝐈</mi><mi id="S4.E7.m1.4.4.1.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.5.5.2.2.2.4" xref="S4.E7.m1.5.5.2.2.3.cmml">,</mo><msub id="S4.E7.m1.5.5.2.2.2.2" xref="S4.E7.m1.5.5.2.2.2.2.cmml"><mi id="S4.E7.m1.5.5.2.2.2.2.2" xref="S4.E7.m1.5.5.2.2.2.2.2.cmml">y</mi><mi id="S4.E7.m1.5.5.2.2.2.2.3" xref="S4.E7.m1.5.5.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E7.m1.5.5.2.2.2.5" xref="S4.E7.m1.5.5.2.2.3.cmml">)</mo></mrow><mo id="S4.E7.m1.5.5.2.3" xref="S4.E7.m1.5.5.2.3.cmml">∈</mo><mi id="S4.E7.m1.5.5.2.4" xref="S4.E7.m1.5.5.2.4.cmml">Q</mi></mrow></munder></mrow><mo lspace="0em" id="S4.E7.m1.6.6.1.1.2" xref="S4.E7.m1.6.6.1.1.2.cmml">−</mo><mrow id="S4.E7.m1.6.6.1.1.1" xref="S4.E7.m1.6.6.1.1.1.cmml"><mi id="S4.E7.m1.6.6.1.1.1.3" xref="S4.E7.m1.6.6.1.1.1.3.cmml">log</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.6.6.1.1.1.2" xref="S4.E7.m1.6.6.1.1.1.2.cmml">​</mo><mi id="S4.E7.m1.6.6.1.1.1.4" xref="S4.E7.m1.6.6.1.1.1.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.6.6.1.1.1.2a" xref="S4.E7.m1.6.6.1.1.1.2.cmml">​</mo><mrow id="S4.E7.m1.6.6.1.1.1.1.1" xref="S4.E7.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.6.6.1.1.1.1.1.2" xref="S4.E7.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.6.6.1.1.1.1.1.1" xref="S4.E7.m1.6.6.1.1.1.1.1.1.cmml"><msub id="S4.E7.m1.6.6.1.1.1.1.1.1.2" xref="S4.E7.m1.6.6.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.6.6.1.1.1.1.1.1.2.2" xref="S4.E7.m1.6.6.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S4.E7.m1.6.6.1.1.1.1.1.1.2.3" xref="S4.E7.m1.6.6.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E7.m1.6.6.1.1.1.1.1.1.1" xref="S4.E7.m1.6.6.1.1.1.1.1.1.1.cmml">∣</mo><msub id="S4.E7.m1.6.6.1.1.1.1.1.1.3" xref="S4.E7.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.6.6.1.1.1.1.1.1.3.2" xref="S4.E7.m1.6.6.1.1.1.1.1.1.3.2.cmml">𝐈</mi><mi id="S4.E7.m1.6.6.1.1.1.1.1.1.3.3" xref="S4.E7.m1.6.6.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.E7.m1.6.6.1.1.1.1.1.3" xref="S4.E7.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.6.6.1.2" xref="S4.E7.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.6b"><apply id="S4.E7.m1.6.6.1.1.cmml" xref="S4.E7.m1.6.6.1"><minus id="S4.E7.m1.6.6.1.1.2.cmml" xref="S4.E7.m1.6.6.1.1.2"></minus><apply id="S4.E7.m1.6.6.1.1.3.cmml" xref="S4.E7.m1.6.6.1.1.3"><times id="S4.E7.m1.6.6.1.1.3.1.cmml" xref="S4.E7.m1.6.6.1.1.3.1"></times><apply id="S4.E7.m1.6.6.1.1.3.2.cmml" xref="S4.E7.m1.6.6.1.1.3.2"><apply id="S4.E7.m1.6.6.1.1.3.2.1.cmml" xref="S4.E7.m1.6.6.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.1.1.3.2.1.1.cmml" xref="S4.E7.m1.6.6.1.1.3.2.1">subscript</csymbol><min id="S4.E7.m1.6.6.1.1.3.2.1.2.cmml" xref="S4.E7.m1.6.6.1.1.3.2.1.2"></min><list id="S4.E7.m1.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2"><apply id="S4.E7.m1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.2">𝜃</ci><ci id="S4.E7.m1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.3">𝐹</ci></apply><apply id="S4.E7.m1.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.E7.m1.2.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2">𝜃</ci><ci id="S4.E7.m1.2.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.2.3">𝐶</ci></apply></list></apply><apply id="S4.E7.m1.3.3.cmml" xref="S4.E7.m1.3.3"><divide id="S4.E7.m1.3.3.2.cmml" xref="S4.E7.m1.3.3"></divide><cn type="integer" id="S4.E7.m1.3.3.3.cmml" xref="S4.E7.m1.3.3.3">1</cn><apply id="S4.E7.m1.3.3.1.2.cmml" xref="S4.E7.m1.3.3.1.3"><abs id="S4.E7.m1.3.3.1.2.1.cmml" xref="S4.E7.m1.3.3.1.3.1"></abs><ci id="S4.E7.m1.3.3.1.1.cmml" xref="S4.E7.m1.3.3.1.1">𝑄</ci></apply></apply></apply><apply id="S4.E7.m1.6.6.1.1.3.3.cmml" xref="S4.E7.m1.6.6.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.1.1.3.3.1.cmml" xref="S4.E7.m1.6.6.1.1.3.3">subscript</csymbol><sum id="S4.E7.m1.6.6.1.1.3.3.2.cmml" xref="S4.E7.m1.6.6.1.1.3.3.2"></sum><apply id="S4.E7.m1.5.5.2.cmml" xref="S4.E7.m1.5.5.2"><in id="S4.E7.m1.5.5.2.3.cmml" xref="S4.E7.m1.5.5.2.3"></in><interval closure="open" id="S4.E7.m1.5.5.2.2.3.cmml" xref="S4.E7.m1.5.5.2.2.2"><apply id="S4.E7.m1.4.4.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.2">𝐈</ci><ci id="S4.E7.m1.4.4.1.1.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E7.m1.5.5.2.2.2.2.cmml" xref="S4.E7.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.2.2.2.2.1.cmml" xref="S4.E7.m1.5.5.2.2.2.2">subscript</csymbol><ci id="S4.E7.m1.5.5.2.2.2.2.2.cmml" xref="S4.E7.m1.5.5.2.2.2.2.2">𝑦</ci><ci id="S4.E7.m1.5.5.2.2.2.2.3.cmml" xref="S4.E7.m1.5.5.2.2.2.2.3">𝑖</ci></apply></interval><ci id="S4.E7.m1.5.5.2.4.cmml" xref="S4.E7.m1.5.5.2.4">𝑄</ci></apply></apply></apply><apply id="S4.E7.m1.6.6.1.1.1.cmml" xref="S4.E7.m1.6.6.1.1.1"><times id="S4.E7.m1.6.6.1.1.1.2.cmml" xref="S4.E7.m1.6.6.1.1.1.2"></times><ci id="S4.E7.m1.6.6.1.1.1.3.cmml" xref="S4.E7.m1.6.6.1.1.1.3">log</ci><ci id="S4.E7.m1.6.6.1.1.1.4.cmml" xref="S4.E7.m1.6.6.1.1.1.4">𝑃</ci><apply id="S4.E7.m1.6.6.1.1.1.1.1.1.cmml" xref="S4.E7.m1.6.6.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.6.6.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E7.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.6.6.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.6.6.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S4.E7.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.6.6.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E7.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.6.6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.6.6.1.1.1.1.1.1.3.2">𝐈</ci><ci id="S4.E7.m1.6.6.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.6.6.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.6c">\min_{\mathbf{\theta}_{F},\mathbf{\theta}_{C}}\frac{1}{|Q|}\sum_{\left(\mathbf{I}_{i},y_{i}\right)\in Q}-\mathrm{log}P\left(y_{i}\mid\mathbf{I}_{i}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.SSS0.Px1.p1.6" class="ltx_p">where <math id="S4.SS2.SSS0.Px1.p1.3.m1.1" class="ltx_Math" alttext="\mathbf{\theta}_{F}" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.3.m1.1a"><msub id="S4.SS2.SSS0.Px1.p1.3.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.3.m1.1.1.2" xref="S4.SS2.SSS0.Px1.p1.3.m1.1.1.2.cmml">θ</mi><mi id="S4.SS2.SSS0.Px1.p1.3.m1.1.1.3" xref="S4.SS2.SSS0.Px1.p1.3.m1.1.1.3.cmml">F</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.3.m1.1b"><apply id="S4.SS2.SSS0.Px1.p1.3.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.3.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.3.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m1.1.1.2">𝜃</ci><ci id="S4.SS2.SSS0.Px1.p1.3.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.3.m1.1c">\mathbf{\theta}_{F}</annotation></semantics></math> and <math id="S4.SS2.SSS0.Px1.p1.4.m2.1" class="ltx_Math" alttext="\mathbf{\theta}_{C}" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.4.m2.1a"><msub id="S4.SS2.SSS0.Px1.p1.4.m2.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2.cmml">θ</mi><mi id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.3" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.4.m2.1b"><apply id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1.2">𝜃</ci><ci id="S4.SS2.SSS0.Px1.p1.4.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.4.m2.1c">\mathbf{\theta}_{C}</annotation></semantics></math> are the learnable parameters of <math id="S4.SS2.SSS0.Px1.p1.5.m3.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.5.m3.1a"><mi id="S4.SS2.SSS0.Px1.p1.5.m3.1.1" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.5.m3.1b"><ci id="S4.SS2.SSS0.Px1.p1.5.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.5.m3.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.5.m3.1c">F</annotation></semantics></math> and <math id="S4.SS2.SSS0.Px1.p1.6.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.6.m4.1a"><mi id="S4.SS2.SSS0.Px1.p1.6.m4.1.1" xref="S4.SS2.SSS0.Px1.p1.6.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.6.m4.1b"><ci id="S4.SS2.SSS0.Px1.p1.6.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.6.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.6.m4.1c">C</annotation></semantics></math>.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">To investigate the effectiveness of our approach, we perform 1-shot-5-way
classification following the meta-learning experimental
setup described in Sec. <a href="#S4.SS2" title="4.2 Meta Reinforced Synthetic Data for Few-shot Learning ‣ 4 Method ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>. We perform 1000 episodes
in meta-testing, with 16 query images per class per episode, and
report average classification accuracy and 95% confidence
intervals. We use the fine-grained classification dataset of Caltech UCSD
Birds (CUB) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> for our main experiments,
and another fine-grained dataset of North American Birds
(NAB) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> for secondary experiments. CUB has 11,788
images with 200 classes, and NAB has 48,527 images with 555 classes.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Implementation Details</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.12" class="ltx_p">While our fine-tuning method introduced in Sec. <a href="#S4.SS1" title="4.1 Fine-tuning Pre-trained Generator for Target Images ‣ 4 Method ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>
can generate images for each step in meta-training and meta-testing,
it takes around 20 seconds per image, so we apply the generation
method ahead of time to make our experiments more efficient. We use
a BigGAN pre-trained on ImageNet, using the publicly-available
weights. We set <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="\lambda_{p}=0.1" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><msub id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml"><mi id="S5.SS1.p1.1.m1.1.1.2.2" xref="S5.SS1.p1.1.m1.1.1.2.2.cmml">λ</mi><mi id="S5.SS1.p1.1.m1.1.1.2.3" xref="S5.SS1.p1.1.m1.1.1.2.3.cmml">p</mi></msub><mo id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><eq id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"></eq><apply id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.2.1.cmml" xref="S5.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.SS1.p1.1.m1.1.1.2.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2.2">𝜆</ci><ci id="S5.SS1.p1.1.m1.1.1.2.3.cmml" xref="S5.SS1.p1.1.m1.1.1.2.3">𝑝</ci></apply><cn type="float" id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\lambda_{p}=0.1</annotation></semantics></math> and <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="\lambda_{z}=0.1" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><msub id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml"><mi id="S5.SS1.p1.2.m2.1.1.2.2" xref="S5.SS1.p1.2.m2.1.1.2.2.cmml">λ</mi><mi id="S5.SS1.p1.2.m2.1.1.2.3" xref="S5.SS1.p1.2.m2.1.1.2.3.cmml">z</mi></msub><mo id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><eq id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1"></eq><apply id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p1.2.m2.1.1.2.1.cmml" xref="S5.SS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS1.p1.2.m2.1.1.2.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2.2">𝜆</ci><ci id="S5.SS1.p1.2.m2.1.1.2.3.cmml" xref="S5.SS1.p1.2.m2.1.1.2.3">𝑧</ci></apply><cn type="float" id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">\lambda_{z}=0.1</annotation></semantics></math>, and perform
500 gradient descent updates with the Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>
optimizer with learning rate <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mn id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">0.01</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><cn type="float" id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">0.01</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">0.01</annotation></semantics></math> for <math id="S5.SS1.p1.4.m4.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S5.SS1.p1.4.m4.1a"><mi id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><ci id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">z</annotation></semantics></math> and <math id="S5.SS1.p1.5.m5.1" class="ltx_Math" alttext="0.0005" display="inline"><semantics id="S5.SS1.p1.5.m5.1a"><mn id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml">0.0005</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><cn type="float" id="S5.SS1.p1.5.m5.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1">0.0005</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">0.0005</annotation></semantics></math> for the
fully connected layers, to produce scale and shift parameters of the
batch normalization layers. We manually chose these hyper-parameters
by trying random values from 0.1 to 0.0001 and visually checking the
quality of a few generated images. We only train once for each image,
generate 10 random images by perturbing <math id="S5.SS1.p1.6.m6.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S5.SS1.p1.6.m6.1a"><mi id="S5.SS1.p1.6.m6.1.1" xref="S5.SS1.p1.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m6.1b"><ci id="S5.SS1.p1.6.m6.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m6.1c">z</annotation></semantics></math>, and randomly use one of
them for each episode (<math id="S5.SS1.p1.7.m7.1" class="ltx_Math" alttext="n_{aug}=1" display="inline"><semantics id="S5.SS1.p1.7.m7.1a"><mrow id="S5.SS1.p1.7.m7.1.1" xref="S5.SS1.p1.7.m7.1.1.cmml"><msub id="S5.SS1.p1.7.m7.1.1.2" xref="S5.SS1.p1.7.m7.1.1.2.cmml"><mi id="S5.SS1.p1.7.m7.1.1.2.2" xref="S5.SS1.p1.7.m7.1.1.2.2.cmml">n</mi><mrow id="S5.SS1.p1.7.m7.1.1.2.3" xref="S5.SS1.p1.7.m7.1.1.2.3.cmml"><mi id="S5.SS1.p1.7.m7.1.1.2.3.2" xref="S5.SS1.p1.7.m7.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.7.m7.1.1.2.3.1" xref="S5.SS1.p1.7.m7.1.1.2.3.1.cmml">​</mo><mi id="S5.SS1.p1.7.m7.1.1.2.3.3" xref="S5.SS1.p1.7.m7.1.1.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.7.m7.1.1.2.3.1a" xref="S5.SS1.p1.7.m7.1.1.2.3.1.cmml">​</mo><mi id="S5.SS1.p1.7.m7.1.1.2.3.4" xref="S5.SS1.p1.7.m7.1.1.2.3.4.cmml">g</mi></mrow></msub><mo id="S5.SS1.p1.7.m7.1.1.1" xref="S5.SS1.p1.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.7.m7.1.1.3" xref="S5.SS1.p1.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.7.m7.1b"><apply id="S5.SS1.p1.7.m7.1.1.cmml" xref="S5.SS1.p1.7.m7.1.1"><eq id="S5.SS1.p1.7.m7.1.1.1.cmml" xref="S5.SS1.p1.7.m7.1.1.1"></eq><apply id="S5.SS1.p1.7.m7.1.1.2.cmml" xref="S5.SS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p1.7.m7.1.1.2.1.cmml" xref="S5.SS1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S5.SS1.p1.7.m7.1.1.2.2.cmml" xref="S5.SS1.p1.7.m7.1.1.2.2">𝑛</ci><apply id="S5.SS1.p1.7.m7.1.1.2.3.cmml" xref="S5.SS1.p1.7.m7.1.1.2.3"><times id="S5.SS1.p1.7.m7.1.1.2.3.1.cmml" xref="S5.SS1.p1.7.m7.1.1.2.3.1"></times><ci id="S5.SS1.p1.7.m7.1.1.2.3.2.cmml" xref="S5.SS1.p1.7.m7.1.1.2.3.2">𝑎</ci><ci id="S5.SS1.p1.7.m7.1.1.2.3.3.cmml" xref="S5.SS1.p1.7.m7.1.1.2.3.3">𝑢</ci><ci id="S5.SS1.p1.7.m7.1.1.2.3.4.cmml" xref="S5.SS1.p1.7.m7.1.1.2.3.4">𝑔</ci></apply></apply><cn type="integer" id="S5.SS1.p1.7.m7.1.1.3.cmml" xref="S5.SS1.p1.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.7.m7.1c">n_{aug}=1</annotation></semantics></math>). For image classification, we use
ResNet18 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> pre-trained on ImageNet for the two CNNs
in <math id="S5.SS1.p1.8.m8.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S5.SS1.p1.8.m8.1a"><mi id="S5.SS1.p1.8.m8.1.1" xref="S5.SS1.p1.8.m8.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.8.m8.1b"><ci id="S5.SS1.p1.8.m8.1.1.cmml" xref="S5.SS1.p1.8.m8.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.8.m8.1c">F</annotation></semantics></math> and one in <math id="S5.SS1.p1.9.m9.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S5.SS1.p1.9.m9.1a"><mi id="S5.SS1.p1.9.m9.1.1" xref="S5.SS1.p1.9.m9.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.9.m9.1b"><ci id="S5.SS1.p1.9.m9.1.1.cmml" xref="S5.SS1.p1.9.m9.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.9.m9.1c">C</annotation></semantics></math>. We train <math id="S5.SS1.p1.10.m10.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S5.SS1.p1.10.m10.1a"><mi id="S5.SS1.p1.10.m10.1.1" xref="S5.SS1.p1.10.m10.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.10.m10.1b"><ci id="S5.SS1.p1.10.m10.1.1.cmml" xref="S5.SS1.p1.10.m10.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.10.m10.1c">F</annotation></semantics></math> and <math id="S5.SS1.p1.11.m11.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S5.SS1.p1.11.m11.1a"><mi id="S5.SS1.p1.11.m11.1.1" xref="S5.SS1.p1.11.m11.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.11.m11.1b"><ci id="S5.SS1.p1.11.m11.1.1.cmml" xref="S5.SS1.p1.11.m11.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.11.m11.1c">C</annotation></semantics></math> with Adam with a default
learning rate of <math id="S5.SS1.p1.12.m12.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="S5.SS1.p1.12.m12.1a"><mn id="S5.SS1.p1.12.m12.1.1" xref="S5.SS1.p1.12.m12.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.12.m12.1b"><cn type="float" id="S5.SS1.p1.12.m12.1.1.cmml" xref="S5.SS1.p1.12.m12.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.12.m12.1c">0.001</annotation></semantics></math>. We select the best model based on the
validation accuracy, and then compute the final accuracy on the test
set. For CUB, we use the same train/val/test split used in previous
work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, and for NAB we randomly split with a
proportion of train:val:test = 2:1:1; see supplementary material for
details. Further implementation details are available as supplemental
source code.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>http://vision.soic.indiana.edu/metairnet/</span></span></span></p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Comparative and Ablative Study on CUB dataset</h3>

<section id="S5.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Baselines.</h5>

<div id="S5.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px1.p1.4" class="ltx_p">We compare our
MetaIRNet with three types of baselines. (1) Non-meta learning
classifiers: We directly train the same ImageNet pre-trained CNN used
in <math id="S5.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="S5.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.1.m1.1c">F</annotation></semantics></math> to classify images in <math id="S5.SS2.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{base}" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.2.m2.1a"><msub id="S5.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">𝒟</mi><mrow id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.1" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.1a" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.4" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.1b" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.5" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.5.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.2">𝒟</ci><apply id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3"><times id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.1"></times><ci id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.2">𝑏</ci><ci id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.3.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.3">𝑎</ci><ci id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.4.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.4">𝑠</ci><ci id="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.5.cmml" xref="S5.SS2.SSS0.Px1.p1.2.m2.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.2.m2.1c">\mathcal{D}_{base}</annotation></semantics></math>, and use it as a
feature extractor for <math id="S5.SS2.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{novel}" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.3.m3.1a"><msub id="S5.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.2" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml">𝒟</mi><mrow id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.cmml"><mi id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.2" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.1" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.3" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.1a" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.4" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.1b" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.5" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.1c" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.6" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.3.m3.1b"><apply id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.2">𝒟</ci><apply id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3"><times id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.1"></times><ci id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.2">𝑛</ci><ci id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.3.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.3">𝑜</ci><ci id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.4.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.4">𝑣</ci><ci id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.5.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.5">𝑒</ci><ci id="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.6.cmml" xref="S5.SS2.SSS0.Px1.p1.3.m3.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.3.m3.1c">\mathcal{D}_{novel}</annotation></semantics></math>. We then use off-the-shelf
classifiers <span id="S5.SS2.SSS0.Px1.p1.4.1" class="ltx_text ltx_font_bold">nearest neighbor</span>, <span id="S5.SS2.SSS0.Px1.p1.4.2" class="ltx_text ltx_font_bold">logistic regression</span>
(one-vs-all classifier), and <span id="S5.SS2.SSS0.Px1.p1.4.3" class="ltx_text ltx_font_bold">softmax regression</span> (also called
multi-class logistic regression). (2) Meta-learning classifiers: We
try the meta-learning method of prototypical network
(<span id="S5.SS2.SSS0.Px1.p1.4.4" class="ltx_text ltx_font_bold">ProtoNet</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>). ProtoNet computes
an average prototype vector for each class and performs nearest
neighbor with the prototypes. We note that our MetaIRNet adapts
ProtoNet as a choice of <math id="S5.SS2.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.4.m4.1a"><mi id="S5.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S5.SS2.SSS0.Px1.p1.4.m4.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px1.p1.4.m4.1b"><ci id="S5.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S5.SS2.SSS0.Px1.p1.4.m4.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px1.p1.4.m4.1c">F</annotation></semantics></math> so this is an ablative version of our
model (MetaIRNet without the image fusion module). (3) Data
augmentation: Because our MetaIRNet learns data-augmentation as a
sub-module, we also compare with three data augmentation strategies,
Flip, Gaussian, and FinetuneGAN. <span id="S5.SS2.SSS0.Px1.p1.4.5" class="ltx_text ltx_font_bold">Flip</span> horizontally flips the
images. <span id="S5.SS2.SSS0.Px1.p1.4.6" class="ltx_text ltx_font_bold">Gaussian</span> adds Gaussian noise with standard deviation
0.01 into the CNN features. <span id="S5.SS2.SSS0.Px1.p1.4.7" class="ltx_text ltx_font_bold">FinetuneGAN</span> (introduced in
Sec. <a href="#S4.SS1" title="4.1 Fine-tuning Pre-trained Generator for Target Images ‣ 4 Method ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>) generates augmented images by
fine-tuning the ImageNet-pretrained BigGAN with each support set. Note
that we do these augmentations in the meta-testing stage to increase
the support set. For fair comparison, we use ProtoNet as the base
classifier of these data augmentation baselines.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>5-way-1-shot accuracy (%) on CUB/NAB dataset with ImageNet pre-trained ResNet18</figcaption>
<table id="S5.T2.18" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.18.19.1" class="ltx_tr">
<th id="S5.T2.18.19.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt">Method</th>
<th id="S5.T2.18.19.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt">Data Augmentation</th>
<td id="S5.T2.18.19.1.3" class="ltx_td ltx_align_center ltx_border_tt">CUB Acc.</td>
<td id="S5.T2.18.19.1.4" class="ltx_td ltx_align_center ltx_border_tt">NAB Acc.</td>
</tr>
<tr id="S5.T2.2.2" class="ltx_tr">
<th id="S5.T2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Nearest Neighbor</th>
<th id="S5.T2.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">-</th>
<td id="S5.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="79.00\pm 0.62" display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mrow id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml"><mn id="S5.T2.1.1.1.m1.1.1.2" xref="S5.T2.1.1.1.m1.1.1.2.cmml">79.00</mn><mo id="S5.T2.1.1.1.m1.1.1.1" xref="S5.T2.1.1.1.m1.1.1.1.cmml">±</mo><mn id="S5.T2.1.1.1.m1.1.1.3" xref="S5.T2.1.1.1.m1.1.1.3.cmml">0.62</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><apply id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.1.1.1.m1.1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.1.1.1.m1.1.1.2.cmml" xref="S5.T2.1.1.1.m1.1.1.2">79.00</cn><cn type="float" id="S5.T2.1.1.1.m1.1.1.3.cmml" xref="S5.T2.1.1.1.m1.1.1.3">0.62</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">79.00\pm 0.62</annotation></semantics></math></td>
<td id="S5.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.2.2.2.m1.1" class="ltx_Math" alttext="80.58\pm 0.59" display="inline"><semantics id="S5.T2.2.2.2.m1.1a"><mrow id="S5.T2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.m1.1.1.cmml"><mn id="S5.T2.2.2.2.m1.1.1.2" xref="S5.T2.2.2.2.m1.1.1.2.cmml">80.58</mn><mo id="S5.T2.2.2.2.m1.1.1.1" xref="S5.T2.2.2.2.m1.1.1.1.cmml">±</mo><mn id="S5.T2.2.2.2.m1.1.1.3" xref="S5.T2.2.2.2.m1.1.1.3.cmml">0.59</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><apply id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.2.2.2.m1.1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.2.2.2.m1.1.1.2.cmml" xref="S5.T2.2.2.2.m1.1.1.2">80.58</cn><cn type="float" id="S5.T2.2.2.2.m1.1.1.3.cmml" xref="S5.T2.2.2.2.m1.1.1.3">0.59</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">80.58\pm 0.59</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.4.4" class="ltx_tr">
<th id="S5.T2.4.4.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">Logistic Regression</th>
<th id="S5.T2.4.4.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">-</th>
<td id="S5.T2.3.3.1" class="ltx_td ltx_align_center"><math id="S5.T2.3.3.1.m1.1" class="ltx_Math" alttext="81.17\pm 0.60" display="inline"><semantics id="S5.T2.3.3.1.m1.1a"><mrow id="S5.T2.3.3.1.m1.1.1" xref="S5.T2.3.3.1.m1.1.1.cmml"><mn id="S5.T2.3.3.1.m1.1.1.2" xref="S5.T2.3.3.1.m1.1.1.2.cmml">81.17</mn><mo id="S5.T2.3.3.1.m1.1.1.1" xref="S5.T2.3.3.1.m1.1.1.1.cmml">±</mo><mn id="S5.T2.3.3.1.m1.1.1.3" xref="S5.T2.3.3.1.m1.1.1.3.cmml">0.60</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.1.m1.1b"><apply id="S5.T2.3.3.1.m1.1.1.cmml" xref="S5.T2.3.3.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.3.3.1.m1.1.1.1.cmml" xref="S5.T2.3.3.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.3.3.1.m1.1.1.2.cmml" xref="S5.T2.3.3.1.m1.1.1.2">81.17</cn><cn type="float" id="S5.T2.3.3.1.m1.1.1.3.cmml" xref="S5.T2.3.3.1.m1.1.1.3">0.60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.1.m1.1c">81.17\pm 0.60</annotation></semantics></math></td>
<td id="S5.T2.4.4.2" class="ltx_td ltx_align_center"><math id="S5.T2.4.4.2.m1.1" class="ltx_Math" alttext="82.70\pm 0.57" display="inline"><semantics id="S5.T2.4.4.2.m1.1a"><mrow id="S5.T2.4.4.2.m1.1.1" xref="S5.T2.4.4.2.m1.1.1.cmml"><mn id="S5.T2.4.4.2.m1.1.1.2" xref="S5.T2.4.4.2.m1.1.1.2.cmml">82.70</mn><mo id="S5.T2.4.4.2.m1.1.1.1" xref="S5.T2.4.4.2.m1.1.1.1.cmml">±</mo><mn id="S5.T2.4.4.2.m1.1.1.3" xref="S5.T2.4.4.2.m1.1.1.3.cmml">0.57</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.2.m1.1b"><apply id="S5.T2.4.4.2.m1.1.1.cmml" xref="S5.T2.4.4.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.4.4.2.m1.1.1.1.cmml" xref="S5.T2.4.4.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.4.4.2.m1.1.1.2.cmml" xref="S5.T2.4.4.2.m1.1.1.2">82.70</cn><cn type="float" id="S5.T2.4.4.2.m1.1.1.3.cmml" xref="S5.T2.4.4.2.m1.1.1.3">0.57</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.2.m1.1c">82.70\pm 0.57</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.6.6" class="ltx_tr">
<th id="S5.T2.6.6.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">Softmax Regression</th>
<th id="S5.T2.6.6.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">-</th>
<td id="S5.T2.5.5.1" class="ltx_td ltx_align_center"><math id="S5.T2.5.5.1.m1.1" class="ltx_Math" alttext="80.77\pm 0.60" display="inline"><semantics id="S5.T2.5.5.1.m1.1a"><mrow id="S5.T2.5.5.1.m1.1.1" xref="S5.T2.5.5.1.m1.1.1.cmml"><mn id="S5.T2.5.5.1.m1.1.1.2" xref="S5.T2.5.5.1.m1.1.1.2.cmml">80.77</mn><mo id="S5.T2.5.5.1.m1.1.1.1" xref="S5.T2.5.5.1.m1.1.1.1.cmml">±</mo><mn id="S5.T2.5.5.1.m1.1.1.3" xref="S5.T2.5.5.1.m1.1.1.3.cmml">0.60</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.1.m1.1b"><apply id="S5.T2.5.5.1.m1.1.1.cmml" xref="S5.T2.5.5.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.5.5.1.m1.1.1.1.cmml" xref="S5.T2.5.5.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.5.5.1.m1.1.1.2.cmml" xref="S5.T2.5.5.1.m1.1.1.2">80.77</cn><cn type="float" id="S5.T2.5.5.1.m1.1.1.3.cmml" xref="S5.T2.5.5.1.m1.1.1.3">0.60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.1.m1.1c">80.77\pm 0.60</annotation></semantics></math></td>
<td id="S5.T2.6.6.2" class="ltx_td ltx_align_center"><math id="S5.T2.6.6.2.m1.1" class="ltx_Math" alttext="82.38\pm 0.57" display="inline"><semantics id="S5.T2.6.6.2.m1.1a"><mrow id="S5.T2.6.6.2.m1.1.1" xref="S5.T2.6.6.2.m1.1.1.cmml"><mn id="S5.T2.6.6.2.m1.1.1.2" xref="S5.T2.6.6.2.m1.1.1.2.cmml">82.38</mn><mo id="S5.T2.6.6.2.m1.1.1.1" xref="S5.T2.6.6.2.m1.1.1.1.cmml">±</mo><mn id="S5.T2.6.6.2.m1.1.1.3" xref="S5.T2.6.6.2.m1.1.1.3.cmml">0.57</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.2.m1.1b"><apply id="S5.T2.6.6.2.m1.1.1.cmml" xref="S5.T2.6.6.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.6.6.2.m1.1.1.1.cmml" xref="S5.T2.6.6.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.6.6.2.m1.1.1.2.cmml" xref="S5.T2.6.6.2.m1.1.1.2">82.38</cn><cn type="float" id="S5.T2.6.6.2.m1.1.1.3.cmml" xref="S5.T2.6.6.2.m1.1.1.3">0.57</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.2.m1.1c">82.38\pm 0.57</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.8.8" class="ltx_tr">
<th id="S5.T2.8.8.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">ProtoNet</th>
<th id="S5.T2.8.8.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">-</th>
<td id="S5.T2.7.7.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.7.7.1.m1.1" class="ltx_Math" alttext="81.73\pm 0.63" display="inline"><semantics id="S5.T2.7.7.1.m1.1a"><mrow id="S5.T2.7.7.1.m1.1.1" xref="S5.T2.7.7.1.m1.1.1.cmml"><mn id="S5.T2.7.7.1.m1.1.1.2" xref="S5.T2.7.7.1.m1.1.1.2.cmml">81.73</mn><mo id="S5.T2.7.7.1.m1.1.1.1" xref="S5.T2.7.7.1.m1.1.1.1.cmml">±</mo><mn id="S5.T2.7.7.1.m1.1.1.3" xref="S5.T2.7.7.1.m1.1.1.3.cmml">0.63</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.1.m1.1b"><apply id="S5.T2.7.7.1.m1.1.1.cmml" xref="S5.T2.7.7.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.7.7.1.m1.1.1.1.cmml" xref="S5.T2.7.7.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.7.7.1.m1.1.1.2.cmml" xref="S5.T2.7.7.1.m1.1.1.2">81.73</cn><cn type="float" id="S5.T2.7.7.1.m1.1.1.3.cmml" xref="S5.T2.7.7.1.m1.1.1.3">0.63</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.1.m1.1c">81.73\pm 0.63</annotation></semantics></math></td>
<td id="S5.T2.8.8.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.8.8.2.m1.1" class="ltx_Math" alttext="87.91\pm 0.52" display="inline"><semantics id="S5.T2.8.8.2.m1.1a"><mrow id="S5.T2.8.8.2.m1.1.1" xref="S5.T2.8.8.2.m1.1.1.cmml"><mn id="S5.T2.8.8.2.m1.1.1.2" xref="S5.T2.8.8.2.m1.1.1.2.cmml">87.91</mn><mo id="S5.T2.8.8.2.m1.1.1.1" xref="S5.T2.8.8.2.m1.1.1.1.cmml">±</mo><mn id="S5.T2.8.8.2.m1.1.1.3" xref="S5.T2.8.8.2.m1.1.1.3.cmml">0.52</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.2.m1.1b"><apply id="S5.T2.8.8.2.m1.1.1.cmml" xref="S5.T2.8.8.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.8.8.2.m1.1.1.1.cmml" xref="S5.T2.8.8.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.8.8.2.m1.1.1.2.cmml" xref="S5.T2.8.8.2.m1.1.1.2">87.91</cn><cn type="float" id="S5.T2.8.8.2.m1.1.1.3.cmml" xref="S5.T2.8.8.2.m1.1.1.3">0.52</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.2.m1.1c">87.91\pm 0.52</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.10.10" class="ltx_tr">
<th id="S5.T2.10.10.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">ProtoNet</th>
<th id="S5.T2.10.10.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">FinetuneGAN</th>
<td id="S5.T2.9.9.1" class="ltx_td ltx_align_center"><math id="S5.T2.9.9.1.m1.1" class="ltx_Math" alttext="79.40\pm 0.69" display="inline"><semantics id="S5.T2.9.9.1.m1.1a"><mrow id="S5.T2.9.9.1.m1.1.1" xref="S5.T2.9.9.1.m1.1.1.cmml"><mn id="S5.T2.9.9.1.m1.1.1.2" xref="S5.T2.9.9.1.m1.1.1.2.cmml">79.40</mn><mo id="S5.T2.9.9.1.m1.1.1.1" xref="S5.T2.9.9.1.m1.1.1.1.cmml">±</mo><mn id="S5.T2.9.9.1.m1.1.1.3" xref="S5.T2.9.9.1.m1.1.1.3.cmml">0.69</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.1.m1.1b"><apply id="S5.T2.9.9.1.m1.1.1.cmml" xref="S5.T2.9.9.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.9.9.1.m1.1.1.1.cmml" xref="S5.T2.9.9.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.9.9.1.m1.1.1.2.cmml" xref="S5.T2.9.9.1.m1.1.1.2">79.40</cn><cn type="float" id="S5.T2.9.9.1.m1.1.1.3.cmml" xref="S5.T2.9.9.1.m1.1.1.3">0.69</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.1.m1.1c">79.40\pm 0.69</annotation></semantics></math></td>
<td id="S5.T2.10.10.2" class="ltx_td ltx_align_center"><math id="S5.T2.10.10.2.m1.1" class="ltx_Math" alttext="85.40\pm 0.59" display="inline"><semantics id="S5.T2.10.10.2.m1.1a"><mrow id="S5.T2.10.10.2.m1.1.1" xref="S5.T2.10.10.2.m1.1.1.cmml"><mn id="S5.T2.10.10.2.m1.1.1.2" xref="S5.T2.10.10.2.m1.1.1.2.cmml">85.40</mn><mo id="S5.T2.10.10.2.m1.1.1.1" xref="S5.T2.10.10.2.m1.1.1.1.cmml">±</mo><mn id="S5.T2.10.10.2.m1.1.1.3" xref="S5.T2.10.10.2.m1.1.1.3.cmml">0.59</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.2.m1.1b"><apply id="S5.T2.10.10.2.m1.1.1.cmml" xref="S5.T2.10.10.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.10.10.2.m1.1.1.1.cmml" xref="S5.T2.10.10.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.10.10.2.m1.1.1.2.cmml" xref="S5.T2.10.10.2.m1.1.1.2">85.40</cn><cn type="float" id="S5.T2.10.10.2.m1.1.1.3.cmml" xref="S5.T2.10.10.2.m1.1.1.3">0.59</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.2.m1.1c">85.40\pm 0.59</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.12.12" class="ltx_tr">
<th id="S5.T2.12.12.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">ProtoNet</th>
<th id="S5.T2.12.12.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">Flip</th>
<td id="S5.T2.11.11.1" class="ltx_td ltx_align_center"><math id="S5.T2.11.11.1.m1.1" class="ltx_Math" alttext="82.66\pm 0.61" display="inline"><semantics id="S5.T2.11.11.1.m1.1a"><mrow id="S5.T2.11.11.1.m1.1.1" xref="S5.T2.11.11.1.m1.1.1.cmml"><mn id="S5.T2.11.11.1.m1.1.1.2" xref="S5.T2.11.11.1.m1.1.1.2.cmml">82.66</mn><mo id="S5.T2.11.11.1.m1.1.1.1" xref="S5.T2.11.11.1.m1.1.1.1.cmml">±</mo><mn id="S5.T2.11.11.1.m1.1.1.3" xref="S5.T2.11.11.1.m1.1.1.3.cmml">0.61</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.1.m1.1b"><apply id="S5.T2.11.11.1.m1.1.1.cmml" xref="S5.T2.11.11.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.11.11.1.m1.1.1.1.cmml" xref="S5.T2.11.11.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.11.11.1.m1.1.1.2.cmml" xref="S5.T2.11.11.1.m1.1.1.2">82.66</cn><cn type="float" id="S5.T2.11.11.1.m1.1.1.3.cmml" xref="S5.T2.11.11.1.m1.1.1.3">0.61</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.1.m1.1c">82.66\pm 0.61</annotation></semantics></math></td>
<td id="S5.T2.12.12.2" class="ltx_td ltx_align_center"><math id="S5.T2.12.12.2.m1.1" class="ltx_Math" alttext="88.55\pm 0.50" display="inline"><semantics id="S5.T2.12.12.2.m1.1a"><mrow id="S5.T2.12.12.2.m1.1.1" xref="S5.T2.12.12.2.m1.1.1.cmml"><mn id="S5.T2.12.12.2.m1.1.1.2" xref="S5.T2.12.12.2.m1.1.1.2.cmml">88.55</mn><mo id="S5.T2.12.12.2.m1.1.1.1" xref="S5.T2.12.12.2.m1.1.1.1.cmml">±</mo><mn id="S5.T2.12.12.2.m1.1.1.3" xref="S5.T2.12.12.2.m1.1.1.3.cmml">0.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.12.12.2.m1.1b"><apply id="S5.T2.12.12.2.m1.1.1.cmml" xref="S5.T2.12.12.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.12.12.2.m1.1.1.1.cmml" xref="S5.T2.12.12.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.12.12.2.m1.1.1.2.cmml" xref="S5.T2.12.12.2.m1.1.1.2">88.55</cn><cn type="float" id="S5.T2.12.12.2.m1.1.1.3.cmml" xref="S5.T2.12.12.2.m1.1.1.3">0.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.12.2.m1.1c">88.55\pm 0.50</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.14.14" class="ltx_tr">
<th id="S5.T2.14.14.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">ProtoNet</th>
<th id="S5.T2.14.14.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">Gaussian</th>
<td id="S5.T2.13.13.1" class="ltx_td ltx_align_center"><math id="S5.T2.13.13.1.m1.1" class="ltx_Math" alttext="81.75\pm 0.63" display="inline"><semantics id="S5.T2.13.13.1.m1.1a"><mrow id="S5.T2.13.13.1.m1.1.1" xref="S5.T2.13.13.1.m1.1.1.cmml"><mn id="S5.T2.13.13.1.m1.1.1.2" xref="S5.T2.13.13.1.m1.1.1.2.cmml">81.75</mn><mo id="S5.T2.13.13.1.m1.1.1.1" xref="S5.T2.13.13.1.m1.1.1.1.cmml">±</mo><mn id="S5.T2.13.13.1.m1.1.1.3" xref="S5.T2.13.13.1.m1.1.1.3.cmml">0.63</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.13.13.1.m1.1b"><apply id="S5.T2.13.13.1.m1.1.1.cmml" xref="S5.T2.13.13.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.13.13.1.m1.1.1.1.cmml" xref="S5.T2.13.13.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.13.13.1.m1.1.1.2.cmml" xref="S5.T2.13.13.1.m1.1.1.2">81.75</cn><cn type="float" id="S5.T2.13.13.1.m1.1.1.3.cmml" xref="S5.T2.13.13.1.m1.1.1.3">0.63</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.13.1.m1.1c">81.75\pm 0.63</annotation></semantics></math></td>
<td id="S5.T2.14.14.2" class="ltx_td ltx_align_center"><math id="S5.T2.14.14.2.m1.1" class="ltx_Math" alttext="87.90\pm 0.52" display="inline"><semantics id="S5.T2.14.14.2.m1.1a"><mrow id="S5.T2.14.14.2.m1.1.1" xref="S5.T2.14.14.2.m1.1.1.cmml"><mn id="S5.T2.14.14.2.m1.1.1.2" xref="S5.T2.14.14.2.m1.1.1.2.cmml">87.90</mn><mo id="S5.T2.14.14.2.m1.1.1.1" xref="S5.T2.14.14.2.m1.1.1.1.cmml">±</mo><mn id="S5.T2.14.14.2.m1.1.1.3" xref="S5.T2.14.14.2.m1.1.1.3.cmml">0.52</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.14.14.2.m1.1b"><apply id="S5.T2.14.14.2.m1.1.1.cmml" xref="S5.T2.14.14.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.14.14.2.m1.1.1.1.cmml" xref="S5.T2.14.14.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.14.14.2.m1.1.1.2.cmml" xref="S5.T2.14.14.2.m1.1.1.2">87.90</cn><cn type="float" id="S5.T2.14.14.2.m1.1.1.3.cmml" xref="S5.T2.14.14.2.m1.1.1.3">0.52</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.14.2.m1.1c">87.90\pm 0.52</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.16.16" class="ltx_tr">
<th id="S5.T2.16.16.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">MetaIRNet (Ours)</th>
<th id="S5.T2.16.16.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FinetuneGAN</th>
<td id="S5.T2.15.15.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.15.15.1.m1.1" class="ltx_Math" alttext="84.13\pm 0.58" display="inline"><semantics id="S5.T2.15.15.1.m1.1a"><mrow id="S5.T2.15.15.1.m1.1.1" xref="S5.T2.15.15.1.m1.1.1.cmml"><mn id="S5.T2.15.15.1.m1.1.1.2" xref="S5.T2.15.15.1.m1.1.1.2.cmml">84.13</mn><mo id="S5.T2.15.15.1.m1.1.1.1" xref="S5.T2.15.15.1.m1.1.1.1.cmml">±</mo><mn id="S5.T2.15.15.1.m1.1.1.3" xref="S5.T2.15.15.1.m1.1.1.3.cmml">0.58</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.15.15.1.m1.1b"><apply id="S5.T2.15.15.1.m1.1.1.cmml" xref="S5.T2.15.15.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.15.15.1.m1.1.1.1.cmml" xref="S5.T2.15.15.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.15.15.1.m1.1.1.2.cmml" xref="S5.T2.15.15.1.m1.1.1.2">84.13</cn><cn type="float" id="S5.T2.15.15.1.m1.1.1.3.cmml" xref="S5.T2.15.15.1.m1.1.1.3">0.58</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.15.1.m1.1c">84.13\pm 0.58</annotation></semantics></math></td>
<td id="S5.T2.16.16.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.16.16.2.m1.1" class="ltx_Math" alttext="89.19\pm 0.51" display="inline"><semantics id="S5.T2.16.16.2.m1.1a"><mrow id="S5.T2.16.16.2.m1.1.1" xref="S5.T2.16.16.2.m1.1.1.cmml"><mn id="S5.T2.16.16.2.m1.1.1.2" xref="S5.T2.16.16.2.m1.1.1.2.cmml">89.19</mn><mo id="S5.T2.16.16.2.m1.1.1.1" xref="S5.T2.16.16.2.m1.1.1.1.cmml">±</mo><mn id="S5.T2.16.16.2.m1.1.1.3" xref="S5.T2.16.16.2.m1.1.1.3.cmml">0.51</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.16.16.2.m1.1b"><apply id="S5.T2.16.16.2.m1.1.1.cmml" xref="S5.T2.16.16.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.16.16.2.m1.1.1.1.cmml" xref="S5.T2.16.16.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.16.16.2.m1.1.1.2.cmml" xref="S5.T2.16.16.2.m1.1.1.2">89.19</cn><cn type="float" id="S5.T2.16.16.2.m1.1.1.3.cmml" xref="S5.T2.16.16.2.m1.1.1.3">0.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.16.2.m1.1c">89.19\pm 0.51</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.18.18" class="ltx_tr">
<th id="S5.T2.18.18.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">MetaIRNet (Ours)</th>
<th id="S5.T2.18.18.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">FinetuneGAN, Flip</th>
<td id="S5.T2.17.17.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S5.T2.17.17.1.m1.1" class="ltx_Math" alttext="\mathbf{84.80\pm 0.56}" display="inline"><semantics id="S5.T2.17.17.1.m1.1a"><mrow id="S5.T2.17.17.1.m1.1.1" xref="S5.T2.17.17.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.17.17.1.m1.1.1.2" xref="S5.T2.17.17.1.m1.1.1.2.cmml">84.80</mn><mo id="S5.T2.17.17.1.m1.1.1.1" xref="S5.T2.17.17.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.17.17.1.m1.1.1.3" xref="S5.T2.17.17.1.m1.1.1.3.cmml">0.56</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.17.17.1.m1.1b"><apply id="S5.T2.17.17.1.m1.1.1.cmml" xref="S5.T2.17.17.1.m1.1.1"><csymbol cd="latexml" id="S5.T2.17.17.1.m1.1.1.1.cmml" xref="S5.T2.17.17.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.17.17.1.m1.1.1.2.cmml" xref="S5.T2.17.17.1.m1.1.1.2">84.80</cn><cn type="float" id="S5.T2.17.17.1.m1.1.1.3.cmml" xref="S5.T2.17.17.1.m1.1.1.3">0.56</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.17.1.m1.1c">\mathbf{84.80\pm 0.56}</annotation></semantics></math></td>
<td id="S5.T2.18.18.2" class="ltx_td ltx_align_center ltx_border_bb"><math id="S5.T2.18.18.2.m1.1" class="ltx_Math" alttext="\mathbf{89.57\pm 0.49}" display="inline"><semantics id="S5.T2.18.18.2.m1.1a"><mrow id="S5.T2.18.18.2.m1.1.1" xref="S5.T2.18.18.2.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.18.18.2.m1.1.1.2" xref="S5.T2.18.18.2.m1.1.1.2.cmml">89.57</mn><mo id="S5.T2.18.18.2.m1.1.1.1" xref="S5.T2.18.18.2.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T2.18.18.2.m1.1.1.3" xref="S5.T2.18.18.2.m1.1.1.3.cmml">0.49</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.18.18.2.m1.1b"><apply id="S5.T2.18.18.2.m1.1.1.cmml" xref="S5.T2.18.18.2.m1.1.1"><csymbol cd="latexml" id="S5.T2.18.18.2.m1.1.1.1.cmml" xref="S5.T2.18.18.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T2.18.18.2.m1.1.1.2.cmml" xref="S5.T2.18.18.2.m1.1.1.2">89.57</cn><cn type="float" id="S5.T2.18.18.2.m1.1.1.3.cmml" xref="S5.T2.18.18.2.m1.1.1.3">0.49</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.18.2.m1.1c">\mathbf{89.57\pm 0.49}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>5-way-1-shot accuracy (%) on CUB dataset with Conv4 without ImageNet pre-training</figcaption>
<table id="S5.T3.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.5.6.1" class="ltx_tr">
<th id="S5.T3.5.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">MetaIRNet</th>
<th id="S5.T3.5.6.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">ProtoNet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>
</th>
<th id="S5.T3.5.6.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">MatchingNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>
</th>
<th id="S5.T3.5.6.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">MAML <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</th>
<th id="S5.T3.5.6.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">RelationNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.5.5" class="ltx_tr">
<th id="S5.T3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><math id="S5.T3.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{65.86\pm 0.72}" display="inline"><semantics id="S5.T3.1.1.1.m1.1a"><mrow id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T3.1.1.1.m1.1.1.2" xref="S5.T3.1.1.1.m1.1.1.2.cmml">65.86</mn><mo id="S5.T3.1.1.1.m1.1.1.1" xref="S5.T3.1.1.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S5.T3.1.1.1.m1.1.1.3" xref="S5.T3.1.1.1.m1.1.1.3.cmml">0.72</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.1b"><apply id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1"><csymbol cd="latexml" id="S5.T3.1.1.1.m1.1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T3.1.1.1.m1.1.1.2.cmml" xref="S5.T3.1.1.1.m1.1.1.2">65.86</cn><cn type="float" id="S5.T3.1.1.1.m1.1.1.3.cmml" xref="S5.T3.1.1.1.m1.1.1.3">0.72</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.1c">\mathbf{65.86\pm 0.72}</annotation></semantics></math></th>
<td id="S5.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="S5.T3.2.2.2.m1.1" class="ltx_Math" alttext="63.50\pm 0.70" display="inline"><semantics id="S5.T3.2.2.2.m1.1a"><mrow id="S5.T3.2.2.2.m1.1.1" xref="S5.T3.2.2.2.m1.1.1.cmml"><mn id="S5.T3.2.2.2.m1.1.1.2" xref="S5.T3.2.2.2.m1.1.1.2.cmml">63.50</mn><mo id="S5.T3.2.2.2.m1.1.1.1" xref="S5.T3.2.2.2.m1.1.1.1.cmml">±</mo><mn id="S5.T3.2.2.2.m1.1.1.3" xref="S5.T3.2.2.2.m1.1.1.3.cmml">0.70</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.m1.1b"><apply id="S5.T3.2.2.2.m1.1.1.cmml" xref="S5.T3.2.2.2.m1.1.1"><csymbol cd="latexml" id="S5.T3.2.2.2.m1.1.1.1.cmml" xref="S5.T3.2.2.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T3.2.2.2.m1.1.1.2.cmml" xref="S5.T3.2.2.2.m1.1.1.2">63.50</cn><cn type="float" id="S5.T3.2.2.2.m1.1.1.3.cmml" xref="S5.T3.2.2.2.m1.1.1.3">0.70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.m1.1c">63.50\pm 0.70</annotation></semantics></math></td>
<td id="S5.T3.3.3.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">
<math id="S5.T3.3.3.3.m1.1" class="ltx_Math" alttext="61.16\pm 0.89" display="inline"><semantics id="S5.T3.3.3.3.m1.1a"><mrow id="S5.T3.3.3.3.m1.1.1" xref="S5.T3.3.3.3.m1.1.1.cmml"><mn id="S5.T3.3.3.3.m1.1.1.2" xref="S5.T3.3.3.3.m1.1.1.2.cmml">61.16</mn><mo id="S5.T3.3.3.3.m1.1.1.1" xref="S5.T3.3.3.3.m1.1.1.1.cmml">±</mo><mn id="S5.T3.3.3.3.m1.1.1.3" xref="S5.T3.3.3.3.m1.1.1.3.cmml">0.89</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.m1.1b"><apply id="S5.T3.3.3.3.m1.1.1.cmml" xref="S5.T3.3.3.3.m1.1.1"><csymbol cd="latexml" id="S5.T3.3.3.3.m1.1.1.1.cmml" xref="S5.T3.3.3.3.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T3.3.3.3.m1.1.1.2.cmml" xref="S5.T3.3.3.3.m1.1.1.2">61.16</cn><cn type="float" id="S5.T3.3.3.3.m1.1.1.3.cmml" xref="S5.T3.3.3.3.m1.1.1.3">0.89</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.m1.1c">61.16\pm 0.89</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
<td id="S5.T3.4.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">
<math id="S5.T3.4.4.4.m1.1" class="ltx_Math" alttext="55.92\pm 0.95" display="inline"><semantics id="S5.T3.4.4.4.m1.1a"><mrow id="S5.T3.4.4.4.m1.1.1" xref="S5.T3.4.4.4.m1.1.1.cmml"><mn id="S5.T3.4.4.4.m1.1.1.2" xref="S5.T3.4.4.4.m1.1.1.2.cmml">55.92</mn><mo id="S5.T3.4.4.4.m1.1.1.1" xref="S5.T3.4.4.4.m1.1.1.1.cmml">±</mo><mn id="S5.T3.4.4.4.m1.1.1.3" xref="S5.T3.4.4.4.m1.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.4.m1.1b"><apply id="S5.T3.4.4.4.m1.1.1.cmml" xref="S5.T3.4.4.4.m1.1.1"><csymbol cd="latexml" id="S5.T3.4.4.4.m1.1.1.1.cmml" xref="S5.T3.4.4.4.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T3.4.4.4.m1.1.1.2.cmml" xref="S5.T3.4.4.4.m1.1.1.2">55.92</cn><cn type="float" id="S5.T3.4.4.4.m1.1.1.3.cmml" xref="S5.T3.4.4.4.m1.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.4.m1.1c">55.92\pm 0.95</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
<td id="S5.T3.5.5.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">
<math id="S5.T3.5.5.5.m1.1" class="ltx_Math" alttext="62.45\pm 0.98" display="inline"><semantics id="S5.T3.5.5.5.m1.1a"><mrow id="S5.T3.5.5.5.m1.1.1" xref="S5.T3.5.5.5.m1.1.1.cmml"><mn id="S5.T3.5.5.5.m1.1.1.2" xref="S5.T3.5.5.5.m1.1.1.2.cmml">62.45</mn><mo id="S5.T3.5.5.5.m1.1.1.1" xref="S5.T3.5.5.5.m1.1.1.1.cmml">±</mo><mn id="S5.T3.5.5.5.m1.1.1.3" xref="S5.T3.5.5.5.m1.1.1.3.cmml">0.98</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.5.5.5.m1.1b"><apply id="S5.T3.5.5.5.m1.1.1.cmml" xref="S5.T3.5.5.5.m1.1.1"><csymbol cd="latexml" id="S5.T3.5.5.5.m1.1.1.1.cmml" xref="S5.T3.5.5.5.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T3.5.5.5.m1.1.1.2.cmml" xref="S5.T3.5.5.5.m1.1.1.2">62.45</cn><cn type="float" id="S5.T3.5.5.5.m1.1.1.3.cmml" xref="S5.T3.5.5.5.m1.1.1.3">0.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.5.5.m1.1c">62.45\pm 0.98</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Results.</h5>

<div id="S5.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px2.p1.1" class="ltx_p">As shown in Table <a href="#S5.T2" title="Table 2 ‣ Baselines. ‣ 5.2 Comparative and Ablative Study on CUB dataset ‣ 5 Experiments ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, our MetaIRNet is superior to
all baselines including the meta-learning classifier of ProtoNet
(84.13% vs. 81.73%) on the CUB dataset. It is notable that while ProtoNet
has worse accuracy when simply using the generated images as
data augmentation, our method shows an accuracy increase from ProtoNet,
which is equivalent to MetaIRNet without the image fusion module. This
indicates that our image fusion module can effectively complement the
original images while removing harmful elements from generated ones.</p>
</div>
<div id="S5.SS2.SSS0.Px2.p2" class="ltx_para">
<p id="S5.SS2.SSS0.Px2.p2.1" class="ltx_p">Interestingly, horizontal flip augmentation yields nearly a 1% accuracy
increase for ProtoNet. Because flipping augmentation cannot be learned
directly by our method, we conjectured that our method could also
benefit from it. The final line of the table shows an additional experiment
with our MetaIRNet
combined with random flip augmentation, showing an additional accuracy increase from 84.13% to 84.80%. This suggests that our method
provides an improvement that is orthogonal to flip
augmentation.</p>
</div>
<figure id="S5.F3" class="ltx_figure ltx_align_floatright"><img src="/html/1911.07164/assets/x2.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="115" height="112" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span> t-SNE plot
</figcaption>
</figure>
</section>
<section id="S5.SS2.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Case Studies.</h5>

<div id="S5.SS2.SSS0.Px3.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px3.p1.2" class="ltx_p">We show some sample visualizations in
Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.3 Results on NAB Dataset ‣ 5 Experiments ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. We observe that image generation often
works well, but sometimes completely fails. An advantage of our
technique is that even in these failure cases, our fused images often
maintain some of the object’s shape, even if the images themselves do
not look realistic. In order to investigate the quality of generated
images in more detail, we randomly pick two classes,
sample 100 images for each class, and a show t-SNE visualization of real
images (•), generated images (<math id="S5.SS2.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="\blacktriangle" display="inline"><semantics id="S5.SS2.SSS0.Px3.p1.1.m1.1a"><mi mathvariant="normal" id="S5.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px3.p1.1.m1.1.1.cmml">▲</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.1.m1.1b"><ci id="S5.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.1.m1.1.1">▲</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.1.m1.1c">\blacktriangle</annotation></semantics></math>), and
augmented fused images (<span id="S5.SS2.SSS0.Px3.p1.2.1" class="ltx_text ltx_font_bold">+</span>) in Fig. <a href="#S5.F3" title="Figure 3 ‣ Results. ‣ 5.2 Comparative and Ablative Study on CUB dataset ‣ 5 Experiments ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, with classes shown in red and blue. It is
reasonable that the generated images are closer to the real ones,
because our loss function (equation 1) encourages this to be
so. Interestingly, perhaps due to artifacts of <math id="S5.SS2.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S5.SS2.SSS0.Px3.p1.2.m2.1a"><mrow id="S5.SS2.SSS0.Px3.p1.2.m2.1.1" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.cmml"><mn id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.2" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.1" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.3" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px3.p1.2.m2.1b"><apply id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1"><times id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.1"></times><cn type="integer" id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.2">3</cn><cn type="integer" id="S5.SS2.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S5.SS2.SSS0.Px3.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px3.p1.2.m2.1c">3\times 3</annotation></semantics></math> patches,
the fused images are distinctive from the real/generated images,
extending the decision boundary.</p>
</div>
</section>
<section id="S5.SS2.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Comparing with state-of-the-art meta-learning classifiers.</h5>

<div id="S5.SS2.SSS0.Px4.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px4.p1.1" class="ltx_p">It is a convention in the machine learning community to compare any
new technique with the performance of many state-of-the-art methods reported in the literature.
This is somewhat difficult for us to do fairly, however:
we use ImageNet-pre-trained features as a starting point (which
is a natural design decision considering that our focus is how to use
ImageNet pre-trained generators for improving fine-grained one-shot
classification), but much of the one/few-shot learning literature
focuses on algorithmic improvements and thus trains from scratch
(often with non-fine-grained datasets). The Delta
Encoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, which uses the idea of learning data
augmentation in the feature space, reports 82.2% on one-shot
classification on the CUB dataset with ImageNet-pre-trained features, but
this is an average of only 10 episodes.</p>
</div>
<div id="S5.SS2.SSS0.Px4.p2" class="ltx_para">
<p id="S5.SS2.SSS0.Px4.p2.1" class="ltx_p">To provide more stable comparison, we cite a benchmark
study <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> reporting accuracy of other
meta-learners <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>
on the CUB dataset with 600 episodes. To compare with these scores, we
experimented with our MetaIRNet and the ProtoNet baseline using the
same four-layered CNN. As shown in Table
<a href="#S5.T3" title="Table 3 ‣ Baselines. ‣ 5.2 Comparative and Ablative Study on CUB dataset ‣ 5 Experiments ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, our MetaIRNet performs better than the
other methods with more than 2% absolute improvement. We note that
this comparison is not totally fair because we use images generated
from a generator pre-trained from ImageNet. However, our contribution
is not to establish a new state-of-the-art score but to present the idea
of transferring an ImageNet pre-trained GAN for improving one shot
classifiers, so we believe this comparison is still informative.</p>
</div>
</section>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Results on NAB Dataset</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">We also
performed similar experiments on the NAB dataset, which is more than four times
larger than CUB, and the results are shown in the last column of
Table <a href="#S5.T2" title="Table 2 ‣ Baselines. ‣ 5.2 Comparative and Ablative Study on CUB dataset ‣ 5 Experiments ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We observe similar results as CUB,
and that our method improves classification accuracy
from a ProtoNet baseline (89.19% vs. 87.91%).</p>
</div>
<figure id="S5.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S5.F4.3" class="ltx_tabular ltx_figure_panel ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.F4.3.1.1" class="ltx_tr">
<td id="S5.F4.3.1.1.1" class="ltx_td ltx_align_left">Original    Generated     Fused        Weight
         Original    Generated     Fused        Weight</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/1-original.png" id="S5.F4.g1" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/1-generated.png" id="S5.F4.g2" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/1-mixed.png" id="S5.F4.g3" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/1-weight.png" id="S5.F4.g4" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="84" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/2-original.png" id="S5.F4.g5" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/2-generated.png" id="S5.F4.g6" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/2-mixed.png" id="S5.F4.g7" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/2-weight.png" id="S5.F4.g8" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="84" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/5-original.png" id="S5.F4.g9" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/5-generated.png" id="S5.F4.g10" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/5-mixed.png" id="S5.F4.g11" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/5-weight.png" id="S5.F4.g12" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="84" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/6-original.png" id="S5.F4.g13" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/6-generated.png" id="S5.F4.g14" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/6-mixed.png" id="S5.F4.g15" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/6-weight.png" id="S5.F4.g16" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="84" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/3-original.png" id="S5.F4.g17" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/3-generated.png" id="S5.F4.g18" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/3-mixed.png" id="S5.F4.g19" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/3-weight.png" id="S5.F4.g20" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="84" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/4-original.png" id="S5.F4.g21" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/4-generated.png" id="S5.F4.g22" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/4-mixed.png" id="S5.F4.g23" class="ltx_graphics ltx_figure_panel ltx_img_square" width="66" height="66" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_many"><img src="/html/1911.07164/assets/samples/4-weight.png" id="S5.F4.g24" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="84" height="66" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>
Samples of original image, generated image, fused image, and mixing weight <math id="S5.F4.2.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S5.F4.2.m1.1b"><mi id="S5.F4.2.m1.1.1" xref="S5.F4.2.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S5.F4.2.m1.1c"><ci id="S5.F4.2.m1.1.1.cmml" xref="S5.F4.2.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.2.m1.1d">\mathbf{w}</annotation></semantics></math>. Higher weight (red) means more original image used, and lower weight (blue) means more generated image used. We show three types of samples based on the quality of generated images: very good (top row), relatively good (middle row), and very bad or broken (last row). </figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We introduce an effective way to employ an ImageNet-pre-trained image
generator for the purpose of improving fine-grained one-shot
classification when data is scarce. As a way to fine-tune the
pre-trained generator, our pilot study finds that adjusting only scale
and shift parameters in batch normalization can produce a visually
realistic images. This technique works with a single image, making the method
less dependent on the number of available images. Furthermore,
although naively adding the generated images into the training set
does not improve performance, we show that it can improve
performance if we mix generated with original
images to create hybrid training exemplars. In order to learn the parameters of this mixing, we adapt a
meta-learning framework.
We implement this idea and demonstrate a consistent and significant
improvement over several classifiers on two fine-grained benchmark
datasets.</p>
</div>
<section id="S6.SS0.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Acknowledgments</h4>

<div id="S6.SS0.SSSx1.p1" class="ltx_para">
<p id="S6.SS0.SSSx1.p1.1" class="ltx_p">We would like to thank Yi Li for drawing Figure 2, and Minjun Li and
Atsuhiro Noguchi for helpful discussions. Part of this work was done while
Satoshi Tsutsui was an intern at Fudan University. Yanwei Fu was supported in
part by the NSFC project (#61572138), and Science and Technology
Commission of Shanghai Municipality Project (#19511120700).
David Crandall was supported in part by
the National Science Foundation (CAREER IIS-1253549),
and the Indiana University
Office of the Vice Provost for Research, the College of Arts and
Sciences, and the Luddy School of Informatics, Computing, and Engineering
through the Emerging Areas of Research Project “Learning: Brains,
Machines, and Children.”
Yanwei Fu
is the corresponding author.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Antreas Antoniou, Amos Storkey, and Harrison Edwards.

</span>
<span class="ltx_bibblock">Augmenting image classifiers using data augmentation generative
adversarial networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">International Conference on Artificial Neural Networks</span>,
2018.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Martin Arjovsky, Soumith Chintala, and Léon Bottou.

</span>
<span class="ltx_bibblock">Wasserstein gan.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1701.07875</span>, 2017.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Andrew Brock, Jeff Donahue, and Karen Simonyan.

</span>
<span class="ltx_bibblock">Large scale gan training for high fidelity natural image synthesis.

</span>
<span class="ltx_bibblock">In <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations (ICLR)</span>,
2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Wei-Yu Chen, Yen-Cheng Liu, Zsolt Kira, Yu-Chiang Frank Wang, and Jia-Bin
Huang.

</span>
<span class="ltx_bibblock">A closer look at few-shot classification.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations (ICLR)</span>,
2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Xi Chen, Yan Duan, Rein Houthooft, John Schulman, Ilya Sutskever, and Pieter
Abbeel.

</span>
<span class="ltx_bibblock">Infogan: Interpretable representation learning by information
maximizing generative adversarial nets.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems (NIPS)</span>,
2016.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Zitian Chen, Yanwei Fu, Kaiyu Chen, and Yu-Gang Jiang.

</span>
<span class="ltx_bibblock">Image block augmentation for one-shot learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">AAAI Conference on Artificial Intelligence (AAAI)</span>, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Zitian Chen, Yanwei Fu, Yu-Xiong Wang, Lin Ma, Wei Liu, and Martial Hebert.

</span>
<span class="ltx_bibblock">Image deformation meta-networks for one-shot learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span>, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Harm De Vries, Florian Strub, Jérémie Mary, Hugo Larochelle, Olivier
Pietquin, and Aaron C Courville.

</span>
<span class="ltx_bibblock">Modulating early visual processing by language.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems (NIPS)</span>,
2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Vincent Dumoulin, Jonathon Shlens, and Manjunath Kudlur.

</span>
<span class="ltx_bibblock">A learned representation for artistic style.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations (ICLR)</span>,
2017.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Chelsea Finn, Pieter Abbeel, and Sergey Levine.

</span>
<span class="ltx_bibblock">Model-agnostic meta-learning for fast adaptation of deep networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning (ICML)</span>, 2017.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Chelsea Finn, Kelvin Xu, and Sergey Levine.

</span>
<span class="ltx_bibblock">Probabilistic model-agnostic meta-learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</span>,
2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Hang Gao, Zheng Shou, Alireza Zareian, Hanwang Zhang, and Shih-Fu Chang.

</span>
<span class="ltx_bibblock">Low-shot learning via covariance-preserving adversarial augmentation
networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</span>,
2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley,
Sherjil Ozair, Aaron Courville, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Generative adversarial nets.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems (NIPS)</span>,
2014.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Ishaan Gulrajani, Faruk Ahmed, Martin Arjovsky, Vincent Dumoulin, and Aaron C
Courville.

</span>
<span class="ltx_bibblock">Improved training of wasserstein gans.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems (NIPS)</span>,
2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Bharath Hariharan and Ross Girshick.

</span>
<span class="ltx_bibblock">Low-shot visual recognition by shrinking and hallucinating features.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">IEEE International Conference on Computer Vision (ICCV)</span>,
2017.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span>, 2016.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Justin Johnson, Alexandre Alahi, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Perceptual losses for real-time style transfer and super-resolution.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">European Conference on Computer Vision (ECCV)</span>, 2016.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations (ICLR)</span>,
2015.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Takeru Miyato, Toshiki Kataoka, Masanori Koyama, and Yuichi Yoshida.

</span>
<span class="ltx_bibblock">Spectral normalization for generative adversarial networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations (ICLR)</span>,
2018.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Atsuhiro Noguchi and Tatsuya Harada.

</span>
<span class="ltx_bibblock">Image generation from small datasets via batch statistics adaptation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">IEEE International Conference on Computer Vision (ICCV)</span>,
2019.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Alec Radford, Luke Metz, and Soumith Chintala.

</span>
<span class="ltx_bibblock">Unsupervised representation learning with deep convolutional
generative adversarial networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations (ICLR)</span>,
2016.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Sachin Ravi and Hugo Larochelle.

</span>
<span class="ltx_bibblock">Optimization as a model for few-shot learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations (ICLR)</span>,
2017.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Andrei A Rusu, Dushyant Rao, Jakub Sygnowski, Oriol Vinyals, Razvan Pascanu,
Simon Osindero, and Raia Hadsell.

</span>
<span class="ltx_bibblock">Meta-learning with latent embedding optimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations (ICLR)</span>,
2018.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Adam Santoro, Sergey Bartunov, Matthew Botvinick, Daan Wierstra, and Timothy
Lillicrap.

</span>
<span class="ltx_bibblock">Meta-learning with memory-augmented neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning (ICML)</span>, 2016.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Eli Schwartz, Leonid Karlinsky, Joseph Shtok, Sivan Harary, Mattias Marder,
Abhishek Kumar, Rogerio Feris, Raja Giryes, and Alex Bronstein.

</span>
<span class="ltx_bibblock">Delta-encoder: an effective sample synthesis method for few-shot
object recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</span>,
2018.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Konstantin Shmelkov, Cordelia Schmid, and Karteek Alahari.

</span>
<span class="ltx_bibblock">How good is my gan?

</span>
<span class="ltx_bibblock">In <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">European Conference on Computer Vision (ECCV)</span>, 2018.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Ashish Shrivastava, Tomas Pfister, Oncel Tuzel, Joshua Susskind, Wenda Wang,
and Russell Webb.

</span>
<span class="ltx_bibblock">Learning from simulated and unsupervised images through adversarial
training.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span>, 2017.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Jake Snell, Kevin Swersky, and Richard S Zemel.

</span>
<span class="ltx_bibblock">Prototypical networks for few-shot learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems (NIPS)</span>,
2017.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Flood Sung, Yongxin Yang, Li Zhang, Tao Xiang, Philip HS Torr, and Timothy M
Hospedales.

</span>
<span class="ltx_bibblock">Learning to compare: Relation network for few-shot learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span>, 2018.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Grant Van Horn, Steve Branson, Ryan Farrell, Scott Haber, Jessie Barry, Panos
Ipeirotis, Pietro Perona, and Serge Belongie.

</span>
<span class="ltx_bibblock">Building a bird recognition app and large scale dataset with citizen
scientists: The fine print in fine-grained dataset collection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span>, 2015.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Oriol Vinyals, Charles Blundell, Timothy Lillicrap, Daan Wierstra, et al.

</span>
<span class="ltx_bibblock">Matching networks for one shot learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems (NIPS)</span>,
2016.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
C. Wah, S. Branson, P. Welinder, P. Perona, and S. Belongie.

</span>
<span class="ltx_bibblock">The Caltech-UCSD Birds-200-2011 Dataset.

</span>
<span class="ltx_bibblock">Technical Report CNS-TR-2011-001, California Institute of Technology,
2011.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Yaxing Wang, Chenshen Wu, Luis Herranz, Joost van de Weijer, Abel
Gonzalez-Garcia, and Bogdan Raducanu.

</span>
<span class="ltx_bibblock">Transferring gans: generating images from limited data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">Proceedings of the European Conference on Computer Vision
(ECCV)</span>, 2018.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Yu-Xiong Wang, Ross Girshick, Martial Hebert, and Bharath Hariharan.

</span>
<span class="ltx_bibblock">Low-shot learning from imaginary data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">IEEE Conference on Computer Vision and Pattern Recognition
(CVPR)</span>, 2018.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Yuxiong Wang and Martial Hebert.

</span>
<span class="ltx_bibblock">Learning from small sample sets by combining unsupervised
meta-training with cnns.

</span>
<span class="ltx_bibblock">In <span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems (NIPS)</span>,
2016.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Hongyi Zhang, Moustapha Cisse, Yann N. Dauphin, and David Lopez-Paz.

</span>
<span class="ltx_bibblock">Mixup: Beyond empirical risk minimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations (ICLR)</span>,
2018.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Ruixiang Zhang, Tong Che, Zoubin Ghahramani, Yoshua Bengio, and Yangqiu Song.

</span>
<span class="ltx_bibblock">MetaGAN: An Adversarial Approach to Few-Shot Learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</span>,
2018.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Jun-Yan Zhu, Taesung Park, Phillip Isola, and Alexei A Efros.

</span>
<span class="ltx_bibblock">Unpaired image-to-image translation using cycle-consistent
adversarial networkss.

</span>
<span class="ltx_bibblock">In <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">IEEE International Conference on Computer Vision (ICCV)</span>,
2017.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Supplementary</h2>

<section id="S7.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Five-shot Experiments</h3>

<div id="S7.SS1.p1" class="ltx_para">
<p id="S7.SS1.p1.1" class="ltx_p">Although our paper focuses on one-shot learning, we also try a five-shot
scenario. We use the ImageNet-pretrained ResNet18 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> as
a backbone. We also try the four layer-CNN (Conv-4) without ImageNet
pretraining in order to compare with other reported scores in a
benchmark study <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. The results are summarized in
Table <a href="#S7.T4" title="Table 4 ‣ 7.1 Five-shot Experiments ‣ 7 Supplementary ‣ Meta-Reinforced Synthetic Data for One-Shot Fine-Grained Visual Recognition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. When we use ImageNet pretrained
ResNet, our method is slightly (92.66% v.s 92.83%) better than the
ProtoNet. Given that non-meta-learning linear classifiers (softmax
regression and logistic regression) can achieve more than 92%
accuracy, we believe that ImageNet features are already strong enough
when used with five examples per class.</p>
</div>
<figure id="S7.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>5-way-5-shot Accuracy (%) on CUB dataset.</figcaption>
<table id="S7.T4.10" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S7.T4.10.11.1" class="ltx_tr">
<th id="S7.T4.10.11.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Method</th>
<th id="S7.T4.10.11.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Base Network</th>
<th id="S7.T4.10.11.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Initialization</th>
<th id="S7.T4.10.11.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S7.T4.1.1" class="ltx_tr">
<td id="S7.T4.1.1.2" class="ltx_td ltx_align_left ltx_border_t">Nearest neighbor</td>
<td id="S7.T4.1.1.3" class="ltx_td ltx_align_left ltx_border_t">ResNet18</td>
<td id="S7.T4.1.1.4" class="ltx_td ltx_align_left ltx_border_t">ImageNet</td>
<td id="S7.T4.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S7.T4.1.1.1.m1.1" class="ltx_Math" alttext="89.44\pm 0.36" display="inline"><semantics id="S7.T4.1.1.1.m1.1a"><mrow id="S7.T4.1.1.1.m1.1.1" xref="S7.T4.1.1.1.m1.1.1.cmml"><mn id="S7.T4.1.1.1.m1.1.1.2" xref="S7.T4.1.1.1.m1.1.1.2.cmml">89.44</mn><mo id="S7.T4.1.1.1.m1.1.1.1" xref="S7.T4.1.1.1.m1.1.1.1.cmml">±</mo><mn id="S7.T4.1.1.1.m1.1.1.3" xref="S7.T4.1.1.1.m1.1.1.3.cmml">0.36</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T4.1.1.1.m1.1b"><apply id="S7.T4.1.1.1.m1.1.1.cmml" xref="S7.T4.1.1.1.m1.1.1"><csymbol cd="latexml" id="S7.T4.1.1.1.m1.1.1.1.cmml" xref="S7.T4.1.1.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.T4.1.1.1.m1.1.1.2.cmml" xref="S7.T4.1.1.1.m1.1.1.2">89.44</cn><cn type="float" id="S7.T4.1.1.1.m1.1.1.3.cmml" xref="S7.T4.1.1.1.m1.1.1.3">0.36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.1.1.1.m1.1c">89.44\pm 0.36</annotation></semantics></math></td>
</tr>
<tr id="S7.T4.2.2" class="ltx_tr">
<td id="S7.T4.2.2.2" class="ltx_td ltx_align_left">Softmax regression</td>
<td id="S7.T4.2.2.3" class="ltx_td ltx_align_left">ResNet18</td>
<td id="S7.T4.2.2.4" class="ltx_td ltx_align_left">ImageNet</td>
<td id="S7.T4.2.2.1" class="ltx_td ltx_align_center"><math id="S7.T4.2.2.1.m1.1" class="ltx_Math" alttext="92.28\pm 0.30" display="inline"><semantics id="S7.T4.2.2.1.m1.1a"><mrow id="S7.T4.2.2.1.m1.1.1" xref="S7.T4.2.2.1.m1.1.1.cmml"><mn id="S7.T4.2.2.1.m1.1.1.2" xref="S7.T4.2.2.1.m1.1.1.2.cmml">92.28</mn><mo id="S7.T4.2.2.1.m1.1.1.1" xref="S7.T4.2.2.1.m1.1.1.1.cmml">±</mo><mn id="S7.T4.2.2.1.m1.1.1.3" xref="S7.T4.2.2.1.m1.1.1.3.cmml">0.30</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T4.2.2.1.m1.1b"><apply id="S7.T4.2.2.1.m1.1.1.cmml" xref="S7.T4.2.2.1.m1.1.1"><csymbol cd="latexml" id="S7.T4.2.2.1.m1.1.1.1.cmml" xref="S7.T4.2.2.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.T4.2.2.1.m1.1.1.2.cmml" xref="S7.T4.2.2.1.m1.1.1.2">92.28</cn><cn type="float" id="S7.T4.2.2.1.m1.1.1.3.cmml" xref="S7.T4.2.2.1.m1.1.1.3">0.30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.2.2.1.m1.1c">92.28\pm 0.30</annotation></semantics></math></td>
</tr>
<tr id="S7.T4.3.3" class="ltx_tr">
<td id="S7.T4.3.3.2" class="ltx_td ltx_align_left">Logistic regression</td>
<td id="S7.T4.3.3.3" class="ltx_td ltx_align_left">ResNet18</td>
<td id="S7.T4.3.3.4" class="ltx_td ltx_align_left">ImageNet</td>
<td id="S7.T4.3.3.1" class="ltx_td ltx_align_center"><math id="S7.T4.3.3.1.m1.1" class="ltx_Math" alttext="92.34\pm 0.30" display="inline"><semantics id="S7.T4.3.3.1.m1.1a"><mrow id="S7.T4.3.3.1.m1.1.1" xref="S7.T4.3.3.1.m1.1.1.cmml"><mn id="S7.T4.3.3.1.m1.1.1.2" xref="S7.T4.3.3.1.m1.1.1.2.cmml">92.34</mn><mo id="S7.T4.3.3.1.m1.1.1.1" xref="S7.T4.3.3.1.m1.1.1.1.cmml">±</mo><mn id="S7.T4.3.3.1.m1.1.1.3" xref="S7.T4.3.3.1.m1.1.1.3.cmml">0.30</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T4.3.3.1.m1.1b"><apply id="S7.T4.3.3.1.m1.1.1.cmml" xref="S7.T4.3.3.1.m1.1.1"><csymbol cd="latexml" id="S7.T4.3.3.1.m1.1.1.1.cmml" xref="S7.T4.3.3.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.T4.3.3.1.m1.1.1.2.cmml" xref="S7.T4.3.3.1.m1.1.1.2">92.34</cn><cn type="float" id="S7.T4.3.3.1.m1.1.1.3.cmml" xref="S7.T4.3.3.1.m1.1.1.3">0.30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.3.3.1.m1.1c">92.34\pm 0.30</annotation></semantics></math></td>
</tr>
<tr id="S7.T4.4.4" class="ltx_tr">
<td id="S7.T4.4.4.2" class="ltx_td ltx_align_left">ProtoNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>
</td>
<td id="S7.T4.4.4.3" class="ltx_td ltx_align_left">ResNet18</td>
<td id="S7.T4.4.4.4" class="ltx_td ltx_align_left">ImageNet</td>
<td id="S7.T4.4.4.1" class="ltx_td ltx_align_center"><math id="S7.T4.4.4.1.m1.1" class="ltx_Math" alttext="92.97\pm 0.31" display="inline"><semantics id="S7.T4.4.4.1.m1.1a"><mrow id="S7.T4.4.4.1.m1.1.1" xref="S7.T4.4.4.1.m1.1.1.cmml"><mn id="S7.T4.4.4.1.m1.1.1.2" xref="S7.T4.4.4.1.m1.1.1.2.cmml">92.97</mn><mo id="S7.T4.4.4.1.m1.1.1.1" xref="S7.T4.4.4.1.m1.1.1.1.cmml">±</mo><mn id="S7.T4.4.4.1.m1.1.1.3" xref="S7.T4.4.4.1.m1.1.1.3.cmml">0.31</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T4.4.4.1.m1.1b"><apply id="S7.T4.4.4.1.m1.1.1.cmml" xref="S7.T4.4.4.1.m1.1.1"><csymbol cd="latexml" id="S7.T4.4.4.1.m1.1.1.1.cmml" xref="S7.T4.4.4.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.T4.4.4.1.m1.1.1.2.cmml" xref="S7.T4.4.4.1.m1.1.1.2">92.97</cn><cn type="float" id="S7.T4.4.4.1.m1.1.1.3.cmml" xref="S7.T4.4.4.1.m1.1.1.3">0.31</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.4.4.1.m1.1c">92.97\pm 0.31</annotation></semantics></math></td>
</tr>
<tr id="S7.T4.5.5" class="ltx_tr">
<td id="S7.T4.5.5.2" class="ltx_td ltx_align_left">MetaIRNet (Ours)</td>
<td id="S7.T4.5.5.3" class="ltx_td ltx_align_left">ResNet18</td>
<td id="S7.T4.5.5.4" class="ltx_td ltx_align_left">ImageNet</td>
<td id="S7.T4.5.5.1" class="ltx_td ltx_align_center"><math id="S7.T4.5.5.1.m1.1" class="ltx_Math" alttext="\mathbf{93.09\pm 0.30}" display="inline"><semantics id="S7.T4.5.5.1.m1.1a"><mrow id="S7.T4.5.5.1.m1.1.1" xref="S7.T4.5.5.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S7.T4.5.5.1.m1.1.1.2" xref="S7.T4.5.5.1.m1.1.1.2.cmml">93.09</mn><mo id="S7.T4.5.5.1.m1.1.1.1" xref="S7.T4.5.5.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S7.T4.5.5.1.m1.1.1.3" xref="S7.T4.5.5.1.m1.1.1.3.cmml">0.30</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T4.5.5.1.m1.1b"><apply id="S7.T4.5.5.1.m1.1.1.cmml" xref="S7.T4.5.5.1.m1.1.1"><csymbol cd="latexml" id="S7.T4.5.5.1.m1.1.1.1.cmml" xref="S7.T4.5.5.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.T4.5.5.1.m1.1.1.2.cmml" xref="S7.T4.5.5.1.m1.1.1.2">93.09</cn><cn type="float" id="S7.T4.5.5.1.m1.1.1.3.cmml" xref="S7.T4.5.5.1.m1.1.1.3">0.30</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.5.5.1.m1.1c">\mathbf{93.09\pm 0.30}</annotation></semantics></math></td>
</tr>
<tr id="S7.T4.6.6" class="ltx_tr">
<td id="S7.T4.6.6.2" class="ltx_td ltx_align_left ltx_border_t">MAML<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S7.T4.6.6.3" class="ltx_td ltx_align_left ltx_border_t">Conv-4</td>
<td id="S7.T4.6.6.4" class="ltx_td ltx_align_left ltx_border_t">Random</td>
<td id="S7.T4.6.6.1" class="ltx_td ltx_align_center ltx_border_t">
<math id="S7.T4.6.6.1.m1.1" class="ltx_Math" alttext="72.09\pm 0.76" display="inline"><semantics id="S7.T4.6.6.1.m1.1a"><mrow id="S7.T4.6.6.1.m1.1.1" xref="S7.T4.6.6.1.m1.1.1.cmml"><mn id="S7.T4.6.6.1.m1.1.1.2" xref="S7.T4.6.6.1.m1.1.1.2.cmml">72.09</mn><mo id="S7.T4.6.6.1.m1.1.1.1" xref="S7.T4.6.6.1.m1.1.1.1.cmml">±</mo><mn id="S7.T4.6.6.1.m1.1.1.3" xref="S7.T4.6.6.1.m1.1.1.3.cmml">0.76</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T4.6.6.1.m1.1b"><apply id="S7.T4.6.6.1.m1.1.1.cmml" xref="S7.T4.6.6.1.m1.1.1"><csymbol cd="latexml" id="S7.T4.6.6.1.m1.1.1.1.cmml" xref="S7.T4.6.6.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.T4.6.6.1.m1.1.1.2.cmml" xref="S7.T4.6.6.1.m1.1.1.2">72.09</cn><cn type="float" id="S7.T4.6.6.1.m1.1.1.3.cmml" xref="S7.T4.6.6.1.m1.1.1.3">0.76</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.6.6.1.m1.1c">72.09\pm 0.76</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
</tr>
<tr id="S7.T4.7.7" class="ltx_tr">
<td id="S7.T4.7.7.2" class="ltx_td ltx_align_left">MatchingNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>
</td>
<td id="S7.T4.7.7.3" class="ltx_td ltx_align_left">Conv-4</td>
<td id="S7.T4.7.7.4" class="ltx_td ltx_align_left">Random</td>
<td id="S7.T4.7.7.1" class="ltx_td ltx_align_center">
<math id="S7.T4.7.7.1.m1.1" class="ltx_Math" alttext="72.86\pm 0.76" display="inline"><semantics id="S7.T4.7.7.1.m1.1a"><mrow id="S7.T4.7.7.1.m1.1.1" xref="S7.T4.7.7.1.m1.1.1.cmml"><mn id="S7.T4.7.7.1.m1.1.1.2" xref="S7.T4.7.7.1.m1.1.1.2.cmml">72.86</mn><mo id="S7.T4.7.7.1.m1.1.1.1" xref="S7.T4.7.7.1.m1.1.1.1.cmml">±</mo><mn id="S7.T4.7.7.1.m1.1.1.3" xref="S7.T4.7.7.1.m1.1.1.3.cmml">0.76</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T4.7.7.1.m1.1b"><apply id="S7.T4.7.7.1.m1.1.1.cmml" xref="S7.T4.7.7.1.m1.1.1"><csymbol cd="latexml" id="S7.T4.7.7.1.m1.1.1.1.cmml" xref="S7.T4.7.7.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.T4.7.7.1.m1.1.1.2.cmml" xref="S7.T4.7.7.1.m1.1.1.2">72.86</cn><cn type="float" id="S7.T4.7.7.1.m1.1.1.3.cmml" xref="S7.T4.7.7.1.m1.1.1.3">0.76</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.7.7.1.m1.1c">72.86\pm 0.76</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
</tr>
<tr id="S7.T4.8.8" class="ltx_tr">
<td id="S7.T4.8.8.2" class="ltx_td ltx_align_left">RelationNet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>
</td>
<td id="S7.T4.8.8.3" class="ltx_td ltx_align_left">Conv-4</td>
<td id="S7.T4.8.8.4" class="ltx_td ltx_align_left">Random</td>
<td id="S7.T4.8.8.1" class="ltx_td ltx_align_center">
<math id="S7.T4.8.8.1.m1.1" class="ltx_Math" alttext="76.11\pm 0.69" display="inline"><semantics id="S7.T4.8.8.1.m1.1a"><mrow id="S7.T4.8.8.1.m1.1.1" xref="S7.T4.8.8.1.m1.1.1.cmml"><mn id="S7.T4.8.8.1.m1.1.1.2" xref="S7.T4.8.8.1.m1.1.1.2.cmml">76.11</mn><mo id="S7.T4.8.8.1.m1.1.1.1" xref="S7.T4.8.8.1.m1.1.1.1.cmml">±</mo><mn id="S7.T4.8.8.1.m1.1.1.3" xref="S7.T4.8.8.1.m1.1.1.3.cmml">0.69</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T4.8.8.1.m1.1b"><apply id="S7.T4.8.8.1.m1.1.1.cmml" xref="S7.T4.8.8.1.m1.1.1"><csymbol cd="latexml" id="S7.T4.8.8.1.m1.1.1.1.cmml" xref="S7.T4.8.8.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.T4.8.8.1.m1.1.1.2.cmml" xref="S7.T4.8.8.1.m1.1.1.2">76.11</cn><cn type="float" id="S7.T4.8.8.1.m1.1.1.3.cmml" xref="S7.T4.8.8.1.m1.1.1.3">0.69</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.8.8.1.m1.1c">76.11\pm 0.69</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
</tr>
<tr id="S7.T4.9.9" class="ltx_tr">
<td id="S7.T4.9.9.2" class="ltx_td ltx_align_left">ProtoNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>
</td>
<td id="S7.T4.9.9.3" class="ltx_td ltx_align_left">Conv-4</td>
<td id="S7.T4.9.9.4" class="ltx_td ltx_align_left">Random</td>
<td id="S7.T4.9.9.1" class="ltx_td ltx_align_center"><math id="S7.T4.9.9.1.m1.1" class="ltx_Math" alttext="80.75\pm 0.46" display="inline"><semantics id="S7.T4.9.9.1.m1.1a"><mrow id="S7.T4.9.9.1.m1.1.1" xref="S7.T4.9.9.1.m1.1.1.cmml"><mn id="S7.T4.9.9.1.m1.1.1.2" xref="S7.T4.9.9.1.m1.1.1.2.cmml">80.75</mn><mo id="S7.T4.9.9.1.m1.1.1.1" xref="S7.T4.9.9.1.m1.1.1.1.cmml">±</mo><mn id="S7.T4.9.9.1.m1.1.1.3" xref="S7.T4.9.9.1.m1.1.1.3.cmml">0.46</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T4.9.9.1.m1.1b"><apply id="S7.T4.9.9.1.m1.1.1.cmml" xref="S7.T4.9.9.1.m1.1.1"><csymbol cd="latexml" id="S7.T4.9.9.1.m1.1.1.1.cmml" xref="S7.T4.9.9.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.T4.9.9.1.m1.1.1.2.cmml" xref="S7.T4.9.9.1.m1.1.1.2">80.75</cn><cn type="float" id="S7.T4.9.9.1.m1.1.1.3.cmml" xref="S7.T4.9.9.1.m1.1.1.3">0.46</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.9.9.1.m1.1c">80.75\pm 0.46</annotation></semantics></math></td>
</tr>
<tr id="S7.T4.10.10" class="ltx_tr">
<td id="S7.T4.10.10.2" class="ltx_td ltx_align_left ltx_border_bb">MetaIRNet (Ours)</td>
<td id="S7.T4.10.10.3" class="ltx_td ltx_align_left ltx_border_bb">Conv-4</td>
<td id="S7.T4.10.10.4" class="ltx_td ltx_align_left ltx_border_bb">Random</td>
<td id="S7.T4.10.10.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="S7.T4.10.10.1.m1.1" class="ltx_Math" alttext="\mathbf{81.16\pm 0.47}" display="inline"><semantics id="S7.T4.10.10.1.m1.1a"><mrow id="S7.T4.10.10.1.m1.1.1" xref="S7.T4.10.10.1.m1.1.1.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S7.T4.10.10.1.m1.1.1.2" xref="S7.T4.10.10.1.m1.1.1.2.cmml">81.16</mn><mo id="S7.T4.10.10.1.m1.1.1.1" xref="S7.T4.10.10.1.m1.1.1.1.cmml">±</mo><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S7.T4.10.10.1.m1.1.1.3" xref="S7.T4.10.10.1.m1.1.1.3.cmml">0.47</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.T4.10.10.1.m1.1b"><apply id="S7.T4.10.10.1.m1.1.1.cmml" xref="S7.T4.10.10.1.m1.1.1"><csymbol cd="latexml" id="S7.T4.10.10.1.m1.1.1.1.cmml" xref="S7.T4.10.10.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.T4.10.10.1.m1.1.1.2.cmml" xref="S7.T4.10.10.1.m1.1.1.2">81.16</cn><cn type="float" id="S7.T4.10.10.1.m1.1.1.3.cmml" xref="S7.T4.10.10.1.m1.1.1.3">0.47</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.T4.10.10.1.m1.1c">\mathbf{81.16\pm 0.47}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S7.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span>An Implementation Detail: Class label input of BigGAN</h3>

<div id="S7.SS2.p1" class="ltx_para">
<p id="S7.SS2.p1.1" class="ltx_p">Part of the noise <math id="S7.SS2.p1.1.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S7.SS2.p1.1.m1.1a"><mi id="S7.SS2.p1.1.m1.1.1" xref="S7.SS2.p1.1.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S7.SS2.p1.1.m1.1b"><ci id="S7.SS2.p1.1.m1.1.1.cmml" xref="S7.SS2.p1.1.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.SS2.p1.1.m1.1c">z</annotation></semantics></math> used in BigGAN is class conditional, and we did not explicitly discuss this part in the main paper, so here we provide details. We optimize the class
conditional embedding and regard it as part of the input noise.
Generally speaking, a conditional GAN uses input noise conditioned on
the label of the image to generate. BigGAN also follows this approach,
but our fine-tuning technique uses a single image to train. In other
words, we only have a single class label and can then optimize the
class embedding as part of the input noise.</p>
</div>
</section>
<section id="S7.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.3 </span>More Experiments</h3>

<section id="S7.SS3.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Increasing the number of generated examples.</h5>

<div id="S7.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S7.SS3.SSS0.Px1.p1.7" class="ltx_p">It is interesting to know if our method can benefit by increasing the number of generated examples. We try <math id="S7.SS3.SSS0.Px1.p1.1.m1.5" class="ltx_Math" alttext="n_{aug}=1,2,3,5,10" display="inline"><semantics id="S7.SS3.SSS0.Px1.p1.1.m1.5a"><mrow id="S7.SS3.SSS0.Px1.p1.1.m1.5.6" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.cmml"><msub id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.cmml"><mi id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.2" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.2.cmml">n</mi><mrow id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.cmml"><mi id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.2" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.1" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.1.cmml">​</mo><mi id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.3" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.1a" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.1.cmml">​</mo><mi id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.4" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.4.cmml">g</mi></mrow></msub><mo id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.1" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.1.cmml">=</mo><mrow id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.3.2" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.3.1.cmml"><mn id="S7.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S7.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">1</mn><mo id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.3.2.1" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S7.SS3.SSS0.Px1.p1.1.m1.2.2" xref="S7.SS3.SSS0.Px1.p1.1.m1.2.2.cmml">2</mn><mo id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.3.2.2" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S7.SS3.SSS0.Px1.p1.1.m1.3.3" xref="S7.SS3.SSS0.Px1.p1.1.m1.3.3.cmml">3</mn><mo id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.3.2.3" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S7.SS3.SSS0.Px1.p1.1.m1.4.4" xref="S7.SS3.SSS0.Px1.p1.1.m1.4.4.cmml">5</mn><mo id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.3.2.4" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S7.SS3.SSS0.Px1.p1.1.m1.5.5" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.5.cmml">10</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px1.p1.1.m1.5b"><apply id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6"><eq id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.1.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.1"></eq><apply id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2"><csymbol cd="ambiguous" id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.1.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2">subscript</csymbol><ci id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.2.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.2">𝑛</ci><apply id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3"><times id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.1.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.1"></times><ci id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.2.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.2">𝑎</ci><ci id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.3.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.3">𝑢</ci><ci id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.4.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.2.3.4">𝑔</ci></apply></apply><list id="S7.SS3.SSS0.Px1.p1.1.m1.5.6.3.1.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.6.3.2"><cn type="integer" id="S7.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.1.1">1</cn><cn type="integer" id="S7.SS3.SSS0.Px1.p1.1.m1.2.2.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.2.2">2</cn><cn type="integer" id="S7.SS3.SSS0.Px1.p1.1.m1.3.3.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.3.3">3</cn><cn type="integer" id="S7.SS3.SSS0.Px1.p1.1.m1.4.4.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.4.4">5</cn><cn type="integer" id="S7.SS3.SSS0.Px1.p1.1.m1.5.5.cmml" xref="S7.SS3.SSS0.Px1.p1.1.m1.5.5">10</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px1.p1.1.m1.5c">n_{aug}=1,2,3,5,10</annotation></semantics></math> on CUB and obtain accuracies
<math id="S7.SS3.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="84.13\pm 0.60" display="inline"><semantics id="S7.SS3.SSS0.Px1.p1.2.m2.1a"><mrow id="S7.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S7.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><mn id="S7.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S7.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml">84.13</mn><mo id="S7.SS3.SSS0.Px1.p1.2.m2.1.1.1" xref="S7.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml">±</mo><mn id="S7.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S7.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml">0.60</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S7.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="latexml" id="S7.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.2.m2.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S7.SS3.SSS0.Px1.p1.2.m2.1.1.2">84.13</cn><cn type="float" id="S7.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S7.SS3.SSS0.Px1.p1.2.m2.1.1.3">0.60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px1.p1.2.m2.1c">84.13\pm 0.60</annotation></semantics></math>, <math id="S7.SS3.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="83.45\pm 0.60" display="inline"><semantics id="S7.SS3.SSS0.Px1.p1.3.m3.1a"><mrow id="S7.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S7.SS3.SSS0.Px1.p1.3.m3.1.1.cmml"><mn id="S7.SS3.SSS0.Px1.p1.3.m3.1.1.2" xref="S7.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml">83.45</mn><mo id="S7.SS3.SSS0.Px1.p1.3.m3.1.1.1" xref="S7.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml">±</mo><mn id="S7.SS3.SSS0.Px1.p1.3.m3.1.1.3" xref="S7.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml">0.60</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S7.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="latexml" id="S7.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.3.m3.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S7.SS3.SSS0.Px1.p1.3.m3.1.1.2">83.45</cn><cn type="float" id="S7.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S7.SS3.SSS0.Px1.p1.3.m3.1.1.3">0.60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px1.p1.3.m3.1c">83.45\pm 0.60</annotation></semantics></math>, <math id="S7.SS3.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="80.99\pm 0.62" display="inline"><semantics id="S7.SS3.SSS0.Px1.p1.4.m4.1a"><mrow id="S7.SS3.SSS0.Px1.p1.4.m4.1.1" xref="S7.SS3.SSS0.Px1.p1.4.m4.1.1.cmml"><mn id="S7.SS3.SSS0.Px1.p1.4.m4.1.1.2" xref="S7.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml">80.99</mn><mo id="S7.SS3.SSS0.Px1.p1.4.m4.1.1.1" xref="S7.SS3.SSS0.Px1.p1.4.m4.1.1.1.cmml">±</mo><mn id="S7.SS3.SSS0.Px1.p1.4.m4.1.1.3" xref="S7.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml">0.62</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px1.p1.4.m4.1b"><apply id="S7.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="latexml" id="S7.SS3.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.4.m4.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S7.SS3.SSS0.Px1.p1.4.m4.1.1.2">80.99</cn><cn type="float" id="S7.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S7.SS3.SSS0.Px1.p1.4.m4.1.1.3">0.62</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px1.p1.4.m4.1c">80.99\pm 0.62</annotation></semantics></math>, <math id="S7.SS3.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="81.21\pm 0.62" display="inline"><semantics id="S7.SS3.SSS0.Px1.p1.5.m5.1a"><mrow id="S7.SS3.SSS0.Px1.p1.5.m5.1.1" xref="S7.SS3.SSS0.Px1.p1.5.m5.1.1.cmml"><mn id="S7.SS3.SSS0.Px1.p1.5.m5.1.1.2" xref="S7.SS3.SSS0.Px1.p1.5.m5.1.1.2.cmml">81.21</mn><mo id="S7.SS3.SSS0.Px1.p1.5.m5.1.1.1" xref="S7.SS3.SSS0.Px1.p1.5.m5.1.1.1.cmml">±</mo><mn id="S7.SS3.SSS0.Px1.p1.5.m5.1.1.3" xref="S7.SS3.SSS0.Px1.p1.5.m5.1.1.3.cmml">0.62</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px1.p1.5.m5.1b"><apply id="S7.SS3.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="latexml" id="S7.SS3.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.5.m5.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.SS3.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S7.SS3.SSS0.Px1.p1.5.m5.1.1.2">81.21</cn><cn type="float" id="S7.SS3.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S7.SS3.SSS0.Px1.p1.5.m5.1.1.3">0.62</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px1.p1.5.m5.1c">81.21\pm 0.62</annotation></semantics></math>, and <math id="S7.SS3.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="80.49\pm 0.69" display="inline"><semantics id="S7.SS3.SSS0.Px1.p1.6.m6.1a"><mrow id="S7.SS3.SSS0.Px1.p1.6.m6.1.1" xref="S7.SS3.SSS0.Px1.p1.6.m6.1.1.cmml"><mn id="S7.SS3.SSS0.Px1.p1.6.m6.1.1.2" xref="S7.SS3.SSS0.Px1.p1.6.m6.1.1.2.cmml">80.49</mn><mo id="S7.SS3.SSS0.Px1.p1.6.m6.1.1.1" xref="S7.SS3.SSS0.Px1.p1.6.m6.1.1.1.cmml">±</mo><mn id="S7.SS3.SSS0.Px1.p1.6.m6.1.1.3" xref="S7.SS3.SSS0.Px1.p1.6.m6.1.1.3.cmml">0.69</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px1.p1.6.m6.1b"><apply id="S7.SS3.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="latexml" id="S7.SS3.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.6.m6.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.SS3.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S7.SS3.SSS0.Px1.p1.6.m6.1.1.2">80.49</cn><cn type="float" id="S7.SS3.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S7.SS3.SSS0.Px1.p1.6.m6.1.1.3">0.69</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px1.p1.6.m6.1c">80.49\pm 0.69</annotation></semantics></math>, respectively. Too many augmented images
seems to bias the classifier. We conclude that the performance gain is
marginal or even harmful when increasing <math id="S7.SS3.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="n_{aug}" display="inline"><semantics id="S7.SS3.SSS0.Px1.p1.7.m7.1a"><msub id="S7.SS3.SSS0.Px1.p1.7.m7.1.1" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.2" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.2.cmml">n</mi><mrow id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.cmml"><mi id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.2" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.1" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.3" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.1a" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.1.cmml">​</mo><mi id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.4" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px1.p1.7.m7.1b"><apply id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.2">𝑛</ci><apply id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3"><times id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.1.cmml" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.1"></times><ci id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.2.cmml" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.2">𝑎</ci><ci id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.3.cmml" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.3">𝑢</ci><ci id="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.4.cmml" xref="S7.SS3.SSS0.Px1.p1.7.m7.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px1.p1.7.m7.1c">n_{aug}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S7.SS3.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Mixup baseline.</h5>

<div id="S7.SS3.SSS0.Px2.p1" class="ltx_para">
<p id="S7.SS3.SSS0.Px2.p1.3" class="ltx_p">Mixup <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> uses random <math id="S7.SS3.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="1\times 1" display="inline"><semantics id="S7.SS3.SSS0.Px2.p1.1.m1.1a"><mrow id="S7.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S7.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mn id="S7.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S7.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S7.SS3.SSS0.Px2.p1.1.m1.1.1.1" xref="S7.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S7.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S7.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S7.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S7.SS3.SSS0.Px2.p1.1.m1.1.1"><times id="S7.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S7.SS3.SSS0.Px2.p1.1.m1.1.1.1"></times><cn type="integer" id="S7.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S7.SS3.SSS0.Px2.p1.1.m1.1.1.2">1</cn><cn type="integer" id="S7.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S7.SS3.SSS0.Px2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px2.p1.1.m1.1c">1\times 1</annotation></semantics></math> weights to mix two images, which can be viewed as a much simpler version of our method to mix a real and generated image pairs. We test this
baseline and obtain one-shot accuracy of <math id="S7.SS3.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="82.24\pm 0.59" display="inline"><semantics id="S7.SS3.SSS0.Px2.p1.2.m2.1a"><mrow id="S7.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S7.SS3.SSS0.Px2.p1.2.m2.1.1.cmml"><mn id="S7.SS3.SSS0.Px2.p1.2.m2.1.1.2" xref="S7.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml">82.24</mn><mo id="S7.SS3.SSS0.Px2.p1.2.m2.1.1.1" xref="S7.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml">±</mo><mn id="S7.SS3.SSS0.Px2.p1.2.m2.1.1.3" xref="S7.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml">0.59</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px2.p1.2.m2.1b"><apply id="S7.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S7.SS3.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="latexml" id="S7.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S7.SS3.SSS0.Px2.p1.2.m2.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S7.SS3.SSS0.Px2.p1.2.m2.1.1.2">82.24</cn><cn type="float" id="S7.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S7.SS3.SSS0.Px2.p1.2.m2.1.1.3">0.59</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px2.p1.2.m2.1c">82.24\pm 0.59</annotation></semantics></math> and <math id="S7.SS3.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="88.33\pm 0.53" display="inline"><semantics id="S7.SS3.SSS0.Px2.p1.3.m3.1a"><mrow id="S7.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S7.SS3.SSS0.Px2.p1.3.m3.1.1.cmml"><mn id="S7.SS3.SSS0.Px2.p1.3.m3.1.1.2" xref="S7.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml">88.33</mn><mo id="S7.SS3.SSS0.Px2.p1.3.m3.1.1.1" xref="S7.SS3.SSS0.Px2.p1.3.m3.1.1.1.cmml">±</mo><mn id="S7.SS3.SSS0.Px2.p1.3.m3.1.1.3" xref="S7.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml">0.53</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px2.p1.3.m3.1b"><apply id="S7.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S7.SS3.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="latexml" id="S7.SS3.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S7.SS3.SSS0.Px2.p1.3.m3.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.SS3.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S7.SS3.SSS0.Px2.p1.3.m3.1.1.2">88.33</cn><cn type="float" id="S7.SS3.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S7.SS3.SSS0.Px2.p1.3.m3.1.1.3">0.53</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px2.p1.3.m3.1c">88.33\pm 0.53</annotation></semantics></math> on CUB and NAB, respectively. These results are higher than
baselines but still lower than ours.</p>
</div>
</section>
<section id="S7.SS3.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Image deformation baseline.</h5>

<div id="S7.SS3.SSS0.Px3.p1" class="ltx_para">
<p id="S7.SS3.SSS0.Px3.p1.3" class="ltx_p">Image deformation net <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> also uses similar <math id="S7.SS3.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S7.SS3.SSS0.Px3.p1.1.m1.1a"><mrow id="S7.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S7.SS3.SSS0.Px3.p1.1.m1.1.1.cmml"><mn id="S7.SS3.SSS0.Px3.p1.1.m1.1.1.2" xref="S7.SS3.SSS0.Px3.p1.1.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S7.SS3.SSS0.Px3.p1.1.m1.1.1.1" xref="S7.SS3.SSS0.Px3.p1.1.m1.1.1.1.cmml">×</mo><mn id="S7.SS3.SSS0.Px3.p1.1.m1.1.1.3" xref="S7.SS3.SSS0.Px3.p1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px3.p1.1.m1.1b"><apply id="S7.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S7.SS3.SSS0.Px3.p1.1.m1.1.1"><times id="S7.SS3.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S7.SS3.SSS0.Px3.p1.1.m1.1.1.1"></times><cn type="integer" id="S7.SS3.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S7.SS3.SSS0.Px3.p1.1.m1.1.1.2">3</cn><cn type="integer" id="S7.SS3.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S7.SS3.SSS0.Px3.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px3.p1.1.m1.1c">3\times 3</annotation></semantics></math> patch based data augmentation learning. The key difference is that while that method augments
support image by fusing with external real images called a gallery set,
our model fuses with images synthesized by GANs. Further, to adapt a generic
pretrained GAN to a new domain, we introduce a technique of optimizing
only the noise z and BatchNorm parameters rather than the full generator, which
is not explored by deformation net <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. We try this baseline by using a gallery set of random images sampled from the meta-training set, and obtain 1-shot-5-way accuracies of <math id="S7.SS3.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="82.84\pm 0.62" display="inline"><semantics id="S7.SS3.SSS0.Px3.p1.2.m2.1a"><mrow id="S7.SS3.SSS0.Px3.p1.2.m2.1.1" xref="S7.SS3.SSS0.Px3.p1.2.m2.1.1.cmml"><mn id="S7.SS3.SSS0.Px3.p1.2.m2.1.1.2" xref="S7.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml">82.84</mn><mo id="S7.SS3.SSS0.Px3.p1.2.m2.1.1.1" xref="S7.SS3.SSS0.Px3.p1.2.m2.1.1.1.cmml">±</mo><mn id="S7.SS3.SSS0.Px3.p1.2.m2.1.1.3" xref="S7.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml">0.62</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px3.p1.2.m2.1b"><apply id="S7.SS3.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S7.SS3.SSS0.Px3.p1.2.m2.1.1"><csymbol cd="latexml" id="S7.SS3.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S7.SS3.SSS0.Px3.p1.2.m2.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S7.SS3.SSS0.Px3.p1.2.m2.1.1.2">82.84</cn><cn type="float" id="S7.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S7.SS3.SSS0.Px3.p1.2.m2.1.1.3">0.62</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px3.p1.2.m2.1c">82.84\pm 0.62</annotation></semantics></math>
on CUB and <math id="S7.SS3.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="88.42\pm 0.59" display="inline"><semantics id="S7.SS3.SSS0.Px3.p1.3.m3.1a"><mrow id="S7.SS3.SSS0.Px3.p1.3.m3.1.1" xref="S7.SS3.SSS0.Px3.p1.3.m3.1.1.cmml"><mn id="S7.SS3.SSS0.Px3.p1.3.m3.1.1.2" xref="S7.SS3.SSS0.Px3.p1.3.m3.1.1.2.cmml">88.42</mn><mo id="S7.SS3.SSS0.Px3.p1.3.m3.1.1.1" xref="S7.SS3.SSS0.Px3.p1.3.m3.1.1.1.cmml">±</mo><mn id="S7.SS3.SSS0.Px3.p1.3.m3.1.1.3" xref="S7.SS3.SSS0.Px3.p1.3.m3.1.1.3.cmml">0.59</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px3.p1.3.m3.1b"><apply id="S7.SS3.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S7.SS3.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="latexml" id="S7.SS3.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S7.SS3.SSS0.Px3.p1.3.m3.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.SS3.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S7.SS3.SSS0.Px3.p1.3.m3.1.1.2">88.42</cn><cn type="float" id="S7.SS3.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S7.SS3.SSS0.Px3.p1.3.m3.1.1.3">0.59</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px3.p1.3.m3.1c">88.42\pm 0.59</annotation></semantics></math> on NAB, which is higher than the
baselines but not as high as ours.</p>
</div>
</section>
<section id="S7.SS3.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Training from scratch or end-to-end.</h5>

<div id="S7.SS3.SSS0.Px4.p1" class="ltx_para">
<p id="S7.SS3.SSS0.Px4.p1.1" class="ltx_p">It is an interesting direction to train the generator end-to-end and without
ImageNet pretraining. Theoretically, we can do end-to-end training of
all components, but in practice we are limited by our GPU memory,
which is not large enough to hold both our model and BigGAN. In order
to simulate the end-to-end and scratch training, we introduce two
constraints. 1) We simplified BigGAN with one-quarter the number of
channels and train from scratch so that we train the generator with
a relatively small meta-training set. 2) We do not propagate the
gradient from classifier to the generator so that we do not have to
put both models onto GPU. We apply our approach with a
four-layer CNN backbone with random initialization and achieved an 1-shot-5-way
accuracy of <math id="S7.SS3.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="63.77\pm 0.71" display="inline"><semantics id="S7.SS3.SSS0.Px4.p1.1.m1.1a"><mrow id="S7.SS3.SSS0.Px4.p1.1.m1.1.1" xref="S7.SS3.SSS0.Px4.p1.1.m1.1.1.cmml"><mn id="S7.SS3.SSS0.Px4.p1.1.m1.1.1.2" xref="S7.SS3.SSS0.Px4.p1.1.m1.1.1.2.cmml">63.77</mn><mo id="S7.SS3.SSS0.Px4.p1.1.m1.1.1.1" xref="S7.SS3.SSS0.Px4.p1.1.m1.1.1.1.cmml">±</mo><mn id="S7.SS3.SSS0.Px4.p1.1.m1.1.1.3" xref="S7.SS3.SSS0.Px4.p1.1.m1.1.1.3.cmml">0.71</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px4.p1.1.m1.1b"><apply id="S7.SS3.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S7.SS3.SSS0.Px4.p1.1.m1.1.1"><csymbol cd="latexml" id="S7.SS3.SSS0.Px4.p1.1.m1.1.1.1.cmml" xref="S7.SS3.SSS0.Px4.p1.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.SS3.SSS0.Px4.p1.1.m1.1.1.2.cmml" xref="S7.SS3.SSS0.Px4.p1.1.m1.1.1.2">63.77</cn><cn type="float" id="S7.SS3.SSS0.Px4.p1.1.m1.1.1.3.cmml" xref="S7.SS3.SSS0.Px4.p1.1.m1.1.1.3">0.71</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px4.p1.1.m1.1c">63.77\pm 0.71</annotation></semantics></math> on CUB.</p>
</div>
</section>
<section id="S7.SS3.SSS0.Px5" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Experiment on Mini-ImageNet</h5>

<div id="S7.SS3.SSS0.Px5.p1" class="ltx_para">
<p id="S7.SS3.SSS0.Px5.p1.2" class="ltx_p">. Although our method is designed for fine-grained recognition, it is interesting to apply this to coarse-grained recognition. Because the public BigGAN model was trained on images including the meta-testing set of ImageNet, we cannot use it as-is. Hence we train the simplified generator (see above paragraph) from scratch using the meta-training set only. Using a backbone of ResNet18, the 1-shot-5-way accuracy on Mini-ImageNet is <math id="S7.SS3.SSS0.Px5.p1.1.m1.1" class="ltx_Math" alttext="53.97\pm 0.63" display="inline"><semantics id="S7.SS3.SSS0.Px5.p1.1.m1.1a"><mrow id="S7.SS3.SSS0.Px5.p1.1.m1.1.1" xref="S7.SS3.SSS0.Px5.p1.1.m1.1.1.cmml"><mn id="S7.SS3.SSS0.Px5.p1.1.m1.1.1.2" xref="S7.SS3.SSS0.Px5.p1.1.m1.1.1.2.cmml">53.97</mn><mo id="S7.SS3.SSS0.Px5.p1.1.m1.1.1.1" xref="S7.SS3.SSS0.Px5.p1.1.m1.1.1.1.cmml">±</mo><mn id="S7.SS3.SSS0.Px5.p1.1.m1.1.1.3" xref="S7.SS3.SSS0.Px5.p1.1.m1.1.1.3.cmml">0.63</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px5.p1.1.m1.1b"><apply id="S7.SS3.SSS0.Px5.p1.1.m1.1.1.cmml" xref="S7.SS3.SSS0.Px5.p1.1.m1.1.1"><csymbol cd="latexml" id="S7.SS3.SSS0.Px5.p1.1.m1.1.1.1.cmml" xref="S7.SS3.SSS0.Px5.p1.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.SS3.SSS0.Px5.p1.1.m1.1.1.2.cmml" xref="S7.SS3.SSS0.Px5.p1.1.m1.1.1.2">53.97</cn><cn type="float" id="S7.SS3.SSS0.Px5.p1.1.m1.1.1.3.cmml" xref="S7.SS3.SSS0.Px5.p1.1.m1.1.1.3">0.63</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px5.p1.1.m1.1c">53.97\pm 0.63</annotation></semantics></math> and <math id="S7.SS3.SSS0.Px5.p1.2.m2.1" class="ltx_Math" alttext="55.01\pm 0.62" display="inline"><semantics id="S7.SS3.SSS0.Px5.p1.2.m2.1a"><mrow id="S7.SS3.SSS0.Px5.p1.2.m2.1.1" xref="S7.SS3.SSS0.Px5.p1.2.m2.1.1.cmml"><mn id="S7.SS3.SSS0.Px5.p1.2.m2.1.1.2" xref="S7.SS3.SSS0.Px5.p1.2.m2.1.1.2.cmml">55.01</mn><mo id="S7.SS3.SSS0.Px5.p1.2.m2.1.1.1" xref="S7.SS3.SSS0.Px5.p1.2.m2.1.1.1.cmml">±</mo><mn id="S7.SS3.SSS0.Px5.p1.2.m2.1.1.3" xref="S7.SS3.SSS0.Px5.p1.2.m2.1.1.3.cmml">0.62</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.SS3.SSS0.Px5.p1.2.m2.1b"><apply id="S7.SS3.SSS0.Px5.p1.2.m2.1.1.cmml" xref="S7.SS3.SSS0.Px5.p1.2.m2.1.1"><csymbol cd="latexml" id="S7.SS3.SSS0.Px5.p1.2.m2.1.1.1.cmml" xref="S7.SS3.SSS0.Px5.p1.2.m2.1.1.1">plus-or-minus</csymbol><cn type="float" id="S7.SS3.SSS0.Px5.p1.2.m2.1.1.2.cmml" xref="S7.SS3.SSS0.Px5.p1.2.m2.1.1.2">55.01</cn><cn type="float" id="S7.SS3.SSS0.Px5.p1.2.m2.1.1.3.cmml" xref="S7.SS3.SSS0.Px5.p1.2.m2.1.1.3">0.62</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.SS3.SSS0.Px5.p1.2.m2.1c">55.01\pm 0.62</annotation></semantics></math> for ProtoNet and MetaIRNet, respectively.</p>
</div>
</section>
</section>
<section id="S7.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.4 </span>Dataset Split for NAB</h3>

<div id="S7.SS4.p1" class="ltx_para">
<p id="S7.SS4.p1.1" class="ltx_p">We used the following dataset split for the North American Bird
(NAB) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> dataset. <span id="S7.SS4.p1.1.1" class="ltx_text" style="font-size:90%;"></span></p>
</div>
<section id="S7.SS4.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph" style="font-size:90%;">Label IDs used for training set</h5>

<div id="S7.SS4.SSS0.Px1.p1" class="ltx_para">
<p id="S7.SS4.SSS0.Px1.p1.1" class="ltx_p"><span id="S7.SS4.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">295, 297, 299, 314, 316, 318, 320, 322, 324, 326, 328,
330, 332, 334, 336, 338, 340, 342, 344, 346, 348, 350,
352, 354, 356, 358, 360, 362, 364, 366, 368, 370, 372,
374, 376, 378, 380, 382, 393, 395, 397, 399, 401, 446,
448, 450, 452, 454, 456, 458, 460, 462, 464, 466, 468,
470, 472, 474, 476, 478, 480, 482, 484, 486, 488, 490,
492, 494, 496, 498, 500, 502, 504, 506, 508, 510, 512,
514, 516, 518, 520, 522, 524, 526, 528, 530, 532, 534,
536, 538, 540, 542, 544, 546, 548, 550, 552, 554, 556,
558, 560, 599, 601, 603, 605, 607, 609, 611, 613, 615,
617, 619, 621, 623, 625, 627, 629, 631, 633, 635, 637,
639, 641, 643, 645, 647, 649, 651, 653, 655, 657, 659,
661, 663, 665, 667, 669, 671, 673, 675, 677, 679, 681,
697, 699, 746, 748, 750, 752, 754, 756, 758, 760, 762,
764, 766, 768, 770, 772, 774, 776, 778, 780, 782, 784,
786, 788, 790, 792, 794, 796, 798, 800, 802, 804, 806,
808, 810, 812, 814, 816, 818, 820, 822, 824, 826, 828,
830, 832, 834, 836, 838, 840, 842, 844, 846, 848, 850,
852, 854, 856, 858, 860, 862, 864, 866, 868, 870, 872,
874, 876, 878, 880, 882, 884, 886, 888, 890, 892, 894,
896, 898, 900, 902, 904, 906, 908, 910, 912, 914, 916,
918, 920, 922, 924, 926, 928, 930, 932, 934, 936, 938,
940, 942, 944, 946, 948, 950, 952, 954, 956, 958, 960,
962, 964, 966, 968, 970, 972, 974, 976, 978, 980, 982,
984, 986, 988, 990, 992, 994, 996, 998, 1000, 1002, 1004,
1006, 1008, 1010</span><span id="S7.SS4.SSS0.Px1.p1.1.2" class="ltx_text" style="font-size:90%;"></span></p>
</div>
</section>
<section id="S7.SS4.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph" style="font-size:90%;">Label IDs used for validation set</h5>

<div id="S7.SS4.SSS0.Px2.p1" class="ltx_para">
<p id="S7.SS4.SSS0.Px2.p1.1" class="ltx_p"><span id="S7.SS4.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">298, 315, 319, 323, 327, 331, 335, 339, 343, 347, 351,
355, 359, 363, 367, 371, 375, 379, 392, 396, 400, 447,
451, 455, 459, 463, 467, 471, 475, 479, 483, 487, 491,
495, 499, 503, 507, 511, 515, 519, 523, 527, 531, 535,
539, 543, 547, 551, 555, 559, 600, 604, 608, 612, 616,
620, 624, 628, 632, 636, 640, 644, 648, 652, 656, 660,
664, 668, 672, 676, 680, 698, 747, 751, 755, 759, 763,
767, 771, 775, 779, 783, 787, 791, 795, 799, 803, 807,
811, 815, 819, 823, 827, 831, 835, 839, 843, 847, 851,
855, 859, 863, 867, 871, 875, 879, 883, 887, 891, 895,
899, 903, 907, 911, 915, 919, 923, 927, 931, 935, 939,
943, 947, 951, 955, 959, 963, 967, 971, 975, 979, 983,
987, 991, 995, 999, 1003, 1007</span><span id="S7.SS4.SSS0.Px2.p1.1.2" class="ltx_text" style="font-size:90%;"></span></p>
</div>
</section>
<section id="S7.SS4.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph" style="font-size:90%;">Label IDs used for test set</h5>

<div id="S7.SS4.SSS0.Px3.p1" class="ltx_para">
<p id="S7.SS4.SSS0.Px3.p1.1" class="ltx_p"><span id="S7.SS4.SSS0.Px3.p1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">296, 313, 317, 321, 325, 329, 333, 337, 341, 345, 349,
353, 357, 361, 365, 369, 373, 377, 381, 394, 398, 402,
449, 453, 457, 461, 465, 469, 473, 477, 481, 485, 489,
493, 497, 501, 505, 509, 513, 517, 521, 525, 529, 533,
537, 541, 545, 549, 553, 557, 561, 602, 606, 610, 614,
618, 622, 626, 630, 634, 638, 642, 646, 650, 654, 658,
662, 666, 670, 674, 678, 696, 700, 749, 753, 757, 761,
765, 769, 773, 777, 781, 785, 789, 793, 797, 801, 805,
809, 813, 817, 821, 825, 829, 833, 837, 841, 845, 849,
853, 857, 861, 865, 869, 873, 877, 881, 885, 889, 893,
897, 901, 905, 909, 913, 917, 921, 925, 929, 933, 937,
941, 945, 949, 953, 957, 961, 965, 969, 973, 977, 981,
985, 989, 993, 997, 1001, 1005, 1009</span><span id="S7.SS4.SSS0.Px3.p1.1.2" class="ltx_text" style="font-size:90%;"></span></p>
</div>
</section>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1911.07163" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1911.07164" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1911.07164">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1911.07164" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1911.07165" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar  7 09:15:22 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
