<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1912.06733] Private Federated Learning with Domain Adaptation</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Private Federated Learning with Domain Adaptation">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Private Federated Learning with Domain Adaptation">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1912.06733">

<!--Generated on Sat Mar  2 13:49:15 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\newfloatcommand</span>
<p id="p1.2" class="ltx_p">capbtabboxtable[][<span id="p1.2.1" class="ltx_ERROR undefined">\FBwidth</span>]


</p>
</div>
<h1 class="ltx_title ltx_title_document">Private Federated Learning with Domain Adaptation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Daniel W. Peterson       Pallika Kanani       Virendra J. Marathe
<br class="ltx_break">Oracle Labs
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">{daniel.peterson,pallika.kanani,virendra.marathe}@oracle.com</span>
</span></span>
</div>

<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL) is a distributed machine learning (ML) paradigm that enables multiple parties to jointly re-train a shared model
without sharing their data with any other parties <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib5" title="" class="ltx_ref">5</a>; <a href="#bib.bib15" title="" class="ltx_ref">15</a>)</cite>, offering advantages in both scale and privacy.
We propose a framework to augment this collaborative model-building with per-user domain adaptation.
We show that this technique improves model accuracy for all users, using both real and synthetic data,
and that this improvement is much more pronounced when differential privacy bounds are imposed on
the FL model.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In FL, multiple parties wish to perform essentially the same
task using ML, with a model structure that is agreed upon in advance.
Although the initial focus of FL has been on targeting millions of
mobile devices <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib5" title="" class="ltx_ref">5</a>)</cite>, the benefits of its architecture
are beneficial even for enterprise settings: the number of users
of an ML service may be much smaller, but privacy concerns are paramount.
Each user wants the best possible classifier for their individual use,
but has a limited budget for labeling their own data. Pooling the data of
multiple users could improve model accuracy, because accuracy generally
increases with increased training data.
The FL framework allows them to effectively pool their labeled
data, without explicitly sharing it.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.2" class="ltx_p">Recognizing that just FL is not sufficient to guarantee data privacy,
many have proposed the addition of differential privacy  <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib9" title="" class="ltx_ref">9</a>; <a href="#bib.bib8" title="" class="ltx_ref">8</a>; <a href="#bib.bib10" title="" class="ltx_ref">10</a>)</cite> to FL <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib1" title="" class="ltx_ref">1</a>; <a href="#bib.bib11" title="" class="ltx_ref">11</a>; <a href="#bib.bib16" title="" class="ltx_ref">16</a>; <a href="#bib.bib20" title="" class="ltx_ref">20</a>)</cite>.
Informally, differential privacy aims to provide a bound, <math id="S1.p3.1.m1.1" class="ltx_Math" alttext="\varepsilon" display="inline"><semantics id="S1.p3.1.m1.1a"><mi id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">ε</mi><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><ci id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">𝜀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">\varepsilon</annotation></semantics></math>,
on the variation in the model’s output based on the inclusion or exclusion
of a single data point. Introducing “noise” in
the training process (inputs, parameters, or outputs) makes it difficult
to guarantee whether any particular data point was used to train the model.
While this noise
ensures <em id="S1.p3.2.1" class="ltx_emph ltx_font_italic"><math id="S1.p3.2.1.m1.1" class="ltx_Math" alttext="\varepsilon" display="inline"><semantics id="S1.p3.2.1.m1.1a"><mi id="S1.p3.2.1.m1.1.1" xref="S1.p3.2.1.m1.1.1.cmml">ε</mi><annotation-xml encoding="MathML-Content" id="S1.p3.2.1.m1.1b"><ci id="S1.p3.2.1.m1.1.1.cmml" xref="S1.p3.2.1.m1.1.1">𝜀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.1.m1.1c">\varepsilon</annotation></semantics></math>-differential privacy</em> <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib9" title="" class="ltx_ref">9</a>)</cite> for the data point,
it can degrade the accuracy of model predictions.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">We consider the setting in which individual user data comes from diverse domains.
This is common, because each user can have a different data-generating process.
We show in <a href="#S3" title="3 Evaluation ‣ Private Federated Learning with Domain Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3</span></a> that, in this setting, the differentially private FL
model may provide worse performance for some users than a non-collaborative baseline,
despite the larger training data set available through FL.
There exists a large body of work on <em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">domain adaptation</em>
in non-FL systems <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib3" title="" class="ltx_ref">3</a>; <a href="#bib.bib6" title="" class="ltx_ref">6</a>; <a href="#bib.bib17" title="" class="ltx_ref">17</a>; <a href="#bib.bib22" title="" class="ltx_ref">22</a>; <a href="#bib.bib13" title="" class="ltx_ref">13</a>)</cite>. In domain adaptation, a model
trained over a data set from a source domain is further refined to
adapt to a data set from a different target domain.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this work, we use privacy-preserving FL to train a public,
generalist model on the task, and then adapt this general model
to each user’s private domain.
While learning the general model, our system also learns a private model for each user.
Each user combines the output of the general and private models using a
mixture of experts (MoE) <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib19" title="" class="ltx_ref">19</a>; <a href="#bib.bib21" title="" class="ltx_ref">21</a>)</cite> to make their final predictions.
The two “experts” in the mixture are the general FL model and the domain-tuned private model,
so we refer to our system as federated learning with domain experts (FL+DE).
For privacy in the general model, we use FL with
differentially private stochastic gradient descent (SGD) <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib1" title="" class="ltx_ref">1</a>)</cite>.
The private domain models are trained using ordinary stochastic gradient descent (i.e. without
differential privacy noise). In principle, the two model architectures
can be identical or radically different, but for convenience
we maintain a common model architecture for the general
(public) and private models. Using a MoE architecture allows the general and
private models to influence predictions differently on each individual data points.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">We demonstrate that our system significantly outperforms the accuracy of differentially
private FL. This largely boils down to two
factors. First, the private models provide domain adaptation, which is
known to typically increase accuracy in each domain. On a real-world classification task, we observe a 1.3% absolute
accuracy improvement due to domain adaptation alone. Second, the private
models allow noise-free updates, because there is no need to conceal
private data from the private model. While the accuracy of the differentially-private FL system degrades by 11.5% in the
low-noise setting, the performance of FL+DE does not degrade at all. In the high-noise
setting, the accuracy of the differentially-private FL system degrades by 13.9% and FL+DE accuracy degrades by only 0.8%.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Our Model</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">At its core, our proposal is to mix the outputs of
a collaboratively-learned general model and a domain expert.
Each participating party has an independent set of labeled training examples that
they wish to keep private, drawn from a party-specific domain
distribution.
These users collaborate
to build a general model for the task, but maintain private, domain-adapted
expert models.
The final predictor is a weighted average of the outputs
from the general and private models.
These weights are learned using a
MoE architecture <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib19" title="" class="ltx_ref">19</a>; <a href="#bib.bib21" title="" class="ltx_ref">21</a>)</cite>, so the entire model can be trained with gradient descent.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.5" class="ltx_p">More specifically, let <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="M_{G}" display="inline"><semantics id="S2.p2.1.m1.1a"><msub id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">M</mi><mi id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">𝑀</ci><ci id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">M_{G}</annotation></semantics></math> be a general model, with parameters
<math id="S2.p2.2.m2.1" class="ltx_Math" alttext="\Theta_{G}" display="inline"><semantics id="S2.p2.2.m2.1a"><msub id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">Θ</mi><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">Θ</ci><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\Theta_{G}</annotation></semantics></math>, so that <math id="S2.p2.3.m3.2" class="ltx_Math" alttext="\hat{y}_{G}=M_{G}(x,\Theta_{G})" display="inline"><semantics id="S2.p2.3.m3.2a"><mrow id="S2.p2.3.m3.2.2" xref="S2.p2.3.m3.2.2.cmml"><msub id="S2.p2.3.m3.2.2.3" xref="S2.p2.3.m3.2.2.3.cmml"><mover accent="true" id="S2.p2.3.m3.2.2.3.2" xref="S2.p2.3.m3.2.2.3.2.cmml"><mi id="S2.p2.3.m3.2.2.3.2.2" xref="S2.p2.3.m3.2.2.3.2.2.cmml">y</mi><mo id="S2.p2.3.m3.2.2.3.2.1" xref="S2.p2.3.m3.2.2.3.2.1.cmml">^</mo></mover><mi id="S2.p2.3.m3.2.2.3.3" xref="S2.p2.3.m3.2.2.3.3.cmml">G</mi></msub><mo id="S2.p2.3.m3.2.2.2" xref="S2.p2.3.m3.2.2.2.cmml">=</mo><mrow id="S2.p2.3.m3.2.2.1" xref="S2.p2.3.m3.2.2.1.cmml"><msub id="S2.p2.3.m3.2.2.1.3" xref="S2.p2.3.m3.2.2.1.3.cmml"><mi id="S2.p2.3.m3.2.2.1.3.2" xref="S2.p2.3.m3.2.2.1.3.2.cmml">M</mi><mi id="S2.p2.3.m3.2.2.1.3.3" xref="S2.p2.3.m3.2.2.1.3.3.cmml">G</mi></msub><mo lspace="0em" rspace="0em" id="S2.p2.3.m3.2.2.1.2" xref="S2.p2.3.m3.2.2.1.2.cmml">​</mo><mrow id="S2.p2.3.m3.2.2.1.1.1" xref="S2.p2.3.m3.2.2.1.1.2.cmml"><mo stretchy="false" id="S2.p2.3.m3.2.2.1.1.1.2" xref="S2.p2.3.m3.2.2.1.1.2.cmml">(</mo><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">x</mi><mo id="S2.p2.3.m3.2.2.1.1.1.3" xref="S2.p2.3.m3.2.2.1.1.2.cmml">,</mo><msub id="S2.p2.3.m3.2.2.1.1.1.1" xref="S2.p2.3.m3.2.2.1.1.1.1.cmml"><mi mathvariant="normal" id="S2.p2.3.m3.2.2.1.1.1.1.2" xref="S2.p2.3.m3.2.2.1.1.1.1.2.cmml">Θ</mi><mi id="S2.p2.3.m3.2.2.1.1.1.1.3" xref="S2.p2.3.m3.2.2.1.1.1.1.3.cmml">G</mi></msub><mo stretchy="false" id="S2.p2.3.m3.2.2.1.1.1.4" xref="S2.p2.3.m3.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.2b"><apply id="S2.p2.3.m3.2.2.cmml" xref="S2.p2.3.m3.2.2"><eq id="S2.p2.3.m3.2.2.2.cmml" xref="S2.p2.3.m3.2.2.2"></eq><apply id="S2.p2.3.m3.2.2.3.cmml" xref="S2.p2.3.m3.2.2.3"><csymbol cd="ambiguous" id="S2.p2.3.m3.2.2.3.1.cmml" xref="S2.p2.3.m3.2.2.3">subscript</csymbol><apply id="S2.p2.3.m3.2.2.3.2.cmml" xref="S2.p2.3.m3.2.2.3.2"><ci id="S2.p2.3.m3.2.2.3.2.1.cmml" xref="S2.p2.3.m3.2.2.3.2.1">^</ci><ci id="S2.p2.3.m3.2.2.3.2.2.cmml" xref="S2.p2.3.m3.2.2.3.2.2">𝑦</ci></apply><ci id="S2.p2.3.m3.2.2.3.3.cmml" xref="S2.p2.3.m3.2.2.3.3">𝐺</ci></apply><apply id="S2.p2.3.m3.2.2.1.cmml" xref="S2.p2.3.m3.2.2.1"><times id="S2.p2.3.m3.2.2.1.2.cmml" xref="S2.p2.3.m3.2.2.1.2"></times><apply id="S2.p2.3.m3.2.2.1.3.cmml" xref="S2.p2.3.m3.2.2.1.3"><csymbol cd="ambiguous" id="S2.p2.3.m3.2.2.1.3.1.cmml" xref="S2.p2.3.m3.2.2.1.3">subscript</csymbol><ci id="S2.p2.3.m3.2.2.1.3.2.cmml" xref="S2.p2.3.m3.2.2.1.3.2">𝑀</ci><ci id="S2.p2.3.m3.2.2.1.3.3.cmml" xref="S2.p2.3.m3.2.2.1.3.3">𝐺</ci></apply><interval closure="open" id="S2.p2.3.m3.2.2.1.1.2.cmml" xref="S2.p2.3.m3.2.2.1.1.1"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝑥</ci><apply id="S2.p2.3.m3.2.2.1.1.1.1.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.3.m3.2.2.1.1.1.1.1.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1">subscript</csymbol><ci id="S2.p2.3.m3.2.2.1.1.1.1.2.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.2">Θ</ci><ci id="S2.p2.3.m3.2.2.1.1.1.1.3.cmml" xref="S2.p2.3.m3.2.2.1.1.1.1.3">𝐺</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.2c">\hat{y}_{G}=M_{G}(x,\Theta_{G})</annotation></semantics></math> is <math id="S2.p2.4.m4.1" class="ltx_Math" alttext="M_{G}" display="inline"><semantics id="S2.p2.4.m4.1a"><msub id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><mi id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml">M</mi><mi id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2">𝑀</ci><ci id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">M_{G}</annotation></semantics></math>’s predicted
probability for the positive class, or perhaps a regressed value<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Although
we tested only binary classification and regression in our experiments, there are obvious extensions to
multiclass problems.</span></span></span>.
<math id="S2.p2.5.m5.1" class="ltx_Math" alttext="M_{G}" display="inline"><semantics id="S2.p2.5.m5.1a"><msub id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml"><mi id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">M</mi><mi id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">𝑀</ci><ci id="S2.p2.5.m5.1.1.3.cmml" xref="S2.p2.5.m5.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">M_{G}</annotation></semantics></math> is shared between all parties, and
is trained on all data using FL with differentially private SGD <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib1" title="" class="ltx_ref">1</a>)</cite>, enabling
each party contribute to training the general model.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.10" class="ltx_p">Similarly, let <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="M_{P_{i}}" display="inline"><semantics id="S2.p3.1.m1.1a"><msub id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml"><mi id="S2.p3.1.m1.1.1.2" xref="S2.p3.1.m1.1.1.2.cmml">M</mi><msub id="S2.p3.1.m1.1.1.3" xref="S2.p3.1.m1.1.1.3.cmml"><mi id="S2.p3.1.m1.1.1.3.2" xref="S2.p3.1.m1.1.1.3.2.cmml">P</mi><mi id="S2.p3.1.m1.1.1.3.3" xref="S2.p3.1.m1.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.1.cmml" xref="S2.p3.1.m1.1.1">subscript</csymbol><ci id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.2">𝑀</ci><apply id="S2.p3.1.m1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.3.1.cmml" xref="S2.p3.1.m1.1.1.3">subscript</csymbol><ci id="S2.p3.1.m1.1.1.3.2.cmml" xref="S2.p3.1.m1.1.1.3.2">𝑃</ci><ci id="S2.p3.1.m1.1.1.3.3.cmml" xref="S2.p3.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">M_{P_{i}}</annotation></semantics></math> be a private model of party <math id="S2.p3.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p3.2.m2.1a"><mi id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">i</annotation></semantics></math>,
parameterized by <math id="S2.p3.3.m3.1" class="ltx_Math" alttext="\Theta_{P_{i}}" display="inline"><semantics id="S2.p3.3.m3.1a"><msub id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml"><mi mathvariant="normal" id="S2.p3.3.m3.1.1.2" xref="S2.p3.3.m3.1.1.2.cmml">Θ</mi><msub id="S2.p3.3.m3.1.1.3" xref="S2.p3.3.m3.1.1.3.cmml"><mi id="S2.p3.3.m3.1.1.3.2" xref="S2.p3.3.m3.1.1.3.2.cmml">P</mi><mi id="S2.p3.3.m3.1.1.3.3" xref="S2.p3.3.m3.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><apply id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.cmml" xref="S2.p3.3.m3.1.1">subscript</csymbol><ci id="S2.p3.3.m3.1.1.2.cmml" xref="S2.p3.3.m3.1.1.2">Θ</ci><apply id="S2.p3.3.m3.1.1.3.cmml" xref="S2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.3.1.cmml" xref="S2.p3.3.m3.1.1.3">subscript</csymbol><ci id="S2.p3.3.m3.1.1.3.2.cmml" xref="S2.p3.3.m3.1.1.3.2">𝑃</ci><ci id="S2.p3.3.m3.1.1.3.3.cmml" xref="S2.p3.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">\Theta_{P_{i}}</annotation></semantics></math>, and <math id="S2.p3.4.m4.2" class="ltx_Math" alttext="\hat{y}_{P_{i}}=M_{P_{i}}(x,\Theta_{P_{i}})" display="inline"><semantics id="S2.p3.4.m4.2a"><mrow id="S2.p3.4.m4.2.2" xref="S2.p3.4.m4.2.2.cmml"><msub id="S2.p3.4.m4.2.2.3" xref="S2.p3.4.m4.2.2.3.cmml"><mover accent="true" id="S2.p3.4.m4.2.2.3.2" xref="S2.p3.4.m4.2.2.3.2.cmml"><mi id="S2.p3.4.m4.2.2.3.2.2" xref="S2.p3.4.m4.2.2.3.2.2.cmml">y</mi><mo id="S2.p3.4.m4.2.2.3.2.1" xref="S2.p3.4.m4.2.2.3.2.1.cmml">^</mo></mover><msub id="S2.p3.4.m4.2.2.3.3" xref="S2.p3.4.m4.2.2.3.3.cmml"><mi id="S2.p3.4.m4.2.2.3.3.2" xref="S2.p3.4.m4.2.2.3.3.2.cmml">P</mi><mi id="S2.p3.4.m4.2.2.3.3.3" xref="S2.p3.4.m4.2.2.3.3.3.cmml">i</mi></msub></msub><mo id="S2.p3.4.m4.2.2.2" xref="S2.p3.4.m4.2.2.2.cmml">=</mo><mrow id="S2.p3.4.m4.2.2.1" xref="S2.p3.4.m4.2.2.1.cmml"><msub id="S2.p3.4.m4.2.2.1.3" xref="S2.p3.4.m4.2.2.1.3.cmml"><mi id="S2.p3.4.m4.2.2.1.3.2" xref="S2.p3.4.m4.2.2.1.3.2.cmml">M</mi><msub id="S2.p3.4.m4.2.2.1.3.3" xref="S2.p3.4.m4.2.2.1.3.3.cmml"><mi id="S2.p3.4.m4.2.2.1.3.3.2" xref="S2.p3.4.m4.2.2.1.3.3.2.cmml">P</mi><mi id="S2.p3.4.m4.2.2.1.3.3.3" xref="S2.p3.4.m4.2.2.1.3.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.p3.4.m4.2.2.1.2" xref="S2.p3.4.m4.2.2.1.2.cmml">​</mo><mrow id="S2.p3.4.m4.2.2.1.1.1" xref="S2.p3.4.m4.2.2.1.1.2.cmml"><mo stretchy="false" id="S2.p3.4.m4.2.2.1.1.1.2" xref="S2.p3.4.m4.2.2.1.1.2.cmml">(</mo><mi id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml">x</mi><mo id="S2.p3.4.m4.2.2.1.1.1.3" xref="S2.p3.4.m4.2.2.1.1.2.cmml">,</mo><msub id="S2.p3.4.m4.2.2.1.1.1.1" xref="S2.p3.4.m4.2.2.1.1.1.1.cmml"><mi mathvariant="normal" id="S2.p3.4.m4.2.2.1.1.1.1.2" xref="S2.p3.4.m4.2.2.1.1.1.1.2.cmml">Θ</mi><msub id="S2.p3.4.m4.2.2.1.1.1.1.3" xref="S2.p3.4.m4.2.2.1.1.1.1.3.cmml"><mi id="S2.p3.4.m4.2.2.1.1.1.1.3.2" xref="S2.p3.4.m4.2.2.1.1.1.1.3.2.cmml">P</mi><mi id="S2.p3.4.m4.2.2.1.1.1.1.3.3" xref="S2.p3.4.m4.2.2.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo stretchy="false" id="S2.p3.4.m4.2.2.1.1.1.4" xref="S2.p3.4.m4.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.2b"><apply id="S2.p3.4.m4.2.2.cmml" xref="S2.p3.4.m4.2.2"><eq id="S2.p3.4.m4.2.2.2.cmml" xref="S2.p3.4.m4.2.2.2"></eq><apply id="S2.p3.4.m4.2.2.3.cmml" xref="S2.p3.4.m4.2.2.3"><csymbol cd="ambiguous" id="S2.p3.4.m4.2.2.3.1.cmml" xref="S2.p3.4.m4.2.2.3">subscript</csymbol><apply id="S2.p3.4.m4.2.2.3.2.cmml" xref="S2.p3.4.m4.2.2.3.2"><ci id="S2.p3.4.m4.2.2.3.2.1.cmml" xref="S2.p3.4.m4.2.2.3.2.1">^</ci><ci id="S2.p3.4.m4.2.2.3.2.2.cmml" xref="S2.p3.4.m4.2.2.3.2.2">𝑦</ci></apply><apply id="S2.p3.4.m4.2.2.3.3.cmml" xref="S2.p3.4.m4.2.2.3.3"><csymbol cd="ambiguous" id="S2.p3.4.m4.2.2.3.3.1.cmml" xref="S2.p3.4.m4.2.2.3.3">subscript</csymbol><ci id="S2.p3.4.m4.2.2.3.3.2.cmml" xref="S2.p3.4.m4.2.2.3.3.2">𝑃</ci><ci id="S2.p3.4.m4.2.2.3.3.3.cmml" xref="S2.p3.4.m4.2.2.3.3.3">𝑖</ci></apply></apply><apply id="S2.p3.4.m4.2.2.1.cmml" xref="S2.p3.4.m4.2.2.1"><times id="S2.p3.4.m4.2.2.1.2.cmml" xref="S2.p3.4.m4.2.2.1.2"></times><apply id="S2.p3.4.m4.2.2.1.3.cmml" xref="S2.p3.4.m4.2.2.1.3"><csymbol cd="ambiguous" id="S2.p3.4.m4.2.2.1.3.1.cmml" xref="S2.p3.4.m4.2.2.1.3">subscript</csymbol><ci id="S2.p3.4.m4.2.2.1.3.2.cmml" xref="S2.p3.4.m4.2.2.1.3.2">𝑀</ci><apply id="S2.p3.4.m4.2.2.1.3.3.cmml" xref="S2.p3.4.m4.2.2.1.3.3"><csymbol cd="ambiguous" id="S2.p3.4.m4.2.2.1.3.3.1.cmml" xref="S2.p3.4.m4.2.2.1.3.3">subscript</csymbol><ci id="S2.p3.4.m4.2.2.1.3.3.2.cmml" xref="S2.p3.4.m4.2.2.1.3.3.2">𝑃</ci><ci id="S2.p3.4.m4.2.2.1.3.3.3.cmml" xref="S2.p3.4.m4.2.2.1.3.3.3">𝑖</ci></apply></apply><interval closure="open" id="S2.p3.4.m4.2.2.1.1.2.cmml" xref="S2.p3.4.m4.2.2.1.1.1"><ci id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1">𝑥</ci><apply id="S2.p3.4.m4.2.2.1.1.1.1.cmml" xref="S2.p3.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.4.m4.2.2.1.1.1.1.1.cmml" xref="S2.p3.4.m4.2.2.1.1.1.1">subscript</csymbol><ci id="S2.p3.4.m4.2.2.1.1.1.1.2.cmml" xref="S2.p3.4.m4.2.2.1.1.1.1.2">Θ</ci><apply id="S2.p3.4.m4.2.2.1.1.1.1.3.cmml" xref="S2.p3.4.m4.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.4.m4.2.2.1.1.1.1.3.1.cmml" xref="S2.p3.4.m4.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.p3.4.m4.2.2.1.1.1.1.3.2.cmml" xref="S2.p3.4.m4.2.2.1.1.1.1.3.2">𝑃</ci><ci id="S2.p3.4.m4.2.2.1.1.1.1.3.3.cmml" xref="S2.p3.4.m4.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.2c">\hat{y}_{P_{i}}=M_{P_{i}}(x,\Theta_{P_{i}})</annotation></semantics></math> be the model’s predicted probability. Although <math id="S2.p3.5.m5.1" class="ltx_Math" alttext="M_{P_{i}}" display="inline"><semantics id="S2.p3.5.m5.1a"><msub id="S2.p3.5.m5.1.1" xref="S2.p3.5.m5.1.1.cmml"><mi id="S2.p3.5.m5.1.1.2" xref="S2.p3.5.m5.1.1.2.cmml">M</mi><msub id="S2.p3.5.m5.1.1.3" xref="S2.p3.5.m5.1.1.3.cmml"><mi id="S2.p3.5.m5.1.1.3.2" xref="S2.p3.5.m5.1.1.3.2.cmml">P</mi><mi id="S2.p3.5.m5.1.1.3.3" xref="S2.p3.5.m5.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.p3.5.m5.1b"><apply id="S2.p3.5.m5.1.1.cmml" xref="S2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p3.5.m5.1.1.1.cmml" xref="S2.p3.5.m5.1.1">subscript</csymbol><ci id="S2.p3.5.m5.1.1.2.cmml" xref="S2.p3.5.m5.1.1.2">𝑀</ci><apply id="S2.p3.5.m5.1.1.3.cmml" xref="S2.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.p3.5.m5.1.1.3.1.cmml" xref="S2.p3.5.m5.1.1.3">subscript</csymbol><ci id="S2.p3.5.m5.1.1.3.2.cmml" xref="S2.p3.5.m5.1.1.3.2">𝑃</ci><ci id="S2.p3.5.m5.1.1.3.3.cmml" xref="S2.p3.5.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m5.1c">M_{P_{i}}</annotation></semantics></math> could have a different architecture
from <math id="S2.p3.6.m6.1" class="ltx_Math" alttext="M_{G}" display="inline"><semantics id="S2.p3.6.m6.1a"><msub id="S2.p3.6.m6.1.1" xref="S2.p3.6.m6.1.1.cmml"><mi id="S2.p3.6.m6.1.1.2" xref="S2.p3.6.m6.1.1.2.cmml">M</mi><mi id="S2.p3.6.m6.1.1.3" xref="S2.p3.6.m6.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.6.m6.1b"><apply id="S2.p3.6.m6.1.1.cmml" xref="S2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p3.6.m6.1.1.1.cmml" xref="S2.p3.6.m6.1.1">subscript</csymbol><ci id="S2.p3.6.m6.1.1.2.cmml" xref="S2.p3.6.m6.1.1.2">𝑀</ci><ci id="S2.p3.6.m6.1.1.3.cmml" xref="S2.p3.6.m6.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m6.1c">M_{G}</annotation></semantics></math>, in this work we initialize <math id="S2.p3.7.m7.1" class="ltx_Math" alttext="M_{P_{i}}" display="inline"><semantics id="S2.p3.7.m7.1a"><msub id="S2.p3.7.m7.1.1" xref="S2.p3.7.m7.1.1.cmml"><mi id="S2.p3.7.m7.1.1.2" xref="S2.p3.7.m7.1.1.2.cmml">M</mi><msub id="S2.p3.7.m7.1.1.3" xref="S2.p3.7.m7.1.1.3.cmml"><mi id="S2.p3.7.m7.1.1.3.2" xref="S2.p3.7.m7.1.1.3.2.cmml">P</mi><mi id="S2.p3.7.m7.1.1.3.3" xref="S2.p3.7.m7.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.p3.7.m7.1b"><apply id="S2.p3.7.m7.1.1.cmml" xref="S2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p3.7.m7.1.1.1.cmml" xref="S2.p3.7.m7.1.1">subscript</csymbol><ci id="S2.p3.7.m7.1.1.2.cmml" xref="S2.p3.7.m7.1.1.2">𝑀</ci><apply id="S2.p3.7.m7.1.1.3.cmml" xref="S2.p3.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.p3.7.m7.1.1.3.1.cmml" xref="S2.p3.7.m7.1.1.3">subscript</csymbol><ci id="S2.p3.7.m7.1.1.3.2.cmml" xref="S2.p3.7.m7.1.1.3.2">𝑃</ci><ci id="S2.p3.7.m7.1.1.3.3.cmml" xref="S2.p3.7.m7.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m7.1c">M_{P_{i}}</annotation></semantics></math> as an exact copy of
<math id="S2.p3.8.m8.1" class="ltx_Math" alttext="M_{G}" display="inline"><semantics id="S2.p3.8.m8.1a"><msub id="S2.p3.8.m8.1.1" xref="S2.p3.8.m8.1.1.cmml"><mi id="S2.p3.8.m8.1.1.2" xref="S2.p3.8.m8.1.1.2.cmml">M</mi><mi id="S2.p3.8.m8.1.1.3" xref="S2.p3.8.m8.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.8.m8.1b"><apply id="S2.p3.8.m8.1.1.cmml" xref="S2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p3.8.m8.1.1.1.cmml" xref="S2.p3.8.m8.1.1">subscript</csymbol><ci id="S2.p3.8.m8.1.1.2.cmml" xref="S2.p3.8.m8.1.1.2">𝑀</ci><ci id="S2.p3.8.m8.1.1.3.cmml" xref="S2.p3.8.m8.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m8.1c">M_{G}</annotation></semantics></math>. Neither <math id="S2.p3.9.m9.1" class="ltx_Math" alttext="M_{P_{i}}" display="inline"><semantics id="S2.p3.9.m9.1a"><msub id="S2.p3.9.m9.1.1" xref="S2.p3.9.m9.1.1.cmml"><mi id="S2.p3.9.m9.1.1.2" xref="S2.p3.9.m9.1.1.2.cmml">M</mi><msub id="S2.p3.9.m9.1.1.3" xref="S2.p3.9.m9.1.1.3.cmml"><mi id="S2.p3.9.m9.1.1.3.2" xref="S2.p3.9.m9.1.1.3.2.cmml">P</mi><mi id="S2.p3.9.m9.1.1.3.3" xref="S2.p3.9.m9.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.p3.9.m9.1b"><apply id="S2.p3.9.m9.1.1.cmml" xref="S2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p3.9.m9.1.1.1.cmml" xref="S2.p3.9.m9.1.1">subscript</csymbol><ci id="S2.p3.9.m9.1.1.2.cmml" xref="S2.p3.9.m9.1.1.2">𝑀</ci><apply id="S2.p3.9.m9.1.1.3.cmml" xref="S2.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="S2.p3.9.m9.1.1.3.1.cmml" xref="S2.p3.9.m9.1.1.3">subscript</csymbol><ci id="S2.p3.9.m9.1.1.3.2.cmml" xref="S2.p3.9.m9.1.1.3.2">𝑃</ci><ci id="S2.p3.9.m9.1.1.3.3.cmml" xref="S2.p3.9.m9.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.9.m9.1c">M_{P_{i}}</annotation></semantics></math>, nor gradient information about it, is shared
with any other party, so <math id="S2.p3.10.m10.1" class="ltx_Math" alttext="M_{P_{i}}" display="inline"><semantics id="S2.p3.10.m10.1a"><msub id="S2.p3.10.m10.1.1" xref="S2.p3.10.m10.1.1.cmml"><mi id="S2.p3.10.m10.1.1.2" xref="S2.p3.10.m10.1.1.2.cmml">M</mi><msub id="S2.p3.10.m10.1.1.3" xref="S2.p3.10.m10.1.1.3.cmml"><mi id="S2.p3.10.m10.1.1.3.2" xref="S2.p3.10.m10.1.1.3.2.cmml">P</mi><mi id="S2.p3.10.m10.1.1.3.3" xref="S2.p3.10.m10.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.p3.10.m10.1b"><apply id="S2.p3.10.m10.1.1.cmml" xref="S2.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S2.p3.10.m10.1.1.1.cmml" xref="S2.p3.10.m10.1.1">subscript</csymbol><ci id="S2.p3.10.m10.1.1.2.cmml" xref="S2.p3.10.m10.1.1.2">𝑀</ci><apply id="S2.p3.10.m10.1.1.3.cmml" xref="S2.p3.10.m10.1.1.3"><csymbol cd="ambiguous" id="S2.p3.10.m10.1.1.3.1.cmml" xref="S2.p3.10.m10.1.1.3">subscript</csymbol><ci id="S2.p3.10.m10.1.1.3.2.cmml" xref="S2.p3.10.m10.1.1.3.2">𝑃</ci><ci id="S2.p3.10.m10.1.1.3.3.cmml" xref="S2.p3.10.m10.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.10.m10.1c">M_{P_{i}}</annotation></semantics></math> can be updated exactly, without
including privacy-related noise.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">The final output that party <math id="S2.p4.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p4.1.m1.1a"><mi id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><ci id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">i</annotation></semantics></math> uses to label data is</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.5" class="ltx_Math" alttext="\hat{y}_{i}=\alpha_{i}(x)M_{G}(x,\Theta_{G})+(1-\alpha_{i}(x))M_{P_{i}}(x,\Theta_{P_{i}})." display="block"><semantics id="S2.E1.m1.5a"><mrow id="S2.E1.m1.5.5.1" xref="S2.E1.m1.5.5.1.1.cmml"><mrow id="S2.E1.m1.5.5.1.1" xref="S2.E1.m1.5.5.1.1.cmml"><msub id="S2.E1.m1.5.5.1.1.5" xref="S2.E1.m1.5.5.1.1.5.cmml"><mover accent="true" id="S2.E1.m1.5.5.1.1.5.2" xref="S2.E1.m1.5.5.1.1.5.2.cmml"><mi id="S2.E1.m1.5.5.1.1.5.2.2" xref="S2.E1.m1.5.5.1.1.5.2.2.cmml">y</mi><mo id="S2.E1.m1.5.5.1.1.5.2.1" xref="S2.E1.m1.5.5.1.1.5.2.1.cmml">^</mo></mover><mi id="S2.E1.m1.5.5.1.1.5.3" xref="S2.E1.m1.5.5.1.1.5.3.cmml">i</mi></msub><mo id="S2.E1.m1.5.5.1.1.4" xref="S2.E1.m1.5.5.1.1.4.cmml">=</mo><mrow id="S2.E1.m1.5.5.1.1.3" xref="S2.E1.m1.5.5.1.1.3.cmml"><mrow id="S2.E1.m1.5.5.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.cmml"><msub id="S2.E1.m1.5.5.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.3.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.3.2" xref="S2.E1.m1.5.5.1.1.1.1.3.2.cmml">α</mi><mi id="S2.E1.m1.5.5.1.1.1.1.3.3" xref="S2.E1.m1.5.5.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.4.2" xref="S2.E1.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.4.2.1" xref="S2.E1.m1.5.5.1.1.1.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.4.2.2" xref="S2.E1.m1.5.5.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.1.1.2a" xref="S2.E1.m1.5.5.1.1.1.1.2.cmml">​</mo><msub id="S2.E1.m1.5.5.1.1.1.1.5" xref="S2.E1.m1.5.5.1.1.1.1.5.cmml"><mi id="S2.E1.m1.5.5.1.1.1.1.5.2" xref="S2.E1.m1.5.5.1.1.1.1.5.2.cmml">M</mi><mi id="S2.E1.m1.5.5.1.1.1.1.5.3" xref="S2.E1.m1.5.5.1.1.1.1.5.3.cmml">G</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.1.1.2b" xref="S2.E1.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.5.5.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">x</mi><mo id="S2.E1.m1.5.5.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E1.m1.5.5.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.cmml">Θ</mi><mi id="S2.E1.m1.5.5.1.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.3.cmml">G</mi></msub><mo stretchy="false" id="S2.E1.m1.5.5.1.1.1.1.1.1.4" xref="S2.E1.m1.5.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.5.5.1.1.3.4" xref="S2.E1.m1.5.5.1.1.3.4.cmml">+</mo><mrow id="S2.E1.m1.5.5.1.1.3.3" xref="S2.E1.m1.5.5.1.1.3.3.cmml"><mrow id="S2.E1.m1.5.5.1.1.2.2.1.1" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.1.1.2.2.1.1.2" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.5.5.1.1.2.2.1.1.1" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.cmml"><mn id="S2.E1.m1.5.5.1.1.2.2.1.1.1.2" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="S2.E1.m1.5.5.1.1.2.2.1.1.1.1" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.1.cmml">−</mo><mrow id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.cmml"><msub id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2.cmml"><mi id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2.2" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2.2.cmml">α</mi><mi id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2.3" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.1" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.1.cmml">​</mo><mrow id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.3.2" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.3.2.1" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.cmml">(</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">x</mi><mo stretchy="false" id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.3.2.2" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E1.m1.5.5.1.1.2.2.1.1.3" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.3.3.3" xref="S2.E1.m1.5.5.1.1.3.3.3.cmml">​</mo><msub id="S2.E1.m1.5.5.1.1.3.3.4" xref="S2.E1.m1.5.5.1.1.3.3.4.cmml"><mi id="S2.E1.m1.5.5.1.1.3.3.4.2" xref="S2.E1.m1.5.5.1.1.3.3.4.2.cmml">M</mi><msub id="S2.E1.m1.5.5.1.1.3.3.4.3" xref="S2.E1.m1.5.5.1.1.3.3.4.3.cmml"><mi id="S2.E1.m1.5.5.1.1.3.3.4.3.2" xref="S2.E1.m1.5.5.1.1.3.3.4.3.2.cmml">P</mi><mi id="S2.E1.m1.5.5.1.1.3.3.4.3.3" xref="S2.E1.m1.5.5.1.1.3.3.4.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.1.1.3.3.3a" xref="S2.E1.m1.5.5.1.1.3.3.3.cmml">​</mo><mrow id="S2.E1.m1.5.5.1.1.3.3.2.1" xref="S2.E1.m1.5.5.1.1.3.3.2.2.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.1.1.3.3.2.1.2" xref="S2.E1.m1.5.5.1.1.3.3.2.2.cmml">(</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">x</mi><mo id="S2.E1.m1.5.5.1.1.3.3.2.1.3" xref="S2.E1.m1.5.5.1.1.3.3.2.2.cmml">,</mo><msub id="S2.E1.m1.5.5.1.1.3.3.2.1.1" xref="S2.E1.m1.5.5.1.1.3.3.2.1.1.cmml"><mi mathvariant="normal" id="S2.E1.m1.5.5.1.1.3.3.2.1.1.2" xref="S2.E1.m1.5.5.1.1.3.3.2.1.1.2.cmml">Θ</mi><msub id="S2.E1.m1.5.5.1.1.3.3.2.1.1.3" xref="S2.E1.m1.5.5.1.1.3.3.2.1.1.3.cmml"><mi id="S2.E1.m1.5.5.1.1.3.3.2.1.1.3.2" xref="S2.E1.m1.5.5.1.1.3.3.2.1.1.3.2.cmml">P</mi><mi id="S2.E1.m1.5.5.1.1.3.3.2.1.1.3.3" xref="S2.E1.m1.5.5.1.1.3.3.2.1.1.3.3.cmml">i</mi></msub></msub><mo stretchy="false" id="S2.E1.m1.5.5.1.1.3.3.2.1.4" xref="S2.E1.m1.5.5.1.1.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E1.m1.5.5.1.2" xref="S2.E1.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.5b"><apply id="S2.E1.m1.5.5.1.1.cmml" xref="S2.E1.m1.5.5.1"><eq id="S2.E1.m1.5.5.1.1.4.cmml" xref="S2.E1.m1.5.5.1.1.4"></eq><apply id="S2.E1.m1.5.5.1.1.5.cmml" xref="S2.E1.m1.5.5.1.1.5"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.5.1.cmml" xref="S2.E1.m1.5.5.1.1.5">subscript</csymbol><apply id="S2.E1.m1.5.5.1.1.5.2.cmml" xref="S2.E1.m1.5.5.1.1.5.2"><ci id="S2.E1.m1.5.5.1.1.5.2.1.cmml" xref="S2.E1.m1.5.5.1.1.5.2.1">^</ci><ci id="S2.E1.m1.5.5.1.1.5.2.2.cmml" xref="S2.E1.m1.5.5.1.1.5.2.2">𝑦</ci></apply><ci id="S2.E1.m1.5.5.1.1.5.3.cmml" xref="S2.E1.m1.5.5.1.1.5.3">𝑖</ci></apply><apply id="S2.E1.m1.5.5.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.3"><plus id="S2.E1.m1.5.5.1.1.3.4.cmml" xref="S2.E1.m1.5.5.1.1.3.4"></plus><apply id="S2.E1.m1.5.5.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1"><times id="S2.E1.m1.5.5.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.2"></times><apply id="S2.E1.m1.5.5.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.3.2">𝛼</ci><ci id="S2.E1.m1.5.5.1.1.1.1.3.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.3.3">𝑖</ci></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑥</ci><apply id="S2.E1.m1.5.5.1.1.1.1.5.cmml" xref="S2.E1.m1.5.5.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.5.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.5">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.5.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.5.2">𝑀</ci><ci id="S2.E1.m1.5.5.1.1.1.1.5.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.5.3">𝐺</ci></apply><interval closure="open" id="S2.E1.m1.5.5.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1"><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑥</ci><apply id="S2.E1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.2">Θ</ci><ci id="S2.E1.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.1.1.1.1.1.3">𝐺</ci></apply></interval></apply><apply id="S2.E1.m1.5.5.1.1.3.3.cmml" xref="S2.E1.m1.5.5.1.1.3.3"><times id="S2.E1.m1.5.5.1.1.3.3.3.cmml" xref="S2.E1.m1.5.5.1.1.3.3.3"></times><apply id="S2.E1.m1.5.5.1.1.2.2.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.2.2.1.1"><minus id="S2.E1.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.1"></minus><cn type="integer" id="S2.E1.m1.5.5.1.1.2.2.1.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.2">1</cn><apply id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3"><times id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.1"></times><apply id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2.1.cmml" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2.2.cmml" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2.2">𝛼</ci><ci id="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2.3.cmml" xref="S2.E1.m1.5.5.1.1.2.2.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑥</ci></apply></apply><apply id="S2.E1.m1.5.5.1.1.3.3.4.cmml" xref="S2.E1.m1.5.5.1.1.3.3.4"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.3.3.4.1.cmml" xref="S2.E1.m1.5.5.1.1.3.3.4">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.3.3.4.2.cmml" xref="S2.E1.m1.5.5.1.1.3.3.4.2">𝑀</ci><apply id="S2.E1.m1.5.5.1.1.3.3.4.3.cmml" xref="S2.E1.m1.5.5.1.1.3.3.4.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.3.3.4.3.1.cmml" xref="S2.E1.m1.5.5.1.1.3.3.4.3">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.3.3.4.3.2.cmml" xref="S2.E1.m1.5.5.1.1.3.3.4.3.2">𝑃</ci><ci id="S2.E1.m1.5.5.1.1.3.3.4.3.3.cmml" xref="S2.E1.m1.5.5.1.1.3.3.4.3.3">𝑖</ci></apply></apply><interval closure="open" id="S2.E1.m1.5.5.1.1.3.3.2.2.cmml" xref="S2.E1.m1.5.5.1.1.3.3.2.1"><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝑥</ci><apply id="S2.E1.m1.5.5.1.1.3.3.2.1.1.cmml" xref="S2.E1.m1.5.5.1.1.3.3.2.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.3.3.2.1.1.1.cmml" xref="S2.E1.m1.5.5.1.1.3.3.2.1.1">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.3.3.2.1.1.2.cmml" xref="S2.E1.m1.5.5.1.1.3.3.2.1.1.2">Θ</ci><apply id="S2.E1.m1.5.5.1.1.3.3.2.1.1.3.cmml" xref="S2.E1.m1.5.5.1.1.3.3.2.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.1.1.3.3.2.1.1.3.1.cmml" xref="S2.E1.m1.5.5.1.1.3.3.2.1.1.3">subscript</csymbol><ci id="S2.E1.m1.5.5.1.1.3.3.2.1.1.3.2.cmml" xref="S2.E1.m1.5.5.1.1.3.3.2.1.1.3.2">𝑃</ci><ci id="S2.E1.m1.5.5.1.1.3.3.2.1.1.3.3.cmml" xref="S2.E1.m1.5.5.1.1.3.3.2.1.1.3.3">𝑖</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.5c">\hat{y}_{i}=\alpha_{i}(x)M_{G}(x,\Theta_{G})+(1-\alpha_{i}(x))M_{P_{i}}(x,\Theta_{P_{i}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.10" class="ltx_p">The weight <math id="S2.p5.1.m1.1" class="ltx_Math" alttext="\alpha_{i}(x)" display="inline"><semantics id="S2.p5.1.m1.1a"><mrow id="S2.p5.1.m1.1.2" xref="S2.p5.1.m1.1.2.cmml"><msub id="S2.p5.1.m1.1.2.2" xref="S2.p5.1.m1.1.2.2.cmml"><mi id="S2.p5.1.m1.1.2.2.2" xref="S2.p5.1.m1.1.2.2.2.cmml">α</mi><mi id="S2.p5.1.m1.1.2.2.3" xref="S2.p5.1.m1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.p5.1.m1.1.2.1" xref="S2.p5.1.m1.1.2.1.cmml">​</mo><mrow id="S2.p5.1.m1.1.2.3.2" xref="S2.p5.1.m1.1.2.cmml"><mo stretchy="false" id="S2.p5.1.m1.1.2.3.2.1" xref="S2.p5.1.m1.1.2.cmml">(</mo><mi id="S2.p5.1.m1.1.1" xref="S2.p5.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S2.p5.1.m1.1.2.3.2.2" xref="S2.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.1b"><apply id="S2.p5.1.m1.1.2.cmml" xref="S2.p5.1.m1.1.2"><times id="S2.p5.1.m1.1.2.1.cmml" xref="S2.p5.1.m1.1.2.1"></times><apply id="S2.p5.1.m1.1.2.2.cmml" xref="S2.p5.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.p5.1.m1.1.2.2.1.cmml" xref="S2.p5.1.m1.1.2.2">subscript</csymbol><ci id="S2.p5.1.m1.1.2.2.2.cmml" xref="S2.p5.1.m1.1.2.2.2">𝛼</ci><ci id="S2.p5.1.m1.1.2.2.3.cmml" xref="S2.p5.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.p5.1.m1.1.1.cmml" xref="S2.p5.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.1c">\alpha_{i}(x)</annotation></semantics></math> is called a gating function in the MoE literature.
In our experiments, we set <math id="S2.p5.2.m2.2" class="ltx_Math" alttext="\alpha_{i}(x)=\sigma(w_{i}^{T}\cdot x+b_{i})" display="inline"><semantics id="S2.p5.2.m2.2a"><mrow id="S2.p5.2.m2.2.2" xref="S2.p5.2.m2.2.2.cmml"><mrow id="S2.p5.2.m2.2.2.3" xref="S2.p5.2.m2.2.2.3.cmml"><msub id="S2.p5.2.m2.2.2.3.2" xref="S2.p5.2.m2.2.2.3.2.cmml"><mi id="S2.p5.2.m2.2.2.3.2.2" xref="S2.p5.2.m2.2.2.3.2.2.cmml">α</mi><mi id="S2.p5.2.m2.2.2.3.2.3" xref="S2.p5.2.m2.2.2.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.p5.2.m2.2.2.3.1" xref="S2.p5.2.m2.2.2.3.1.cmml">​</mo><mrow id="S2.p5.2.m2.2.2.3.3.2" xref="S2.p5.2.m2.2.2.3.cmml"><mo stretchy="false" id="S2.p5.2.m2.2.2.3.3.2.1" xref="S2.p5.2.m2.2.2.3.cmml">(</mo><mi id="S2.p5.2.m2.1.1" xref="S2.p5.2.m2.1.1.cmml">x</mi><mo stretchy="false" id="S2.p5.2.m2.2.2.3.3.2.2" xref="S2.p5.2.m2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.p5.2.m2.2.2.2" xref="S2.p5.2.m2.2.2.2.cmml">=</mo><mrow id="S2.p5.2.m2.2.2.1" xref="S2.p5.2.m2.2.2.1.cmml"><mi id="S2.p5.2.m2.2.2.1.3" xref="S2.p5.2.m2.2.2.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.p5.2.m2.2.2.1.2" xref="S2.p5.2.m2.2.2.1.2.cmml">​</mo><mrow id="S2.p5.2.m2.2.2.1.1.1" xref="S2.p5.2.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.p5.2.m2.2.2.1.1.1.2" xref="S2.p5.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.p5.2.m2.2.2.1.1.1.1" xref="S2.p5.2.m2.2.2.1.1.1.1.cmml"><mrow id="S2.p5.2.m2.2.2.1.1.1.1.2" xref="S2.p5.2.m2.2.2.1.1.1.1.2.cmml"><msubsup id="S2.p5.2.m2.2.2.1.1.1.1.2.2" xref="S2.p5.2.m2.2.2.1.1.1.1.2.2.cmml"><mi id="S2.p5.2.m2.2.2.1.1.1.1.2.2.2.2" xref="S2.p5.2.m2.2.2.1.1.1.1.2.2.2.2.cmml">w</mi><mi id="S2.p5.2.m2.2.2.1.1.1.1.2.2.2.3" xref="S2.p5.2.m2.2.2.1.1.1.1.2.2.2.3.cmml">i</mi><mi id="S2.p5.2.m2.2.2.1.1.1.1.2.2.3" xref="S2.p5.2.m2.2.2.1.1.1.1.2.2.3.cmml">T</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S2.p5.2.m2.2.2.1.1.1.1.2.1" xref="S2.p5.2.m2.2.2.1.1.1.1.2.1.cmml">⋅</mo><mi id="S2.p5.2.m2.2.2.1.1.1.1.2.3" xref="S2.p5.2.m2.2.2.1.1.1.1.2.3.cmml">x</mi></mrow><mo id="S2.p5.2.m2.2.2.1.1.1.1.1" xref="S2.p5.2.m2.2.2.1.1.1.1.1.cmml">+</mo><msub id="S2.p5.2.m2.2.2.1.1.1.1.3" xref="S2.p5.2.m2.2.2.1.1.1.1.3.cmml"><mi id="S2.p5.2.m2.2.2.1.1.1.1.3.2" xref="S2.p5.2.m2.2.2.1.1.1.1.3.2.cmml">b</mi><mi id="S2.p5.2.m2.2.2.1.1.1.1.3.3" xref="S2.p5.2.m2.2.2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S2.p5.2.m2.2.2.1.1.1.3" xref="S2.p5.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.2.m2.2b"><apply id="S2.p5.2.m2.2.2.cmml" xref="S2.p5.2.m2.2.2"><eq id="S2.p5.2.m2.2.2.2.cmml" xref="S2.p5.2.m2.2.2.2"></eq><apply id="S2.p5.2.m2.2.2.3.cmml" xref="S2.p5.2.m2.2.2.3"><times id="S2.p5.2.m2.2.2.3.1.cmml" xref="S2.p5.2.m2.2.2.3.1"></times><apply id="S2.p5.2.m2.2.2.3.2.cmml" xref="S2.p5.2.m2.2.2.3.2"><csymbol cd="ambiguous" id="S2.p5.2.m2.2.2.3.2.1.cmml" xref="S2.p5.2.m2.2.2.3.2">subscript</csymbol><ci id="S2.p5.2.m2.2.2.3.2.2.cmml" xref="S2.p5.2.m2.2.2.3.2.2">𝛼</ci><ci id="S2.p5.2.m2.2.2.3.2.3.cmml" xref="S2.p5.2.m2.2.2.3.2.3">𝑖</ci></apply><ci id="S2.p5.2.m2.1.1.cmml" xref="S2.p5.2.m2.1.1">𝑥</ci></apply><apply id="S2.p5.2.m2.2.2.1.cmml" xref="S2.p5.2.m2.2.2.1"><times id="S2.p5.2.m2.2.2.1.2.cmml" xref="S2.p5.2.m2.2.2.1.2"></times><ci id="S2.p5.2.m2.2.2.1.3.cmml" xref="S2.p5.2.m2.2.2.1.3">𝜎</ci><apply id="S2.p5.2.m2.2.2.1.1.1.1.cmml" xref="S2.p5.2.m2.2.2.1.1.1"><plus id="S2.p5.2.m2.2.2.1.1.1.1.1.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.1"></plus><apply id="S2.p5.2.m2.2.2.1.1.1.1.2.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.2"><ci id="S2.p5.2.m2.2.2.1.1.1.1.2.1.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.2.1">⋅</ci><apply id="S2.p5.2.m2.2.2.1.1.1.1.2.2.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.p5.2.m2.2.2.1.1.1.1.2.2.1.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.2.2">superscript</csymbol><apply id="S2.p5.2.m2.2.2.1.1.1.1.2.2.2.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.p5.2.m2.2.2.1.1.1.1.2.2.2.1.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="S2.p5.2.m2.2.2.1.1.1.1.2.2.2.2.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.2.2.2.2">𝑤</ci><ci id="S2.p5.2.m2.2.2.1.1.1.1.2.2.2.3.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S2.p5.2.m2.2.2.1.1.1.1.2.2.3.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.2.2.3">𝑇</ci></apply><ci id="S2.p5.2.m2.2.2.1.1.1.1.2.3.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.2.3">𝑥</ci></apply><apply id="S2.p5.2.m2.2.2.1.1.1.1.3.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p5.2.m2.2.2.1.1.1.1.3.1.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.p5.2.m2.2.2.1.1.1.1.3.2.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.3.2">𝑏</ci><ci id="S2.p5.2.m2.2.2.1.1.1.1.3.3.cmml" xref="S2.p5.2.m2.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.2.m2.2c">\alpha_{i}(x)=\sigma(w_{i}^{T}\cdot x+b_{i})</annotation></semantics></math>,
where <math id="S2.p5.3.m3.1" class="ltx_Math" alttext="\sigma(x)" display="inline"><semantics id="S2.p5.3.m3.1a"><mrow id="S2.p5.3.m3.1.2" xref="S2.p5.3.m3.1.2.cmml"><mi id="S2.p5.3.m3.1.2.2" xref="S2.p5.3.m3.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.p5.3.m3.1.2.1" xref="S2.p5.3.m3.1.2.1.cmml">​</mo><mrow id="S2.p5.3.m3.1.2.3.2" xref="S2.p5.3.m3.1.2.cmml"><mo stretchy="false" id="S2.p5.3.m3.1.2.3.2.1" xref="S2.p5.3.m3.1.2.cmml">(</mo><mi id="S2.p5.3.m3.1.1" xref="S2.p5.3.m3.1.1.cmml">x</mi><mo stretchy="false" id="S2.p5.3.m3.1.2.3.2.2" xref="S2.p5.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.3.m3.1b"><apply id="S2.p5.3.m3.1.2.cmml" xref="S2.p5.3.m3.1.2"><times id="S2.p5.3.m3.1.2.1.cmml" xref="S2.p5.3.m3.1.2.1"></times><ci id="S2.p5.3.m3.1.2.2.cmml" xref="S2.p5.3.m3.1.2.2">𝜎</ci><ci id="S2.p5.3.m3.1.1.cmml" xref="S2.p5.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.3.m3.1c">\sigma(x)</annotation></semantics></math> is the sigmoid function, and <math id="S2.p5.4.m4.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S2.p5.4.m4.1a"><msub id="S2.p5.4.m4.1.1" xref="S2.p5.4.m4.1.1.cmml"><mi id="S2.p5.4.m4.1.1.2" xref="S2.p5.4.m4.1.1.2.cmml">w</mi><mi id="S2.p5.4.m4.1.1.3" xref="S2.p5.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p5.4.m4.1b"><apply id="S2.p5.4.m4.1.1.cmml" xref="S2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p5.4.m4.1.1.1.cmml" xref="S2.p5.4.m4.1.1">subscript</csymbol><ci id="S2.p5.4.m4.1.1.2.cmml" xref="S2.p5.4.m4.1.1.2">𝑤</ci><ci id="S2.p5.4.m4.1.1.3.cmml" xref="S2.p5.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.4.m4.1c">w_{i}</annotation></semantics></math> and <math id="S2.p5.5.m5.1" class="ltx_Math" alttext="b_{i}" display="inline"><semantics id="S2.p5.5.m5.1a"><msub id="S2.p5.5.m5.1.1" xref="S2.p5.5.m5.1.1.cmml"><mi id="S2.p5.5.m5.1.1.2" xref="S2.p5.5.m5.1.1.2.cmml">b</mi><mi id="S2.p5.5.m5.1.1.3" xref="S2.p5.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p5.5.m5.1b"><apply id="S2.p5.5.m5.1.1.cmml" xref="S2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p5.5.m5.1.1.1.cmml" xref="S2.p5.5.m5.1.1">subscript</csymbol><ci id="S2.p5.5.m5.1.1.2.cmml" xref="S2.p5.5.m5.1.1.2">𝑏</ci><ci id="S2.p5.5.m5.1.1.3.cmml" xref="S2.p5.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.5.m5.1c">b_{i}</annotation></semantics></math> are
learned weights. This gating function learns which regions to trust the private model over the general model,
and allows smooth mixing along the boundary.
Thus the final output
<math id="S2.p5.6.m6.1" class="ltx_Math" alttext="\hat{y_{i}}" display="inline"><semantics id="S2.p5.6.m6.1a"><mover accent="true" id="S2.p5.6.m6.1.1" xref="S2.p5.6.m6.1.1.cmml"><msub id="S2.p5.6.m6.1.1.2" xref="S2.p5.6.m6.1.1.2.cmml"><mi id="S2.p5.6.m6.1.1.2.2" xref="S2.p5.6.m6.1.1.2.2.cmml">y</mi><mi id="S2.p5.6.m6.1.1.2.3" xref="S2.p5.6.m6.1.1.2.3.cmml">i</mi></msub><mo id="S2.p5.6.m6.1.1.1" xref="S2.p5.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.p5.6.m6.1b"><apply id="S2.p5.6.m6.1.1.cmml" xref="S2.p5.6.m6.1.1"><ci id="S2.p5.6.m6.1.1.1.cmml" xref="S2.p5.6.m6.1.1.1">^</ci><apply id="S2.p5.6.m6.1.1.2.cmml" xref="S2.p5.6.m6.1.1.2"><csymbol cd="ambiguous" id="S2.p5.6.m6.1.1.2.1.cmml" xref="S2.p5.6.m6.1.1.2">subscript</csymbol><ci id="S2.p5.6.m6.1.1.2.2.cmml" xref="S2.p5.6.m6.1.1.2.2">𝑦</ci><ci id="S2.p5.6.m6.1.1.2.3.cmml" xref="S2.p5.6.m6.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.6.m6.1c">\hat{y_{i}}</annotation></semantics></math> depends on learned parameters <math id="S2.p5.7.m7.1" class="ltx_Math" alttext="\Theta_{G}" display="inline"><semantics id="S2.p5.7.m7.1a"><msub id="S2.p5.7.m7.1.1" xref="S2.p5.7.m7.1.1.cmml"><mi mathvariant="normal" id="S2.p5.7.m7.1.1.2" xref="S2.p5.7.m7.1.1.2.cmml">Θ</mi><mi id="S2.p5.7.m7.1.1.3" xref="S2.p5.7.m7.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p5.7.m7.1b"><apply id="S2.p5.7.m7.1.1.cmml" xref="S2.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p5.7.m7.1.1.1.cmml" xref="S2.p5.7.m7.1.1">subscript</csymbol><ci id="S2.p5.7.m7.1.1.2.cmml" xref="S2.p5.7.m7.1.1.2">Θ</ci><ci id="S2.p5.7.m7.1.1.3.cmml" xref="S2.p5.7.m7.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.7.m7.1c">\Theta_{G}</annotation></semantics></math>, <math id="S2.p5.8.m8.1" class="ltx_Math" alttext="\Theta_{P_{i}}" display="inline"><semantics id="S2.p5.8.m8.1a"><msub id="S2.p5.8.m8.1.1" xref="S2.p5.8.m8.1.1.cmml"><mi mathvariant="normal" id="S2.p5.8.m8.1.1.2" xref="S2.p5.8.m8.1.1.2.cmml">Θ</mi><msub id="S2.p5.8.m8.1.1.3" xref="S2.p5.8.m8.1.1.3.cmml"><mi id="S2.p5.8.m8.1.1.3.2" xref="S2.p5.8.m8.1.1.3.2.cmml">P</mi><mi id="S2.p5.8.m8.1.1.3.3" xref="S2.p5.8.m8.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.p5.8.m8.1b"><apply id="S2.p5.8.m8.1.1.cmml" xref="S2.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p5.8.m8.1.1.1.cmml" xref="S2.p5.8.m8.1.1">subscript</csymbol><ci id="S2.p5.8.m8.1.1.2.cmml" xref="S2.p5.8.m8.1.1.2">Θ</ci><apply id="S2.p5.8.m8.1.1.3.cmml" xref="S2.p5.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.p5.8.m8.1.1.3.1.cmml" xref="S2.p5.8.m8.1.1.3">subscript</csymbol><ci id="S2.p5.8.m8.1.1.3.2.cmml" xref="S2.p5.8.m8.1.1.3.2">𝑃</ci><ci id="S2.p5.8.m8.1.1.3.3.cmml" xref="S2.p5.8.m8.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.8.m8.1c">\Theta_{P_{i}}</annotation></semantics></math>,
<math id="S2.p5.9.m9.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S2.p5.9.m9.1a"><msub id="S2.p5.9.m9.1.1" xref="S2.p5.9.m9.1.1.cmml"><mi id="S2.p5.9.m9.1.1.2" xref="S2.p5.9.m9.1.1.2.cmml">w</mi><mi id="S2.p5.9.m9.1.1.3" xref="S2.p5.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p5.9.m9.1b"><apply id="S2.p5.9.m9.1.1.cmml" xref="S2.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S2.p5.9.m9.1.1.1.cmml" xref="S2.p5.9.m9.1.1">subscript</csymbol><ci id="S2.p5.9.m9.1.1.2.cmml" xref="S2.p5.9.m9.1.1.2">𝑤</ci><ci id="S2.p5.9.m9.1.1.3.cmml" xref="S2.p5.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.9.m9.1c">w_{i}</annotation></semantics></math>, and <math id="S2.p5.10.m10.1" class="ltx_Math" alttext="b_{i}" display="inline"><semantics id="S2.p5.10.m10.1a"><msub id="S2.p5.10.m10.1.1" xref="S2.p5.10.m10.1.1.cmml"><mi id="S2.p5.10.m10.1.1.2" xref="S2.p5.10.m10.1.1.2.cmml">b</mi><mi id="S2.p5.10.m10.1.1.3" xref="S2.p5.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p5.10.m10.1b"><apply id="S2.p5.10.m10.1.1.cmml" xref="S2.p5.10.m10.1.1"><csymbol cd="ambiguous" id="S2.p5.10.m10.1.1.1.cmml" xref="S2.p5.10.m10.1.1">subscript</csymbol><ci id="S2.p5.10.m10.1.1.2.cmml" xref="S2.p5.10.m10.1.1.2">𝑏</ci><ci id="S2.p5.10.m10.1.1.3.cmml" xref="S2.p5.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.10.m10.1c">b_{i}</annotation></semantics></math>, and all are updated via SGD.</p>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.2" class="ltx_p">The private model <math id="S2.p6.1.m1.1" class="ltx_Math" alttext="M_{P_{i}}" display="inline"><semantics id="S2.p6.1.m1.1a"><msub id="S2.p6.1.m1.1.1" xref="S2.p6.1.m1.1.1.cmml"><mi id="S2.p6.1.m1.1.1.2" xref="S2.p6.1.m1.1.1.2.cmml">M</mi><msub id="S2.p6.1.m1.1.1.3" xref="S2.p6.1.m1.1.1.3.cmml"><mi id="S2.p6.1.m1.1.1.3.2" xref="S2.p6.1.m1.1.1.3.2.cmml">P</mi><mi id="S2.p6.1.m1.1.1.3.3" xref="S2.p6.1.m1.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.1b"><apply id="S2.p6.1.m1.1.1.cmml" xref="S2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p6.1.m1.1.1.1.cmml" xref="S2.p6.1.m1.1.1">subscript</csymbol><ci id="S2.p6.1.m1.1.1.2.cmml" xref="S2.p6.1.m1.1.1.2">𝑀</ci><apply id="S2.p6.1.m1.1.1.3.cmml" xref="S2.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p6.1.m1.1.1.3.1.cmml" xref="S2.p6.1.m1.1.1.3">subscript</csymbol><ci id="S2.p6.1.m1.1.1.3.2.cmml" xref="S2.p6.1.m1.1.1.3.2">𝑃</ci><ci id="S2.p6.1.m1.1.1.3.3.cmml" xref="S2.p6.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.1.m1.1c">M_{P_{i}}</annotation></semantics></math> and weighting mechanism <math id="S2.p6.2.m2.1" class="ltx_Math" alttext="\alpha_{i}" display="inline"><semantics id="S2.p6.2.m2.1a"><msub id="S2.p6.2.m2.1.1" xref="S2.p6.2.m2.1.1.cmml"><mi id="S2.p6.2.m2.1.1.2" xref="S2.p6.2.m2.1.1.2.cmml">α</mi><mi id="S2.p6.2.m2.1.1.3" xref="S2.p6.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.2.m2.1b"><apply id="S2.p6.2.m2.1.1.cmml" xref="S2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p6.2.m2.1.1.1.cmml" xref="S2.p6.2.m2.1.1">subscript</csymbol><ci id="S2.p6.2.m2.1.1.2.cmml" xref="S2.p6.2.m2.1.1.2">𝛼</ci><ci id="S2.p6.2.m2.1.1.3.cmml" xref="S2.p6.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.2.m2.1c">\alpha_{i}</annotation></semantics></math> work
together to provide a significant benefit
over differentially private FL. First, by allowing individual domain adapatation,
they boost accuracy. Second, because they allow noise-free updates, they
prevent the accuracy loss associated with more stringent privacy requirements,
which add noise to the general model.</p>
</div>
<div id="S2.p7" class="ltx_para">
<p id="S2.p7.2" class="ltx_p">Over time, a user’s gating function
<math id="S2.p7.1.m1.1" class="ltx_Math" alttext="\alpha_{i}(x)" display="inline"><semantics id="S2.p7.1.m1.1a"><mrow id="S2.p7.1.m1.1.2" xref="S2.p7.1.m1.1.2.cmml"><msub id="S2.p7.1.m1.1.2.2" xref="S2.p7.1.m1.1.2.2.cmml"><mi id="S2.p7.1.m1.1.2.2.2" xref="S2.p7.1.m1.1.2.2.2.cmml">α</mi><mi id="S2.p7.1.m1.1.2.2.3" xref="S2.p7.1.m1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.p7.1.m1.1.2.1" xref="S2.p7.1.m1.1.2.1.cmml">​</mo><mrow id="S2.p7.1.m1.1.2.3.2" xref="S2.p7.1.m1.1.2.cmml"><mo stretchy="false" id="S2.p7.1.m1.1.2.3.2.1" xref="S2.p7.1.m1.1.2.cmml">(</mo><mi id="S2.p7.1.m1.1.1" xref="S2.p7.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S2.p7.1.m1.1.2.3.2.2" xref="S2.p7.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p7.1.m1.1b"><apply id="S2.p7.1.m1.1.2.cmml" xref="S2.p7.1.m1.1.2"><times id="S2.p7.1.m1.1.2.1.cmml" xref="S2.p7.1.m1.1.2.1"></times><apply id="S2.p7.1.m1.1.2.2.cmml" xref="S2.p7.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.p7.1.m1.1.2.2.1.cmml" xref="S2.p7.1.m1.1.2.2">subscript</csymbol><ci id="S2.p7.1.m1.1.2.2.2.cmml" xref="S2.p7.1.m1.1.2.2.2">𝛼</ci><ci id="S2.p7.1.m1.1.2.2.3.cmml" xref="S2.p7.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.p7.1.m1.1.1.cmml" xref="S2.p7.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.1.m1.1c">\alpha_{i}(x)</annotation></semantics></math> learns whether to trust the general model or the private model
more for a given input, and the private model <math id="S2.p7.2.m2.1" class="ltx_Math" alttext="M_{P_{i}}" display="inline"><semantics id="S2.p7.2.m2.1a"><msub id="S2.p7.2.m2.1.1" xref="S2.p7.2.m2.1.1.cmml"><mi id="S2.p7.2.m2.1.1.2" xref="S2.p7.2.m2.1.1.2.cmml">M</mi><msub id="S2.p7.2.m2.1.1.3" xref="S2.p7.2.m2.1.1.3.cmml"><mi id="S2.p7.2.m2.1.1.3.2" xref="S2.p7.2.m2.1.1.3.2.cmml">P</mi><mi id="S2.p7.2.m2.1.1.3.3" xref="S2.p7.2.m2.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.p7.2.m2.1b"><apply id="S2.p7.2.m2.1.1.cmml" xref="S2.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p7.2.m2.1.1.1.cmml" xref="S2.p7.2.m2.1.1">subscript</csymbol><ci id="S2.p7.2.m2.1.1.2.cmml" xref="S2.p7.2.m2.1.1.2">𝑀</ci><apply id="S2.p7.2.m2.1.1.3.cmml" xref="S2.p7.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.p7.2.m2.1.1.3.1.cmml" xref="S2.p7.2.m2.1.1.3">subscript</csymbol><ci id="S2.p7.2.m2.1.1.3.2.cmml" xref="S2.p7.2.m2.1.1.3.2">𝑃</ci><ci id="S2.p7.2.m2.1.1.3.3.cmml" xref="S2.p7.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.2.m2.1c">M_{P_{i}}</annotation></semantics></math> needs to perform
well on only the subset of points for which the general model fails.
While the general model still benefits from the pooled training data,
it receives weaker updates on these “private” data points. This means
users with unusual domains have a smaller effect on the general model,
which may increase its ability to generalize <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib14" title="" class="ltx_ref">14</a>)</cite>.
This may also provide increased privacy for the users’ data.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Evaluation</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The main hypothesis of this work is that domain adaptation techniques can
improve accuracy in a federated learning setting, and that this accuracy
improvement holds even when noise is added to protect the privacy
of the gradient updates.
We illustrate the effectiveness of our domain adaptation technique on two
datasets.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.5" class="ltx_p">The first dataset is a synthetic regression problem. Two users attempt
to fit a linear model of the function <math id="S3.p2.1.m1.2" class="ltx_Math" alttext="f(x_{1},x_{2})=5x_{1}-2x_{2}+0.5x_{2}^{3}" display="inline"><semantics id="S3.p2.1.m1.2a"><mrow id="S3.p2.1.m1.2.2" xref="S3.p2.1.m1.2.2.cmml"><mrow id="S3.p2.1.m1.2.2.2" xref="S3.p2.1.m1.2.2.2.cmml"><mi id="S3.p2.1.m1.2.2.2.4" xref="S3.p2.1.m1.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.2.2.2.3" xref="S3.p2.1.m1.2.2.2.3.cmml">​</mo><mrow id="S3.p2.1.m1.2.2.2.2.2" xref="S3.p2.1.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.p2.1.m1.2.2.2.2.2.3" xref="S3.p2.1.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.p2.1.m1.1.1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.1.1.1.2.cmml">x</mi><mn id="S3.p2.1.m1.1.1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.p2.1.m1.2.2.2.2.2.4" xref="S3.p2.1.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.p2.1.m1.2.2.2.2.2.2" xref="S3.p2.1.m1.2.2.2.2.2.2.cmml"><mi id="S3.p2.1.m1.2.2.2.2.2.2.2" xref="S3.p2.1.m1.2.2.2.2.2.2.2.cmml">x</mi><mn id="S3.p2.1.m1.2.2.2.2.2.2.3" xref="S3.p2.1.m1.2.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.p2.1.m1.2.2.2.2.2.5" xref="S3.p2.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.p2.1.m1.2.2.3" xref="S3.p2.1.m1.2.2.3.cmml">=</mo><mrow id="S3.p2.1.m1.2.2.4" xref="S3.p2.1.m1.2.2.4.cmml"><mrow id="S3.p2.1.m1.2.2.4.2" xref="S3.p2.1.m1.2.2.4.2.cmml"><mrow id="S3.p2.1.m1.2.2.4.2.2" xref="S3.p2.1.m1.2.2.4.2.2.cmml"><mn id="S3.p2.1.m1.2.2.4.2.2.2" xref="S3.p2.1.m1.2.2.4.2.2.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.2.2.4.2.2.1" xref="S3.p2.1.m1.2.2.4.2.2.1.cmml">​</mo><msub id="S3.p2.1.m1.2.2.4.2.2.3" xref="S3.p2.1.m1.2.2.4.2.2.3.cmml"><mi id="S3.p2.1.m1.2.2.4.2.2.3.2" xref="S3.p2.1.m1.2.2.4.2.2.3.2.cmml">x</mi><mn id="S3.p2.1.m1.2.2.4.2.2.3.3" xref="S3.p2.1.m1.2.2.4.2.2.3.3.cmml">1</mn></msub></mrow><mo id="S3.p2.1.m1.2.2.4.2.1" xref="S3.p2.1.m1.2.2.4.2.1.cmml">−</mo><mrow id="S3.p2.1.m1.2.2.4.2.3" xref="S3.p2.1.m1.2.2.4.2.3.cmml"><mn id="S3.p2.1.m1.2.2.4.2.3.2" xref="S3.p2.1.m1.2.2.4.2.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.2.2.4.2.3.1" xref="S3.p2.1.m1.2.2.4.2.3.1.cmml">​</mo><msub id="S3.p2.1.m1.2.2.4.2.3.3" xref="S3.p2.1.m1.2.2.4.2.3.3.cmml"><mi id="S3.p2.1.m1.2.2.4.2.3.3.2" xref="S3.p2.1.m1.2.2.4.2.3.3.2.cmml">x</mi><mn id="S3.p2.1.m1.2.2.4.2.3.3.3" xref="S3.p2.1.m1.2.2.4.2.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.p2.1.m1.2.2.4.1" xref="S3.p2.1.m1.2.2.4.1.cmml">+</mo><mrow id="S3.p2.1.m1.2.2.4.3" xref="S3.p2.1.m1.2.2.4.3.cmml"><mn id="S3.p2.1.m1.2.2.4.3.2" xref="S3.p2.1.m1.2.2.4.3.2.cmml">0.5</mn><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.2.2.4.3.1" xref="S3.p2.1.m1.2.2.4.3.1.cmml">​</mo><msubsup id="S3.p2.1.m1.2.2.4.3.3" xref="S3.p2.1.m1.2.2.4.3.3.cmml"><mi id="S3.p2.1.m1.2.2.4.3.3.2.2" xref="S3.p2.1.m1.2.2.4.3.3.2.2.cmml">x</mi><mn id="S3.p2.1.m1.2.2.4.3.3.2.3" xref="S3.p2.1.m1.2.2.4.3.3.2.3.cmml">2</mn><mn id="S3.p2.1.m1.2.2.4.3.3.3" xref="S3.p2.1.m1.2.2.4.3.3.3.cmml">3</mn></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.2b"><apply id="S3.p2.1.m1.2.2.cmml" xref="S3.p2.1.m1.2.2"><eq id="S3.p2.1.m1.2.2.3.cmml" xref="S3.p2.1.m1.2.2.3"></eq><apply id="S3.p2.1.m1.2.2.2.cmml" xref="S3.p2.1.m1.2.2.2"><times id="S3.p2.1.m1.2.2.2.3.cmml" xref="S3.p2.1.m1.2.2.2.3"></times><ci id="S3.p2.1.m1.2.2.2.4.cmml" xref="S3.p2.1.m1.2.2.2.4">𝑓</ci><interval closure="open" id="S3.p2.1.m1.2.2.2.2.3.cmml" xref="S3.p2.1.m1.2.2.2.2.2"><apply id="S3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="S3.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.p2.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.p2.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p2.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.p2.1.m1.2.2.2.2.2.2.2">𝑥</ci><cn type="integer" id="S3.p2.1.m1.2.2.2.2.2.2.3.cmml" xref="S3.p2.1.m1.2.2.2.2.2.2.3">2</cn></apply></interval></apply><apply id="S3.p2.1.m1.2.2.4.cmml" xref="S3.p2.1.m1.2.2.4"><plus id="S3.p2.1.m1.2.2.4.1.cmml" xref="S3.p2.1.m1.2.2.4.1"></plus><apply id="S3.p2.1.m1.2.2.4.2.cmml" xref="S3.p2.1.m1.2.2.4.2"><minus id="S3.p2.1.m1.2.2.4.2.1.cmml" xref="S3.p2.1.m1.2.2.4.2.1"></minus><apply id="S3.p2.1.m1.2.2.4.2.2.cmml" xref="S3.p2.1.m1.2.2.4.2.2"><times id="S3.p2.1.m1.2.2.4.2.2.1.cmml" xref="S3.p2.1.m1.2.2.4.2.2.1"></times><cn type="integer" id="S3.p2.1.m1.2.2.4.2.2.2.cmml" xref="S3.p2.1.m1.2.2.4.2.2.2">5</cn><apply id="S3.p2.1.m1.2.2.4.2.2.3.cmml" xref="S3.p2.1.m1.2.2.4.2.2.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.4.2.2.3.1.cmml" xref="S3.p2.1.m1.2.2.4.2.2.3">subscript</csymbol><ci id="S3.p2.1.m1.2.2.4.2.2.3.2.cmml" xref="S3.p2.1.m1.2.2.4.2.2.3.2">𝑥</ci><cn type="integer" id="S3.p2.1.m1.2.2.4.2.2.3.3.cmml" xref="S3.p2.1.m1.2.2.4.2.2.3.3">1</cn></apply></apply><apply id="S3.p2.1.m1.2.2.4.2.3.cmml" xref="S3.p2.1.m1.2.2.4.2.3"><times id="S3.p2.1.m1.2.2.4.2.3.1.cmml" xref="S3.p2.1.m1.2.2.4.2.3.1"></times><cn type="integer" id="S3.p2.1.m1.2.2.4.2.3.2.cmml" xref="S3.p2.1.m1.2.2.4.2.3.2">2</cn><apply id="S3.p2.1.m1.2.2.4.2.3.3.cmml" xref="S3.p2.1.m1.2.2.4.2.3.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.4.2.3.3.1.cmml" xref="S3.p2.1.m1.2.2.4.2.3.3">subscript</csymbol><ci id="S3.p2.1.m1.2.2.4.2.3.3.2.cmml" xref="S3.p2.1.m1.2.2.4.2.3.3.2">𝑥</ci><cn type="integer" id="S3.p2.1.m1.2.2.4.2.3.3.3.cmml" xref="S3.p2.1.m1.2.2.4.2.3.3.3">2</cn></apply></apply></apply><apply id="S3.p2.1.m1.2.2.4.3.cmml" xref="S3.p2.1.m1.2.2.4.3"><times id="S3.p2.1.m1.2.2.4.3.1.cmml" xref="S3.p2.1.m1.2.2.4.3.1"></times><cn type="float" id="S3.p2.1.m1.2.2.4.3.2.cmml" xref="S3.p2.1.m1.2.2.4.3.2">0.5</cn><apply id="S3.p2.1.m1.2.2.4.3.3.cmml" xref="S3.p2.1.m1.2.2.4.3.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.4.3.3.1.cmml" xref="S3.p2.1.m1.2.2.4.3.3">superscript</csymbol><apply id="S3.p2.1.m1.2.2.4.3.3.2.cmml" xref="S3.p2.1.m1.2.2.4.3.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.4.3.3.2.1.cmml" xref="S3.p2.1.m1.2.2.4.3.3">subscript</csymbol><ci id="S3.p2.1.m1.2.2.4.3.3.2.2.cmml" xref="S3.p2.1.m1.2.2.4.3.3.2.2">𝑥</ci><cn type="integer" id="S3.p2.1.m1.2.2.4.3.3.2.3.cmml" xref="S3.p2.1.m1.2.2.4.3.3.2.3">2</cn></apply><cn type="integer" id="S3.p2.1.m1.2.2.4.3.3.3.cmml" xref="S3.p2.1.m1.2.2.4.3.3.3">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.2c">f(x_{1},x_{2})=5x_{1}-2x_{2}+0.5x_{2}^{3}</annotation></semantics></math>.
Each has input data drawn from a distinct 2-dimensional Gaussian, and because
of these domain differences, they get different exposure to the nonlinear
<math id="S3.p2.2.m2.1" class="ltx_Math" alttext="x_{2}^{3}" display="inline"><semantics id="S3.p2.2.m2.1a"><msubsup id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2.2" xref="S3.p2.2.m2.1.1.2.2.cmml">x</mi><mn id="S3.p2.2.m2.1.1.2.3" xref="S3.p2.2.m2.1.1.2.3.cmml">2</mn><mn id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">3</mn></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">superscript</csymbol><apply id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.2.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.2.cmml" xref="S3.p2.2.m2.1.1.2.2">𝑥</ci><cn type="integer" id="S3.p2.2.m2.1.1.2.3.cmml" xref="S3.p2.2.m2.1.1.2.3">2</cn></apply><cn type="integer" id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">x_{2}^{3}</annotation></semantics></math> term. We draw 2500 training examples, 500 validation examples, and 500
test examples for each user, all from that user’s 2d Gaussian, then compute <math id="S3.p2.3.m3.2" class="ltx_Math" alttext="f(x_{1},x_{2})" display="inline"><semantics id="S3.p2.3.m3.2a"><mrow id="S3.p2.3.m3.2.2" xref="S3.p2.3.m3.2.2.cmml"><mi id="S3.p2.3.m3.2.2.4" xref="S3.p2.3.m3.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.p2.3.m3.2.2.3" xref="S3.p2.3.m3.2.2.3.cmml">​</mo><mrow id="S3.p2.3.m3.2.2.2.2" xref="S3.p2.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.p2.3.m3.2.2.2.2.3" xref="S3.p2.3.m3.2.2.2.3.cmml">(</mo><msub id="S3.p2.3.m3.1.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.p2.3.m3.1.1.1.1.1.2" xref="S3.p2.3.m3.1.1.1.1.1.2.cmml">x</mi><mn id="S3.p2.3.m3.1.1.1.1.1.3" xref="S3.p2.3.m3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.p2.3.m3.2.2.2.2.4" xref="S3.p2.3.m3.2.2.2.3.cmml">,</mo><msub id="S3.p2.3.m3.2.2.2.2.2" xref="S3.p2.3.m3.2.2.2.2.2.cmml"><mi id="S3.p2.3.m3.2.2.2.2.2.2" xref="S3.p2.3.m3.2.2.2.2.2.2.cmml">x</mi><mn id="S3.p2.3.m3.2.2.2.2.2.3" xref="S3.p2.3.m3.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.p2.3.m3.2.2.2.2.5" xref="S3.p2.3.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.2b"><apply id="S3.p2.3.m3.2.2.cmml" xref="S3.p2.3.m3.2.2"><times id="S3.p2.3.m3.2.2.3.cmml" xref="S3.p2.3.m3.2.2.3"></times><ci id="S3.p2.3.m3.2.2.4.cmml" xref="S3.p2.3.m3.2.2.4">𝑓</ci><interval closure="open" id="S3.p2.3.m3.2.2.2.3.cmml" xref="S3.p2.3.m3.2.2.2.2"><apply id="S3.p2.3.m3.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="S3.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.p2.3.m3.1.1.1.1.1.3">1</cn></apply><apply id="S3.p2.3.m3.2.2.2.2.2.cmml" xref="S3.p2.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.3.m3.2.2.2.2.2.1.cmml" xref="S3.p2.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.p2.3.m3.2.2.2.2.2.2.cmml" xref="S3.p2.3.m3.2.2.2.2.2.2">𝑥</ci><cn type="integer" id="S3.p2.3.m3.2.2.2.2.2.3.cmml" xref="S3.p2.3.m3.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.2c">f(x_{1},x_{2})</annotation></semantics></math>.
The users aim to minimize root mean squared error (RMSE) on the
test set. The baseline error is computed with each user fitting a
single linear model to their training data. We then compute RMSE for
each user if the users collaborate to build a single linear model
using FL, and augmenting FL with private domain experts (FL+DE).
Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Evaluation ‣ Private Federated Learning with Domain Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the synthetic data, the
target function, and the learned gating functions for both users.
To see the effects of differential privacy, we test with low noise (<math id="S3.p2.4.m4.1" class="ltx_Math" alttext="\sigma=2" display="inline"><semantics id="S3.p2.4.m4.1a"><mrow id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">σ</mi><mo id="S3.p2.4.m4.1.1.1" xref="S3.p2.4.m4.1.1.1.cmml">=</mo><mn id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><eq id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1"></eq><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝜎</ci><cn type="integer" id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">\sigma=2</annotation></semantics></math>)
and high noise (<math id="S3.p2.5.m5.1" class="ltx_Math" alttext="\sigma=4" display="inline"><semantics id="S3.p2.5.m5.1a"><mrow id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">σ</mi><mo id="S3.p2.5.m5.1.1.1" xref="S3.p2.5.m5.1.1.1.cmml">=</mo><mn id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><eq id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1.1"></eq><ci id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">𝜎</ci><cn type="integer" id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">\sigma=4</annotation></semantics></math>), following prior work <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib1" title="" class="ltx_ref">1</a>)</cite>.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">Test errors for the baseline, FL, FL+DE systems are provided in
Table <a href="#S3.F3" title="Figure 3 ‣ 3 Evaluation ‣ Private Federated Learning with Domain Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. FL+DE provides the best results of any model,
and graceful degradation compared to differentially-private FL as the noise increases.
FL alone provides a lower error for both users if there are no privacy concerns, but as we
increase the noise we apply to the gradient, we observe a dramatic
increase in error.
FL+DE is more expressive than a single linear model -
it learns a linear model and gating function for each user on top of the shared linear
model - so it is unsurprising that RMSE is lower when no noise is
added to the gradients. However, FL+DE does not suffer as much penalty
as FL when noise is added to the shared gradient updates.
In the worst case, the performance degrades only to the
baseline level (where each user has a linear model for its entire
dataset).</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/1912.06733/assets/synthetic_data.png" id="S3.F1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="100" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Visualizing the synthetic data experiment. Axes for all figures
represent input values for <math id="S3.F1.8.m1.1" class="ltx_Math" alttext="x_{1}" display="inline"><semantics id="S3.F1.8.m1.1b"><msub id="S3.F1.8.m1.1.1" xref="S3.F1.8.m1.1.1.cmml"><mi id="S3.F1.8.m1.1.1.2" xref="S3.F1.8.m1.1.1.2.cmml">x</mi><mn id="S3.F1.8.m1.1.1.3" xref="S3.F1.8.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F1.8.m1.1c"><apply id="S3.F1.8.m1.1.1.cmml" xref="S3.F1.8.m1.1.1"><csymbol cd="ambiguous" id="S3.F1.8.m1.1.1.1.cmml" xref="S3.F1.8.m1.1.1">subscript</csymbol><ci id="S3.F1.8.m1.1.1.2.cmml" xref="S3.F1.8.m1.1.1.2">𝑥</ci><cn type="integer" id="S3.F1.8.m1.1.1.3.cmml" xref="S3.F1.8.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.8.m1.1d">x_{1}</annotation></semantics></math> and <math id="S3.F1.9.m2.1" class="ltx_Math" alttext="x_{2}" display="inline"><semantics id="S3.F1.9.m2.1b"><msub id="S3.F1.9.m2.1.1" xref="S3.F1.9.m2.1.1.cmml"><mi id="S3.F1.9.m2.1.1.2" xref="S3.F1.9.m2.1.1.2.cmml">x</mi><mn id="S3.F1.9.m2.1.1.3" xref="S3.F1.9.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F1.9.m2.1c"><apply id="S3.F1.9.m2.1.1.cmml" xref="S3.F1.9.m2.1.1"><csymbol cd="ambiguous" id="S3.F1.9.m2.1.1.1.cmml" xref="S3.F1.9.m2.1.1">subscript</csymbol><ci id="S3.F1.9.m2.1.1.2.cmml" xref="S3.F1.9.m2.1.1.2">𝑥</ci><cn type="integer" id="S3.F1.9.m2.1.1.3.cmml" xref="S3.F1.9.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.9.m2.1d">x_{2}</annotation></semantics></math>. Left to right:
(a) <math id="S3.F1.10.m3.1" class="ltx_Math" alttext="x_{1}" display="inline"><semantics id="S3.F1.10.m3.1b"><msub id="S3.F1.10.m3.1.1" xref="S3.F1.10.m3.1.1.cmml"><mi id="S3.F1.10.m3.1.1.2" xref="S3.F1.10.m3.1.1.2.cmml">x</mi><mn id="S3.F1.10.m3.1.1.3" xref="S3.F1.10.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F1.10.m3.1c"><apply id="S3.F1.10.m3.1.1.cmml" xref="S3.F1.10.m3.1.1"><csymbol cd="ambiguous" id="S3.F1.10.m3.1.1.1.cmml" xref="S3.F1.10.m3.1.1">subscript</csymbol><ci id="S3.F1.10.m3.1.1.2.cmml" xref="S3.F1.10.m3.1.1.2">𝑥</ci><cn type="integer" id="S3.F1.10.m3.1.1.3.cmml" xref="S3.F1.10.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.10.m3.1d">x_{1}</annotation></semantics></math> and <math id="S3.F1.11.m4.1" class="ltx_Math" alttext="x_{2}" display="inline"><semantics id="S3.F1.11.m4.1b"><msub id="S3.F1.11.m4.1.1" xref="S3.F1.11.m4.1.1.cmml"><mi id="S3.F1.11.m4.1.1.2" xref="S3.F1.11.m4.1.1.2.cmml">x</mi><mn id="S3.F1.11.m4.1.1.3" xref="S3.F1.11.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F1.11.m4.1c"><apply id="S3.F1.11.m4.1.1.cmml" xref="S3.F1.11.m4.1.1"><csymbol cd="ambiguous" id="S3.F1.11.m4.1.1.1.cmml" xref="S3.F1.11.m4.1.1">subscript</csymbol><ci id="S3.F1.11.m4.1.1.2.cmml" xref="S3.F1.11.m4.1.1.2">𝑥</ci><cn type="integer" id="S3.F1.11.m4.1.1.3.cmml" xref="S3.F1.11.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.11.m4.1d">x_{2}</annotation></semantics></math> values of test data points sampled from distinct 2d Gaussians.
(b) Target values of nonlinear function <math id="S3.F1.12.m5.2" class="ltx_Math" alttext="f(x_{1},x_{2})" display="inline"><semantics id="S3.F1.12.m5.2b"><mrow id="S3.F1.12.m5.2.2" xref="S3.F1.12.m5.2.2.cmml"><mi id="S3.F1.12.m5.2.2.4" xref="S3.F1.12.m5.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.F1.12.m5.2.2.3" xref="S3.F1.12.m5.2.2.3.cmml">​</mo><mrow id="S3.F1.12.m5.2.2.2.2" xref="S3.F1.12.m5.2.2.2.3.cmml"><mo stretchy="false" id="S3.F1.12.m5.2.2.2.2.3" xref="S3.F1.12.m5.2.2.2.3.cmml">(</mo><msub id="S3.F1.12.m5.1.1.1.1.1" xref="S3.F1.12.m5.1.1.1.1.1.cmml"><mi id="S3.F1.12.m5.1.1.1.1.1.2" xref="S3.F1.12.m5.1.1.1.1.1.2.cmml">x</mi><mn id="S3.F1.12.m5.1.1.1.1.1.3" xref="S3.F1.12.m5.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.F1.12.m5.2.2.2.2.4" xref="S3.F1.12.m5.2.2.2.3.cmml">,</mo><msub id="S3.F1.12.m5.2.2.2.2.2" xref="S3.F1.12.m5.2.2.2.2.2.cmml"><mi id="S3.F1.12.m5.2.2.2.2.2.2" xref="S3.F1.12.m5.2.2.2.2.2.2.cmml">x</mi><mn id="S3.F1.12.m5.2.2.2.2.2.3" xref="S3.F1.12.m5.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.F1.12.m5.2.2.2.2.5" xref="S3.F1.12.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.12.m5.2c"><apply id="S3.F1.12.m5.2.2.cmml" xref="S3.F1.12.m5.2.2"><times id="S3.F1.12.m5.2.2.3.cmml" xref="S3.F1.12.m5.2.2.3"></times><ci id="S3.F1.12.m5.2.2.4.cmml" xref="S3.F1.12.m5.2.2.4">𝑓</ci><interval closure="open" id="S3.F1.12.m5.2.2.2.3.cmml" xref="S3.F1.12.m5.2.2.2.2"><apply id="S3.F1.12.m5.1.1.1.1.1.cmml" xref="S3.F1.12.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F1.12.m5.1.1.1.1.1.1.cmml" xref="S3.F1.12.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.F1.12.m5.1.1.1.1.1.2.cmml" xref="S3.F1.12.m5.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="S3.F1.12.m5.1.1.1.1.1.3.cmml" xref="S3.F1.12.m5.1.1.1.1.1.3">1</cn></apply><apply id="S3.F1.12.m5.2.2.2.2.2.cmml" xref="S3.F1.12.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.F1.12.m5.2.2.2.2.2.1.cmml" xref="S3.F1.12.m5.2.2.2.2.2">subscript</csymbol><ci id="S3.F1.12.m5.2.2.2.2.2.2.cmml" xref="S3.F1.12.m5.2.2.2.2.2.2">𝑥</ci><cn type="integer" id="S3.F1.12.m5.2.2.2.2.2.3.cmml" xref="S3.F1.12.m5.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.12.m5.2d">f(x_{1},x_{2})</annotation></semantics></math>.
(c) Values of the MoE gating function, <math id="S3.F1.13.m6.2" class="ltx_Math" alttext="\alpha_{1}(x_{1},x_{2})" display="inline"><semantics id="S3.F1.13.m6.2b"><mrow id="S3.F1.13.m6.2.2" xref="S3.F1.13.m6.2.2.cmml"><msub id="S3.F1.13.m6.2.2.4" xref="S3.F1.13.m6.2.2.4.cmml"><mi id="S3.F1.13.m6.2.2.4.2" xref="S3.F1.13.m6.2.2.4.2.cmml">α</mi><mn id="S3.F1.13.m6.2.2.4.3" xref="S3.F1.13.m6.2.2.4.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.F1.13.m6.2.2.3" xref="S3.F1.13.m6.2.2.3.cmml">​</mo><mrow id="S3.F1.13.m6.2.2.2.2" xref="S3.F1.13.m6.2.2.2.3.cmml"><mo stretchy="false" id="S3.F1.13.m6.2.2.2.2.3" xref="S3.F1.13.m6.2.2.2.3.cmml">(</mo><msub id="S3.F1.13.m6.1.1.1.1.1" xref="S3.F1.13.m6.1.1.1.1.1.cmml"><mi id="S3.F1.13.m6.1.1.1.1.1.2" xref="S3.F1.13.m6.1.1.1.1.1.2.cmml">x</mi><mn id="S3.F1.13.m6.1.1.1.1.1.3" xref="S3.F1.13.m6.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.F1.13.m6.2.2.2.2.4" xref="S3.F1.13.m6.2.2.2.3.cmml">,</mo><msub id="S3.F1.13.m6.2.2.2.2.2" xref="S3.F1.13.m6.2.2.2.2.2.cmml"><mi id="S3.F1.13.m6.2.2.2.2.2.2" xref="S3.F1.13.m6.2.2.2.2.2.2.cmml">x</mi><mn id="S3.F1.13.m6.2.2.2.2.2.3" xref="S3.F1.13.m6.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.F1.13.m6.2.2.2.2.5" xref="S3.F1.13.m6.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.13.m6.2c"><apply id="S3.F1.13.m6.2.2.cmml" xref="S3.F1.13.m6.2.2"><times id="S3.F1.13.m6.2.2.3.cmml" xref="S3.F1.13.m6.2.2.3"></times><apply id="S3.F1.13.m6.2.2.4.cmml" xref="S3.F1.13.m6.2.2.4"><csymbol cd="ambiguous" id="S3.F1.13.m6.2.2.4.1.cmml" xref="S3.F1.13.m6.2.2.4">subscript</csymbol><ci id="S3.F1.13.m6.2.2.4.2.cmml" xref="S3.F1.13.m6.2.2.4.2">𝛼</ci><cn type="integer" id="S3.F1.13.m6.2.2.4.3.cmml" xref="S3.F1.13.m6.2.2.4.3">1</cn></apply><interval closure="open" id="S3.F1.13.m6.2.2.2.3.cmml" xref="S3.F1.13.m6.2.2.2.2"><apply id="S3.F1.13.m6.1.1.1.1.1.cmml" xref="S3.F1.13.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F1.13.m6.1.1.1.1.1.1.cmml" xref="S3.F1.13.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.F1.13.m6.1.1.1.1.1.2.cmml" xref="S3.F1.13.m6.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="S3.F1.13.m6.1.1.1.1.1.3.cmml" xref="S3.F1.13.m6.1.1.1.1.1.3">1</cn></apply><apply id="S3.F1.13.m6.2.2.2.2.2.cmml" xref="S3.F1.13.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.F1.13.m6.2.2.2.2.2.1.cmml" xref="S3.F1.13.m6.2.2.2.2.2">subscript</csymbol><ci id="S3.F1.13.m6.2.2.2.2.2.2.cmml" xref="S3.F1.13.m6.2.2.2.2.2.2">𝑥</ci><cn type="integer" id="S3.F1.13.m6.2.2.2.2.2.3.cmml" xref="S3.F1.13.m6.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.13.m6.2d">\alpha_{1}(x_{1},x_{2})</annotation></semantics></math> learned by User 1. In the darker region,
the private domain expert is preferred, while the general model is preferred in the
lighter region.
(d) The gating function <math id="S3.F1.14.m7.2" class="ltx_Math" alttext="\alpha_{2}(x_{1},x_{2})" display="inline"><semantics id="S3.F1.14.m7.2b"><mrow id="S3.F1.14.m7.2.2" xref="S3.F1.14.m7.2.2.cmml"><msub id="S3.F1.14.m7.2.2.4" xref="S3.F1.14.m7.2.2.4.cmml"><mi id="S3.F1.14.m7.2.2.4.2" xref="S3.F1.14.m7.2.2.4.2.cmml">α</mi><mn id="S3.F1.14.m7.2.2.4.3" xref="S3.F1.14.m7.2.2.4.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.F1.14.m7.2.2.3" xref="S3.F1.14.m7.2.2.3.cmml">​</mo><mrow id="S3.F1.14.m7.2.2.2.2" xref="S3.F1.14.m7.2.2.2.3.cmml"><mo stretchy="false" id="S3.F1.14.m7.2.2.2.2.3" xref="S3.F1.14.m7.2.2.2.3.cmml">(</mo><msub id="S3.F1.14.m7.1.1.1.1.1" xref="S3.F1.14.m7.1.1.1.1.1.cmml"><mi id="S3.F1.14.m7.1.1.1.1.1.2" xref="S3.F1.14.m7.1.1.1.1.1.2.cmml">x</mi><mn id="S3.F1.14.m7.1.1.1.1.1.3" xref="S3.F1.14.m7.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.F1.14.m7.2.2.2.2.4" xref="S3.F1.14.m7.2.2.2.3.cmml">,</mo><msub id="S3.F1.14.m7.2.2.2.2.2" xref="S3.F1.14.m7.2.2.2.2.2.cmml"><mi id="S3.F1.14.m7.2.2.2.2.2.2" xref="S3.F1.14.m7.2.2.2.2.2.2.cmml">x</mi><mn id="S3.F1.14.m7.2.2.2.2.2.3" xref="S3.F1.14.m7.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.F1.14.m7.2.2.2.2.5" xref="S3.F1.14.m7.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.14.m7.2c"><apply id="S3.F1.14.m7.2.2.cmml" xref="S3.F1.14.m7.2.2"><times id="S3.F1.14.m7.2.2.3.cmml" xref="S3.F1.14.m7.2.2.3"></times><apply id="S3.F1.14.m7.2.2.4.cmml" xref="S3.F1.14.m7.2.2.4"><csymbol cd="ambiguous" id="S3.F1.14.m7.2.2.4.1.cmml" xref="S3.F1.14.m7.2.2.4">subscript</csymbol><ci id="S3.F1.14.m7.2.2.4.2.cmml" xref="S3.F1.14.m7.2.2.4.2">𝛼</ci><cn type="integer" id="S3.F1.14.m7.2.2.4.3.cmml" xref="S3.F1.14.m7.2.2.4.3">2</cn></apply><interval closure="open" id="S3.F1.14.m7.2.2.2.3.cmml" xref="S3.F1.14.m7.2.2.2.2"><apply id="S3.F1.14.m7.1.1.1.1.1.cmml" xref="S3.F1.14.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F1.14.m7.1.1.1.1.1.1.cmml" xref="S3.F1.14.m7.1.1.1.1.1">subscript</csymbol><ci id="S3.F1.14.m7.1.1.1.1.1.2.cmml" xref="S3.F1.14.m7.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="S3.F1.14.m7.1.1.1.1.1.3.cmml" xref="S3.F1.14.m7.1.1.1.1.1.3">1</cn></apply><apply id="S3.F1.14.m7.2.2.2.2.2.cmml" xref="S3.F1.14.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.F1.14.m7.2.2.2.2.2.1.cmml" xref="S3.F1.14.m7.2.2.2.2.2">subscript</csymbol><ci id="S3.F1.14.m7.2.2.2.2.2.2.cmml" xref="S3.F1.14.m7.2.2.2.2.2.2">𝑥</ci><cn type="integer" id="S3.F1.14.m7.2.2.2.2.2.3.cmml" xref="S3.F1.14.m7.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.14.m7.2d">\alpha_{2}(x_{1},x_{2})</annotation></semantics></math> of User 2, which uses the shared model in a
different region than User 1.
</figcaption>
</figure>
<figure id="S3.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S3.F3.9" class="ltx_block ltx_figure_panel">
<span id="S3.F3.9.1" class="ltx_ERROR undefined">{floatrow}</span><span id="S3.F3.9.2" class="ltx_ERROR undefined">\capbtabbox</span>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S3.F3.10" class="ltx_block ltx_figure_panel">
<span id="S3.F3.10.1" class="ltx_ERROR undefined">\TopFloatBoxes</span>
<table id="S3.F3.6" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.F3.6.7.1" class="ltx_tr">
<th id="S3.F3.6.7.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S3.F3.6.7.1.1.1" class="ltx_text ltx_font_bold">System</span></th>
<td id="S3.F3.6.7.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.F3.6.7.1.2.1" class="ltx_text ltx_font_bold">User 1 RMSE</span></td>
<td id="S3.F3.6.7.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.F3.6.7.1.3.1" class="ltx_text ltx_font_bold">User 2 RMSE</span></td>
</tr>
<tr id="S3.F3.6.8.2" class="ltx_tr">
<th id="S3.F3.6.8.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Baseline</th>
<td id="S3.F3.6.8.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">15.32</td>
<td id="S3.F3.6.8.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10.95</td>
</tr>
<tr id="S3.F3.1.1" class="ltx_tr">
<th id="S3.F3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">FL, <math id="S3.F3.1.1.1.m1.1" class="ltx_Math" alttext="\sigma=0" display="inline"><semantics id="S3.F3.1.1.1.m1.1a"><mrow id="S3.F3.1.1.1.m1.1.1" xref="S3.F3.1.1.1.m1.1.1.cmml"><mi id="S3.F3.1.1.1.m1.1.1.2" xref="S3.F3.1.1.1.m1.1.1.2.cmml">σ</mi><mo id="S3.F3.1.1.1.m1.1.1.1" xref="S3.F3.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S3.F3.1.1.1.m1.1.1.3" xref="S3.F3.1.1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.1.1.1.m1.1b"><apply id="S3.F3.1.1.1.m1.1.1.cmml" xref="S3.F3.1.1.1.m1.1.1"><eq id="S3.F3.1.1.1.m1.1.1.1.cmml" xref="S3.F3.1.1.1.m1.1.1.1"></eq><ci id="S3.F3.1.1.1.m1.1.1.2.cmml" xref="S3.F3.1.1.1.m1.1.1.2">𝜎</ci><cn type="integer" id="S3.F3.1.1.1.m1.1.1.3.cmml" xref="S3.F3.1.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.1.1.1.m1.1c">\sigma=0</annotation></semantics></math>
</th>
<td id="S3.F3.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">12.75</td>
<td id="S3.F3.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">9.67</td>
</tr>
<tr id="S3.F3.2.2" class="ltx_tr">
<th id="S3.F3.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">FL, <math id="S3.F3.2.2.1.m1.1" class="ltx_Math" alttext="\sigma=2" display="inline"><semantics id="S3.F3.2.2.1.m1.1a"><mrow id="S3.F3.2.2.1.m1.1.1" xref="S3.F3.2.2.1.m1.1.1.cmml"><mi id="S3.F3.2.2.1.m1.1.1.2" xref="S3.F3.2.2.1.m1.1.1.2.cmml">σ</mi><mo id="S3.F3.2.2.1.m1.1.1.1" xref="S3.F3.2.2.1.m1.1.1.1.cmml">=</mo><mn id="S3.F3.2.2.1.m1.1.1.3" xref="S3.F3.2.2.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.2.2.1.m1.1b"><apply id="S3.F3.2.2.1.m1.1.1.cmml" xref="S3.F3.2.2.1.m1.1.1"><eq id="S3.F3.2.2.1.m1.1.1.1.cmml" xref="S3.F3.2.2.1.m1.1.1.1"></eq><ci id="S3.F3.2.2.1.m1.1.1.2.cmml" xref="S3.F3.2.2.1.m1.1.1.2">𝜎</ci><cn type="integer" id="S3.F3.2.2.1.m1.1.1.3.cmml" xref="S3.F3.2.2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.2.2.1.m1.1c">\sigma=2</annotation></semantics></math>
</th>
<td id="S3.F3.2.2.2" class="ltx_td ltx_align_center ltx_border_r">13.79</td>
<td id="S3.F3.2.2.3" class="ltx_td ltx_align_center ltx_border_r">12.68</td>
</tr>
<tr id="S3.F3.3.3" class="ltx_tr">
<th id="S3.F3.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">FL, <math id="S3.F3.3.3.1.m1.1" class="ltx_Math" alttext="\sigma=4" display="inline"><semantics id="S3.F3.3.3.1.m1.1a"><mrow id="S3.F3.3.3.1.m1.1.1" xref="S3.F3.3.3.1.m1.1.1.cmml"><mi id="S3.F3.3.3.1.m1.1.1.2" xref="S3.F3.3.3.1.m1.1.1.2.cmml">σ</mi><mo id="S3.F3.3.3.1.m1.1.1.1" xref="S3.F3.3.3.1.m1.1.1.1.cmml">=</mo><mn id="S3.F3.3.3.1.m1.1.1.3" xref="S3.F3.3.3.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.3.3.1.m1.1b"><apply id="S3.F3.3.3.1.m1.1.1.cmml" xref="S3.F3.3.3.1.m1.1.1"><eq id="S3.F3.3.3.1.m1.1.1.1.cmml" xref="S3.F3.3.3.1.m1.1.1.1"></eq><ci id="S3.F3.3.3.1.m1.1.1.2.cmml" xref="S3.F3.3.3.1.m1.1.1.2">𝜎</ci><cn type="integer" id="S3.F3.3.3.1.m1.1.1.3.cmml" xref="S3.F3.3.3.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.3.3.1.m1.1c">\sigma=4</annotation></semantics></math>
</th>
<td id="S3.F3.3.3.2" class="ltx_td ltx_align_center ltx_border_r">12.59</td>
<td id="S3.F3.3.3.3" class="ltx_td ltx_align_center ltx_border_r">19.49</td>
</tr>
<tr id="S3.F3.4.4" class="ltx_tr">
<th id="S3.F3.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">FL+DE, <math id="S3.F3.4.4.1.m1.1" class="ltx_Math" alttext="\sigma=0" display="inline"><semantics id="S3.F3.4.4.1.m1.1a"><mrow id="S3.F3.4.4.1.m1.1.1" xref="S3.F3.4.4.1.m1.1.1.cmml"><mi id="S3.F3.4.4.1.m1.1.1.2" xref="S3.F3.4.4.1.m1.1.1.2.cmml">σ</mi><mo id="S3.F3.4.4.1.m1.1.1.1" xref="S3.F3.4.4.1.m1.1.1.1.cmml">=</mo><mn id="S3.F3.4.4.1.m1.1.1.3" xref="S3.F3.4.4.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.4.4.1.m1.1b"><apply id="S3.F3.4.4.1.m1.1.1.cmml" xref="S3.F3.4.4.1.m1.1.1"><eq id="S3.F3.4.4.1.m1.1.1.1.cmml" xref="S3.F3.4.4.1.m1.1.1.1"></eq><ci id="S3.F3.4.4.1.m1.1.1.2.cmml" xref="S3.F3.4.4.1.m1.1.1.2">𝜎</ci><cn type="integer" id="S3.F3.4.4.1.m1.1.1.3.cmml" xref="S3.F3.4.4.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.4.1.m1.1c">\sigma=0</annotation></semantics></math>
</th>
<td id="S3.F3.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">12.12</td>
<td id="S3.F3.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.F3.4.4.3.1" class="ltx_text ltx_font_bold">9.41</span></td>
</tr>
<tr id="S3.F3.5.5" class="ltx_tr">
<th id="S3.F3.5.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">FL+DE, <math id="S3.F3.5.5.1.m1.1" class="ltx_Math" alttext="\sigma=2" display="inline"><semantics id="S3.F3.5.5.1.m1.1a"><mrow id="S3.F3.5.5.1.m1.1.1" xref="S3.F3.5.5.1.m1.1.1.cmml"><mi id="S3.F3.5.5.1.m1.1.1.2" xref="S3.F3.5.5.1.m1.1.1.2.cmml">σ</mi><mo id="S3.F3.5.5.1.m1.1.1.1" xref="S3.F3.5.5.1.m1.1.1.1.cmml">=</mo><mn id="S3.F3.5.5.1.m1.1.1.3" xref="S3.F3.5.5.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.5.5.1.m1.1b"><apply id="S3.F3.5.5.1.m1.1.1.cmml" xref="S3.F3.5.5.1.m1.1.1"><eq id="S3.F3.5.5.1.m1.1.1.1.cmml" xref="S3.F3.5.5.1.m1.1.1.1"></eq><ci id="S3.F3.5.5.1.m1.1.1.2.cmml" xref="S3.F3.5.5.1.m1.1.1.2">𝜎</ci><cn type="integer" id="S3.F3.5.5.1.m1.1.1.3.cmml" xref="S3.F3.5.5.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.5.5.1.m1.1c">\sigma=2</annotation></semantics></math>
</th>
<td id="S3.F3.5.5.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.F3.5.5.2.1" class="ltx_text ltx_font_bold">12.05</span></td>
<td id="S3.F3.5.5.3" class="ltx_td ltx_align_center ltx_border_r">9.73</td>
</tr>
<tr id="S3.F3.6.6" class="ltx_tr">
<th id="S3.F3.6.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">FL+DE, <math id="S3.F3.6.6.1.m1.1" class="ltx_Math" alttext="\sigma=4" display="inline"><semantics id="S3.F3.6.6.1.m1.1a"><mrow id="S3.F3.6.6.1.m1.1.1" xref="S3.F3.6.6.1.m1.1.1.cmml"><mi id="S3.F3.6.6.1.m1.1.1.2" xref="S3.F3.6.6.1.m1.1.1.2.cmml">σ</mi><mo id="S3.F3.6.6.1.m1.1.1.1" xref="S3.F3.6.6.1.m1.1.1.1.cmml">=</mo><mn id="S3.F3.6.6.1.m1.1.1.3" xref="S3.F3.6.6.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F3.6.6.1.m1.1b"><apply id="S3.F3.6.6.1.m1.1.1.cmml" xref="S3.F3.6.6.1.m1.1.1"><eq id="S3.F3.6.6.1.m1.1.1.1.cmml" xref="S3.F3.6.6.1.m1.1.1.1"></eq><ci id="S3.F3.6.6.1.m1.1.1.2.cmml" xref="S3.F3.6.6.1.m1.1.1.2">𝜎</ci><cn type="integer" id="S3.F3.6.6.1.m1.1.1.3.cmml" xref="S3.F3.6.6.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.6.6.1.m1.1c">\sigma=4</annotation></semantics></math>
</th>
<td id="S3.F3.6.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">13.78</td>
<td id="S3.F3.6.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">10.95</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span> Test error for regression models trained on synthetic data
(lower is better). The domain-only baseline system trains a separate model for
each user on their data. Traditional FL, and our system of FL with domain experts
(FL+DE) are tested with various noise levels, <math id="S3.F3.8.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.F3.8.m1.1b"><mi id="S3.F3.8.m1.1.1" xref="S3.F3.8.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.F3.8.m1.1c"><ci id="S3.F3.8.m1.1.1.cmml" xref="S3.F3.8.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.8.m1.1d">\sigma</annotation></semantics></math>, for differential privacy.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span id="S3.F3.11" class="ltx_ERROR ltx_figure_panel undefined">\ffigbox</span></div>
<div class="ltx_flex_cell ltx_flex_size_2"><span id="S3.F3.12" class="ltx_ERROR ltx_figure_panel undefined">\TopFloatBoxes</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/1912.06733/assets/bar_plot_with_error_bars.png" id="S3.F3.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="598" height="299" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
Classifier accuracy on the spam dataset (higher is better).
FL and our system (FL+DE) are evaluated as gradient noise is increased
(for differential privacy).
The dashed horizontal line indicates domain-only baseline performance.
Error bars show performance variance across users.
</figcaption>
</figure>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.4" class="ltx_p">The second dataset is a real-world domain adaptation dataset for spam
detection, which was released as part of the ECML PKDD 2006 Discovery
Challenge <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib4" title="" class="ltx_ref">4</a>)</cite>. The task is to classify whether an email
in a user’s inbox is spam, and personalizing the spam filtering for
each user. The amount of data available per user is limited, so it is
expected that collaboration can increase the quality of the
classifier. However, each user has a different inbox, so domain
adaptation is required. The dataset was originally designed to test
methods of unsupervised domain adaptation, but using the evaluation
dataset labels, which are now publicly available, we simulate <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="15" display="inline"><semantics id="S3.p4.1.m1.1a"><mn id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><cn type="integer" id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">15</annotation></semantics></math>
users collaborating to build a spam classifier in a supervised setting. In this case, we
measure classifier accuracy, not prediction error. We use the dataset
from task <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S3.p4.2.m2.1a"><mi id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><ci id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">b</annotation></semantics></math>. For each of our users, we train on <math id="S3.p4.3.m3.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S3.p4.3.m3.1a"><mn id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><cn type="integer" id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">50</annotation></semantics></math> labeled
examples, leaving <math id="S3.p4.4.m4.1" class="ltx_Math" alttext="350" display="inline"><semantics id="S3.p4.4.m4.1a"><mn id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml">350</mn><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><cn type="integer" id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1">350</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">350</annotation></semantics></math> examples for testing. The baseline
system trains one classifier for each user, using in-domain data only,
and we also train a collaborative FL model and finally FL+DE.</p>
</div>
<div id="S3.p5" class="ltx_para">
<p id="S3.p5.5" class="ltx_p">The results are illustrated in Figure <a href="#S3.F3" title="Figure 3 ‣ 3 Evaluation ‣ Private Federated Learning with Domain Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Once again,
FL+DE provides the best overall accuracy, and maintains its performance
as noise is added to provide differential privacy.
The accuracy of the baseline system is 81.2% (<math id="S3.p5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.p5.1.m1.1a"><mo id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><csymbol cd="latexml" id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">\pm</annotation></semantics></math> 10.5%), averaged
across users. In the absence of noise, FL achieves 90.8% mean accuracy, and
FL+DE reaches 92.1% accuracy. When we simulate low noise (<math id="S3.p5.2.m2.1" class="ltx_Math" alttext="\sigma=0.5" display="inline"><semantics id="S3.p5.2.m2.1a"><mrow id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml"><mi id="S3.p5.2.m2.1.1.2" xref="S3.p5.2.m2.1.1.2.cmml">σ</mi><mo id="S3.p5.2.m2.1.1.1" xref="S3.p5.2.m2.1.1.1.cmml">=</mo><mn id="S3.p5.2.m2.1.1.3" xref="S3.p5.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><apply id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1"><eq id="S3.p5.2.m2.1.1.1.cmml" xref="S3.p5.2.m2.1.1.1"></eq><ci id="S3.p5.2.m2.1.1.2.cmml" xref="S3.p5.2.m2.1.1.2">𝜎</ci><cn type="float" id="S3.p5.2.m2.1.1.3.cmml" xref="S3.p5.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">\sigma=0.5</annotation></semantics></math>),
FL classification accuracy drops to 79.3%, but FL+DE achieves a minor improvement to
92.2% mean accuracy. In high noise (<math id="S3.p5.3.m3.1" class="ltx_Math" alttext="\sigma=1.0" display="inline"><semantics id="S3.p5.3.m3.1a"><mrow id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml"><mi id="S3.p5.3.m3.1.1.2" xref="S3.p5.3.m3.1.1.2.cmml">σ</mi><mo id="S3.p5.3.m3.1.1.1" xref="S3.p5.3.m3.1.1.1.cmml">=</mo><mn id="S3.p5.3.m3.1.1.3" xref="S3.p5.3.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><apply id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1"><eq id="S3.p5.3.m3.1.1.1.cmml" xref="S3.p5.3.m3.1.1.1"></eq><ci id="S3.p5.3.m3.1.1.2.cmml" xref="S3.p5.3.m3.1.1.2">𝜎</ci><cn type="float" id="S3.p5.3.m3.1.1.3.cmml" xref="S3.p5.3.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">\sigma=1.0</annotation></semantics></math>), the FL system accuracy drops further to 76.9%,
but the FL+DE accuracy drops only to 91.3%.
On this dataset, we change parameters for low and high noise to <math id="S3.p5.4.m4.1" class="ltx_Math" alttext="\sigma=0.5" display="inline"><semantics id="S3.p5.4.m4.1a"><mrow id="S3.p5.4.m4.1.1" xref="S3.p5.4.m4.1.1.cmml"><mi id="S3.p5.4.m4.1.1.2" xref="S3.p5.4.m4.1.1.2.cmml">σ</mi><mo id="S3.p5.4.m4.1.1.1" xref="S3.p5.4.m4.1.1.1.cmml">=</mo><mn id="S3.p5.4.m4.1.1.3" xref="S3.p5.4.m4.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.4.m4.1b"><apply id="S3.p5.4.m4.1.1.cmml" xref="S3.p5.4.m4.1.1"><eq id="S3.p5.4.m4.1.1.1.cmml" xref="S3.p5.4.m4.1.1.1"></eq><ci id="S3.p5.4.m4.1.1.2.cmml" xref="S3.p5.4.m4.1.1.2">𝜎</ci><cn type="float" id="S3.p5.4.m4.1.1.3.cmml" xref="S3.p5.4.m4.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.4.m4.1c">\sigma=0.5</annotation></semantics></math> and <math id="S3.p5.5.m5.1" class="ltx_Math" alttext="\sigma=1" display="inline"><semantics id="S3.p5.5.m5.1a"><mrow id="S3.p5.5.m5.1.1" xref="S3.p5.5.m5.1.1.cmml"><mi id="S3.p5.5.m5.1.1.2" xref="S3.p5.5.m5.1.1.2.cmml">σ</mi><mo id="S3.p5.5.m5.1.1.1" xref="S3.p5.5.m5.1.1.1.cmml">=</mo><mn id="S3.p5.5.m5.1.1.3" xref="S3.p5.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.5.m5.1b"><apply id="S3.p5.5.m5.1.1.cmml" xref="S3.p5.5.m5.1.1"><eq id="S3.p5.5.m5.1.1.1.cmml" xref="S3.p5.5.m5.1.1.1"></eq><ci id="S3.p5.5.m5.1.1.2.cmml" xref="S3.p5.5.m5.1.1.2">𝜎</ci><cn type="integer" id="S3.p5.5.m5.1.1.3.cmml" xref="S3.p5.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.5.m5.1c">\sigma=1</annotation></semantics></math>,
because higher noise levels led the FL model to worse-than-random perfomance for some users,
while the FL+DE accuracy dropped to roughly the baseline accuracy.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Work</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Our core idea of maintaining two models per party is somewhat similar
to Daumé and Marcu’s work <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib7" title="" class="ltx_ref">7</a>)</cite>, where they propose
training three models, a “source-domain” model, a “target-domain”
model, and a “general” model. The composition of
these models during training and for inference is quite complex,
whereas our approach uses a simple weighted averaging algorithm.
Furthermore, their work targets two domains, whereas ours is more
suitable for FL and can target a multitude of domains, one for each participating
party.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Domain adaptation and federated learning have been studied in privacy-preserving and secure settings.
One line of work focuses on protecting privacy in a classic
domain adaptation setup <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib12" title="" class="ltx_ref">12</a>)</cite>, where a well-tuned model on a source domain is
adapted to perform better in a target domain with more limited data.
Another line of work focuses on secure federated learning <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib18" title="" class="ltx_ref">18</a>)</cite>,
but uses additively homomorphic encryption to ensure privacy in a two-party
federated learning context. This is different from <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="\varepsilon" display="inline"><semantics id="S4.p2.1.m1.1a"><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">ε</mi><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝜀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">\varepsilon</annotation></semantics></math>-differential privacy,
and does not maintain a collaborative general model. Each of these systems considers one part of
our set-up, but no prior work combines efforts of collaborative
learning combined with private domain adaptation.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">Attention <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib2" title="" class="ltx_ref">2</a>)</cite> has been used in a FL environment to weight updates
from different users <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib14" title="" class="ltx_ref">14</a>)</cite>, allowing users with extremely unusual
gradient updates to have a smaller disruptive effect on the general
FL model. While this generally improved perplexity on unseen data,
improving the general model, it does not allow users with unusual datasets
to improve prediction quality on their domain.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">The PATE architecture <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib23" title="" class="ltx_ref">23</a>)</cite> is yet another class of
distributed ML systems that uses privately trained models of
participating parties as sources for consensus-based labeling of data
for a new user to help it train its model on its private data. The
models trained for individual users act as an ensemble of
“teachers” for the new party that is training a new model for
itself. The consensus based labeling provides the privacy guarantees
for each party. This approach could be used to build the general model,
rather than differentially-private FL, but we have not yet tested its
effectiveness in conjunction with domain-adaptation techniques.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This work demonstrates that adding private, per-user domain adaptation to
a collaborative model-building framework can increase accuracy for all users,
and is especially beneficial when privacy guarantees begin to diminish the
utility of the collaborative general model.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">Our implementation of domain adaptation employs a mixture of experts, with each
user learning a domain expert model and a private gating mechanism.
This domain adaptation framework is another contribution
of our work, and allows us to train the entire model
with gradient descent. We demonstrate that it works well in practice on both
regression and classification tasks.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">In future work, however, it may be practical to consider other mechanisms
for building a collaborative model (e.g., PATE), or alternative domain adaptation techniques (e.g., hypothesis
transfer learning).
We expect that the general setup of learning one collaborative generalist
and a private domain adaptation mechanism will be useful in many settings and
for many types of models.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Martin Abadi, Andy Chu, Ian Goodfellow, H. Brendan McMahan, Ilya Mironov, Kunal
Talwar, and Li Zhang.

</span>
<span class="ltx_bibblock">Deep learning with differential privacy.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Proceedings of the 2016 ACM SIGSAC Conference on Computer and
Communications Security</span>, pages 308–318, 2016.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Neural machine translation by jointly learning to align and
translate.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1409.0473</span>, 2014.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Shai Ben-David, John Blitzer, Koby Crammer, Alex Kulesza, Fernando Pereira, and
Jennifer Wortman Vaughan.

</span>
<span class="ltx_bibblock">A theory of learning from different domains.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">Machine Learning</span>, 79(1-2):151–175, May 2010.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Steffen Bickel.

</span>
<span class="ltx_bibblock">Ecml-pkdd discovery challenge 2006 overview.

</span>
<span class="ltx_bibblock">2006.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Keith Bonawitz, Hubert Eichner, Wolfgang Grieskamp, Dzmitry Huba, Alex
Ingerman, Vladimir Ivanov, Chloé Kiddon, Jakub Konecný, Stefano
Mazzocchi, H. Brendan McMahan, Timon Van Overveldt, David Petrou, Daniel
Ramage, and Jason Roselander.

</span>
<span class="ltx_bibblock">Towards federated learning at scale: System design.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1902.01046, 2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Koby Crammer, Michael Kearns, and Jennifer Wortman.

</span>
<span class="ltx_bibblock">Learning from multiple sources.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Journal of Machine Learning Research</span>, 9:1757–1774, June
2008.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Hal Daumé, III and Daniel Marcu.

</span>
<span class="ltx_bibblock">Domain Adaptation for Statistical Classifiers.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">Journal of Artificial Intelligence Research</span>, 26(1):101–126,
May 2006.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Cynthia Dwork.

</span>
<span class="ltx_bibblock">Differential privacy.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Automata, Languages and Programming, 33rd International
Colloquium, ICALP</span>, pages 1–12, 2006.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Cynthia Dwork, Frank McSherry, Kobbi Nissim, and Adam Smith.

</span>
<span class="ltx_bibblock">Calibrating noise to sensitivity in private data analysis.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Proceedings of the Third Conference on Theory of
Cryptography</span>, TCC’06, pages 265–284, 2006.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Cynthia Dwork and Aaron Roth.

</span>
<span class="ltx_bibblock">The algorithmic foundations of differential privacy.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Foundations and Trends in Theoretical Computer Science</span>,
9(3&amp;#8211;4):211–407, August 2014.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Robin C. Geyer, Tassilo Klein, and Moin Nabi.

</span>
<span class="ltx_bibblock">Differentially Private Federated Learning: A Client Level
Perspective.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1712.07557, 2017.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Xiawei Guo, Quanming Yao, WeiWei Tu, Yuqiang Chen, Wenyuan Dai, and Qiang Yang.

</span>
<span class="ltx_bibblock">Privacy-preserving transfer learning for knowledge sharing.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1811.09491</span>, 2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Hal Daumé III.

</span>
<span class="ltx_bibblock">Frustratingly easy domain adaptation.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/0907.1815, 2009.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Shaoxiong Ji, Shirui Pan, Guodong Long, Xue Li, Jing Jiang, and Zi Huang.

</span>
<span class="ltx_bibblock">Learning private neural language modeling with attentive aggregation.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.07108</span>, 2018.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Jakub Konecný, Brendan McMahan, and Daniel Ramage.

</span>
<span class="ltx_bibblock">Federated optimization: Distributed optimization beyond the
datacenter.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1511.03575, 2015.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Jakub Konecný, H. Brendan McMahan, Daniel Ramage, and Peter
Richtárik.

</span>
<span class="ltx_bibblock">Federated optimization: Distributed machine learning for on-device
intelligence.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1610.02527, 2016.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Wouter M. Kouw and Marco Loog.

</span>
<span class="ltx_bibblock">An introduction to domain adaptation and transfer learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1812.11806, 2018.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Yang Liu, Tianjian Chen, and Qiang Yang.

</span>
<span class="ltx_bibblock">Secure federated transfer learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.03337</span>, 2018.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Saeed Masoudnia and Reza Ebrahimpour.

</span>
<span class="ltx_bibblock">Mixture of Experts: A Literature Survey.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Artificial Intelligence Review</span>, 42(2):275–293, August 2014.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
H. Brendan McMahan, Eider Moore, Daniel Ramage, and Blaise Agüera
y Arcas.

</span>
<span class="ltx_bibblock">Federated learning of deep networks using model averaging.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1602.05629, 2016.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Steven J Nowlan and Geoffrey E Hinton.

</span>
<span class="ltx_bibblock">Evaluation of adaptive mixtures of competing experts.

</span>
<span class="ltx_bibblock">In <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, pages
774–780, 1991.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Sinno Jialin Pan and Qiang Yang.

</span>
<span class="ltx_bibblock">A survey on transfer learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Knowledge and Data Engineering</span>,
22(10):1345–1359, October 2010.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Nicolas Papernot, Shuang Song, Ilya Mironov, Ananth Raghunathan, Kunal Talwar,
and Úlfar Erlingsson.

</span>
<span class="ltx_bibblock">Scalable private learning with PATE.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">6th International Conference on Learning Representations,
ICLR 2018, Vancouver, BC, Canada, April 30 - May 3, 2018, Conference Track
Proceedings</span>, 2018.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1912.06732" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1912.06733" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1912.06733">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1912.06733" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1912.06734" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  2 13:49:15 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
