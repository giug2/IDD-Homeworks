<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2308.08643] Towards Personalized Federated Learning via Heterogeneous Model Reassembly</title><meta property="og:description" content="This paper focuses on addressing the practical yet challenging problem of model heterogeneity in federated learning, where clients possess models with different network structures.
To track this problem, we propose a n…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Towards Personalized Federated Learning via Heterogeneous Model Reassembly">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Towards Personalized Federated Learning via Heterogeneous Model Reassembly">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2308.08643">

<!--Generated on Wed Feb 28 12:25:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Towards Personalized Federated Learning via Heterogeneous Model Reassembly</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span id="id1.1.id1" class="ltx_text ltx_font_bold">Jiaqi Wang<sup id="id1.1.id1.1" class="ltx_sup"><span id="id1.1.id1.1.1" class="ltx_text ltx_font_medium">1</span></sup></span> <span id="id2.2.id2" class="ltx_text ltx_font_bold">Xingyi Yang<sup id="id2.2.id2.1" class="ltx_sup"><span id="id2.2.id2.1.1" class="ltx_text ltx_font_medium">2</span></sup></span>  <span id="id3.3.id3" class="ltx_text ltx_font_bold">Suhan Cui<sup id="id3.3.id3.1" class="ltx_sup"><span id="id3.3.id3.1.1" class="ltx_text ltx_font_medium">1</span></sup></span>  <span id="id4.4.id4" class="ltx_text ltx_font_bold">Liwei Che<sup id="id4.4.id4.1" class="ltx_sup"><span id="id4.4.id4.1.1" class="ltx_text ltx_font_medium">1</span></sup>
<br class="ltx_break">Lingjuan Lyu<sup id="id4.4.id4.2" class="ltx_sup"><span id="id4.4.id4.2.1" class="ltx_text ltx_font_medium">3</span></sup></span> <span id="id5.5.id5" class="ltx_text ltx_font_bold">Dongkuan Xu<sup id="id5.5.id5.1" class="ltx_sup"><span id="id5.5.id5.1.1" class="ltx_text ltx_font_medium">4</span></sup></span> <span id="id6.6.id6" class="ltx_text ltx_font_bold">Fenglong Ma<sup id="id6.6.id6.1" class="ltx_sup"><span id="id6.6.id6.1.1" class="ltx_text ltx_font_medium">1</span></sup>
<br class="ltx_break"><sup id="id6.6.id6.2" class="ltx_sup"><span id="id6.6.id6.2.1" class="ltx_text ltx_font_medium">1</span></sup></span>The Pennsylvania State University  <sup id="id7.7.id7" class="ltx_sup">2</sup>National University of Singapore 
<br class="ltx_break"><sup id="id8.8.id8" class="ltx_sup">3</sup>Sony AI <sup id="id9.9.id9" class="ltx_sup">4</sup>North Carolina State University
<br class="ltx_break"><span id="id10.10.id10" class="ltx_text ltx_font_typewriter">{jqwang,sxc6192,lfc5481,fenglong}@psu.edu,
<br class="ltx_break">xyang@u.nus.edu, lingjuan.lv@sony.com, dxu27@ncsu.edu</span>
</span><span class="ltx_author_notes">Corresponding author.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id11.id1" class="ltx_p">This paper focuses on addressing the practical yet challenging problem of model heterogeneity in federated learning, where clients possess models with different network structures.
To track this problem, we propose a novel framework called <span id="id11.id1.1" class="ltx_text ltx_font_typewriter">pFedHR</span>, which leverages heterogeneous model reassembly to achieve personalized federated learning. In particular, we approach the problem of heterogeneous model personalization as a model-matching optimization task on the server side. Moreover, <span id="id11.id1.2" class="ltx_text ltx_font_typewriter">pFedHR</span> automatically and dynamically generates informative and diverse personalized candidates with minimal human intervention. Furthermore, our proposed heterogeneous model reassembly technique mitigates the adverse impact introduced by using public data with different distributions from the client data to a certain extent. Experimental results demonstrate that <span id="id11.id1.3" class="ltx_text ltx_font_typewriter">pFedHR</span> outperforms baselines on three datasets under both IID and Non-IID settings. Additionally, <span id="id11.id1.4" class="ltx_text ltx_font_typewriter">pFedHR</span> effectively reduces the adverse impact of using different public data and dynamically generates diverse personalized models in an automated manner<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Source code can be found in the link <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/JackqqWang/pfedHR</span></span></span></span>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) aims to enable collaborative machine learning without the need to share clients’ data with others, thereby upholding data privacy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. However, traditional federated learning approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> typically enforce the use of an identical model structure for all clients during training. This constraint poses challenges in achieving personalized learning within the FL framework. In real-world scenarios, clients such as data centers, institutes, or companies often possess their own distinct models, which may have varying structures.
Training on top of their original models should be a better solution than deploying new ones for collaborative purposes.
Therefore, a practical solution lies in fostering <span id="S1.p1.1.1" class="ltx_text ltx_font_bold">heterogeneous model cooperation</span> within FL, while preserving individual model structures.
Only a few studies have attempted to address the challenging problem of heterogeneous model cooperation in FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, and most of them incorporate the use of a public dataset to facilitate both cooperation and personalization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. However, these approaches still face several key issues:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p"><span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Undermining personalization through consensus</span>: Existing methods often generate consensual side information, such as class information <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, logits <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, and label-wise representations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, using public data. This information is then exchanged and used to conduct average operations on the server, resulting in a consensus representation. However, this approach poses privacy and security concerns due to the exchange of side information <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. Furthermore, the averaging process significantly diminishes the unique characteristics of individual local models, thereby hampering model personalization. Consequently, there is a need to explore approaches that can achieve local model personalization without relying on consensus-based techniques.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Excessive reliance on prior knowledge for distillation-based approaches</span>: Distillation-based techniques, such as knowledge distillation (KD), are commonly employed for heterogeneous model aggregation in FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. However, these techniques necessitate the predefinition of a shared model structure based on prior knowledge <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. This shared model is then downloaded to clients to guide their training process. Consequently, handcrafted models can heavily influence local model personalization. Additionally, a fixed shared model structure may be insufficient for effectively guiding personalized learning when dealing with a large number of clients with non-IID data. Thus, it is crucial to explore methods that can automatically and dynamically generate client-specific personalized models as guidance.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p"><span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Sensitivity to the choice of public datasets</span>: Most existing approaches use public data to obtain guidance information, such as logits <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> or a shared model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, for local model personalization. The design of these approaches makes public data and model personalization <span id="S1.I1.i3.p1.1.2" class="ltx_text ltx_font_bold">tightly bound together</span>. Thus, they usually choose the public data with the same distribution as the client data. Therefore, using public data with different distributions from client data will cause a significant performance drop in existing models. Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the performance variations of different models trained on the SVHN dataset with different public datasets (detailed experimental information can be found in Section <a href="#S4.SS4" title="4.4 Public Dataset Analysis ‣ 4 Experiments ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>). The figure demonstrates a significant performance drop when using alternative public datasets.
Consequently, mitigating the adverse impact of employing diverse public data remains a critical yet practical research challenge in FL.</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2308.08643/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="71" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.4.2" class="ltx_text" style="font-size:90%;">Performance changes when using different public data. <span id="S1.F1.4.2.1" class="ltx_text ltx_font_typewriter">pFedHR</span> is our proposed model.</span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p"><span id="S1.p2.1.1" class="ltx_text ltx_font_bold">Motivation &amp; Challenges</span>.
In fact, both consensus-based and distillation-based approaches aim to learn aggregated and shared information used as guidance in personalized local model training, which is not an optimal way to achieve personalization.
An ideal solution is to generate a personalized model for the corresponding client, which is significantly challenging since the assessable information on the server side can only include the uploaded client models and the public data.
To avoid the issue of public data sensitivity, only client models can be used. These constraints motivate us to employ the model reassembly technique <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> to generate models first and then select the most matchable personalized model for a specific client from the generations.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To this end, we will face several new challenges. (<span id="S1.p3.1.1" class="ltx_text ltx_font_bold">C1</span>) Applying the model reassembly technique will result in many candidates. Thus, the first challenge is how to get the optimal candidates.
(<span id="S1.p3.1.2" class="ltx_text ltx_font_bold">C2</span>) The layers of the generated candidates are usually from different client models, and the output dimension size of the first layer may not align with the input dimension size of the second layer, which leads to the necessity of network layer stitching. However, the parameters of the stitched layers are unknown. Therefore, the second challenge is how to learn those unknown parameters in the stitched models.
(<span id="S1.p3.1.3" class="ltx_text ltx_font_bold">C3</span>) Even with well-trained stitched models, digging out the best match between a client model and a stitched model remains a big challenge.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.3" class="ltx_p"><span id="S1.p4.3.1" class="ltx_text ltx_font_bold">Our Approach</span>.
To simultaneously tackle all the aforementioned challenges, we present a novel framework called <span id="S1.p4.3.2" class="ltx_text ltx_font_typewriter">pFedHR</span>, which aims to achieve personalized federated learning and address the issue of heterogeneous model cooperation (as depicted in Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). The <span id="S1.p4.3.3" class="ltx_text ltx_font_typewriter">pFedHR</span> framework comprises two key updates: the server update and the client update.
In particular, to tackle <span id="S1.p4.3.4" class="ltx_text ltx_font_bold">C3</span>, we approach the issue of heterogeneous model personalization from a model-matching optimization perspective on the <span id="S1.p4.3.5" class="ltx_text ltx_font_bold">server</span> side (see Section <a href="#S3.SS1.SSS1" title="3.1.1 Similarity-based Model Matching ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1.1</span></a>).
To solve this problem, we introduce a novel <span id="S1.p4.3.6" class="ltx_text ltx_font_bold">heterogeneous model reassembly</span> technique in Section <a href="#S3.SS1.SSS2" title="3.1.2 Heterogeneous Model Reassembly – 𝑔⁢(⋅,⋅) ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1.2</span></a> to assemble models uploaded from clients, i.e., <math id="S1.p4.1.m1.3" class="ltx_Math" alttext="\{\mathbf{w}_{t}^{1},\cdots,\mathbf{w}_{t}^{B}\}" display="inline"><semantics id="S1.p4.1.m1.3a"><mrow id="S1.p4.1.m1.3.3.2" xref="S1.p4.1.m1.3.3.3.cmml"><mo stretchy="false" id="S1.p4.1.m1.3.3.2.3" xref="S1.p4.1.m1.3.3.3.cmml">{</mo><msubsup id="S1.p4.1.m1.2.2.1.1" xref="S1.p4.1.m1.2.2.1.1.cmml"><mi id="S1.p4.1.m1.2.2.1.1.2.2" xref="S1.p4.1.m1.2.2.1.1.2.2.cmml">𝐰</mi><mi id="S1.p4.1.m1.2.2.1.1.2.3" xref="S1.p4.1.m1.2.2.1.1.2.3.cmml">t</mi><mn id="S1.p4.1.m1.2.2.1.1.3" xref="S1.p4.1.m1.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S1.p4.1.m1.3.3.2.4" xref="S1.p4.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">⋯</mi><mo id="S1.p4.1.m1.3.3.2.5" xref="S1.p4.1.m1.3.3.3.cmml">,</mo><msubsup id="S1.p4.1.m1.3.3.2.2" xref="S1.p4.1.m1.3.3.2.2.cmml"><mi id="S1.p4.1.m1.3.3.2.2.2.2" xref="S1.p4.1.m1.3.3.2.2.2.2.cmml">𝐰</mi><mi id="S1.p4.1.m1.3.3.2.2.2.3" xref="S1.p4.1.m1.3.3.2.2.2.3.cmml">t</mi><mi id="S1.p4.1.m1.3.3.2.2.3" xref="S1.p4.1.m1.3.3.2.2.3.cmml">B</mi></msubsup><mo stretchy="false" id="S1.p4.1.m1.3.3.2.6" xref="S1.p4.1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.3b"><set id="S1.p4.1.m1.3.3.3.cmml" xref="S1.p4.1.m1.3.3.2"><apply id="S1.p4.1.m1.2.2.1.1.cmml" xref="S1.p4.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.2.2.1.1.1.cmml" xref="S1.p4.1.m1.2.2.1.1">superscript</csymbol><apply id="S1.p4.1.m1.2.2.1.1.2.cmml" xref="S1.p4.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.2.2.1.1.2.1.cmml" xref="S1.p4.1.m1.2.2.1.1">subscript</csymbol><ci id="S1.p4.1.m1.2.2.1.1.2.2.cmml" xref="S1.p4.1.m1.2.2.1.1.2.2">𝐰</ci><ci id="S1.p4.1.m1.2.2.1.1.2.3.cmml" xref="S1.p4.1.m1.2.2.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S1.p4.1.m1.2.2.1.1.3.cmml" xref="S1.p4.1.m1.2.2.1.1.3">1</cn></apply><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">⋯</ci><apply id="S1.p4.1.m1.3.3.2.2.cmml" xref="S1.p4.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S1.p4.1.m1.3.3.2.2.1.cmml" xref="S1.p4.1.m1.3.3.2.2">superscript</csymbol><apply id="S1.p4.1.m1.3.3.2.2.2.cmml" xref="S1.p4.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S1.p4.1.m1.3.3.2.2.2.1.cmml" xref="S1.p4.1.m1.3.3.2.2">subscript</csymbol><ci id="S1.p4.1.m1.3.3.2.2.2.2.cmml" xref="S1.p4.1.m1.3.3.2.2.2.2">𝐰</ci><ci id="S1.p4.1.m1.3.3.2.2.2.3.cmml" xref="S1.p4.1.m1.3.3.2.2.2.3">𝑡</ci></apply><ci id="S1.p4.1.m1.3.3.2.2.3.cmml" xref="S1.p4.1.m1.3.3.2.2.3">𝐵</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.3c">\{\mathbf{w}_{t}^{1},\cdots,\mathbf{w}_{t}^{B}\}</annotation></semantics></math>, where <math id="S1.p4.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S1.p4.2.m2.1a"><mi id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">B</annotation></semantics></math> is the number of active clients in the <math id="S1.p4.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S1.p4.3.m3.1a"><mi id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><ci id="S1.p4.3.m3.1.1.cmml" xref="S1.p4.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">t</annotation></semantics></math>-the communication round. This technique involves the dynamic grouping of model layers based on their functions, i.e., <em id="S1.p4.3.7" class="ltx_emph ltx_font_italic">layer-wise decomposition</em> and <em id="S1.p4.3.8" class="ltx_emph ltx_font_italic">function-driven layer grouping</em> in Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
To handle <span id="S1.p4.3.9" class="ltx_text ltx_font_bold">C1</span>, a heuristic rule-based search strategy is proposed in <em id="S1.p4.3.10" class="ltx_emph ltx_font_italic">reassembly candidate generation</em> to assemble informative and diverse model candidates using clustering results.
Importantly, all layers in each candidate are derived from the uploaded client models.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.4" class="ltx_p">Prior to matching the client model with candidates, we perform network <em id="S1.p5.4.1" class="ltx_emph ltx_font_italic">layer stitching</em> while maximizing the retention of information from the original client models (Section <a href="#S3.SS1.SSS3" title='3.1.3 Similarity Learning with Layer Stitching – "sim"⁢(⋅,⋅) ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly' class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1.3</span></a>).
To tackle <span id="S1.p5.4.2" class="ltx_text ltx_font_bold">C2</span>, we introduce public data <math id="S1.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{p}" display="inline"><semantics id="S1.p5.1.m1.1a"><msub id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p5.1.m1.1.1.2" xref="S1.p5.1.m1.1.1.2.cmml">𝒟</mi><mi id="S1.p5.1.m1.1.1.3" xref="S1.p5.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><apply id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p5.1.m1.1.1.1.cmml" xref="S1.p5.1.m1.1.1">subscript</csymbol><ci id="S1.p5.1.m1.1.1.2.cmml" xref="S1.p5.1.m1.1.1.2">𝒟</ci><ci id="S1.p5.1.m1.1.1.3.cmml" xref="S1.p5.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">\mathcal{D}_{p}</annotation></semantics></math> to help the finetuning of the stitched candidates, i.e., <math id="S1.p5.2.m2.3" class="ltx_Math" alttext="\{\tilde{\mathbf{c}}_{t}^{1},\cdots,\tilde{\mathbf{c}}_{t}^{M}\}" display="inline"><semantics id="S1.p5.2.m2.3a"><mrow id="S1.p5.2.m2.3.3.2" xref="S1.p5.2.m2.3.3.3.cmml"><mo stretchy="false" id="S1.p5.2.m2.3.3.2.3" xref="S1.p5.2.m2.3.3.3.cmml">{</mo><msubsup id="S1.p5.2.m2.2.2.1.1" xref="S1.p5.2.m2.2.2.1.1.cmml"><mover accent="true" id="S1.p5.2.m2.2.2.1.1.2.2" xref="S1.p5.2.m2.2.2.1.1.2.2.cmml"><mi id="S1.p5.2.m2.2.2.1.1.2.2.2" xref="S1.p5.2.m2.2.2.1.1.2.2.2.cmml">𝐜</mi><mo id="S1.p5.2.m2.2.2.1.1.2.2.1" xref="S1.p5.2.m2.2.2.1.1.2.2.1.cmml">~</mo></mover><mi id="S1.p5.2.m2.2.2.1.1.2.3" xref="S1.p5.2.m2.2.2.1.1.2.3.cmml">t</mi><mn id="S1.p5.2.m2.2.2.1.1.3" xref="S1.p5.2.m2.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S1.p5.2.m2.3.3.2.4" xref="S1.p5.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml">⋯</mi><mo id="S1.p5.2.m2.3.3.2.5" xref="S1.p5.2.m2.3.3.3.cmml">,</mo><msubsup id="S1.p5.2.m2.3.3.2.2" xref="S1.p5.2.m2.3.3.2.2.cmml"><mover accent="true" id="S1.p5.2.m2.3.3.2.2.2.2" xref="S1.p5.2.m2.3.3.2.2.2.2.cmml"><mi id="S1.p5.2.m2.3.3.2.2.2.2.2" xref="S1.p5.2.m2.3.3.2.2.2.2.2.cmml">𝐜</mi><mo id="S1.p5.2.m2.3.3.2.2.2.2.1" xref="S1.p5.2.m2.3.3.2.2.2.2.1.cmml">~</mo></mover><mi id="S1.p5.2.m2.3.3.2.2.2.3" xref="S1.p5.2.m2.3.3.2.2.2.3.cmml">t</mi><mi id="S1.p5.2.m2.3.3.2.2.3" xref="S1.p5.2.m2.3.3.2.2.3.cmml">M</mi></msubsup><mo stretchy="false" id="S1.p5.2.m2.3.3.2.6" xref="S1.p5.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.3b"><set id="S1.p5.2.m2.3.3.3.cmml" xref="S1.p5.2.m2.3.3.2"><apply id="S1.p5.2.m2.2.2.1.1.cmml" xref="S1.p5.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S1.p5.2.m2.2.2.1.1.1.cmml" xref="S1.p5.2.m2.2.2.1.1">superscript</csymbol><apply id="S1.p5.2.m2.2.2.1.1.2.cmml" xref="S1.p5.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S1.p5.2.m2.2.2.1.1.2.1.cmml" xref="S1.p5.2.m2.2.2.1.1">subscript</csymbol><apply id="S1.p5.2.m2.2.2.1.1.2.2.cmml" xref="S1.p5.2.m2.2.2.1.1.2.2"><ci id="S1.p5.2.m2.2.2.1.1.2.2.1.cmml" xref="S1.p5.2.m2.2.2.1.1.2.2.1">~</ci><ci id="S1.p5.2.m2.2.2.1.1.2.2.2.cmml" xref="S1.p5.2.m2.2.2.1.1.2.2.2">𝐜</ci></apply><ci id="S1.p5.2.m2.2.2.1.1.2.3.cmml" xref="S1.p5.2.m2.2.2.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S1.p5.2.m2.2.2.1.1.3.cmml" xref="S1.p5.2.m2.2.2.1.1.3">1</cn></apply><ci id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1">⋯</ci><apply id="S1.p5.2.m2.3.3.2.2.cmml" xref="S1.p5.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S1.p5.2.m2.3.3.2.2.1.cmml" xref="S1.p5.2.m2.3.3.2.2">superscript</csymbol><apply id="S1.p5.2.m2.3.3.2.2.2.cmml" xref="S1.p5.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S1.p5.2.m2.3.3.2.2.2.1.cmml" xref="S1.p5.2.m2.3.3.2.2">subscript</csymbol><apply id="S1.p5.2.m2.3.3.2.2.2.2.cmml" xref="S1.p5.2.m2.3.3.2.2.2.2"><ci id="S1.p5.2.m2.3.3.2.2.2.2.1.cmml" xref="S1.p5.2.m2.3.3.2.2.2.2.1">~</ci><ci id="S1.p5.2.m2.3.3.2.2.2.2.2.cmml" xref="S1.p5.2.m2.3.3.2.2.2.2.2">𝐜</ci></apply><ci id="S1.p5.2.m2.3.3.2.2.2.3.cmml" xref="S1.p5.2.m2.3.3.2.2.2.3">𝑡</ci></apply><ci id="S1.p5.2.m2.3.3.2.2.3.cmml" xref="S1.p5.2.m2.3.3.2.2.3">𝑀</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.3c">\{\tilde{\mathbf{c}}_{t}^{1},\cdots,\tilde{\mathbf{c}}_{t}^{M}\}</annotation></semantics></math>, where <math id="S1.p5.3.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S1.p5.3.m3.1a"><mi id="S1.p5.3.m3.1.1" xref="S1.p5.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.p5.3.m3.1b"><ci id="S1.p5.3.m3.1.1.cmml" xref="S1.p5.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.3.m3.1c">M</annotation></semantics></math> is the number of generated candidates.
Specifically, we employ labeled <span id="S1.p5.4.3" class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline">OR</span> unlabeled public data to fine-tune the stitched and client models and then calculate similarities based on model outputs.
Intuitively, if two models are highly related to each other, their outputs should also be similar.
Therefore, we select the candidate with the highest similarity as the personalized model of the corresponding client, which results in matched pairs <math id="S1.p5.4.m4.3" class="ltx_Math" alttext="\{\{\mathbf{w}_{t}^{1},\tilde{\mathbf{c}}_{t}^{i}\},\cdots,\{\mathbf{w}_{t}^{B},\tilde{\mathbf{c}}_{t}^{m}\}\}" display="inline"><semantics id="S1.p5.4.m4.3a"><mrow id="S1.p5.4.m4.3.3.2" xref="S1.p5.4.m4.3.3.3.cmml"><mo stretchy="false" id="S1.p5.4.m4.3.3.2.3" xref="S1.p5.4.m4.3.3.3.cmml">{</mo><mrow id="S1.p5.4.m4.2.2.1.1.2" xref="S1.p5.4.m4.2.2.1.1.3.cmml"><mo stretchy="false" id="S1.p5.4.m4.2.2.1.1.2.3" xref="S1.p5.4.m4.2.2.1.1.3.cmml">{</mo><msubsup id="S1.p5.4.m4.2.2.1.1.1.1" xref="S1.p5.4.m4.2.2.1.1.1.1.cmml"><mi id="S1.p5.4.m4.2.2.1.1.1.1.2.2" xref="S1.p5.4.m4.2.2.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S1.p5.4.m4.2.2.1.1.1.1.2.3" xref="S1.p5.4.m4.2.2.1.1.1.1.2.3.cmml">t</mi><mn id="S1.p5.4.m4.2.2.1.1.1.1.3" xref="S1.p5.4.m4.2.2.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S1.p5.4.m4.2.2.1.1.2.4" xref="S1.p5.4.m4.2.2.1.1.3.cmml">,</mo><msubsup id="S1.p5.4.m4.2.2.1.1.2.2" xref="S1.p5.4.m4.2.2.1.1.2.2.cmml"><mover accent="true" id="S1.p5.4.m4.2.2.1.1.2.2.2.2" xref="S1.p5.4.m4.2.2.1.1.2.2.2.2.cmml"><mi id="S1.p5.4.m4.2.2.1.1.2.2.2.2.2" xref="S1.p5.4.m4.2.2.1.1.2.2.2.2.2.cmml">𝐜</mi><mo id="S1.p5.4.m4.2.2.1.1.2.2.2.2.1" xref="S1.p5.4.m4.2.2.1.1.2.2.2.2.1.cmml">~</mo></mover><mi id="S1.p5.4.m4.2.2.1.1.2.2.2.3" xref="S1.p5.4.m4.2.2.1.1.2.2.2.3.cmml">t</mi><mi id="S1.p5.4.m4.2.2.1.1.2.2.3" xref="S1.p5.4.m4.2.2.1.1.2.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="S1.p5.4.m4.2.2.1.1.2.5" xref="S1.p5.4.m4.2.2.1.1.3.cmml">}</mo></mrow><mo id="S1.p5.4.m4.3.3.2.4" xref="S1.p5.4.m4.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S1.p5.4.m4.1.1" xref="S1.p5.4.m4.1.1.cmml">⋯</mi><mo id="S1.p5.4.m4.3.3.2.5" xref="S1.p5.4.m4.3.3.3.cmml">,</mo><mrow id="S1.p5.4.m4.3.3.2.2.2" xref="S1.p5.4.m4.3.3.2.2.3.cmml"><mo stretchy="false" id="S1.p5.4.m4.3.3.2.2.2.3" xref="S1.p5.4.m4.3.3.2.2.3.cmml">{</mo><msubsup id="S1.p5.4.m4.3.3.2.2.1.1" xref="S1.p5.4.m4.3.3.2.2.1.1.cmml"><mi id="S1.p5.4.m4.3.3.2.2.1.1.2.2" xref="S1.p5.4.m4.3.3.2.2.1.1.2.2.cmml">𝐰</mi><mi id="S1.p5.4.m4.3.3.2.2.1.1.2.3" xref="S1.p5.4.m4.3.3.2.2.1.1.2.3.cmml">t</mi><mi id="S1.p5.4.m4.3.3.2.2.1.1.3" xref="S1.p5.4.m4.3.3.2.2.1.1.3.cmml">B</mi></msubsup><mo id="S1.p5.4.m4.3.3.2.2.2.4" xref="S1.p5.4.m4.3.3.2.2.3.cmml">,</mo><msubsup id="S1.p5.4.m4.3.3.2.2.2.2" xref="S1.p5.4.m4.3.3.2.2.2.2.cmml"><mover accent="true" id="S1.p5.4.m4.3.3.2.2.2.2.2.2" xref="S1.p5.4.m4.3.3.2.2.2.2.2.2.cmml"><mi id="S1.p5.4.m4.3.3.2.2.2.2.2.2.2" xref="S1.p5.4.m4.3.3.2.2.2.2.2.2.2.cmml">𝐜</mi><mo id="S1.p5.4.m4.3.3.2.2.2.2.2.2.1" xref="S1.p5.4.m4.3.3.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S1.p5.4.m4.3.3.2.2.2.2.2.3" xref="S1.p5.4.m4.3.3.2.2.2.2.2.3.cmml">t</mi><mi id="S1.p5.4.m4.3.3.2.2.2.2.3" xref="S1.p5.4.m4.3.3.2.2.2.2.3.cmml">m</mi></msubsup><mo stretchy="false" id="S1.p5.4.m4.3.3.2.2.2.5" xref="S1.p5.4.m4.3.3.2.2.3.cmml">}</mo></mrow><mo stretchy="false" id="S1.p5.4.m4.3.3.2.6" xref="S1.p5.4.m4.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.4.m4.3b"><set id="S1.p5.4.m4.3.3.3.cmml" xref="S1.p5.4.m4.3.3.2"><set id="S1.p5.4.m4.2.2.1.1.3.cmml" xref="S1.p5.4.m4.2.2.1.1.2"><apply id="S1.p5.4.m4.2.2.1.1.1.1.cmml" xref="S1.p5.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S1.p5.4.m4.2.2.1.1.1.1.1.cmml" xref="S1.p5.4.m4.2.2.1.1.1.1">superscript</csymbol><apply id="S1.p5.4.m4.2.2.1.1.1.1.2.cmml" xref="S1.p5.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S1.p5.4.m4.2.2.1.1.1.1.2.1.cmml" xref="S1.p5.4.m4.2.2.1.1.1.1">subscript</csymbol><ci id="S1.p5.4.m4.2.2.1.1.1.1.2.2.cmml" xref="S1.p5.4.m4.2.2.1.1.1.1.2.2">𝐰</ci><ci id="S1.p5.4.m4.2.2.1.1.1.1.2.3.cmml" xref="S1.p5.4.m4.2.2.1.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S1.p5.4.m4.2.2.1.1.1.1.3.cmml" xref="S1.p5.4.m4.2.2.1.1.1.1.3">1</cn></apply><apply id="S1.p5.4.m4.2.2.1.1.2.2.cmml" xref="S1.p5.4.m4.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S1.p5.4.m4.2.2.1.1.2.2.1.cmml" xref="S1.p5.4.m4.2.2.1.1.2.2">superscript</csymbol><apply id="S1.p5.4.m4.2.2.1.1.2.2.2.cmml" xref="S1.p5.4.m4.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S1.p5.4.m4.2.2.1.1.2.2.2.1.cmml" xref="S1.p5.4.m4.2.2.1.1.2.2">subscript</csymbol><apply id="S1.p5.4.m4.2.2.1.1.2.2.2.2.cmml" xref="S1.p5.4.m4.2.2.1.1.2.2.2.2"><ci id="S1.p5.4.m4.2.2.1.1.2.2.2.2.1.cmml" xref="S1.p5.4.m4.2.2.1.1.2.2.2.2.1">~</ci><ci id="S1.p5.4.m4.2.2.1.1.2.2.2.2.2.cmml" xref="S1.p5.4.m4.2.2.1.1.2.2.2.2.2">𝐜</ci></apply><ci id="S1.p5.4.m4.2.2.1.1.2.2.2.3.cmml" xref="S1.p5.4.m4.2.2.1.1.2.2.2.3">𝑡</ci></apply><ci id="S1.p5.4.m4.2.2.1.1.2.2.3.cmml" xref="S1.p5.4.m4.2.2.1.1.2.2.3">𝑖</ci></apply></set><ci id="S1.p5.4.m4.1.1.cmml" xref="S1.p5.4.m4.1.1">⋯</ci><set id="S1.p5.4.m4.3.3.2.2.3.cmml" xref="S1.p5.4.m4.3.3.2.2.2"><apply id="S1.p5.4.m4.3.3.2.2.1.1.cmml" xref="S1.p5.4.m4.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S1.p5.4.m4.3.3.2.2.1.1.1.cmml" xref="S1.p5.4.m4.3.3.2.2.1.1">superscript</csymbol><apply id="S1.p5.4.m4.3.3.2.2.1.1.2.cmml" xref="S1.p5.4.m4.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S1.p5.4.m4.3.3.2.2.1.1.2.1.cmml" xref="S1.p5.4.m4.3.3.2.2.1.1">subscript</csymbol><ci id="S1.p5.4.m4.3.3.2.2.1.1.2.2.cmml" xref="S1.p5.4.m4.3.3.2.2.1.1.2.2">𝐰</ci><ci id="S1.p5.4.m4.3.3.2.2.1.1.2.3.cmml" xref="S1.p5.4.m4.3.3.2.2.1.1.2.3">𝑡</ci></apply><ci id="S1.p5.4.m4.3.3.2.2.1.1.3.cmml" xref="S1.p5.4.m4.3.3.2.2.1.1.3">𝐵</ci></apply><apply id="S1.p5.4.m4.3.3.2.2.2.2.cmml" xref="S1.p5.4.m4.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S1.p5.4.m4.3.3.2.2.2.2.1.cmml" xref="S1.p5.4.m4.3.3.2.2.2.2">superscript</csymbol><apply id="S1.p5.4.m4.3.3.2.2.2.2.2.cmml" xref="S1.p5.4.m4.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S1.p5.4.m4.3.3.2.2.2.2.2.1.cmml" xref="S1.p5.4.m4.3.3.2.2.2.2">subscript</csymbol><apply id="S1.p5.4.m4.3.3.2.2.2.2.2.2.cmml" xref="S1.p5.4.m4.3.3.2.2.2.2.2.2"><ci id="S1.p5.4.m4.3.3.2.2.2.2.2.2.1.cmml" xref="S1.p5.4.m4.3.3.2.2.2.2.2.2.1">~</ci><ci id="S1.p5.4.m4.3.3.2.2.2.2.2.2.2.cmml" xref="S1.p5.4.m4.3.3.2.2.2.2.2.2.2">𝐜</ci></apply><ci id="S1.p5.4.m4.3.3.2.2.2.2.2.3.cmml" xref="S1.p5.4.m4.3.3.2.2.2.2.2.3">𝑡</ci></apply><ci id="S1.p5.4.m4.3.3.2.2.2.2.3.cmml" xref="S1.p5.4.m4.3.3.2.2.2.2.3">𝑚</ci></apply></set></set></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.4.m4.3c">\{\{\mathbf{w}_{t}^{1},\tilde{\mathbf{c}}_{t}^{i}\},\cdots,\{\mathbf{w}_{t}^{B},\tilde{\mathbf{c}}_{t}^{m}\}\}</annotation></semantics></math> in Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
In the <span id="S1.p5.4.4" class="ltx_text ltx_font_bold">client</span> update (Section <a href="#S3.SS2" title="3.2 Client Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>), we treat the matched personalized model as a guidance mechanism for client parameter learning using knowledge distillation<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Note that the network architecture of both local model and personalized model are known, and thus, there is no human intervention in the client update.</span></span></span>.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">It is worth noting that we <span id="S1.p6.1.1" class="ltx_text ltx_font_bold">minimally use public data</span> during our model learning to reduce their adverse impact.
In our model design, the public data are used for clustering layers, fine-tuning the stitched candidates, and guiding model matching.
Clustering and matching stages use public data to obtain the feedforward outputs as guidance and do not involve model parameter updates.
<em id="S1.p6.1.2" class="ltx_emph ltx_font_italic">Only in the fine-tuning stage, the stitched models’ parameters will be updated based on public data.</em>
To reduce its impact as much as possible, we limit the number of finetuning epochs during the model implementation.
Although we cannot thoroughly break the tie between model training and public data, such a design at least greatly alleviates the problem of public data sensitivity in FL.</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2308.08643/assets/x2.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="406" height="173" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F2.5.2.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S1.F2.2.1" class="ltx_text" style="font-size:90%;">Overview of the proposed <span id="S1.F2.2.1.1" class="ltx_text ltx_font_typewriter">pFedHR</span>. <math id="S1.F2.2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S1.F2.2.1.m1.1b"><mi id="S1.F2.2.1.m1.1.1" xref="S1.F2.2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.F2.2.1.m1.1c"><ci id="S1.F2.2.1.m1.1.1.cmml" xref="S1.F2.2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.2.1.m1.1d">K</annotation></semantics></math> is the number of clusters.</span></figcaption>
</figure>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p"><span id="S1.p7.1.1" class="ltx_text ltx_font_bold">Contributions</span>. Our work makes the following key contributions: (1) We introduce the first personalized federated learning framework based on model reassembly, specifically designed to address the challenges of heterogeneous model cooperation. (2) The proposed <span id="S1.p7.1.2" class="ltx_text ltx_font_typewriter">pFedHR</span> framework demonstrates the ability to automatically and dynamically generate personalized candidates that are both informative and diverse, requiring minimal human intervention. (3) We present a novel heterogeneous model reassembly technique, which effectively mitigates the adverse impact caused by using public data with distributions different from client data. (4) Experimental results show that the <span id="S1.p7.1.3" class="ltx_text ltx_font_typewriter">pFedHR</span> framework achieves state-of-the-art performance on three datasets, exhibiting superior performance under both IID and Non-IID settings when compared to baselines employing labeled and unlabeled public datasets.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Model Heterogeneity in Federated Learning</span>.
Although many federated learning models, such as FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, Per-FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, PFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, and PFedBayes<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, have been proposed recently, the focus on heterogeneous model cooperation, where clients possess models with diverse structures, remains limited. It is worth noting that in this context, the client models are originally distinct and not derived from a shared, large global model through the distillation of subnetworks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. Existing studies on heterogeneous model cooperation can be broadly categorized based on whether they utilize public data for model training.
FedKD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> aims to achieve personalized models for each client <span id="S2.p1.1.2" class="ltx_text ltx_font_bold">without employing public data</span> by simultaneously maintaining a large heterogeneous model and a small homogeneous model on each client, which incurs high computational costs.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Most existing approaches <span id="S2.p2.1.1" class="ltx_text ltx_font_bold">leverage public data</span> to facilitate model training. Among them, FedDF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, FedKEMF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, and FCCL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> employ <em id="S2.p2.1.2" class="ltx_emph ltx_font_italic">unlabeled public data</em>. However, FedDF trains a global model with different settings compared to our approach. FedKEMF performs mutual knowledge distillation learning on the server side to achieve model personalization, requiring predefined model structures. FCCL averages the logits provided by each client and utilizes a consensus logit as guidance during local model training. It is worth noting that the use of logits raises concerns regarding privacy and security <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. FedMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and FedGH <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> employ <em id="S2.p2.1.3" class="ltx_emph ltx_font_italic">labeled public data</em>. These approaches exchange class information or representations between the server and clients and perform aggregation to address the model heterogeneity issue. However, similar to FCCL, these methods also introduce privacy leakage concerns.
In contrast to existing work, we propose a general framework capable of utilizing either <span id="S2.p2.1.4" class="ltx_text ltx_font_bold">labeled OR unlabeled public data</span> to learn personalized models through heterogeneous model reassembly. We summarize the distinctions between existing approaches and our framework in Table <a href="#S2.T1" title="Table 1 ‣ 2 Related Work ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Neural Network Reassembly and Stitching</span>.
As illustrated in Table <a href="#S2.T1" title="Table 1 ‣ 2 Related Work ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, conventional methods are primarily employed in existing federated learning approaches to obtain personalized client models, with limited exploration of model reassembly. Additionally, there is a lack of research investigating neural network reassembly and stitching <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> within the context of federated learning. For instance, the work presented in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> proposes three algorithms to merge two models within the weight space, but it is limited to handling only two models as input. In our setting, multiple models need to be incorporated into the model reassembly or aggregation process. Furthermore, both <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> focus on pre-trained models, which differ from our specific scenario.</p>
</div>
<figure id="S2.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S2.T1.3.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S2.T1.4.2" class="ltx_text" style="font-size:90%;">A comparison between existing heterogeneous model cooperation works and our <span id="S2.T1.4.2.1" class="ltx_text ltx_font_typewriter">pFedHR</span>.</span></figcaption>
<div id="S2.T1.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:88.9pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-109.5pt,27.9pt) scale(0.613042158472457,0.613042158472457) ;">
<table id="S2.T1.5.1" class="ltx_tabular ltx_align_middle">
<tr id="S2.T1.5.1.1" class="ltx_tr">
<td id="S2.T1.5.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" rowspan="2"><span id="S2.T1.5.1.1.1.1" class="ltx_text ltx_font_bold">Approach</span></td>
<td id="S2.T1.5.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2"><span id="S2.T1.5.1.1.2.1" class="ltx_text ltx_font_bold">Public Dataset</span></td>
<td id="S2.T1.5.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="3"><span id="S2.T1.5.1.1.3.1" class="ltx_text ltx_font_bold">Model Characteristics</span></td>
</tr>
<tr id="S2.T1.5.1.2" class="ltx_tr">
<td id="S2.T1.5.1.2.1" class="ltx_td ltx_align_center ltx_border_t">W. Label</td>
<td id="S2.T1.5.1.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">W.o. Label</td>
<td id="S2.T1.5.1.2.3" class="ltx_td ltx_align_center ltx_border_t">Upload and Download</td>
<td id="S2.T1.5.1.2.4" class="ltx_td ltx_align_center ltx_border_t">Aggregation</td>
<td id="S2.T1.5.1.2.5" class="ltx_td ltx_align_center ltx_border_t">Personalization</td>
</tr>
<tr id="S2.T1.5.1.3" class="ltx_tr" style="background-color:#E6E6E6;">
<td id="S2.T1.5.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S2.T1.5.1.3.1.1" class="ltx_text" style="background-color:#E6E6E6;">FedDF<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite></span></td>
<td id="S2.T1.5.1.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.5.1.3.2.1" class="ltx_text" style="background-color:#E6E6E6;">✗</span></td>
<td id="S2.T1.5.1.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S2.T1.5.1.3.3.1" class="ltx_text" style="background-color:#E6E6E6;">✓</span></td>
<td id="S2.T1.5.1.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.5.1.3.4.1" class="ltx_text" style="background-color:#E6E6E6;">parameters</span></td>
<td id="S2.T1.5.1.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.5.1.3.5.1" class="ltx_text" style="background-color:#E6E6E6;">ensemble distillation</span></td>
<td id="S2.T1.5.1.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S2.T1.5.1.3.6.1" class="ltx_text" style="background-color:#E6E6E6;">✗</span></td>
</tr>
<tr id="S2.T1.5.1.4" class="ltx_tr">
<td id="S2.T1.5.1.4.1" class="ltx_td ltx_align_left ltx_border_r">FedKEMF<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>
</td>
<td id="S2.T1.5.1.4.2" class="ltx_td ltx_align_center">✗</td>
<td id="S2.T1.5.1.4.3" class="ltx_td ltx_align_center ltx_border_r">✓</td>
<td id="S2.T1.5.1.4.4" class="ltx_td ltx_align_center">parameters</td>
<td id="S2.T1.5.1.4.5" class="ltx_td ltx_align_center">mutual learning</td>
<td id="S2.T1.5.1.4.6" class="ltx_td ltx_align_center">✓</td>
</tr>
<tr id="S2.T1.5.1.5" class="ltx_tr">
<td id="S2.T1.5.1.5.1" class="ltx_td ltx_align_left ltx_border_r">FCCL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</td>
<td id="S2.T1.5.1.5.2" class="ltx_td ltx_align_center">✗</td>
<td id="S2.T1.5.1.5.3" class="ltx_td ltx_align_center ltx_border_r">✓</td>
<td id="S2.T1.5.1.5.4" class="ltx_td ltx_align_center">logits</td>
<td id="S2.T1.5.1.5.5" class="ltx_td ltx_align_center">average</td>
<td id="S2.T1.5.1.5.6" class="ltx_td ltx_align_center">✓</td>
</tr>
<tr id="S2.T1.5.1.6" class="ltx_tr">
<td id="S2.T1.5.1.6.1" class="ltx_td ltx_align_left ltx_border_r">FedMD<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</td>
<td id="S2.T1.5.1.6.2" class="ltx_td ltx_align_center">✓</td>
<td id="S2.T1.5.1.6.3" class="ltx_td ltx_align_center ltx_border_r">✗</td>
<td id="S2.T1.5.1.6.4" class="ltx_td ltx_align_center">class scores</td>
<td id="S2.T1.5.1.6.5" class="ltx_td ltx_align_center">average</td>
<td id="S2.T1.5.1.6.6" class="ltx_td ltx_align_center">✓</td>
</tr>
<tr id="S2.T1.5.1.7" class="ltx_tr">
<td id="S2.T1.5.1.7.1" class="ltx_td ltx_align_left ltx_border_r">FedGH <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>
</td>
<td id="S2.T1.5.1.7.2" class="ltx_td ltx_align_center">✓</td>
<td id="S2.T1.5.1.7.3" class="ltx_td ltx_align_center ltx_border_r">✗</td>
<td id="S2.T1.5.1.7.4" class="ltx_td ltx_align_center">label-wise representations</td>
<td id="S2.T1.5.1.7.5" class="ltx_td ltx_align_center">average</td>
<td id="S2.T1.5.1.7.6" class="ltx_td ltx_align_center">✓</td>
</tr>
<tr id="S2.T1.5.1.8" class="ltx_tr" style="background-color:#FFCCCC;">
<td id="S2.T1.5.1.8.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><span id="S2.T1.5.1.8.1.1" class="ltx_text ltx_font_typewriter" style="background-color:#FFCCCC;">pFedHR</span></td>
<td id="S2.T1.5.1.8.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S2.T1.5.1.8.2.1" class="ltx_text" style="background-color:#FFCCCC;">✓</span></td>
<td id="S2.T1.5.1.8.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S2.T1.5.1.8.3.1" class="ltx_text" style="background-color:#FFCCCC;">✓</span></td>
<td id="S2.T1.5.1.8.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S2.T1.5.1.8.4.1" class="ltx_text" style="background-color:#FFCCCC;">parameters</span></td>
<td id="S2.T1.5.1.8.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S2.T1.5.1.8.5.1" class="ltx_text" style="background-color:#FFCCCC;">model reassembly</span></td>
<td id="S2.T1.5.1.8.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S2.T1.5.1.8.6.1" class="ltx_text" style="background-color:#FFCCCC;">✓</span></td>
</tr>
</table>
</span></div>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Our model <span id="S3.p1.1.1" class="ltx_text ltx_font_typewriter">pFedHR</span> incorporates two key updates: the server update and the local update, as depicted in Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Next, we provide the details of our model design starting with the server update.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Server Update</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.8" class="ltx_p">During each communication round <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">t</annotation></semantics></math>, the server will receive <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">B</annotation></semantics></math> heterogeneous client models with parameters denoted as <math id="S3.SS1.p1.3.m3.4" class="ltx_Math" alttext="\{\mathbf{w}_{t}^{1},\mathbf{w}_{t}^{2},\cdots,\mathbf{w}_{t}^{B}\}" display="inline"><semantics id="S3.SS1.p1.3.m3.4a"><mrow id="S3.SS1.p1.3.m3.4.4.3" xref="S3.SS1.p1.3.m3.4.4.4.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.4.4.3.4" xref="S3.SS1.p1.3.m3.4.4.4.cmml">{</mo><msubsup id="S3.SS1.p1.3.m3.2.2.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.2.2" xref="S3.SS1.p1.3.m3.2.2.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.p1.3.m3.2.2.1.1.2.3" xref="S3.SS1.p1.3.m3.2.2.1.1.2.3.cmml">t</mi><mn id="S3.SS1.p1.3.m3.2.2.1.1.3" xref="S3.SS1.p1.3.m3.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.p1.3.m3.4.4.3.5" xref="S3.SS1.p1.3.m3.4.4.4.cmml">,</mo><msubsup id="S3.SS1.p1.3.m3.3.3.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS1.p1.3.m3.3.3.2.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS1.p1.3.m3.3.3.2.2.2.3" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml">t</mi><mn id="S3.SS1.p1.3.m3.3.3.2.2.3" xref="S3.SS1.p1.3.m3.3.3.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.p1.3.m3.4.4.3.6" xref="S3.SS1.p1.3.m3.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.3.m3.4.4.3.7" xref="S3.SS1.p1.3.m3.4.4.4.cmml">,</mo><msubsup id="S3.SS1.p1.3.m3.4.4.3.3" xref="S3.SS1.p1.3.m3.4.4.3.3.cmml"><mi id="S3.SS1.p1.3.m3.4.4.3.3.2.2" xref="S3.SS1.p1.3.m3.4.4.3.3.2.2.cmml">𝐰</mi><mi id="S3.SS1.p1.3.m3.4.4.3.3.2.3" xref="S3.SS1.p1.3.m3.4.4.3.3.2.3.cmml">t</mi><mi id="S3.SS1.p1.3.m3.4.4.3.3.3" xref="S3.SS1.p1.3.m3.4.4.3.3.3.cmml">B</mi></msubsup><mo stretchy="false" id="S3.SS1.p1.3.m3.4.4.3.8" xref="S3.SS1.p1.3.m3.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.4b"><set id="S3.SS1.p1.3.m3.4.4.4.cmml" xref="S3.SS1.p1.3.m3.4.4.3"><apply id="S3.SS1.p1.3.m3.2.2.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1">superscript</csymbol><apply id="S3.SS1.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.2.2">𝐰</ci><ci id="S3.SS1.p1.3.m3.2.2.1.1.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.3">1</cn></apply><apply id="S3.SS1.p1.3.m3.3.3.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2">superscript</csymbol><apply id="S3.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2">𝐰</ci><ci id="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.3">2</cn></apply><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">⋯</ci><apply id="S3.SS1.p1.3.m3.4.4.3.3.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.3.3.1.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3">superscript</csymbol><apply id="S3.SS1.p1.3.m3.4.4.3.3.2.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.4.4.3.3.2.1.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.4.4.3.3.2.2.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.2.2">𝐰</ci><ci id="S3.SS1.p1.3.m3.4.4.3.3.2.3.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.3.m3.4.4.3.3.3.cmml" xref="S3.SS1.p1.3.m3.4.4.3.3.3">𝐵</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.4c">\{\mathbf{w}_{t}^{1},\mathbf{w}_{t}^{2},\cdots,\mathbf{w}_{t}^{B}\}</annotation></semantics></math>. As we discussed in Section <a href="#S1" title="1 Introduction ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, traditional approaches have limitations when applied in this context. To overcome these limitations and learn a personalized model <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\hat{\mathbf{w}}_{t}^{n}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msubsup id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mover accent="true" id="S3.SS1.p1.4.m4.1.1.2.2" xref="S3.SS1.p1.4.m4.1.1.2.2.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2.2.2" xref="S3.SS1.p1.4.m4.1.1.2.2.2.cmml">𝐰</mi><mo id="S3.SS1.p1.4.m4.1.1.2.2.1" xref="S3.SS1.p1.4.m4.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p1.4.m4.1.1.2.3" xref="S3.SS1.p1.4.m4.1.1.2.3.cmml">t</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">superscript</csymbol><apply id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><apply id="S3.SS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2.2"><ci id="S3.SS1.p1.4.m4.1.1.2.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1.2.2.1">^</ci><ci id="S3.SS1.p1.4.m4.1.1.2.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2.2.2">𝐰</ci></apply><ci id="S3.SS1.p1.4.m4.1.1.2.3.cmml" xref="S3.SS1.p1.4.m4.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\hat{\mathbf{w}}_{t}^{n}</annotation></semantics></math> that can be distributed to the corresponding <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">n</annotation></semantics></math>-th client, we propose a novel approach that leverages the publicly available data <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{p}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝒟</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathcal{D}_{p}</annotation></semantics></math> stored on the server to find the <span id="S3.SS1.p1.8.1" class="ltx_text ltx_font_bold">most similar</span> aggregated models learned from <math id="S3.SS1.p1.7.m7.4" class="ltx_Math" alttext="\{\mathbf{w}_{t}^{1},\mathbf{w}_{t}^{2},\cdots,\mathbf{w}_{t}^{B}\}" display="inline"><semantics id="S3.SS1.p1.7.m7.4a"><mrow id="S3.SS1.p1.7.m7.4.4.3" xref="S3.SS1.p1.7.m7.4.4.4.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m7.4.4.3.4" xref="S3.SS1.p1.7.m7.4.4.4.cmml">{</mo><msubsup id="S3.SS1.p1.7.m7.2.2.1.1" xref="S3.SS1.p1.7.m7.2.2.1.1.cmml"><mi id="S3.SS1.p1.7.m7.2.2.1.1.2.2" xref="S3.SS1.p1.7.m7.2.2.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.p1.7.m7.2.2.1.1.2.3" xref="S3.SS1.p1.7.m7.2.2.1.1.2.3.cmml">t</mi><mn id="S3.SS1.p1.7.m7.2.2.1.1.3" xref="S3.SS1.p1.7.m7.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.p1.7.m7.4.4.3.5" xref="S3.SS1.p1.7.m7.4.4.4.cmml">,</mo><msubsup id="S3.SS1.p1.7.m7.3.3.2.2" xref="S3.SS1.p1.7.m7.3.3.2.2.cmml"><mi id="S3.SS1.p1.7.m7.3.3.2.2.2.2" xref="S3.SS1.p1.7.m7.3.3.2.2.2.2.cmml">𝐰</mi><mi id="S3.SS1.p1.7.m7.3.3.2.2.2.3" xref="S3.SS1.p1.7.m7.3.3.2.2.2.3.cmml">t</mi><mn id="S3.SS1.p1.7.m7.3.3.2.2.3" xref="S3.SS1.p1.7.m7.3.3.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.p1.7.m7.4.4.3.6" xref="S3.SS1.p1.7.m7.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.7.m7.4.4.3.7" xref="S3.SS1.p1.7.m7.4.4.4.cmml">,</mo><msubsup id="S3.SS1.p1.7.m7.4.4.3.3" xref="S3.SS1.p1.7.m7.4.4.3.3.cmml"><mi id="S3.SS1.p1.7.m7.4.4.3.3.2.2" xref="S3.SS1.p1.7.m7.4.4.3.3.2.2.cmml">𝐰</mi><mi id="S3.SS1.p1.7.m7.4.4.3.3.2.3" xref="S3.SS1.p1.7.m7.4.4.3.3.2.3.cmml">t</mi><mi id="S3.SS1.p1.7.m7.4.4.3.3.3" xref="S3.SS1.p1.7.m7.4.4.3.3.3.cmml">B</mi></msubsup><mo stretchy="false" id="S3.SS1.p1.7.m7.4.4.3.8" xref="S3.SS1.p1.7.m7.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.4b"><set id="S3.SS1.p1.7.m7.4.4.4.cmml" xref="S3.SS1.p1.7.m7.4.4.3"><apply id="S3.SS1.p1.7.m7.2.2.1.1.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.2.2.1.1.1.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1">superscript</csymbol><apply id="S3.SS1.p1.7.m7.2.2.1.1.2.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.2.2.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.2.2.1.1.2.2.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.2.2">𝐰</ci><ci id="S3.SS1.p1.7.m7.2.2.1.1.2.3.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.p1.7.m7.2.2.1.1.3.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.3">1</cn></apply><apply id="S3.SS1.p1.7.m7.3.3.2.2.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.2.2.1.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2">superscript</csymbol><apply id="S3.SS1.p1.7.m7.3.3.2.2.2.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2.2">𝐰</ci><ci id="S3.SS1.p1.7.m7.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.p1.7.m7.3.3.2.2.3.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.3">2</cn></apply><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">⋯</ci><apply id="S3.SS1.p1.7.m7.4.4.3.3.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.4.4.3.3.1.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3">superscript</csymbol><apply id="S3.SS1.p1.7.m7.4.4.3.3.2.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.4.4.3.3.2.1.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.4.4.3.3.2.2.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3.2.2">𝐰</ci><ci id="S3.SS1.p1.7.m7.4.4.3.3.2.3.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.7.m7.4.4.3.3.3.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3.3">𝐵</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.4c">\{\mathbf{w}_{t}^{1},\mathbf{w}_{t}^{2},\cdots,\mathbf{w}_{t}^{B}\}</annotation></semantics></math> for <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="{\mathbf{w}}_{t}^{n}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><msubsup id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2.2" xref="S3.SS1.p1.8.m8.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.p1.8.m8.1.1.2.3" xref="S3.SS1.p1.8.m8.1.1.2.3.cmml">t</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">superscript</csymbol><apply id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2.2">𝐰</ci><ci id="S3.SS1.p1.8.m8.1.1.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">{\mathbf{w}}_{t}^{n}</annotation></semantics></math>.</p>
</div>
<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Similarity-based Model Matching</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.2" class="ltx_p">Let <math id="S3.SS1.SSS1.p1.1.m1.2" class="ltx_Math" alttext="g(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.SSS1.p1.1.m1.2a"><mrow id="S3.SS1.SSS1.p1.1.m1.2.3" xref="S3.SS1.SSS1.p1.1.m1.2.3.cmml"><mi id="S3.SS1.SSS1.p1.1.m1.2.3.2" xref="S3.SS1.SSS1.p1.1.m1.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.1.m1.2.3.1" xref="S3.SS1.SSS1.p1.1.m1.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS1.p1.1.m1.2.3.3.2" xref="S3.SS1.SSS1.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.1.m1.2.3.3.2.1" xref="S3.SS1.SSS1.p1.1.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.SSS1.p1.1.m1.2.3.3.2.2" xref="S3.SS1.SSS1.p1.1.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.1.m1.2.2" xref="S3.SS1.SSS1.p1.1.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS1.p1.1.m1.2.3.3.2.3" xref="S3.SS1.SSS1.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.2b"><apply id="S3.SS1.SSS1.p1.1.m1.2.3.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.3"><times id="S3.SS1.SSS1.p1.1.m1.2.3.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.3.1"></times><ci id="S3.SS1.SSS1.p1.1.m1.2.3.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.3.2">𝑔</ci><interval closure="open" id="S3.SS1.SSS1.p1.1.m1.2.3.3.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.3.3.2"><ci id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1">⋅</ci><ci id="S3.SS1.SSS1.p1.1.m1.2.2.cmml" xref="S3.SS1.SSS1.p1.1.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.2c">g(\cdot,\cdot)</annotation></semantics></math> denote the model aggregation function, which can automatically and dynamically obtain <math id="S3.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><mi id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><ci id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">M</annotation></semantics></math> aggregated model candidates as follows:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\{\mathbf{c}_{t}^{1},\cdots,\mathbf{c}_{t}^{M}\}=g(\{\mathbf{w}_{t}^{1},\mathbf{w}_{t}^{2},\cdots,\mathbf{w}_{t}^{B}\},\mathcal{D}_{p})," display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.2.3.cmml">{</mo><msubsup id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2.cmml">𝐜</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.2.3.cmml">t</mi><mn id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.E1.m1.3.3.1.1.2.2.4" xref="S3.E1.m1.3.3.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">⋯</mi><mo id="S3.E1.m1.3.3.1.1.2.2.5" xref="S3.E1.m1.3.3.1.1.2.3.cmml">,</mo><msubsup id="S3.E1.m1.3.3.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.cmml">𝐜</mi><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml">t</mi><mi id="S3.E1.m1.3.3.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.3.cmml">M</mi></msubsup><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.2.6" xref="S3.E1.m1.3.3.1.1.2.3.cmml">}</mo></mrow><mo id="S3.E1.m1.3.3.1.1.5" xref="S3.E1.m1.3.3.1.1.5.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.4" xref="S3.E1.m1.3.3.1.1.4.cmml"><mi id="S3.E1.m1.3.3.1.1.4.4" xref="S3.E1.m1.3.3.1.1.4.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.4.3" xref="S3.E1.m1.3.3.1.1.4.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.4.2.2" xref="S3.E1.m1.3.3.1.1.4.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.4.2.2.3" xref="S3.E1.m1.3.3.1.1.4.2.3.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.3.1.1.1.4.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.1.1.1.3.4" xref="S3.E1.m1.3.3.1.1.3.1.1.1.4.cmml">{</mo><msubsup id="S3.E1.m1.3.3.1.1.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.2.3.cmml">t</mi><mn id="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.E1.m1.3.3.1.1.3.1.1.1.3.5" xref="S3.E1.m1.3.3.1.1.3.1.1.1.4.cmml">,</mo><msubsup id="S3.E1.m1.3.3.1.1.3.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.2.2.cmml">𝐰</mi><mi id="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.2.3.cmml">t</mi><mn id="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.3.cmml">2</mn></msubsup><mo id="S3.E1.m1.3.3.1.1.3.1.1.1.3.6" xref="S3.E1.m1.3.3.1.1.3.1.1.1.4.cmml">,</mo><mi mathvariant="normal" id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">⋯</mi><mo id="S3.E1.m1.3.3.1.1.3.1.1.1.3.7" xref="S3.E1.m1.3.3.1.1.3.1.1.1.4.cmml">,</mo><msubsup id="S3.E1.m1.3.3.1.1.3.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.2.2" xref="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.2.2.cmml">𝐰</mi><mi id="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.2.3" xref="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.2.3.cmml">t</mi><mi id="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.3" xref="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.3.cmml">B</mi></msubsup><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.1.1.1.3.8" xref="S3.E1.m1.3.3.1.1.3.1.1.1.4.cmml">}</mo></mrow><mo id="S3.E1.m1.3.3.1.1.4.2.2.4" xref="S3.E1.m1.3.3.1.1.4.2.3.cmml">,</mo><msub id="S3.E1.m1.3.3.1.1.4.2.2.2" xref="S3.E1.m1.3.3.1.1.4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.4.2.2.2.2" xref="S3.E1.m1.3.3.1.1.4.2.2.2.2.cmml">𝒟</mi><mi id="S3.E1.m1.3.3.1.1.4.2.2.2.3" xref="S3.E1.m1.3.3.1.1.4.2.2.2.3.cmml">p</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.1.1.4.2.2.5" xref="S3.E1.m1.3.3.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.5.cmml" xref="S3.E1.m1.3.3.1.1.5"></eq><set id="S3.E1.m1.3.3.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2.2">𝐜</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3">1</cn></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">⋯</ci><apply id="S3.E1.m1.3.3.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2">𝐜</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E1.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3">𝑀</ci></apply></set><apply id="S3.E1.m1.3.3.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.4"><times id="S3.E1.m1.3.3.1.1.4.3.cmml" xref="S3.E1.m1.3.3.1.1.4.3"></times><ci id="S3.E1.m1.3.3.1.1.4.4.cmml" xref="S3.E1.m1.3.3.1.1.4.4">𝑔</ci><interval closure="open" id="S3.E1.m1.3.3.1.1.4.2.3.cmml" xref="S3.E1.m1.3.3.1.1.4.2.2"><set id="S3.E1.m1.3.3.1.1.3.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.3"><apply id="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.2.2">𝐰</ci><ci id="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.1.1.3">1</cn></apply><apply id="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.2.2">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.2.2">𝐰</ci><ci id="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.2.2.3">2</cn></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">⋯</ci><apply id="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.3.3">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.2.2">𝐰</ci><ci id="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.2.3">𝑡</ci></apply><ci id="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.1.1.1.3.3.3">𝐵</ci></apply></set><apply id="S3.E1.m1.3.3.1.1.4.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.4.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.4.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.4.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.4.2.2.2.2">𝒟</ci><ci id="S3.E1.m1.3.3.1.1.4.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.4.2.2.2.3">𝑝</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\{\mathbf{c}_{t}^{1},\cdots,\mathbf{c}_{t}^{M}\}=g(\{\mathbf{w}_{t}^{1},\mathbf{w}_{t}^{2},\cdots,\mathbf{w}_{t}^{B}\},\mathcal{D}_{p}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p1.9" class="ltx_p">where <math id="S3.SS1.SSS1.p1.3.m1.2" class="ltx_Math" alttext="g(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.SSS1.p1.3.m1.2a"><mrow id="S3.SS1.SSS1.p1.3.m1.2.3" xref="S3.SS1.SSS1.p1.3.m1.2.3.cmml"><mi id="S3.SS1.SSS1.p1.3.m1.2.3.2" xref="S3.SS1.SSS1.p1.3.m1.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.3.m1.2.3.1" xref="S3.SS1.SSS1.p1.3.m1.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS1.p1.3.m1.2.3.3.2" xref="S3.SS1.SSS1.p1.3.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.3.m1.2.3.3.2.1" xref="S3.SS1.SSS1.p1.3.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.3.m1.1.1" xref="S3.SS1.SSS1.p1.3.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.SSS1.p1.3.m1.2.3.3.2.2" xref="S3.SS1.SSS1.p1.3.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.3.m1.2.2" xref="S3.SS1.SSS1.p1.3.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS1.p1.3.m1.2.3.3.2.3" xref="S3.SS1.SSS1.p1.3.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m1.2b"><apply id="S3.SS1.SSS1.p1.3.m1.2.3.cmml" xref="S3.SS1.SSS1.p1.3.m1.2.3"><times id="S3.SS1.SSS1.p1.3.m1.2.3.1.cmml" xref="S3.SS1.SSS1.p1.3.m1.2.3.1"></times><ci id="S3.SS1.SSS1.p1.3.m1.2.3.2.cmml" xref="S3.SS1.SSS1.p1.3.m1.2.3.2">𝑔</ci><interval closure="open" id="S3.SS1.SSS1.p1.3.m1.2.3.3.1.cmml" xref="S3.SS1.SSS1.p1.3.m1.2.3.3.2"><ci id="S3.SS1.SSS1.p1.3.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m1.1.1">⋅</ci><ci id="S3.SS1.SSS1.p1.3.m1.2.2.cmml" xref="S3.SS1.SSS1.p1.3.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m1.2c">g(\cdot,\cdot)</annotation></semantics></math> will be detailed in Section <a href="#S3.SS1.SSS2" title="3.1.2 Heterogeneous Model Reassembly – 𝑔⁢(⋅,⋅) ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1.2</span></a>, and <math id="S3.SS1.SSS1.p1.4.m2.1" class="ltx_Math" alttext="\mathbf{c}_{k}^{m}" display="inline"><semantics id="S3.SS1.SSS1.p1.4.m2.1a"><msubsup id="S3.SS1.SSS1.p1.4.m2.1.1" xref="S3.SS1.SSS1.p1.4.m2.1.1.cmml"><mi id="S3.SS1.SSS1.p1.4.m2.1.1.2.2" xref="S3.SS1.SSS1.p1.4.m2.1.1.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS1.p1.4.m2.1.1.2.3" xref="S3.SS1.SSS1.p1.4.m2.1.1.2.3.cmml">k</mi><mi id="S3.SS1.SSS1.p1.4.m2.1.1.3" xref="S3.SS1.SSS1.p1.4.m2.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.4.m2.1b"><apply id="S3.SS1.SSS1.p1.4.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.4.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m2.1.1">superscript</csymbol><apply id="S3.SS1.SSS1.p1.4.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.4.m2.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.4.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.4.m2.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.4.m2.1.1.2.2">𝐜</ci><ci id="S3.SS1.SSS1.p1.4.m2.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.4.m2.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.SSS1.p1.4.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p1.4.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.4.m2.1c">\mathbf{c}_{k}^{m}</annotation></semantics></math> is the <math id="S3.SS1.SSS1.p1.5.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.SSS1.p1.5.m3.1a"><mi id="S3.SS1.SSS1.p1.5.m3.1.1" xref="S3.SS1.SSS1.p1.5.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.5.m3.1b"><ci id="S3.SS1.SSS1.p1.5.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.5.m3.1c">m</annotation></semantics></math>-th generated model candidate learned by <math id="S3.SS1.SSS1.p1.6.m4.2" class="ltx_Math" alttext="g(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.SSS1.p1.6.m4.2a"><mrow id="S3.SS1.SSS1.p1.6.m4.2.3" xref="S3.SS1.SSS1.p1.6.m4.2.3.cmml"><mi id="S3.SS1.SSS1.p1.6.m4.2.3.2" xref="S3.SS1.SSS1.p1.6.m4.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.6.m4.2.3.1" xref="S3.SS1.SSS1.p1.6.m4.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS1.p1.6.m4.2.3.3.2" xref="S3.SS1.SSS1.p1.6.m4.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.6.m4.2.3.3.2.1" xref="S3.SS1.SSS1.p1.6.m4.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.6.m4.1.1" xref="S3.SS1.SSS1.p1.6.m4.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.SSS1.p1.6.m4.2.3.3.2.2" xref="S3.SS1.SSS1.p1.6.m4.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.6.m4.2.2" xref="S3.SS1.SSS1.p1.6.m4.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS1.p1.6.m4.2.3.3.2.3" xref="S3.SS1.SSS1.p1.6.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.6.m4.2b"><apply id="S3.SS1.SSS1.p1.6.m4.2.3.cmml" xref="S3.SS1.SSS1.p1.6.m4.2.3"><times id="S3.SS1.SSS1.p1.6.m4.2.3.1.cmml" xref="S3.SS1.SSS1.p1.6.m4.2.3.1"></times><ci id="S3.SS1.SSS1.p1.6.m4.2.3.2.cmml" xref="S3.SS1.SSS1.p1.6.m4.2.3.2">𝑔</ci><interval closure="open" id="S3.SS1.SSS1.p1.6.m4.2.3.3.1.cmml" xref="S3.SS1.SSS1.p1.6.m4.2.3.3.2"><ci id="S3.SS1.SSS1.p1.6.m4.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m4.1.1">⋅</ci><ci id="S3.SS1.SSS1.p1.6.m4.2.2.cmml" xref="S3.SS1.SSS1.p1.6.m4.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.6.m4.2c">g(\cdot,\cdot)</annotation></semantics></math>. Note that <math id="S3.SS1.SSS1.p1.7.m5.1" class="ltx_Math" alttext="\mathbf{c}_{k}^{m}" display="inline"><semantics id="S3.SS1.SSS1.p1.7.m5.1a"><msubsup id="S3.SS1.SSS1.p1.7.m5.1.1" xref="S3.SS1.SSS1.p1.7.m5.1.1.cmml"><mi id="S3.SS1.SSS1.p1.7.m5.1.1.2.2" xref="S3.SS1.SSS1.p1.7.m5.1.1.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS1.p1.7.m5.1.1.2.3" xref="S3.SS1.SSS1.p1.7.m5.1.1.2.3.cmml">k</mi><mi id="S3.SS1.SSS1.p1.7.m5.1.1.3" xref="S3.SS1.SSS1.p1.7.m5.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.7.m5.1b"><apply id="S3.SS1.SSS1.p1.7.m5.1.1.cmml" xref="S3.SS1.SSS1.p1.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.7.m5.1.1.1.cmml" xref="S3.SS1.SSS1.p1.7.m5.1.1">superscript</csymbol><apply id="S3.SS1.SSS1.p1.7.m5.1.1.2.cmml" xref="S3.SS1.SSS1.p1.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.7.m5.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.7.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.7.m5.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.7.m5.1.1.2.2">𝐜</ci><ci id="S3.SS1.SSS1.p1.7.m5.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.7.m5.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.SSS1.p1.7.m5.1.1.3.cmml" xref="S3.SS1.SSS1.p1.7.m5.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.7.m5.1c">\mathbf{c}_{k}^{m}</annotation></semantics></math> denotes the model before network stitching.
<math id="S3.SS1.SSS1.p1.8.m6.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.SSS1.p1.8.m6.1a"><mi id="S3.SS1.SSS1.p1.8.m6.1.1" xref="S3.SS1.SSS1.p1.8.m6.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.8.m6.1b"><ci id="S3.SS1.SSS1.p1.8.m6.1.1.cmml" xref="S3.SS1.SSS1.p1.8.m6.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.8.m6.1c">M</annotation></semantics></math> is the total number of candidates, which is not a fixed number and is estimated by <math id="S3.SS1.SSS1.p1.9.m7.2" class="ltx_Math" alttext="g(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.SSS1.p1.9.m7.2a"><mrow id="S3.SS1.SSS1.p1.9.m7.2.3" xref="S3.SS1.SSS1.p1.9.m7.2.3.cmml"><mi id="S3.SS1.SSS1.p1.9.m7.2.3.2" xref="S3.SS1.SSS1.p1.9.m7.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.9.m7.2.3.1" xref="S3.SS1.SSS1.p1.9.m7.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS1.p1.9.m7.2.3.3.2" xref="S3.SS1.SSS1.p1.9.m7.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.9.m7.2.3.3.2.1" xref="S3.SS1.SSS1.p1.9.m7.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.9.m7.1.1" xref="S3.SS1.SSS1.p1.9.m7.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.SSS1.p1.9.m7.2.3.3.2.2" xref="S3.SS1.SSS1.p1.9.m7.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.9.m7.2.2" xref="S3.SS1.SSS1.p1.9.m7.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS1.p1.9.m7.2.3.3.2.3" xref="S3.SS1.SSS1.p1.9.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.9.m7.2b"><apply id="S3.SS1.SSS1.p1.9.m7.2.3.cmml" xref="S3.SS1.SSS1.p1.9.m7.2.3"><times id="S3.SS1.SSS1.p1.9.m7.2.3.1.cmml" xref="S3.SS1.SSS1.p1.9.m7.2.3.1"></times><ci id="S3.SS1.SSS1.p1.9.m7.2.3.2.cmml" xref="S3.SS1.SSS1.p1.9.m7.2.3.2">𝑔</ci><interval closure="open" id="S3.SS1.SSS1.p1.9.m7.2.3.3.1.cmml" xref="S3.SS1.SSS1.p1.9.m7.2.3.3.2"><ci id="S3.SS1.SSS1.p1.9.m7.1.1.cmml" xref="S3.SS1.SSS1.p1.9.m7.1.1">⋅</ci><ci id="S3.SS1.SSS1.p1.9.m7.2.2.cmml" xref="S3.SS1.SSS1.p1.9.m7.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.9.m7.2c">g(\cdot,\cdot)</annotation></semantics></math>. In such a way, our goal is to optimize the following function:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.8" class="ltx_Math" alttext="\mathbf{c}_{t}^{*}=\operatorname*{arg\;max}_{\mathbf{c}_{t}^{m};m\in[1,M]}\{\text{sim}({\mathbf{w}}_{t}^{n},\mathbf{c}_{t}^{1};\mathcal{D}_{p}),\cdots,\text{sim}({\mathbf{w}}_{t}^{n},\mathbf{c}_{t}^{M};\mathcal{D}_{p})\},\forall n\in[1,B]," display="block"><semantics id="S3.E2.m1.8a"><mrow id="S3.E2.m1.8.8.1"><mrow id="S3.E2.m1.8.8.1.1.2" xref="S3.E2.m1.8.8.1.1.3.cmml"><mrow id="S3.E2.m1.8.8.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.cmml"><msubsup id="S3.E2.m1.8.8.1.1.1.1.5" xref="S3.E2.m1.8.8.1.1.1.1.5.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.5.2.2" xref="S3.E2.m1.8.8.1.1.1.1.5.2.2.cmml">𝐜</mi><mi id="S3.E2.m1.8.8.1.1.1.1.5.2.3" xref="S3.E2.m1.8.8.1.1.1.1.5.2.3.cmml">t</mi><mo id="S3.E2.m1.8.8.1.1.1.1.5.3" xref="S3.E2.m1.8.8.1.1.1.1.5.3.cmml">∗</mo></msubsup><mo id="S3.E2.m1.8.8.1.1.1.1.4" xref="S3.E2.m1.8.8.1.1.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.3.3" xref="S3.E2.m1.8.8.1.1.1.1.3.4.cmml"><munder id="S3.E2.m1.8.8.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.cmml">arg</mi><mo lspace="0.280em" rspace="0em" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.3.cmml">max</mi></mrow><mrow id="S3.E2.m1.4.4.4" xref="S3.E2.m1.4.4.4.cmml"><mrow id="S3.E2.m1.4.4.4.4.1" xref="S3.E2.m1.4.4.4.4.2.cmml"><msubsup id="S3.E2.m1.4.4.4.4.1.1" xref="S3.E2.m1.4.4.4.4.1.1.cmml"><mi id="S3.E2.m1.4.4.4.4.1.1.2.2" xref="S3.E2.m1.4.4.4.4.1.1.2.2.cmml">𝐜</mi><mi id="S3.E2.m1.4.4.4.4.1.1.2.3" xref="S3.E2.m1.4.4.4.4.1.1.2.3.cmml">t</mi><mi id="S3.E2.m1.4.4.4.4.1.1.3" xref="S3.E2.m1.4.4.4.4.1.1.3.cmml">m</mi></msubsup><mo id="S3.E2.m1.4.4.4.4.1.2" xref="S3.E2.m1.4.4.4.4.2.cmml">;</mo><mi id="S3.E2.m1.3.3.3.3" xref="S3.E2.m1.3.3.3.3.cmml">m</mi></mrow><mo id="S3.E2.m1.4.4.4.5" xref="S3.E2.m1.4.4.4.5.cmml">∈</mo><mrow id="S3.E2.m1.4.4.4.6.2" xref="S3.E2.m1.4.4.4.6.1.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.4.6.2.1" xref="S3.E2.m1.4.4.4.6.1.cmml">[</mo><mn id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">1</mn><mo id="S3.E2.m1.4.4.4.6.2.2" xref="S3.E2.m1.4.4.4.6.1.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">M</mi><mo stretchy="false" id="S3.E2.m1.4.4.4.6.2.3" xref="S3.E2.m1.4.4.4.6.1.cmml">]</mo></mrow></mrow></munder><mo id="S3.E2.m1.8.8.1.1.1.1.3.3a" xref="S3.E2.m1.8.8.1.1.1.1.3.4.cmml">⁡</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.3.3.3" xref="S3.E2.m1.8.8.1.1.1.1.3.4.cmml"><mo stretchy="false" id="S3.E2.m1.8.8.1.1.1.1.3.3.3.3" xref="S3.E2.m1.8.8.1.1.1.1.3.4.cmml">{</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.cmml"><mtext id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.5" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.5a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.4" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.4.cmml">​</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.4.cmml"><mo stretchy="false" id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.4" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.4.cmml">(</mo><msubsup id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.2.2" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.2.3" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.2.3.cmml">t</mi><mi id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.3.cmml">n</mi></msubsup><mo id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.5" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.4.cmml">,</mo><msubsup id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.2.2" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.2.2.cmml">𝐜</mi><mi id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.2.3" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.2.3.cmml">t</mi><mn id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.3" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.3.cmml">1</mn></msubsup><mo id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.6" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.4.cmml">;</mo><msub id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3.2" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3.2.cmml">𝒟</mi><mi id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3.3" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3.3.cmml">p</mi></msub><mo stretchy="false" id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.7" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.8.8.1.1.1.1.3.3.3.4" xref="S3.E2.m1.8.8.1.1.1.1.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">⋯</mi><mo id="S3.E2.m1.8.8.1.1.1.1.3.3.3.5" xref="S3.E2.m1.8.8.1.1.1.1.3.4.cmml">,</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.cmml"><mtext id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.5" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.5a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.4" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.4.cmml">​</mo><mrow id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.4.cmml"><mo stretchy="false" id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.4" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.4.cmml">(</mo><msubsup id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.2.2" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.2.3" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.2.3.cmml">t</mi><mi id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.3" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.3.cmml">n</mi></msubsup><mo id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.5" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.4.cmml">,</mo><msubsup id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.cmml"><mi id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.2.2" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.2.2.cmml">𝐜</mi><mi id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.2.3" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.2.3.cmml">t</mi><mi id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.3" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.3.cmml">M</mi></msubsup><mo id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.6" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.4.cmml">;</mo><msub id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3.2" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3.2.cmml">𝒟</mi><mi id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3.3" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3.3.cmml">p</mi></msub><mo stretchy="false" id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.7" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.4.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.8.8.1.1.1.1.3.3.3.6" xref="S3.E2.m1.8.8.1.1.1.1.3.4.cmml">}</mo></mrow></mrow></mrow><mo id="S3.E2.m1.8.8.1.1.2.3" xref="S3.E2.m1.8.8.1.1.3a.cmml">,</mo><mrow id="S3.E2.m1.8.8.1.1.2.2" xref="S3.E2.m1.8.8.1.1.2.2.cmml"><mrow id="S3.E2.m1.8.8.1.1.2.2.2" xref="S3.E2.m1.8.8.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S3.E2.m1.8.8.1.1.2.2.2.1" xref="S3.E2.m1.8.8.1.1.2.2.2.1.cmml">∀</mo><mi id="S3.E2.m1.8.8.1.1.2.2.2.2" xref="S3.E2.m1.8.8.1.1.2.2.2.2.cmml">n</mi></mrow><mo id="S3.E2.m1.8.8.1.1.2.2.1" xref="S3.E2.m1.8.8.1.1.2.2.1.cmml">∈</mo><mrow id="S3.E2.m1.8.8.1.1.2.2.3.2" xref="S3.E2.m1.8.8.1.1.2.2.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.8.8.1.1.2.2.3.2.1" xref="S3.E2.m1.8.8.1.1.2.2.3.1.cmml">[</mo><mn id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">1</mn><mo id="S3.E2.m1.8.8.1.1.2.2.3.2.2" xref="S3.E2.m1.8.8.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml">B</mi><mo stretchy="false" id="S3.E2.m1.8.8.1.1.2.2.3.2.3" xref="S3.E2.m1.8.8.1.1.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E2.m1.8.8.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.8b"><apply id="S3.E2.m1.8.8.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.3a.cmml" xref="S3.E2.m1.8.8.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.8.8.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1"><eq id="S3.E2.m1.8.8.1.1.1.1.4.cmml" xref="S3.E2.m1.8.8.1.1.1.1.4"></eq><apply id="S3.E2.m1.8.8.1.1.1.1.5.cmml" xref="S3.E2.m1.8.8.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.5.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.5">superscript</csymbol><apply id="S3.E2.m1.8.8.1.1.1.1.5.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.5.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.5">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.5.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.5.2.2">𝐜</ci><ci id="S3.E2.m1.8.8.1.1.1.1.5.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.5.2.3">𝑡</ci></apply><times id="S3.E2.m1.8.8.1.1.1.1.5.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.5.3"></times></apply><apply id="S3.E2.m1.8.8.1.1.1.1.3.4.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3"><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2"><times id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.1"></times><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.2">arg</ci><ci id="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.1.1.1.2.3">max</ci></apply><apply id="S3.E2.m1.4.4.4.cmml" xref="S3.E2.m1.4.4.4"><in id="S3.E2.m1.4.4.4.5.cmml" xref="S3.E2.m1.4.4.4.5"></in><list id="S3.E2.m1.4.4.4.4.2.cmml" xref="S3.E2.m1.4.4.4.4.1"><apply id="S3.E2.m1.4.4.4.4.1.1.cmml" xref="S3.E2.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.4.4.1.1">superscript</csymbol><apply id="S3.E2.m1.4.4.4.4.1.1.2.cmml" xref="S3.E2.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.1.1.2.1.cmml" xref="S3.E2.m1.4.4.4.4.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.1.1.2.2.cmml" xref="S3.E2.m1.4.4.4.4.1.1.2.2">𝐜</ci><ci id="S3.E2.m1.4.4.4.4.1.1.2.3.cmml" xref="S3.E2.m1.4.4.4.4.1.1.2.3">𝑡</ci></apply><ci id="S3.E2.m1.4.4.4.4.1.1.3.cmml" xref="S3.E2.m1.4.4.4.4.1.1.3">𝑚</ci></apply><ci id="S3.E2.m1.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3">𝑚</ci></list><interval closure="closed" id="S3.E2.m1.4.4.4.6.1.cmml" xref="S3.E2.m1.4.4.4.6.2"><cn type="integer" id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">1</cn><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑀</ci></interval></apply></apply><apply id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1"><times id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.4.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.4"></times><ci id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.5a.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.5"><mtext id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.5.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.5">sim</mtext></ci><vector id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.4.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3"><apply id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.2.2">𝐰</ci><ci id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.1.1.1.3">𝑛</ci></apply><apply id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2">superscript</csymbol><apply id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.2.2">𝐜</ci><ci id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.2.2.2.3">1</cn></apply><apply id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3.2">𝒟</ci><ci id="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.2.2.2.1.3.3.3.3">𝑝</ci></apply></vector></apply><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">⋯</ci><apply id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2"><times id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.4.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.4"></times><ci id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.5a.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.5"><mtext id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.5.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.5">sim</mtext></ci><vector id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.4.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3"><apply id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1">superscript</csymbol><apply id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.2.2">𝐰</ci><ci id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.1.1.1.3">𝑛</ci></apply><apply id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2">superscript</csymbol><apply id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.2.2">𝐜</ci><ci id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.2.2.2.3">𝑀</ci></apply><apply id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3.1.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3">subscript</csymbol><ci id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3.2.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3.2">𝒟</ci><ci id="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3.3.cmml" xref="S3.E2.m1.8.8.1.1.1.1.3.3.3.2.3.3.3.3">𝑝</ci></apply></vector></apply></apply></apply><apply id="S3.E2.m1.8.8.1.1.2.2.cmml" xref="S3.E2.m1.8.8.1.1.2.2"><in id="S3.E2.m1.8.8.1.1.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.2.2.1"></in><apply id="S3.E2.m1.8.8.1.1.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.2.2.2"><csymbol cd="latexml" id="S3.E2.m1.8.8.1.1.2.2.2.1.cmml" xref="S3.E2.m1.8.8.1.1.2.2.2.1">for-all</csymbol><ci id="S3.E2.m1.8.8.1.1.2.2.2.2.cmml" xref="S3.E2.m1.8.8.1.1.2.2.2.2">𝑛</ci></apply><interval closure="closed" id="S3.E2.m1.8.8.1.1.2.2.3.1.cmml" xref="S3.E2.m1.8.8.1.1.2.2.3.2"><cn type="integer" id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6">1</cn><ci id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7">𝐵</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.8c">\mathbf{c}_{t}^{*}=\operatorname*{arg\;max}_{\mathbf{c}_{t}^{m};m\in[1,M]}\{\text{sim}({\mathbf{w}}_{t}^{n},\mathbf{c}_{t}^{1};\mathcal{D}_{p}),\cdots,\text{sim}({\mathbf{w}}_{t}^{n},\mathbf{c}_{t}^{M};\mathcal{D}_{p})\},\forall n\in[1,B],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p1.13" class="ltx_p">where <math id="S3.SS1.SSS1.p1.10.m1.1" class="ltx_Math" alttext="\mathbf{c}_{t}^{*}" display="inline"><semantics id="S3.SS1.SSS1.p1.10.m1.1a"><msubsup id="S3.SS1.SSS1.p1.10.m1.1.1" xref="S3.SS1.SSS1.p1.10.m1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.10.m1.1.1.2.2" xref="S3.SS1.SSS1.p1.10.m1.1.1.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS1.p1.10.m1.1.1.2.3" xref="S3.SS1.SSS1.p1.10.m1.1.1.2.3.cmml">t</mi><mo id="S3.SS1.SSS1.p1.10.m1.1.1.3" xref="S3.SS1.SSS1.p1.10.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.10.m1.1b"><apply id="S3.SS1.SSS1.p1.10.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.10.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.10.m1.1.1">superscript</csymbol><apply id="S3.SS1.SSS1.p1.10.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.10.m1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.10.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.10.m1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.10.m1.1.1.2.2">𝐜</ci><ci id="S3.SS1.SSS1.p1.10.m1.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.10.m1.1.1.2.3">𝑡</ci></apply><times id="S3.SS1.SSS1.p1.10.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.10.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.10.m1.1c">\mathbf{c}_{t}^{*}</annotation></semantics></math> is the best matched model for <math id="S3.SS1.SSS1.p1.11.m2.1" class="ltx_Math" alttext="\mathbf{w}_{t}^{n}" display="inline"><semantics id="S3.SS1.SSS1.p1.11.m2.1a"><msubsup id="S3.SS1.SSS1.p1.11.m2.1.1" xref="S3.SS1.SSS1.p1.11.m2.1.1.cmml"><mi id="S3.SS1.SSS1.p1.11.m2.1.1.2.2" xref="S3.SS1.SSS1.p1.11.m2.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.SSS1.p1.11.m2.1.1.2.3" xref="S3.SS1.SSS1.p1.11.m2.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS1.p1.11.m2.1.1.3" xref="S3.SS1.SSS1.p1.11.m2.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.11.m2.1b"><apply id="S3.SS1.SSS1.p1.11.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.11.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.11.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.11.m2.1.1">superscript</csymbol><apply id="S3.SS1.SSS1.p1.11.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p1.11.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.11.m2.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.11.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.11.m2.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.11.m2.1.1.2.2">𝐰</ci><ci id="S3.SS1.SSS1.p1.11.m2.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.11.m2.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS1.p1.11.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p1.11.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.11.m2.1c">\mathbf{w}_{t}^{n}</annotation></semantics></math>, which is also denoted as <math id="S3.SS1.SSS1.p1.12.m3.1" class="ltx_Math" alttext="\hat{\mathbf{w}}_{t}^{n}=\mathbf{c}_{t}^{*}" display="inline"><semantics id="S3.SS1.SSS1.p1.12.m3.1a"><mrow id="S3.SS1.SSS1.p1.12.m3.1.1" xref="S3.SS1.SSS1.p1.12.m3.1.1.cmml"><msubsup id="S3.SS1.SSS1.p1.12.m3.1.1.2" xref="S3.SS1.SSS1.p1.12.m3.1.1.2.cmml"><mover accent="true" id="S3.SS1.SSS1.p1.12.m3.1.1.2.2.2" xref="S3.SS1.SSS1.p1.12.m3.1.1.2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.12.m3.1.1.2.2.2.2" xref="S3.SS1.SSS1.p1.12.m3.1.1.2.2.2.2.cmml">𝐰</mi><mo id="S3.SS1.SSS1.p1.12.m3.1.1.2.2.2.1" xref="S3.SS1.SSS1.p1.12.m3.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.SSS1.p1.12.m3.1.1.2.2.3" xref="S3.SS1.SSS1.p1.12.m3.1.1.2.2.3.cmml">t</mi><mi id="S3.SS1.SSS1.p1.12.m3.1.1.2.3" xref="S3.SS1.SSS1.p1.12.m3.1.1.2.3.cmml">n</mi></msubsup><mo id="S3.SS1.SSS1.p1.12.m3.1.1.1" xref="S3.SS1.SSS1.p1.12.m3.1.1.1.cmml">=</mo><msubsup id="S3.SS1.SSS1.p1.12.m3.1.1.3" xref="S3.SS1.SSS1.p1.12.m3.1.1.3.cmml"><mi id="S3.SS1.SSS1.p1.12.m3.1.1.3.2.2" xref="S3.SS1.SSS1.p1.12.m3.1.1.3.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS1.p1.12.m3.1.1.3.2.3" xref="S3.SS1.SSS1.p1.12.m3.1.1.3.2.3.cmml">t</mi><mo id="S3.SS1.SSS1.p1.12.m3.1.1.3.3" xref="S3.SS1.SSS1.p1.12.m3.1.1.3.3.cmml">∗</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.12.m3.1b"><apply id="S3.SS1.SSS1.p1.12.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1"><eq id="S3.SS1.SSS1.p1.12.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.1"></eq><apply id="S3.SS1.SSS1.p1.12.m3.1.1.2.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.12.m3.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.2">superscript</csymbol><apply id="S3.SS1.SSS1.p1.12.m3.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.12.m3.1.1.2.2.1.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.2">subscript</csymbol><apply id="S3.SS1.SSS1.p1.12.m3.1.1.2.2.2.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.2.2.2"><ci id="S3.SS1.SSS1.p1.12.m3.1.1.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.2.2.2.1">^</ci><ci id="S3.SS1.SSS1.p1.12.m3.1.1.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.2.2.2.2">𝐰</ci></apply><ci id="S3.SS1.SSS1.p1.12.m3.1.1.2.2.3.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.2.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS1.p1.12.m3.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.2.3">𝑛</ci></apply><apply id="S3.SS1.SSS1.p1.12.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.12.m3.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.3">superscript</csymbol><apply id="S3.SS1.SSS1.p1.12.m3.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.12.m3.1.1.3.2.1.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS1.p1.12.m3.1.1.3.2.2.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.3.2.2">𝐜</ci><ci id="S3.SS1.SSS1.p1.12.m3.1.1.3.2.3.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.3.2.3">𝑡</ci></apply><times id="S3.SS1.SSS1.p1.12.m3.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.12.m3.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.12.m3.1c">\hat{\mathbf{w}}_{t}^{n}=\mathbf{c}_{t}^{*}</annotation></semantics></math>. <math id="S3.SS1.SSS1.p1.13.m4.2" class="ltx_Math" alttext="\text{sim}(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.SSS1.p1.13.m4.2a"><mrow id="S3.SS1.SSS1.p1.13.m4.2.3" xref="S3.SS1.SSS1.p1.13.m4.2.3.cmml"><mtext id="S3.SS1.SSS1.p1.13.m4.2.3.2" xref="S3.SS1.SSS1.p1.13.m4.2.3.2a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.13.m4.2.3.1" xref="S3.SS1.SSS1.p1.13.m4.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS1.p1.13.m4.2.3.3.2" xref="S3.SS1.SSS1.p1.13.m4.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.13.m4.2.3.3.2.1" xref="S3.SS1.SSS1.p1.13.m4.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.13.m4.1.1" xref="S3.SS1.SSS1.p1.13.m4.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.SSS1.p1.13.m4.2.3.3.2.2" xref="S3.SS1.SSS1.p1.13.m4.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.13.m4.2.2" xref="S3.SS1.SSS1.p1.13.m4.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS1.p1.13.m4.2.3.3.2.3" xref="S3.SS1.SSS1.p1.13.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.13.m4.2b"><apply id="S3.SS1.SSS1.p1.13.m4.2.3.cmml" xref="S3.SS1.SSS1.p1.13.m4.2.3"><times id="S3.SS1.SSS1.p1.13.m4.2.3.1.cmml" xref="S3.SS1.SSS1.p1.13.m4.2.3.1"></times><ci id="S3.SS1.SSS1.p1.13.m4.2.3.2a.cmml" xref="S3.SS1.SSS1.p1.13.m4.2.3.2"><mtext id="S3.SS1.SSS1.p1.13.m4.2.3.2.cmml" xref="S3.SS1.SSS1.p1.13.m4.2.3.2">sim</mtext></ci><interval closure="open" id="S3.SS1.SSS1.p1.13.m4.2.3.3.1.cmml" xref="S3.SS1.SSS1.p1.13.m4.2.3.3.2"><ci id="S3.SS1.SSS1.p1.13.m4.1.1.cmml" xref="S3.SS1.SSS1.p1.13.m4.1.1">⋅</ci><ci id="S3.SS1.SSS1.p1.13.m4.2.2.cmml" xref="S3.SS1.SSS1.p1.13.m4.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.13.m4.2c">\text{sim}(\cdot,\cdot)</annotation></semantics></math> is the similarity function between two models, which will be detailed in Section <a href="#S3.SS1.SSS3" title='3.1.3 Similarity Learning with Layer Stitching – "sim"⁢(⋅,⋅) ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly' class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1.3</span></a>.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Heterogeneous Model Reassembly – <math id="S3.SS1.SSS2.1.m1.2" class="ltx_Math" alttext="{g}(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.SSS2.1.m1.2b"><mrow id="S3.SS1.SSS2.1.m1.2.3" xref="S3.SS1.SSS2.1.m1.2.3.cmml"><mi id="S3.SS1.SSS2.1.m1.2.3.2" xref="S3.SS1.SSS2.1.m1.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.1.m1.2.3.1" xref="S3.SS1.SSS2.1.m1.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS2.1.m1.2.3.3.2" xref="S3.SS1.SSS2.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS2.1.m1.2.3.3.2.1" xref="S3.SS1.SSS2.1.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.1.m1.1.1" xref="S3.SS1.SSS2.1.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.SSS2.1.m1.2.3.3.2.2" xref="S3.SS1.SSS2.1.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.1.m1.2.2" xref="S3.SS1.SSS2.1.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS2.1.m1.2.3.3.2.3" xref="S3.SS1.SSS2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.1.m1.2c"><apply id="S3.SS1.SSS2.1.m1.2.3.cmml" xref="S3.SS1.SSS2.1.m1.2.3"><times id="S3.SS1.SSS2.1.m1.2.3.1.cmml" xref="S3.SS1.SSS2.1.m1.2.3.1"></times><ci id="S3.SS1.SSS2.1.m1.2.3.2.cmml" xref="S3.SS1.SSS2.1.m1.2.3.2">𝑔</ci><interval closure="open" id="S3.SS1.SSS2.1.m1.2.3.3.1.cmml" xref="S3.SS1.SSS2.1.m1.2.3.3.2"><ci id="S3.SS1.SSS2.1.m1.1.1.cmml" xref="S3.SS1.SSS2.1.m1.1.1">⋅</ci><ci id="S3.SS1.SSS2.1.m1.2.2.cmml" xref="S3.SS1.SSS2.1.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.1.m1.2d">{g}(\cdot,\cdot)</annotation></semantics></math>
</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.4" class="ltx_p">To optimize Eq. (<a href="#S3.E2" title="In 3.1.1 Similarity-based Model Matching ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), we need to obtain <math id="S3.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.SSS2.p1.1.m1.1a"><mi id="S3.SS1.SSS2.p1.1.m1.1.1" xref="S3.SS1.SSS2.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.1.m1.1b"><ci id="S3.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.1.m1.1c">M</annotation></semantics></math> candidates using the heterogenous model aggregation function <math id="S3.SS1.SSS2.p1.2.m2.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="S3.SS1.SSS2.p1.2.m2.1a"><mrow id="S3.SS1.SSS2.p1.2.m2.1.2" xref="S3.SS1.SSS2.p1.2.m2.1.2.cmml"><mi id="S3.SS1.SSS2.p1.2.m2.1.2.2" xref="S3.SS1.SSS2.p1.2.m2.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p1.2.m2.1.2.1" xref="S3.SS1.SSS2.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS1.SSS2.p1.2.m2.1.2.3.2" xref="S3.SS1.SSS2.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p1.2.m2.1.2.3.2.1" xref="S3.SS1.SSS2.p1.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p1.2.m2.1.1" xref="S3.SS1.SSS2.p1.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS2.p1.2.m2.1.2.3.2.2" xref="S3.SS1.SSS2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.2.m2.1b"><apply id="S3.SS1.SSS2.p1.2.m2.1.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.2"><times id="S3.SS1.SSS2.p1.2.m2.1.2.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.2.1"></times><ci id="S3.SS1.SSS2.p1.2.m2.1.2.2.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.2.2">𝑔</ci><ci id="S3.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p1.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.2.m2.1c">g(\cdot)</annotation></semantics></math> in Eq. (<a href="#S3.E1" title="In 3.1.1 Similarity-based Model Matching ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). To avoid the issue of predefined model architectures in the knowledge distillation approaches, we aim to automatically and dynamically learn the candidate architectures via a newly designed function <math id="S3.SS1.SSS2.p1.3.m3.2" class="ltx_Math" alttext="g(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.SSS2.p1.3.m3.2a"><mrow id="S3.SS1.SSS2.p1.3.m3.2.3" xref="S3.SS1.SSS2.p1.3.m3.2.3.cmml"><mi id="S3.SS1.SSS2.p1.3.m3.2.3.2" xref="S3.SS1.SSS2.p1.3.m3.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p1.3.m3.2.3.1" xref="S3.SS1.SSS2.p1.3.m3.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS2.p1.3.m3.2.3.3.2" xref="S3.SS1.SSS2.p1.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p1.3.m3.2.3.3.2.1" xref="S3.SS1.SSS2.p1.3.m3.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p1.3.m3.1.1" xref="S3.SS1.SSS2.p1.3.m3.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.SSS2.p1.3.m3.2.3.3.2.2" xref="S3.SS1.SSS2.p1.3.m3.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p1.3.m3.2.2" xref="S3.SS1.SSS2.p1.3.m3.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS2.p1.3.m3.2.3.3.2.3" xref="S3.SS1.SSS2.p1.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.3.m3.2b"><apply id="S3.SS1.SSS2.p1.3.m3.2.3.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.3"><times id="S3.SS1.SSS2.p1.3.m3.2.3.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.3.1"></times><ci id="S3.SS1.SSS2.p1.3.m3.2.3.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.3.2">𝑔</ci><interval closure="open" id="S3.SS1.SSS2.p1.3.m3.2.3.3.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.3.3.2"><ci id="S3.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p1.3.m3.1.1">⋅</ci><ci id="S3.SS1.SSS2.p1.3.m3.2.2.cmml" xref="S3.SS1.SSS2.p1.3.m3.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.3.m3.2c">g(\cdot,\cdot)</annotation></semantics></math>. In particular, we propose a decomposition-grouping-reassembly method as <math id="S3.SS1.SSS2.p1.4.m4.2" class="ltx_Math" alttext="g(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.SSS2.p1.4.m4.2a"><mrow id="S3.SS1.SSS2.p1.4.m4.2.3" xref="S3.SS1.SSS2.p1.4.m4.2.3.cmml"><mi id="S3.SS1.SSS2.p1.4.m4.2.3.2" xref="S3.SS1.SSS2.p1.4.m4.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p1.4.m4.2.3.1" xref="S3.SS1.SSS2.p1.4.m4.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS2.p1.4.m4.2.3.3.2" xref="S3.SS1.SSS2.p1.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p1.4.m4.2.3.3.2.1" xref="S3.SS1.SSS2.p1.4.m4.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p1.4.m4.1.1" xref="S3.SS1.SSS2.p1.4.m4.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.SSS2.p1.4.m4.2.3.3.2.2" xref="S3.SS1.SSS2.p1.4.m4.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p1.4.m4.2.2" xref="S3.SS1.SSS2.p1.4.m4.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS2.p1.4.m4.2.3.3.2.3" xref="S3.SS1.SSS2.p1.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p1.4.m4.2b"><apply id="S3.SS1.SSS2.p1.4.m4.2.3.cmml" xref="S3.SS1.SSS2.p1.4.m4.2.3"><times id="S3.SS1.SSS2.p1.4.m4.2.3.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.2.3.1"></times><ci id="S3.SS1.SSS2.p1.4.m4.2.3.2.cmml" xref="S3.SS1.SSS2.p1.4.m4.2.3.2">𝑔</ci><interval closure="open" id="S3.SS1.SSS2.p1.4.m4.2.3.3.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.2.3.3.2"><ci id="S3.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS2.p1.4.m4.1.1">⋅</ci><ci id="S3.SS1.SSS2.p1.4.m4.2.2.cmml" xref="S3.SS1.SSS2.p1.4.m4.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p1.4.m4.2c">g(\cdot,\cdot)</annotation></semantics></math>, including layer-wise decomposition, function-driven layer grouping, and reassembly candidate generation.</p>
</div>
<div id="S3.SS1.SSS2.p2" class="ltx_para">
<p id="S3.SS1.SSS2.p2.6" class="ltx_p"><span id="S3.SS1.SSS2.p2.6.1" class="ltx_text ltx_font_bold">Layer-wise Decomposition</span>.
Assume that each uploaded client model <math id="S3.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{w}_{t}^{n}" display="inline"><semantics id="S3.SS1.SSS2.p2.1.m1.1a"><msubsup id="S3.SS1.SSS2.p2.1.m1.1.1" xref="S3.SS1.SSS2.p2.1.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p2.1.m1.1.1.2.2" xref="S3.SS1.SSS2.p2.1.m1.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.SSS2.p2.1.m1.1.1.2.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS2.p2.1.m1.1.1.3" xref="S3.SS1.SSS2.p2.1.m1.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.1.m1.1b"><apply id="S3.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.2.2">𝐰</ci><ci id="S3.SS1.SSS2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.1.m1.1c">\mathbf{w}_{t}^{n}</annotation></semantics></math> contains <math id="S3.SS1.SSS2.p2.2.m2.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS1.SSS2.p2.2.m2.1a"><mi id="S3.SS1.SSS2.p2.2.m2.1.1" xref="S3.SS1.SSS2.p2.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.2.m2.1b"><ci id="S3.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p2.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.2.m2.1c">H</annotation></semantics></math> layers, i.e., <math id="S3.SS1.SSS2.p2.3.m3.7" class="ltx_Math" alttext="\mathbf{w}_{t}^{n}=[(\mathbf{L}_{t,1}^{n},O^{n}_{1}),\cdots,(\mathbf{L}_{t,H}^{n},O^{n}_{E})]" display="inline"><semantics id="S3.SS1.SSS2.p2.3.m3.7a"><mrow id="S3.SS1.SSS2.p2.3.m3.7.7" xref="S3.SS1.SSS2.p2.3.m3.7.7.cmml"><msubsup id="S3.SS1.SSS2.p2.3.m3.7.7.4" xref="S3.SS1.SSS2.p2.3.m3.7.7.4.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.7.7.4.2.2" xref="S3.SS1.SSS2.p2.3.m3.7.7.4.2.2.cmml">𝐰</mi><mi id="S3.SS1.SSS2.p2.3.m3.7.7.4.2.3" xref="S3.SS1.SSS2.p2.3.m3.7.7.4.2.3.cmml">t</mi><mi id="S3.SS1.SSS2.p2.3.m3.7.7.4.3" xref="S3.SS1.SSS2.p2.3.m3.7.7.4.3.cmml">n</mi></msubsup><mo id="S3.SS1.SSS2.p2.3.m3.7.7.3" xref="S3.SS1.SSS2.p2.3.m3.7.7.3.cmml">=</mo><mrow id="S3.SS1.SSS2.p2.3.m3.7.7.2.2" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.3" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.3.cmml">[</mo><mrow id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.3" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.3.cmml">(</mo><msubsup id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.2.2" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.2.2.cmml">𝐋</mi><mrow id="S3.SS1.SSS2.p2.3.m3.2.2.2.4" xref="S3.SS1.SSS2.p2.3.m3.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.1.1.1.1" xref="S3.SS1.SSS2.p2.3.m3.1.1.1.1.cmml">t</mi><mo id="S3.SS1.SSS2.p2.3.m3.2.2.2.4.1" xref="S3.SS1.SSS2.p2.3.m3.2.2.2.3.cmml">,</mo><mn id="S3.SS1.SSS2.p2.3.m3.2.2.2.2" xref="S3.SS1.SSS2.p2.3.m3.2.2.2.2.cmml">1</mn></mrow><mi id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.3" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.3.cmml">n</mi></msubsup><mo id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.4" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.3.cmml">,</mo><msubsup id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.2.2" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.2.2.cmml">O</mi><mn id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.3" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.3.cmml">1</mn><mi id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.2.3" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.5" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.3.cmml">)</mo></mrow><mo id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.4" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p2.3.m3.5.5" xref="S3.SS1.SSS2.p2.3.m3.5.5.cmml">⋯</mi><mo id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.5" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.3.cmml">,</mo><mrow id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.3" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.3.cmml">(</mo><msubsup id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.2.2" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.2.2.cmml">𝐋</mi><mrow id="S3.SS1.SSS2.p2.3.m3.4.4.2.4" xref="S3.SS1.SSS2.p2.3.m3.4.4.2.3.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.3.3.1.1" xref="S3.SS1.SSS2.p2.3.m3.3.3.1.1.cmml">t</mi><mo id="S3.SS1.SSS2.p2.3.m3.4.4.2.4.1" xref="S3.SS1.SSS2.p2.3.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.p2.3.m3.4.4.2.2" xref="S3.SS1.SSS2.p2.3.m3.4.4.2.2.cmml">H</mi></mrow><mi id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.3" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.3.cmml">n</mi></msubsup><mo id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.4" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.3.cmml">,</mo><msubsup id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.2.2" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.2.2.cmml">O</mi><mi id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.3" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.3.cmml">E</mi><mi id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.2.3" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.5" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.6" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.3.m3.7b"><apply id="S3.SS1.SSS2.p2.3.m3.7.7.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7"><eq id="S3.SS1.SSS2.p2.3.m3.7.7.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.3"></eq><apply id="S3.SS1.SSS2.p2.3.m3.7.7.4.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.4"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.7.7.4.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.4">superscript</csymbol><apply id="S3.SS1.SSS2.p2.3.m3.7.7.4.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.4"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.7.7.4.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.4">subscript</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.7.7.4.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.4.2.2">𝐰</ci><ci id="S3.SS1.SSS2.p2.3.m3.7.7.4.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.4.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS2.p2.3.m3.7.7.4.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.4.3">𝑛</ci></apply><list id="S3.SS1.SSS2.p2.3.m3.7.7.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2"><interval closure="open" id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2"><apply id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.2.2">𝐋</ci><list id="S3.SS1.SSS2.p2.3.m3.2.2.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.2.2.2.4"><ci id="S3.SS1.SSS2.p2.3.m3.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.1.1.1.1">𝑡</ci><cn type="integer" id="S3.SS1.SSS2.p2.3.m3.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.2.2.2.2">1</cn></list></apply><ci id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.1.1.3">𝑛</ci></apply><apply id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2">subscript</csymbol><apply id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2">superscript</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.2.2">𝑂</ci><ci id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.2.3">𝑛</ci></apply><cn type="integer" id="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.6.6.1.1.1.2.2.3">1</cn></apply></interval><ci id="S3.SS1.SSS2.p2.3.m3.5.5.cmml" xref="S3.SS1.SSS2.p2.3.m3.5.5">⋯</ci><interval closure="open" id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2"><apply id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.2.2">𝐋</ci><list id="S3.SS1.SSS2.p2.3.m3.4.4.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.2.4"><ci id="S3.SS1.SSS2.p2.3.m3.3.3.1.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.3.3.1.1">𝑡</ci><ci id="S3.SS1.SSS2.p2.3.m3.4.4.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.4.4.2.2">𝐻</ci></list></apply><ci id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.1.1.3">𝑛</ci></apply><apply id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2">subscript</csymbol><apply id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.2.2">𝑂</ci><ci id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.2.3">𝑛</ci></apply><ci id="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS2.p2.3.m3.7.7.2.2.2.2.2.3">𝐸</ci></apply></interval></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.3.m3.7c">\mathbf{w}_{t}^{n}=[(\mathbf{L}_{t,1}^{n},O^{n}_{1}),\cdots,(\mathbf{L}_{t,H}^{n},O^{n}_{E})]</annotation></semantics></math>, where each layer <math id="S3.SS1.SSS2.p2.4.m4.2" class="ltx_Math" alttext="\mathbf{L}_{t,h}^{n}" display="inline"><semantics id="S3.SS1.SSS2.p2.4.m4.2a"><msubsup id="S3.SS1.SSS2.p2.4.m4.2.3" xref="S3.SS1.SSS2.p2.4.m4.2.3.cmml"><mi id="S3.SS1.SSS2.p2.4.m4.2.3.2.2" xref="S3.SS1.SSS2.p2.4.m4.2.3.2.2.cmml">𝐋</mi><mrow id="S3.SS1.SSS2.p2.4.m4.2.2.2.4" xref="S3.SS1.SSS2.p2.4.m4.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.p2.4.m4.1.1.1.1" xref="S3.SS1.SSS2.p2.4.m4.1.1.1.1.cmml">t</mi><mo id="S3.SS1.SSS2.p2.4.m4.2.2.2.4.1" xref="S3.SS1.SSS2.p2.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.p2.4.m4.2.2.2.2" xref="S3.SS1.SSS2.p2.4.m4.2.2.2.2.cmml">h</mi></mrow><mi id="S3.SS1.SSS2.p2.4.m4.2.3.3" xref="S3.SS1.SSS2.p2.4.m4.2.3.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.4.m4.2b"><apply id="S3.SS1.SSS2.p2.4.m4.2.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.4.m4.2.3.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.2.3">superscript</csymbol><apply id="S3.SS1.SSS2.p2.4.m4.2.3.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.4.m4.2.3.2.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.2.3">subscript</csymbol><ci id="S3.SS1.SSS2.p2.4.m4.2.3.2.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.2.3.2.2">𝐋</ci><list id="S3.SS1.SSS2.p2.4.m4.2.2.2.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.2.2.2.4"><ci id="S3.SS1.SSS2.p2.4.m4.1.1.1.1.cmml" xref="S3.SS1.SSS2.p2.4.m4.1.1.1.1">𝑡</ci><ci id="S3.SS1.SSS2.p2.4.m4.2.2.2.2.cmml" xref="S3.SS1.SSS2.p2.4.m4.2.2.2.2">ℎ</ci></list></apply><ci id="S3.SS1.SSS2.p2.4.m4.2.3.3.cmml" xref="S3.SS1.SSS2.p2.4.m4.2.3.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.4.m4.2c">\mathbf{L}_{t,h}^{n}</annotation></semantics></math> is associated with an operation type <math id="S3.SS1.SSS2.p2.5.m5.1" class="ltx_Math" alttext="O^{n}_{e}" display="inline"><semantics id="S3.SS1.SSS2.p2.5.m5.1a"><msubsup id="S3.SS1.SSS2.p2.5.m5.1.1" xref="S3.SS1.SSS2.p2.5.m5.1.1.cmml"><mi id="S3.SS1.SSS2.p2.5.m5.1.1.2.2" xref="S3.SS1.SSS2.p2.5.m5.1.1.2.2.cmml">O</mi><mi id="S3.SS1.SSS2.p2.5.m5.1.1.3" xref="S3.SS1.SSS2.p2.5.m5.1.1.3.cmml">e</mi><mi id="S3.SS1.SSS2.p2.5.m5.1.1.2.3" xref="S3.SS1.SSS2.p2.5.m5.1.1.2.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.5.m5.1b"><apply id="S3.SS1.SSS2.p2.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.5.m5.1.1.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1">subscript</csymbol><apply id="S3.SS1.SSS2.p2.5.m5.1.1.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p2.5.m5.1.1.2.1.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.SSS2.p2.5.m5.1.1.2.2.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.2.2">𝑂</ci><ci id="S3.SS1.SSS2.p2.5.m5.1.1.2.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.2.3">𝑛</ci></apply><ci id="S3.SS1.SSS2.p2.5.m5.1.1.3.cmml" xref="S3.SS1.SSS2.p2.5.m5.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.5.m5.1c">O^{n}_{e}</annotation></semantics></math>. For example, a plain convolutional neural network (CNN) usually has three operations: convolution, pooling, and fully connected layers. For different client models, <math id="S3.SS1.SSS2.p2.6.m6.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS1.SSS2.p2.6.m6.1a"><mi id="S3.SS1.SSS2.p2.6.m6.1.1" xref="S3.SS1.SSS2.p2.6.m6.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p2.6.m6.1b"><ci id="S3.SS1.SSS2.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS2.p2.6.m6.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p2.6.m6.1c">H</annotation></semantics></math> may be different. The decomposition step aims to obtain these layers and their corresponding operation types.</p>
</div>
<div id="S3.SS1.SSS2.p3" class="ltx_para">
<p id="S3.SS1.SSS2.p3.1" class="ltx_p"><span id="S3.SS1.SSS2.p3.1.1" class="ltx_text ltx_font_bold">Function-driven Layer Grouping.</span>
After decomposing layers of client models, we group these layers based on their functional similarities. Due to the model structure heterogeneity in our setting, the dimension size of the output representations from layers by feeding the public data <math id="S3.SS1.SSS2.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{p}" display="inline"><semantics id="S3.SS1.SSS2.p3.1.m1.1a"><msub id="S3.SS1.SSS2.p3.1.m1.1.1" xref="S3.SS1.SSS2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p3.1.m1.1.1.2" xref="S3.SS1.SSS2.p3.1.m1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.SSS2.p3.1.m1.1.1.3" xref="S3.SS1.SSS2.p3.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.1.m1.1b"><apply id="S3.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.2">𝒟</ci><ci id="S3.SS1.SSS2.p3.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p3.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.1.m1.1c">\mathcal{D}_{p}</annotation></semantics></math> to different models will be different. Thus, measuring the similarity between a pair of layers is challenging, which can be resolved by applying the commonly used centered kernel alignment (CKA) technique <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. In particular, we define the distance metric between any pair of layers as follows:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.17" class="ltx_Math" alttext="\text{dis}(\mathbf{L}_{t,i}^{n},\mathbf{L}_{t,j}^{b})=(\text{CKA}(\mathbf{X}_{t,i}^{n},\mathbf{X}_{t,i}^{b})+\text{CKA}(\mathbf{L}_{t,i}^{n}(\mathbf{X}_{t,i}^{n}),\mathbf{L}_{t,i}^{b}(\mathbf{X}_{t,i}^{b})))^{-1}," display="block"><semantics id="S3.E3.m1.17a"><mrow id="S3.E3.m1.17.17.1" xref="S3.E3.m1.17.17.1.1.cmml"><mrow id="S3.E3.m1.17.17.1.1" xref="S3.E3.m1.17.17.1.1.cmml"><mrow id="S3.E3.m1.17.17.1.1.2" xref="S3.E3.m1.17.17.1.1.2.cmml"><mtext id="S3.E3.m1.17.17.1.1.2.4" xref="S3.E3.m1.17.17.1.1.2.4a.cmml">dis</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.17.17.1.1.2.3" xref="S3.E3.m1.17.17.1.1.2.3.cmml">​</mo><mrow id="S3.E3.m1.17.17.1.1.2.2.2" xref="S3.E3.m1.17.17.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.17.17.1.1.2.2.2.3" xref="S3.E3.m1.17.17.1.1.2.2.3.cmml">(</mo><msubsup id="S3.E3.m1.17.17.1.1.1.1.1.1" xref="S3.E3.m1.17.17.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.17.17.1.1.1.1.1.1.2.2" xref="S3.E3.m1.17.17.1.1.1.1.1.1.2.2.cmml">𝐋</mi><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">t</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S3.E3.m1.17.17.1.1.1.1.1.1.3" xref="S3.E3.m1.17.17.1.1.1.1.1.1.3.cmml">n</mi></msubsup><mo id="S3.E3.m1.17.17.1.1.2.2.2.4" xref="S3.E3.m1.17.17.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E3.m1.17.17.1.1.2.2.2.2" xref="S3.E3.m1.17.17.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.17.17.1.1.2.2.2.2.2.2" xref="S3.E3.m1.17.17.1.1.2.2.2.2.2.2.cmml">𝐋</mi><mrow id="S3.E3.m1.4.4.2.4" xref="S3.E3.m1.4.4.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml">t</mi><mo id="S3.E3.m1.4.4.2.4.1" xref="S3.E3.m1.4.4.2.3.cmml">,</mo><mi id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.2.cmml">j</mi></mrow><mi id="S3.E3.m1.17.17.1.1.2.2.2.2.3" xref="S3.E3.m1.17.17.1.1.2.2.2.2.3.cmml">b</mi></msubsup><mo stretchy="false" id="S3.E3.m1.17.17.1.1.2.2.2.5" xref="S3.E3.m1.17.17.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.17.17.1.1.4" xref="S3.E3.m1.17.17.1.1.4.cmml">=</mo><msup id="S3.E3.m1.17.17.1.1.3" xref="S3.E3.m1.17.17.1.1.3.cmml"><mrow id="S3.E3.m1.17.17.1.1.3.1.1" xref="S3.E3.m1.17.17.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.17.17.1.1.3.1.1.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.17.17.1.1.3.1.1.1" xref="S3.E3.m1.17.17.1.1.3.1.1.1.cmml"><mrow id="S3.E3.m1.17.17.1.1.3.1.1.1.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.cmml"><mtext id="S3.E3.m1.17.17.1.1.3.1.1.1.2.4" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.4a.cmml">CKA</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.17.17.1.1.3.1.1.1.2.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.3.cmml">​</mo><mrow id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.3.cmml">(</mo><msubsup id="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1" xref="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.2.2.cmml">𝐗</mi><mrow id="S3.E3.m1.6.6.2.4" xref="S3.E3.m1.6.6.2.3.cmml"><mi id="S3.E3.m1.5.5.1.1" xref="S3.E3.m1.5.5.1.1.cmml">t</mi><mo id="S3.E3.m1.6.6.2.4.1" xref="S3.E3.m1.6.6.2.3.cmml">,</mo><mi id="S3.E3.m1.6.6.2.2" xref="S3.E3.m1.6.6.2.2.cmml">i</mi></mrow><mi id="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.3.cmml">n</mi></msubsup><mo id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.4" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.2.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.2.2.cmml">𝐗</mi><mrow id="S3.E3.m1.8.8.2.4" xref="S3.E3.m1.8.8.2.3.cmml"><mi id="S3.E3.m1.7.7.1.1" xref="S3.E3.m1.7.7.1.1.cmml">t</mi><mo id="S3.E3.m1.8.8.2.4.1" xref="S3.E3.m1.8.8.2.3.cmml">,</mo><mi id="S3.E3.m1.8.8.2.2" xref="S3.E3.m1.8.8.2.2.cmml">i</mi></mrow><mi id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.3.cmml">b</mi></msubsup><mo stretchy="false" id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.5" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.17.17.1.1.3.1.1.1.5" xref="S3.E3.m1.17.17.1.1.3.1.1.1.5.cmml">+</mo><mrow id="S3.E3.m1.17.17.1.1.3.1.1.1.4" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.cmml"><mtext id="S3.E3.m1.17.17.1.1.3.1.1.1.4.4" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.4a.cmml">CKA</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.17.17.1.1.3.1.1.1.4.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.3.cmml">​</mo><mrow id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.3.cmml">(</mo><mrow id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.cmml"><msubsup id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.cmml"><mi id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.2.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.2.2.cmml">𝐋</mi><mrow id="S3.E3.m1.10.10.2.4" xref="S3.E3.m1.10.10.2.3.cmml"><mi id="S3.E3.m1.9.9.1.1" xref="S3.E3.m1.9.9.1.1.cmml">t</mi><mo id="S3.E3.m1.10.10.2.4.1" xref="S3.E3.m1.10.10.2.3.cmml">,</mo><mi id="S3.E3.m1.10.10.2.2" xref="S3.E3.m1.10.10.2.2.cmml">i</mi></mrow><mi id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.2.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.2.2.cmml">𝐗</mi><mrow id="S3.E3.m1.12.12.2.4" xref="S3.E3.m1.12.12.2.3.cmml"><mi id="S3.E3.m1.11.11.1.1" xref="S3.E3.m1.11.11.1.1.cmml">t</mi><mo id="S3.E3.m1.12.12.2.4.1" xref="S3.E3.m1.12.12.2.3.cmml">,</mo><mi id="S3.E3.m1.12.12.2.2" xref="S3.E3.m1.12.12.2.2.cmml">i</mi></mrow><mi id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.4" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.3.cmml">,</mo><mrow id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.cmml"><msubsup id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.cmml"><mi id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.2.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.2.2.cmml">𝐋</mi><mrow id="S3.E3.m1.14.14.2.4" xref="S3.E3.m1.14.14.2.3.cmml"><mi id="S3.E3.m1.13.13.1.1" xref="S3.E3.m1.13.13.1.1.cmml">t</mi><mo id="S3.E3.m1.14.14.2.4.1" xref="S3.E3.m1.14.14.2.3.cmml">,</mo><mi id="S3.E3.m1.14.14.2.2" xref="S3.E3.m1.14.14.2.2.cmml">i</mi></mrow><mi id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.3.cmml">b</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.2.cmml">​</mo><mrow id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.cmml"><mi id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.2.2" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.2.2.cmml">𝐗</mi><mrow id="S3.E3.m1.16.16.2.4" xref="S3.E3.m1.16.16.2.3.cmml"><mi id="S3.E3.m1.15.15.1.1" xref="S3.E3.m1.15.15.1.1.cmml">t</mi><mo id="S3.E3.m1.16.16.2.4.1" xref="S3.E3.m1.16.16.2.3.cmml">,</mo><mi id="S3.E3.m1.16.16.2.2" xref="S3.E3.m1.16.16.2.2.cmml">i</mi></mrow><mi id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.3.cmml">b</mi></msubsup><mo stretchy="false" id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.5" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E3.m1.17.17.1.1.3.1.1.3" xref="S3.E3.m1.17.17.1.1.3.1.1.1.cmml">)</mo></mrow><mrow id="S3.E3.m1.17.17.1.1.3.3" xref="S3.E3.m1.17.17.1.1.3.3.cmml"><mo id="S3.E3.m1.17.17.1.1.3.3a" xref="S3.E3.m1.17.17.1.1.3.3.cmml">−</mo><mn id="S3.E3.m1.17.17.1.1.3.3.2" xref="S3.E3.m1.17.17.1.1.3.3.2.cmml">1</mn></mrow></msup></mrow><mo id="S3.E3.m1.17.17.1.2" xref="S3.E3.m1.17.17.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.17b"><apply id="S3.E3.m1.17.17.1.1.cmml" xref="S3.E3.m1.17.17.1"><eq id="S3.E3.m1.17.17.1.1.4.cmml" xref="S3.E3.m1.17.17.1.1.4"></eq><apply id="S3.E3.m1.17.17.1.1.2.cmml" xref="S3.E3.m1.17.17.1.1.2"><times id="S3.E3.m1.17.17.1.1.2.3.cmml" xref="S3.E3.m1.17.17.1.1.2.3"></times><ci id="S3.E3.m1.17.17.1.1.2.4a.cmml" xref="S3.E3.m1.17.17.1.1.2.4"><mtext id="S3.E3.m1.17.17.1.1.2.4.cmml" xref="S3.E3.m1.17.17.1.1.2.4">dis</mtext></ci><interval closure="open" id="S3.E3.m1.17.17.1.1.2.2.3.cmml" xref="S3.E3.m1.17.17.1.1.2.2.2"><apply id="S3.E3.m1.17.17.1.1.1.1.1.1.cmml" xref="S3.E3.m1.17.17.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.17.17.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.17.17.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.17.17.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.17.17.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.17.17.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.17.17.1.1.1.1.1.1.2.2">𝐋</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑡</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S3.E3.m1.17.17.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.17.17.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S3.E3.m1.17.17.1.1.2.2.2.2.cmml" xref="S3.E3.m1.17.17.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.17.17.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E3.m1.17.17.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.17.17.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.17.17.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.17.17.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.17.17.1.1.2.2.2.2.2.2">𝐋</ci><list id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.4"><ci id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1">𝑡</ci><ci id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.2">𝑗</ci></list></apply><ci id="S3.E3.m1.17.17.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.17.17.1.1.2.2.2.2.3">𝑏</ci></apply></interval></apply><apply id="S3.E3.m1.17.17.1.1.3.cmml" xref="S3.E3.m1.17.17.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.2.cmml" xref="S3.E3.m1.17.17.1.1.3">superscript</csymbol><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1"><plus id="S3.E3.m1.17.17.1.1.3.1.1.1.5.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.5"></plus><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2"><times id="S3.E3.m1.17.17.1.1.3.1.1.1.2.3.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.3"></times><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.2.4a.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.4"><mtext id="S3.E3.m1.17.17.1.1.3.1.1.1.2.4.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.4">CKA</mtext></ci><interval closure="open" id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.3.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2"><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.2.2">𝐗</ci><list id="S3.E3.m1.6.6.2.3.cmml" xref="S3.E3.m1.6.6.2.4"><ci id="S3.E3.m1.5.5.1.1.cmml" xref="S3.E3.m1.5.5.1.1">𝑡</ci><ci id="S3.E3.m1.6.6.2.2.cmml" xref="S3.E3.m1.6.6.2.2">𝑖</ci></list></apply><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.2.2">𝐗</ci><list id="S3.E3.m1.8.8.2.3.cmml" xref="S3.E3.m1.8.8.2.4"><ci id="S3.E3.m1.7.7.1.1.cmml" xref="S3.E3.m1.7.7.1.1">𝑡</ci><ci id="S3.E3.m1.8.8.2.2.cmml" xref="S3.E3.m1.8.8.2.2">𝑖</ci></list></apply><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.2.2.2.2.3">𝑏</ci></apply></interval></apply><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.4.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4"><times id="S3.E3.m1.17.17.1.1.3.1.1.1.4.3.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.3"></times><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.4.4a.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.4"><mtext id="S3.E3.m1.17.17.1.1.3.1.1.1.4.4.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.4">CKA</mtext></ci><interval closure="open" id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.3.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2"><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1"><times id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.2"></times><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.2.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.2.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.2.2">𝐋</ci><list id="S3.E3.m1.10.10.2.3.cmml" xref="S3.E3.m1.10.10.2.4"><ci id="S3.E3.m1.9.9.1.1.cmml" xref="S3.E3.m1.9.9.1.1">𝑡</ci><ci id="S3.E3.m1.10.10.2.2.cmml" xref="S3.E3.m1.10.10.2.2">𝑖</ci></list></apply><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.3.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.2.2">𝐗</ci><list id="S3.E3.m1.12.12.2.3.cmml" xref="S3.E3.m1.12.12.2.4"><ci id="S3.E3.m1.11.11.1.1.cmml" xref="S3.E3.m1.11.11.1.1">𝑡</ci><ci id="S3.E3.m1.12.12.2.2.cmml" xref="S3.E3.m1.12.12.2.2">𝑖</ci></list></apply><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.3.1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2"><times id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.2"></times><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3">superscript</csymbol><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.2.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.2.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.2.2">𝐋</ci><list id="S3.E3.m1.14.14.2.3.cmml" xref="S3.E3.m1.14.14.2.4"><ci id="S3.E3.m1.13.13.1.1.cmml" xref="S3.E3.m1.13.13.1.1">𝑡</ci><ci id="S3.E3.m1.14.14.2.2.cmml" xref="S3.E3.m1.14.14.2.2">𝑖</ci></list></apply><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.3.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.3.3">𝑏</ci></apply><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1">superscript</csymbol><apply id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.2.1.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1">subscript</csymbol><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.2.2.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.2.2">𝐗</ci><list id="S3.E3.m1.16.16.2.3.cmml" xref="S3.E3.m1.16.16.2.4"><ci id="S3.E3.m1.15.15.1.1.cmml" xref="S3.E3.m1.15.15.1.1">𝑡</ci><ci id="S3.E3.m1.16.16.2.2.cmml" xref="S3.E3.m1.16.16.2.2">𝑖</ci></list></apply><ci id="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.3.cmml" xref="S3.E3.m1.17.17.1.1.3.1.1.1.4.2.2.2.1.1.1.3">𝑏</ci></apply></apply></interval></apply></apply><apply id="S3.E3.m1.17.17.1.1.3.3.cmml" xref="S3.E3.m1.17.17.1.1.3.3"><minus id="S3.E3.m1.17.17.1.1.3.3.1.cmml" xref="S3.E3.m1.17.17.1.1.3.3"></minus><cn type="integer" id="S3.E3.m1.17.17.1.1.3.3.2.cmml" xref="S3.E3.m1.17.17.1.1.3.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.17c">\text{dis}(\mathbf{L}_{t,i}^{n},\mathbf{L}_{t,j}^{b})=(\text{CKA}(\mathbf{X}_{t,i}^{n},\mathbf{X}_{t,i}^{b})+\text{CKA}(\mathbf{L}_{t,i}^{n}(\mathbf{X}_{t,i}^{n}),\mathbf{L}_{t,i}^{b}(\mathbf{X}_{t,i}^{b})))^{-1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS2.p3.6" class="ltx_p">where <math id="S3.SS1.SSS2.p3.2.m1.2" class="ltx_Math" alttext="\mathbf{X}_{t,i}^{n}" display="inline"><semantics id="S3.SS1.SSS2.p3.2.m1.2a"><msubsup id="S3.SS1.SSS2.p3.2.m1.2.3" xref="S3.SS1.SSS2.p3.2.m1.2.3.cmml"><mi id="S3.SS1.SSS2.p3.2.m1.2.3.2.2" xref="S3.SS1.SSS2.p3.2.m1.2.3.2.2.cmml">𝐗</mi><mrow id="S3.SS1.SSS2.p3.2.m1.2.2.2.4" xref="S3.SS1.SSS2.p3.2.m1.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.p3.2.m1.1.1.1.1" xref="S3.SS1.SSS2.p3.2.m1.1.1.1.1.cmml">t</mi><mo id="S3.SS1.SSS2.p3.2.m1.2.2.2.4.1" xref="S3.SS1.SSS2.p3.2.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.p3.2.m1.2.2.2.2" xref="S3.SS1.SSS2.p3.2.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS1.SSS2.p3.2.m1.2.3.3" xref="S3.SS1.SSS2.p3.2.m1.2.3.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.2.m1.2b"><apply id="S3.SS1.SSS2.p3.2.m1.2.3.cmml" xref="S3.SS1.SSS2.p3.2.m1.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.2.m1.2.3.1.cmml" xref="S3.SS1.SSS2.p3.2.m1.2.3">superscript</csymbol><apply id="S3.SS1.SSS2.p3.2.m1.2.3.2.cmml" xref="S3.SS1.SSS2.p3.2.m1.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.2.m1.2.3.2.1.cmml" xref="S3.SS1.SSS2.p3.2.m1.2.3">subscript</csymbol><ci id="S3.SS1.SSS2.p3.2.m1.2.3.2.2.cmml" xref="S3.SS1.SSS2.p3.2.m1.2.3.2.2">𝐗</ci><list id="S3.SS1.SSS2.p3.2.m1.2.2.2.3.cmml" xref="S3.SS1.SSS2.p3.2.m1.2.2.2.4"><ci id="S3.SS1.SSS2.p3.2.m1.1.1.1.1.cmml" xref="S3.SS1.SSS2.p3.2.m1.1.1.1.1">𝑡</ci><ci id="S3.SS1.SSS2.p3.2.m1.2.2.2.2.cmml" xref="S3.SS1.SSS2.p3.2.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS1.SSS2.p3.2.m1.2.3.3.cmml" xref="S3.SS1.SSS2.p3.2.m1.2.3.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.2.m1.2c">\mathbf{X}_{t,i}^{n}</annotation></semantics></math> is the input data of <math id="S3.SS1.SSS2.p3.3.m2.2" class="ltx_Math" alttext="\mathbf{L}_{t,i}^{n}" display="inline"><semantics id="S3.SS1.SSS2.p3.3.m2.2a"><msubsup id="S3.SS1.SSS2.p3.3.m2.2.3" xref="S3.SS1.SSS2.p3.3.m2.2.3.cmml"><mi id="S3.SS1.SSS2.p3.3.m2.2.3.2.2" xref="S3.SS1.SSS2.p3.3.m2.2.3.2.2.cmml">𝐋</mi><mrow id="S3.SS1.SSS2.p3.3.m2.2.2.2.4" xref="S3.SS1.SSS2.p3.3.m2.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.p3.3.m2.1.1.1.1" xref="S3.SS1.SSS2.p3.3.m2.1.1.1.1.cmml">t</mi><mo id="S3.SS1.SSS2.p3.3.m2.2.2.2.4.1" xref="S3.SS1.SSS2.p3.3.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.p3.3.m2.2.2.2.2" xref="S3.SS1.SSS2.p3.3.m2.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS1.SSS2.p3.3.m2.2.3.3" xref="S3.SS1.SSS2.p3.3.m2.2.3.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.3.m2.2b"><apply id="S3.SS1.SSS2.p3.3.m2.2.3.cmml" xref="S3.SS1.SSS2.p3.3.m2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.3.m2.2.3.1.cmml" xref="S3.SS1.SSS2.p3.3.m2.2.3">superscript</csymbol><apply id="S3.SS1.SSS2.p3.3.m2.2.3.2.cmml" xref="S3.SS1.SSS2.p3.3.m2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.3.m2.2.3.2.1.cmml" xref="S3.SS1.SSS2.p3.3.m2.2.3">subscript</csymbol><ci id="S3.SS1.SSS2.p3.3.m2.2.3.2.2.cmml" xref="S3.SS1.SSS2.p3.3.m2.2.3.2.2">𝐋</ci><list id="S3.SS1.SSS2.p3.3.m2.2.2.2.3.cmml" xref="S3.SS1.SSS2.p3.3.m2.2.2.2.4"><ci id="S3.SS1.SSS2.p3.3.m2.1.1.1.1.cmml" xref="S3.SS1.SSS2.p3.3.m2.1.1.1.1">𝑡</ci><ci id="S3.SS1.SSS2.p3.3.m2.2.2.2.2.cmml" xref="S3.SS1.SSS2.p3.3.m2.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS1.SSS2.p3.3.m2.2.3.3.cmml" xref="S3.SS1.SSS2.p3.3.m2.2.3.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.3.m2.2c">\mathbf{L}_{t,i}^{n}</annotation></semantics></math>, and <math id="S3.SS1.SSS2.p3.4.m3.5" class="ltx_Math" alttext="\mathbf{L}_{t,i}^{n}(\mathbf{X}_{t,i}^{n})" display="inline"><semantics id="S3.SS1.SSS2.p3.4.m3.5a"><mrow id="S3.SS1.SSS2.p3.4.m3.5.5" xref="S3.SS1.SSS2.p3.4.m3.5.5.cmml"><msubsup id="S3.SS1.SSS2.p3.4.m3.5.5.3" xref="S3.SS1.SSS2.p3.4.m3.5.5.3.cmml"><mi id="S3.SS1.SSS2.p3.4.m3.5.5.3.2.2" xref="S3.SS1.SSS2.p3.4.m3.5.5.3.2.2.cmml">𝐋</mi><mrow id="S3.SS1.SSS2.p3.4.m3.2.2.2.4" xref="S3.SS1.SSS2.p3.4.m3.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.p3.4.m3.1.1.1.1" xref="S3.SS1.SSS2.p3.4.m3.1.1.1.1.cmml">t</mi><mo id="S3.SS1.SSS2.p3.4.m3.2.2.2.4.1" xref="S3.SS1.SSS2.p3.4.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.p3.4.m3.2.2.2.2" xref="S3.SS1.SSS2.p3.4.m3.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS1.SSS2.p3.4.m3.5.5.3.3" xref="S3.SS1.SSS2.p3.4.m3.5.5.3.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p3.4.m3.5.5.2" xref="S3.SS1.SSS2.p3.4.m3.5.5.2.cmml">​</mo><mrow id="S3.SS1.SSS2.p3.4.m3.5.5.1.1" xref="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p3.4.m3.5.5.1.1.2" xref="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.cmml">(</mo><msubsup id="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1" xref="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.cmml"><mi id="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.2.2" xref="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.2.2.cmml">𝐗</mi><mrow id="S3.SS1.SSS2.p3.4.m3.4.4.2.4" xref="S3.SS1.SSS2.p3.4.m3.4.4.2.3.cmml"><mi id="S3.SS1.SSS2.p3.4.m3.3.3.1.1" xref="S3.SS1.SSS2.p3.4.m3.3.3.1.1.cmml">t</mi><mo id="S3.SS1.SSS2.p3.4.m3.4.4.2.4.1" xref="S3.SS1.SSS2.p3.4.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.p3.4.m3.4.4.2.2" xref="S3.SS1.SSS2.p3.4.m3.4.4.2.2.cmml">i</mi></mrow><mi id="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.3" xref="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS2.p3.4.m3.5.5.1.1.3" xref="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.4.m3.5b"><apply id="S3.SS1.SSS2.p3.4.m3.5.5.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5"><times id="S3.SS1.SSS2.p3.4.m3.5.5.2.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.2"></times><apply id="S3.SS1.SSS2.p3.4.m3.5.5.3.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.4.m3.5.5.3.1.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.3">superscript</csymbol><apply id="S3.SS1.SSS2.p3.4.m3.5.5.3.2.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.4.m3.5.5.3.2.1.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.3">subscript</csymbol><ci id="S3.SS1.SSS2.p3.4.m3.5.5.3.2.2.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.3.2.2">𝐋</ci><list id="S3.SS1.SSS2.p3.4.m3.2.2.2.3.cmml" xref="S3.SS1.SSS2.p3.4.m3.2.2.2.4"><ci id="S3.SS1.SSS2.p3.4.m3.1.1.1.1.cmml" xref="S3.SS1.SSS2.p3.4.m3.1.1.1.1">𝑡</ci><ci id="S3.SS1.SSS2.p3.4.m3.2.2.2.2.cmml" xref="S3.SS1.SSS2.p3.4.m3.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS1.SSS2.p3.4.m3.5.5.3.3.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.3.3">𝑛</ci></apply><apply id="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.1.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.2.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.2.1.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.2.2">𝐗</ci><list id="S3.SS1.SSS2.p3.4.m3.4.4.2.3.cmml" xref="S3.SS1.SSS2.p3.4.m3.4.4.2.4"><ci id="S3.SS1.SSS2.p3.4.m3.3.3.1.1.cmml" xref="S3.SS1.SSS2.p3.4.m3.3.3.1.1">𝑡</ci><ci id="S3.SS1.SSS2.p3.4.m3.4.4.2.2.cmml" xref="S3.SS1.SSS2.p3.4.m3.4.4.2.2">𝑖</ci></list></apply><ci id="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.3.cmml" xref="S3.SS1.SSS2.p3.4.m3.5.5.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.4.m3.5c">\mathbf{L}_{t,i}^{n}(\mathbf{X}_{t,i}^{n})</annotation></semantics></math> denotes the output data from <math id="S3.SS1.SSS2.p3.5.m4.2" class="ltx_Math" alttext="\mathbf{L}_{t,i}^{n}" display="inline"><semantics id="S3.SS1.SSS2.p3.5.m4.2a"><msubsup id="S3.SS1.SSS2.p3.5.m4.2.3" xref="S3.SS1.SSS2.p3.5.m4.2.3.cmml"><mi id="S3.SS1.SSS2.p3.5.m4.2.3.2.2" xref="S3.SS1.SSS2.p3.5.m4.2.3.2.2.cmml">𝐋</mi><mrow id="S3.SS1.SSS2.p3.5.m4.2.2.2.4" xref="S3.SS1.SSS2.p3.5.m4.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.p3.5.m4.1.1.1.1" xref="S3.SS1.SSS2.p3.5.m4.1.1.1.1.cmml">t</mi><mo id="S3.SS1.SSS2.p3.5.m4.2.2.2.4.1" xref="S3.SS1.SSS2.p3.5.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.p3.5.m4.2.2.2.2" xref="S3.SS1.SSS2.p3.5.m4.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS1.SSS2.p3.5.m4.2.3.3" xref="S3.SS1.SSS2.p3.5.m4.2.3.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.5.m4.2b"><apply id="S3.SS1.SSS2.p3.5.m4.2.3.cmml" xref="S3.SS1.SSS2.p3.5.m4.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.5.m4.2.3.1.cmml" xref="S3.SS1.SSS2.p3.5.m4.2.3">superscript</csymbol><apply id="S3.SS1.SSS2.p3.5.m4.2.3.2.cmml" xref="S3.SS1.SSS2.p3.5.m4.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p3.5.m4.2.3.2.1.cmml" xref="S3.SS1.SSS2.p3.5.m4.2.3">subscript</csymbol><ci id="S3.SS1.SSS2.p3.5.m4.2.3.2.2.cmml" xref="S3.SS1.SSS2.p3.5.m4.2.3.2.2">𝐋</ci><list id="S3.SS1.SSS2.p3.5.m4.2.2.2.3.cmml" xref="S3.SS1.SSS2.p3.5.m4.2.2.2.4"><ci id="S3.SS1.SSS2.p3.5.m4.1.1.1.1.cmml" xref="S3.SS1.SSS2.p3.5.m4.1.1.1.1">𝑡</ci><ci id="S3.SS1.SSS2.p3.5.m4.2.2.2.2.cmml" xref="S3.SS1.SSS2.p3.5.m4.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS1.SSS2.p3.5.m4.2.3.3.cmml" xref="S3.SS1.SSS2.p3.5.m4.2.3.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.5.m4.2c">\mathbf{L}_{t,i}^{n}</annotation></semantics></math>. This metric uses <math id="S3.SS1.SSS2.p3.6.m5.2" class="ltx_Math" alttext="\text{CKA}(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.SSS2.p3.6.m5.2a"><mrow id="S3.SS1.SSS2.p3.6.m5.2.3" xref="S3.SS1.SSS2.p3.6.m5.2.3.cmml"><mtext id="S3.SS1.SSS2.p3.6.m5.2.3.2" xref="S3.SS1.SSS2.p3.6.m5.2.3.2a.cmml">CKA</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p3.6.m5.2.3.1" xref="S3.SS1.SSS2.p3.6.m5.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS2.p3.6.m5.2.3.3.2" xref="S3.SS1.SSS2.p3.6.m5.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p3.6.m5.2.3.3.2.1" xref="S3.SS1.SSS2.p3.6.m5.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p3.6.m5.1.1" xref="S3.SS1.SSS2.p3.6.m5.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.SSS2.p3.6.m5.2.3.3.2.2" xref="S3.SS1.SSS2.p3.6.m5.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS2.p3.6.m5.2.2" xref="S3.SS1.SSS2.p3.6.m5.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS2.p3.6.m5.2.3.3.2.3" xref="S3.SS1.SSS2.p3.6.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p3.6.m5.2b"><apply id="S3.SS1.SSS2.p3.6.m5.2.3.cmml" xref="S3.SS1.SSS2.p3.6.m5.2.3"><times id="S3.SS1.SSS2.p3.6.m5.2.3.1.cmml" xref="S3.SS1.SSS2.p3.6.m5.2.3.1"></times><ci id="S3.SS1.SSS2.p3.6.m5.2.3.2a.cmml" xref="S3.SS1.SSS2.p3.6.m5.2.3.2"><mtext id="S3.SS1.SSS2.p3.6.m5.2.3.2.cmml" xref="S3.SS1.SSS2.p3.6.m5.2.3.2">CKA</mtext></ci><interval closure="open" id="S3.SS1.SSS2.p3.6.m5.2.3.3.1.cmml" xref="S3.SS1.SSS2.p3.6.m5.2.3.3.2"><ci id="S3.SS1.SSS2.p3.6.m5.1.1.cmml" xref="S3.SS1.SSS2.p3.6.m5.1.1">⋅</ci><ci id="S3.SS1.SSS2.p3.6.m5.2.2.cmml" xref="S3.SS1.SSS2.p3.6.m5.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p3.6.m5.2c">\text{CKA}(\cdot,\cdot)</annotation></semantics></math> to calculate the similarity between both input and output data of two layers.</p>
</div>
<figure id="alg1" class="ltx_float ltx_algorithm">
<div id="alg1.42" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg1.3.3" class="ltx_listingline">
<span id="alg1.3.3.3" class="ltx_text" style="font-size:90%;">





<span id="alg1.3.3.3.1" class="ltx_text ltx_font_bold">input :</span> Layer clusters <math id="alg1.1.1.1.m1.4" class="ltx_Math" alttext="\{\mathcal{G}_{t}^{1},\mathcal{G}_{t}^{2},\cdots,\mathcal{G}_{t}^{K}\}" display="inline"><semantics id="alg1.1.1.1.m1.4a"><mrow id="alg1.1.1.1.m1.4.4.3" xref="alg1.1.1.1.m1.4.4.4.cmml"><mo stretchy="false" id="alg1.1.1.1.m1.4.4.3.4" xref="alg1.1.1.1.m1.4.4.4.cmml">{</mo><msubsup id="alg1.1.1.1.m1.2.2.1.1" xref="alg1.1.1.1.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.1.1.1.m1.2.2.1.1.2.2" xref="alg1.1.1.1.m1.2.2.1.1.2.2.cmml">𝒢</mi><mi id="alg1.1.1.1.m1.2.2.1.1.2.3" xref="alg1.1.1.1.m1.2.2.1.1.2.3.cmml">t</mi><mn id="alg1.1.1.1.m1.2.2.1.1.3" xref="alg1.1.1.1.m1.2.2.1.1.3.cmml">1</mn></msubsup><mo id="alg1.1.1.1.m1.4.4.3.5" xref="alg1.1.1.1.m1.4.4.4.cmml">,</mo><msubsup id="alg1.1.1.1.m1.3.3.2.2" xref="alg1.1.1.1.m1.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.1.1.1.m1.3.3.2.2.2.2" xref="alg1.1.1.1.m1.3.3.2.2.2.2.cmml">𝒢</mi><mi id="alg1.1.1.1.m1.3.3.2.2.2.3" xref="alg1.1.1.1.m1.3.3.2.2.2.3.cmml">t</mi><mn id="alg1.1.1.1.m1.3.3.2.2.3" xref="alg1.1.1.1.m1.3.3.2.2.3.cmml">2</mn></msubsup><mo id="alg1.1.1.1.m1.4.4.3.6" xref="alg1.1.1.1.m1.4.4.4.cmml">,</mo><mi mathvariant="normal" id="alg1.1.1.1.m1.1.1" xref="alg1.1.1.1.m1.1.1.cmml">⋯</mi><mo id="alg1.1.1.1.m1.4.4.3.7" xref="alg1.1.1.1.m1.4.4.4.cmml">,</mo><msubsup id="alg1.1.1.1.m1.4.4.3.3" xref="alg1.1.1.1.m1.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.1.1.1.m1.4.4.3.3.2.2" xref="alg1.1.1.1.m1.4.4.3.3.2.2.cmml">𝒢</mi><mi id="alg1.1.1.1.m1.4.4.3.3.2.3" xref="alg1.1.1.1.m1.4.4.3.3.2.3.cmml">t</mi><mi id="alg1.1.1.1.m1.4.4.3.3.3" xref="alg1.1.1.1.m1.4.4.3.3.3.cmml">K</mi></msubsup><mo stretchy="false" id="alg1.1.1.1.m1.4.4.3.8" xref="alg1.1.1.1.m1.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.1.1.m1.4b"><set id="alg1.1.1.1.m1.4.4.4.cmml" xref="alg1.1.1.1.m1.4.4.3"><apply id="alg1.1.1.1.m1.2.2.1.1.cmml" xref="alg1.1.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.1.1.1.m1.2.2.1.1.1.cmml" xref="alg1.1.1.1.m1.2.2.1.1">superscript</csymbol><apply id="alg1.1.1.1.m1.2.2.1.1.2.cmml" xref="alg1.1.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.1.1.1.m1.2.2.1.1.2.1.cmml" xref="alg1.1.1.1.m1.2.2.1.1">subscript</csymbol><ci id="alg1.1.1.1.m1.2.2.1.1.2.2.cmml" xref="alg1.1.1.1.m1.2.2.1.1.2.2">𝒢</ci><ci id="alg1.1.1.1.m1.2.2.1.1.2.3.cmml" xref="alg1.1.1.1.m1.2.2.1.1.2.3">𝑡</ci></apply><cn type="integer" id="alg1.1.1.1.m1.2.2.1.1.3.cmml" xref="alg1.1.1.1.m1.2.2.1.1.3">1</cn></apply><apply id="alg1.1.1.1.m1.3.3.2.2.cmml" xref="alg1.1.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.1.1.1.m1.3.3.2.2.1.cmml" xref="alg1.1.1.1.m1.3.3.2.2">superscript</csymbol><apply id="alg1.1.1.1.m1.3.3.2.2.2.cmml" xref="alg1.1.1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.1.1.1.m1.3.3.2.2.2.1.cmml" xref="alg1.1.1.1.m1.3.3.2.2">subscript</csymbol><ci id="alg1.1.1.1.m1.3.3.2.2.2.2.cmml" xref="alg1.1.1.1.m1.3.3.2.2.2.2">𝒢</ci><ci id="alg1.1.1.1.m1.3.3.2.2.2.3.cmml" xref="alg1.1.1.1.m1.3.3.2.2.2.3">𝑡</ci></apply><cn type="integer" id="alg1.1.1.1.m1.3.3.2.2.3.cmml" xref="alg1.1.1.1.m1.3.3.2.2.3">2</cn></apply><ci id="alg1.1.1.1.m1.1.1.cmml" xref="alg1.1.1.1.m1.1.1">⋯</ci><apply id="alg1.1.1.1.m1.4.4.3.3.cmml" xref="alg1.1.1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="alg1.1.1.1.m1.4.4.3.3.1.cmml" xref="alg1.1.1.1.m1.4.4.3.3">superscript</csymbol><apply id="alg1.1.1.1.m1.4.4.3.3.2.cmml" xref="alg1.1.1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="alg1.1.1.1.m1.4.4.3.3.2.1.cmml" xref="alg1.1.1.1.m1.4.4.3.3">subscript</csymbol><ci id="alg1.1.1.1.m1.4.4.3.3.2.2.cmml" xref="alg1.1.1.1.m1.4.4.3.3.2.2">𝒢</ci><ci id="alg1.1.1.1.m1.4.4.3.3.2.3.cmml" xref="alg1.1.1.1.m1.4.4.3.3.2.3">𝑡</ci></apply><ci id="alg1.1.1.1.m1.4.4.3.3.3.cmml" xref="alg1.1.1.1.m1.4.4.3.3.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.1.m1.4c">\{\mathcal{G}_{t}^{1},\mathcal{G}_{t}^{2},\cdots,\mathcal{G}_{t}^{K}\}</annotation></semantics></math>, operation type set <math id="alg1.2.2.2.m2.1" class="ltx_Math" alttext="\mathcal{O}" display="inline"><semantics id="alg1.2.2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.2.2.2.m2.1.1" xref="alg1.2.2.2.m2.1.1.cmml">𝒪</mi><annotation-xml encoding="MathML-Content" id="alg1.2.2.2.m2.1b"><ci id="alg1.2.2.2.m2.1.1.cmml" xref="alg1.2.2.2.m2.1.1">𝒪</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.2.m2.1c">\mathcal{O}</annotation></semantics></math>, rule set <math id="alg1.3.3.3.m3.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="alg1.3.3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.3.3.3.m3.1.1" xref="alg1.3.3.3.m3.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="alg1.3.3.3.m3.1b"><ci id="alg1.3.3.3.m3.1.1.cmml" xref="alg1.3.3.3.m3.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.3.m3.1c">\mathcal{R}</annotation></semantics></math></span>
</div>
<div id="alg1.4.4" class="ltx_listingline">
<span id="alg1.4.4.1" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.4.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">output :</span><span id="alg1.4.4.3" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.4.4.m1.3" class="ltx_Math" alttext="\{\mathbf{c}_{t}^{1},\cdots,\mathbf{c}_{t}^{M}\}" display="inline"><semantics id="alg1.4.4.m1.3a"><mrow id="alg1.4.4.m1.3.3.2" xref="alg1.4.4.m1.3.3.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.4.4.m1.3.3.2.3" xref="alg1.4.4.m1.3.3.3.cmml">{</mo><msubsup id="alg1.4.4.m1.2.2.1.1" xref="alg1.4.4.m1.2.2.1.1.cmml"><mi mathsize="90%" id="alg1.4.4.m1.2.2.1.1.2.2" xref="alg1.4.4.m1.2.2.1.1.2.2.cmml">𝐜</mi><mi mathsize="90%" id="alg1.4.4.m1.2.2.1.1.2.3" xref="alg1.4.4.m1.2.2.1.1.2.3.cmml">t</mi><mn mathsize="90%" id="alg1.4.4.m1.2.2.1.1.3" xref="alg1.4.4.m1.2.2.1.1.3.cmml">1</mn></msubsup><mo mathsize="90%" id="alg1.4.4.m1.3.3.2.4" xref="alg1.4.4.m1.3.3.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.4.4.m1.1.1" xref="alg1.4.4.m1.1.1.cmml">⋯</mi><mo mathsize="90%" id="alg1.4.4.m1.3.3.2.5" xref="alg1.4.4.m1.3.3.3.cmml">,</mo><msubsup id="alg1.4.4.m1.3.3.2.2" xref="alg1.4.4.m1.3.3.2.2.cmml"><mi mathsize="90%" id="alg1.4.4.m1.3.3.2.2.2.2" xref="alg1.4.4.m1.3.3.2.2.2.2.cmml">𝐜</mi><mi mathsize="90%" id="alg1.4.4.m1.3.3.2.2.2.3" xref="alg1.4.4.m1.3.3.2.2.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.4.4.m1.3.3.2.2.3" xref="alg1.4.4.m1.3.3.2.2.3.cmml">M</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.4.4.m1.3.3.2.6" xref="alg1.4.4.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.4.4.m1.3b"><set id="alg1.4.4.m1.3.3.3.cmml" xref="alg1.4.4.m1.3.3.2"><apply id="alg1.4.4.m1.2.2.1.1.cmml" xref="alg1.4.4.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.4.4.m1.2.2.1.1.1.cmml" xref="alg1.4.4.m1.2.2.1.1">superscript</csymbol><apply id="alg1.4.4.m1.2.2.1.1.2.cmml" xref="alg1.4.4.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.4.4.m1.2.2.1.1.2.1.cmml" xref="alg1.4.4.m1.2.2.1.1">subscript</csymbol><ci id="alg1.4.4.m1.2.2.1.1.2.2.cmml" xref="alg1.4.4.m1.2.2.1.1.2.2">𝐜</ci><ci id="alg1.4.4.m1.2.2.1.1.2.3.cmml" xref="alg1.4.4.m1.2.2.1.1.2.3">𝑡</ci></apply><cn type="integer" id="alg1.4.4.m1.2.2.1.1.3.cmml" xref="alg1.4.4.m1.2.2.1.1.3">1</cn></apply><ci id="alg1.4.4.m1.1.1.cmml" xref="alg1.4.4.m1.1.1">⋯</ci><apply id="alg1.4.4.m1.3.3.2.2.cmml" xref="alg1.4.4.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.4.4.m1.3.3.2.2.1.cmml" xref="alg1.4.4.m1.3.3.2.2">superscript</csymbol><apply id="alg1.4.4.m1.3.3.2.2.2.cmml" xref="alg1.4.4.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.4.4.m1.3.3.2.2.2.1.cmml" xref="alg1.4.4.m1.3.3.2.2">subscript</csymbol><ci id="alg1.4.4.m1.3.3.2.2.2.2.cmml" xref="alg1.4.4.m1.3.3.2.2.2.2">𝐜</ci><ci id="alg1.4.4.m1.3.3.2.2.2.3.cmml" xref="alg1.4.4.m1.3.3.2.2.2.3">𝑡</ci></apply><ci id="alg1.4.4.m1.3.3.2.2.3.cmml" xref="alg1.4.4.m1.3.3.2.2.3">𝑀</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m1.3c">\{\mathbf{c}_{t}^{1},\cdots,\mathbf{c}_{t}^{M}\}</annotation></semantics></math><span id="alg1.4.4.4" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg1.5.5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.5.5.1.1.1" class="ltx_text" style="font-size:90%;">1</span></span><span id="alg1.5.5.2" class="ltx_text" style="font-size:90%;">
Initialize </span><math id="alg1.5.5.m1.1" class="ltx_Math" alttext="\mathcal{C}_{t}=" display="inline"><semantics id="alg1.5.5.m1.1a"><mrow id="alg1.5.5.m1.1.1" xref="alg1.5.5.m1.1.1.cmml"><msub id="alg1.5.5.m1.1.1.2" xref="alg1.5.5.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.5.5.m1.1.1.2.2" xref="alg1.5.5.m1.1.1.2.2.cmml">𝒞</mi><mi mathsize="90%" id="alg1.5.5.m1.1.1.2.3" xref="alg1.5.5.m1.1.1.2.3.cmml">t</mi></msub><mo mathsize="90%" id="alg1.5.5.m1.1.1.1" xref="alg1.5.5.m1.1.1.1.cmml">=</mo><mi id="alg1.5.5.m1.1.1.3" xref="alg1.5.5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.5.5.m1.1b"><apply id="alg1.5.5.m1.1.1.cmml" xref="alg1.5.5.m1.1.1"><eq id="alg1.5.5.m1.1.1.1.cmml" xref="alg1.5.5.m1.1.1.1"></eq><apply id="alg1.5.5.m1.1.1.2.cmml" xref="alg1.5.5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.5.5.m1.1.1.2.1.cmml" xref="alg1.5.5.m1.1.1.2">subscript</csymbol><ci id="alg1.5.5.m1.1.1.2.2.cmml" xref="alg1.5.5.m1.1.1.2.2">𝒞</ci><ci id="alg1.5.5.m1.1.1.2.3.cmml" xref="alg1.5.5.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.5.5.m1.1.1.3.cmml" xref="alg1.5.5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.m1.1c">\mathcal{C}_{t}=</annotation></semantics></math><span id="alg1.5.5.3" class="ltx_text" style="font-size:90%;"> Ø;</span>
</div>
<div id="alg1.6.6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.6.6.2.1.1" class="ltx_text" style="font-size:90%;">2</span></span><span id="alg1.6.6.3" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.6.6.4" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.6.6.5" class="ltx_text" style="font-size:90%;"> </span><em id="alg1.6.6.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="alg1.6.6.1.m1.3" class="ltx_Math" alttext="k\leftarrow 1,\cdots,K" display="inline"><semantics id="alg1.6.6.1.m1.3a"><mrow id="alg1.6.6.1.m1.3.4" xref="alg1.6.6.1.m1.3.4.cmml"><mi id="alg1.6.6.1.m1.3.4.2" xref="alg1.6.6.1.m1.3.4.2.cmml">k</mi><mo stretchy="false" id="alg1.6.6.1.m1.3.4.1" xref="alg1.6.6.1.m1.3.4.1.cmml">←</mo><mrow id="alg1.6.6.1.m1.3.4.3.2" xref="alg1.6.6.1.m1.3.4.3.1.cmml"><mn id="alg1.6.6.1.m1.1.1" xref="alg1.6.6.1.m1.1.1.cmml">1</mn><mo id="alg1.6.6.1.m1.3.4.3.2.1" xref="alg1.6.6.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.6.6.1.m1.2.2" xref="alg1.6.6.1.m1.2.2.cmml">⋯</mi><mo id="alg1.6.6.1.m1.3.4.3.2.2" xref="alg1.6.6.1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.6.6.1.m1.3.3" xref="alg1.6.6.1.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.6.6.1.m1.3b"><apply id="alg1.6.6.1.m1.3.4.cmml" xref="alg1.6.6.1.m1.3.4"><ci id="alg1.6.6.1.m1.3.4.1.cmml" xref="alg1.6.6.1.m1.3.4.1">←</ci><ci id="alg1.6.6.1.m1.3.4.2.cmml" xref="alg1.6.6.1.m1.3.4.2">𝑘</ci><list id="alg1.6.6.1.m1.3.4.3.1.cmml" xref="alg1.6.6.1.m1.3.4.3.2"><cn type="integer" id="alg1.6.6.1.m1.1.1.cmml" xref="alg1.6.6.1.m1.1.1">1</cn><ci id="alg1.6.6.1.m1.2.2.cmml" xref="alg1.6.6.1.m1.2.2">⋯</ci><ci id="alg1.6.6.1.m1.3.3.cmml" xref="alg1.6.6.1.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.1.m1.3c">k\leftarrow 1,\cdots,K</annotation></semantics></math> </em><span id="alg1.6.6.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.6.6.7" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="alg1.8.8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.8.8.3.1.1" class="ltx_text" style="font-size:90%;">3</span></span><span id="alg1.8.8.4" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.8.8.5" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.8.8.6" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.8.8.2" class="ltx_text" style="font-size:90%;color:#008080;">// <math id="alg1.7.7.1.m1.1" class="ltx_Math" alttext="Q_{k}" display="inline"><semantics id="alg1.7.7.1.m1.1a"><msub id="alg1.7.7.1.m1.1.1" xref="alg1.7.7.1.m1.1.1.cmml"><mi mathcolor="#008080" id="alg1.7.7.1.m1.1.1.2" xref="alg1.7.7.1.m1.1.1.2.cmml">Q</mi><mi mathcolor="#008080" id="alg1.7.7.1.m1.1.1.3" xref="alg1.7.7.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.7.7.1.m1.1b"><apply id="alg1.7.7.1.m1.1.1.cmml" xref="alg1.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.7.7.1.m1.1.1.1.cmml" xref="alg1.7.7.1.m1.1.1">subscript</csymbol><ci id="alg1.7.7.1.m1.1.1.2.cmml" xref="alg1.7.7.1.m1.1.1.2">𝑄</ci><ci id="alg1.7.7.1.m1.1.1.3.cmml" xref="alg1.7.7.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.1.m1.1c">Q_{k}</annotation></semantics></math> is the number of operation-layer pairs in <math id="alg1.8.8.2.m2.1" class="ltx_Math" alttext="\mathcal{G}_{t}^{k}" display="inline"><semantics id="alg1.8.8.2.m2.1a"><msubsup id="alg1.8.8.2.m2.1.1" xref="alg1.8.8.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathcolor="#008080" id="alg1.8.8.2.m2.1.1.2.2" xref="alg1.8.8.2.m2.1.1.2.2.cmml">𝒢</mi><mi mathcolor="#008080" id="alg1.8.8.2.m2.1.1.2.3" xref="alg1.8.8.2.m2.1.1.2.3.cmml">t</mi><mi mathcolor="#008080" id="alg1.8.8.2.m2.1.1.3" xref="alg1.8.8.2.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.8.8.2.m2.1b"><apply id="alg1.8.8.2.m2.1.1.cmml" xref="alg1.8.8.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.8.8.2.m2.1.1.1.cmml" xref="alg1.8.8.2.m2.1.1">superscript</csymbol><apply id="alg1.8.8.2.m2.1.1.2.cmml" xref="alg1.8.8.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.8.8.2.m2.1.1.2.1.cmml" xref="alg1.8.8.2.m2.1.1">subscript</csymbol><ci id="alg1.8.8.2.m2.1.1.2.2.cmml" xref="alg1.8.8.2.m2.1.1.2.2">𝒢</ci><ci id="alg1.8.8.2.m2.1.1.2.3.cmml" xref="alg1.8.8.2.m2.1.1.2.3">𝑡</ci></apply><ci id="alg1.8.8.2.m2.1.1.3.cmml" xref="alg1.8.8.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.2.m2.1c">\mathcal{G}_{t}^{k}</annotation></semantics></math></span>
</div>
<div id="alg1.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.9.9.2.1.1" class="ltx_text" style="font-size:90%;">4</span></span><span id="alg1.9.9.3" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.9.9.4" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.9.9.5" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.9.9.6" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.9.9.7" class="ltx_text" style="font-size:90%;"> </span><em id="alg1.9.9.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="alg1.9.9.1.m1.3" class="ltx_Math" alttext="q\leftarrow 1,\cdots,Q_{k}" display="inline"><semantics id="alg1.9.9.1.m1.3a"><mrow id="alg1.9.9.1.m1.3.3" xref="alg1.9.9.1.m1.3.3.cmml"><mi id="alg1.9.9.1.m1.3.3.3" xref="alg1.9.9.1.m1.3.3.3.cmml">q</mi><mo stretchy="false" id="alg1.9.9.1.m1.3.3.2" xref="alg1.9.9.1.m1.3.3.2.cmml">←</mo><mrow id="alg1.9.9.1.m1.3.3.1.1" xref="alg1.9.9.1.m1.3.3.1.2.cmml"><mn id="alg1.9.9.1.m1.1.1" xref="alg1.9.9.1.m1.1.1.cmml">1</mn><mo id="alg1.9.9.1.m1.3.3.1.1.2" xref="alg1.9.9.1.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.9.9.1.m1.2.2" xref="alg1.9.9.1.m1.2.2.cmml">⋯</mi><mo id="alg1.9.9.1.m1.3.3.1.1.3" xref="alg1.9.9.1.m1.3.3.1.2.cmml">,</mo><msub id="alg1.9.9.1.m1.3.3.1.1.1" xref="alg1.9.9.1.m1.3.3.1.1.1.cmml"><mi id="alg1.9.9.1.m1.3.3.1.1.1.2" xref="alg1.9.9.1.m1.3.3.1.1.1.2.cmml">Q</mi><mi id="alg1.9.9.1.m1.3.3.1.1.1.3" xref="alg1.9.9.1.m1.3.3.1.1.1.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.9.1.m1.3b"><apply id="alg1.9.9.1.m1.3.3.cmml" xref="alg1.9.9.1.m1.3.3"><ci id="alg1.9.9.1.m1.3.3.2.cmml" xref="alg1.9.9.1.m1.3.3.2">←</ci><ci id="alg1.9.9.1.m1.3.3.3.cmml" xref="alg1.9.9.1.m1.3.3.3">𝑞</ci><list id="alg1.9.9.1.m1.3.3.1.2.cmml" xref="alg1.9.9.1.m1.3.3.1.1"><cn type="integer" id="alg1.9.9.1.m1.1.1.cmml" xref="alg1.9.9.1.m1.1.1">1</cn><ci id="alg1.9.9.1.m1.2.2.cmml" xref="alg1.9.9.1.m1.2.2">⋯</ci><apply id="alg1.9.9.1.m1.3.3.1.1.1.cmml" xref="alg1.9.9.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.9.9.1.m1.3.3.1.1.1.1.cmml" xref="alg1.9.9.1.m1.3.3.1.1.1">subscript</csymbol><ci id="alg1.9.9.1.m1.3.3.1.1.1.2.cmml" xref="alg1.9.9.1.m1.3.3.1.1.1.2">𝑄</ci><ci id="alg1.9.9.1.m1.3.3.1.1.1.3.cmml" xref="alg1.9.9.1.m1.3.3.1.1.1.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.1.m1.3c">q\leftarrow 1,\cdots,Q_{k}</annotation></semantics></math></em><span id="alg1.9.9.8" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.9.9.9" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="alg1.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.12.12.1.1.1" class="ltx_text" style="font-size:90%;">5</span></span><span id="alg1.12.12.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.12.12.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.12.12.4" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.12.12.5" class="ltx_text" style="font-size:90%;">
Initialize an empty candidate </span><math id="alg1.10.10.m1.1" class="ltx_Math" alttext="\mathbf{c}_{q}=[]" display="inline"><semantics id="alg1.10.10.m1.1a"><mrow id="alg1.10.10.m1.1.1" xref="alg1.10.10.m1.1.1.cmml"><msub id="alg1.10.10.m1.1.1.2" xref="alg1.10.10.m1.1.1.2.cmml"><mi mathsize="90%" id="alg1.10.10.m1.1.1.2.2" xref="alg1.10.10.m1.1.1.2.2.cmml">𝐜</mi><mi mathsize="90%" id="alg1.10.10.m1.1.1.2.3" xref="alg1.10.10.m1.1.1.2.3.cmml">q</mi></msub><mo mathsize="90%" id="alg1.10.10.m1.1.1.1" xref="alg1.10.10.m1.1.1.1.cmml">=</mo><mrow id="alg1.10.10.m1.1.1.3.2" xref="alg1.10.10.m1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.10.10.m1.1.1.3.2.1" xref="alg1.10.10.m1.1.1.3.1.cmml">[</mo><mo maxsize="90%" minsize="90%" id="alg1.10.10.m1.1.1.3.2.2" xref="alg1.10.10.m1.1.1.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.10.10.m1.1b"><apply id="alg1.10.10.m1.1.1.cmml" xref="alg1.10.10.m1.1.1"><eq id="alg1.10.10.m1.1.1.1.cmml" xref="alg1.10.10.m1.1.1.1"></eq><apply id="alg1.10.10.m1.1.1.2.cmml" xref="alg1.10.10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.10.10.m1.1.1.2.1.cmml" xref="alg1.10.10.m1.1.1.2">subscript</csymbol><ci id="alg1.10.10.m1.1.1.2.2.cmml" xref="alg1.10.10.m1.1.1.2.2">𝐜</ci><ci id="alg1.10.10.m1.1.1.2.3.cmml" xref="alg1.10.10.m1.1.1.2.3">𝑞</ci></apply><list id="alg1.10.10.m1.1.1.3.1.cmml" xref="alg1.10.10.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m1.1c">\mathbf{c}_{q}=[]</annotation></semantics></math><span id="alg1.12.12.6" class="ltx_text" style="font-size:90%;">, operation type set </span><math id="alg1.11.11.m2.1" class="ltx_Math" alttext="\mathcal{O}_{q}=" display="inline"><semantics id="alg1.11.11.m2.1a"><mrow id="alg1.11.11.m2.1.1" xref="alg1.11.11.m2.1.1.cmml"><msub id="alg1.11.11.m2.1.1.2" xref="alg1.11.11.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.11.11.m2.1.1.2.2" xref="alg1.11.11.m2.1.1.2.2.cmml">𝒪</mi><mi mathsize="90%" id="alg1.11.11.m2.1.1.2.3" xref="alg1.11.11.m2.1.1.2.3.cmml">q</mi></msub><mo mathsize="90%" id="alg1.11.11.m2.1.1.1" xref="alg1.11.11.m2.1.1.1.cmml">=</mo><mi id="alg1.11.11.m2.1.1.3" xref="alg1.11.11.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.11.11.m2.1b"><apply id="alg1.11.11.m2.1.1.cmml" xref="alg1.11.11.m2.1.1"><eq id="alg1.11.11.m2.1.1.1.cmml" xref="alg1.11.11.m2.1.1.1"></eq><apply id="alg1.11.11.m2.1.1.2.cmml" xref="alg1.11.11.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.11.11.m2.1.1.2.1.cmml" xref="alg1.11.11.m2.1.1.2">subscript</csymbol><ci id="alg1.11.11.m2.1.1.2.2.cmml" xref="alg1.11.11.m2.1.1.2.2">𝒪</ci><ci id="alg1.11.11.m2.1.1.2.3.cmml" xref="alg1.11.11.m2.1.1.2.3">𝑞</ci></apply><csymbol cd="latexml" id="alg1.11.11.m2.1.1.3.cmml" xref="alg1.11.11.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.m2.1c">\mathcal{O}_{q}=</annotation></semantics></math><span id="alg1.12.12.7" class="ltx_text" style="font-size:90%;"> Ø, group id set </span><math id="alg1.12.12.m3.1" class="ltx_Math" alttext="\mathcal{K}_{q}=" display="inline"><semantics id="alg1.12.12.m3.1a"><mrow id="alg1.12.12.m3.1.1" xref="alg1.12.12.m3.1.1.cmml"><msub id="alg1.12.12.m3.1.1.2" xref="alg1.12.12.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.12.12.m3.1.1.2.2" xref="alg1.12.12.m3.1.1.2.2.cmml">𝒦</mi><mi mathsize="90%" id="alg1.12.12.m3.1.1.2.3" xref="alg1.12.12.m3.1.1.2.3.cmml">q</mi></msub><mo mathsize="90%" id="alg1.12.12.m3.1.1.1" xref="alg1.12.12.m3.1.1.1.cmml">=</mo><mi id="alg1.12.12.m3.1.1.3" xref="alg1.12.12.m3.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.12.12.m3.1b"><apply id="alg1.12.12.m3.1.1.cmml" xref="alg1.12.12.m3.1.1"><eq id="alg1.12.12.m3.1.1.1.cmml" xref="alg1.12.12.m3.1.1.1"></eq><apply id="alg1.12.12.m3.1.1.2.cmml" xref="alg1.12.12.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.12.12.m3.1.1.2.1.cmml" xref="alg1.12.12.m3.1.1.2">subscript</csymbol><ci id="alg1.12.12.m3.1.1.2.2.cmml" xref="alg1.12.12.m3.1.1.2.2">𝒦</ci><ci id="alg1.12.12.m3.1.1.2.3.cmml" xref="alg1.12.12.m3.1.1.2.3">𝑞</ci></apply><csymbol cd="latexml" id="alg1.12.12.m3.1.1.3.cmml" xref="alg1.12.12.m3.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.m3.1c">\mathcal{K}_{q}=</annotation></semantics></math><span id="alg1.12.12.8" class="ltx_text" style="font-size:90%;"> Ø;</span>
</div>
<div id="alg1.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.15.15.1.1.1" class="ltx_text" style="font-size:90%;">6</span></span><span id="alg1.15.15.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.15.15.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.15.15.4" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.15.15.5" class="ltx_text" style="font-size:90%;">
Select the </span><math id="alg1.13.13.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="alg1.13.13.m1.1a"><mi mathsize="90%" id="alg1.13.13.m1.1.1" xref="alg1.13.13.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg1.13.13.m1.1b"><ci id="alg1.13.13.m1.1.1.cmml" xref="alg1.13.13.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.m1.1c">q</annotation></semantics></math><span id="alg1.15.15.6" class="ltx_text" style="font-size:90%;">-th layer-operation pair </span><math id="alg1.14.14.m2.4" class="ltx_Math" alttext="(\mathcal{L}_{t,i}^{n},O_{i}^{n})" display="inline"><semantics id="alg1.14.14.m2.4a"><mrow id="alg1.14.14.m2.4.4.2" xref="alg1.14.14.m2.4.4.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.14.14.m2.4.4.2.3" xref="alg1.14.14.m2.4.4.3.cmml">(</mo><msubsup id="alg1.14.14.m2.3.3.1.1" xref="alg1.14.14.m2.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.14.14.m2.3.3.1.1.2.2" xref="alg1.14.14.m2.3.3.1.1.2.2.cmml">ℒ</mi><mrow id="alg1.14.14.m2.2.2.2.4" xref="alg1.14.14.m2.2.2.2.3.cmml"><mi mathsize="90%" id="alg1.14.14.m2.1.1.1.1" xref="alg1.14.14.m2.1.1.1.1.cmml">t</mi><mo mathsize="90%" id="alg1.14.14.m2.2.2.2.4.1" xref="alg1.14.14.m2.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="alg1.14.14.m2.2.2.2.2" xref="alg1.14.14.m2.2.2.2.2.cmml">i</mi></mrow><mi mathsize="90%" id="alg1.14.14.m2.3.3.1.1.3" xref="alg1.14.14.m2.3.3.1.1.3.cmml">n</mi></msubsup><mo mathsize="90%" id="alg1.14.14.m2.4.4.2.4" xref="alg1.14.14.m2.4.4.3.cmml">,</mo><msubsup id="alg1.14.14.m2.4.4.2.2" xref="alg1.14.14.m2.4.4.2.2.cmml"><mi mathsize="90%" id="alg1.14.14.m2.4.4.2.2.2.2" xref="alg1.14.14.m2.4.4.2.2.2.2.cmml">O</mi><mi mathsize="90%" id="alg1.14.14.m2.4.4.2.2.2.3" xref="alg1.14.14.m2.4.4.2.2.2.3.cmml">i</mi><mi mathsize="90%" id="alg1.14.14.m2.4.4.2.2.3" xref="alg1.14.14.m2.4.4.2.2.3.cmml">n</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.14.14.m2.4.4.2.5" xref="alg1.14.14.m2.4.4.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.14.14.m2.4b"><interval closure="open" id="alg1.14.14.m2.4.4.3.cmml" xref="alg1.14.14.m2.4.4.2"><apply id="alg1.14.14.m2.3.3.1.1.cmml" xref="alg1.14.14.m2.3.3.1.1"><csymbol cd="ambiguous" id="alg1.14.14.m2.3.3.1.1.1.cmml" xref="alg1.14.14.m2.3.3.1.1">superscript</csymbol><apply id="alg1.14.14.m2.3.3.1.1.2.cmml" xref="alg1.14.14.m2.3.3.1.1"><csymbol cd="ambiguous" id="alg1.14.14.m2.3.3.1.1.2.1.cmml" xref="alg1.14.14.m2.3.3.1.1">subscript</csymbol><ci id="alg1.14.14.m2.3.3.1.1.2.2.cmml" xref="alg1.14.14.m2.3.3.1.1.2.2">ℒ</ci><list id="alg1.14.14.m2.2.2.2.3.cmml" xref="alg1.14.14.m2.2.2.2.4"><ci id="alg1.14.14.m2.1.1.1.1.cmml" xref="alg1.14.14.m2.1.1.1.1">𝑡</ci><ci id="alg1.14.14.m2.2.2.2.2.cmml" xref="alg1.14.14.m2.2.2.2.2">𝑖</ci></list></apply><ci id="alg1.14.14.m2.3.3.1.1.3.cmml" xref="alg1.14.14.m2.3.3.1.1.3">𝑛</ci></apply><apply id="alg1.14.14.m2.4.4.2.2.cmml" xref="alg1.14.14.m2.4.4.2.2"><csymbol cd="ambiguous" id="alg1.14.14.m2.4.4.2.2.1.cmml" xref="alg1.14.14.m2.4.4.2.2">superscript</csymbol><apply id="alg1.14.14.m2.4.4.2.2.2.cmml" xref="alg1.14.14.m2.4.4.2.2"><csymbol cd="ambiguous" id="alg1.14.14.m2.4.4.2.2.2.1.cmml" xref="alg1.14.14.m2.4.4.2.2">subscript</csymbol><ci id="alg1.14.14.m2.4.4.2.2.2.2.cmml" xref="alg1.14.14.m2.4.4.2.2.2.2">𝑂</ci><ci id="alg1.14.14.m2.4.4.2.2.2.3.cmml" xref="alg1.14.14.m2.4.4.2.2.2.3">𝑖</ci></apply><ci id="alg1.14.14.m2.4.4.2.2.3.cmml" xref="alg1.14.14.m2.4.4.2.2.3">𝑛</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.m2.4c">(\mathcal{L}_{t,i}^{n},O_{i}^{n})</annotation></semantics></math><span id="alg1.15.15.7" class="ltx_text" style="font-size:90%;"> from group </span><math id="alg1.15.15.m3.1" class="ltx_Math" alttext="\mathcal{G}_{k}" display="inline"><semantics id="alg1.15.15.m3.1a"><msub id="alg1.15.15.m3.1.1" xref="alg1.15.15.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.15.15.m3.1.1.2" xref="alg1.15.15.m3.1.1.2.cmml">𝒢</mi><mi mathsize="90%" id="alg1.15.15.m3.1.1.3" xref="alg1.15.15.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.15.15.m3.1b"><apply id="alg1.15.15.m3.1.1.cmml" xref="alg1.15.15.m3.1.1"><csymbol cd="ambiguous" id="alg1.15.15.m3.1.1.1.cmml" xref="alg1.15.15.m3.1.1">subscript</csymbol><ci id="alg1.15.15.m3.1.1.2.cmml" xref="alg1.15.15.m3.1.1.2">𝒢</ci><ci id="alg1.15.15.m3.1.1.3.cmml" xref="alg1.15.15.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.m3.1c">\mathcal{G}_{k}</annotation></semantics></math>
</div>
<div id="alg1.21.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.21.21.1.1.1" class="ltx_text" style="font-size:90%;">7</span></span><span id="alg1.21.21.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.21.21.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.21.21.4" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.21.21.5" class="ltx_text" style="font-size:90%;">
Add </span><math id="alg1.16.16.m1.4" class="ltx_Math" alttext="(\mathcal{L}_{t,i}^{n},O_{i}^{n})" display="inline"><semantics id="alg1.16.16.m1.4a"><mrow id="alg1.16.16.m1.4.4.2" xref="alg1.16.16.m1.4.4.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.16.16.m1.4.4.2.3" xref="alg1.16.16.m1.4.4.3.cmml">(</mo><msubsup id="alg1.16.16.m1.3.3.1.1" xref="alg1.16.16.m1.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.16.16.m1.3.3.1.1.2.2" xref="alg1.16.16.m1.3.3.1.1.2.2.cmml">ℒ</mi><mrow id="alg1.16.16.m1.2.2.2.4" xref="alg1.16.16.m1.2.2.2.3.cmml"><mi mathsize="90%" id="alg1.16.16.m1.1.1.1.1" xref="alg1.16.16.m1.1.1.1.1.cmml">t</mi><mo mathsize="90%" id="alg1.16.16.m1.2.2.2.4.1" xref="alg1.16.16.m1.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="alg1.16.16.m1.2.2.2.2" xref="alg1.16.16.m1.2.2.2.2.cmml">i</mi></mrow><mi mathsize="90%" id="alg1.16.16.m1.3.3.1.1.3" xref="alg1.16.16.m1.3.3.1.1.3.cmml">n</mi></msubsup><mo mathsize="90%" id="alg1.16.16.m1.4.4.2.4" xref="alg1.16.16.m1.4.4.3.cmml">,</mo><msubsup id="alg1.16.16.m1.4.4.2.2" xref="alg1.16.16.m1.4.4.2.2.cmml"><mi mathsize="90%" id="alg1.16.16.m1.4.4.2.2.2.2" xref="alg1.16.16.m1.4.4.2.2.2.2.cmml">O</mi><mi mathsize="90%" id="alg1.16.16.m1.4.4.2.2.2.3" xref="alg1.16.16.m1.4.4.2.2.2.3.cmml">i</mi><mi mathsize="90%" id="alg1.16.16.m1.4.4.2.2.3" xref="alg1.16.16.m1.4.4.2.2.3.cmml">n</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.16.16.m1.4.4.2.5" xref="alg1.16.16.m1.4.4.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.16.16.m1.4b"><interval closure="open" id="alg1.16.16.m1.4.4.3.cmml" xref="alg1.16.16.m1.4.4.2"><apply id="alg1.16.16.m1.3.3.1.1.cmml" xref="alg1.16.16.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.16.16.m1.3.3.1.1.1.cmml" xref="alg1.16.16.m1.3.3.1.1">superscript</csymbol><apply id="alg1.16.16.m1.3.3.1.1.2.cmml" xref="alg1.16.16.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.16.16.m1.3.3.1.1.2.1.cmml" xref="alg1.16.16.m1.3.3.1.1">subscript</csymbol><ci id="alg1.16.16.m1.3.3.1.1.2.2.cmml" xref="alg1.16.16.m1.3.3.1.1.2.2">ℒ</ci><list id="alg1.16.16.m1.2.2.2.3.cmml" xref="alg1.16.16.m1.2.2.2.4"><ci id="alg1.16.16.m1.1.1.1.1.cmml" xref="alg1.16.16.m1.1.1.1.1">𝑡</ci><ci id="alg1.16.16.m1.2.2.2.2.cmml" xref="alg1.16.16.m1.2.2.2.2">𝑖</ci></list></apply><ci id="alg1.16.16.m1.3.3.1.1.3.cmml" xref="alg1.16.16.m1.3.3.1.1.3">𝑛</ci></apply><apply id="alg1.16.16.m1.4.4.2.2.cmml" xref="alg1.16.16.m1.4.4.2.2"><csymbol cd="ambiguous" id="alg1.16.16.m1.4.4.2.2.1.cmml" xref="alg1.16.16.m1.4.4.2.2">superscript</csymbol><apply id="alg1.16.16.m1.4.4.2.2.2.cmml" xref="alg1.16.16.m1.4.4.2.2"><csymbol cd="ambiguous" id="alg1.16.16.m1.4.4.2.2.2.1.cmml" xref="alg1.16.16.m1.4.4.2.2">subscript</csymbol><ci id="alg1.16.16.m1.4.4.2.2.2.2.cmml" xref="alg1.16.16.m1.4.4.2.2.2.2">𝑂</ci><ci id="alg1.16.16.m1.4.4.2.2.2.3.cmml" xref="alg1.16.16.m1.4.4.2.2.2.3">𝑖</ci></apply><ci id="alg1.16.16.m1.4.4.2.2.3.cmml" xref="alg1.16.16.m1.4.4.2.2.3">𝑛</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.m1.4c">(\mathcal{L}_{t,i}^{n},O_{i}^{n})</annotation></semantics></math><span id="alg1.21.21.6" class="ltx_text" style="font-size:90%;"> to </span><math id="alg1.17.17.m2.1" class="ltx_Math" alttext="\mathbf{c}_{q}" display="inline"><semantics id="alg1.17.17.m2.1a"><msub id="alg1.17.17.m2.1.1" xref="alg1.17.17.m2.1.1.cmml"><mi mathsize="90%" id="alg1.17.17.m2.1.1.2" xref="alg1.17.17.m2.1.1.2.cmml">𝐜</mi><mi mathsize="90%" id="alg1.17.17.m2.1.1.3" xref="alg1.17.17.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.17.17.m2.1b"><apply id="alg1.17.17.m2.1.1.cmml" xref="alg1.17.17.m2.1.1"><csymbol cd="ambiguous" id="alg1.17.17.m2.1.1.1.cmml" xref="alg1.17.17.m2.1.1">subscript</csymbol><ci id="alg1.17.17.m2.1.1.2.cmml" xref="alg1.17.17.m2.1.1.2">𝐜</ci><ci id="alg1.17.17.m2.1.1.3.cmml" xref="alg1.17.17.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.17.m2.1c">\mathbf{c}_{q}</annotation></semantics></math><span id="alg1.21.21.7" class="ltx_text" style="font-size:90%;">,
add </span><math id="alg1.18.18.m3.1" class="ltx_Math" alttext="O_{i}^{n}" display="inline"><semantics id="alg1.18.18.m3.1a"><msubsup id="alg1.18.18.m3.1.1" xref="alg1.18.18.m3.1.1.cmml"><mi mathsize="90%" id="alg1.18.18.m3.1.1.2.2" xref="alg1.18.18.m3.1.1.2.2.cmml">O</mi><mi mathsize="90%" id="alg1.18.18.m3.1.1.2.3" xref="alg1.18.18.m3.1.1.2.3.cmml">i</mi><mi mathsize="90%" id="alg1.18.18.m3.1.1.3" xref="alg1.18.18.m3.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.18.18.m3.1b"><apply id="alg1.18.18.m3.1.1.cmml" xref="alg1.18.18.m3.1.1"><csymbol cd="ambiguous" id="alg1.18.18.m3.1.1.1.cmml" xref="alg1.18.18.m3.1.1">superscript</csymbol><apply id="alg1.18.18.m3.1.1.2.cmml" xref="alg1.18.18.m3.1.1"><csymbol cd="ambiguous" id="alg1.18.18.m3.1.1.2.1.cmml" xref="alg1.18.18.m3.1.1">subscript</csymbol><ci id="alg1.18.18.m3.1.1.2.2.cmml" xref="alg1.18.18.m3.1.1.2.2">𝑂</ci><ci id="alg1.18.18.m3.1.1.2.3.cmml" xref="alg1.18.18.m3.1.1.2.3">𝑖</ci></apply><ci id="alg1.18.18.m3.1.1.3.cmml" xref="alg1.18.18.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.18.m3.1c">O_{i}^{n}</annotation></semantics></math><span id="alg1.21.21.8" class="ltx_text" style="font-size:90%;"> to </span><math id="alg1.19.19.m4.1" class="ltx_Math" alttext="\mathcal{O}_{q}" display="inline"><semantics id="alg1.19.19.m4.1a"><msub id="alg1.19.19.m4.1.1" xref="alg1.19.19.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.19.19.m4.1.1.2" xref="alg1.19.19.m4.1.1.2.cmml">𝒪</mi><mi mathsize="90%" id="alg1.19.19.m4.1.1.3" xref="alg1.19.19.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.19.19.m4.1b"><apply id="alg1.19.19.m4.1.1.cmml" xref="alg1.19.19.m4.1.1"><csymbol cd="ambiguous" id="alg1.19.19.m4.1.1.1.cmml" xref="alg1.19.19.m4.1.1">subscript</csymbol><ci id="alg1.19.19.m4.1.1.2.cmml" xref="alg1.19.19.m4.1.1.2">𝒪</ci><ci id="alg1.19.19.m4.1.1.3.cmml" xref="alg1.19.19.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.19.m4.1c">\mathcal{O}_{q}</annotation></semantics></math><span id="alg1.21.21.9" class="ltx_text" style="font-size:90%;">,
add </span><math id="alg1.20.20.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.20.20.m5.1a"><mi mathsize="90%" id="alg1.20.20.m5.1.1" xref="alg1.20.20.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.20.20.m5.1b"><ci id="alg1.20.20.m5.1.1.cmml" xref="alg1.20.20.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.20.m5.1c">k</annotation></semantics></math><span id="alg1.21.21.10" class="ltx_text" style="font-size:90%;"> to </span><math id="alg1.21.21.m6.1" class="ltx_Math" alttext="\mathcal{K}_{q}" display="inline"><semantics id="alg1.21.21.m6.1a"><msub id="alg1.21.21.m6.1.1" xref="alg1.21.21.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.21.21.m6.1.1.2" xref="alg1.21.21.m6.1.1.2.cmml">𝒦</mi><mi mathsize="90%" id="alg1.21.21.m6.1.1.3" xref="alg1.21.21.m6.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.21.21.m6.1b"><apply id="alg1.21.21.m6.1.1.cmml" xref="alg1.21.21.m6.1.1"><csymbol cd="ambiguous" id="alg1.21.21.m6.1.1.1.cmml" xref="alg1.21.21.m6.1.1">subscript</csymbol><ci id="alg1.21.21.m6.1.1.2.cmml" xref="alg1.21.21.m6.1.1.2">𝒦</ci><ci id="alg1.21.21.m6.1.1.3.cmml" xref="alg1.21.21.m6.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.21.m6.1c">\mathcal{K}_{q}</annotation></semantics></math><span id="alg1.21.21.11" class="ltx_text" style="font-size:90%;">;</span>
</div>
<div id="alg1.22.22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.22.22.2.1.1" class="ltx_text" style="font-size:90%;">8</span></span><span id="alg1.22.22.3" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.22.22.4" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.22.22.5" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.22.22.6" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.22.22.7" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.22.22.8" class="ltx_text" style="font-size:90%;"> </span><em id="alg1.22.22.1" class="ltx_emph ltx_font_italic" style="font-size:90%;"><math id="alg1.22.22.1.m1.3" class="ltx_Math" alttext="k^{\prime}\leftarrow 1,\cdots,K" display="inline"><semantics id="alg1.22.22.1.m1.3a"><mrow id="alg1.22.22.1.m1.3.4" xref="alg1.22.22.1.m1.3.4.cmml"><msup id="alg1.22.22.1.m1.3.4.2" xref="alg1.22.22.1.m1.3.4.2.cmml"><mi id="alg1.22.22.1.m1.3.4.2.2" xref="alg1.22.22.1.m1.3.4.2.2.cmml">k</mi><mo id="alg1.22.22.1.m1.3.4.2.3" xref="alg1.22.22.1.m1.3.4.2.3.cmml">′</mo></msup><mo stretchy="false" id="alg1.22.22.1.m1.3.4.1" xref="alg1.22.22.1.m1.3.4.1.cmml">←</mo><mrow id="alg1.22.22.1.m1.3.4.3.2" xref="alg1.22.22.1.m1.3.4.3.1.cmml"><mn id="alg1.22.22.1.m1.1.1" xref="alg1.22.22.1.m1.1.1.cmml">1</mn><mo id="alg1.22.22.1.m1.3.4.3.2.1" xref="alg1.22.22.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.22.22.1.m1.2.2" xref="alg1.22.22.1.m1.2.2.cmml">⋯</mi><mo id="alg1.22.22.1.m1.3.4.3.2.2" xref="alg1.22.22.1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.22.22.1.m1.3.3" xref="alg1.22.22.1.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.22.22.1.m1.3b"><apply id="alg1.22.22.1.m1.3.4.cmml" xref="alg1.22.22.1.m1.3.4"><ci id="alg1.22.22.1.m1.3.4.1.cmml" xref="alg1.22.22.1.m1.3.4.1">←</ci><apply id="alg1.22.22.1.m1.3.4.2.cmml" xref="alg1.22.22.1.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.22.22.1.m1.3.4.2.1.cmml" xref="alg1.22.22.1.m1.3.4.2">superscript</csymbol><ci id="alg1.22.22.1.m1.3.4.2.2.cmml" xref="alg1.22.22.1.m1.3.4.2.2">𝑘</ci><ci id="alg1.22.22.1.m1.3.4.2.3.cmml" xref="alg1.22.22.1.m1.3.4.2.3">′</ci></apply><list id="alg1.22.22.1.m1.3.4.3.1.cmml" xref="alg1.22.22.1.m1.3.4.3.2"><cn type="integer" id="alg1.22.22.1.m1.1.1.cmml" xref="alg1.22.22.1.m1.1.1">1</cn><ci id="alg1.22.22.1.m1.2.2.cmml" xref="alg1.22.22.1.m1.2.2">⋯</ci><ci id="alg1.22.22.1.m1.3.3.cmml" xref="alg1.22.22.1.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.22.1.m1.3c">k^{\prime}\leftarrow 1,\cdots,K</annotation></semantics></math> </em><span id="alg1.22.22.9" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.22.22.10" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="alg1.23.23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.23.23.1.1.1" class="ltx_text" style="font-size:90%;">9</span></span><span id="alg1.23.23.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.23.23.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.23.23.4" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.23.23.5" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.23.23.6" class="ltx_text" style="font-size:90%;">
Check a pair from </span><math id="alg1.23.23.m1.1" class="ltx_Math" alttext="\mathcal{G}_{k^{\prime}}" display="inline"><semantics id="alg1.23.23.m1.1a"><msub id="alg1.23.23.m1.1.1" xref="alg1.23.23.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.23.23.m1.1.1.2" xref="alg1.23.23.m1.1.1.2.cmml">𝒢</mi><msup id="alg1.23.23.m1.1.1.3" xref="alg1.23.23.m1.1.1.3.cmml"><mi mathsize="90%" id="alg1.23.23.m1.1.1.3.2" xref="alg1.23.23.m1.1.1.3.2.cmml">k</mi><mo mathsize="90%" id="alg1.23.23.m1.1.1.3.3" xref="alg1.23.23.m1.1.1.3.3.cmml">′</mo></msup></msub><annotation-xml encoding="MathML-Content" id="alg1.23.23.m1.1b"><apply id="alg1.23.23.m1.1.1.cmml" xref="alg1.23.23.m1.1.1"><csymbol cd="ambiguous" id="alg1.23.23.m1.1.1.1.cmml" xref="alg1.23.23.m1.1.1">subscript</csymbol><ci id="alg1.23.23.m1.1.1.2.cmml" xref="alg1.23.23.m1.1.1.2">𝒢</ci><apply id="alg1.23.23.m1.1.1.3.cmml" xref="alg1.23.23.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.23.23.m1.1.1.3.1.cmml" xref="alg1.23.23.m1.1.1.3">superscript</csymbol><ci id="alg1.23.23.m1.1.1.3.2.cmml" xref="alg1.23.23.m1.1.1.3.2">𝑘</ci><ci id="alg1.23.23.m1.1.1.3.3.cmml" xref="alg1.23.23.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.23.m1.1c">\mathcal{G}_{k^{\prime}}</annotation></semantics></math><span id="alg1.23.23.7" class="ltx_text" style="font-size:90%;"> whether it satisfies: </span>
</div>
<div id="alg1.25.25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.25.25.1.1.1" class="ltx_text" style="font-size:90%;">10</span></span><span id="alg1.25.25.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.25.25.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.25.25.4" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.25.25.5" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.25.25.6" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.24.24.m1.1" class="ltx_Math" alttext="\mathcal{R}_{1}" display="inline"><semantics id="alg1.24.24.m1.1a"><msub id="alg1.24.24.m1.1.1" xref="alg1.24.24.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.24.24.m1.1.1.2" xref="alg1.24.24.m1.1.1.2.cmml">ℛ</mi><mn mathsize="90%" id="alg1.24.24.m1.1.1.3" xref="alg1.24.24.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.24.24.m1.1b"><apply id="alg1.24.24.m1.1.1.cmml" xref="alg1.24.24.m1.1.1"><csymbol cd="ambiguous" id="alg1.24.24.m1.1.1.1.cmml" xref="alg1.24.24.m1.1.1">subscript</csymbol><ci id="alg1.24.24.m1.1.1.2.cmml" xref="alg1.24.24.m1.1.1.2">ℛ</ci><cn type="integer" id="alg1.24.24.m1.1.1.3.cmml" xref="alg1.24.24.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.24.m1.1c">\mathcal{R}_{1}</annotation></semantics></math><span id="alg1.25.25.7" class="ltx_text" style="font-size:90%;"> (</span><span id="alg1.25.25.8" class="ltx_text" style="font-size:90%;color:#0000FF;">layer order</span><span id="alg1.25.25.9" class="ltx_text" style="font-size:90%;">): the layer index should be larger than that of the last layer added to </span><math id="alg1.25.25.m2.1" class="ltx_Math" alttext="\mathbf{c}_{q}" display="inline"><semantics id="alg1.25.25.m2.1a"><msub id="alg1.25.25.m2.1.1" xref="alg1.25.25.m2.1.1.cmml"><mi mathsize="90%" id="alg1.25.25.m2.1.1.2" xref="alg1.25.25.m2.1.1.2.cmml">𝐜</mi><mi mathsize="90%" id="alg1.25.25.m2.1.1.3" xref="alg1.25.25.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.25.25.m2.1b"><apply id="alg1.25.25.m2.1.1.cmml" xref="alg1.25.25.m2.1.1"><csymbol cd="ambiguous" id="alg1.25.25.m2.1.1.1.cmml" xref="alg1.25.25.m2.1.1">subscript</csymbol><ci id="alg1.25.25.m2.1.1.2.cmml" xref="alg1.25.25.m2.1.1.2">𝐜</ci><ci id="alg1.25.25.m2.1.1.3.cmml" xref="alg1.25.25.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.25.m2.1c">\mathbf{c}_{q}</annotation></semantics></math><span id="alg1.25.25.10" class="ltx_text" style="font-size:90%;">, and</span>
</div>
<div id="alg1.27.27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.27.27.1.1.1" class="ltx_text" style="font-size:90%;">11</span></span><span id="alg1.27.27.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.27.27.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.27.27.4" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.27.27.5" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.27.27.6" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.26.26.m1.1" class="ltx_Math" alttext="\mathcal{R}_{2}" display="inline"><semantics id="alg1.26.26.m1.1a"><msub id="alg1.26.26.m1.1.1" xref="alg1.26.26.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.26.26.m1.1.1.2" xref="alg1.26.26.m1.1.1.2.cmml">ℛ</mi><mn mathsize="90%" id="alg1.26.26.m1.1.1.3" xref="alg1.26.26.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.26.26.m1.1b"><apply id="alg1.26.26.m1.1.1.cmml" xref="alg1.26.26.m1.1.1"><csymbol cd="ambiguous" id="alg1.26.26.m1.1.1.1.cmml" xref="alg1.26.26.m1.1.1">subscript</csymbol><ci id="alg1.26.26.m1.1.1.2.cmml" xref="alg1.26.26.m1.1.1.2">ℛ</ci><cn type="integer" id="alg1.26.26.m1.1.1.3.cmml" xref="alg1.26.26.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.26.26.m1.1c">\mathcal{R}_{2}</annotation></semantics></math><span id="alg1.27.27.7" class="ltx_text" style="font-size:90%;"> (</span><span id="alg1.27.27.8" class="ltx_text" style="font-size:90%;color:#0000FF;">operation order</span><span id="alg1.27.27.9" class="ltx_text" style="font-size:90%;">): the operation type should be followed by the previous type in </span><math id="alg1.27.27.m2.1" class="ltx_Math" alttext="\mathbf{c}_{q}" display="inline"><semantics id="alg1.27.27.m2.1a"><msub id="alg1.27.27.m2.1.1" xref="alg1.27.27.m2.1.1.cmml"><mi mathsize="90%" id="alg1.27.27.m2.1.1.2" xref="alg1.27.27.m2.1.1.2.cmml">𝐜</mi><mi mathsize="90%" id="alg1.27.27.m2.1.1.3" xref="alg1.27.27.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.27.27.m2.1b"><apply id="alg1.27.27.m2.1.1.cmml" xref="alg1.27.27.m2.1.1"><csymbol cd="ambiguous" id="alg1.27.27.m2.1.1.1.cmml" xref="alg1.27.27.m2.1.1">subscript</csymbol><ci id="alg1.27.27.m2.1.1.2.cmml" xref="alg1.27.27.m2.1.1.2">𝐜</ci><ci id="alg1.27.27.m2.1.1.3.cmml" xref="alg1.27.27.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.27.27.m2.1c">\mathbf{c}_{q}</annotation></semantics></math><span id="alg1.27.27.10" class="ltx_text" style="font-size:90%;">;</span>
</div>
<div id="alg1.42.43" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.42.43.1.1.1" class="ltx_text" style="font-size:90%;">12</span></span><span id="alg1.42.43.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.43.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.43.4" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.43.5" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.42.43.6" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.42.43.7" class="ltx_text ltx_font_bold" style="font-size:90%;">if</span><span id="alg1.42.43.8" class="ltx_text" style="font-size:90%;"> </span><em id="alg1.42.43.9" class="ltx_emph ltx_font_italic" style="font-size:90%;">True</em><span id="alg1.42.43.10" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.42.43.11" class="ltx_text ltx_font_bold" style="font-size:90%;">then</span>
</div>
<div id="alg1.31.31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.31.31.1.1.1" class="ltx_text" style="font-size:90%;">13</span></span><span id="alg1.31.31.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.31.31.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.31.31.4" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.31.31.5" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.31.31.6" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.31.31.7" class="ltx_text" style="font-size:90%;">
Add the pair to </span><math id="alg1.28.28.m1.1" class="ltx_Math" alttext="\mathbf{c}_{q}" display="inline"><semantics id="alg1.28.28.m1.1a"><msub id="alg1.28.28.m1.1.1" xref="alg1.28.28.m1.1.1.cmml"><mi mathsize="90%" id="alg1.28.28.m1.1.1.2" xref="alg1.28.28.m1.1.1.2.cmml">𝐜</mi><mi mathsize="90%" id="alg1.28.28.m1.1.1.3" xref="alg1.28.28.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.28.28.m1.1b"><apply id="alg1.28.28.m1.1.1.cmml" xref="alg1.28.28.m1.1.1"><csymbol cd="ambiguous" id="alg1.28.28.m1.1.1.1.cmml" xref="alg1.28.28.m1.1.1">subscript</csymbol><ci id="alg1.28.28.m1.1.1.2.cmml" xref="alg1.28.28.m1.1.1.2">𝐜</ci><ci id="alg1.28.28.m1.1.1.3.cmml" xref="alg1.28.28.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.28.28.m1.1c">\mathbf{c}_{q}</annotation></semantics></math><span id="alg1.31.31.8" class="ltx_text" style="font-size:90%;">,
add its operation type to </span><math id="alg1.29.29.m2.1" class="ltx_Math" alttext="\mathcal{O}_{q}" display="inline"><semantics id="alg1.29.29.m2.1a"><msub id="alg1.29.29.m2.1.1" xref="alg1.29.29.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.29.29.m2.1.1.2" xref="alg1.29.29.m2.1.1.2.cmml">𝒪</mi><mi mathsize="90%" id="alg1.29.29.m2.1.1.3" xref="alg1.29.29.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.29.29.m2.1b"><apply id="alg1.29.29.m2.1.1.cmml" xref="alg1.29.29.m2.1.1"><csymbol cd="ambiguous" id="alg1.29.29.m2.1.1.1.cmml" xref="alg1.29.29.m2.1.1">subscript</csymbol><ci id="alg1.29.29.m2.1.1.2.cmml" xref="alg1.29.29.m2.1.1.2">𝒪</ci><ci id="alg1.29.29.m2.1.1.3.cmml" xref="alg1.29.29.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.29.29.m2.1c">\mathcal{O}_{q}</annotation></semantics></math><span id="alg1.31.31.9" class="ltx_text" style="font-size:90%;">,
add </span><math id="alg1.30.30.m3.1" class="ltx_Math" alttext="k^{\prime}" display="inline"><semantics id="alg1.30.30.m3.1a"><msup id="alg1.30.30.m3.1.1" xref="alg1.30.30.m3.1.1.cmml"><mi mathsize="90%" id="alg1.30.30.m3.1.1.2" xref="alg1.30.30.m3.1.1.2.cmml">k</mi><mo mathsize="90%" id="alg1.30.30.m3.1.1.3" xref="alg1.30.30.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg1.30.30.m3.1b"><apply id="alg1.30.30.m3.1.1.cmml" xref="alg1.30.30.m3.1.1"><csymbol cd="ambiguous" id="alg1.30.30.m3.1.1.1.cmml" xref="alg1.30.30.m3.1.1">superscript</csymbol><ci id="alg1.30.30.m3.1.1.2.cmml" xref="alg1.30.30.m3.1.1.2">𝑘</ci><ci id="alg1.30.30.m3.1.1.3.cmml" xref="alg1.30.30.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.30.30.m3.1c">k^{\prime}</annotation></semantics></math><span id="alg1.31.31.10" class="ltx_text" style="font-size:90%;"> to </span><math id="alg1.31.31.m4.1" class="ltx_Math" alttext="\mathcal{K}_{q}" display="inline"><semantics id="alg1.31.31.m4.1a"><msub id="alg1.31.31.m4.1.1" xref="alg1.31.31.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.31.31.m4.1.1.2" xref="alg1.31.31.m4.1.1.2.cmml">𝒦</mi><mi mathsize="90%" id="alg1.31.31.m4.1.1.3" xref="alg1.31.31.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.31.31.m4.1b"><apply id="alg1.31.31.m4.1.1.cmml" xref="alg1.31.31.m4.1.1"><csymbol cd="ambiguous" id="alg1.31.31.m4.1.1.1.cmml" xref="alg1.31.31.m4.1.1">subscript</csymbol><ci id="alg1.31.31.m4.1.1.2.cmml" xref="alg1.31.31.m4.1.1.2">𝒦</ci><ci id="alg1.31.31.m4.1.1.3.cmml" xref="alg1.31.31.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.31.31.m4.1c">\mathcal{K}_{q}</annotation></semantics></math><span id="alg1.31.31.11" class="ltx_text" style="font-size:90%;">;</span>
</div>
<div id="alg1.42.44" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.42.44.1.1.1" class="ltx_text" style="font-size:90%;">14</span></span><span id="alg1.42.44.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.44.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.44.4" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.44.5" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.44.6" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.42.44.7" class="ltx_text" style="font-size:90%;">
Move to the next pair;
</span>
</div>
<div id="alg1.42.45" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.42.45.1.1.1" class="ltx_text" style="font-size:90%;">15</span></span><span id="alg1.42.45.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.45.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.45.4" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.45.5" class="ltx_text" style="font-size:90%;">   </span>
</div>
<div id="alg1.33.33" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.33.33.1.1.1" class="ltx_text" style="font-size:90%;">16</span></span><span id="alg1.33.33.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.33.33.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.33.33.4" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.33.33.5" class="ltx_text" style="font-size:90%;">Check </span><math id="alg1.32.32.m1.1" class="ltx_Math" alttext="\mathcal{O}_{q}" display="inline"><semantics id="alg1.32.32.m1.1a"><msub id="alg1.32.32.m1.1.1" xref="alg1.32.32.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.32.32.m1.1.1.2" xref="alg1.32.32.m1.1.1.2.cmml">𝒪</mi><mi mathsize="90%" id="alg1.32.32.m1.1.1.3" xref="alg1.32.32.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.32.32.m1.1b"><apply id="alg1.32.32.m1.1.1.cmml" xref="alg1.32.32.m1.1.1"><csymbol cd="ambiguous" id="alg1.32.32.m1.1.1.1.cmml" xref="alg1.32.32.m1.1.1">subscript</csymbol><ci id="alg1.32.32.m1.1.1.2.cmml" xref="alg1.32.32.m1.1.1.2">𝒪</ci><ci id="alg1.32.32.m1.1.1.3.cmml" xref="alg1.32.32.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.32.32.m1.1c">\mathcal{O}_{q}</annotation></semantics></math><span id="alg1.33.33.6" class="ltx_text" style="font-size:90%;"> and </span><math id="alg1.33.33.m2.1" class="ltx_Math" alttext="\mathcal{K}_{q}" display="inline"><semantics id="alg1.33.33.m2.1a"><msub id="alg1.33.33.m2.1.1" xref="alg1.33.33.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.33.33.m2.1.1.2" xref="alg1.33.33.m2.1.1.2.cmml">𝒦</mi><mi mathsize="90%" id="alg1.33.33.m2.1.1.3" xref="alg1.33.33.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.33.33.m2.1b"><apply id="alg1.33.33.m2.1.1.cmml" xref="alg1.33.33.m2.1.1"><csymbol cd="ambiguous" id="alg1.33.33.m2.1.1.1.cmml" xref="alg1.33.33.m2.1.1">subscript</csymbol><ci id="alg1.33.33.m2.1.1.2.cmml" xref="alg1.33.33.m2.1.1.2">𝒦</ci><ci id="alg1.33.33.m2.1.1.3.cmml" xref="alg1.33.33.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.33.33.m2.1c">\mathcal{K}_{q}</annotation></semantics></math><span id="alg1.33.33.7" class="ltx_text" style="font-size:90%;"> with:</span>
</div>
<div id="alg1.36.36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.36.36.1.1.1" class="ltx_text" style="font-size:90%;">17</span></span><span id="alg1.36.36.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.36.36.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.36.36.4" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.36.36.5" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.34.34.m1.1" class="ltx_Math" alttext="\mathcal{R}_{3}" display="inline"><semantics id="alg1.34.34.m1.1a"><msub id="alg1.34.34.m1.1.1" xref="alg1.34.34.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.34.34.m1.1.1.2" xref="alg1.34.34.m1.1.1.2.cmml">ℛ</mi><mn mathsize="90%" id="alg1.34.34.m1.1.1.3" xref="alg1.34.34.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.34.34.m1.1b"><apply id="alg1.34.34.m1.1.1.cmml" xref="alg1.34.34.m1.1.1"><csymbol cd="ambiguous" id="alg1.34.34.m1.1.1.1.cmml" xref="alg1.34.34.m1.1.1">subscript</csymbol><ci id="alg1.34.34.m1.1.1.2.cmml" xref="alg1.34.34.m1.1.1.2">ℛ</ci><cn type="integer" id="alg1.34.34.m1.1.1.3.cmml" xref="alg1.34.34.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.34.34.m1.1c">\mathcal{R}_{3}</annotation></semantics></math><span id="alg1.36.36.6" class="ltx_text" style="font-size:90%;"> (</span><span id="alg1.36.36.7" class="ltx_text" style="font-size:90%;color:#0000FF;">complete operation</span><span id="alg1.36.36.8" class="ltx_text" style="font-size:90%;">): the size of </span><math id="alg1.35.35.m2.1" class="ltx_Math" alttext="\mathcal{O}_{q}" display="inline"><semantics id="alg1.35.35.m2.1a"><msub id="alg1.35.35.m2.1.1" xref="alg1.35.35.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.35.35.m2.1.1.2" xref="alg1.35.35.m2.1.1.2.cmml">𝒪</mi><mi mathsize="90%" id="alg1.35.35.m2.1.1.3" xref="alg1.35.35.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.35.35.m2.1b"><apply id="alg1.35.35.m2.1.1.cmml" xref="alg1.35.35.m2.1.1"><csymbol cd="ambiguous" id="alg1.35.35.m2.1.1.1.cmml" xref="alg1.35.35.m2.1.1">subscript</csymbol><ci id="alg1.35.35.m2.1.1.2.cmml" xref="alg1.35.35.m2.1.1.2">𝒪</ci><ci id="alg1.35.35.m2.1.1.3.cmml" xref="alg1.35.35.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.35.35.m2.1c">\mathcal{O}_{q}</annotation></semantics></math><span id="alg1.36.36.9" class="ltx_text" style="font-size:90%;"> should be equal to that of </span><math id="alg1.36.36.m3.1" class="ltx_Math" alttext="\mathcal{O}" display="inline"><semantics id="alg1.36.36.m3.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.36.36.m3.1.1" xref="alg1.36.36.m3.1.1.cmml">𝒪</mi><annotation-xml encoding="MathML-Content" id="alg1.36.36.m3.1b"><ci id="alg1.36.36.m3.1.1.cmml" xref="alg1.36.36.m3.1.1">𝒪</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.36.36.m3.1c">\mathcal{O}</annotation></semantics></math><span id="alg1.36.36.10" class="ltx_text" style="font-size:90%;">, and</span>
</div>
<div id="alg1.39.39" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.39.39.1.1.1" class="ltx_text" style="font-size:90%;">18</span></span><span id="alg1.39.39.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.39.39.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.39.39.4" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.39.39.5" class="ltx_text" style="font-size:90%;">
</span><math id="alg1.37.37.m1.1" class="ltx_Math" alttext="\mathcal{R}_{4}" display="inline"><semantics id="alg1.37.37.m1.1a"><msub id="alg1.37.37.m1.1.1" xref="alg1.37.37.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.37.37.m1.1.1.2" xref="alg1.37.37.m1.1.1.2.cmml">ℛ</mi><mn mathsize="90%" id="alg1.37.37.m1.1.1.3" xref="alg1.37.37.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.37.37.m1.1b"><apply id="alg1.37.37.m1.1.1.cmml" xref="alg1.37.37.m1.1.1"><csymbol cd="ambiguous" id="alg1.37.37.m1.1.1.1.cmml" xref="alg1.37.37.m1.1.1">subscript</csymbol><ci id="alg1.37.37.m1.1.1.2.cmml" xref="alg1.37.37.m1.1.1.2">ℛ</ci><cn type="integer" id="alg1.37.37.m1.1.1.3.cmml" xref="alg1.37.37.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.37.37.m1.1c">\mathcal{R}_{4}</annotation></semantics></math><span id="alg1.39.39.6" class="ltx_text" style="font-size:90%;"> (</span><span id="alg1.39.39.7" class="ltx_text" style="font-size:90%;color:#0000FF;">diverse group</span><span id="alg1.39.39.8" class="ltx_text" style="font-size:90%;">): the size of </span><math id="alg1.38.38.m2.1" class="ltx_Math" alttext="\mathcal{K}_{q}" display="inline"><semantics id="alg1.38.38.m2.1a"><msub id="alg1.38.38.m2.1.1" xref="alg1.38.38.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.38.38.m2.1.1.2" xref="alg1.38.38.m2.1.1.2.cmml">𝒦</mi><mi mathsize="90%" id="alg1.38.38.m2.1.1.3" xref="alg1.38.38.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.38.38.m2.1b"><apply id="alg1.38.38.m2.1.1.cmml" xref="alg1.38.38.m2.1.1"><csymbol cd="ambiguous" id="alg1.38.38.m2.1.1.1.cmml" xref="alg1.38.38.m2.1.1">subscript</csymbol><ci id="alg1.38.38.m2.1.1.2.cmml" xref="alg1.38.38.m2.1.1.2">𝒦</ci><ci id="alg1.38.38.m2.1.1.3.cmml" xref="alg1.38.38.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.38.38.m2.1c">\mathcal{K}_{q}</annotation></semantics></math><span id="alg1.39.39.9" class="ltx_text" style="font-size:90%;"> should be equal to </span><math id="alg1.39.39.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.39.39.m3.1a"><mi mathsize="90%" id="alg1.39.39.m3.1.1" xref="alg1.39.39.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.39.39.m3.1b"><ci id="alg1.39.39.m3.1.1.cmml" xref="alg1.39.39.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.39.39.m3.1c">K</annotation></semantics></math><span id="alg1.39.39.10" class="ltx_text" style="font-size:90%;">;</span>
</div>
<div id="alg1.42.46" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.42.46.1.1.1" class="ltx_text" style="font-size:90%;">19</span></span><span id="alg1.42.46.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.46.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.46.4" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.42.46.5" class="ltx_text" style="font-size:90%;">
</span><span id="alg1.42.46.6" class="ltx_text ltx_font_bold" style="font-size:90%;">if</span><span id="alg1.42.46.7" class="ltx_text" style="font-size:90%;"> </span><em id="alg1.42.46.8" class="ltx_emph ltx_font_italic" style="font-size:90%;">True</em><span id="alg1.42.46.9" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.42.46.10" class="ltx_text ltx_font_bold" style="font-size:90%;">then</span>
</div>
<div id="alg1.41.41" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.41.41.1.1.1" class="ltx_text" style="font-size:90%;">20</span></span><span id="alg1.41.41.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.41.41.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.41.41.4" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.41.41.5" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.41.41.6" class="ltx_text" style="font-size:90%;">
Add the candidate </span><math id="alg1.40.40.m1.1" class="ltx_Math" alttext="\mathbf{c}_{q}" display="inline"><semantics id="alg1.40.40.m1.1a"><msub id="alg1.40.40.m1.1.1" xref="alg1.40.40.m1.1.1.cmml"><mi mathsize="90%" id="alg1.40.40.m1.1.1.2" xref="alg1.40.40.m1.1.1.2.cmml">𝐜</mi><mi mathsize="90%" id="alg1.40.40.m1.1.1.3" xref="alg1.40.40.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.40.40.m1.1b"><apply id="alg1.40.40.m1.1.1.cmml" xref="alg1.40.40.m1.1.1"><csymbol cd="ambiguous" id="alg1.40.40.m1.1.1.1.cmml" xref="alg1.40.40.m1.1.1">subscript</csymbol><ci id="alg1.40.40.m1.1.1.2.cmml" xref="alg1.40.40.m1.1.1.2">𝐜</ci><ci id="alg1.40.40.m1.1.1.3.cmml" xref="alg1.40.40.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.40.40.m1.1c">\mathbf{c}_{q}</annotation></semantics></math><span id="alg1.41.41.7" class="ltx_text" style="font-size:90%;"> to </span><math id="alg1.41.41.m2.1" class="ltx_Math" alttext="\mathcal{C}_{t}" display="inline"><semantics id="alg1.41.41.m2.1a"><msub id="alg1.41.41.m2.1.1" xref="alg1.41.41.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.41.41.m2.1.1.2" xref="alg1.41.41.m2.1.1.2.cmml">𝒞</mi><mi mathsize="90%" id="alg1.41.41.m2.1.1.3" xref="alg1.41.41.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.41.41.m2.1b"><apply id="alg1.41.41.m2.1.1.cmml" xref="alg1.41.41.m2.1.1"><csymbol cd="ambiguous" id="alg1.41.41.m2.1.1.1.cmml" xref="alg1.41.41.m2.1.1">subscript</csymbol><ci id="alg1.41.41.m2.1.1.2.cmml" xref="alg1.41.41.m2.1.1.2">𝒞</ci><ci id="alg1.41.41.m2.1.1.3.cmml" xref="alg1.41.41.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.41.41.m2.1c">\mathcal{C}_{t}</annotation></semantics></math><span id="alg1.41.41.8" class="ltx_text" style="font-size:90%;">;
</span>
</div>
<div id="alg1.42.47" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.42.47.1.1.1" class="ltx_text" style="font-size:90%;">21</span></span><span id="alg1.42.47.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.47.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.47.4" class="ltx_text" style="font-size:90%;">   </span>
</div>
<div id="alg1.42.48" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.42.48.1.1.1" class="ltx_text" style="font-size:90%;">22</span></span><span id="alg1.42.48.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="alg1.42.48.3" class="ltx_text" style="font-size:90%;">   </span>
</div>
<div id="alg1.42.42" class="ltx_listingline">
<span id="alg1.42.42.1" class="ltx_text ltx_font_bold" style="font-size:90%;">return :</span><span id="alg1.42.42.2" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.42.42.m1.3" class="ltx_Math" alttext="\mathcal{C}_{t}=\{\mathbf{c}_{t}^{1},\cdots,\mathbf{c}_{t}^{M}\}" display="inline"><semantics id="alg1.42.42.m1.3a"><mrow id="alg1.42.42.m1.3.3" xref="alg1.42.42.m1.3.3.cmml"><msub id="alg1.42.42.m1.3.3.4" xref="alg1.42.42.m1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.42.42.m1.3.3.4.2" xref="alg1.42.42.m1.3.3.4.2.cmml">𝒞</mi><mi mathsize="90%" id="alg1.42.42.m1.3.3.4.3" xref="alg1.42.42.m1.3.3.4.3.cmml">t</mi></msub><mo mathsize="90%" id="alg1.42.42.m1.3.3.3" xref="alg1.42.42.m1.3.3.3.cmml">=</mo><mrow id="alg1.42.42.m1.3.3.2.2" xref="alg1.42.42.m1.3.3.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.42.42.m1.3.3.2.2.3" xref="alg1.42.42.m1.3.3.2.3.cmml">{</mo><msubsup id="alg1.42.42.m1.2.2.1.1.1" xref="alg1.42.42.m1.2.2.1.1.1.cmml"><mi mathsize="90%" id="alg1.42.42.m1.2.2.1.1.1.2.2" xref="alg1.42.42.m1.2.2.1.1.1.2.2.cmml">𝐜</mi><mi mathsize="90%" id="alg1.42.42.m1.2.2.1.1.1.2.3" xref="alg1.42.42.m1.2.2.1.1.1.2.3.cmml">t</mi><mn mathsize="90%" id="alg1.42.42.m1.2.2.1.1.1.3" xref="alg1.42.42.m1.2.2.1.1.1.3.cmml">1</mn></msubsup><mo mathsize="90%" id="alg1.42.42.m1.3.3.2.2.4" xref="alg1.42.42.m1.3.3.2.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.42.42.m1.1.1" xref="alg1.42.42.m1.1.1.cmml">⋯</mi><mo mathsize="90%" id="alg1.42.42.m1.3.3.2.2.5" xref="alg1.42.42.m1.3.3.2.3.cmml">,</mo><msubsup id="alg1.42.42.m1.3.3.2.2.2" xref="alg1.42.42.m1.3.3.2.2.2.cmml"><mi mathsize="90%" id="alg1.42.42.m1.3.3.2.2.2.2.2" xref="alg1.42.42.m1.3.3.2.2.2.2.2.cmml">𝐜</mi><mi mathsize="90%" id="alg1.42.42.m1.3.3.2.2.2.2.3" xref="alg1.42.42.m1.3.3.2.2.2.2.3.cmml">t</mi><mi mathsize="90%" id="alg1.42.42.m1.3.3.2.2.2.3" xref="alg1.42.42.m1.3.3.2.2.2.3.cmml">M</mi></msubsup><mo maxsize="90%" minsize="90%" id="alg1.42.42.m1.3.3.2.2.6" xref="alg1.42.42.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.42.42.m1.3b"><apply id="alg1.42.42.m1.3.3.cmml" xref="alg1.42.42.m1.3.3"><eq id="alg1.42.42.m1.3.3.3.cmml" xref="alg1.42.42.m1.3.3.3"></eq><apply id="alg1.42.42.m1.3.3.4.cmml" xref="alg1.42.42.m1.3.3.4"><csymbol cd="ambiguous" id="alg1.42.42.m1.3.3.4.1.cmml" xref="alg1.42.42.m1.3.3.4">subscript</csymbol><ci id="alg1.42.42.m1.3.3.4.2.cmml" xref="alg1.42.42.m1.3.3.4.2">𝒞</ci><ci id="alg1.42.42.m1.3.3.4.3.cmml" xref="alg1.42.42.m1.3.3.4.3">𝑡</ci></apply><set id="alg1.42.42.m1.3.3.2.3.cmml" xref="alg1.42.42.m1.3.3.2.2"><apply id="alg1.42.42.m1.2.2.1.1.1.cmml" xref="alg1.42.42.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.42.42.m1.2.2.1.1.1.1.cmml" xref="alg1.42.42.m1.2.2.1.1.1">superscript</csymbol><apply id="alg1.42.42.m1.2.2.1.1.1.2.cmml" xref="alg1.42.42.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.42.42.m1.2.2.1.1.1.2.1.cmml" xref="alg1.42.42.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.42.42.m1.2.2.1.1.1.2.2.cmml" xref="alg1.42.42.m1.2.2.1.1.1.2.2">𝐜</ci><ci id="alg1.42.42.m1.2.2.1.1.1.2.3.cmml" xref="alg1.42.42.m1.2.2.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="alg1.42.42.m1.2.2.1.1.1.3.cmml" xref="alg1.42.42.m1.2.2.1.1.1.3">1</cn></apply><ci id="alg1.42.42.m1.1.1.cmml" xref="alg1.42.42.m1.1.1">⋯</ci><apply id="alg1.42.42.m1.3.3.2.2.2.cmml" xref="alg1.42.42.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.42.42.m1.3.3.2.2.2.1.cmml" xref="alg1.42.42.m1.3.3.2.2.2">superscript</csymbol><apply id="alg1.42.42.m1.3.3.2.2.2.2.cmml" xref="alg1.42.42.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.42.42.m1.3.3.2.2.2.2.1.cmml" xref="alg1.42.42.m1.3.3.2.2.2">subscript</csymbol><ci id="alg1.42.42.m1.3.3.2.2.2.2.2.cmml" xref="alg1.42.42.m1.3.3.2.2.2.2.2">𝐜</ci><ci id="alg1.42.42.m1.3.3.2.2.2.2.3.cmml" xref="alg1.42.42.m1.3.3.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.42.42.m1.3.3.2.2.2.3.cmml" xref="alg1.42.42.m1.3.3.2.2.2.3">𝑀</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.42.42.m1.3c">\mathcal{C}_{t}=\{\mathbf{c}_{t}^{1},\cdots,\mathbf{c}_{t}^{M}\}</annotation></semantics></math><span id="alg1.42.42.3" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="alg1.42.49" class="ltx_listingline">
<span id="alg1.42.49.1" class="ltx_text" style="font-size:90%;">

</span>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg1.46.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Reassembly Candidate Search</figcaption>
</figure>
<div id="S3.SS1.SSS2.p4" class="ltx_para">
<p id="S3.SS1.SSS2.p4.3" class="ltx_p">Based on the defined distance metric, we conduct the K-means-style algorithm to group the layers of <math id="S3.SS1.SSS2.p4.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS1.SSS2.p4.1.m1.1a"><mi id="S3.SS1.SSS2.p4.1.m1.1.1" xref="S3.SS1.SSS2.p4.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.1.m1.1b"><ci id="S3.SS1.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p4.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.1.m1.1c">B</annotation></semantics></math> models into <math id="S3.SS1.SSS2.p4.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.SSS2.p4.2.m2.1a"><mi id="S3.SS1.SSS2.p4.2.m2.1.1" xref="S3.SS1.SSS2.p4.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.2.m2.1b"><ci id="S3.SS1.SSS2.p4.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p4.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.2.m2.1c">K</annotation></semantics></math> clusters. This optimization process aims to minimize the sum of distances between all pairs of layers, denoted as <math id="S3.SS1.SSS2.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{t}" display="inline"><semantics id="S3.SS1.SSS2.p4.3.m3.1a"><msub id="S3.SS1.SSS2.p4.3.m3.1.1" xref="S3.SS1.SSS2.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p4.3.m3.1.1.2" xref="S3.SS1.SSS2.p4.3.m3.1.1.2.cmml">ℒ</mi><mi id="S3.SS1.SSS2.p4.3.m3.1.1.3" xref="S3.SS1.SSS2.p4.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.3.m3.1b"><apply id="S3.SS1.SSS2.p4.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.3.m3.1.1.1.cmml" xref="S3.SS1.SSS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p4.3.m3.1.1.2.cmml" xref="S3.SS1.SSS2.p4.3.m3.1.1.2">ℒ</ci><ci id="S3.SS1.SSS2.p4.3.m3.1.1.3.cmml" xref="S3.SS1.SSS2.p4.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.3.m3.1c">\mathcal{L}_{t}</annotation></semantics></math>. The procedure can be described as follows:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.9" class="ltx_Math" alttext="\min\mathcal{L}_{t}=\min_{\delta_{b,h}^{a}\in\{0,1\}}\sum_{k=1}^{K}\sum_{b=1}^{B}\sum_{h=1}^{H}\delta_{b,h}^{k}(\text{dis}(\mathbf{L}_{t}^{k},\mathbf{L}_{t,h}^{b}))," display="block"><semantics id="S3.E4.m1.9a"><mrow id="S3.E4.m1.9.9.1" xref="S3.E4.m1.9.9.1.1.cmml"><mrow id="S3.E4.m1.9.9.1.1" xref="S3.E4.m1.9.9.1.1.cmml"><mrow id="S3.E4.m1.9.9.1.1.3" xref="S3.E4.m1.9.9.1.1.3.cmml"><mi id="S3.E4.m1.9.9.1.1.3.1" xref="S3.E4.m1.9.9.1.1.3.1.cmml">min</mi><mo lspace="0.167em" id="S3.E4.m1.9.9.1.1.3a" xref="S3.E4.m1.9.9.1.1.3.cmml">⁡</mo><msub id="S3.E4.m1.9.9.1.1.3.2" xref="S3.E4.m1.9.9.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.9.9.1.1.3.2.2" xref="S3.E4.m1.9.9.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E4.m1.9.9.1.1.3.2.3" xref="S3.E4.m1.9.9.1.1.3.2.3.cmml">t</mi></msub></mrow><mo id="S3.E4.m1.9.9.1.1.2" xref="S3.E4.m1.9.9.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.9.9.1.1.1" xref="S3.E4.m1.9.9.1.1.1.cmml"><munder id="S3.E4.m1.9.9.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.3.cmml"><mi id="S3.E4.m1.9.9.1.1.1.3.2" xref="S3.E4.m1.9.9.1.1.1.3.2.cmml">min</mi><mrow id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml"><msubsup id="S3.E4.m1.4.4.4.6" xref="S3.E4.m1.4.4.4.6.cmml"><mi id="S3.E4.m1.4.4.4.6.2.2" xref="S3.E4.m1.4.4.4.6.2.2.cmml">δ</mi><mrow id="S3.E4.m1.2.2.2.2.2.4" xref="S3.E4.m1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">b</mi><mo id="S3.E4.m1.2.2.2.2.2.4.1" xref="S3.E4.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml">h</mi></mrow><mi id="S3.E4.m1.4.4.4.6.3" xref="S3.E4.m1.4.4.4.6.3.cmml">a</mi></msubsup><mo id="S3.E4.m1.4.4.4.5" xref="S3.E4.m1.4.4.4.5.cmml">∈</mo><mrow id="S3.E4.m1.4.4.4.7.2" xref="S3.E4.m1.4.4.4.7.1.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.4.7.2.1" xref="S3.E4.m1.4.4.4.7.1.cmml">{</mo><mn id="S3.E4.m1.3.3.3.3" xref="S3.E4.m1.3.3.3.3.cmml">0</mn><mo id="S3.E4.m1.4.4.4.7.2.2" xref="S3.E4.m1.4.4.4.7.1.cmml">,</mo><mn id="S3.E4.m1.4.4.4.4" xref="S3.E4.m1.4.4.4.4.cmml">1</mn><mo stretchy="false" id="S3.E4.m1.4.4.4.7.2.3" xref="S3.E4.m1.4.4.4.7.1.cmml">}</mo></mrow></mrow></munder><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.9.9.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.cmml"><munderover id="S3.E4.m1.9.9.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E4.m1.9.9.1.1.1.1.2.2.2" xref="S3.E4.m1.9.9.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.2.2.3" xref="S3.E4.m1.9.9.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.2.2.3.2" xref="S3.E4.m1.9.9.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E4.m1.9.9.1.1.1.1.2.2.3.1" xref="S3.E4.m1.9.9.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.9.9.1.1.1.1.2.2.3.3" xref="S3.E4.m1.9.9.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.9.9.1.1.1.1.2.3" xref="S3.E4.m1.9.9.1.1.1.1.2.3.cmml">K</mi></munderover><mrow id="S3.E4.m1.9.9.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.cmml"><munderover id="S3.E4.m1.9.9.1.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E4.m1.9.9.1.1.1.1.1.2.2.2" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.1.2.2.3" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.2" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.2.cmml">b</mi><mo id="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.1" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.3" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.9.9.1.1.1.1.1.2.3" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.cmml">B</mi></munderover><mrow id="S3.E4.m1.9.9.1.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.1.cmml"><munderover id="S3.E4.m1.9.9.1.1.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.2.cmml">h</mi><mo id="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.1" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.2.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.3.cmml">H</mi></munderover><mrow id="S3.E4.m1.9.9.1.1.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E4.m1.9.9.1.1.1.1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.2.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.2.2.cmml">δ</mi><mrow id="S3.E4.m1.6.6.2.4" xref="S3.E4.m1.6.6.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml">b</mi><mo id="S3.E4.m1.6.6.2.4.1" xref="S3.E4.m1.6.6.2.3.cmml">,</mo><mi id="S3.E4.m1.6.6.2.2" xref="S3.E4.m1.6.6.2.2.cmml">h</mi></mrow><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.4a.cmml">dis</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐋</mi><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐋</mi><mrow id="S3.E4.m1.8.8.2.4" xref="S3.E4.m1.8.8.2.3.cmml"><mi id="S3.E4.m1.7.7.1.1" xref="S3.E4.m1.7.7.1.1.cmml">t</mi><mo id="S3.E4.m1.8.8.2.4.1" xref="S3.E4.m1.8.8.2.3.cmml">,</mo><mi id="S3.E4.m1.8.8.2.2" xref="S3.E4.m1.8.8.2.2.cmml">h</mi></mrow><mi id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">b</mi></msubsup><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.5" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.9.9.1.2" xref="S3.E4.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.9b"><apply id="S3.E4.m1.9.9.1.1.cmml" xref="S3.E4.m1.9.9.1"><eq id="S3.E4.m1.9.9.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.2"></eq><apply id="S3.E4.m1.9.9.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.3"><min id="S3.E4.m1.9.9.1.1.3.1.cmml" xref="S3.E4.m1.9.9.1.1.3.1"></min><apply id="S3.E4.m1.9.9.1.1.3.2.cmml" xref="S3.E4.m1.9.9.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.3.2.1.cmml" xref="S3.E4.m1.9.9.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.3.2.2.cmml" xref="S3.E4.m1.9.9.1.1.3.2.2">ℒ</ci><ci id="S3.E4.m1.9.9.1.1.3.2.3.cmml" xref="S3.E4.m1.9.9.1.1.3.2.3">𝑡</ci></apply></apply><apply id="S3.E4.m1.9.9.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1"><times id="S3.E4.m1.9.9.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.2"></times><apply id="S3.E4.m1.9.9.1.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.3.1.cmml" xref="S3.E4.m1.9.9.1.1.1.3">subscript</csymbol><min id="S3.E4.m1.9.9.1.1.1.3.2.cmml" xref="S3.E4.m1.9.9.1.1.1.3.2"></min><apply id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"><in id="S3.E4.m1.4.4.4.5.cmml" xref="S3.E4.m1.4.4.4.5"></in><apply id="S3.E4.m1.4.4.4.6.cmml" xref="S3.E4.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.6.1.cmml" xref="S3.E4.m1.4.4.4.6">superscript</csymbol><apply id="S3.E4.m1.4.4.4.6.2.cmml" xref="S3.E4.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.6.2.1.cmml" xref="S3.E4.m1.4.4.4.6">subscript</csymbol><ci id="S3.E4.m1.4.4.4.6.2.2.cmml" xref="S3.E4.m1.4.4.4.6.2.2">𝛿</ci><list id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝑏</ci><ci id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2">ℎ</ci></list></apply><ci id="S3.E4.m1.4.4.4.6.3.cmml" xref="S3.E4.m1.4.4.4.6.3">𝑎</ci></apply><set id="S3.E4.m1.4.4.4.7.1.cmml" xref="S3.E4.m1.4.4.4.7.2"><cn type="integer" id="S3.E4.m1.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3">0</cn><cn type="integer" id="S3.E4.m1.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4">1</cn></set></apply></apply><apply id="S3.E4.m1.9.9.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1"><apply id="S3.E4.m1.9.9.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.9.9.1.1.1.1.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.9.9.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2.2.2"></sum><apply id="S3.E4.m1.9.9.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2.2.3"><eq id="S3.E4.m1.9.9.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.9.9.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E4.m1.9.9.1.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.9.9.1.1.1.1.2.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.2.3">𝐾</ci></apply><apply id="S3.E4.m1.9.9.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1"><apply id="S3.E4.m1.9.9.1.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.9.9.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.9.9.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2.2"></sum><apply id="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2.3"><eq id="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.2">𝑏</ci><cn type="integer" id="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.9.9.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3">𝐵</ci></apply><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1"><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3"><eq id="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.2">ℎ</ci><cn type="integer" id="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.2.3">𝐻</ci></apply><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1"><times id="S3.E4.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.2.2">𝛿</ci><list id="S3.E4.m1.6.6.2.3.cmml" xref="S3.E4.m1.6.6.2.4"><ci id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1.1">𝑏</ci><ci id="S3.E4.m1.6.6.2.2.cmml" xref="S3.E4.m1.6.6.2.2">ℎ</ci></list></apply><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1"><times id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.3"></times><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.4a.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.4"><mtext id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.4">dis</mtext></ci><interval closure="open" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐋</ci><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝐋</ci><list id="S3.E4.m1.8.8.2.3.cmml" xref="S3.E4.m1.8.8.2.4"><ci id="S3.E4.m1.7.7.1.1.cmml" xref="S3.E4.m1.7.7.1.1">𝑡</ci><ci id="S3.E4.m1.8.8.2.2.cmml" xref="S3.E4.m1.8.8.2.2">ℎ</ci></list></apply><ci id="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑏</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.9c">\min\mathcal{L}_{t}=\min_{\delta_{b,h}^{a}\in\{0,1\}}\sum_{k=1}^{K}\sum_{b=1}^{B}\sum_{h=1}^{H}\delta_{b,h}^{k}(\text{dis}(\mathbf{L}_{t}^{k},\mathbf{L}_{t,h}^{b})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS2.p4.13" class="ltx_p">where <math id="S3.SS1.SSS2.p4.4.m1.1" class="ltx_Math" alttext="\mathbf{L}_{t}^{k}" display="inline"><semantics id="S3.SS1.SSS2.p4.4.m1.1a"><msubsup id="S3.SS1.SSS2.p4.4.m1.1.1" xref="S3.SS1.SSS2.p4.4.m1.1.1.cmml"><mi id="S3.SS1.SSS2.p4.4.m1.1.1.2.2" xref="S3.SS1.SSS2.p4.4.m1.1.1.2.2.cmml">𝐋</mi><mi id="S3.SS1.SSS2.p4.4.m1.1.1.2.3" xref="S3.SS1.SSS2.p4.4.m1.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS2.p4.4.m1.1.1.3" xref="S3.SS1.SSS2.p4.4.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.4.m1.1b"><apply id="S3.SS1.SSS2.p4.4.m1.1.1.cmml" xref="S3.SS1.SSS2.p4.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.4.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p4.4.m1.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p4.4.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p4.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.4.m1.1.1.2.1.cmml" xref="S3.SS1.SSS2.p4.4.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p4.4.m1.1.1.2.2.cmml" xref="S3.SS1.SSS2.p4.4.m1.1.1.2.2">𝐋</ci><ci id="S3.SS1.SSS2.p4.4.m1.1.1.2.3.cmml" xref="S3.SS1.SSS2.p4.4.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS2.p4.4.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p4.4.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.4.m1.1c">\mathbf{L}_{t}^{k}</annotation></semantics></math> is the center of the <math id="S3.SS1.SSS2.p4.5.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.SSS2.p4.5.m2.1a"><mi id="S3.SS1.SSS2.p4.5.m2.1.1" xref="S3.SS1.SSS2.p4.5.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.5.m2.1b"><ci id="S3.SS1.SSS2.p4.5.m2.1.1.cmml" xref="S3.SS1.SSS2.p4.5.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.5.m2.1c">k</annotation></semantics></math>-th cluster. <math id="S3.SS1.SSS2.p4.6.m3.2" class="ltx_Math" alttext="\delta_{b,h}^{k}" display="inline"><semantics id="S3.SS1.SSS2.p4.6.m3.2a"><msubsup id="S3.SS1.SSS2.p4.6.m3.2.3" xref="S3.SS1.SSS2.p4.6.m3.2.3.cmml"><mi id="S3.SS1.SSS2.p4.6.m3.2.3.2.2" xref="S3.SS1.SSS2.p4.6.m3.2.3.2.2.cmml">δ</mi><mrow id="S3.SS1.SSS2.p4.6.m3.2.2.2.4" xref="S3.SS1.SSS2.p4.6.m3.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.p4.6.m3.1.1.1.1" xref="S3.SS1.SSS2.p4.6.m3.1.1.1.1.cmml">b</mi><mo id="S3.SS1.SSS2.p4.6.m3.2.2.2.4.1" xref="S3.SS1.SSS2.p4.6.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.p4.6.m3.2.2.2.2" xref="S3.SS1.SSS2.p4.6.m3.2.2.2.2.cmml">h</mi></mrow><mi id="S3.SS1.SSS2.p4.6.m3.2.3.3" xref="S3.SS1.SSS2.p4.6.m3.2.3.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.6.m3.2b"><apply id="S3.SS1.SSS2.p4.6.m3.2.3.cmml" xref="S3.SS1.SSS2.p4.6.m3.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.6.m3.2.3.1.cmml" xref="S3.SS1.SSS2.p4.6.m3.2.3">superscript</csymbol><apply id="S3.SS1.SSS2.p4.6.m3.2.3.2.cmml" xref="S3.SS1.SSS2.p4.6.m3.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.6.m3.2.3.2.1.cmml" xref="S3.SS1.SSS2.p4.6.m3.2.3">subscript</csymbol><ci id="S3.SS1.SSS2.p4.6.m3.2.3.2.2.cmml" xref="S3.SS1.SSS2.p4.6.m3.2.3.2.2">𝛿</ci><list id="S3.SS1.SSS2.p4.6.m3.2.2.2.3.cmml" xref="S3.SS1.SSS2.p4.6.m3.2.2.2.4"><ci id="S3.SS1.SSS2.p4.6.m3.1.1.1.1.cmml" xref="S3.SS1.SSS2.p4.6.m3.1.1.1.1">𝑏</ci><ci id="S3.SS1.SSS2.p4.6.m3.2.2.2.2.cmml" xref="S3.SS1.SSS2.p4.6.m3.2.2.2.2">ℎ</ci></list></apply><ci id="S3.SS1.SSS2.p4.6.m3.2.3.3.cmml" xref="S3.SS1.SSS2.p4.6.m3.2.3.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.6.m3.2c">\delta_{b,h}^{k}</annotation></semantics></math> is the indicator. If the <math id="S3.SS1.SSS2.p4.7.m4.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS1.SSS2.p4.7.m4.1a"><mi id="S3.SS1.SSS2.p4.7.m4.1.1" xref="S3.SS1.SSS2.p4.7.m4.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.7.m4.1b"><ci id="S3.SS1.SSS2.p4.7.m4.1.1.cmml" xref="S3.SS1.SSS2.p4.7.m4.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.7.m4.1c">h</annotation></semantics></math>-th layer of <math id="S3.SS1.SSS2.p4.8.m5.1" class="ltx_Math" alttext="\mathbf{w}_{t}^{b}" display="inline"><semantics id="S3.SS1.SSS2.p4.8.m5.1a"><msubsup id="S3.SS1.SSS2.p4.8.m5.1.1" xref="S3.SS1.SSS2.p4.8.m5.1.1.cmml"><mi id="S3.SS1.SSS2.p4.8.m5.1.1.2.2" xref="S3.SS1.SSS2.p4.8.m5.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.SSS2.p4.8.m5.1.1.2.3" xref="S3.SS1.SSS2.p4.8.m5.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS2.p4.8.m5.1.1.3" xref="S3.SS1.SSS2.p4.8.m5.1.1.3.cmml">b</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.8.m5.1b"><apply id="S3.SS1.SSS2.p4.8.m5.1.1.cmml" xref="S3.SS1.SSS2.p4.8.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.8.m5.1.1.1.cmml" xref="S3.SS1.SSS2.p4.8.m5.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p4.8.m5.1.1.2.cmml" xref="S3.SS1.SSS2.p4.8.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.8.m5.1.1.2.1.cmml" xref="S3.SS1.SSS2.p4.8.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p4.8.m5.1.1.2.2.cmml" xref="S3.SS1.SSS2.p4.8.m5.1.1.2.2">𝐰</ci><ci id="S3.SS1.SSS2.p4.8.m5.1.1.2.3.cmml" xref="S3.SS1.SSS2.p4.8.m5.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS2.p4.8.m5.1.1.3.cmml" xref="S3.SS1.SSS2.p4.8.m5.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.8.m5.1c">\mathbf{w}_{t}^{b}</annotation></semantics></math> belongs to the <math id="S3.SS1.SSS2.p4.9.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.SSS2.p4.9.m6.1a"><mi id="S3.SS1.SSS2.p4.9.m6.1.1" xref="S3.SS1.SSS2.p4.9.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.9.m6.1b"><ci id="S3.SS1.SSS2.p4.9.m6.1.1.cmml" xref="S3.SS1.SSS2.p4.9.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.9.m6.1c">k</annotation></semantics></math>-th cluster, then <math id="S3.SS1.SSS2.p4.10.m7.2" class="ltx_Math" alttext="\delta_{b,h}^{k}=1" display="inline"><semantics id="S3.SS1.SSS2.p4.10.m7.2a"><mrow id="S3.SS1.SSS2.p4.10.m7.2.3" xref="S3.SS1.SSS2.p4.10.m7.2.3.cmml"><msubsup id="S3.SS1.SSS2.p4.10.m7.2.3.2" xref="S3.SS1.SSS2.p4.10.m7.2.3.2.cmml"><mi id="S3.SS1.SSS2.p4.10.m7.2.3.2.2.2" xref="S3.SS1.SSS2.p4.10.m7.2.3.2.2.2.cmml">δ</mi><mrow id="S3.SS1.SSS2.p4.10.m7.2.2.2.4" xref="S3.SS1.SSS2.p4.10.m7.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.p4.10.m7.1.1.1.1" xref="S3.SS1.SSS2.p4.10.m7.1.1.1.1.cmml">b</mi><mo id="S3.SS1.SSS2.p4.10.m7.2.2.2.4.1" xref="S3.SS1.SSS2.p4.10.m7.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.p4.10.m7.2.2.2.2" xref="S3.SS1.SSS2.p4.10.m7.2.2.2.2.cmml">h</mi></mrow><mi id="S3.SS1.SSS2.p4.10.m7.2.3.2.3" xref="S3.SS1.SSS2.p4.10.m7.2.3.2.3.cmml">k</mi></msubsup><mo id="S3.SS1.SSS2.p4.10.m7.2.3.1" xref="S3.SS1.SSS2.p4.10.m7.2.3.1.cmml">=</mo><mn id="S3.SS1.SSS2.p4.10.m7.2.3.3" xref="S3.SS1.SSS2.p4.10.m7.2.3.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.10.m7.2b"><apply id="S3.SS1.SSS2.p4.10.m7.2.3.cmml" xref="S3.SS1.SSS2.p4.10.m7.2.3"><eq id="S3.SS1.SSS2.p4.10.m7.2.3.1.cmml" xref="S3.SS1.SSS2.p4.10.m7.2.3.1"></eq><apply id="S3.SS1.SSS2.p4.10.m7.2.3.2.cmml" xref="S3.SS1.SSS2.p4.10.m7.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.10.m7.2.3.2.1.cmml" xref="S3.SS1.SSS2.p4.10.m7.2.3.2">superscript</csymbol><apply id="S3.SS1.SSS2.p4.10.m7.2.3.2.2.cmml" xref="S3.SS1.SSS2.p4.10.m7.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.10.m7.2.3.2.2.1.cmml" xref="S3.SS1.SSS2.p4.10.m7.2.3.2">subscript</csymbol><ci id="S3.SS1.SSS2.p4.10.m7.2.3.2.2.2.cmml" xref="S3.SS1.SSS2.p4.10.m7.2.3.2.2.2">𝛿</ci><list id="S3.SS1.SSS2.p4.10.m7.2.2.2.3.cmml" xref="S3.SS1.SSS2.p4.10.m7.2.2.2.4"><ci id="S3.SS1.SSS2.p4.10.m7.1.1.1.1.cmml" xref="S3.SS1.SSS2.p4.10.m7.1.1.1.1">𝑏</ci><ci id="S3.SS1.SSS2.p4.10.m7.2.2.2.2.cmml" xref="S3.SS1.SSS2.p4.10.m7.2.2.2.2">ℎ</ci></list></apply><ci id="S3.SS1.SSS2.p4.10.m7.2.3.2.3.cmml" xref="S3.SS1.SSS2.p4.10.m7.2.3.2.3">𝑘</ci></apply><cn type="integer" id="S3.SS1.SSS2.p4.10.m7.2.3.3.cmml" xref="S3.SS1.SSS2.p4.10.m7.2.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.10.m7.2c">\delta_{b,h}^{k}=1</annotation></semantics></math>. Otherwise, <math id="S3.SS1.SSS2.p4.11.m8.2" class="ltx_Math" alttext="\delta_{b,h}^{k}=0" display="inline"><semantics id="S3.SS1.SSS2.p4.11.m8.2a"><mrow id="S3.SS1.SSS2.p4.11.m8.2.3" xref="S3.SS1.SSS2.p4.11.m8.2.3.cmml"><msubsup id="S3.SS1.SSS2.p4.11.m8.2.3.2" xref="S3.SS1.SSS2.p4.11.m8.2.3.2.cmml"><mi id="S3.SS1.SSS2.p4.11.m8.2.3.2.2.2" xref="S3.SS1.SSS2.p4.11.m8.2.3.2.2.2.cmml">δ</mi><mrow id="S3.SS1.SSS2.p4.11.m8.2.2.2.4" xref="S3.SS1.SSS2.p4.11.m8.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.p4.11.m8.1.1.1.1" xref="S3.SS1.SSS2.p4.11.m8.1.1.1.1.cmml">b</mi><mo id="S3.SS1.SSS2.p4.11.m8.2.2.2.4.1" xref="S3.SS1.SSS2.p4.11.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.p4.11.m8.2.2.2.2" xref="S3.SS1.SSS2.p4.11.m8.2.2.2.2.cmml">h</mi></mrow><mi id="S3.SS1.SSS2.p4.11.m8.2.3.2.3" xref="S3.SS1.SSS2.p4.11.m8.2.3.2.3.cmml">k</mi></msubsup><mo id="S3.SS1.SSS2.p4.11.m8.2.3.1" xref="S3.SS1.SSS2.p4.11.m8.2.3.1.cmml">=</mo><mn id="S3.SS1.SSS2.p4.11.m8.2.3.3" xref="S3.SS1.SSS2.p4.11.m8.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.11.m8.2b"><apply id="S3.SS1.SSS2.p4.11.m8.2.3.cmml" xref="S3.SS1.SSS2.p4.11.m8.2.3"><eq id="S3.SS1.SSS2.p4.11.m8.2.3.1.cmml" xref="S3.SS1.SSS2.p4.11.m8.2.3.1"></eq><apply id="S3.SS1.SSS2.p4.11.m8.2.3.2.cmml" xref="S3.SS1.SSS2.p4.11.m8.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.11.m8.2.3.2.1.cmml" xref="S3.SS1.SSS2.p4.11.m8.2.3.2">superscript</csymbol><apply id="S3.SS1.SSS2.p4.11.m8.2.3.2.2.cmml" xref="S3.SS1.SSS2.p4.11.m8.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.11.m8.2.3.2.2.1.cmml" xref="S3.SS1.SSS2.p4.11.m8.2.3.2">subscript</csymbol><ci id="S3.SS1.SSS2.p4.11.m8.2.3.2.2.2.cmml" xref="S3.SS1.SSS2.p4.11.m8.2.3.2.2.2">𝛿</ci><list id="S3.SS1.SSS2.p4.11.m8.2.2.2.3.cmml" xref="S3.SS1.SSS2.p4.11.m8.2.2.2.4"><ci id="S3.SS1.SSS2.p4.11.m8.1.1.1.1.cmml" xref="S3.SS1.SSS2.p4.11.m8.1.1.1.1">𝑏</ci><ci id="S3.SS1.SSS2.p4.11.m8.2.2.2.2.cmml" xref="S3.SS1.SSS2.p4.11.m8.2.2.2.2">ℎ</ci></list></apply><ci id="S3.SS1.SSS2.p4.11.m8.2.3.2.3.cmml" xref="S3.SS1.SSS2.p4.11.m8.2.3.2.3">𝑘</ci></apply><cn type="integer" id="S3.SS1.SSS2.p4.11.m8.2.3.3.cmml" xref="S3.SS1.SSS2.p4.11.m8.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.11.m8.2c">\delta_{b,h}^{k}=0</annotation></semantics></math>. After the grouping process, we obtain <math id="S3.SS1.SSS2.p4.12.m9.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.SSS2.p4.12.m9.1a"><mi id="S3.SS1.SSS2.p4.12.m9.1.1" xref="S3.SS1.SSS2.p4.12.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.12.m9.1b"><ci id="S3.SS1.SSS2.p4.12.m9.1.1.cmml" xref="S3.SS1.SSS2.p4.12.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.12.m9.1c">K</annotation></semantics></math> layer clusters denoted as <math id="S3.SS1.SSS2.p4.13.m10.4" class="ltx_Math" alttext="\{\mathcal{G}_{t}^{1},\mathcal{G}_{t}^{2},\cdots,\mathcal{G}_{t}^{K}\}" display="inline"><semantics id="S3.SS1.SSS2.p4.13.m10.4a"><mrow id="S3.SS1.SSS2.p4.13.m10.4.4.3" xref="S3.SS1.SSS2.p4.13.m10.4.4.4.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p4.13.m10.4.4.3.4" xref="S3.SS1.SSS2.p4.13.m10.4.4.4.cmml">{</mo><msubsup id="S3.SS1.SSS2.p4.13.m10.2.2.1.1" xref="S3.SS1.SSS2.p4.13.m10.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p4.13.m10.2.2.1.1.2.2" xref="S3.SS1.SSS2.p4.13.m10.2.2.1.1.2.2.cmml">𝒢</mi><mi id="S3.SS1.SSS2.p4.13.m10.2.2.1.1.2.3" xref="S3.SS1.SSS2.p4.13.m10.2.2.1.1.2.3.cmml">t</mi><mn id="S3.SS1.SSS2.p4.13.m10.2.2.1.1.3" xref="S3.SS1.SSS2.p4.13.m10.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.SSS2.p4.13.m10.4.4.3.5" xref="S3.SS1.SSS2.p4.13.m10.4.4.4.cmml">,</mo><msubsup id="S3.SS1.SSS2.p4.13.m10.3.3.2.2" xref="S3.SS1.SSS2.p4.13.m10.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p4.13.m10.3.3.2.2.2.2" xref="S3.SS1.SSS2.p4.13.m10.3.3.2.2.2.2.cmml">𝒢</mi><mi id="S3.SS1.SSS2.p4.13.m10.3.3.2.2.2.3" xref="S3.SS1.SSS2.p4.13.m10.3.3.2.2.2.3.cmml">t</mi><mn id="S3.SS1.SSS2.p4.13.m10.3.3.2.2.3" xref="S3.SS1.SSS2.p4.13.m10.3.3.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.SSS2.p4.13.m10.4.4.3.6" xref="S3.SS1.SSS2.p4.13.m10.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p4.13.m10.1.1" xref="S3.SS1.SSS2.p4.13.m10.1.1.cmml">⋯</mi><mo id="S3.SS1.SSS2.p4.13.m10.4.4.3.7" xref="S3.SS1.SSS2.p4.13.m10.4.4.4.cmml">,</mo><msubsup id="S3.SS1.SSS2.p4.13.m10.4.4.3.3" xref="S3.SS1.SSS2.p4.13.m10.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p4.13.m10.4.4.3.3.2.2" xref="S3.SS1.SSS2.p4.13.m10.4.4.3.3.2.2.cmml">𝒢</mi><mi id="S3.SS1.SSS2.p4.13.m10.4.4.3.3.2.3" xref="S3.SS1.SSS2.p4.13.m10.4.4.3.3.2.3.cmml">t</mi><mi id="S3.SS1.SSS2.p4.13.m10.4.4.3.3.3" xref="S3.SS1.SSS2.p4.13.m10.4.4.3.3.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS2.p4.13.m10.4.4.3.8" xref="S3.SS1.SSS2.p4.13.m10.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p4.13.m10.4b"><set id="S3.SS1.SSS2.p4.13.m10.4.4.4.cmml" xref="S3.SS1.SSS2.p4.13.m10.4.4.3"><apply id="S3.SS1.SSS2.p4.13.m10.2.2.1.1.cmml" xref="S3.SS1.SSS2.p4.13.m10.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.13.m10.2.2.1.1.1.cmml" xref="S3.SS1.SSS2.p4.13.m10.2.2.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p4.13.m10.2.2.1.1.2.cmml" xref="S3.SS1.SSS2.p4.13.m10.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.13.m10.2.2.1.1.2.1.cmml" xref="S3.SS1.SSS2.p4.13.m10.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p4.13.m10.2.2.1.1.2.2.cmml" xref="S3.SS1.SSS2.p4.13.m10.2.2.1.1.2.2">𝒢</ci><ci id="S3.SS1.SSS2.p4.13.m10.2.2.1.1.2.3.cmml" xref="S3.SS1.SSS2.p4.13.m10.2.2.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.SSS2.p4.13.m10.2.2.1.1.3.cmml" xref="S3.SS1.SSS2.p4.13.m10.2.2.1.1.3">1</cn></apply><apply id="S3.SS1.SSS2.p4.13.m10.3.3.2.2.cmml" xref="S3.SS1.SSS2.p4.13.m10.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.13.m10.3.3.2.2.1.cmml" xref="S3.SS1.SSS2.p4.13.m10.3.3.2.2">superscript</csymbol><apply id="S3.SS1.SSS2.p4.13.m10.3.3.2.2.2.cmml" xref="S3.SS1.SSS2.p4.13.m10.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.13.m10.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS2.p4.13.m10.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p4.13.m10.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS2.p4.13.m10.3.3.2.2.2.2">𝒢</ci><ci id="S3.SS1.SSS2.p4.13.m10.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS2.p4.13.m10.3.3.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.SSS2.p4.13.m10.3.3.2.2.3.cmml" xref="S3.SS1.SSS2.p4.13.m10.3.3.2.2.3">2</cn></apply><ci id="S3.SS1.SSS2.p4.13.m10.1.1.cmml" xref="S3.SS1.SSS2.p4.13.m10.1.1">⋯</ci><apply id="S3.SS1.SSS2.p4.13.m10.4.4.3.3.cmml" xref="S3.SS1.SSS2.p4.13.m10.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.13.m10.4.4.3.3.1.cmml" xref="S3.SS1.SSS2.p4.13.m10.4.4.3.3">superscript</csymbol><apply id="S3.SS1.SSS2.p4.13.m10.4.4.3.3.2.cmml" xref="S3.SS1.SSS2.p4.13.m10.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p4.13.m10.4.4.3.3.2.1.cmml" xref="S3.SS1.SSS2.p4.13.m10.4.4.3.3">subscript</csymbol><ci id="S3.SS1.SSS2.p4.13.m10.4.4.3.3.2.2.cmml" xref="S3.SS1.SSS2.p4.13.m10.4.4.3.3.2.2">𝒢</ci><ci id="S3.SS1.SSS2.p4.13.m10.4.4.3.3.2.3.cmml" xref="S3.SS1.SSS2.p4.13.m10.4.4.3.3.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS2.p4.13.m10.4.4.3.3.3.cmml" xref="S3.SS1.SSS2.p4.13.m10.4.4.3.3.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p4.13.m10.4c">\{\mathcal{G}_{t}^{1},\mathcal{G}_{t}^{2},\cdots,\mathcal{G}_{t}^{K}\}</annotation></semantics></math>. There are multiple layers in each group, which have similar functions. Besides, each layer is associated with an operation type.</p>
</div>
<div id="S3.SS1.SSS2.p5" class="ltx_para">
<p id="S3.SS1.SSS2.p5.2" class="ltx_p"><span id="S3.SS1.SSS2.p5.2.1" class="ltx_text ltx_font_bold">Reassembly Candidate Generation</span>.
The last step for obtaining personalized candidates <math id="S3.SS1.SSS2.p5.1.m1.3" class="ltx_Math" alttext="\{\mathbf{c}_{t}^{1},\cdots,\mathbf{c}_{t}^{M}\}" display="inline"><semantics id="S3.SS1.SSS2.p5.1.m1.3a"><mrow id="S3.SS1.SSS2.p5.1.m1.3.3.2" xref="S3.SS1.SSS2.p5.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p5.1.m1.3.3.2.3" xref="S3.SS1.SSS2.p5.1.m1.3.3.3.cmml">{</mo><msubsup id="S3.SS1.SSS2.p5.1.m1.2.2.1.1" xref="S3.SS1.SSS2.p5.1.m1.2.2.1.1.cmml"><mi id="S3.SS1.SSS2.p5.1.m1.2.2.1.1.2.2" xref="S3.SS1.SSS2.p5.1.m1.2.2.1.1.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS2.p5.1.m1.2.2.1.1.2.3" xref="S3.SS1.SSS2.p5.1.m1.2.2.1.1.2.3.cmml">t</mi><mn id="S3.SS1.SSS2.p5.1.m1.2.2.1.1.3" xref="S3.SS1.SSS2.p5.1.m1.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.SSS2.p5.1.m1.3.3.2.4" xref="S3.SS1.SSS2.p5.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p5.1.m1.1.1" xref="S3.SS1.SSS2.p5.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS1.SSS2.p5.1.m1.3.3.2.5" xref="S3.SS1.SSS2.p5.1.m1.3.3.3.cmml">,</mo><msubsup id="S3.SS1.SSS2.p5.1.m1.3.3.2.2" xref="S3.SS1.SSS2.p5.1.m1.3.3.2.2.cmml"><mi id="S3.SS1.SSS2.p5.1.m1.3.3.2.2.2.2" xref="S3.SS1.SSS2.p5.1.m1.3.3.2.2.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS2.p5.1.m1.3.3.2.2.2.3" xref="S3.SS1.SSS2.p5.1.m1.3.3.2.2.2.3.cmml">t</mi><mi id="S3.SS1.SSS2.p5.1.m1.3.3.2.2.3" xref="S3.SS1.SSS2.p5.1.m1.3.3.2.2.3.cmml">M</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS2.p5.1.m1.3.3.2.6" xref="S3.SS1.SSS2.p5.1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p5.1.m1.3b"><set id="S3.SS1.SSS2.p5.1.m1.3.3.3.cmml" xref="S3.SS1.SSS2.p5.1.m1.3.3.2"><apply id="S3.SS1.SSS2.p5.1.m1.2.2.1.1.cmml" xref="S3.SS1.SSS2.p5.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.SSS2.p5.1.m1.2.2.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p5.1.m1.2.2.1.1.2.cmml" xref="S3.SS1.SSS2.p5.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.1.m1.2.2.1.1.2.1.cmml" xref="S3.SS1.SSS2.p5.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p5.1.m1.2.2.1.1.2.2.cmml" xref="S3.SS1.SSS2.p5.1.m1.2.2.1.1.2.2">𝐜</ci><ci id="S3.SS1.SSS2.p5.1.m1.2.2.1.1.2.3.cmml" xref="S3.SS1.SSS2.p5.1.m1.2.2.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.SSS2.p5.1.m1.2.2.1.1.3.cmml" xref="S3.SS1.SSS2.p5.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.SSS2.p5.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p5.1.m1.1.1">⋯</ci><apply id="S3.SS1.SSS2.p5.1.m1.3.3.2.2.cmml" xref="S3.SS1.SSS2.p5.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.1.m1.3.3.2.2.1.cmml" xref="S3.SS1.SSS2.p5.1.m1.3.3.2.2">superscript</csymbol><apply id="S3.SS1.SSS2.p5.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.SSS2.p5.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS2.p5.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p5.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS2.p5.1.m1.3.3.2.2.2.2">𝐜</ci><ci id="S3.SS1.SSS2.p5.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS2.p5.1.m1.3.3.2.2.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS2.p5.1.m1.3.3.2.2.3.cmml" xref="S3.SS1.SSS2.p5.1.m1.3.3.2.2.3">𝑀</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p5.1.m1.3c">\{\mathbf{c}_{t}^{1},\cdots,\mathbf{c}_{t}^{M}\}</annotation></semantics></math> is to assemble the learned layer-wise groups <math id="S3.SS1.SSS2.p5.2.m2.4" class="ltx_Math" alttext="\{\mathcal{G}_{t}^{1},\mathcal{G}_{t}^{2},\cdots,\mathcal{G}_{t}^{K}\}" display="inline"><semantics id="S3.SS1.SSS2.p5.2.m2.4a"><mrow id="S3.SS1.SSS2.p5.2.m2.4.4.3" xref="S3.SS1.SSS2.p5.2.m2.4.4.4.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p5.2.m2.4.4.3.4" xref="S3.SS1.SSS2.p5.2.m2.4.4.4.cmml">{</mo><msubsup id="S3.SS1.SSS2.p5.2.m2.2.2.1.1" xref="S3.SS1.SSS2.p5.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p5.2.m2.2.2.1.1.2.2" xref="S3.SS1.SSS2.p5.2.m2.2.2.1.1.2.2.cmml">𝒢</mi><mi id="S3.SS1.SSS2.p5.2.m2.2.2.1.1.2.3" xref="S3.SS1.SSS2.p5.2.m2.2.2.1.1.2.3.cmml">t</mi><mn id="S3.SS1.SSS2.p5.2.m2.2.2.1.1.3" xref="S3.SS1.SSS2.p5.2.m2.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.SSS2.p5.2.m2.4.4.3.5" xref="S3.SS1.SSS2.p5.2.m2.4.4.4.cmml">,</mo><msubsup id="S3.SS1.SSS2.p5.2.m2.3.3.2.2" xref="S3.SS1.SSS2.p5.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p5.2.m2.3.3.2.2.2.2" xref="S3.SS1.SSS2.p5.2.m2.3.3.2.2.2.2.cmml">𝒢</mi><mi id="S3.SS1.SSS2.p5.2.m2.3.3.2.2.2.3" xref="S3.SS1.SSS2.p5.2.m2.3.3.2.2.2.3.cmml">t</mi><mn id="S3.SS1.SSS2.p5.2.m2.3.3.2.2.3" xref="S3.SS1.SSS2.p5.2.m2.3.3.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.SSS2.p5.2.m2.4.4.3.6" xref="S3.SS1.SSS2.p5.2.m2.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p5.2.m2.1.1" xref="S3.SS1.SSS2.p5.2.m2.1.1.cmml">⋯</mi><mo id="S3.SS1.SSS2.p5.2.m2.4.4.3.7" xref="S3.SS1.SSS2.p5.2.m2.4.4.4.cmml">,</mo><msubsup id="S3.SS1.SSS2.p5.2.m2.4.4.3.3" xref="S3.SS1.SSS2.p5.2.m2.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p5.2.m2.4.4.3.3.2.2" xref="S3.SS1.SSS2.p5.2.m2.4.4.3.3.2.2.cmml">𝒢</mi><mi id="S3.SS1.SSS2.p5.2.m2.4.4.3.3.2.3" xref="S3.SS1.SSS2.p5.2.m2.4.4.3.3.2.3.cmml">t</mi><mi id="S3.SS1.SSS2.p5.2.m2.4.4.3.3.3" xref="S3.SS1.SSS2.p5.2.m2.4.4.3.3.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS2.p5.2.m2.4.4.3.8" xref="S3.SS1.SSS2.p5.2.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p5.2.m2.4b"><set id="S3.SS1.SSS2.p5.2.m2.4.4.4.cmml" xref="S3.SS1.SSS2.p5.2.m2.4.4.3"><apply id="S3.SS1.SSS2.p5.2.m2.2.2.1.1.cmml" xref="S3.SS1.SSS2.p5.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.SSS2.p5.2.m2.2.2.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p5.2.m2.2.2.1.1.2.cmml" xref="S3.SS1.SSS2.p5.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.2.m2.2.2.1.1.2.1.cmml" xref="S3.SS1.SSS2.p5.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p5.2.m2.2.2.1.1.2.2.cmml" xref="S3.SS1.SSS2.p5.2.m2.2.2.1.1.2.2">𝒢</ci><ci id="S3.SS1.SSS2.p5.2.m2.2.2.1.1.2.3.cmml" xref="S3.SS1.SSS2.p5.2.m2.2.2.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.SSS2.p5.2.m2.2.2.1.1.3.cmml" xref="S3.SS1.SSS2.p5.2.m2.2.2.1.1.3">1</cn></apply><apply id="S3.SS1.SSS2.p5.2.m2.3.3.2.2.cmml" xref="S3.SS1.SSS2.p5.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.2.m2.3.3.2.2.1.cmml" xref="S3.SS1.SSS2.p5.2.m2.3.3.2.2">superscript</csymbol><apply id="S3.SS1.SSS2.p5.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.SSS2.p5.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS2.p5.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p5.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS2.p5.2.m2.3.3.2.2.2.2">𝒢</ci><ci id="S3.SS1.SSS2.p5.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS2.p5.2.m2.3.3.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.SSS2.p5.2.m2.3.3.2.2.3.cmml" xref="S3.SS1.SSS2.p5.2.m2.3.3.2.2.3">2</cn></apply><ci id="S3.SS1.SSS2.p5.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p5.2.m2.1.1">⋯</ci><apply id="S3.SS1.SSS2.p5.2.m2.4.4.3.3.cmml" xref="S3.SS1.SSS2.p5.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.2.m2.4.4.3.3.1.cmml" xref="S3.SS1.SSS2.p5.2.m2.4.4.3.3">superscript</csymbol><apply id="S3.SS1.SSS2.p5.2.m2.4.4.3.3.2.cmml" xref="S3.SS1.SSS2.p5.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p5.2.m2.4.4.3.3.2.1.cmml" xref="S3.SS1.SSS2.p5.2.m2.4.4.3.3">subscript</csymbol><ci id="S3.SS1.SSS2.p5.2.m2.4.4.3.3.2.2.cmml" xref="S3.SS1.SSS2.p5.2.m2.4.4.3.3.2.2">𝒢</ci><ci id="S3.SS1.SSS2.p5.2.m2.4.4.3.3.2.3.cmml" xref="S3.SS1.SSS2.p5.2.m2.4.4.3.3.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS2.p5.2.m2.4.4.3.3.3.cmml" xref="S3.SS1.SSS2.p5.2.m2.4.4.3.3.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p5.2.m2.4c">\{\mathcal{G}_{t}^{1},\mathcal{G}_{t}^{2},\cdots,\mathcal{G}_{t}^{K}\}</annotation></semantics></math> based on their functions. To this end, we design a heuristic rule-based search strategy as shown in Algorithm <a href="#alg1" title="In 3.1.2 Heterogeneous Model Reassembly – 𝑔⁢(⋅,⋅) ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
Our goal is to automatically generate <em id="S3.SS1.SSS2.p5.2.2" class="ltx_emph ltx_font_italic">informative</em> and <em id="S3.SS1.SSS2.p5.2.3" class="ltx_emph ltx_font_italic">diverse</em> candidates.</p>
</div>
<div id="S3.SS1.SSS2.p6" class="ltx_para">
<p id="S3.SS1.SSS2.p6.6" class="ltx_p">Generally, an <span id="S3.SS1.SSS2.p6.6.1" class="ltx_text ltx_font_bold">informative</span> candidate needs to follow the design of handcrafted network structures. This is challenging since the candidates are automatically generated without human interventions and prior knowledge. To satisfy this condition, we require the layer orders to be guaranteed (<math id="S3.SS1.SSS2.p6.1.m1.1" class="ltx_Math" alttext="\mathcal{R}_{1}" display="inline"><semantics id="S3.SS1.SSS2.p6.1.m1.1a"><msub id="S3.SS1.SSS2.p6.1.m1.1.1" xref="S3.SS1.SSS2.p6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p6.1.m1.1.1.2" xref="S3.SS1.SSS2.p6.1.m1.1.1.2.cmml">ℛ</mi><mn id="S3.SS1.SSS2.p6.1.m1.1.1.3" xref="S3.SS1.SSS2.p6.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p6.1.m1.1b"><apply id="S3.SS1.SSS2.p6.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p6.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p6.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p6.1.m1.1.1.2">ℛ</ci><cn type="integer" id="S3.SS1.SSS2.p6.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p6.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p6.1.m1.1c">\mathcal{R}_{1}</annotation></semantics></math> in Line 10). For example, the <math id="S3.SS1.SSS2.p6.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.SSS2.p6.2.m2.1a"><mi id="S3.SS1.SSS2.p6.2.m2.1.1" xref="S3.SS1.SSS2.p6.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p6.2.m2.1b"><ci id="S3.SS1.SSS2.p6.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p6.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p6.2.m2.1c">i</annotation></semantics></math>-th layer from the <math id="S3.SS1.SSS2.p6.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.SSS2.p6.3.m3.1a"><mi id="S3.SS1.SSS2.p6.3.m3.1.1" xref="S3.SS1.SSS2.p6.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p6.3.m3.1b"><ci id="S3.SS1.SSS2.p6.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p6.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p6.3.m3.1c">n</annotation></semantics></math>-th model, i.e., <math id="S3.SS1.SSS2.p6.4.m4.2" class="ltx_Math" alttext="\mathbf{L}_{t,i}^{n}" display="inline"><semantics id="S3.SS1.SSS2.p6.4.m4.2a"><msubsup id="S3.SS1.SSS2.p6.4.m4.2.3" xref="S3.SS1.SSS2.p6.4.m4.2.3.cmml"><mi id="S3.SS1.SSS2.p6.4.m4.2.3.2.2" xref="S3.SS1.SSS2.p6.4.m4.2.3.2.2.cmml">𝐋</mi><mrow id="S3.SS1.SSS2.p6.4.m4.2.2.2.4" xref="S3.SS1.SSS2.p6.4.m4.2.2.2.3.cmml"><mi id="S3.SS1.SSS2.p6.4.m4.1.1.1.1" xref="S3.SS1.SSS2.p6.4.m4.1.1.1.1.cmml">t</mi><mo id="S3.SS1.SSS2.p6.4.m4.2.2.2.4.1" xref="S3.SS1.SSS2.p6.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS2.p6.4.m4.2.2.2.2" xref="S3.SS1.SSS2.p6.4.m4.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS1.SSS2.p6.4.m4.2.3.3" xref="S3.SS1.SSS2.p6.4.m4.2.3.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p6.4.m4.2b"><apply id="S3.SS1.SSS2.p6.4.m4.2.3.cmml" xref="S3.SS1.SSS2.p6.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p6.4.m4.2.3.1.cmml" xref="S3.SS1.SSS2.p6.4.m4.2.3">superscript</csymbol><apply id="S3.SS1.SSS2.p6.4.m4.2.3.2.cmml" xref="S3.SS1.SSS2.p6.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p6.4.m4.2.3.2.1.cmml" xref="S3.SS1.SSS2.p6.4.m4.2.3">subscript</csymbol><ci id="S3.SS1.SSS2.p6.4.m4.2.3.2.2.cmml" xref="S3.SS1.SSS2.p6.4.m4.2.3.2.2">𝐋</ci><list id="S3.SS1.SSS2.p6.4.m4.2.2.2.3.cmml" xref="S3.SS1.SSS2.p6.4.m4.2.2.2.4"><ci id="S3.SS1.SSS2.p6.4.m4.1.1.1.1.cmml" xref="S3.SS1.SSS2.p6.4.m4.1.1.1.1">𝑡</ci><ci id="S3.SS1.SSS2.p6.4.m4.2.2.2.2.cmml" xref="S3.SS1.SSS2.p6.4.m4.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS1.SSS2.p6.4.m4.2.3.3.cmml" xref="S3.SS1.SSS2.p6.4.m4.2.3.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p6.4.m4.2c">\mathbf{L}_{t,i}^{n}</annotation></semantics></math>, in a candidate must be followed by a layer with an index <math id="S3.SS1.SSS2.p6.5.m5.1" class="ltx_Math" alttext="j&gt;i" display="inline"><semantics id="S3.SS1.SSS2.p6.5.m5.1a"><mrow id="S3.SS1.SSS2.p6.5.m5.1.1" xref="S3.SS1.SSS2.p6.5.m5.1.1.cmml"><mi id="S3.SS1.SSS2.p6.5.m5.1.1.2" xref="S3.SS1.SSS2.p6.5.m5.1.1.2.cmml">j</mi><mo id="S3.SS1.SSS2.p6.5.m5.1.1.1" xref="S3.SS1.SSS2.p6.5.m5.1.1.1.cmml">&gt;</mo><mi id="S3.SS1.SSS2.p6.5.m5.1.1.3" xref="S3.SS1.SSS2.p6.5.m5.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p6.5.m5.1b"><apply id="S3.SS1.SSS2.p6.5.m5.1.1.cmml" xref="S3.SS1.SSS2.p6.5.m5.1.1"><gt id="S3.SS1.SSS2.p6.5.m5.1.1.1.cmml" xref="S3.SS1.SSS2.p6.5.m5.1.1.1"></gt><ci id="S3.SS1.SSS2.p6.5.m5.1.1.2.cmml" xref="S3.SS1.SSS2.p6.5.m5.1.1.2">𝑗</ci><ci id="S3.SS1.SSS2.p6.5.m5.1.1.3.cmml" xref="S3.SS1.SSS2.p6.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p6.5.m5.1c">j&gt;i</annotation></semantics></math> from other models or itself. Besides, the operation type also determines the quality of a model. For a CNN model, the fully connected layer is usually used after the convolution layer, which motivates us to design the <math id="S3.SS1.SSS2.p6.6.m6.1" class="ltx_Math" alttext="\mathcal{R}_{2}" display="inline"><semantics id="S3.SS1.SSS2.p6.6.m6.1a"><msub id="S3.SS1.SSS2.p6.6.m6.1.1" xref="S3.SS1.SSS2.p6.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p6.6.m6.1.1.2" xref="S3.SS1.SSS2.p6.6.m6.1.1.2.cmml">ℛ</mi><mn id="S3.SS1.SSS2.p6.6.m6.1.1.3" xref="S3.SS1.SSS2.p6.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p6.6.m6.1b"><apply id="S3.SS1.SSS2.p6.6.m6.1.1.cmml" xref="S3.SS1.SSS2.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p6.6.m6.1.1.1.cmml" xref="S3.SS1.SSS2.p6.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p6.6.m6.1.1.2.cmml" xref="S3.SS1.SSS2.p6.6.m6.1.1.2">ℛ</ci><cn type="integer" id="S3.SS1.SSS2.p6.6.m6.1.1.3.cmml" xref="S3.SS1.SSS2.p6.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p6.6.m6.1c">\mathcal{R}_{2}</annotation></semantics></math> operation order rule in Line 11.</p>
</div>
<div id="S3.SS1.SSS2.p7" class="ltx_para">
<p id="S3.SS1.SSS2.p7.3" class="ltx_p">Only taking the informativeness principle into consideration, we may generate a vast number of candidates with different sizes of layers. Some candidates may be a subset of others and even worse with low quality. Besides, the large number of candidates will increase the computational burden of the server. To avoid these issues and further obtain high-quality candidates, we use the <span id="S3.SS1.SSS2.p7.3.1" class="ltx_text ltx_font_bold">diversity</span> principle as the filtering rule.
A diverse and informative model should contain all the operation types, i.e., the <math id="S3.SS1.SSS2.p7.1.m1.1" class="ltx_Math" alttext="\mathcal{R}_{3}" display="inline"><semantics id="S3.SS1.SSS2.p7.1.m1.1a"><msub id="S3.SS1.SSS2.p7.1.m1.1.1" xref="S3.SS1.SSS2.p7.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p7.1.m1.1.1.2" xref="S3.SS1.SSS2.p7.1.m1.1.1.2.cmml">ℛ</mi><mn id="S3.SS1.SSS2.p7.1.m1.1.1.3" xref="S3.SS1.SSS2.p7.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p7.1.m1.1b"><apply id="S3.SS1.SSS2.p7.1.m1.1.1.cmml" xref="S3.SS1.SSS2.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p7.1.m1.1.1.1.cmml" xref="S3.SS1.SSS2.p7.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p7.1.m1.1.1.2.cmml" xref="S3.SS1.SSS2.p7.1.m1.1.1.2">ℛ</ci><cn type="integer" id="S3.SS1.SSS2.p7.1.m1.1.1.3.cmml" xref="S3.SS1.SSS2.p7.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p7.1.m1.1c">\mathcal{R}_{3}</annotation></semantics></math> complete operation rule in Line 16. Besides, the groups <math id="S3.SS1.SSS2.p7.2.m2.3" class="ltx_Math" alttext="\{\mathcal{G}_{t}^{1},\cdots,\mathcal{G}_{t}^{K}\}" display="inline"><semantics id="S3.SS1.SSS2.p7.2.m2.3a"><mrow id="S3.SS1.SSS2.p7.2.m2.3.3.2" xref="S3.SS1.SSS2.p7.2.m2.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.SSS2.p7.2.m2.3.3.2.3" xref="S3.SS1.SSS2.p7.2.m2.3.3.3.cmml">{</mo><msubsup id="S3.SS1.SSS2.p7.2.m2.2.2.1.1" xref="S3.SS1.SSS2.p7.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p7.2.m2.2.2.1.1.2.2" xref="S3.SS1.SSS2.p7.2.m2.2.2.1.1.2.2.cmml">𝒢</mi><mi id="S3.SS1.SSS2.p7.2.m2.2.2.1.1.2.3" xref="S3.SS1.SSS2.p7.2.m2.2.2.1.1.2.3.cmml">t</mi><mn id="S3.SS1.SSS2.p7.2.m2.2.2.1.1.3" xref="S3.SS1.SSS2.p7.2.m2.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.SSS2.p7.2.m2.3.3.2.4" xref="S3.SS1.SSS2.p7.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS2.p7.2.m2.1.1" xref="S3.SS1.SSS2.p7.2.m2.1.1.cmml">⋯</mi><mo id="S3.SS1.SSS2.p7.2.m2.3.3.2.5" xref="S3.SS1.SSS2.p7.2.m2.3.3.3.cmml">,</mo><msubsup id="S3.SS1.SSS2.p7.2.m2.3.3.2.2" xref="S3.SS1.SSS2.p7.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p7.2.m2.3.3.2.2.2.2" xref="S3.SS1.SSS2.p7.2.m2.3.3.2.2.2.2.cmml">𝒢</mi><mi id="S3.SS1.SSS2.p7.2.m2.3.3.2.2.2.3" xref="S3.SS1.SSS2.p7.2.m2.3.3.2.2.2.3.cmml">t</mi><mi id="S3.SS1.SSS2.p7.2.m2.3.3.2.2.3" xref="S3.SS1.SSS2.p7.2.m2.3.3.2.2.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS2.p7.2.m2.3.3.2.6" xref="S3.SS1.SSS2.p7.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p7.2.m2.3b"><set id="S3.SS1.SSS2.p7.2.m2.3.3.3.cmml" xref="S3.SS1.SSS2.p7.2.m2.3.3.2"><apply id="S3.SS1.SSS2.p7.2.m2.2.2.1.1.cmml" xref="S3.SS1.SSS2.p7.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p7.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.SSS2.p7.2.m2.2.2.1.1">superscript</csymbol><apply id="S3.SS1.SSS2.p7.2.m2.2.2.1.1.2.cmml" xref="S3.SS1.SSS2.p7.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p7.2.m2.2.2.1.1.2.1.cmml" xref="S3.SS1.SSS2.p7.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p7.2.m2.2.2.1.1.2.2.cmml" xref="S3.SS1.SSS2.p7.2.m2.2.2.1.1.2.2">𝒢</ci><ci id="S3.SS1.SSS2.p7.2.m2.2.2.1.1.2.3.cmml" xref="S3.SS1.SSS2.p7.2.m2.2.2.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.SSS2.p7.2.m2.2.2.1.1.3.cmml" xref="S3.SS1.SSS2.p7.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.SSS2.p7.2.m2.1.1.cmml" xref="S3.SS1.SSS2.p7.2.m2.1.1">⋯</ci><apply id="S3.SS1.SSS2.p7.2.m2.3.3.2.2.cmml" xref="S3.SS1.SSS2.p7.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p7.2.m2.3.3.2.2.1.cmml" xref="S3.SS1.SSS2.p7.2.m2.3.3.2.2">superscript</csymbol><apply id="S3.SS1.SSS2.p7.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.SSS2.p7.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p7.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS2.p7.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS2.p7.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS2.p7.2.m2.3.3.2.2.2.2">𝒢</ci><ci id="S3.SS1.SSS2.p7.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS2.p7.2.m2.3.3.2.2.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS2.p7.2.m2.3.3.2.2.3.cmml" xref="S3.SS1.SSS2.p7.2.m2.3.3.2.2.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p7.2.m2.3c">\{\mathcal{G}_{t}^{1},\cdots,\mathcal{G}_{t}^{K}\}</annotation></semantics></math> are clustered based on their layer functions. The requirement that layers of candidates must be from different groups should significantly increase the diversity of model functions, which motivates us to design the <math id="S3.SS1.SSS2.p7.3.m3.1" class="ltx_Math" alttext="\mathcal{R}_{4}" display="inline"><semantics id="S3.SS1.SSS2.p7.3.m3.1a"><msub id="S3.SS1.SSS2.p7.3.m3.1.1" xref="S3.SS1.SSS2.p7.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS2.p7.3.m3.1.1.2" xref="S3.SS1.SSS2.p7.3.m3.1.1.2.cmml">ℛ</mi><mn id="S3.SS1.SSS2.p7.3.m3.1.1.3" xref="S3.SS1.SSS2.p7.3.m3.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS2.p7.3.m3.1b"><apply id="S3.SS1.SSS2.p7.3.m3.1.1.cmml" xref="S3.SS1.SSS2.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS2.p7.3.m3.1.1.1.cmml" xref="S3.SS1.SSS2.p7.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS2.p7.3.m3.1.1.2.cmml" xref="S3.SS1.SSS2.p7.3.m3.1.1.2">ℛ</ci><cn type="integer" id="S3.SS1.SSS2.p7.3.m3.1.1.3.cmml" xref="S3.SS1.SSS2.p7.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS2.p7.3.m3.1c">\mathcal{R}_{4}</annotation></semantics></math> diverse group rule in Line 17.</p>
</div>
</section>
<section id="S3.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3 </span>Similarity Learning with Layer Stitching – <math id="S3.SS1.SSS3.1.m1.2" class="ltx_Math" alttext="\text{sim}(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.SSS3.1.m1.2b"><mrow id="S3.SS1.SSS3.1.m1.2.3" xref="S3.SS1.SSS3.1.m1.2.3.cmml"><mtext id="S3.SS1.SSS3.1.m1.2.3.2" xref="S3.SS1.SSS3.1.m1.2.3.2a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.1.m1.2.3.1" xref="S3.SS1.SSS3.1.m1.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS3.1.m1.2.3.3.2" xref="S3.SS1.SSS3.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS3.1.m1.2.3.3.2.1" xref="S3.SS1.SSS3.1.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.1.m1.1.1" xref="S3.SS1.SSS3.1.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.SSS3.1.m1.2.3.3.2.2" xref="S3.SS1.SSS3.1.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.1.m1.2.2" xref="S3.SS1.SSS3.1.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS3.1.m1.2.3.3.2.3" xref="S3.SS1.SSS3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.1.m1.2c"><apply id="S3.SS1.SSS3.1.m1.2.3.cmml" xref="S3.SS1.SSS3.1.m1.2.3"><times id="S3.SS1.SSS3.1.m1.2.3.1.cmml" xref="S3.SS1.SSS3.1.m1.2.3.1"></times><ci id="S3.SS1.SSS3.1.m1.2.3.2a.cmml" xref="S3.SS1.SSS3.1.m1.2.3.2"><mtext id="S3.SS1.SSS3.1.m1.2.3.2.cmml" xref="S3.SS1.SSS3.1.m1.2.3.2">sim</mtext></ci><interval closure="open" id="S3.SS1.SSS3.1.m1.2.3.3.1.cmml" xref="S3.SS1.SSS3.1.m1.2.3.3.2"><ci id="S3.SS1.SSS3.1.m1.1.1.cmml" xref="S3.SS1.SSS3.1.m1.1.1">⋅</ci><ci id="S3.SS1.SSS3.1.m1.2.2.cmml" xref="S3.SS1.SSS3.1.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.1.m1.2d">\text{sim}(\cdot,\cdot)</annotation></semantics></math>
</h4>

<div id="S3.SS1.SSS3.p1" class="ltx_para">
<p id="S3.SS1.SSS3.p1.6" class="ltx_p">After obtaining a set of candidate models <math id="S3.SS1.SSS3.p1.1.m1.3" class="ltx_Math" alttext="\{\mathbf{c}_{t}^{1},\cdots,\mathbf{c}_{t}^{M}\}" display="inline"><semantics id="S3.SS1.SSS3.p1.1.m1.3a"><mrow id="S3.SS1.SSS3.p1.1.m1.3.3.2" xref="S3.SS1.SSS3.p1.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p1.1.m1.3.3.2.3" xref="S3.SS1.SSS3.p1.1.m1.3.3.3.cmml">{</mo><msubsup id="S3.SS1.SSS3.p1.1.m1.2.2.1.1" xref="S3.SS1.SSS3.p1.1.m1.2.2.1.1.cmml"><mi id="S3.SS1.SSS3.p1.1.m1.2.2.1.1.2.2" xref="S3.SS1.SSS3.p1.1.m1.2.2.1.1.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS3.p1.1.m1.2.2.1.1.2.3" xref="S3.SS1.SSS3.p1.1.m1.2.2.1.1.2.3.cmml">t</mi><mn id="S3.SS1.SSS3.p1.1.m1.2.2.1.1.3" xref="S3.SS1.SSS3.p1.1.m1.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.SSS3.p1.1.m1.3.3.2.4" xref="S3.SS1.SSS3.p1.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS3.p1.1.m1.1.1" xref="S3.SS1.SSS3.p1.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS1.SSS3.p1.1.m1.3.3.2.5" xref="S3.SS1.SSS3.p1.1.m1.3.3.3.cmml">,</mo><msubsup id="S3.SS1.SSS3.p1.1.m1.3.3.2.2" xref="S3.SS1.SSS3.p1.1.m1.3.3.2.2.cmml"><mi id="S3.SS1.SSS3.p1.1.m1.3.3.2.2.2.2" xref="S3.SS1.SSS3.p1.1.m1.3.3.2.2.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS3.p1.1.m1.3.3.2.2.2.3" xref="S3.SS1.SSS3.p1.1.m1.3.3.2.2.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p1.1.m1.3.3.2.2.3" xref="S3.SS1.SSS3.p1.1.m1.3.3.2.2.3.cmml">M</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS3.p1.1.m1.3.3.2.6" xref="S3.SS1.SSS3.p1.1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.1.m1.3b"><set id="S3.SS1.SSS3.p1.1.m1.3.3.3.cmml" xref="S3.SS1.SSS3.p1.1.m1.3.3.2"><apply id="S3.SS1.SSS3.p1.1.m1.2.2.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.2.2.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS1.SSS3.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.1.m1.2.2.1.1.2.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p1.1.m1.2.2.1.1.2.2.cmml" xref="S3.SS1.SSS3.p1.1.m1.2.2.1.1.2.2">𝐜</ci><ci id="S3.SS1.SSS3.p1.1.m1.2.2.1.1.2.3.cmml" xref="S3.SS1.SSS3.p1.1.m1.2.2.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.SSS3.p1.1.m1.2.2.1.1.3.cmml" xref="S3.SS1.SSS3.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1">⋯</ci><apply id="S3.SS1.SSS3.p1.1.m1.3.3.2.2.cmml" xref="S3.SS1.SSS3.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.3.3.2.2">superscript</csymbol><apply id="S3.SS1.SSS3.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.SSS3.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS3.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS3.p1.1.m1.3.3.2.2.2.2">𝐜</ci><ci id="S3.SS1.SSS3.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS3.p1.1.m1.3.3.2.2.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p1.1.m1.3.3.2.2.3.cmml" xref="S3.SS1.SSS3.p1.1.m1.3.3.2.2.3">𝑀</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.1.m1.3c">\{\mathbf{c}_{t}^{1},\cdots,\mathbf{c}_{t}^{M}\}</annotation></semantics></math>, to optimize Eq. (<a href="#S3.E2" title="In 3.1.1 Similarity-based Model Matching ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), we need to calculate the similary bettwen each client model <math id="S3.SS1.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{w}_{t}^{n}" display="inline"><semantics id="S3.SS1.SSS3.p1.2.m2.1a"><msubsup id="S3.SS1.SSS3.p1.2.m2.1.1" xref="S3.SS1.SSS3.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS3.p1.2.m2.1.1.2.2" xref="S3.SS1.SSS3.p1.2.m2.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.SSS3.p1.2.m2.1.1.2.3" xref="S3.SS1.SSS3.p1.2.m2.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p1.2.m2.1.1.3" xref="S3.SS1.SSS3.p1.2.m2.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.2.m2.1b"><apply id="S3.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1.2.2">𝐰</ci><ci id="S3.SS1.SSS3.p1.2.m2.1.1.2.3.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.2.m2.1c">\mathbf{w}_{t}^{n}</annotation></semantics></math> and all the cadidates <math id="S3.SS1.SSS3.p1.3.m3.3" class="ltx_Math" alttext="\{\mathbf{c}_{t}^{1},\cdots,\mathbf{c}_{t}^{M}\}" display="inline"><semantics id="S3.SS1.SSS3.p1.3.m3.3a"><mrow id="S3.SS1.SSS3.p1.3.m3.3.3.2" xref="S3.SS1.SSS3.p1.3.m3.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p1.3.m3.3.3.2.3" xref="S3.SS1.SSS3.p1.3.m3.3.3.3.cmml">{</mo><msubsup id="S3.SS1.SSS3.p1.3.m3.2.2.1.1" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.2" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.3" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.3.cmml">t</mi><mn id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.3" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.SSS3.p1.3.m3.3.3.2.4" xref="S3.SS1.SSS3.p1.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS3.p1.3.m3.1.1" xref="S3.SS1.SSS3.p1.3.m3.1.1.cmml">⋯</mi><mo id="S3.SS1.SSS3.p1.3.m3.3.3.2.5" xref="S3.SS1.SSS3.p1.3.m3.3.3.3.cmml">,</mo><msubsup id="S3.SS1.SSS3.p1.3.m3.3.3.2.2" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.cmml"><mi id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.2" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.3" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.3" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.3.cmml">M</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS3.p1.3.m3.3.3.2.6" xref="S3.SS1.SSS3.p1.3.m3.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.3.m3.3b"><set id="S3.SS1.SSS3.p1.3.m3.3.3.3.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2"><apply id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.2.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.2">𝐜</ci><ci id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.3.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS1.SSS3.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS1.SSS3.p1.3.m3.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.1.1">⋯</ci><apply id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2">superscript</csymbol><apply id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.2">𝐜</ci><ci id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS1.SSS3.p1.3.m3.3.3.2.2.3">𝑀</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.3.m3.3c">\{\mathbf{c}_{t}^{1},\cdots,\mathbf{c}_{t}^{M}\}</annotation></semantics></math> using the public data <math id="S3.SS1.SSS3.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{p}" display="inline"><semantics id="S3.SS1.SSS3.p1.4.m4.1a"><msub id="S3.SS1.SSS3.p1.4.m4.1.1" xref="S3.SS1.SSS3.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p1.4.m4.1.1.2" xref="S3.SS1.SSS3.p1.4.m4.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.SSS3.p1.4.m4.1.1.3" xref="S3.SS1.SSS3.p1.4.m4.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.4.m4.1b"><apply id="S3.SS1.SSS3.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS3.p1.4.m4.1.1.2">𝒟</ci><ci id="S3.SS1.SSS3.p1.4.m4.1.1.3.cmml" xref="S3.SS1.SSS3.p1.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.4.m4.1c">\mathcal{D}_{p}</annotation></semantics></math>. However, this is non-trivial since <math id="S3.SS1.SSS3.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{c}_{t}^{m}" display="inline"><semantics id="S3.SS1.SSS3.p1.5.m5.1a"><msubsup id="S3.SS1.SSS3.p1.5.m5.1.1" xref="S3.SS1.SSS3.p1.5.m5.1.1.cmml"><mi id="S3.SS1.SSS3.p1.5.m5.1.1.2.2" xref="S3.SS1.SSS3.p1.5.m5.1.1.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS3.p1.5.m5.1.1.2.3" xref="S3.SS1.SSS3.p1.5.m5.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p1.5.m5.1.1.3" xref="S3.SS1.SSS3.p1.5.m5.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.5.m5.1b"><apply id="S3.SS1.SSS3.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.5.m5.1.1.1.cmml" xref="S3.SS1.SSS3.p1.5.m5.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.5.m5.1.1.2.1.cmml" xref="S3.SS1.SSS3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p1.5.m5.1.1.2.2.cmml" xref="S3.SS1.SSS3.p1.5.m5.1.1.2.2">𝐜</ci><ci id="S3.SS1.SSS3.p1.5.m5.1.1.2.3.cmml" xref="S3.SS1.SSS3.p1.5.m5.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p1.5.m5.1.1.3.cmml" xref="S3.SS1.SSS3.p1.5.m5.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.5.m5.1c">\mathbf{c}_{t}^{m}</annotation></semantics></math> is assembled by layers from different client models, which is not a complete model architecture. We have to stitch these layers together before using <math id="S3.SS1.SSS3.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{c}_{t}^{m}" display="inline"><semantics id="S3.SS1.SSS3.p1.6.m6.1a"><msubsup id="S3.SS1.SSS3.p1.6.m6.1.1" xref="S3.SS1.SSS3.p1.6.m6.1.1.cmml"><mi id="S3.SS1.SSS3.p1.6.m6.1.1.2.2" xref="S3.SS1.SSS3.p1.6.m6.1.1.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS3.p1.6.m6.1.1.2.3" xref="S3.SS1.SSS3.p1.6.m6.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p1.6.m6.1.1.3" xref="S3.SS1.SSS3.p1.6.m6.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.6.m6.1b"><apply id="S3.SS1.SSS3.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS3.p1.6.m6.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.SSS3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.SSS3.p1.6.m6.1.1.2.2">𝐜</ci><ci id="S3.SS1.SSS3.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.SSS3.p1.6.m6.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS3.p1.6.m6.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.6.m6.1c">\mathbf{c}_{t}^{m}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.SSS3.p2" class="ltx_para">
<p id="S3.SS1.SSS3.p2.17" class="ltx_p"><span id="S3.SS1.SSS3.p2.17.1" class="ltx_text ltx_font_bold">Layer Stitching</span>.
Assume that <math id="S3.SS1.SSS3.p2.1.m1.2" class="ltx_Math" alttext="\mathbf{L}_{t,i}^{n}" display="inline"><semantics id="S3.SS1.SSS3.p2.1.m1.2a"><msubsup id="S3.SS1.SSS3.p2.1.m1.2.3" xref="S3.SS1.SSS3.p2.1.m1.2.3.cmml"><mi id="S3.SS1.SSS3.p2.1.m1.2.3.2.2" xref="S3.SS1.SSS3.p2.1.m1.2.3.2.2.cmml">𝐋</mi><mrow id="S3.SS1.SSS3.p2.1.m1.2.2.2.4" xref="S3.SS1.SSS3.p2.1.m1.2.2.2.3.cmml"><mi id="S3.SS1.SSS3.p2.1.m1.1.1.1.1" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1.cmml">t</mi><mo id="S3.SS1.SSS3.p2.1.m1.2.2.2.4.1" xref="S3.SS1.SSS3.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS3.p2.1.m1.2.2.2.2" xref="S3.SS1.SSS3.p2.1.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS1.SSS3.p2.1.m1.2.3.3" xref="S3.SS1.SSS3.p2.1.m1.2.3.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.1.m1.2b"><apply id="S3.SS1.SSS3.p2.1.m1.2.3.cmml" xref="S3.SS1.SSS3.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.1.m1.2.3.1.cmml" xref="S3.SS1.SSS3.p2.1.m1.2.3">superscript</csymbol><apply id="S3.SS1.SSS3.p2.1.m1.2.3.2.cmml" xref="S3.SS1.SSS3.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.1.m1.2.3.2.1.cmml" xref="S3.SS1.SSS3.p2.1.m1.2.3">subscript</csymbol><ci id="S3.SS1.SSS3.p2.1.m1.2.3.2.2.cmml" xref="S3.SS1.SSS3.p2.1.m1.2.3.2.2">𝐋</ci><list id="S3.SS1.SSS3.p2.1.m1.2.2.2.3.cmml" xref="S3.SS1.SSS3.p2.1.m1.2.2.2.4"><ci id="S3.SS1.SSS3.p2.1.m1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.1.m1.1.1.1.1">𝑡</ci><ci id="S3.SS1.SSS3.p2.1.m1.2.2.2.2.cmml" xref="S3.SS1.SSS3.p2.1.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS1.SSS3.p2.1.m1.2.3.3.cmml" xref="S3.SS1.SSS3.p2.1.m1.2.3.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.1.m1.2c">\mathbf{L}_{t,i}^{n}</annotation></semantics></math> and <math id="S3.SS1.SSS3.p2.2.m2.2" class="ltx_Math" alttext="\mathbf{L}_{t,j}^{b}" display="inline"><semantics id="S3.SS1.SSS3.p2.2.m2.2a"><msubsup id="S3.SS1.SSS3.p2.2.m2.2.3" xref="S3.SS1.SSS3.p2.2.m2.2.3.cmml"><mi id="S3.SS1.SSS3.p2.2.m2.2.3.2.2" xref="S3.SS1.SSS3.p2.2.m2.2.3.2.2.cmml">𝐋</mi><mrow id="S3.SS1.SSS3.p2.2.m2.2.2.2.4" xref="S3.SS1.SSS3.p2.2.m2.2.2.2.3.cmml"><mi id="S3.SS1.SSS3.p2.2.m2.1.1.1.1" xref="S3.SS1.SSS3.p2.2.m2.1.1.1.1.cmml">t</mi><mo id="S3.SS1.SSS3.p2.2.m2.2.2.2.4.1" xref="S3.SS1.SSS3.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS3.p2.2.m2.2.2.2.2" xref="S3.SS1.SSS3.p2.2.m2.2.2.2.2.cmml">j</mi></mrow><mi id="S3.SS1.SSS3.p2.2.m2.2.3.3" xref="S3.SS1.SSS3.p2.2.m2.2.3.3.cmml">b</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.2.m2.2b"><apply id="S3.SS1.SSS3.p2.2.m2.2.3.cmml" xref="S3.SS1.SSS3.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.2.m2.2.3.1.cmml" xref="S3.SS1.SSS3.p2.2.m2.2.3">superscript</csymbol><apply id="S3.SS1.SSS3.p2.2.m2.2.3.2.cmml" xref="S3.SS1.SSS3.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.2.m2.2.3.2.1.cmml" xref="S3.SS1.SSS3.p2.2.m2.2.3">subscript</csymbol><ci id="S3.SS1.SSS3.p2.2.m2.2.3.2.2.cmml" xref="S3.SS1.SSS3.p2.2.m2.2.3.2.2">𝐋</ci><list id="S3.SS1.SSS3.p2.2.m2.2.2.2.3.cmml" xref="S3.SS1.SSS3.p2.2.m2.2.2.2.4"><ci id="S3.SS1.SSS3.p2.2.m2.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.2.m2.1.1.1.1">𝑡</ci><ci id="S3.SS1.SSS3.p2.2.m2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p2.2.m2.2.2.2.2">𝑗</ci></list></apply><ci id="S3.SS1.SSS3.p2.2.m2.2.3.3.cmml" xref="S3.SS1.SSS3.p2.2.m2.2.3.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.2.m2.2c">\mathbf{L}_{t,j}^{b}</annotation></semantics></math> are any two consecutive layers in the candidate model <math id="S3.SS1.SSS3.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{c}_{t}^{m}" display="inline"><semantics id="S3.SS1.SSS3.p2.3.m3.1a"><msubsup id="S3.SS1.SSS3.p2.3.m3.1.1" xref="S3.SS1.SSS3.p2.3.m3.1.1.cmml"><mi id="S3.SS1.SSS3.p2.3.m3.1.1.2.2" xref="S3.SS1.SSS3.p2.3.m3.1.1.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS3.p2.3.m3.1.1.2.3" xref="S3.SS1.SSS3.p2.3.m3.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p2.3.m3.1.1.3" xref="S3.SS1.SSS3.p2.3.m3.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.3.m3.1b"><apply id="S3.SS1.SSS3.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.3.m3.1.1.1.cmml" xref="S3.SS1.SSS3.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p2.3.m3.1.1.2.cmml" xref="S3.SS1.SSS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS1.SSS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS1.SSS3.p2.3.m3.1.1.2.2">𝐜</ci><ci id="S3.SS1.SSS3.p2.3.m3.1.1.2.3.cmml" xref="S3.SS1.SSS3.p2.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p2.3.m3.1.1.3.cmml" xref="S3.SS1.SSS3.p2.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.3.m3.1c">\mathbf{c}_{t}^{m}</annotation></semantics></math>. Let <math id="S3.SS1.SSS3.p2.4.m4.1" class="ltx_Math" alttext="d_{i}" display="inline"><semantics id="S3.SS1.SSS3.p2.4.m4.1a"><msub id="S3.SS1.SSS3.p2.4.m4.1.1" xref="S3.SS1.SSS3.p2.4.m4.1.1.cmml"><mi id="S3.SS1.SSS3.p2.4.m4.1.1.2" xref="S3.SS1.SSS3.p2.4.m4.1.1.2.cmml">d</mi><mi id="S3.SS1.SSS3.p2.4.m4.1.1.3" xref="S3.SS1.SSS3.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.4.m4.1b"><apply id="S3.SS1.SSS3.p2.4.m4.1.1.cmml" xref="S3.SS1.SSS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.4.m4.1.1.1.cmml" xref="S3.SS1.SSS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.4.m4.1.1.2.cmml" xref="S3.SS1.SSS3.p2.4.m4.1.1.2">𝑑</ci><ci id="S3.SS1.SSS3.p2.4.m4.1.1.3.cmml" xref="S3.SS1.SSS3.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.4.m4.1c">d_{i}</annotation></semantics></math> denote the output dimension of <math id="S3.SS1.SSS3.p2.5.m5.2" class="ltx_Math" alttext="\mathbf{L}_{t,i}^{n}" display="inline"><semantics id="S3.SS1.SSS3.p2.5.m5.2a"><msubsup id="S3.SS1.SSS3.p2.5.m5.2.3" xref="S3.SS1.SSS3.p2.5.m5.2.3.cmml"><mi id="S3.SS1.SSS3.p2.5.m5.2.3.2.2" xref="S3.SS1.SSS3.p2.5.m5.2.3.2.2.cmml">𝐋</mi><mrow id="S3.SS1.SSS3.p2.5.m5.2.2.2.4" xref="S3.SS1.SSS3.p2.5.m5.2.2.2.3.cmml"><mi id="S3.SS1.SSS3.p2.5.m5.1.1.1.1" xref="S3.SS1.SSS3.p2.5.m5.1.1.1.1.cmml">t</mi><mo id="S3.SS1.SSS3.p2.5.m5.2.2.2.4.1" xref="S3.SS1.SSS3.p2.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS3.p2.5.m5.2.2.2.2" xref="S3.SS1.SSS3.p2.5.m5.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS1.SSS3.p2.5.m5.2.3.3" xref="S3.SS1.SSS3.p2.5.m5.2.3.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.5.m5.2b"><apply id="S3.SS1.SSS3.p2.5.m5.2.3.cmml" xref="S3.SS1.SSS3.p2.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.5.m5.2.3.1.cmml" xref="S3.SS1.SSS3.p2.5.m5.2.3">superscript</csymbol><apply id="S3.SS1.SSS3.p2.5.m5.2.3.2.cmml" xref="S3.SS1.SSS3.p2.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.5.m5.2.3.2.1.cmml" xref="S3.SS1.SSS3.p2.5.m5.2.3">subscript</csymbol><ci id="S3.SS1.SSS3.p2.5.m5.2.3.2.2.cmml" xref="S3.SS1.SSS3.p2.5.m5.2.3.2.2">𝐋</ci><list id="S3.SS1.SSS3.p2.5.m5.2.2.2.3.cmml" xref="S3.SS1.SSS3.p2.5.m5.2.2.2.4"><ci id="S3.SS1.SSS3.p2.5.m5.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.5.m5.1.1.1.1">𝑡</ci><ci id="S3.SS1.SSS3.p2.5.m5.2.2.2.2.cmml" xref="S3.SS1.SSS3.p2.5.m5.2.2.2.2">𝑖</ci></list></apply><ci id="S3.SS1.SSS3.p2.5.m5.2.3.3.cmml" xref="S3.SS1.SSS3.p2.5.m5.2.3.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.5.m5.2c">\mathbf{L}_{t,i}^{n}</annotation></semantics></math> and <math id="S3.SS1.SSS3.p2.6.m6.1" class="ltx_Math" alttext="d_{j}" display="inline"><semantics id="S3.SS1.SSS3.p2.6.m6.1a"><msub id="S3.SS1.SSS3.p2.6.m6.1.1" xref="S3.SS1.SSS3.p2.6.m6.1.1.cmml"><mi id="S3.SS1.SSS3.p2.6.m6.1.1.2" xref="S3.SS1.SSS3.p2.6.m6.1.1.2.cmml">d</mi><mi id="S3.SS1.SSS3.p2.6.m6.1.1.3" xref="S3.SS1.SSS3.p2.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.6.m6.1b"><apply id="S3.SS1.SSS3.p2.6.m6.1.1.cmml" xref="S3.SS1.SSS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.6.m6.1.1.1.cmml" xref="S3.SS1.SSS3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.6.m6.1.1.2.cmml" xref="S3.SS1.SSS3.p2.6.m6.1.1.2">𝑑</ci><ci id="S3.SS1.SSS3.p2.6.m6.1.1.3.cmml" xref="S3.SS1.SSS3.p2.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.6.m6.1c">d_{j}</annotation></semantics></math> denote the input dimension of <math id="S3.SS1.SSS3.p2.7.m7.2" class="ltx_Math" alttext="\mathbf{L}_{t,j}^{b}" display="inline"><semantics id="S3.SS1.SSS3.p2.7.m7.2a"><msubsup id="S3.SS1.SSS3.p2.7.m7.2.3" xref="S3.SS1.SSS3.p2.7.m7.2.3.cmml"><mi id="S3.SS1.SSS3.p2.7.m7.2.3.2.2" xref="S3.SS1.SSS3.p2.7.m7.2.3.2.2.cmml">𝐋</mi><mrow id="S3.SS1.SSS3.p2.7.m7.2.2.2.4" xref="S3.SS1.SSS3.p2.7.m7.2.2.2.3.cmml"><mi id="S3.SS1.SSS3.p2.7.m7.1.1.1.1" xref="S3.SS1.SSS3.p2.7.m7.1.1.1.1.cmml">t</mi><mo id="S3.SS1.SSS3.p2.7.m7.2.2.2.4.1" xref="S3.SS1.SSS3.p2.7.m7.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS3.p2.7.m7.2.2.2.2" xref="S3.SS1.SSS3.p2.7.m7.2.2.2.2.cmml">j</mi></mrow><mi id="S3.SS1.SSS3.p2.7.m7.2.3.3" xref="S3.SS1.SSS3.p2.7.m7.2.3.3.cmml">b</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.7.m7.2b"><apply id="S3.SS1.SSS3.p2.7.m7.2.3.cmml" xref="S3.SS1.SSS3.p2.7.m7.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.7.m7.2.3.1.cmml" xref="S3.SS1.SSS3.p2.7.m7.2.3">superscript</csymbol><apply id="S3.SS1.SSS3.p2.7.m7.2.3.2.cmml" xref="S3.SS1.SSS3.p2.7.m7.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.7.m7.2.3.2.1.cmml" xref="S3.SS1.SSS3.p2.7.m7.2.3">subscript</csymbol><ci id="S3.SS1.SSS3.p2.7.m7.2.3.2.2.cmml" xref="S3.SS1.SSS3.p2.7.m7.2.3.2.2">𝐋</ci><list id="S3.SS1.SSS3.p2.7.m7.2.2.2.3.cmml" xref="S3.SS1.SSS3.p2.7.m7.2.2.2.4"><ci id="S3.SS1.SSS3.p2.7.m7.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.7.m7.1.1.1.1">𝑡</ci><ci id="S3.SS1.SSS3.p2.7.m7.2.2.2.2.cmml" xref="S3.SS1.SSS3.p2.7.m7.2.2.2.2">𝑗</ci></list></apply><ci id="S3.SS1.SSS3.p2.7.m7.2.3.3.cmml" xref="S3.SS1.SSS3.p2.7.m7.2.3.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.7.m7.2c">\mathbf{L}_{t,j}^{b}</annotation></semantics></math>. <math id="S3.SS1.SSS3.p2.8.m8.1" class="ltx_Math" alttext="d_{i}" display="inline"><semantics id="S3.SS1.SSS3.p2.8.m8.1a"><msub id="S3.SS1.SSS3.p2.8.m8.1.1" xref="S3.SS1.SSS3.p2.8.m8.1.1.cmml"><mi id="S3.SS1.SSS3.p2.8.m8.1.1.2" xref="S3.SS1.SSS3.p2.8.m8.1.1.2.cmml">d</mi><mi id="S3.SS1.SSS3.p2.8.m8.1.1.3" xref="S3.SS1.SSS3.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.8.m8.1b"><apply id="S3.SS1.SSS3.p2.8.m8.1.1.cmml" xref="S3.SS1.SSS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.8.m8.1.1.1.cmml" xref="S3.SS1.SSS3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.8.m8.1.1.2.cmml" xref="S3.SS1.SSS3.p2.8.m8.1.1.2">𝑑</ci><ci id="S3.SS1.SSS3.p2.8.m8.1.1.3.cmml" xref="S3.SS1.SSS3.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.8.m8.1c">d_{i}</annotation></semantics></math> is usually not equal to <math id="S3.SS1.SSS3.p2.9.m9.1" class="ltx_Math" alttext="d_{j}" display="inline"><semantics id="S3.SS1.SSS3.p2.9.m9.1a"><msub id="S3.SS1.SSS3.p2.9.m9.1.1" xref="S3.SS1.SSS3.p2.9.m9.1.1.cmml"><mi id="S3.SS1.SSS3.p2.9.m9.1.1.2" xref="S3.SS1.SSS3.p2.9.m9.1.1.2.cmml">d</mi><mi id="S3.SS1.SSS3.p2.9.m9.1.1.3" xref="S3.SS1.SSS3.p2.9.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.9.m9.1b"><apply id="S3.SS1.SSS3.p2.9.m9.1.1.cmml" xref="S3.SS1.SSS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.9.m9.1.1.1.cmml" xref="S3.SS1.SSS3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.9.m9.1.1.2.cmml" xref="S3.SS1.SSS3.p2.9.m9.1.1.2">𝑑</ci><ci id="S3.SS1.SSS3.p2.9.m9.1.1.3.cmml" xref="S3.SS1.SSS3.p2.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.9.m9.1c">d_{j}</annotation></semantics></math>. To stitch these two layers, we follow existing work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> by adding a nonlinear activation function <math id="S3.SS1.SSS3.p2.10.m10.1" class="ltx_Math" alttext="\text{ReLU}(\cdot)" display="inline"><semantics id="S3.SS1.SSS3.p2.10.m10.1a"><mrow id="S3.SS1.SSS3.p2.10.m10.1.2" xref="S3.SS1.SSS3.p2.10.m10.1.2.cmml"><mtext id="S3.SS1.SSS3.p2.10.m10.1.2.2" xref="S3.SS1.SSS3.p2.10.m10.1.2.2a.cmml">ReLU</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p2.10.m10.1.2.1" xref="S3.SS1.SSS3.p2.10.m10.1.2.1.cmml">​</mo><mrow id="S3.SS1.SSS3.p2.10.m10.1.2.3.2" xref="S3.SS1.SSS3.p2.10.m10.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p2.10.m10.1.2.3.2.1" xref="S3.SS1.SSS3.p2.10.m10.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p2.10.m10.1.1" xref="S3.SS1.SSS3.p2.10.m10.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS3.p2.10.m10.1.2.3.2.2" xref="S3.SS1.SSS3.p2.10.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.10.m10.1b"><apply id="S3.SS1.SSS3.p2.10.m10.1.2.cmml" xref="S3.SS1.SSS3.p2.10.m10.1.2"><times id="S3.SS1.SSS3.p2.10.m10.1.2.1.cmml" xref="S3.SS1.SSS3.p2.10.m10.1.2.1"></times><ci id="S3.SS1.SSS3.p2.10.m10.1.2.2a.cmml" xref="S3.SS1.SSS3.p2.10.m10.1.2.2"><mtext id="S3.SS1.SSS3.p2.10.m10.1.2.2.cmml" xref="S3.SS1.SSS3.p2.10.m10.1.2.2">ReLU</mtext></ci><ci id="S3.SS1.SSS3.p2.10.m10.1.1.cmml" xref="S3.SS1.SSS3.p2.10.m10.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.10.m10.1c">\text{ReLU}(\cdot)</annotation></semantics></math> on top of a linear layer, i.e., <math id="S3.SS1.SSS3.p2.11.m11.1" class="ltx_Math" alttext="\text{ReLU}(\mathbf{W}^{\top}\mathbf{X}+\mathbf{b})" display="inline"><semantics id="S3.SS1.SSS3.p2.11.m11.1a"><mrow id="S3.SS1.SSS3.p2.11.m11.1.1" xref="S3.SS1.SSS3.p2.11.m11.1.1.cmml"><mtext id="S3.SS1.SSS3.p2.11.m11.1.1.3" xref="S3.SS1.SSS3.p2.11.m11.1.1.3a.cmml">ReLU</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p2.11.m11.1.1.2" xref="S3.SS1.SSS3.p2.11.m11.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS3.p2.11.m11.1.1.1.1" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.2" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.cmml"><mrow id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.cmml"><msup id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2.2" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mo id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2.3" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.1" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.1.cmml">​</mo><mi id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.3" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.3.cmml">𝐗</mi></mrow><mo id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.1" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.1.cmml">+</mo><mi id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.3" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.3.cmml">𝐛</mi></mrow><mo stretchy="false" id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.3" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.11.m11.1b"><apply id="S3.SS1.SSS3.p2.11.m11.1.1.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1"><times id="S3.SS1.SSS3.p2.11.m11.1.1.2.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.2"></times><ci id="S3.SS1.SSS3.p2.11.m11.1.1.3a.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.3"><mtext id="S3.SS1.SSS3.p2.11.m11.1.1.3.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.3">ReLU</mtext></ci><apply id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1"><plus id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.1"></plus><apply id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2"><times id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.1"></times><apply id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2.2">𝐖</ci><csymbol cd="latexml" id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.2.3">top</csymbol></apply><ci id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.2.3">𝐗</ci></apply><ci id="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p2.11.m11.1.1.1.1.1.3">𝐛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.11.m11.1c">\text{ReLU}(\mathbf{W}^{\top}\mathbf{X}+\mathbf{b})</annotation></semantics></math>, where <math id="S3.SS1.SSS3.p2.12.m12.1" class="ltx_Math" alttext="\mathbf{W}\in\mathbb{R}^{d_{i}\times d_{j}}" display="inline"><semantics id="S3.SS1.SSS3.p2.12.m12.1a"><mrow id="S3.SS1.SSS3.p2.12.m12.1.1" xref="S3.SS1.SSS3.p2.12.m12.1.1.cmml"><mi id="S3.SS1.SSS3.p2.12.m12.1.1.2" xref="S3.SS1.SSS3.p2.12.m12.1.1.2.cmml">𝐖</mi><mo id="S3.SS1.SSS3.p2.12.m12.1.1.1" xref="S3.SS1.SSS3.p2.12.m12.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS3.p2.12.m12.1.1.3" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.cmml"><mi id="S3.SS1.SSS3.p2.12.m12.1.1.3.2" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS3.p2.12.m12.1.1.3.3" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.cmml"><msub id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2.cmml"><mi id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2.2" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2.2.cmml">d</mi><mi id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2.3" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.1" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3.cmml"><mi id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3.2" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3.3" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3.3.cmml">j</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.12.m12.1b"><apply id="S3.SS1.SSS3.p2.12.m12.1.1.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1"><in id="S3.SS1.SSS3.p2.12.m12.1.1.1.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.1"></in><ci id="S3.SS1.SSS3.p2.12.m12.1.1.2.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.2">𝐖</ci><apply id="S3.SS1.SSS3.p2.12.m12.1.1.3.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.12.m12.1.1.3.1.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS3.p2.12.m12.1.1.3.2.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3"><times id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.1.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.1"></times><apply id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2.1.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2.2.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2.3.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3.1.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3.2.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3.3.cmml" xref="S3.SS1.SSS3.p2.12.m12.1.1.3.3.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.12.m12.1c">\mathbf{W}\in\mathbb{R}^{d_{i}\times d_{j}}</annotation></semantics></math>, <math id="S3.SS1.SSS3.p2.13.m13.1" class="ltx_Math" alttext="\mathbf{b}\in\mathbb{R}^{d_{j}}" display="inline"><semantics id="S3.SS1.SSS3.p2.13.m13.1a"><mrow id="S3.SS1.SSS3.p2.13.m13.1.1" xref="S3.SS1.SSS3.p2.13.m13.1.1.cmml"><mi id="S3.SS1.SSS3.p2.13.m13.1.1.2" xref="S3.SS1.SSS3.p2.13.m13.1.1.2.cmml">𝐛</mi><mo id="S3.SS1.SSS3.p2.13.m13.1.1.1" xref="S3.SS1.SSS3.p2.13.m13.1.1.1.cmml">∈</mo><msup id="S3.SS1.SSS3.p2.13.m13.1.1.3" xref="S3.SS1.SSS3.p2.13.m13.1.1.3.cmml"><mi id="S3.SS1.SSS3.p2.13.m13.1.1.3.2" xref="S3.SS1.SSS3.p2.13.m13.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS1.SSS3.p2.13.m13.1.1.3.3" xref="S3.SS1.SSS3.p2.13.m13.1.1.3.3.cmml"><mi id="S3.SS1.SSS3.p2.13.m13.1.1.3.3.2" xref="S3.SS1.SSS3.p2.13.m13.1.1.3.3.2.cmml">d</mi><mi id="S3.SS1.SSS3.p2.13.m13.1.1.3.3.3" xref="S3.SS1.SSS3.p2.13.m13.1.1.3.3.3.cmml">j</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.13.m13.1b"><apply id="S3.SS1.SSS3.p2.13.m13.1.1.cmml" xref="S3.SS1.SSS3.p2.13.m13.1.1"><in id="S3.SS1.SSS3.p2.13.m13.1.1.1.cmml" xref="S3.SS1.SSS3.p2.13.m13.1.1.1"></in><ci id="S3.SS1.SSS3.p2.13.m13.1.1.2.cmml" xref="S3.SS1.SSS3.p2.13.m13.1.1.2">𝐛</ci><apply id="S3.SS1.SSS3.p2.13.m13.1.1.3.cmml" xref="S3.SS1.SSS3.p2.13.m13.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.13.m13.1.1.3.1.cmml" xref="S3.SS1.SSS3.p2.13.m13.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS3.p2.13.m13.1.1.3.2.cmml" xref="S3.SS1.SSS3.p2.13.m13.1.1.3.2">ℝ</ci><apply id="S3.SS1.SSS3.p2.13.m13.1.1.3.3.cmml" xref="S3.SS1.SSS3.p2.13.m13.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.13.m13.1.1.3.3.1.cmml" xref="S3.SS1.SSS3.p2.13.m13.1.1.3.3">subscript</csymbol><ci id="S3.SS1.SSS3.p2.13.m13.1.1.3.3.2.cmml" xref="S3.SS1.SSS3.p2.13.m13.1.1.3.3.2">𝑑</ci><ci id="S3.SS1.SSS3.p2.13.m13.1.1.3.3.3.cmml" xref="S3.SS1.SSS3.p2.13.m13.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.13.m13.1c">\mathbf{b}\in\mathbb{R}^{d_{j}}</annotation></semantics></math>, and <math id="S3.SS1.SSS3.p2.14.m14.1" class="ltx_Math" alttext="\mathbf{X}" display="inline"><semantics id="S3.SS1.SSS3.p2.14.m14.1a"><mi id="S3.SS1.SSS3.p2.14.m14.1.1" xref="S3.SS1.SSS3.p2.14.m14.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.14.m14.1b"><ci id="S3.SS1.SSS3.p2.14.m14.1.1.cmml" xref="S3.SS1.SSS3.p2.14.m14.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.14.m14.1c">\mathbf{X}</annotation></semantics></math> represents the output data from the first layer. In such a way, we can obtain a stitched candidate <math id="S3.SS1.SSS3.p2.15.m15.1" class="ltx_Math" alttext="\tilde{\mathbf{c}}_{t}^{m}" display="inline"><semantics id="S3.SS1.SSS3.p2.15.m15.1a"><msubsup id="S3.SS1.SSS3.p2.15.m15.1.1" xref="S3.SS1.SSS3.p2.15.m15.1.1.cmml"><mover accent="true" id="S3.SS1.SSS3.p2.15.m15.1.1.2.2" xref="S3.SS1.SSS3.p2.15.m15.1.1.2.2.cmml"><mi id="S3.SS1.SSS3.p2.15.m15.1.1.2.2.2" xref="S3.SS1.SSS3.p2.15.m15.1.1.2.2.2.cmml">𝐜</mi><mo id="S3.SS1.SSS3.p2.15.m15.1.1.2.2.1" xref="S3.SS1.SSS3.p2.15.m15.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS1.SSS3.p2.15.m15.1.1.2.3" xref="S3.SS1.SSS3.p2.15.m15.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p2.15.m15.1.1.3" xref="S3.SS1.SSS3.p2.15.m15.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.15.m15.1b"><apply id="S3.SS1.SSS3.p2.15.m15.1.1.cmml" xref="S3.SS1.SSS3.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.15.m15.1.1.1.cmml" xref="S3.SS1.SSS3.p2.15.m15.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p2.15.m15.1.1.2.cmml" xref="S3.SS1.SSS3.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.15.m15.1.1.2.1.cmml" xref="S3.SS1.SSS3.p2.15.m15.1.1">subscript</csymbol><apply id="S3.SS1.SSS3.p2.15.m15.1.1.2.2.cmml" xref="S3.SS1.SSS3.p2.15.m15.1.1.2.2"><ci id="S3.SS1.SSS3.p2.15.m15.1.1.2.2.1.cmml" xref="S3.SS1.SSS3.p2.15.m15.1.1.2.2.1">~</ci><ci id="S3.SS1.SSS3.p2.15.m15.1.1.2.2.2.cmml" xref="S3.SS1.SSS3.p2.15.m15.1.1.2.2.2">𝐜</ci></apply><ci id="S3.SS1.SSS3.p2.15.m15.1.1.2.3.cmml" xref="S3.SS1.SSS3.p2.15.m15.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p2.15.m15.1.1.3.cmml" xref="S3.SS1.SSS3.p2.15.m15.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.15.m15.1c">\tilde{\mathbf{c}}_{t}^{m}</annotation></semantics></math>.
The reasons that we apply this simple layer as the stitch are twofold. On the one hand, even adding a simple linear layer between any two consecutive layers, the model will increase <math id="S3.SS1.SSS3.p2.16.m16.1" class="ltx_Math" alttext="d_{i}*(d_{j}+1)" display="inline"><semantics id="S3.SS1.SSS3.p2.16.m16.1a"><mrow id="S3.SS1.SSS3.p2.16.m16.1.1" xref="S3.SS1.SSS3.p2.16.m16.1.1.cmml"><msub id="S3.SS1.SSS3.p2.16.m16.1.1.3" xref="S3.SS1.SSS3.p2.16.m16.1.1.3.cmml"><mi id="S3.SS1.SSS3.p2.16.m16.1.1.3.2" xref="S3.SS1.SSS3.p2.16.m16.1.1.3.2.cmml">d</mi><mi id="S3.SS1.SSS3.p2.16.m16.1.1.3.3" xref="S3.SS1.SSS3.p2.16.m16.1.1.3.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS3.p2.16.m16.1.1.2" xref="S3.SS1.SSS3.p2.16.m16.1.1.2.cmml">∗</mo><mrow id="S3.SS1.SSS3.p2.16.m16.1.1.1.1" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.2" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.cmml"><msub id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2.2" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2.2.cmml">d</mi><mi id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2.3" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.1" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.3" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.3" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.16.m16.1b"><apply id="S3.SS1.SSS3.p2.16.m16.1.1.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1"><times id="S3.SS1.SSS3.p2.16.m16.1.1.2.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1.2"></times><apply id="S3.SS1.SSS3.p2.16.m16.1.1.3.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.16.m16.1.1.3.1.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS3.p2.16.m16.1.1.3.2.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1.3.2">𝑑</ci><ci id="S3.SS1.SSS3.p2.16.m16.1.1.3.3.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1.3.3">𝑖</ci></apply><apply id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1"><plus id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.1"></plus><apply id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2.2">𝑑</ci><ci id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.2.3">𝑗</ci></apply><cn type="integer" id="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p2.16.m16.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.16.m16.1c">d_{i}*(d_{j}+1)</annotation></semantics></math> parameters.
Since a candidate <math id="S3.SS1.SSS3.p2.17.m17.1" class="ltx_Math" alttext="\mathbf{c}_{t}^{m}" display="inline"><semantics id="S3.SS1.SSS3.p2.17.m17.1a"><msubsup id="S3.SS1.SSS3.p2.17.m17.1.1" xref="S3.SS1.SSS3.p2.17.m17.1.1.cmml"><mi id="S3.SS1.SSS3.p2.17.m17.1.1.2.2" xref="S3.SS1.SSS3.p2.17.m17.1.1.2.2.cmml">𝐜</mi><mi id="S3.SS1.SSS3.p2.17.m17.1.1.2.3" xref="S3.SS1.SSS3.p2.17.m17.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p2.17.m17.1.1.3" xref="S3.SS1.SSS3.p2.17.m17.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p2.17.m17.1b"><apply id="S3.SS1.SSS3.p2.17.m17.1.1.cmml" xref="S3.SS1.SSS3.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.17.m17.1.1.1.cmml" xref="S3.SS1.SSS3.p2.17.m17.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p2.17.m17.1.1.2.cmml" xref="S3.SS1.SSS3.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p2.17.m17.1.1.2.1.cmml" xref="S3.SS1.SSS3.p2.17.m17.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p2.17.m17.1.1.2.2.cmml" xref="S3.SS1.SSS3.p2.17.m17.1.1.2.2">𝐜</ci><ci id="S3.SS1.SSS3.p2.17.m17.1.1.2.3.cmml" xref="S3.SS1.SSS3.p2.17.m17.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p2.17.m17.1.1.3.cmml" xref="S3.SS1.SSS3.p2.17.m17.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p2.17.m17.1c">\mathbf{c}_{t}^{m}</annotation></semantics></math> may contain several layers, if using more complicated layers as the stitch, the number of parameters will significantly increase, which makes the new candidate model hard to be trained. On the other hand, using a simple layer with a few parameters may be helpful for the new candidate model to maintain more information from the original models. This is of importance for the similarity calculation in the next step.</p>
</div>
<div id="S3.SS1.SSS3.p3" class="ltx_para">
<p id="S3.SS1.SSS3.p3.2" class="ltx_p"><span id="S3.SS1.SSS3.p3.2.1" class="ltx_text ltx_font_bold">Similarity Calculation</span>.
We propose to use the cosine score <math id="S3.SS1.SSS3.p3.1.m1.2" class="ltx_Math" alttext="\text{cos}(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.SSS3.p3.1.m1.2a"><mrow id="S3.SS1.SSS3.p3.1.m1.2.3" xref="S3.SS1.SSS3.p3.1.m1.2.3.cmml"><mtext id="S3.SS1.SSS3.p3.1.m1.2.3.2" xref="S3.SS1.SSS3.p3.1.m1.2.3.2a.cmml">cos</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p3.1.m1.2.3.1" xref="S3.SS1.SSS3.p3.1.m1.2.3.1.cmml">​</mo><mrow id="S3.SS1.SSS3.p3.1.m1.2.3.3.2" xref="S3.SS1.SSS3.p3.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p3.1.m1.2.3.3.2.1" xref="S3.SS1.SSS3.p3.1.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p3.1.m1.1.1" xref="S3.SS1.SSS3.p3.1.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.SSS3.p3.1.m1.2.3.3.2.2" xref="S3.SS1.SSS3.p3.1.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p3.1.m1.2.2" xref="S3.SS1.SSS3.p3.1.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.SSS3.p3.1.m1.2.3.3.2.3" xref="S3.SS1.SSS3.p3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.1.m1.2b"><apply id="S3.SS1.SSS3.p3.1.m1.2.3.cmml" xref="S3.SS1.SSS3.p3.1.m1.2.3"><times id="S3.SS1.SSS3.p3.1.m1.2.3.1.cmml" xref="S3.SS1.SSS3.p3.1.m1.2.3.1"></times><ci id="S3.SS1.SSS3.p3.1.m1.2.3.2a.cmml" xref="S3.SS1.SSS3.p3.1.m1.2.3.2"><mtext id="S3.SS1.SSS3.p3.1.m1.2.3.2.cmml" xref="S3.SS1.SSS3.p3.1.m1.2.3.2">cos</mtext></ci><interval closure="open" id="S3.SS1.SSS3.p3.1.m1.2.3.3.1.cmml" xref="S3.SS1.SSS3.p3.1.m1.2.3.3.2"><ci id="S3.SS1.SSS3.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p3.1.m1.1.1">⋅</ci><ci id="S3.SS1.SSS3.p3.1.m1.2.2.cmml" xref="S3.SS1.SSS3.p3.1.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.1.m1.2c">\text{cos}(\cdot,\cdot)</annotation></semantics></math> to calculate the similarity between a pair of models <math id="S3.SS1.SSS3.p3.2.m2.2" class="ltx_Math" alttext="(\mathbf{w}_{t}^{n},\tilde{\mathbf{c}}_{t}^{m})" display="inline"><semantics id="S3.SS1.SSS3.p3.2.m2.2a"><mrow id="S3.SS1.SSS3.p3.2.m2.2.2.2" xref="S3.SS1.SSS3.p3.2.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p3.2.m2.2.2.2.3" xref="S3.SS1.SSS3.p3.2.m2.2.2.3.cmml">(</mo><msubsup id="S3.SS1.SSS3.p3.2.m2.1.1.1.1" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.cmml"><mi id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.2.2" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.2.3" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.3" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.3.cmml">n</mi></msubsup><mo id="S3.SS1.SSS3.p3.2.m2.2.2.2.4" xref="S3.SS1.SSS3.p3.2.m2.2.2.3.cmml">,</mo><msubsup id="S3.SS1.SSS3.p3.2.m2.2.2.2.2" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2.cmml"><mover accent="true" id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.2" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.2.2" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.2.2.cmml">𝐜</mi><mo id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.2.1" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.3" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.3" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2.3.cmml">m</mi></msubsup><mo stretchy="false" id="S3.SS1.SSS3.p3.2.m2.2.2.2.5" xref="S3.SS1.SSS3.p3.2.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.2.m2.2b"><interval closure="open" id="S3.SS1.SSS3.p3.2.m2.2.2.3.cmml" xref="S3.SS1.SSS3.p3.2.m2.2.2.2"><apply id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.2.2">𝐰</ci><ci id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p3.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p3.2.m2.1.1.1.1.3">𝑛</ci></apply><apply id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.1.cmml" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2">superscript</csymbol><apply id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2">subscript</csymbol><apply id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.2"><ci id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.2.1">~</ci><ci id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.2.2">𝐜</ci></apply><ci id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p3.2.m2.2.2.2.2.3.cmml" xref="S3.SS1.SSS3.p3.2.m2.2.2.2.2.3">𝑚</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.2.m2.2c">(\mathbf{w}_{t}^{n},\tilde{\mathbf{c}}_{t}^{m})</annotation></semantics></math> as follows:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\text{sim}({\mathbf{w}}_{t}^{n},\mathbf{c}_{t}^{m};\mathcal{D}_{p})=\text{sim}({\mathbf{w}}_{t}^{n},\tilde{\mathbf{c}}_{t}^{m};\mathcal{D}_{p})=\frac{1}{P}\sum_{p=1}^{P}\text{cos}(\boldsymbol{\alpha}_{t}^{n}(\mathbf{x}_{p}),\boldsymbol{\alpha}_{t}^{m}(\mathbf{x}_{p}))," display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><mtext id="S3.E5.m1.1.1.1.1.3.5" xref="S3.E5.m1.1.1.1.1.3.5a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.4" xref="S3.E5.m1.1.1.1.1.3.4.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.4.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.3.3.3.4" xref="S3.E5.m1.1.1.1.1.3.3.4.cmml">(</mo><msubsup id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msubsup><mo id="S3.E5.m1.1.1.1.1.3.3.3.5" xref="S3.E5.m1.1.1.1.1.3.3.4.cmml">,</mo><msubsup id="S3.E5.m1.1.1.1.1.2.2.2.2" xref="S3.E5.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2.2.cmml">𝐜</mi><mi id="S3.E5.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2.3.cmml">t</mi><mi id="S3.E5.m1.1.1.1.1.2.2.2.2.3" xref="S3.E5.m1.1.1.1.1.2.2.2.2.3.cmml">m</mi></msubsup><mo id="S3.E5.m1.1.1.1.1.3.3.3.6" xref="S3.E5.m1.1.1.1.1.3.3.4.cmml">;</mo><msub id="S3.E5.m1.1.1.1.1.3.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.3.3.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.3.3.2.cmml">𝒟</mi><mi id="S3.E5.m1.1.1.1.1.3.3.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.3.3.cmml">p</mi></msub><mo stretchy="false" id="S3.E5.m1.1.1.1.1.3.3.3.7" xref="S3.E5.m1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.1.1.1.1.10" xref="S3.E5.m1.1.1.1.1.10.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.6" xref="S3.E5.m1.1.1.1.1.6.cmml"><mtext id="S3.E5.m1.1.1.1.1.6.5" xref="S3.E5.m1.1.1.1.1.6.5a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.6.4" xref="S3.E5.m1.1.1.1.1.6.4.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.6.3.3" xref="S3.E5.m1.1.1.1.1.6.3.4.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.6.3.3.4" xref="S3.E5.m1.1.1.1.1.6.3.4.cmml">(</mo><msubsup id="S3.E5.m1.1.1.1.1.4.1.1.1" xref="S3.E5.m1.1.1.1.1.4.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.4.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.4.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.E5.m1.1.1.1.1.4.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.4.1.1.1.2.3.cmml">t</mi><mi id="S3.E5.m1.1.1.1.1.4.1.1.1.3" xref="S3.E5.m1.1.1.1.1.4.1.1.1.3.cmml">n</mi></msubsup><mo id="S3.E5.m1.1.1.1.1.6.3.3.5" xref="S3.E5.m1.1.1.1.1.6.3.4.cmml">,</mo><msubsup id="S3.E5.m1.1.1.1.1.5.2.2.2" xref="S3.E5.m1.1.1.1.1.5.2.2.2.cmml"><mover accent="true" id="S3.E5.m1.1.1.1.1.5.2.2.2.2.2" xref="S3.E5.m1.1.1.1.1.5.2.2.2.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1.5.2.2.2.2.2.2" xref="S3.E5.m1.1.1.1.1.5.2.2.2.2.2.2.cmml">𝐜</mi><mo id="S3.E5.m1.1.1.1.1.5.2.2.2.2.2.1" xref="S3.E5.m1.1.1.1.1.5.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S3.E5.m1.1.1.1.1.5.2.2.2.2.3" xref="S3.E5.m1.1.1.1.1.5.2.2.2.2.3.cmml">t</mi><mi id="S3.E5.m1.1.1.1.1.5.2.2.2.3" xref="S3.E5.m1.1.1.1.1.5.2.2.2.3.cmml">m</mi></msubsup><mo id="S3.E5.m1.1.1.1.1.6.3.3.6" xref="S3.E5.m1.1.1.1.1.6.3.4.cmml">;</mo><msub id="S3.E5.m1.1.1.1.1.6.3.3.3" xref="S3.E5.m1.1.1.1.1.6.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.6.3.3.3.2" xref="S3.E5.m1.1.1.1.1.6.3.3.3.2.cmml">𝒟</mi><mi id="S3.E5.m1.1.1.1.1.6.3.3.3.3" xref="S3.E5.m1.1.1.1.1.6.3.3.3.3.cmml">p</mi></msub><mo stretchy="false" id="S3.E5.m1.1.1.1.1.6.3.3.7" xref="S3.E5.m1.1.1.1.1.6.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.1.1.1.1.11" xref="S3.E5.m1.1.1.1.1.11.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.8" xref="S3.E5.m1.1.1.1.1.8.cmml"><mfrac id="S3.E5.m1.1.1.1.1.8.4" xref="S3.E5.m1.1.1.1.1.8.4.cmml"><mn id="S3.E5.m1.1.1.1.1.8.4.2" xref="S3.E5.m1.1.1.1.1.8.4.2.cmml">1</mn><mi id="S3.E5.m1.1.1.1.1.8.4.3" xref="S3.E5.m1.1.1.1.1.8.4.3.cmml">P</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.8.3" xref="S3.E5.m1.1.1.1.1.8.3.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.8.2" xref="S3.E5.m1.1.1.1.1.8.2.cmml"><munderover id="S3.E5.m1.1.1.1.1.8.2.3" xref="S3.E5.m1.1.1.1.1.8.2.3.cmml"><mo movablelimits="false" id="S3.E5.m1.1.1.1.1.8.2.3.2.2" xref="S3.E5.m1.1.1.1.1.8.2.3.2.2.cmml">∑</mo><mrow id="S3.E5.m1.1.1.1.1.8.2.3.2.3" xref="S3.E5.m1.1.1.1.1.8.2.3.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.8.2.3.2.3.2" xref="S3.E5.m1.1.1.1.1.8.2.3.2.3.2.cmml">p</mi><mo id="S3.E5.m1.1.1.1.1.8.2.3.2.3.1" xref="S3.E5.m1.1.1.1.1.8.2.3.2.3.1.cmml">=</mo><mn id="S3.E5.m1.1.1.1.1.8.2.3.2.3.3" xref="S3.E5.m1.1.1.1.1.8.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.1.1.1.1.8.2.3.3" xref="S3.E5.m1.1.1.1.1.8.2.3.3.cmml">P</mi></munderover><mrow id="S3.E5.m1.1.1.1.1.8.2.2" xref="S3.E5.m1.1.1.1.1.8.2.2.cmml"><mtext id="S3.E5.m1.1.1.1.1.8.2.2.4" xref="S3.E5.m1.1.1.1.1.8.2.2.4a.cmml">cos</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.8.2.2.3" xref="S3.E5.m1.1.1.1.1.8.2.2.3.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.8.2.2.2.2" xref="S3.E5.m1.1.1.1.1.8.2.2.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.8.2.2.2.2.3" xref="S3.E5.m1.1.1.1.1.8.2.2.2.3.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.cmml"><msubsup id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.2.2.cmml">𝜶</mi><mi id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.2.3.cmml">t</mi><mi id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.3.cmml">p</mi></msub><mo stretchy="false" id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.1.1.1.1.8.2.2.2.2.4" xref="S3.E5.m1.1.1.1.1.8.2.2.2.3.cmml">,</mo><mrow id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.cmml"><msubsup id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.2.2" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.2.2.cmml">𝜶</mi><mi id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.2.3" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.2.3.cmml">t</mi><mi id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.3" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.3.cmml">m</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.2" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.2" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.2" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.2.cmml">𝐱</mi><mi id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.3" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.3.cmml">p</mi></msub><mo stretchy="false" id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.3" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E5.m1.1.1.1.1.8.2.2.2.2.5" xref="S3.E5.m1.1.1.1.1.8.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><and id="S3.E5.m1.1.1.1.1a.cmml" xref="S3.E5.m1.1.1.1"></and><apply id="S3.E5.m1.1.1.1.1b.cmml" xref="S3.E5.m1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.10.cmml" xref="S3.E5.m1.1.1.1.1.10"></eq><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><times id="S3.E5.m1.1.1.1.1.3.4.cmml" xref="S3.E5.m1.1.1.1.1.3.4"></times><ci id="S3.E5.m1.1.1.1.1.3.5a.cmml" xref="S3.E5.m1.1.1.1.1.3.5"><mtext id="S3.E5.m1.1.1.1.1.3.5.cmml" xref="S3.E5.m1.1.1.1.1.3.5">sim</mtext></ci><vector id="S3.E5.m1.1.1.1.1.3.3.4.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3"><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S3.E5.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2.2">𝐜</ci><ci id="S3.E5.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E5.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2.3">𝑚</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3.2">𝒟</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3.3">𝑝</ci></apply></vector></apply><apply id="S3.E5.m1.1.1.1.1.6.cmml" xref="S3.E5.m1.1.1.1.1.6"><times id="S3.E5.m1.1.1.1.1.6.4.cmml" xref="S3.E5.m1.1.1.1.1.6.4"></times><ci id="S3.E5.m1.1.1.1.1.6.5a.cmml" xref="S3.E5.m1.1.1.1.1.6.5"><mtext id="S3.E5.m1.1.1.1.1.6.5.cmml" xref="S3.E5.m1.1.1.1.1.6.5">sim</mtext></ci><vector id="S3.E5.m1.1.1.1.1.6.3.4.cmml" xref="S3.E5.m1.1.1.1.1.6.3.3"><apply id="S3.E5.m1.1.1.1.1.4.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.4.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.4.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.4.1.1.1">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.4.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.4.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.4.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.4.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.4.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.4.1.1.1.2.2">𝐰</ci><ci id="S3.E5.m1.1.1.1.1.4.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.4.1.1.1.2.3">𝑡</ci></apply><ci id="S3.E5.m1.1.1.1.1.4.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.4.1.1.1.3">𝑛</ci></apply><apply id="S3.E5.m1.1.1.1.1.5.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.5.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.5.2.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.5.2.2.2">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.5.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.5.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.5.2.2.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.5.2.2.2">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.5.2.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.5.2.2.2.2.2"><ci id="S3.E5.m1.1.1.1.1.5.2.2.2.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.5.2.2.2.2.2.1">~</ci><ci id="S3.E5.m1.1.1.1.1.5.2.2.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.5.2.2.2.2.2.2">𝐜</ci></apply><ci id="S3.E5.m1.1.1.1.1.5.2.2.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.5.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E5.m1.1.1.1.1.5.2.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.5.2.2.2.3">𝑚</ci></apply><apply id="S3.E5.m1.1.1.1.1.6.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.6.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.6.3.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.6.3.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.6.3.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.6.3.3.3.2">𝒟</ci><ci id="S3.E5.m1.1.1.1.1.6.3.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.6.3.3.3.3">𝑝</ci></apply></vector></apply></apply><apply id="S3.E5.m1.1.1.1.1c.cmml" xref="S3.E5.m1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.11.cmml" xref="S3.E5.m1.1.1.1.1.11"></eq><share href="#S3.E5.m1.1.1.1.1.6.cmml" id="S3.E5.m1.1.1.1.1d.cmml" xref="S3.E5.m1.1.1.1"></share><apply id="S3.E5.m1.1.1.1.1.8.cmml" xref="S3.E5.m1.1.1.1.1.8"><times id="S3.E5.m1.1.1.1.1.8.3.cmml" xref="S3.E5.m1.1.1.1.1.8.3"></times><apply id="S3.E5.m1.1.1.1.1.8.4.cmml" xref="S3.E5.m1.1.1.1.1.8.4"><divide id="S3.E5.m1.1.1.1.1.8.4.1.cmml" xref="S3.E5.m1.1.1.1.1.8.4"></divide><cn type="integer" id="S3.E5.m1.1.1.1.1.8.4.2.cmml" xref="S3.E5.m1.1.1.1.1.8.4.2">1</cn><ci id="S3.E5.m1.1.1.1.1.8.4.3.cmml" xref="S3.E5.m1.1.1.1.1.8.4.3">𝑃</ci></apply><apply id="S3.E5.m1.1.1.1.1.8.2.cmml" xref="S3.E5.m1.1.1.1.1.8.2"><apply id="S3.E5.m1.1.1.1.1.8.2.3.cmml" xref="S3.E5.m1.1.1.1.1.8.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.8.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.8.2.3">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.8.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.8.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.8.2.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.8.2.3">subscript</csymbol><sum id="S3.E5.m1.1.1.1.1.8.2.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.8.2.3.2.2"></sum><apply id="S3.E5.m1.1.1.1.1.8.2.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.8.2.3.2.3"><eq id="S3.E5.m1.1.1.1.1.8.2.3.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.8.2.3.2.3.1"></eq><ci id="S3.E5.m1.1.1.1.1.8.2.3.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.8.2.3.2.3.2">𝑝</ci><cn type="integer" id="S3.E5.m1.1.1.1.1.8.2.3.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.8.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.1.1.1.1.8.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.8.2.3.3">𝑃</ci></apply><apply id="S3.E5.m1.1.1.1.1.8.2.2.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2"><times id="S3.E5.m1.1.1.1.1.8.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.3"></times><ci id="S3.E5.m1.1.1.1.1.8.2.2.4a.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.4"><mtext id="S3.E5.m1.1.1.1.1.8.2.2.4.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.4">cos</mtext></ci><interval closure="open" id="S3.E5.m1.1.1.1.1.8.2.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2"><apply id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.2"></times><apply id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.2.2">𝜶</ci><ci id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.7.1.1.1.1.1.1.1.1.3">𝑝</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2"><times id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.2"></times><apply id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.2.2">𝜶</ci><ci id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.2.3">𝑡</ci></apply><ci id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.3.3">𝑚</ci></apply><apply id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.2">𝐱</ci><ci id="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.8.2.2.2.2.2.1.1.1.3">𝑝</ci></apply></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\text{sim}({\mathbf{w}}_{t}^{n},\mathbf{c}_{t}^{m};\mathcal{D}_{p})=\text{sim}({\mathbf{w}}_{t}^{n},\tilde{\mathbf{c}}_{t}^{m};\mathcal{D}_{p})=\frac{1}{P}\sum_{p=1}^{P}\text{cos}(\boldsymbol{\alpha}_{t}^{n}(\mathbf{x}_{p}),\boldsymbol{\alpha}_{t}^{m}(\mathbf{x}_{p})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS3.p3.16" class="ltx_p">where <math id="S3.SS1.SSS3.p3.3.m1.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.SS1.SSS3.p3.3.m1.1a"><mi id="S3.SS1.SSS3.p3.3.m1.1.1" xref="S3.SS1.SSS3.p3.3.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.3.m1.1b"><ci id="S3.SS1.SSS3.p3.3.m1.1.1.cmml" xref="S3.SS1.SSS3.p3.3.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.3.m1.1c">P</annotation></semantics></math> denotes the number of data in the public dataset <math id="S3.SS1.SSS3.p3.4.m2.1" class="ltx_Math" alttext="\mathcal{D}_{p}" display="inline"><semantics id="S3.SS1.SSS3.p3.4.m2.1a"><msub id="S3.SS1.SSS3.p3.4.m2.1.1" xref="S3.SS1.SSS3.p3.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p3.4.m2.1.1.2" xref="S3.SS1.SSS3.p3.4.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.SSS3.p3.4.m2.1.1.3" xref="S3.SS1.SSS3.p3.4.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.4.m2.1b"><apply id="S3.SS1.SSS3.p3.4.m2.1.1.cmml" xref="S3.SS1.SSS3.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.4.m2.1.1.1.cmml" xref="S3.SS1.SSS3.p3.4.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.4.m2.1.1.2.cmml" xref="S3.SS1.SSS3.p3.4.m2.1.1.2">𝒟</ci><ci id="S3.SS1.SSS3.p3.4.m2.1.1.3.cmml" xref="S3.SS1.SSS3.p3.4.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.4.m2.1c">\mathcal{D}_{p}</annotation></semantics></math> and <math id="S3.SS1.SSS3.p3.5.m3.1" class="ltx_Math" alttext="\mathbf{x}_{p}" display="inline"><semantics id="S3.SS1.SSS3.p3.5.m3.1a"><msub id="S3.SS1.SSS3.p3.5.m3.1.1" xref="S3.SS1.SSS3.p3.5.m3.1.1.cmml"><mi id="S3.SS1.SSS3.p3.5.m3.1.1.2" xref="S3.SS1.SSS3.p3.5.m3.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.SSS3.p3.5.m3.1.1.3" xref="S3.SS1.SSS3.p3.5.m3.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.5.m3.1b"><apply id="S3.SS1.SSS3.p3.5.m3.1.1.cmml" xref="S3.SS1.SSS3.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.5.m3.1.1.1.cmml" xref="S3.SS1.SSS3.p3.5.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.5.m3.1.1.2.cmml" xref="S3.SS1.SSS3.p3.5.m3.1.1.2">𝐱</ci><ci id="S3.SS1.SSS3.p3.5.m3.1.1.3.cmml" xref="S3.SS1.SSS3.p3.5.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.5.m3.1c">\mathbf{x}_{p}</annotation></semantics></math> is the <math id="S3.SS1.SSS3.p3.6.m4.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS1.SSS3.p3.6.m4.1a"><mi id="S3.SS1.SSS3.p3.6.m4.1.1" xref="S3.SS1.SSS3.p3.6.m4.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.6.m4.1b"><ci id="S3.SS1.SSS3.p3.6.m4.1.1.cmml" xref="S3.SS1.SSS3.p3.6.m4.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.6.m4.1c">p</annotation></semantics></math>-th data in <math id="S3.SS1.SSS3.p3.7.m5.1" class="ltx_Math" alttext="\mathcal{D}_{p}" display="inline"><semantics id="S3.SS1.SSS3.p3.7.m5.1a"><msub id="S3.SS1.SSS3.p3.7.m5.1.1" xref="S3.SS1.SSS3.p3.7.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p3.7.m5.1.1.2" xref="S3.SS1.SSS3.p3.7.m5.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.SSS3.p3.7.m5.1.1.3" xref="S3.SS1.SSS3.p3.7.m5.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.7.m5.1b"><apply id="S3.SS1.SSS3.p3.7.m5.1.1.cmml" xref="S3.SS1.SSS3.p3.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.7.m5.1.1.1.cmml" xref="S3.SS1.SSS3.p3.7.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.7.m5.1.1.2.cmml" xref="S3.SS1.SSS3.p3.7.m5.1.1.2">𝒟</ci><ci id="S3.SS1.SSS3.p3.7.m5.1.1.3.cmml" xref="S3.SS1.SSS3.p3.7.m5.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.7.m5.1c">\mathcal{D}_{p}</annotation></semantics></math>. <math id="S3.SS1.SSS3.p3.8.m6.1" class="ltx_Math" alttext="\boldsymbol{\alpha}_{t}^{n}(\mathbf{x}_{p})" display="inline"><semantics id="S3.SS1.SSS3.p3.8.m6.1a"><mrow id="S3.SS1.SSS3.p3.8.m6.1.1" xref="S3.SS1.SSS3.p3.8.m6.1.1.cmml"><msubsup id="S3.SS1.SSS3.p3.8.m6.1.1.3" xref="S3.SS1.SSS3.p3.8.m6.1.1.3.cmml"><mi id="S3.SS1.SSS3.p3.8.m6.1.1.3.2.2" xref="S3.SS1.SSS3.p3.8.m6.1.1.3.2.2.cmml">𝜶</mi><mi id="S3.SS1.SSS3.p3.8.m6.1.1.3.2.3" xref="S3.SS1.SSS3.p3.8.m6.1.1.3.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p3.8.m6.1.1.3.3" xref="S3.SS1.SSS3.p3.8.m6.1.1.3.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p3.8.m6.1.1.2" xref="S3.SS1.SSS3.p3.8.m6.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS3.p3.8.m6.1.1.1.1" xref="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p3.8.m6.1.1.1.1.2" xref="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1" xref="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.2" xref="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.3" xref="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.3.cmml">p</mi></msub><mo stretchy="false" id="S3.SS1.SSS3.p3.8.m6.1.1.1.1.3" xref="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.8.m6.1b"><apply id="S3.SS1.SSS3.p3.8.m6.1.1.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1"><times id="S3.SS1.SSS3.p3.8.m6.1.1.2.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1.2"></times><apply id="S3.SS1.SSS3.p3.8.m6.1.1.3.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.8.m6.1.1.3.1.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1.3">superscript</csymbol><apply id="S3.SS1.SSS3.p3.8.m6.1.1.3.2.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.8.m6.1.1.3.2.1.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS3.p3.8.m6.1.1.3.2.2.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1.3.2.2">𝜶</ci><ci id="S3.SS1.SSS3.p3.8.m6.1.1.3.2.3.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1.3.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p3.8.m6.1.1.3.3.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1.3.3">𝑛</ci></apply><apply id="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p3.8.m6.1.1.1.1.1.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.8.m6.1c">\boldsymbol{\alpha}_{t}^{n}(\mathbf{x}_{p})</annotation></semantics></math> and <math id="S3.SS1.SSS3.p3.9.m7.1" class="ltx_Math" alttext="\boldsymbol{\alpha}_{t}^{m}(\mathbf{x}_{p})" display="inline"><semantics id="S3.SS1.SSS3.p3.9.m7.1a"><mrow id="S3.SS1.SSS3.p3.9.m7.1.1" xref="S3.SS1.SSS3.p3.9.m7.1.1.cmml"><msubsup id="S3.SS1.SSS3.p3.9.m7.1.1.3" xref="S3.SS1.SSS3.p3.9.m7.1.1.3.cmml"><mi id="S3.SS1.SSS3.p3.9.m7.1.1.3.2.2" xref="S3.SS1.SSS3.p3.9.m7.1.1.3.2.2.cmml">𝜶</mi><mi id="S3.SS1.SSS3.p3.9.m7.1.1.3.2.3" xref="S3.SS1.SSS3.p3.9.m7.1.1.3.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p3.9.m7.1.1.3.3" xref="S3.SS1.SSS3.p3.9.m7.1.1.3.3.cmml">m</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS1.SSS3.p3.9.m7.1.1.2" xref="S3.SS1.SSS3.p3.9.m7.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS3.p3.9.m7.1.1.1.1" xref="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS3.p3.9.m7.1.1.1.1.2" xref="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1" xref="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.2" xref="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.3" xref="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.3.cmml">p</mi></msub><mo stretchy="false" id="S3.SS1.SSS3.p3.9.m7.1.1.1.1.3" xref="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.9.m7.1b"><apply id="S3.SS1.SSS3.p3.9.m7.1.1.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1"><times id="S3.SS1.SSS3.p3.9.m7.1.1.2.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1.2"></times><apply id="S3.SS1.SSS3.p3.9.m7.1.1.3.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.9.m7.1.1.3.1.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1.3">superscript</csymbol><apply id="S3.SS1.SSS3.p3.9.m7.1.1.3.2.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.9.m7.1.1.3.2.1.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS3.p3.9.m7.1.1.3.2.2.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1.3.2.2">𝜶</ci><ci id="S3.SS1.SSS3.p3.9.m7.1.1.3.2.3.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1.3.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p3.9.m7.1.1.3.3.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1.3.3">𝑚</ci></apply><apply id="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS3.p3.9.m7.1.1.1.1.1.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.9.m7.1c">\boldsymbol{\alpha}_{t}^{m}(\mathbf{x}_{p})</annotation></semantics></math> are the logits output from models <math id="S3.SS1.SSS3.p3.10.m8.1" class="ltx_Math" alttext="\mathbf{w}_{t}^{n}" display="inline"><semantics id="S3.SS1.SSS3.p3.10.m8.1a"><msubsup id="S3.SS1.SSS3.p3.10.m8.1.1" xref="S3.SS1.SSS3.p3.10.m8.1.1.cmml"><mi id="S3.SS1.SSS3.p3.10.m8.1.1.2.2" xref="S3.SS1.SSS3.p3.10.m8.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.SSS3.p3.10.m8.1.1.2.3" xref="S3.SS1.SSS3.p3.10.m8.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p3.10.m8.1.1.3" xref="S3.SS1.SSS3.p3.10.m8.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.10.m8.1b"><apply id="S3.SS1.SSS3.p3.10.m8.1.1.cmml" xref="S3.SS1.SSS3.p3.10.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.10.m8.1.1.1.cmml" xref="S3.SS1.SSS3.p3.10.m8.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p3.10.m8.1.1.2.cmml" xref="S3.SS1.SSS3.p3.10.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.10.m8.1.1.2.1.cmml" xref="S3.SS1.SSS3.p3.10.m8.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.10.m8.1.1.2.2.cmml" xref="S3.SS1.SSS3.p3.10.m8.1.1.2.2">𝐰</ci><ci id="S3.SS1.SSS3.p3.10.m8.1.1.2.3.cmml" xref="S3.SS1.SSS3.p3.10.m8.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p3.10.m8.1.1.3.cmml" xref="S3.SS1.SSS3.p3.10.m8.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.10.m8.1c">\mathbf{w}_{t}^{n}</annotation></semantics></math> and <math id="S3.SS1.SSS3.p3.11.m9.1" class="ltx_Math" alttext="\tilde{\mathbf{c}}_{t}^{m}" display="inline"><semantics id="S3.SS1.SSS3.p3.11.m9.1a"><msubsup id="S3.SS1.SSS3.p3.11.m9.1.1" xref="S3.SS1.SSS3.p3.11.m9.1.1.cmml"><mover accent="true" id="S3.SS1.SSS3.p3.11.m9.1.1.2.2" xref="S3.SS1.SSS3.p3.11.m9.1.1.2.2.cmml"><mi id="S3.SS1.SSS3.p3.11.m9.1.1.2.2.2" xref="S3.SS1.SSS3.p3.11.m9.1.1.2.2.2.cmml">𝐜</mi><mo id="S3.SS1.SSS3.p3.11.m9.1.1.2.2.1" xref="S3.SS1.SSS3.p3.11.m9.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS1.SSS3.p3.11.m9.1.1.2.3" xref="S3.SS1.SSS3.p3.11.m9.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p3.11.m9.1.1.3" xref="S3.SS1.SSS3.p3.11.m9.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.11.m9.1b"><apply id="S3.SS1.SSS3.p3.11.m9.1.1.cmml" xref="S3.SS1.SSS3.p3.11.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.11.m9.1.1.1.cmml" xref="S3.SS1.SSS3.p3.11.m9.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p3.11.m9.1.1.2.cmml" xref="S3.SS1.SSS3.p3.11.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.11.m9.1.1.2.1.cmml" xref="S3.SS1.SSS3.p3.11.m9.1.1">subscript</csymbol><apply id="S3.SS1.SSS3.p3.11.m9.1.1.2.2.cmml" xref="S3.SS1.SSS3.p3.11.m9.1.1.2.2"><ci id="S3.SS1.SSS3.p3.11.m9.1.1.2.2.1.cmml" xref="S3.SS1.SSS3.p3.11.m9.1.1.2.2.1">~</ci><ci id="S3.SS1.SSS3.p3.11.m9.1.1.2.2.2.cmml" xref="S3.SS1.SSS3.p3.11.m9.1.1.2.2.2">𝐜</ci></apply><ci id="S3.SS1.SSS3.p3.11.m9.1.1.2.3.cmml" xref="S3.SS1.SSS3.p3.11.m9.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p3.11.m9.1.1.3.cmml" xref="S3.SS1.SSS3.p3.11.m9.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.11.m9.1c">\tilde{\mathbf{c}}_{t}^{m}</annotation></semantics></math>, respectively.
To obtain the logits, we need to finetune <math id="S3.SS1.SSS3.p3.12.m10.1" class="ltx_Math" alttext="\mathbf{w}_{t}^{n}" display="inline"><semantics id="S3.SS1.SSS3.p3.12.m10.1a"><msubsup id="S3.SS1.SSS3.p3.12.m10.1.1" xref="S3.SS1.SSS3.p3.12.m10.1.1.cmml"><mi id="S3.SS1.SSS3.p3.12.m10.1.1.2.2" xref="S3.SS1.SSS3.p3.12.m10.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS1.SSS3.p3.12.m10.1.1.2.3" xref="S3.SS1.SSS3.p3.12.m10.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p3.12.m10.1.1.3" xref="S3.SS1.SSS3.p3.12.m10.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.12.m10.1b"><apply id="S3.SS1.SSS3.p3.12.m10.1.1.cmml" xref="S3.SS1.SSS3.p3.12.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.12.m10.1.1.1.cmml" xref="S3.SS1.SSS3.p3.12.m10.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p3.12.m10.1.1.2.cmml" xref="S3.SS1.SSS3.p3.12.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.12.m10.1.1.2.1.cmml" xref="S3.SS1.SSS3.p3.12.m10.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.12.m10.1.1.2.2.cmml" xref="S3.SS1.SSS3.p3.12.m10.1.1.2.2">𝐰</ci><ci id="S3.SS1.SSS3.p3.12.m10.1.1.2.3.cmml" xref="S3.SS1.SSS3.p3.12.m10.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p3.12.m10.1.1.3.cmml" xref="S3.SS1.SSS3.p3.12.m10.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.12.m10.1c">\mathbf{w}_{t}^{n}</annotation></semantics></math> and <math id="S3.SS1.SSS3.p3.13.m11.1" class="ltx_Math" alttext="\tilde{\mathbf{c}}_{t}^{m}" display="inline"><semantics id="S3.SS1.SSS3.p3.13.m11.1a"><msubsup id="S3.SS1.SSS3.p3.13.m11.1.1" xref="S3.SS1.SSS3.p3.13.m11.1.1.cmml"><mover accent="true" id="S3.SS1.SSS3.p3.13.m11.1.1.2.2" xref="S3.SS1.SSS3.p3.13.m11.1.1.2.2.cmml"><mi id="S3.SS1.SSS3.p3.13.m11.1.1.2.2.2" xref="S3.SS1.SSS3.p3.13.m11.1.1.2.2.2.cmml">𝐜</mi><mo id="S3.SS1.SSS3.p3.13.m11.1.1.2.2.1" xref="S3.SS1.SSS3.p3.13.m11.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS1.SSS3.p3.13.m11.1.1.2.3" xref="S3.SS1.SSS3.p3.13.m11.1.1.2.3.cmml">t</mi><mi id="S3.SS1.SSS3.p3.13.m11.1.1.3" xref="S3.SS1.SSS3.p3.13.m11.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.13.m11.1b"><apply id="S3.SS1.SSS3.p3.13.m11.1.1.cmml" xref="S3.SS1.SSS3.p3.13.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.13.m11.1.1.1.cmml" xref="S3.SS1.SSS3.p3.13.m11.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p3.13.m11.1.1.2.cmml" xref="S3.SS1.SSS3.p3.13.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.13.m11.1.1.2.1.cmml" xref="S3.SS1.SSS3.p3.13.m11.1.1">subscript</csymbol><apply id="S3.SS1.SSS3.p3.13.m11.1.1.2.2.cmml" xref="S3.SS1.SSS3.p3.13.m11.1.1.2.2"><ci id="S3.SS1.SSS3.p3.13.m11.1.1.2.2.1.cmml" xref="S3.SS1.SSS3.p3.13.m11.1.1.2.2.1">~</ci><ci id="S3.SS1.SSS3.p3.13.m11.1.1.2.2.2.cmml" xref="S3.SS1.SSS3.p3.13.m11.1.1.2.2.2">𝐜</ci></apply><ci id="S3.SS1.SSS3.p3.13.m11.1.1.2.3.cmml" xref="S3.SS1.SSS3.p3.13.m11.1.1.2.3">𝑡</ci></apply><ci id="S3.SS1.SSS3.p3.13.m11.1.1.3.cmml" xref="S3.SS1.SSS3.p3.13.m11.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.13.m11.1c">\tilde{\mathbf{c}}_{t}^{m}</annotation></semantics></math> using <math id="S3.SS1.SSS3.p3.14.m12.1" class="ltx_Math" alttext="\mathcal{D}_{p}" display="inline"><semantics id="S3.SS1.SSS3.p3.14.m12.1a"><msub id="S3.SS1.SSS3.p3.14.m12.1.1" xref="S3.SS1.SSS3.p3.14.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p3.14.m12.1.1.2" xref="S3.SS1.SSS3.p3.14.m12.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.SSS3.p3.14.m12.1.1.3" xref="S3.SS1.SSS3.p3.14.m12.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.14.m12.1b"><apply id="S3.SS1.SSS3.p3.14.m12.1.1.cmml" xref="S3.SS1.SSS3.p3.14.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.14.m12.1.1.1.cmml" xref="S3.SS1.SSS3.p3.14.m12.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.14.m12.1.1.2.cmml" xref="S3.SS1.SSS3.p3.14.m12.1.1.2">𝒟</ci><ci id="S3.SS1.SSS3.p3.14.m12.1.1.3.cmml" xref="S3.SS1.SSS3.p3.14.m12.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.14.m12.1c">\mathcal{D}_{p}</annotation></semantics></math> first. In our design, we can use both labeled and unlabeled data to finetune models but with different loss functions.
If <math id="S3.SS1.SSS3.p3.15.m13.1" class="ltx_Math" alttext="\mathcal{D}_{p}" display="inline"><semantics id="S3.SS1.SSS3.p3.15.m13.1a"><msub id="S3.SS1.SSS3.p3.15.m13.1.1" xref="S3.SS1.SSS3.p3.15.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p3.15.m13.1.1.2" xref="S3.SS1.SSS3.p3.15.m13.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.SSS3.p3.15.m13.1.1.3" xref="S3.SS1.SSS3.p3.15.m13.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.15.m13.1b"><apply id="S3.SS1.SSS3.p3.15.m13.1.1.cmml" xref="S3.SS1.SSS3.p3.15.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.15.m13.1.1.1.cmml" xref="S3.SS1.SSS3.p3.15.m13.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.15.m13.1.1.2.cmml" xref="S3.SS1.SSS3.p3.15.m13.1.1.2">𝒟</ci><ci id="S3.SS1.SSS3.p3.15.m13.1.1.3.cmml" xref="S3.SS1.SSS3.p3.15.m13.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.15.m13.1c">\mathcal{D}_{p}</annotation></semantics></math> is <span id="S3.SS1.SSS3.p3.16.1" class="ltx_text ltx_font_bold">labeled</span>, then we use the supervised cross-entropy (CE) loss to finetune the model.
If <math id="S3.SS1.SSS3.p3.16.m14.1" class="ltx_Math" alttext="\mathcal{D}_{p}" display="inline"><semantics id="S3.SS1.SSS3.p3.16.m14.1a"><msub id="S3.SS1.SSS3.p3.16.m14.1.1" xref="S3.SS1.SSS3.p3.16.m14.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p3.16.m14.1.1.2" xref="S3.SS1.SSS3.p3.16.m14.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.SSS3.p3.16.m14.1.1.3" xref="S3.SS1.SSS3.p3.16.m14.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p3.16.m14.1b"><apply id="S3.SS1.SSS3.p3.16.m14.1.1.cmml" xref="S3.SS1.SSS3.p3.16.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p3.16.m14.1.1.1.cmml" xref="S3.SS1.SSS3.p3.16.m14.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p3.16.m14.1.1.2.cmml" xref="S3.SS1.SSS3.p3.16.m14.1.1.2">𝒟</ci><ci id="S3.SS1.SSS3.p3.16.m14.1.1.3.cmml" xref="S3.SS1.SSS3.p3.16.m14.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p3.16.m14.1c">\mathcal{D}_{p}</annotation></semantics></math> is <span id="S3.SS1.SSS3.p3.16.2" class="ltx_text ltx_font_bold">unlabeled</span>, then we apply the self-supervised contrastive loss to finetune them following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Client Update</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.7" class="ltx_p">The obtained personalized model <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\hat{\mathbf{w}}_{t}^{n}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msubsup id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mover accent="true" id="S3.SS2.p1.1.m1.1.1.2.2" xref="S3.SS2.p1.1.m1.1.1.2.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2.2.2" xref="S3.SS2.p1.1.m1.1.1.2.2.2.cmml">𝐰</mi><mo id="S3.SS2.p1.1.m1.1.1.2.2.1" xref="S3.SS2.p1.1.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p1.1.m1.1.1.2.3" xref="S3.SS2.p1.1.m1.1.1.2.3.cmml">t</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">superscript</csymbol><apply id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2"><ci id="S3.SS2.p1.1.m1.1.1.2.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2.1">^</ci><ci id="S3.SS2.p1.1.m1.1.1.2.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2.2">𝐰</ci></apply><ci id="S3.SS2.p1.1.m1.1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\hat{\mathbf{w}}_{t}^{n}</annotation></semantics></math> (i.e., <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{c}_{t}^{*}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msubsup id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml">𝐜</mi><mi id="S3.SS2.p1.2.m2.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.2.3.cmml">t</mi><mo id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">𝐜</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3">𝑡</ci></apply><times id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathbf{c}_{t}^{*}</annotation></semantics></math> in Eq. (<a href="#S3.E2" title="In 3.1.1 Similarity-based Model Matching ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>)) will be distributed to the <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">n</annotation></semantics></math>-th client if it is selected in the next communication round <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="t+1" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">t</mi><mo id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">+</mo><mn id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><plus id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"></plus><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑡</ci><cn type="integer" id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">t+1</annotation></semantics></math>. <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\hat{\mathbf{w}}_{t}^{n}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><msubsup id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mover accent="true" id="S3.SS2.p1.5.m5.1.1.2.2" xref="S3.SS2.p1.5.m5.1.1.2.2.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2.2.2" xref="S3.SS2.p1.5.m5.1.1.2.2.2.cmml">𝐰</mi><mo id="S3.SS2.p1.5.m5.1.1.2.2.1" xref="S3.SS2.p1.5.m5.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p1.5.m5.1.1.2.3" xref="S3.SS2.p1.5.m5.1.1.2.3.cmml">t</mi><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">superscript</csymbol><apply id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2"><ci id="S3.SS2.p1.5.m5.1.1.2.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2.1">^</ci><ci id="S3.SS2.p1.5.m5.1.1.2.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2.2">𝐰</ci></apply><ci id="S3.SS2.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\hat{\mathbf{w}}_{t}^{n}</annotation></semantics></math> is a reassembled model that carries external knowledge from other clients, but its network structure is different from the original <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mathbf{w}_{t}^{n}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msubsup id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2.2" xref="S3.SS2.p1.6.m6.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS2.p1.6.m6.1.1.2.3" xref="S3.SS2.p1.6.m6.1.1.2.3.cmml">t</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">superscript</csymbol><apply id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2.2">𝐰</ci><ci id="S3.SS2.p1.6.m6.1.1.2.3.cmml" xref="S3.SS2.p1.6.m6.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathbf{w}_{t}^{n}</annotation></semantics></math>. To incorporate the new knowledge without training <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\mathbf{w}_{t}^{n}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><msubsup id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2.2" xref="S3.SS2.p1.7.m7.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS2.p1.7.m7.1.1.2.3" xref="S3.SS2.p1.7.m7.1.1.2.3.cmml">t</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">superscript</csymbol><apply id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.2.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2.2">𝐰</ci><ci id="S3.SS2.p1.7.m7.1.1.2.3.cmml" xref="S3.SS2.p1.7.m7.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\mathbf{w}_{t}^{n}</annotation></semantics></math> from scratch, we propose to apply knowledge distillation on the client following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.3" class="ltx_p">Let <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{n}=\{(\mathbf{x}_{i}^{n},\mathbf{y}_{i}^{n})\}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><msub id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">𝒟</mi><mi id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">n</mi></msub><mo id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">=</mo><mrow id="S3.SS2.p2.1.m1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.2.cmml">{</mo><mrow id="S3.SS2.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.1.1.1.1.1.2.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.2.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.3.cmml">n</mi></msubsup><mo id="S3.SS2.p2.1.m1.1.1.1.1.1.2.4" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.2.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.2.2.cmml">𝐲</mi><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.2.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.SS2.p2.1.m1.1.1.1.1.1.2.5" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS2.p2.1.m1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><eq id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2"></eq><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">𝒟</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">𝑛</ci></apply><set id="S3.SS2.p2.1.m1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1"><interval closure="open" id="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2"><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.2.2">𝐲</ci><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.2.3">𝑛</ci></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathcal{D}_{n}=\{(\mathbf{x}_{i}^{n},\mathbf{y}_{i}^{n})\}</annotation></semantics></math> denote the labeled data, where <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{x}_{i}^{n}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msubsup id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS2.p2.2.m2.1.1.2.3" xref="S3.SS2.p2.2.m2.1.1.2.3.cmml">i</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2.2">𝐱</ci><ci id="S3.SS2.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.p2.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\mathbf{x}_{i}^{n}</annotation></semantics></math> is the data feature and <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{y}_{i}^{n}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msubsup id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2.2" xref="S3.SS2.p2.3.m3.1.1.2.2.cmml">𝐲</mi><mi id="S3.SS2.p2.3.m3.1.1.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3.cmml">i</mi><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2">𝐲</ci><ci id="S3.SS2.p2.3.m3.1.1.2.3.cmml" xref="S3.SS2.p2.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\mathbf{y}_{i}^{n}</annotation></semantics></math> is the coresponding ground truth vector. The loss of training local model with knowledge distillation is defined as follows:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.3" class="ltx_Math" alttext="\mathcal{J}_{n}=\frac{1}{|\mathcal{D}_{n}|}\sum_{i=1}^{|\mathcal{D}_{n}|}\left[\text{CE}(\mathbf{w}_{t}^{n}(\mathbf{x}_{i}^{n}),\mathbf{y}_{i}^{n})+\lambda\text{KL}(\boldsymbol{\alpha}_{t}^{n}(\mathbf{x}_{i}^{n}),\hat{\boldsymbol{\alpha}}_{t}^{n}(\mathbf{x}_{i}^{n}))\right]," display="block"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><msub id="S3.E6.m1.3.3.1.1.3" xref="S3.E6.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.3.3.1.1.3.2" xref="S3.E6.m1.3.3.1.1.3.2.cmml">𝒥</mi><mi id="S3.E6.m1.3.3.1.1.3.3" xref="S3.E6.m1.3.3.1.1.3.3.cmml">n</mi></msub><mo id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.3.3.1.1.1" xref="S3.E6.m1.3.3.1.1.1.cmml"><mfrac id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mn id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml">1</mn><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.cmml"><munderover id="S3.E6.m1.3.3.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.2.2.3.2" xref="S3.E6.m1.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E6.m1.3.3.1.1.1.1.2.2.3.1" xref="S3.E6.m1.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.3.3.1.1.1.1.2.2.3.3" xref="S3.E6.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.2" xref="S3.E6.m1.2.2.1.2.1.cmml">|</mo><msub id="S3.E6.m1.2.2.1.1.1" xref="S3.E6.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.2.cmml">𝒟</mi><mi id="S3.E6.m1.2.2.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.E6.m1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mtext id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.4a.cmml">CE</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝐰</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">t</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml">𝐲</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml">i</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.5" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.5" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.5.cmml">+</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.4.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3.cmml">​</mo><mtext id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.5" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.5a.cmml">KL</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3a" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.3.cmml">(</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.cmml"><msubsup id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.2.cmml">𝜶</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.3.cmml">t</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.3.cmml">,</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.cmml"><msubsup id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.cmml"><mover accent="true" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.2.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.2.2.cmml">𝜶</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.2.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.2.1.cmml">^</mo></mover><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.3.cmml">t</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml">(</mo><msubsup id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.3.cmml">i</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.5" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.3.3.1.2" xref="S3.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1"><eq id="S3.E6.m1.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2"></eq><apply id="S3.E6.m1.3.3.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.3.2">𝒥</ci><ci id="S3.E6.m1.3.3.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.3.3">𝑛</ci></apply><apply id="S3.E6.m1.3.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1"><times id="S3.E6.m1.3.3.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2"></times><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><divide id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1"></divide><cn type="integer" id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">1</cn><apply id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1"><abs id="S3.E6.m1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2"></abs><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E6.m1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1"><apply id="S3.E6.m1.3.3.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E6.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E6.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2.2.3"><eq id="S3.E6.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E6.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.2.2.1.2.cmml" xref="S3.E6.m1.2.2.1.1"><abs id="S3.E6.m1.2.2.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2"></abs><apply id="S3.E6.m1.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.2">𝒟</ci><ci id="S3.E6.m1.2.2.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1"><plus id="S3.E6.m1.3.3.1.1.1.1.1.1.1.5.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.5"></plus><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2"><times id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3"></times><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.4a.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.4"><mtext id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.4">CE</mtext></ci><interval closure="open" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2"><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐰</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2">𝐲</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3">𝑛</ci></apply></interval></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4"><times id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3"></times><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.4.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.4">𝜆</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.5a.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.5"><mtext id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.5.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.5">KL</mtext></ci><interval closure="open" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2"><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1"><times id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2"></times><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.2">𝜶</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.3">𝑡</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.1.1.3">𝑛</ci></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2"><times id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.2"></times><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3">subscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.2"><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.2.1">^</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.2.2">𝜶</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.3">𝑡</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.3">𝑛</ci></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.2">𝐱</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.1.1.3">𝑛</ci></apply></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">\mathcal{J}_{n}=\frac{1}{|\mathcal{D}_{n}|}\sum_{i=1}^{|\mathcal{D}_{n}|}\left[\text{CE}(\mathbf{w}_{t}^{n}(\mathbf{x}_{i}^{n}),\mathbf{y}_{i}^{n})+\lambda\text{KL}(\boldsymbol{\alpha}_{t}^{n}(\mathbf{x}_{i}^{n}),\hat{\boldsymbol{\alpha}}_{t}^{n}(\mathbf{x}_{i}^{n}))\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.12" class="ltx_p">where <math id="S3.SS2.p2.4.m1.1" class="ltx_Math" alttext="|\mathcal{D}_{n}|" display="inline"><semantics id="S3.SS2.p2.4.m1.1a"><mrow id="S3.SS2.p2.4.m1.1.1.1" xref="S3.SS2.p2.4.m1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.4.m1.1.1.1.2" xref="S3.SS2.p2.4.m1.1.1.2.1.cmml">|</mo><msub id="S3.SS2.p2.4.m1.1.1.1.1" xref="S3.SS2.p2.4.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.4.m1.1.1.1.1.2" xref="S3.SS2.p2.4.m1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p2.4.m1.1.1.1.1.3" xref="S3.SS2.p2.4.m1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S3.SS2.p2.4.m1.1.1.1.3" xref="S3.SS2.p2.4.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m1.1b"><apply id="S3.SS2.p2.4.m1.1.1.2.cmml" xref="S3.SS2.p2.4.m1.1.1.1"><abs id="S3.SS2.p2.4.m1.1.1.2.1.cmml" xref="S3.SS2.p2.4.m1.1.1.1.2"></abs><apply id="S3.SS2.p2.4.m1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m1.1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m1.1.1.1.1.2.cmml" xref="S3.SS2.p2.4.m1.1.1.1.1.2">𝒟</ci><ci id="S3.SS2.p2.4.m1.1.1.1.1.3.cmml" xref="S3.SS2.p2.4.m1.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m1.1c">|\mathcal{D}_{n}|</annotation></semantics></math> denotes the number of data in <math id="S3.SS2.p2.5.m2.1" class="ltx_Math" alttext="\mathcal{D}_{n}" display="inline"><semantics id="S3.SS2.p2.5.m2.1a"><msub id="S3.SS2.p2.5.m2.1.1" xref="S3.SS2.p2.5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.5.m2.1.1.2" xref="S3.SS2.p2.5.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p2.5.m2.1.1.3" xref="S3.SS2.p2.5.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m2.1b"><apply id="S3.SS2.p2.5.m2.1.1.cmml" xref="S3.SS2.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m2.1.1.1.cmml" xref="S3.SS2.p2.5.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m2.1.1.2.cmml" xref="S3.SS2.p2.5.m2.1.1.2">𝒟</ci><ci id="S3.SS2.p2.5.m2.1.1.3.cmml" xref="S3.SS2.p2.5.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m2.1c">\mathcal{D}_{n}</annotation></semantics></math>, <math id="S3.SS2.p2.6.m3.1" class="ltx_Math" alttext="\mathbf{w}_{t}^{n}(\mathbf{x}_{i}^{n})" display="inline"><semantics id="S3.SS2.p2.6.m3.1a"><mrow id="S3.SS2.p2.6.m3.1.1" xref="S3.SS2.p2.6.m3.1.1.cmml"><msubsup id="S3.SS2.p2.6.m3.1.1.3" xref="S3.SS2.p2.6.m3.1.1.3.cmml"><mi id="S3.SS2.p2.6.m3.1.1.3.2.2" xref="S3.SS2.p2.6.m3.1.1.3.2.2.cmml">𝐰</mi><mi id="S3.SS2.p2.6.m3.1.1.3.2.3" xref="S3.SS2.p2.6.m3.1.1.3.2.3.cmml">t</mi><mi id="S3.SS2.p2.6.m3.1.1.3.3" xref="S3.SS2.p2.6.m3.1.1.3.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p2.6.m3.1.1.2" xref="S3.SS2.p2.6.m3.1.1.2.cmml">​</mo><mrow id="S3.SS2.p2.6.m3.1.1.1.1" xref="S3.SS2.p2.6.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.6.m3.1.1.1.1.2" xref="S3.SS2.p2.6.m3.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS2.p2.6.m3.1.1.1.1.1" xref="S3.SS2.p2.6.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.6.m3.1.1.1.1.1.2.2" xref="S3.SS2.p2.6.m3.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS2.p2.6.m3.1.1.1.1.1.2.3" xref="S3.SS2.p2.6.m3.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.p2.6.m3.1.1.1.1.1.3" xref="S3.SS2.p2.6.m3.1.1.1.1.1.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.SS2.p2.6.m3.1.1.1.1.3" xref="S3.SS2.p2.6.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m3.1b"><apply id="S3.SS2.p2.6.m3.1.1.cmml" xref="S3.SS2.p2.6.m3.1.1"><times id="S3.SS2.p2.6.m3.1.1.2.cmml" xref="S3.SS2.p2.6.m3.1.1.2"></times><apply id="S3.SS2.p2.6.m3.1.1.3.cmml" xref="S3.SS2.p2.6.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m3.1.1.3.1.cmml" xref="S3.SS2.p2.6.m3.1.1.3">superscript</csymbol><apply id="S3.SS2.p2.6.m3.1.1.3.2.cmml" xref="S3.SS2.p2.6.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m3.1.1.3.2.1.cmml" xref="S3.SS2.p2.6.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.6.m3.1.1.3.2.2.cmml" xref="S3.SS2.p2.6.m3.1.1.3.2.2">𝐰</ci><ci id="S3.SS2.p2.6.m3.1.1.3.2.3.cmml" xref="S3.SS2.p2.6.m3.1.1.3.2.3">𝑡</ci></apply><ci id="S3.SS2.p2.6.m3.1.1.3.3.cmml" xref="S3.SS2.p2.6.m3.1.1.3.3">𝑛</ci></apply><apply id="S3.SS2.p2.6.m3.1.1.1.1.1.cmml" xref="S3.SS2.p2.6.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.6.m3.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p2.6.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.6.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m3.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.6.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m3.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.6.m3.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.SS2.p2.6.m3.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.6.m3.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p2.6.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.6.m3.1.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m3.1c">\mathbf{w}_{t}^{n}(\mathbf{x}_{i}^{n})</annotation></semantics></math> means the predicted label distribution, <math id="S3.SS2.p2.7.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p2.7.m4.1a"><mi id="S3.SS2.p2.7.m4.1.1" xref="S3.SS2.p2.7.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m4.1b"><ci id="S3.SS2.p2.7.m4.1.1.cmml" xref="S3.SS2.p2.7.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m4.1c">\lambda</annotation></semantics></math> is a hyperparameter, <math id="S3.SS2.p2.8.m5.2" class="ltx_Math" alttext="\text{KL}(\cdot,\cdot)" display="inline"><semantics id="S3.SS2.p2.8.m5.2a"><mrow id="S3.SS2.p2.8.m5.2.3" xref="S3.SS2.p2.8.m5.2.3.cmml"><mtext id="S3.SS2.p2.8.m5.2.3.2" xref="S3.SS2.p2.8.m5.2.3.2a.cmml">KL</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.p2.8.m5.2.3.1" xref="S3.SS2.p2.8.m5.2.3.1.cmml">​</mo><mrow id="S3.SS2.p2.8.m5.2.3.3.2" xref="S3.SS2.p2.8.m5.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.8.m5.2.3.3.2.1" xref="S3.SS2.p2.8.m5.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p2.8.m5.1.1" xref="S3.SS2.p2.8.m5.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS2.p2.8.m5.2.3.3.2.2" xref="S3.SS2.p2.8.m5.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p2.8.m5.2.2" xref="S3.SS2.p2.8.m5.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p2.8.m5.2.3.3.2.3" xref="S3.SS2.p2.8.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m5.2b"><apply id="S3.SS2.p2.8.m5.2.3.cmml" xref="S3.SS2.p2.8.m5.2.3"><times id="S3.SS2.p2.8.m5.2.3.1.cmml" xref="S3.SS2.p2.8.m5.2.3.1"></times><ci id="S3.SS2.p2.8.m5.2.3.2a.cmml" xref="S3.SS2.p2.8.m5.2.3.2"><mtext id="S3.SS2.p2.8.m5.2.3.2.cmml" xref="S3.SS2.p2.8.m5.2.3.2">KL</mtext></ci><interval closure="open" id="S3.SS2.p2.8.m5.2.3.3.1.cmml" xref="S3.SS2.p2.8.m5.2.3.3.2"><ci id="S3.SS2.p2.8.m5.1.1.cmml" xref="S3.SS2.p2.8.m5.1.1">⋅</ci><ci id="S3.SS2.p2.8.m5.2.2.cmml" xref="S3.SS2.p2.8.m5.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m5.2c">\text{KL}(\cdot,\cdot)</annotation></semantics></math> is the Kullback–Leibler divergence, and <math id="S3.SS2.p2.9.m6.1" class="ltx_Math" alttext="\boldsymbol{\alpha}_{t}^{n}(\mathbf{x}_{i}^{n})" display="inline"><semantics id="S3.SS2.p2.9.m6.1a"><mrow id="S3.SS2.p2.9.m6.1.1" xref="S3.SS2.p2.9.m6.1.1.cmml"><msubsup id="S3.SS2.p2.9.m6.1.1.3" xref="S3.SS2.p2.9.m6.1.1.3.cmml"><mi id="S3.SS2.p2.9.m6.1.1.3.2.2" xref="S3.SS2.p2.9.m6.1.1.3.2.2.cmml">𝜶</mi><mi id="S3.SS2.p2.9.m6.1.1.3.2.3" xref="S3.SS2.p2.9.m6.1.1.3.2.3.cmml">t</mi><mi id="S3.SS2.p2.9.m6.1.1.3.3" xref="S3.SS2.p2.9.m6.1.1.3.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p2.9.m6.1.1.2" xref="S3.SS2.p2.9.m6.1.1.2.cmml">​</mo><mrow id="S3.SS2.p2.9.m6.1.1.1.1" xref="S3.SS2.p2.9.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.9.m6.1.1.1.1.2" xref="S3.SS2.p2.9.m6.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS2.p2.9.m6.1.1.1.1.1" xref="S3.SS2.p2.9.m6.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.9.m6.1.1.1.1.1.2.2" xref="S3.SS2.p2.9.m6.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS2.p2.9.m6.1.1.1.1.1.2.3" xref="S3.SS2.p2.9.m6.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.p2.9.m6.1.1.1.1.1.3" xref="S3.SS2.p2.9.m6.1.1.1.1.1.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.SS2.p2.9.m6.1.1.1.1.3" xref="S3.SS2.p2.9.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m6.1b"><apply id="S3.SS2.p2.9.m6.1.1.cmml" xref="S3.SS2.p2.9.m6.1.1"><times id="S3.SS2.p2.9.m6.1.1.2.cmml" xref="S3.SS2.p2.9.m6.1.1.2"></times><apply id="S3.SS2.p2.9.m6.1.1.3.cmml" xref="S3.SS2.p2.9.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m6.1.1.3.1.cmml" xref="S3.SS2.p2.9.m6.1.1.3">superscript</csymbol><apply id="S3.SS2.p2.9.m6.1.1.3.2.cmml" xref="S3.SS2.p2.9.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m6.1.1.3.2.1.cmml" xref="S3.SS2.p2.9.m6.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.9.m6.1.1.3.2.2.cmml" xref="S3.SS2.p2.9.m6.1.1.3.2.2">𝜶</ci><ci id="S3.SS2.p2.9.m6.1.1.3.2.3.cmml" xref="S3.SS2.p2.9.m6.1.1.3.2.3">𝑡</ci></apply><ci id="S3.SS2.p2.9.m6.1.1.3.3.cmml" xref="S3.SS2.p2.9.m6.1.1.3.3">𝑛</ci></apply><apply id="S3.SS2.p2.9.m6.1.1.1.1.1.cmml" xref="S3.SS2.p2.9.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.9.m6.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p2.9.m6.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.9.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m6.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.9.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m6.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.9.m6.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.SS2.p2.9.m6.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.9.m6.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p2.9.m6.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.9.m6.1.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m6.1c">\boldsymbol{\alpha}_{t}^{n}(\mathbf{x}_{i}^{n})</annotation></semantics></math> and <math id="S3.SS2.p2.10.m7.1" class="ltx_Math" alttext="\hat{\boldsymbol{\alpha}}_{t}^{n}(\mathbf{x}_{i}^{n})" display="inline"><semantics id="S3.SS2.p2.10.m7.1a"><mrow id="S3.SS2.p2.10.m7.1.1" xref="S3.SS2.p2.10.m7.1.1.cmml"><msubsup id="S3.SS2.p2.10.m7.1.1.3" xref="S3.SS2.p2.10.m7.1.1.3.cmml"><mover accent="true" id="S3.SS2.p2.10.m7.1.1.3.2.2" xref="S3.SS2.p2.10.m7.1.1.3.2.2.cmml"><mi id="S3.SS2.p2.10.m7.1.1.3.2.2.2" xref="S3.SS2.p2.10.m7.1.1.3.2.2.2.cmml">𝜶</mi><mo id="S3.SS2.p2.10.m7.1.1.3.2.2.1" xref="S3.SS2.p2.10.m7.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p2.10.m7.1.1.3.2.3" xref="S3.SS2.p2.10.m7.1.1.3.2.3.cmml">t</mi><mi id="S3.SS2.p2.10.m7.1.1.3.3" xref="S3.SS2.p2.10.m7.1.1.3.3.cmml">n</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p2.10.m7.1.1.2" xref="S3.SS2.p2.10.m7.1.1.2.cmml">​</mo><mrow id="S3.SS2.p2.10.m7.1.1.1.1" xref="S3.SS2.p2.10.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.10.m7.1.1.1.1.2" xref="S3.SS2.p2.10.m7.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS2.p2.10.m7.1.1.1.1.1" xref="S3.SS2.p2.10.m7.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.10.m7.1.1.1.1.1.2.2" xref="S3.SS2.p2.10.m7.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS2.p2.10.m7.1.1.1.1.1.2.3" xref="S3.SS2.p2.10.m7.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.p2.10.m7.1.1.1.1.1.3" xref="S3.SS2.p2.10.m7.1.1.1.1.1.3.cmml">n</mi></msubsup><mo stretchy="false" id="S3.SS2.p2.10.m7.1.1.1.1.3" xref="S3.SS2.p2.10.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m7.1b"><apply id="S3.SS2.p2.10.m7.1.1.cmml" xref="S3.SS2.p2.10.m7.1.1"><times id="S3.SS2.p2.10.m7.1.1.2.cmml" xref="S3.SS2.p2.10.m7.1.1.2"></times><apply id="S3.SS2.p2.10.m7.1.1.3.cmml" xref="S3.SS2.p2.10.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m7.1.1.3.1.cmml" xref="S3.SS2.p2.10.m7.1.1.3">superscript</csymbol><apply id="S3.SS2.p2.10.m7.1.1.3.2.cmml" xref="S3.SS2.p2.10.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m7.1.1.3.2.1.cmml" xref="S3.SS2.p2.10.m7.1.1.3">subscript</csymbol><apply id="S3.SS2.p2.10.m7.1.1.3.2.2.cmml" xref="S3.SS2.p2.10.m7.1.1.3.2.2"><ci id="S3.SS2.p2.10.m7.1.1.3.2.2.1.cmml" xref="S3.SS2.p2.10.m7.1.1.3.2.2.1">^</ci><ci id="S3.SS2.p2.10.m7.1.1.3.2.2.2.cmml" xref="S3.SS2.p2.10.m7.1.1.3.2.2.2">𝜶</ci></apply><ci id="S3.SS2.p2.10.m7.1.1.3.2.3.cmml" xref="S3.SS2.p2.10.m7.1.1.3.2.3">𝑡</ci></apply><ci id="S3.SS2.p2.10.m7.1.1.3.3.cmml" xref="S3.SS2.p2.10.m7.1.1.3.3">𝑛</ci></apply><apply id="S3.SS2.p2.10.m7.1.1.1.1.1.cmml" xref="S3.SS2.p2.10.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m7.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.10.m7.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p2.10.m7.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.10.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m7.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.10.m7.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.10.m7.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.10.m7.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.SS2.p2.10.m7.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.10.m7.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p2.10.m7.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.10.m7.1.1.1.1.1.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m7.1c">\hat{\boldsymbol{\alpha}}_{t}^{n}(\mathbf{x}_{i}^{n})</annotation></semantics></math> are the logits from the local model <math id="S3.SS2.p2.11.m8.1" class="ltx_Math" alttext="\mathbf{w}_{t}^{n}" display="inline"><semantics id="S3.SS2.p2.11.m8.1a"><msubsup id="S3.SS2.p2.11.m8.1.1" xref="S3.SS2.p2.11.m8.1.1.cmml"><mi id="S3.SS2.p2.11.m8.1.1.2.2" xref="S3.SS2.p2.11.m8.1.1.2.2.cmml">𝐰</mi><mi id="S3.SS2.p2.11.m8.1.1.2.3" xref="S3.SS2.p2.11.m8.1.1.2.3.cmml">t</mi><mi id="S3.SS2.p2.11.m8.1.1.3" xref="S3.SS2.p2.11.m8.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m8.1b"><apply id="S3.SS2.p2.11.m8.1.1.cmml" xref="S3.SS2.p2.11.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m8.1.1.1.cmml" xref="S3.SS2.p2.11.m8.1.1">superscript</csymbol><apply id="S3.SS2.p2.11.m8.1.1.2.cmml" xref="S3.SS2.p2.11.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m8.1.1.2.1.cmml" xref="S3.SS2.p2.11.m8.1.1">subscript</csymbol><ci id="S3.SS2.p2.11.m8.1.1.2.2.cmml" xref="S3.SS2.p2.11.m8.1.1.2.2">𝐰</ci><ci id="S3.SS2.p2.11.m8.1.1.2.3.cmml" xref="S3.SS2.p2.11.m8.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.p2.11.m8.1.1.3.cmml" xref="S3.SS2.p2.11.m8.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m8.1c">\mathbf{w}_{t}^{n}</annotation></semantics></math> and the downloaded personalized model <math id="S3.SS2.p2.12.m9.1" class="ltx_Math" alttext="\hat{\mathbf{w}}_{t}^{n}" display="inline"><semantics id="S3.SS2.p2.12.m9.1a"><msubsup id="S3.SS2.p2.12.m9.1.1" xref="S3.SS2.p2.12.m9.1.1.cmml"><mover accent="true" id="S3.SS2.p2.12.m9.1.1.2.2" xref="S3.SS2.p2.12.m9.1.1.2.2.cmml"><mi id="S3.SS2.p2.12.m9.1.1.2.2.2" xref="S3.SS2.p2.12.m9.1.1.2.2.2.cmml">𝐰</mi><mo id="S3.SS2.p2.12.m9.1.1.2.2.1" xref="S3.SS2.p2.12.m9.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS2.p2.12.m9.1.1.2.3" xref="S3.SS2.p2.12.m9.1.1.2.3.cmml">t</mi><mi id="S3.SS2.p2.12.m9.1.1.3" xref="S3.SS2.p2.12.m9.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m9.1b"><apply id="S3.SS2.p2.12.m9.1.1.cmml" xref="S3.SS2.p2.12.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m9.1.1.1.cmml" xref="S3.SS2.p2.12.m9.1.1">superscript</csymbol><apply id="S3.SS2.p2.12.m9.1.1.2.cmml" xref="S3.SS2.p2.12.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m9.1.1.2.1.cmml" xref="S3.SS2.p2.12.m9.1.1">subscript</csymbol><apply id="S3.SS2.p2.12.m9.1.1.2.2.cmml" xref="S3.SS2.p2.12.m9.1.1.2.2"><ci id="S3.SS2.p2.12.m9.1.1.2.2.1.cmml" xref="S3.SS2.p2.12.m9.1.1.2.2.1">^</ci><ci id="S3.SS2.p2.12.m9.1.1.2.2.2.cmml" xref="S3.SS2.p2.12.m9.1.1.2.2.2">𝐰</ci></apply><ci id="S3.SS2.p2.12.m9.1.1.2.3.cmml" xref="S3.SS2.p2.12.m9.1.1.2.3">𝑡</ci></apply><ci id="S3.SS2.p2.12.m9.1.1.3.cmml" xref="S3.SS2.p2.12.m9.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m9.1c">\hat{\mathbf{w}}_{t}^{n}</annotation></semantics></math>, respevtively.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experiment Setups</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.5" class="ltx_p"><span id="S4.SS1.p1.5.1" class="ltx_text ltx_font_bold">Datasets</span>.
We conduct experiments for the image classification task on MNIST, SVHN, and CIFAR-10 datasets under both IID and non-IID data distribution settings, respectively.
We split the datasets into <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="80\%" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">80</mn><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">80\%</annotation></semantics></math> for training and <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mn id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">20</mn><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">20\%</annotation></semantics></math> for testing. During training, we randomly sample <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mn id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">10</mn><mo id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">10\%</annotation></semantics></math> training data to put in the server as <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{p}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝒟</ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\mathcal{D}_{p}</annotation></semantics></math> and the remaining <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="90\%" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mn id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">90</mn><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="latexml" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">90\%</annotation></semantics></math> to distribute to the clients. The training and testing datasets are randomly sampled for the IID setting. For the non-IID setting, each client randomly holds two classes of data. To test the personalization effectiveness, we sample the testing dataset following the label distribution as the training dataset. We also conduct experiments to test models using <span id="S4.SS1.p1.5.2" class="ltx_text ltx_font_bold">different public data</span> in Section <a href="#S4.SS4" title="4.4 Public Dataset Analysis ‣ 4 Experiments ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.4</span></a>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Baselines</span>.
We compare <span id="S4.SS1.p2.1.2" class="ltx_text ltx_font_typewriter">pFedHR</span> with the baselines under two settings. (1) <span id="S4.SS1.p2.1.3" class="ltx_text ltx_font_bold">Heterogenous setting</span>. In this setting, clients are allowed to have different model structures. The proposed <span id="S4.SS1.p2.1.4" class="ltx_text ltx_font_typewriter">pFedHR</span> is general and can use both labeled and unlabeled public datasets to conduct heterogeneous model cooperation. To make fair comparisons, we use FedMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and FedGH <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> as baselines when using the <em id="S4.SS1.p2.1.5" class="ltx_emph ltx_font_italic">labeled public data</em>, and FCCL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and FedKEMF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> when testing the <em id="S4.SS1.p2.1.6" class="ltx_emph ltx_font_italic">unlabeled public data</em>.
(2) <span id="S4.SS1.p2.1.7" class="ltx_text ltx_font_bold">Homogenous setting</span>. In this setting, clients share an identical model structure.
We use traditional and personalized FL models as baselines, including FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, Per-FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, PFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, and PFedBayes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Heterogenous Setting Evaluation</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.4" class="ltx_p"><span id="S4.SS2.p1.4.1" class="ltx_text ltx_font_bold">Small Number of Clients</span>. Similar to existing work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, to test the performance with a small number of clients, we set the client number <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="N=12" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">N</mi><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">12</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><eq id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></eq><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑁</ci><cn type="integer" id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">12</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">N=12</annotation></semantics></math> and active client number <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="B=4" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">B</mi><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><eq id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></eq><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝐵</ci><cn type="integer" id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">B=4</annotation></semantics></math> in each communication round. We design <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mn id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><cn type="integer" id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">4</annotation></semantics></math> types of models with different structures and randomly assign each type of model to 3 clients. The <em id="S4.SS2.p1.4.2" class="ltx_emph ltx_font_italic">Conv</em> operation contains convolution, max pooling, batch normalization, and ReLu, and the <em id="S4.SS2.p1.4.3" class="ltx_emph ltx_font_italic">FC</em> layer contains fully connected mapping, ReLU, and dropout.
We set the number of clusters <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="{K}=4" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">K</mi><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><eq id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></eq><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝐾</ci><cn type="integer" id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">{K}=4</annotation></semantics></math>. Then local training epoch and the server finetuning epoch are equal to 10 and 3, respectively. The public data and client data are from the same dataset.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.3.2" class="ltx_text" style="font-size:90%;">Performance comparison with baselines under the heterogeneous setting.</span></figcaption>
<div id="S4.T2.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:104.1pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-68.1pt,20.3pt) scale(0.718135051235948,0.718135051235948) ;">
<table id="S4.T2.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.4.1.1" class="ltx_tr">
<td id="S4.T2.4.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T2.4.1.1.1.1" class="ltx_text"><span id="S4.T2.4.1.1.1.1.1" class="ltx_text"></span> <span id="S4.T2.4.1.1.1.1.2" class="ltx_text">
<span id="S4.T2.4.1.1.1.1.2.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.4.1.1.1.1.2.1.1" class="ltx_tr">
<span id="S4.T2.4.1.1.1.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.4.1.1.1.1.2.1.1.1.1" class="ltx_text ltx_font_bold">Public</span></span></span>
<span id="S4.T2.4.1.1.1.1.2.1.2" class="ltx_tr">
<span id="S4.T2.4.1.1.1.1.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.4.1.1.1.1.2.1.2.1.1" class="ltx_text ltx_font_bold">Data</span></span></span>
</span></span> <span id="S4.T2.4.1.1.1.1.3" class="ltx_text"></span></span></td>
<td id="S4.T2.4.1.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T2.4.1.1.2.1" class="ltx_text ltx_font_bold">Dataset</span></td>
<td id="S4.T2.4.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2"><span id="S4.T2.4.1.1.3.1" class="ltx_text ltx_font_bold">MNIST</span></td>
<td id="S4.T2.4.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2"><span id="S4.T2.4.1.1.4.1" class="ltx_text ltx_font_bold">SVHN</span></td>
<td id="S4.T2.4.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S4.T2.4.1.1.5.1" class="ltx_text ltx_font_bold">CIFAR-10</span></td>
</tr>
<tr id="S4.T2.4.1.2" class="ltx_tr">
<td id="S4.T2.4.1.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T2.4.1.2.1.1" class="ltx_text ltx_font_bold">Model</span></td>
<td id="S4.T2.4.1.2.2" class="ltx_td ltx_align_center ltx_border_t">IID</td>
<td id="S4.T2.4.1.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Non-IID</td>
<td id="S4.T2.4.1.2.4" class="ltx_td ltx_align_center ltx_border_t">IID</td>
<td id="S4.T2.4.1.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Non-IID</td>
<td id="S4.T2.4.1.2.6" class="ltx_td ltx_align_center ltx_border_t">IID</td>
<td id="S4.T2.4.1.2.7" class="ltx_td ltx_align_center ltx_border_t">Non-IID</td>
</tr>
<tr id="S4.T2.4.1.3" class="ltx_tr">
<td id="S4.T2.4.1.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.4.1.3.1.1" class="ltx_text">Labeled</span></td>
<td id="S4.T2.4.1.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">FedMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</td>
<td id="S4.T2.4.1.3.3" class="ltx_td ltx_align_center ltx_border_t">93.08%</td>
<td id="S4.T2.4.1.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">91.44%</td>
<td id="S4.T2.4.1.3.5" class="ltx_td ltx_align_center ltx_border_t">81.55%</td>
<td id="S4.T2.4.1.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.39%</td>
<td id="S4.T2.4.1.3.7" class="ltx_td ltx_align_center ltx_border_t">68.22%</td>
<td id="S4.T2.4.1.3.8" class="ltx_td ltx_align_center ltx_border_t">66.13%</td>
</tr>
<tr id="S4.T2.4.1.4" class="ltx_tr">
<td id="S4.T2.4.1.4.1" class="ltx_td ltx_align_left ltx_border_r">FedGH <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>
</td>
<td id="S4.T2.4.1.4.2" class="ltx_td ltx_align_center">94.10%</td>
<td id="S4.T2.4.1.4.3" class="ltx_td ltx_align_center ltx_border_r">93.27%</td>
<td id="S4.T2.4.1.4.4" class="ltx_td ltx_align_center">81.94%</td>
<td id="S4.T2.4.1.4.5" class="ltx_td ltx_align_center ltx_border_r">81.06%</td>
<td id="S4.T2.4.1.4.6" class="ltx_td ltx_align_center">72.69%</td>
<td id="S4.T2.4.1.4.7" class="ltx_td ltx_align_center">70.27%</td>
</tr>
<tr id="S4.T2.4.1.5" class="ltx_tr">
<td id="S4.T2.4.1.5.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S4.T2.4.1.5.1.1" class="ltx_text ltx_font_typewriter" style="background-color:#D9D9D9;">pFedHR</span></td>
<td id="S4.T2.4.1.5.2" class="ltx_td ltx_align_center"><span id="S4.T2.4.1.5.2.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">94.55%</span></td>
<td id="S4.T2.4.1.5.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.4.1.5.3.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">94.41%</span></td>
<td id="S4.T2.4.1.5.4" class="ltx_td ltx_align_center"><span id="S4.T2.4.1.5.4.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">83.68%</span></td>
<td id="S4.T2.4.1.5.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.4.1.5.5.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">83.40%</span></td>
<td id="S4.T2.4.1.5.6" class="ltx_td ltx_align_center"><span id="S4.T2.4.1.5.6.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">73.88%</span></td>
<td id="S4.T2.4.1.5.7" class="ltx_td ltx_align_center"><span id="S4.T2.4.1.5.7.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">71.74%</span></td>
</tr>
<tr id="S4.T2.4.1.6" class="ltx_tr">
<td id="S4.T2.4.1.6.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_tt" rowspan="3"><span id="S4.T2.4.1.6.1.1" class="ltx_text">Unlabeled</span></td>
<td id="S4.T2.4.1.6.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">FedKEMF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>
</td>
<td id="S4.T2.4.1.6.3" class="ltx_td ltx_align_center ltx_border_tt">93.01%</td>
<td id="S4.T2.4.1.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">91.66%</td>
<td id="S4.T2.4.1.6.5" class="ltx_td ltx_align_center ltx_border_tt">80.41%</td>
<td id="S4.T2.4.1.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">79.33%</td>
<td id="S4.T2.4.1.6.7" class="ltx_td ltx_align_center ltx_border_tt">67.12%</td>
<td id="S4.T2.4.1.6.8" class="ltx_td ltx_align_center ltx_border_tt">66.93%</td>
</tr>
<tr id="S4.T2.4.1.7" class="ltx_tr">
<td id="S4.T2.4.1.7.1" class="ltx_td ltx_align_left ltx_border_r">FCCL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</td>
<td id="S4.T2.4.1.7.2" class="ltx_td ltx_align_center">93.62%</td>
<td id="S4.T2.4.1.7.3" class="ltx_td ltx_align_center ltx_border_r">92.88%</td>
<td id="S4.T2.4.1.7.4" class="ltx_td ltx_align_center">82.03%</td>
<td id="S4.T2.4.1.7.5" class="ltx_td ltx_align_center ltx_border_r">79.75%</td>
<td id="S4.T2.4.1.7.6" class="ltx_td ltx_align_center">68.77%</td>
<td id="S4.T2.4.1.7.7" class="ltx_td ltx_align_center">66.49%</td>
</tr>
<tr id="S4.T2.4.1.8" class="ltx_tr">
<td id="S4.T2.4.1.8.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" style="background-color:#D9D9D9;"><span id="S4.T2.4.1.8.1.1" class="ltx_text ltx_font_typewriter" style="background-color:#D9D9D9;">pFedHR</span></td>
<td id="S4.T2.4.1.8.2" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#D9D9D9;"><span id="S4.T2.4.1.8.2.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">93.89%</span></td>
<td id="S4.T2.4.1.8.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="background-color:#D9D9D9;"><span id="S4.T2.4.1.8.3.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">93.76%</span></td>
<td id="S4.T2.4.1.8.4" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#D9D9D9;"><span id="S4.T2.4.1.8.4.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">83.15%</span></td>
<td id="S4.T2.4.1.8.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="background-color:#D9D9D9;"><span id="S4.T2.4.1.8.5.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">80.24<span id="S4.T2.4.1.8.5.1.1" class="ltx_text ltx_font_medium">%</span></span></td>
<td id="S4.T2.4.1.8.6" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#D9D9D9;"><span id="S4.T2.4.1.8.6.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">69.38<span id="S4.T2.4.1.8.6.1.1" class="ltx_text ltx_font_medium">%</span></span></td>
<td id="S4.T2.4.1.8.7" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#D9D9D9;"><span id="S4.T2.4.1.8.7.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">68.01<span id="S4.T2.4.1.8.7.1.1" class="ltx_text ltx_font_medium">%</span></span></td>
</tr>
</table>
</span></div>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Heterogenous Setting Evaluation ‣ 4 Experiments ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the experimental results for the heterogeneous setting using both labeled and unlabeled public data. We can observe that the proposed <span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_typewriter">pFedHR</span> achieves state-of-the-art performance on all datasets and settings. We also find the methods using labeled public datasets can boost the performance compared with unlabeled public ones in general, which aligns with our expectations and experiences.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.3" class="ltx_p"><span id="S4.SS2.p3.3.1" class="ltx_text ltx_font_bold">Large Number of Clients</span>.
We also test the performance of models with a large number of clients.
When the number of active clients <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">B</annotation></semantics></math> is large, calculating layer pair-wise distance values using Eq. (<a href="#S3.E3" title="In 3.1.2 Heterogeneous Model Reassembly – 𝑔⁢(⋅,⋅) ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) will be highly time-consuming. To avoid this issue, a straightforward solution is to conduct FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> for averaging the models with the same structures first and then do the function-driven layer grouping based on the averaged structures via Eq. (<a href="#S3.E4" title="In 3.1.2 Heterogeneous Model Reassembly – 𝑔⁢(⋅,⋅) ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). The following operations are the same as <span id="S4.SS2.p3.3.2" class="ltx_text ltx_font_typewriter">pFedHR</span>. In this experiment, we set <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">N</mi><mo id="S4.SS2.p3.2.m2.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><eq id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1"></eq><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝑁</ci><cn type="integer" id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">N=100</annotation></semantics></math> clients and the active number of clients <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="B=10" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">B</mi><mo id="S4.SS2.p3.3.m3.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><eq id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1"></eq><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝐵</ci><cn type="integer" id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">B=10</annotation></semantics></math>. Other settings are the same as those in the small number client experiment.</p>
</div>
<figure id="S4.T3" class="ltx_table ltx_align_floatright">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.4.2.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.2.1" class="ltx_text" style="font-size:90%;">Evaluation using a large number of clients on the SVHN dataset (<math id="S4.T3.2.1.m1.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S4.T3.2.1.m1.1b"><mrow id="S4.T3.2.1.m1.1.1" xref="S4.T3.2.1.m1.1.1.cmml"><mi id="S4.T3.2.1.m1.1.1.2" xref="S4.T3.2.1.m1.1.1.2.cmml">N</mi><mo id="S4.T3.2.1.m1.1.1.1" xref="S4.T3.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.T3.2.1.m1.1.1.3" xref="S4.T3.2.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.2.1.m1.1c"><apply id="S4.T3.2.1.m1.1.1.cmml" xref="S4.T3.2.1.m1.1.1"><eq id="S4.T3.2.1.m1.1.1.1.cmml" xref="S4.T3.2.1.m1.1.1.1"></eq><ci id="S4.T3.2.1.m1.1.1.2.cmml" xref="S4.T3.2.1.m1.1.1.2">𝑁</ci><cn type="integer" id="S4.T3.2.1.m1.1.1.3.cmml" xref="S4.T3.2.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.1.m1.1d">N=100</annotation></semantics></math>).</span></figcaption>
<div id="S4.T3.5" class="ltx_inline-block ltx_transformed_outer" style="width:195.1pt;height:110.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-13.8pt,7.8pt) scale(0.876101816700999,0.876101816700999) ;">
<table id="S4.T3.5.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T3.5.1.1" class="ltx_tr">
<td id="S4.T3.5.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="S4.T3.5.1.1.1.1" class="ltx_text ltx_font_bold">Public Data</span></td>
<td id="S4.T3.5.1.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T3.5.1.1.2.1" class="ltx_text ltx_font_bold">Model</span></td>
<td id="S4.T3.5.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="S4.T3.5.1.1.3.1" class="ltx_text ltx_font_bold">IID</span></td>
<td id="S4.T3.5.1.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T3.5.1.1.4.1" class="ltx_text ltx_font_bold">Non-IID</span></td>
</tr>
<tr id="S4.T3.5.1.2" class="ltx_tr">
<td id="S4.T3.5.1.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T3.5.1.2.1.1" class="ltx_text">Labeled</span></td>
<td id="S4.T3.5.1.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">FedMD</td>
<td id="S4.T3.5.1.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.16%</td>
<td id="S4.T3.5.1.2.4" class="ltx_td ltx_align_center ltx_border_t">74.34%</td>
</tr>
<tr id="S4.T3.5.1.3" class="ltx_tr">
<td id="S4.T3.5.1.3.1" class="ltx_td ltx_align_left ltx_border_r">FedGH</td>
<td id="S4.T3.5.1.3.2" class="ltx_td ltx_align_center ltx_border_r">76.27%</td>
<td id="S4.T3.5.1.3.3" class="ltx_td ltx_align_center">72.78%</td>
</tr>
<tr id="S4.T3.5.1.4" class="ltx_tr">
<td id="S4.T3.5.1.4.1" class="ltx_td ltx_align_left ltx_border_r" style="background-color:#D9D9D9;"><span id="S4.T3.5.1.4.1.1" class="ltx_text" style="background-color:#D9D9D9;">pFedHR</span></td>
<td id="S4.T3.5.1.4.2" class="ltx_td ltx_align_center ltx_border_r" style="background-color:#D9D9D9;"><span id="S4.T3.5.1.4.2.1" class="ltx_text" style="background-color:#D9D9D9;"><span id="S4.T3.5.1.4.2.1.1" class="ltx_text ltx_font_bold">80.02%</span></span></td>
<td id="S4.T3.5.1.4.3" class="ltx_td ltx_align_center" style="background-color:#D9D9D9;"><span id="S4.T3.5.1.4.3.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">77.63%</span></td>
</tr>
<tr id="S4.T3.5.1.5" class="ltx_tr">
<td id="S4.T3.5.1.5.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T3.5.1.5.1.1" class="ltx_text">Unlabeled</span></td>
<td id="S4.T3.5.1.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">FedKEAF</td>
<td id="S4.T3.5.1.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">76.27%</td>
<td id="S4.T3.5.1.5.4" class="ltx_td ltx_align_center ltx_border_t">74.61%</td>
</tr>
<tr id="S4.T3.5.1.6" class="ltx_tr">
<td id="S4.T3.5.1.6.1" class="ltx_td ltx_align_left ltx_border_r">FCCL</td>
<td id="S4.T3.5.1.6.2" class="ltx_td ltx_align_center ltx_border_r">75.03%</td>
<td id="S4.T3.5.1.6.3" class="ltx_td ltx_align_center">71.54%</td>
</tr>
<tr id="S4.T3.5.1.7" class="ltx_tr">
<td id="S4.T3.5.1.7.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" style="background-color:#D9D9D9;"><span id="S4.T3.5.1.7.1.1" class="ltx_text" style="background-color:#D9D9D9;">pFedHR</span></td>
<td id="S4.T3.5.1.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="background-color:#D9D9D9;"><span id="S4.T3.5.1.7.2.1" class="ltx_text" style="background-color:#D9D9D9;"><span id="S4.T3.5.1.7.2.1.1" class="ltx_text ltx_font_bold">78.98%</span></span></td>
<td id="S4.T3.5.1.7.3" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#D9D9D9;"><span id="S4.T3.5.1.7.3.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">75.77%</span></td>
</tr>
</table>
</span></div>
</figure>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">Table <a href="#S4.T3" title="Table 3 ‣ 4.2 Heterogenous Setting Evaluation ‣ 4 Experiments ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the results on the SVHN dataset for testing the proposed <span id="S4.SS2.p4.1.1" class="ltx_text ltx_font_typewriter">pFedHR</span> for a large number of clients setting. The results show similar patterns as those listed in Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Heterogenous Setting Evaluation ‣ 4 Experiments ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, where the proposed <span id="S4.SS2.p4.1.2" class="ltx_text ltx_font_typewriter">pFedHR</span> achieves the best performance under IID and Non-IID settings whether it uses labeled or unlabeled public datasets. Compared to the results on the SVHN dataset in Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Heterogenous Setting Evaluation ‣ 4 Experiments ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we can find that the performance of all the baselines and our models drops. Because the number of training data is fixed, allocating these data to 100 clients will make each client use fewer data for training, which leads to a performance drop. The results on both small and large numbers of clients clearly demonstrate the effectiveness of our model for addressing the heterogeneous model cooperation issue in federated learning.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Homogeneous Setting Evaluation</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">In this experiment, all the clients use the same model structure. We test the performance of our proposed <span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_typewriter">pFedHR</span> on representative models with the smallest (<span id="S4.SS3.p1.1.2" class="ltx_text ltx_font_bold">M1</span>) and largest (<span id="S4.SS3.p1.1.3" class="ltx_text ltx_font_bold">M4</span>) number of layers, compared with state-of-the-art homogeneous federated learning models. Except for the identical model structure, other experimental settings are the same as those used in the scenario of the small number of clients.
Note that for <span id="S4.SS3.p1.1.4" class="ltx_text ltx_font_typewriter">pFedHR</span>, we report the results using the labeled public data in this experiment. The results are shown in Table <a href="#S4.T4" title="Table 4 ‣ 4.3 Homogeneous Setting Evaluation ‣ 4 Experiments ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.2.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S4.T4.3.2" class="ltx_text" style="font-size:90%;">Homogeneous model comparison with baselines.</span></figcaption>
<div id="S4.T4.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:170.1pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-84.6pt,41.3pt) scale(0.672284726540678,0.672284726540678) ;">
<table id="S4.T4.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T4.4.1.1" class="ltx_tr">
<td id="S4.T4.4.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T4.4.1.1.1.1" class="ltx_text ltx_font_bold">Model</span></td>
<td id="S4.T4.4.1.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><span id="S4.T4.4.1.1.2.1" class="ltx_text ltx_font_bold">Dataset</span></td>
<td id="S4.T4.4.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2"><span id="S4.T4.4.1.1.3.1" class="ltx_text ltx_font_bold">MNIST</span></td>
<td id="S4.T4.4.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2"><span id="S4.T4.4.1.1.4.1" class="ltx_text ltx_font_bold">SVHN</span></td>
<td id="S4.T4.4.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S4.T4.4.1.1.5.1" class="ltx_text ltx_font_bold">CIFAR-10</span></td>
</tr>
<tr id="S4.T4.4.1.2" class="ltx_tr">
<td id="S4.T4.4.1.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S4.T4.4.1.2.1.1" class="ltx_text ltx_font_bold">Setting</span></td>
<td id="S4.T4.4.1.2.2" class="ltx_td ltx_align_center ltx_border_t">IID</td>
<td id="S4.T4.4.1.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Non-IID</td>
<td id="S4.T4.4.1.2.4" class="ltx_td ltx_align_center ltx_border_t">IID</td>
<td id="S4.T4.4.1.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Non-IID</td>
<td id="S4.T4.4.1.2.6" class="ltx_td ltx_align_center ltx_border_t">IID</td>
<td id="S4.T4.4.1.2.7" class="ltx_td ltx_align_center ltx_border_t">Non-IID</td>
</tr>
<tr id="S4.T4.4.1.3" class="ltx_tr">
<td id="S4.T4.4.1.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" rowspan="6"><span id="S4.T4.4.1.3.1.1" class="ltx_text">M1</span></td>
<td id="S4.T4.4.1.3.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
<td id="S4.T4.4.1.3.3" class="ltx_td ltx_align_center ltx_border_t">91.23%</td>
<td id="S4.T4.4.1.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">90.04%</td>
<td id="S4.T4.4.1.3.5" class="ltx_td ltx_align_center ltx_border_t">53.45%</td>
<td id="S4.T4.4.1.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">51.33%</td>
<td id="S4.T4.4.1.3.7" class="ltx_td ltx_align_center ltx_border_t">43.05%</td>
<td id="S4.T4.4.1.3.8" class="ltx_td ltx_align_center ltx_border_t">33.39%</td>
</tr>
<tr id="S4.T4.4.1.4" class="ltx_tr">
<td id="S4.T4.4.1.4.1" class="ltx_td ltx_align_left ltx_border_r">FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>
</td>
<td id="S4.T4.4.1.4.2" class="ltx_td ltx_align_center">92.66%</td>
<td id="S4.T4.4.1.4.3" class="ltx_td ltx_align_center ltx_border_r">92.47%</td>
<td id="S4.T4.4.1.4.4" class="ltx_td ltx_align_center">54.86%</td>
<td id="S4.T4.4.1.4.5" class="ltx_td ltx_align_center ltx_border_r">53.09%</td>
<td id="S4.T4.4.1.4.6" class="ltx_td ltx_align_center">43.62%</td>
<td id="S4.T4.4.1.4.7" class="ltx_td ltx_align_center">35.06%</td>
</tr>
<tr id="S4.T4.4.1.5" class="ltx_tr">
<td id="S4.T4.4.1.5.1" class="ltx_td ltx_align_left ltx_border_r">Per-FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>
</td>
<td id="S4.T4.4.1.5.2" class="ltx_td ltx_align_center">93.23%</td>
<td id="S4.T4.4.1.5.3" class="ltx_td ltx_align_center ltx_border_r">93.04%</td>
<td id="S4.T4.4.1.5.4" class="ltx_td ltx_align_center">54.29%</td>
<td id="S4.T4.4.1.5.5" class="ltx_td ltx_align_center ltx_border_r">52.04%</td>
<td id="S4.T4.4.1.5.6" class="ltx_td ltx_align_center">44.14%</td>
<td id="S4.T4.4.1.5.7" class="ltx_td ltx_align_center">42.02%</td>
</tr>
<tr id="S4.T4.4.1.6" class="ltx_tr">
<td id="S4.T4.4.1.6.1" class="ltx_td ltx_align_left ltx_border_r">PFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>
</td>
<td id="S4.T4.4.1.6.2" class="ltx_td ltx_align_center">93.57%</td>
<td id="S4.T4.4.1.6.3" class="ltx_td ltx_align_center ltx_border_r">92.00%</td>
<td id="S4.T4.4.1.6.4" class="ltx_td ltx_align_center">55.01%</td>
<td id="S4.T4.4.1.6.5" class="ltx_td ltx_align_center ltx_border_r">53.78%</td>
<td id="S4.T4.4.1.6.6" class="ltx_td ltx_align_center">45.01%</td>
<td id="S4.T4.4.1.6.7" class="ltx_td ltx_align_center">43.65%</td>
</tr>
<tr id="S4.T4.4.1.7" class="ltx_tr">
<td id="S4.T4.4.1.7.1" class="ltx_td ltx_align_left ltx_border_r">PFedBayes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</td>
<td id="S4.T4.4.1.7.2" class="ltx_td ltx_align_center"><span id="S4.T4.4.1.7.2.1" class="ltx_text ltx_font_bold">94.39%</span></td>
<td id="S4.T4.4.1.7.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.4.1.7.3.1" class="ltx_text ltx_font_bold">93.32%</span></td>
<td id="S4.T4.4.1.7.4" class="ltx_td ltx_align_center">58.49%</td>
<td id="S4.T4.4.1.7.5" class="ltx_td ltx_align_center ltx_border_r">55.74%</td>
<td id="S4.T4.4.1.7.6" class="ltx_td ltx_align_center">46.12%</td>
<td id="S4.T4.4.1.7.7" class="ltx_td ltx_align_center">44.49%</td>
</tr>
<tr id="S4.T4.4.1.8" class="ltx_tr">
<td id="S4.T4.4.1.8.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S4.T4.4.1.8.1.1" class="ltx_text ltx_font_typewriter" style="background-color:#D9D9D9;">pFedHR</span></td>
<td id="S4.T4.4.1.8.2" class="ltx_td ltx_align_center"><span id="S4.T4.4.1.8.2.1" class="ltx_text" style="background-color:#D9D9D9;">94.26%</span></td>
<td id="S4.T4.4.1.8.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.4.1.8.3.1" class="ltx_text" style="background-color:#D9D9D9;">93.26%</span></td>
<td id="S4.T4.4.1.8.4" class="ltx_td ltx_align_center"><span id="S4.T4.4.1.8.4.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">61.72%</span></td>
<td id="S4.T4.4.1.8.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.4.1.8.5.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">59.23%</span></td>
<td id="S4.T4.4.1.8.6" class="ltx_td ltx_align_center"><span id="S4.T4.4.1.8.6.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">54.38%</span></td>
<td id="S4.T4.4.1.8.7" class="ltx_td ltx_align_center"><span id="S4.T4.4.1.8.7.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">48.44%</span></td>
</tr>
<tr id="S4.T4.4.1.9" class="ltx_tr">
<td id="S4.T4.4.1.9.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" rowspan="6"><span id="S4.T4.4.1.9.1.1" class="ltx_text">M4</span></td>
<td id="S4.T4.4.1.9.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
</td>
<td id="S4.T4.4.1.9.3" class="ltx_td ltx_align_center ltx_border_t">94.24%</td>
<td id="S4.T4.4.1.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">92.16%</td>
<td id="S4.T4.4.1.9.5" class="ltx_td ltx_align_center ltx_border_t">83.26%</td>
<td id="S4.T4.4.1.9.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">82.77%</td>
<td id="S4.T4.4.1.9.7" class="ltx_td ltx_align_center ltx_border_t">67.68%</td>
<td id="S4.T4.4.1.9.8" class="ltx_td ltx_align_center ltx_border_t">58.92%</td>
</tr>
<tr id="S4.T4.4.1.10" class="ltx_tr">
<td id="S4.T4.4.1.10.1" class="ltx_td ltx_align_left ltx_border_r">FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>
</td>
<td id="S4.T4.4.1.10.2" class="ltx_td ltx_align_center">94.22%</td>
<td id="S4.T4.4.1.10.3" class="ltx_td ltx_align_center ltx_border_r">93.22%</td>
<td id="S4.T4.4.1.10.4" class="ltx_td ltx_align_center">84.72%</td>
<td id="S4.T4.4.1.10.5" class="ltx_td ltx_align_center ltx_border_r">83.00%</td>
<td id="S4.T4.4.1.10.6" class="ltx_td ltx_align_center">71.24%</td>
<td id="S4.T4.4.1.10.7" class="ltx_td ltx_align_center">63.98%</td>
</tr>
<tr id="S4.T4.4.1.11" class="ltx_tr">
<td id="S4.T4.4.1.11.1" class="ltx_td ltx_align_left ltx_border_r">Per-FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>
</td>
<td id="S4.T4.4.1.11.2" class="ltx_td ltx_align_center"><span id="S4.T4.4.1.11.2.1" class="ltx_text ltx_font_bold">95.77%</span></td>
<td id="S4.T4.4.1.11.3" class="ltx_td ltx_align_center ltx_border_r">93.67%</td>
<td id="S4.T4.4.1.11.4" class="ltx_td ltx_align_center">85.99%</td>
<td id="S4.T4.4.1.11.5" class="ltx_td ltx_align_center ltx_border_r">84.01%</td>
<td id="S4.T4.4.1.11.6" class="ltx_td ltx_align_center">79.56%</td>
<td id="S4.T4.4.1.11.7" class="ltx_td ltx_align_center">76.23%</td>
</tr>
<tr id="S4.T4.4.1.12" class="ltx_tr">
<td id="S4.T4.4.1.12.1" class="ltx_td ltx_align_left ltx_border_r">PFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>
</td>
<td id="S4.T4.4.1.12.2" class="ltx_td ltx_align_center">95.71%</td>
<td id="S4.T4.4.1.12.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T4.4.1.12.3.1" class="ltx_text ltx_font_bold">94.02%</span></td>
<td id="S4.T4.4.1.12.4" class="ltx_td ltx_align_center">87.63%</td>
<td id="S4.T4.4.1.12.5" class="ltx_td ltx_align_center ltx_border_r">85.33%</td>
<td id="S4.T4.4.1.12.6" class="ltx_td ltx_align_center">79.88%</td>
<td id="S4.T4.4.1.12.7" class="ltx_td ltx_align_center">77.56%</td>
</tr>
<tr id="S4.T4.4.1.13" class="ltx_tr">
<td id="S4.T4.4.1.13.1" class="ltx_td ltx_align_left ltx_border_r">PFedBayes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</td>
<td id="S4.T4.4.1.13.2" class="ltx_td ltx_align_center">95.64%</td>
<td id="S4.T4.4.1.13.3" class="ltx_td ltx_align_center ltx_border_r">93.23%</td>
<td id="S4.T4.4.1.13.4" class="ltx_td ltx_align_center">88.34%</td>
<td id="S4.T4.4.1.13.5" class="ltx_td ltx_align_center ltx_border_r">86.28%</td>
<td id="S4.T4.4.1.13.6" class="ltx_td ltx_align_center">80.06%</td>
<td id="S4.T4.4.1.13.7" class="ltx_td ltx_align_center">77.93%</td>
</tr>
<tr id="S4.T4.4.1.14" class="ltx_tr">
<td id="S4.T4.4.1.14.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><span id="S4.T4.4.1.14.1.1" class="ltx_text ltx_font_typewriter" style="background-color:#D9D9D9;">pFedHR</span></td>
<td id="S4.T4.4.1.14.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.1.14.2.1" class="ltx_text" style="background-color:#D9D9D9;">94.88%</span></td>
<td id="S4.T4.4.1.14.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T4.4.1.14.3.1" class="ltx_text" style="background-color:#D9D9D9;">93.77%</span></td>
<td id="S4.T4.4.1.14.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.1.14.4.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">89.87%</span></td>
<td id="S4.T4.4.1.14.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T4.4.1.14.5.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">87.94%</span></td>
<td id="S4.T4.4.1.14.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.1.14.6.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">81.54%</span></td>
<td id="S4.T4.4.1.14.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T4.4.1.14.7.1" class="ltx_text ltx_font_bold" style="background-color:#D9D9D9;">79.45%</span></td>
</tr>
</table>
</span></div>
</figure>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">We can observe that using a simple model (M1) can make models achieve relatively high performance since the MNIST dataset is easy. However, for complicated datasets, i.e., SVHN and CIFAR-10, using a complex model structure (i.e., M4) is helpful for all approaches to improve their performance significantly. Our proposed <span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_typewriter">pFedHR</span> outperforms all baselines on these two datasets, even equipping with a simple model M1. Note that our model is proposed to address the heterogeneous model cooperation problem instead of the homogeneous personalization in FL. Thus, it is a practical approach and can achieve personalization. Still, we also need to mention that it needs extra public data on the server, which is different from baselines.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Public Dataset Analysis</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p"><span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_bold">Sensitivity to the Public Data Selection</span>.
In the previous experiments, the public and client data are from the same dataset, i.e., having the same distribution. To validate the effect of using different public data during model learning for all baselines and our model, we conduct experiments by choosing public data from different datasets and report the results on the SVHN dataset. Other experimental settings are the same as those in the scenario of the small number of clients.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the experimental results for all approaches using labeled and unlabeled public datasets. We can observe that replacing the public data will make all approaches decrease performance. This is reasonable since the data distributions between public and client data are different. However, compared with baselines, the proposed <span id="S4.SS4.p2.1.1" class="ltx_text ltx_font_typewriter">pFedHR</span> has the <span id="S4.SS4.p2.1.2" class="ltx_text ltx_font_bold">lowest performance drop</span>. <em id="S4.SS4.p2.1.3" class="ltx_emph ltx_font_italic">Even using other public data, <span id="S4.SS4.p2.1.3.1" class="ltx_text ltx_font_typewriter">pFedHR</span> can achieve comparable or better performance with baselines using SVHN as the public data</em>. This advantage stems from our model design. As described in Section <a href="#S3.SS1.SSS3" title='3.1.3 Similarity Learning with Layer Stitching – "sim"⁢(⋅,⋅) ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly' class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1.3</span></a>, we keep more information from original client models by using a simple layer as the stitch. Besides, we aim to search for the most similar personalized candidate with a client model. We propose to calculate the average logits in Eq. (<a href="#S3.E5" title='In 3.1.3 Similarity Learning with Layer Stitching – "sim"⁢(⋅,⋅) ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly' class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) as the criteria. To obtain the logits, we do not need to finetune the models many times. In our experiments, we set the number of finetuning epochs as 3. This strategy can also help the model reduce the adverse impact of public data during model training.</p>
</div>
<figure id="S4.F3" class="ltx_figure ltx_align_floatright"><img src="/html/2308.08643/assets/figure/pub_per.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="240" height="146" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">Performance change w.r.t. the percentage of public data.</span></figcaption>
</figure>
<div id="S4.SS4.p3" class="ltx_para">
<p id="S4.SS4.p3.1" class="ltx_p"><span id="S4.SS4.p3.1.1" class="ltx_text ltx_font_bold">Sensitivity to the Percentage of Public Data</span>.
Several factors can affect model performance. In this experiment, we aim to investigate whether the percentage of public data is a key factor in influencing performance change. Toward this end, we still use the small number of clients setting, i.e., the client and public data are from the SVHN dataset, but we adjust the percentage of public data. In the original experiment, we used 10% data as the public data. Now, we reduce this percentage to 2% and 5%. The results are shown in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.4 Public Dataset Analysis ‣ 4 Experiments ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. We can observe that with the increase in the percentage of public data, the performance of the proposed <span id="S4.SS4.p3.1.2" class="ltx_text ltx_font_typewriter">pFedHR</span> also improves. These results align with our expectations since more public data used for finetuning can help <span id="S4.SS4.p3.1.3" class="ltx_text ltx_font_typewriter">pFedHR</span> obtain more accurately matched personalized models, further enhancing the final accuracy.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Experiment results with Different Numbers of Clusters</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.3" class="ltx_p">In our model design, we need to group functional layers into <math id="S4.SS5.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS5.p1.1.m1.1a"><mi id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><ci id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">K</annotation></semantics></math> groups by optimizing Eq. (4). Where <math id="S4.SS5.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS5.p1.2.m2.1a"><mi id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><ci id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">K</annotation></semantics></math> is a predefined hyperparameter. In this experiment, we aim to investigate the performance influence with regard to <math id="S4.SS5.p1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS5.p1.3.m3.1a"><mi id="S4.SS5.p1.3.m3.1.1" xref="S4.SS5.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.1b"><ci id="S4.SS5.p1.3.m3.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.1c">K</annotation></semantics></math>. In particular, we conduct the experiments on the SVHN dataset with 12 local clients, and the public data are also the SVHN data.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.12" class="ltx_p">Figure <a href="#S4.F4" title="Figure 4 ‣ 4.5 Experiment results with Different Numbers of Clusters ‣ 4 Experiments ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the results on both IID and Non-IID settings with labeled and unlabeled public data. <math id="S4.SS5.p2.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S4.SS5.p2.1.m1.1a"><mi id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.1b"><ci id="S4.SS5.p2.1.m1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">X</annotation></semantics></math>-axis represents the number of clusters, and <math id="S4.SS5.p2.2.m2.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S4.SS5.p2.2.m2.1a"><mi id="S4.SS5.p2.2.m2.1.1" xref="S4.SS5.p2.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.2.m2.1b"><ci id="S4.SS5.p2.2.m2.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.2.m2.1c">Y</annotation></semantics></math>-axis denotes the accuracy values. We can observe that with the increase of <math id="S4.SS5.p2.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS5.p2.3.m3.1a"><mi id="S4.SS5.p2.3.m3.1.1" xref="S4.SS5.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.3.m3.1b"><ci id="S4.SS5.p2.3.m3.1.1.cmml" xref="S4.SS5.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.3.m3.1c">K</annotation></semantics></math>, the performance will also increase. However, in the experiments, we do not recommend setting a large <math id="S4.SS5.p2.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS5.p2.4.m4.1a"><mi id="S4.SS5.p2.4.m4.1.1" xref="S4.SS5.p2.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.4.m4.1b"><ci id="S4.SS5.p2.4.m4.1.1.cmml" xref="S4.SS5.p2.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.4.m4.1c">K</annotation></semantics></math> since a trade-off balance exists between <math id="S4.SS5.p2.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS5.p2.5.m5.1a"><mi id="S4.SS5.p2.5.m5.1.1" xref="S4.SS5.p2.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.5.m5.1b"><ci id="S4.SS5.p2.5.m5.1.1.cmml" xref="S4.SS5.p2.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.5.m5.1c">K</annotation></semantics></math> and <math id="S4.SS5.p2.6.m6.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.SS5.p2.6.m6.1a"><mi id="S4.SS5.p2.6.m6.1.1" xref="S4.SS5.p2.6.m6.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.6.m6.1b"><ci id="S4.SS5.p2.6.m6.1.1.cmml" xref="S4.SS5.p2.6.m6.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.6.m6.1c">M</annotation></semantics></math>, where <math id="S4.SS5.p2.7.m7.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.SS5.p2.7.m7.1a"><mi id="S4.SS5.p2.7.m7.1.1" xref="S4.SS5.p2.7.m7.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.7.m7.1b"><ci id="S4.SS5.p2.7.m7.1.1.cmml" xref="S4.SS5.p2.7.m7.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.7.m7.1c">M</annotation></semantics></math> is the number of candidates automatically generated by Algorithm 1 in the main manuscript. If <math id="S4.SS5.p2.8.m8.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS5.p2.8.m8.1a"><mi id="S4.SS5.p2.8.m8.1.1" xref="S4.SS5.p2.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.8.m8.1b"><ci id="S4.SS5.p2.8.m8.1.1.cmml" xref="S4.SS5.p2.8.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.8.m8.1c">K</annotation></semantics></math> is large, then <math id="S4.SS5.p2.9.m9.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S4.SS5.p2.9.m9.1a"><mi id="S4.SS5.p2.9.m9.1.1" xref="S4.SS5.p2.9.m9.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.9.m9.1b"><ci id="S4.SS5.p2.9.m9.1.1.cmml" xref="S4.SS5.p2.9.m9.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.9.m9.1c">M</annotation></semantics></math> will be small due to Rule <math id="S4.SS5.p2.10.m10.1" class="ltx_Math" alttext="\mathcal{R}_{4}" display="inline"><semantics id="S4.SS5.p2.10.m10.1a"><msub id="S4.SS5.p2.10.m10.1.1" xref="S4.SS5.p2.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS5.p2.10.m10.1.1.2" xref="S4.SS5.p2.10.m10.1.1.2.cmml">ℛ</mi><mn id="S4.SS5.p2.10.m10.1.1.3" xref="S4.SS5.p2.10.m10.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.10.m10.1b"><apply id="S4.SS5.p2.10.m10.1.1.cmml" xref="S4.SS5.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS5.p2.10.m10.1.1.1.cmml" xref="S4.SS5.p2.10.m10.1.1">subscript</csymbol><ci id="S4.SS5.p2.10.m10.1.1.2.cmml" xref="S4.SS5.p2.10.m10.1.1.2">ℛ</ci><cn type="integer" id="S4.SS5.p2.10.m10.1.1.3.cmml" xref="S4.SS5.p2.10.m10.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.10.m10.1c">\mathcal{R}_{4}</annotation></semantics></math>. In other words, a larger <math id="S4.SS5.p2.11.m11.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS5.p2.11.m11.1a"><mi id="S4.SS5.p2.11.m11.1.1" xref="S4.SS5.p2.11.m11.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.11.m11.1b"><ci id="S4.SS5.p2.11.m11.1.1.cmml" xref="S4.SS5.p2.11.m11.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.11.m11.1c">K</annotation></semantics></math> may make the empty <math id="S4.SS5.p2.12.m12.1" class="ltx_Math" alttext="\mathcal{C}_{t}" display="inline"><semantics id="S4.SS5.p2.12.m12.1a"><msub id="S4.SS5.p2.12.m12.1.1" xref="S4.SS5.p2.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS5.p2.12.m12.1.1.2" xref="S4.SS5.p2.12.m12.1.1.2.cmml">𝒞</mi><mi id="S4.SS5.p2.12.m12.1.1.3" xref="S4.SS5.p2.12.m12.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.12.m12.1b"><apply id="S4.SS5.p2.12.m12.1.1.cmml" xref="S4.SS5.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS5.p2.12.m12.1.1.1.cmml" xref="S4.SS5.p2.12.m12.1.1">subscript</csymbol><ci id="S4.SS5.p2.12.m12.1.1.2.cmml" xref="S4.SS5.p2.12.m12.1.1.2">𝒞</ci><ci id="S4.SS5.p2.12.m12.1.1.3.cmml" xref="S4.SS5.p2.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.12.m12.1c">\mathcal{C}_{t}</annotation></semantics></math> returned by Algorithm 1 in the main manuscript.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2308.08643/assets/x3.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="112" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.4.2.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.2.1" class="ltx_text" style="font-size:90%;">Results on different number of clusters <math id="S4.F4.2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.F4.2.1.m1.1b"><mi id="S4.F4.2.1.m1.1.1" xref="S4.F4.2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.F4.2.1.m1.1c"><ci id="S4.F4.2.1.m1.1.1.cmml" xref="S4.F4.2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.2.1.m1.1d">K</annotation></semantics></math>’s.</span></figcaption>
</figure>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Layer Stitching Study</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.1" class="ltx_p">One of our major contributions is to develop a new layer stitching strategy to reduce the adverse impacts of introducing public data, even with different distributions from the client data. Our proposed strategy includes two aspects: (1) using a simple layer to stitch layers and (2) reducing the number of finetuning epochs. To validate the correctness of these assumptions, we conduct the following experiments on SVHN with 12 clients, where both client data and <span id="S4.SS6.p1.1.1" class="ltx_text ltx_font_bold">labeled</span> public data are extracted from SVHN.</p>
</div>
<div id="S4.SS6.p2" class="ltx_para">
<p id="S4.SS6.p2.1" class="ltx_p"><span id="S4.SS6.p2.1.1" class="ltx_text ltx_font_bold">Stitching Layer Numbers</span>. In this experiment, we add the complexity of layers for stitching. In our model design, we only use <math id="S4.SS6.p2.1.m1.1" class="ltx_Math" alttext="\text{ReLU}(\mathbf{W}^{\top}\mathbf{X}+\mathbf{b})" display="inline"><semantics id="S4.SS6.p2.1.m1.1a"><mrow id="S4.SS6.p2.1.m1.1.1" xref="S4.SS6.p2.1.m1.1.1.cmml"><mtext id="S4.SS6.p2.1.m1.1.1.3" xref="S4.SS6.p2.1.m1.1.1.3a.cmml">ReLU</mtext><mo lspace="0em" rspace="0em" id="S4.SS6.p2.1.m1.1.1.2" xref="S4.SS6.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S4.SS6.p2.1.m1.1.1.1.1" xref="S4.SS6.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS6.p2.1.m1.1.1.1.1.2" xref="S4.SS6.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS6.p2.1.m1.1.1.1.1.1" xref="S4.SS6.p2.1.m1.1.1.1.1.1.cmml"><mrow id="S4.SS6.p2.1.m1.1.1.1.1.1.2" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2.cmml"><msup id="S4.SS6.p2.1.m1.1.1.1.1.1.2.2" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2.2.cmml"><mi id="S4.SS6.p2.1.m1.1.1.1.1.1.2.2.2" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2.2.2.cmml">𝐖</mi><mo id="S4.SS6.p2.1.m1.1.1.1.1.1.2.2.3" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2.2.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S4.SS6.p2.1.m1.1.1.1.1.1.2.1" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S4.SS6.p2.1.m1.1.1.1.1.1.2.3" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2.3.cmml">𝐗</mi></mrow><mo id="S4.SS6.p2.1.m1.1.1.1.1.1.1" xref="S4.SS6.p2.1.m1.1.1.1.1.1.1.cmml">+</mo><mi id="S4.SS6.p2.1.m1.1.1.1.1.1.3" xref="S4.SS6.p2.1.m1.1.1.1.1.1.3.cmml">𝐛</mi></mrow><mo stretchy="false" id="S4.SS6.p2.1.m1.1.1.1.1.3" xref="S4.SS6.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.1.m1.1b"><apply id="S4.SS6.p2.1.m1.1.1.cmml" xref="S4.SS6.p2.1.m1.1.1"><times id="S4.SS6.p2.1.m1.1.1.2.cmml" xref="S4.SS6.p2.1.m1.1.1.2"></times><ci id="S4.SS6.p2.1.m1.1.1.3a.cmml" xref="S4.SS6.p2.1.m1.1.1.3"><mtext id="S4.SS6.p2.1.m1.1.1.3.cmml" xref="S4.SS6.p2.1.m1.1.1.3">ReLU</mtext></ci><apply id="S4.SS6.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS6.p2.1.m1.1.1.1.1"><plus id="S4.SS6.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS6.p2.1.m1.1.1.1.1.1.1"></plus><apply id="S4.SS6.p2.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2"><times id="S4.SS6.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2.1"></times><apply id="S4.SS6.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS6.p2.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.SS6.p2.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2.2.2">𝐖</ci><csymbol cd="latexml" id="S4.SS6.p2.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2.2.3">top</csymbol></apply><ci id="S4.SS6.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS6.p2.1.m1.1.1.1.1.1.2.3">𝐗</ci></apply><ci id="S4.SS6.p2.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS6.p2.1.m1.1.1.1.1.1.3">𝐛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.1.m1.1c">\text{ReLU}(\mathbf{W}^{\top}\mathbf{X}+\mathbf{b})</annotation></semantics></math>. Now, we increase the number of linear layers from 1 to 2 to 3. The results are depicted in Figure <a href="#S4.F6" title="Figure 6 ‣ 4.6 Layer Stitching Study ‣ 4 Experiments ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. We can observe that under both IID and Non-IID settings, the performance will decrease with the increase of the complexity of the stitching layers. These results demonstrate our assumption that more complex stitching layers will introduce more information about public data but reduce the personalized information of each client model maintained. Thus, using a simple layer to stitch layers is a reasonable choice.</p>
</div>
<div id="S4.SS6.p3" class="ltx_para">
<p id="S4.SS6.p3.1" class="ltx_p"><span id="S4.SS6.p3.1.1" class="ltx_text ltx_font_bold">Stitched Model Finetuning Numbers</span>. We further explore the influence of the number of finetuning epochs on the stitched model. The results are shown in Figure <a href="#S4.F6" title="Figure 6 ‣ 4.6 Layer Stitching Study ‣ 4 Experiments ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. We can observe that increasing the number of finetuning epochs can also introduce more public data information and reduce model performance. Thus, setting a small number of finetuning epochs benefits keeping the model’s performance.</p>
</div>
<figure id="S4.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F6.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:173.4pt;"><img src="/html/2308.08643/assets/x4.png" id="S4.F6.1.g1" class="ltx_graphics ltx_img_landscape" width="169" height="90" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.1.1.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F6.1.2.2" class="ltx_text" style="font-size:90%;">Stitching layer number study.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F6.2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_top" style="width:169.1pt;"><img src="/html/2308.08643/assets/x5.png" id="S4.F6.2.g1" class="ltx_graphics ltx_img_landscape" width="163" height="92" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.2.1.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S4.F6.2.2.2" class="ltx_text" style="font-size:90%;">Server finetuning number study.</span></figcaption>
</figure>
</div>
</div>
</figure>
<figure id="S4.F7" class="ltx_figure ltx_align_floatright"><img src="/html/2308.08643/assets/x6.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="161" height="92" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F7.2.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S4.F7.3.2" class="ltx_text" style="font-size:90%;">Candidate models.</span></figcaption>
</figure>
</section>
<section id="S4.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7 </span>Personalized Model Visualization</h3>

<div id="S4.SS7.p1" class="ltx_para">
<p id="S4.SS7.p1.4" class="ltx_p"><span id="S4.SS7.p1.4.1" class="ltx_text ltx_font_typewriter">pFedHR</span> can automatically and dynamically generate candidates for clients using the proposed heterogeneous model reassembly techniques in Section <a href="#S3.SS1.SSS2" title="3.1.2 Heterogeneous Model Reassembly – 𝑔⁢(⋅,⋅) ‣ 3.1 Server Update ‣ 3 Methodology ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1.2</span></a>. We visualize the generated models for a client at two different epochs (<math id="S4.SS7.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS7.p1.1.m1.1a"><mi id="S4.SS7.p1.1.m1.1.1" xref="S4.SS7.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.1.m1.1b"><ci id="S4.SS7.p1.1.m1.1.1.cmml" xref="S4.SS7.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.1.m1.1c">t</annotation></semantics></math> and <math id="S4.SS7.p1.2.m2.1" class="ltx_Math" alttext="t^{\prime}" display="inline"><semantics id="S4.SS7.p1.2.m2.1a"><msup id="S4.SS7.p1.2.m2.1.1" xref="S4.SS7.p1.2.m2.1.1.cmml"><mi id="S4.SS7.p1.2.m2.1.1.2" xref="S4.SS7.p1.2.m2.1.1.2.cmml">t</mi><mo id="S4.SS7.p1.2.m2.1.1.3" xref="S4.SS7.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.2.m2.1b"><apply id="S4.SS7.p1.2.m2.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS7.p1.2.m2.1.1.1.cmml" xref="S4.SS7.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS7.p1.2.m2.1.1.2.cmml" xref="S4.SS7.p1.2.m2.1.1.2">𝑡</ci><ci id="S4.SS7.p1.2.m2.1.1.3.cmml" xref="S4.SS7.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.2.m2.1c">t^{\prime}</annotation></semantics></math>) to make a comparison in Figure <a href="#S4.F7" title="Figure 7 ‣ 4.6 Layer Stitching Study ‣ 4 Experiments ‣ Towards Personalized Federated Learning via Heterogeneous Model Reassembly" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. We can observe that at epoch <math id="S4.SS7.p1.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS7.p1.3.m3.1a"><mi id="S4.SS7.p1.3.m3.1.1" xref="S4.SS7.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.3.m3.1b"><ci id="S4.SS7.p1.3.m3.1.1.cmml" xref="S4.SS7.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.3.m3.1c">t</annotation></semantics></math>, the layers are “[<em id="S4.SS7.p1.4.2" class="ltx_emph ltx_font_italic">Conv2</em> from M1, <em id="S4.SS7.p1.4.3" class="ltx_emph ltx_font_italic">Conv3</em> from M2, <em id="S4.SS7.p1.4.4" class="ltx_emph ltx_font_italic">Conv4</em> from M3, <em id="S4.SS7.p1.4.5" class="ltx_emph ltx_font_italic">Conv5</em> from M3, <em id="S4.SS7.p1.4.6" class="ltx_emph ltx_font_italic">FC3</em> from M2]”, which is significantly different the model structure at epoch <math id="S4.SS7.p1.4.m4.1" class="ltx_Math" alttext="t^{\prime}" display="inline"><semantics id="S4.SS7.p1.4.m4.1a"><msup id="S4.SS7.p1.4.m4.1.1" xref="S4.SS7.p1.4.m4.1.1.cmml"><mi id="S4.SS7.p1.4.m4.1.1.2" xref="S4.SS7.p1.4.m4.1.1.2.cmml">t</mi><mo id="S4.SS7.p1.4.m4.1.1.3" xref="S4.SS7.p1.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.4.m4.1b"><apply id="S4.SS7.p1.4.m4.1.1.cmml" xref="S4.SS7.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS7.p1.4.m4.1.1.1.cmml" xref="S4.SS7.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS7.p1.4.m4.1.1.2.cmml" xref="S4.SS7.p1.4.m4.1.1.2">𝑡</ci><ci id="S4.SS7.p1.4.m4.1.1.3.cmml" xref="S4.SS7.p1.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS7.p1.4.m4.1c">t^{\prime}</annotation></semantics></math>.
These models automatically reassemble different layers from different models learned by the proposed <span id="S4.SS7.p1.4.7" class="ltx_text ltx_font_typewriter">pFedHR</span> instead of using predefined structures or consensus information.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">Model heterogeneity is a crucial and practical challenge in federated learning. While a few studies have addressed this problem, existing models still encounter various issues. To bridge this research gap, we propose a novel framework, named <span id="S5.p1.1.1" class="ltx_text ltx_font_typewriter">pFedHR</span>, for personalized federated learning, focusing on solving the problem of heterogeneous model cooperation.
The experimental results conducted on three datasets, under both IID and Non-IID settings, have verified the effectiveness of our proposed <span id="S5.p1.1.2" class="ltx_text ltx_font_typewriter">pFedHR</span> framework in addressing the model heterogeneity issue in federated learning. The achieved state-of-the-art performance serves as evidence of the efficacy and practicality of our approach.
<span id="S5.p1.1.3" class="ltx_text ltx_font_bold">Acknowledgements</span>
This work is partially supported by the National Science Foundation under Grant No. 2212323 and 2238275.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Peter Kairouz, H Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi
Bennis, Arjun Nitin Bhagoji, Kallista Bonawitz, Zachary Charles, Graham
Cormode, Rachel Cummings, et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Foundations and Trends® in Machine Learning</span>,
14(1–2):1–210, 2021.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Proceedings of Machine learning and systems</span>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Viraaji Mothukuri, Reza M Parizi, Seyedamin Pouriyeh, Yan Huang, Ali
Dehghantanha, and Gautam Srivastava.

</span>
<span class="ltx_bibblock">A survey on security and privacy of federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">Future Generation Computer Systems</span>, 115:619–640, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pages 1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Yue Tan, Guodong Long, Jie Ma, Lu Liu, Tianyi Zhou, and Jing Jiang.

</span>
<span class="ltx_bibblock">Federated learning from pre-trained models: A contrastive learning
approach.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2209.10083</span>, 2022.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Yue Tan, Guodong Long, Lu Liu, Tianyi Zhou, Qinghua Lu, Jing Jiang, and Chengqi
Zhang.

</span>
<span class="ltx_bibblock">Fedproto: Federated prototype learning across heterogeneous clients.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</span>, volume 36, pages 8432–8440, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Krishna Pillutla, Kshitiz Malik, Abdel-Rahman Mohamed, Mike Rabbat, Maziar
Sanjabi, and Lin Xiao.

</span>
<span class="ltx_bibblock">Federated learning with partial model personalization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
17716–17758. PMLR, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Avishek Ghosh, Jichan Chung, Dong Yin, and Kannan Ramchandran.

</span>
<span class="ltx_bibblock">An efficient framework for clustered federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
33:19586–19597, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Tianfei Zhou and Ender Konukoglu.

</span>
<span class="ltx_bibblock">Fedfa: Federated feature augmentation.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2301.12995</span>, 2023.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Fengwen Chen, Guodong Long, Zonghan Wu, Tianyi Zhou, and Jing Jiang.

</span>
<span class="ltx_bibblock">Personalized federated learning with graph.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2203.00829</span>, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Jianyu Wang, Qinghua Liu, Hao Liang, Gauri Joshi, and H Vincent Poor.

</span>
<span class="ltx_bibblock">Tackling the objective inconsistency problem in heterogeneous
federated optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>,
33:7611–7623, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Yue Wu, Shuaicheng Zhang, Wenchao Yu, Yanchi Liu, Quanquan Gu, Dawei Zhou,
Haifeng Chen, and Wei Cheng.

</span>
<span class="ltx_bibblock">Personalized federated learning under mixture of distributions.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2305.01068</span>, 2023.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Chuhan Wu, Fangzhao Wu, Lingjuan Lyu, Yongfeng Huang, and Xing Xie.

</span>
<span class="ltx_bibblock">Communication-efficient federated learning via knowledge
distillation.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Nature communications</span>, 13(1):2032, 2022.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Daliang Li and Junpu Wang.

</span>
<span class="ltx_bibblock">Fedmd: Heterogenous federated learning via model distillation.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1910.03581</span>, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Wenke Huang, Mang Ye, and Bo Du.

</span>
<span class="ltx_bibblock">Learn from others and be yourself in heterogeneous federated
learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 10143–10153, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Tao Lin, Lingjing Kong, Sebastian U Stich, and Martin Jaggi.

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
33:2351–2363, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Sixing Yu, Wei Qian, and Ali Jannesari.

</span>
<span class="ltx_bibblock">Resource-aware federated learning using knowledge extraction and
multi-model fusion.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2208.07978</span>, 2022.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Lichao Sun and Lingjuan Lyu.

</span>
<span class="ltx_bibblock">Federated model distillation with noise-free differential privacy.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2009.05537</span>, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Liping Yi, Gang Wang, Xiaoguang Liu, Zhuan Shi, and Han Yu.

</span>
<span class="ltx_bibblock">Fedgh: Heterogeneous federated learning with generalized global
header.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2303.13137</span>, 2023.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Lingjuan Lyu, Han Yu, Xingjun Ma, Chen Chen, Lichao Sun, Jun Zhao, Qiang Yang,
and S Yu Philip.

</span>
<span class="ltx_bibblock">Privacy and robustness in federated learning: Attacks and defenses.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">IEEE transactions on neural networks and learning systems</span>,
2022.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Jiaqi Wang, Shenglai Zeng, Zewei Long, Yaqing Wang, Houping Xiao, and Fenglong
Ma.

</span>
<span class="ltx_bibblock">Knowledge-enhanced semi-supervised federated learning for aggregating
heterogeneous lightweight clients in iot.

</span>
<span class="ltx_bibblock">In <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Proceedings of the 2023 SIAM International Conference on Data
Mining (SDM)</span>, pages 496–504. SIAM, 2023.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Xingyi Yang, Daquan Zhou, Songhua Liu, Jingwen Ye, and Xinchao Wang.

</span>
<span class="ltx_bibblock">Deep model reassembly.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>,
35:25739–25753, 2022.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.

</span>
<span class="ltx_bibblock">Personalized federated learning with theoretical guarantees: A
model-agnostic meta-learning approach.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
33:3557–3568, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Canh T Dinh, Nguyen Tran, and Josh Nguyen.

</span>
<span class="ltx_bibblock">Personalized federated learning with moreau envelopes.

</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
33:21394–21405, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Xu Zhang, Yinchuan Li, Wenpeng Li, Kaiyang Guo, and Yunfeng Shao.

</span>
<span class="ltx_bibblock">Personalized federated learning via variational bayesian inference.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
26293–26310. PMLR, 2022.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Enmao Diao, Jie Ding, and Vahid Tarokh.

</span>
<span class="ltx_bibblock">Heterofl: Computation and communication efficient federated learning
for heterogeneous clients.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2010.01264</span>, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Xiaofeng Lu, Yuying Liao, Chao Liu, Pietro Lio, and Pan Hui.

</span>
<span class="ltx_bibblock">Heterogeneous model fusion federated learning mechanism based on
model mapping.

</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">IEEE Internet of Things Journal</span>, 9(8):6058–6068, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Jiankai Sun, Xin Yang, Yuanshun Yao, Aonan Zhang, Weihao Gao, Junyuan Xie, and
Chong Wang.

</span>
<span class="ltx_bibblock">Vertical federated learning without revealing intersection
membership.

</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2106.05508</span>, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Yamini Bansal, Preetum Nakkiran, and Boaz Barak.

</span>
<span class="ltx_bibblock">Revisiting model stitching to compare neural representations.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 34:225–236,
2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Samuel K Ainsworth, Jonathan Hayase, and Siddhartha Srinivasa.

</span>
<span class="ltx_bibblock">Git re-basin: Merging models modulo permutation symmetries.

</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2209.04836</span>, 2022.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Zizheng Pan, Jianfei Cai, and Bohan Zhuang.

</span>
<span class="ltx_bibblock">Stitchable neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2302.06586</span>, 2023.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Dang Nguyen, Trang Nguyen, Khai Nguyen, Dinh Phung, Hung Bui, and Nhat Ho.

</span>
<span class="ltx_bibblock">On cross-layer alignment for model fusion of heterogeneous neural
networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">ICASSP 2023-2023 IEEE International Conference on Acoustics,
Speech and Signal Processing (ICASSP)</span>, pages 1–5. IEEE, 2023.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Simon Kornblith, Mohammad Norouzi, Honglak Lee, and Geoffrey Hinton.

</span>
<span class="ltx_bibblock">Similarity of neural network representations revisited.

</span>
<span class="ltx_bibblock">In <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
3519–3529. PMLR, 2019.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Ting Chen, Simon Kornblith, Mohammad Norouzi, and Geoffrey Hinton.

</span>
<span class="ltx_bibblock">A simple framework for contrastive learning of visual
representations.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">International conference on machine learning</span>, pages
1597–1607. PMLR, 2020.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Ying Zhang, Tao Xiang, Timothy M Hospedales, and Huchuan Lu.

</span>
<span class="ltx_bibblock">Deep mutual learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, pages 4320–4328, 2018.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2308.08642" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2308.08643" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2308.08643">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2308.08643" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2308.08644" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 12:25:12 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
