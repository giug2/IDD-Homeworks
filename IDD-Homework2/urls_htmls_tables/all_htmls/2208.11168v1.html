<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2208.11168] Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks</title><meta property="og:description" content="Geometric Deep Learning has recently attracted significant
interest in a wide range of machine learning fields, including document analysis. The application of Graph Neural Networks (GNNs) has become crucial in various…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2208.11168">

<!--Generated on Wed Mar 13 20:18:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Document Analysis and Recognition ">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="id1" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>Dipartimento di Ingegneria dell’Informazione (DINFO)
<br class="ltx_break">Università degli studi di Firenze, Italy
<br class="ltx_break"><span id="id1.1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>{andrea.gemelli, enrico.civitelli, simone.marinai}@unifi.it</span></span></span>
</span></span></span><span id="id2" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">institutetext: </span>Computer Vision Center &amp; Computer Science Department
<br class="ltx_break">Universitat Autònoma de Barcelona, Spain
<br class="ltx_break"><span id="id2.1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">email: </span>{sbiswas, josep}@cvc.uab.es</span></span></span></span></span></span>
<h1 class="ltx_title ltx_title_document">Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Andrea Gemelli 
</span><span class="ltx_author_notes">11
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0002-6149-8282" title="ORCID identifier" class="ltx_ref">0000-0002-6149-8282</a></span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sanket Biswas
</span><span class="ltx_author_notes">22
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0001-6648-8270" title="ORCID identifier" class="ltx_ref">0000-0001-6648-8270</a></span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Enrico Civitelli
</span><span class="ltx_author_notes">11
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0001-5322-4831" title="ORCID identifier" class="ltx_ref">0000-0001-5322-4831</a></span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Josep Lladós
</span><span class="ltx_author_notes">22
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0002-4533-4739" title="ORCID identifier" class="ltx_ref">0000-0002-4533-4739</a></span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Simone Marinai
</span><span class="ltx_author_notes">11
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0002-6702-2277" title="ORCID identifier" class="ltx_ref">0000-0002-6702-2277</a></span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id5.id1" class="ltx_p">Geometric Deep Learning has recently attracted significant
interest in a wide range of machine learning fields, including document analysis. The application of Graph Neural Networks (GNNs) has become crucial in various document-related tasks since they can unravel important structural patterns, fundamental in key information extraction processes. Previous works in the literature propose task-driven models and do not take into account the full power of graphs. We propose Doc2Graph, a task-agnostic document understanding framework based on a GNN model, to solve different tasks given different types of documents. We evaluated our approach on two challenging datasets for key information extraction in form understanding, invoice layout analysis and table detection. Our code is freely accessible on <a target="_blank" href="https://github.com/andreagemelli/doc2graph" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/andreagemelli/doc2graph</a>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Document Analysis and Recognition <math id="id1.m1.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="id1.m1.1a"><mo id="id1.m1.1.1" xref="id1.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="id1.m1.1b"><ci id="id1.m1.1.1.cmml" xref="id1.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="id1.m1.1c">\cdot</annotation></semantics></math> Graph Neural Networks <math id="id2.m2.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="id2.m2.1a"><mo id="id2.m2.1.1" xref="id2.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="id2.m2.1b"><ci id="id2.m2.1.1.cmml" xref="id2.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="id2.m2.1c">\cdot</annotation></semantics></math> Document Understanding <math id="id3.m3.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="id3.m3.1a"><mo id="id3.m3.1.1" xref="id3.m3.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="id3.m3.1b"><ci id="id3.m3.1.1.cmml" xref="id3.m3.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="id3.m3.1c">\cdot</annotation></semantics></math> Key Information Extraction <math id="id4.m4.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="id4.m4.1a"><mo id="id4.m4.1.1" xref="id4.m4.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="id4.m4.1b"><ci id="id4.m4.1.1.cmml" xref="id4.m4.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="id4.m4.1c">\cdot</annotation></semantics></math> Table Detection
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Document Intelligence deals with the ability to read, understand and interpret documents.
Document understanding can be backed by graph representations, that robustly represent objects and relations. Graph reasoning for document parsing involves manipulating structured representations of semantically meaningful document objects (titles, tables, figures) and relations, using compositional rules. Customarily, graphs have been selected as an adequate framework for leveraging structural information from documents, due to their inherent representational power to codify the object components (or semantic entities) and their pairwise relationships. In this context, recently graph neural networks (GNNs) have emerged as a powerful tool to tackle the problems of Key Information Extraction (KIE)  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, Document Layout Analysis (DLA) which includes well-studied sub-tasks like table detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, table structure recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> and table extraction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, Visual Question Answering (VQA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, synthetic document generation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and so on.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Simultaneously, the common state-of-the-art practice in the document understanding community is to utilize the power of huge pre-trained vision-language models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> that learn whether the visual, textual and layout cues of the document are correlated. Despite achieving superior performance on most document understanding tasks, large-scale document pre-training comes with a high computational cost both in terms of memory and training time.
We present a solution that does not rely on huge vision-language model pre-training modules, but rather recognizes the semantic text entities and their relationships from documents exploiting graphs. The solution has experimented on two challenging benchmarks for forms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and invoices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> with a very small amount of labeled training data.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Inspired by some prior works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, we introduce <em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">Doc2Graph</em>, a novel task-agnostic framework to exploit graph-based representations for document understanding. The proposed model is validated in three different challenges, namely KIE in form understanding, invoice layout analysis and table detection.
A graph representation module is proposed to organize the document objects. The graph nodes represent words or the semantic entities while edges the pairwise relationships between them. Finding the optimal set of edges to create the graph is anything but trivial: usually in literature heuristics are applied, e.g. using a visibility graph <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. In this work, we do not make any assumption a priori on the connectivity: rather we attempt to build a fully connected graph representation over documents and let the network learn by itself what is relevant.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In summary, the primary contributions of this work can be summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Doc2Graph, the first task-agnostic GNN-based document understanding framework, evaluated on two challenging benchmarks (form and invoice understanding) for three significant tasks, without any requirement of huge pre-training data;</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a general graph representation module for documents, that do not rely on heuristics to build pairwise relationships between words or entities;</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">A novel GNN architectural pipeline with node and edge aggregation functions suited for documents, that exploits the relative positioning of document objects through polar coordinates.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The rest of the paper is organized as follows. In section <a href="#S2" title="2 Related Work ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> we review the state-of-the-art in graph representation learning and vision-language models for document understanding. Section <a href="#S3" title="3 Method ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> provides the details of the main methodological contribution. The experimental evaluation is reported in section <a href="#S4" title="4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Finally, the conclusions are drawn in section <a href="#S5" title="5 Conclusion ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Document understanding has been studied extensively in the last few years, owing to the advent of deep learning, but has been reformulated in a recent survey by Borchmann et. al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
The tasks range from KIE performed for understanding forms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, receipts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and invoices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, to multimodal comprehension of both visual and textual cues in a document for classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. It also includes the DLA task where recent works focus on building an end-to-end framework for both detection and classification of page regions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Table detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, structure recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and extraction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> in DLA gathered some special attention in recent years due to the high variability of layouts that make the both necessary to be solved and challenging to be tackled. In addition, question answering <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> has emerged as an extension of the KIE task principle, where a natural language question replaces a property name. Current state-of-the-art approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> on these document understanding tasks have utilized the power of large pre-trained language models, relying on language more than the visual and geometrical information in a document and also end up using hundreds of millions of parameters in the process. Moreover, most of these models are trained with a huge transformer pipeline, which requires an immense amount of data during pre-training. In this regard, Davis et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and Sarkar et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> proposed language-agnostic models. In  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> they focused on the entity relationship detection problem in forms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> using a simple CNN as a text line detector and then detecting key-value relationship pairs using a heuristic based on each relationship candidate score generated from the model. Sarkar et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> rather focused on extracting the form structure by reformulating the problem as a semantic segmentation (pixel labeling) task. They used a U-Net based architectural pipeline, predicting all levels of the document hierarchy in parallel, making it quite efficient.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">GNN for document understanding was first introduced for mainly key DLA sub-tasks that include table detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and table structure recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. The key idea behind its introduction was to utilize the powerful geometrical characteristics of a document using GNN and then to preserve the privacy of confidential textual content (especially for administrative documents) during training, making the model language-independent and more structure-reliant as proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> for detection of tables in invoices. Carbonell et. al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> used graph convolutional networks (GCNs) to solve the entity(word) grouping, labeling and entity linking tasks for form analysis. They used the information of the bounding
boxes and word embeddings as the principal node features and do not include any visual features, while they used k-nearest neighbours (KNNs) to encode the edge information. The FUDGE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> framework was then developed for form understanding as an extension of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> to greatly improve the state-of-the-art on both the semantic entity labeling and entity linking tasks by proposing relationship pairs using the same detection CNN as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Then a graph convolutional network (GCN) was deployed with plugged visual features from the CNN so that semantic labels for the text entities were predicted jointly with the key-value relationship pairs, as they are quite related tasks.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Inspired by this influential prior work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, we aim to propose a task-agnostic GNN-based framework called <em id="S2.p3.1.1" class="ltx_emph ltx_font_italic">Doc2Graph</em> that adapts a similar joint prediction of both the tasks, semantic entity labeling and entity linking using a node classification and edge classification module respectively. Doc2Graph is established to tackle multiple challenges ranging from KIE for form understanding to layout analysis and table detection for invoice understanding, without needing any kind of huge data pre-training and being lightweight and efficient.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we present the proposed approach. First, we describe the pre-processing step that converts document images into graphs. Then, we describe the GNN model designed to tackle different kinds of tasks.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Documents graph structure</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">A graph is a structure made of nodes and edges. A graph can be seen as a language model representing a document in terms of its segments (text units) and relationships. A preprocessing step is required. Depending on the task, different levels of granularity have to be considered for defining the constituent objects of a document. They can be single words or entities, that is, groups of words that share a certain property (e.g., the name of a company). In our work we try both as the starting point of the pipeline: we apply an OCR to recognize words, while a pre-trained object detection model for detecting entities.
The chosen objects, once found, constitute the nodes of the graph.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">At this point, nodes need to be connected through edges. Finding the optimal set of edges to create the graph is anything but trivial: usually in literature heuristics are applied, e.g. using a visibility graph <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. These approaches: (i) do not generalise well on different layouts; (ii) strongly rely on the previous node detection processes, which are often prone to errors; (iii) generate noise in the connections, since bounding box of objects could cut out important relations or allow unwanted ones; (iv) exclude in advance sets of solutions, e.g. answers far from questions.
To avoid those behaviours, we do not make any assumption a priori on the connectivity: we build a fully connected graph and we let the network learn by itself what relations are relevant.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Node and edge features</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">In order to learn, suitable features should be associated to nodes and edges of the graph. In documents, this information can be extracted from sources of different modalities, such as visual, language and layout ones.
Different methods can be applied to encode a node (either word or entity) to enrich its representation. In our pipeline, with the aim to possibly keep it lightweight, we include:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p">a language model to encode the text. We use the spaCy large English model to get word vector representations of words and entities;</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p">a visual encoder to represent style and formatting. We pretrain a U-Net<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> on FUNSD for entities segmentation. Since U-Net uses feature maps at different encoder’s layers to segment the images, we decide to use all these information as visual features. Moreover, it is important to highlight that, for each features map, we used a RoI Alignment layer to extract the features relative to each entities bounding box;</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p">the absolute normalized positions of objects inside a document; layout and structure are meaningful features to include in industrial documents, e.g. for key-value associations.</p>
</div>
</li>
</ul>
<p id="S3.SS2.p1.2" class="ltx_p">As for the edges, to the best of our knowledge, we propose two new sets of features to help both the node and the edge classification tasks:</p>
<ul id="S3.I2" class="ltx_itemize">
<li id="S3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i1.p1" class="ltx_para">
<p id="S3.I2.i1.p1.1" class="ltx_p">a normalized euclidean distance between nodes, by means of the minimum distance between bounding boxes. Since we are using a fully connected graph this is crucial for the aggregation node function in use to keep locality property during the message passing algorithm;</p>
</div>
</li>
<li id="S3.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i2.p1" class="ltx_para">
<p id="S3.I2.i2.p1.2" class="ltx_p">relative positioning of nodes using polar coordinates. Each source node is considered to be in the center of a Cartesian plane and all its neighbors are encoded by means of distance and angle. We discretize the space into bins (one-hot encoded), which number can be chosen, instead of using normalized angles: a continuous representation of the angle is challenging because, for instance, two points at the same distance with angles <math id="S3.I2.i2.p1.1.m1.1" class="ltx_Math" alttext="360^{\circ}" display="inline"><semantics id="S3.I2.i2.p1.1.m1.1a"><msup id="S3.I2.i2.p1.1.m1.1.1" xref="S3.I2.i2.p1.1.m1.1.1.cmml"><mn id="S3.I2.i2.p1.1.m1.1.1.2" xref="S3.I2.i2.p1.1.m1.1.1.2.cmml">360</mn><mo id="S3.I2.i2.p1.1.m1.1.1.3" xref="S3.I2.i2.p1.1.m1.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.1.m1.1b"><apply id="S3.I2.i2.p1.1.m1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i2.p1.1.m1.1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S3.I2.i2.p1.1.m1.1.1.2.cmml" xref="S3.I2.i2.p1.1.m1.1.1.2">360</cn><compose id="S3.I2.i2.p1.1.m1.1.1.3.cmml" xref="S3.I2.i2.p1.1.m1.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.1.m1.1c">360^{\circ}</annotation></semantics></math> and <math id="S3.I2.i2.p1.2.m2.1" class="ltx_Math" alttext="0^{\circ}" display="inline"><semantics id="S3.I2.i2.p1.2.m2.1a"><msup id="S3.I2.i2.p1.2.m2.1.1" xref="S3.I2.i2.p1.2.m2.1.1.cmml"><mn id="S3.I2.i2.p1.2.m2.1.1.2" xref="S3.I2.i2.p1.2.m2.1.1.2.cmml">0</mn><mo id="S3.I2.i2.p1.2.m2.1.1.3" xref="S3.I2.i2.p1.2.m2.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.2.m2.1b"><apply id="S3.I2.i2.p1.2.m2.1.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I2.i2.p1.2.m2.1.1.1.cmml" xref="S3.I2.i2.p1.2.m2.1.1">superscript</csymbol><cn type="integer" id="S3.I2.i2.p1.2.m2.1.1.2.cmml" xref="S3.I2.i2.p1.2.m2.1.1.2">0</cn><compose id="S3.I2.i2.p1.2.m2.1.1.3.cmml" xref="S3.I2.i2.p1.2.m2.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.2.m2.1c">0^{\circ}</annotation></semantics></math> would be encoded differently.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Architecture</h3>

<figure id="S3.F1" class="ltx_figure"><img src="/html/2208.11168/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="208" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S3.F1.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Our proposed Doc2Graph framework<span id="S3.F1.4.2.1" class="ltx_text ltx_font_medium">. For visualisation purposes, the architecture shows the perspective of one node (the blue one in Doc2Graph).</span></span></figcaption>
</figure>
<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Each node feature vector passes through our proposed architecture (Fig. <a href="#S3.F1" title="Figure 1 ‣ 3.3 Architecture ‣ 3 Method ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, visualization of GNN layer inspired by <a target="_blank" href="https://distill.pub/2021/gnn-intro/" title="" class="ltx_ref ltx_href">“A Gentle Introduction to GNNs”</a>): the connectivity defines the neighborhood for the message passing, while the weight learnable matrices are shared across all nodes and edges, respectively. We make use of four different components:</p>
<ul id="S3.I3" class="ltx_itemize">
<li id="S3.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I3.i1.p1" class="ltx_para">
<p id="S3.I3.i1.p1.1" class="ltx_p">Input Projector: this module applies as many fully connected (FC) layers as there are different modalities in use, to project each of their representations into inner spaces of the same dimension; e.g., we found it to be not very informative combine low dimensional geometrical features with high dimensional visual ones, as they are;</p>
</div>
</li>
<li id="S3.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I3.i2.p1" class="ltx_para">
<p id="S3.I3.i2.p1.1" class="ltx_p">GNN Layer: we make use of a slightly different version of GraphSAGE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Using a fully connected graph, we redefine the aggregation strategy (eq. <a href="#S3.E2" title="In 3.3.1 GNN Layer ‣ 3.3 Architecture ‣ 3 Method ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>);</p>
</div>
</li>
<li id="S3.I3.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I3.i3.p1" class="ltx_para">
<p id="S3.I3.i3.p1.1" class="ltx_p">Node Predictor: this is a FC layer, that maps the representation of each node into the number of target classes;</p>
</div>
</li>
<li id="S3.I3.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I3.i4.p1" class="ltx_para">
<p id="S3.I3.i4.p1.1" class="ltx_p">Edge Predictor: this is a two-FC layer, that assigns a label to each edge. To do so, we propose a novel aggregation on edges (eq. <a href="#S3.E3" title="In 3.3.2 Edge Predictor ‣ 3.3 Architecture ‣ 3 Method ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
</li>
</ul>
</div>
<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>GNN Layer</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.4" class="ltx_p">Our version of GraphSAGE slightly differs in the neighborhood aggregation. At layer <math id="S3.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mi id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><ci id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">l</annotation></semantics></math> given a node <math id="S3.SS3.SSS1.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.SSS1.p1.2.m2.1a"><mi id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b"><ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">i</annotation></semantics></math>, <math id="S3.SS3.SSS1.p1.3.m3.1" class="ltx_Math" alttext="h_{i}" display="inline"><semantics id="S3.SS3.SSS1.p1.3.m3.1a"><msub id="S3.SS3.SSS1.p1.3.m3.1.1" xref="S3.SS3.SSS1.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS1.p1.3.m3.1.1.2" xref="S3.SS3.SSS1.p1.3.m3.1.1.2.cmml">h</mi><mi id="S3.SS3.SSS1.p1.3.m3.1.1.3" xref="S3.SS3.SSS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m3.1b"><apply id="S3.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.2">ℎ</ci><ci id="S3.SS3.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.1c">h_{i}</annotation></semantics></math> its inner representation and <math id="S3.SS3.SSS1.p1.4.m4.1" class="ltx_Math" alttext="N(i)" display="inline"><semantics id="S3.SS3.SSS1.p1.4.m4.1a"><mrow id="S3.SS3.SSS1.p1.4.m4.1.2" xref="S3.SS3.SSS1.p1.4.m4.1.2.cmml"><mi id="S3.SS3.SSS1.p1.4.m4.1.2.2" xref="S3.SS3.SSS1.p1.4.m4.1.2.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.4.m4.1.2.1" xref="S3.SS3.SSS1.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS3.SSS1.p1.4.m4.1.2.3.2" xref="S3.SS3.SSS1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.4.m4.1.2.3.2.1" xref="S3.SS3.SSS1.p1.4.m4.1.2.cmml">(</mo><mi id="S3.SS3.SSS1.p1.4.m4.1.1" xref="S3.SS3.SSS1.p1.4.m4.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.SSS1.p1.4.m4.1.2.3.2.2" xref="S3.SS3.SSS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.4.m4.1b"><apply id="S3.SS3.SSS1.p1.4.m4.1.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.2"><times id="S3.SS3.SSS1.p1.4.m4.1.2.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.2.1"></times><ci id="S3.SS3.SSS1.p1.4.m4.1.2.2.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.2.2">𝑁</ci><ci id="S3.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m4.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.4.m4.1c">N(i)</annotation></semantics></math> its set of neighbors, the aggregation is defined as:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="h_{N(i)}^{l+1}=aggregate(\{h^{l}_{j},\forall j\in N(i)\})" display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><msubsup id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml"><mi id="S3.E1.m1.3.3.3.2.2" xref="S3.E1.m1.3.3.3.2.2.cmml">h</mi><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.4.2" xref="S3.E1.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.4.2.1" xref="S3.E1.m1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.4.2.2" xref="S3.E1.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.3.cmml"><mi id="S3.E1.m1.3.3.3.3.2" xref="S3.E1.m1.3.3.3.3.2.cmml">l</mi><mo id="S3.E1.m1.3.3.3.3.1" xref="S3.E1.m1.3.3.3.3.1.cmml">+</mo><mn id="S3.E1.m1.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.cmml"><mi id="S3.E1.m1.3.3.1.3" xref="S3.E1.m1.3.3.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.2.cmml">​</mo><mi id="S3.E1.m1.3.3.1.4" xref="S3.E1.m1.3.3.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.2a" xref="S3.E1.m1.3.3.1.2.cmml">​</mo><mi id="S3.E1.m1.3.3.1.5" xref="S3.E1.m1.3.3.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.2b" xref="S3.E1.m1.3.3.1.2.cmml">​</mo><mi id="S3.E1.m1.3.3.1.6" xref="S3.E1.m1.3.3.1.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.2c" xref="S3.E1.m1.3.3.1.2.cmml">​</mo><mi id="S3.E1.m1.3.3.1.7" xref="S3.E1.m1.3.3.1.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.2d" xref="S3.E1.m1.3.3.1.2.cmml">​</mo><mi id="S3.E1.m1.3.3.1.8" xref="S3.E1.m1.3.3.1.8.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.2e" xref="S3.E1.m1.3.3.1.2.cmml">​</mo><mi id="S3.E1.m1.3.3.1.9" xref="S3.E1.m1.3.3.1.9.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.2f" xref="S3.E1.m1.3.3.1.2.cmml">​</mo><mi id="S3.E1.m1.3.3.1.10" xref="S3.E1.m1.3.3.1.10.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.2g" xref="S3.E1.m1.3.3.1.2.cmml">​</mo><mi id="S3.E1.m1.3.3.1.11" xref="S3.E1.m1.3.3.1.11.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.2h" xref="S3.E1.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml">{</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml"><msubsup id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">j</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.1.cmml">∀</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml">j</mi></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml">∈</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.4.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.1.1.4.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.2.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">i</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml">}</mo></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><eq id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2"></eq><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3">superscript</csymbol><apply id="S3.E1.m1.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.2.1.cmml" xref="S3.E1.m1.3.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.3.2.2.cmml" xref="S3.E1.m1.3.3.3.2.2">ℎ</ci><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><times id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3">𝑁</ci><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑖</ci></apply></apply><apply id="S3.E1.m1.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3"><plus id="S3.E1.m1.3.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.3.1"></plus><ci id="S3.E1.m1.3.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.3.2">𝑙</ci><cn type="integer" id="S3.E1.m1.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3">1</cn></apply></apply><apply id="S3.E1.m1.3.3.1.cmml" xref="S3.E1.m1.3.3.1"><times id="S3.E1.m1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.2"></times><ci id="S3.E1.m1.3.3.1.3.cmml" xref="S3.E1.m1.3.3.1.3">𝑎</ci><ci id="S3.E1.m1.3.3.1.4.cmml" xref="S3.E1.m1.3.3.1.4">𝑔</ci><ci id="S3.E1.m1.3.3.1.5.cmml" xref="S3.E1.m1.3.3.1.5">𝑔</ci><ci id="S3.E1.m1.3.3.1.6.cmml" xref="S3.E1.m1.3.3.1.6">𝑟</ci><ci id="S3.E1.m1.3.3.1.7.cmml" xref="S3.E1.m1.3.3.1.7">𝑒</ci><ci id="S3.E1.m1.3.3.1.8.cmml" xref="S3.E1.m1.3.3.1.8">𝑔</ci><ci id="S3.E1.m1.3.3.1.9.cmml" xref="S3.E1.m1.3.3.1.9">𝑎</ci><ci id="S3.E1.m1.3.3.1.10.cmml" xref="S3.E1.m1.3.3.1.10">𝑡</ci><ci id="S3.E1.m1.3.3.1.11.cmml" xref="S3.E1.m1.3.3.1.11">𝑒</ci><set id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1"><in id="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3"></in><list id="S3.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.1">for-all</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2">𝑗</ci></apply></list><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4"><times id="S3.E1.m1.3.3.1.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.1"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.2">𝑁</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑖</ci></apply></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">h_{N(i)}^{l+1}=aggregate(\{h^{l}_{j},\forall j\in N(i)\})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS1.p1.5" class="ltx_p">where <math id="S3.SS3.SSS1.p1.5.m1.1" class="ltx_Math" alttext="aggregate" display="inline"><semantics id="S3.SS3.SSS1.p1.5.m1.1a"><mrow id="S3.SS3.SSS1.p1.5.m1.1.1" xref="S3.SS3.SSS1.p1.5.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.5.m1.1.1.2" xref="S3.SS3.SSS1.p1.5.m1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.5.m1.1.1.1" xref="S3.SS3.SSS1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.5.m1.1.1.3" xref="S3.SS3.SSS1.p1.5.m1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.5.m1.1.1.1a" xref="S3.SS3.SSS1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.5.m1.1.1.4" xref="S3.SS3.SSS1.p1.5.m1.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.5.m1.1.1.1b" xref="S3.SS3.SSS1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.5.m1.1.1.5" xref="S3.SS3.SSS1.p1.5.m1.1.1.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.5.m1.1.1.1c" xref="S3.SS3.SSS1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.5.m1.1.1.6" xref="S3.SS3.SSS1.p1.5.m1.1.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.5.m1.1.1.1d" xref="S3.SS3.SSS1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.5.m1.1.1.7" xref="S3.SS3.SSS1.p1.5.m1.1.1.7.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.5.m1.1.1.1e" xref="S3.SS3.SSS1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.5.m1.1.1.8" xref="S3.SS3.SSS1.p1.5.m1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.5.m1.1.1.1f" xref="S3.SS3.SSS1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.5.m1.1.1.9" xref="S3.SS3.SSS1.p1.5.m1.1.1.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.5.m1.1.1.1g" xref="S3.SS3.SSS1.p1.5.m1.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.5.m1.1.1.10" xref="S3.SS3.SSS1.p1.5.m1.1.1.10.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.5.m1.1b"><apply id="S3.SS3.SSS1.p1.5.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1"><times id="S3.SS3.SSS1.p1.5.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1.1"></times><ci id="S3.SS3.SSS1.p1.5.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1.2">𝑎</ci><ci id="S3.SS3.SSS1.p1.5.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1.3">𝑔</ci><ci id="S3.SS3.SSS1.p1.5.m1.1.1.4.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1.4">𝑔</ci><ci id="S3.SS3.SSS1.p1.5.m1.1.1.5.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1.5">𝑟</ci><ci id="S3.SS3.SSS1.p1.5.m1.1.1.6.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1.6">𝑒</ci><ci id="S3.SS3.SSS1.p1.5.m1.1.1.7.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1.7">𝑔</ci><ci id="S3.SS3.SSS1.p1.5.m1.1.1.8.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1.8">𝑎</ci><ci id="S3.SS3.SSS1.p1.5.m1.1.1.9.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1.9">𝑡</ci><ci id="S3.SS3.SSS1.p1.5.m1.1.1.10.cmml" xref="S3.SS3.SSS1.p1.5.m1.1.1.10">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.5.m1.1c">aggregate</annotation></semantics></math> can be any permutation invariant operation, e.g. sum or mean.
Usually, in other domains, the graph structure is naturally given by the data itself but, as already stated, in documents this can be challenging (sec. <a href="#S3.SS1" title="3.1 Documents graph structure ‣ 3 Method ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>). Then, given a document, we redefine the above equation as:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="h_{N(i)}^{l+1}=\frac{c}{|\Upsilon(i)|}\sum_{j\in\Upsilon(i)}h^{l}_{j}" display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.5" xref="S3.E2.m1.4.5.cmml"><msubsup id="S3.E2.m1.4.5.2" xref="S3.E2.m1.4.5.2.cmml"><mi id="S3.E2.m1.4.5.2.2.2" xref="S3.E2.m1.4.5.2.2.2.cmml">h</mi><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.4.2" xref="S3.E2.m1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.4.2.1" xref="S3.E2.m1.1.1.1.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.4.2.2" xref="S3.E2.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E2.m1.4.5.2.3" xref="S3.E2.m1.4.5.2.3.cmml"><mi id="S3.E2.m1.4.5.2.3.2" xref="S3.E2.m1.4.5.2.3.2.cmml">l</mi><mo id="S3.E2.m1.4.5.2.3.1" xref="S3.E2.m1.4.5.2.3.1.cmml">+</mo><mn id="S3.E2.m1.4.5.2.3.3" xref="S3.E2.m1.4.5.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E2.m1.4.5.1" xref="S3.E2.m1.4.5.1.cmml">=</mo><mrow id="S3.E2.m1.4.5.3" xref="S3.E2.m1.4.5.3.cmml"><mfrac id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml"><mi id="S3.E2.m1.3.3.4" xref="S3.E2.m1.3.3.4.cmml">c</mi><mrow id="S3.E2.m1.3.3.2.2" xref="S3.E2.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.2.2.2" xref="S3.E2.m1.3.3.2.3.1.cmml">|</mo><mrow id="S3.E2.m1.3.3.2.2.1" xref="S3.E2.m1.3.3.2.2.1.cmml"><mi mathvariant="normal" id="S3.E2.m1.3.3.2.2.1.2" xref="S3.E2.m1.3.3.2.2.1.2.cmml">Υ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.2.2.1.1" xref="S3.E2.m1.3.3.2.2.1.1.cmml">​</mo><mrow id="S3.E2.m1.3.3.2.2.1.3.2" xref="S3.E2.m1.3.3.2.2.1.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.2.2.1.3.2.1" xref="S3.E2.m1.3.3.2.2.1.cmml">(</mo><mi id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.E2.m1.3.3.2.2.1.3.2.2" xref="S3.E2.m1.3.3.2.2.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.3.3.2.2.3" xref="S3.E2.m1.3.3.2.3.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.5.3.1" xref="S3.E2.m1.4.5.3.1.cmml">​</mo><mrow id="S3.E2.m1.4.5.3.2" xref="S3.E2.m1.4.5.3.2.cmml"><munder id="S3.E2.m1.4.5.3.2.1" xref="S3.E2.m1.4.5.3.2.1.cmml"><mo movablelimits="false" id="S3.E2.m1.4.5.3.2.1.2" xref="S3.E2.m1.4.5.3.2.1.2.cmml">∑</mo><mrow id="S3.E2.m1.4.4.1" xref="S3.E2.m1.4.4.1.cmml"><mi id="S3.E2.m1.4.4.1.3" xref="S3.E2.m1.4.4.1.3.cmml">j</mi><mo id="S3.E2.m1.4.4.1.2" xref="S3.E2.m1.4.4.1.2.cmml">∈</mo><mrow id="S3.E2.m1.4.4.1.4" xref="S3.E2.m1.4.4.1.4.cmml"><mi mathvariant="normal" id="S3.E2.m1.4.4.1.4.2" xref="S3.E2.m1.4.4.1.4.2.cmml">Υ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.4.1" xref="S3.E2.m1.4.4.1.4.1.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.4.3.2" xref="S3.E2.m1.4.4.1.4.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.4.3.2.1" xref="S3.E2.m1.4.4.1.4.cmml">(</mo><mi id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml">i</mi><mo stretchy="false" id="S3.E2.m1.4.4.1.4.3.2.2" xref="S3.E2.m1.4.4.1.4.cmml">)</mo></mrow></mrow></mrow></munder><msubsup id="S3.E2.m1.4.5.3.2.2" xref="S3.E2.m1.4.5.3.2.2.cmml"><mi id="S3.E2.m1.4.5.3.2.2.2.2" xref="S3.E2.m1.4.5.3.2.2.2.2.cmml">h</mi><mi id="S3.E2.m1.4.5.3.2.2.3" xref="S3.E2.m1.4.5.3.2.2.3.cmml">j</mi><mi id="S3.E2.m1.4.5.3.2.2.2.3" xref="S3.E2.m1.4.5.3.2.2.2.3.cmml">l</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.5.cmml" xref="S3.E2.m1.4.5"><eq id="S3.E2.m1.4.5.1.cmml" xref="S3.E2.m1.4.5.1"></eq><apply id="S3.E2.m1.4.5.2.cmml" xref="S3.E2.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.5.2.1.cmml" xref="S3.E2.m1.4.5.2">superscript</csymbol><apply id="S3.E2.m1.4.5.2.2.cmml" xref="S3.E2.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.5.2.2.1.cmml" xref="S3.E2.m1.4.5.2">subscript</csymbol><ci id="S3.E2.m1.4.5.2.2.2.cmml" xref="S3.E2.m1.4.5.2.2.2">ℎ</ci><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><times id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3">𝑁</ci><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑖</ci></apply></apply><apply id="S3.E2.m1.4.5.2.3.cmml" xref="S3.E2.m1.4.5.2.3"><plus id="S3.E2.m1.4.5.2.3.1.cmml" xref="S3.E2.m1.4.5.2.3.1"></plus><ci id="S3.E2.m1.4.5.2.3.2.cmml" xref="S3.E2.m1.4.5.2.3.2">𝑙</ci><cn type="integer" id="S3.E2.m1.4.5.2.3.3.cmml" xref="S3.E2.m1.4.5.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.4.5.3.cmml" xref="S3.E2.m1.4.5.3"><times id="S3.E2.m1.4.5.3.1.cmml" xref="S3.E2.m1.4.5.3.1"></times><apply id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3"><divide id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3"></divide><ci id="S3.E2.m1.3.3.4.cmml" xref="S3.E2.m1.3.3.4">𝑐</ci><apply id="S3.E2.m1.3.3.2.3.cmml" xref="S3.E2.m1.3.3.2.2"><abs id="S3.E2.m1.3.3.2.3.1.cmml" xref="S3.E2.m1.3.3.2.2.2"></abs><apply id="S3.E2.m1.3.3.2.2.1.cmml" xref="S3.E2.m1.3.3.2.2.1"><times id="S3.E2.m1.3.3.2.2.1.1.cmml" xref="S3.E2.m1.3.3.2.2.1.1"></times><ci id="S3.E2.m1.3.3.2.2.1.2.cmml" xref="S3.E2.m1.3.3.2.2.1.2">Υ</ci><ci id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.4.5.3.2.cmml" xref="S3.E2.m1.4.5.3.2"><apply id="S3.E2.m1.4.5.3.2.1.cmml" xref="S3.E2.m1.4.5.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.5.3.2.1.1.cmml" xref="S3.E2.m1.4.5.3.2.1">subscript</csymbol><sum id="S3.E2.m1.4.5.3.2.1.2.cmml" xref="S3.E2.m1.4.5.3.2.1.2"></sum><apply id="S3.E2.m1.4.4.1.cmml" xref="S3.E2.m1.4.4.1"><in id="S3.E2.m1.4.4.1.2.cmml" xref="S3.E2.m1.4.4.1.2"></in><ci id="S3.E2.m1.4.4.1.3.cmml" xref="S3.E2.m1.4.4.1.3">𝑗</ci><apply id="S3.E2.m1.4.4.1.4.cmml" xref="S3.E2.m1.4.4.1.4"><times id="S3.E2.m1.4.4.1.4.1.cmml" xref="S3.E2.m1.4.4.1.4.1"></times><ci id="S3.E2.m1.4.4.1.4.2.cmml" xref="S3.E2.m1.4.4.1.4.2">Υ</ci><ci id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1.1">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.4.5.3.2.2.cmml" xref="S3.E2.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.5.3.2.2.1.cmml" xref="S3.E2.m1.4.5.3.2.2">subscript</csymbol><apply id="S3.E2.m1.4.5.3.2.2.2.cmml" xref="S3.E2.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.5.3.2.2.2.1.cmml" xref="S3.E2.m1.4.5.3.2.2">superscript</csymbol><ci id="S3.E2.m1.4.5.3.2.2.2.2.cmml" xref="S3.E2.m1.4.5.3.2.2.2.2">ℎ</ci><ci id="S3.E2.m1.4.5.3.2.2.2.3.cmml" xref="S3.E2.m1.4.5.3.2.2.2.3">𝑙</ci></apply><ci id="S3.E2.m1.4.5.3.2.2.3.cmml" xref="S3.E2.m1.4.5.3.2.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">h_{N(i)}^{l+1}=\frac{c}{|\Upsilon(i)|}\sum_{j\in\Upsilon(i)}h^{l}_{j}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS1.p1.10" class="ltx_p">where <math id="S3.SS3.SSS1.p1.6.m1.4" class="ltx_Math" alttext="\Upsilon(i)=\{j\in N(i):|i-j|&lt;threshold\}" display="inline"><semantics id="S3.SS3.SSS1.p1.6.m1.4a"><mrow id="S3.SS3.SSS1.p1.6.m1.4.4" xref="S3.SS3.SSS1.p1.6.m1.4.4.cmml"><mrow id="S3.SS3.SSS1.p1.6.m1.4.4.4" xref="S3.SS3.SSS1.p1.6.m1.4.4.4.cmml"><mi mathvariant="normal" id="S3.SS3.SSS1.p1.6.m1.4.4.4.2" xref="S3.SS3.SSS1.p1.6.m1.4.4.4.2.cmml">Υ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.6.m1.4.4.4.1" xref="S3.SS3.SSS1.p1.6.m1.4.4.4.1.cmml">​</mo><mrow id="S3.SS3.SSS1.p1.6.m1.4.4.4.3.2" xref="S3.SS3.SSS1.p1.6.m1.4.4.4.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.6.m1.4.4.4.3.2.1" xref="S3.SS3.SSS1.p1.6.m1.4.4.4.cmml">(</mo><mi id="S3.SS3.SSS1.p1.6.m1.1.1" xref="S3.SS3.SSS1.p1.6.m1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.SSS1.p1.6.m1.4.4.4.3.2.2" xref="S3.SS3.SSS1.p1.6.m1.4.4.4.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS1.p1.6.m1.4.4.3" xref="S3.SS3.SSS1.p1.6.m1.4.4.3.cmml">=</mo><mrow id="S3.SS3.SSS1.p1.6.m1.4.4.2.2" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.3" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.3.1.cmml">{</mo><mrow id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.2" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.2.cmml">j</mi><mo id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.1" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.1.cmml">∈</mo><mrow id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.2" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.1" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.1.cmml">​</mo><mrow id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.3.2" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.3.2.1" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.cmml">(</mo><mi id="S3.SS3.SSS1.p1.6.m1.2.2" xref="S3.SS3.SSS1.p1.6.m1.2.2.cmml">i</mi><mo rspace="0.278em" stretchy="false" id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.3.2.2" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.278em" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.4" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.3.1.cmml">:</mo><mrow id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.cmml"><mrow id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.2" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.2.1.cmml">|</mo><mrow id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.2" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.2.cmml">i</mi><mo id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.1" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.1.cmml">−</mo><mi id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.3" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.3.cmml">j</mi></mrow><mo stretchy="false" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.3" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.2.1.cmml">|</mo></mrow><mo id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.2" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.2.cmml">&lt;</mo><mrow id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.cmml"><mi id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.2" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.3" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1a" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.4" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1b" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.5" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1c" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.6" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1d" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.7" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.7.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1e" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.8" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1f" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.9" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1g" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.10" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.10.cmml">d</mi></mrow></mrow><mo stretchy="false" id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.5" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.6.m1.4b"><apply id="S3.SS3.SSS1.p1.6.m1.4.4.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4"><eq id="S3.SS3.SSS1.p1.6.m1.4.4.3.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.3"></eq><apply id="S3.SS3.SSS1.p1.6.m1.4.4.4.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.4"><times id="S3.SS3.SSS1.p1.6.m1.4.4.4.1.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.4.1"></times><ci id="S3.SS3.SSS1.p1.6.m1.4.4.4.2.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.4.2">Υ</ci><ci id="S3.SS3.SSS1.p1.6.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m1.1.1">𝑖</ci></apply><apply id="S3.SS3.SSS1.p1.6.m1.4.4.2.3.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2"><csymbol cd="latexml" id="S3.SS3.SSS1.p1.6.m1.4.4.2.3.1.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.3">conditional-set</csymbol><apply id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1"><in id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.1"></in><ci id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.2">𝑗</ci><apply id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3"><times id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.1"></times><ci id="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.6.m1.3.3.1.1.1.3.2">𝑁</ci><ci id="S3.SS3.SSS1.p1.6.m1.2.2.cmml" xref="S3.SS3.SSS1.p1.6.m1.2.2">𝑖</ci></apply></apply><apply id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2"><lt id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.2"></lt><apply id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.2.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1"><abs id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.2.1.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.2"></abs><apply id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1"><minus id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.1"></minus><ci id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.2">𝑖</ci><ci id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3"><times id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.1"></times><ci id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.2.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.2">𝑡</ci><ci id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.3.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.3">ℎ</ci><ci id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.4.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.4">𝑟</ci><ci id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.5.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.5">𝑒</ci><ci id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.6.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.6">𝑠</ci><ci id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.7.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.7">ℎ</ci><ci id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.8.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.8">𝑜</ci><ci id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.9.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.9">𝑙</ci><ci id="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.10.cmml" xref="S3.SS3.SSS1.p1.6.m1.4.4.2.2.2.3.10">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.6.m1.4c">\Upsilon(i)=\{j\in N(i):|i-j|&lt;threshold\}</annotation></semantics></math>, <math id="S3.SS3.SSS1.p1.7.m2.1" class="ltx_Math" alttext="|i-j|" display="inline"><semantics id="S3.SS3.SSS1.p1.7.m2.1a"><mrow id="S3.SS3.SSS1.p1.7.m2.1.1.1" xref="S3.SS3.SSS1.p1.7.m2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.7.m2.1.1.1.2" xref="S3.SS3.SSS1.p1.7.m2.1.1.2.1.cmml">|</mo><mrow id="S3.SS3.SSS1.p1.7.m2.1.1.1.1" xref="S3.SS3.SSS1.p1.7.m2.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.7.m2.1.1.1.1.2" xref="S3.SS3.SSS1.p1.7.m2.1.1.1.1.2.cmml">i</mi><mo id="S3.SS3.SSS1.p1.7.m2.1.1.1.1.1" xref="S3.SS3.SSS1.p1.7.m2.1.1.1.1.1.cmml">−</mo><mi id="S3.SS3.SSS1.p1.7.m2.1.1.1.1.3" xref="S3.SS3.SSS1.p1.7.m2.1.1.1.1.3.cmml">j</mi></mrow><mo stretchy="false" id="S3.SS3.SSS1.p1.7.m2.1.1.1.3" xref="S3.SS3.SSS1.p1.7.m2.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.7.m2.1b"><apply id="S3.SS3.SSS1.p1.7.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p1.7.m2.1.1.1"><abs id="S3.SS3.SSS1.p1.7.m2.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.7.m2.1.1.1.2"></abs><apply id="S3.SS3.SSS1.p1.7.m2.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m2.1.1.1.1"><minus id="S3.SS3.SSS1.p1.7.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m2.1.1.1.1.1"></minus><ci id="S3.SS3.SSS1.p1.7.m2.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.7.m2.1.1.1.1.2">𝑖</ci><ci id="S3.SS3.SSS1.p1.7.m2.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.7.m2.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.7.m2.1c">|i-j|</annotation></semantics></math> is the Euclidean distance of nodes <math id="S3.SS3.SSS1.p1.8.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.SSS1.p1.8.m3.1a"><mi id="S3.SS3.SSS1.p1.8.m3.1.1" xref="S3.SS3.SSS1.p1.8.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.8.m3.1b"><ci id="S3.SS3.SSS1.p1.8.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.8.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.8.m3.1c">i</annotation></semantics></math> and <math id="S3.SS3.SSS1.p1.9.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.SSS1.p1.9.m4.1a"><mi id="S3.SS3.SSS1.p1.9.m4.1.1" xref="S3.SS3.SSS1.p1.9.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.9.m4.1b"><ci id="S3.SS3.SSS1.p1.9.m4.1.1.cmml" xref="S3.SS3.SSS1.p1.9.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.9.m4.1c">j</annotation></semantics></math> saved (normalized between 0 and 1) on their connecting edge, and <math id="S3.SS3.SSS1.p1.10.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS3.SSS1.p1.10.m5.1a"><mi id="S3.SS3.SSS1.p1.10.m5.1.1" xref="S3.SS3.SSS1.p1.10.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.10.m5.1b"><ci id="S3.SS3.SSS1.p1.10.m5.1.1.cmml" xref="S3.SS3.SSS1.p1.10.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.10.m5.1c">c</annotation></semantics></math> is a constant scale factor.</p>
</div>
</section>
<section id="S3.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Edge Predictor</h4>

<div id="S3.SS3.SSS2.p1" class="ltx_para">
<p id="S3.SS3.SSS2.p1.5" class="ltx_p">We consider each edge as a triplet (<math id="S3.SS3.SSS2.p1.1.m1.3" class="ltx_Math" alttext="src,e,dst" display="inline"><semantics id="S3.SS3.SSS2.p1.1.m1.3a"><mrow id="S3.SS3.SSS2.p1.1.m1.3.3.2" xref="S3.SS3.SSS2.p1.1.m1.3.3.3.cmml"><mrow id="S3.SS3.SSS2.p1.1.m1.2.2.1.1" xref="S3.SS3.SSS2.p1.1.m1.2.2.1.1.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.2.2.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.2.2.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.1.m1.2.2.1.1.1" xref="S3.SS3.SSS2.p1.1.m1.2.2.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.1.m1.2.2.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.2.2.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.1.m1.2.2.1.1.1a" xref="S3.SS3.SSS2.p1.1.m1.2.2.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.1.m1.2.2.1.1.4" xref="S3.SS3.SSS2.p1.1.m1.2.2.1.1.4.cmml">c</mi></mrow><mo id="S3.SS3.SSS2.p1.1.m1.3.3.2.3" xref="S3.SS3.SSS2.p1.1.m1.3.3.3.cmml">,</mo><mi id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml">e</mi><mo id="S3.SS3.SSS2.p1.1.m1.3.3.2.4" xref="S3.SS3.SSS2.p1.1.m1.3.3.3.cmml">,</mo><mrow id="S3.SS3.SSS2.p1.1.m1.3.3.2.2" xref="S3.SS3.SSS2.p1.1.m1.3.3.2.2.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.3.3.2.2.2" xref="S3.SS3.SSS2.p1.1.m1.3.3.2.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.1.m1.3.3.2.2.1" xref="S3.SS3.SSS2.p1.1.m1.3.3.2.2.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.1.m1.3.3.2.2.3" xref="S3.SS3.SSS2.p1.1.m1.3.3.2.2.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.1.m1.3.3.2.2.1a" xref="S3.SS3.SSS2.p1.1.m1.3.3.2.2.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.1.m1.3.3.2.2.4" xref="S3.SS3.SSS2.p1.1.m1.3.3.2.2.4.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.3b"><list id="S3.SS3.SSS2.p1.1.m1.3.3.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3.2"><apply id="S3.SS3.SSS2.p1.1.m1.2.2.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.2.2.1.1"><times id="S3.SS3.SSS2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.2.2.1.1.1"></times><ci id="S3.SS3.SSS2.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.2.2.1.1.2">𝑠</ci><ci id="S3.SS3.SSS2.p1.1.m1.2.2.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.2.2.1.1.3">𝑟</ci><ci id="S3.SS3.SSS2.p1.1.m1.2.2.1.1.4.cmml" xref="S3.SS3.SSS2.p1.1.m1.2.2.1.1.4">𝑐</ci></apply><ci id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">𝑒</ci><apply id="S3.SS3.SSS2.p1.1.m1.3.3.2.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3.2.2"><times id="S3.SS3.SSS2.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3.2.2.1"></times><ci id="S3.SS3.SSS2.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3.2.2.2">𝑑</ci><ci id="S3.SS3.SSS2.p1.1.m1.3.3.2.2.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3.2.2.3">𝑠</ci><ci id="S3.SS3.SSS2.p1.1.m1.3.3.2.2.4.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3.2.2.4">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.3c">src,e,dst</annotation></semantics></math>): <math id="S3.SS3.SSS2.p1.2.m2.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mi id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><ci id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">e</annotation></semantics></math> is the edge connecting the source (<math id="S3.SS3.SSS2.p1.3.m3.1" class="ltx_Math" alttext="src" display="inline"><semantics id="S3.SS3.SSS2.p1.3.m3.1a"><mrow id="S3.SS3.SSS2.p1.3.m3.1.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p1.3.m3.1.1.2" xref="S3.SS3.SSS2.p1.3.m3.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.3.m3.1.1.1" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.3.m3.1.1.3" xref="S3.SS3.SSS2.p1.3.m3.1.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.3.m3.1.1.1a" xref="S3.SS3.SSS2.p1.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.3.m3.1.1.4" xref="S3.SS3.SSS2.p1.3.m3.1.1.4.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.3.m3.1b"><apply id="S3.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1"><times id="S3.SS3.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.1"></times><ci id="S3.SS3.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.2">𝑠</ci><ci id="S3.SS3.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.3">𝑟</ci><ci id="S3.SS3.SSS2.p1.3.m3.1.1.4.cmml" xref="S3.SS3.SSS2.p1.3.m3.1.1.4">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.3.m3.1c">src</annotation></semantics></math>) and destination (<math id="S3.SS3.SSS2.p1.4.m4.1" class="ltx_Math" alttext="dst" display="inline"><semantics id="S3.SS3.SSS2.p1.4.m4.1a"><mrow id="S3.SS3.SSS2.p1.4.m4.1.1" xref="S3.SS3.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p1.4.m4.1.1.2" xref="S3.SS3.SSS2.p1.4.m4.1.1.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.4.m4.1.1.1" xref="S3.SS3.SSS2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.1.3" xref="S3.SS3.SSS2.p1.4.m4.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.4.m4.1.1.1a" xref="S3.SS3.SSS2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.4.m4.1.1.4" xref="S3.SS3.SSS2.p1.4.m4.1.1.4.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.4.m4.1b"><apply id="S3.SS3.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1"><times id="S3.SS3.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.1"></times><ci id="S3.SS3.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.2">𝑑</ci><ci id="S3.SS3.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.3">𝑠</ci><ci id="S3.SS3.SSS2.p1.4.m4.1.1.4.cmml" xref="S3.SS3.SSS2.p1.4.m4.1.1.4">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.4.m4.1c">dst</annotation></semantics></math>) node.
The edge representation <math id="S3.SS3.SSS2.p1.5.m5.1" class="ltx_Math" alttext="h_{e}" display="inline"><semantics id="S3.SS3.SSS2.p1.5.m5.1a"><msub id="S3.SS3.SSS2.p1.5.m5.1.1" xref="S3.SS3.SSS2.p1.5.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p1.5.m5.1.1.2" xref="S3.SS3.SSS2.p1.5.m5.1.1.2.cmml">h</mi><mi id="S3.SS3.SSS2.p1.5.m5.1.1.3" xref="S3.SS3.SSS2.p1.5.m5.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.5.m5.1b"><apply id="S3.SS3.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.5.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.5.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p1.5.m5.1.1.2">ℎ</ci><ci id="S3.SS3.SSS2.p1.5.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p1.5.m5.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.5.m5.1c">h_{e}</annotation></semantics></math> to feed into the two-FC classifier is defined as:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.2" class="ltx_Math" alttext="h_{e}=h_{src}\;\|\;h_{dst}\;\|\;cls_{src}\;\|\;cls_{dst}\;\|\;e_{polar}" display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><msub id="S3.E3.m1.2.2.4" xref="S3.E3.m1.2.2.4.cmml"><mi id="S3.E3.m1.2.2.4.2" xref="S3.E3.m1.2.2.4.2.cmml">h</mi><mi id="S3.E3.m1.2.2.4.3" xref="S3.E3.m1.2.2.4.3.cmml">e</mi></msub><mo id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.2.3.cmml">=</mo><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><msub id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.4.cmml"><mi id="S3.E3.m1.2.2.2.4.2" xref="S3.E3.m1.2.2.2.4.2.cmml">h</mi><mrow id="S3.E3.m1.2.2.2.4.3" xref="S3.E3.m1.2.2.2.4.3.cmml"><mi id="S3.E3.m1.2.2.2.4.3.2" xref="S3.E3.m1.2.2.2.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.4.3.1" xref="S3.E3.m1.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.2.4.3.3" xref="S3.E3.m1.2.2.2.4.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.4.3.1a" xref="S3.E3.m1.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.2.4.3.4" xref="S3.E3.m1.2.2.2.4.3.4.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.2.cmml"><mo rspace="0.280em" stretchy="false" id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml">h</mi><mrow id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.3.1a" xref="S3.E3.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.1.1.1.3.4" xref="S3.E3.m1.1.1.1.1.1.1.3.4.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo lspace="0.280em" rspace="0em" id="S3.E3.m1.2.2.2.3a" xref="S3.E3.m1.2.2.2.3.cmml">​</mo><mi id="S3.E3.m1.2.2.2.5" xref="S3.E3.m1.2.2.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.3b" xref="S3.E3.m1.2.2.2.3.cmml">​</mo><mi id="S3.E3.m1.2.2.2.6" xref="S3.E3.m1.2.2.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.3c" xref="S3.E3.m1.2.2.2.3.cmml">​</mo><msub id="S3.E3.m1.2.2.2.7" xref="S3.E3.m1.2.2.2.7.cmml"><mi id="S3.E3.m1.2.2.2.7.2" xref="S3.E3.m1.2.2.2.7.2.cmml">s</mi><mrow id="S3.E3.m1.2.2.2.7.3" xref="S3.E3.m1.2.2.2.7.3.cmml"><mi id="S3.E3.m1.2.2.2.7.3.2" xref="S3.E3.m1.2.2.2.7.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.7.3.1" xref="S3.E3.m1.2.2.2.7.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.2.7.3.3" xref="S3.E3.m1.2.2.2.7.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.7.3.1a" xref="S3.E3.m1.2.2.2.7.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.2.7.3.4" xref="S3.E3.m1.2.2.2.7.3.4.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.3d" xref="S3.E3.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E3.m1.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.cmml"><mo rspace="0.280em" stretchy="false" id="S3.E3.m1.2.2.2.2.1.2" xref="S3.E3.m1.2.2.2.2.2.1.cmml">‖</mo><mrow id="S3.E3.m1.2.2.2.2.1.1" xref="S3.E3.m1.2.2.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.cmml">​</mo><mi id="S3.E3.m1.2.2.2.2.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.1a" xref="S3.E3.m1.2.2.2.2.1.1.1.cmml">​</mo><msub id="S3.E3.m1.2.2.2.2.1.1.4" xref="S3.E3.m1.2.2.2.2.1.1.4.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.4.2" xref="S3.E3.m1.2.2.2.2.1.1.4.2.cmml">s</mi><mrow id="S3.E3.m1.2.2.2.2.1.1.4.3" xref="S3.E3.m1.2.2.2.2.1.1.4.3.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.4.3.2" xref="S3.E3.m1.2.2.2.2.1.1.4.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.4.3.1" xref="S3.E3.m1.2.2.2.2.1.1.4.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.2.2.1.1.4.3.3" xref="S3.E3.m1.2.2.2.2.1.1.4.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.4.3.1a" xref="S3.E3.m1.2.2.2.2.1.1.4.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.2.2.1.1.4.3.4" xref="S3.E3.m1.2.2.2.2.1.1.4.3.4.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E3.m1.2.2.2.2.1.3" xref="S3.E3.m1.2.2.2.2.2.1.cmml">‖</mo></mrow><mo lspace="0.280em" rspace="0em" id="S3.E3.m1.2.2.2.3e" xref="S3.E3.m1.2.2.2.3.cmml">​</mo><msub id="S3.E3.m1.2.2.2.8" xref="S3.E3.m1.2.2.2.8.cmml"><mi id="S3.E3.m1.2.2.2.8.2" xref="S3.E3.m1.2.2.2.8.2.cmml">e</mi><mrow id="S3.E3.m1.2.2.2.8.3" xref="S3.E3.m1.2.2.2.8.3.cmml"><mi id="S3.E3.m1.2.2.2.8.3.2" xref="S3.E3.m1.2.2.2.8.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.8.3.1" xref="S3.E3.m1.2.2.2.8.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.2.8.3.3" xref="S3.E3.m1.2.2.2.8.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.8.3.1a" xref="S3.E3.m1.2.2.2.8.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.2.8.3.4" xref="S3.E3.m1.2.2.2.8.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.8.3.1b" xref="S3.E3.m1.2.2.2.8.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.2.8.3.5" xref="S3.E3.m1.2.2.2.8.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.8.3.1c" xref="S3.E3.m1.2.2.2.8.3.1.cmml">​</mo><mi id="S3.E3.m1.2.2.2.8.3.6" xref="S3.E3.m1.2.2.2.8.3.6.cmml">r</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><eq id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2.3"></eq><apply id="S3.E3.m1.2.2.4.cmml" xref="S3.E3.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.4.1.cmml" xref="S3.E3.m1.2.2.4">subscript</csymbol><ci id="S3.E3.m1.2.2.4.2.cmml" xref="S3.E3.m1.2.2.4.2">ℎ</ci><ci id="S3.E3.m1.2.2.4.3.cmml" xref="S3.E3.m1.2.2.4.3">𝑒</ci></apply><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><times id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3"></times><apply id="S3.E3.m1.2.2.2.4.cmml" xref="S3.E3.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.4.1.cmml" xref="S3.E3.m1.2.2.2.4">subscript</csymbol><ci id="S3.E3.m1.2.2.2.4.2.cmml" xref="S3.E3.m1.2.2.2.4.2">ℎ</ci><apply id="S3.E3.m1.2.2.2.4.3.cmml" xref="S3.E3.m1.2.2.2.4.3"><times id="S3.E3.m1.2.2.2.4.3.1.cmml" xref="S3.E3.m1.2.2.2.4.3.1"></times><ci id="S3.E3.m1.2.2.2.4.3.2.cmml" xref="S3.E3.m1.2.2.2.4.3.2">𝑠</ci><ci id="S3.E3.m1.2.2.2.4.3.3.cmml" xref="S3.E3.m1.2.2.2.4.3.3">𝑟</ci><ci id="S3.E3.m1.2.2.2.4.3.4.cmml" xref="S3.E3.m1.2.2.2.4.3.4">𝑐</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">ℎ</ci><apply id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><times id="S3.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2">𝑑</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3">𝑠</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.4">𝑡</ci></apply></apply></apply><ci id="S3.E3.m1.2.2.2.5.cmml" xref="S3.E3.m1.2.2.2.5">𝑐</ci><ci id="S3.E3.m1.2.2.2.6.cmml" xref="S3.E3.m1.2.2.2.6">𝑙</ci><apply id="S3.E3.m1.2.2.2.7.cmml" xref="S3.E3.m1.2.2.2.7"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.7.1.cmml" xref="S3.E3.m1.2.2.2.7">subscript</csymbol><ci id="S3.E3.m1.2.2.2.7.2.cmml" xref="S3.E3.m1.2.2.2.7.2">𝑠</ci><apply id="S3.E3.m1.2.2.2.7.3.cmml" xref="S3.E3.m1.2.2.2.7.3"><times id="S3.E3.m1.2.2.2.7.3.1.cmml" xref="S3.E3.m1.2.2.2.7.3.1"></times><ci id="S3.E3.m1.2.2.2.7.3.2.cmml" xref="S3.E3.m1.2.2.2.7.3.2">𝑠</ci><ci id="S3.E3.m1.2.2.2.7.3.3.cmml" xref="S3.E3.m1.2.2.2.7.3.3">𝑟</ci><ci id="S3.E3.m1.2.2.2.7.3.4.cmml" xref="S3.E3.m1.2.2.2.7.3.4">𝑐</ci></apply></apply><apply id="S3.E3.m1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.1.2">norm</csymbol><apply id="S3.E3.m1.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1"><times id="S3.E3.m1.2.2.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1"></times><ci id="S3.E3.m1.2.2.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.2">𝑐</ci><ci id="S3.E3.m1.2.2.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.3">𝑙</ci><apply id="S3.E3.m1.2.2.2.2.1.1.4.cmml" xref="S3.E3.m1.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.4.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.4">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.1.1.4.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.4.2">𝑠</ci><apply id="S3.E3.m1.2.2.2.2.1.1.4.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.4.3"><times id="S3.E3.m1.2.2.2.2.1.1.4.3.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.4.3.1"></times><ci id="S3.E3.m1.2.2.2.2.1.1.4.3.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.4.3.2">𝑑</ci><ci id="S3.E3.m1.2.2.2.2.1.1.4.3.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.4.3.3">𝑠</ci><ci id="S3.E3.m1.2.2.2.2.1.1.4.3.4.cmml" xref="S3.E3.m1.2.2.2.2.1.1.4.3.4">𝑡</ci></apply></apply></apply></apply><apply id="S3.E3.m1.2.2.2.8.cmml" xref="S3.E3.m1.2.2.2.8"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.8.1.cmml" xref="S3.E3.m1.2.2.2.8">subscript</csymbol><ci id="S3.E3.m1.2.2.2.8.2.cmml" xref="S3.E3.m1.2.2.2.8.2">𝑒</ci><apply id="S3.E3.m1.2.2.2.8.3.cmml" xref="S3.E3.m1.2.2.2.8.3"><times id="S3.E3.m1.2.2.2.8.3.1.cmml" xref="S3.E3.m1.2.2.2.8.3.1"></times><ci id="S3.E3.m1.2.2.2.8.3.2.cmml" xref="S3.E3.m1.2.2.2.8.3.2">𝑝</ci><ci id="S3.E3.m1.2.2.2.8.3.3.cmml" xref="S3.E3.m1.2.2.2.8.3.3">𝑜</ci><ci id="S3.E3.m1.2.2.2.8.3.4.cmml" xref="S3.E3.m1.2.2.2.8.3.4">𝑙</ci><ci id="S3.E3.m1.2.2.2.8.3.5.cmml" xref="S3.E3.m1.2.2.2.8.3.5">𝑎</ci><ci id="S3.E3.m1.2.2.2.8.3.6.cmml" xref="S3.E3.m1.2.2.2.8.3.6">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">h_{e}=h_{src}\;\|\;h_{dst}\;\|\;cls_{src}\;\|\;cls_{dst}\;\|\;e_{polar}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS2.p1.11" class="ltx_p">where <math id="S3.SS3.SSS2.p1.6.m1.1" class="ltx_Math" alttext="h_{src}" display="inline"><semantics id="S3.SS3.SSS2.p1.6.m1.1a"><msub id="S3.SS3.SSS2.p1.6.m1.1.1" xref="S3.SS3.SSS2.p1.6.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.6.m1.1.1.2" xref="S3.SS3.SSS2.p1.6.m1.1.1.2.cmml">h</mi><mrow id="S3.SS3.SSS2.p1.6.m1.1.1.3" xref="S3.SS3.SSS2.p1.6.m1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.6.m1.1.1.3.2" xref="S3.SS3.SSS2.p1.6.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.6.m1.1.1.3.1" xref="S3.SS3.SSS2.p1.6.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.6.m1.1.1.3.3" xref="S3.SS3.SSS2.p1.6.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.6.m1.1.1.3.1a" xref="S3.SS3.SSS2.p1.6.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.6.m1.1.1.3.4" xref="S3.SS3.SSS2.p1.6.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.6.m1.1b"><apply id="S3.SS3.SSS2.p1.6.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.6.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.6.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.6.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.6.m1.1.1.2">ℎ</ci><apply id="S3.SS3.SSS2.p1.6.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.6.m1.1.1.3"><times id="S3.SS3.SSS2.p1.6.m1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.6.m1.1.1.3.1"></times><ci id="S3.SS3.SSS2.p1.6.m1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.6.m1.1.1.3.2">𝑠</ci><ci id="S3.SS3.SSS2.p1.6.m1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.6.m1.1.1.3.3">𝑟</ci><ci id="S3.SS3.SSS2.p1.6.m1.1.1.3.4.cmml" xref="S3.SS3.SSS2.p1.6.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.6.m1.1c">h_{src}</annotation></semantics></math> and <math id="S3.SS3.SSS2.p1.7.m2.1" class="ltx_Math" alttext="h_{dst}" display="inline"><semantics id="S3.SS3.SSS2.p1.7.m2.1a"><msub id="S3.SS3.SSS2.p1.7.m2.1.1" xref="S3.SS3.SSS2.p1.7.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p1.7.m2.1.1.2" xref="S3.SS3.SSS2.p1.7.m2.1.1.2.cmml">h</mi><mrow id="S3.SS3.SSS2.p1.7.m2.1.1.3" xref="S3.SS3.SSS2.p1.7.m2.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.7.m2.1.1.3.2" xref="S3.SS3.SSS2.p1.7.m2.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.7.m2.1.1.3.1" xref="S3.SS3.SSS2.p1.7.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.7.m2.1.1.3.3" xref="S3.SS3.SSS2.p1.7.m2.1.1.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.7.m2.1.1.3.1a" xref="S3.SS3.SSS2.p1.7.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.7.m2.1.1.3.4" xref="S3.SS3.SSS2.p1.7.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.7.m2.1b"><apply id="S3.SS3.SSS2.p1.7.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.7.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.7.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.7.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p1.7.m2.1.1.2">ℎ</ci><apply id="S3.SS3.SSS2.p1.7.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p1.7.m2.1.1.3"><times id="S3.SS3.SSS2.p1.7.m2.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.7.m2.1.1.3.1"></times><ci id="S3.SS3.SSS2.p1.7.m2.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.7.m2.1.1.3.2">𝑑</ci><ci id="S3.SS3.SSS2.p1.7.m2.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.7.m2.1.1.3.3">𝑠</ci><ci id="S3.SS3.SSS2.p1.7.m2.1.1.3.4.cmml" xref="S3.SS3.SSS2.p1.7.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.7.m2.1c">h_{dst}</annotation></semantics></math> are the node embeddings output of the last GNN layer, <math id="S3.SS3.SSS2.p1.8.m3.1" class="ltx_Math" alttext="cls_{scr}" display="inline"><semantics id="S3.SS3.SSS2.p1.8.m3.1a"><mrow id="S3.SS3.SSS2.p1.8.m3.1.1" xref="S3.SS3.SSS2.p1.8.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p1.8.m3.1.1.2" xref="S3.SS3.SSS2.p1.8.m3.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.8.m3.1.1.1" xref="S3.SS3.SSS2.p1.8.m3.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.8.m3.1.1.3" xref="S3.SS3.SSS2.p1.8.m3.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.8.m3.1.1.1a" xref="S3.SS3.SSS2.p1.8.m3.1.1.1.cmml">​</mo><msub id="S3.SS3.SSS2.p1.8.m3.1.1.4" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.cmml"><mi id="S3.SS3.SSS2.p1.8.m3.1.1.4.2" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.2.cmml">s</mi><mrow id="S3.SS3.SSS2.p1.8.m3.1.1.4.3" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.3.cmml"><mi id="S3.SS3.SSS2.p1.8.m3.1.1.4.3.2" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.8.m3.1.1.4.3.1" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.8.m3.1.1.4.3.3" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.3.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.8.m3.1.1.4.3.1a" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.8.m3.1.1.4.3.4" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.3.4.cmml">r</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.8.m3.1b"><apply id="S3.SS3.SSS2.p1.8.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.8.m3.1.1"><times id="S3.SS3.SSS2.p1.8.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p1.8.m3.1.1.1"></times><ci id="S3.SS3.SSS2.p1.8.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p1.8.m3.1.1.2">𝑐</ci><ci id="S3.SS3.SSS2.p1.8.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p1.8.m3.1.1.3">𝑙</ci><apply id="S3.SS3.SSS2.p1.8.m3.1.1.4.cmml" xref="S3.SS3.SSS2.p1.8.m3.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.8.m3.1.1.4.1.cmml" xref="S3.SS3.SSS2.p1.8.m3.1.1.4">subscript</csymbol><ci id="S3.SS3.SSS2.p1.8.m3.1.1.4.2.cmml" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.2">𝑠</ci><apply id="S3.SS3.SSS2.p1.8.m3.1.1.4.3.cmml" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.3"><times id="S3.SS3.SSS2.p1.8.m3.1.1.4.3.1.cmml" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.3.1"></times><ci id="S3.SS3.SSS2.p1.8.m3.1.1.4.3.2.cmml" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.3.2">𝑠</ci><ci id="S3.SS3.SSS2.p1.8.m3.1.1.4.3.3.cmml" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.3.3">𝑐</ci><ci id="S3.SS3.SSS2.p1.8.m3.1.1.4.3.4.cmml" xref="S3.SS3.SSS2.p1.8.m3.1.1.4.3.4">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.8.m3.1c">cls_{scr}</annotation></semantics></math> and <math id="S3.SS3.SSS2.p1.9.m4.1" class="ltx_Math" alttext="cls_{dst}" display="inline"><semantics id="S3.SS3.SSS2.p1.9.m4.1a"><mrow id="S3.SS3.SSS2.p1.9.m4.1.1" xref="S3.SS3.SSS2.p1.9.m4.1.1.cmml"><mi id="S3.SS3.SSS2.p1.9.m4.1.1.2" xref="S3.SS3.SSS2.p1.9.m4.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.9.m4.1.1.1" xref="S3.SS3.SSS2.p1.9.m4.1.1.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.9.m4.1.1.3" xref="S3.SS3.SSS2.p1.9.m4.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.9.m4.1.1.1a" xref="S3.SS3.SSS2.p1.9.m4.1.1.1.cmml">​</mo><msub id="S3.SS3.SSS2.p1.9.m4.1.1.4" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.cmml"><mi id="S3.SS3.SSS2.p1.9.m4.1.1.4.2" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.2.cmml">s</mi><mrow id="S3.SS3.SSS2.p1.9.m4.1.1.4.3" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.3.cmml"><mi id="S3.SS3.SSS2.p1.9.m4.1.1.4.3.2" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.9.m4.1.1.4.3.1" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.9.m4.1.1.4.3.3" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.9.m4.1.1.4.3.1a" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.9.m4.1.1.4.3.4" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.3.4.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.9.m4.1b"><apply id="S3.SS3.SSS2.p1.9.m4.1.1.cmml" xref="S3.SS3.SSS2.p1.9.m4.1.1"><times id="S3.SS3.SSS2.p1.9.m4.1.1.1.cmml" xref="S3.SS3.SSS2.p1.9.m4.1.1.1"></times><ci id="S3.SS3.SSS2.p1.9.m4.1.1.2.cmml" xref="S3.SS3.SSS2.p1.9.m4.1.1.2">𝑐</ci><ci id="S3.SS3.SSS2.p1.9.m4.1.1.3.cmml" xref="S3.SS3.SSS2.p1.9.m4.1.1.3">𝑙</ci><apply id="S3.SS3.SSS2.p1.9.m4.1.1.4.cmml" xref="S3.SS3.SSS2.p1.9.m4.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.9.m4.1.1.4.1.cmml" xref="S3.SS3.SSS2.p1.9.m4.1.1.4">subscript</csymbol><ci id="S3.SS3.SSS2.p1.9.m4.1.1.4.2.cmml" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.2">𝑠</ci><apply id="S3.SS3.SSS2.p1.9.m4.1.1.4.3.cmml" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.3"><times id="S3.SS3.SSS2.p1.9.m4.1.1.4.3.1.cmml" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.3.1"></times><ci id="S3.SS3.SSS2.p1.9.m4.1.1.4.3.2.cmml" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.3.2">𝑑</ci><ci id="S3.SS3.SSS2.p1.9.m4.1.1.4.3.3.cmml" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.3.3">𝑠</ci><ci id="S3.SS3.SSS2.p1.9.m4.1.1.4.3.4.cmml" xref="S3.SS3.SSS2.p1.9.m4.1.1.4.3.4">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.9.m4.1c">cls_{dst}</annotation></semantics></math> are the softmax of the output logits of the previous node predictor layer, <math id="S3.SS3.SSS2.p1.10.m5.1" class="ltx_Math" alttext="e_{polar}" display="inline"><semantics id="S3.SS3.SSS2.p1.10.m5.1a"><msub id="S3.SS3.SSS2.p1.10.m5.1.1" xref="S3.SS3.SSS2.p1.10.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p1.10.m5.1.1.2" xref="S3.SS3.SSS2.p1.10.m5.1.1.2.cmml">e</mi><mrow id="S3.SS3.SSS2.p1.10.m5.1.1.3" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.10.m5.1.1.3.2" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.10.m5.1.1.3.1" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.10.m5.1.1.3.3" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.10.m5.1.1.3.1a" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.10.m5.1.1.3.4" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.10.m5.1.1.3.1b" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.10.m5.1.1.3.5" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.10.m5.1.1.3.1c" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.10.m5.1.1.3.6" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.6.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.10.m5.1b"><apply id="S3.SS3.SSS2.p1.10.m5.1.1.cmml" xref="S3.SS3.SSS2.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.10.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p1.10.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.10.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p1.10.m5.1.1.2">𝑒</ci><apply id="S3.SS3.SSS2.p1.10.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p1.10.m5.1.1.3"><times id="S3.SS3.SSS2.p1.10.m5.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.1"></times><ci id="S3.SS3.SSS2.p1.10.m5.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.2">𝑝</ci><ci id="S3.SS3.SSS2.p1.10.m5.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.3">𝑜</ci><ci id="S3.SS3.SSS2.p1.10.m5.1.1.3.4.cmml" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.4">𝑙</ci><ci id="S3.SS3.SSS2.p1.10.m5.1.1.3.5.cmml" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.5">𝑎</ci><ci id="S3.SS3.SSS2.p1.10.m5.1.1.3.6.cmml" xref="S3.SS3.SSS2.p1.10.m5.1.1.3.6">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.10.m5.1c">e_{polar}</annotation></semantics></math> are the polar coordinates described in sec <a href="#S3.SS2" title="3.2 Node and edge features ‣ 3 Method ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> and <math id="S3.SS3.SSS2.p1.11.m6.1" class="ltx_Math" alttext="\|" display="inline"><semantics id="S3.SS3.SSS2.p1.11.m6.1a"><mo id="S3.SS3.SSS2.p1.11.m6.1.1" xref="S3.SS3.SSS2.p1.11.m6.1.1.cmml">∥</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.11.m6.1b"><ci id="S3.SS3.SSS2.p1.11.m6.1.1.cmml" xref="S3.SS3.SSS2.p1.11.m6.1.1">∥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.11.m6.1c">\|</annotation></semantics></math> is the concatenation operator. These choices have been made because: (i) relative positioning on edges is stronger compared to absolute positioning on nodes: the local property introduced by means of polar coordinates can be extended to different data, e.g. documents of different sizes or orientations; (ii) if the considered task comprise also the classification of nodes, their classes may help in the classification of edges, e.g. in forms it should not possible to find an answer connected to another answer.</p>
</div>
<div id="S3.SS3.SSS2.p2" class="ltx_para">
<p id="S3.SS3.SSS2.p2.1" class="ltx_p">Given the task, graphs can be either undirected or directed: both are represented with two or one directed edge between nodes, respectively. In the first case, the order does not matter and so the above formula can be redefined as:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.2" class="ltx_Math" alttext="h_{e}=(h_{src}+h_{dst})\;\|\;cls_{src}\;\|\;cls_{dst}\;\|\;e_{polar}" display="block"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml"><msub id="S3.E4.m1.2.2.4" xref="S3.E4.m1.2.2.4.cmml"><mi id="S3.E4.m1.2.2.4.2" xref="S3.E4.m1.2.2.4.2.cmml">h</mi><mi id="S3.E4.m1.2.2.4.3" xref="S3.E4.m1.2.2.4.3.cmml">e</mi></msub><mo id="S3.E4.m1.2.2.3" xref="S3.E4.m1.2.2.3.cmml">=</mo><mrow id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.2.cmml"><mrow id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.E4.m1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.2.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.1.1.1.2.3.1" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.2.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.1.1.1.2.3.1a" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.2.3.4" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3.4.cmml">c</mi></mrow></msub><mo id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.3.2.cmml">h</mi><mrow id="S3.E4.m1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.1.1.1.3.3.1a" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.3.3.4" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.280em" rspace="0em" id="S3.E4.m1.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.3.cmml">​</mo><mrow id="S3.E4.m1.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.2.cmml"><mo rspace="0.280em" stretchy="false" id="S3.E4.m1.2.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml">‖</mo><mrow id="S3.E4.m1.2.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.2.1.1.cmml"><mi id="S3.E4.m1.2.2.2.2.2.1.1.2" xref="S3.E4.m1.2.2.2.2.2.1.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.1.1.1" xref="S3.E4.m1.2.2.2.2.2.1.1.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.2.2.1.1.3" xref="S3.E4.m1.2.2.2.2.2.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.1.1.1a" xref="S3.E4.m1.2.2.2.2.2.1.1.1.cmml">​</mo><msub id="S3.E4.m1.2.2.2.2.2.1.1.4" xref="S3.E4.m1.2.2.2.2.2.1.1.4.cmml"><mi id="S3.E4.m1.2.2.2.2.2.1.1.4.2" xref="S3.E4.m1.2.2.2.2.2.1.1.4.2.cmml">s</mi><mrow id="S3.E4.m1.2.2.2.2.2.1.1.4.3" xref="S3.E4.m1.2.2.2.2.2.1.1.4.3.cmml"><mi id="S3.E4.m1.2.2.2.2.2.1.1.4.3.2" xref="S3.E4.m1.2.2.2.2.2.1.1.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.1.1.4.3.1" xref="S3.E4.m1.2.2.2.2.2.1.1.4.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.2.2.1.1.4.3.3" xref="S3.E4.m1.2.2.2.2.2.1.1.4.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.1.1.4.3.1a" xref="S3.E4.m1.2.2.2.2.2.1.1.4.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.2.2.1.1.4.3.4" xref="S3.E4.m1.2.2.2.2.2.1.1.4.3.4.cmml">c</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E4.m1.2.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml">‖</mo></mrow><mo lspace="0.280em" rspace="0em" id="S3.E4.m1.2.2.2.2.3a" xref="S3.E4.m1.2.2.2.2.3.cmml">​</mo><mi id="S3.E4.m1.2.2.2.2.4" xref="S3.E4.m1.2.2.2.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.3b" xref="S3.E4.m1.2.2.2.2.3.cmml">​</mo><mi id="S3.E4.m1.2.2.2.2.5" xref="S3.E4.m1.2.2.2.2.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.3c" xref="S3.E4.m1.2.2.2.2.3.cmml">​</mo><msub id="S3.E4.m1.2.2.2.2.6" xref="S3.E4.m1.2.2.2.2.6.cmml"><mi id="S3.E4.m1.2.2.2.2.6.2" xref="S3.E4.m1.2.2.2.2.6.2.cmml">s</mi><mrow id="S3.E4.m1.2.2.2.2.6.3" xref="S3.E4.m1.2.2.2.2.6.3.cmml"><mi id="S3.E4.m1.2.2.2.2.6.3.2" xref="S3.E4.m1.2.2.2.2.6.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.6.3.1" xref="S3.E4.m1.2.2.2.2.6.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.2.6.3.3" xref="S3.E4.m1.2.2.2.2.6.3.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.6.3.1a" xref="S3.E4.m1.2.2.2.2.6.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.2.6.3.4" xref="S3.E4.m1.2.2.2.2.6.3.4.cmml">t</mi></mrow></msub></mrow><mo rspace="0.558em" id="S3.E4.m1.2.2.2.3" xref="S3.E4.m1.2.2.2.3.cmml">∥</mo><msub id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.4.cmml"><mi id="S3.E4.m1.2.2.2.4.2" xref="S3.E4.m1.2.2.2.4.2.cmml">e</mi><mrow id="S3.E4.m1.2.2.2.4.3" xref="S3.E4.m1.2.2.2.4.3.cmml"><mi id="S3.E4.m1.2.2.2.4.3.2" xref="S3.E4.m1.2.2.2.4.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.4.3.1" xref="S3.E4.m1.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.4.3.3" xref="S3.E4.m1.2.2.2.4.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.4.3.1a" xref="S3.E4.m1.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.4.3.4" xref="S3.E4.m1.2.2.2.4.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.4.3.1b" xref="S3.E4.m1.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.4.3.5" xref="S3.E4.m1.2.2.2.4.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.4.3.1c" xref="S3.E4.m1.2.2.2.4.3.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.4.3.6" xref="S3.E4.m1.2.2.2.4.3.6.cmml">r</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"><eq id="S3.E4.m1.2.2.3.cmml" xref="S3.E4.m1.2.2.3"></eq><apply id="S3.E4.m1.2.2.4.cmml" xref="S3.E4.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.4.1.cmml" xref="S3.E4.m1.2.2.4">subscript</csymbol><ci id="S3.E4.m1.2.2.4.2.cmml" xref="S3.E4.m1.2.2.4.2">ℎ</ci><ci id="S3.E4.m1.2.2.4.3.cmml" xref="S3.E4.m1.2.2.4.3">𝑒</ci></apply><apply id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2.2"><csymbol cd="latexml" id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.3">conditional</csymbol><apply id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2"><times id="S3.E4.m1.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.3"></times><apply id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><plus id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2.2">ℎ</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3"><times id="S3.E4.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E4.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3.3">𝑟</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2.3.4">𝑐</ci></apply></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3.2">ℎ</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3"><times id="S3.E4.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3.2">𝑑</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3.3">𝑠</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3.3.4">𝑡</ci></apply></apply></apply><apply id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1"><csymbol cd="latexml" id="S3.E4.m1.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.2">norm</csymbol><apply id="S3.E4.m1.2.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1"><times id="S3.E4.m1.2.2.2.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1"></times><ci id="S3.E4.m1.2.2.2.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.2">𝑐</ci><ci id="S3.E4.m1.2.2.2.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.3">𝑙</ci><apply id="S3.E4.m1.2.2.2.2.2.1.1.4.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.1.1.4.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.4">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.1.1.4.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.4.2">𝑠</ci><apply id="S3.E4.m1.2.2.2.2.2.1.1.4.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.4.3"><times id="S3.E4.m1.2.2.2.2.2.1.1.4.3.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.4.3.1"></times><ci id="S3.E4.m1.2.2.2.2.2.1.1.4.3.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.4.3.2">𝑠</ci><ci id="S3.E4.m1.2.2.2.2.2.1.1.4.3.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.4.3.3">𝑟</ci><ci id="S3.E4.m1.2.2.2.2.2.1.1.4.3.4.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.4.3.4">𝑐</ci></apply></apply></apply></apply><ci id="S3.E4.m1.2.2.2.2.4.cmml" xref="S3.E4.m1.2.2.2.2.4">𝑐</ci><ci id="S3.E4.m1.2.2.2.2.5.cmml" xref="S3.E4.m1.2.2.2.2.5">𝑙</ci><apply id="S3.E4.m1.2.2.2.2.6.cmml" xref="S3.E4.m1.2.2.2.2.6"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.6.1.cmml" xref="S3.E4.m1.2.2.2.2.6">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.6.2.cmml" xref="S3.E4.m1.2.2.2.2.6.2">𝑠</ci><apply id="S3.E4.m1.2.2.2.2.6.3.cmml" xref="S3.E4.m1.2.2.2.2.6.3"><times id="S3.E4.m1.2.2.2.2.6.3.1.cmml" xref="S3.E4.m1.2.2.2.2.6.3.1"></times><ci id="S3.E4.m1.2.2.2.2.6.3.2.cmml" xref="S3.E4.m1.2.2.2.2.6.3.2">𝑑</ci><ci id="S3.E4.m1.2.2.2.2.6.3.3.cmml" xref="S3.E4.m1.2.2.2.2.6.3.3">𝑠</ci><ci id="S3.E4.m1.2.2.2.2.6.3.4.cmml" xref="S3.E4.m1.2.2.2.2.6.3.4">𝑡</ci></apply></apply></apply><apply id="S3.E4.m1.2.2.2.4.cmml" xref="S3.E4.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.4.1.cmml" xref="S3.E4.m1.2.2.2.4">subscript</csymbol><ci id="S3.E4.m1.2.2.2.4.2.cmml" xref="S3.E4.m1.2.2.2.4.2">𝑒</ci><apply id="S3.E4.m1.2.2.2.4.3.cmml" xref="S3.E4.m1.2.2.2.4.3"><times id="S3.E4.m1.2.2.2.4.3.1.cmml" xref="S3.E4.m1.2.2.2.4.3.1"></times><ci id="S3.E4.m1.2.2.2.4.3.2.cmml" xref="S3.E4.m1.2.2.2.4.3.2">𝑝</ci><ci id="S3.E4.m1.2.2.2.4.3.3.cmml" xref="S3.E4.m1.2.2.2.4.3.3">𝑜</ci><ci id="S3.E4.m1.2.2.2.4.3.4.cmml" xref="S3.E4.m1.2.2.2.4.3.4">𝑙</ci><ci id="S3.E4.m1.2.2.2.4.3.5.cmml" xref="S3.E4.m1.2.2.2.4.3.5">𝑎</ci><ci id="S3.E4.m1.2.2.2.4.3.6.cmml" xref="S3.E4.m1.2.2.2.4.3.6">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">h_{e}=(h_{src}+h_{dst})\;\|\;cls_{src}\;\|\;cls_{dst}\;\|\;e_{polar}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments and Results</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this chapter we present experiments of our method on two different datasets, FUNSD and RVL-CDIP invoices, to tackle three tasks: entity linking, layout analysis and table detection. We also discuss results compared to other methods.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Proposed model</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p">We performed ablation studies on our proposed model for entity linking on FUNSD without contribution and classification of nodes (Fig. <a href="#S3.F1" title="Figure 1 ‣ 3.3 Architecture ‣ 3 Method ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), since we found it to be the most challenging task. In Tab. <a href="#S4.T1" title="Table 1 ‣ 4.1 Proposed model ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> we report different combinations of features and hyperparameters. Geometrical and textual features make the largest contribution, while visual features bring almost three points more to the Key-Value F1 score by an important increase in terms of network parameters (2.3 times more). Textual and geometrical features remain crucial for the task at hand, and their combination increase by a large amount both of their scores when used in isolation. This may be due to two facts: (i) our U-Net has not been included during the GNN training time (as done in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>), unable to adjust the representation for spotting key-value relationship pairs; (ii) the segmentation task used to train the backbone do not yield useful features for that goal (as shown in Tab. <a href="#S4.T1" title="Table 1 ‣ 4.1 Proposed model ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
The hyperparameters shown in the table refer to the edge predictor (EP) inner layer input dimension and the input projector fully connected (IP FC) layers (per each modality) output dimension, respectively. A larger EP is much more informative for the classification of links into ‘none’ (cut edges, meaning no relationship) or ‘key-value’, while more dimensions for the projected modalities helped the model to better learn the importance of their contributions. These changes bring an improvement of 13 points on the key-value F1 scores, between the third and fourth line of the table where we keep the features fixed. We do not report the score relative to others network settings since their changes only brought a decrease overall metrics. We use a learning rate of <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="10^{-3}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msup id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">10</mn><mrow id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml"><mo id="S4.SS1.p1.1.m1.1.1.3a" xref="S4.SS1.p1.1.m1.1.1.3.cmml">−</mo><mn id="S4.SS1.p1.1.m1.1.1.3.2" xref="S4.SS1.p1.1.m1.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">10</cn><apply id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3"><minus id="S4.SS1.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.p1.1.m1.1.1.3"></minus><cn type="integer" id="S4.SS1.p1.1.m1.1.1.3.2.cmml" xref="S4.SS1.p1.1.m1.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">10^{-3}</annotation></semantics></math> and a weight decay of <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msup id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mn id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">10</mn><mrow id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml"><mo id="S4.SS1.p1.2.m2.1.1.3a" xref="S4.SS1.p1.2.m2.1.1.3.cmml">−</mo><mn id="S4.SS1.p1.2.m2.1.1.3.2" xref="S4.SS1.p1.2.m2.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">superscript</csymbol><cn type="integer" id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">10</cn><apply id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3"><minus id="S4.SS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3"></minus><cn type="integer" id="S4.SS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">10^{-4}</annotation></semantics></math>, with a dropout of 0.2 over the last FC layer. The threshold over neighbor nodes and their contribution scale factor (sec. <a href="#S3.SS3.SSS1" title="3.3.1 GNN Layer ‣ 3.3 Architecture ‣ 3 Method ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.1</span></a>) are fixed to 0.9 and 0.1, respectively. The bins to discretize the space for angles (sec. <a href="#S3.SS3.SSS2" title="3.3.2 Edge Predictor ‣ 3.3 Architecture ‣ 3 Method ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3.2</span></a>) are 8. We apply one GNN layer before the node and edge predictors.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<div id="S4.T1.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:91.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-80.8pt,17.1pt) scale(0.728591933629949,0.728591933629949) ;">
<table id="S4.T1.4.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="3"><span id="S4.T1.1.1.1.2.1" class="ltx_text ltx_font_italic">Features</span></th>
<th id="S4.T1.1.1.1.3" class="ltx_td ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></th>
<th id="S4.T1.1.1.1.4" class="ltx_td ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></th>
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="2">
<span id="S4.T1.1.1.1.1.1" class="ltx_text ltx_font_italic">F<sub id="S4.T1.1.1.1.1.1.1" class="ltx_sub">1</sub> per classes</span> (<math id="S4.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T1.1.1.1.1.m1.1a"><mo stretchy="false" id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math>)</th>
<th id="S4.T1.1.1.1.5" class="ltx_td ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></th>
<td id="S4.T1.1.1.1.6" class="ltx_td ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></td>
</tr>
<tr id="S4.T1.4.4.4" class="ltx_tr">
<th id="S4.T1.4.4.4.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.4.4.4.4.1" class="ltx_text ltx_font_bold">Geometric</span></th>
<th id="S4.T1.4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.4.4.4.5.1" class="ltx_text ltx_font_bold">Text</span></th>
<th id="S4.T1.4.4.4.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.4.4.4.6.1" class="ltx_text ltx_font_bold">Visual</span></th>
<th id="S4.T1.4.4.4.7" class="ltx_td ltx_align_left ltx_th ltx_th_column" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.4.4.4.7.1" class="ltx_text ltx_font_bold">EP Inner dim</span></th>
<th id="S4.T1.4.4.4.8" class="ltx_td ltx_align_left ltx_th ltx_th_column" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.4.4.4.8.1" class="ltx_text ltx_font_bold">IP FC dim</span></th>
<th id="S4.T1.4.4.4.9" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.4.4.4.9.1" class="ltx_text ltx_font_bold">None</span></th>
<th id="S4.T1.4.4.4.10" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.4.4.4.10.1" class="ltx_text ltx_font_bold">Key-Value</span></th>
<th id="S4.T1.2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S4.T1.2.2.2.1.1" class="ltx_text ltx_font_bold">AUC-PR</span> (<math id="S4.T1.2.2.2.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T1.2.2.2.1.m1.1a"><mo stretchy="false" id="S4.T1.2.2.2.1.m1.1.1" xref="S4.T1.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.1.m1.1b"><ci id="S4.T1.2.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.1.m1.1c">\uparrow</annotation></semantics></math>)</th>
<th id="S4.T1.4.4.4.3" class="ltx_td ltx_align_left ltx_th ltx_th_column" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S4.T1.3.3.3.2.1" class="ltx_text ltx_font_bold"># Params <math id="S4.T1.3.3.3.2.1.m1.1" class="ltx_Math" alttext="\times 10^{6}" display="inline"><semantics id="S4.T1.3.3.3.2.1.m1.1a"><mrow id="S4.T1.3.3.3.2.1.m1.1.1" xref="S4.T1.3.3.3.2.1.m1.1.1.cmml"><mi id="S4.T1.3.3.3.2.1.m1.1.1.2" xref="S4.T1.3.3.3.2.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="S4.T1.3.3.3.2.1.m1.1.1.1" xref="S4.T1.3.3.3.2.1.m1.1.1.1.cmml">×</mo><msup id="S4.T1.3.3.3.2.1.m1.1.1.3" xref="S4.T1.3.3.3.2.1.m1.1.1.3.cmml"><mn id="S4.T1.3.3.3.2.1.m1.1.1.3.2" xref="S4.T1.3.3.3.2.1.m1.1.1.3.2.cmml">10</mn><mn id="S4.T1.3.3.3.2.1.m1.1.1.3.3" xref="S4.T1.3.3.3.2.1.m1.1.1.3.3.cmml">6</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.2.1.m1.1b"><apply id="S4.T1.3.3.3.2.1.m1.1.1.cmml" xref="S4.T1.3.3.3.2.1.m1.1.1"><times id="S4.T1.3.3.3.2.1.m1.1.1.1.cmml" xref="S4.T1.3.3.3.2.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.T1.3.3.3.2.1.m1.1.1.2.cmml" xref="S4.T1.3.3.3.2.1.m1.1.1.2">absent</csymbol><apply id="S4.T1.3.3.3.2.1.m1.1.1.3.cmml" xref="S4.T1.3.3.3.2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T1.3.3.3.2.1.m1.1.1.3.1.cmml" xref="S4.T1.3.3.3.2.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S4.T1.3.3.3.2.1.m1.1.1.3.2.cmml" xref="S4.T1.3.3.3.2.1.m1.1.1.3.2">10</cn><cn type="integer" id="S4.T1.3.3.3.2.1.m1.1.1.3.3.cmml" xref="S4.T1.3.3.3.2.1.m1.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.2.1.m1.1c">\times 10^{6}</annotation></semantics></math></span> (<math id="S4.T1.4.4.4.3.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T1.4.4.4.3.m1.1a"><mo stretchy="false" id="S4.T1.4.4.4.3.m1.1.1" xref="S4.T1.4.4.4.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.3.m1.1b"><ci id="S4.T1.4.4.4.3.m1.1.1.cmml" xref="S4.T1.4.4.4.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.3.m1.1c">\downarrow</annotation></semantics></math>)</th>
</tr>
<tr id="S4.T1.4.4.5.1" class="ltx_tr">
<td id="S4.T1.4.4.5.1.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T1.4.4.5.1.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">✗</td>
<td id="S4.T1.4.4.5.1.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">✗</td>
<td id="S4.T1.4.4.5.1.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">20</td>
<td id="S4.T1.4.4.5.1.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">100</td>
<td id="S4.T1.4.4.5.1.6" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.9587</td>
<td id="S4.T1.4.4.5.1.7" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.1507</td>
<td id="S4.T1.4.4.5.1.8" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.6301</td>
<td id="S4.T1.4.4.5.1.9" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.025</td>
</tr>
<tr id="S4.T1.4.4.6.2" class="ltx_tr">
<td id="S4.T1.4.4.6.2.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✗</td>
<td id="S4.T1.4.4.6.2.2" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T1.4.4.6.2.3" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✗</td>
<td id="S4.T1.4.4.6.2.4" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">20</td>
<td id="S4.T1.4.4.6.2.5" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">100</td>
<td id="S4.T1.4.4.6.2.6" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.9893</td>
<td id="S4.T1.4.4.6.2.7" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.1981</td>
<td id="S4.T1.4.4.6.2.8" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.5605</td>
<td id="S4.T1.4.4.6.2.9" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.054</td>
</tr>
<tr id="S4.T1.4.4.7.3" class="ltx_tr">
<td id="S4.T1.4.4.7.3.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T1.4.4.7.3.2" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T1.4.4.7.3.3" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✗</td>
<td id="S4.T1.4.4.7.3.4" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">20</td>
<td id="S4.T1.4.4.7.3.5" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">100</td>
<td id="S4.T1.4.4.7.3.6" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.9941</td>
<td id="S4.T1.4.4.7.3.7" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.4305</td>
<td id="S4.T1.4.4.7.3.8" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.7002</td>
<td id="S4.T1.4.4.7.3.9" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.120</td>
</tr>
<tr id="S4.T1.4.4.8.4" class="ltx_tr">
<td id="S4.T1.4.4.8.4.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T1.4.4.8.4.2" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T1.4.4.8.4.3" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✗</td>
<td id="S4.T1.4.4.8.4.4" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">300</td>
<td id="S4.T1.4.4.8.4.5" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">300</td>
<td id="S4.T1.4.4.8.4.6" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.9961</td>
<td id="S4.T1.4.4.8.4.7" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.5606</td>
<td id="S4.T1.4.4.8.4.8" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.7733</td>
<td id="S4.T1.4.4.8.4.9" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">1.18</td>
</tr>
<tr id="S4.T1.4.4.9.5" class="ltx_tr">
<td id="S4.T1.4.4.9.5.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T1.4.4.9.5.2" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T1.4.4.9.5.3" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T1.4.4.9.5.4" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">300</td>
<td id="S4.T1.4.4.9.5.5" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">300</td>
<td id="S4.T1.4.4.9.5.6" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.4.4.9.5.6.1" class="ltx_text ltx_font_bold">0.9964</span></td>
<td id="S4.T1.4.4.9.5.7" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.4.4.9.5.7.1" class="ltx_text ltx_font_bold">0.5895</span></td>
<td id="S4.T1.4.4.9.5.8" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.4.4.9.5.8.1" class="ltx_text ltx_font_bold">0.7903</span></td>
<td id="S4.T1.4.4.9.5.9" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">2.68</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.7.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.8.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Ablation studies of Doc2Graph model<span id="S4.T1.8.2.1" class="ltx_text ltx_font_medium">. EP Inner dim and IP FC dim show edge predictor layer input dimension and the input projector fully connected layers output dimension, respectively. AUC-PR refers to the key-value edge class. The # Params refers to Doc2Graph trainable parameters solely.</span></span></figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>FUNSD</h3>

<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Dataset</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p">The dataset<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> comprises 199 real, fully annotated, scanned forms. The documents are selected as a subset of the larger RVL-CDIP<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> dataset, a collection of 400,000 grayscale images of various documents. The authors define the Form Understanding (FoUn) challenge into three different tasks: word grouping, semantic entity labeling and entity linking.
A recent work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> found some inconsistency in the original labeling, which impeded its applicability to the key-value extraction problem. In this work, we are using the revised version of FUNSD.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2208.11168/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="300" height="195" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.3.2" class="ltx_text" style="font-size:90%;">Image taken from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>: the document on the right is the revised version of the document on the left, where some answers (green) are mislabeled as question (blue), and some questions (blue) are mislabeled as headers (yellow)</span></figcaption>
</figure>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Entity Detection</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.1" class="ltx_p">Our focus is on the GNN performances but, for comparison reasons, we used a YOLOv5 small <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> to detect entities (pretrained on COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>). In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> the word grouping task is evaluated using the ARI metric: since we are not using words, we evaluated the entity detection with F1 score using two different IoU thresholds (Tab. <a href="#S4.T2" title="Table 2 ‣ 4.2.2 Entity Detection ‣ 4.2 FUNSD ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). For the semantic entity labeling and entity linking tasks we use IoU <math id="S4.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="&gt;0.50" display="inline"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><mrow id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS2.SSS2.p1.1.m1.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.SSS2.p1.1.m1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml">0.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><apply id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"><gt id="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2">absent</csymbol><cn type="float" id="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.3">0.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">&gt;0.50</annotation></semantics></math> as done in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>: we did not perform any optimization on the detector model, which introduces a high drop rate for both entities and links. We create the graphs on top of YOLO detections, linking the ground truth accordingly (Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.2.2 Entity Detection ‣ 4.2 FUNSD ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>): false positive entities (red boxes) are labeled as class ’other’, while false negative entities cause some key-value pairs to be lost (red links). The new connections created as a consequence of wrong detections are considered false positives and labeled as ‘none’.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<div id="S4.T2.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:303.5pt;height:74.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(5.1pt,-1.2pt) scale(1.03447505309973,1.03447505309973) ;">
<table id="S4.T2.2.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.2.2.2" class="ltx_tr">
<th id="S4.T2.2.2.2.3" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></th>
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="3">
<span id="S4.T2.1.1.1.1.1" class="ltx_text ltx_font_italic">Metrics</span> (<math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mo stretchy="false" id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math>)</th>
<th id="S4.T2.2.2.2.4" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></th>
<th id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="2">
<span id="S4.T2.2.2.2.2.1" class="ltx_text ltx_font_italic">% Drop Rate</span> (<math id="S4.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T2.2.2.2.2.m1.1a"><mo stretchy="false" id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><ci id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">\downarrow</annotation></semantics></math>)</th>
</tr>
<tr id="S4.T2.2.2.3.1" class="ltx_tr">
<th id="S4.T2.2.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.2.2.3.1.1.1" class="ltx_text ltx_font_bold">IoU</span></th>
<th id="S4.T2.2.2.3.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.2.2.3.1.2.1" class="ltx_text ltx_font_bold">Precision</span></th>
<th id="S4.T2.2.2.3.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.2.2.3.1.3.1" class="ltx_text ltx_font_bold">Recall</span></th>
<th id="S4.T2.2.2.3.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.2.2.3.1.4.1" class="ltx_text ltx_font_bold">F<sub id="S4.T2.2.2.3.1.4.1.1" class="ltx_sub">1</sub></span></th>
<th id="S4.T2.2.2.3.1.5" class="ltx_td ltx_th ltx_th_column ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;"></th>
<th id="S4.T2.2.2.3.1.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.2.2.3.1.6.1" class="ltx_text ltx_font_bold">Entity</span></th>
<th id="S4.T2.2.2.3.1.7" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.2.2.3.1.7.1" class="ltx_text ltx_font_bold">Link</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.2.2.4.1" class="ltx_tr">
<th id="S4.T2.2.2.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.25</th>
<td id="S4.T2.2.2.4.1.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.8728</td>
<td id="S4.T2.2.2.4.1.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.8712</td>
<td id="S4.T2.2.2.4.1.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.8720</td>
<th id="S4.T2.2.2.4.1.5" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"></th>
<td id="S4.T2.2.2.4.1.6" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">12.72</td>
<td id="S4.T2.2.2.4.1.7" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">16.63</td>
</tr>
<tr id="S4.T2.2.2.5.2" class="ltx_tr">
<th id="S4.T2.2.2.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">0.50</th>
<td id="S4.T2.2.2.5.2.2" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">0.8132</td>
<td id="S4.T2.2.2.5.2.3" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">0.8109</td>
<td id="S4.T2.2.2.5.2.4" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">0.8121</td>
<th id="S4.T2.2.2.5.2.5" class="ltx_td ltx_th ltx_th_row ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"></th>
<td id="S4.T2.2.2.5.2.6" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">18.67</td>
<td id="S4.T2.2.2.5.2.7" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">25.93</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.5.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.6.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Entity detection results<span id="S4.T2.6.2.1" class="ltx_text ltx_font_medium">. YOLOv5 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>-small performances on the entity detection task.</span></span></figcaption>
</figure>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2208.11168/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="105" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.4.2.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.2.1" class="ltx_text" style="font-size:90%;">Blue boxes are FUNSD entities ground truth, green boxes are the correct detected one (with IoU <math id="S4.F3.2.1.m1.1" class="ltx_Math" alttext="&gt;0.25/0.50" display="inline"><semantics id="S4.F3.2.1.m1.1b"><mrow id="S4.F3.2.1.m1.1.1" xref="S4.F3.2.1.m1.1.1.cmml"><mi id="S4.F3.2.1.m1.1.1.2" xref="S4.F3.2.1.m1.1.1.2.cmml"></mi><mo id="S4.F3.2.1.m1.1.1.1" xref="S4.F3.2.1.m1.1.1.1.cmml">&gt;</mo><mrow id="S4.F3.2.1.m1.1.1.3" xref="S4.F3.2.1.m1.1.1.3.cmml"><mn id="S4.F3.2.1.m1.1.1.3.2" xref="S4.F3.2.1.m1.1.1.3.2.cmml">0.25</mn><mo id="S4.F3.2.1.m1.1.1.3.1" xref="S4.F3.2.1.m1.1.1.3.1.cmml">/</mo><mn id="S4.F3.2.1.m1.1.1.3.3" xref="S4.F3.2.1.m1.1.1.3.3.cmml">0.50</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.2.1.m1.1c"><apply id="S4.F3.2.1.m1.1.1.cmml" xref="S4.F3.2.1.m1.1.1"><gt id="S4.F3.2.1.m1.1.1.1.cmml" xref="S4.F3.2.1.m1.1.1.1"></gt><csymbol cd="latexml" id="S4.F3.2.1.m1.1.1.2.cmml" xref="S4.F3.2.1.m1.1.1.2">absent</csymbol><apply id="S4.F3.2.1.m1.1.1.3.cmml" xref="S4.F3.2.1.m1.1.1.3"><divide id="S4.F3.2.1.m1.1.1.3.1.cmml" xref="S4.F3.2.1.m1.1.1.3.1"></divide><cn type="float" id="S4.F3.2.1.m1.1.1.3.2.cmml" xref="S4.F3.2.1.m1.1.1.3.2">0.25</cn><cn type="float" id="S4.F3.2.1.m1.1.1.3.3.cmml" xref="S4.F3.2.1.m1.1.1.3.3">0.50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.2.1.m1.1d">&gt;0.25/0.50</annotation></semantics></math>), while red boxes are the false positive ones.</span></figcaption>
</figure>
<figure id="S4.T3" class="ltx_table">
<div id="S4.T3.7" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:135.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-72.0pt,22.4pt) scale(0.750700436983918,0.750700436983918) ;">
<table id="S4.T3.7.7" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<td id="S4.T3.1.1.1.2" class="ltx_td ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></td>
<td id="S4.T3.1.1.1.3" class="ltx_td ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></td>
<td id="S4.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="2">
<span id="S4.T3.1.1.1.1.1" class="ltx_text ltx_font_italic">F<sub id="S4.T3.1.1.1.1.1.1" class="ltx_sub">1</sub></span> (<math id="S4.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T3.1.1.1.1.m1.1a"><mo stretchy="false" id="S4.T3.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><ci id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math>)</td>
<td id="S4.T3.1.1.1.4" class="ltx_td ltx_nopad_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></td>
</tr>
<tr id="S4.T3.3.3.3" class="ltx_tr">
<td id="S4.T3.3.3.3.3" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T3.3.3.3.3.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S4.T3.3.3.3.4" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T3.3.3.3.4.1" class="ltx_text ltx_font_bold">GNN</span></td>
<td id="S4.T3.3.3.3.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T3.3.3.3.5.1" class="ltx_text ltx_font_bold">Semantic Entity Labeling</span></td>
<td id="S4.T3.3.3.3.6" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T3.3.3.3.6.1" class="ltx_text ltx_font_bold">Entity Linking</span></td>
<td id="S4.T3.3.3.3.2" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T3.3.3.3.2.2" class="ltx_text ltx_font_bold"># Params <math id="S4.T3.2.2.2.1.1.m1.1" class="ltx_Math" alttext="\times 10^{6}" display="inline"><semantics id="S4.T3.2.2.2.1.1.m1.1a"><mrow id="S4.T3.2.2.2.1.1.m1.1.1" xref="S4.T3.2.2.2.1.1.m1.1.1.cmml"><mi id="S4.T3.2.2.2.1.1.m1.1.1.2" xref="S4.T3.2.2.2.1.1.m1.1.1.2.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="S4.T3.2.2.2.1.1.m1.1.1.1" xref="S4.T3.2.2.2.1.1.m1.1.1.1.cmml">×</mo><msup id="S4.T3.2.2.2.1.1.m1.1.1.3" xref="S4.T3.2.2.2.1.1.m1.1.1.3.cmml"><mn id="S4.T3.2.2.2.1.1.m1.1.1.3.2" xref="S4.T3.2.2.2.1.1.m1.1.1.3.2.cmml">10</mn><mn id="S4.T3.2.2.2.1.1.m1.1.1.3.3" xref="S4.T3.2.2.2.1.1.m1.1.1.3.3.cmml">6</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.1.1.m1.1b"><apply id="S4.T3.2.2.2.1.1.m1.1.1.cmml" xref="S4.T3.2.2.2.1.1.m1.1.1"><times id="S4.T3.2.2.2.1.1.m1.1.1.1.cmml" xref="S4.T3.2.2.2.1.1.m1.1.1.1"></times><csymbol cd="latexml" id="S4.T3.2.2.2.1.1.m1.1.1.2.cmml" xref="S4.T3.2.2.2.1.1.m1.1.1.2">absent</csymbol><apply id="S4.T3.2.2.2.1.1.m1.1.1.3.cmml" xref="S4.T3.2.2.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T3.2.2.2.1.1.m1.1.1.3.1.cmml" xref="S4.T3.2.2.2.1.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S4.T3.2.2.2.1.1.m1.1.1.3.2.cmml" xref="S4.T3.2.2.2.1.1.m1.1.1.3.2">10</cn><cn type="integer" id="S4.T3.2.2.2.1.1.m1.1.1.3.3.cmml" xref="S4.T3.2.2.2.1.1.m1.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.1.1.m1.1c">\times 10^{6}</annotation></semantics></math> (<math id="S4.T3.3.3.3.2.2.m2.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T3.3.3.3.2.2.m2.1a"><mo stretchy="false" id="S4.T3.3.3.3.2.2.m2.1.1" xref="S4.T3.3.3.3.2.2.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.2.2.m2.1b"><ci id="S4.T3.3.3.3.2.2.m2.1.1.cmml" xref="S4.T3.3.3.3.2.2.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.2.2.m2.1c">\downarrow</annotation></semantics></math>)</span></td>
</tr>
<tr id="S4.T3.7.7.8.1" class="ltx_tr">
<td id="S4.T3.7.7.8.1.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">BROS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</td>
<td id="S4.T3.7.7.8.1.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">✗</td>
<td id="S4.T3.7.7.8.1.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T3.7.7.8.1.3.1" class="ltx_text ltx_font_bold">0.8121</span></td>
<td id="S4.T3.7.7.8.1.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T3.7.7.8.1.4.1" class="ltx_text ltx_font_bold">0.6696</span></td>
<td id="S4.T3.7.7.8.1.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">138</td>
</tr>
<tr id="S4.T3.7.7.9.2" class="ltx_tr">
<td id="S4.T3.7.7.9.2.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">LayoutLM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>
</td>
<td id="S4.T3.7.7.9.2.2" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✗</td>
<td id="S4.T3.7.7.9.2.3" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.7895</td>
<td id="S4.T3.7.7.9.2.4" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.4281</td>
<td id="S4.T3.7.7.9.2.5" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">343</td>
</tr>
<tr id="S4.T3.7.7.10.3" class="ltx_tr">
<td id="S4.T3.7.7.10.3.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">FUNSD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</td>
<td id="S4.T3.7.7.10.3.2" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T3.7.7.10.3.3" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.5700</td>
<td id="S4.T3.7.7.10.3.4" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.0400</td>
<td id="S4.T3.7.7.10.3.5" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">-</td>
</tr>
<tr id="S4.T3.7.7.11.4" class="ltx_tr">
<td id="S4.T3.7.7.11.4.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">Carbonell et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>
</td>
<td id="S4.T3.7.7.11.4.2" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T3.7.7.11.4.3" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.6400</td>
<td id="S4.T3.7.7.11.4.4" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.3900</td>
<td id="S4.T3.7.7.11.4.5" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">201</td>
</tr>
<tr id="S4.T3.7.7.12.5" class="ltx_tr">
<td id="S4.T3.7.7.12.5.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">FUDGE w/o GCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</td>
<td id="S4.T3.7.7.12.5.2" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✗</td>
<td id="S4.T3.7.7.12.5.3" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.6507</td>
<td id="S4.T3.7.7.12.5.4" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.5241</td>
<td id="S4.T3.7.7.12.5.5" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">12</td>
</tr>
<tr id="S4.T3.7.7.13.6" class="ltx_tr">
<td id="S4.T3.7.7.13.6.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">FUDGE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</td>
<td id="S4.T3.7.7.13.6.2" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T3.7.7.13.6.3" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.6652</td>
<td id="S4.T3.7.7.13.6.4" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.5662</td>
<td id="S4.T3.7.7.13.6.5" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">17</td>
</tr>
<tr id="S4.T3.5.5.5" class="ltx_tr">
<td id="S4.T3.5.5.5.3" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">Doc2Graph + YOLO</td>
<td id="S4.T3.5.5.5.4" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T3.4.4.4.1" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.6581 <math id="S4.T3.4.4.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.4.4.4.1.m1.1a"><mo id="S4.T3.4.4.4.1.m1.1.1" xref="S4.T3.4.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.1.m1.1b"><csymbol cd="latexml" id="S4.T3.4.4.4.1.m1.1.1.cmml" xref="S4.T3.4.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.1.m1.1c">\pm</annotation></semantics></math> 0.006</td>
<td id="S4.T3.5.5.5.2" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.3882 <math id="S4.T3.5.5.5.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.5.5.5.2.m1.1a"><mo id="S4.T3.5.5.5.2.m1.1.1" xref="S4.T3.5.5.5.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.5.2.m1.1b"><csymbol cd="latexml" id="S4.T3.5.5.5.2.m1.1.1.cmml" xref="S4.T3.5.5.5.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.5.2.m1.1c">\pm</annotation></semantics></math> 0.028</td>
<td id="S4.T3.5.5.5.5" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">13.5</td>
</tr>
<tr id="S4.T3.7.7.7" class="ltx_tr">
<td id="S4.T3.7.7.7.3" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">Doc2Graph + GT</td>
<td id="S4.T3.7.7.7.4" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">✓</td>
<td id="S4.T3.6.6.6.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S4.T3.6.6.6.1.1" class="ltx_text ltx_framed ltx_framed_underline">0.8225</span> <math id="S4.T3.6.6.6.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.6.6.6.1.m1.1a"><mo id="S4.T3.6.6.6.1.m1.1.1" xref="S4.T3.6.6.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.6.1.m1.1b"><csymbol cd="latexml" id="S4.T3.6.6.6.1.m1.1.1.cmml" xref="S4.T3.6.6.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.6.1.m1.1c">\pm</annotation></semantics></math> 0.005</td>
<td id="S4.T3.7.7.7.2" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">0.5336 <math id="S4.T3.7.7.7.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T3.7.7.7.2.m1.1a"><mo id="S4.T3.7.7.7.2.m1.1.1" xref="S4.T3.7.7.7.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T3.7.7.7.2.m1.1b"><csymbol cd="latexml" id="S4.T3.7.7.7.2.m1.1.1.cmml" xref="S4.T3.7.7.7.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.7.7.2.m1.1c">\pm</annotation></semantics></math> 0.036</td>
<td id="S4.T3.7.7.7.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T3.7.7.7.5.1" class="ltx_text ltx_font_bold">6.2</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.10.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.11.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Results on FUNSD<span id="S4.T3.11.2.1" class="ltx_text ltx_font_medium">. The results have been shown for both semantic entity labeling and entity linking tasks with their corresponding metrics.</span></span></figcaption>
</figure>
</section>
<section id="S4.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.3 </span>Numerical results</h4>

<div id="S4.SS2.SSS3.p1" class="ltx_para">
<p id="S4.SS2.SSS3.p1.4" class="ltx_p">We trained our architecture (sec. <a href="#S3.SS3" title="3.3 Architecture ‣ 3 Method ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>) with a 10-fold cross validation. Since we found high variance in the results, we report both mean and variance over the 10 best models chosen over their respective validation sets. The objective function in use (<math id="S4.SS2.SSS3.p1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS2.SSS3.p1.1.m1.1a"><mi id="S4.SS2.SSS3.p1.1.m1.1.1" xref="S4.SS2.SSS3.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.1.m1.1b"><ci id="S4.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.1.m1.1c">L</annotation></semantics></math>) is based on both node (<math id="S4.SS2.SSS3.p1.2.m2.1" class="ltx_Math" alttext="L_{n}" display="inline"><semantics id="S4.SS2.SSS3.p1.2.m2.1a"><msub id="S4.SS2.SSS3.p1.2.m2.1.1" xref="S4.SS2.SSS3.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS3.p1.2.m2.1.1.2" xref="S4.SS2.SSS3.p1.2.m2.1.1.2.cmml">L</mi><mi id="S4.SS2.SSS3.p1.2.m2.1.1.3" xref="S4.SS2.SSS3.p1.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.2.m2.1b"><apply id="S4.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.2">𝐿</ci><ci id="S4.SS2.SSS3.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.2.m2.1c">L_{n}</annotation></semantics></math>) and edge (<math id="S4.SS2.SSS3.p1.3.m3.1" class="ltx_Math" alttext="L_{e}" display="inline"><semantics id="S4.SS2.SSS3.p1.3.m3.1a"><msub id="S4.SS2.SSS3.p1.3.m3.1.1" xref="S4.SS2.SSS3.p1.3.m3.1.1.cmml"><mi id="S4.SS2.SSS3.p1.3.m3.1.1.2" xref="S4.SS2.SSS3.p1.3.m3.1.1.2.cmml">L</mi><mi id="S4.SS2.SSS3.p1.3.m3.1.1.3" xref="S4.SS2.SSS3.p1.3.m3.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.3.m3.1b"><apply id="S4.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1.2">𝐿</ci><ci id="S4.SS2.SSS3.p1.3.m3.1.1.3.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.3.m3.1c">L_{e}</annotation></semantics></math>) classification tasks: <math id="S4.SS2.SSS3.p1.4.m4.1" class="ltx_Math" alttext="L=L_{n}+L_{e}" display="inline"><semantics id="S4.SS2.SSS3.p1.4.m4.1a"><mrow id="S4.SS2.SSS3.p1.4.m4.1.1" xref="S4.SS2.SSS3.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS3.p1.4.m4.1.1.2" xref="S4.SS2.SSS3.p1.4.m4.1.1.2.cmml">L</mi><mo id="S4.SS2.SSS3.p1.4.m4.1.1.1" xref="S4.SS2.SSS3.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S4.SS2.SSS3.p1.4.m4.1.1.3" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.cmml"><msub id="S4.SS2.SSS3.p1.4.m4.1.1.3.2" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.2.cmml"><mi id="S4.SS2.SSS3.p1.4.m4.1.1.3.2.2" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.2.2.cmml">L</mi><mi id="S4.SS2.SSS3.p1.4.m4.1.1.3.2.3" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.2.3.cmml">n</mi></msub><mo id="S4.SS2.SSS3.p1.4.m4.1.1.3.1" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.1.cmml">+</mo><msub id="S4.SS2.SSS3.p1.4.m4.1.1.3.3" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.3.cmml"><mi id="S4.SS2.SSS3.p1.4.m4.1.1.3.3.2" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.3.2.cmml">L</mi><mi id="S4.SS2.SSS3.p1.4.m4.1.1.3.3.3" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.3.3.cmml">e</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.4.m4.1b"><apply id="S4.SS2.SSS3.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1"><eq id="S4.SS2.SSS3.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.1"></eq><ci id="S4.SS2.SSS3.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.2">𝐿</ci><apply id="S4.SS2.SSS3.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3"><plus id="S4.SS2.SSS3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.1"></plus><apply id="S4.SS2.SSS3.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.4.m4.1.1.3.2.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.2">subscript</csymbol><ci id="S4.SS2.SSS3.p1.4.m4.1.1.3.2.2.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.2.2">𝐿</ci><ci id="S4.SS2.SSS3.p1.4.m4.1.1.3.2.3.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.2.3">𝑛</ci></apply><apply id="S4.SS2.SSS3.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.3">subscript</csymbol><ci id="S4.SS2.SSS3.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.3.2">𝐿</ci><ci id="S4.SS2.SSS3.p1.4.m4.1.1.3.3.3.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.3.3">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.4.m4.1c">L=L_{n}+L_{e}</annotation></semantics></math>.
In Tab. <a href="#S4.T3" title="Table 3 ‣ 4.2.2 Entity Detection ‣ 4.2 FUNSD ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> we report the performances of our model Doc2Graph compared to other language models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and graph-based techniques <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. The number of parameters # Params refer to the trainable Doc2Graph pipeline (that includes the U-Net and YOLO backbones); for the spaCy word-embedding details, refer to <a target="_blank" href="https://spacy.io/models/en#en_core_web_lg" title="" class="ltx_ref ltx_href">their documentation</a>. Using YOLO our network outperforms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> for semantic entity labeling and meets their model on entity linking, using just 13.5 parameters. We could not do better than FUDGE, which still outperforms our scores. Their backbone is trained for both tasks along with the GCN (GCN that adds just minor improvements). The gap, especially on entity linking, is mainly due to the low contributions given by our visual features (Tab. <a href="#S4.T1" title="Table 1 ‣ 4.1 Proposed model ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) and the detector in use (Tab. <a href="#S4.F3" title="Figure 3 ‣ 4.2.2 Entity Detection ‣ 4.2 FUNSD ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
We also report the results of our model initialized with ground truth (GT) entities, to show how it would perform in the best case scenario. Entity linking remains a harder task compared to semantic entity labeling and only complex language models seem to be able to solve it. Moreover, for the sake of completeness, we highlight that, with good entity representations, our model outperforms all the considered architectures for the Semantic Entity Labeling task. Finally, we want to further stress that the main contribution of a graph-based method is to yield a simpler but more lightweight solution.</p>
</div>
</section>
<section id="S4.SS2.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.4 </span>Qualitative results</h4>

<div id="S4.SS2.SSS4.p1" class="ltx_para">
<p id="S4.SS2.SSS4.p1.1" class="ltx_p">The order matters for detecting key-value relationship, since the direction of a link induce a property for the destination entity that enrich its meaning. Differently from FUDGE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> we do make use of directed edges, which led to a better understanding of the document having interpretable results. In Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.3.2 Numerical results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> we show our qualitative results using Doc2Graph on groundtruth: green and red dots mean source and destination nodes, respectively. As shown in the different example cases, Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.3.2 Numerical results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a><a href="#S4.F5.sf1" title="In Figure 5 ‣ 4.3.2 Numerical results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5(a)</span></a> and  <a href="#S4.F5" title="Figure 5 ‣ 4.3.2 Numerical results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a><a href="#S4.F5.sf2" title="In Figure 5 ‣ 4.3.2 Numerical results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5(b)</span></a> resemble a simple structured form layout with directed one-to-one key-value association pairs and Doc2Graph manages to extract them. On the contrary, where the layout appears to be more complex as in Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.3.2 Numerical results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a><a href="#S4.F5.sf4" title="In Figure 5 ‣ 4.3.2 Numerical results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5(d)</span></a>, Doc2Graph fails to generalize the concept of one-to-many key-value relationship pairs. This may be due to the small number of trainable samples we had in our training data and the fact that header-cells usually present different positioning and semantic meaning. In the future we will integrate a table structure recognition path into our pipeline, hoping to improve the extraction of all kinds of key-value relationships in such more complex layout scenarios.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>RVL-CDIP Invoices</h3>

<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Dataset</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p">In the work of Riba et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> another subset of RVL-CDIP has been released. The authors selected 518 documents from the invoices classes, annotating 6 different regions (two examples of annotations are shown in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.3.1 Dataset ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). The task that can be performed are layout analysis, in terms of node classification, and table detection, in terms of bounding box (IoU <math id="S4.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S4.SS3.SSS1.p1.1.m1.1a"><mo id="S4.SS3.SSS1.p1.1.m1.1.1" xref="S4.SS3.SSS1.p1.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p1.1.m1.1b"><gt id="S4.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p1.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.1.m1.1c">&gt;</annotation></semantics></math> 50).</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2208.11168/assets/x4.png" id="S4.F4.1.g1" class="ltx_graphics ltx_img_portrait" width="368" height="488" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2208.11168/assets/x5.png" id="S4.F4.2.g1" class="ltx_graphics ltx_img_portrait" width="368" height="488" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.5.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.6.2" class="ltx_text ltx_font_bold" style="font-size:90%;">RVL-CDIP Invoices benchmark in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite><span id="S4.F4.6.2.1" class="ltx_text ltx_font_medium">. There are 6 regions: supplier (pink), invoice_info (brown), receiver (green), table (orange), total (light blue), other (gray).</span></span></figcaption>
</figure>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Numerical results</h4>

<div id="S4.SS3.SSS2.p1" class="ltx_para">
<p id="S4.SS3.SSS2.p1.1" class="ltx_p">As done previously, we perform a k-fold cross validation keeping, for each fold, the same amount of test (104), val (52) and training documents (362). This time we applied an OCR to build the graph. There are two tasks: layout analysis, in terms of accuracy, and table detection, using F1 score and <math id="S4.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="IoU&gt;0.50" display="inline"><semantics id="S4.SS3.SSS2.p1.1.m1.1a"><mrow id="S4.SS3.SSS2.p1.1.m1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.cmml"><mrow id="S4.SS3.SSS2.p1.1.m1.1.1.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.cmml"><mi id="S4.SS3.SSS2.p1.1.m1.1.1.2.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS2.p1.1.m1.1.1.2.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.SS3.SSS2.p1.1.m1.1.1.2.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS2.p1.1.m1.1.1.2.1a" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.SS3.SSS2.p1.1.m1.1.1.2.4" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.4.cmml">U</mi></mrow><mo id="S4.SS3.SSS2.p1.1.m1.1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.cmml">&gt;</mo><mn id="S4.SS3.SSS2.p1.1.m1.1.1.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.3.cmml">0.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.1.m1.1b"><apply id="S4.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1"><gt id="S4.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1"></gt><apply id="S4.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.2"><times id="S4.SS3.SSS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.1"></times><ci id="S4.SS3.SSS2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.2">𝐼</ci><ci id="S4.SS3.SSS2.p1.1.m1.1.1.2.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.3">𝑜</ci><ci id="S4.SS3.SSS2.p1.1.m1.1.1.2.4.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.4">𝑈</ci></apply><cn type="float" id="S4.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.3">0.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.1.m1.1c">IoU&gt;0.50</annotation></semantics></math> for table regions. Our model outperforms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> in both tasks, as shown in tables <a href="#S4.T4" title="Table 4 ‣ 4.3.2 Numerical results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#S4.T5" title="Table 5 ‣ 4.3.2 Numerical results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. In particular, for table detection, we extracted the subgraph induced by the edge classified as ‘table’ (two nodes are linked if they are in the same table) to extract the target region. Riba et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> formulated the problem as a binary classification: we report, for brevity, in Tab. <a href="#S4.T5" title="Table 5 ‣ 4.3.2 Numerical results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> the threshold on confidence score they use to cut out edges, that in our multi-class setting (‘none’ or ‘table’) is implicitly set to 0.50 by the softmax.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<div id="S4.T4.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:260.2pt;height:74.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(3.9pt,-1.1pt) scale(1.03084636410749,1.03084636410749) ;">
<table id="S4.T4.2.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.1.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></th>
<th id="S4.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="2">
<span id="S4.T4.1.1.1.1.1" class="ltx_text ltx_font_italic">Accuracy</span> (<math id="S4.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T4.1.1.1.1.m1.1a"><mo stretchy="false" id="S4.T4.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><ci id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math>)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.2.2.3.1" class="ltx_tr">
<th id="S4.T4.2.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T4.2.2.3.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<td id="S4.T4.2.2.3.1.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T4.2.2.3.1.2.1" class="ltx_text ltx_font_bold">Max</span></td>
<td id="S4.T4.2.2.3.1.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T4.2.2.3.1.3.1" class="ltx_text ltx_font_bold">Mean</span></td>
</tr>
<tr id="S4.T4.2.2.4.2" class="ltx_tr">
<th id="S4.T4.2.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">Riba et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</th>
<td id="S4.T4.2.2.4.2.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">62.30</td>
<td id="S4.T4.2.2.4.2.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">-</td>
</tr>
<tr id="S4.T4.2.2.2" class="ltx_tr">
<th id="S4.T4.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">Doc2Graph + OCR</th>
<td id="S4.T4.2.2.2.3" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T4.2.2.2.3.1" class="ltx_text ltx_font_bold">69.80</span></td>
<td id="S4.T4.2.2.2.1" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S4.T4.2.2.2.1.1" class="ltx_text ltx_font_bold">67.80</span> <math id="S4.T4.2.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.2.2.2.1.m1.1a"><mo id="S4.T4.2.2.2.1.m1.1.1" xref="S4.T4.2.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.1.m1.1b"><csymbol cd="latexml" id="S4.T4.2.2.2.1.m1.1.1.cmml" xref="S4.T4.2.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.1.m1.1c">\pm</annotation></semantics></math> 1.1</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.5.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S4.T4.6.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Layout analysis results on RVL-CDIP Invoices<span id="S4.T4.6.2.1" class="ltx_text ltx_font_medium">. Layout analysis accuracy scores depicted in terms of node classification task.</span></span></figcaption>
</figure>
<figure id="S4.T5" class="ltx_table">
<div id="S4.T5.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:88pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-5.0pt,1.0pt) scale(0.977537199788241,0.977537199788241) ;">
<table id="S4.T5.4.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.1.1.1" class="ltx_tr">
<th id="S4.T5.1.1.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></th>
<th id="S4.T5.1.1.1.3" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></th>
<th id="S4.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="3">
<span id="S4.T5.1.1.1.1.1" class="ltx_text ltx_font_italic">Metrics</span> (<math id="S4.T5.1.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T5.1.1.1.1.m1.1a"><mo stretchy="false" id="S4.T5.1.1.1.1.m1.1.1" xref="S4.T5.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T5.1.1.1.1.m1.1b"><ci id="S4.T5.1.1.1.1.m1.1.1.cmml" xref="S4.T5.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math>)</th>
</tr>
<tr id="S4.T5.4.4.5.1" class="ltx_tr">
<th id="S4.T5.4.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T5.4.4.5.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S4.T5.4.4.5.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T5.4.4.5.1.2.1" class="ltx_text ltx_font_bold">Threshold</span></th>
<th id="S4.T5.4.4.5.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T5.4.4.5.1.3.1" class="ltx_text ltx_font_bold">Precision</span></th>
<th id="S4.T5.4.4.5.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T5.4.4.5.1.4.1" class="ltx_text ltx_font_bold">Recall</span></th>
<th id="S4.T5.4.4.5.1.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T5.4.4.5.1.5.1" class="ltx_text ltx_font_bold">F<sub id="S4.T5.4.4.5.1.5.1.1" class="ltx_sub">1</sub></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.4.4.6.1" class="ltx_tr">
<th id="S4.T5.4.4.6.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">Riba et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</th>
<th id="S4.T5.4.4.6.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.1</th>
<td id="S4.T5.4.4.6.1.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.2520</td>
<td id="S4.T5.4.4.6.1.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T5.4.4.6.1.4.1" class="ltx_text ltx_font_bold">0.3960</span></td>
<td id="S4.T5.4.4.6.1.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">0.3080</td>
</tr>
<tr id="S4.T5.4.4.7.2" class="ltx_tr">
<th id="S4.T5.4.4.7.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">Riba et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</th>
<th id="S4.T5.4.4.7.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;">0.5</th>
<td id="S4.T5.4.4.7.2.3" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.1520</td>
<td id="S4.T5.4.4.7.2.4" class="ltx_td ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.3650</td>
<td id="S4.T5.4.4.7.2.5" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-left:10.0pt;padding-right:10.0pt;">0.2150</td>
</tr>
<tr id="S4.T5.4.4.4" class="ltx_tr">
<th id="S4.T5.4.4.4.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">Doc2Graph + OCR</th>
<th id="S4.T5.4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">0.5</th>
<td id="S4.T5.2.2.2.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S4.T5.2.2.2.1.1" class="ltx_text ltx_font_bold">0.3786</span> <math id="S4.T5.2.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.2.2.2.1.m1.1a"><mo id="S4.T5.2.2.2.1.m1.1.1" xref="S4.T5.2.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.2.2.2.1.m1.1b"><csymbol cd="latexml" id="S4.T5.2.2.2.1.m1.1.1.cmml" xref="S4.T5.2.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.2.2.2.1.m1.1c">\pm</annotation></semantics></math> 0.07</td>
<td id="S4.T5.3.3.3.2" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">0.3723 <math id="S4.T5.3.3.3.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.3.3.3.2.m1.1a"><mo id="S4.T5.3.3.3.2.m1.1.1" xref="S4.T5.3.3.3.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.3.3.3.2.m1.1b"><csymbol cd="latexml" id="S4.T5.3.3.3.2.m1.1.1.cmml" xref="S4.T5.3.3.3.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.3.3.2.m1.1c">\pm</annotation></semantics></math> 0.07</td>
<td id="S4.T5.4.4.4.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S4.T5.4.4.4.3.1" class="ltx_text ltx_font_bold">0.3754</span> <math id="S4.T5.4.4.4.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.4.4.4.3.m1.1a"><mo id="S4.T5.4.4.4.3.m1.1.1" xref="S4.T5.4.4.4.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.4.4.4.3.m1.1b"><csymbol cd="latexml" id="S4.T5.4.4.4.3.m1.1.1.cmml" xref="S4.T5.4.4.4.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.4.4.3.m1.1c">\pm</annotation></semantics></math> 0.07</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T5.7.1.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="S4.T5.8.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Table Detection in terms of F1 score<span id="S4.T5.8.2.1" class="ltx_text ltx_font_medium">. A table is considered correctly detected if its IoU is greater than 0.50. Threshold values refers to the scores an edges has to have in order to do not be cut: in our case is set to 0.50 by the softmax in use.</span></span></figcaption>
</figure>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2208.11168/assets/x6.png" id="S4.F5.sf1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="415" height="541" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2208.11168/assets/x7.png" id="S4.F5.sf2.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="415" height="550" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2208.11168/assets/x8.png" id="S4.F5.sf3.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="415" height="540" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F5.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2208.11168/assets/x9.png" id="S4.F5.sf4.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="415" height="517" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.sf4.2.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.3.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S4.F5.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Entity Linking on FUNSD<span id="S4.F5.4.2.1" class="ltx_text ltx_font_medium">. We make use of directed edges: green and red dots mean source and destination nodes, respectively.</span></span></figcaption>
</figure>
</section>
<section id="S4.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3 </span>Qualitative results</h4>

<div id="S4.SS3.SSS3.p1" class="ltx_para">
<p id="S4.SS3.SSS3.p1.1" class="ltx_p">In Fig. <a href="#S4.F6" title="Figure 6 ‣ 4.3.3 Qualitative results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> we show the qualitative results. The two documents are duplicated to better visualize the two tasks. For layout analysis, the greater boxes colors indicate the true label that the word inside should have (the colors reflects classes as shown in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.3.1 Dataset ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). For the table detection we use a simple heuristic: we take the enclosing rectangle (green) of the nodes connected by ‘table’ edges, then we evaluate the IoU with target regions (orange). This heuristic is effective but simple and so error-prone: if a false positive is found outside table regions this could lead to a poor detection result, e.g. a bounding box including also ’sender item’ entity or ’receiver item’ entity. In addition, as inferred from Figs. <a href="#S4.F6" title="Figure 6 ‣ 4.3.3 Qualitative results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a><a href="#S4.F6.sf1" title="In Figure 6 ‣ 4.3.3 Qualitative results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6(a)</span></a> and  <a href="#S4.F6" title="Figure 6 ‣ 4.3.3 Qualitative results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a><a href="#S4.F6.sf2" title="In Figure 6 ‣ 4.3.3 Qualitative results ‣ 4.3 RVL-CDIP Invoices ‣ 4 Experiments and Results ‣ Doc2Graph: a Task Agnostic Document Understanding Framework based on Graph Neural Networks" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6(b)</span></a>, ’total’ regions could be taken out.
In the future, we will refine this behaviour by both boosting the node classification task and including ’total’ as a table region for the training of edges.</p>
</div>
<figure id="S4.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2208.11168/assets/x10.png" id="S4.F6.sf1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="415" height="538" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2208.11168/assets/x11.png" id="S4.F6.sf2.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="415" height="538" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F6.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2208.11168/assets/x12.png" id="S4.F6.sf3.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="415" height="538" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F6.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2208.11168/assets/x13.png" id="S4.F6.sf4.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="415" height="538" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.sf4.2.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F6.3.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S4.F6.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Layout Analysis on RVLCDIP Invoices<span id="S4.F6.4.2.1" class="ltx_text ltx_font_medium">. Inference over two documents from RVL-CDIP Invoices, showing both Layout Analysis (a,c) and Table Detection (b,d) tasks.</span></span></figcaption>
</figure>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this work, we have presented a task-agnostic document understanding framework based on a Graph Neural Network. We propose a general representation of documents as graphs, exploiting fully connectivity between document objects and letting the network automatically learn meaningful pairwise relationships. Node and edge aggregation functions are defined by taking into account the relative positioning of document objects. We evaluated our model on two challenging benchmarks for three different tasks: entity linking on forms, layout analysis on invoices and table detection. Our preliminary results show that our model can achieve promising results, keeping the network dimensionality considerably low.
For future works, we will extend our framework to other documents and tasks, to deeper investigate the generalization property of the GNN. We would like to explore more extensively the contribution of different source features and how to combine them in more meaningful and learnable ways.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgment</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work has been partially supported by the the Spanish projects MIRANDA RTI2018-095645-B-C21 and GRAIL PID2021-126808OB-I00, the CERCA Program / Generalitat de Catalunya, the FCT-19-15244, and PhD Scholarship from AGAUR (2021FIB-10010).</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Appalaraju, S., Jasani, B., Kota, B.U., Xie, Y., Manmatha, R.: Docformer:
End-to-end transformer for document understanding. In: Proceedings of the
IEEE/CVF International Conference on Computer Vision. pp. 993–1003 (2021)

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Biswas, S., Banerjee, A., Lladós, J., Pal, U.: Docsegtr: An instance-level
end-to-end document image segmentation transformer. arXiv preprint
arXiv:2201.11438 (2022)

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Biswas, S., Riba, P., Lladós, J., Pal, U.: Beyond document object
detection: instance-level segmentation of complex layouts. International
Journal on Document Analysis and Recognition (IJDAR) <span id="bib.bib3.1.1" class="ltx_text ltx_font_bold">24</span>(3),
269–281 (2021)

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Biswas, S., Riba, P., Lladós, J., Pal, U.: Graph-based deep generative
modelling for document layout generation. In: International Conference on
Document Analysis and Recognition. pp. 525–537. Springer (2021)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Borchmann, Ł., Pietruszka, M., Stanislawek, T., Jurkiewicz, D., Turski, M.,
Szyndler, K., Graliński, F.: Due: End-to-end document understanding
benchmark. In: Thirty-fifth Conference on Neural Information Processing
Systems Datasets and Benchmarks Track (Round 2) (2021)

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Carbonell, M., Riba, P., Villegas, M., Fornés, A., Lladós, J.: Named
entity recognition and relation extraction with graph neural networks in semi
structured documents. In: 2020 25th International Conference on Pattern
Recognition (ICPR). pp. 9622–9627. IEEE (2021)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Davis, B., Morse, B., Cohen, S., Price, B., Tensmeyer, C.: Deep visual
template-free form parsing. In: 2019 International Conference on Document
Analysis and Recognition (ICDAR). pp. 134–141. IEEE (2019)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Davis, B., Morse, B., Price, B., Tensmeyer, C., Wiginton, C.: Visual fudge:
Form understanding via dynamic graph editing. In: International Conference on
Document Analysis and Recognition. pp. 416–431. Springer (2021)

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Gemelli, A., Vivoli, E., Marinai, S.: Graph neural networks and representation
embedding for table extraction in PDF documents. In: accepted for
publication at ICPR22 (2022)

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Goldmann, L.: Layout Analysis Groundtruth for the RVL-CDIP Dataset (Sep
2019). https://doi.org/10.5281/zenodo.3257319

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Hamilton, W., Ying, Z., Leskovec, J.: Inductive representation learning on
large graphs. Advances in neural information processing systems <span id="bib.bib11.1.1" class="ltx_text ltx_font_bold">30</span>
(2017)

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Harley, A.W., Ufkes, A., Derpanis, K.G.: Evaluation of deep convolutional nets
for document image classification and retrieval. In: International Conference
on Document Analysis and Recognition (ICDAR)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Hong, T., Kim, D., Ji, M., Hwang, W., Nam, D., Park, S.: Bros: a pre-trained
language model for understanding texts in document (2020)

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Huang, Z., Chen, K., He, J., Bai, X., Karatzas, D., Lu, S., Jawahar, C.:
Icdar2019 competition on scanned receipt ocr and information extraction. In:
2019 International Conference on Document Analysis and Recognition (ICDAR).
pp. 1516–1520. IEEE (2019)

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Jaume, G., Ekenel, H.K., Thiran, J.P.: Funsd: A dataset for form understanding
in noisy scanned documents. In: 2019 International Conference on Document
Analysis and Recognition Workshops (ICDARW). vol. 2, pp. 1–6. IEEE (2019)

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Jocher, G., Chaurasia, A., Stoken, A., Borovec, J., NanoCode012, Kwon, Y.,
TaoXie, Fang, J., imyhxy, Michael, K.: ultralytics/yolov5: v6. 1-tensorrt,
tensorflow edge tpu and openvino export and inference. Zenodo, Feb
<span id="bib.bib16.1.1" class="ltx_text ltx_font_bold">22</span> (2022)

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Li, X., Wu, B., Song, J., Gao, L., Zeng, P., Gan, C.: Text-instance graph:
Exploring the relational semantics for text-based visual question answering.
Pattern Recognition <span id="bib.bib17.1.1" class="ltx_text ltx_font_bold">124</span>, 108455 (2022)

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Liang, Y., Wang, X., Duan, X., Zhu, W.: Multi-modal contextual graph neural
network for text visual question answering. In: 2020 25th International
Conference on Pattern Recognition (ICPR). pp. 3491–3498. IEEE (2021)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Lin, T.Y., Maire, M., Belongie, S., Hays, J., Perona, P., Ramanan, D.,
Dollár, P., Zitnick, C.L.: Microsoft coco: Common objects in context. In:
European conference on computer vision. pp. 740–755. Springer (2014)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Liu, H., Li, X., Liu, B., Jiang, D., Liu, Y., Ren, B.: Neural collaborative
graph machines for table structure recognition. In: Proceedings of the
IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp.
4533–4542 (2022)

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Mathew, M., Karatzas, D., Jawahar, C.: Docvqa: A dataset for vqa on document
images. In: Proceedings of the IEEE/CVF winter conference on applications of
computer vision. pp. 2200–2209 (2021)

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Powalski, R., Borchmann, Ł., Jurkiewicz, D., Dwojak, T., Pietruszka, M.,
Pałka, G.: Going full-tilt boogie on document understanding with
text-image-layout transformer. In: International Conference on Document
Analysis and Recognition. pp. 732–747. Springer (2021)

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Qasim, S.R., Mahmood, H., Shafait, F.: Rethinking table recognition using graph
neural networks. In: 2019 International Conference on Document Analysis and
Recognition (ICDAR). pp. 142–147. IEEE (2019)

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Raja, S., Mondal, A., Jawahar, C.: Table structure recognition using top-down
and bottom-up cues. In: European Conference on Computer Vision. pp. 70–86.
Springer (2020)

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Riba, P., Dutta, A., Goldmann, L., Fornés, A., Ramos, O., Lladós, J.:
Table detection in invoice documents by graph neural networks. In: 2019
International Conference on Document Analysis and Recognition (ICDAR). pp.
122–127. IEEE (2019)

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Riba, P., Goldmann, L., Terrades, O.R., Rusticus, D., Fornés, A.,
Lladós, J.: Table detection in business document images by message
passing networks. Pattern Recognition <span id="bib.bib26.1.1" class="ltx_text ltx_font_bold">127</span>, 108641 (2022)

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Ronneberger, O., Fischer, P., Brox, T.: U-net: Convolutional networks for
biomedical image segmentation. CoRR <span id="bib.bib27.1.1" class="ltx_text ltx_font_bold">abs/1505.04597</span> (2015),
<a target="_blank" href="http://arxiv.org/abs/1505.04597" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1505.04597</a>

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Sarkar, M., Aggarwal, M., Jain, A., Gupta, H., Krishnamurthy, B.: Document
structure extraction using prior based high resolution hierarchical semantic
segmentation. In: European Conference on Computer Vision. pp. 649–666.
Springer (2020)

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Singh, A., Natarajan, V., Shah, M., Jiang, Y., Chen, X., Batra, D., Parikh, D.,
Rohrbach, M.: Towards vqa models that can read. In: Proceedings of the
IEEE/CVF conference on computer vision and pattern recognition. pp.
8317–8326 (2019)

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Smock, B., Pesala, R., Abraham, R.: Pubtables-1m: Towards comprehensive table
extraction from unstructured documents. In: Proceedings of the IEEE/CVF
Conference on Computer Vision and Pattern Recognition. pp. 4634–4642 (2022)

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Vu, H.M., Nguyen, D.T.N.: Revising funsd dataset for key-value detection in
document images. arXiv preprint arXiv:2010.05322 (2020)

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Xu, Y., Xu, Y., Lv, T., Cui, L., Wei, F., Wang, G., Lu, Y., Florencio, D.,
Zhang, C., Che, W., et al.: Layoutlmv2: Multi-modal pre-training for
visually-rich document understanding. arXiv preprint arXiv:2012.14740 (2020)

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Xu, Y., Li, M., Cui, L., Huang, S., Wei, F., Zhou, M.: Layoutlm: Pre-training
of text and layout for document image understanding. In: Proceedings of the
26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data
Mining. pp. 1192–1200 (2020)

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Xue, W., Yu, B., Wang, W., Tao, D., Li, Q.: Tgrnet: A table graph
reconstruction network for table structure recognition. In: Proceedings of
the IEEE/CVF International Conference on Computer Vision. pp. 1295–1304
(2021)

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Yu, W., Lu, N., Qi, X., Gong, P., Xiao, R.: Pick: processing key information
extraction from documents using improved graph learning-convolutional
networks. In: 2020 25th International Conference on Pattern Recognition
(ICPR). pp. 4363–4370. IEEE (2021)

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2208.11167" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2208.11168" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2208.11168">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2208.11168" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2208.11169" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Mar 13 20:18:12 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
