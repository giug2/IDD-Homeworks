<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare</title>
<!--Generated on Sat Sep 14 08:32:23 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.01813v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S1" title="In Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S2" title="In Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span><span class="ltx_text ltx_font_smallcaps">Related Works</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3" title="In Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span><span class="ltx_text ltx_font_smallcaps">Methods</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.SS1" title="In 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span><span class="ltx_text ltx_font_italic">Preliminaries: Quantization</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.SS2" title="In 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span><span class="ltx_text ltx_font_italic">Data Synthesis from Pre-trained SAM</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.SS3" title="In 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span><span class="ltx_text ltx_font_italic">Quantization Calibration: Scale Reparameterization</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.SS4" title="In 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span><span class="ltx_text ltx_font_italic">The Overall Quantization Pipeline</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4" title="In Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span><span class="ltx_text ltx_font_smallcaps">Experiments</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4.SS1" title="In 4 Experiments ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span><span class="ltx_text ltx_font_italic">Analysis of Synthesized Images</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4.SS2" title="In 4 Experiments ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span><span class="ltx_text ltx_font_italic">Efficiency Evaluation of Quantized Models</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4.SS3" title="In 4 Experiments ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span><span class="ltx_text ltx_font_italic">Accuracy Evaluation of Quantized Models</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4.SS4" title="In 4 Experiments ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span><span class="ltx_text ltx_font_italic">Ablation Studies</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S5" title="In Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span><span class="ltx_text ltx_font_smallcaps">Conclusion</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A1" title="In Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Our preliminary efforts for DFQ-SAM</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A1.SS1" title="In Appendix A Our preliminary efforts for DFQ-SAM ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span><span class="ltx_text ltx_font_italic">PSAQ-ViT: Patch Similarity Metric</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A1.SS2" title="In Appendix A Our preliminary efforts for DFQ-SAM ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span><span class="ltx_text ltx_font_italic">RepQ-ViT: Scale Reparameterization</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A2" title="In Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>More experimental details and results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A2.SS1" title="In Appendix B More experimental details and results ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span><span class="ltx_text ltx_font_italic">Implementation Details</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A2.SS2" title="In Appendix B More experimental details and results ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span><span class="ltx_text ltx_font_italic">Visualization of Label Evolution</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A2.SS3" title="In Appendix B More experimental details and results ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span><span class="ltx_text ltx_font_italic">Qualitative Evaluation of Quantization Results</span></span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\newfloatcommand</span>
<p class="ltx_p" id="p1.2">capbtabboxtable[][<span class="ltx_ERROR undefined" id="p1.2.1">\FBwidth</span>]














</p>
</div>
<h1 class="ltx_title ltx_title_document" style="font-size:207%;">Privacy-Preserving SAM Quantization for 
<br class="ltx_break"/>Efficient Edge Intelligence in Healthcare</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhikai Li<sup class="ltx_sup" id="id4.4.id1">∗</sup>, Jing Zhang<sup class="ltx_sup" id="id5.5.id2">∗</sup>, and Qingyi Gu
</span><span class="ltx_author_notes"><sup class="ltx_sup" id="id6.6.id1">∗</sup> Equal Contribution
This work is supported in part by the National Natural Science Foundation of China under Grant 62276255; in part by the National Science and Technology Major Project under Grant 2022ZD0119402. (Corresponding author: Qingyi Gu)
Z. Li, J. Zhang, and Q. Gu are with the Institute of Automation, Chinese Academy of Sciences, Beijing 100190, China, and Z. Li and J. Zhang are also with the School of Artificial Intelligence, University of Chinese Academy of Sciences, Beijing 100049, China. (e-mail: lizhikai2020@ia.ac.cn; zhangjing2024@ia.ac.cn; qingyi.gu@ia.ac.cn)
Our code will be publicly available.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id7.id1">The disparity in healthcare personnel expertise and medical resources across different regions of the world is a pressing social issue. Artificial intelligence technology offers new opportunities to alleviate this issue by empowering diagnostic and treatment capabilities in underdeveloped areas. Segment Anything Model (SAM), which excels in intelligent image segmentation, has demonstrated exceptional performance in medical monitoring and assisted diagnosis. Unfortunately, the huge computational and storage overhead of SAM poses significant challenges for deployment on resource-limited edge devices, especially in underdeveloped regions with limited equipment and computing power.
Quantization is an effective solution for model compression; however, traditional methods rely heavily on original data for calibration, which raises widespread concerns about medical data privacy and security.
In this paper, we propose a data-free quantization framework for SAM, called DFQ-SAM, which learns and calibrates quantization parameters without any original data, thus effectively preserving data privacy during model compression. Specifically, we propose pseudo-positive label evolution for segmentation, combined with patch similarity, to fully leverage the semantic and distribution priors in pre-trained models, which facilitates high-quality data synthesis as a substitute for real data.
Furthermore, we introduce scale reparameterization to ensure the accuracy of low-bit quantization.
We perform extensive segmentation experiments on datasets of various modalities such as CT and MRI, and DFQ-SAM consistently provides significant performance on low-bit quantization, e.g., 4-bit quantization results in only a 2.01% accuracy decrease in abdominal organ segmentation on AbdomenCT1K dataset.
DFQ-SAM decouples the model deployment from real data, eliminating the need for data transfer in cloud-edge collaboration, thereby protecting sensitive data from potential attacks.
By offloading complex medical analysis tasks to local nodes and employing privacy-preserving model compression, it enables secure, fast, and personalized healthcare services at the edge. This enhances system efficiency and optimizes resource allocation, and thus facilitating the pervasive application of artificial intelligence in worldwide healthcare, especially in remote or resource-limited regions.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The severe imbalance in healthcare personnel expertise and medical resources worldwide, particularly between developed and underdeveloped regions, has become an urgent social issue<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib3" title="">3</a>]</cite>. This disparity prevents patients in underdeveloped regions from receiving timely and effective medical services. For instance, over 70% of the global cancer burden occurs in low- and middle-income settings, yet most patients with malignancies lack access to the resources and systems available in high-income countries<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib4" title="">4</a>]</cite>.
Artificial intelligence technology, especially Segment Anything Model (SAM) that excels in intelligent image segmentation<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib7" title="">7</a>]</cite>, offers unprecedented opportunities to address this issue. SAM demonstrates exceptional performance in medical monitoring and assisted diagnosis, significantly enhancing diagnostic accuracy and treatment outcomes, thereby improving the overall healthcare standards in underdeveloped regions.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="422" id="S1.F1.g1" src="x1.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration of data-free quantization. It synthesizes data based on information extracted from the pre-trained model, which is then used for quantization calibration. Since no original data is utilized, it effectively protects data privacy and security.</figcaption>
</figure>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="298" id="S1.F2.g1" src="x2.png" width="797"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of the proposed DFQ-SAM. It retrieves the pre-trained model solely from the cloud, protecting data privacy by avoiding access to any original data. The model is then compressed using data-free quantization for deployment on various edge devices. It enables low-cost and reliable intelligent healthcare at the edge, allowing underdeveloped regions to equally benefit from artificial intelligence technology, thereby helping to alleviate the disparity in healthcare resources.</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite the outstanding performance, SAM’s high computational and storage requirements pose significant challenges for its deployment and application<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib9" title="">9</a>]</cite>. This is particularly problematic in underdeveloped regions, where economic constraints limit the capabilities of medical equipment and computing power, which further exacerbates the inequality in healthcare resources, preventing those most in need of technological support from benefiting.
Therefore, to facilitate the downward mobilization of high-quality healthcare resources and ensure convenient access, we are committed to exploring effective model compression techniques that allow SAM to be deployed on low-cost edge devices, serving as dedicated local nodes for each demand source.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Model quantization, which reduces the representation precision of model parameters, is a practical solution for model compression <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib11" title="">11</a>]</cite>.
Note that considering the diversity in hardware and medical tasks across local nodes, such as different generations of GPUs and CPUs, and various image modalities like CT and MRI, it’s essential that each node performs quantization locally with settings tailored to its specific conditions, rather than relying on a unified approach in the cloud.
However, traditional quantization methods require access to the original training data from the cloud to identify parameter distributions for quantization calibration<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib14" title="">14</a>]</cite>. This dependency on original data poses significant risks to data privacy and security, especially in the data-sensitive medical field<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib17" title="">17</a>]</cite>.
To this end, data-free quantization (DFQ), a.k.a. zero-shot quantization, is increasingly gaining attention<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib20" title="">20</a>]</cite>. Its goal is to utilize the prior information of the pre-trained model to synthesize data in reverse and then use them for calibration, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">1</span></a>. Despite some progress, previous DFQ efforts focus on convolutional neural networks (CNNs) for classification or detection tasks, with little exploration of SAM for segmentation tasks, leaving it an open issue.</p>
</div>
<figure class="ltx_figure" id="S1.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="284" id="S1.F3.g1" src="x3.png" width="706"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Visualization of segmentation results on different datasets (256<math alttext="\times" class="ltx_Math" display="inline" id="S1.F3.2.m1.1"><semantics id="S1.F3.2.m1.1b"><mo id="S1.F3.2.m1.1.1" xref="S1.F3.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.F3.2.m1.1c"><times id="S1.F3.2.m1.1.1.cmml" xref="S1.F3.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.F3.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S1.F3.2.m1.1e">×</annotation></semantics></math>256 pixels). The proposed DFQ-SAM, which utilizes synthesized data for 4-bit quantization, consistently performs comparable to full-precision baseline. See Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A2.F11" title="Figure 11 ‣ B.3 Qualitative Evaluation of Quantization Results ‣ Appendix B More experimental details and results ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">11</span></a> for more samples.</figcaption>
</figure>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.2">For image segmentation with SAM, the dual complexity of its model structure and task presents greater challenges in designing the DFQ algorithm. In terms of model structure, the image encoder in SAM utilizes a Transformer architecture<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib21" title="">21</a>]</cite>. Most previous works have been limited to CNNs, relying on BatchNorm statistics, which are not applicable to Transformers. Additionally, the DFQ algorithm requires pseudo-labels to guide data synthesis, but segmentation task labels must account for mask size, category, and relative position, making it challenging to specify them appropriately.
To address the above issues, we propose DFQ-SAM, an accurate and practical data-free quantization framework for SAM. Specifically, we propose an evolutionary strategy for pseudo-positive labels, which iteratively samples model outputs to reverse-update the preset labels. This approach ensures that the labels are fully aligned with the response preferences of the pre-trained model, thereby guaranteeing their rationality and effectiveness. We also leverage patch similarity to further exploit the prior knowledge within the Transformer model, enhancing the quality of synthesized data.
Moreover, to achieve accurate quantization calibration, we introduce the scale reparameterization technique, which significantly improves the performance of low-bit quantization.
DFQ-SAM exhibits strong generalization across various image modalities, and the experimental results show that it consistently achieves impressive performance on datasets of multiple modalities such as CT and MRI. For instance, when performing 4-bit quantization, DFQ-SAM achieves an 8<math alttext="\times" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mo id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><times id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">×</annotation></semantics></math> reduction in model size and a 64<math alttext="\times" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mo id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><times id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">×</annotation></semantics></math> reduction in computational complexity (i.e., BOPs), while only incurring a 2.01% drop in accuracy on AbdomenCT1K dataset.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1"><span class="ltx_text ltx_font_bold" id="S1.p5.1.1">Discussion</span>
Note that this work is an extension of our previous works, PSAQ-ViT<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib23" title="">23</a>]</cite> and RepQ-ViT<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib24" title="">24</a>]</cite>, which lay a strong theoretical foundation and provide early validation. PSAQ-ViT introduces patch similarity, making the first successful attempt at data-free quantization for Transformers, and RepQ-ViT is a powerful baseline of low-bit quantization calibration in the community. Building on these achievements, DFQ-SAM introduces a novel segmentation label evolution strategy tailored for SAM, resulting in a promising and practical data-free quantization framework. To the best of our knowledge, it is the first data-free quantization approach for SAM.
DFQ-SAM has the potential to accelerate the widespread adoption of SAM-based intelligent healthcare through low-cost, multi-node distributed edge deployment, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">2</span></a>. In this system, a large central model is maintained in the cloud, where it is continuously updated and upgraded, and periodically distributed to edge nodes. At the edge, the model is quantized according to the hardware specifications and used to deliver medical services. Thanks to data-free quantization, only the pre-trained model needs to be transmitted between the cloud and the edge, eliminating the need for any training data. This not only greatly reduces bandwidth requirements but, more importantly, ensures robust protection of data privacy and security.
Therefore, DFQ-SAM effectively addresses data privacy concerns in the compression and deployment of SAM, facilitating its widespread and secure application in real-world scenarios. In the context of the current imbalance in healthcare resource distribution, this technology helps underdeveloped regions equally benefit from intelligent healthcare, making a significant impact on improving medical conditions in these areas.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Related Works</span>
</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Medical SAM</span>
Medical image segmentation, which works on separating different tissues, organs, or pathological areas within complex medical images, can provide clear diagnostic insights and treatment guidance, and thus plays a crucial role in clinical practice<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib26" title="">26</a>]</cite>.
In recent years, a series of notable deep learning-based models, such as UNet++<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib27" title="">27</a>]</cite> and TransUNet<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib28" title="">28</a>]</cite>, have emerged. However, these models are typically designed for specific image modalities or anatomical regions and lack generalizability. In contrast, SAM stands out due to its versatility, zero-shot transfer capabilities, and interactive features<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib29" title="">29</a>]</cite>, resulting in a significant improvement in segmentation performance. To enhance the adaptability of SAM to medical images, MedSAM<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib5" title="">5</a>]</cite> and SAM-Med 2D<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib6" title="">6</a>]</cite> collect large-scale medical image datasets to fine-tune the model, significantly improving SAM’s performance on medical image segmentation. There are also works that extend them to applications with higher image resolutions<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib7" title="">7</a>]</cite> and 3D scenarios<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib30" title="">30</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">However, SAM’s high model complexity makes it challenging to deploy and execute on resource-constrained edge devices, particularly in the medical field where high concurrency and real-time processing are essential. FastSAM<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib31" title="">31</a>]</cite> and MobileSAM<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib9" title="">9</a>]</cite> optimize model efficiency from an architectural design perspective, but there is still a large gap with practical implementation.
Consequently, model compression techniques for SAM are critically desired to enable real-time intelligent medical analysis at the edge.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Data-free Quantization</span>
Quantization, which uses reduced numerical precision to represent parameters, is an effective approach for model compression<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib32" title="">32</a>]</cite>. In the quantization process, parameter calibration relies on the numerical distribution, which traditionally requires the input of original training data to obtain this distribution<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib33" title="">33</a>]</cite>. This approach raises data privacy and security concerns, particularly in the medical field where access to data is typically restricted, rendering traditional methods impractical<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib16" title="">16</a>]</cite>. To address these challenges, various efforts have begun to explore the emerging field of data-free quantization<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib20" title="">20</a>]</cite>. It focuses on leveraging the prior knowledge embedded in pre-trained models to synthesize data for calibration, and the quality of synthesized data is crucial to quantization performance<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib23" title="">23</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">The quality of synthesized data depends on its consistency with the original training data in both distribution and semantics. Earlier approaches achieve distribution consistency through BatchNorm statistics<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib18" title="">18</a>]</cite> and promote semantic consistency using preset pseudo-labels<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib16" title="">16</a>]</cite>. However, they suffer from great limitations on model structures and tasks. On one hand, there is no BatchNorm layer in Transformers, resulting in unavailable statistical information; on the other hand, the presetting of labels for segmentation tasks is unexplored. Therefore, how to realize data-free quantization of SAM for image segmentation remains an open issue.
In this paper, we first employ patch similarity as a substitute for BatchNorm statistics to capture the prior distribution in Transformers, as proposed in our preliminary work PSAQ-ViT<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib23" title="">23</a>]</cite>. Building on it, we propose the pseudo-positive label evolution strategy to generate and iteratively update the segmentation labels, thus achieving accurate data-free quantization of SAM.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Methods</span>
</h2>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="233" id="S3.F4.g1" src="x4.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Illustration of pseudo-label evolution and synthesized image updating (256<math alttext="\times" class="ltx_Math" display="inline" id="S3.F4.2.m1.1"><semantics id="S3.F4.2.m1.1b"><mo id="S3.F4.2.m1.1.1" xref="S3.F4.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.F4.2.m1.1c"><times id="S3.F4.2.m1.1.1.cmml" xref="S3.F4.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S3.F4.2.m1.1e">×</annotation></semantics></math>256 pixels). Label evolution and image updating are conducted alternately: The label continuously discovers new regions based on the image outputs, which in turn further drives the image optimization. Ultimately, both converge at a high semantic level. See Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A2.F10" title="Figure 10 ‣ B.2 Visualization of Label Evolution ‣ Appendix B More experimental details and results ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">10</span></a> for more samples.</figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span><span class="ltx_text ltx_font_italic" id="S3.SS1.1.1">Preliminaries: Quantization</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.10">Model quantization discretizes the full-precision parameters in the pre-trained model and represents them as integer values.
In the following, we introduce the discretization process through the uniform quantizer, which is the simplest and most commonly used quantizer:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E1">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E1X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle Quant" class="ltx_Math" display="inline" id="S3.E1X.2.1.1.m1.1"><semantics id="S3.E1X.2.1.1.m1.1a"><mrow id="S3.E1X.2.1.1.m1.1.1" xref="S3.E1X.2.1.1.m1.1.1.cmml"><mi id="S3.E1X.2.1.1.m1.1.1.2" xref="S3.E1X.2.1.1.m1.1.1.2.cmml">Q</mi><mo id="S3.E1X.2.1.1.m1.1.1.1" xref="S3.E1X.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.E1X.2.1.1.m1.1.1.3" xref="S3.E1X.2.1.1.m1.1.1.3.cmml">u</mi><mo id="S3.E1X.2.1.1.m1.1.1.1a" xref="S3.E1X.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.E1X.2.1.1.m1.1.1.4" xref="S3.E1X.2.1.1.m1.1.1.4.cmml">a</mi><mo id="S3.E1X.2.1.1.m1.1.1.1b" xref="S3.E1X.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.E1X.2.1.1.m1.1.1.5" xref="S3.E1X.2.1.1.m1.1.1.5.cmml">n</mi><mo id="S3.E1X.2.1.1.m1.1.1.1c" xref="S3.E1X.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.E1X.2.1.1.m1.1.1.6" xref="S3.E1X.2.1.1.m1.1.1.6.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E1X.2.1.1.m1.1b"><apply id="S3.E1X.2.1.1.m1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1"><times id="S3.E1X.2.1.1.m1.1.1.1.cmml" xref="S3.E1X.2.1.1.m1.1.1.1"></times><ci id="S3.E1X.2.1.1.m1.1.1.2.cmml" xref="S3.E1X.2.1.1.m1.1.1.2">𝑄</ci><ci id="S3.E1X.2.1.1.m1.1.1.3.cmml" xref="S3.E1X.2.1.1.m1.1.1.3">𝑢</ci><ci id="S3.E1X.2.1.1.m1.1.1.4.cmml" xref="S3.E1X.2.1.1.m1.1.1.4">𝑎</ci><ci id="S3.E1X.2.1.1.m1.1.1.5.cmml" xref="S3.E1X.2.1.1.m1.1.1.5">𝑛</ci><ci id="S3.E1X.2.1.1.m1.1.1.6.cmml" xref="S3.E1X.2.1.1.m1.1.1.6">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1X.2.1.1.m1.1c">\displaystyle Quant</annotation><annotation encoding="application/x-llamapun" id="S3.E1X.2.1.1.m1.1d">italic_Q italic_u italic_a italic_n italic_t</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:\bm{x}^{\mathbb{Z}}=\text{clip}\left(\left\lfloor\frac{\bm{x}}{s%
}\right\rceil+z,0,2^{b}-1\right)," class="ltx_math_unparsed" display="inline" id="S3.E1X.3.2.2.m1.1"><semantics id="S3.E1X.3.2.2.m1.1a"><mrow id="S3.E1X.3.2.2.m1.1b"><mo id="S3.E1X.3.2.2.m1.1.1" rspace="0.278em">:</mo><msup id="S3.E1X.3.2.2.m1.1.2"><mi id="S3.E1X.3.2.2.m1.1.2.2">𝒙</mi><mi id="S3.E1X.3.2.2.m1.1.2.3">ℤ</mi></msup><mo id="S3.E1X.3.2.2.m1.1.3">=</mo><mtext id="S3.E1X.3.2.2.m1.1.4">clip</mtext><mrow id="S3.E1X.3.2.2.m1.1.5"><mo id="S3.E1X.3.2.2.m1.1.5.1">(</mo><mrow id="S3.E1X.3.2.2.m1.1.5.2"><mo id="S3.E1X.3.2.2.m1.1.5.2.1">⌊</mo><mstyle displaystyle="true" id="S3.E1X.3.2.2.m1.1.5.2.2"><mfrac id="S3.E1X.3.2.2.m1.1.5.2.2a"><mi id="S3.E1X.3.2.2.m1.1.5.2.2.2">𝒙</mi><mi id="S3.E1X.3.2.2.m1.1.5.2.2.3">s</mi></mfrac></mstyle><mo id="S3.E1X.3.2.2.m1.1.5.2.3">⌉</mo></mrow><mo id="S3.E1X.3.2.2.m1.1.5.3">+</mo><mi id="S3.E1X.3.2.2.m1.1.5.4">z</mi><mo id="S3.E1X.3.2.2.m1.1.5.5">,</mo><mn id="S3.E1X.3.2.2.m1.1.5.6">0</mn><mo id="S3.E1X.3.2.2.m1.1.5.7">,</mo><msup id="S3.E1X.3.2.2.m1.1.5.8"><mn id="S3.E1X.3.2.2.m1.1.5.8.2">2</mn><mi id="S3.E1X.3.2.2.m1.1.5.8.3">b</mi></msup><mo id="S3.E1X.3.2.2.m1.1.5.9">−</mo><mn id="S3.E1X.3.2.2.m1.1.5.10">1</mn><mo id="S3.E1X.3.2.2.m1.1.5.11">)</mo></mrow><mo id="S3.E1X.3.2.2.m1.1.6">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E1X.3.2.2.m1.1c">\displaystyle:\bm{x}^{\mathbb{Z}}=\text{clip}\left(\left\lfloor\frac{\bm{x}}{s%
}\right\rceil+z,0,2^{b}-1\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E1X.3.2.2.m1.1d">: bold_italic_x start_POSTSUPERSCRIPT blackboard_Z end_POSTSUPERSCRIPT = clip ( ⌊ divide start_ARG bold_italic_x end_ARG start_ARG italic_s end_ARG ⌉ + italic_z , 0 , 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT - 1 ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E1Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle DeQuant" class="ltx_Math" display="inline" id="S3.E1Xa.2.1.1.m1.1"><semantics id="S3.E1Xa.2.1.1.m1.1a"><mrow id="S3.E1Xa.2.1.1.m1.1.1" xref="S3.E1Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E1Xa.2.1.1.m1.1.1.2" xref="S3.E1Xa.2.1.1.m1.1.1.2.cmml">D</mi><mo id="S3.E1Xa.2.1.1.m1.1.1.1" xref="S3.E1Xa.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.E1Xa.2.1.1.m1.1.1.3" xref="S3.E1Xa.2.1.1.m1.1.1.3.cmml">e</mi><mo id="S3.E1Xa.2.1.1.m1.1.1.1a" xref="S3.E1Xa.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.E1Xa.2.1.1.m1.1.1.4" xref="S3.E1Xa.2.1.1.m1.1.1.4.cmml">Q</mi><mo id="S3.E1Xa.2.1.1.m1.1.1.1b" xref="S3.E1Xa.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.E1Xa.2.1.1.m1.1.1.5" xref="S3.E1Xa.2.1.1.m1.1.1.5.cmml">u</mi><mo id="S3.E1Xa.2.1.1.m1.1.1.1c" xref="S3.E1Xa.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.E1Xa.2.1.1.m1.1.1.6" xref="S3.E1Xa.2.1.1.m1.1.1.6.cmml">a</mi><mo id="S3.E1Xa.2.1.1.m1.1.1.1d" xref="S3.E1Xa.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.E1Xa.2.1.1.m1.1.1.7" xref="S3.E1Xa.2.1.1.m1.1.1.7.cmml">n</mi><mo id="S3.E1Xa.2.1.1.m1.1.1.1e" xref="S3.E1Xa.2.1.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.E1Xa.2.1.1.m1.1.1.8" xref="S3.E1Xa.2.1.1.m1.1.1.8.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.E1Xa.2.1.1.m1.1b"><apply id="S3.E1Xa.2.1.1.m1.1.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1"><times id="S3.E1Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.1"></times><ci id="S3.E1Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.2">𝐷</ci><ci id="S3.E1Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.3">𝑒</ci><ci id="S3.E1Xa.2.1.1.m1.1.1.4.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.4">𝑄</ci><ci id="S3.E1Xa.2.1.1.m1.1.1.5.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.5">𝑢</ci><ci id="S3.E1Xa.2.1.1.m1.1.1.6.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.6">𝑎</ci><ci id="S3.E1Xa.2.1.1.m1.1.1.7.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.7">𝑛</ci><ci id="S3.E1Xa.2.1.1.m1.1.1.8.cmml" xref="S3.E1Xa.2.1.1.m1.1.1.8">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xa.2.1.1.m1.1c">\displaystyle DeQuant</annotation><annotation encoding="application/x-llamapun" id="S3.E1Xa.2.1.1.m1.1d">italic_D italic_e italic_Q italic_u italic_a italic_n italic_t</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:\hat{\bm{x}}=s\left(\bm{x}^{\mathbb{Z}}-z\right)\approx\bm{x}," class="ltx_Math" display="inline" id="S3.E1Xa.3.2.2.m1.1"><semantics id="S3.E1Xa.3.2.2.m1.1a"><mrow id="S3.E1Xa.3.2.2.m1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S3.E1Xa.3.2.2.m1.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.3.cmml"></mi><mo id="S3.E1Xa.3.2.2.m1.1.1.1.1.2" lspace="0.278em" rspace="0.278em" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.2.cmml">:</mo><mrow id="S3.E1Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3.2.cmml">𝒙</mi><mo id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3.1.cmml">^</mo></mover><mo id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.4" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml">s</mi><mo id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">ℤ</mi></msup><mo id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">z</mi></mrow><mo id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.5" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.5.cmml">≈</mo><mi id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.6" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.6.cmml">𝒙</mi></mrow></mrow><mo id="S3.E1Xa.3.2.2.m1.1.1.1.2" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1Xa.3.2.2.m1.1b"><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1"><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.2">:</ci><csymbol cd="latexml" id="S3.E1Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.3">absent</csymbol><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1"><and id="S3.E1Xa.3.2.2.m1.1.1.1.1.1a.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1"></and><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1b.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1"><eq id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.4.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.4"></eq><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3"><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3.1">^</ci><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.3.2">𝒙</ci></apply><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1"><times id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.2"></times><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.3">𝑠</ci><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1"><minus id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.3">ℤ</ci></apply><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">𝑧</ci></apply></apply></apply><apply id="S3.E1Xa.3.2.2.m1.1.1.1.1.1c.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1"><approx id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.5.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.5"></approx><share href="https://arxiv.org/html/2410.01813v1#S3.E1Xa.3.2.2.m1.1.1.1.1.1.1.cmml" id="S3.E1Xa.3.2.2.m1.1.1.1.1.1d.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1"></share><ci id="S3.E1Xa.3.2.2.m1.1.1.1.1.1.6.cmml" xref="S3.E1Xa.3.2.2.m1.1.1.1.1.1.6">𝒙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1Xa.3.2.2.m1.1c">\displaystyle:\hat{\bm{x}}=s\left(\bm{x}^{\mathbb{Z}}-z\right)\approx\bm{x},</annotation><annotation encoding="application/x-llamapun" id="S3.E1Xa.3.2.2.m1.1d">: over^ start_ARG bold_italic_x end_ARG = italic_s ( bold_italic_x start_POSTSUPERSCRIPT blackboard_Z end_POSTSUPERSCRIPT - italic_z ) ≈ bold_italic_x ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.9">where <math alttext="\bm{x}\in\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝒙</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝒙</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\bm{x}\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_italic_x ∈ blackboard_R</annotation></semantics></math> and <math alttext="\bm{x}^{\mathbb{Z}}\in\mathbb{Z}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><msup id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2.2" xref="S3.SS1.p1.2.m2.1.1.2.2.cmml">𝒙</mi><mi id="S3.SS1.p1.2.m2.1.1.2.3" xref="S3.SS1.p1.2.m2.1.1.2.3.cmml">ℤ</mi></msup><mo id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">ℤ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><in id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"></in><apply id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2.2">𝒙</ci><ci id="S3.SS1.p1.2.m2.1.1.2.3.cmml" xref="S3.SS1.p1.2.m2.1.1.2.3">ℤ</ci></apply><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">ℤ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\bm{x}^{\mathbb{Z}}\in\mathbb{Z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">bold_italic_x start_POSTSUPERSCRIPT blackboard_Z end_POSTSUPERSCRIPT ∈ blackboard_Z</annotation></semantics></math> represent the floating-point and quantized values, respectively. The operator <math alttext="\left\lfloor\cdot\right\rceil" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.2.2" xref="S3.SS1.p1.3.m3.1.2.1.cmml"><mo id="S3.SS1.p1.3.m3.1.2.2.1" xref="S3.SS1.p1.3.m3.1.2.1.1.cmml">⌊</mo><mo id="S3.SS1.p1.3.m3.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p1.3.m3.1.1.cmml">⋅</mo><mo id="S3.SS1.p1.3.m3.1.2.2.2" xref="S3.SS1.p1.3.m3.1.2.1.1.cmml">⌉</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.2.2"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.1.2.1.1.cmml" xref="S3.SS1.p1.3.m3.1.2.2.1">delimited-⌊⌉</csymbol><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\left\lfloor\cdot\right\rceil</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">⌊ ⋅ ⌉</annotation></semantics></math> refers to the rounding function, and <math alttext="b\in\mathbb{N}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">b</mi><mo id="S3.SS1.p1.4.m4.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">ℕ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><in id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1"></in><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑏</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">ℕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">b\in\mathbb{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_b ∈ blackboard_N</annotation></semantics></math> is the bit-width used for quantization. The de-quantized value <math alttext="\hat{\bm{x}}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mover accent="true" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">𝒙</mi><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><ci id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1">^</ci><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\hat{\bm{x}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">over^ start_ARG bold_italic_x end_ARG</annotation></semantics></math> serves as an approximation to <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">bold_italic_x</annotation></semantics></math>.
Notably, <math alttext="s\in\mathbb{R}^{+}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">s</mi><mo id="S3.SS1.p1.7.m7.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">ℝ</mi><mo id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><in id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1"></in><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑠</ci><apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">ℝ</ci><plus id="S3.SS1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">s\in\mathbb{R}^{+}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_s ∈ blackboard_R start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> is the quantization scale, and <math alttext="z\in\mathbb{Z}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">z</mi><mo id="S3.SS1.p1.8.m8.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">ℤ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><in id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1"></in><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝑧</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">ℤ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">z\in\mathbb{Z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_z ∈ blackboard_Z</annotation></semantics></math> is the zero-point. Both of them are essential parameters for quantization and they are determined by the numerical distribution of <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">bold_italic_x</annotation></semantics></math> as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="s=\frac{\max(\bm{x})-\min(\bm{x})}{2^{b}-1},\quad z=\left\lfloor-\frac{\min(%
\bm{x})}{s}\right\rceil." class="ltx_math_unparsed" display="block" id="S3.E2.m1.7"><semantics id="S3.E2.m1.7a"><mrow id="S3.E2.m1.7b"><mi id="S3.E2.m1.7.8">s</mi><mo id="S3.E2.m1.7.9">=</mo><mfrac id="S3.E2.m1.4.4"><mrow id="S3.E2.m1.4.4.4"><mrow id="S3.E2.m1.4.4.4.6.2"><mi id="S3.E2.m1.1.1.1.1">max</mi><mo id="S3.E2.m1.4.4.4.6.2a">⁡</mo><mrow id="S3.E2.m1.4.4.4.6.2.1"><mo id="S3.E2.m1.4.4.4.6.2.1.1" stretchy="false">(</mo><mi id="S3.E2.m1.2.2.2.2">𝒙</mi><mo id="S3.E2.m1.4.4.4.6.2.1.2" stretchy="false">)</mo></mrow></mrow><mo id="S3.E2.m1.4.4.4.5">−</mo><mrow id="S3.E2.m1.4.4.4.7.2"><mi id="S3.E2.m1.3.3.3.3">min</mi><mo id="S3.E2.m1.4.4.4.7.2a">⁡</mo><mrow id="S3.E2.m1.4.4.4.7.2.1"><mo id="S3.E2.m1.4.4.4.7.2.1.1" stretchy="false">(</mo><mi id="S3.E2.m1.4.4.4.4">𝒙</mi><mo id="S3.E2.m1.4.4.4.7.2.1.2" stretchy="false">)</mo></mrow></mrow></mrow><mrow id="S3.E2.m1.4.4.6"><msup id="S3.E2.m1.4.4.6.2"><mn id="S3.E2.m1.4.4.6.2.2">2</mn><mi id="S3.E2.m1.4.4.6.2.3">b</mi></msup><mo id="S3.E2.m1.4.4.6.1">−</mo><mn id="S3.E2.m1.4.4.6.3">1</mn></mrow></mfrac><mo id="S3.E2.m1.7.10" rspace="1.167em">,</mo><mi id="S3.E2.m1.7.7">z</mi><mo id="S3.E2.m1.7.11">=</mo><mrow id="S3.E2.m1.7.12"><mo id="S3.E2.m1.7.12.1">⌊</mo><mo id="S3.E2.m1.7.12.2" lspace="0em">−</mo><mfrac id="S3.E2.m1.6.6"><mrow id="S3.E2.m1.6.6.2.4"><mi id="S3.E2.m1.5.5.1.1">min</mi><mo id="S3.E2.m1.6.6.2.4a">⁡</mo><mrow id="S3.E2.m1.6.6.2.4.1"><mo id="S3.E2.m1.6.6.2.4.1.1" stretchy="false">(</mo><mi id="S3.E2.m1.6.6.2.2">𝒙</mi><mo id="S3.E2.m1.6.6.2.4.1.2" stretchy="false">)</mo></mrow></mrow><mi id="S3.E2.m1.6.6.4">s</mi></mfrac><mo id="S3.E2.m1.7.12.3">⌉</mo></mrow><mo id="S3.E2.m1.7.13" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E2.m1.7c">s=\frac{\max(\bm{x})-\min(\bm{x})}{2^{b}-1},\quad z=\left\lfloor-\frac{\min(%
\bm{x})}{s}\right\rceil.</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.7d">italic_s = divide start_ARG roman_max ( bold_italic_x ) - roman_min ( bold_italic_x ) end_ARG start_ARG 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT - 1 end_ARG , italic_z = ⌊ - divide start_ARG roman_min ( bold_italic_x ) end_ARG start_ARG italic_s end_ARG ⌉ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.2">Formally, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E2" title="In 3.1 Preliminaries: Quantization ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">2</span></a> is referred to as the quantization calibration procedure. It is evident that accurately capturing the parameter distributions to obtain precise values for <math alttext="s" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_s</annotation></semantics></math> and <math alttext="z" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_z</annotation></semantics></math> is crucial. Traditionally, acquiring the distribution of activation values requires inputting the original training data to extract feature maps. However, this approach raises privacy and security concerns, particularly in sensitive fields like healthcare. Thus, in this paper, we are dedicated to exploring how to perform quantization calibration without accessing the original data.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span><span class="ltx_text ltx_font_italic" id="S3.SS2.1.1">Data Synthesis from Pre-trained SAM</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The quality of synthesized data from pre-trained models is measured in two ways: semantic matching and distributional matching. We design SAM-specific methods to facilitate both matching, as described in detail below.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">Semantic Matching: Pseudo-positive Label Evolution</span>
To enhance the semantic information of synthesized images, we need to predefine the labels as a guide and utilize the pre-trained model as a discriminator to optimize the images by facilitating the alignment of the model outputs with the labels. For instance, in the classification task, if the category label "dog" is preset, the image is optimized so that when it is input into the model, the output predicts "dog" with progressively higher confidence, thereby infusing the image with clear and distinct "dog" semantics. As a result, the semantics of the final synthesized images are strongly correlated with the predefined labels. However, creating labels with reasonable semantics for segmentation tasks is challenging, as it requires consideration of the mask’s size, category, and relative position.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">Therefore, instead of direct manual predefinition, we propose the pseudo-positive label evolution strategy, which continuously samples the model’s output in iterations and progressively superimposes high-confidence (i.e., pseudo-positive) predicted masks into the labels. This capitalizes on the output preferences of the pre-trained model, allowing the pseudo-labels to be fully aligned with the semantics learned by the model.
Interestingly, the concept of label evolution is also utilized in DIODE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib34" title="">34</a>]</cite> for object detection. However, in this work, the segmentation task and the zero-shot capabilities of SAM create a stark contrast, posing greater challenges for mask sampling: (i) Masks are pixel-level, with irregular shapes and connectivity; (ii) SAM’s outputs do not include category information.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.12">To address the above challenges, we measure confidence by calculating the average category score within the mask region, with the category scores obtained from an auxiliary model (e.g., TransUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib28" title="">28</a>]</cite>). Formally, the computation process is as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle M_{c^{*}}^{(t)}=\arg\max\left(\frac{1}{\left|M_{c}\right|}\sum_{%
(h,w)\in M_{c}}S_{h,w,c}\right)," class="ltx_Math" display="inline" id="S3.E3X.2.1.1.m1.9"><semantics id="S3.E3X.2.1.1.m1.9a"><mrow id="S3.E3X.2.1.1.m1.9.9.1" xref="S3.E3X.2.1.1.m1.9.9.1.1.cmml"><mrow id="S3.E3X.2.1.1.m1.9.9.1.1" xref="S3.E3X.2.1.1.m1.9.9.1.1.cmml"><msubsup id="S3.E3X.2.1.1.m1.9.9.1.1.3" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.cmml"><mi id="S3.E3X.2.1.1.m1.9.9.1.1.3.2.2" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.2.2.cmml">M</mi><msup id="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3.cmml"><mi id="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3.2" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3.2.cmml">c</mi><mo id="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3.3" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3.3.cmml">∗</mo></msup><mrow id="S3.E3X.2.1.1.m1.1.1.1.3" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.cmml"><mo id="S3.E3X.2.1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.cmml">(</mo><mi id="S3.E3X.2.1.1.m1.1.1.1.1" xref="S3.E3X.2.1.1.m1.1.1.1.1.cmml">t</mi><mo id="S3.E3X.2.1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.cmml">)</mo></mrow></msubsup><mo id="S3.E3X.2.1.1.m1.9.9.1.1.2" xref="S3.E3X.2.1.1.m1.9.9.1.1.2.cmml">=</mo><mrow id="S3.E3X.2.1.1.m1.9.9.1.1.1" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.9.9.1.1.1.2" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.2.cmml">arg</mi><mo id="S3.E3X.2.1.1.m1.9.9.1.1.1a" lspace="0.167em" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.cmml">⁡</mo><mrow id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.2.cmml"><mi id="S3.E3X.2.1.1.m1.8.8" xref="S3.E3X.2.1.1.m1.8.8.cmml">max</mi><mo id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1a" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.2.cmml"><mo id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.2.cmml">(</mo><mrow id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E3X.2.1.1.m1.2.2" xref="S3.E3X.2.1.1.m1.2.2.cmml"><mfrac id="S3.E3X.2.1.1.m1.2.2a" xref="S3.E3X.2.1.1.m1.2.2.cmml"><mn id="S3.E3X.2.1.1.m1.2.2.3" xref="S3.E3X.2.1.1.m1.2.2.3.cmml">1</mn><mrow id="S3.E3X.2.1.1.m1.2.2.1.1" xref="S3.E3X.2.1.1.m1.2.2.1.2.cmml"><mo id="S3.E3X.2.1.1.m1.2.2.1.1.2" xref="S3.E3X.2.1.1.m1.2.2.1.2.1.cmml">|</mo><msub id="S3.E3X.2.1.1.m1.2.2.1.1.1" xref="S3.E3X.2.1.1.m1.2.2.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.2.2.1.1.1.2" xref="S3.E3X.2.1.1.m1.2.2.1.1.1.2.cmml">M</mi><mi id="S3.E3X.2.1.1.m1.2.2.1.1.1.3" xref="S3.E3X.2.1.1.m1.2.2.1.1.1.3.cmml">c</mi></msub><mo id="S3.E3X.2.1.1.m1.2.2.1.1.3" xref="S3.E3X.2.1.1.m1.2.2.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.1" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.1" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.1.cmml"><munder id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.1a" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.1.cmml"><mo id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.1.2" movablelimits="false" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.1.2.cmml">∑</mo><mrow id="S3.E3X.2.1.1.m1.4.4.2" xref="S3.E3X.2.1.1.m1.4.4.2.cmml"><mrow id="S3.E3X.2.1.1.m1.4.4.2.4.2" xref="S3.E3X.2.1.1.m1.4.4.2.4.1.cmml"><mo id="S3.E3X.2.1.1.m1.4.4.2.4.2.1" stretchy="false" xref="S3.E3X.2.1.1.m1.4.4.2.4.1.cmml">(</mo><mi id="S3.E3X.2.1.1.m1.3.3.1.1" xref="S3.E3X.2.1.1.m1.3.3.1.1.cmml">h</mi><mo id="S3.E3X.2.1.1.m1.4.4.2.4.2.2" xref="S3.E3X.2.1.1.m1.4.4.2.4.1.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.4.4.2.2" xref="S3.E3X.2.1.1.m1.4.4.2.2.cmml">w</mi><mo id="S3.E3X.2.1.1.m1.4.4.2.4.2.3" stretchy="false" xref="S3.E3X.2.1.1.m1.4.4.2.4.1.cmml">)</mo></mrow><mo id="S3.E3X.2.1.1.m1.4.4.2.3" xref="S3.E3X.2.1.1.m1.4.4.2.3.cmml">∈</mo><msub id="S3.E3X.2.1.1.m1.4.4.2.5" xref="S3.E3X.2.1.1.m1.4.4.2.5.cmml"><mi id="S3.E3X.2.1.1.m1.4.4.2.5.2" xref="S3.E3X.2.1.1.m1.4.4.2.5.2.cmml">M</mi><mi id="S3.E3X.2.1.1.m1.4.4.2.5.3" xref="S3.E3X.2.1.1.m1.4.4.2.5.3.cmml">c</mi></msub></mrow></munder></mstyle><msub id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml">S</mi><mrow id="S3.E3X.2.1.1.m1.7.7.3.5" xref="S3.E3X.2.1.1.m1.7.7.3.4.cmml"><mi id="S3.E3X.2.1.1.m1.5.5.1.1" xref="S3.E3X.2.1.1.m1.5.5.1.1.cmml">h</mi><mo id="S3.E3X.2.1.1.m1.7.7.3.5.1" xref="S3.E3X.2.1.1.m1.7.7.3.4.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.6.6.2.2" xref="S3.E3X.2.1.1.m1.6.6.2.2.cmml">w</mi><mo id="S3.E3X.2.1.1.m1.7.7.3.5.2" xref="S3.E3X.2.1.1.m1.7.7.3.4.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.7.7.3.3" xref="S3.E3X.2.1.1.m1.7.7.3.3.cmml">c</mi></mrow></msub></mrow></mrow><mo id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E3X.2.1.1.m1.9.9.1.2" xref="S3.E3X.2.1.1.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.9b"><apply id="S3.E3X.2.1.1.m1.9.9.1.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.1"><eq id="S3.E3X.2.1.1.m1.9.9.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.2"></eq><apply id="S3.E3X.2.1.1.m1.9.9.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.9.9.1.1.3.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.3">superscript</csymbol><apply id="S3.E3X.2.1.1.m1.9.9.1.1.3.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.9.9.1.1.3.2.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.3">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.9.9.1.1.3.2.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.2.2">𝑀</ci><apply id="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3">superscript</csymbol><ci id="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3.2">𝑐</ci><times id="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3.3.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.3.2.3.3"></times></apply></apply><ci id="S3.E3X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1.1.1">𝑡</ci></apply><apply id="S3.E3X.2.1.1.m1.9.9.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.1"><arg id="S3.E3X.2.1.1.m1.9.9.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.2"></arg><apply id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1"><max id="S3.E3X.2.1.1.m1.8.8.cmml" xref="S3.E3X.2.1.1.m1.8.8"></max><apply id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1"><times id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.1"></times><apply id="S3.E3X.2.1.1.m1.2.2.cmml" xref="S3.E3X.2.1.1.m1.2.2"><divide id="S3.E3X.2.1.1.m1.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.2.2"></divide><cn id="S3.E3X.2.1.1.m1.2.2.3.cmml" type="integer" xref="S3.E3X.2.1.1.m1.2.2.3">1</cn><apply id="S3.E3X.2.1.1.m1.2.2.1.2.cmml" xref="S3.E3X.2.1.1.m1.2.2.1.1"><abs id="S3.E3X.2.1.1.m1.2.2.1.2.1.cmml" xref="S3.E3X.2.1.1.m1.2.2.1.1.2"></abs><apply id="S3.E3X.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.2.2.1.1.1.2">𝑀</ci><ci id="S3.E3X.2.1.1.m1.2.2.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.2.2.1.1.1.3">𝑐</ci></apply></apply></apply><apply id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2"><apply id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.1.2"></sum><apply id="S3.E3X.2.1.1.m1.4.4.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.2"><in id="S3.E3X.2.1.1.m1.4.4.2.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.2.3"></in><interval closure="open" id="S3.E3X.2.1.1.m1.4.4.2.4.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.2.4.2"><ci id="S3.E3X.2.1.1.m1.3.3.1.1.cmml" xref="S3.E3X.2.1.1.m1.3.3.1.1">ℎ</ci><ci id="S3.E3X.2.1.1.m1.4.4.2.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.2.2">𝑤</ci></interval><apply id="S3.E3X.2.1.1.m1.4.4.2.5.cmml" xref="S3.E3X.2.1.1.m1.4.4.2.5"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.4.4.2.5.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.2.5">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.4.4.2.5.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.2.5.2">𝑀</ci><ci id="S3.E3X.2.1.1.m1.4.4.2.5.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.2.5.3">𝑐</ci></apply></apply></apply><apply id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.9.9.1.1.1.1.1.1.1.2.2.2">𝑆</ci><list id="S3.E3X.2.1.1.m1.7.7.3.4.cmml" xref="S3.E3X.2.1.1.m1.7.7.3.5"><ci id="S3.E3X.2.1.1.m1.5.5.1.1.cmml" xref="S3.E3X.2.1.1.m1.5.5.1.1">ℎ</ci><ci id="S3.E3X.2.1.1.m1.6.6.2.2.cmml" xref="S3.E3X.2.1.1.m1.6.6.2.2">𝑤</ci><ci id="S3.E3X.2.1.1.m1.7.7.3.3.cmml" xref="S3.E3X.2.1.1.m1.7.7.3.3">𝑐</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.9c">\displaystyle M_{c^{*}}^{(t)}=\arg\max\left(\frac{1}{\left|M_{c}\right|}\sum_{%
(h,w)\in M_{c}}S_{h,w,c}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E3X.2.1.1.m1.9d">italic_M start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT = roman_arg roman_max ( divide start_ARG 1 end_ARG start_ARG | italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT ( italic_h , italic_w ) ∈ italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_S start_POSTSUBSCRIPT italic_h , italic_w , italic_c end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS2.p4.9">where <math alttext="M_{c}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><msub id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">M</mi><mi id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝑀</ci><ci id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">M_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the predicted mask of category <math alttext="c" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_c</annotation></semantics></math>, with region provided by SAM and category provided by the auxiliary model, and <math alttext="|M_{c}|" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><mrow id="S3.SS2.p4.3.m3.1.1.1" xref="S3.SS2.p4.3.m3.1.1.2.cmml"><mo id="S3.SS2.p4.3.m3.1.1.1.2" stretchy="false" xref="S3.SS2.p4.3.m3.1.1.2.1.cmml">|</mo><msub id="S3.SS2.p4.3.m3.1.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.1.1.2" xref="S3.SS2.p4.3.m3.1.1.1.1.2.cmml">M</mi><mi id="S3.SS2.p4.3.m3.1.1.1.1.3" xref="S3.SS2.p4.3.m3.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.SS2.p4.3.m3.1.1.1.3" stretchy="false" xref="S3.SS2.p4.3.m3.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.1"><abs id="S3.SS2.p4.3.m3.1.1.2.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1.2"></abs><apply id="S3.SS2.p4.3.m3.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.1.1.2">𝑀</ci><ci id="S3.SS2.p4.3.m3.1.1.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.1.1.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">|M_{c}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">| italic_M start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT |</annotation></semantics></math> is the number of pixels in the mask.
<math alttext="S_{h,w,c}" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.3"><semantics id="S3.SS2.p4.4.m4.3a"><msub id="S3.SS2.p4.4.m4.3.4" xref="S3.SS2.p4.4.m4.3.4.cmml"><mi id="S3.SS2.p4.4.m4.3.4.2" xref="S3.SS2.p4.4.m4.3.4.2.cmml">S</mi><mrow id="S3.SS2.p4.4.m4.3.3.3.5" xref="S3.SS2.p4.4.m4.3.3.3.4.cmml"><mi id="S3.SS2.p4.4.m4.1.1.1.1" xref="S3.SS2.p4.4.m4.1.1.1.1.cmml">h</mi><mo id="S3.SS2.p4.4.m4.3.3.3.5.1" xref="S3.SS2.p4.4.m4.3.3.3.4.cmml">,</mo><mi id="S3.SS2.p4.4.m4.2.2.2.2" xref="S3.SS2.p4.4.m4.2.2.2.2.cmml">w</mi><mo id="S3.SS2.p4.4.m4.3.3.3.5.2" xref="S3.SS2.p4.4.m4.3.3.3.4.cmml">,</mo><mi id="S3.SS2.p4.4.m4.3.3.3.3" xref="S3.SS2.p4.4.m4.3.3.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.3b"><apply id="S3.SS2.p4.4.m4.3.4.cmml" xref="S3.SS2.p4.4.m4.3.4"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.3.4.1.cmml" xref="S3.SS2.p4.4.m4.3.4">subscript</csymbol><ci id="S3.SS2.p4.4.m4.3.4.2.cmml" xref="S3.SS2.p4.4.m4.3.4.2">𝑆</ci><list id="S3.SS2.p4.4.m4.3.3.3.4.cmml" xref="S3.SS2.p4.4.m4.3.3.3.5"><ci id="S3.SS2.p4.4.m4.1.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1.1.1">ℎ</ci><ci id="S3.SS2.p4.4.m4.2.2.2.2.cmml" xref="S3.SS2.p4.4.m4.2.2.2.2">𝑤</ci><ci id="S3.SS2.p4.4.m4.3.3.3.3.cmml" xref="S3.SS2.p4.4.m4.3.3.3.3">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.3c">S_{h,w,c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.3d">italic_S start_POSTSUBSCRIPT italic_h , italic_w , italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the confidence score that the pixel (<math alttext="h" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.1"><semantics id="S3.SS2.p4.5.m5.1a"><mi id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m5.1d">italic_h</annotation></semantics></math>,<math alttext="w" class="ltx_Math" display="inline" id="S3.SS2.p4.6.m6.1"><semantics id="S3.SS2.p4.6.m6.1a"><mi id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><ci id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.6.m6.1d">italic_w</annotation></semantics></math>) belongs to the category <math alttext="c" class="ltx_Math" display="inline" id="S3.SS2.p4.7.m7.1"><semantics id="S3.SS2.p4.7.m7.1a"><mi id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><ci id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.7.m7.1d">italic_c</annotation></semantics></math>. <math alttext="M_{c^{*}}^{(t)}" class="ltx_Math" display="inline" id="S3.SS2.p4.8.m8.1"><semantics id="S3.SS2.p4.8.m8.1a"><msubsup id="S3.SS2.p4.8.m8.1.2" xref="S3.SS2.p4.8.m8.1.2.cmml"><mi id="S3.SS2.p4.8.m8.1.2.2.2" xref="S3.SS2.p4.8.m8.1.2.2.2.cmml">M</mi><msup id="S3.SS2.p4.8.m8.1.2.2.3" xref="S3.SS2.p4.8.m8.1.2.2.3.cmml"><mi id="S3.SS2.p4.8.m8.1.2.2.3.2" xref="S3.SS2.p4.8.m8.1.2.2.3.2.cmml">c</mi><mo id="S3.SS2.p4.8.m8.1.2.2.3.3" xref="S3.SS2.p4.8.m8.1.2.2.3.3.cmml">∗</mo></msup><mrow id="S3.SS2.p4.8.m8.1.1.1.3" xref="S3.SS2.p4.8.m8.1.2.cmml"><mo id="S3.SS2.p4.8.m8.1.1.1.3.1" stretchy="false" xref="S3.SS2.p4.8.m8.1.2.cmml">(</mo><mi id="S3.SS2.p4.8.m8.1.1.1.1" xref="S3.SS2.p4.8.m8.1.1.1.1.cmml">t</mi><mo id="S3.SS2.p4.8.m8.1.1.1.3.2" stretchy="false" xref="S3.SS2.p4.8.m8.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m8.1b"><apply id="S3.SS2.p4.8.m8.1.2.cmml" xref="S3.SS2.p4.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m8.1.2.1.cmml" xref="S3.SS2.p4.8.m8.1.2">superscript</csymbol><apply id="S3.SS2.p4.8.m8.1.2.2.cmml" xref="S3.SS2.p4.8.m8.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m8.1.2.2.1.cmml" xref="S3.SS2.p4.8.m8.1.2">subscript</csymbol><ci id="S3.SS2.p4.8.m8.1.2.2.2.cmml" xref="S3.SS2.p4.8.m8.1.2.2.2">𝑀</ci><apply id="S3.SS2.p4.8.m8.1.2.2.3.cmml" xref="S3.SS2.p4.8.m8.1.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m8.1.2.2.3.1.cmml" xref="S3.SS2.p4.8.m8.1.2.2.3">superscript</csymbol><ci id="S3.SS2.p4.8.m8.1.2.2.3.2.cmml" xref="S3.SS2.p4.8.m8.1.2.2.3.2">𝑐</ci><times id="S3.SS2.p4.8.m8.1.2.2.3.3.cmml" xref="S3.SS2.p4.8.m8.1.2.2.3.3"></times></apply></apply><ci id="S3.SS2.p4.8.m8.1.1.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m8.1c">M_{c^{*}}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.8.m8.1d">italic_M start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the pseudo-positive response obtained at the <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p4.9.m9.1"><semantics id="S3.SS2.p4.9.m9.1a"><mi id="S3.SS2.p4.9.m9.1.1" xref="S3.SS2.p4.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.9.m9.1b"><ci id="S3.SS2.p4.9.m9.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.9.m9.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.9.m9.1d">italic_t</annotation></semantics></math>-th iteration.
To ensure the saliency of sampling, we continuously filter them in real time according to confidence scores and connected component sizes during the iteration process. Eventually, we stack the filtered masks and obtain the pseudo-labels as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{M}^{GT}=\{M_{c^{*}}^{(t)}\mid\max_{(h,w)\in M_{c^{*}}^{(t)}}(S_{h,w,c%
^{*}})&gt;\varepsilon_{1},|M_{c^{*}}^{(t)}|&gt;\varepsilon_{2}\}," class="ltx_Math" display="block" id="S3.E4.m1.9"><semantics id="S3.E4.m1.9a"><mrow id="S3.E4.m1.9.9.1" xref="S3.E4.m1.9.9.1.1.cmml"><mrow id="S3.E4.m1.9.9.1.1" xref="S3.E4.m1.9.9.1.1.cmml"><msup id="S3.E4.m1.9.9.1.1.4" xref="S3.E4.m1.9.9.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.9.9.1.1.4.2" xref="S3.E4.m1.9.9.1.1.4.2.cmml">ℳ</mi><mrow id="S3.E4.m1.9.9.1.1.4.3" xref="S3.E4.m1.9.9.1.1.4.3.cmml"><mi id="S3.E4.m1.9.9.1.1.4.3.2" xref="S3.E4.m1.9.9.1.1.4.3.2.cmml">G</mi><mo id="S3.E4.m1.9.9.1.1.4.3.1" xref="S3.E4.m1.9.9.1.1.4.3.1.cmml">⁢</mo><mi id="S3.E4.m1.9.9.1.1.4.3.3" xref="S3.E4.m1.9.9.1.1.4.3.3.cmml">T</mi></mrow></msup><mo id="S3.E4.m1.9.9.1.1.3" xref="S3.E4.m1.9.9.1.1.3.cmml">=</mo><mrow id="S3.E4.m1.9.9.1.1.2.2" xref="S3.E4.m1.9.9.1.1.2.3.cmml"><mo id="S3.E4.m1.9.9.1.1.2.2.3" stretchy="false" xref="S3.E4.m1.9.9.1.1.2.3.1.cmml">{</mo><msubsup id="S3.E4.m1.9.9.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.1.1.1.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.1.2.2" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2.cmml">M</mi><msup id="S3.E4.m1.9.9.1.1.1.1.1.2.3" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.9.9.1.1.1.1.1.2.3.2" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.2.cmml">c</mi><mo id="S3.E4.m1.9.9.1.1.1.1.1.2.3.3" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.cmml">∗</mo></msup><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.9.9.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.9.9.1.1.1.1.1.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">t</mi><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.9.9.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo fence="true" id="S3.E4.m1.9.9.1.1.2.2.4" lspace="0em" rspace="0.167em" xref="S3.E4.m1.9.9.1.1.2.3.1.cmml">∣</mo><mrow id="S3.E4.m1.9.9.1.1.2.2.2.2" xref="S3.E4.m1.9.9.1.1.2.2.2.3.cmml"><mrow id="S3.E4.m1.9.9.1.1.2.2.2.1.1" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.cmml"><mrow id="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.3.cmml"><munder id="S3.E4.m1.9.9.1.1.2.2.2.1.1.1.1.1" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E4.m1.9.9.1.1.2.2.2.1.1.1.1.1.2" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.1.1.1.2.cmml">max</mi><mrow id="S3.E4.m1.4.4.3" xref="S3.E4.m1.4.4.3.cmml"><mrow id="S3.E4.m1.4.4.3.5.2" xref="S3.E4.m1.4.4.3.5.1.cmml"><mo id="S3.E4.m1.4.4.3.5.2.1" stretchy="false" xref="S3.E4.m1.4.4.3.5.1.cmml">(</mo><mi id="S3.E4.m1.3.3.2.2" xref="S3.E4.m1.3.3.2.2.cmml">h</mi><mo id="S3.E4.m1.4.4.3.5.2.2" xref="S3.E4.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.E4.m1.4.4.3.3" xref="S3.E4.m1.4.4.3.3.cmml">w</mi><mo id="S3.E4.m1.4.4.3.5.2.3" stretchy="false" xref="S3.E4.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S3.E4.m1.4.4.3.4" xref="S3.E4.m1.4.4.3.4.cmml">∈</mo><msubsup id="S3.E4.m1.4.4.3.6" xref="S3.E4.m1.4.4.3.6.cmml"><mi id="S3.E4.m1.4.4.3.6.2.2" xref="S3.E4.m1.4.4.3.6.2.2.cmml">M</mi><msup id="S3.E4.m1.4.4.3.6.2.3" xref="S3.E4.m1.4.4.3.6.2.3.cmml"><mi id="S3.E4.m1.4.4.3.6.2.3.2" xref="S3.E4.m1.4.4.3.6.2.3.2.cmml">c</mi><mo id="S3.E4.m1.4.4.3.6.2.3.3" xref="S3.E4.m1.4.4.3.6.2.3.3.cmml">∗</mo></msup><mrow id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.4.4.3.6.cmml"><mo id="S3.E4.m1.2.2.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.4.4.3.6.cmml">(</mo><mi id="S3.E4.m1.2.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml">t</mi><mo id="S3.E4.m1.2.2.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.4.4.3.6.cmml">)</mo></mrow></msubsup></mrow></munder><mo id="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2a" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.3.cmml">⁡</mo><mrow id="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.3.cmml"><mo id="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2.2" stretchy="false" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.3.cmml">(</mo><msub id="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2.1" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2.1.cmml"><mi id="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2.1.2" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2.1.2.cmml">S</mi><mrow id="S3.E4.m1.7.7.3.3" xref="S3.E4.m1.7.7.3.4.cmml"><mi id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml">h</mi><mo id="S3.E4.m1.7.7.3.3.2" xref="S3.E4.m1.7.7.3.4.cmml">,</mo><mi id="S3.E4.m1.6.6.2.2" xref="S3.E4.m1.6.6.2.2.cmml">w</mi><mo id="S3.E4.m1.7.7.3.3.3" xref="S3.E4.m1.7.7.3.4.cmml">,</mo><msup id="S3.E4.m1.7.7.3.3.1" xref="S3.E4.m1.7.7.3.3.1.cmml"><mi id="S3.E4.m1.7.7.3.3.1.2" xref="S3.E4.m1.7.7.3.3.1.2.cmml">c</mi><mo id="S3.E4.m1.7.7.3.3.1.3" xref="S3.E4.m1.7.7.3.3.1.3.cmml">∗</mo></msup></mrow></msub><mo id="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2.3" stretchy="false" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.9.9.1.1.2.2.2.1.1.3" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.3.cmml">&gt;</mo><msub id="S3.E4.m1.9.9.1.1.2.2.2.1.1.4" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.4.cmml"><mi id="S3.E4.m1.9.9.1.1.2.2.2.1.1.4.2" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.4.2.cmml">ε</mi><mn id="S3.E4.m1.9.9.1.1.2.2.2.1.1.4.3" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.4.3.cmml">1</mn></msub></mrow><mo id="S3.E4.m1.9.9.1.1.2.2.2.2.3" xref="S3.E4.m1.9.9.1.1.2.2.2.3a.cmml">,</mo><mrow id="S3.E4.m1.9.9.1.1.2.2.2.2.2" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.cmml"><mrow id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.2.cmml"><mo id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.2" stretchy="false" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.2.1.cmml">|</mo><msubsup id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.2" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.2.cmml">M</mi><msup id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3.cmml"><mi id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3.2" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3.2.cmml">c</mi><mo id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3.3" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3.3.cmml">∗</mo></msup><mrow id="S3.E4.m1.8.8.1.3" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.cmml"><mo id="S3.E4.m1.8.8.1.3.1" stretchy="false" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.cmml">(</mo><mi id="S3.E4.m1.8.8.1.1" xref="S3.E4.m1.8.8.1.1.cmml">t</mi><mo id="S3.E4.m1.8.8.1.3.2" stretchy="false" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.3" stretchy="false" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.2.1.cmml">|</mo></mrow><mo id="S3.E4.m1.9.9.1.1.2.2.2.2.2.2" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.2.cmml">&gt;</mo><msub id="S3.E4.m1.9.9.1.1.2.2.2.2.2.3" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.9.9.1.1.2.2.2.2.2.3.2" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.3.2.cmml">ε</mi><mn id="S3.E4.m1.9.9.1.1.2.2.2.2.2.3.3" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.3.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.E4.m1.9.9.1.1.2.2.5" stretchy="false" xref="S3.E4.m1.9.9.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo id="S3.E4.m1.9.9.1.2" xref="S3.E4.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.9b"><apply id="S3.E4.m1.9.9.1.1.cmml" xref="S3.E4.m1.9.9.1"><eq id="S3.E4.m1.9.9.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.3"></eq><apply id="S3.E4.m1.9.9.1.1.4.cmml" xref="S3.E4.m1.9.9.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.4.1.cmml" xref="S3.E4.m1.9.9.1.1.4">superscript</csymbol><ci id="S3.E4.m1.9.9.1.1.4.2.cmml" xref="S3.E4.m1.9.9.1.1.4.2">ℳ</ci><apply id="S3.E4.m1.9.9.1.1.4.3.cmml" xref="S3.E4.m1.9.9.1.1.4.3"><times id="S3.E4.m1.9.9.1.1.4.3.1.cmml" xref="S3.E4.m1.9.9.1.1.4.3.1"></times><ci id="S3.E4.m1.9.9.1.1.4.3.2.cmml" xref="S3.E4.m1.9.9.1.1.4.3.2">𝐺</ci><ci id="S3.E4.m1.9.9.1.1.4.3.3.cmml" xref="S3.E4.m1.9.9.1.1.4.3.3">𝑇</ci></apply></apply><apply id="S3.E4.m1.9.9.1.1.2.3.cmml" xref="S3.E4.m1.9.9.1.1.2.2"><csymbol cd="latexml" id="S3.E4.m1.9.9.1.1.2.3.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.3">conditional-set</csymbol><apply id="S3.E4.m1.9.9.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.9.9.1.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.2">𝑀</ci><apply id="S3.E4.m1.9.9.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E4.m1.9.9.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.2">𝑐</ci><times id="S3.E4.m1.9.9.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.9.9.1.1.1.1.1.2.3.3"></times></apply></apply><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑡</ci></apply><apply id="S3.E4.m1.9.9.1.1.2.2.2.3.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.2.2.2.3a.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.9.9.1.1.2.2.2.1.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1"><gt id="S3.E4.m1.9.9.1.1.2.2.2.1.1.3.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.3"></gt><apply id="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.3.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2"><apply id="S3.E4.m1.9.9.1.1.2.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.1.1.1">subscript</csymbol><max id="S3.E4.m1.9.9.1.1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.1.1.1.2"></max><apply id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3"><in id="S3.E4.m1.4.4.3.4.cmml" xref="S3.E4.m1.4.4.3.4"></in><interval closure="open" id="S3.E4.m1.4.4.3.5.1.cmml" xref="S3.E4.m1.4.4.3.5.2"><ci id="S3.E4.m1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.2.2">ℎ</ci><ci id="S3.E4.m1.4.4.3.3.cmml" xref="S3.E4.m1.4.4.3.3">𝑤</ci></interval><apply id="S3.E4.m1.4.4.3.6.cmml" xref="S3.E4.m1.4.4.3.6"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.6.1.cmml" xref="S3.E4.m1.4.4.3.6">superscript</csymbol><apply id="S3.E4.m1.4.4.3.6.2.cmml" xref="S3.E4.m1.4.4.3.6"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.6.2.1.cmml" xref="S3.E4.m1.4.4.3.6">subscript</csymbol><ci id="S3.E4.m1.4.4.3.6.2.2.cmml" xref="S3.E4.m1.4.4.3.6.2.2">𝑀</ci><apply id="S3.E4.m1.4.4.3.6.2.3.cmml" xref="S3.E4.m1.4.4.3.6.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.6.2.3.1.cmml" xref="S3.E4.m1.4.4.3.6.2.3">superscript</csymbol><ci id="S3.E4.m1.4.4.3.6.2.3.2.cmml" xref="S3.E4.m1.4.4.3.6.2.3.2">𝑐</ci><times id="S3.E4.m1.4.4.3.6.2.3.3.cmml" xref="S3.E4.m1.4.4.3.6.2.3.3"></times></apply></apply><ci id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1">𝑡</ci></apply></apply></apply><apply id="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2.1.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2.1">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2.1.2.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.2.2.2.1.2">𝑆</ci><list id="S3.E4.m1.7.7.3.4.cmml" xref="S3.E4.m1.7.7.3.3"><ci id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1.1">ℎ</ci><ci id="S3.E4.m1.6.6.2.2.cmml" xref="S3.E4.m1.6.6.2.2">𝑤</ci><apply id="S3.E4.m1.7.7.3.3.1.cmml" xref="S3.E4.m1.7.7.3.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.3.3.1.1.cmml" xref="S3.E4.m1.7.7.3.3.1">superscript</csymbol><ci id="S3.E4.m1.7.7.3.3.1.2.cmml" xref="S3.E4.m1.7.7.3.3.1.2">𝑐</ci><times id="S3.E4.m1.7.7.3.3.1.3.cmml" xref="S3.E4.m1.7.7.3.3.1.3"></times></apply></list></apply></apply><apply id="S3.E4.m1.9.9.1.1.2.2.2.1.1.4.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.2.2.2.1.1.4.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.4">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.2.2.2.1.1.4.2.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.4.2">𝜀</ci><cn id="S3.E4.m1.9.9.1.1.2.2.2.1.1.4.3.cmml" type="integer" xref="S3.E4.m1.9.9.1.1.2.2.2.1.1.4.3">1</cn></apply></apply><apply id="S3.E4.m1.9.9.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2"><gt id="S3.E4.m1.9.9.1.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.2"></gt><apply id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.2.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1"><abs id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.2.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.2"></abs><apply id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1">superscript</csymbol><apply id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.2">𝑀</ci><apply id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3">superscript</csymbol><ci id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3.2.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3.2">𝑐</ci><times id="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3.3.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.1.1.1.2.3.3"></times></apply></apply><ci id="S3.E4.m1.8.8.1.1.cmml" xref="S3.E4.m1.8.8.1.1">𝑡</ci></apply></apply><apply id="S3.E4.m1.9.9.1.1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E4.m1.9.9.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.3.2">𝜀</ci><cn id="S3.E4.m1.9.9.1.1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E4.m1.9.9.1.1.2.2.2.2.2.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.9c">\mathcal{M}^{GT}=\{M_{c^{*}}^{(t)}\mid\max_{(h,w)\in M_{c^{*}}^{(t)}}(S_{h,w,c%
^{*}})&gt;\varepsilon_{1},|M_{c^{*}}^{(t)}|&gt;\varepsilon_{2}\},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.9d">caligraphic_M start_POSTSUPERSCRIPT italic_G italic_T end_POSTSUPERSCRIPT = { italic_M start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT ∣ roman_max start_POSTSUBSCRIPT ( italic_h , italic_w ) ∈ italic_M start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ( italic_S start_POSTSUBSCRIPT italic_h , italic_w , italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) &gt; italic_ε start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , | italic_M start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT | &gt; italic_ε start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p4.11">where <math alttext="\varepsilon_{1}" class="ltx_Math" display="inline" id="S3.SS2.p4.10.m1.1"><semantics id="S3.SS2.p4.10.m1.1a"><msub id="S3.SS2.p4.10.m1.1.1" xref="S3.SS2.p4.10.m1.1.1.cmml"><mi id="S3.SS2.p4.10.m1.1.1.2" xref="S3.SS2.p4.10.m1.1.1.2.cmml">ε</mi><mn id="S3.SS2.p4.10.m1.1.1.3" xref="S3.SS2.p4.10.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.10.m1.1b"><apply id="S3.SS2.p4.10.m1.1.1.cmml" xref="S3.SS2.p4.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.10.m1.1.1.1.cmml" xref="S3.SS2.p4.10.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.10.m1.1.1.2.cmml" xref="S3.SS2.p4.10.m1.1.1.2">𝜀</ci><cn id="S3.SS2.p4.10.m1.1.1.3.cmml" type="integer" xref="S3.SS2.p4.10.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.10.m1.1c">\varepsilon_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.10.m1.1d">italic_ε start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\varepsilon_{2}" class="ltx_Math" display="inline" id="S3.SS2.p4.11.m2.1"><semantics id="S3.SS2.p4.11.m2.1a"><msub id="S3.SS2.p4.11.m2.1.1" xref="S3.SS2.p4.11.m2.1.1.cmml"><mi id="S3.SS2.p4.11.m2.1.1.2" xref="S3.SS2.p4.11.m2.1.1.2.cmml">ε</mi><mn id="S3.SS2.p4.11.m2.1.1.3" xref="S3.SS2.p4.11.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.11.m2.1b"><apply id="S3.SS2.p4.11.m2.1.1.cmml" xref="S3.SS2.p4.11.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.11.m2.1.1.1.cmml" xref="S3.SS2.p4.11.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.11.m2.1.1.2.cmml" xref="S3.SS2.p4.11.m2.1.1.2">𝜀</ci><cn id="S3.SS2.p4.11.m2.1.1.3.cmml" type="integer" xref="S3.SS2.p4.11.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.11.m2.1c">\varepsilon_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.11.m2.1d">italic_ε start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are the filter thresholds for confidence and size of the mask, respectively. Given the pseudo-labels, we define <em class="ltx_emph ltx_font_italic" id="S3.SS2.p4.11.1">Semantic Matching Loss</em> to enhance the semantic content of synthesized images as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{SM}=\mathcal{L}_{Mask}+\alpha\cdot\mathcal{L}_{Class}," class="ltx_Math" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E5.m1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.2.3.2" xref="S3.E5.m1.1.1.1.1.2.3.2.cmml">S</mi><mo id="S3.E5.m1.1.1.1.1.2.3.1" xref="S3.E5.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.2.3.3" xref="S3.E5.m1.1.1.1.1.2.3.3.cmml">M</mi></mrow></msub><mo id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><msub id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E5.m1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.3.2" xref="S3.E5.m1.1.1.1.1.3.2.3.2.cmml">M</mi><mo id="S3.E5.m1.1.1.1.1.3.2.3.1" xref="S3.E5.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.1.1.3.2.3.3.cmml">a</mi><mo id="S3.E5.m1.1.1.1.1.3.2.3.1a" xref="S3.E5.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.3.2.3.4" xref="S3.E5.m1.1.1.1.1.3.2.3.4.cmml">s</mi><mo id="S3.E5.m1.1.1.1.1.3.2.3.1b" xref="S3.E5.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.3.2.3.5" xref="S3.E5.m1.1.1.1.1.3.2.3.5.cmml">k</mi></mrow></msub><mo id="S3.E5.m1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.2.cmml">α</mi><mo id="S3.E5.m1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E5.m1.1.1.1.1.3.3.1.cmml">⋅</mo><msub id="S3.E5.m1.1.1.1.1.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.3.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S3.E5.m1.1.1.1.1.3.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.3.3.2.cmml">C</mi><mo id="S3.E5.m1.1.1.1.1.3.3.3.3.1" xref="S3.E5.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.3.3.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.3.3.cmml">l</mi><mo id="S3.E5.m1.1.1.1.1.3.3.3.3.1a" xref="S3.E5.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.3.3.3.3.4" xref="S3.E5.m1.1.1.1.1.3.3.3.3.4.cmml">a</mi><mo id="S3.E5.m1.1.1.1.1.3.3.3.3.1b" xref="S3.E5.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.3.3.3.3.5" xref="S3.E5.m1.1.1.1.1.3.3.3.3.5.cmml">s</mi><mo id="S3.E5.m1.1.1.1.1.3.3.3.3.1c" xref="S3.E5.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.3.3.3.3.6" xref="S3.E5.m1.1.1.1.1.3.3.3.3.6.cmml">s</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"></eq><apply id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2">ℒ</ci><apply id="S3.E5.m1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.3"><times id="S3.E5.m1.1.1.1.1.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.2.3.1"></times><ci id="S3.E5.m1.1.1.1.1.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.2.3.2">𝑆</ci><ci id="S3.E5.m1.1.1.1.1.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.2.3.3">𝑀</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><plus id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.1"></plus><apply id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S3.E5.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3"><times id="S3.E5.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E5.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.2">𝑀</ci><ci id="S3.E5.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.3">𝑎</ci><ci id="S3.E5.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.4">𝑠</ci><ci id="S3.E5.m1.1.1.1.1.3.2.3.5.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.5">𝑘</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3"><ci id="S3.E5.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.1">⋅</ci><ci id="S3.E5.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2">𝛼</ci><apply id="S3.E5.m1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="S3.E5.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3"><times id="S3.E5.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E5.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3.2">𝐶</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3.3">𝑙</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3.3.4.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3.4">𝑎</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3.3.5.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3.5">𝑠</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3.3.6.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3.3.6">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathcal{L}_{SM}=\mathcal{L}_{Mask}+\alpha\cdot\mathcal{L}_{Class},</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_S italic_M end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_M italic_a italic_s italic_k end_POSTSUBSCRIPT + italic_α ⋅ caligraphic_L start_POSTSUBSCRIPT italic_C italic_l italic_a italic_s italic_s end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E6">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E6X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{where}\quad\mathcal{L}_{Mask}" class="ltx_Math" display="inline" id="S3.E6X.2.1.1.m1.2"><semantics id="S3.E6X.2.1.1.m1.2a"><mrow id="S3.E6X.2.1.1.m1.2.2.1" xref="S3.E6X.2.1.1.m1.2.2.2.cmml"><mtext id="S3.E6X.2.1.1.m1.1.1" xref="S3.E6X.2.1.1.m1.1.1a.cmml">where</mtext><mspace id="S3.E6X.2.1.1.m1.2.2.1.2" width="1em" xref="S3.E6X.2.1.1.m1.2.2.2.cmml"></mspace><msub id="S3.E6X.2.1.1.m1.2.2.1.1" xref="S3.E6X.2.1.1.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6X.2.1.1.m1.2.2.1.1.2" xref="S3.E6X.2.1.1.m1.2.2.1.1.2.cmml">ℒ</mi><mrow id="S3.E6X.2.1.1.m1.2.2.1.1.3" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.cmml"><mi id="S3.E6X.2.1.1.m1.2.2.1.1.3.2" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.2.cmml">M</mi><mo id="S3.E6X.2.1.1.m1.2.2.1.1.3.1" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.1.cmml">⁢</mo><mi id="S3.E6X.2.1.1.m1.2.2.1.1.3.3" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.3.cmml">a</mi><mo id="S3.E6X.2.1.1.m1.2.2.1.1.3.1a" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.1.cmml">⁢</mo><mi id="S3.E6X.2.1.1.m1.2.2.1.1.3.4" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.4.cmml">s</mi><mo id="S3.E6X.2.1.1.m1.2.2.1.1.3.1b" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.1.cmml">⁢</mo><mi id="S3.E6X.2.1.1.m1.2.2.1.1.3.5" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.5.cmml">k</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.E6X.2.1.1.m1.2b"><list id="S3.E6X.2.1.1.m1.2.2.2.cmml" xref="S3.E6X.2.1.1.m1.2.2.1"><ci id="S3.E6X.2.1.1.m1.1.1a.cmml" xref="S3.E6X.2.1.1.m1.1.1"><mtext id="S3.E6X.2.1.1.m1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1">where</mtext></ci><apply id="S3.E6X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E6X.2.1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E6X.2.1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.E6X.2.1.1.m1.2.2.1.1.2.cmml" xref="S3.E6X.2.1.1.m1.2.2.1.1.2">ℒ</ci><apply id="S3.E6X.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E6X.2.1.1.m1.2.2.1.1.3"><times id="S3.E6X.2.1.1.m1.2.2.1.1.3.1.cmml" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.1"></times><ci id="S3.E6X.2.1.1.m1.2.2.1.1.3.2.cmml" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.2">𝑀</ci><ci id="S3.E6X.2.1.1.m1.2.2.1.1.3.3.cmml" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.3">𝑎</ci><ci id="S3.E6X.2.1.1.m1.2.2.1.1.3.4.cmml" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.4">𝑠</ci><ci id="S3.E6X.2.1.1.m1.2.2.1.1.3.5.cmml" xref="S3.E6X.2.1.1.m1.2.2.1.1.3.5">𝑘</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.E6X.2.1.1.m1.2c">\displaystyle\text{where}\quad\mathcal{L}_{Mask}</annotation><annotation encoding="application/x-llamapun" id="S3.E6X.2.1.1.m1.2d">where caligraphic_L start_POSTSUBSCRIPT italic_M italic_a italic_s italic_k end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=1-\frac{|\mathcal{M}^{Pred}\cap\mathcal{M}^{GT}|}{|\mathcal{M}^{%
Pred}\cup\mathcal{M}^{GT}|}," class="ltx_Math" display="inline" id="S3.E6X.3.2.2.m1.3"><semantics id="S3.E6X.3.2.2.m1.3a"><mrow id="S3.E6X.3.2.2.m1.3.3.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.cmml"><mrow id="S3.E6X.3.2.2.m1.3.3.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.cmml"><mi id="S3.E6X.3.2.2.m1.3.3.1.1.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.2.cmml"></mi><mo id="S3.E6X.3.2.2.m1.3.3.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E6X.3.2.2.m1.3.3.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.3.cmml"><mn id="S3.E6X.3.2.2.m1.3.3.1.1.3.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.3.2.cmml">1</mn><mo id="S3.E6X.3.2.2.m1.3.3.1.1.3.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.3.1.cmml">−</mo><mstyle displaystyle="true" id="S3.E6X.3.2.2.m1.2.2" xref="S3.E6X.3.2.2.m1.2.2.cmml"><mfrac id="S3.E6X.3.2.2.m1.2.2a" xref="S3.E6X.3.2.2.m1.2.2.cmml"><mrow id="S3.E6X.3.2.2.m1.1.1.1.1" xref="S3.E6X.3.2.2.m1.1.1.1.2.cmml"><mo id="S3.E6X.3.2.2.m1.1.1.1.1.2" stretchy="false" xref="S3.E6X.3.2.2.m1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E6X.3.2.2.m1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.cmml"><msup id="S3.E6X.3.2.2.m1.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.2" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.2.cmml">ℳ</mi><mrow id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.2" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.2.cmml">P</mi><mo id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.1" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.3" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.3.cmml">r</mi><mo id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.1a" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.4" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.4.cmml">e</mi><mo id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.1b" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.5" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.5.cmml">d</mi></mrow></msup><mo id="S3.E6X.3.2.2.m1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.1.cmml">∩</mo><msup id="S3.E6X.3.2.2.m1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6X.3.2.2.m1.1.1.1.1.1.3.2" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3.2.cmml">ℳ</mi><mrow id="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.2" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.2.cmml">G</mi><mo id="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.1" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.3" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.3.cmml">T</mi></mrow></msup></mrow><mo id="S3.E6X.3.2.2.m1.1.1.1.1.3" stretchy="false" xref="S3.E6X.3.2.2.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E6X.3.2.2.m1.2.2.2.1" xref="S3.E6X.3.2.2.m1.2.2.2.2.cmml"><mo id="S3.E6X.3.2.2.m1.2.2.2.1.2" stretchy="false" xref="S3.E6X.3.2.2.m1.2.2.2.2.1.cmml">|</mo><mrow id="S3.E6X.3.2.2.m1.2.2.2.1.1" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.cmml"><msup id="S3.E6X.3.2.2.m1.2.2.2.1.1.2" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.2" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.2.cmml">ℳ</mi><mrow id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.cmml"><mi id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.2" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.2.cmml">P</mi><mo id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.1" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.3" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.3.cmml">r</mi><mo id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.1a" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.4" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.4.cmml">e</mi><mo id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.1b" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.5" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.5.cmml">d</mi></mrow></msup><mo id="S3.E6X.3.2.2.m1.2.2.2.1.1.1" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.1.cmml">∪</mo><msup id="S3.E6X.3.2.2.m1.2.2.2.1.1.3" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6X.3.2.2.m1.2.2.2.1.1.3.2" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3.2.cmml">ℳ</mi><mrow id="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.cmml"><mi id="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.2" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.2.cmml">G</mi><mo id="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.1" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.3" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.3.cmml">T</mi></mrow></msup></mrow><mo id="S3.E6X.3.2.2.m1.2.2.2.1.3" stretchy="false" xref="S3.E6X.3.2.2.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mstyle></mrow></mrow><mo id="S3.E6X.3.2.2.m1.3.3.1.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6X.3.2.2.m1.3b"><apply id="S3.E6X.3.2.2.m1.3.3.1.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1"><eq id="S3.E6X.3.2.2.m1.3.3.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1"></eq><csymbol cd="latexml" id="S3.E6X.3.2.2.m1.3.3.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.2">absent</csymbol><apply id="S3.E6X.3.2.2.m1.3.3.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.3"><minus id="S3.E6X.3.2.2.m1.3.3.1.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.3.1"></minus><cn id="S3.E6X.3.2.2.m1.3.3.1.1.3.2.cmml" type="integer" xref="S3.E6X.3.2.2.m1.3.3.1.1.3.2">1</cn><apply id="S3.E6X.3.2.2.m1.2.2.cmml" xref="S3.E6X.3.2.2.m1.2.2"><divide id="S3.E6X.3.2.2.m1.2.2.3.cmml" xref="S3.E6X.3.2.2.m1.2.2"></divide><apply id="S3.E6X.3.2.2.m1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1"><abs id="S3.E6X.3.2.2.m1.1.1.1.2.1.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.2"></abs><apply id="S3.E6X.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1"><intersect id="S3.E6X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.1"></intersect><apply id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.1.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.2">ℳ</ci><apply id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3"><times id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.1"></times><ci id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.2">𝑃</ci><ci id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.3">𝑟</ci><ci id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.4.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.4">𝑒</ci><ci id="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.5.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.2.3.5">𝑑</ci></apply></apply><apply id="S3.E6X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.1.1.1.1.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E6X.3.2.2.m1.1.1.1.1.1.3.2.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3.2">ℳ</ci><apply id="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3"><times id="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.1"></times><ci id="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.2">𝐺</ci><ci id="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6X.3.2.2.m1.1.1.1.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply><apply id="S3.E6X.3.2.2.m1.2.2.2.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1"><abs id="S3.E6X.3.2.2.m1.2.2.2.2.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.2"></abs><apply id="S3.E6X.3.2.2.m1.2.2.2.1.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1"><union id="S3.E6X.3.2.2.m1.2.2.2.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.1"></union><apply id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2">superscript</csymbol><ci id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.2">ℳ</ci><apply id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3"><times id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.1"></times><ci id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.2">𝑃</ci><ci id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.3">𝑟</ci><ci id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.4.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.4">𝑒</ci><ci id="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.5.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.2.3.5">𝑑</ci></apply></apply><apply id="S3.E6X.3.2.2.m1.2.2.2.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.2.2.2.1.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3">superscript</csymbol><ci id="S3.E6X.3.2.2.m1.2.2.2.1.1.3.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3.2">ℳ</ci><apply id="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3"><times id="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.1"></times><ci id="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.2">𝐺</ci><ci id="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.2.1.1.3.3.3">𝑇</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6X.3.2.2.m1.3c">\displaystyle=1-\frac{|\mathcal{M}^{Pred}\cap\mathcal{M}^{GT}|}{|\mathcal{M}^{%
Pred}\cup\mathcal{M}^{GT}|},</annotation><annotation encoding="application/x-llamapun" id="S3.E6X.3.2.2.m1.3d">= 1 - divide start_ARG | caligraphic_M start_POSTSUPERSCRIPT italic_P italic_r italic_e italic_d end_POSTSUPERSCRIPT ∩ caligraphic_M start_POSTSUPERSCRIPT italic_G italic_T end_POSTSUPERSCRIPT | end_ARG start_ARG | caligraphic_M start_POSTSUPERSCRIPT italic_P italic_r italic_e italic_d end_POSTSUPERSCRIPT ∪ caligraphic_M start_POSTSUPERSCRIPT italic_G italic_T end_POSTSUPERSCRIPT | end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E6Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{Class}" class="ltx_Math" display="inline" id="S3.E6Xa.2.1.1.m1.1"><semantics id="S3.E6Xa.2.1.1.m1.1a"><msub id="S3.E6Xa.2.1.1.m1.1.1" xref="S3.E6Xa.2.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6Xa.2.1.1.m1.1.1.2" xref="S3.E6Xa.2.1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.E6Xa.2.1.1.m1.1.1.3" xref="S3.E6Xa.2.1.1.m1.1.1.3.cmml"><mi id="S3.E6Xa.2.1.1.m1.1.1.3.2" xref="S3.E6Xa.2.1.1.m1.1.1.3.2.cmml">C</mi><mo id="S3.E6Xa.2.1.1.m1.1.1.3.1" xref="S3.E6Xa.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6Xa.2.1.1.m1.1.1.3.3" xref="S3.E6Xa.2.1.1.m1.1.1.3.3.cmml">l</mi><mo id="S3.E6Xa.2.1.1.m1.1.1.3.1a" xref="S3.E6Xa.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6Xa.2.1.1.m1.1.1.3.4" xref="S3.E6Xa.2.1.1.m1.1.1.3.4.cmml">a</mi><mo id="S3.E6Xa.2.1.1.m1.1.1.3.1b" xref="S3.E6Xa.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6Xa.2.1.1.m1.1.1.3.5" xref="S3.E6Xa.2.1.1.m1.1.1.3.5.cmml">s</mi><mo id="S3.E6Xa.2.1.1.m1.1.1.3.1c" xref="S3.E6Xa.2.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6Xa.2.1.1.m1.1.1.3.6" xref="S3.E6Xa.2.1.1.m1.1.1.3.6.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E6Xa.2.1.1.m1.1b"><apply id="S3.E6Xa.2.1.1.m1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E6Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E6Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E6Xa.2.1.1.m1.1.1.2">ℒ</ci><apply id="S3.E6Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E6Xa.2.1.1.m1.1.1.3"><times id="S3.E6Xa.2.1.1.m1.1.1.3.1.cmml" xref="S3.E6Xa.2.1.1.m1.1.1.3.1"></times><ci id="S3.E6Xa.2.1.1.m1.1.1.3.2.cmml" xref="S3.E6Xa.2.1.1.m1.1.1.3.2">𝐶</ci><ci id="S3.E6Xa.2.1.1.m1.1.1.3.3.cmml" xref="S3.E6Xa.2.1.1.m1.1.1.3.3">𝑙</ci><ci id="S3.E6Xa.2.1.1.m1.1.1.3.4.cmml" xref="S3.E6Xa.2.1.1.m1.1.1.3.4">𝑎</ci><ci id="S3.E6Xa.2.1.1.m1.1.1.3.5.cmml" xref="S3.E6Xa.2.1.1.m1.1.1.3.5">𝑠</ci><ci id="S3.E6Xa.2.1.1.m1.1.1.3.6.cmml" xref="S3.E6Xa.2.1.1.m1.1.1.3.6">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6Xa.2.1.1.m1.1c">\displaystyle\mathcal{L}_{Class}</annotation><annotation encoding="application/x-llamapun" id="S3.E6Xa.2.1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_C italic_l italic_a italic_s italic_s end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\frac{1}{|\mathcal{M}^{GT}|}\sum_{M_{c^{*}}\in\mathcal{M}^{GT}}%
\sum_{(h,w)\in M_{c^{*}}}\log(S_{h,w,c^{*}})." class="ltx_Math" display="inline" id="S3.E6Xa.3.2.2.m1.8"><semantics id="S3.E6Xa.3.2.2.m1.8a"><mrow id="S3.E6Xa.3.2.2.m1.8.8.1" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.cmml"><mrow id="S3.E6Xa.3.2.2.m1.8.8.1.1" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.cmml"><mi id="S3.E6Xa.3.2.2.m1.8.8.1.1.3" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.3.cmml"></mi><mo id="S3.E6Xa.3.2.2.m1.8.8.1.1.2" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.2.cmml">=</mo><mrow id="S3.E6Xa.3.2.2.m1.8.8.1.1.1" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.cmml"><mo id="S3.E6Xa.3.2.2.m1.8.8.1.1.1a" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.cmml">−</mo><mrow id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E6Xa.3.2.2.m1.1.1" xref="S3.E6Xa.3.2.2.m1.1.1.cmml"><mfrac id="S3.E6Xa.3.2.2.m1.1.1a" xref="S3.E6Xa.3.2.2.m1.1.1.cmml"><mn id="S3.E6Xa.3.2.2.m1.1.1.3" xref="S3.E6Xa.3.2.2.m1.1.1.3.cmml">1</mn><mrow id="S3.E6Xa.3.2.2.m1.1.1.1.1" xref="S3.E6Xa.3.2.2.m1.1.1.1.2.cmml"><mo id="S3.E6Xa.3.2.2.m1.1.1.1.1.2" stretchy="false" xref="S3.E6Xa.3.2.2.m1.1.1.1.2.1.cmml">|</mo><msup id="S3.E6Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.2" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.2.cmml">ℳ</mi><mrow id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.cmml"><mi id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.2" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.2.cmml">G</mi><mo id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.1" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.3" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.3.cmml">T</mi></mrow></msup><mo id="S3.E6Xa.3.2.2.m1.1.1.1.1.3" stretchy="false" xref="S3.E6Xa.3.2.2.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.2" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.cmml"><munder id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2a" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.cmml"><mo id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2" movablelimits="false" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.cmml"><msub id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.cmml"><mi id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.2" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.2.cmml">M</mi><msup id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3.cmml"><mi id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3.2" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3.2.cmml">c</mi><mo id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3.3" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3.3.cmml">∗</mo></msup></msub><mo id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.1" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.1.cmml">∈</mo><msup id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.2" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.2.cmml">ℳ</mi><mrow id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.cmml"><mi id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.2" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.2.cmml">G</mi><mo id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.1" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.1.cmml">⁢</mo><mi id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.3" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.3.cmml">T</mi></mrow></msup></mrow></munder></mstyle><mrow id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.2" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.2.cmml"><munder id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.2a" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.2.cmml"><mo id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.2.2" movablelimits="false" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E6Xa.3.2.2.m1.3.3.2" xref="S3.E6Xa.3.2.2.m1.3.3.2.cmml"><mrow id="S3.E6Xa.3.2.2.m1.3.3.2.4.2" xref="S3.E6Xa.3.2.2.m1.3.3.2.4.1.cmml"><mo id="S3.E6Xa.3.2.2.m1.3.3.2.4.2.1" stretchy="false" xref="S3.E6Xa.3.2.2.m1.3.3.2.4.1.cmml">(</mo><mi id="S3.E6Xa.3.2.2.m1.2.2.1.1" xref="S3.E6Xa.3.2.2.m1.2.2.1.1.cmml">h</mi><mo id="S3.E6Xa.3.2.2.m1.3.3.2.4.2.2" xref="S3.E6Xa.3.2.2.m1.3.3.2.4.1.cmml">,</mo><mi id="S3.E6Xa.3.2.2.m1.3.3.2.2" xref="S3.E6Xa.3.2.2.m1.3.3.2.2.cmml">w</mi><mo id="S3.E6Xa.3.2.2.m1.3.3.2.4.2.3" stretchy="false" xref="S3.E6Xa.3.2.2.m1.3.3.2.4.1.cmml">)</mo></mrow><mo id="S3.E6Xa.3.2.2.m1.3.3.2.3" xref="S3.E6Xa.3.2.2.m1.3.3.2.3.cmml">∈</mo><msub id="S3.E6Xa.3.2.2.m1.3.3.2.5" xref="S3.E6Xa.3.2.2.m1.3.3.2.5.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.2.5.2" xref="S3.E6Xa.3.2.2.m1.3.3.2.5.2.cmml">M</mi><msup id="S3.E6Xa.3.2.2.m1.3.3.2.5.3" xref="S3.E6Xa.3.2.2.m1.3.3.2.5.3.cmml"><mi id="S3.E6Xa.3.2.2.m1.3.3.2.5.3.2" xref="S3.E6Xa.3.2.2.m1.3.3.2.5.3.2.cmml">c</mi><mo id="S3.E6Xa.3.2.2.m1.3.3.2.5.3.3" xref="S3.E6Xa.3.2.2.m1.3.3.2.5.3.3.cmml">∗</mo></msup></msub></mrow></munder></mstyle><mrow id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6Xa.3.2.2.m1.7.7" xref="S3.E6Xa.3.2.2.m1.7.7.cmml">log</mi><mo id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1a" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml">S</mi><mrow id="S3.E6Xa.3.2.2.m1.6.6.3.3" xref="S3.E6Xa.3.2.2.m1.6.6.3.4.cmml"><mi id="S3.E6Xa.3.2.2.m1.4.4.1.1" xref="S3.E6Xa.3.2.2.m1.4.4.1.1.cmml">h</mi><mo id="S3.E6Xa.3.2.2.m1.6.6.3.3.2" xref="S3.E6Xa.3.2.2.m1.6.6.3.4.cmml">,</mo><mi id="S3.E6Xa.3.2.2.m1.5.5.2.2" xref="S3.E6Xa.3.2.2.m1.5.5.2.2.cmml">w</mi><mo id="S3.E6Xa.3.2.2.m1.6.6.3.3.3" xref="S3.E6Xa.3.2.2.m1.6.6.3.4.cmml">,</mo><msup id="S3.E6Xa.3.2.2.m1.6.6.3.3.1" xref="S3.E6Xa.3.2.2.m1.6.6.3.3.1.cmml"><mi id="S3.E6Xa.3.2.2.m1.6.6.3.3.1.2" xref="S3.E6Xa.3.2.2.m1.6.6.3.3.1.2.cmml">c</mi><mo id="S3.E6Xa.3.2.2.m1.6.6.3.3.1.3" xref="S3.E6Xa.3.2.2.m1.6.6.3.3.1.3.cmml">∗</mo></msup></mrow></msub><mo id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E6Xa.3.2.2.m1.8.8.1.2" lspace="0em" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6Xa.3.2.2.m1.8b"><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1"><eq id="S3.E6Xa.3.2.2.m1.8.8.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.2"></eq><csymbol cd="latexml" id="S3.E6Xa.3.2.2.m1.8.8.1.1.3.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.3">absent</csymbol><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1"><minus id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1"></minus><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1"><times id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.2"></times><apply id="S3.E6Xa.3.2.2.m1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1"><divide id="S3.E6Xa.3.2.2.m1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.1.1"></divide><cn id="S3.E6Xa.3.2.2.m1.1.1.3.cmml" type="integer" xref="S3.E6Xa.3.2.2.m1.1.1.3">1</cn><apply id="S3.E6Xa.3.2.2.m1.1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1"><abs id="S3.E6Xa.3.2.2.m1.1.1.1.2.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.2"></abs><apply id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.2">ℳ</ci><apply id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3"><times id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.1"></times><ci id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.2.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.2">𝐺</ci><ci id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.3.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply></apply><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1"><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2"></sum><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3"><in id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.1"></in><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.2">𝑀</ci><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3">superscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3.2">𝑐</ci><times id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3.3.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.3.3"></times></apply></apply><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3">superscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.2">ℳ</ci><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3"><times id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.1"></times><ci id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.2">𝐺</ci><ci id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.3.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.3.3">𝑇</ci></apply></apply></apply></apply><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1"><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.2.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.2.2"></sum><apply id="S3.E6Xa.3.2.2.m1.3.3.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.2"><in id="S3.E6Xa.3.2.2.m1.3.3.2.3.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.2.3"></in><interval closure="open" id="S3.E6Xa.3.2.2.m1.3.3.2.4.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.2.4.2"><ci id="S3.E6Xa.3.2.2.m1.2.2.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.2.2.1.1">ℎ</ci><ci id="S3.E6Xa.3.2.2.m1.3.3.2.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.2.2">𝑤</ci></interval><apply id="S3.E6Xa.3.2.2.m1.3.3.2.5.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.2.5"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.3.3.2.5.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.2.5">subscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.3.3.2.5.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.2.5.2">𝑀</ci><apply id="S3.E6Xa.3.2.2.m1.3.3.2.5.3.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.2.5.3"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.3.3.2.5.3.1.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.2.5.3">superscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.3.3.2.5.3.2.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.2.5.3.2">𝑐</ci><times id="S3.E6Xa.3.2.2.m1.3.3.2.5.3.3.cmml" xref="S3.E6Xa.3.2.2.m1.3.3.2.5.3.3"></times></apply></apply></apply></apply><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1"><log id="S3.E6Xa.3.2.2.m1.7.7.cmml" xref="S3.E6Xa.3.2.2.m1.7.7"></log><apply id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.1.1.2">𝑆</ci><list id="S3.E6Xa.3.2.2.m1.6.6.3.4.cmml" xref="S3.E6Xa.3.2.2.m1.6.6.3.3"><ci id="S3.E6Xa.3.2.2.m1.4.4.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.4.4.1.1">ℎ</ci><ci id="S3.E6Xa.3.2.2.m1.5.5.2.2.cmml" xref="S3.E6Xa.3.2.2.m1.5.5.2.2">𝑤</ci><apply id="S3.E6Xa.3.2.2.m1.6.6.3.3.1.cmml" xref="S3.E6Xa.3.2.2.m1.6.6.3.3.1"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.6.6.3.3.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.6.6.3.3.1">superscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.6.6.3.3.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.6.6.3.3.1.2">𝑐</ci><times id="S3.E6Xa.3.2.2.m1.6.6.3.3.1.3.cmml" xref="S3.E6Xa.3.2.2.m1.6.6.3.3.1.3"></times></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6Xa.3.2.2.m1.8c">\displaystyle=-\frac{1}{|\mathcal{M}^{GT}|}\sum_{M_{c^{*}}\in\mathcal{M}^{GT}}%
\sum_{(h,w)\in M_{c^{*}}}\log(S_{h,w,c^{*}}).</annotation><annotation encoding="application/x-llamapun" id="S3.E6Xa.3.2.2.m1.8d">= - divide start_ARG 1 end_ARG start_ARG | caligraphic_M start_POSTSUPERSCRIPT italic_G italic_T end_POSTSUPERSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_M start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∈ caligraphic_M start_POSTSUPERSCRIPT italic_G italic_T end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT ( italic_h , italic_w ) ∈ italic_M start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log ( italic_S start_POSTSUBSCRIPT italic_h , italic_w , italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.3">Here, <math alttext="\mathcal{L}_{Mask}" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><msub id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml"><mi id="S3.SS2.p5.1.m1.1.1.3.2" xref="S3.SS2.p5.1.m1.1.1.3.2.cmml">M</mi><mo id="S3.SS2.p5.1.m1.1.1.3.1" xref="S3.SS2.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.1.m1.1.1.3.3" xref="S3.SS2.p5.1.m1.1.1.3.3.cmml">a</mi><mo id="S3.SS2.p5.1.m1.1.1.3.1a" xref="S3.SS2.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.1.m1.1.1.3.4" xref="S3.SS2.p5.1.m1.1.1.3.4.cmml">s</mi><mo id="S3.SS2.p5.1.m1.1.1.3.1b" xref="S3.SS2.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.1.m1.1.1.3.5" xref="S3.SS2.p5.1.m1.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">ℒ</ci><apply id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3"><times id="S3.SS2.p5.1.m1.1.1.3.1.cmml" xref="S3.SS2.p5.1.m1.1.1.3.1"></times><ci id="S3.SS2.p5.1.m1.1.1.3.2.cmml" xref="S3.SS2.p5.1.m1.1.1.3.2">𝑀</ci><ci id="S3.SS2.p5.1.m1.1.1.3.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3">𝑎</ci><ci id="S3.SS2.p5.1.m1.1.1.3.4.cmml" xref="S3.SS2.p5.1.m1.1.1.3.4">𝑠</ci><ci id="S3.SS2.p5.1.m1.1.1.3.5.cmml" xref="S3.SS2.p5.1.m1.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\mathcal{L}_{Mask}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_M italic_a italic_s italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is used to promote IoU matching of mask regions, <math alttext="\mathcal{L}_{Class}" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.1"><semantics id="S3.SS2.p5.2.m2.1a"><msub id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.3.2.cmml">C</mi><mo id="S3.SS2.p5.2.m2.1.1.3.1" xref="S3.SS2.p5.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.2.m2.1.1.3.3" xref="S3.SS2.p5.2.m2.1.1.3.3.cmml">l</mi><mo id="S3.SS2.p5.2.m2.1.1.3.1a" xref="S3.SS2.p5.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.2.m2.1.1.3.4" xref="S3.SS2.p5.2.m2.1.1.3.4.cmml">a</mi><mo id="S3.SS2.p5.2.m2.1.1.3.1b" xref="S3.SS2.p5.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.2.m2.1.1.3.5" xref="S3.SS2.p5.2.m2.1.1.3.5.cmml">s</mi><mo id="S3.SS2.p5.2.m2.1.1.3.1c" xref="S3.SS2.p5.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p5.2.m2.1.1.3.6" xref="S3.SS2.p5.2.m2.1.1.3.6.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2">ℒ</ci><apply id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3"><times id="S3.SS2.p5.2.m2.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3.1"></times><ci id="S3.SS2.p5.2.m2.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.2">𝐶</ci><ci id="S3.SS2.p5.2.m2.1.1.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3">𝑙</ci><ci id="S3.SS2.p5.2.m2.1.1.3.4.cmml" xref="S3.SS2.p5.2.m2.1.1.3.4">𝑎</ci><ci id="S3.SS2.p5.2.m2.1.1.3.5.cmml" xref="S3.SS2.p5.2.m2.1.1.3.5">𝑠</ci><ci id="S3.SS2.p5.2.m2.1.1.3.6.cmml" xref="S3.SS2.p5.2.m2.1.1.3.6">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">\mathcal{L}_{Class}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_C italic_l italic_a italic_s italic_s end_POSTSUBSCRIPT</annotation></semantics></math> is conditional cross entropy to promote category matching within the masks, and <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m3.1"><semantics id="S3.SS2.p5.3.m3.1a"><mi id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><ci id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m3.1d">italic_α</annotation></semantics></math> is the balance coefficient. Note that label evolution and image updating occur alternately: The synthesized images provide response preferences for label evolution while the resulting labels guide image updating, and ultimately both converge at a high semantic level.</p>
</div>
<div class="ltx_para" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.1">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.F4" title="Figure 4 ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">4</span></a> illustrates the process of pseudo-label evolution and synthesized image updating. The label is initialized by a mask with random position, size, and category, and the image is initialized by Gaussian noise. As the iterations proceed, the label evolves: in the 50th iteration, a liver region (red) appears near the right kidney (purple); in the 200th iteration, a pancreas (orange) region appears near the stomach (dark blue). Also, the left kidney (bright blue) and the right kidney (purple) are distributed symmetrically on both sides of the stomach (dark blue). These present spatial relationships aligned with the real labels. Moreover, the shapes and sizes of the masks also gradually converge to the real labels. For instance, the kidneys (purple and bright blue) appear elliptical or auricular, the pancreas (orange) is in the form of a thin irregular strip, and the stomach (dark blue) is relatively large. As a result, both the label and the image gradually learn abundant semantic information, resulting in a mutually beneficial situation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p7">
<p class="ltx_p" id="S3.SS2.p7.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p7.1.1">Distributional Matching: Patch Similarity Metric</span>
Previous methods are designed for CNNs, and they rely on BatchNorm statistics to obtain the distribution of the original data. However, Transformers employs LayerNorm, which does not store any previous information. To this end, our preliminary work PSAQ-ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib22" title="">22</a>]</cite> summarizes the general difference between the two by examining the self-attention module’s response in Transformers when the inputs are real images and Gaussian noise, respectively. The details are in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A1.SS1" title="A.1 PSAQ-ViT: Patch Similarity Metric ‣ Appendix A Our preliminary efforts for DFQ-SAM ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">A.1</span></a>. Building on this insight, it designs a relative value metric, the diversity of patch similarity, to quantify this difference and optimizes it during image synthesis to narrow the gap, allowing the synthesized image to gradually approach the distribution of real images from the initial Gaussian noise.</p>
</div>
<div class="ltx_para" id="S3.SS2.p8">
<p class="ltx_p" id="S3.SS2.p8.4">Specifically, we first hook the output from the attention module, denoted as <math alttext="O_{l}" class="ltx_Math" display="inline" id="S3.SS2.p8.1.m1.1"><semantics id="S3.SS2.p8.1.m1.1a"><msub id="S3.SS2.p8.1.m1.1.1" xref="S3.SS2.p8.1.m1.1.1.cmml"><mi id="S3.SS2.p8.1.m1.1.1.2" xref="S3.SS2.p8.1.m1.1.1.2.cmml">O</mi><mi id="S3.SS2.p8.1.m1.1.1.3" xref="S3.SS2.p8.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.1.m1.1b"><apply id="S3.SS2.p8.1.m1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p8.1.m1.1.1.2.cmml" xref="S3.SS2.p8.1.m1.1.1.2">𝑂</ci><ci id="S3.SS2.p8.1.m1.1.1.3.cmml" xref="S3.SS2.p8.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.1.m1.1c">O_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.1.m1.1d">italic_O start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. Here, <math alttext="l\in\{1,\cdots,L\}" class="ltx_Math" display="inline" id="S3.SS2.p8.2.m2.3"><semantics id="S3.SS2.p8.2.m2.3a"><mrow id="S3.SS2.p8.2.m2.3.4" xref="S3.SS2.p8.2.m2.3.4.cmml"><mi id="S3.SS2.p8.2.m2.3.4.2" xref="S3.SS2.p8.2.m2.3.4.2.cmml">l</mi><mo id="S3.SS2.p8.2.m2.3.4.1" xref="S3.SS2.p8.2.m2.3.4.1.cmml">∈</mo><mrow id="S3.SS2.p8.2.m2.3.4.3.2" xref="S3.SS2.p8.2.m2.3.4.3.1.cmml"><mo id="S3.SS2.p8.2.m2.3.4.3.2.1" stretchy="false" xref="S3.SS2.p8.2.m2.3.4.3.1.cmml">{</mo><mn id="S3.SS2.p8.2.m2.1.1" xref="S3.SS2.p8.2.m2.1.1.cmml">1</mn><mo id="S3.SS2.p8.2.m2.3.4.3.2.2" xref="S3.SS2.p8.2.m2.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p8.2.m2.2.2" mathvariant="normal" xref="S3.SS2.p8.2.m2.2.2.cmml">⋯</mi><mo id="S3.SS2.p8.2.m2.3.4.3.2.3" xref="S3.SS2.p8.2.m2.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p8.2.m2.3.3" xref="S3.SS2.p8.2.m2.3.3.cmml">L</mi><mo id="S3.SS2.p8.2.m2.3.4.3.2.4" stretchy="false" xref="S3.SS2.p8.2.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.2.m2.3b"><apply id="S3.SS2.p8.2.m2.3.4.cmml" xref="S3.SS2.p8.2.m2.3.4"><in id="S3.SS2.p8.2.m2.3.4.1.cmml" xref="S3.SS2.p8.2.m2.3.4.1"></in><ci id="S3.SS2.p8.2.m2.3.4.2.cmml" xref="S3.SS2.p8.2.m2.3.4.2">𝑙</ci><set id="S3.SS2.p8.2.m2.3.4.3.1.cmml" xref="S3.SS2.p8.2.m2.3.4.3.2"><cn id="S3.SS2.p8.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p8.2.m2.1.1">1</cn><ci id="S3.SS2.p8.2.m2.2.2.cmml" xref="S3.SS2.p8.2.m2.2.2">⋯</ci><ci id="S3.SS2.p8.2.m2.3.3.cmml" xref="S3.SS2.p8.2.m2.3.3">𝐿</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.2.m2.3c">l\in\{1,\cdots,L\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.2.m2.3d">italic_l ∈ { 1 , ⋯ , italic_L }</annotation></semantics></math>, and <math alttext="L" class="ltx_Math" display="inline" id="S3.SS2.p8.3.m3.1"><semantics id="S3.SS2.p8.3.m3.1a"><mi id="S3.SS2.p8.3.m3.1.1" xref="S3.SS2.p8.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.3.m3.1b"><ci id="S3.SS2.p8.3.m3.1.1.cmml" xref="S3.SS2.p8.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.3.m3.1d">italic_L</annotation></semantics></math> is the number of layers.
Then, we normalize <math alttext="O_{l}" class="ltx_Math" display="inline" id="S3.SS2.p8.4.m4.1"><semantics id="S3.SS2.p8.4.m4.1a"><msub id="S3.SS2.p8.4.m4.1.1" xref="S3.SS2.p8.4.m4.1.1.cmml"><mi id="S3.SS2.p8.4.m4.1.1.2" xref="S3.SS2.p8.4.m4.1.1.2.cmml">O</mi><mi id="S3.SS2.p8.4.m4.1.1.3" xref="S3.SS2.p8.4.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.4.m4.1b"><apply id="S3.SS2.p8.4.m4.1.1.cmml" xref="S3.SS2.p8.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.4.m4.1.1.1.cmml" xref="S3.SS2.p8.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p8.4.m4.1.1.2.cmml" xref="S3.SS2.p8.4.m4.1.1.2">𝑂</ci><ci id="S3.SS2.p8.4.m4.1.1.3.cmml" xref="S3.SS2.p8.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.4.m4.1c">O_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.4.m4.1d">italic_O start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> in its patch dimension to ensure a unified range of relative value metrics, which is achieved by computing the cosine similarity as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{\Gamma}_{l}\left(u_{i},u_{j}\right)=\left\{\left.\frac{u_{i}\cdot u_{j}}{%
\left\|u_{i}\right\|\left\|u_{j}\right\|}\right\rvert\,i,j\in\{1,2,\ldots,N\}%
\right\}," class="ltx_math_unparsed" display="block" id="S3.E7.m1.2"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2b"><msub id="S3.E7.m1.2.3"><mi id="S3.E7.m1.2.3.2">𝚪</mi><mi id="S3.E7.m1.2.3.3">l</mi></msub><mrow id="S3.E7.m1.2.4"><mo id="S3.E7.m1.2.4.1">(</mo><msub id="S3.E7.m1.2.4.2"><mi id="S3.E7.m1.2.4.2.2">u</mi><mi id="S3.E7.m1.2.4.2.3">i</mi></msub><mo id="S3.E7.m1.2.4.3">,</mo><msub id="S3.E7.m1.2.4.4"><mi id="S3.E7.m1.2.4.4.2">u</mi><mi id="S3.E7.m1.2.4.4.3">j</mi></msub><mo id="S3.E7.m1.2.4.5">)</mo></mrow><mo id="S3.E7.m1.2.5">=</mo><mrow id="S3.E7.m1.2.6"><mo id="S3.E7.m1.2.6.1">{</mo><mfrac id="S3.E7.m1.2.2"><mrow id="S3.E7.m1.2.2.4"><msub id="S3.E7.m1.2.2.4.2"><mi id="S3.E7.m1.2.2.4.2.2">u</mi><mi id="S3.E7.m1.2.2.4.2.3">i</mi></msub><mo id="S3.E7.m1.2.2.4.1" lspace="0.222em" rspace="0.222em">⋅</mo><msub id="S3.E7.m1.2.2.4.3"><mi id="S3.E7.m1.2.2.4.3.2">u</mi><mi id="S3.E7.m1.2.2.4.3.3">j</mi></msub></mrow><mrow id="S3.E7.m1.2.2.2"><mrow id="S3.E7.m1.1.1.1.1.1"><mo id="S3.E7.m1.1.1.1.1.1.2">‖</mo><msub id="S3.E7.m1.1.1.1.1.1.1"><mi id="S3.E7.m1.1.1.1.1.1.1.2">u</mi><mi id="S3.E7.m1.1.1.1.1.1.1.3">i</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.3">‖</mo></mrow><mo id="S3.E7.m1.2.2.2.3">⁢</mo><mrow id="S3.E7.m1.2.2.2.2.1"><mo id="S3.E7.m1.2.2.2.2.1.2">‖</mo><msub id="S3.E7.m1.2.2.2.2.1.1"><mi id="S3.E7.m1.2.2.2.2.1.1.2">u</mi><mi id="S3.E7.m1.2.2.2.2.1.1.3">j</mi></msub><mo id="S3.E7.m1.2.2.2.2.1.3">‖</mo></mrow></mrow></mfrac><mo id="S3.E7.m1.2.6.2" rspace="0.170em">|</mo></mrow><mi id="S3.E7.m1.2.7">i</mi><mo id="S3.E7.m1.2.8">,</mo><mi id="S3.E7.m1.2.9">j</mi><mo id="S3.E7.m1.2.10">∈</mo><mrow id="S3.E7.m1.2.11"><mo id="S3.E7.m1.2.11.1" stretchy="false">{</mo><mn id="S3.E7.m1.2.11.2">1</mn><mo id="S3.E7.m1.2.11.3">,</mo><mn id="S3.E7.m1.2.11.4">2</mn><mo id="S3.E7.m1.2.11.5">,</mo><mi id="S3.E7.m1.2.11.6" mathvariant="normal">…</mi><mo id="S3.E7.m1.2.11.7">,</mo><mi id="S3.E7.m1.2.11.8">N</mi><mo id="S3.E7.m1.2.11.9" stretchy="false">}</mo></mrow><mo id="S3.E7.m1.2.12">}</mo><mo id="S3.E7.m1.2.13">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E7.m1.2c">\bm{\Gamma}_{l}\left(u_{i},u_{j}\right)=\left\{\left.\frac{u_{i}\cdot u_{j}}{%
\left\|u_{i}\right\|\left\|u_{j}\right\|}\right\rvert\,i,j\in\{1,2,\ldots,N\}%
\right\},</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.2d">bold_Γ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = { divide start_ARG italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ italic_u start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG ∥ italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ ∥ italic_u start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∥ end_ARG | italic_i , italic_j ∈ { 1 , 2 , … , italic_N } } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p8.11">where <math alttext="u_{i}" class="ltx_Math" display="inline" id="S3.SS2.p8.5.m1.1"><semantics id="S3.SS2.p8.5.m1.1a"><msub id="S3.SS2.p8.5.m1.1.1" xref="S3.SS2.p8.5.m1.1.1.cmml"><mi id="S3.SS2.p8.5.m1.1.1.2" xref="S3.SS2.p8.5.m1.1.1.2.cmml">u</mi><mi id="S3.SS2.p8.5.m1.1.1.3" xref="S3.SS2.p8.5.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.5.m1.1b"><apply id="S3.SS2.p8.5.m1.1.1.cmml" xref="S3.SS2.p8.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.5.m1.1.1.1.cmml" xref="S3.SS2.p8.5.m1.1.1">subscript</csymbol><ci id="S3.SS2.p8.5.m1.1.1.2.cmml" xref="S3.SS2.p8.5.m1.1.1.2">𝑢</ci><ci id="S3.SS2.p8.5.m1.1.1.3.cmml" xref="S3.SS2.p8.5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.5.m1.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.5.m1.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="u_{j}" class="ltx_Math" display="inline" id="S3.SS2.p8.6.m2.1"><semantics id="S3.SS2.p8.6.m2.1a"><msub id="S3.SS2.p8.6.m2.1.1" xref="S3.SS2.p8.6.m2.1.1.cmml"><mi id="S3.SS2.p8.6.m2.1.1.2" xref="S3.SS2.p8.6.m2.1.1.2.cmml">u</mi><mi id="S3.SS2.p8.6.m2.1.1.3" xref="S3.SS2.p8.6.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.6.m2.1b"><apply id="S3.SS2.p8.6.m2.1.1.cmml" xref="S3.SS2.p8.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.6.m2.1.1.1.cmml" xref="S3.SS2.p8.6.m2.1.1">subscript</csymbol><ci id="S3.SS2.p8.6.m2.1.1.2.cmml" xref="S3.SS2.p8.6.m2.1.1.2">𝑢</ci><ci id="S3.SS2.p8.6.m2.1.1.3.cmml" xref="S3.SS2.p8.6.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.6.m2.1c">u_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.6.m2.1d">italic_u start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p8.7.m3.1"><semantics id="S3.SS2.p8.7.m3.1a"><mi id="S3.SS2.p8.7.m3.1.1" xref="S3.SS2.p8.7.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.7.m3.1b"><ci id="S3.SS2.p8.7.m3.1.1.cmml" xref="S3.SS2.p8.7.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.7.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.7.m3.1d">italic_i</annotation></semantics></math>-th and <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p8.8.m4.1"><semantics id="S3.SS2.p8.8.m4.1a"><mi id="S3.SS2.p8.8.m4.1.1" xref="S3.SS2.p8.8.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.8.m4.1b"><ci id="S3.SS2.p8.8.m4.1.1.cmml" xref="S3.SS2.p8.8.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.8.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.8.m4.1d">italic_j</annotation></semantics></math>-th vectors in the patch dimension of <math alttext="O_{l}" class="ltx_Math" display="inline" id="S3.SS2.p8.9.m5.1"><semantics id="S3.SS2.p8.9.m5.1a"><msub id="S3.SS2.p8.9.m5.1.1" xref="S3.SS2.p8.9.m5.1.1.cmml"><mi id="S3.SS2.p8.9.m5.1.1.2" xref="S3.SS2.p8.9.m5.1.1.2.cmml">O</mi><mi id="S3.SS2.p8.9.m5.1.1.3" xref="S3.SS2.p8.9.m5.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.9.m5.1b"><apply id="S3.SS2.p8.9.m5.1.1.cmml" xref="S3.SS2.p8.9.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.9.m5.1.1.1.cmml" xref="S3.SS2.p8.9.m5.1.1">subscript</csymbol><ci id="S3.SS2.p8.9.m5.1.1.2.cmml" xref="S3.SS2.p8.9.m5.1.1.2">𝑂</ci><ci id="S3.SS2.p8.9.m5.1.1.3.cmml" xref="S3.SS2.p8.9.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.9.m5.1c">O_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.9.m5.1d">italic_O start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, respectively, and <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.p8.10.m6.1"><semantics id="S3.SS2.p8.10.m6.1a"><mi id="S3.SS2.p8.10.m6.1.1" xref="S3.SS2.p8.10.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.10.m6.1b"><ci id="S3.SS2.p8.10.m6.1.1.cmml" xref="S3.SS2.p8.10.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.10.m6.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.10.m6.1d">italic_N</annotation></semantics></math> is the number of patches. Here, <math alttext="\bm{\Gamma}_{l}" class="ltx_Math" display="inline" id="S3.SS2.p8.11.m7.1"><semantics id="S3.SS2.p8.11.m7.1a"><msub id="S3.SS2.p8.11.m7.1.1" xref="S3.SS2.p8.11.m7.1.1.cmml"><mi id="S3.SS2.p8.11.m7.1.1.2" xref="S3.SS2.p8.11.m7.1.1.2.cmml">𝚪</mi><mi id="S3.SS2.p8.11.m7.1.1.3" xref="S3.SS2.p8.11.m7.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.11.m7.1b"><apply id="S3.SS2.p8.11.m7.1.1.cmml" xref="S3.SS2.p8.11.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.11.m7.1.1.1.cmml" xref="S3.SS2.p8.11.m7.1.1">subscript</csymbol><ci id="S3.SS2.p8.11.m7.1.1.2.cmml" xref="S3.SS2.p8.11.m7.1.1.2">𝚪</ci><ci id="S3.SS2.p8.11.m7.1.1.3.cmml" xref="S3.SS2.p8.11.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.11.m7.1c">\bm{\Gamma}_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.11.m7.1d">bold_Γ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> is referred to as <em class="ltx_emph ltx_font_italic" id="S3.SS2.p8.11.1">patch similarity</em>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p9">
<p class="ltx_p" id="S3.SS2.p9.1">The diversity of patch similarity is measured by the differential entropy, which is calculated as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E8">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E8X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbb{E}(\bm{\Gamma}_{l};\mathcal{G})=-\int f_{h}(x)\cdot\log%
\left[f_{h}(x)\right]dx," class="ltx_Math" display="inline" id="S3.E8X.2.1.1.m1.5"><semantics id="S3.E8X.2.1.1.m1.5a"><mrow id="S3.E8X.2.1.1.m1.5.5.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.cmml"><mrow id="S3.E8X.2.1.1.m1.5.5.1.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.cmml"><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.1.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.3.cmml">𝔼</mi><mo id="S3.E8X.2.1.1.m1.5.5.1.1.1.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.2.cmml">(</mo><msub id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.cmml">𝚪</mi><mi id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.2.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8X.2.1.1.m1.1.1" xref="S3.E8X.2.1.1.m1.1.1.cmml">𝒢</mi><mo id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.4" stretchy="false" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E8X.2.1.1.m1.5.5.1.1.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.cmml"><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2a" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.cmml">−</mo><mstyle displaystyle="true" id="S3.E8X.2.1.1.m1.5.5.1.1.2.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.cmml"><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.2.1a" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.cmml"><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.2.cmml">∫</mo><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.cmml"><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.cmml"><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.cmml"><msub id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.2.cmml">f</mi><mi id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.3.cmml">h</mi></msub><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.3.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.cmml"><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.3.2.1" stretchy="false" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.cmml">(</mo><mi id="S3.E8X.2.1.1.m1.2.2" xref="S3.E8X.2.1.1.m1.2.2.cmml">x</mi><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.3.2.2" rspace="0.055em" stretchy="false" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.2" rspace="0.222em" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.2.cmml">⋅</mo><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.2.cmml"><mi id="S3.E8X.2.1.1.m1.4.4" xref="S3.E8X.2.1.1.m1.4.4.cmml">log</mi><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1a" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.2.cmml"><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.2.cmml">[</mo><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml"><msub id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3.cmml">h</mi></msub><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.1" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E8X.2.1.1.m1.3.3" xref="S3.E8X.2.1.1.m1.3.3.cmml">x</mi><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.2.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.2" lspace="0em" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.2.cmml">⁢</mo><mrow id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.3" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.3.cmml"><mo id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.3.1" rspace="0em" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.3.1.cmml">𝑑</mo><mi id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.3.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.3.2.cmml">x</mi></mrow></mrow></mrow></mstyle></mrow></mrow><mo id="S3.E8X.2.1.1.m1.5.5.1.2" xref="S3.E8X.2.1.1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8X.2.1.1.m1.5b"><apply id="S3.E8X.2.1.1.m1.5.5.1.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1"><eq id="S3.E8X.2.1.1.m1.5.5.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.3"></eq><apply id="S3.E8X.2.1.1.m1.5.5.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1"><times id="S3.E8X.2.1.1.m1.5.5.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.2"></times><ci id="S3.E8X.2.1.1.m1.5.5.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.3">𝔼</ci><list id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1"><apply id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.2">𝚪</ci><ci id="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.1.1.1.1.3">𝑙</ci></apply><ci id="S3.E8X.2.1.1.m1.1.1.cmml" xref="S3.E8X.2.1.1.m1.1.1">𝒢</ci></list></apply><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2"><minus id="S3.E8X.2.1.1.m1.5.5.1.1.2.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2"></minus><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1"><int id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.2"></int><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1"><times id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.2"></times><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1"><ci id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.2">⋅</ci><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3"><times id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.1"></times><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.2">𝑓</ci><ci id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.3.2.3">ℎ</ci></apply><ci id="S3.E8X.2.1.1.m1.2.2.cmml" xref="S3.E8X.2.1.1.m1.2.2">𝑥</ci></apply><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1"><log id="S3.E8X.2.1.1.m1.4.4.cmml" xref="S3.E8X.2.1.1.m1.4.4"></log><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1"><times id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.1"></times><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.1.1.1.1.1.2.3">ℎ</ci></apply><ci id="S3.E8X.2.1.1.m1.3.3.cmml" xref="S3.E8X.2.1.1.m1.3.3">𝑥</ci></apply></apply></apply><apply id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.3.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.3"><csymbol cd="latexml" id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.3.1.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.3.1">differential-d</csymbol><ci id="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.3.2.cmml" xref="S3.E8X.2.1.1.m1.5.5.1.1.2.1.1.3.2">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8X.2.1.1.m1.5c">\displaystyle\mathbb{E}(\bm{\Gamma}_{l};\mathcal{G})=-\int f_{h}(x)\cdot\log%
\left[f_{h}(x)\right]dx,</annotation><annotation encoding="application/x-llamapun" id="S3.E8X.2.1.1.m1.5d">blackboard_E ( bold_Γ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ; caligraphic_G ) = - ∫ italic_f start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_x ) ⋅ roman_log [ italic_f start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_x ) ] italic_d italic_x ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E8Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{where}\quad f_{h}(x)=\frac{1}{K}\sum_{k=1}^{K}\mathcal{K}_{%
h}(x-x_{k})." class="ltx_Math" display="inline" id="S3.E8Xa.2.1.1.m1.3"><semantics id="S3.E8Xa.2.1.1.m1.3a"><mrow id="S3.E8Xa.2.1.1.m1.3.3.1" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.E8Xa.2.1.1.m1.3.3.1.1" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.2.cmml"><mtext id="S3.E8Xa.2.1.1.m1.2.2" xref="S3.E8Xa.2.1.1.m1.2.2a.cmml">where</mtext><mspace id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.2" width="1em" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.2.cmml"></mspace><mrow id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml"><msub id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.cmml">f</mi><mi id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2.3" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2.3.cmml">h</mi></msub><mo id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml"><mo id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="S3.E8Xa.2.1.1.m1.1.1" xref="S3.E8Xa.2.1.1.m1.1.1.cmml">x</mi><mo id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8Xa.2.1.1.m1.3.3.1.1.3" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E8Xa.2.1.1.m1.3.3.1.1.2" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3.cmml"><mfrac id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3a" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3.cmml"><mn id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3.2" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3.2.cmml">1</mn><mi id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3.3" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3.3.cmml">K</mi></mfrac></mstyle><mo id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.2" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.2.cmml">⁢</mo><mrow id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.cmml"><mstyle displaystyle="true" id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.cmml"><munderover id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2a" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.cmml"><mo id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.2" movablelimits="false" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.2" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.2.cmml">k</mi><mo id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.1" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.3" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.3" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.3.cmml">K</mi></munderover></mstyle><mrow id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.cmml"><msub id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3.2" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3.2.cmml">𝒦</mi><mi id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3.3" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3.3.cmml">h</mi></msub><mo id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.2" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.2.cmml">⁢</mo><mrow id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mo id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.2" stretchy="false" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mi id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">x</mi><mo id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.1" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3.cmml"><mi id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3.2" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3.2.cmml">x</mi><mi id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3.3" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.3" stretchy="false" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E8Xa.2.1.1.m1.3.3.1.2" lspace="0em" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8Xa.2.1.1.m1.3b"><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1"><eq id="S3.E8Xa.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.3"></eq><list id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1"><ci id="S3.E8Xa.2.1.1.m1.2.2a.cmml" xref="S3.E8Xa.2.1.1.m1.2.2"><mtext id="S3.E8Xa.2.1.1.m1.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.2.2">where</mtext></ci><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1"><times id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.1"></times><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.1.1.1.2.3">ℎ</ci></apply><ci id="S3.E8Xa.2.1.1.m1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.1.1">𝑥</ci></apply></list><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2"><times id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.2"></times><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3"><divide id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3"></divide><cn id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3.2.cmml" type="integer" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3.2">1</cn><ci id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.3.3">𝐾</ci></apply><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1"><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2">superscript</csymbol><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2">subscript</csymbol><sum id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.2"></sum><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3"><eq id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.1"></eq><ci id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.2">𝑘</ci><cn id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.3.cmml" type="integer" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.2.3">𝐾</ci></apply><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1"><times id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.2"></times><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3.2">𝒦</ci><ci id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.3.3">ℎ</ci></apply><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1"><minus id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.1"></minus><ci id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.2">𝑥</ci><apply id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3.1.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3.2.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3.2">𝑥</ci><ci id="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3.3.cmml" xref="S3.E8Xa.2.1.1.m1.3.3.1.1.2.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8Xa.2.1.1.m1.3c">\displaystyle\text{where}\quad f_{h}(x)=\frac{1}{K}\sum_{k=1}^{K}\mathcal{K}_{%
h}(x-x_{k}).</annotation><annotation encoding="application/x-llamapun" id="S3.E8Xa.2.1.1.m1.3d">where italic_f start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_x ) = divide start_ARG 1 end_ARG start_ARG italic_K end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT caligraphic_K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_x - italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p10">
<p class="ltx_p" id="S3.SS2.p10.7">Here, <math alttext="f_{h}(x)" class="ltx_Math" display="inline" id="S3.SS2.p10.1.m1.1"><semantics id="S3.SS2.p10.1.m1.1a"><mrow id="S3.SS2.p10.1.m1.1.2" xref="S3.SS2.p10.1.m1.1.2.cmml"><msub id="S3.SS2.p10.1.m1.1.2.2" xref="S3.SS2.p10.1.m1.1.2.2.cmml"><mi id="S3.SS2.p10.1.m1.1.2.2.2" xref="S3.SS2.p10.1.m1.1.2.2.2.cmml">f</mi><mi id="S3.SS2.p10.1.m1.1.2.2.3" xref="S3.SS2.p10.1.m1.1.2.2.3.cmml">h</mi></msub><mo id="S3.SS2.p10.1.m1.1.2.1" xref="S3.SS2.p10.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p10.1.m1.1.2.3.2" xref="S3.SS2.p10.1.m1.1.2.cmml"><mo id="S3.SS2.p10.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p10.1.m1.1.2.cmml">(</mo><mi id="S3.SS2.p10.1.m1.1.1" xref="S3.SS2.p10.1.m1.1.1.cmml">x</mi><mo id="S3.SS2.p10.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p10.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.1.m1.1b"><apply id="S3.SS2.p10.1.m1.1.2.cmml" xref="S3.SS2.p10.1.m1.1.2"><times id="S3.SS2.p10.1.m1.1.2.1.cmml" xref="S3.SS2.p10.1.m1.1.2.1"></times><apply id="S3.SS2.p10.1.m1.1.2.2.cmml" xref="S3.SS2.p10.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p10.1.m1.1.2.2.1.cmml" xref="S3.SS2.p10.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS2.p10.1.m1.1.2.2.2.cmml" xref="S3.SS2.p10.1.m1.1.2.2.2">𝑓</ci><ci id="S3.SS2.p10.1.m1.1.2.2.3.cmml" xref="S3.SS2.p10.1.m1.1.2.2.3">ℎ</ci></apply><ci id="S3.SS2.p10.1.m1.1.1.cmml" xref="S3.SS2.p10.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.1.m1.1c">f_{h}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> is the continuous probability density function of <math alttext="\bm{\Gamma}_{l}" class="ltx_Math" display="inline" id="S3.SS2.p10.2.m2.1"><semantics id="S3.SS2.p10.2.m2.1a"><msub id="S3.SS2.p10.2.m2.1.1" xref="S3.SS2.p10.2.m2.1.1.cmml"><mi id="S3.SS2.p10.2.m2.1.1.2" xref="S3.SS2.p10.2.m2.1.1.2.cmml">𝚪</mi><mi id="S3.SS2.p10.2.m2.1.1.3" xref="S3.SS2.p10.2.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.2.m2.1b"><apply id="S3.SS2.p10.2.m2.1.1.cmml" xref="S3.SS2.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.2.m2.1.1.1.cmml" xref="S3.SS2.p10.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p10.2.m2.1.1.2.cmml" xref="S3.SS2.p10.2.m2.1.1.2">𝚪</ci><ci id="S3.SS2.p10.2.m2.1.1.3.cmml" xref="S3.SS2.p10.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.2.m2.1c">\bm{\Gamma}_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.2.m2.1d">bold_Γ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, estimated using kernel density estimation. <math alttext="\mathcal{K}_{h}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p10.3.m3.1"><semantics id="S3.SS2.p10.3.m3.1a"><mrow id="S3.SS2.p10.3.m3.1.2" xref="S3.SS2.p10.3.m3.1.2.cmml"><msub id="S3.SS2.p10.3.m3.1.2.2" xref="S3.SS2.p10.3.m3.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p10.3.m3.1.2.2.2" xref="S3.SS2.p10.3.m3.1.2.2.2.cmml">𝒦</mi><mi id="S3.SS2.p10.3.m3.1.2.2.3" xref="S3.SS2.p10.3.m3.1.2.2.3.cmml">h</mi></msub><mo id="S3.SS2.p10.3.m3.1.2.1" xref="S3.SS2.p10.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p10.3.m3.1.2.3.2" xref="S3.SS2.p10.3.m3.1.2.cmml"><mo id="S3.SS2.p10.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS2.p10.3.m3.1.2.cmml">(</mo><mo id="S3.SS2.p10.3.m3.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p10.3.m3.1.1.cmml">⋅</mo><mo id="S3.SS2.p10.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS2.p10.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.3.m3.1b"><apply id="S3.SS2.p10.3.m3.1.2.cmml" xref="S3.SS2.p10.3.m3.1.2"><times id="S3.SS2.p10.3.m3.1.2.1.cmml" xref="S3.SS2.p10.3.m3.1.2.1"></times><apply id="S3.SS2.p10.3.m3.1.2.2.cmml" xref="S3.SS2.p10.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p10.3.m3.1.2.2.1.cmml" xref="S3.SS2.p10.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS2.p10.3.m3.1.2.2.2.cmml" xref="S3.SS2.p10.3.m3.1.2.2.2">𝒦</ci><ci id="S3.SS2.p10.3.m3.1.2.2.3.cmml" xref="S3.SS2.p10.3.m3.1.2.2.3">ℎ</ci></apply><ci id="S3.SS2.p10.3.m3.1.1.cmml" xref="S3.SS2.p10.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.3.m3.1c">\mathcal{K}_{h}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.3.m3.1d">caligraphic_K start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> represents the kernel (e.g. normal kernel) with the bandwidth <math alttext="h" class="ltx_Math" display="inline" id="S3.SS2.p10.4.m4.1"><semantics id="S3.SS2.p10.4.m4.1a"><mi id="S3.SS2.p10.4.m4.1.1" xref="S3.SS2.p10.4.m4.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.4.m4.1b"><ci id="S3.SS2.p10.4.m4.1.1.cmml" xref="S3.SS2.p10.4.m4.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.4.m4.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.4.m4.1d">italic_h</annotation></semantics></math>, <math alttext="x_{k}" class="ltx_Math" display="inline" id="S3.SS2.p10.5.m5.1"><semantics id="S3.SS2.p10.5.m5.1a"><msub id="S3.SS2.p10.5.m5.1.1" xref="S3.SS2.p10.5.m5.1.1.cmml"><mi id="S3.SS2.p10.5.m5.1.1.2" xref="S3.SS2.p10.5.m5.1.1.2.cmml">x</mi><mi id="S3.SS2.p10.5.m5.1.1.3" xref="S3.SS2.p10.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.5.m5.1b"><apply id="S3.SS2.p10.5.m5.1.1.cmml" xref="S3.SS2.p10.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.5.m5.1.1.1.cmml" xref="S3.SS2.p10.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p10.5.m5.1.1.2.cmml" xref="S3.SS2.p10.5.m5.1.1.2">𝑥</ci><ci id="S3.SS2.p10.5.m5.1.1.3.cmml" xref="S3.SS2.p10.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.5.m5.1c">x_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.5.m5.1d">italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a training point drawn from <math alttext="\bm{\Gamma}_{l}" class="ltx_Math" display="inline" id="S3.SS2.p10.6.m6.1"><semantics id="S3.SS2.p10.6.m6.1a"><msub id="S3.SS2.p10.6.m6.1.1" xref="S3.SS2.p10.6.m6.1.1.cmml"><mi id="S3.SS2.p10.6.m6.1.1.2" xref="S3.SS2.p10.6.m6.1.1.2.cmml">𝚪</mi><mi id="S3.SS2.p10.6.m6.1.1.3" xref="S3.SS2.p10.6.m6.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.6.m6.1b"><apply id="S3.SS2.p10.6.m6.1.1.cmml" xref="S3.SS2.p10.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.6.m6.1.1.1.cmml" xref="S3.SS2.p10.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p10.6.m6.1.1.2.cmml" xref="S3.SS2.p10.6.m6.1.1.2">𝚪</ci><ci id="S3.SS2.p10.6.m6.1.1.3.cmml" xref="S3.SS2.p10.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.6.m6.1c">\bm{\Gamma}_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.6.m6.1d">bold_Γ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> and serves as the center of a kernel, and <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p10.7.m7.1"><semantics id="S3.SS2.p10.7.m7.1a"><mi id="S3.SS2.p10.7.m7.1.1" xref="S3.SS2.p10.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.7.m7.1b"><ci id="S3.SS2.p10.7.m7.1.1.cmml" xref="S3.SS2.p10.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.7.m7.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p10.7.m7.1d">italic_x</annotation></semantics></math> is the given test point.</p>
</div>
<div class="ltx_para" id="S3.SS2.p11">
<p class="ltx_p" id="S3.SS2.p11.1">Finally, we sum the differential entropy of each layer to capture the diversity of patch similarity across all layers, and the <em class="ltx_emph ltx_font_italic" id="S3.SS2.p11.1.1">Distributional Matching Loss</em> is defined as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{DM}=\sum_{l=1}^{L}\mathbb{E}(\bm{\Gamma}_{l};\mathcal{G})." class="ltx_Math" display="block" id="S3.E9.m1.2"><semantics id="S3.E9.m1.2a"><mrow id="S3.E9.m1.2.2.1" xref="S3.E9.m1.2.2.1.1.cmml"><mrow id="S3.E9.m1.2.2.1.1" xref="S3.E9.m1.2.2.1.1.cmml"><msub id="S3.E9.m1.2.2.1.1.3" xref="S3.E9.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.2.2.1.1.3.2" xref="S3.E9.m1.2.2.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E9.m1.2.2.1.1.3.3" xref="S3.E9.m1.2.2.1.1.3.3.cmml"><mi id="S3.E9.m1.2.2.1.1.3.3.2" xref="S3.E9.m1.2.2.1.1.3.3.2.cmml">D</mi><mo id="S3.E9.m1.2.2.1.1.3.3.1" xref="S3.E9.m1.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E9.m1.2.2.1.1.3.3.3" xref="S3.E9.m1.2.2.1.1.3.3.3.cmml">M</mi></mrow></msub><mo id="S3.E9.m1.2.2.1.1.2" rspace="0.111em" xref="S3.E9.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.2.2.1.1.1" xref="S3.E9.m1.2.2.1.1.1.cmml"><munderover id="S3.E9.m1.2.2.1.1.1.2" xref="S3.E9.m1.2.2.1.1.1.2.cmml"><mo id="S3.E9.m1.2.2.1.1.1.2.2.2" movablelimits="false" xref="S3.E9.m1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E9.m1.2.2.1.1.1.2.2.3" xref="S3.E9.m1.2.2.1.1.1.2.2.3.cmml"><mi id="S3.E9.m1.2.2.1.1.1.2.2.3.2" xref="S3.E9.m1.2.2.1.1.1.2.2.3.2.cmml">l</mi><mo id="S3.E9.m1.2.2.1.1.1.2.2.3.1" xref="S3.E9.m1.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E9.m1.2.2.1.1.1.2.2.3.3" xref="S3.E9.m1.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.2.2.1.1.1.2.3" xref="S3.E9.m1.2.2.1.1.1.2.3.cmml">L</mi></munderover><mrow id="S3.E9.m1.2.2.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.cmml"><mi id="S3.E9.m1.2.2.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.1.3.cmml">𝔼</mi><mo id="S3.E9.m1.2.2.1.1.1.1.2" xref="S3.E9.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.2.2.1.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S3.E9.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E9.m1.2.2.1.1.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝚪</mi><mi id="S3.E9.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S3.E9.m1.2.2.1.1.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.1.1.2.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">𝒢</mi><mo id="S3.E9.m1.2.2.1.1.1.1.1.1.4" stretchy="false" xref="S3.E9.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E9.m1.2.2.1.2" lspace="0em" xref="S3.E9.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.2b"><apply id="S3.E9.m1.2.2.1.1.cmml" xref="S3.E9.m1.2.2.1"><eq id="S3.E9.m1.2.2.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.2"></eq><apply id="S3.E9.m1.2.2.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.3.1.cmml" xref="S3.E9.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E9.m1.2.2.1.1.3.2.cmml" xref="S3.E9.m1.2.2.1.1.3.2">ℒ</ci><apply id="S3.E9.m1.2.2.1.1.3.3.cmml" xref="S3.E9.m1.2.2.1.1.3.3"><times id="S3.E9.m1.2.2.1.1.3.3.1.cmml" xref="S3.E9.m1.2.2.1.1.3.3.1"></times><ci id="S3.E9.m1.2.2.1.1.3.3.2.cmml" xref="S3.E9.m1.2.2.1.1.3.3.2">𝐷</ci><ci id="S3.E9.m1.2.2.1.1.3.3.3.cmml" xref="S3.E9.m1.2.2.1.1.3.3.3">𝑀</ci></apply></apply><apply id="S3.E9.m1.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1"><apply id="S3.E9.m1.2.2.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.1.2.1.cmml" xref="S3.E9.m1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.E9.m1.2.2.1.1.1.2.2.cmml" xref="S3.E9.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.E9.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S3.E9.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.E9.m1.2.2.1.1.1.2.2.2"></sum><apply id="S3.E9.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.E9.m1.2.2.1.1.1.2.2.3"><eq id="S3.E9.m1.2.2.1.1.1.2.2.3.1.cmml" xref="S3.E9.m1.2.2.1.1.1.2.2.3.1"></eq><ci id="S3.E9.m1.2.2.1.1.1.2.2.3.2.cmml" xref="S3.E9.m1.2.2.1.1.1.2.2.3.2">𝑙</ci><cn id="S3.E9.m1.2.2.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E9.m1.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.2.2.1.1.1.2.3.cmml" xref="S3.E9.m1.2.2.1.1.1.2.3">𝐿</ci></apply><apply id="S3.E9.m1.2.2.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1"><times id="S3.E9.m1.2.2.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.2"></times><ci id="S3.E9.m1.2.2.1.1.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.1.1.3">𝔼</ci><list id="S3.E9.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1"><apply id="S3.E9.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.2">𝚪</ci><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.3">𝑙</ci></apply><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">𝒢</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.2c">\mathcal{L}_{DM}=\sum_{l=1}^{L}\mathbb{E}(\bm{\Gamma}_{l};\mathcal{G}).</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_D italic_M end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT blackboard_E ( bold_Γ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ; caligraphic_G ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span><span class="ltx_text ltx_font_italic" id="S3.SS3.1.1">Quantization Calibration: Scale Reparameterization</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">With the synthesized data, it is also crucial to utilize them for accurate quantization calibration. However, the Transformer structure in SAM poses significant challenges for low-bit quantization due to the extreme parameter distributions of its unique components. In particular, LayerNorm activations exhibit severe inter-channel variations, so that sharing a unified quantization scale across all channels leads to crashing quantization performance.
Therefore, we propose a novel quantization strategy, which first computes a unique quantization scale for each channel, and then converts them into a unified scale through mathematical equivalent transformations. This can significantly improve the quantization accuracy while ensuring hardware adaptability.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.14">Specifically, we perform an independent quantization calibration for each channel to obtain the quantization scale <math alttext="\bm{s}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\bm{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">bold_italic_s</annotation></semantics></math> and zero-point <math alttext="\bm{z}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\bm{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">bold_italic_z</annotation></semantics></math>. Here, both <math alttext="\bm{s}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\bm{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">bold_italic_s</annotation></semantics></math> and <math alttext="\bm{z}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\bm{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">bold_italic_z</annotation></semantics></math> are <math alttext="D" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">italic_D</annotation></semantics></math>-dimensional vectors, and <math alttext="D" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><mi id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">italic_D</annotation></semantics></math> is the number of channels in LayerNorm activations. Then, we define the reparameterization procedures <math alttext="\tilde{s}=\text{E}[\bm{s}]" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><mrow id="S3.SS3.p2.7.m7.1.2" xref="S3.SS3.p2.7.m7.1.2.cmml"><mover accent="true" id="S3.SS3.p2.7.m7.1.2.2" xref="S3.SS3.p2.7.m7.1.2.2.cmml"><mi id="S3.SS3.p2.7.m7.1.2.2.2" xref="S3.SS3.p2.7.m7.1.2.2.2.cmml">s</mi><mo id="S3.SS3.p2.7.m7.1.2.2.1" xref="S3.SS3.p2.7.m7.1.2.2.1.cmml">~</mo></mover><mo id="S3.SS3.p2.7.m7.1.2.1" xref="S3.SS3.p2.7.m7.1.2.1.cmml">=</mo><mrow id="S3.SS3.p2.7.m7.1.2.3" xref="S3.SS3.p2.7.m7.1.2.3.cmml"><mtext id="S3.SS3.p2.7.m7.1.2.3.2" xref="S3.SS3.p2.7.m7.1.2.3.2a.cmml">E</mtext><mo id="S3.SS3.p2.7.m7.1.2.3.1" xref="S3.SS3.p2.7.m7.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.7.m7.1.2.3.3.2" xref="S3.SS3.p2.7.m7.1.2.3.3.1.cmml"><mo id="S3.SS3.p2.7.m7.1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p2.7.m7.1.2.3.3.1.1.cmml">[</mo><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">𝒔</mi><mo id="S3.SS3.p2.7.m7.1.2.3.3.2.2" stretchy="false" xref="S3.SS3.p2.7.m7.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.2.cmml" xref="S3.SS3.p2.7.m7.1.2"><eq id="S3.SS3.p2.7.m7.1.2.1.cmml" xref="S3.SS3.p2.7.m7.1.2.1"></eq><apply id="S3.SS3.p2.7.m7.1.2.2.cmml" xref="S3.SS3.p2.7.m7.1.2.2"><ci id="S3.SS3.p2.7.m7.1.2.2.1.cmml" xref="S3.SS3.p2.7.m7.1.2.2.1">~</ci><ci id="S3.SS3.p2.7.m7.1.2.2.2.cmml" xref="S3.SS3.p2.7.m7.1.2.2.2">𝑠</ci></apply><apply id="S3.SS3.p2.7.m7.1.2.3.cmml" xref="S3.SS3.p2.7.m7.1.2.3"><times id="S3.SS3.p2.7.m7.1.2.3.1.cmml" xref="S3.SS3.p2.7.m7.1.2.3.1"></times><ci id="S3.SS3.p2.7.m7.1.2.3.2a.cmml" xref="S3.SS3.p2.7.m7.1.2.3.2"><mtext id="S3.SS3.p2.7.m7.1.2.3.2.cmml" xref="S3.SS3.p2.7.m7.1.2.3.2">E</mtext></ci><apply id="S3.SS3.p2.7.m7.1.2.3.3.1.cmml" xref="S3.SS3.p2.7.m7.1.2.3.3.2"><csymbol cd="latexml" id="S3.SS3.p2.7.m7.1.2.3.3.1.1.cmml" xref="S3.SS3.p2.7.m7.1.2.3.3.2.1">delimited-[]</csymbol><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝒔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">\tilde{s}=\text{E}[\bm{s}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">over~ start_ARG italic_s end_ARG = E [ bold_italic_s ]</annotation></semantics></math> and <math alttext="\tilde{z}=\text{E}[\bm{z}]" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m8.1"><semantics id="S3.SS3.p2.8.m8.1a"><mrow id="S3.SS3.p2.8.m8.1.2" xref="S3.SS3.p2.8.m8.1.2.cmml"><mover accent="true" id="S3.SS3.p2.8.m8.1.2.2" xref="S3.SS3.p2.8.m8.1.2.2.cmml"><mi id="S3.SS3.p2.8.m8.1.2.2.2" xref="S3.SS3.p2.8.m8.1.2.2.2.cmml">z</mi><mo id="S3.SS3.p2.8.m8.1.2.2.1" xref="S3.SS3.p2.8.m8.1.2.2.1.cmml">~</mo></mover><mo id="S3.SS3.p2.8.m8.1.2.1" xref="S3.SS3.p2.8.m8.1.2.1.cmml">=</mo><mrow id="S3.SS3.p2.8.m8.1.2.3" xref="S3.SS3.p2.8.m8.1.2.3.cmml"><mtext id="S3.SS3.p2.8.m8.1.2.3.2" xref="S3.SS3.p2.8.m8.1.2.3.2a.cmml">E</mtext><mo id="S3.SS3.p2.8.m8.1.2.3.1" xref="S3.SS3.p2.8.m8.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.8.m8.1.2.3.3.2" xref="S3.SS3.p2.8.m8.1.2.3.3.1.cmml"><mo id="S3.SS3.p2.8.m8.1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p2.8.m8.1.2.3.3.1.1.cmml">[</mo><mi id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml">𝒛</mi><mo id="S3.SS3.p2.8.m8.1.2.3.3.2.2" stretchy="false" xref="S3.SS3.p2.8.m8.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><apply id="S3.SS3.p2.8.m8.1.2.cmml" xref="S3.SS3.p2.8.m8.1.2"><eq id="S3.SS3.p2.8.m8.1.2.1.cmml" xref="S3.SS3.p2.8.m8.1.2.1"></eq><apply id="S3.SS3.p2.8.m8.1.2.2.cmml" xref="S3.SS3.p2.8.m8.1.2.2"><ci id="S3.SS3.p2.8.m8.1.2.2.1.cmml" xref="S3.SS3.p2.8.m8.1.2.2.1">~</ci><ci id="S3.SS3.p2.8.m8.1.2.2.2.cmml" xref="S3.SS3.p2.8.m8.1.2.2.2">𝑧</ci></apply><apply id="S3.SS3.p2.8.m8.1.2.3.cmml" xref="S3.SS3.p2.8.m8.1.2.3"><times id="S3.SS3.p2.8.m8.1.2.3.1.cmml" xref="S3.SS3.p2.8.m8.1.2.3.1"></times><ci id="S3.SS3.p2.8.m8.1.2.3.2a.cmml" xref="S3.SS3.p2.8.m8.1.2.3.2"><mtext id="S3.SS3.p2.8.m8.1.2.3.2.cmml" xref="S3.SS3.p2.8.m8.1.2.3.2">E</mtext></ci><apply id="S3.SS3.p2.8.m8.1.2.3.3.1.cmml" xref="S3.SS3.p2.8.m8.1.2.3.3.2"><csymbol cd="latexml" id="S3.SS3.p2.8.m8.1.2.3.3.1.1.cmml" xref="S3.SS3.p2.8.m8.1.2.3.3.2.1">delimited-[]</csymbol><ci id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1">𝒛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">\tilde{z}=\text{E}[\bm{z}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m8.1d">over~ start_ARG italic_z end_ARG = E [ bold_italic_z ]</annotation></semantics></math>, where <math alttext="\tilde{s}" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m9.1"><semantics id="S3.SS3.p2.9.m9.1a"><mover accent="true" id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml"><mi id="S3.SS3.p2.9.m9.1.1.2" xref="S3.SS3.p2.9.m9.1.1.2.cmml">s</mi><mo id="S3.SS3.p2.9.m9.1.1.1" xref="S3.SS3.p2.9.m9.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><apply id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1"><ci id="S3.SS3.p2.9.m9.1.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1.1">~</ci><ci id="S3.SS3.p2.9.m9.1.1.2.cmml" xref="S3.SS3.p2.9.m9.1.1.2">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">\tilde{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m9.1d">over~ start_ARG italic_s end_ARG</annotation></semantics></math> and <math alttext="\tilde{z}" class="ltx_Math" display="inline" id="S3.SS3.p2.10.m10.1"><semantics id="S3.SS3.p2.10.m10.1a"><mover accent="true" id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml"><mi id="S3.SS3.p2.10.m10.1.1.2" xref="S3.SS3.p2.10.m10.1.1.2.cmml">z</mi><mo id="S3.SS3.p2.10.m10.1.1.1" xref="S3.SS3.p2.10.m10.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><apply id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1"><ci id="S3.SS3.p2.10.m10.1.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1.1">~</ci><ci id="S3.SS3.p2.10.m10.1.1.2.cmml" xref="S3.SS3.p2.10.m10.1.1.2">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">\tilde{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.10.m10.1d">over~ start_ARG italic_z end_ARG</annotation></semantics></math> are the values to be shared by all channels.
To hold the model output constant after reparameterization, we need to adjust the affine factors <math alttext="\bm{\beta}" class="ltx_Math" display="inline" id="S3.SS3.p2.11.m11.1"><semantics id="S3.SS3.p2.11.m11.1a"><mi id="S3.SS3.p2.11.m11.1.1" xref="S3.SS3.p2.11.m11.1.1.cmml">𝜷</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m11.1b"><ci id="S3.SS3.p2.11.m11.1.1.cmml" xref="S3.SS3.p2.11.m11.1.1">𝜷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m11.1c">\bm{\beta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.11.m11.1d">bold_italic_β</annotation></semantics></math> and <math alttext="\bm{\gamma}" class="ltx_Math" display="inline" id="S3.SS3.p2.12.m12.1"><semantics id="S3.SS3.p2.12.m12.1a"><mi id="S3.SS3.p2.12.m12.1.1" xref="S3.SS3.p2.12.m12.1.1.cmml">𝜸</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m12.1b"><ci id="S3.SS3.p2.12.m12.1.1.cmml" xref="S3.SS3.p2.12.m12.1.1">𝜸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m12.1c">\bm{\gamma}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.12.m12.1d">bold_italic_γ</annotation></semantics></math> in LayerNorm and the next layer’s weights <math alttext="\bm{W}^{qkv}" class="ltx_Math" display="inline" id="S3.SS3.p2.13.m13.1"><semantics id="S3.SS3.p2.13.m13.1a"><msup id="S3.SS3.p2.13.m13.1.1" xref="S3.SS3.p2.13.m13.1.1.cmml"><mi id="S3.SS3.p2.13.m13.1.1.2" xref="S3.SS3.p2.13.m13.1.1.2.cmml">𝑾</mi><mrow id="S3.SS3.p2.13.m13.1.1.3" xref="S3.SS3.p2.13.m13.1.1.3.cmml"><mi id="S3.SS3.p2.13.m13.1.1.3.2" xref="S3.SS3.p2.13.m13.1.1.3.2.cmml">q</mi><mo id="S3.SS3.p2.13.m13.1.1.3.1" xref="S3.SS3.p2.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.13.m13.1.1.3.3" xref="S3.SS3.p2.13.m13.1.1.3.3.cmml">k</mi><mo id="S3.SS3.p2.13.m13.1.1.3.1a" xref="S3.SS3.p2.13.m13.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.13.m13.1.1.3.4" xref="S3.SS3.p2.13.m13.1.1.3.4.cmml">v</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m13.1b"><apply id="S3.SS3.p2.13.m13.1.1.cmml" xref="S3.SS3.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.13.m13.1.1.1.cmml" xref="S3.SS3.p2.13.m13.1.1">superscript</csymbol><ci id="S3.SS3.p2.13.m13.1.1.2.cmml" xref="S3.SS3.p2.13.m13.1.1.2">𝑾</ci><apply id="S3.SS3.p2.13.m13.1.1.3.cmml" xref="S3.SS3.p2.13.m13.1.1.3"><times id="S3.SS3.p2.13.m13.1.1.3.1.cmml" xref="S3.SS3.p2.13.m13.1.1.3.1"></times><ci id="S3.SS3.p2.13.m13.1.1.3.2.cmml" xref="S3.SS3.p2.13.m13.1.1.3.2">𝑞</ci><ci id="S3.SS3.p2.13.m13.1.1.3.3.cmml" xref="S3.SS3.p2.13.m13.1.1.3.3">𝑘</ci><ci id="S3.SS3.p2.13.m13.1.1.3.4.cmml" xref="S3.SS3.p2.13.m13.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m13.1c">\bm{W}^{qkv}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.13.m13.1d">bold_italic_W start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\bm{b}^{qkv}" class="ltx_Math" display="inline" id="S3.SS3.p2.14.m14.1"><semantics id="S3.SS3.p2.14.m14.1a"><msup id="S3.SS3.p2.14.m14.1.1" xref="S3.SS3.p2.14.m14.1.1.cmml"><mi id="S3.SS3.p2.14.m14.1.1.2" xref="S3.SS3.p2.14.m14.1.1.2.cmml">𝒃</mi><mrow id="S3.SS3.p2.14.m14.1.1.3" xref="S3.SS3.p2.14.m14.1.1.3.cmml"><mi id="S3.SS3.p2.14.m14.1.1.3.2" xref="S3.SS3.p2.14.m14.1.1.3.2.cmml">q</mi><mo id="S3.SS3.p2.14.m14.1.1.3.1" xref="S3.SS3.p2.14.m14.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.14.m14.1.1.3.3" xref="S3.SS3.p2.14.m14.1.1.3.3.cmml">k</mi><mo id="S3.SS3.p2.14.m14.1.1.3.1a" xref="S3.SS3.p2.14.m14.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.14.m14.1.1.3.4" xref="S3.SS3.p2.14.m14.1.1.3.4.cmml">v</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m14.1b"><apply id="S3.SS3.p2.14.m14.1.1.cmml" xref="S3.SS3.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.14.m14.1.1.1.cmml" xref="S3.SS3.p2.14.m14.1.1">superscript</csymbol><ci id="S3.SS3.p2.14.m14.1.1.2.cmml" xref="S3.SS3.p2.14.m14.1.1.2">𝒃</ci><apply id="S3.SS3.p2.14.m14.1.1.3.cmml" xref="S3.SS3.p2.14.m14.1.1.3"><times id="S3.SS3.p2.14.m14.1.1.3.1.cmml" xref="S3.SS3.p2.14.m14.1.1.3.1"></times><ci id="S3.SS3.p2.14.m14.1.1.3.2.cmml" xref="S3.SS3.p2.14.m14.1.1.3.2">𝑞</ci><ci id="S3.SS3.p2.14.m14.1.1.3.3.cmml" xref="S3.SS3.p2.14.m14.1.1.3.3">𝑘</ci><ci id="S3.SS3.p2.14.m14.1.1.3.4.cmml" xref="S3.SS3.p2.14.m14.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m14.1c">\bm{b}^{qkv}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.14.m14.1d">bold_italic_b start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT</annotation></semantics></math> as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx1">
<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\left\{\begin{aligned} \widetilde{\bm{\beta}}&amp;=(\bm{\beta}+\bm{s}%
\odot\bm{r}_{2})/\bm{r}_{1}\\
\widetilde{\bm{\gamma}}&amp;=\bm{\gamma}/{\bm{r}_{1}}\\
\widetilde{\bm{W}}^{qkv}_{:,j}&amp;=\bm{r}_{1}\odot\bm{W}^{qkv}_{:,j}\\
\widetilde{\bm{b}}^{qkv}_{j}&amp;=\bm{b}^{qkv}_{j}-(\bm{s}\odot\bm{r}_{2})\bm{W}^{%
qkv}_{:,j}\end{aligned}\right." class="ltx_math_unparsed" display="inline" id="S3.E10.m1.8"><semantics id="S3.E10.m1.8a"><mrow id="S3.E10.m1.8b"><mo id="S3.E10.m1.8.9">{</mo><mtable columnspacing="0pt" id="S3.E10.m1.8.8" rowspacing="0pt"><mtr id="S3.E10.m1.8.8a"><mtd class="ltx_align_right" columnalign="right" id="S3.E10.m1.8.8b"><mover accent="true" id="S3.E10.m1.1.1.1.2.1"><mi id="S3.E10.m1.1.1.1.2.1.2">𝜷</mi><mo id="S3.E10.m1.1.1.1.2.1.1">~</mo></mover></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.8.8c"><mrow id="S3.E10.m1.1.1.1.1.1"><mi id="S3.E10.m1.1.1.1.1.1.3"></mi><mo id="S3.E10.m1.1.1.1.1.1.2">=</mo><mrow id="S3.E10.m1.1.1.1.1.1.1"><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1"><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1.1"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.2">𝜷</mi><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1.1">+</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.2">𝒔</mi><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em">⊙</mo><msub id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.2">𝒓</mi><mn id="S3.E10.m1.1.1.1.1.1.1.1.1.1.3.3.3">2</mn></msub></mrow></mrow><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.3" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.1.1.1.1.1.1.2">/</mo><msub id="S3.E10.m1.1.1.1.1.1.1.3"><mi id="S3.E10.m1.1.1.1.1.1.1.3.2">𝒓</mi><mn id="S3.E10.m1.1.1.1.1.1.1.3.3">1</mn></msub></mrow></mrow></mtd></mtr><mtr id="S3.E10.m1.8.8d"><mtd class="ltx_align_right" columnalign="right" id="S3.E10.m1.8.8e"><mover accent="true" id="S3.E10.m1.8.8.9.1.1"><mi id="S3.E10.m1.8.8.9.1.1.2">𝜸</mi><mo id="S3.E10.m1.8.8.9.1.1.1">~</mo></mover></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.8.8f"><mrow id="S3.E10.m1.8.8.9.2.1"><mi id="S3.E10.m1.8.8.9.2.1.2"></mi><mo id="S3.E10.m1.8.8.9.2.1.1">=</mo><mrow id="S3.E10.m1.8.8.9.2.1.3"><mi id="S3.E10.m1.8.8.9.2.1.3.2">𝜸</mi><mo id="S3.E10.m1.8.8.9.2.1.3.1">/</mo><msub id="S3.E10.m1.8.8.9.2.1.3.3"><mi id="S3.E10.m1.8.8.9.2.1.3.3.2">𝒓</mi><mn id="S3.E10.m1.8.8.9.2.1.3.3.3">1</mn></msub></mrow></mrow></mtd></mtr><mtr id="S3.E10.m1.8.8g"><mtd class="ltx_align_right" columnalign="right" id="S3.E10.m1.8.8h"><msubsup id="S3.E10.m1.3.3.3.2.2"><mover accent="true" id="S3.E10.m1.3.3.3.2.2.4.2"><mi id="S3.E10.m1.3.3.3.2.2.4.2.2">𝑾</mi><mo id="S3.E10.m1.3.3.3.2.2.4.2.1">~</mo></mover><mrow id="S3.E10.m1.3.3.3.2.2.2.2.4"><mo id="S3.E10.m1.2.2.2.1.1.1.1.1" rspace="0em">:</mo><mo id="S3.E10.m1.3.3.3.2.2.2.2.4.1">,</mo><mi id="S3.E10.m1.3.3.3.2.2.2.2.2">j</mi></mrow><mrow id="S3.E10.m1.3.3.3.2.2.4.3"><mi id="S3.E10.m1.3.3.3.2.2.4.3.2">q</mi><mo id="S3.E10.m1.3.3.3.2.2.4.3.1">⁢</mo><mi id="S3.E10.m1.3.3.3.2.2.4.3.3">k</mi><mo id="S3.E10.m1.3.3.3.2.2.4.3.1a">⁢</mo><mi id="S3.E10.m1.3.3.3.2.2.4.3.4">v</mi></mrow></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.8.8i"><mrow id="S3.E10.m1.5.5.5.4.2"><mi id="S3.E10.m1.5.5.5.4.2.4"></mi><mo id="S3.E10.m1.5.5.5.4.2.3">=</mo><mrow id="S3.E10.m1.5.5.5.4.2.5"><msub id="S3.E10.m1.5.5.5.4.2.5.2"><mi id="S3.E10.m1.5.5.5.4.2.5.2.2">𝒓</mi><mn id="S3.E10.m1.5.5.5.4.2.5.2.3">1</mn></msub><mo id="S3.E10.m1.5.5.5.4.2.5.1" lspace="0.222em" rspace="0.222em">⊙</mo><msubsup id="S3.E10.m1.5.5.5.4.2.5.3"><mi id="S3.E10.m1.5.5.5.4.2.5.3.2.2">𝑾</mi><mrow id="S3.E10.m1.5.5.5.4.2.2.2.4"><mo id="S3.E10.m1.4.4.4.3.1.1.1.1" rspace="0em">:</mo><mo id="S3.E10.m1.5.5.5.4.2.2.2.4.1">,</mo><mi id="S3.E10.m1.5.5.5.4.2.2.2.2">j</mi></mrow><mrow id="S3.E10.m1.5.5.5.4.2.5.3.2.3"><mi id="S3.E10.m1.5.5.5.4.2.5.3.2.3.2">q</mi><mo id="S3.E10.m1.5.5.5.4.2.5.3.2.3.1">⁢</mo><mi id="S3.E10.m1.5.5.5.4.2.5.3.2.3.3">k</mi><mo id="S3.E10.m1.5.5.5.4.2.5.3.2.3.1a">⁢</mo><mi id="S3.E10.m1.5.5.5.4.2.5.3.2.3.4">v</mi></mrow></msubsup></mrow></mrow></mtd></mtr><mtr id="S3.E10.m1.8.8j"><mtd class="ltx_align_right" columnalign="right" id="S3.E10.m1.8.8k"><msubsup id="S3.E10.m1.8.8.8.4.1"><mover accent="true" id="S3.E10.m1.8.8.8.4.1.2.2"><mi id="S3.E10.m1.8.8.8.4.1.2.2.2">𝒃</mi><mo id="S3.E10.m1.8.8.8.4.1.2.2.1">~</mo></mover><mi id="S3.E10.m1.8.8.8.4.1.3">j</mi><mrow id="S3.E10.m1.8.8.8.4.1.2.3"><mi id="S3.E10.m1.8.8.8.4.1.2.3.2">q</mi><mo id="S3.E10.m1.8.8.8.4.1.2.3.1">⁢</mo><mi id="S3.E10.m1.8.8.8.4.1.2.3.3">k</mi><mo id="S3.E10.m1.8.8.8.4.1.2.3.1a">⁢</mo><mi id="S3.E10.m1.8.8.8.4.1.2.3.4">v</mi></mrow></msubsup></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.8.8l"><mrow id="S3.E10.m1.8.8.8.3.3"><mi id="S3.E10.m1.8.8.8.3.3.5"></mi><mo id="S3.E10.m1.8.8.8.3.3.4">=</mo><mrow id="S3.E10.m1.8.8.8.3.3.3"><msubsup id="S3.E10.m1.8.8.8.3.3.3.3"><mi id="S3.E10.m1.8.8.8.3.3.3.3.2.2">𝒃</mi><mi id="S3.E10.m1.8.8.8.3.3.3.3.3">j</mi><mrow id="S3.E10.m1.8.8.8.3.3.3.3.2.3"><mi id="S3.E10.m1.8.8.8.3.3.3.3.2.3.2">q</mi><mo id="S3.E10.m1.8.8.8.3.3.3.3.2.3.1">⁢</mo><mi id="S3.E10.m1.8.8.8.3.3.3.3.2.3.3">k</mi><mo id="S3.E10.m1.8.8.8.3.3.3.3.2.3.1a">⁢</mo><mi id="S3.E10.m1.8.8.8.3.3.3.3.2.3.4">v</mi></mrow></msubsup><mo id="S3.E10.m1.8.8.8.3.3.3.2">−</mo><mrow id="S3.E10.m1.8.8.8.3.3.3.1"><mrow id="S3.E10.m1.8.8.8.3.3.3.1.1.1"><mo id="S3.E10.m1.8.8.8.3.3.3.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E10.m1.8.8.8.3.3.3.1.1.1.1"><mi id="S3.E10.m1.8.8.8.3.3.3.1.1.1.1.2">𝒔</mi><mo id="S3.E10.m1.8.8.8.3.3.3.1.1.1.1.1" lspace="0.222em" rspace="0.222em">⊙</mo><msub id="S3.E10.m1.8.8.8.3.3.3.1.1.1.1.3"><mi id="S3.E10.m1.8.8.8.3.3.3.1.1.1.1.3.2">𝒓</mi><mn id="S3.E10.m1.8.8.8.3.3.3.1.1.1.1.3.3">2</mn></msub></mrow><mo id="S3.E10.m1.8.8.8.3.3.3.1.1.1.3" stretchy="false">)</mo></mrow><mo id="S3.E10.m1.8.8.8.3.3.3.1.2">⁢</mo><msubsup id="S3.E10.m1.8.8.8.3.3.3.1.3"><mi id="S3.E10.m1.8.8.8.3.3.3.1.3.2.2">𝑾</mi><mrow id="S3.E10.m1.7.7.7.2.2.2.2.4"><mo id="S3.E10.m1.6.6.6.1.1.1.1.1" rspace="0em">:</mo><mo id="S3.E10.m1.7.7.7.2.2.2.2.4.1">,</mo><mi id="S3.E10.m1.7.7.7.2.2.2.2.2">j</mi></mrow><mrow id="S3.E10.m1.8.8.8.3.3.3.1.3.2.3"><mi id="S3.E10.m1.8.8.8.3.3.3.1.3.2.3.2">q</mi><mo id="S3.E10.m1.8.8.8.3.3.3.1.3.2.3.1">⁢</mo><mi id="S3.E10.m1.8.8.8.3.3.3.1.3.2.3.3">k</mi><mo id="S3.E10.m1.8.8.8.3.3.3.1.3.2.3.1a">⁢</mo><mi id="S3.E10.m1.8.8.8.3.3.3.1.3.2.3.4">v</mi></mrow></msubsup></mrow></mrow></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex" id="S3.E10.m1.8c">\displaystyle\left\{\begin{aligned} \widetilde{\bm{\beta}}&amp;=(\bm{\beta}+\bm{s}%
\odot\bm{r}_{2})/\bm{r}_{1}\\
\widetilde{\bm{\gamma}}&amp;=\bm{\gamma}/{\bm{r}_{1}}\\
\widetilde{\bm{W}}^{qkv}_{:,j}&amp;=\bm{r}_{1}\odot\bm{W}^{qkv}_{:,j}\\
\widetilde{\bm{b}}^{qkv}_{j}&amp;=\bm{b}^{qkv}_{j}-(\bm{s}\odot\bm{r}_{2})\bm{W}^{%
qkv}_{:,j}\end{aligned}\right.</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.8d">{ start_ROW start_CELL over~ start_ARG bold_italic_β end_ARG end_CELL start_CELL = ( bold_italic_β + bold_italic_s ⊙ bold_italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) / bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL over~ start_ARG bold_italic_γ end_ARG end_CELL start_CELL = bold_italic_γ / bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL over~ start_ARG bold_italic_W end_ARG start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT : , italic_j end_POSTSUBSCRIPT end_CELL start_CELL = bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊙ bold_italic_W start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT : , italic_j end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL over~ start_ARG bold_italic_b end_ARG start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_CELL start_CELL = bold_italic_b start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - ( bold_italic_s ⊙ bold_italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) bold_italic_W start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT : , italic_j end_POSTSUBSCRIPT end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.23">where <math alttext="\bm{r}_{1}=\bm{s}/\tilde{\bm{s}}" class="ltx_Math" display="inline" id="S3.SS3.p2.15.m1.1"><semantics id="S3.SS3.p2.15.m1.1a"><mrow id="S3.SS3.p2.15.m1.1.1" xref="S3.SS3.p2.15.m1.1.1.cmml"><msub id="S3.SS3.p2.15.m1.1.1.2" xref="S3.SS3.p2.15.m1.1.1.2.cmml"><mi id="S3.SS3.p2.15.m1.1.1.2.2" xref="S3.SS3.p2.15.m1.1.1.2.2.cmml">𝒓</mi><mn id="S3.SS3.p2.15.m1.1.1.2.3" xref="S3.SS3.p2.15.m1.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS3.p2.15.m1.1.1.1" xref="S3.SS3.p2.15.m1.1.1.1.cmml">=</mo><mrow id="S3.SS3.p2.15.m1.1.1.3" xref="S3.SS3.p2.15.m1.1.1.3.cmml"><mi id="S3.SS3.p2.15.m1.1.1.3.2" xref="S3.SS3.p2.15.m1.1.1.3.2.cmml">𝒔</mi><mo id="S3.SS3.p2.15.m1.1.1.3.1" xref="S3.SS3.p2.15.m1.1.1.3.1.cmml">/</mo><mover accent="true" id="S3.SS3.p2.15.m1.1.1.3.3" xref="S3.SS3.p2.15.m1.1.1.3.3.cmml"><mi id="S3.SS3.p2.15.m1.1.1.3.3.2" xref="S3.SS3.p2.15.m1.1.1.3.3.2.cmml">𝒔</mi><mo id="S3.SS3.p2.15.m1.1.1.3.3.1" xref="S3.SS3.p2.15.m1.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.15.m1.1b"><apply id="S3.SS3.p2.15.m1.1.1.cmml" xref="S3.SS3.p2.15.m1.1.1"><eq id="S3.SS3.p2.15.m1.1.1.1.cmml" xref="S3.SS3.p2.15.m1.1.1.1"></eq><apply id="S3.SS3.p2.15.m1.1.1.2.cmml" xref="S3.SS3.p2.15.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.15.m1.1.1.2.1.cmml" xref="S3.SS3.p2.15.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.15.m1.1.1.2.2.cmml" xref="S3.SS3.p2.15.m1.1.1.2.2">𝒓</ci><cn id="S3.SS3.p2.15.m1.1.1.2.3.cmml" type="integer" xref="S3.SS3.p2.15.m1.1.1.2.3">1</cn></apply><apply id="S3.SS3.p2.15.m1.1.1.3.cmml" xref="S3.SS3.p2.15.m1.1.1.3"><divide id="S3.SS3.p2.15.m1.1.1.3.1.cmml" xref="S3.SS3.p2.15.m1.1.1.3.1"></divide><ci id="S3.SS3.p2.15.m1.1.1.3.2.cmml" xref="S3.SS3.p2.15.m1.1.1.3.2">𝒔</ci><apply id="S3.SS3.p2.15.m1.1.1.3.3.cmml" xref="S3.SS3.p2.15.m1.1.1.3.3"><ci id="S3.SS3.p2.15.m1.1.1.3.3.1.cmml" xref="S3.SS3.p2.15.m1.1.1.3.3.1">~</ci><ci id="S3.SS3.p2.15.m1.1.1.3.3.2.cmml" xref="S3.SS3.p2.15.m1.1.1.3.3.2">𝒔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.15.m1.1c">\bm{r}_{1}=\bm{s}/\tilde{\bm{s}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.15.m1.1d">bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = bold_italic_s / over~ start_ARG bold_italic_s end_ARG</annotation></semantics></math> and <math alttext="\bm{r}_{2}=\bm{z}-\tilde{\bm{z}}" class="ltx_Math" display="inline" id="S3.SS3.p2.16.m2.1"><semantics id="S3.SS3.p2.16.m2.1a"><mrow id="S3.SS3.p2.16.m2.1.1" xref="S3.SS3.p2.16.m2.1.1.cmml"><msub id="S3.SS3.p2.16.m2.1.1.2" xref="S3.SS3.p2.16.m2.1.1.2.cmml"><mi id="S3.SS3.p2.16.m2.1.1.2.2" xref="S3.SS3.p2.16.m2.1.1.2.2.cmml">𝒓</mi><mn id="S3.SS3.p2.16.m2.1.1.2.3" xref="S3.SS3.p2.16.m2.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS3.p2.16.m2.1.1.1" xref="S3.SS3.p2.16.m2.1.1.1.cmml">=</mo><mrow id="S3.SS3.p2.16.m2.1.1.3" xref="S3.SS3.p2.16.m2.1.1.3.cmml"><mi id="S3.SS3.p2.16.m2.1.1.3.2" xref="S3.SS3.p2.16.m2.1.1.3.2.cmml">𝒛</mi><mo id="S3.SS3.p2.16.m2.1.1.3.1" xref="S3.SS3.p2.16.m2.1.1.3.1.cmml">−</mo><mover accent="true" id="S3.SS3.p2.16.m2.1.1.3.3" xref="S3.SS3.p2.16.m2.1.1.3.3.cmml"><mi id="S3.SS3.p2.16.m2.1.1.3.3.2" xref="S3.SS3.p2.16.m2.1.1.3.3.2.cmml">𝒛</mi><mo id="S3.SS3.p2.16.m2.1.1.3.3.1" xref="S3.SS3.p2.16.m2.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.16.m2.1b"><apply id="S3.SS3.p2.16.m2.1.1.cmml" xref="S3.SS3.p2.16.m2.1.1"><eq id="S3.SS3.p2.16.m2.1.1.1.cmml" xref="S3.SS3.p2.16.m2.1.1.1"></eq><apply id="S3.SS3.p2.16.m2.1.1.2.cmml" xref="S3.SS3.p2.16.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.16.m2.1.1.2.1.cmml" xref="S3.SS3.p2.16.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.16.m2.1.1.2.2.cmml" xref="S3.SS3.p2.16.m2.1.1.2.2">𝒓</ci><cn id="S3.SS3.p2.16.m2.1.1.2.3.cmml" type="integer" xref="S3.SS3.p2.16.m2.1.1.2.3">2</cn></apply><apply id="S3.SS3.p2.16.m2.1.1.3.cmml" xref="S3.SS3.p2.16.m2.1.1.3"><minus id="S3.SS3.p2.16.m2.1.1.3.1.cmml" xref="S3.SS3.p2.16.m2.1.1.3.1"></minus><ci id="S3.SS3.p2.16.m2.1.1.3.2.cmml" xref="S3.SS3.p2.16.m2.1.1.3.2">𝒛</ci><apply id="S3.SS3.p2.16.m2.1.1.3.3.cmml" xref="S3.SS3.p2.16.m2.1.1.3.3"><ci id="S3.SS3.p2.16.m2.1.1.3.3.1.cmml" xref="S3.SS3.p2.16.m2.1.1.3.3.1">~</ci><ci id="S3.SS3.p2.16.m2.1.1.3.3.2.cmml" xref="S3.SS3.p2.16.m2.1.1.3.3.2">𝒛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.16.m2.1c">\bm{r}_{2}=\bm{z}-\tilde{\bm{z}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.16.m2.1d">bold_italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = bold_italic_z - over~ start_ARG bold_italic_z end_ARG</annotation></semantics></math> are the variation factors, <math alttext="j\in\{1,\cdots,D^{\prime}\}" class="ltx_Math" display="inline" id="S3.SS3.p2.17.m3.3"><semantics id="S3.SS3.p2.17.m3.3a"><mrow id="S3.SS3.p2.17.m3.3.3" xref="S3.SS3.p2.17.m3.3.3.cmml"><mi id="S3.SS3.p2.17.m3.3.3.3" xref="S3.SS3.p2.17.m3.3.3.3.cmml">j</mi><mo id="S3.SS3.p2.17.m3.3.3.2" xref="S3.SS3.p2.17.m3.3.3.2.cmml">∈</mo><mrow id="S3.SS3.p2.17.m3.3.3.1.1" xref="S3.SS3.p2.17.m3.3.3.1.2.cmml"><mo id="S3.SS3.p2.17.m3.3.3.1.1.2" stretchy="false" xref="S3.SS3.p2.17.m3.3.3.1.2.cmml">{</mo><mn id="S3.SS3.p2.17.m3.1.1" xref="S3.SS3.p2.17.m3.1.1.cmml">1</mn><mo id="S3.SS3.p2.17.m3.3.3.1.1.3" xref="S3.SS3.p2.17.m3.3.3.1.2.cmml">,</mo><mi id="S3.SS3.p2.17.m3.2.2" mathvariant="normal" xref="S3.SS3.p2.17.m3.2.2.cmml">⋯</mi><mo id="S3.SS3.p2.17.m3.3.3.1.1.4" xref="S3.SS3.p2.17.m3.3.3.1.2.cmml">,</mo><msup id="S3.SS3.p2.17.m3.3.3.1.1.1" xref="S3.SS3.p2.17.m3.3.3.1.1.1.cmml"><mi id="S3.SS3.p2.17.m3.3.3.1.1.1.2" xref="S3.SS3.p2.17.m3.3.3.1.1.1.2.cmml">D</mi><mo id="S3.SS3.p2.17.m3.3.3.1.1.1.3" xref="S3.SS3.p2.17.m3.3.3.1.1.1.3.cmml">′</mo></msup><mo id="S3.SS3.p2.17.m3.3.3.1.1.5" stretchy="false" xref="S3.SS3.p2.17.m3.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.17.m3.3b"><apply id="S3.SS3.p2.17.m3.3.3.cmml" xref="S3.SS3.p2.17.m3.3.3"><in id="S3.SS3.p2.17.m3.3.3.2.cmml" xref="S3.SS3.p2.17.m3.3.3.2"></in><ci id="S3.SS3.p2.17.m3.3.3.3.cmml" xref="S3.SS3.p2.17.m3.3.3.3">𝑗</ci><set id="S3.SS3.p2.17.m3.3.3.1.2.cmml" xref="S3.SS3.p2.17.m3.3.3.1.1"><cn id="S3.SS3.p2.17.m3.1.1.cmml" type="integer" xref="S3.SS3.p2.17.m3.1.1">1</cn><ci id="S3.SS3.p2.17.m3.2.2.cmml" xref="S3.SS3.p2.17.m3.2.2">⋯</ci><apply id="S3.SS3.p2.17.m3.3.3.1.1.1.cmml" xref="S3.SS3.p2.17.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.17.m3.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.17.m3.3.3.1.1.1">superscript</csymbol><ci id="S3.SS3.p2.17.m3.3.3.1.1.1.2.cmml" xref="S3.SS3.p2.17.m3.3.3.1.1.1.2">𝐷</ci><ci id="S3.SS3.p2.17.m3.3.3.1.1.1.3.cmml" xref="S3.SS3.p2.17.m3.3.3.1.1.1.3">′</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.17.m3.3c">j\in\{1,\cdots,D^{\prime}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.17.m3.3d">italic_j ∈ { 1 , ⋯ , italic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT }</annotation></semantics></math>, and <math alttext="D^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.p2.18.m4.1"><semantics id="S3.SS3.p2.18.m4.1a"><msup id="S3.SS3.p2.18.m4.1.1" xref="S3.SS3.p2.18.m4.1.1.cmml"><mi id="S3.SS3.p2.18.m4.1.1.2" xref="S3.SS3.p2.18.m4.1.1.2.cmml">D</mi><mo id="S3.SS3.p2.18.m4.1.1.3" xref="S3.SS3.p2.18.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.18.m4.1b"><apply id="S3.SS3.p2.18.m4.1.1.cmml" xref="S3.SS3.p2.18.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.18.m4.1.1.1.cmml" xref="S3.SS3.p2.18.m4.1.1">superscript</csymbol><ci id="S3.SS3.p2.18.m4.1.1.2.cmml" xref="S3.SS3.p2.18.m4.1.1.2">𝐷</ci><ci id="S3.SS3.p2.18.m4.1.1.3.cmml" xref="S3.SS3.p2.18.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.18.m4.1c">D^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.18.m4.1d">italic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is the number of channels in <math alttext="\bm{W}^{qkv}" class="ltx_Math" display="inline" id="S3.SS3.p2.19.m5.1"><semantics id="S3.SS3.p2.19.m5.1a"><msup id="S3.SS3.p2.19.m5.1.1" xref="S3.SS3.p2.19.m5.1.1.cmml"><mi id="S3.SS3.p2.19.m5.1.1.2" xref="S3.SS3.p2.19.m5.1.1.2.cmml">𝑾</mi><mrow id="S3.SS3.p2.19.m5.1.1.3" xref="S3.SS3.p2.19.m5.1.1.3.cmml"><mi id="S3.SS3.p2.19.m5.1.1.3.2" xref="S3.SS3.p2.19.m5.1.1.3.2.cmml">q</mi><mo id="S3.SS3.p2.19.m5.1.1.3.1" xref="S3.SS3.p2.19.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.19.m5.1.1.3.3" xref="S3.SS3.p2.19.m5.1.1.3.3.cmml">k</mi><mo id="S3.SS3.p2.19.m5.1.1.3.1a" xref="S3.SS3.p2.19.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.19.m5.1.1.3.4" xref="S3.SS3.p2.19.m5.1.1.3.4.cmml">v</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.19.m5.1b"><apply id="S3.SS3.p2.19.m5.1.1.cmml" xref="S3.SS3.p2.19.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.19.m5.1.1.1.cmml" xref="S3.SS3.p2.19.m5.1.1">superscript</csymbol><ci id="S3.SS3.p2.19.m5.1.1.2.cmml" xref="S3.SS3.p2.19.m5.1.1.2">𝑾</ci><apply id="S3.SS3.p2.19.m5.1.1.3.cmml" xref="S3.SS3.p2.19.m5.1.1.3"><times id="S3.SS3.p2.19.m5.1.1.3.1.cmml" xref="S3.SS3.p2.19.m5.1.1.3.1"></times><ci id="S3.SS3.p2.19.m5.1.1.3.2.cmml" xref="S3.SS3.p2.19.m5.1.1.3.2">𝑞</ci><ci id="S3.SS3.p2.19.m5.1.1.3.3.cmml" xref="S3.SS3.p2.19.m5.1.1.3.3">𝑘</ci><ci id="S3.SS3.p2.19.m5.1.1.3.4.cmml" xref="S3.SS3.p2.19.m5.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.19.m5.1c">\bm{W}^{qkv}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.19.m5.1d">bold_italic_W start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT</annotation></semantics></math>.
Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E10" title="In 3.3 Quantization Calibration: Scale Reparameterization ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">10</span></a> can realize equivalent transformations from <math alttext="\bm{s}" class="ltx_Math" display="inline" id="S3.SS3.p2.20.m6.1"><semantics id="S3.SS3.p2.20.m6.1a"><mi id="S3.SS3.p2.20.m6.1.1" xref="S3.SS3.p2.20.m6.1.1.cmml">𝒔</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.20.m6.1b"><ci id="S3.SS3.p2.20.m6.1.1.cmml" xref="S3.SS3.p2.20.m6.1.1">𝒔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.20.m6.1c">\bm{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.20.m6.1d">bold_italic_s</annotation></semantics></math> and <math alttext="\bm{z}" class="ltx_Math" display="inline" id="S3.SS3.p2.21.m7.1"><semantics id="S3.SS3.p2.21.m7.1a"><mi id="S3.SS3.p2.21.m7.1.1" xref="S3.SS3.p2.21.m7.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.21.m7.1b"><ci id="S3.SS3.p2.21.m7.1.1.cmml" xref="S3.SS3.p2.21.m7.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.21.m7.1c">\bm{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.21.m7.1d">bold_italic_z</annotation></semantics></math> to <math alttext="\tilde{s}" class="ltx_Math" display="inline" id="S3.SS3.p2.22.m8.1"><semantics id="S3.SS3.p2.22.m8.1a"><mover accent="true" id="S3.SS3.p2.22.m8.1.1" xref="S3.SS3.p2.22.m8.1.1.cmml"><mi id="S3.SS3.p2.22.m8.1.1.2" xref="S3.SS3.p2.22.m8.1.1.2.cmml">s</mi><mo id="S3.SS3.p2.22.m8.1.1.1" xref="S3.SS3.p2.22.m8.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.22.m8.1b"><apply id="S3.SS3.p2.22.m8.1.1.cmml" xref="S3.SS3.p2.22.m8.1.1"><ci id="S3.SS3.p2.22.m8.1.1.1.cmml" xref="S3.SS3.p2.22.m8.1.1.1">~</ci><ci id="S3.SS3.p2.22.m8.1.1.2.cmml" xref="S3.SS3.p2.22.m8.1.1.2">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.22.m8.1c">\tilde{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.22.m8.1d">over~ start_ARG italic_s end_ARG</annotation></semantics></math> and <math alttext="\tilde{z}" class="ltx_Math" display="inline" id="S3.SS3.p2.23.m9.1"><semantics id="S3.SS3.p2.23.m9.1a"><mover accent="true" id="S3.SS3.p2.23.m9.1.1" xref="S3.SS3.p2.23.m9.1.1.cmml"><mi id="S3.SS3.p2.23.m9.1.1.2" xref="S3.SS3.p2.23.m9.1.1.2.cmml">z</mi><mo id="S3.SS3.p2.23.m9.1.1.1" xref="S3.SS3.p2.23.m9.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.23.m9.1b"><apply id="S3.SS3.p2.23.m9.1.1.cmml" xref="S3.SS3.p2.23.m9.1.1"><ci id="S3.SS3.p2.23.m9.1.1.1.cmml" xref="S3.SS3.p2.23.m9.1.1.1">~</ci><ci id="S3.SS3.p2.23.m9.1.1.2.cmml" xref="S3.SS3.p2.23.m9.1.1.2">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.23.m9.1c">\tilde{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.23.m9.1d">over~ start_ARG italic_z end_ARG</annotation></semantics></math> while maintaining the model output the same.
Note that the equivalent transformations are proposed in our preliminary work RepQ-ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib24" title="">24</a>]</cite>, and the details of the derivation are in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A1.SS2" title="A.2 RepQ-ViT: Scale Reparameterization ‣ Appendix A Our preliminary efforts for DFQ-SAM ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">A.2</span></a>.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="alg1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg1.18">
<div class="ltx_listingline" id="alg1.1.1">
<span class="ltx_text" id="alg1.1.1.1" style="font-size:90%;">
<span class="ltx_text" id="alg1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="alg1.1.1.1.1.1">Input:</span> </span>Pre-trained SAM <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="alg1.1.1.1.m1.1"><semantics id="alg1.1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.1.1.1.m1.1.1" xref="alg1.1.1.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="alg1.1.1.1.m1.1b"><ci id="alg1.1.1.1.m1.1.1.cmml" xref="alg1.1.1.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.1.m1.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="alg1.1.1.1.m1.1d">caligraphic_P</annotation></semantics></math>.</span>
</div>
<div class="ltx_listingline" id="alg1.3.3">
<span class="ltx_text" id="alg1.3.3.1" style="font-size:90%;">
</span><span class="ltx_text" id="alg1.3.3.2" style="font-size:90%;"><span class="ltx_text ltx_font_bold" id="alg1.3.3.2.1">Output:</span> </span><span class="ltx_text" id="alg1.3.3.3" style="font-size:90%;">Synthesized images </span><math alttext="I_{S}" class="ltx_Math" display="inline" id="alg1.2.2.m1.1"><semantics id="alg1.2.2.m1.1a"><msub id="alg1.2.2.m1.1.1" xref="alg1.2.2.m1.1.1.cmml"><mi id="alg1.2.2.m1.1.1.2" mathsize="90%" xref="alg1.2.2.m1.1.1.2.cmml">I</mi><mi id="alg1.2.2.m1.1.1.3" mathsize="90%" xref="alg1.2.2.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.2.2.m1.1b"><apply id="alg1.2.2.m1.1.1.cmml" xref="alg1.2.2.m1.1.1"><csymbol cd="ambiguous" id="alg1.2.2.m1.1.1.1.cmml" xref="alg1.2.2.m1.1.1">subscript</csymbol><ci id="alg1.2.2.m1.1.1.2.cmml" xref="alg1.2.2.m1.1.1.2">𝐼</ci><ci id="alg1.2.2.m1.1.1.3.cmml" xref="alg1.2.2.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.m1.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="alg1.2.2.m1.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.3.3.4" style="font-size:90%;">, Quantized SAM </span><math alttext="\mathcal{Q}" class="ltx_Math" display="inline" id="alg1.3.3.m2.1"><semantics id="alg1.3.3.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.3.3.m2.1.1" mathsize="90%" xref="alg1.3.3.m2.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="alg1.3.3.m2.1b"><ci id="alg1.3.3.m2.1.1.cmml" xref="alg1.3.3.m2.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m2.1c">\mathcal{Q}</annotation><annotation encoding="application/x-llamapun" id="alg1.3.3.m2.1d">caligraphic_Q</annotation></semantics></math><span class="ltx_text" id="alg1.3.3.5" style="font-size:90%;">.</span>
</div>
<div class="ltx_listingline" id="alg1.5.5">
<span class="ltx_text" id="alg1.5.5.1" style="font-size:90%;">
Initialize </span><math alttext="I_{S}" class="ltx_Math" display="inline" id="alg1.4.4.m1.1"><semantics id="alg1.4.4.m1.1a"><msub id="alg1.4.4.m1.1.1" xref="alg1.4.4.m1.1.1.cmml"><mi id="alg1.4.4.m1.1.1.2" mathsize="90%" xref="alg1.4.4.m1.1.1.2.cmml">I</mi><mi id="alg1.4.4.m1.1.1.3" mathsize="90%" xref="alg1.4.4.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.4.4.m1.1b"><apply id="alg1.4.4.m1.1.1.cmml" xref="alg1.4.4.m1.1.1"><csymbol cd="ambiguous" id="alg1.4.4.m1.1.1.1.cmml" xref="alg1.4.4.m1.1.1">subscript</csymbol><ci id="alg1.4.4.m1.1.1.2.cmml" xref="alg1.4.4.m1.1.1.2">𝐼</ci><ci id="alg1.4.4.m1.1.1.3.cmml" xref="alg1.4.4.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m1.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="alg1.4.4.m1.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.5.5.2" style="font-size:90%;"> from Gaussian distribution </span><math alttext="\mathcal{N}(0,1)" class="ltx_Math" display="inline" id="alg1.5.5.m2.2"><semantics id="alg1.5.5.m2.2a"><mrow id="alg1.5.5.m2.2.3" xref="alg1.5.5.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.5.5.m2.2.3.2" mathsize="90%" xref="alg1.5.5.m2.2.3.2.cmml">𝒩</mi><mo id="alg1.5.5.m2.2.3.1" xref="alg1.5.5.m2.2.3.1.cmml">⁢</mo><mrow id="alg1.5.5.m2.2.3.3.2" xref="alg1.5.5.m2.2.3.3.1.cmml"><mo id="alg1.5.5.m2.2.3.3.2.1" maxsize="90%" minsize="90%" xref="alg1.5.5.m2.2.3.3.1.cmml">(</mo><mn id="alg1.5.5.m2.1.1" mathsize="90%" xref="alg1.5.5.m2.1.1.cmml">0</mn><mo id="alg1.5.5.m2.2.3.3.2.2" mathsize="90%" xref="alg1.5.5.m2.2.3.3.1.cmml">,</mo><mn id="alg1.5.5.m2.2.2" mathsize="90%" xref="alg1.5.5.m2.2.2.cmml">1</mn><mo id="alg1.5.5.m2.2.3.3.2.3" maxsize="90%" minsize="90%" xref="alg1.5.5.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.5.5.m2.2b"><apply id="alg1.5.5.m2.2.3.cmml" xref="alg1.5.5.m2.2.3"><times id="alg1.5.5.m2.2.3.1.cmml" xref="alg1.5.5.m2.2.3.1"></times><ci id="alg1.5.5.m2.2.3.2.cmml" xref="alg1.5.5.m2.2.3.2">𝒩</ci><interval closure="open" id="alg1.5.5.m2.2.3.3.1.cmml" xref="alg1.5.5.m2.2.3.3.2"><cn id="alg1.5.5.m2.1.1.cmml" type="integer" xref="alg1.5.5.m2.1.1">0</cn><cn id="alg1.5.5.m2.2.2.cmml" type="integer" xref="alg1.5.5.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.m2.2c">\mathcal{N}(0,1)</annotation><annotation encoding="application/x-llamapun" id="alg1.5.5.m2.2d">caligraphic_N ( 0 , 1 )</annotation></semantics></math><span class="ltx_text" id="alg1.5.5.3" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.18.19">
<span class="ltx_text" id="alg1.18.19.1" style="font-size:90%;">
</span><span class="ltx_text" id="alg1.18.19.2" style="font-size:90%;color:#008080;"># <span class="ltx_text ltx_font_bold" id="alg1.18.19.2.1">Stage 1: Image Synthesis</span></span>
</div>
<div class="ltx_listingline" id="alg1.6.6">
<span class="ltx_text" id="alg1.6.6.2" style="font-size:90%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.6.6.3" style="font-size:90%;">for</span><span class="ltx_text" id="alg1.6.6.4" style="font-size:90%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.6.6.1" style="font-size:90%;"><math alttext="t=1,2,\cdots" class="ltx_Math" display="inline" id="alg1.6.6.1.m1.3"><semantics id="alg1.6.6.1.m1.3a"><mrow id="alg1.6.6.1.m1.3.4" xref="alg1.6.6.1.m1.3.4.cmml"><mi id="alg1.6.6.1.m1.3.4.2" xref="alg1.6.6.1.m1.3.4.2.cmml">t</mi><mo id="alg1.6.6.1.m1.3.4.1" xref="alg1.6.6.1.m1.3.4.1.cmml">=</mo><mrow id="alg1.6.6.1.m1.3.4.3.2" xref="alg1.6.6.1.m1.3.4.3.1.cmml"><mn id="alg1.6.6.1.m1.1.1" xref="alg1.6.6.1.m1.1.1.cmml">1</mn><mo id="alg1.6.6.1.m1.3.4.3.2.1" xref="alg1.6.6.1.m1.3.4.3.1.cmml">,</mo><mn id="alg1.6.6.1.m1.2.2" xref="alg1.6.6.1.m1.2.2.cmml">2</mn><mo id="alg1.6.6.1.m1.3.4.3.2.2" xref="alg1.6.6.1.m1.3.4.3.1.cmml">,</mo><mi id="alg1.6.6.1.m1.3.3" mathvariant="normal" xref="alg1.6.6.1.m1.3.3.cmml">⋯</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.6.6.1.m1.3b"><apply id="alg1.6.6.1.m1.3.4.cmml" xref="alg1.6.6.1.m1.3.4"><eq id="alg1.6.6.1.m1.3.4.1.cmml" xref="alg1.6.6.1.m1.3.4.1"></eq><ci id="alg1.6.6.1.m1.3.4.2.cmml" xref="alg1.6.6.1.m1.3.4.2">𝑡</ci><list id="alg1.6.6.1.m1.3.4.3.1.cmml" xref="alg1.6.6.1.m1.3.4.3.2"><cn id="alg1.6.6.1.m1.1.1.cmml" type="integer" xref="alg1.6.6.1.m1.1.1">1</cn><cn id="alg1.6.6.1.m1.2.2.cmml" type="integer" xref="alg1.6.6.1.m1.2.2">2</cn><ci id="alg1.6.6.1.m1.3.3.cmml" xref="alg1.6.6.1.m1.3.3">⋯</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.1.m1.3c">t=1,2,\cdots</annotation><annotation encoding="application/x-llamapun" id="alg1.6.6.1.m1.3d">italic_t = 1 , 2 , ⋯</annotation></semantics></math></em><span class="ltx_text" id="alg1.6.6.5" style="font-size:90%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.6.6.6" style="font-size:90%;">do</span>
</div>
<div class="ltx_listingline" id="alg1.9.9">
<span class="ltx_text" id="alg1.9.9.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.9.9.2" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.9.9.3" style="font-size:90%;">
Input </span><math alttext="I_{S}" class="ltx_Math" display="inline" id="alg1.7.7.m1.1"><semantics id="alg1.7.7.m1.1a"><msub id="alg1.7.7.m1.1.1" xref="alg1.7.7.m1.1.1.cmml"><mi id="alg1.7.7.m1.1.1.2" mathsize="90%" xref="alg1.7.7.m1.1.1.2.cmml">I</mi><mi id="alg1.7.7.m1.1.1.3" mathsize="90%" xref="alg1.7.7.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.7.7.m1.1b"><apply id="alg1.7.7.m1.1.1.cmml" xref="alg1.7.7.m1.1.1"><csymbol cd="ambiguous" id="alg1.7.7.m1.1.1.1.cmml" xref="alg1.7.7.m1.1.1">subscript</csymbol><ci id="alg1.7.7.m1.1.1.2.cmml" xref="alg1.7.7.m1.1.1.2">𝐼</ci><ci id="alg1.7.7.m1.1.1.3.cmml" xref="alg1.7.7.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.m1.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="alg1.7.7.m1.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.9.9.4" style="font-size:90%;"> to </span><math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="alg1.8.8.m2.1"><semantics id="alg1.8.8.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.8.8.m2.1.1" mathsize="90%" xref="alg1.8.8.m2.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="alg1.8.8.m2.1b"><ci id="alg1.8.8.m2.1.1.cmml" xref="alg1.8.8.m2.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.m2.1c">\mathcal{P}</annotation><annotation encoding="application/x-llamapun" id="alg1.8.8.m2.1d">caligraphic_P</annotation></semantics></math><span class="ltx_text" id="alg1.9.9.5" style="font-size:90%;"> and forward propagate </span><math alttext="\mathcal{P}(I_{S})" class="ltx_Math" display="inline" id="alg1.9.9.m3.1"><semantics id="alg1.9.9.m3.1a"><mrow id="alg1.9.9.m3.1.1" xref="alg1.9.9.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.9.9.m3.1.1.3" mathsize="90%" xref="alg1.9.9.m3.1.1.3.cmml">𝒫</mi><mo id="alg1.9.9.m3.1.1.2" xref="alg1.9.9.m3.1.1.2.cmml">⁢</mo><mrow id="alg1.9.9.m3.1.1.1.1" xref="alg1.9.9.m3.1.1.1.1.1.cmml"><mo id="alg1.9.9.m3.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.9.9.m3.1.1.1.1.1.cmml">(</mo><msub id="alg1.9.9.m3.1.1.1.1.1" xref="alg1.9.9.m3.1.1.1.1.1.cmml"><mi id="alg1.9.9.m3.1.1.1.1.1.2" mathsize="90%" xref="alg1.9.9.m3.1.1.1.1.1.2.cmml">I</mi><mi id="alg1.9.9.m3.1.1.1.1.1.3" mathsize="90%" xref="alg1.9.9.m3.1.1.1.1.1.3.cmml">S</mi></msub><mo id="alg1.9.9.m3.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.9.9.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.9.m3.1b"><apply id="alg1.9.9.m3.1.1.cmml" xref="alg1.9.9.m3.1.1"><times id="alg1.9.9.m3.1.1.2.cmml" xref="alg1.9.9.m3.1.1.2"></times><ci id="alg1.9.9.m3.1.1.3.cmml" xref="alg1.9.9.m3.1.1.3">𝒫</ci><apply id="alg1.9.9.m3.1.1.1.1.1.cmml" xref="alg1.9.9.m3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.9.9.m3.1.1.1.1.1.1.cmml" xref="alg1.9.9.m3.1.1.1.1">subscript</csymbol><ci id="alg1.9.9.m3.1.1.1.1.1.2.cmml" xref="alg1.9.9.m3.1.1.1.1.1.2">𝐼</ci><ci id="alg1.9.9.m3.1.1.1.1.1.3.cmml" xref="alg1.9.9.m3.1.1.1.1.1.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.m3.1c">\mathcal{P}(I_{S})</annotation><annotation encoding="application/x-llamapun" id="alg1.9.9.m3.1d">caligraphic_P ( italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.9.9.6" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.18.20">
<span class="ltx_text" id="alg1.18.20.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.18.20.2" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.18.20.3" style="font-size:90%;">
</span><span class="ltx_text" id="alg1.18.20.4" style="font-size:90%;color:#008080;"># Semantic Matching</span>
</div>
<div class="ltx_listingline" id="alg1.10.10">
<span class="ltx_text" id="alg1.10.10.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.10.10.2" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.10.10.3" style="font-size:90%;">
Collect maximum response preference </span><math alttext="M_{c^{*}}^{(t)}" class="ltx_Math" display="inline" id="alg1.10.10.m1.1"><semantics id="alg1.10.10.m1.1a"><msubsup id="alg1.10.10.m1.1.2" xref="alg1.10.10.m1.1.2.cmml"><mi id="alg1.10.10.m1.1.2.2.2" mathsize="90%" xref="alg1.10.10.m1.1.2.2.2.cmml">M</mi><msup id="alg1.10.10.m1.1.2.2.3" xref="alg1.10.10.m1.1.2.2.3.cmml"><mi id="alg1.10.10.m1.1.2.2.3.2" mathsize="90%" xref="alg1.10.10.m1.1.2.2.3.2.cmml">c</mi><mo id="alg1.10.10.m1.1.2.2.3.3" mathsize="90%" xref="alg1.10.10.m1.1.2.2.3.3.cmml">∗</mo></msup><mrow id="alg1.10.10.m1.1.1.1.3" xref="alg1.10.10.m1.1.2.cmml"><mo id="alg1.10.10.m1.1.1.1.3.1" maxsize="90%" minsize="90%" xref="alg1.10.10.m1.1.2.cmml">(</mo><mi id="alg1.10.10.m1.1.1.1.1" mathsize="90%" xref="alg1.10.10.m1.1.1.1.1.cmml">t</mi><mo id="alg1.10.10.m1.1.1.1.3.2" maxsize="90%" minsize="90%" xref="alg1.10.10.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.10.10.m1.1b"><apply id="alg1.10.10.m1.1.2.cmml" xref="alg1.10.10.m1.1.2"><csymbol cd="ambiguous" id="alg1.10.10.m1.1.2.1.cmml" xref="alg1.10.10.m1.1.2">superscript</csymbol><apply id="alg1.10.10.m1.1.2.2.cmml" xref="alg1.10.10.m1.1.2"><csymbol cd="ambiguous" id="alg1.10.10.m1.1.2.2.1.cmml" xref="alg1.10.10.m1.1.2">subscript</csymbol><ci id="alg1.10.10.m1.1.2.2.2.cmml" xref="alg1.10.10.m1.1.2.2.2">𝑀</ci><apply id="alg1.10.10.m1.1.2.2.3.cmml" xref="alg1.10.10.m1.1.2.2.3"><csymbol cd="ambiguous" id="alg1.10.10.m1.1.2.2.3.1.cmml" xref="alg1.10.10.m1.1.2.2.3">superscript</csymbol><ci id="alg1.10.10.m1.1.2.2.3.2.cmml" xref="alg1.10.10.m1.1.2.2.3.2">𝑐</ci><times id="alg1.10.10.m1.1.2.2.3.3.cmml" xref="alg1.10.10.m1.1.2.2.3.3"></times></apply></apply><ci id="alg1.10.10.m1.1.1.1.1.cmml" xref="alg1.10.10.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m1.1c">M_{c^{*}}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="alg1.10.10.m1.1d">italic_M start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.10.10.4" style="font-size:90%;"> by Eq. </span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E3" style="font-size:90%;" title="In 3.2 Data Synthesis from Pre-trained SAM ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">3</span></a><span class="ltx_text" id="alg1.10.10.5" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.18.21">
<span class="ltx_text" id="alg1.18.21.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.18.21.2" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.18.21.3" style="font-size:90%;">
Filter and evolve pseudo labels by Eq. </span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E4" style="font-size:90%;" title="In 3.2 Data Synthesis from Pre-trained SAM ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">4</span></a><span class="ltx_text" id="alg1.18.21.4" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.11.11">
<span class="ltx_text" id="alg1.11.11.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.11.11.2" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.11.11.3" style="font-size:90%;">
Calculate semantic matching loss </span><math alttext="\mathcal{L}_{SM}" class="ltx_Math" display="inline" id="alg1.11.11.m1.1"><semantics id="alg1.11.11.m1.1a"><msub id="alg1.11.11.m1.1.1" xref="alg1.11.11.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.11.11.m1.1.1.2" mathsize="90%" xref="alg1.11.11.m1.1.1.2.cmml">ℒ</mi><mrow id="alg1.11.11.m1.1.1.3" xref="alg1.11.11.m1.1.1.3.cmml"><mi id="alg1.11.11.m1.1.1.3.2" mathsize="90%" xref="alg1.11.11.m1.1.1.3.2.cmml">S</mi><mo id="alg1.11.11.m1.1.1.3.1" xref="alg1.11.11.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.11.11.m1.1.1.3.3" mathsize="90%" xref="alg1.11.11.m1.1.1.3.3.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.11.11.m1.1b"><apply id="alg1.11.11.m1.1.1.cmml" xref="alg1.11.11.m1.1.1"><csymbol cd="ambiguous" id="alg1.11.11.m1.1.1.1.cmml" xref="alg1.11.11.m1.1.1">subscript</csymbol><ci id="alg1.11.11.m1.1.1.2.cmml" xref="alg1.11.11.m1.1.1.2">ℒ</ci><apply id="alg1.11.11.m1.1.1.3.cmml" xref="alg1.11.11.m1.1.1.3"><times id="alg1.11.11.m1.1.1.3.1.cmml" xref="alg1.11.11.m1.1.1.3.1"></times><ci id="alg1.11.11.m1.1.1.3.2.cmml" xref="alg1.11.11.m1.1.1.3.2">𝑆</ci><ci id="alg1.11.11.m1.1.1.3.3.cmml" xref="alg1.11.11.m1.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.m1.1c">\mathcal{L}_{SM}</annotation><annotation encoding="application/x-llamapun" id="alg1.11.11.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_S italic_M end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.11.11.4" style="font-size:90%;"> by Eq. </span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E6" style="font-size:90%;" title="In 3.2 Data Synthesis from Pre-trained SAM ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">6</span></a><span class="ltx_text" id="alg1.11.11.5" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.18.22">
<span class="ltx_text" id="alg1.18.22.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.18.22.2" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.18.22.3" style="font-size:90%;">
</span><span class="ltx_text" id="alg1.18.22.4" style="font-size:90%;color:#008080;"># Distributional Matching</span><span class="ltx_text" id="alg1.18.22.5" style="font-size:90%;"> </span>
</div>
<div class="ltx_listingline" id="alg1.18.23">
<span class="ltx_text" id="alg1.18.23.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.18.23.2" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.18.23.3" style="font-size:90%;">
Calculate patch similarity by Eq. </span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E7" style="font-size:90%;" title="In 3.2 Data Synthesis from Pre-trained SAM ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">7</span></a><span class="ltx_text" id="alg1.18.23.4" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.12.12">
<span class="ltx_text" id="alg1.12.12.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.12.12.2" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.12.12.3" style="font-size:90%;">
Calculate distributional matching loss </span><math alttext="\mathcal{L}_{DM}" class="ltx_Math" display="inline" id="alg1.12.12.m1.1"><semantics id="alg1.12.12.m1.1a"><msub id="alg1.12.12.m1.1.1" xref="alg1.12.12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.12.12.m1.1.1.2" mathsize="90%" xref="alg1.12.12.m1.1.1.2.cmml">ℒ</mi><mrow id="alg1.12.12.m1.1.1.3" xref="alg1.12.12.m1.1.1.3.cmml"><mi id="alg1.12.12.m1.1.1.3.2" mathsize="90%" xref="alg1.12.12.m1.1.1.3.2.cmml">D</mi><mo id="alg1.12.12.m1.1.1.3.1" xref="alg1.12.12.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.12.12.m1.1.1.3.3" mathsize="90%" xref="alg1.12.12.m1.1.1.3.3.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.12.12.m1.1b"><apply id="alg1.12.12.m1.1.1.cmml" xref="alg1.12.12.m1.1.1"><csymbol cd="ambiguous" id="alg1.12.12.m1.1.1.1.cmml" xref="alg1.12.12.m1.1.1">subscript</csymbol><ci id="alg1.12.12.m1.1.1.2.cmml" xref="alg1.12.12.m1.1.1.2">ℒ</ci><apply id="alg1.12.12.m1.1.1.3.cmml" xref="alg1.12.12.m1.1.1.3"><times id="alg1.12.12.m1.1.1.3.1.cmml" xref="alg1.12.12.m1.1.1.3.1"></times><ci id="alg1.12.12.m1.1.1.3.2.cmml" xref="alg1.12.12.m1.1.1.3.2">𝐷</ci><ci id="alg1.12.12.m1.1.1.3.3.cmml" xref="alg1.12.12.m1.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.m1.1c">\mathcal{L}_{DM}</annotation><annotation encoding="application/x-llamapun" id="alg1.12.12.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_D italic_M end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.12.12.4" style="font-size:90%;"> by Eq. </span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E9" style="font-size:90%;" title="In 3.2 Data Synthesis from Pre-trained SAM ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">9</span></a><span class="ltx_text" id="alg1.12.12.5" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.18.24">
<span class="ltx_text" id="alg1.18.24.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.18.24.2" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.18.24.3" style="font-size:90%;">
</span><span class="ltx_text" id="alg1.18.24.4" style="font-size:90%;color:#008080;"># Image Updating</span><span class="ltx_text" id="alg1.18.24.5" style="font-size:90%;"> </span>
</div>
<div class="ltx_listingline" id="alg1.13.13">
<span class="ltx_text" id="alg1.13.13.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.13.13.2" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.13.13.3" style="font-size:90%;">
Combine two losses to obtain </span><math alttext="\mathcal{L}_{IS}" class="ltx_Math" display="inline" id="alg1.13.13.m1.1"><semantics id="alg1.13.13.m1.1a"><msub id="alg1.13.13.m1.1.1" xref="alg1.13.13.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.13.13.m1.1.1.2" mathsize="90%" xref="alg1.13.13.m1.1.1.2.cmml">ℒ</mi><mrow id="alg1.13.13.m1.1.1.3" xref="alg1.13.13.m1.1.1.3.cmml"><mi id="alg1.13.13.m1.1.1.3.2" mathsize="90%" xref="alg1.13.13.m1.1.1.3.2.cmml">I</mi><mo id="alg1.13.13.m1.1.1.3.1" xref="alg1.13.13.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.13.13.m1.1.1.3.3" mathsize="90%" xref="alg1.13.13.m1.1.1.3.3.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.13.13.m1.1b"><apply id="alg1.13.13.m1.1.1.cmml" xref="alg1.13.13.m1.1.1"><csymbol cd="ambiguous" id="alg1.13.13.m1.1.1.1.cmml" xref="alg1.13.13.m1.1.1">subscript</csymbol><ci id="alg1.13.13.m1.1.1.2.cmml" xref="alg1.13.13.m1.1.1.2">ℒ</ci><apply id="alg1.13.13.m1.1.1.3.cmml" xref="alg1.13.13.m1.1.1.3"><times id="alg1.13.13.m1.1.1.3.1.cmml" xref="alg1.13.13.m1.1.1.3.1"></times><ci id="alg1.13.13.m1.1.1.3.2.cmml" xref="alg1.13.13.m1.1.1.3.2">𝐼</ci><ci id="alg1.13.13.m1.1.1.3.3.cmml" xref="alg1.13.13.m1.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.m1.1c">\mathcal{L}_{IS}</annotation><annotation encoding="application/x-llamapun" id="alg1.13.13.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_I italic_S end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.13.13.4" style="font-size:90%;"> by Eq. </span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E11" style="font-size:90%;" title="In 3.4 The Overall Quantization Pipeline ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">11</span></a><span class="ltx_text" id="alg1.13.13.5" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.15.15">
<span class="ltx_text" id="alg1.15.15.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.15.15.2" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.15.15.3" style="font-size:90%;">
Update </span><math alttext="I_{S}" class="ltx_Math" display="inline" id="alg1.14.14.m1.1"><semantics id="alg1.14.14.m1.1a"><msub id="alg1.14.14.m1.1.1" xref="alg1.14.14.m1.1.1.cmml"><mi id="alg1.14.14.m1.1.1.2" mathsize="90%" xref="alg1.14.14.m1.1.1.2.cmml">I</mi><mi id="alg1.14.14.m1.1.1.3" mathsize="90%" xref="alg1.14.14.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.14.14.m1.1b"><apply id="alg1.14.14.m1.1.1.cmml" xref="alg1.14.14.m1.1.1"><csymbol cd="ambiguous" id="alg1.14.14.m1.1.1.1.cmml" xref="alg1.14.14.m1.1.1">subscript</csymbol><ci id="alg1.14.14.m1.1.1.2.cmml" xref="alg1.14.14.m1.1.1.2">𝐼</ci><ci id="alg1.14.14.m1.1.1.3.cmml" xref="alg1.14.14.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.m1.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="alg1.14.14.m1.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.15.15.4" style="font-size:90%;"> by back-propagation of </span><math alttext="\mathcal{L}_{IS}" class="ltx_Math" display="inline" id="alg1.15.15.m2.1"><semantics id="alg1.15.15.m2.1a"><msub id="alg1.15.15.m2.1.1" xref="alg1.15.15.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.15.15.m2.1.1.2" mathsize="90%" xref="alg1.15.15.m2.1.1.2.cmml">ℒ</mi><mrow id="alg1.15.15.m2.1.1.3" xref="alg1.15.15.m2.1.1.3.cmml"><mi id="alg1.15.15.m2.1.1.3.2" mathsize="90%" xref="alg1.15.15.m2.1.1.3.2.cmml">I</mi><mo id="alg1.15.15.m2.1.1.3.1" xref="alg1.15.15.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.15.15.m2.1.1.3.3" mathsize="90%" xref="alg1.15.15.m2.1.1.3.3.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.15.15.m2.1b"><apply id="alg1.15.15.m2.1.1.cmml" xref="alg1.15.15.m2.1.1"><csymbol cd="ambiguous" id="alg1.15.15.m2.1.1.1.cmml" xref="alg1.15.15.m2.1.1">subscript</csymbol><ci id="alg1.15.15.m2.1.1.2.cmml" xref="alg1.15.15.m2.1.1.2">ℒ</ci><apply id="alg1.15.15.m2.1.1.3.cmml" xref="alg1.15.15.m2.1.1.3"><times id="alg1.15.15.m2.1.1.3.1.cmml" xref="alg1.15.15.m2.1.1.3.1"></times><ci id="alg1.15.15.m2.1.1.3.2.cmml" xref="alg1.15.15.m2.1.1.3.2">𝐼</ci><ci id="alg1.15.15.m2.1.1.3.3.cmml" xref="alg1.15.15.m2.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.m2.1c">\mathcal{L}_{IS}</annotation><annotation encoding="application/x-llamapun" id="alg1.15.15.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_I italic_S end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.15.15.5" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.18.25">
<span class="ltx_text" id="alg1.18.25.1" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.18.25.2" style="font-size:90%;">   </span><span class="ltx_text" id="alg1.18.25.3" style="font-size:90%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.18.26">
<span class="ltx_text" id="alg1.18.26.1" style="font-size:90%;color:#008080;"># <span class="ltx_text ltx_font_bold" id="alg1.18.26.1.1">Stage 2: Quantization Calibration</span></span>
</div>
<div class="ltx_listingline" id="alg1.18.18">
<span class="ltx_text" id="alg1.18.18.1" style="font-size:90%;">
Input </span><math alttext="I_{S}" class="ltx_Math" display="inline" id="alg1.16.16.m1.1"><semantics id="alg1.16.16.m1.1a"><msub id="alg1.16.16.m1.1.1" xref="alg1.16.16.m1.1.1.cmml"><mi id="alg1.16.16.m1.1.1.2" mathsize="90%" xref="alg1.16.16.m1.1.1.2.cmml">I</mi><mi id="alg1.16.16.m1.1.1.3" mathsize="90%" xref="alg1.16.16.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.16.16.m1.1b"><apply id="alg1.16.16.m1.1.1.cmml" xref="alg1.16.16.m1.1.1"><csymbol cd="ambiguous" id="alg1.16.16.m1.1.1.1.cmml" xref="alg1.16.16.m1.1.1">subscript</csymbol><ci id="alg1.16.16.m1.1.1.2.cmml" xref="alg1.16.16.m1.1.1.2">𝐼</ci><ci id="alg1.16.16.m1.1.1.3.cmml" xref="alg1.16.16.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.m1.1c">I_{S}</annotation><annotation encoding="application/x-llamapun" id="alg1.16.16.m1.1d">italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.18.18.2" style="font-size:90%;"> to </span><math alttext="\mathcal{Q}" class="ltx_Math" display="inline" id="alg1.17.17.m2.1"><semantics id="alg1.17.17.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.17.17.m2.1.1" mathsize="90%" xref="alg1.17.17.m2.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="alg1.17.17.m2.1b"><ci id="alg1.17.17.m2.1.1.cmml" xref="alg1.17.17.m2.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.17.m2.1c">\mathcal{Q}</annotation><annotation encoding="application/x-llamapun" id="alg1.17.17.m2.1d">caligraphic_Q</annotation></semantics></math><span class="ltx_text" id="alg1.18.18.3" style="font-size:90%;"> and forward propagate </span><math alttext="\mathcal{Q}(I_{S})" class="ltx_Math" display="inline" id="alg1.18.18.m3.1"><semantics id="alg1.18.18.m3.1a"><mrow id="alg1.18.18.m3.1.1" xref="alg1.18.18.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.18.18.m3.1.1.3" mathsize="90%" xref="alg1.18.18.m3.1.1.3.cmml">𝒬</mi><mo id="alg1.18.18.m3.1.1.2" xref="alg1.18.18.m3.1.1.2.cmml">⁢</mo><mrow id="alg1.18.18.m3.1.1.1.1" xref="alg1.18.18.m3.1.1.1.1.1.cmml"><mo id="alg1.18.18.m3.1.1.1.1.2" maxsize="90%" minsize="90%" xref="alg1.18.18.m3.1.1.1.1.1.cmml">(</mo><msub id="alg1.18.18.m3.1.1.1.1.1" xref="alg1.18.18.m3.1.1.1.1.1.cmml"><mi id="alg1.18.18.m3.1.1.1.1.1.2" mathsize="90%" xref="alg1.18.18.m3.1.1.1.1.1.2.cmml">I</mi><mi id="alg1.18.18.m3.1.1.1.1.1.3" mathsize="90%" xref="alg1.18.18.m3.1.1.1.1.1.3.cmml">S</mi></msub><mo id="alg1.18.18.m3.1.1.1.1.3" maxsize="90%" minsize="90%" xref="alg1.18.18.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.18.18.m3.1b"><apply id="alg1.18.18.m3.1.1.cmml" xref="alg1.18.18.m3.1.1"><times id="alg1.18.18.m3.1.1.2.cmml" xref="alg1.18.18.m3.1.1.2"></times><ci id="alg1.18.18.m3.1.1.3.cmml" xref="alg1.18.18.m3.1.1.3">𝒬</ci><apply id="alg1.18.18.m3.1.1.1.1.1.cmml" xref="alg1.18.18.m3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.18.18.m3.1.1.1.1.1.1.cmml" xref="alg1.18.18.m3.1.1.1.1">subscript</csymbol><ci id="alg1.18.18.m3.1.1.1.1.1.2.cmml" xref="alg1.18.18.m3.1.1.1.1.1.2">𝐼</ci><ci id="alg1.18.18.m3.1.1.1.1.1.3.cmml" xref="alg1.18.18.m3.1.1.1.1.1.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.18.m3.1c">\mathcal{Q}(I_{S})</annotation><annotation encoding="application/x-llamapun" id="alg1.18.18.m3.1d">caligraphic_Q ( italic_I start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.18.18.4" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.18.27">
<span class="ltx_text" id="alg1.18.27.1" style="font-size:90%;">
Calibrate the initial quantization parameters by Eq. </span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E2" style="font-size:90%;" title="In 3.1 Preliminaries: Quantization ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">2</span></a><span class="ltx_text" id="alg1.18.27.2" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.18.28">
<span class="ltx_text" id="alg1.18.28.1" style="font-size:90%;">
Perform scale reparameterization by Eq. </span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E10" style="font-size:90%;" title="In 3.3 Quantization Calibration: Scale Reparameterization ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">10</span></a><span class="ltx_text" id="alg1.18.28.2" style="font-size:90%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.18.29">
<span class="ltx_text" id="alg1.18.29.1" style="font-size:90%;">
</span>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.22.1.1">Algorithm 1</span> </span>The DFQ-SAM Pipeline</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span><span class="ltx_text ltx_font_italic" id="S3.SS4.1.1">The Overall Quantization Pipeline</span>
</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">The quantization process of DFQ-SAM is divided into two stages: (i) image synthesis, and (ii) quantization calibration. The whole pipeline is summarized in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#alg1" title="In 3.3 Quantization Calibration: Scale Reparameterization ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">1</span></a>. Each stage is described in detail below.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.2"><span class="ltx_text ltx_font_bold" id="S3.SS4.p2.2.1">Image Synthesis</span>
Our goal is to fully exploit the prior information in the pre-trained SAM, and thus facilitate the matching of synthesized images with real images from both semantic and distributional aspects.
Note that <math alttext="\mathcal{L}_{SM}" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><msub id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.1.3.2.cmml">S</mi><mo id="S3.SS4.p2.1.m1.1.1.3.1" xref="S3.SS4.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p2.1.m1.1.1.3.3" xref="S3.SS4.p2.1.m1.1.1.3.3.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">ℒ</ci><apply id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3"><times id="S3.SS4.p2.1.m1.1.1.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.3.1"></times><ci id="S3.SS4.p2.1.m1.1.1.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.3.2">𝑆</ci><ci id="S3.SS4.p2.1.m1.1.1.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\mathcal{L}_{SM}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_S italic_M end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathcal{L}_{DM}" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.1"><semantics id="S3.SS4.p2.2.m2.1a"><msub id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.2.m2.1.1.2" xref="S3.SS4.p2.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml"><mi id="S3.SS4.p2.2.m2.1.1.3.2" xref="S3.SS4.p2.2.m2.1.1.3.2.cmml">D</mi><mo id="S3.SS4.p2.2.m2.1.1.3.1" xref="S3.SS4.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p2.2.m2.1.1.3.3" xref="S3.SS4.p2.2.m2.1.1.3.3.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2">ℒ</ci><apply id="S3.SS4.p2.2.m2.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3"><times id="S3.SS4.p2.2.m2.1.1.3.1.cmml" xref="S3.SS4.p2.2.m2.1.1.3.1"></times><ci id="S3.SS4.p2.2.m2.1.1.3.2.cmml" xref="S3.SS4.p2.2.m2.1.1.3.2">𝐷</ci><ci id="S3.SS4.p2.2.m2.1.1.3.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">\mathcal{L}_{DM}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_D italic_M end_POSTSUBSCRIPT</annotation></semantics></math> are specifically designed with careful consideration of the Transformer model architecture and the image segmentation task, thus resulting in significant performance.
Specifically, we take the image as the optimization objective and update it by calculating the following loss function:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{IS}=\mathcal{L}_{SM}+\beta\cdot\mathcal{L}_{DM}," class="ltx_Math" display="block" id="S3.E11.m1.1"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml"><mrow id="S3.E11.m1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.cmml"><msub id="S3.E11.m1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.1.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E11.m1.1.1.1.1.2.3" xref="S3.E11.m1.1.1.1.1.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1.2.3.2" xref="S3.E11.m1.1.1.1.1.2.3.2.cmml">I</mi><mo id="S3.E11.m1.1.1.1.1.2.3.1" xref="S3.E11.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.1.1.2.3.3" xref="S3.E11.m1.1.1.1.1.2.3.3.cmml">S</mi></mrow></msub><mo id="S3.E11.m1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E11.m1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.3.cmml"><msub id="S3.E11.m1.1.1.1.1.3.2" xref="S3.E11.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.1.1.1.1.3.2.2" xref="S3.E11.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E11.m1.1.1.1.1.3.2.3" xref="S3.E11.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E11.m1.1.1.1.1.3.2.3.2" xref="S3.E11.m1.1.1.1.1.3.2.3.2.cmml">S</mi><mo id="S3.E11.m1.1.1.1.1.3.2.3.1" xref="S3.E11.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.1.1.3.2.3.3" xref="S3.E11.m1.1.1.1.1.3.2.3.3.cmml">M</mi></mrow></msub><mo id="S3.E11.m1.1.1.1.1.3.1" xref="S3.E11.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E11.m1.1.1.1.1.3.3" xref="S3.E11.m1.1.1.1.1.3.3.cmml"><mi id="S3.E11.m1.1.1.1.1.3.3.2" xref="S3.E11.m1.1.1.1.1.3.3.2.cmml">β</mi><mo id="S3.E11.m1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E11.m1.1.1.1.1.3.3.1.cmml">⋅</mo><msub id="S3.E11.m1.1.1.1.1.3.3.3" xref="S3.E11.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.1.1.1.1.3.3.3.2" xref="S3.E11.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S3.E11.m1.1.1.1.1.3.3.3.3" xref="S3.E11.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E11.m1.1.1.1.1.3.3.3.3.2" xref="S3.E11.m1.1.1.1.1.3.3.3.3.2.cmml">D</mi><mo id="S3.E11.m1.1.1.1.1.3.3.3.3.1" xref="S3.E11.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E11.m1.1.1.1.1.3.3.3.3.3" xref="S3.E11.m1.1.1.1.1.3.3.3.3.3.cmml">M</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E11.m1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.1b"><apply id="S3.E11.m1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1"><eq id="S3.E11.m1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1"></eq><apply id="S3.E11.m1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.2.2">ℒ</ci><apply id="S3.E11.m1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.2.3"><times id="S3.E11.m1.1.1.1.1.2.3.1.cmml" xref="S3.E11.m1.1.1.1.1.2.3.1"></times><ci id="S3.E11.m1.1.1.1.1.2.3.2.cmml" xref="S3.E11.m1.1.1.1.1.2.3.2">𝐼</ci><ci id="S3.E11.m1.1.1.1.1.2.3.3.cmml" xref="S3.E11.m1.1.1.1.1.2.3.3">𝑆</ci></apply></apply><apply id="S3.E11.m1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.3"><plus id="S3.E11.m1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.1.1.1.1.3.1"></plus><apply id="S3.E11.m1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.3.2.1.cmml" xref="S3.E11.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.3.2.2.cmml" xref="S3.E11.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S3.E11.m1.1.1.1.1.3.2.3.cmml" xref="S3.E11.m1.1.1.1.1.3.2.3"><times id="S3.E11.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E11.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E11.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E11.m1.1.1.1.1.3.2.3.2">𝑆</ci><ci id="S3.E11.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E11.m1.1.1.1.1.3.2.3.3">𝑀</ci></apply></apply><apply id="S3.E11.m1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.1.1.1.1.3.3"><ci id="S3.E11.m1.1.1.1.1.3.3.1.cmml" xref="S3.E11.m1.1.1.1.1.3.3.1">⋅</ci><ci id="S3.E11.m1.1.1.1.1.3.3.2.cmml" xref="S3.E11.m1.1.1.1.1.3.3.2">𝛽</ci><apply id="S3.E11.m1.1.1.1.1.3.3.3.cmml" xref="S3.E11.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E11.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E11.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="S3.E11.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E11.m1.1.1.1.1.3.3.3.3"><times id="S3.E11.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E11.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E11.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E11.m1.1.1.1.1.3.3.3.3.2">𝐷</ci><ci id="S3.E11.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E11.m1.1.1.1.1.3.3.3.3.3">𝑀</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.1c">\mathcal{L}_{IS}=\mathcal{L}_{SM}+\beta\cdot\mathcal{L}_{DM},</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_I italic_S end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_S italic_M end_POSTSUBSCRIPT + italic_β ⋅ caligraphic_L start_POSTSUBSCRIPT italic_D italic_M end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p2.3">where <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m1.1"><semantics id="S3.SS4.p2.3.m1.1a"><mi id="S3.SS4.p2.3.m1.1.1" xref="S3.SS4.p2.3.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m1.1b"><ci id="S3.SS4.p2.3.m1.1.1.cmml" xref="S3.SS4.p2.3.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.3.m1.1d">italic_β</annotation></semantics></math> is the balance coefficient.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.p3.1.1">Quantization Calibration</span>
After obtaining the synthesized images, we utilize them instead of the real dataset to calibrate the quantization parameters. In this stage, we employ scale reparameterization presented in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E10" title="In 3.3 Quantization Calibration: Scale Reparameterization ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">10</span></a> to ensure the accuracy of low-bit quantization. Note that we adopt post-training quantization, which does not require any resource-intensive training or fine-tuning, allowing the compression process to be achieved easily and quickly.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Experiments</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We conduct exhaustive experiments to demonstrate the effectiveness and advantages of DFQ-SAM. The implementation details, including the models, datasets, comparison methods, and settings, are presented in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A2.SS1" title="B.1 Implementation Details ‣ Appendix B More experimental details and results ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">B.1</span></a>. In the following, we will discuss the experimental results in detail.</p>
</div>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="501" id="S4.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Visualization of synthesized images (256<math alttext="\times" class="ltx_Math" display="inline" id="S4.F5.2.m1.1"><semantics id="S4.F5.2.m1.1b"><mo id="S4.F5.2.m1.1.1" xref="S4.F5.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.F5.2.m1.1c"><times id="S4.F5.2.m1.1.1.cmml" xref="S4.F5.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.F5.2.m1.1e">×</annotation></semantics></math>256 pixels). The first two rows are grayscale images and the third row is color images, both reflecting medical semantic contents.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="386" id="S4.F6.g1" src="x6.png" width="706"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Illustration of inference acceleration using 4-bit quantization across various devices, demonstrating a speedup ranging from 3.43<math alttext="\times" class="ltx_Math" display="inline" id="S4.F6.3.m1.1"><semantics id="S4.F6.3.m1.1b"><mo id="S4.F6.3.m1.1.1" xref="S4.F6.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.F6.3.m1.1c"><times id="S4.F6.3.m1.1.1.cmml" xref="S4.F6.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.3.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.F6.3.m1.1e">×</annotation></semantics></math> to 3.59<math alttext="\times" class="ltx_Math" display="inline" id="S4.F6.4.m2.1"><semantics id="S4.F6.4.m2.1b"><mo id="S4.F6.4.m2.1.1" xref="S4.F6.4.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.F6.4.m2.1c"><times id="S4.F6.4.m2.1.1.cmml" xref="S4.F6.4.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.4.m2.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S4.F6.4.m2.1e">×</annotation></semantics></math> compared to the FP32 baseline.</figcaption>
</figure>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span><span class="ltx_text ltx_font_italic" id="S4.SS1.1.1">Analysis of Synthesized Images</span>
</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4.F5" title="Figure 5 ‣ 4 Experiments ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">5</span></a> shows the visualization results of synthesized images (256<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mo id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><times id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">×</annotation></semantics></math>256 pixels).
It should be emphasized that only the pre-trained model is required to synthesize these images, without any other information, especially the original data or any external prior.
In terms of brightness and contrast, we can observe that the synthesized images are well-aligned with the distribution of real images, demonstrating that the image synthesis process has successfully captured the fundamental visual priors in the pre-trained model. Additionally, from a semantic perspective, the synthesized images accurately reflect the anatomical structures and relative positions of various organs, aligning well with the characteristics of real images.
This alignment in both aspects plays a crucial role in downstream quantization calibration.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span><span class="ltx_text ltx_font_italic" id="S4.SS2.1.1">Efficiency Evaluation of Quantized Models</span>
</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.2">We demonstrate the effect of inference acceleration by deploying the 4-bit quantized model on different NVIDIA GPUs, including Titan RTX, RTX 3090, and RTX A6000.
In this implementation, the kernel of the quantized computation is built on CUTLASS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib35" title="">35</a>]</cite>, which is a high-performance CUDA library specifically designed for matrix multiplication. The acceleration results are presented in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4.F6" title="Figure 6 ‣ 4 Experiments ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">6</span></a>, indicating a 3.43<math alttext="\sim" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mo id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">∼</annotation></semantics></math>3.59<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mo id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><times id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">×</annotation></semantics></math> speedup compared to the full-precision baseline.
Therefore, the quantized SAM consistently delivers significantly enhanced inference efficiency across various hardware platforms, exhibiting strong compatibility and versatility. This ensures real-time and efficient medical services at the edge, which is particularly crucial in distributed systems with diverse hardware environments at local nodes, thereby promoting the widespread deployment and application of intelligent healthcare.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span><span class="ltx_text ltx_font_italic" id="S4.SS3.1.1">Accuracy Evaluation of Quantized Models</span>
</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Here, we conduct extensive experiments on a variety set of datasets to demonstrate the accuracy advantages of the proposed DFQ-SAM. Notably, to highlight the generalization and robustness of the algorithm, the adopted datasets are from diverse modalities, including CT, MRI, PET, Ultrasound, Xray, Dermoscopy, and Endoscopy.
The evaluation metric is the predicted IoU of the masks. The accuracy results are presented and discussed in detail below.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Quantization results on grayscale medical images, with modalities of CT, MRI, PET, Ultrasound, and X-ray. DFQ-SAM is compared to methods that use real data or Gaussian noise for quantization. The reported values are the IoU results of segmentation masks on different datasets. We also present the model complexity, including model size and computational load (BOPs).</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.1" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.1.1.1.1" style="font-size:90%;">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.2" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.1.1.2.1" style="font-size:90%;">Privacy</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.3" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.1.1.3.1" style="font-size:90%;">Prec. (W/A)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.4" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.1.1.4.1" style="font-size:90%;">Size (MB)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.5" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.1.1.5.1" style="font-size:90%;">BOPs (G)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T1.3.1.1.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.1.1.6.1" style="font-size:90%;">CT</span></th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.1.1.7" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.1.1.7.1" style="font-size:90%;">Average</span></th>
</tr>
<tr class="ltx_tr" id="S4.T1.3.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.2.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text" id="S4.T1.3.2.2.1.1" style="font-size:90%;">AbdomenCT1k</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.3.2.2.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib36" title="">36</a><span class="ltx_text" id="S4.T1.3.2.2.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text" id="S4.T1.3.2.2.2.1" style="font-size:90%;">FLARE</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.3.2.2.2.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib37" title="">37</a><span class="ltx_text" id="S4.T1.3.2.2.2.3.2" style="font-size:90%;">]</span></cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.2.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text" id="S4.T1.3.2.2.3.1" style="font-size:90%;">Synapse</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.3.2.2.3.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib38" title="">38</a><span class="ltx_text" id="S4.T1.3.2.2.3.3.2" style="font-size:90%;">]</span></cite>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.3.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.3.1.1.1" style="font-size:90%;">FP Baseline</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.1.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.3.1.2.1" style="font-size:90%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.1.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.3.1.3.1" style="font-size:90%;">32/32</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.1.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.3.1.4.1" style="font-size:90%;">358</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.1.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.3.1.5.1" style="font-size:90%;">19866</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.1.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.3.1.6.1" style="font-size:90%;">76.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.1.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.3.1.7.1" style="font-size:90%;">75.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.1.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.3.1.8.1" style="font-size:90%;">76.34</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T1.3.3.1.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.3.1.9.1" style="font-size:90%;">76.28</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.4.2">
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.4.2.1.1" style="font-size:90%;">Real Data</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.2.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.4.2.2.1" style="font-size:90%;color:#CC4054;">✗</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.2.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.4.2.3.1" style="font-size:90%;">4/4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.2.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.4.2.4.1" style="font-size:90%;">46.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.2.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.4.2.5.1" style="font-size:90%;">346</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.2.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.4.2.6.1" style="font-size:90%;">69.83</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.2.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.4.2.7.1" style="font-size:90%;">73.31</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.2.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.4.2.8.1" style="font-size:90%;">74.55</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.4.2.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.4.2.9.1" style="font-size:90%;">72.56</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.5.3">
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.3.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.5.3.1.1" style="font-size:90%;">Gaussian Noise</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.3.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.5.3.2.1" style="font-size:90%;color:#40CC54;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.3.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.5.3.3.1" style="font-size:90%;">4/4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.3.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.5.3.4.1" style="font-size:90%;">46.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.3.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.5.3.5.1" style="font-size:90%;">346</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.3.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.5.3.6.1" style="font-size:90%;">62.03</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.3.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.5.3.7.1" style="font-size:90%;">71.25</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.3.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.5.3.8.1" style="font-size:90%;">71.66</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.5.3.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.5.3.9.1" style="font-size:90%;">68.31</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.6.4" style="background-color:#CCE6E6;">
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.3.6.4.1.1" style="background-color:#CCE6E6;">
<tr class="ltx_tr" id="S4.T1.3.6.4.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.6.4.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.6.4.1.1.1.1.1" style="font-size:90%;">Synthesized Data</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.6.4.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.6.4.1.1.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text" id="S4.T1.3.6.4.1.1.2.1.1" style="font-size:90%;">(</span><span class="ltx_text ltx_font_bold" id="S4.T1.3.6.4.1.1.2.1.2" style="font-size:90%;">DFQ-SAM, Ours</span><span class="ltx_text" id="S4.T1.3.6.4.1.1.2.1.3" style="font-size:90%;">)</span>
</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.4.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.6.4.2.1" style="font-size:90%;color:#40CC54;background-color:#CCE6E6;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.4.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.6.4.3.1" style="font-size:90%;background-color:#CCE6E6;">4/4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.4.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.6.4.4.1" style="font-size:90%;background-color:#CCE6E6;">46.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.4.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.6.4.5.1" style="font-size:90%;background-color:#CCE6E6;">346</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.4.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.6.4.6.1" style="font-size:90%;background-color:#CCE6E6;">74.32</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.4.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.6.4.7.1" style="font-size:90%;background-color:#CCE6E6;">73.90</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.4.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.6.4.8.1" style="font-size:90%;background-color:#CCE6E6;">75.12</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.6.4.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.6.4.9.1" style="font-size:90%;background-color:#CCE6E6;">74.45</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.7.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.7.5.1" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.7.5.1.1" style="font-size:90%;">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.7.5.2" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.7.5.2.1" style="font-size:90%;">Privacy</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.7.5.3" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.7.5.3.1" style="font-size:90%;">Prec. (W/A)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.7.5.4" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.7.5.4.1" style="font-size:90%;">Size (MB)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.7.5.5" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.7.5.5.1" style="font-size:90%;">BOPs (G)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T1.3.7.5.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.7.5.6.1" style="font-size:90%;">MRI</span></th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.7.5.7" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.7.5.7.1" style="font-size:90%;">Average</span></th>
</tr>
<tr class="ltx_tr" id="S4.T1.3.8.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.8.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text" id="S4.T1.3.8.6.1.1" style="font-size:90%;">ACDC</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.3.8.6.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib39" title="">39</a><span class="ltx_text" id="S4.T1.3.8.6.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.8.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text" id="S4.T1.3.8.6.2.1" style="font-size:90%;">MSD</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.3.8.6.2.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib40" title="">40</a><span class="ltx_text" id="S4.T1.3.8.6.2.3.2" style="font-size:90%;">]</span></cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.8.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text" id="S4.T1.3.8.6.3.1" style="font-size:90%;">ATLAS</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.3.8.6.3.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib41" title="">41</a><span class="ltx_text" id="S4.T1.3.8.6.3.3.2" style="font-size:90%;">]</span></cite>
</th>
</tr>
<tr class="ltx_tr" id="S4.T1.3.9.7">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.9.7.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.9.7.1.1" style="font-size:90%;">FP Baseline</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.9.7.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.9.7.2.1" style="font-size:90%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.9.7.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.9.7.3.1" style="font-size:90%;">32/32</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.9.7.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.9.7.4.1" style="font-size:90%;">358</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.9.7.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.9.7.5.1" style="font-size:90%;">19866</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.9.7.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.9.7.6.1" style="font-size:90%;">72.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.9.7.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.9.7.7.1" style="font-size:90%;">72.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.9.7.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.9.7.8.1" style="font-size:90%;">66.86</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T1.3.9.7.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.9.7.9.1" style="font-size:90%;">70.70</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.10.8">
<td class="ltx_td ltx_align_center" id="S4.T1.3.10.8.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.10.8.1.1" style="font-size:90%;">Real Data</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.10.8.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.10.8.2.1" style="font-size:90%;color:#CC4054;">✗</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.10.8.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.10.8.3.1" style="font-size:90%;">4/4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.10.8.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.10.8.4.1" style="font-size:90%;">46.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.10.8.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.10.8.5.1" style="font-size:90%;">346</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.10.8.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.10.8.6.1" style="font-size:90%;">69.92</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.10.8.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.10.8.7.1" style="font-size:90%;">71.62</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.10.8.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.10.8.8.1" style="font-size:90%;">63.42</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.10.8.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.10.8.9.1" style="font-size:90%;">68.32</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.11.9">
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.9.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.11.9.1.1" style="font-size:90%;">Gaussian Noise</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.9.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.11.9.2.1" style="font-size:90%;color:#40CC54;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.9.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.11.9.3.1" style="font-size:90%;">4/4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.9.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.11.9.4.1" style="font-size:90%;">46.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.9.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.11.9.5.1" style="font-size:90%;">346</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.9.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.11.9.6.1" style="font-size:90%;">67.54</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.9.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.11.9.7.1" style="font-size:90%;">70.44</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.9.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.11.9.8.1" style="font-size:90%;">59.69</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.11.9.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.11.9.9.1" style="font-size:90%;">65.89</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.12.10" style="background-color:#CCE6E6;">
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.10.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.3.12.10.1.1" style="background-color:#CCE6E6;">
<tr class="ltx_tr" id="S4.T1.3.12.10.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.12.10.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.12.10.1.1.1.1.1" style="font-size:90%;">Synthesized Data</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.12.10.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.12.10.1.1.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text" id="S4.T1.3.12.10.1.1.2.1.1" style="font-size:90%;">(</span><span class="ltx_text ltx_font_bold" id="S4.T1.3.12.10.1.1.2.1.2" style="font-size:90%;">DFQ-SAM, Ours</span><span class="ltx_text" id="S4.T1.3.12.10.1.1.2.1.3" style="font-size:90%;">)</span>
</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.10.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.12.10.2.1" style="font-size:90%;color:#40CC54;background-color:#CCE6E6;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.10.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.12.10.3.1" style="font-size:90%;background-color:#CCE6E6;">4/4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.10.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.12.10.4.1" style="font-size:90%;background-color:#CCE6E6;">46.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.10.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.12.10.5.1" style="font-size:90%;background-color:#CCE6E6;">346</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.10.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.12.10.6.1" style="font-size:90%;background-color:#CCE6E6;">71.29</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.10.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.12.10.7.1" style="font-size:90%;background-color:#CCE6E6;">71.86</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.10.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.12.10.8.1" style="font-size:90%;background-color:#CCE6E6;">64.44</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.12.10.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.12.10.9.1" style="font-size:90%;background-color:#CCE6E6;">69.20</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.13.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.13.11.1" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.13.11.1.1" style="font-size:90%;">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.13.11.2" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.13.11.2.1" style="font-size:90%;">Privacy</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.13.11.3" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.13.11.3.1" style="font-size:90%;">Prec. (W/A)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.13.11.4" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.13.11.4.1" style="font-size:90%;">Size (MB)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.13.11.5" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.13.11.5.1" style="font-size:90%;">BOPs (G)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.13.11.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.13.11.6.1" style="font-size:90%;">PET</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.13.11.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.13.11.7.1" style="font-size:90%;">Ultrasound</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.13.11.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.13.11.8.1" style="font-size:90%;">Xray</span></th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.3.13.11.9" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.13.11.9.1" style="font-size:90%;">Average</span></th>
</tr>
<tr class="ltx_tr" id="S4.T1.3.14.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.14.12.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text" id="S4.T1.3.14.12.1.1" style="font-size:90%;">AutoPET</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.3.14.12.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib42" title="">42</a><span class="ltx_text" id="S4.T1.3.14.12.1.3.2" style="font-size:90%;">]</span></cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.14.12.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text" id="S4.T1.3.14.12.2.1" style="font-size:90%;">SA-Ultrasound</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.3.14.12.2.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib6" title="">6</a><span class="ltx_text" id="S4.T1.3.14.12.2.3.2" style="font-size:90%;">]</span></cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.14.12.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text" id="S4.T1.3.14.12.3.1" style="font-size:90%;">SA-Xray</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.3.14.12.3.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib6" title="">6</a><span class="ltx_text" id="S4.T1.3.14.12.3.3.2" style="font-size:90%;">]</span></cite>
</th>
</tr>
<tr class="ltx_tr" id="S4.T1.3.15.13">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.15.13.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.15.13.1.1" style="font-size:90%;">FP Baseline</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.15.13.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.15.13.2.1" style="font-size:90%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.15.13.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.15.13.3.1" style="font-size:90%;">32/32</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.15.13.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.15.13.4.1" style="font-size:90%;">358</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.15.13.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.15.13.5.1" style="font-size:90%;">19866</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.15.13.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.15.13.6.1" style="font-size:90%;">64.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.15.13.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.15.13.7.1" style="font-size:90%;">69.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.15.13.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.15.13.8.1" style="font-size:90%;">47.63</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T1.3.15.13.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.15.13.9.1" style="font-size:90%;">60.42</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.16.14">
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.14.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.16.14.1.1" style="font-size:90%;">Real Data</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.14.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.16.14.2.1" style="font-size:90%;color:#CC4054;">✗</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.14.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.16.14.3.1" style="font-size:90%;">4/4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.14.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.16.14.4.1" style="font-size:90%;">46.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.14.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.16.14.5.1" style="font-size:90%;">346</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.14.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.16.14.6.1" style="font-size:90%;">64.11</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.14.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.16.14.7.1" style="font-size:90%;">69.18</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.14.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.16.14.8.1" style="font-size:90%;">47.70</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.16.14.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.16.14.9.1" style="font-size:90%;">60.33</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.17.15">
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.15.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.17.15.1.1" style="font-size:90%;">Gaussian Noise</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.15.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.17.15.2.1" style="font-size:90%;color:#40CC54;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.15.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.17.15.3.1" style="font-size:90%;">4/4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.15.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.17.15.4.1" style="font-size:90%;">46.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.15.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.17.15.5.1" style="font-size:90%;">346</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.15.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.17.15.6.1" style="font-size:90%;">62.84</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.15.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.17.15.7.1" style="font-size:90%;">68.36</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.15.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.17.15.8.1" style="font-size:90%;">44.35</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.17.15.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.17.15.9.1" style="font-size:90%;">58.52</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.18.16" style="background-color:#CCE6E6;">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.18.16.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.3.18.16.1.1" style="background-color:#CCE6E6;">
<tr class="ltx_tr" id="S4.T1.3.18.16.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.18.16.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.18.16.1.1.1.1.1" style="font-size:90%;">Synthesized Data</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.18.16.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T1.3.18.16.1.1.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text" id="S4.T1.3.18.16.1.1.2.1.1" style="font-size:90%;">(</span><span class="ltx_text ltx_font_bold" id="S4.T1.3.18.16.1.1.2.1.2" style="font-size:90%;">DFQ-SAM, Ours</span><span class="ltx_text" id="S4.T1.3.18.16.1.1.2.1.3" style="font-size:90%;">)</span>
</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.18.16.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.18.16.2.1" style="font-size:90%;color:#40CC54;background-color:#CCE6E6;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.18.16.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.18.16.3.1" style="font-size:90%;background-color:#CCE6E6;">4/4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.18.16.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.18.16.4.1" style="font-size:90%;background-color:#CCE6E6;">46.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.18.16.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.18.16.5.1" style="font-size:90%;background-color:#CCE6E6;">346</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.18.16.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.18.16.6.1" style="font-size:90%;background-color:#CCE6E6;">65.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.18.16.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.18.16.7.1" style="font-size:90%;background-color:#CCE6E6;">68.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.18.16.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.18.16.8.1" style="font-size:90%;background-color:#CCE6E6;">45.47</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S4.T1.3.18.16.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.3.18.16.9.1" style="font-size:90%;background-color:#CCE6E6;">59.97</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Quantization results on color medical images, with modalities of Dermoscopy and Endoscopy. DFQ-SAM is compared to methods that use real data or Gaussian noise for quantization. The reported values are the IoU results of segmentation masks on different datasets. We also present the model complexity, including model size and computational load (BOPs).</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.3.1.1.1" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.1.1.1.1" style="font-size:90%;">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.3.1.1.2" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.1.1.2.1" style="font-size:90%;">Privacy</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.3.1.1.3" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.1.1.3.1" style="font-size:90%;">Prec. (W/A)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.3.1.1.4" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.1.1.4.1" style="font-size:90%;">Size (MB)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.3.1.1.5" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.1.1.5.1" style="font-size:90%;">BOPs (G)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.3.1.1.6" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.1.1.6.1" style="font-size:90%;">Dermoscopy</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T2.3.1.1.7" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.1.1.7.1" style="font-size:90%;">Endoscopy</span></th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.3.1.1.8" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.1.1.8.1" style="font-size:90%;">Average</span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.3.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.3.2.2.1" style="padding-left:4.0pt;padding-right:4.0pt;">
<span class="ltx_text" id="S4.T2.3.2.2.1.1" style="font-size:90%;">ISIC</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.2.2.1.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib43" title="">43</a><span class="ltx_text" id="S4.T2.3.2.2.1.3.2" style="font-size:90%;">]</span></cite><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.2.2.1.4.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib44" title="">44</a><span class="ltx_text" id="S4.T2.3.2.2.1.5.2" style="font-size:90%;">]</span></cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.3.2.2.2" style="padding-left:4.0pt;padding-right:4.0pt;">
<span class="ltx_text" id="S4.T2.3.2.2.2.1" style="font-size:90%;">EndoVis</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.2.2.2.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib45" title="">45</a><span class="ltx_text" id="S4.T2.3.2.2.2.3.2" style="font-size:90%;">]</span></cite>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.3.2.2.3" style="padding-left:4.0pt;padding-right:4.0pt;">
<span class="ltx_text" id="S4.T2.3.2.2.3.1" style="font-size:90%;">SA-Endoscopy</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T2.3.2.2.3.2.1" style="font-size:90%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib6" title="">6</a><span class="ltx_text" id="S4.T2.3.2.2.3.3.2" style="font-size:90%;">]</span></cite>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.3.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.1.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.3.1.1.1" style="font-size:90%;">FP Baseline</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.1.2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.3.1.2.1" style="font-size:90%;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.1.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.3.1.3.1" style="font-size:90%;">32/32</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.1.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.3.1.4.1" style="font-size:90%;">358</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.1.5" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.3.1.5.1" style="font-size:90%;">19866</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.1.6" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.3.1.6.1" style="font-size:90%;">84.24</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.1.7" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.3.1.7.1" style="font-size:90%;">70.44</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.1.8" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.3.1.8.1" style="font-size:90%;">83.38</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.3.3.1.9" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.3.1.9.1" style="font-size:90%;">79.35</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.4.2">
<td class="ltx_td ltx_align_center" id="S4.T2.3.4.2.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.4.2.1.1" style="font-size:90%;">Real Data</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.4.2.2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.4.2.2.1" style="font-size:90%;color:#CC4054;">✗</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.4.2.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.4.2.3.1" style="font-size:90%;">4/4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.4.2.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.4.2.4.1" style="font-size:90%;">46.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.4.2.5" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.4.2.5.1" style="font-size:90%;">346</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.4.2.6" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.4.2.6.1" style="font-size:90%;">82.71</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.4.2.7" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.4.2.7.1" style="font-size:90%;">66.31</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.4.2.8" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.4.2.8.1" style="font-size:90%;">78.91</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.3.4.2.9" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.4.2.9.1" style="font-size:90%;">75.98</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.5.3">
<td class="ltx_td ltx_align_center" id="S4.T2.3.5.3.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.5.3.1.1" style="font-size:90%;">Gaussian Noise</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.5.3.2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.5.3.2.1" style="font-size:90%;color:#40CC54;">✓</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.5.3.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.5.3.3.1" style="font-size:90%;">4/4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.5.3.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.5.3.4.1" style="font-size:90%;">46.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.5.3.5" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.5.3.5.1" style="font-size:90%;">346</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.5.3.6" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.5.3.6.1" style="font-size:90%;">80.59</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.5.3.7" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.5.3.7.1" style="font-size:90%;">63.82</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.5.3.8" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.5.3.8.1" style="font-size:90%;">76.09</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.3.5.3.9" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.5.3.9.1" style="font-size:90%;">73.50</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.6.4" style="background-color:#CCE6E6;">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.3.6.4.1" style="padding-left:4.0pt;padding-right:4.0pt;">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.3.6.4.1.1" style="background-color:#CCE6E6;">
<tr class="ltx_tr" id="S4.T2.3.6.4.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.3.6.4.1.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.6.4.1.1.1.1.1" style="font-size:90%;">Synthesized Data</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.6.4.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.3.6.4.1.1.2.1" style="padding-left:4.0pt;padding-right:4.0pt;">
<span class="ltx_text" id="S4.T2.3.6.4.1.1.2.1.1" style="font-size:90%;">(</span><span class="ltx_text ltx_font_bold" id="S4.T2.3.6.4.1.1.2.1.2" style="font-size:90%;">DFQ-SAM, Ours</span><span class="ltx_text" id="S4.T2.3.6.4.1.1.2.1.3" style="font-size:90%;">)</span>
</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.3.6.4.2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.6.4.2.1" style="font-size:90%;color:#40CC54;background-color:#CCE6E6;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.3.6.4.3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.6.4.3.1" style="font-size:90%;background-color:#CCE6E6;">4/4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.3.6.4.4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.6.4.4.1" style="font-size:90%;background-color:#CCE6E6;">46.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.3.6.4.5" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.6.4.5.1" style="font-size:90%;background-color:#CCE6E6;">346</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.3.6.4.6" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.6.4.6.1" style="font-size:90%;background-color:#CCE6E6;">83.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.3.6.4.7" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.6.4.7.1" style="font-size:90%;background-color:#CCE6E6;">66.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.3.6.4.8" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.6.4.8.1" style="font-size:90%;background-color:#CCE6E6;">79.01</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S4.T2.3.6.4.9" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S4.T2.3.6.4.9.1" style="font-size:90%;background-color:#CCE6E6;">76.16</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.4"><span class="ltx_text ltx_font_bold" id="S4.SS3.p2.4.1">Main Results</span>
Tables <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4.T1" title="TABLE I ‣ 4.3 Accuracy Evaluation of Quantized Models ‣ 4 Experiments ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">I</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4.T2" title="TABLE II ‣ 4.3 Accuracy Evaluation of Quantized Models ‣ 4 Experiments ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">II</span></a> report the quantization results for image segmentation on grayscale and color datasets, respectively.
They also report the model complexity, including model size and computational load (BOPs), where the former is reduced by <math alttext="\sim" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mo id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><csymbol cd="latexml" id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">∼</annotation></semantics></math>8<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><mo id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><times id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">×</annotation></semantics></math> and the latter by <math alttext="\sim" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1"><semantics id="S4.SS3.p2.3.m3.1a"><mo id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><csymbol cd="latexml" id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.1d">∼</annotation></semantics></math>64<math alttext="\times" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1"><semantics id="S4.SS3.p2.4.m4.1a"><mo id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><times id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">×</annotation></semantics></math>.
We begin by discussing the results on grayscale datasets. Calibration using Gaussian noise apparently results in unsatisfactory performance; in contrast, DFQ-SAM achieves significantly improved performance by utilizing synthesized data.
For instance, in the CT modality, the average accuracy of DFQ-SAM in 4-bit quantization on the three datasets AbdomenCT1k, FLARE, and Synapse is 74.45, which is only a 1.83 degradation from the full-precision baseline.
DFQ-SAM also achieves encouraging performance on the datasets of MRI modalities ACDC, MSD, and ATLAS, with an average accuracy of 69.20, producing only 1.50 accuracy loss.
Moreover, the performance of DFQ-SAM remains robust on color datasets. For ISIC and SA-Endoscopy datasets, the accuracy of DFQ-SAM reaches 83.23 and 79.01, respectively, which is even higher than the real-data method, underscoring DFQ-SAM’s capability to maintain high accuracy.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p3.1.1">DFQ-SAM vs. Real-data Quant.</span>
We also present a more intuitive comparison between DFA-SAM and the real-data method, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4.F7.sf1" title="In Figure 7 ‣ 4.3 Accuracy Evaluation of Quantized Models ‣ 4 Experiments ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">7(a)</span></a>. The values are the difference in performance between the two, and a value greater than 0 is a case where DFQ-SAM outperforms the real-data method. Surprisingly, in most cases, DFQ-SAM is on the superior side, which means that the synthesized data is more effective for calibration than the real data. This is because the synthesized images learn the prior from the whole dataset and represent the comprehensive distribution of the overall dataset, and therefore have a better information capacity than the real data that represents individual instances.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p4.1.1">DFQ-SAM vs. FP Baseline</span>
Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4.F7.sf2" title="In Figure 7 ‣ 4.3 Accuracy Evaluation of Quantized Models ‣ 4 Experiments ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">7(b)</span></a> illustrates the performance radargram of DFQ-SAM and the full-precision baseline. Intuitively, DFQ-SAM, despite adopting low-bit quantization, continues to deliver performance that closely matches that of the high-precision pre-trained model across various datasets, effectively preserving critical features even with reduced bit precision.
Therefore, DFQ-SAM is proven capable of achieving near-lossless compression, fully demonstrating its reliability in real-world applications.</p>
</div>
<figure class="ltx_figure" id="S4.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="226" id="S4.F7.sf1.g1" src="x7.png" width="456"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F7.sf1.2.1.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="S4.F7.sf1.3.2" style="font-size:80%;">DFQ-SAM vs. Real-data Quant. </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="232" id="S4.F7.sf2.g1" src="x8.png" width="290"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F7.sf2.2.1.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="S4.F7.sf2.3.2" style="font-size:80%;">DFQ-SAM vs. FP Baseline</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Illustration of comparisons of quantization performance. (a) is a bar chart of the 4-bit performance differences between DFQ-SAM and real-data quantization on various datasets, which highlights that DFQ-SAM using synthesized data can outperform the method using real data in most cases. (b) is a performance radargram of DFQ-SAM versus the full-precision baseline across various image modalities, demonstrating that 4-bit DFQ-SAM can achieve comparable performance.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="380" id="S4.F8.sf1.g1" src="x9.png" width="664"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F8.sf1.2.1.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="S4.F8.sf1.3.2" style="font-size:80%;">AbdomenCT1k Dataset</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F8.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="382" id="S4.F8.sf2.g1" src="x10.png" width="664"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F8.sf2.2.1.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="S4.F8.sf2.3.2" style="font-size:80%;">FLARE Dataset</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Ablation experiments on the effectiveness of each component in DFQ-SAM. Each component contributes significantly, resulting in impressive performance of DFQ-SAM.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F9.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="379" id="S4.F9.sf1.g1" src="x11.png" width="739"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F9.sf1.4.2.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="S4.F9.sf1.2.1" style="font-size:80%;">Grid Search for <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.F9.sf1.2.1.m1.1"><semantics id="S4.F9.sf1.2.1.m1.1b"><mi id="S4.F9.sf1.2.1.m1.1.1" xref="S4.F9.sf1.2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.F9.sf1.2.1.m1.1c"><ci id="S4.F9.sf1.2.1.m1.1.1.cmml" xref="S4.F9.sf1.2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F9.sf1.2.1.m1.1d">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.F9.sf1.2.1.m1.1e">italic_α</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F9.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="390" id="S4.F9.sf2.g1" src="x12.png" width="739"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F9.sf2.4.2.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="S4.F9.sf2.2.1" style="font-size:80%;">Grid Search for <math alttext="\beta" class="ltx_Math" display="inline" id="S4.F9.sf2.2.1.m1.1"><semantics id="S4.F9.sf2.2.1.m1.1b"><mi id="S4.F9.sf2.2.1.m1.1.1" xref="S4.F9.sf2.2.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.F9.sf2.2.1.m1.1c"><ci id="S4.F9.sf2.2.1.m1.1.1.cmml" xref="S4.F9.sf2.2.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F9.sf2.2.1.m1.1d">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.F9.sf2.2.1.m1.1e">italic_β</annotation></semantics></math></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Grid search for balance hyperparameters <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.F9.3.m1.1"><semantics id="S4.F9.3.m1.1b"><mi id="S4.F9.3.m1.1.1" xref="S4.F9.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.F9.3.m1.1c"><ci id="S4.F9.3.m1.1.1.cmml" xref="S4.F9.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F9.3.m1.1d">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.F9.3.m1.1e">italic_α</annotation></semantics></math> and <math alttext="\beta" class="ltx_Math" display="inline" id="S4.F9.4.m2.1"><semantics id="S4.F9.4.m2.1b"><mi id="S4.F9.4.m2.1.1" xref="S4.F9.4.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.F9.4.m2.1c"><ci id="S4.F9.4.m2.1.1.cmml" xref="S4.F9.4.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F9.4.m2.1d">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.F9.4.m2.1e">italic_β</annotation></semantics></math>. The quantization performance is robust to hyperparameters, and their optimal values remain consistent across different datasets.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span><span class="ltx_text ltx_font_italic" id="S4.SS4.1.1">Ablation Studies</span>
</h3>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.1">Effectiveness of Each Component</span>
Here, we verify the effectiveness of each component in DFQ-SAM, and the results are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4.F8" title="Figure 8 ‣ 4.3 Accuracy Evaluation of Quantized Models ‣ 4 Experiments ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">8</span></a>. The initial baseline is established by optimizing Gaussian noise with random labels.
Building on this, the sequential addition of the proposed modules, including label evolution, patch similarity, and scale reparameterization, further enhances performance at each step. For instance, on AbdomenCT1k dataset, the initial accuracy is 68.73, and the improvements by the three components are 1.42, 2.46, and 1.71, respectively, resulting in a final accuracy of 74.32. Therefore, each component plays a crucial role in improving the overall performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.2"><span class="ltx_text ltx_font_bold" id="S4.SS4.p2.2.1">Grid Search for Hyperparameters</span>
We also assess the impact of the balance hyperparameters <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><mi id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_α</annotation></semantics></math> and <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m2.1"><semantics id="S4.SS4.p2.2.m2.1a"><mi id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><ci id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">italic_β</annotation></semantics></math> through a grid search and determine the optimal values. The results are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S4.F9" title="Figure 9 ‣ 4.3 Accuracy Evaluation of Quantized Models ‣ 4 Experiments ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">9</span></a>.
We observe that the quantization performance is robust to changes in hyperparameters, showing only minor variations, such as between 0.732 and 0.744. More importantly, they reach the optimal value at the same point (0.5, 0.05) across different datasets.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">Conclusion</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we propose DFQ-SAM, a model quantization framework for medical SAM without requiring any original training data, thus preserving data privacy in model compression and deployment.
DFQ-SAM effectively leverages the prior knowledge from the pre-trained model to invert the synthesized data, aligning it with real data in both semantic and distributional aspects. It then employs an advanced quantization calibration strategy, achieving near lossless 4-bit model compression. To the best of our knowledge, this is the first successful attempt at data-free quantization for SAM. Exhaustive experiments demonstrate that DFQ-SAM exhibits encouraging performance on a range of datasets with multiple modalities, even surpassing the real-data-driven approach.
With the proposed framework, the model complexity of medical SAM is significantly reduced, while data privacy is well protected in cloud-side collaboration, which facilitates the provision of safe, reliable, and fast intelligent medical services on resource-constrained devices. This helps to actively promote the downward sinking of high-quality medical resources, ensuring more equitable access to healthcare in remote and underdeveloped areas, which is crucial for addressing the current imbalance in the distribution of medical resources.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
C. Pramesh, R. A. Badwe, N. Bhoo-Pathy, C. M. Booth, G. Chinnaswamy, A. J. Dare, V. P. de Andrade, D. J. Hunter, S. Gopal, M. Gospodarowicz, <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">et al.</span>, “Priorities for cancer research in low-and middle-income countries: a global perspective,” <span class="ltx_text ltx_font_italic" id="bib.bib1.2.2">Nature medicine</span>, vol. 28, no. 4, pp. 649–657, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
A. F. Brito, E. Semenova, G. Dudas, G. W. Hassler, C. C. Kalinich, M. U. Kraemer, J. Ho, H. Tegally, G. Githinji, C. N. Agoti, <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">et al.</span>, “Global disparities in sars-cov-2 genomic surveillance,” <span class="ltx_text ltx_font_italic" id="bib.bib2.2.2">Nature communications</span>, vol. 13, no. 1, p. 7003, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
H. Gelband, R. Sankaranarayanan, C. L. Gauvreau, S. Horton, B. O. Anderson, F. Bray, J. Cleary, A. J. Dare, L. Denny, M. K. Gospodarowicz, <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">et al.</span>, “Costs, affordability, and feasibility of an essential package of cancer control interventions in low-income and middle-income countries: key messages from disease control priorities,” <span class="ltx_text ltx_font_italic" id="bib.bib3.2.2">The Lancet</span>, vol. 387, no. 10033, pp. 2133–2144, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
K. Chalkidou, P. Marquez, P. K. Dhillon, Y. Teerawattananon, T. Anothaisintawee, C. A. G. Gadelha, and R. Sullivan, “Evidence-informed frameworks for cost-effective cancer care and prevention in low, middle, and high-income countries,” <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">The lancet oncology</span>, vol. 15, no. 3, pp. e119–e131, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
J. Ma, Y. He, F. Li, L. Han, C. You, and B. Wang, “Segment anything in medical images,” <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Nature Communications</span>, vol. 15, no. 1, p. 654, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. Cheng, J. Ye, Z. Deng, J. Chen, T. Li, H. Wang, Y. Su, Z. Huang, J. Chen, L. Jiang, <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">et al.</span>, “Sam-med2d,” <span class="ltx_text ltx_font_italic" id="bib.bib6.2.2">arXiv preprint arXiv:2308.16184</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
X. Wei, J. Cao, Y. Jin, M. Lu, G. Wang, and S. Zhang, “I-medsam: Implicit medical image segmentation with segment anything,” <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2311.17081</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
C. Lv, H. Chen, J. Guo, Y. Ding, and X. Liu, “Ptq4sam: Post-training quantization for segment anything,” in <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span>, pp. 15941–15951, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
C. Zhang, D. Han, Y. Qiao, J. U. Kim, S.-H. Bae, S. Lee, and C. S. Hong, “Faster segment anything: Towards lightweight sam for mobile applications,” <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2306.14289</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
A. Gholami, S. Kim, Z. Dong, Z. Yao, M. W. Mahoney, and K. Keutzer, “A survey of quantization methods for efficient neural network inference,” in <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Low-Power Computer Vision</span>, pp. 291–326, Chapman and Hall/CRC, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
R. Krishnamoorthi, “Quantizing deep convolutional networks for efficient inference: A whitepaper,” <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:1806.08342</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
K. Wang, Z. Liu, Y. Lin, J. Lin, and S. Han, “Haq: Hardware-aware automated quantization with mixed precision,” in <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span>, pp. 8612–8620, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
S. K. Esser, J. L. McKinstry, D. Bablani, R. Appuswamy, and D. S. Modha, “Learned step size quantization,” <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:1902.08153</span>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Z. Li, X. Long, J. Xiao, and Q. Gu, “Htq: Exploring the high-dimensional trade-off of mixed-precision quantization,” <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">Pattern Recognition</span>, p. 110788, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Y. Cai, Z. Yao, Z. Dong, A. Gholami, M. W. Mahoney, and K. Keutzer, “Zeroq: A novel zero shot quantization framework,” in <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span>, pp. 13169–13178, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Y. Zhong, M. Lin, G. Nan, J. Liu, B. Zhang, Y. Tian, and R. Ji, “Intraq: Learning synthetic images with intra-class heterogeneity for zero-shot network quantization,” in <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span>, pp. 12339–12348, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
S. Xu, H. Li, B. Zhuang, J. Liu, J. Cao, C. Liang, and M. Tan, “Generative low-bitwidth data free quantization,” in <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part XII 16</span>, pp. 1–17, Springer, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
X. Zhang, H. Qin, Y. Ding, R. Gong, Q. Yan, R. Tao, Y. Li, F. Yu, and X. Liu, “Diversifying sample generation for accurate data-free quantization,” in <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</span>, pp. 15658–15667, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Z. Li, L. Ma, X. Long, J. Xiao, and Q. Gu, “Dual-discriminator adversarial framework for data-free quantization,” <span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">Neurocomputing</span>, vol. 511, pp. 67–77, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
C. Fan, Z. Wang, D. Guo, and M. Wang, “Data-free quantization via pseudo-label filtering,” in <span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</span>, pp. 5589–5598, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
A. Dosovitskiy, L. Beyer, A. Kolesnikov, D. Weissenborn, X. Zhai, T. Unterthiner, M. Dehghani, M. Minderer, G. Heigold, S. Gelly, <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">et al.</span>, “An image is worth 16x16 words: Transformers for image recognition at scale,” <span class="ltx_text ltx_font_italic" id="bib.bib21.2.2">arXiv preprint arXiv:2010.11929</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Z. Li, L. Ma, M. Chen, J. Xiao, and Q. Gu, “Patch similarity aware data-free quantization for vision transformers,” in <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">European conference on computer vision</span>, pp. 154–170, Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Z. Li, M. Chen, J. Xiao, and Q. Gu, “Psaq-vit v2: Toward accurate and general data-free quantization for vision transformers,” <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">IEEE Transactions on Neural Networks and Learning Systems</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Z. Li, J. Xiao, L. Yang, and Q. Gu, “Repq-vit: Scale reparameterization for post-training quantization of vision transformers,” in <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</span>, pp. 17227–17236, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
D. D. Patil and S. G. Deore, “Medical image segmentation: a review,” <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">International Journal of Computer Science and Mobile Computing</span>, vol. 2, no. 1, pp. 22–27, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
S. Wang, C. Li, R. Wang, Z. Liu, M. Wang, H. Tan, Y. Wu, X. Liu, H. Sun, R. Yang, <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">et al.</span>, “Annotation-efficient deep learning for automatic medical image segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib26.2.2">Nature communications</span>, vol. 12, no. 1, p. 5915, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Z. Zhou, M. M. Rahman Siddiquee, N. Tajbakhsh, and J. Liang, “Unet++: A nested u-net architecture for medical image segmentation,” in <span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">Deep Learning in Medical Image Analysis and Multimodal Learning for Clinical Decision Support: 4th International Workshop, DLMIA 2018, and 8th International Workshop, ML-CDS 2018, Held in Conjunction with MICCAI 2018, Granada, Spain, September 20, 2018, Proceedings 4</span>, pp. 3–11, Springer, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
J. Chen, Y. Lu, Q. Yu, X. Luo, E. Adeli, Y. Wang, L. Lu, A. L. Yuille, and Y. Zhou, “Transunet: Transformers make strong encoders for medical image segmentation,” <span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2102.04306</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
A. Kirillov, E. Mintun, N. Ravi, H. Mao, C. Rolland, L. Gustafson, T. Xiao, S. Whitehead, A. C. Berg, W.-Y. Lo, <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">et al.</span>, “Segment anything,” in <span class="ltx_text ltx_font_italic" id="bib.bib29.2.2">Proceedings of the IEEE/CVF International Conference on Computer Vision</span>, pp. 4015–4026, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
H. Wang, S. Guo, J. Ye, Z. Deng, J. Cheng, T.-X. Li, J. Chen, Y.-C. Su, Z. Huang, Y. Shen, B. Fu, S. Zhang, J. He, and Y. Qiao, “Sam-med3d,” <span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2310.15161</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
X. Zhao, W. Ding, Y. An, Y. Du, T. Yu, M. Li, M. Tang, and J. Wang, “Fast segment anything,” <span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2306.12156</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Z. Li and Q. Gu, “I-vit: Integer-only quantization for efficient vision transformer inference,” in <span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</span>, pp. 17065–17075, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Z. Li, X. Liu, J. Zhang, and Q. Gu, “Repquant: Towards accurate post-training quantization of large transformer models via scale reparameterization,” <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2402.05628</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
A. Chawla, H. Yin, P. Molchanov, and J. Alvarez, “Data-free knowledge distillation for object detection,” in <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision</span>, pp. 3289–3298, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
A. Kerr, D. Merrill, J. Demouth, and J. Tran, “Cutlass: Fast linear algebra in cuda c++,” <span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">NVIDIA Developer Blog</span>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
J. Ma, Y. Zhang, S. Gu, C. Zhu, C. Ge, Y. Zhang, X. An, C. Wang, Q. Wang, X. Liu, S. Cao, Q. Zhang, S. Liu, Y. Wang, Y. Li, J. He, and X. Yang, “Abdomenct-1k: Is abdominal organ segmentation a solved problem?,” <span class="ltx_text ltx_font_italic" id="bib.bib36.1.1">IEEE Transactions on Pattern Analysis and Machine Intelligence</span>, vol. 44, no. 10, pp. 6695–6714, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
J. Ma and B. Wang, <span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">Fast and Low-Resource Semi-supervised Abdominal Organ Segmentation: MICCAI 2022 Challenge, FLARE 2022, Held in Conjunction with MICCAI 2022, Singapore, September 22, 2022, Proceedings</span>, vol. 13816.

</span>
<span class="ltx_bibblock">Springer Nature, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
“Multi-atlas labeling beyond the cranial vault - workshop and challenge,” 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
O. Bernard, A. Lalande, C. Zotti, F. Cervenansky, X. Yang, P.-A. Heng, I. Cetin, K. Lekadir, O. Camara, M. A. G. Ballester, <span class="ltx_text ltx_font_italic" id="bib.bib39.1.1">et al.</span>, “Deep learning techniques for automatic mri cardiac multi-structures segmentation and diagnosis: is the problem solved?,” <span class="ltx_text ltx_font_italic" id="bib.bib39.2.2">IEEE transactions on medical imaging</span>, vol. 37, no. 11, pp. 2514–2525, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
M. Antonelli, A. Reinke, S. Bakas, K. Farahani, A. Kopp-Schneider, B. A. Landman, G. Litjens, B. Menze, O. Ronneberger, R. M. Summers, <span class="ltx_text ltx_font_italic" id="bib.bib40.1.1">et al.</span>, “The medical segmentation decathlon,” <span class="ltx_text ltx_font_italic" id="bib.bib40.2.2">Nature communications</span>, vol. 13, no. 1, p. 4128, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
F. Quinton, R. Popoff, B. Presles, S. Leclerc, F. Meriaudeau, G. Nodari, O. Lopez, J. Pellegrinelli, O. Chevallier, D. Ginhac, <span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">et al.</span>, “A tumour and liver automatic segmentation (atlas) dataset on contrast-enhanced magnetic resonance imaging for hepatocellular carcinoma,” <span class="ltx_text ltx_font_italic" id="bib.bib41.2.2">Data</span>, vol. 8, no. 5, p. 79, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
S. Gatidis, T. Hepp, M. Früh, C. La Fougère, K. Nikolaou, C. Pfannenberg, B. Schölkopf, T. Küstner, C. Cyran, and D. Rubin, “A whole-body fdg-pet/ct dataset with manually annotated tumor lesions,” <span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">Scientific Data</span>, vol. 9, no. 1, p. 601, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
D. Gutman, N. C. Codella, E. Celebi, B. Helba, M. Marchetti, N. Mishra, and A. Halpern, “Skin lesion analysis toward melanoma detection: A challenge at the international symposium on biomedical imaging (isbi) 2016, hosted by the international skin imaging collaboration (isic),” <span class="ltx_text ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:1605.01397</span>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
N. C. Codella, D. Gutman, M. E. Celebi, B. Helba, M. A. Marchetti, S. W. Dusza, A. Kalloo, K. Liopyris, N. Mishra, H. Kittler, <span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">et al.</span>, “Skin lesion analysis toward melanoma detection: A challenge at the 2017 international symposium on biomedical imaging (isbi), hosted by the international skin imaging collaboration (isic),” in <span class="ltx_text ltx_font_italic" id="bib.bib44.2.2">2018 IEEE 15th international symposium on biomedical imaging (ISBI 2018)</span>, pp. 168–172, IEEE, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
M. Allan, A. Shvets, T. Kurmann, Z. Zhang, R. Duggal, Y.-H. Su, N. Rieke, I. Laina, N. Kalavakonda, S. Bodenstedt, <span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">et al.</span>, “2017 robotic instrument segmentation challenge,” <span class="ltx_text ltx_font_italic" id="bib.bib45.2.2">arXiv preprint arXiv:1902.06426</span>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
D. P. Kingma and J. Ba, “Adam: A method for stochastic optimization,” <span class="ltx_text ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:1412.6980</span>, 2014.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Our preliminary efforts for DFQ-SAM</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">Our preliminary efforts, PSAQ-ViT<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib23" title="">23</a>]</cite> and RepQ-ViT<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib24" title="">24</a>]</cite>, have laid a strong foundation for the success of DFQ-SAM, allowing us to accomplish accurate low-bit model quantization without any original data. Here, we present their ideas and details.</p>
</div>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span><span class="ltx_text ltx_font_italic" id="A1.SS1.1.1">PSAQ-ViT: Patch Similarity Metric</span>
</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">PSAQ-ViT is the first successful attempt within the community to quantize Transformers without any original data, aiming to utilize the inherent prior information embedded in the unique properties of Transformer models to synthesize data. In the absence of an absolute value metric such as BatchNorm statistics, the approach focus on assessing the general difference in model inference when the input is Gaussian noise versus real images, and anticipates developing a <em class="ltx_emph ltx_font_italic" id="A1.SS1.p1.1.1">relative value</em> metric accordingly to optimize the noise by reducing the above difference.</p>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1">As noted by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib21" title="">21</a>]</cite>, the self-attention mechanism in Transformers is designed to extract key information during training, such as distinguishing the foreground from the background, which helps the model make accurate decisions. During the inference phase of a pre-trained model, real images generate varying responses between foreground and background patches, resulting in diverse patch similarities (i.e., differences in response similarity across patches). In contrast, Gaussian noise inputs, which do not clearly separate foreground from background, lead to more uniform responses.</p>
</div>
<div class="ltx_para" id="A1.SS1.p3">
<p class="ltx_p" id="A1.SS1.p3.1">Therefore, PSAQ-ViT treats the diversity of patch similarities as the key difference and quantifies this diversity using the differential entropy of patch responses in self-attention mechanism. By using this measure as an optimization criterion, the approach gradually transforms the image from Gaussian noise to one with increasingly diverse responses, thereby closely approximating a real image.</p>
</div>
<div class="ltx_para" id="A1.SS1.p4">
<p class="ltx_p" id="A1.SS1.p4.1">The patch similarity, its differential entropy, and the loss are presented in Eqs. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E7" title="In 3.2 Data Synthesis from Pre-trained SAM ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">7</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E8" title="In 3.2 Data Synthesis from Pre-trained SAM ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">8</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E9" title="In 3.2 Data Synthesis from Pre-trained SAM ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">9</span></a>, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span><span class="ltx_text ltx_font_italic" id="A1.SS2.1.1">RepQ-ViT: Scale Reparameterization</span>
</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">RepQ-ViT enables accurate low-bit (e.g., 4-bit) quantization calibration without the need for cumbersome and resource-intensive training or fine-tuning. It achieves this by elegantly addressing the challenge of quantizing components with extreme distributions. Specifically, it proposes a novel quantization-inference decoupling paradigm, where the former employs complex quantizers to maintain the data distribution as much as possible, and the latter employs simplified quantizers to perform fast inference. And importantly, the two can be equivalently transformed by scale reparameterization.</p>
</div>
<div class="ltx_para" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.1">The proposed paradigm is remarkably effective for components with extreme distributions, especially LayerNorm activations with severe inter-channel variance. RepQ-ViT first performs channel-wise quantization for LayerNorm activations in the quantization process, i.e., each channel has a unique quantization scale, and then equivalently transforms to layer-wise quantization in the inference process, i.e., all channels share a unified quantization scale. In the following we describe the derivation of the equivalent transformations.</p>
</div>
<div class="ltx_para" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.10">Given LayerNorm activations <math alttext="\bm{X}" class="ltx_Math" display="inline" id="A1.SS2.p3.1.m1.1"><semantics id="A1.SS2.p3.1.m1.1a"><mi id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><ci id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">\bm{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.1.m1.1d">bold_italic_X</annotation></semantics></math>, when performing channel-wise quantization, the quantization scale <math alttext="\bm{s}\in R^{D}" class="ltx_Math" display="inline" id="A1.SS2.p3.2.m2.1"><semantics id="A1.SS2.p3.2.m2.1a"><mrow id="A1.SS2.p3.2.m2.1.1" xref="A1.SS2.p3.2.m2.1.1.cmml"><mi id="A1.SS2.p3.2.m2.1.1.2" xref="A1.SS2.p3.2.m2.1.1.2.cmml">𝒔</mi><mo id="A1.SS2.p3.2.m2.1.1.1" xref="A1.SS2.p3.2.m2.1.1.1.cmml">∈</mo><msup id="A1.SS2.p3.2.m2.1.1.3" xref="A1.SS2.p3.2.m2.1.1.3.cmml"><mi id="A1.SS2.p3.2.m2.1.1.3.2" xref="A1.SS2.p3.2.m2.1.1.3.2.cmml">R</mi><mi id="A1.SS2.p3.2.m2.1.1.3.3" xref="A1.SS2.p3.2.m2.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.1b"><apply id="A1.SS2.p3.2.m2.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1"><in id="A1.SS2.p3.2.m2.1.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1.1"></in><ci id="A1.SS2.p3.2.m2.1.1.2.cmml" xref="A1.SS2.p3.2.m2.1.1.2">𝒔</ci><apply id="A1.SS2.p3.2.m2.1.1.3.cmml" xref="A1.SS2.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.2.m2.1.1.3.1.cmml" xref="A1.SS2.p3.2.m2.1.1.3">superscript</csymbol><ci id="A1.SS2.p3.2.m2.1.1.3.2.cmml" xref="A1.SS2.p3.2.m2.1.1.3.2">𝑅</ci><ci id="A1.SS2.p3.2.m2.1.1.3.3.cmml" xref="A1.SS2.p3.2.m2.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.1c">\bm{s}\in R^{D}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.2.m2.1d">bold_italic_s ∈ italic_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> and zero-point <math alttext="\bm{z}\in Z^{D}" class="ltx_Math" display="inline" id="A1.SS2.p3.3.m3.1"><semantics id="A1.SS2.p3.3.m3.1a"><mrow id="A1.SS2.p3.3.m3.1.1" xref="A1.SS2.p3.3.m3.1.1.cmml"><mi id="A1.SS2.p3.3.m3.1.1.2" xref="A1.SS2.p3.3.m3.1.1.2.cmml">𝒛</mi><mo id="A1.SS2.p3.3.m3.1.1.1" xref="A1.SS2.p3.3.m3.1.1.1.cmml">∈</mo><msup id="A1.SS2.p3.3.m3.1.1.3" xref="A1.SS2.p3.3.m3.1.1.3.cmml"><mi id="A1.SS2.p3.3.m3.1.1.3.2" xref="A1.SS2.p3.3.m3.1.1.3.2.cmml">Z</mi><mi id="A1.SS2.p3.3.m3.1.1.3.3" xref="A1.SS2.p3.3.m3.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.3.m3.1b"><apply id="A1.SS2.p3.3.m3.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1"><in id="A1.SS2.p3.3.m3.1.1.1.cmml" xref="A1.SS2.p3.3.m3.1.1.1"></in><ci id="A1.SS2.p3.3.m3.1.1.2.cmml" xref="A1.SS2.p3.3.m3.1.1.2">𝒛</ci><apply id="A1.SS2.p3.3.m3.1.1.3.cmml" xref="A1.SS2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.3.m3.1.1.3.1.cmml" xref="A1.SS2.p3.3.m3.1.1.3">superscript</csymbol><ci id="A1.SS2.p3.3.m3.1.1.3.2.cmml" xref="A1.SS2.p3.3.m3.1.1.3.2">𝑍</ci><ci id="A1.SS2.p3.3.m3.1.1.3.3.cmml" xref="A1.SS2.p3.3.m3.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.3.m3.1c">\bm{z}\in Z^{D}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.3.m3.1d">bold_italic_z ∈ italic_Z start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> are obtained.
The objective is to reparameterize them into scalars <math alttext="\tilde{s}\in R^{1}" class="ltx_Math" display="inline" id="A1.SS2.p3.4.m4.1"><semantics id="A1.SS2.p3.4.m4.1a"><mrow id="A1.SS2.p3.4.m4.1.1" xref="A1.SS2.p3.4.m4.1.1.cmml"><mover accent="true" id="A1.SS2.p3.4.m4.1.1.2" xref="A1.SS2.p3.4.m4.1.1.2.cmml"><mi id="A1.SS2.p3.4.m4.1.1.2.2" xref="A1.SS2.p3.4.m4.1.1.2.2.cmml">s</mi><mo id="A1.SS2.p3.4.m4.1.1.2.1" xref="A1.SS2.p3.4.m4.1.1.2.1.cmml">~</mo></mover><mo id="A1.SS2.p3.4.m4.1.1.1" xref="A1.SS2.p3.4.m4.1.1.1.cmml">∈</mo><msup id="A1.SS2.p3.4.m4.1.1.3" xref="A1.SS2.p3.4.m4.1.1.3.cmml"><mi id="A1.SS2.p3.4.m4.1.1.3.2" xref="A1.SS2.p3.4.m4.1.1.3.2.cmml">R</mi><mn id="A1.SS2.p3.4.m4.1.1.3.3" xref="A1.SS2.p3.4.m4.1.1.3.3.cmml">1</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.4.m4.1b"><apply id="A1.SS2.p3.4.m4.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1"><in id="A1.SS2.p3.4.m4.1.1.1.cmml" xref="A1.SS2.p3.4.m4.1.1.1"></in><apply id="A1.SS2.p3.4.m4.1.1.2.cmml" xref="A1.SS2.p3.4.m4.1.1.2"><ci id="A1.SS2.p3.4.m4.1.1.2.1.cmml" xref="A1.SS2.p3.4.m4.1.1.2.1">~</ci><ci id="A1.SS2.p3.4.m4.1.1.2.2.cmml" xref="A1.SS2.p3.4.m4.1.1.2.2">𝑠</ci></apply><apply id="A1.SS2.p3.4.m4.1.1.3.cmml" xref="A1.SS2.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m4.1.1.3.1.cmml" xref="A1.SS2.p3.4.m4.1.1.3">superscript</csymbol><ci id="A1.SS2.p3.4.m4.1.1.3.2.cmml" xref="A1.SS2.p3.4.m4.1.1.3.2">𝑅</ci><cn id="A1.SS2.p3.4.m4.1.1.3.3.cmml" type="integer" xref="A1.SS2.p3.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.4.m4.1c">\tilde{s}\in R^{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.4.m4.1d">over~ start_ARG italic_s end_ARG ∈ italic_R start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\tilde{z}\in Z^{1}" class="ltx_Math" display="inline" id="A1.SS2.p3.5.m5.1"><semantics id="A1.SS2.p3.5.m5.1a"><mrow id="A1.SS2.p3.5.m5.1.1" xref="A1.SS2.p3.5.m5.1.1.cmml"><mover accent="true" id="A1.SS2.p3.5.m5.1.1.2" xref="A1.SS2.p3.5.m5.1.1.2.cmml"><mi id="A1.SS2.p3.5.m5.1.1.2.2" xref="A1.SS2.p3.5.m5.1.1.2.2.cmml">z</mi><mo id="A1.SS2.p3.5.m5.1.1.2.1" xref="A1.SS2.p3.5.m5.1.1.2.1.cmml">~</mo></mover><mo id="A1.SS2.p3.5.m5.1.1.1" xref="A1.SS2.p3.5.m5.1.1.1.cmml">∈</mo><msup id="A1.SS2.p3.5.m5.1.1.3" xref="A1.SS2.p3.5.m5.1.1.3.cmml"><mi id="A1.SS2.p3.5.m5.1.1.3.2" xref="A1.SS2.p3.5.m5.1.1.3.2.cmml">Z</mi><mn id="A1.SS2.p3.5.m5.1.1.3.3" xref="A1.SS2.p3.5.m5.1.1.3.3.cmml">1</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.5.m5.1b"><apply id="A1.SS2.p3.5.m5.1.1.cmml" xref="A1.SS2.p3.5.m5.1.1"><in id="A1.SS2.p3.5.m5.1.1.1.cmml" xref="A1.SS2.p3.5.m5.1.1.1"></in><apply id="A1.SS2.p3.5.m5.1.1.2.cmml" xref="A1.SS2.p3.5.m5.1.1.2"><ci id="A1.SS2.p3.5.m5.1.1.2.1.cmml" xref="A1.SS2.p3.5.m5.1.1.2.1">~</ci><ci id="A1.SS2.p3.5.m5.1.1.2.2.cmml" xref="A1.SS2.p3.5.m5.1.1.2.2">𝑧</ci></apply><apply id="A1.SS2.p3.5.m5.1.1.3.cmml" xref="A1.SS2.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p3.5.m5.1.1.3.1.cmml" xref="A1.SS2.p3.5.m5.1.1.3">superscript</csymbol><ci id="A1.SS2.p3.5.m5.1.1.3.2.cmml" xref="A1.SS2.p3.5.m5.1.1.3.2">𝑍</ci><cn id="A1.SS2.p3.5.m5.1.1.3.3.cmml" type="integer" xref="A1.SS2.p3.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.5.m5.1c">\tilde{z}\in Z^{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.5.m5.1d">over~ start_ARG italic_z end_ARG ∈ italic_Z start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math> to accommodate layer-wise quantization.
Here, <math alttext="\tilde{s}" class="ltx_Math" display="inline" id="A1.SS2.p3.6.m6.1"><semantics id="A1.SS2.p3.6.m6.1a"><mover accent="true" id="A1.SS2.p3.6.m6.1.1" xref="A1.SS2.p3.6.m6.1.1.cmml"><mi id="A1.SS2.p3.6.m6.1.1.2" xref="A1.SS2.p3.6.m6.1.1.2.cmml">s</mi><mo id="A1.SS2.p3.6.m6.1.1.1" xref="A1.SS2.p3.6.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.6.m6.1b"><apply id="A1.SS2.p3.6.m6.1.1.cmml" xref="A1.SS2.p3.6.m6.1.1"><ci id="A1.SS2.p3.6.m6.1.1.1.cmml" xref="A1.SS2.p3.6.m6.1.1.1">~</ci><ci id="A1.SS2.p3.6.m6.1.1.2.cmml" xref="A1.SS2.p3.6.m6.1.1.2">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.6.m6.1c">\tilde{s}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.6.m6.1d">over~ start_ARG italic_s end_ARG</annotation></semantics></math> and <math alttext="\tilde{z}" class="ltx_Math" display="inline" id="A1.SS2.p3.7.m7.1"><semantics id="A1.SS2.p3.7.m7.1a"><mover accent="true" id="A1.SS2.p3.7.m7.1.1" xref="A1.SS2.p3.7.m7.1.1.cmml"><mi id="A1.SS2.p3.7.m7.1.1.2" xref="A1.SS2.p3.7.m7.1.1.2.cmml">z</mi><mo id="A1.SS2.p3.7.m7.1.1.1" xref="A1.SS2.p3.7.m7.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.7.m7.1b"><apply id="A1.SS2.p3.7.m7.1.1.cmml" xref="A1.SS2.p3.7.m7.1.1"><ci id="A1.SS2.p3.7.m7.1.1.1.cmml" xref="A1.SS2.p3.7.m7.1.1.1">~</ci><ci id="A1.SS2.p3.7.m7.1.1.2.cmml" xref="A1.SS2.p3.7.m7.1.1.2">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.7.m7.1c">\tilde{z}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.7.m7.1d">over~ start_ARG italic_z end_ARG</annotation></semantics></math> are pre-specified and set to their respective mean values, i.e., <math alttext="\tilde{s}=\text{E}[\bm{s}],\tilde{z}=\text{E}[\bm{z}]" class="ltx_Math" display="inline" id="A1.SS2.p3.8.m8.4"><semantics id="A1.SS2.p3.8.m8.4a"><mrow id="A1.SS2.p3.8.m8.4.4.2" xref="A1.SS2.p3.8.m8.4.4.3.cmml"><mrow id="A1.SS2.p3.8.m8.3.3.1.1" xref="A1.SS2.p3.8.m8.3.3.1.1.cmml"><mover accent="true" id="A1.SS2.p3.8.m8.3.3.1.1.2" xref="A1.SS2.p3.8.m8.3.3.1.1.2.cmml"><mi id="A1.SS2.p3.8.m8.3.3.1.1.2.2" xref="A1.SS2.p3.8.m8.3.3.1.1.2.2.cmml">s</mi><mo id="A1.SS2.p3.8.m8.3.3.1.1.2.1" xref="A1.SS2.p3.8.m8.3.3.1.1.2.1.cmml">~</mo></mover><mo id="A1.SS2.p3.8.m8.3.3.1.1.1" xref="A1.SS2.p3.8.m8.3.3.1.1.1.cmml">=</mo><mrow id="A1.SS2.p3.8.m8.3.3.1.1.3" xref="A1.SS2.p3.8.m8.3.3.1.1.3.cmml"><mtext id="A1.SS2.p3.8.m8.3.3.1.1.3.2" xref="A1.SS2.p3.8.m8.3.3.1.1.3.2a.cmml">E</mtext><mo id="A1.SS2.p3.8.m8.3.3.1.1.3.1" xref="A1.SS2.p3.8.m8.3.3.1.1.3.1.cmml">⁢</mo><mrow id="A1.SS2.p3.8.m8.3.3.1.1.3.3.2" xref="A1.SS2.p3.8.m8.3.3.1.1.3.3.1.cmml"><mo id="A1.SS2.p3.8.m8.3.3.1.1.3.3.2.1" stretchy="false" xref="A1.SS2.p3.8.m8.3.3.1.1.3.3.1.1.cmml">[</mo><mi id="A1.SS2.p3.8.m8.1.1" xref="A1.SS2.p3.8.m8.1.1.cmml">𝒔</mi><mo id="A1.SS2.p3.8.m8.3.3.1.1.3.3.2.2" stretchy="false" xref="A1.SS2.p3.8.m8.3.3.1.1.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="A1.SS2.p3.8.m8.4.4.2.3" xref="A1.SS2.p3.8.m8.4.4.3a.cmml">,</mo><mrow id="A1.SS2.p3.8.m8.4.4.2.2" xref="A1.SS2.p3.8.m8.4.4.2.2.cmml"><mover accent="true" id="A1.SS2.p3.8.m8.4.4.2.2.2" xref="A1.SS2.p3.8.m8.4.4.2.2.2.cmml"><mi id="A1.SS2.p3.8.m8.4.4.2.2.2.2" xref="A1.SS2.p3.8.m8.4.4.2.2.2.2.cmml">z</mi><mo id="A1.SS2.p3.8.m8.4.4.2.2.2.1" xref="A1.SS2.p3.8.m8.4.4.2.2.2.1.cmml">~</mo></mover><mo id="A1.SS2.p3.8.m8.4.4.2.2.1" xref="A1.SS2.p3.8.m8.4.4.2.2.1.cmml">=</mo><mrow id="A1.SS2.p3.8.m8.4.4.2.2.3" xref="A1.SS2.p3.8.m8.4.4.2.2.3.cmml"><mtext id="A1.SS2.p3.8.m8.4.4.2.2.3.2" xref="A1.SS2.p3.8.m8.4.4.2.2.3.2a.cmml">E</mtext><mo id="A1.SS2.p3.8.m8.4.4.2.2.3.1" xref="A1.SS2.p3.8.m8.4.4.2.2.3.1.cmml">⁢</mo><mrow id="A1.SS2.p3.8.m8.4.4.2.2.3.3.2" xref="A1.SS2.p3.8.m8.4.4.2.2.3.3.1.cmml"><mo id="A1.SS2.p3.8.m8.4.4.2.2.3.3.2.1" stretchy="false" xref="A1.SS2.p3.8.m8.4.4.2.2.3.3.1.1.cmml">[</mo><mi id="A1.SS2.p3.8.m8.2.2" xref="A1.SS2.p3.8.m8.2.2.cmml">𝒛</mi><mo id="A1.SS2.p3.8.m8.4.4.2.2.3.3.2.2" stretchy="false" xref="A1.SS2.p3.8.m8.4.4.2.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.8.m8.4b"><apply id="A1.SS2.p3.8.m8.4.4.3.cmml" xref="A1.SS2.p3.8.m8.4.4.2"><csymbol cd="ambiguous" id="A1.SS2.p3.8.m8.4.4.3a.cmml" xref="A1.SS2.p3.8.m8.4.4.2.3">formulae-sequence</csymbol><apply id="A1.SS2.p3.8.m8.3.3.1.1.cmml" xref="A1.SS2.p3.8.m8.3.3.1.1"><eq id="A1.SS2.p3.8.m8.3.3.1.1.1.cmml" xref="A1.SS2.p3.8.m8.3.3.1.1.1"></eq><apply id="A1.SS2.p3.8.m8.3.3.1.1.2.cmml" xref="A1.SS2.p3.8.m8.3.3.1.1.2"><ci id="A1.SS2.p3.8.m8.3.3.1.1.2.1.cmml" xref="A1.SS2.p3.8.m8.3.3.1.1.2.1">~</ci><ci id="A1.SS2.p3.8.m8.3.3.1.1.2.2.cmml" xref="A1.SS2.p3.8.m8.3.3.1.1.2.2">𝑠</ci></apply><apply id="A1.SS2.p3.8.m8.3.3.1.1.3.cmml" xref="A1.SS2.p3.8.m8.3.3.1.1.3"><times id="A1.SS2.p3.8.m8.3.3.1.1.3.1.cmml" xref="A1.SS2.p3.8.m8.3.3.1.1.3.1"></times><ci id="A1.SS2.p3.8.m8.3.3.1.1.3.2a.cmml" xref="A1.SS2.p3.8.m8.3.3.1.1.3.2"><mtext id="A1.SS2.p3.8.m8.3.3.1.1.3.2.cmml" xref="A1.SS2.p3.8.m8.3.3.1.1.3.2">E</mtext></ci><apply id="A1.SS2.p3.8.m8.3.3.1.1.3.3.1.cmml" xref="A1.SS2.p3.8.m8.3.3.1.1.3.3.2"><csymbol cd="latexml" id="A1.SS2.p3.8.m8.3.3.1.1.3.3.1.1.cmml" xref="A1.SS2.p3.8.m8.3.3.1.1.3.3.2.1">delimited-[]</csymbol><ci id="A1.SS2.p3.8.m8.1.1.cmml" xref="A1.SS2.p3.8.m8.1.1">𝒔</ci></apply></apply></apply><apply id="A1.SS2.p3.8.m8.4.4.2.2.cmml" xref="A1.SS2.p3.8.m8.4.4.2.2"><eq id="A1.SS2.p3.8.m8.4.4.2.2.1.cmml" xref="A1.SS2.p3.8.m8.4.4.2.2.1"></eq><apply id="A1.SS2.p3.8.m8.4.4.2.2.2.cmml" xref="A1.SS2.p3.8.m8.4.4.2.2.2"><ci id="A1.SS2.p3.8.m8.4.4.2.2.2.1.cmml" xref="A1.SS2.p3.8.m8.4.4.2.2.2.1">~</ci><ci id="A1.SS2.p3.8.m8.4.4.2.2.2.2.cmml" xref="A1.SS2.p3.8.m8.4.4.2.2.2.2">𝑧</ci></apply><apply id="A1.SS2.p3.8.m8.4.4.2.2.3.cmml" xref="A1.SS2.p3.8.m8.4.4.2.2.3"><times id="A1.SS2.p3.8.m8.4.4.2.2.3.1.cmml" xref="A1.SS2.p3.8.m8.4.4.2.2.3.1"></times><ci id="A1.SS2.p3.8.m8.4.4.2.2.3.2a.cmml" xref="A1.SS2.p3.8.m8.4.4.2.2.3.2"><mtext id="A1.SS2.p3.8.m8.4.4.2.2.3.2.cmml" xref="A1.SS2.p3.8.m8.4.4.2.2.3.2">E</mtext></ci><apply id="A1.SS2.p3.8.m8.4.4.2.2.3.3.1.cmml" xref="A1.SS2.p3.8.m8.4.4.2.2.3.3.2"><csymbol cd="latexml" id="A1.SS2.p3.8.m8.4.4.2.2.3.3.1.1.cmml" xref="A1.SS2.p3.8.m8.4.4.2.2.3.3.2.1">delimited-[]</csymbol><ci id="A1.SS2.p3.8.m8.2.2.cmml" xref="A1.SS2.p3.8.m8.2.2">𝒛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.8.m8.4c">\tilde{s}=\text{E}[\bm{s}],\tilde{z}=\text{E}[\bm{z}]</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.8.m8.4d">over~ start_ARG italic_s end_ARG = E [ bold_italic_s ] , over~ start_ARG italic_z end_ARG = E [ bold_italic_z ]</annotation></semantics></math>. Introducing the variation factors <math alttext="\bm{r}_{1}=\bm{s}/\tilde{\bm{s}}" class="ltx_Math" display="inline" id="A1.SS2.p3.9.m9.1"><semantics id="A1.SS2.p3.9.m9.1a"><mrow id="A1.SS2.p3.9.m9.1.1" xref="A1.SS2.p3.9.m9.1.1.cmml"><msub id="A1.SS2.p3.9.m9.1.1.2" xref="A1.SS2.p3.9.m9.1.1.2.cmml"><mi id="A1.SS2.p3.9.m9.1.1.2.2" xref="A1.SS2.p3.9.m9.1.1.2.2.cmml">𝒓</mi><mn id="A1.SS2.p3.9.m9.1.1.2.3" xref="A1.SS2.p3.9.m9.1.1.2.3.cmml">1</mn></msub><mo id="A1.SS2.p3.9.m9.1.1.1" xref="A1.SS2.p3.9.m9.1.1.1.cmml">=</mo><mrow id="A1.SS2.p3.9.m9.1.1.3" xref="A1.SS2.p3.9.m9.1.1.3.cmml"><mi id="A1.SS2.p3.9.m9.1.1.3.2" xref="A1.SS2.p3.9.m9.1.1.3.2.cmml">𝒔</mi><mo id="A1.SS2.p3.9.m9.1.1.3.1" xref="A1.SS2.p3.9.m9.1.1.3.1.cmml">/</mo><mover accent="true" id="A1.SS2.p3.9.m9.1.1.3.3" xref="A1.SS2.p3.9.m9.1.1.3.3.cmml"><mi id="A1.SS2.p3.9.m9.1.1.3.3.2" xref="A1.SS2.p3.9.m9.1.1.3.3.2.cmml">𝒔</mi><mo id="A1.SS2.p3.9.m9.1.1.3.3.1" xref="A1.SS2.p3.9.m9.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.9.m9.1b"><apply id="A1.SS2.p3.9.m9.1.1.cmml" xref="A1.SS2.p3.9.m9.1.1"><eq id="A1.SS2.p3.9.m9.1.1.1.cmml" xref="A1.SS2.p3.9.m9.1.1.1"></eq><apply id="A1.SS2.p3.9.m9.1.1.2.cmml" xref="A1.SS2.p3.9.m9.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p3.9.m9.1.1.2.1.cmml" xref="A1.SS2.p3.9.m9.1.1.2">subscript</csymbol><ci id="A1.SS2.p3.9.m9.1.1.2.2.cmml" xref="A1.SS2.p3.9.m9.1.1.2.2">𝒓</ci><cn id="A1.SS2.p3.9.m9.1.1.2.3.cmml" type="integer" xref="A1.SS2.p3.9.m9.1.1.2.3">1</cn></apply><apply id="A1.SS2.p3.9.m9.1.1.3.cmml" xref="A1.SS2.p3.9.m9.1.1.3"><divide id="A1.SS2.p3.9.m9.1.1.3.1.cmml" xref="A1.SS2.p3.9.m9.1.1.3.1"></divide><ci id="A1.SS2.p3.9.m9.1.1.3.2.cmml" xref="A1.SS2.p3.9.m9.1.1.3.2">𝒔</ci><apply id="A1.SS2.p3.9.m9.1.1.3.3.cmml" xref="A1.SS2.p3.9.m9.1.1.3.3"><ci id="A1.SS2.p3.9.m9.1.1.3.3.1.cmml" xref="A1.SS2.p3.9.m9.1.1.3.3.1">~</ci><ci id="A1.SS2.p3.9.m9.1.1.3.3.2.cmml" xref="A1.SS2.p3.9.m9.1.1.3.3.2">𝒔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.9.m9.1c">\bm{r}_{1}=\bm{s}/\tilde{\bm{s}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.9.m9.1d">bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = bold_italic_s / over~ start_ARG bold_italic_s end_ARG</annotation></semantics></math> and <math alttext="\bm{r}_{2}=\bm{z}-\tilde{\bm{z}}" class="ltx_Math" display="inline" id="A1.SS2.p3.10.m10.1"><semantics id="A1.SS2.p3.10.m10.1a"><mrow id="A1.SS2.p3.10.m10.1.1" xref="A1.SS2.p3.10.m10.1.1.cmml"><msub id="A1.SS2.p3.10.m10.1.1.2" xref="A1.SS2.p3.10.m10.1.1.2.cmml"><mi id="A1.SS2.p3.10.m10.1.1.2.2" xref="A1.SS2.p3.10.m10.1.1.2.2.cmml">𝒓</mi><mn id="A1.SS2.p3.10.m10.1.1.2.3" xref="A1.SS2.p3.10.m10.1.1.2.3.cmml">2</mn></msub><mo id="A1.SS2.p3.10.m10.1.1.1" xref="A1.SS2.p3.10.m10.1.1.1.cmml">=</mo><mrow id="A1.SS2.p3.10.m10.1.1.3" xref="A1.SS2.p3.10.m10.1.1.3.cmml"><mi id="A1.SS2.p3.10.m10.1.1.3.2" xref="A1.SS2.p3.10.m10.1.1.3.2.cmml">𝒛</mi><mo id="A1.SS2.p3.10.m10.1.1.3.1" xref="A1.SS2.p3.10.m10.1.1.3.1.cmml">−</mo><mover accent="true" id="A1.SS2.p3.10.m10.1.1.3.3" xref="A1.SS2.p3.10.m10.1.1.3.3.cmml"><mi id="A1.SS2.p3.10.m10.1.1.3.3.2" xref="A1.SS2.p3.10.m10.1.1.3.3.2.cmml">𝒛</mi><mo id="A1.SS2.p3.10.m10.1.1.3.3.1" xref="A1.SS2.p3.10.m10.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.10.m10.1b"><apply id="A1.SS2.p3.10.m10.1.1.cmml" xref="A1.SS2.p3.10.m10.1.1"><eq id="A1.SS2.p3.10.m10.1.1.1.cmml" xref="A1.SS2.p3.10.m10.1.1.1"></eq><apply id="A1.SS2.p3.10.m10.1.1.2.cmml" xref="A1.SS2.p3.10.m10.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p3.10.m10.1.1.2.1.cmml" xref="A1.SS2.p3.10.m10.1.1.2">subscript</csymbol><ci id="A1.SS2.p3.10.m10.1.1.2.2.cmml" xref="A1.SS2.p3.10.m10.1.1.2.2">𝒓</ci><cn id="A1.SS2.p3.10.m10.1.1.2.3.cmml" type="integer" xref="A1.SS2.p3.10.m10.1.1.2.3">2</cn></apply><apply id="A1.SS2.p3.10.m10.1.1.3.cmml" xref="A1.SS2.p3.10.m10.1.1.3"><minus id="A1.SS2.p3.10.m10.1.1.3.1.cmml" xref="A1.SS2.p3.10.m10.1.1.3.1"></minus><ci id="A1.SS2.p3.10.m10.1.1.3.2.cmml" xref="A1.SS2.p3.10.m10.1.1.3.2">𝒛</ci><apply id="A1.SS2.p3.10.m10.1.1.3.3.cmml" xref="A1.SS2.p3.10.m10.1.1.3.3"><ci id="A1.SS2.p3.10.m10.1.1.3.3.1.cmml" xref="A1.SS2.p3.10.m10.1.1.3.3.1">~</ci><ci id="A1.SS2.p3.10.m10.1.1.3.3.2.cmml" xref="A1.SS2.p3.10.m10.1.1.3.3.2">𝒛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.10.m10.1c">\bm{r}_{2}=\bm{z}-\tilde{\bm{z}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.10.m10.1d">bold_italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = bold_italic_z - over~ start_ARG bold_italic_z end_ARG</annotation></semantics></math>, the following equations are established:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx2">
<tbody id="A1.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{\bm{z}}" class="ltx_Math" display="inline" id="A1.E12.m1.1"><semantics id="A1.E12.m1.1a"><mover accent="true" id="A1.E12.m1.1.1" xref="A1.E12.m1.1.1.cmml"><mi id="A1.E12.m1.1.1.2" xref="A1.E12.m1.1.1.2.cmml">𝒛</mi><mo id="A1.E12.m1.1.1.1" xref="A1.E12.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A1.E12.m1.1b"><apply id="A1.E12.m1.1.1.cmml" xref="A1.E12.m1.1.1"><ci id="A1.E12.m1.1.1.1.cmml" xref="A1.E12.m1.1.1.1">~</ci><ci id="A1.E12.m1.1.1.2.cmml" xref="A1.E12.m1.1.1.2">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.1c">\displaystyle\tilde{\bm{z}}</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.1d">over~ start_ARG bold_italic_z end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\bm{z}-\bm{r}_{2}=\left\lfloor-\frac{\left[\min(\bm{X}_{:,d})%
\right]_{1\leq d\leq D}+\bm{s}\odot\bm{r}_{2}}{\bm{s}}\right\rceil" class="ltx_math_unparsed" display="inline" id="A1.E12.m2.4"><semantics id="A1.E12.m2.4a"><mrow id="A1.E12.m2.4b"><mo id="A1.E12.m2.4.5">=</mo><mi id="A1.E12.m2.4.6">𝒛</mi><mo id="A1.E12.m2.4.7">−</mo><msub id="A1.E12.m2.4.8"><mi id="A1.E12.m2.4.8.2">𝒓</mi><mn id="A1.E12.m2.4.8.3">2</mn></msub><mo id="A1.E12.m2.4.9">=</mo><mrow id="A1.E12.m2.4.10"><mo id="A1.E12.m2.4.10.1">⌊</mo><mo id="A1.E12.m2.4.10.2" lspace="0em">−</mo><mstyle displaystyle="true" id="A1.E12.m2.4.4"><mfrac id="A1.E12.m2.4.4a"><mrow id="A1.E12.m2.4.4.4"><msub id="A1.E12.m2.4.4.4.4"><mrow id="A1.E12.m2.4.4.4.4.1.1"><mo id="A1.E12.m2.4.4.4.4.1.1.2">[</mo><mrow id="A1.E12.m2.4.4.4.4.1.1.1.1"><mi id="A1.E12.m2.3.3.3.3">min</mi><mo id="A1.E12.m2.4.4.4.4.1.1.1.1a">⁡</mo><mrow id="A1.E12.m2.4.4.4.4.1.1.1.1.1"><mo id="A1.E12.m2.4.4.4.4.1.1.1.1.1.2" stretchy="false">(</mo><msub id="A1.E12.m2.4.4.4.4.1.1.1.1.1.1"><mi id="A1.E12.m2.4.4.4.4.1.1.1.1.1.1.2">𝑿</mi><mrow id="A1.E12.m2.2.2.2.2.2.4"><mo id="A1.E12.m2.1.1.1.1.1.1" rspace="0em">:</mo><mo id="A1.E12.m2.2.2.2.2.2.4.1">,</mo><mi id="A1.E12.m2.2.2.2.2.2.2">d</mi></mrow></msub><mo id="A1.E12.m2.4.4.4.4.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mo id="A1.E12.m2.4.4.4.4.1.1.3">]</mo></mrow><mrow id="A1.E12.m2.4.4.4.4.3"><mn id="A1.E12.m2.4.4.4.4.3.2">1</mn><mo id="A1.E12.m2.4.4.4.4.3.3">≤</mo><mi id="A1.E12.m2.4.4.4.4.3.4">d</mi><mo id="A1.E12.m2.4.4.4.4.3.5">≤</mo><mi id="A1.E12.m2.4.4.4.4.3.6">D</mi></mrow></msub><mo id="A1.E12.m2.4.4.4.5">+</mo><mrow id="A1.E12.m2.4.4.4.6"><mi id="A1.E12.m2.4.4.4.6.2">𝒔</mi><mo id="A1.E12.m2.4.4.4.6.1" lspace="0.222em" rspace="0.222em">⊙</mo><msub id="A1.E12.m2.4.4.4.6.3"><mi id="A1.E12.m2.4.4.4.6.3.2">𝒓</mi><mn id="A1.E12.m2.4.4.4.6.3.3">2</mn></msub></mrow></mrow><mi id="A1.E12.m2.4.4.6">𝒔</mi></mfrac></mstyle><mo id="A1.E12.m2.4.10.3">⌉</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E12.m2.4c">\displaystyle=\bm{z}-\bm{r}_{2}=\left\lfloor-\frac{\left[\min(\bm{X}_{:,d})%
\right]_{1\leq d\leq D}+\bm{s}\odot\bm{r}_{2}}{\bm{s}}\right\rceil</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m2.4d">= bold_italic_z - bold_italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = ⌊ - divide start_ARG [ roman_min ( bold_italic_X start_POSTSUBSCRIPT : , italic_d end_POSTSUBSCRIPT ) ] start_POSTSUBSCRIPT 1 ≤ italic_d ≤ italic_D end_POSTSUBSCRIPT + bold_italic_s ⊙ bold_italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG bold_italic_s end_ARG ⌉</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="A1.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{\bm{s}}" class="ltx_Math" display="inline" id="A1.E13.m1.1"><semantics id="A1.E13.m1.1a"><mover accent="true" id="A1.E13.m1.1.1" xref="A1.E13.m1.1.1.cmml"><mi id="A1.E13.m1.1.1.2" xref="A1.E13.m1.1.1.2.cmml">𝒔</mi><mo id="A1.E13.m1.1.1.1" xref="A1.E13.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A1.E13.m1.1b"><apply id="A1.E13.m1.1.1.cmml" xref="A1.E13.m1.1.1"><ci id="A1.E13.m1.1.1.1.cmml" xref="A1.E13.m1.1.1.1">~</ci><ci id="A1.E13.m1.1.1.2.cmml" xref="A1.E13.m1.1.1.2">𝒔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m1.1c">\displaystyle\tilde{\bm{s}}</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.1d">over~ start_ARG bold_italic_s end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\bm{s}}{\bm{r}_{1}}=\frac{\left[\max(\bm{X}_{:,d})-\min(%
\bm{X}_{:,d})\right]_{1\leq d\leq D}/\bm{r}_{1}}{2^{b}-1}" class="ltx_Math" display="inline" id="A1.E13.m2.7"><semantics id="A1.E13.m2.7a"><mrow id="A1.E13.m2.7.8" xref="A1.E13.m2.7.8.cmml"><mi id="A1.E13.m2.7.8.2" xref="A1.E13.m2.7.8.2.cmml"></mi><mo id="A1.E13.m2.7.8.3" xref="A1.E13.m2.7.8.3.cmml">=</mo><mstyle displaystyle="true" id="A1.E13.m2.7.8.4" xref="A1.E13.m2.7.8.4.cmml"><mfrac id="A1.E13.m2.7.8.4a" xref="A1.E13.m2.7.8.4.cmml"><mi id="A1.E13.m2.7.8.4.2" xref="A1.E13.m2.7.8.4.2.cmml">𝒔</mi><msub id="A1.E13.m2.7.8.4.3" xref="A1.E13.m2.7.8.4.3.cmml"><mi id="A1.E13.m2.7.8.4.3.2" xref="A1.E13.m2.7.8.4.3.2.cmml">𝒓</mi><mn id="A1.E13.m2.7.8.4.3.3" xref="A1.E13.m2.7.8.4.3.3.cmml">1</mn></msub></mfrac></mstyle><mo id="A1.E13.m2.7.8.5" xref="A1.E13.m2.7.8.5.cmml">=</mo><mstyle displaystyle="true" id="A1.E13.m2.7.7" xref="A1.E13.m2.7.7.cmml"><mfrac id="A1.E13.m2.7.7a" xref="A1.E13.m2.7.7.cmml"><mrow id="A1.E13.m2.7.7.7" xref="A1.E13.m2.7.7.7.cmml"><msub id="A1.E13.m2.7.7.7.7" xref="A1.E13.m2.7.7.7.7.cmml"><mrow id="A1.E13.m2.7.7.7.7.1.1" xref="A1.E13.m2.7.7.7.7.1.2.cmml"><mo id="A1.E13.m2.7.7.7.7.1.1.2" xref="A1.E13.m2.7.7.7.7.1.2.1.cmml">[</mo><mrow id="A1.E13.m2.7.7.7.7.1.1.1" xref="A1.E13.m2.7.7.7.7.1.1.1.cmml"><mrow id="A1.E13.m2.7.7.7.7.1.1.1.1.1" xref="A1.E13.m2.7.7.7.7.1.1.1.1.2.cmml"><mi id="A1.E13.m2.5.5.5.5" xref="A1.E13.m2.5.5.5.5.cmml">max</mi><mo id="A1.E13.m2.7.7.7.7.1.1.1.1.1a" xref="A1.E13.m2.7.7.7.7.1.1.1.1.2.cmml">⁡</mo><mrow id="A1.E13.m2.7.7.7.7.1.1.1.1.1.1" xref="A1.E13.m2.7.7.7.7.1.1.1.1.2.cmml"><mo id="A1.E13.m2.7.7.7.7.1.1.1.1.1.1.2" stretchy="false" xref="A1.E13.m2.7.7.7.7.1.1.1.1.2.cmml">(</mo><msub id="A1.E13.m2.7.7.7.7.1.1.1.1.1.1.1" xref="A1.E13.m2.7.7.7.7.1.1.1.1.1.1.1.cmml"><mi id="A1.E13.m2.7.7.7.7.1.1.1.1.1.1.1.2" xref="A1.E13.m2.7.7.7.7.1.1.1.1.1.1.1.2.cmml">𝑿</mi><mrow id="A1.E13.m2.2.2.2.2.2.4" xref="A1.E13.m2.2.2.2.2.2.3.cmml"><mo id="A1.E13.m2.1.1.1.1.1.1" rspace="0em" xref="A1.E13.m2.1.1.1.1.1.1.cmml">:</mo><mo id="A1.E13.m2.2.2.2.2.2.4.1" xref="A1.E13.m2.2.2.2.2.2.3.cmml">,</mo><mi id="A1.E13.m2.2.2.2.2.2.2" xref="A1.E13.m2.2.2.2.2.2.2.cmml">d</mi></mrow></msub><mo id="A1.E13.m2.7.7.7.7.1.1.1.1.1.1.3" stretchy="false" xref="A1.E13.m2.7.7.7.7.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="A1.E13.m2.7.7.7.7.1.1.1.3" xref="A1.E13.m2.7.7.7.7.1.1.1.3.cmml">−</mo><mrow id="A1.E13.m2.7.7.7.7.1.1.1.2.1" xref="A1.E13.m2.7.7.7.7.1.1.1.2.2.cmml"><mi id="A1.E13.m2.6.6.6.6" xref="A1.E13.m2.6.6.6.6.cmml">min</mi><mo id="A1.E13.m2.7.7.7.7.1.1.1.2.1a" xref="A1.E13.m2.7.7.7.7.1.1.1.2.2.cmml">⁡</mo><mrow id="A1.E13.m2.7.7.7.7.1.1.1.2.1.1" xref="A1.E13.m2.7.7.7.7.1.1.1.2.2.cmml"><mo id="A1.E13.m2.7.7.7.7.1.1.1.2.1.1.2" stretchy="false" xref="A1.E13.m2.7.7.7.7.1.1.1.2.2.cmml">(</mo><msub id="A1.E13.m2.7.7.7.7.1.1.1.2.1.1.1" xref="A1.E13.m2.7.7.7.7.1.1.1.2.1.1.1.cmml"><mi id="A1.E13.m2.7.7.7.7.1.1.1.2.1.1.1.2" xref="A1.E13.m2.7.7.7.7.1.1.1.2.1.1.1.2.cmml">𝑿</mi><mrow id="A1.E13.m2.4.4.4.4.2.4" xref="A1.E13.m2.4.4.4.4.2.3.cmml"><mo id="A1.E13.m2.3.3.3.3.1.1" rspace="0em" xref="A1.E13.m2.3.3.3.3.1.1.cmml">:</mo><mo id="A1.E13.m2.4.4.4.4.2.4.1" xref="A1.E13.m2.4.4.4.4.2.3.cmml">,</mo><mi id="A1.E13.m2.4.4.4.4.2.2" xref="A1.E13.m2.4.4.4.4.2.2.cmml">d</mi></mrow></msub><mo id="A1.E13.m2.7.7.7.7.1.1.1.2.1.1.3" stretchy="false" xref="A1.E13.m2.7.7.7.7.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E13.m2.7.7.7.7.1.1.3" xref="A1.E13.m2.7.7.7.7.1.2.1.cmml">]</mo></mrow><mrow id="A1.E13.m2.7.7.7.7.3" xref="A1.E13.m2.7.7.7.7.3.cmml"><mn id="A1.E13.m2.7.7.7.7.3.2" xref="A1.E13.m2.7.7.7.7.3.2.cmml">1</mn><mo id="A1.E13.m2.7.7.7.7.3.3" xref="A1.E13.m2.7.7.7.7.3.3.cmml">≤</mo><mi id="A1.E13.m2.7.7.7.7.3.4" xref="A1.E13.m2.7.7.7.7.3.4.cmml">d</mi><mo id="A1.E13.m2.7.7.7.7.3.5" xref="A1.E13.m2.7.7.7.7.3.5.cmml">≤</mo><mi id="A1.E13.m2.7.7.7.7.3.6" xref="A1.E13.m2.7.7.7.7.3.6.cmml">D</mi></mrow></msub><mo id="A1.E13.m2.7.7.7.8" xref="A1.E13.m2.7.7.7.8.cmml">/</mo><msub id="A1.E13.m2.7.7.7.9" xref="A1.E13.m2.7.7.7.9.cmml"><mi id="A1.E13.m2.7.7.7.9.2" xref="A1.E13.m2.7.7.7.9.2.cmml">𝒓</mi><mn id="A1.E13.m2.7.7.7.9.3" xref="A1.E13.m2.7.7.7.9.3.cmml">1</mn></msub></mrow><mrow id="A1.E13.m2.7.7.9" xref="A1.E13.m2.7.7.9.cmml"><msup id="A1.E13.m2.7.7.9.2" xref="A1.E13.m2.7.7.9.2.cmml"><mn id="A1.E13.m2.7.7.9.2.2" xref="A1.E13.m2.7.7.9.2.2.cmml">2</mn><mi id="A1.E13.m2.7.7.9.2.3" xref="A1.E13.m2.7.7.9.2.3.cmml">b</mi></msup><mo id="A1.E13.m2.7.7.9.1" xref="A1.E13.m2.7.7.9.1.cmml">−</mo><mn id="A1.E13.m2.7.7.9.3" xref="A1.E13.m2.7.7.9.3.cmml">1</mn></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E13.m2.7b"><apply id="A1.E13.m2.7.8.cmml" xref="A1.E13.m2.7.8"><and id="A1.E13.m2.7.8a.cmml" xref="A1.E13.m2.7.8"></and><apply id="A1.E13.m2.7.8b.cmml" xref="A1.E13.m2.7.8"><eq id="A1.E13.m2.7.8.3.cmml" xref="A1.E13.m2.7.8.3"></eq><csymbol cd="latexml" id="A1.E13.m2.7.8.2.cmml" xref="A1.E13.m2.7.8.2">absent</csymbol><apply id="A1.E13.m2.7.8.4.cmml" xref="A1.E13.m2.7.8.4"><divide id="A1.E13.m2.7.8.4.1.cmml" xref="A1.E13.m2.7.8.4"></divide><ci id="A1.E13.m2.7.8.4.2.cmml" xref="A1.E13.m2.7.8.4.2">𝒔</ci><apply id="A1.E13.m2.7.8.4.3.cmml" xref="A1.E13.m2.7.8.4.3"><csymbol cd="ambiguous" id="A1.E13.m2.7.8.4.3.1.cmml" xref="A1.E13.m2.7.8.4.3">subscript</csymbol><ci id="A1.E13.m2.7.8.4.3.2.cmml" xref="A1.E13.m2.7.8.4.3.2">𝒓</ci><cn id="A1.E13.m2.7.8.4.3.3.cmml" type="integer" xref="A1.E13.m2.7.8.4.3.3">1</cn></apply></apply></apply><apply id="A1.E13.m2.7.8c.cmml" xref="A1.E13.m2.7.8"><eq id="A1.E13.m2.7.8.5.cmml" xref="A1.E13.m2.7.8.5"></eq><share href="https://arxiv.org/html/2410.01813v1#A1.E13.m2.7.8.4.cmml" id="A1.E13.m2.7.8d.cmml" xref="A1.E13.m2.7.8"></share><apply id="A1.E13.m2.7.7.cmml" xref="A1.E13.m2.7.7"><divide id="A1.E13.m2.7.7.8.cmml" xref="A1.E13.m2.7.7"></divide><apply id="A1.E13.m2.7.7.7.cmml" xref="A1.E13.m2.7.7.7"><divide id="A1.E13.m2.7.7.7.8.cmml" xref="A1.E13.m2.7.7.7.8"></divide><apply id="A1.E13.m2.7.7.7.7.cmml" xref="A1.E13.m2.7.7.7.7"><csymbol cd="ambiguous" id="A1.E13.m2.7.7.7.7.2.cmml" xref="A1.E13.m2.7.7.7.7">subscript</csymbol><apply id="A1.E13.m2.7.7.7.7.1.2.cmml" xref="A1.E13.m2.7.7.7.7.1.1"><csymbol cd="latexml" id="A1.E13.m2.7.7.7.7.1.2.1.cmml" xref="A1.E13.m2.7.7.7.7.1.1.2">delimited-[]</csymbol><apply id="A1.E13.m2.7.7.7.7.1.1.1.cmml" xref="A1.E13.m2.7.7.7.7.1.1.1"><minus id="A1.E13.m2.7.7.7.7.1.1.1.3.cmml" xref="A1.E13.m2.7.7.7.7.1.1.1.3"></minus><apply id="A1.E13.m2.7.7.7.7.1.1.1.1.2.cmml" xref="A1.E13.m2.7.7.7.7.1.1.1.1.1"><max id="A1.E13.m2.5.5.5.5.cmml" xref="A1.E13.m2.5.5.5.5"></max><apply id="A1.E13.m2.7.7.7.7.1.1.1.1.1.1.1.cmml" xref="A1.E13.m2.7.7.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E13.m2.7.7.7.7.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m2.7.7.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E13.m2.7.7.7.7.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m2.7.7.7.7.1.1.1.1.1.1.1.2">𝑿</ci><list id="A1.E13.m2.2.2.2.2.2.3.cmml" xref="A1.E13.m2.2.2.2.2.2.4"><ci id="A1.E13.m2.1.1.1.1.1.1.cmml" xref="A1.E13.m2.1.1.1.1.1.1">:</ci><ci id="A1.E13.m2.2.2.2.2.2.2.cmml" xref="A1.E13.m2.2.2.2.2.2.2">𝑑</ci></list></apply></apply><apply id="A1.E13.m2.7.7.7.7.1.1.1.2.2.cmml" xref="A1.E13.m2.7.7.7.7.1.1.1.2.1"><min id="A1.E13.m2.6.6.6.6.cmml" xref="A1.E13.m2.6.6.6.6"></min><apply id="A1.E13.m2.7.7.7.7.1.1.1.2.1.1.1.cmml" xref="A1.E13.m2.7.7.7.7.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A1.E13.m2.7.7.7.7.1.1.1.2.1.1.1.1.cmml" xref="A1.E13.m2.7.7.7.7.1.1.1.2.1.1.1">subscript</csymbol><ci id="A1.E13.m2.7.7.7.7.1.1.1.2.1.1.1.2.cmml" xref="A1.E13.m2.7.7.7.7.1.1.1.2.1.1.1.2">𝑿</ci><list id="A1.E13.m2.4.4.4.4.2.3.cmml" xref="A1.E13.m2.4.4.4.4.2.4"><ci id="A1.E13.m2.3.3.3.3.1.1.cmml" xref="A1.E13.m2.3.3.3.3.1.1">:</ci><ci id="A1.E13.m2.4.4.4.4.2.2.cmml" xref="A1.E13.m2.4.4.4.4.2.2">𝑑</ci></list></apply></apply></apply></apply><apply id="A1.E13.m2.7.7.7.7.3.cmml" xref="A1.E13.m2.7.7.7.7.3"><and id="A1.E13.m2.7.7.7.7.3a.cmml" xref="A1.E13.m2.7.7.7.7.3"></and><apply id="A1.E13.m2.7.7.7.7.3b.cmml" xref="A1.E13.m2.7.7.7.7.3"><leq id="A1.E13.m2.7.7.7.7.3.3.cmml" xref="A1.E13.m2.7.7.7.7.3.3"></leq><cn id="A1.E13.m2.7.7.7.7.3.2.cmml" type="integer" xref="A1.E13.m2.7.7.7.7.3.2">1</cn><ci id="A1.E13.m2.7.7.7.7.3.4.cmml" xref="A1.E13.m2.7.7.7.7.3.4">𝑑</ci></apply><apply id="A1.E13.m2.7.7.7.7.3c.cmml" xref="A1.E13.m2.7.7.7.7.3"><leq id="A1.E13.m2.7.7.7.7.3.5.cmml" xref="A1.E13.m2.7.7.7.7.3.5"></leq><share href="https://arxiv.org/html/2410.01813v1#A1.E13.m2.7.7.7.7.3.4.cmml" id="A1.E13.m2.7.7.7.7.3d.cmml" xref="A1.E13.m2.7.7.7.7.3"></share><ci id="A1.E13.m2.7.7.7.7.3.6.cmml" xref="A1.E13.m2.7.7.7.7.3.6">𝐷</ci></apply></apply></apply><apply id="A1.E13.m2.7.7.7.9.cmml" xref="A1.E13.m2.7.7.7.9"><csymbol cd="ambiguous" id="A1.E13.m2.7.7.7.9.1.cmml" xref="A1.E13.m2.7.7.7.9">subscript</csymbol><ci id="A1.E13.m2.7.7.7.9.2.cmml" xref="A1.E13.m2.7.7.7.9.2">𝒓</ci><cn id="A1.E13.m2.7.7.7.9.3.cmml" type="integer" xref="A1.E13.m2.7.7.7.9.3">1</cn></apply></apply><apply id="A1.E13.m2.7.7.9.cmml" xref="A1.E13.m2.7.7.9"><minus id="A1.E13.m2.7.7.9.1.cmml" xref="A1.E13.m2.7.7.9.1"></minus><apply id="A1.E13.m2.7.7.9.2.cmml" xref="A1.E13.m2.7.7.9.2"><csymbol cd="ambiguous" id="A1.E13.m2.7.7.9.2.1.cmml" xref="A1.E13.m2.7.7.9.2">superscript</csymbol><cn id="A1.E13.m2.7.7.9.2.2.cmml" type="integer" xref="A1.E13.m2.7.7.9.2.2">2</cn><ci id="A1.E13.m2.7.7.9.2.3.cmml" xref="A1.E13.m2.7.7.9.2.3">𝑏</ci></apply><cn id="A1.E13.m2.7.7.9.3.cmml" type="integer" xref="A1.E13.m2.7.7.9.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m2.7c">\displaystyle=\frac{\bm{s}}{\bm{r}_{1}}=\frac{\left[\max(\bm{X}_{:,d})-\min(%
\bm{X}_{:,d})\right]_{1\leq d\leq D}/\bm{r}_{1}}{2^{b}-1}</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m2.7d">= divide start_ARG bold_italic_s end_ARG start_ARG bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG = divide start_ARG [ roman_max ( bold_italic_X start_POSTSUBSCRIPT : , italic_d end_POSTSUBSCRIPT ) - roman_min ( bold_italic_X start_POSTSUBSCRIPT : , italic_d end_POSTSUBSCRIPT ) ] start_POSTSUBSCRIPT 1 ≤ italic_d ≤ italic_D end_POSTSUBSCRIPT / bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG start_ARG 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT - 1 end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.p4">
<p class="ltx_p" id="A1.SS2.p4.6">Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A1.E12" title="In A.2 RepQ-ViT: Scale Reparameterization ‣ Appendix A Our preliminary efforts for DFQ-SAM ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">12</span></a> indicates that adding <math alttext="\bm{s}\odot\bm{r}_{2}" class="ltx_Math" display="inline" id="A1.SS2.p4.1.m1.1"><semantics id="A1.SS2.p4.1.m1.1a"><mrow id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml"><mi id="A1.SS2.p4.1.m1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.2.cmml">𝒔</mi><mo id="A1.SS2.p4.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p4.1.m1.1.1.1.cmml">⊙</mo><msub id="A1.SS2.p4.1.m1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.3.cmml"><mi id="A1.SS2.p4.1.m1.1.1.3.2" xref="A1.SS2.p4.1.m1.1.1.3.2.cmml">𝒓</mi><mn id="A1.SS2.p4.1.m1.1.1.3.3" xref="A1.SS2.p4.1.m1.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><apply id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1"><csymbol cd="latexml" id="A1.SS2.p4.1.m1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1.1">direct-product</csymbol><ci id="A1.SS2.p4.1.m1.1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.1.2">𝒔</ci><apply id="A1.SS2.p4.1.m1.1.1.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p4.1.m1.1.1.3.1.cmml" xref="A1.SS2.p4.1.m1.1.1.3">subscript</csymbol><ci id="A1.SS2.p4.1.m1.1.1.3.2.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2">𝒓</ci><cn id="A1.SS2.p4.1.m1.1.1.3.3.cmml" type="integer" xref="A1.SS2.p4.1.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">\bm{s}\odot\bm{r}_{2}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.1.m1.1d">bold_italic_s ⊙ bold_italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> to each channel of <math alttext="\bm{X}" class="ltx_Math" display="inline" id="A1.SS2.p4.2.m2.1"><semantics id="A1.SS2.p4.2.m2.1a"><mi id="A1.SS2.p4.2.m2.1.1" xref="A1.SS2.p4.2.m2.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.2.m2.1b"><ci id="A1.SS2.p4.2.m2.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.2.m2.1c">\bm{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.2.m2.1d">bold_italic_X</annotation></semantics></math> results in <math alttext="\tilde{\bm{z}}" class="ltx_Math" display="inline" id="A1.SS2.p4.3.m3.1"><semantics id="A1.SS2.p4.3.m3.1a"><mover accent="true" id="A1.SS2.p4.3.m3.1.1" xref="A1.SS2.p4.3.m3.1.1.cmml"><mi id="A1.SS2.p4.3.m3.1.1.2" xref="A1.SS2.p4.3.m3.1.1.2.cmml">𝒛</mi><mo id="A1.SS2.p4.3.m3.1.1.1" xref="A1.SS2.p4.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.3.m3.1b"><apply id="A1.SS2.p4.3.m3.1.1.cmml" xref="A1.SS2.p4.3.m3.1.1"><ci id="A1.SS2.p4.3.m3.1.1.1.cmml" xref="A1.SS2.p4.3.m3.1.1.1">~</ci><ci id="A1.SS2.p4.3.m3.1.1.2.cmml" xref="A1.SS2.p4.3.m3.1.1.2">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.3.m3.1c">\tilde{\bm{z}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.3.m3.1d">over~ start_ARG bold_italic_z end_ARG</annotation></semantics></math>, while Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A1.E13" title="In A.2 RepQ-ViT: Scale Reparameterization ‣ Appendix A Our preliminary efforts for DFQ-SAM ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">13</span></a> shows that dividing each channel of <math alttext="\bm{X}" class="ltx_Math" display="inline" id="A1.SS2.p4.4.m4.1"><semantics id="A1.SS2.p4.4.m4.1a"><mi id="A1.SS2.p4.4.m4.1.1" xref="A1.SS2.p4.4.m4.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.4.m4.1b"><ci id="A1.SS2.p4.4.m4.1.1.cmml" xref="A1.SS2.p4.4.m4.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.4.m4.1c">\bm{X}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.4.m4.1d">bold_italic_X</annotation></semantics></math> by <math alttext="\bm{r}_{1}" class="ltx_Math" display="inline" id="A1.SS2.p4.5.m5.1"><semantics id="A1.SS2.p4.5.m5.1a"><msub id="A1.SS2.p4.5.m5.1.1" xref="A1.SS2.p4.5.m5.1.1.cmml"><mi id="A1.SS2.p4.5.m5.1.1.2" xref="A1.SS2.p4.5.m5.1.1.2.cmml">𝒓</mi><mn id="A1.SS2.p4.5.m5.1.1.3" xref="A1.SS2.p4.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.5.m5.1b"><apply id="A1.SS2.p4.5.m5.1.1.cmml" xref="A1.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS2.p4.5.m5.1.1.1.cmml" xref="A1.SS2.p4.5.m5.1.1">subscript</csymbol><ci id="A1.SS2.p4.5.m5.1.1.2.cmml" xref="A1.SS2.p4.5.m5.1.1.2">𝒓</ci><cn id="A1.SS2.p4.5.m5.1.1.3.cmml" type="integer" xref="A1.SS2.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.5.m5.1c">\bm{r}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.5.m5.1d">bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> achieves <math alttext="\tilde{\bm{s}}" class="ltx_Math" display="inline" id="A1.SS2.p4.6.m6.1"><semantics id="A1.SS2.p4.6.m6.1a"><mover accent="true" id="A1.SS2.p4.6.m6.1.1" xref="A1.SS2.p4.6.m6.1.1.cmml"><mi id="A1.SS2.p4.6.m6.1.1.2" xref="A1.SS2.p4.6.m6.1.1.2.cmml">𝒔</mi><mo id="A1.SS2.p4.6.m6.1.1.1" xref="A1.SS2.p4.6.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.6.m6.1b"><apply id="A1.SS2.p4.6.m6.1.1.cmml" xref="A1.SS2.p4.6.m6.1.1"><ci id="A1.SS2.p4.6.m6.1.1.1.cmml" xref="A1.SS2.p4.6.m6.1.1.1">~</ci><ci id="A1.SS2.p4.6.m6.1.1.2.cmml" xref="A1.SS2.p4.6.m6.1.1.2">𝒔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.6.m6.1c">\tilde{\bm{s}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p4.6.m6.1d">over~ start_ARG bold_italic_s end_ARG</annotation></semantics></math>. These adjustments can be implemented by modifying the affine factors in LayerNorm layer as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widetilde{\bm{\beta}}=\frac{\bm{\beta}+\bm{s}\odot\bm{r}_{2}}{\bm{r}_{1}},%
\quad\widetilde{\bm{\gamma}}=\frac{\bm{\gamma}}{\bm{r}_{1}}" class="ltx_Math" display="block" id="A1.E14.m1.2"><semantics id="A1.E14.m1.2a"><mrow id="A1.E14.m1.2.2.2" xref="A1.E14.m1.2.2.3.cmml"><mrow id="A1.E14.m1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.cmml"><mover accent="true" id="A1.E14.m1.1.1.1.1.2" xref="A1.E14.m1.1.1.1.1.2.cmml"><mi id="A1.E14.m1.1.1.1.1.2.2" xref="A1.E14.m1.1.1.1.1.2.2.cmml">𝜷</mi><mo id="A1.E14.m1.1.1.1.1.2.1" xref="A1.E14.m1.1.1.1.1.2.1.cmml">~</mo></mover><mo id="A1.E14.m1.1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.1.cmml">=</mo><mfrac id="A1.E14.m1.1.1.1.1.3" xref="A1.E14.m1.1.1.1.1.3.cmml"><mrow id="A1.E14.m1.1.1.1.1.3.2" xref="A1.E14.m1.1.1.1.1.3.2.cmml"><mi id="A1.E14.m1.1.1.1.1.3.2.2" xref="A1.E14.m1.1.1.1.1.3.2.2.cmml">𝜷</mi><mo id="A1.E14.m1.1.1.1.1.3.2.1" xref="A1.E14.m1.1.1.1.1.3.2.1.cmml">+</mo><mrow id="A1.E14.m1.1.1.1.1.3.2.3" xref="A1.E14.m1.1.1.1.1.3.2.3.cmml"><mi id="A1.E14.m1.1.1.1.1.3.2.3.2" xref="A1.E14.m1.1.1.1.1.3.2.3.2.cmml">𝒔</mi><mo id="A1.E14.m1.1.1.1.1.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="A1.E14.m1.1.1.1.1.3.2.3.1.cmml">⊙</mo><msub id="A1.E14.m1.1.1.1.1.3.2.3.3" xref="A1.E14.m1.1.1.1.1.3.2.3.3.cmml"><mi id="A1.E14.m1.1.1.1.1.3.2.3.3.2" xref="A1.E14.m1.1.1.1.1.3.2.3.3.2.cmml">𝒓</mi><mn id="A1.E14.m1.1.1.1.1.3.2.3.3.3" xref="A1.E14.m1.1.1.1.1.3.2.3.3.3.cmml">2</mn></msub></mrow></mrow><msub id="A1.E14.m1.1.1.1.1.3.3" xref="A1.E14.m1.1.1.1.1.3.3.cmml"><mi id="A1.E14.m1.1.1.1.1.3.3.2" xref="A1.E14.m1.1.1.1.1.3.3.2.cmml">𝒓</mi><mn id="A1.E14.m1.1.1.1.1.3.3.3" xref="A1.E14.m1.1.1.1.1.3.3.3.cmml">1</mn></msub></mfrac></mrow><mo id="A1.E14.m1.2.2.2.3" rspace="1.167em" xref="A1.E14.m1.2.2.3a.cmml">,</mo><mrow id="A1.E14.m1.2.2.2.2" xref="A1.E14.m1.2.2.2.2.cmml"><mover accent="true" id="A1.E14.m1.2.2.2.2.2" xref="A1.E14.m1.2.2.2.2.2.cmml"><mi id="A1.E14.m1.2.2.2.2.2.2" xref="A1.E14.m1.2.2.2.2.2.2.cmml">𝜸</mi><mo id="A1.E14.m1.2.2.2.2.2.1" xref="A1.E14.m1.2.2.2.2.2.1.cmml">~</mo></mover><mo id="A1.E14.m1.2.2.2.2.1" xref="A1.E14.m1.2.2.2.2.1.cmml">=</mo><mfrac id="A1.E14.m1.2.2.2.2.3" xref="A1.E14.m1.2.2.2.2.3.cmml"><mi id="A1.E14.m1.2.2.2.2.3.2" xref="A1.E14.m1.2.2.2.2.3.2.cmml">𝜸</mi><msub id="A1.E14.m1.2.2.2.2.3.3" xref="A1.E14.m1.2.2.2.2.3.3.cmml"><mi id="A1.E14.m1.2.2.2.2.3.3.2" xref="A1.E14.m1.2.2.2.2.3.3.2.cmml">𝒓</mi><mn id="A1.E14.m1.2.2.2.2.3.3.3" xref="A1.E14.m1.2.2.2.2.3.3.3.cmml">1</mn></msub></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E14.m1.2b"><apply id="A1.E14.m1.2.2.3.cmml" xref="A1.E14.m1.2.2.2"><csymbol cd="ambiguous" id="A1.E14.m1.2.2.3a.cmml" xref="A1.E14.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A1.E14.m1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1"><eq id="A1.E14.m1.1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1.1"></eq><apply id="A1.E14.m1.1.1.1.1.2.cmml" xref="A1.E14.m1.1.1.1.1.2"><ci id="A1.E14.m1.1.1.1.1.2.1.cmml" xref="A1.E14.m1.1.1.1.1.2.1">~</ci><ci id="A1.E14.m1.1.1.1.1.2.2.cmml" xref="A1.E14.m1.1.1.1.1.2.2">𝜷</ci></apply><apply id="A1.E14.m1.1.1.1.1.3.cmml" xref="A1.E14.m1.1.1.1.1.3"><divide id="A1.E14.m1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.1.1.1.1.3"></divide><apply id="A1.E14.m1.1.1.1.1.3.2.cmml" xref="A1.E14.m1.1.1.1.1.3.2"><plus id="A1.E14.m1.1.1.1.1.3.2.1.cmml" xref="A1.E14.m1.1.1.1.1.3.2.1"></plus><ci id="A1.E14.m1.1.1.1.1.3.2.2.cmml" xref="A1.E14.m1.1.1.1.1.3.2.2">𝜷</ci><apply id="A1.E14.m1.1.1.1.1.3.2.3.cmml" xref="A1.E14.m1.1.1.1.1.3.2.3"><csymbol cd="latexml" id="A1.E14.m1.1.1.1.1.3.2.3.1.cmml" xref="A1.E14.m1.1.1.1.1.3.2.3.1">direct-product</csymbol><ci id="A1.E14.m1.1.1.1.1.3.2.3.2.cmml" xref="A1.E14.m1.1.1.1.1.3.2.3.2">𝒔</ci><apply id="A1.E14.m1.1.1.1.1.3.2.3.3.cmml" xref="A1.E14.m1.1.1.1.1.3.2.3.3"><csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.1.3.2.3.3.1.cmml" xref="A1.E14.m1.1.1.1.1.3.2.3.3">subscript</csymbol><ci id="A1.E14.m1.1.1.1.1.3.2.3.3.2.cmml" xref="A1.E14.m1.1.1.1.1.3.2.3.3.2">𝒓</ci><cn id="A1.E14.m1.1.1.1.1.3.2.3.3.3.cmml" type="integer" xref="A1.E14.m1.1.1.1.1.3.2.3.3.3">2</cn></apply></apply></apply><apply id="A1.E14.m1.1.1.1.1.3.3.cmml" xref="A1.E14.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.1.3.3.1.cmml" xref="A1.E14.m1.1.1.1.1.3.3">subscript</csymbol><ci id="A1.E14.m1.1.1.1.1.3.3.2.cmml" xref="A1.E14.m1.1.1.1.1.3.3.2">𝒓</ci><cn id="A1.E14.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E14.m1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="A1.E14.m1.2.2.2.2.cmml" xref="A1.E14.m1.2.2.2.2"><eq id="A1.E14.m1.2.2.2.2.1.cmml" xref="A1.E14.m1.2.2.2.2.1"></eq><apply id="A1.E14.m1.2.2.2.2.2.cmml" xref="A1.E14.m1.2.2.2.2.2"><ci id="A1.E14.m1.2.2.2.2.2.1.cmml" xref="A1.E14.m1.2.2.2.2.2.1">~</ci><ci id="A1.E14.m1.2.2.2.2.2.2.cmml" xref="A1.E14.m1.2.2.2.2.2.2">𝜸</ci></apply><apply id="A1.E14.m1.2.2.2.2.3.cmml" xref="A1.E14.m1.2.2.2.2.3"><divide id="A1.E14.m1.2.2.2.2.3.1.cmml" xref="A1.E14.m1.2.2.2.2.3"></divide><ci id="A1.E14.m1.2.2.2.2.3.2.cmml" xref="A1.E14.m1.2.2.2.2.3.2">𝜸</ci><apply id="A1.E14.m1.2.2.2.2.3.3.cmml" xref="A1.E14.m1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="A1.E14.m1.2.2.2.2.3.3.1.cmml" xref="A1.E14.m1.2.2.2.2.3.3">subscript</csymbol><ci id="A1.E14.m1.2.2.2.2.3.3.2.cmml" xref="A1.E14.m1.2.2.2.2.3.3.2">𝒓</ci><cn id="A1.E14.m1.2.2.2.2.3.3.3.cmml" type="integer" xref="A1.E14.m1.2.2.2.2.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E14.m1.2c">\widetilde{\bm{\beta}}=\frac{\bm{\beta}+\bm{s}\odot\bm{r}_{2}}{\bm{r}_{1}},%
\quad\widetilde{\bm{\gamma}}=\frac{\bm{\gamma}}{\bm{r}_{1}}</annotation><annotation encoding="application/x-llamapun" id="A1.E14.m1.2d">over~ start_ARG bold_italic_β end_ARG = divide start_ARG bold_italic_β + bold_italic_s ⊙ bold_italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG , over~ start_ARG bold_italic_γ end_ARG = divide start_ARG bold_italic_γ end_ARG start_ARG bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.p5">
<p class="ltx_p" id="A1.SS2.p5.1">The above procedure results in a distribution shift of activations, i.e., <math alttext="\widetilde{\bm{X}}_{n,:}=(\bm{X}_{n,:}+\bm{s}\odot\bm{r}_{2})/\bm{r}_{1}" class="ltx_Math" display="inline" id="A1.SS2.p5.1.m1.5"><semantics id="A1.SS2.p5.1.m1.5a"><mrow id="A1.SS2.p5.1.m1.5.5" xref="A1.SS2.p5.1.m1.5.5.cmml"><msub id="A1.SS2.p5.1.m1.5.5.3" xref="A1.SS2.p5.1.m1.5.5.3.cmml"><mover accent="true" id="A1.SS2.p5.1.m1.5.5.3.2" xref="A1.SS2.p5.1.m1.5.5.3.2.cmml"><mi id="A1.SS2.p5.1.m1.5.5.3.2.2" xref="A1.SS2.p5.1.m1.5.5.3.2.2.cmml">𝑿</mi><mo id="A1.SS2.p5.1.m1.5.5.3.2.1" xref="A1.SS2.p5.1.m1.5.5.3.2.1.cmml">~</mo></mover><mrow id="A1.SS2.p5.1.m1.2.2.2.4" xref="A1.SS2.p5.1.m1.2.2.2.3.cmml"><mi id="A1.SS2.p5.1.m1.1.1.1.1" xref="A1.SS2.p5.1.m1.1.1.1.1.cmml">n</mi><mo id="A1.SS2.p5.1.m1.2.2.2.4.1" xref="A1.SS2.p5.1.m1.2.2.2.3.cmml">,</mo><mo id="A1.SS2.p5.1.m1.2.2.2.2" xref="A1.SS2.p5.1.m1.2.2.2.2.cmml">:</mo></mrow></msub><mo id="A1.SS2.p5.1.m1.5.5.2" xref="A1.SS2.p5.1.m1.5.5.2.cmml">=</mo><mrow id="A1.SS2.p5.1.m1.5.5.1" xref="A1.SS2.p5.1.m1.5.5.1.cmml"><mrow id="A1.SS2.p5.1.m1.5.5.1.1.1" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.cmml"><mo id="A1.SS2.p5.1.m1.5.5.1.1.1.2" stretchy="false" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.p5.1.m1.5.5.1.1.1.1" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.cmml"><msub id="A1.SS2.p5.1.m1.5.5.1.1.1.1.2" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.2.cmml"><mi id="A1.SS2.p5.1.m1.5.5.1.1.1.1.2.2" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.2.2.cmml">𝑿</mi><mrow id="A1.SS2.p5.1.m1.4.4.2.4" xref="A1.SS2.p5.1.m1.4.4.2.3.cmml"><mi id="A1.SS2.p5.1.m1.3.3.1.1" xref="A1.SS2.p5.1.m1.3.3.1.1.cmml">n</mi><mo id="A1.SS2.p5.1.m1.4.4.2.4.1" xref="A1.SS2.p5.1.m1.4.4.2.3.cmml">,</mo><mo id="A1.SS2.p5.1.m1.4.4.2.2" xref="A1.SS2.p5.1.m1.4.4.2.2.cmml">:</mo></mrow></msub><mo id="A1.SS2.p5.1.m1.5.5.1.1.1.1.1" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.1.cmml">+</mo><mrow id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.cmml"><mi id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.2" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.2.cmml">𝒔</mi><mo id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.1.cmml">⊙</mo><msub id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3.cmml"><mi id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3.2" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3.2.cmml">𝒓</mi><mn id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3.3" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo id="A1.SS2.p5.1.m1.5.5.1.1.1.3" stretchy="false" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.cmml">)</mo></mrow><mo id="A1.SS2.p5.1.m1.5.5.1.2" xref="A1.SS2.p5.1.m1.5.5.1.2.cmml">/</mo><msub id="A1.SS2.p5.1.m1.5.5.1.3" xref="A1.SS2.p5.1.m1.5.5.1.3.cmml"><mi id="A1.SS2.p5.1.m1.5.5.1.3.2" xref="A1.SS2.p5.1.m1.5.5.1.3.2.cmml">𝒓</mi><mn id="A1.SS2.p5.1.m1.5.5.1.3.3" xref="A1.SS2.p5.1.m1.5.5.1.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.5b"><apply id="A1.SS2.p5.1.m1.5.5.cmml" xref="A1.SS2.p5.1.m1.5.5"><eq id="A1.SS2.p5.1.m1.5.5.2.cmml" xref="A1.SS2.p5.1.m1.5.5.2"></eq><apply id="A1.SS2.p5.1.m1.5.5.3.cmml" xref="A1.SS2.p5.1.m1.5.5.3"><csymbol cd="ambiguous" id="A1.SS2.p5.1.m1.5.5.3.1.cmml" xref="A1.SS2.p5.1.m1.5.5.3">subscript</csymbol><apply id="A1.SS2.p5.1.m1.5.5.3.2.cmml" xref="A1.SS2.p5.1.m1.5.5.3.2"><ci id="A1.SS2.p5.1.m1.5.5.3.2.1.cmml" xref="A1.SS2.p5.1.m1.5.5.3.2.1">~</ci><ci id="A1.SS2.p5.1.m1.5.5.3.2.2.cmml" xref="A1.SS2.p5.1.m1.5.5.3.2.2">𝑿</ci></apply><list id="A1.SS2.p5.1.m1.2.2.2.3.cmml" xref="A1.SS2.p5.1.m1.2.2.2.4"><ci id="A1.SS2.p5.1.m1.1.1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1.1.1">𝑛</ci><ci id="A1.SS2.p5.1.m1.2.2.2.2.cmml" xref="A1.SS2.p5.1.m1.2.2.2.2">:</ci></list></apply><apply id="A1.SS2.p5.1.m1.5.5.1.cmml" xref="A1.SS2.p5.1.m1.5.5.1"><divide id="A1.SS2.p5.1.m1.5.5.1.2.cmml" xref="A1.SS2.p5.1.m1.5.5.1.2"></divide><apply id="A1.SS2.p5.1.m1.5.5.1.1.1.1.cmml" xref="A1.SS2.p5.1.m1.5.5.1.1.1"><plus id="A1.SS2.p5.1.m1.5.5.1.1.1.1.1.cmml" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.1"></plus><apply id="A1.SS2.p5.1.m1.5.5.1.1.1.1.2.cmml" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p5.1.m1.5.5.1.1.1.1.2.1.cmml" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="A1.SS2.p5.1.m1.5.5.1.1.1.1.2.2.cmml" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.2.2">𝑿</ci><list id="A1.SS2.p5.1.m1.4.4.2.3.cmml" xref="A1.SS2.p5.1.m1.4.4.2.4"><ci id="A1.SS2.p5.1.m1.3.3.1.1.cmml" xref="A1.SS2.p5.1.m1.3.3.1.1">𝑛</ci><ci id="A1.SS2.p5.1.m1.4.4.2.2.cmml" xref="A1.SS2.p5.1.m1.4.4.2.2">:</ci></list></apply><apply id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.cmml" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3"><csymbol cd="latexml" id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.1.cmml" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.1">direct-product</csymbol><ci id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.2.cmml" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.2">𝒔</ci><apply id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3.cmml" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3.1.cmml" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3">subscript</csymbol><ci id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3.2.cmml" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3.2">𝒓</ci><cn id="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.SS2.p5.1.m1.5.5.1.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="A1.SS2.p5.1.m1.5.5.1.3.cmml" xref="A1.SS2.p5.1.m1.5.5.1.3"><csymbol cd="ambiguous" id="A1.SS2.p5.1.m1.5.5.1.3.1.cmml" xref="A1.SS2.p5.1.m1.5.5.1.3">subscript</csymbol><ci id="A1.SS2.p5.1.m1.5.5.1.3.2.cmml" xref="A1.SS2.p5.1.m1.5.5.1.3.2">𝒓</ci><cn id="A1.SS2.p5.1.m1.5.5.1.3.3.cmml" type="integer" xref="A1.SS2.p5.1.m1.5.5.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.5c">\widetilde{\bm{X}}_{n,:}=(\bm{X}_{n,:}+\bm{s}\odot\bm{r}_{2})/\bm{r}_{1}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p5.1.m1.5d">over~ start_ARG bold_italic_X end_ARG start_POSTSUBSCRIPT italic_n , : end_POSTSUBSCRIPT = ( bold_italic_X start_POSTSUBSCRIPT italic_n , : end_POSTSUBSCRIPT + bold_italic_s ⊙ bold_italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) / bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>. This distribution shift can be corrected by applying inverse compensation to the weights of the subsequent layer. Specifically, using equivalent transformations, we obtain:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\bm{X}_{n,:}\bm{W}^{qkv}_{:,j}+\bm{b}^{qkv}_{j}=\frac{\bm{X}_{n,:%
}+\bm{s}\odot\bm{r}_{2}}{\bm{r}_{1}}\left(\bm{r}_{1}\odot\bm{W}^{qkv}_{:,j}%
\right)\\
+\left(\bm{b}^{qkv}_{j}-(\bm{s}\odot\bm{r}_{2})\bm{W}^{qkv}_{:,j}\right)\end{split}" class="ltx_Math" display="block" id="A1.E15.m1.39"><semantics id="A1.E15.m1.39a"><mtable displaystyle="true" id="A1.E15.m1.39.39.4" rowspacing="0pt" xref="A1.E15.m1.37.37.2.cmml"><mtr id="A1.E15.m1.39.39.4a" xref="A1.E15.m1.37.37.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E15.m1.39.39.4b" xref="A1.E15.m1.37.37.2.cmml"><mrow id="A1.E15.m1.38.38.3.36.20.20" xref="A1.E15.m1.37.37.2.cmml"><mrow id="A1.E15.m1.38.38.3.36.20.20.21" xref="A1.E15.m1.37.37.2.cmml"><mrow id="A1.E15.m1.38.38.3.36.20.20.21.1" xref="A1.E15.m1.37.37.2.cmml"><msub id="A1.E15.m1.38.38.3.36.20.20.21.1.2" xref="A1.E15.m1.37.37.2.cmml"><mi id="A1.E15.m1.1.1.1.1.1.1" xref="A1.E15.m1.1.1.1.1.1.1.cmml">𝑿</mi><mrow id="A1.E15.m1.2.2.2.2.2.2.1.4" xref="A1.E15.m1.2.2.2.2.2.2.1.3.cmml"><mi id="A1.E15.m1.2.2.2.2.2.2.1.1" xref="A1.E15.m1.2.2.2.2.2.2.1.1.cmml">n</mi><mo id="A1.E15.m1.2.2.2.2.2.2.1.4.1" xref="A1.E15.m1.2.2.2.2.2.2.1.3.cmml">,</mo><mo id="A1.E15.m1.2.2.2.2.2.2.1.2" xref="A1.E15.m1.2.2.2.2.2.2.1.2.cmml">:</mo></mrow></msub><mo id="A1.E15.m1.38.38.3.36.20.20.21.1.1" xref="A1.E15.m1.37.37.2.cmml">⁢</mo><msubsup id="A1.E15.m1.38.38.3.36.20.20.21.1.3" xref="A1.E15.m1.37.37.2.cmml"><mi id="A1.E15.m1.3.3.3.3.3.3" xref="A1.E15.m1.3.3.3.3.3.3.cmml">𝑾</mi><mrow id="A1.E15.m1.5.5.5.5.5.5.1.4" xref="A1.E15.m1.5.5.5.5.5.5.1.3.cmml"><mo id="A1.E15.m1.5.5.5.5.5.5.1.1" rspace="0em" xref="A1.E15.m1.5.5.5.5.5.5.1.1.cmml">:</mo><mo id="A1.E15.m1.5.5.5.5.5.5.1.4.1" xref="A1.E15.m1.5.5.5.5.5.5.1.3.cmml">,</mo><mi id="A1.E15.m1.5.5.5.5.5.5.1.2" xref="A1.E15.m1.5.5.5.5.5.5.1.2.cmml">j</mi></mrow><mrow id="A1.E15.m1.4.4.4.4.4.4.1" xref="A1.E15.m1.4.4.4.4.4.4.1.cmml"><mi id="A1.E15.m1.4.4.4.4.4.4.1.2" xref="A1.E15.m1.4.4.4.4.4.4.1.2.cmml">q</mi><mo id="A1.E15.m1.4.4.4.4.4.4.1.1" xref="A1.E15.m1.4.4.4.4.4.4.1.1.cmml">⁢</mo><mi id="A1.E15.m1.4.4.4.4.4.4.1.3" xref="A1.E15.m1.4.4.4.4.4.4.1.3.cmml">k</mi><mo id="A1.E15.m1.4.4.4.4.4.4.1.1a" xref="A1.E15.m1.4.4.4.4.4.4.1.1.cmml">⁢</mo><mi id="A1.E15.m1.4.4.4.4.4.4.1.4" xref="A1.E15.m1.4.4.4.4.4.4.1.4.cmml">v</mi></mrow></msubsup></mrow><mo id="A1.E15.m1.6.6.6.6.6.6" xref="A1.E15.m1.6.6.6.6.6.6.cmml">+</mo><msubsup id="A1.E15.m1.38.38.3.36.20.20.21.2" xref="A1.E15.m1.37.37.2.cmml"><mi id="A1.E15.m1.7.7.7.7.7.7" xref="A1.E15.m1.7.7.7.7.7.7.cmml">𝒃</mi><mi id="A1.E15.m1.9.9.9.9.9.9.1" xref="A1.E15.m1.9.9.9.9.9.9.1.cmml">j</mi><mrow id="A1.E15.m1.8.8.8.8.8.8.1" xref="A1.E15.m1.8.8.8.8.8.8.1.cmml"><mi id="A1.E15.m1.8.8.8.8.8.8.1.2" xref="A1.E15.m1.8.8.8.8.8.8.1.2.cmml">q</mi><mo id="A1.E15.m1.8.8.8.8.8.8.1.1" xref="A1.E15.m1.8.8.8.8.8.8.1.1.cmml">⁢</mo><mi id="A1.E15.m1.8.8.8.8.8.8.1.3" xref="A1.E15.m1.8.8.8.8.8.8.1.3.cmml">k</mi><mo id="A1.E15.m1.8.8.8.8.8.8.1.1a" xref="A1.E15.m1.8.8.8.8.8.8.1.1.cmml">⁢</mo><mi id="A1.E15.m1.8.8.8.8.8.8.1.4" xref="A1.E15.m1.8.8.8.8.8.8.1.4.cmml">v</mi></mrow></msubsup></mrow><mo id="A1.E15.m1.10.10.10.10.10.10" xref="A1.E15.m1.10.10.10.10.10.10.cmml">=</mo><mrow id="A1.E15.m1.38.38.3.36.20.20.20" xref="A1.E15.m1.37.37.2.cmml"><mfrac id="A1.E15.m1.11.11.11.11.11.11" xref="A1.E15.m1.11.11.11.11.11.11.cmml"><mrow id="A1.E15.m1.11.11.11.11.11.11.2" xref="A1.E15.m1.11.11.11.11.11.11.2.cmml"><msub id="A1.E15.m1.11.11.11.11.11.11.2.4" xref="A1.E15.m1.11.11.11.11.11.11.2.4.cmml"><mi id="A1.E15.m1.11.11.11.11.11.11.2.4.2" xref="A1.E15.m1.11.11.11.11.11.11.2.4.2.cmml">𝑿</mi><mrow id="A1.E15.m1.11.11.11.11.11.11.2.2.2.4" xref="A1.E15.m1.11.11.11.11.11.11.2.2.2.3.cmml"><mi id="A1.E15.m1.11.11.11.11.11.11.1.1.1.1" xref="A1.E15.m1.11.11.11.11.11.11.1.1.1.1.cmml">n</mi><mo id="A1.E15.m1.11.11.11.11.11.11.2.2.2.4.1" xref="A1.E15.m1.11.11.11.11.11.11.2.2.2.3.cmml">,</mo><mo id="A1.E15.m1.11.11.11.11.11.11.2.2.2.2" xref="A1.E15.m1.11.11.11.11.11.11.2.2.2.2.cmml">:</mo></mrow></msub><mo id="A1.E15.m1.11.11.11.11.11.11.2.3" xref="A1.E15.m1.11.11.11.11.11.11.2.3.cmml">+</mo><mrow id="A1.E15.m1.11.11.11.11.11.11.2.5" xref="A1.E15.m1.11.11.11.11.11.11.2.5.cmml"><mi id="A1.E15.m1.11.11.11.11.11.11.2.5.2" xref="A1.E15.m1.11.11.11.11.11.11.2.5.2.cmml">𝒔</mi><mo id="A1.E15.m1.11.11.11.11.11.11.2.5.1" lspace="0.222em" rspace="0.222em" xref="A1.E15.m1.11.11.11.11.11.11.2.5.1.cmml">⊙</mo><msub id="A1.E15.m1.11.11.11.11.11.11.2.5.3" xref="A1.E15.m1.11.11.11.11.11.11.2.5.3.cmml"><mi id="A1.E15.m1.11.11.11.11.11.11.2.5.3.2" xref="A1.E15.m1.11.11.11.11.11.11.2.5.3.2.cmml">𝒓</mi><mn id="A1.E15.m1.11.11.11.11.11.11.2.5.3.3" xref="A1.E15.m1.11.11.11.11.11.11.2.5.3.3.cmml">2</mn></msub></mrow></mrow><msub id="A1.E15.m1.11.11.11.11.11.11.4" xref="A1.E15.m1.11.11.11.11.11.11.4.cmml"><mi id="A1.E15.m1.11.11.11.11.11.11.4.2" xref="A1.E15.m1.11.11.11.11.11.11.4.2.cmml">𝒓</mi><mn id="A1.E15.m1.11.11.11.11.11.11.4.3" xref="A1.E15.m1.11.11.11.11.11.11.4.3.cmml">1</mn></msub></mfrac><mo id="A1.E15.m1.38.38.3.36.20.20.20.2" xref="A1.E15.m1.37.37.2.cmml">⁢</mo><mrow id="A1.E15.m1.38.38.3.36.20.20.20.1.1" xref="A1.E15.m1.37.37.2.cmml"><mo id="A1.E15.m1.12.12.12.12.12.12" xref="A1.E15.m1.37.37.2.cmml">(</mo><mrow id="A1.E15.m1.38.38.3.36.20.20.20.1.1.1" xref="A1.E15.m1.37.37.2.cmml"><msub id="A1.E15.m1.38.38.3.36.20.20.20.1.1.1.1" xref="A1.E15.m1.37.37.2.cmml"><mi id="A1.E15.m1.13.13.13.13.13.13" xref="A1.E15.m1.13.13.13.13.13.13.cmml">𝒓</mi><mn id="A1.E15.m1.14.14.14.14.14.14.1" xref="A1.E15.m1.14.14.14.14.14.14.1.cmml">1</mn></msub><mo id="A1.E15.m1.15.15.15.15.15.15" lspace="0.222em" rspace="0.222em" xref="A1.E15.m1.15.15.15.15.15.15.cmml">⊙</mo><msubsup id="A1.E15.m1.38.38.3.36.20.20.20.1.1.1.2" xref="A1.E15.m1.37.37.2.cmml"><mi id="A1.E15.m1.16.16.16.16.16.16" xref="A1.E15.m1.16.16.16.16.16.16.cmml">𝑾</mi><mrow id="A1.E15.m1.18.18.18.18.18.18.1.4" xref="A1.E15.m1.18.18.18.18.18.18.1.3.cmml"><mo id="A1.E15.m1.18.18.18.18.18.18.1.1" rspace="0em" xref="A1.E15.m1.18.18.18.18.18.18.1.1.cmml">:</mo><mo id="A1.E15.m1.18.18.18.18.18.18.1.4.1" xref="A1.E15.m1.18.18.18.18.18.18.1.3.cmml">,</mo><mi id="A1.E15.m1.18.18.18.18.18.18.1.2" xref="A1.E15.m1.18.18.18.18.18.18.1.2.cmml">j</mi></mrow><mrow id="A1.E15.m1.17.17.17.17.17.17.1" xref="A1.E15.m1.17.17.17.17.17.17.1.cmml"><mi id="A1.E15.m1.17.17.17.17.17.17.1.2" xref="A1.E15.m1.17.17.17.17.17.17.1.2.cmml">q</mi><mo id="A1.E15.m1.17.17.17.17.17.17.1.1" xref="A1.E15.m1.17.17.17.17.17.17.1.1.cmml">⁢</mo><mi id="A1.E15.m1.17.17.17.17.17.17.1.3" xref="A1.E15.m1.17.17.17.17.17.17.1.3.cmml">k</mi><mo id="A1.E15.m1.17.17.17.17.17.17.1.1a" xref="A1.E15.m1.17.17.17.17.17.17.1.1.cmml">⁢</mo><mi id="A1.E15.m1.17.17.17.17.17.17.1.4" xref="A1.E15.m1.17.17.17.17.17.17.1.4.cmml">v</mi></mrow></msubsup></mrow><mo id="A1.E15.m1.19.19.19.19.19.19" xref="A1.E15.m1.37.37.2.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="A1.E15.m1.39.39.4c" xref="A1.E15.m1.37.37.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="A1.E15.m1.39.39.4d" xref="A1.E15.m1.37.37.2.cmml"><mrow id="A1.E15.m1.39.39.4.37.17.17" xref="A1.E15.m1.37.37.2.cmml"><mo id="A1.E15.m1.39.39.4.37.17.17a" xref="A1.E15.m1.37.37.2.cmml">+</mo><mrow id="A1.E15.m1.39.39.4.37.17.17.17.1" xref="A1.E15.m1.37.37.2.cmml"><mo id="A1.E15.m1.21.21.21.2.2.2" xref="A1.E15.m1.37.37.2.cmml">(</mo><mrow id="A1.E15.m1.39.39.4.37.17.17.17.1.1" xref="A1.E15.m1.37.37.2.cmml"><msubsup id="A1.E15.m1.39.39.4.37.17.17.17.1.1.2" xref="A1.E15.m1.37.37.2.cmml"><mi id="A1.E15.m1.22.22.22.3.3.3" xref="A1.E15.m1.22.22.22.3.3.3.cmml">𝒃</mi><mi id="A1.E15.m1.24.24.24.5.5.5.1" xref="A1.E15.m1.24.24.24.5.5.5.1.cmml">j</mi><mrow id="A1.E15.m1.23.23.23.4.4.4.1" xref="A1.E15.m1.23.23.23.4.4.4.1.cmml"><mi id="A1.E15.m1.23.23.23.4.4.4.1.2" xref="A1.E15.m1.23.23.23.4.4.4.1.2.cmml">q</mi><mo id="A1.E15.m1.23.23.23.4.4.4.1.1" xref="A1.E15.m1.23.23.23.4.4.4.1.1.cmml">⁢</mo><mi id="A1.E15.m1.23.23.23.4.4.4.1.3" xref="A1.E15.m1.23.23.23.4.4.4.1.3.cmml">k</mi><mo id="A1.E15.m1.23.23.23.4.4.4.1.1a" xref="A1.E15.m1.23.23.23.4.4.4.1.1.cmml">⁢</mo><mi id="A1.E15.m1.23.23.23.4.4.4.1.4" xref="A1.E15.m1.23.23.23.4.4.4.1.4.cmml">v</mi></mrow></msubsup><mo id="A1.E15.m1.25.25.25.6.6.6" xref="A1.E15.m1.25.25.25.6.6.6.cmml">−</mo><mrow id="A1.E15.m1.39.39.4.37.17.17.17.1.1.1" xref="A1.E15.m1.37.37.2.cmml"><mrow id="A1.E15.m1.39.39.4.37.17.17.17.1.1.1.1.1" xref="A1.E15.m1.37.37.2.cmml"><mo id="A1.E15.m1.26.26.26.7.7.7" stretchy="false" xref="A1.E15.m1.37.37.2.cmml">(</mo><mrow id="A1.E15.m1.39.39.4.37.17.17.17.1.1.1.1.1.1" xref="A1.E15.m1.37.37.2.cmml"><mi id="A1.E15.m1.27.27.27.8.8.8" xref="A1.E15.m1.27.27.27.8.8.8.cmml">𝒔</mi><mo id="A1.E15.m1.28.28.28.9.9.9" lspace="0.222em" rspace="0.222em" xref="A1.E15.m1.28.28.28.9.9.9.cmml">⊙</mo><msub id="A1.E15.m1.39.39.4.37.17.17.17.1.1.1.1.1.1.1" xref="A1.E15.m1.37.37.2.cmml"><mi id="A1.E15.m1.29.29.29.10.10.10" xref="A1.E15.m1.29.29.29.10.10.10.cmml">𝒓</mi><mn id="A1.E15.m1.30.30.30.11.11.11.1" xref="A1.E15.m1.30.30.30.11.11.11.1.cmml">2</mn></msub></mrow><mo id="A1.E15.m1.31.31.31.12.12.12" stretchy="false" xref="A1.E15.m1.37.37.2.cmml">)</mo></mrow><mo id="A1.E15.m1.39.39.4.37.17.17.17.1.1.1.2" xref="A1.E15.m1.37.37.2.cmml">⁢</mo><msubsup id="A1.E15.m1.39.39.4.37.17.17.17.1.1.1.3" xref="A1.E15.m1.37.37.2.cmml"><mi id="A1.E15.m1.32.32.32.13.13.13" xref="A1.E15.m1.32.32.32.13.13.13.cmml">𝑾</mi><mrow id="A1.E15.m1.34.34.34.15.15.15.1.4" xref="A1.E15.m1.34.34.34.15.15.15.1.3.cmml"><mo id="A1.E15.m1.34.34.34.15.15.15.1.1" rspace="0em" xref="A1.E15.m1.34.34.34.15.15.15.1.1.cmml">:</mo><mo id="A1.E15.m1.34.34.34.15.15.15.1.4.1" xref="A1.E15.m1.34.34.34.15.15.15.1.3.cmml">,</mo><mi id="A1.E15.m1.34.34.34.15.15.15.1.2" xref="A1.E15.m1.34.34.34.15.15.15.1.2.cmml">j</mi></mrow><mrow id="A1.E15.m1.33.33.33.14.14.14.1" xref="A1.E15.m1.33.33.33.14.14.14.1.cmml"><mi id="A1.E15.m1.33.33.33.14.14.14.1.2" xref="A1.E15.m1.33.33.33.14.14.14.1.2.cmml">q</mi><mo id="A1.E15.m1.33.33.33.14.14.14.1.1" xref="A1.E15.m1.33.33.33.14.14.14.1.1.cmml">⁢</mo><mi id="A1.E15.m1.33.33.33.14.14.14.1.3" xref="A1.E15.m1.33.33.33.14.14.14.1.3.cmml">k</mi><mo id="A1.E15.m1.33.33.33.14.14.14.1.1a" xref="A1.E15.m1.33.33.33.14.14.14.1.1.cmml">⁢</mo><mi id="A1.E15.m1.33.33.33.14.14.14.1.4" xref="A1.E15.m1.33.33.33.14.14.14.1.4.cmml">v</mi></mrow></msubsup></mrow></mrow><mo id="A1.E15.m1.35.35.35.16.16.16" xref="A1.E15.m1.37.37.2.cmml">)</mo></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="A1.E15.m1.39b"><apply id="A1.E15.m1.37.37.2.cmml" xref="A1.E15.m1.39.39.4"><eq id="A1.E15.m1.10.10.10.10.10.10.cmml" xref="A1.E15.m1.10.10.10.10.10.10"></eq><apply id="A1.E15.m1.37.37.2.4.cmml" xref="A1.E15.m1.39.39.4"><plus id="A1.E15.m1.6.6.6.6.6.6.cmml" xref="A1.E15.m1.6.6.6.6.6.6"></plus><apply id="A1.E15.m1.37.37.2.4.2.cmml" xref="A1.E15.m1.39.39.4"><times id="A1.E15.m1.37.37.2.4.2.1.cmml" xref="A1.E15.m1.39.39.4"></times><apply id="A1.E15.m1.37.37.2.4.2.2.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.37.37.2.4.2.2.1.cmml" xref="A1.E15.m1.39.39.4">subscript</csymbol><ci id="A1.E15.m1.1.1.1.1.1.1.cmml" xref="A1.E15.m1.1.1.1.1.1.1">𝑿</ci><list id="A1.E15.m1.2.2.2.2.2.2.1.3.cmml" xref="A1.E15.m1.2.2.2.2.2.2.1.4"><ci id="A1.E15.m1.2.2.2.2.2.2.1.1.cmml" xref="A1.E15.m1.2.2.2.2.2.2.1.1">𝑛</ci><ci id="A1.E15.m1.2.2.2.2.2.2.1.2.cmml" xref="A1.E15.m1.2.2.2.2.2.2.1.2">:</ci></list></apply><apply id="A1.E15.m1.37.37.2.4.2.3.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.37.37.2.4.2.3.1.cmml" xref="A1.E15.m1.39.39.4">subscript</csymbol><apply id="A1.E15.m1.37.37.2.4.2.3.2.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.37.37.2.4.2.3.2.1.cmml" xref="A1.E15.m1.39.39.4">superscript</csymbol><ci id="A1.E15.m1.3.3.3.3.3.3.cmml" xref="A1.E15.m1.3.3.3.3.3.3">𝑾</ci><apply id="A1.E15.m1.4.4.4.4.4.4.1.cmml" xref="A1.E15.m1.4.4.4.4.4.4.1"><times id="A1.E15.m1.4.4.4.4.4.4.1.1.cmml" xref="A1.E15.m1.4.4.4.4.4.4.1.1"></times><ci id="A1.E15.m1.4.4.4.4.4.4.1.2.cmml" xref="A1.E15.m1.4.4.4.4.4.4.1.2">𝑞</ci><ci id="A1.E15.m1.4.4.4.4.4.4.1.3.cmml" xref="A1.E15.m1.4.4.4.4.4.4.1.3">𝑘</ci><ci id="A1.E15.m1.4.4.4.4.4.4.1.4.cmml" xref="A1.E15.m1.4.4.4.4.4.4.1.4">𝑣</ci></apply></apply><list id="A1.E15.m1.5.5.5.5.5.5.1.3.cmml" xref="A1.E15.m1.5.5.5.5.5.5.1.4"><ci id="A1.E15.m1.5.5.5.5.5.5.1.1.cmml" xref="A1.E15.m1.5.5.5.5.5.5.1.1">:</ci><ci id="A1.E15.m1.5.5.5.5.5.5.1.2.cmml" xref="A1.E15.m1.5.5.5.5.5.5.1.2">𝑗</ci></list></apply></apply><apply id="A1.E15.m1.37.37.2.4.3.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.37.37.2.4.3.1.cmml" xref="A1.E15.m1.39.39.4">subscript</csymbol><apply id="A1.E15.m1.37.37.2.4.3.2.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.37.37.2.4.3.2.1.cmml" xref="A1.E15.m1.39.39.4">superscript</csymbol><ci id="A1.E15.m1.7.7.7.7.7.7.cmml" xref="A1.E15.m1.7.7.7.7.7.7">𝒃</ci><apply id="A1.E15.m1.8.8.8.8.8.8.1.cmml" xref="A1.E15.m1.8.8.8.8.8.8.1"><times id="A1.E15.m1.8.8.8.8.8.8.1.1.cmml" xref="A1.E15.m1.8.8.8.8.8.8.1.1"></times><ci id="A1.E15.m1.8.8.8.8.8.8.1.2.cmml" xref="A1.E15.m1.8.8.8.8.8.8.1.2">𝑞</ci><ci id="A1.E15.m1.8.8.8.8.8.8.1.3.cmml" xref="A1.E15.m1.8.8.8.8.8.8.1.3">𝑘</ci><ci id="A1.E15.m1.8.8.8.8.8.8.1.4.cmml" xref="A1.E15.m1.8.8.8.8.8.8.1.4">𝑣</ci></apply></apply><ci id="A1.E15.m1.9.9.9.9.9.9.1.cmml" xref="A1.E15.m1.9.9.9.9.9.9.1">𝑗</ci></apply></apply><apply id="A1.E15.m1.37.37.2.2.cmml" xref="A1.E15.m1.39.39.4"><plus id="A1.E15.m1.20.20.20.1.1.1.cmml" xref="A1.E15.m1.39.39.4"></plus><apply id="A1.E15.m1.36.36.1.1.1.cmml" xref="A1.E15.m1.39.39.4"><times id="A1.E15.m1.36.36.1.1.1.2.cmml" xref="A1.E15.m1.39.39.4"></times><apply id="A1.E15.m1.11.11.11.11.11.11.cmml" xref="A1.E15.m1.11.11.11.11.11.11"><divide id="A1.E15.m1.11.11.11.11.11.11.3.cmml" xref="A1.E15.m1.11.11.11.11.11.11"></divide><apply id="A1.E15.m1.11.11.11.11.11.11.2.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2"><plus id="A1.E15.m1.11.11.11.11.11.11.2.3.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2.3"></plus><apply id="A1.E15.m1.11.11.11.11.11.11.2.4.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2.4"><csymbol cd="ambiguous" id="A1.E15.m1.11.11.11.11.11.11.2.4.1.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2.4">subscript</csymbol><ci id="A1.E15.m1.11.11.11.11.11.11.2.4.2.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2.4.2">𝑿</ci><list id="A1.E15.m1.11.11.11.11.11.11.2.2.2.3.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2.2.2.4"><ci id="A1.E15.m1.11.11.11.11.11.11.1.1.1.1.cmml" xref="A1.E15.m1.11.11.11.11.11.11.1.1.1.1">𝑛</ci><ci id="A1.E15.m1.11.11.11.11.11.11.2.2.2.2.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2.2.2.2">:</ci></list></apply><apply id="A1.E15.m1.11.11.11.11.11.11.2.5.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2.5"><csymbol cd="latexml" id="A1.E15.m1.11.11.11.11.11.11.2.5.1.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2.5.1">direct-product</csymbol><ci id="A1.E15.m1.11.11.11.11.11.11.2.5.2.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2.5.2">𝒔</ci><apply id="A1.E15.m1.11.11.11.11.11.11.2.5.3.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2.5.3"><csymbol cd="ambiguous" id="A1.E15.m1.11.11.11.11.11.11.2.5.3.1.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2.5.3">subscript</csymbol><ci id="A1.E15.m1.11.11.11.11.11.11.2.5.3.2.cmml" xref="A1.E15.m1.11.11.11.11.11.11.2.5.3.2">𝒓</ci><cn id="A1.E15.m1.11.11.11.11.11.11.2.5.3.3.cmml" type="integer" xref="A1.E15.m1.11.11.11.11.11.11.2.5.3.3">2</cn></apply></apply></apply><apply id="A1.E15.m1.11.11.11.11.11.11.4.cmml" xref="A1.E15.m1.11.11.11.11.11.11.4"><csymbol cd="ambiguous" id="A1.E15.m1.11.11.11.11.11.11.4.1.cmml" xref="A1.E15.m1.11.11.11.11.11.11.4">subscript</csymbol><ci id="A1.E15.m1.11.11.11.11.11.11.4.2.cmml" xref="A1.E15.m1.11.11.11.11.11.11.4.2">𝒓</ci><cn id="A1.E15.m1.11.11.11.11.11.11.4.3.cmml" type="integer" xref="A1.E15.m1.11.11.11.11.11.11.4.3">1</cn></apply></apply><apply id="A1.E15.m1.36.36.1.1.1.1.1.1.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="latexml" id="A1.E15.m1.15.15.15.15.15.15.cmml" xref="A1.E15.m1.15.15.15.15.15.15">direct-product</csymbol><apply id="A1.E15.m1.36.36.1.1.1.1.1.1.2.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.36.36.1.1.1.1.1.1.2.1.cmml" xref="A1.E15.m1.39.39.4">subscript</csymbol><ci id="A1.E15.m1.13.13.13.13.13.13.cmml" xref="A1.E15.m1.13.13.13.13.13.13">𝒓</ci><cn id="A1.E15.m1.14.14.14.14.14.14.1.cmml" type="integer" xref="A1.E15.m1.14.14.14.14.14.14.1">1</cn></apply><apply id="A1.E15.m1.36.36.1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.36.36.1.1.1.1.1.1.3.1.cmml" xref="A1.E15.m1.39.39.4">subscript</csymbol><apply id="A1.E15.m1.36.36.1.1.1.1.1.1.3.2.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.36.36.1.1.1.1.1.1.3.2.1.cmml" xref="A1.E15.m1.39.39.4">superscript</csymbol><ci id="A1.E15.m1.16.16.16.16.16.16.cmml" xref="A1.E15.m1.16.16.16.16.16.16">𝑾</ci><apply id="A1.E15.m1.17.17.17.17.17.17.1.cmml" xref="A1.E15.m1.17.17.17.17.17.17.1"><times id="A1.E15.m1.17.17.17.17.17.17.1.1.cmml" xref="A1.E15.m1.17.17.17.17.17.17.1.1"></times><ci id="A1.E15.m1.17.17.17.17.17.17.1.2.cmml" xref="A1.E15.m1.17.17.17.17.17.17.1.2">𝑞</ci><ci id="A1.E15.m1.17.17.17.17.17.17.1.3.cmml" xref="A1.E15.m1.17.17.17.17.17.17.1.3">𝑘</ci><ci id="A1.E15.m1.17.17.17.17.17.17.1.4.cmml" xref="A1.E15.m1.17.17.17.17.17.17.1.4">𝑣</ci></apply></apply><list id="A1.E15.m1.18.18.18.18.18.18.1.3.cmml" xref="A1.E15.m1.18.18.18.18.18.18.1.4"><ci id="A1.E15.m1.18.18.18.18.18.18.1.1.cmml" xref="A1.E15.m1.18.18.18.18.18.18.1.1">:</ci><ci id="A1.E15.m1.18.18.18.18.18.18.1.2.cmml" xref="A1.E15.m1.18.18.18.18.18.18.1.2">𝑗</ci></list></apply></apply></apply><apply id="A1.E15.m1.37.37.2.2.2.1.1.cmml" xref="A1.E15.m1.39.39.4"><minus id="A1.E15.m1.25.25.25.6.6.6.cmml" xref="A1.E15.m1.25.25.25.6.6.6"></minus><apply id="A1.E15.m1.37.37.2.2.2.1.1.3.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.37.37.2.2.2.1.1.3.1.cmml" xref="A1.E15.m1.39.39.4">subscript</csymbol><apply id="A1.E15.m1.37.37.2.2.2.1.1.3.2.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.37.37.2.2.2.1.1.3.2.1.cmml" xref="A1.E15.m1.39.39.4">superscript</csymbol><ci id="A1.E15.m1.22.22.22.3.3.3.cmml" xref="A1.E15.m1.22.22.22.3.3.3">𝒃</ci><apply id="A1.E15.m1.23.23.23.4.4.4.1.cmml" xref="A1.E15.m1.23.23.23.4.4.4.1"><times id="A1.E15.m1.23.23.23.4.4.4.1.1.cmml" xref="A1.E15.m1.23.23.23.4.4.4.1.1"></times><ci id="A1.E15.m1.23.23.23.4.4.4.1.2.cmml" xref="A1.E15.m1.23.23.23.4.4.4.1.2">𝑞</ci><ci id="A1.E15.m1.23.23.23.4.4.4.1.3.cmml" xref="A1.E15.m1.23.23.23.4.4.4.1.3">𝑘</ci><ci id="A1.E15.m1.23.23.23.4.4.4.1.4.cmml" xref="A1.E15.m1.23.23.23.4.4.4.1.4">𝑣</ci></apply></apply><ci id="A1.E15.m1.24.24.24.5.5.5.1.cmml" xref="A1.E15.m1.24.24.24.5.5.5.1">𝑗</ci></apply><apply id="A1.E15.m1.37.37.2.2.2.1.1.1.cmml" xref="A1.E15.m1.39.39.4"><times id="A1.E15.m1.37.37.2.2.2.1.1.1.2.cmml" xref="A1.E15.m1.39.39.4"></times><apply id="A1.E15.m1.37.37.2.2.2.1.1.1.1.1.1.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="latexml" id="A1.E15.m1.28.28.28.9.9.9.cmml" xref="A1.E15.m1.28.28.28.9.9.9">direct-product</csymbol><ci id="A1.E15.m1.27.27.27.8.8.8.cmml" xref="A1.E15.m1.27.27.27.8.8.8">𝒔</ci><apply id="A1.E15.m1.37.37.2.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.37.37.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E15.m1.39.39.4">subscript</csymbol><ci id="A1.E15.m1.29.29.29.10.10.10.cmml" xref="A1.E15.m1.29.29.29.10.10.10">𝒓</ci><cn id="A1.E15.m1.30.30.30.11.11.11.1.cmml" type="integer" xref="A1.E15.m1.30.30.30.11.11.11.1">2</cn></apply></apply><apply id="A1.E15.m1.37.37.2.2.2.1.1.1.3.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.37.37.2.2.2.1.1.1.3.1.cmml" xref="A1.E15.m1.39.39.4">subscript</csymbol><apply id="A1.E15.m1.37.37.2.2.2.1.1.1.3.2.cmml" xref="A1.E15.m1.39.39.4"><csymbol cd="ambiguous" id="A1.E15.m1.37.37.2.2.2.1.1.1.3.2.1.cmml" xref="A1.E15.m1.39.39.4">superscript</csymbol><ci id="A1.E15.m1.32.32.32.13.13.13.cmml" xref="A1.E15.m1.32.32.32.13.13.13">𝑾</ci><apply id="A1.E15.m1.33.33.33.14.14.14.1.cmml" xref="A1.E15.m1.33.33.33.14.14.14.1"><times id="A1.E15.m1.33.33.33.14.14.14.1.1.cmml" xref="A1.E15.m1.33.33.33.14.14.14.1.1"></times><ci id="A1.E15.m1.33.33.33.14.14.14.1.2.cmml" xref="A1.E15.m1.33.33.33.14.14.14.1.2">𝑞</ci><ci id="A1.E15.m1.33.33.33.14.14.14.1.3.cmml" xref="A1.E15.m1.33.33.33.14.14.14.1.3">𝑘</ci><ci id="A1.E15.m1.33.33.33.14.14.14.1.4.cmml" xref="A1.E15.m1.33.33.33.14.14.14.1.4">𝑣</ci></apply></apply><list id="A1.E15.m1.34.34.34.15.15.15.1.3.cmml" xref="A1.E15.m1.34.34.34.15.15.15.1.4"><ci id="A1.E15.m1.34.34.34.15.15.15.1.1.cmml" xref="A1.E15.m1.34.34.34.15.15.15.1.1">:</ci><ci id="A1.E15.m1.34.34.34.15.15.15.1.2.cmml" xref="A1.E15.m1.34.34.34.15.15.15.1.2">𝑗</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15.m1.39c">\begin{split}\bm{X}_{n,:}\bm{W}^{qkv}_{:,j}+\bm{b}^{qkv}_{j}=\frac{\bm{X}_{n,:%
}+\bm{s}\odot\bm{r}_{2}}{\bm{r}_{1}}\left(\bm{r}_{1}\odot\bm{W}^{qkv}_{:,j}%
\right)\\
+\left(\bm{b}^{qkv}_{j}-(\bm{s}\odot\bm{r}_{2})\bm{W}^{qkv}_{:,j}\right)\end{split}</annotation><annotation encoding="application/x-llamapun" id="A1.E15.m1.39d">start_ROW start_CELL bold_italic_X start_POSTSUBSCRIPT italic_n , : end_POSTSUBSCRIPT bold_italic_W start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT : , italic_j end_POSTSUBSCRIPT + bold_italic_b start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = divide start_ARG bold_italic_X start_POSTSUBSCRIPT italic_n , : end_POSTSUBSCRIPT + bold_italic_s ⊙ bold_italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG ( bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊙ bold_italic_W start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT : , italic_j end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL + ( bold_italic_b start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - ( bold_italic_s ⊙ bold_italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) bold_italic_W start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT : , italic_j end_POSTSUBSCRIPT ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p5.2">which suggests that to ensure the next layer’s outputs remain consistent, we need to adjust the weights as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A1.E16">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E16X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\widetilde{\bm{W}}^{qkv}_{:,j}" class="ltx_Math" display="inline" id="A1.E16X.2.1.1.m1.2"><semantics id="A1.E16X.2.1.1.m1.2a"><msubsup id="A1.E16X.2.1.1.m1.2.3" xref="A1.E16X.2.1.1.m1.2.3.cmml"><mover accent="true" id="A1.E16X.2.1.1.m1.2.3.2.2" xref="A1.E16X.2.1.1.m1.2.3.2.2.cmml"><mi id="A1.E16X.2.1.1.m1.2.3.2.2.2" xref="A1.E16X.2.1.1.m1.2.3.2.2.2.cmml">𝑾</mi><mo id="A1.E16X.2.1.1.m1.2.3.2.2.1" xref="A1.E16X.2.1.1.m1.2.3.2.2.1.cmml">~</mo></mover><mrow id="A1.E16X.2.1.1.m1.2.2.2.4" xref="A1.E16X.2.1.1.m1.2.2.2.3.cmml"><mo id="A1.E16X.2.1.1.m1.1.1.1.1" rspace="0em" xref="A1.E16X.2.1.1.m1.1.1.1.1.cmml">:</mo><mo id="A1.E16X.2.1.1.m1.2.2.2.4.1" xref="A1.E16X.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="A1.E16X.2.1.1.m1.2.2.2.2" xref="A1.E16X.2.1.1.m1.2.2.2.2.cmml">j</mi></mrow><mrow id="A1.E16X.2.1.1.m1.2.3.2.3" xref="A1.E16X.2.1.1.m1.2.3.2.3.cmml"><mi id="A1.E16X.2.1.1.m1.2.3.2.3.2" xref="A1.E16X.2.1.1.m1.2.3.2.3.2.cmml">q</mi><mo id="A1.E16X.2.1.1.m1.2.3.2.3.1" xref="A1.E16X.2.1.1.m1.2.3.2.3.1.cmml">⁢</mo><mi id="A1.E16X.2.1.1.m1.2.3.2.3.3" xref="A1.E16X.2.1.1.m1.2.3.2.3.3.cmml">k</mi><mo id="A1.E16X.2.1.1.m1.2.3.2.3.1a" xref="A1.E16X.2.1.1.m1.2.3.2.3.1.cmml">⁢</mo><mi id="A1.E16X.2.1.1.m1.2.3.2.3.4" xref="A1.E16X.2.1.1.m1.2.3.2.3.4.cmml">v</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.E16X.2.1.1.m1.2b"><apply id="A1.E16X.2.1.1.m1.2.3.cmml" xref="A1.E16X.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="A1.E16X.2.1.1.m1.2.3.1.cmml" xref="A1.E16X.2.1.1.m1.2.3">subscript</csymbol><apply id="A1.E16X.2.1.1.m1.2.3.2.cmml" xref="A1.E16X.2.1.1.m1.2.3"><csymbol cd="ambiguous" id="A1.E16X.2.1.1.m1.2.3.2.1.cmml" xref="A1.E16X.2.1.1.m1.2.3">superscript</csymbol><apply id="A1.E16X.2.1.1.m1.2.3.2.2.cmml" xref="A1.E16X.2.1.1.m1.2.3.2.2"><ci id="A1.E16X.2.1.1.m1.2.3.2.2.1.cmml" xref="A1.E16X.2.1.1.m1.2.3.2.2.1">~</ci><ci id="A1.E16X.2.1.1.m1.2.3.2.2.2.cmml" xref="A1.E16X.2.1.1.m1.2.3.2.2.2">𝑾</ci></apply><apply id="A1.E16X.2.1.1.m1.2.3.2.3.cmml" xref="A1.E16X.2.1.1.m1.2.3.2.3"><times id="A1.E16X.2.1.1.m1.2.3.2.3.1.cmml" xref="A1.E16X.2.1.1.m1.2.3.2.3.1"></times><ci id="A1.E16X.2.1.1.m1.2.3.2.3.2.cmml" xref="A1.E16X.2.1.1.m1.2.3.2.3.2">𝑞</ci><ci id="A1.E16X.2.1.1.m1.2.3.2.3.3.cmml" xref="A1.E16X.2.1.1.m1.2.3.2.3.3">𝑘</ci><ci id="A1.E16X.2.1.1.m1.2.3.2.3.4.cmml" xref="A1.E16X.2.1.1.m1.2.3.2.3.4">𝑣</ci></apply></apply><list id="A1.E16X.2.1.1.m1.2.2.2.3.cmml" xref="A1.E16X.2.1.1.m1.2.2.2.4"><ci id="A1.E16X.2.1.1.m1.1.1.1.1.cmml" xref="A1.E16X.2.1.1.m1.1.1.1.1">:</ci><ci id="A1.E16X.2.1.1.m1.2.2.2.2.cmml" xref="A1.E16X.2.1.1.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16X.2.1.1.m1.2c">\displaystyle\widetilde{\bm{W}}^{qkv}_{:,j}</annotation><annotation encoding="application/x-llamapun" id="A1.E16X.2.1.1.m1.2d">over~ start_ARG bold_italic_W end_ARG start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT : , italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\bm{r}_{1}\odot\bm{W}^{qkv}_{:,j}" class="ltx_Math" display="inline" id="A1.E16X.3.2.2.m1.2"><semantics id="A1.E16X.3.2.2.m1.2a"><mrow id="A1.E16X.3.2.2.m1.2.3" xref="A1.E16X.3.2.2.m1.2.3.cmml"><mi id="A1.E16X.3.2.2.m1.2.3.2" xref="A1.E16X.3.2.2.m1.2.3.2.cmml"></mi><mo id="A1.E16X.3.2.2.m1.2.3.1" xref="A1.E16X.3.2.2.m1.2.3.1.cmml">=</mo><mrow id="A1.E16X.3.2.2.m1.2.3.3" xref="A1.E16X.3.2.2.m1.2.3.3.cmml"><msub id="A1.E16X.3.2.2.m1.2.3.3.2" xref="A1.E16X.3.2.2.m1.2.3.3.2.cmml"><mi id="A1.E16X.3.2.2.m1.2.3.3.2.2" xref="A1.E16X.3.2.2.m1.2.3.3.2.2.cmml">𝒓</mi><mn id="A1.E16X.3.2.2.m1.2.3.3.2.3" xref="A1.E16X.3.2.2.m1.2.3.3.2.3.cmml">1</mn></msub><mo id="A1.E16X.3.2.2.m1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.E16X.3.2.2.m1.2.3.3.1.cmml">⊙</mo><msubsup id="A1.E16X.3.2.2.m1.2.3.3.3" xref="A1.E16X.3.2.2.m1.2.3.3.3.cmml"><mi id="A1.E16X.3.2.2.m1.2.3.3.3.2.2" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.2.cmml">𝑾</mi><mrow id="A1.E16X.3.2.2.m1.2.2.2.4" xref="A1.E16X.3.2.2.m1.2.2.2.3.cmml"><mo id="A1.E16X.3.2.2.m1.1.1.1.1" rspace="0em" xref="A1.E16X.3.2.2.m1.1.1.1.1.cmml">:</mo><mo id="A1.E16X.3.2.2.m1.2.2.2.4.1" xref="A1.E16X.3.2.2.m1.2.2.2.3.cmml">,</mo><mi id="A1.E16X.3.2.2.m1.2.2.2.2" xref="A1.E16X.3.2.2.m1.2.2.2.2.cmml">j</mi></mrow><mrow id="A1.E16X.3.2.2.m1.2.3.3.3.2.3" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.3.cmml"><mi id="A1.E16X.3.2.2.m1.2.3.3.3.2.3.2" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.3.2.cmml">q</mi><mo id="A1.E16X.3.2.2.m1.2.3.3.3.2.3.1" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="A1.E16X.3.2.2.m1.2.3.3.3.2.3.3" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.3.3.cmml">k</mi><mo id="A1.E16X.3.2.2.m1.2.3.3.3.2.3.1a" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.3.1.cmml">⁢</mo><mi id="A1.E16X.3.2.2.m1.2.3.3.3.2.3.4" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.3.4.cmml">v</mi></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E16X.3.2.2.m1.2b"><apply id="A1.E16X.3.2.2.m1.2.3.cmml" xref="A1.E16X.3.2.2.m1.2.3"><eq id="A1.E16X.3.2.2.m1.2.3.1.cmml" xref="A1.E16X.3.2.2.m1.2.3.1"></eq><csymbol cd="latexml" id="A1.E16X.3.2.2.m1.2.3.2.cmml" xref="A1.E16X.3.2.2.m1.2.3.2">absent</csymbol><apply id="A1.E16X.3.2.2.m1.2.3.3.cmml" xref="A1.E16X.3.2.2.m1.2.3.3"><csymbol cd="latexml" id="A1.E16X.3.2.2.m1.2.3.3.1.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.1">direct-product</csymbol><apply id="A1.E16X.3.2.2.m1.2.3.3.2.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.2"><csymbol cd="ambiguous" id="A1.E16X.3.2.2.m1.2.3.3.2.1.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.2">subscript</csymbol><ci id="A1.E16X.3.2.2.m1.2.3.3.2.2.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.2.2">𝒓</ci><cn id="A1.E16X.3.2.2.m1.2.3.3.2.3.cmml" type="integer" xref="A1.E16X.3.2.2.m1.2.3.3.2.3">1</cn></apply><apply id="A1.E16X.3.2.2.m1.2.3.3.3.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.3"><csymbol cd="ambiguous" id="A1.E16X.3.2.2.m1.2.3.3.3.1.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.3">subscript</csymbol><apply id="A1.E16X.3.2.2.m1.2.3.3.3.2.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.3"><csymbol cd="ambiguous" id="A1.E16X.3.2.2.m1.2.3.3.3.2.1.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.3">superscript</csymbol><ci id="A1.E16X.3.2.2.m1.2.3.3.3.2.2.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.2">𝑾</ci><apply id="A1.E16X.3.2.2.m1.2.3.3.3.2.3.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.3"><times id="A1.E16X.3.2.2.m1.2.3.3.3.2.3.1.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.3.1"></times><ci id="A1.E16X.3.2.2.m1.2.3.3.3.2.3.2.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.3.2">𝑞</ci><ci id="A1.E16X.3.2.2.m1.2.3.3.3.2.3.3.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.3.3">𝑘</ci><ci id="A1.E16X.3.2.2.m1.2.3.3.3.2.3.4.cmml" xref="A1.E16X.3.2.2.m1.2.3.3.3.2.3.4">𝑣</ci></apply></apply><list id="A1.E16X.3.2.2.m1.2.2.2.3.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.4"><ci id="A1.E16X.3.2.2.m1.1.1.1.1.cmml" xref="A1.E16X.3.2.2.m1.1.1.1.1">:</ci><ci id="A1.E16X.3.2.2.m1.2.2.2.2.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16X.3.2.2.m1.2c">\displaystyle=\bm{r}_{1}\odot\bm{W}^{qkv}_{:,j}</annotation><annotation encoding="application/x-llamapun" id="A1.E16X.3.2.2.m1.2d">= bold_italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⊙ bold_italic_W start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT : , italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(16)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E16Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\widetilde{\bm{b}}^{qkv}_{j}" class="ltx_Math" display="inline" id="A1.E16Xa.2.1.1.m1.1"><semantics id="A1.E16Xa.2.1.1.m1.1a"><msubsup id="A1.E16Xa.2.1.1.m1.1.1" xref="A1.E16Xa.2.1.1.m1.1.1.cmml"><mover accent="true" id="A1.E16Xa.2.1.1.m1.1.1.2.2" xref="A1.E16Xa.2.1.1.m1.1.1.2.2.cmml"><mi id="A1.E16Xa.2.1.1.m1.1.1.2.2.2" xref="A1.E16Xa.2.1.1.m1.1.1.2.2.2.cmml">𝒃</mi><mo id="A1.E16Xa.2.1.1.m1.1.1.2.2.1" xref="A1.E16Xa.2.1.1.m1.1.1.2.2.1.cmml">~</mo></mover><mi id="A1.E16Xa.2.1.1.m1.1.1.3" xref="A1.E16Xa.2.1.1.m1.1.1.3.cmml">j</mi><mrow id="A1.E16Xa.2.1.1.m1.1.1.2.3" xref="A1.E16Xa.2.1.1.m1.1.1.2.3.cmml"><mi id="A1.E16Xa.2.1.1.m1.1.1.2.3.2" xref="A1.E16Xa.2.1.1.m1.1.1.2.3.2.cmml">q</mi><mo id="A1.E16Xa.2.1.1.m1.1.1.2.3.1" xref="A1.E16Xa.2.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="A1.E16Xa.2.1.1.m1.1.1.2.3.3" xref="A1.E16Xa.2.1.1.m1.1.1.2.3.3.cmml">k</mi><mo id="A1.E16Xa.2.1.1.m1.1.1.2.3.1a" xref="A1.E16Xa.2.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="A1.E16Xa.2.1.1.m1.1.1.2.3.4" xref="A1.E16Xa.2.1.1.m1.1.1.2.3.4.cmml">v</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.E16Xa.2.1.1.m1.1b"><apply id="A1.E16Xa.2.1.1.m1.1.1.cmml" xref="A1.E16Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.E16Xa.2.1.1.m1.1.1.1.cmml" xref="A1.E16Xa.2.1.1.m1.1.1">subscript</csymbol><apply id="A1.E16Xa.2.1.1.m1.1.1.2.cmml" xref="A1.E16Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.E16Xa.2.1.1.m1.1.1.2.1.cmml" xref="A1.E16Xa.2.1.1.m1.1.1">superscript</csymbol><apply id="A1.E16Xa.2.1.1.m1.1.1.2.2.cmml" xref="A1.E16Xa.2.1.1.m1.1.1.2.2"><ci id="A1.E16Xa.2.1.1.m1.1.1.2.2.1.cmml" xref="A1.E16Xa.2.1.1.m1.1.1.2.2.1">~</ci><ci id="A1.E16Xa.2.1.1.m1.1.1.2.2.2.cmml" xref="A1.E16Xa.2.1.1.m1.1.1.2.2.2">𝒃</ci></apply><apply id="A1.E16Xa.2.1.1.m1.1.1.2.3.cmml" xref="A1.E16Xa.2.1.1.m1.1.1.2.3"><times id="A1.E16Xa.2.1.1.m1.1.1.2.3.1.cmml" xref="A1.E16Xa.2.1.1.m1.1.1.2.3.1"></times><ci id="A1.E16Xa.2.1.1.m1.1.1.2.3.2.cmml" xref="A1.E16Xa.2.1.1.m1.1.1.2.3.2">𝑞</ci><ci id="A1.E16Xa.2.1.1.m1.1.1.2.3.3.cmml" xref="A1.E16Xa.2.1.1.m1.1.1.2.3.3">𝑘</ci><ci id="A1.E16Xa.2.1.1.m1.1.1.2.3.4.cmml" xref="A1.E16Xa.2.1.1.m1.1.1.2.3.4">𝑣</ci></apply></apply><ci id="A1.E16Xa.2.1.1.m1.1.1.3.cmml" xref="A1.E16Xa.2.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16Xa.2.1.1.m1.1c">\displaystyle\widetilde{\bm{b}}^{qkv}_{j}</annotation><annotation encoding="application/x-llamapun" id="A1.E16Xa.2.1.1.m1.1d">over~ start_ARG bold_italic_b end_ARG start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\bm{b}^{qkv}_{j}-(\bm{s}\odot\bm{r}_{2})\bm{W}^{qkv}_{:,j}" class="ltx_Math" display="inline" id="A1.E16Xa.3.2.2.m1.3"><semantics id="A1.E16Xa.3.2.2.m1.3a"><mrow id="A1.E16Xa.3.2.2.m1.3.3" xref="A1.E16Xa.3.2.2.m1.3.3.cmml"><mi id="A1.E16Xa.3.2.2.m1.3.3.3" xref="A1.E16Xa.3.2.2.m1.3.3.3.cmml"></mi><mo id="A1.E16Xa.3.2.2.m1.3.3.2" xref="A1.E16Xa.3.2.2.m1.3.3.2.cmml">=</mo><mrow id="A1.E16Xa.3.2.2.m1.3.3.1" xref="A1.E16Xa.3.2.2.m1.3.3.1.cmml"><msubsup id="A1.E16Xa.3.2.2.m1.3.3.1.3" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.cmml"><mi id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.2" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.2.cmml">𝒃</mi><mi id="A1.E16Xa.3.2.2.m1.3.3.1.3.3" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.3.cmml">j</mi><mrow id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.cmml"><mi id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.2" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.2.cmml">q</mi><mo id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.1" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.1.cmml">⁢</mo><mi id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.3" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.3.cmml">k</mi><mo id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.1a" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.1.cmml">⁢</mo><mi id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.4" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.4.cmml">v</mi></mrow></msubsup><mo id="A1.E16Xa.3.2.2.m1.3.3.1.2" xref="A1.E16Xa.3.2.2.m1.3.3.1.2.cmml">−</mo><mrow id="A1.E16Xa.3.2.2.m1.3.3.1.1" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.cmml"><mrow id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.cmml"><mo id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.2" stretchy="false" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.cmml"><mi id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.2" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.2.cmml">𝒔</mi><mo id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml">⊙</mo><msub id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3.cmml"><mi id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3.2" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3.2.cmml">𝒓</mi><mn id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3.3" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.3" stretchy="false" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E16Xa.3.2.2.m1.3.3.1.1.2" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.2.cmml">⁢</mo><msubsup id="A1.E16Xa.3.2.2.m1.3.3.1.1.3" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.cmml"><mi id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.2" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.2.cmml">𝑾</mi><mrow id="A1.E16Xa.3.2.2.m1.2.2.2.4" xref="A1.E16Xa.3.2.2.m1.2.2.2.3.cmml"><mo id="A1.E16Xa.3.2.2.m1.1.1.1.1" rspace="0em" xref="A1.E16Xa.3.2.2.m1.1.1.1.1.cmml">:</mo><mo id="A1.E16Xa.3.2.2.m1.2.2.2.4.1" xref="A1.E16Xa.3.2.2.m1.2.2.2.3.cmml">,</mo><mi id="A1.E16Xa.3.2.2.m1.2.2.2.2" xref="A1.E16Xa.3.2.2.m1.2.2.2.2.cmml">j</mi></mrow><mrow id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.cmml"><mi id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.2" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.2.cmml">q</mi><mo id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.1" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.1.cmml">⁢</mo><mi id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.3" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.3.cmml">k</mi><mo id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.1a" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.1.cmml">⁢</mo><mi id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.4" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.4.cmml">v</mi></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E16Xa.3.2.2.m1.3b"><apply id="A1.E16Xa.3.2.2.m1.3.3.cmml" xref="A1.E16Xa.3.2.2.m1.3.3"><eq id="A1.E16Xa.3.2.2.m1.3.3.2.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.2"></eq><csymbol cd="latexml" id="A1.E16Xa.3.2.2.m1.3.3.3.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.3">absent</csymbol><apply id="A1.E16Xa.3.2.2.m1.3.3.1.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1"><minus id="A1.E16Xa.3.2.2.m1.3.3.1.2.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.2"></minus><apply id="A1.E16Xa.3.2.2.m1.3.3.1.3.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.3"><csymbol cd="ambiguous" id="A1.E16Xa.3.2.2.m1.3.3.1.3.1.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.3">subscript</csymbol><apply id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.3"><csymbol cd="ambiguous" id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.1.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.3">superscript</csymbol><ci id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.2.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.2">𝒃</ci><apply id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3"><times id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.1.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.1"></times><ci id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.2.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.2">𝑞</ci><ci id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.3.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.3">𝑘</ci><ci id="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.4.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.2.3.4">𝑣</ci></apply></apply><ci id="A1.E16Xa.3.2.2.m1.3.3.1.3.3.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.3.3">𝑗</ci></apply><apply id="A1.E16Xa.3.2.2.m1.3.3.1.1.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1"><times id="A1.E16Xa.3.2.2.m1.3.3.1.1.2.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.2"></times><apply id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.1">direct-product</csymbol><ci id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.2.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.2">𝒔</ci><apply id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3.1.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3.2.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3.2">𝒓</ci><cn id="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.1.1.1.3.3">2</cn></apply></apply><apply id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.1.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3">subscript</csymbol><apply id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.1.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3">superscript</csymbol><ci id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.2.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.2">𝑾</ci><apply id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3"><times id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.1.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.1"></times><ci id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.2.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.2">𝑞</ci><ci id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.3.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.3">𝑘</ci><ci id="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.4.cmml" xref="A1.E16Xa.3.2.2.m1.3.3.1.1.3.2.3.4">𝑣</ci></apply></apply><list id="A1.E16Xa.3.2.2.m1.2.2.2.3.cmml" xref="A1.E16Xa.3.2.2.m1.2.2.2.4"><ci id="A1.E16Xa.3.2.2.m1.1.1.1.1.cmml" xref="A1.E16Xa.3.2.2.m1.1.1.1.1">:</ci><ci id="A1.E16Xa.3.2.2.m1.2.2.2.2.cmml" xref="A1.E16Xa.3.2.2.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16Xa.3.2.2.m1.3c">\displaystyle=\bm{b}^{qkv}_{j}-(\bm{s}\odot\bm{r}_{2})\bm{W}^{qkv}_{:,j}</annotation><annotation encoding="application/x-llamapun" id="A1.E16Xa.3.2.2.m1.3d">= bold_italic_b start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - ( bold_italic_s ⊙ bold_italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) bold_italic_W start_POSTSUPERSCRIPT italic_q italic_k italic_v end_POSTSUPERSCRIPT start_POSTSUBSCRIPT : , italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.p6">
<p class="ltx_p" id="A1.SS2.p6.1">Combining Eqs. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A1.E14" title="In A.2 RepQ-ViT: Scale Reparameterization ‣ Appendix A Our preliminary efforts for DFQ-SAM ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">14</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A1.E16" title="In A.2 RepQ-ViT: Scale Reparameterization ‣ Appendix A Our preliminary efforts for DFQ-SAM ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">16</span></a>, the parameters to be transformed are presented in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#S3.E10" title="In 3.3 Quantization Calibration: Scale Reparameterization ‣ 3 Methods ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">10</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>More experimental details and results</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span><span class="ltx_text ltx_font_italic" id="A2.SS1.1.1">Implementation Details</span>
</h3>
<div class="ltx_para ltx_noindent" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="A2.SS1.p1.1.1">Models and datasets</span>
The pre-trained model we adopt is SAM-Med2D<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib6" title="">6</a>]</cite>, which achieves impressive image segmentation performance in the medical domain.
To demonstrate generalizability, we adopt a variety of datasets from multiple modalities, as follows:</p>
<ul class="ltx_itemize" id="A2.I1">
<li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i1.p1.1">AbdomenCT1k<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib36" title="">36</a>]</cite>: Abdominal CT organ segmentation, including the liver, kidneys, spleen, and pancreas. The test dataset includes 3,000 images with 3,361 labels.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i2.p1.1">FLARE<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib37" title="">37</a>]</cite>: Abdominal CT organ segmentation, including 13 regions such as the liver, spleen, pancreas, right kidney, left kidney, and stomach. The test dataset includes 479 images with 2,480 labels.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i3.p1">
<p class="ltx_p" id="A2.I1.i3.p1.1">Synapse<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib38" title="">38</a>]</cite>: Abdominal CT organ segmentation, including 9 regions such as the aorta, gallbladder, spleen, left kidney, and right kidney. The test dataset includes 175 images with 672 labels.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i4.p1">
<p class="ltx_p" id="A2.I1.i4.p1.1">ACDC<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib39" title="">39</a>]</cite>: Cardiac MRI organ segmentation, including delineation of the left ventricular cavity, myocardium, and right ventricle. The test dataset includes 423 images with 481 labels.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i5.p1">
<p class="ltx_p" id="A2.I1.i5.p1.1">MSD<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib40" title="">40</a>]</cite>: MRI organ segmentation, including the heart and prostate. The test dataset includes 190 images with 193 labels.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i6.p1">
<p class="ltx_p" id="A2.I1.i6.p1.1">ATLAS<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib41" title="">41</a>]</cite>: Liver MRI organ segmentation, including the liver and liver tumors. The test dataset includes 773 images with 1,169 labels.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i7.p1">
<p class="ltx_p" id="A2.I1.i7.p1.1">AutoPET<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib42" title="">42</a>]</cite>: PET lesion segmentation, including malignant lymphoma, melanoma, and non-small cell lung cancer. The test dataset includes 521 images with 533 labels.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i8.p1">
<p class="ltx_p" id="A2.I1.i8.p1.1">ISIC<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib43" title="">43</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib44" title="">44</a>]</cite>: Dermoscopy melanoma segmentation. The test dataset includes 330 images with 330 labels.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i9" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i9.p1">
<p class="ltx_p" id="A2.I1.i9.p1.1">EndoVis<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib45" title="">45</a>]</cite>: Endoscopy abdominal organ segmentation. The test dataset includes 492 images with 648 labels.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i10" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i10.p1">
<p class="ltx_p" id="A2.I1.i10.p1.1">SA-Med2D-20M<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib6" title="">6</a>]</cite>: The large medical image dataset collected in SAM-Med 2D, and we use ultrasound, X-ray, and Endoscopy datasets (prefixed with SA). SA-Ultrasound is the segmentation of nerves and breasts, including 198 images with 198 labels; SA-Xray is the chest X-ray segmentation for pneumothorax and pulmonary embolism, including 555 images with 580 labels; SA-Endoscopy is the colonoscopy polyp segmentation, including 126 images with 127 labels.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p2">
<p class="ltx_p" id="A2.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="A2.SS1.p2.1.1">Comparison methods</span>
First, DFQ-SAM is compared to the full-precision baseline, which is the original pre-trained model without any post-processing. Then, since there is no data-free quantization work for SAM to date, we have to construct the comparison methods on our own under equivalent conditions, as follows:</p>
<ul class="ltx_itemize" id="A2.I2">
<li class="ltx_item" id="A2.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I2.i1.p1">
<p class="ltx_p" id="A2.I2.i1.p1.1">Real Data: Sampling real data from the original dataset for quantization calibration.</p>
</div>
</li>
<li class="ltx_item" id="A2.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I2.i2.p1">
<p class="ltx_p" id="A2.I2.i2.p1.1">Gaussian Data: Directly using random Gaussian noise for quantization calibration.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="A2.SS1.p3">
<p class="ltx_p" id="A2.SS1.p3.1">Note that to ensure a fair comparison, they differ from DFQ-SAM only in calibration data, while remaining identical in other aspects, such as the calibration strategy.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS1.p4">
<p class="ltx_p" id="A2.SS1.p4.2"><span class="ltx_text ltx_font_bold" id="A2.SS1.p4.2.1">Experimental settings</span>
All experiments in this work are implemented in Pytorch. To accommodate the hardware and deployment toolchains, we apply channel-wise quantization for weights and layer-wise quantization for activations in the inference process, where scale reparameterization is applied to post-LayerNorm activations in all blocks. The quantization bit precision is set to 4, both for weights and activations.
We synthesize one image for each dataset to perform quantization calibration, with a resolution of 256x256 pixels, which is aligned with the training set of SAM-Med2D. In the data synthesis phase, we adopt the Adam <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#bib.bib46" title="">46</a>]</cite> optimizer. Although further tuning might improve accuracy, we standardized the process by setting the total number of iterations to 1500, with label evolution occurring simultaneously during the first 500 iterations. The hyperparameters <math alttext="\alpha" class="ltx_Math" display="inline" id="A2.SS1.p4.1.m1.1"><semantics id="A2.SS1.p4.1.m1.1a"><mi id="A2.SS1.p4.1.m1.1.1" xref="A2.SS1.p4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.1.m1.1b"><ci id="A2.SS1.p4.1.m1.1.1.cmml" xref="A2.SS1.p4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.1.m1.1d">italic_α</annotation></semantics></math> and <math alttext="\beta" class="ltx_Math" display="inline" id="A2.SS1.p4.2.m2.1"><semantics id="A2.SS1.p4.2.m2.1a"><mi id="A2.SS1.p4.2.m2.1.1" xref="A2.SS1.p4.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p4.2.m2.1b"><ci id="A2.SS1.p4.2.m2.1.1.cmml" xref="A2.SS1.p4.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p4.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p4.2.m2.1d">italic_β</annotation></semantics></math> are set to 0.5 and 0.05, respectively, after a grid search. All data synthesis and accuracy evaluation experiments are done on a single NVIDIA RTX A6000 GPU.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span><span class="ltx_text ltx_font_italic" id="A2.SS2.1.1">Visualization of Label Evolution</span>
</h3>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A2.F10" title="Figure 10 ‣ B.2 Visualization of Label Evolution ‣ Appendix B More experimental details and results ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">10</span></a> provides more illustrations of pseudo-label evolution and synthesized image updating (256<math alttext="\times" class="ltx_Math" display="inline" id="A2.SS2.p1.1.m1.1"><semantics id="A2.SS2.p1.1.m1.1a"><mo id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><times id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.1.m1.1d">×</annotation></semantics></math>256 pixels). In the case of different samples, both labels and images co-evolve and gradually learn more semantic information, resulting in a win-win situation.</p>
</div>
<figure class="ltx_figure" id="A2.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F10.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="236" id="A2.F10.sf1.g1" src="x13.png" width="747"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F10.sf1.2.1.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="A2.F10.sf1.3.2" style="font-size:80%;">Sample 1, Grayscale Image</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F10.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="236" id="A2.F10.sf2.g1" src="x14.png" width="747"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F10.sf2.2.1.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="A2.F10.sf2.3.2" style="font-size:80%;">Sample 2, Grayscale Image</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F10.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="236" id="A2.F10.sf3.g1" src="x15.png" width="747"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F10.sf3.2.1.1" style="font-size:80%;">(c)</span> </span><span class="ltx_text" id="A2.F10.sf3.3.2" style="font-size:80%;">Sample 3, Color Image</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F10.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="235" id="A2.F10.sf4.g1" src="x16.png" width="747"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F10.sf4.2.1.1" style="font-size:80%;">(d)</span> </span><span class="ltx_text" id="A2.F10.sf4.3.2" style="font-size:80%;">Sample 4, Color Image</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Illustration of pseudo-label evolution and synthesized image updating (256<math alttext="\times" class="ltx_Math" display="inline" id="A2.F10.2.m1.1"><semantics id="A2.F10.2.m1.1b"><mo id="A2.F10.2.m1.1.1" xref="A2.F10.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F10.2.m1.1c"><times id="A2.F10.2.m1.1.1.cmml" xref="A2.F10.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F10.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F10.2.m1.1e">×</annotation></semantics></math>256 pixels). Label evolution and image updating are conducted alternately: The label continuously discovers new regions based on the image outputs, which in turn further drives the image optimization. Ultimately, both converge at a high semantic level.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span><span class="ltx_text ltx_font_italic" id="A2.SS3.1.1">Qualitative Evaluation of Quantization Results</span>
</h3>
<div class="ltx_para" id="A2.SS3.p1">
<p class="ltx_p" id="A2.SS3.p1.1">Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.01813v1#A2.F11" title="Figure 11 ‣ B.3 Qualitative Evaluation of Quantization Results ‣ Appendix B More experimental details and results ‣ Privacy-Preserving SAM Quantization for Efficient Edge Intelligence in Healthcare"><span class="ltx_text ltx_ref_tag">11</span></a> provides more visualizations of segmentation results on different datasets (256<math alttext="\times" class="ltx_Math" display="inline" id="A2.SS3.p1.1.m1.1"><semantics id="A2.SS3.p1.1.m1.1a"><mo id="A2.SS3.p1.1.m1.1.1" xref="A2.SS3.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.1.m1.1b"><times id="A2.SS3.p1.1.m1.1.1.cmml" xref="A2.SS3.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A2.SS3.p1.1.m1.1d">×</annotation></semantics></math>256 pixels).
As observed, the synthesized data from our DFQ-SAM offers significantly better quantization calibration than Gaussian noise. Furthermore, the 4-bit quantized model produced by DFQ-SAM achieves performance comparable to the full-precision baseline, enabling almost lossless compression.</p>
</div>
<figure class="ltx_figure" id="A2.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F11.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="285" id="A2.F11.sf1.g1" src="x17.png" width="789"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F11.sf1.2.1.1" style="font-size:80%;">(a)</span> </span><span class="ltx_text" id="A2.F11.sf1.3.2" style="font-size:80%;">AbdomenCT1k, FLARE, Synapse, and AutoPET Datasets</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F11.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="285" id="A2.F11.sf2.g1" src="x18.png" width="789"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F11.sf2.2.1.1" style="font-size:80%;">(b)</span> </span><span class="ltx_text" id="A2.F11.sf2.3.2" style="font-size:80%;">ACDC, MSD, ATLAS, and SA-Ultrasound Datasets</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F11.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="285" id="A2.F11.sf3.g1" src="x19.png" width="789"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A2.F11.sf3.2.1.1" style="font-size:80%;">(c)</span> </span><span class="ltx_text" id="A2.F11.sf3.3.2" style="font-size:80%;">SA-Xray, ISIC, EndoVis, and SA-Endoscopy Datasets</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Visualization of segmentation results on different datasets (256<math alttext="\times" class="ltx_Math" display="inline" id="A2.F11.2.m1.1"><semantics id="A2.F11.2.m1.1b"><mo id="A2.F11.2.m1.1.1" xref="A2.F11.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.F11.2.m1.1c"><times id="A2.F11.2.m1.1.1.cmml" xref="A2.F11.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.F11.2.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="A2.F11.2.m1.1e">×</annotation></semantics></math>256 pixels). The proposed DFQ-SAM, which utilizes synthesized data, consistently achieves comparable performance to full-precision baseline at 4-bit quantization.</figcaption>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Sep 14 08:32:23 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
