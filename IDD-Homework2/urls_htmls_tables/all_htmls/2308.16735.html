<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2308.16735] Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment</title><meta property="og:description" content="Deployment of Deep Neural Networks in medical imaging is hindered by distribution shift between training data and data processed after deployment, causing performance degradation. Post-Deployment Adaptation (PDA) addre…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2308.16735">

<!--Generated on Wed Feb 28 10:40:56 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="adaptation domain shift federated learning">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="id1" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>Department of Engineering Science, University of Oxford, UK </span></span></span><span id="id2" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">institutetext: </span>Nuffield Department of Clinical Neurosciences, University of Oxford, UK 
<br class="ltx_break"><span id="id2.1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">email: </span>felix.wagner@eng.ox.ac.uk</span></span></span></span></span></span>
<h1 class="ltx_title ltx_title_document">Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Felix Wagner 
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zeju Li
</span><span class="ltx_author_notes">22</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pramit Saha
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Konstantinos Kamnitsas
</span><span class="ltx_author_notes">11</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Deployment of Deep Neural Networks in medical imaging is hindered by distribution shift between training data and data processed after deployment, causing performance degradation. Post-Deployment Adaptation (PDA) addresses this by tailoring a pre-trained, deployed model to the <em id="id1.id1.1" class="ltx_emph ltx_font_italic">target</em> data distribution using limited labelled or entirely unlabelled target data, while assuming no access to <em id="id1.id1.2" class="ltx_emph ltx_font_italic">source</em> training data as they cannot be deployed with the model due to privacy concerns and their large size. This makes reliable adaptation challenging due to limited learning signal.
This paper challenges this assumption and introduces <span id="id1.id1.3" class="ltx_text ltx_font_bold">FedPDA</span>, a novel adaptation framework that brings the utility of learning from remote data from Federated Learning into PDA. FedPDA enables a deployed model to obtain information from source data via remote gradient exchange, while aiming to optimize the model specifically for the target domain. Tailored for FedPDA, we introduce a novel optimization method <span id="id1.id1.4" class="ltx_text ltx_font_typewriter">StarAlign</span> (<span id="id1.id1.5" class="ltx_text ltx_font_bold">S</span>ource-<span id="id1.id1.6" class="ltx_text ltx_font_bold">Ta</span>rget <span id="id1.id1.7" class="ltx_text ltx_font_bold">R</span>emote Gradient <span id="id1.id1.8" class="ltx_text ltx_font_bold">Align</span>ment) that aligns gradients between source-target domain pairs by maximizing their inner product, to facilitate learning a target-specific model.
We demonstrate the method’s effectiveness using multi-center databases for the tasks of cancer metastases detection and skin lesion classification, where our method compares favourably to previous work. Code is available at: <a target="_blank" href="https://github.com/FelixWag/StarAlign" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/FelixWag/StarAlign</a></p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>adaptation domain shift federated learning
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Effectiveness of <span title="" class="ltx_glossaryref">Deep Neural Networks (DNNs)</span> relies on the assumption that training (source) and testing (target) data are drawn from the same distribution (domain). When <span title="" class="ltx_glossaryref">DNNs</span> are applied to target data from a distribution (target domain) that differs from the training distribution (source domain), i.e. there is distribution shift, <span title="" class="ltx_glossaryref">DNNs</span>’ performance degrades <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. For instance, such shift can occur, when a pre-trained <span title="" class="ltx_glossaryref">DNN</span> model is deployed to a medical institution with data acquired from a different scanner or patient population than the training data. This hinders reliable deployment of <span title="" class="ltx_glossaryref">DNNs</span> in clinical workflows.
<br class="ltx_break"><span id="S1.p1.1.1" class="ltx_text ltx_font_bold">Related Work:</span> Variety of approaches have been investigated to alleviate this issue.
<span title="" class="ltx_glossaryref">Domain Generalization (DG)</span> approaches assume access to data from multiple source domains during training. They aim to learn representations that are invariant to distribution shift, enabling better generalization to any unseen domain <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Due to the great heterogeneity in medical imaging, achieving universal generalization may be too optimistic.
Instead, <span title="" class="ltx_glossaryref">Domain Adaptation (DA)</span> methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> aim to learn a model that performs well on a specific target domain. They assume that (commonly unlabelled) target data and labelled source data is collected in advance and centrally aggregated to train a model <em id="S1.p1.1.2" class="ltx_emph ltx_font_italic">from scratch</em>. Privacy concerns in healthcare limit the scalability of these approaches.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p"><span title="" class="ltx_glossaryref">Federated Learning (FL)</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> enables training a single model on multiple decentralised databases. The original Federated Averaging algorithm (<span id="S1.p2.1.1" class="ltx_text ltx_font_typewriter">FedAvg</span>)<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and its extensions target scenarios where different "nodes" in the federated <em id="S1.p2.1.2" class="ltx_emph ltx_font_italic">consortium</em> have data from different source domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. They train a single model to generalize well across unseen domains.
In contrast, approaches for <em id="S1.p2.1.3" class="ltx_emph ltx_font_italic">Personalization</em> in <span title="" class="ltx_glossaryref">FL</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> learn multiple models, one for each source domain but do not support adaptation to unseen target domains.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Federated Domain Adaptation (FDA) methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> enable <span title="" class="ltx_glossaryref">DA</span> in a federated setting. These methods assume abundant unlabelled data on the target domain and perform distribution matching to enforce domain invariance. They train a model from scratch for each target which limits their practicality, while the enforced invariance can lead to loss of target-specific discriminative features.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p"><span title="" class="ltx_glossaryref">Post-Deployment Adaptation (PDA)</span> methods (or Test-Time Adaptation or Source-free DA) seek to enable a pre-trained/deployed model to optimize itself for the specific target domain by learning only from limited labelled or unlabelled target data processed after deployment <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. These methods assume that deployed models have no access to the source data due to privacy, licensing, or data volume constraints. In practice, however, adaptation using solely limited labelled or unlabelled data can lead to overfitting or unreliable results.
<br class="ltx_break"><span id="S1.p4.1.1" class="ltx_text ltx_font_bold">Contribution:</span> This work presents a novel <span title="" class="ltx_glossaryref">PDA</span> framework to <em id="S1.p4.1.2" class="ltx_emph ltx_font_italic">optimize a pre-trained, deployed model</em> for a <em id="S1.p4.1.3" class="ltx_emph ltx_font_italic">specific target domain</em> of deployment, assuming <em id="S1.p4.1.4" class="ltx_emph ltx_font_italic">limited labelled data at the deployment node</em>, while <em id="S1.p4.1.5" class="ltx_emph ltx_font_italic">remotely obtaining information from source data</em> to facilitate target-specific adaptation.</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">The framework enables a deployed DNN to obtain information from source data without data exchange, using remote gradient exchange. This overcomes PDA’s restriction of unavailable access to source data. This combines <span title="" class="ltx_glossaryref">FL</span> with <span title="" class="ltx_glossaryref">PDA</span> into a new framework, <span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">FedPDA</span> (Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). Unlike <span title="" class="ltx_glossaryref">FL</span>, FedPDA optimizes a target-specific model instead of a model that generalises to any distribution (<span title="" class="ltx_glossaryref">FL</span>) or source distributions (personalized <span title="" class="ltx_glossaryref">FL</span>). While <span title="" class="ltx_glossaryref">DA</span> requires central aggregation of data, FedPDA does not transfer data. FedPDA also differs from FDA by adapting a <em id="S1.I1.i1.p1.1.2" class="ltx_emph ltx_font_italic">pre-trained deployed</em> model at the user’s endpoint, rather than training a model <em id="S1.I1.i1.p1.1.3" class="ltx_emph ltx_font_italic">pre-deployment from scratch</em> with abundant unlabelled target data and ML developer’s oversight. This addresses the practical need for reliable adaptation with limited data and technical challenge of optimizing from a source-specific initial optimum to a target-specific optimum.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Tailored specifically for this setting, we introduce the <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_typewriter">StarAlign</span> optimization algorithm (<span id="S1.I1.i2.p1.1.2" class="ltx_text ltx_font_bold">S</span>ource-<span id="S1.I1.i2.p1.1.3" class="ltx_text ltx_font_bold">Ta</span>rget <span id="S1.I1.i2.p1.1.4" class="ltx_text ltx_font_bold">R</span>emote Gradient <span id="S1.I1.i2.p1.1.5" class="ltx_text ltx_font_bold">Align</span>ment) for decentralised multi-domain training. It extracts gradients from source data and aligns them with target data gradients by maximising the gradient inner product, to regularize adaptation of a target-specific model.</p>
</div>
</li>
</ul>
<p id="S1.p4.2" class="ltx_p">We evaluate the method through extensive experiments on two medical datasets: cancer metastases classification in histology images using Camelyon17 with 5 target domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, and a very challenging setting for skin lesion classification using a collection of 4 databases (HAM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, BCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, MSK <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, D7P <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>).
In numerous settings, our method achieves favourable results compared to state-of-the-art PDA, (personalized) <span title="" class="ltx_glossaryref">FL</span>, FDA and gradient alignment methods.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2308.16735/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="163" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The <span id="S1.F1.3.1" class="ltx_text ltx_font_bold">FedPDA</span> framework consists of three steps: (1) The model is trained on source domains (here via FL); (2) The model is deployed to the target domain; (3) Adaptation is done via gradient alignment between all source-target domain pairs with <span id="S1.F1.4.2" class="ltx_text ltx_font_typewriter">StarAlign</span> without cross-domain data exchange.</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.9" class="ltx_p"><span id="S2.p1.9.1" class="ltx_text ltx_font_bold">Problem setting:</span>
We consider the general case with a set of <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">S</annotation></semantics></math> source domains <math id="S2.p1.2.m2.3" class="ltx_Math" alttext="\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}" display="inline"><semantics id="S2.p1.2.m2.3a"><mrow id="S2.p1.2.m2.3.3.2" xref="S2.p1.2.m2.3.3.3.cmml"><mo stretchy="false" id="S2.p1.2.m2.3.3.2.3" xref="S2.p1.2.m2.3.3.3.cmml">{</mo><msub id="S2.p1.2.m2.2.2.1.1" xref="S2.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.2.2.1.1.2" xref="S2.p1.2.m2.2.2.1.1.2.cmml">𝒟</mi><mn id="S2.p1.2.m2.2.2.1.1.3" xref="S2.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.p1.2.m2.3.3.2.4" xref="S2.p1.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">…</mi><mo id="S2.p1.2.m2.3.3.2.5" xref="S2.p1.2.m2.3.3.3.cmml">,</mo><msub id="S2.p1.2.m2.3.3.2.2" xref="S2.p1.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.3.3.2.2.2" xref="S2.p1.2.m2.3.3.2.2.2.cmml">𝒟</mi><mi id="S2.p1.2.m2.3.3.2.2.3" xref="S2.p1.2.m2.3.3.2.2.3.cmml">S</mi></msub><mo stretchy="false" id="S2.p1.2.m2.3.3.2.6" xref="S2.p1.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.3b"><set id="S2.p1.2.m2.3.3.3.cmml" xref="S2.p1.2.m2.3.3.2"><apply id="S2.p1.2.m2.2.2.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.2.2.1.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S2.p1.2.m2.2.2.1.1.2.cmml" xref="S2.p1.2.m2.2.2.1.1.2">𝒟</ci><cn type="integer" id="S2.p1.2.m2.2.2.1.1.3.cmml" xref="S2.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">…</ci><apply id="S2.p1.2.m2.3.3.2.2.cmml" xref="S2.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.p1.2.m2.3.3.2.2.1.cmml" xref="S2.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S2.p1.2.m2.3.3.2.2.2.cmml" xref="S2.p1.2.m2.3.3.2.2.2">𝒟</ci><ci id="S2.p1.2.m2.3.3.2.2.3.cmml" xref="S2.p1.2.m2.3.3.2.2.3">𝑆</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.3c">\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}</annotation></semantics></math> and one target domain <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{T}" display="inline"><semantics id="S2.p1.3.m3.1a"><msub id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml">𝒟</mi><mi id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2">𝒟</ci><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">\mathcal{D}_{T}</annotation></semantics></math>, where <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="T\!=\!S\!+\!1" display="inline"><semantics id="S2.p1.4.m4.1a"><mrow id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><mi id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml">T</mi><mo lspace="0.108em" rspace="0.108em" id="S2.p1.4.m4.1.1.1" xref="S2.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml"><mi id="S2.p1.4.m4.1.1.3.2" xref="S2.p1.4.m4.1.1.3.2.cmml">S</mi><mo lspace="0.052em" rspace="0.052em" id="S2.p1.4.m4.1.1.3.1" xref="S2.p1.4.m4.1.1.3.1.cmml">+</mo><mn id="S2.p1.4.m4.1.1.3.3" xref="S2.p1.4.m4.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><eq id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1"></eq><ci id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2">𝑇</ci><apply id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3"><plus id="S2.p1.4.m4.1.1.3.1.cmml" xref="S2.p1.4.m4.1.1.3.1"></plus><ci id="S2.p1.4.m4.1.1.3.2.cmml" xref="S2.p1.4.m4.1.1.3.2">𝑆</ci><cn type="integer" id="S2.p1.4.m4.1.1.3.3.cmml" xref="S2.p1.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">T\!=\!S\!+\!1</annotation></semantics></math>. Each domain’s dataset <math id="S2.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{k}\coloneqq\{(x_{i}^{k},y_{i}^{k})\}_{i=1}^{n_{k}}" display="inline"><semantics id="S2.p1.5.m5.1a"><mrow id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml"><msub id="S2.p1.5.m5.1.1.3" xref="S2.p1.5.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.5.m5.1.1.3.2" xref="S2.p1.5.m5.1.1.3.2.cmml">𝒟</mi><mi id="S2.p1.5.m5.1.1.3.3" xref="S2.p1.5.m5.1.1.3.3.cmml">k</mi></msub><mo id="S2.p1.5.m5.1.1.2" xref="S2.p1.5.m5.1.1.2.cmml">≔</mo><msubsup id="S2.p1.5.m5.1.1.1" xref="S2.p1.5.m5.1.1.1.cmml"><mrow id="S2.p1.5.m5.1.1.1.1.1.1" xref="S2.p1.5.m5.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.p1.5.m5.1.1.1.1.1.1.2" xref="S2.p1.5.m5.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.p1.5.m5.1.1.1.1.1.1.1.2" xref="S2.p1.5.m5.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.p1.5.m5.1.1.1.1.1.1.1.2.3" xref="S2.p1.5.m5.1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S2.p1.5.m5.1.1.1.1.1.1.1.1.1" xref="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.2.2" xref="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.2.3" xref="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.3" xref="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S2.p1.5.m5.1.1.1.1.1.1.1.2.4" xref="S2.p1.5.m5.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S2.p1.5.m5.1.1.1.1.1.1.1.2.2" xref="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.2.2" xref="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.2.3" xref="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mi id="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.3" xref="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S2.p1.5.m5.1.1.1.1.1.1.1.2.5" xref="S2.p1.5.m5.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S2.p1.5.m5.1.1.1.1.1.1.3" xref="S2.p1.5.m5.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.5.m5.1.1.1.1.3" xref="S2.p1.5.m5.1.1.1.1.3.cmml"><mi id="S2.p1.5.m5.1.1.1.1.3.2" xref="S2.p1.5.m5.1.1.1.1.3.2.cmml">i</mi><mo id="S2.p1.5.m5.1.1.1.1.3.1" xref="S2.p1.5.m5.1.1.1.1.3.1.cmml">=</mo><mn id="S2.p1.5.m5.1.1.1.1.3.3" xref="S2.p1.5.m5.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S2.p1.5.m5.1.1.1.3" xref="S2.p1.5.m5.1.1.1.3.cmml"><mi id="S2.p1.5.m5.1.1.1.3.2" xref="S2.p1.5.m5.1.1.1.3.2.cmml">n</mi><mi id="S2.p1.5.m5.1.1.1.3.3" xref="S2.p1.5.m5.1.1.1.3.3.cmml">k</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><apply id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1"><ci id="S2.p1.5.m5.1.1.2.cmml" xref="S2.p1.5.m5.1.1.2">≔</ci><apply id="S2.p1.5.m5.1.1.3.cmml" xref="S2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.3.1.cmml" xref="S2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S2.p1.5.m5.1.1.3.2.cmml" xref="S2.p1.5.m5.1.1.3.2">𝒟</ci><ci id="S2.p1.5.m5.1.1.3.3.cmml" xref="S2.p1.5.m5.1.1.3.3">𝑘</ci></apply><apply id="S2.p1.5.m5.1.1.1.cmml" xref="S2.p1.5.m5.1.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.2.cmml" xref="S2.p1.5.m5.1.1.1">superscript</csymbol><apply id="S2.p1.5.m5.1.1.1.1.cmml" xref="S2.p1.5.m5.1.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.1.2.cmml" xref="S2.p1.5.m5.1.1.1">subscript</csymbol><set id="S2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1"><interval closure="open" id="S2.p1.5.m5.1.1.1.1.1.1.1.3.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.2"><apply id="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.p1.5.m5.1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply></interval></set><apply id="S2.p1.5.m5.1.1.1.1.3.cmml" xref="S2.p1.5.m5.1.1.1.1.3"><eq id="S2.p1.5.m5.1.1.1.1.3.1.cmml" xref="S2.p1.5.m5.1.1.1.1.3.1"></eq><ci id="S2.p1.5.m5.1.1.1.1.3.2.cmml" xref="S2.p1.5.m5.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S2.p1.5.m5.1.1.1.1.3.3.cmml" xref="S2.p1.5.m5.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.p1.5.m5.1.1.1.3.cmml" xref="S2.p1.5.m5.1.1.1.3"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.3.1.cmml" xref="S2.p1.5.m5.1.1.1.3">subscript</csymbol><ci id="S2.p1.5.m5.1.1.1.3.2.cmml" xref="S2.p1.5.m5.1.1.1.3.2">𝑛</ci><ci id="S2.p1.5.m5.1.1.1.3.3.cmml" xref="S2.p1.5.m5.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">\mathcal{D}_{k}\coloneqq\{(x_{i}^{k},y_{i}^{k})\}_{i=1}^{n_{k}}</annotation></semantics></math> is drawn from a data distribution <math id="S2.p1.6.m6.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="S2.p1.6.m6.1a"><msub id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mi id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml">p</mi><mi id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2">𝑝</ci><ci id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">p_{k}</annotation></semantics></math>, where <math id="S2.p1.7.m7.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S2.p1.7.m7.1a"><msub id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml"><mi id="S2.p1.7.m7.1.1.2" xref="S2.p1.7.m7.1.1.2.cmml">x</mi><mi id="S2.p1.7.m7.1.1.3" xref="S2.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.1.1.cmml" xref="S2.p1.7.m7.1.1">subscript</csymbol><ci id="S2.p1.7.m7.1.1.2.cmml" xref="S2.p1.7.m7.1.1.2">𝑥</ci><ci id="S2.p1.7.m7.1.1.3.cmml" xref="S2.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">x_{i}</annotation></semantics></math> is an image and <math id="S2.p1.8.m8.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S2.p1.8.m8.1a"><msub id="S2.p1.8.m8.1.1" xref="S2.p1.8.m8.1.1.cmml"><mi id="S2.p1.8.m8.1.1.2" xref="S2.p1.8.m8.1.1.2.cmml">y</mi><mi id="S2.p1.8.m8.1.1.3" xref="S2.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.1b"><apply id="S2.p1.8.m8.1.1.cmml" xref="S2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m8.1.1.1.cmml" xref="S2.p1.8.m8.1.1">subscript</csymbol><ci id="S2.p1.8.m8.1.1.2.cmml" xref="S2.p1.8.m8.1.1.2">𝑦</ci><ci id="S2.p1.8.m8.1.1.3.cmml" xref="S2.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.1c">y_{i}</annotation></semantics></math> the corresponding label. We assume there are little available labels in the target domain, <math id="S2.p1.9.m9.4" class="ltx_Math" alttext="|\mathcal{D}_{T}|\ll|\mathcal{D}_{k}|,\forall k\in[1,S]" display="inline"><semantics id="S2.p1.9.m9.4a"><mrow id="S2.p1.9.m9.4.4.2" xref="S2.p1.9.m9.4.4.3.cmml"><mrow id="S2.p1.9.m9.3.3.1.1" xref="S2.p1.9.m9.3.3.1.1.cmml"><mrow id="S2.p1.9.m9.3.3.1.1.1.1" xref="S2.p1.9.m9.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S2.p1.9.m9.3.3.1.1.1.1.2" xref="S2.p1.9.m9.3.3.1.1.1.2.1.cmml">|</mo><msub id="S2.p1.9.m9.3.3.1.1.1.1.1" xref="S2.p1.9.m9.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.9.m9.3.3.1.1.1.1.1.2" xref="S2.p1.9.m9.3.3.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.p1.9.m9.3.3.1.1.1.1.1.3" xref="S2.p1.9.m9.3.3.1.1.1.1.1.3.cmml">T</mi></msub><mo stretchy="false" id="S2.p1.9.m9.3.3.1.1.1.1.3" xref="S2.p1.9.m9.3.3.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.p1.9.m9.3.3.1.1.3" xref="S2.p1.9.m9.3.3.1.1.3.cmml">≪</mo><mrow id="S2.p1.9.m9.3.3.1.1.2.1" xref="S2.p1.9.m9.3.3.1.1.2.2.cmml"><mo stretchy="false" id="S2.p1.9.m9.3.3.1.1.2.1.2" xref="S2.p1.9.m9.3.3.1.1.2.2.1.cmml">|</mo><msub id="S2.p1.9.m9.3.3.1.1.2.1.1" xref="S2.p1.9.m9.3.3.1.1.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.9.m9.3.3.1.1.2.1.1.2" xref="S2.p1.9.m9.3.3.1.1.2.1.1.2.cmml">𝒟</mi><mi id="S2.p1.9.m9.3.3.1.1.2.1.1.3" xref="S2.p1.9.m9.3.3.1.1.2.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.p1.9.m9.3.3.1.1.2.1.3" xref="S2.p1.9.m9.3.3.1.1.2.2.1.cmml">|</mo></mrow></mrow><mo id="S2.p1.9.m9.4.4.2.3" xref="S2.p1.9.m9.4.4.3a.cmml">,</mo><mrow id="S2.p1.9.m9.4.4.2.2" xref="S2.p1.9.m9.4.4.2.2.cmml"><mrow id="S2.p1.9.m9.4.4.2.2.2" xref="S2.p1.9.m9.4.4.2.2.2.cmml"><mo rspace="0.167em" id="S2.p1.9.m9.4.4.2.2.2.1" xref="S2.p1.9.m9.4.4.2.2.2.1.cmml">∀</mo><mi id="S2.p1.9.m9.4.4.2.2.2.2" xref="S2.p1.9.m9.4.4.2.2.2.2.cmml">k</mi></mrow><mo id="S2.p1.9.m9.4.4.2.2.1" xref="S2.p1.9.m9.4.4.2.2.1.cmml">∈</mo><mrow id="S2.p1.9.m9.4.4.2.2.3.2" xref="S2.p1.9.m9.4.4.2.2.3.1.cmml"><mo stretchy="false" id="S2.p1.9.m9.4.4.2.2.3.2.1" xref="S2.p1.9.m9.4.4.2.2.3.1.cmml">[</mo><mn id="S2.p1.9.m9.1.1" xref="S2.p1.9.m9.1.1.cmml">1</mn><mo id="S2.p1.9.m9.4.4.2.2.3.2.2" xref="S2.p1.9.m9.4.4.2.2.3.1.cmml">,</mo><mi id="S2.p1.9.m9.2.2" xref="S2.p1.9.m9.2.2.cmml">S</mi><mo stretchy="false" id="S2.p1.9.m9.4.4.2.2.3.2.3" xref="S2.p1.9.m9.4.4.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.9.m9.4b"><apply id="S2.p1.9.m9.4.4.3.cmml" xref="S2.p1.9.m9.4.4.2"><csymbol cd="ambiguous" id="S2.p1.9.m9.4.4.3a.cmml" xref="S2.p1.9.m9.4.4.2.3">formulae-sequence</csymbol><apply id="S2.p1.9.m9.3.3.1.1.cmml" xref="S2.p1.9.m9.3.3.1.1"><csymbol cd="latexml" id="S2.p1.9.m9.3.3.1.1.3.cmml" xref="S2.p1.9.m9.3.3.1.1.3">much-less-than</csymbol><apply id="S2.p1.9.m9.3.3.1.1.1.2.cmml" xref="S2.p1.9.m9.3.3.1.1.1.1"><abs id="S2.p1.9.m9.3.3.1.1.1.2.1.cmml" xref="S2.p1.9.m9.3.3.1.1.1.1.2"></abs><apply id="S2.p1.9.m9.3.3.1.1.1.1.1.cmml" xref="S2.p1.9.m9.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.9.m9.3.3.1.1.1.1.1.1.cmml" xref="S2.p1.9.m9.3.3.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.9.m9.3.3.1.1.1.1.1.2.cmml" xref="S2.p1.9.m9.3.3.1.1.1.1.1.2">𝒟</ci><ci id="S2.p1.9.m9.3.3.1.1.1.1.1.3.cmml" xref="S2.p1.9.m9.3.3.1.1.1.1.1.3">𝑇</ci></apply></apply><apply id="S2.p1.9.m9.3.3.1.1.2.2.cmml" xref="S2.p1.9.m9.3.3.1.1.2.1"><abs id="S2.p1.9.m9.3.3.1.1.2.2.1.cmml" xref="S2.p1.9.m9.3.3.1.1.2.1.2"></abs><apply id="S2.p1.9.m9.3.3.1.1.2.1.1.cmml" xref="S2.p1.9.m9.3.3.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.p1.9.m9.3.3.1.1.2.1.1.1.cmml" xref="S2.p1.9.m9.3.3.1.1.2.1.1">subscript</csymbol><ci id="S2.p1.9.m9.3.3.1.1.2.1.1.2.cmml" xref="S2.p1.9.m9.3.3.1.1.2.1.1.2">𝒟</ci><ci id="S2.p1.9.m9.3.3.1.1.2.1.1.3.cmml" xref="S2.p1.9.m9.3.3.1.1.2.1.1.3">𝑘</ci></apply></apply></apply><apply id="S2.p1.9.m9.4.4.2.2.cmml" xref="S2.p1.9.m9.4.4.2.2"><in id="S2.p1.9.m9.4.4.2.2.1.cmml" xref="S2.p1.9.m9.4.4.2.2.1"></in><apply id="S2.p1.9.m9.4.4.2.2.2.cmml" xref="S2.p1.9.m9.4.4.2.2.2"><csymbol cd="latexml" id="S2.p1.9.m9.4.4.2.2.2.1.cmml" xref="S2.p1.9.m9.4.4.2.2.2.1">for-all</csymbol><ci id="S2.p1.9.m9.4.4.2.2.2.2.cmml" xref="S2.p1.9.m9.4.4.2.2.2.2">𝑘</ci></apply><interval closure="closed" id="S2.p1.9.m9.4.4.2.2.3.1.cmml" xref="S2.p1.9.m9.4.4.2.2.3.2"><cn type="integer" id="S2.p1.9.m9.1.1.cmml" xref="S2.p1.9.m9.1.1">1</cn><ci id="S2.p1.9.m9.2.2.cmml" xref="S2.p1.9.m9.2.2">𝑆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m9.4c">|\mathcal{D}_{T}|\ll|\mathcal{D}_{k}|,\forall k\in[1,S]</annotation></semantics></math>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.5" class="ltx_p">In a setting with multiple source domains, optimizing a DNN’s parameters <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\theta</annotation></semantics></math> is commonly done with <span title="" class="ltx_glossaryref">Empirical Risk Minimization (ERM)</span>, by minimizing a cost <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="R_{K}" display="inline"><semantics id="S2.p2.2.m2.1a"><msub id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">R</mi><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">𝑅</ci><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">R_{K}</annotation></semantics></math> for each domain <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S2.p2.3.m3.1a"><msub id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">𝒟</mi><mi id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">𝒟</ci><ci id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">\mathcal{D}_{k}</annotation></semantics></math>, which is the expectation of a loss <math id="S2.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S2.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><ci id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">\mathcal{L}</annotation></semantics></math> over <math id="S2.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S2.p2.5.m5.1a"><msub id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">𝒟</mi><mi id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">𝒟</ci><ci id="S2.p2.5.m5.1.1.3.cmml" xref="S2.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">\mathcal{D}_{k}</annotation></semantics></math>:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.8" class="ltx_Math" alttext="\min_{\theta}R_{ERM}(\theta)\coloneqq\frac{1}{S}\sum_{k=1}^{S}R_{k}(\theta)=\frac{1}{S}\sum_{k=1}^{S}\mathbb{E}_{(x,y)\sim\mathcal{D}_{k}}[\mathcal{L}(\theta;x,y)]." display="block"><semantics id="S2.E1.m1.8a"><mrow id="S2.E1.m1.8.8.1" xref="S2.E1.m1.8.8.1.1.cmml"><mrow id="S2.E1.m1.8.8.1.1" xref="S2.E1.m1.8.8.1.1.cmml"><mrow id="S2.E1.m1.8.8.1.1.3" xref="S2.E1.m1.8.8.1.1.3.cmml"><mrow id="S2.E1.m1.8.8.1.1.3.2" xref="S2.E1.m1.8.8.1.1.3.2.cmml"><munder id="S2.E1.m1.8.8.1.1.3.2.1" xref="S2.E1.m1.8.8.1.1.3.2.1.cmml"><mi id="S2.E1.m1.8.8.1.1.3.2.1.2" xref="S2.E1.m1.8.8.1.1.3.2.1.2.cmml">min</mi><mi id="S2.E1.m1.8.8.1.1.3.2.1.3" xref="S2.E1.m1.8.8.1.1.3.2.1.3.cmml">θ</mi></munder><mo lspace="0.167em" id="S2.E1.m1.8.8.1.1.3.2a" xref="S2.E1.m1.8.8.1.1.3.2.cmml">⁡</mo><msub id="S2.E1.m1.8.8.1.1.3.2.2" xref="S2.E1.m1.8.8.1.1.3.2.2.cmml"><mi id="S2.E1.m1.8.8.1.1.3.2.2.2" xref="S2.E1.m1.8.8.1.1.3.2.2.2.cmml">R</mi><mrow id="S2.E1.m1.8.8.1.1.3.2.2.3" xref="S2.E1.m1.8.8.1.1.3.2.2.3.cmml"><mi id="S2.E1.m1.8.8.1.1.3.2.2.3.2" xref="S2.E1.m1.8.8.1.1.3.2.2.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.1.1.3.2.2.3.1" xref="S2.E1.m1.8.8.1.1.3.2.2.3.1.cmml">​</mo><mi id="S2.E1.m1.8.8.1.1.3.2.2.3.3" xref="S2.E1.m1.8.8.1.1.3.2.2.3.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.1.1.3.2.2.3.1a" xref="S2.E1.m1.8.8.1.1.3.2.2.3.1.cmml">​</mo><mi id="S2.E1.m1.8.8.1.1.3.2.2.3.4" xref="S2.E1.m1.8.8.1.1.3.2.2.3.4.cmml">M</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.1.1.3.1" xref="S2.E1.m1.8.8.1.1.3.1.cmml">​</mo><mrow id="S2.E1.m1.8.8.1.1.3.3.2" xref="S2.E1.m1.8.8.1.1.3.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.1.1.3.3.2.1" xref="S2.E1.m1.8.8.1.1.3.cmml">(</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S2.E1.m1.8.8.1.1.3.3.2.2" xref="S2.E1.m1.8.8.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.8.8.1.1.4" xref="S2.E1.m1.8.8.1.1.4.cmml">≔</mo><mrow id="S2.E1.m1.8.8.1.1.5" xref="S2.E1.m1.8.8.1.1.5.cmml"><mfrac id="S2.E1.m1.8.8.1.1.5.2" xref="S2.E1.m1.8.8.1.1.5.2.cmml"><mn id="S2.E1.m1.8.8.1.1.5.2.2" xref="S2.E1.m1.8.8.1.1.5.2.2.cmml">1</mn><mi id="S2.E1.m1.8.8.1.1.5.2.3" xref="S2.E1.m1.8.8.1.1.5.2.3.cmml">S</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.1.1.5.1" xref="S2.E1.m1.8.8.1.1.5.1.cmml">​</mo><mrow id="S2.E1.m1.8.8.1.1.5.3" xref="S2.E1.m1.8.8.1.1.5.3.cmml"><munderover id="S2.E1.m1.8.8.1.1.5.3.1" xref="S2.E1.m1.8.8.1.1.5.3.1.cmml"><mo movablelimits="false" id="S2.E1.m1.8.8.1.1.5.3.1.2.2" xref="S2.E1.m1.8.8.1.1.5.3.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.8.8.1.1.5.3.1.2.3" xref="S2.E1.m1.8.8.1.1.5.3.1.2.3.cmml"><mi id="S2.E1.m1.8.8.1.1.5.3.1.2.3.2" xref="S2.E1.m1.8.8.1.1.5.3.1.2.3.2.cmml">k</mi><mo id="S2.E1.m1.8.8.1.1.5.3.1.2.3.1" xref="S2.E1.m1.8.8.1.1.5.3.1.2.3.1.cmml">=</mo><mn id="S2.E1.m1.8.8.1.1.5.3.1.2.3.3" xref="S2.E1.m1.8.8.1.1.5.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.8.8.1.1.5.3.1.3" xref="S2.E1.m1.8.8.1.1.5.3.1.3.cmml">S</mi></munderover><mrow id="S2.E1.m1.8.8.1.1.5.3.2" xref="S2.E1.m1.8.8.1.1.5.3.2.cmml"><msub id="S2.E1.m1.8.8.1.1.5.3.2.2" xref="S2.E1.m1.8.8.1.1.5.3.2.2.cmml"><mi id="S2.E1.m1.8.8.1.1.5.3.2.2.2" xref="S2.E1.m1.8.8.1.1.5.3.2.2.2.cmml">R</mi><mi id="S2.E1.m1.8.8.1.1.5.3.2.2.3" xref="S2.E1.m1.8.8.1.1.5.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.1.1.5.3.2.1" xref="S2.E1.m1.8.8.1.1.5.3.2.1.cmml">​</mo><mrow id="S2.E1.m1.8.8.1.1.5.3.2.3.2" xref="S2.E1.m1.8.8.1.1.5.3.2.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.1.1.5.3.2.3.2.1" xref="S2.E1.m1.8.8.1.1.5.3.2.cmml">(</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">θ</mi><mo stretchy="false" id="S2.E1.m1.8.8.1.1.5.3.2.3.2.2" xref="S2.E1.m1.8.8.1.1.5.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.8.8.1.1.6" xref="S2.E1.m1.8.8.1.1.6.cmml">=</mo><mrow id="S2.E1.m1.8.8.1.1.1" xref="S2.E1.m1.8.8.1.1.1.cmml"><mfrac id="S2.E1.m1.8.8.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.3.cmml"><mn id="S2.E1.m1.8.8.1.1.1.3.2" xref="S2.E1.m1.8.8.1.1.1.3.2.cmml">1</mn><mi id="S2.E1.m1.8.8.1.1.1.3.3" xref="S2.E1.m1.8.8.1.1.1.3.3.cmml">S</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.8.8.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.cmml"><munderover id="S2.E1.m1.8.8.1.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E1.m1.8.8.1.1.1.1.2.2.2" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.8.8.1.1.1.1.2.2.3" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.cmml"><mi id="S2.E1.m1.8.8.1.1.1.1.2.2.3.2" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S2.E1.m1.8.8.1.1.1.1.2.2.3.1" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.8.8.1.1.1.1.2.3" xref="S2.E1.m1.8.8.1.1.1.1.2.3.cmml">S</mi></munderover><mrow id="S2.E1.m1.8.8.1.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.1.cmml"><msub id="S2.E1.m1.8.8.1.1.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.8.8.1.1.1.1.1.3.2" xref="S2.E1.m1.8.8.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><mrow id="S2.E1.m1.2.2.2.4.2" xref="S2.E1.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.2.4.2.1" xref="S2.E1.m1.2.2.2.4.1.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">x</mi><mo id="S2.E1.m1.2.2.2.4.2.2" xref="S2.E1.m1.2.2.2.4.1.cmml">,</mo><mi id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S2.E1.m1.2.2.2.4.2.3" xref="S2.E1.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml">∼</mo><msub id="S2.E1.m1.2.2.2.5" xref="S2.E1.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.2.5.2" xref="S2.E1.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S2.E1.m1.2.2.2.5.3" xref="S2.E1.m1.2.2.2.5.3.cmml">k</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.1.1.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.8.8.1.1.1.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.2.1" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">θ</mi><mo id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml">;</mo><mi id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml">x</mi><mo id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S2.E1.m1.7.7" xref="S2.E1.m1.7.7.cmml">y</mi><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.2.4" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E1.m1.8.8.1.2" xref="S2.E1.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.8b"><apply id="S2.E1.m1.8.8.1.1.cmml" xref="S2.E1.m1.8.8.1"><and id="S2.E1.m1.8.8.1.1a.cmml" xref="S2.E1.m1.8.8.1"></and><apply id="S2.E1.m1.8.8.1.1b.cmml" xref="S2.E1.m1.8.8.1"><ci id="S2.E1.m1.8.8.1.1.4.cmml" xref="S2.E1.m1.8.8.1.1.4">≔</ci><apply id="S2.E1.m1.8.8.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.3"><times id="S2.E1.m1.8.8.1.1.3.1.cmml" xref="S2.E1.m1.8.8.1.1.3.1"></times><apply id="S2.E1.m1.8.8.1.1.3.2.cmml" xref="S2.E1.m1.8.8.1.1.3.2"><apply id="S2.E1.m1.8.8.1.1.3.2.1.cmml" xref="S2.E1.m1.8.8.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.3.2.1.1.cmml" xref="S2.E1.m1.8.8.1.1.3.2.1">subscript</csymbol><min id="S2.E1.m1.8.8.1.1.3.2.1.2.cmml" xref="S2.E1.m1.8.8.1.1.3.2.1.2"></min><ci id="S2.E1.m1.8.8.1.1.3.2.1.3.cmml" xref="S2.E1.m1.8.8.1.1.3.2.1.3">𝜃</ci></apply><apply id="S2.E1.m1.8.8.1.1.3.2.2.cmml" xref="S2.E1.m1.8.8.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.3.2.2.1.cmml" xref="S2.E1.m1.8.8.1.1.3.2.2">subscript</csymbol><ci id="S2.E1.m1.8.8.1.1.3.2.2.2.cmml" xref="S2.E1.m1.8.8.1.1.3.2.2.2">𝑅</ci><apply id="S2.E1.m1.8.8.1.1.3.2.2.3.cmml" xref="S2.E1.m1.8.8.1.1.3.2.2.3"><times id="S2.E1.m1.8.8.1.1.3.2.2.3.1.cmml" xref="S2.E1.m1.8.8.1.1.3.2.2.3.1"></times><ci id="S2.E1.m1.8.8.1.1.3.2.2.3.2.cmml" xref="S2.E1.m1.8.8.1.1.3.2.2.3.2">𝐸</ci><ci id="S2.E1.m1.8.8.1.1.3.2.2.3.3.cmml" xref="S2.E1.m1.8.8.1.1.3.2.2.3.3">𝑅</ci><ci id="S2.E1.m1.8.8.1.1.3.2.2.3.4.cmml" xref="S2.E1.m1.8.8.1.1.3.2.2.3.4">𝑀</ci></apply></apply></apply><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝜃</ci></apply><apply id="S2.E1.m1.8.8.1.1.5.cmml" xref="S2.E1.m1.8.8.1.1.5"><times id="S2.E1.m1.8.8.1.1.5.1.cmml" xref="S2.E1.m1.8.8.1.1.5.1"></times><apply id="S2.E1.m1.8.8.1.1.5.2.cmml" xref="S2.E1.m1.8.8.1.1.5.2"><divide id="S2.E1.m1.8.8.1.1.5.2.1.cmml" xref="S2.E1.m1.8.8.1.1.5.2"></divide><cn type="integer" id="S2.E1.m1.8.8.1.1.5.2.2.cmml" xref="S2.E1.m1.8.8.1.1.5.2.2">1</cn><ci id="S2.E1.m1.8.8.1.1.5.2.3.cmml" xref="S2.E1.m1.8.8.1.1.5.2.3">𝑆</ci></apply><apply id="S2.E1.m1.8.8.1.1.5.3.cmml" xref="S2.E1.m1.8.8.1.1.5.3"><apply id="S2.E1.m1.8.8.1.1.5.3.1.cmml" xref="S2.E1.m1.8.8.1.1.5.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.5.3.1.1.cmml" xref="S2.E1.m1.8.8.1.1.5.3.1">superscript</csymbol><apply id="S2.E1.m1.8.8.1.1.5.3.1.2.cmml" xref="S2.E1.m1.8.8.1.1.5.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.5.3.1.2.1.cmml" xref="S2.E1.m1.8.8.1.1.5.3.1">subscript</csymbol><sum id="S2.E1.m1.8.8.1.1.5.3.1.2.2.cmml" xref="S2.E1.m1.8.8.1.1.5.3.1.2.2"></sum><apply id="S2.E1.m1.8.8.1.1.5.3.1.2.3.cmml" xref="S2.E1.m1.8.8.1.1.5.3.1.2.3"><eq id="S2.E1.m1.8.8.1.1.5.3.1.2.3.1.cmml" xref="S2.E1.m1.8.8.1.1.5.3.1.2.3.1"></eq><ci id="S2.E1.m1.8.8.1.1.5.3.1.2.3.2.cmml" xref="S2.E1.m1.8.8.1.1.5.3.1.2.3.2">𝑘</ci><cn type="integer" id="S2.E1.m1.8.8.1.1.5.3.1.2.3.3.cmml" xref="S2.E1.m1.8.8.1.1.5.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.8.8.1.1.5.3.1.3.cmml" xref="S2.E1.m1.8.8.1.1.5.3.1.3">𝑆</ci></apply><apply id="S2.E1.m1.8.8.1.1.5.3.2.cmml" xref="S2.E1.m1.8.8.1.1.5.3.2"><times id="S2.E1.m1.8.8.1.1.5.3.2.1.cmml" xref="S2.E1.m1.8.8.1.1.5.3.2.1"></times><apply id="S2.E1.m1.8.8.1.1.5.3.2.2.cmml" xref="S2.E1.m1.8.8.1.1.5.3.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.5.3.2.2.1.cmml" xref="S2.E1.m1.8.8.1.1.5.3.2.2">subscript</csymbol><ci id="S2.E1.m1.8.8.1.1.5.3.2.2.2.cmml" xref="S2.E1.m1.8.8.1.1.5.3.2.2.2">𝑅</ci><ci id="S2.E1.m1.8.8.1.1.5.3.2.2.3.cmml" xref="S2.E1.m1.8.8.1.1.5.3.2.2.3">𝑘</ci></apply><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝜃</ci></apply></apply></apply></apply><apply id="S2.E1.m1.8.8.1.1c.cmml" xref="S2.E1.m1.8.8.1"><eq id="S2.E1.m1.8.8.1.1.6.cmml" xref="S2.E1.m1.8.8.1.1.6"></eq><share href="#S2.E1.m1.8.8.1.1.5.cmml" id="S2.E1.m1.8.8.1.1d.cmml" xref="S2.E1.m1.8.8.1"></share><apply id="S2.E1.m1.8.8.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1"><times id="S2.E1.m1.8.8.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.2"></times><apply id="S2.E1.m1.8.8.1.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.1.3"><divide id="S2.E1.m1.8.8.1.1.1.3.1.cmml" xref="S2.E1.m1.8.8.1.1.1.3"></divide><cn type="integer" id="S2.E1.m1.8.8.1.1.1.3.2.cmml" xref="S2.E1.m1.8.8.1.1.1.3.2">1</cn><ci id="S2.E1.m1.8.8.1.1.1.3.3.cmml" xref="S2.E1.m1.8.8.1.1.1.3.3">𝑆</ci></apply><apply id="S2.E1.m1.8.8.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1"><apply id="S2.E1.m1.8.8.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.2.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2">superscript</csymbol><apply id="S2.E1.m1.8.8.1.1.1.1.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.8.8.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2"></sum><apply id="S2.E1.m1.8.8.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3"><eq id="S2.E1.m1.8.8.1.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.1"></eq><ci id="S2.E1.m1.8.8.1.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.8.8.1.1.1.1.2.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.3">𝑆</ci></apply><apply id="S2.E1.m1.8.8.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1"><times id="S2.E1.m1.8.8.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.2"></times><apply id="S2.E1.m1.8.8.1.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.8.8.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.3.2">𝔼</ci><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><csymbol cd="latexml" id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S2.E1.m1.2.2.2.4.1.cmml" xref="S2.E1.m1.2.2.2.4.2"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑥</ci><ci id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2">𝑦</ci></interval><apply id="S2.E1.m1.2.2.2.5.cmml" xref="S2.E1.m1.2.2.2.5"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.5.1.cmml" xref="S2.E1.m1.2.2.2.5">subscript</csymbol><ci id="S2.E1.m1.2.2.2.5.2.cmml" xref="S2.E1.m1.2.2.2.5.2">𝒟</ci><ci id="S2.E1.m1.2.2.2.5.3.cmml" xref="S2.E1.m1.2.2.2.5.3">𝑘</ci></apply></apply></apply><apply id="S2.E1.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1"></times><ci id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2">ℒ</ci><list id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.2"><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝜃</ci><ci id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6">𝑥</ci><ci id="S2.E1.m1.7.7.cmml" xref="S2.E1.m1.7.7">𝑦</ci></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.8c">\min_{\theta}R_{ERM}(\theta)\coloneqq\frac{1}{S}\sum_{k=1}^{S}R_{k}(\theta)=\frac{1}{S}\sum_{k=1}^{S}\mathbb{E}_{(x,y)\sim\mathcal{D}_{k}}[\mathcal{L}(\theta;x,y)].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p2.12" class="ltx_p">This can be performed via centralised training (e.g. <span title="" class="ltx_glossaryref">DG</span> methods) or approximated via FL when <math id="S2.p2.6.m1.3" class="ltx_Math" alttext="\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}" display="inline"><semantics id="S2.p2.6.m1.3a"><mrow id="S2.p2.6.m1.3.3.2" xref="S2.p2.6.m1.3.3.3.cmml"><mo stretchy="false" id="S2.p2.6.m1.3.3.2.3" xref="S2.p2.6.m1.3.3.3.cmml">{</mo><msub id="S2.p2.6.m1.2.2.1.1" xref="S2.p2.6.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.6.m1.2.2.1.1.2" xref="S2.p2.6.m1.2.2.1.1.2.cmml">𝒟</mi><mn id="S2.p2.6.m1.2.2.1.1.3" xref="S2.p2.6.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.p2.6.m1.3.3.2.4" xref="S2.p2.6.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.p2.6.m1.1.1" xref="S2.p2.6.m1.1.1.cmml">…</mi><mo id="S2.p2.6.m1.3.3.2.5" xref="S2.p2.6.m1.3.3.3.cmml">,</mo><msub id="S2.p2.6.m1.3.3.2.2" xref="S2.p2.6.m1.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.6.m1.3.3.2.2.2" xref="S2.p2.6.m1.3.3.2.2.2.cmml">𝒟</mi><mi id="S2.p2.6.m1.3.3.2.2.3" xref="S2.p2.6.m1.3.3.2.2.3.cmml">S</mi></msub><mo stretchy="false" id="S2.p2.6.m1.3.3.2.6" xref="S2.p2.6.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m1.3b"><set id="S2.p2.6.m1.3.3.3.cmml" xref="S2.p2.6.m1.3.3.2"><apply id="S2.p2.6.m1.2.2.1.1.cmml" xref="S2.p2.6.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.p2.6.m1.2.2.1.1.1.cmml" xref="S2.p2.6.m1.2.2.1.1">subscript</csymbol><ci id="S2.p2.6.m1.2.2.1.1.2.cmml" xref="S2.p2.6.m1.2.2.1.1.2">𝒟</ci><cn type="integer" id="S2.p2.6.m1.2.2.1.1.3.cmml" xref="S2.p2.6.m1.2.2.1.1.3">1</cn></apply><ci id="S2.p2.6.m1.1.1.cmml" xref="S2.p2.6.m1.1.1">…</ci><apply id="S2.p2.6.m1.3.3.2.2.cmml" xref="S2.p2.6.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.p2.6.m1.3.3.2.2.1.cmml" xref="S2.p2.6.m1.3.3.2.2">subscript</csymbol><ci id="S2.p2.6.m1.3.3.2.2.2.cmml" xref="S2.p2.6.m1.3.3.2.2.2">𝒟</ci><ci id="S2.p2.6.m1.3.3.2.2.3.cmml" xref="S2.p2.6.m1.3.3.2.2.3">𝑆</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m1.3c">\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}</annotation></semantics></math> are distributed and without data sharing. In our experiments we focus on the latter challenging case. We assume model <math id="S2.p2.7.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.p2.7.m2.1a"><mi id="S2.p2.7.m2.1.1" xref="S2.p2.7.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.p2.7.m2.1b"><ci id="S2.p2.7.m2.1.1.cmml" xref="S2.p2.7.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m2.1c">\theta</annotation></semantics></math> is pre-trained and ‘deployed’ to a target domain where limited labelled <math id="S2.p2.8.m3.1" class="ltx_Math" alttext="D_{T}" display="inline"><semantics id="S2.p2.8.m3.1a"><msub id="S2.p2.8.m3.1.1" xref="S2.p2.8.m3.1.1.cmml"><mi id="S2.p2.8.m3.1.1.2" xref="S2.p2.8.m3.1.1.2.cmml">D</mi><mi id="S2.p2.8.m3.1.1.3" xref="S2.p2.8.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.8.m3.1b"><apply id="S2.p2.8.m3.1.1.cmml" xref="S2.p2.8.m3.1.1"><csymbol cd="ambiguous" id="S2.p2.8.m3.1.1.1.cmml" xref="S2.p2.8.m3.1.1">subscript</csymbol><ci id="S2.p2.8.m3.1.1.2.cmml" xref="S2.p2.8.m3.1.1.2">𝐷</ci><ci id="S2.p2.8.m3.1.1.3.cmml" xref="S2.p2.8.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m3.1c">D_{T}</annotation></semantics></math> is available.
Due to domain shift <math id="S2.p2.9.m4.4" class="ltx_Math" alttext="p_{T}\neq p_{k},\forall k\in[1,S]" display="inline"><semantics id="S2.p2.9.m4.4a"><mrow id="S2.p2.9.m4.4.4.2" xref="S2.p2.9.m4.4.4.3.cmml"><mrow id="S2.p2.9.m4.3.3.1.1" xref="S2.p2.9.m4.3.3.1.1.cmml"><msub id="S2.p2.9.m4.3.3.1.1.2" xref="S2.p2.9.m4.3.3.1.1.2.cmml"><mi id="S2.p2.9.m4.3.3.1.1.2.2" xref="S2.p2.9.m4.3.3.1.1.2.2.cmml">p</mi><mi id="S2.p2.9.m4.3.3.1.1.2.3" xref="S2.p2.9.m4.3.3.1.1.2.3.cmml">T</mi></msub><mo id="S2.p2.9.m4.3.3.1.1.1" xref="S2.p2.9.m4.3.3.1.1.1.cmml">≠</mo><msub id="S2.p2.9.m4.3.3.1.1.3" xref="S2.p2.9.m4.3.3.1.1.3.cmml"><mi id="S2.p2.9.m4.3.3.1.1.3.2" xref="S2.p2.9.m4.3.3.1.1.3.2.cmml">p</mi><mi id="S2.p2.9.m4.3.3.1.1.3.3" xref="S2.p2.9.m4.3.3.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S2.p2.9.m4.4.4.2.3" xref="S2.p2.9.m4.4.4.3a.cmml">,</mo><mrow id="S2.p2.9.m4.4.4.2.2" xref="S2.p2.9.m4.4.4.2.2.cmml"><mrow id="S2.p2.9.m4.4.4.2.2.2" xref="S2.p2.9.m4.4.4.2.2.2.cmml"><mo rspace="0.167em" id="S2.p2.9.m4.4.4.2.2.2.1" xref="S2.p2.9.m4.4.4.2.2.2.1.cmml">∀</mo><mi id="S2.p2.9.m4.4.4.2.2.2.2" xref="S2.p2.9.m4.4.4.2.2.2.2.cmml">k</mi></mrow><mo id="S2.p2.9.m4.4.4.2.2.1" xref="S2.p2.9.m4.4.4.2.2.1.cmml">∈</mo><mrow id="S2.p2.9.m4.4.4.2.2.3.2" xref="S2.p2.9.m4.4.4.2.2.3.1.cmml"><mo stretchy="false" id="S2.p2.9.m4.4.4.2.2.3.2.1" xref="S2.p2.9.m4.4.4.2.2.3.1.cmml">[</mo><mn id="S2.p2.9.m4.1.1" xref="S2.p2.9.m4.1.1.cmml">1</mn><mo id="S2.p2.9.m4.4.4.2.2.3.2.2" xref="S2.p2.9.m4.4.4.2.2.3.1.cmml">,</mo><mi id="S2.p2.9.m4.2.2" xref="S2.p2.9.m4.2.2.cmml">S</mi><mo stretchy="false" id="S2.p2.9.m4.4.4.2.2.3.2.3" xref="S2.p2.9.m4.4.4.2.2.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.9.m4.4b"><apply id="S2.p2.9.m4.4.4.3.cmml" xref="S2.p2.9.m4.4.4.2"><csymbol cd="ambiguous" id="S2.p2.9.m4.4.4.3a.cmml" xref="S2.p2.9.m4.4.4.2.3">formulae-sequence</csymbol><apply id="S2.p2.9.m4.3.3.1.1.cmml" xref="S2.p2.9.m4.3.3.1.1"><neq id="S2.p2.9.m4.3.3.1.1.1.cmml" xref="S2.p2.9.m4.3.3.1.1.1"></neq><apply id="S2.p2.9.m4.3.3.1.1.2.cmml" xref="S2.p2.9.m4.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.p2.9.m4.3.3.1.1.2.1.cmml" xref="S2.p2.9.m4.3.3.1.1.2">subscript</csymbol><ci id="S2.p2.9.m4.3.3.1.1.2.2.cmml" xref="S2.p2.9.m4.3.3.1.1.2.2">𝑝</ci><ci id="S2.p2.9.m4.3.3.1.1.2.3.cmml" xref="S2.p2.9.m4.3.3.1.1.2.3">𝑇</ci></apply><apply id="S2.p2.9.m4.3.3.1.1.3.cmml" xref="S2.p2.9.m4.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.p2.9.m4.3.3.1.1.3.1.cmml" xref="S2.p2.9.m4.3.3.1.1.3">subscript</csymbol><ci id="S2.p2.9.m4.3.3.1.1.3.2.cmml" xref="S2.p2.9.m4.3.3.1.1.3.2">𝑝</ci><ci id="S2.p2.9.m4.3.3.1.1.3.3.cmml" xref="S2.p2.9.m4.3.3.1.1.3.3">𝑘</ci></apply></apply><apply id="S2.p2.9.m4.4.4.2.2.cmml" xref="S2.p2.9.m4.4.4.2.2"><in id="S2.p2.9.m4.4.4.2.2.1.cmml" xref="S2.p2.9.m4.4.4.2.2.1"></in><apply id="S2.p2.9.m4.4.4.2.2.2.cmml" xref="S2.p2.9.m4.4.4.2.2.2"><csymbol cd="latexml" id="S2.p2.9.m4.4.4.2.2.2.1.cmml" xref="S2.p2.9.m4.4.4.2.2.2.1">for-all</csymbol><ci id="S2.p2.9.m4.4.4.2.2.2.2.cmml" xref="S2.p2.9.m4.4.4.2.2.2.2">𝑘</ci></apply><interval closure="closed" id="S2.p2.9.m4.4.4.2.2.3.1.cmml" xref="S2.p2.9.m4.4.4.2.2.3.2"><cn type="integer" id="S2.p2.9.m4.1.1.cmml" xref="S2.p2.9.m4.1.1">1</cn><ci id="S2.p2.9.m4.2.2.cmml" xref="S2.p2.9.m4.2.2">𝑆</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m4.4c">p_{T}\neq p_{k},\forall k\in[1,S]</annotation></semantics></math>, we assume <math id="S2.p2.10.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.p2.10.m5.1a"><mi id="S2.p2.10.m5.1.1" xref="S2.p2.10.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.p2.10.m5.1b"><ci id="S2.p2.10.m5.1.1.cmml" xref="S2.p2.10.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m5.1c">\theta</annotation></semantics></math> may not generalize to the target domain. Next, we describe our algorithm for adapting <math id="S2.p2.11.m6.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.p2.11.m6.1a"><mi id="S2.p2.11.m6.1.1" xref="S2.p2.11.m6.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.p2.11.m6.1b"><ci id="S2.p2.11.m6.1.1.cmml" xref="S2.p2.11.m6.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m6.1c">\theta</annotation></semantics></math> to <math id="S2.p2.12.m7.1" class="ltx_Math" alttext="p_{T}" display="inline"><semantics id="S2.p2.12.m7.1a"><msub id="S2.p2.12.m7.1.1" xref="S2.p2.12.m7.1.1.cmml"><mi id="S2.p2.12.m7.1.1.2" xref="S2.p2.12.m7.1.1.2.cmml">p</mi><mi id="S2.p2.12.m7.1.1.3" xref="S2.p2.12.m7.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.12.m7.1b"><apply id="S2.p2.12.m7.1.1.cmml" xref="S2.p2.12.m7.1.1"><csymbol cd="ambiguous" id="S2.p2.12.m7.1.1.1.cmml" xref="S2.p2.12.m7.1.1">subscript</csymbol><ci id="S2.p2.12.m7.1.1.2.cmml" xref="S2.p2.12.m7.1.1.2">𝑝</ci><ci id="S2.p2.12.m7.1.1.3.cmml" xref="S2.p2.12.m7.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m7.1c">p_{T}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Using only limited labelled target data <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{T}" display="inline"><semantics id="S3.p1.1.m1.1a"><msub id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">𝒟</mi><mi id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝒟</ci><ci id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathcal{D}_{T}</annotation></semantics></math> for PDA is likely to give unreliable results. Therefore, our FedPDA framework, enables a deployed model to obtain information from source data using remote gradient exchange via FL (Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). To achieve this, our <span id="S3.p1.1.1" class="ltx_text ltx_font_typewriter">StarAlign</span> algorithm for FedPDA aligns gradients of all domains with target domain gradients by maximising their inner product.
This ensures that source-derived gradients promote learning features that are relevant to the target domain.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Theoretical Derivation of Source-Target Alignment</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.8" class="ltx_p">First, we derive our algorithm in the <em id="S3.SS1.p1.8.1" class="ltx_emph ltx_font_italic">theoretical</em> setting where source and target data <math id="S3.SS1.p1.1.m1.4" class="ltx_Math" alttext="\{\mathcal{D}_{1},\dots,\mathcal{D}_{S},\mathcal{D}_{T}\}" display="inline"><semantics id="S3.SS1.p1.1.m1.4a"><mrow id="S3.SS1.p1.1.m1.4.4.3" xref="S3.SS1.p1.1.m1.4.4.4.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.4.4.3.4" xref="S3.SS1.p1.1.m1.4.4.4.cmml">{</mo><msub id="S3.SS1.p1.1.m1.2.2.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.2.2.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.2.cmml">𝒟</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.4.4.3.5" xref="S3.SS1.p1.1.m1.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p1.1.m1.4.4.3.6" xref="S3.SS1.p1.1.m1.4.4.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.3.3.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml">𝒟</mi><mi id="S3.SS1.p1.1.m1.3.3.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.3.cmml">S</mi></msub><mo id="S3.SS1.p1.1.m1.4.4.3.7" xref="S3.SS1.p1.1.m1.4.4.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.4.4.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.4.4.3.3.2" xref="S3.SS1.p1.1.m1.4.4.3.3.2.cmml">𝒟</mi><mi id="S3.SS1.p1.1.m1.4.4.3.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.cmml">T</mi></msub><mo stretchy="false" id="S3.SS1.p1.1.m1.4.4.3.8" xref="S3.SS1.p1.1.m1.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.4b"><set id="S3.SS1.p1.1.m1.4.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4.3"><apply id="S3.SS1.p1.1.m1.2.2.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.2">𝒟</ci><cn type="integer" id="S3.SS1.p1.1.m1.2.2.1.1.3.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">…</ci><apply id="S3.SS1.p1.1.m1.3.3.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">𝒟</ci><ci id="S3.SS1.p1.1.m1.3.3.2.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.3">𝑆</ci></apply><apply id="S3.SS1.p1.1.m1.4.4.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.3.3.1.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.3.3.2.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.2">𝒟</ci><ci id="S3.SS1.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3">𝑇</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.4c">\{\mathcal{D}_{1},\dots,\mathcal{D}_{S},\mathcal{D}_{T}\}</annotation></semantics></math> are available for centralised training. The subsequent section presents our <em id="S3.SS1.p1.8.2" class="ltx_emph ltx_font_italic">distributed algorithm</em> for remote domains, developed to approximate the optimization (Eq. <a href="#S3.E2" title="In 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) in the theoretical setting.
We form pairs between each domain and target <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{T}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝒟</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{D}_{T}</annotation></semantics></math> to extract target-relevant information from each source domain. For the <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">k</annotation></semantics></math>-th pair we minimise the combined cost <math id="S3.SS1.p1.4.m4.3" class="ltx_Math" alttext="R_{kT}(\theta)\!=\!R_{k}(\theta)\!+\!R_{T}(\theta)" display="inline"><semantics id="S3.SS1.p1.4.m4.3a"><mrow id="S3.SS1.p1.4.m4.3.4" xref="S3.SS1.p1.4.m4.3.4.cmml"><mrow id="S3.SS1.p1.4.m4.3.4.2" xref="S3.SS1.p1.4.m4.3.4.2.cmml"><msub id="S3.SS1.p1.4.m4.3.4.2.2" xref="S3.SS1.p1.4.m4.3.4.2.2.cmml"><mi id="S3.SS1.p1.4.m4.3.4.2.2.2" xref="S3.SS1.p1.4.m4.3.4.2.2.2.cmml">R</mi><mrow id="S3.SS1.p1.4.m4.3.4.2.2.3" xref="S3.SS1.p1.4.m4.3.4.2.2.3.cmml"><mi id="S3.SS1.p1.4.m4.3.4.2.2.3.2" xref="S3.SS1.p1.4.m4.3.4.2.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.3.4.2.2.3.1" xref="S3.SS1.p1.4.m4.3.4.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p1.4.m4.3.4.2.2.3.3" xref="S3.SS1.p1.4.m4.3.4.2.2.3.3.cmml">T</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.3.4.2.1" xref="S3.SS1.p1.4.m4.3.4.2.1.cmml">​</mo><mrow id="S3.SS1.p1.4.m4.3.4.2.3.2" xref="S3.SS1.p1.4.m4.3.4.2.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.3.4.2.3.2.1" xref="S3.SS1.p1.4.m4.3.4.2.cmml">(</mo><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS1.p1.4.m4.3.4.2.3.2.2" xref="S3.SS1.p1.4.m4.3.4.2.cmml">)</mo></mrow></mrow><mo lspace="0.108em" rspace="0.108em" id="S3.SS1.p1.4.m4.3.4.1" xref="S3.SS1.p1.4.m4.3.4.1.cmml">=</mo><mrow id="S3.SS1.p1.4.m4.3.4.3" xref="S3.SS1.p1.4.m4.3.4.3.cmml"><mrow id="S3.SS1.p1.4.m4.3.4.3.2" xref="S3.SS1.p1.4.m4.3.4.3.2.cmml"><msub id="S3.SS1.p1.4.m4.3.4.3.2.2" xref="S3.SS1.p1.4.m4.3.4.3.2.2.cmml"><mi id="S3.SS1.p1.4.m4.3.4.3.2.2.2" xref="S3.SS1.p1.4.m4.3.4.3.2.2.2.cmml">R</mi><mi id="S3.SS1.p1.4.m4.3.4.3.2.2.3" xref="S3.SS1.p1.4.m4.3.4.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.3.4.3.2.1" xref="S3.SS1.p1.4.m4.3.4.3.2.1.cmml">​</mo><mrow id="S3.SS1.p1.4.m4.3.4.3.2.3.2" xref="S3.SS1.p1.4.m4.3.4.3.2.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.3.4.3.2.3.2.1" xref="S3.SS1.p1.4.m4.3.4.3.2.cmml">(</mo><mi id="S3.SS1.p1.4.m4.2.2" xref="S3.SS1.p1.4.m4.2.2.cmml">θ</mi><mo stretchy="false" id="S3.SS1.p1.4.m4.3.4.3.2.3.2.2" xref="S3.SS1.p1.4.m4.3.4.3.2.cmml">)</mo></mrow></mrow><mo lspace="0.052em" rspace="0.052em" id="S3.SS1.p1.4.m4.3.4.3.1" xref="S3.SS1.p1.4.m4.3.4.3.1.cmml">+</mo><mrow id="S3.SS1.p1.4.m4.3.4.3.3" xref="S3.SS1.p1.4.m4.3.4.3.3.cmml"><msub id="S3.SS1.p1.4.m4.3.4.3.3.2" xref="S3.SS1.p1.4.m4.3.4.3.3.2.cmml"><mi id="S3.SS1.p1.4.m4.3.4.3.3.2.2" xref="S3.SS1.p1.4.m4.3.4.3.3.2.2.cmml">R</mi><mi id="S3.SS1.p1.4.m4.3.4.3.3.2.3" xref="S3.SS1.p1.4.m4.3.4.3.3.2.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.4.m4.3.4.3.3.1" xref="S3.SS1.p1.4.m4.3.4.3.3.1.cmml">​</mo><mrow id="S3.SS1.p1.4.m4.3.4.3.3.3.2" xref="S3.SS1.p1.4.m4.3.4.3.3.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.3.4.3.3.3.2.1" xref="S3.SS1.p1.4.m4.3.4.3.3.cmml">(</mo><mi id="S3.SS1.p1.4.m4.3.3" xref="S3.SS1.p1.4.m4.3.3.cmml">θ</mi><mo stretchy="false" id="S3.SS1.p1.4.m4.3.4.3.3.3.2.2" xref="S3.SS1.p1.4.m4.3.4.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.3b"><apply id="S3.SS1.p1.4.m4.3.4.cmml" xref="S3.SS1.p1.4.m4.3.4"><eq id="S3.SS1.p1.4.m4.3.4.1.cmml" xref="S3.SS1.p1.4.m4.3.4.1"></eq><apply id="S3.SS1.p1.4.m4.3.4.2.cmml" xref="S3.SS1.p1.4.m4.3.4.2"><times id="S3.SS1.p1.4.m4.3.4.2.1.cmml" xref="S3.SS1.p1.4.m4.3.4.2.1"></times><apply id="S3.SS1.p1.4.m4.3.4.2.2.cmml" xref="S3.SS1.p1.4.m4.3.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.4.2.2.1.cmml" xref="S3.SS1.p1.4.m4.3.4.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.4.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.4.2.2.2">𝑅</ci><apply id="S3.SS1.p1.4.m4.3.4.2.2.3.cmml" xref="S3.SS1.p1.4.m4.3.4.2.2.3"><times id="S3.SS1.p1.4.m4.3.4.2.2.3.1.cmml" xref="S3.SS1.p1.4.m4.3.4.2.2.3.1"></times><ci id="S3.SS1.p1.4.m4.3.4.2.2.3.2.cmml" xref="S3.SS1.p1.4.m4.3.4.2.2.3.2">𝑘</ci><ci id="S3.SS1.p1.4.m4.3.4.2.2.3.3.cmml" xref="S3.SS1.p1.4.m4.3.4.2.2.3.3">𝑇</ci></apply></apply><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝜃</ci></apply><apply id="S3.SS1.p1.4.m4.3.4.3.cmml" xref="S3.SS1.p1.4.m4.3.4.3"><plus id="S3.SS1.p1.4.m4.3.4.3.1.cmml" xref="S3.SS1.p1.4.m4.3.4.3.1"></plus><apply id="S3.SS1.p1.4.m4.3.4.3.2.cmml" xref="S3.SS1.p1.4.m4.3.4.3.2"><times id="S3.SS1.p1.4.m4.3.4.3.2.1.cmml" xref="S3.SS1.p1.4.m4.3.4.3.2.1"></times><apply id="S3.SS1.p1.4.m4.3.4.3.2.2.cmml" xref="S3.SS1.p1.4.m4.3.4.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.4.3.2.2.1.cmml" xref="S3.SS1.p1.4.m4.3.4.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.4.3.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.4.3.2.2.2">𝑅</ci><ci id="S3.SS1.p1.4.m4.3.4.3.2.2.3.cmml" xref="S3.SS1.p1.4.m4.3.4.3.2.2.3">𝑘</ci></apply><ci id="S3.SS1.p1.4.m4.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2">𝜃</ci></apply><apply id="S3.SS1.p1.4.m4.3.4.3.3.cmml" xref="S3.SS1.p1.4.m4.3.4.3.3"><times id="S3.SS1.p1.4.m4.3.4.3.3.1.cmml" xref="S3.SS1.p1.4.m4.3.4.3.3.1"></times><apply id="S3.SS1.p1.4.m4.3.4.3.3.2.cmml" xref="S3.SS1.p1.4.m4.3.4.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.4.3.3.2.1.cmml" xref="S3.SS1.p1.4.m4.3.4.3.3.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.4.3.3.2.2.cmml" xref="S3.SS1.p1.4.m4.3.4.3.3.2.2">𝑅</ci><ci id="S3.SS1.p1.4.m4.3.4.3.3.2.3.cmml" xref="S3.SS1.p1.4.m4.3.4.3.3.2.3">𝑇</ci></apply><ci id="S3.SS1.p1.4.m4.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.3c">R_{kT}(\theta)\!=\!R_{k}(\theta)\!+\!R_{T}(\theta)</annotation></semantics></math>.
To align gradients <math id="S3.SS1.p1.5.m5.4" class="ltx_Math" alttext="G_{k}=\mathbb{E}_{\mathcal{D}_{k}}[\nabla_{\theta}\mathcal{L}_{k}(\theta;x,y)]" display="inline"><semantics id="S3.SS1.p1.5.m5.4a"><mrow id="S3.SS1.p1.5.m5.4.4" xref="S3.SS1.p1.5.m5.4.4.cmml"><msub id="S3.SS1.p1.5.m5.4.4.3" xref="S3.SS1.p1.5.m5.4.4.3.cmml"><mi id="S3.SS1.p1.5.m5.4.4.3.2" xref="S3.SS1.p1.5.m5.4.4.3.2.cmml">G</mi><mi id="S3.SS1.p1.5.m5.4.4.3.3" xref="S3.SS1.p1.5.m5.4.4.3.3.cmml">k</mi></msub><mo id="S3.SS1.p1.5.m5.4.4.2" xref="S3.SS1.p1.5.m5.4.4.2.cmml">=</mo><mrow id="S3.SS1.p1.5.m5.4.4.1" xref="S3.SS1.p1.5.m5.4.4.1.cmml"><msub id="S3.SS1.p1.5.m5.4.4.1.3" xref="S3.SS1.p1.5.m5.4.4.1.3.cmml"><mi id="S3.SS1.p1.5.m5.4.4.1.3.2" xref="S3.SS1.p1.5.m5.4.4.1.3.2.cmml">𝔼</mi><msub id="S3.SS1.p1.5.m5.4.4.1.3.3" xref="S3.SS1.p1.5.m5.4.4.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.4.4.1.3.3.2" xref="S3.SS1.p1.5.m5.4.4.1.3.3.2.cmml">𝒟</mi><mi id="S3.SS1.p1.5.m5.4.4.1.3.3.3" xref="S3.SS1.p1.5.m5.4.4.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.5.m5.4.4.1.2" xref="S3.SS1.p1.5.m5.4.4.1.2.cmml">​</mo><mrow id="S3.SS1.p1.5.m5.4.4.1.1.1" xref="S3.SS1.p1.5.m5.4.4.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m5.4.4.1.1.1.2" xref="S3.SS1.p1.5.m5.4.4.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p1.5.m5.4.4.1.1.1.1" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.cmml"><mrow id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.cmml"><msub id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1.cmml"><mo rspace="0.167em" id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1.2" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1.2.cmml">∇</mo><mi id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1.3" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1.3.cmml">θ</mi></msub><msub id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2.2" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2.2.cmml">ℒ</mi><mi id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2.3" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2.3.cmml">k</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p1.5.m5.4.4.1.1.1.1.1" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.1.cmml">​</mo><mrow id="S3.SS1.p1.5.m5.4.4.1.1.1.1.3.2" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m5.4.4.1.1.1.1.3.2.1" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.3.1.cmml">(</mo><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">θ</mi><mo id="S3.SS1.p1.5.m5.4.4.1.1.1.1.3.2.2" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.3.1.cmml">;</mo><mi id="S3.SS1.p1.5.m5.2.2" xref="S3.SS1.p1.5.m5.2.2.cmml">x</mi><mo id="S3.SS1.p1.5.m5.4.4.1.1.1.1.3.2.3" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS1.p1.5.m5.3.3" xref="S3.SS1.p1.5.m5.3.3.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.5.m5.4.4.1.1.1.1.3.2.4" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS1.p1.5.m5.4.4.1.1.1.3" xref="S3.SS1.p1.5.m5.4.4.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.4b"><apply id="S3.SS1.p1.5.m5.4.4.cmml" xref="S3.SS1.p1.5.m5.4.4"><eq id="S3.SS1.p1.5.m5.4.4.2.cmml" xref="S3.SS1.p1.5.m5.4.4.2"></eq><apply id="S3.SS1.p1.5.m5.4.4.3.cmml" xref="S3.SS1.p1.5.m5.4.4.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.3.1.cmml" xref="S3.SS1.p1.5.m5.4.4.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.4.4.3.2.cmml" xref="S3.SS1.p1.5.m5.4.4.3.2">𝐺</ci><ci id="S3.SS1.p1.5.m5.4.4.3.3.cmml" xref="S3.SS1.p1.5.m5.4.4.3.3">𝑘</ci></apply><apply id="S3.SS1.p1.5.m5.4.4.1.cmml" xref="S3.SS1.p1.5.m5.4.4.1"><times id="S3.SS1.p1.5.m5.4.4.1.2.cmml" xref="S3.SS1.p1.5.m5.4.4.1.2"></times><apply id="S3.SS1.p1.5.m5.4.4.1.3.cmml" xref="S3.SS1.p1.5.m5.4.4.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.1.3.1.cmml" xref="S3.SS1.p1.5.m5.4.4.1.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.4.4.1.3.2.cmml" xref="S3.SS1.p1.5.m5.4.4.1.3.2">𝔼</ci><apply id="S3.SS1.p1.5.m5.4.4.1.3.3.cmml" xref="S3.SS1.p1.5.m5.4.4.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.1.3.3.1.cmml" xref="S3.SS1.p1.5.m5.4.4.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.4.4.1.3.3.2.cmml" xref="S3.SS1.p1.5.m5.4.4.1.3.3.2">𝒟</ci><ci id="S3.SS1.p1.5.m5.4.4.1.3.3.3.cmml" xref="S3.SS1.p1.5.m5.4.4.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.SS1.p1.5.m5.4.4.1.1.2.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.5.m5.4.4.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.5.m5.4.4.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1"><times id="S3.SS1.p1.5.m5.4.4.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.1"></times><apply id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2"><apply id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1.1.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1.2.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1.2">∇</ci><ci id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1.3.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.1.3">𝜃</ci></apply><apply id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2.2">ℒ</ci><ci id="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.2.2.3">𝑘</ci></apply></apply><list id="S3.SS1.p1.5.m5.4.4.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.4.4.1.1.1.1.3.2"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝜃</ci><ci id="S3.SS1.p1.5.m5.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2">𝑥</ci><ci id="S3.SS1.p1.5.m5.3.3.cmml" xref="S3.SS1.p1.5.m5.3.3">𝑦</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.4c">G_{k}=\mathbb{E}_{\mathcal{D}_{k}}[\nabla_{\theta}\mathcal{L}_{k}(\theta;x,y)]</annotation></semantics></math> of the <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">k</annotation></semantics></math>-th domain
and the target domain <math id="S3.SS1.p1.7.m7.4" class="ltx_Math" alttext="G_{T}=\mathbb{E}_{\mathcal{D}_{T}}[\nabla_{\theta}\mathcal{L}_{T}(\theta;x,y)]" display="inline"><semantics id="S3.SS1.p1.7.m7.4a"><mrow id="S3.SS1.p1.7.m7.4.4" xref="S3.SS1.p1.7.m7.4.4.cmml"><msub id="S3.SS1.p1.7.m7.4.4.3" xref="S3.SS1.p1.7.m7.4.4.3.cmml"><mi id="S3.SS1.p1.7.m7.4.4.3.2" xref="S3.SS1.p1.7.m7.4.4.3.2.cmml">G</mi><mi id="S3.SS1.p1.7.m7.4.4.3.3" xref="S3.SS1.p1.7.m7.4.4.3.3.cmml">T</mi></msub><mo id="S3.SS1.p1.7.m7.4.4.2" xref="S3.SS1.p1.7.m7.4.4.2.cmml">=</mo><mrow id="S3.SS1.p1.7.m7.4.4.1" xref="S3.SS1.p1.7.m7.4.4.1.cmml"><msub id="S3.SS1.p1.7.m7.4.4.1.3" xref="S3.SS1.p1.7.m7.4.4.1.3.cmml"><mi id="S3.SS1.p1.7.m7.4.4.1.3.2" xref="S3.SS1.p1.7.m7.4.4.1.3.2.cmml">𝔼</mi><msub id="S3.SS1.p1.7.m7.4.4.1.3.3" xref="S3.SS1.p1.7.m7.4.4.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.4.4.1.3.3.2" xref="S3.SS1.p1.7.m7.4.4.1.3.3.2.cmml">𝒟</mi><mi id="S3.SS1.p1.7.m7.4.4.1.3.3.3" xref="S3.SS1.p1.7.m7.4.4.1.3.3.3.cmml">T</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m7.4.4.1.2" xref="S3.SS1.p1.7.m7.4.4.1.2.cmml">​</mo><mrow id="S3.SS1.p1.7.m7.4.4.1.1.1" xref="S3.SS1.p1.7.m7.4.4.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m7.4.4.1.1.1.2" xref="S3.SS1.p1.7.m7.4.4.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p1.7.m7.4.4.1.1.1.1" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.cmml"><mrow id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.cmml"><msub id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1.cmml"><mo rspace="0.167em" id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1.2" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1.2.cmml">∇</mo><mi id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1.3" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1.3.cmml">θ</mi></msub><msub id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2.2" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2.2.cmml">ℒ</mi><mi id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2.3" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2.3.cmml">T</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m7.4.4.1.1.1.1.1" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.1.cmml">​</mo><mrow id="S3.SS1.p1.7.m7.4.4.1.1.1.1.3.2" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m7.4.4.1.1.1.1.3.2.1" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.3.1.cmml">(</mo><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">θ</mi><mo id="S3.SS1.p1.7.m7.4.4.1.1.1.1.3.2.2" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.3.1.cmml">;</mo><mi id="S3.SS1.p1.7.m7.2.2" xref="S3.SS1.p1.7.m7.2.2.cmml">x</mi><mo id="S3.SS1.p1.7.m7.4.4.1.1.1.1.3.2.3" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS1.p1.7.m7.3.3" xref="S3.SS1.p1.7.m7.3.3.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.7.m7.4.4.1.1.1.1.3.2.4" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS1.p1.7.m7.4.4.1.1.1.3" xref="S3.SS1.p1.7.m7.4.4.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.4b"><apply id="S3.SS1.p1.7.m7.4.4.cmml" xref="S3.SS1.p1.7.m7.4.4"><eq id="S3.SS1.p1.7.m7.4.4.2.cmml" xref="S3.SS1.p1.7.m7.4.4.2"></eq><apply id="S3.SS1.p1.7.m7.4.4.3.cmml" xref="S3.SS1.p1.7.m7.4.4.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.4.4.3.1.cmml" xref="S3.SS1.p1.7.m7.4.4.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.4.4.3.2.cmml" xref="S3.SS1.p1.7.m7.4.4.3.2">𝐺</ci><ci id="S3.SS1.p1.7.m7.4.4.3.3.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3">𝑇</ci></apply><apply id="S3.SS1.p1.7.m7.4.4.1.cmml" xref="S3.SS1.p1.7.m7.4.4.1"><times id="S3.SS1.p1.7.m7.4.4.1.2.cmml" xref="S3.SS1.p1.7.m7.4.4.1.2"></times><apply id="S3.SS1.p1.7.m7.4.4.1.3.cmml" xref="S3.SS1.p1.7.m7.4.4.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.4.4.1.3.1.cmml" xref="S3.SS1.p1.7.m7.4.4.1.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.4.4.1.3.2.cmml" xref="S3.SS1.p1.7.m7.4.4.1.3.2">𝔼</ci><apply id="S3.SS1.p1.7.m7.4.4.1.3.3.cmml" xref="S3.SS1.p1.7.m7.4.4.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.4.4.1.3.3.1.cmml" xref="S3.SS1.p1.7.m7.4.4.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.4.4.1.3.3.2.cmml" xref="S3.SS1.p1.7.m7.4.4.1.3.3.2">𝒟</ci><ci id="S3.SS1.p1.7.m7.4.4.1.3.3.3.cmml" xref="S3.SS1.p1.7.m7.4.4.1.3.3.3">𝑇</ci></apply></apply><apply id="S3.SS1.p1.7.m7.4.4.1.1.2.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.7.m7.4.4.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.7.m7.4.4.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1"><times id="S3.SS1.p1.7.m7.4.4.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.1"></times><apply id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2"><apply id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1.1.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1.2.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1.2">∇</ci><ci id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1.3.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.1.3">𝜃</ci></apply><apply id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2.2">ℒ</ci><ci id="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.2.2.3">𝑇</ci></apply></apply><list id="S3.SS1.p1.7.m7.4.4.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.4.4.1.1.1.1.3.2"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝜃</ci><ci id="S3.SS1.p1.7.m7.2.2.cmml" xref="S3.SS1.p1.7.m7.2.2">𝑥</ci><ci id="S3.SS1.p1.7.m7.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3">𝑦</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.4c">G_{T}=\mathbb{E}_{\mathcal{D}_{T}}[\nabla_{\theta}\mathcal{L}_{T}(\theta;x,y)]</annotation></semantics></math>, we maximize their inner product <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="G_{T}\!\cdot\!G_{k}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><msub id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2.2" xref="S3.SS1.p1.8.m8.1.1.2.2.cmml">G</mi><mi id="S3.SS1.p1.8.m8.1.1.2.3" xref="S3.SS1.p1.8.m8.1.1.2.3.cmml">T</mi></msub><mo lspace="0.052em" rspace="0.052em" id="S3.SS1.p1.8.m8.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.cmml">⋅</mo><msub id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml"><mi id="S3.SS1.p1.8.m8.1.1.3.2" xref="S3.SS1.p1.8.m8.1.1.3.2.cmml">G</mi><mi id="S3.SS1.p1.8.m8.1.1.3.3" xref="S3.SS1.p1.8.m8.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><ci id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1">⋅</ci><apply id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2.2">𝐺</ci><ci id="S3.SS1.p1.8.m8.1.1.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.2.3">𝑇</ci></apply><apply id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.3.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.3.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2">𝐺</ci><ci id="S3.SS1.p1.8.m8.1.1.3.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">G_{T}\!\cdot\!G_{k}</annotation></semantics></math>. Hence over all pairs, we minimize the total cost:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.3" class="ltx_Math" alttext="R^{\texttt{StarAlign}}_{total}=\frac{1}{S\!+\!1}\sum_{k=1}^{S+1}R^{\texttt{Align}}_{kT}(\theta)=\frac{1}{S\!+\!1}\sum_{k=1}^{S+1}\left(R_{kT}(\theta)-\delta G_{T}\cdot G_{k}\right)," display="block"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><msubsup id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.2.2" xref="S3.E2.m1.3.3.1.1.3.2.2.cmml">R</mi><mrow id="S3.E2.m1.3.3.1.1.3.3" xref="S3.E2.m1.3.3.1.1.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.3.1" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.1.1.3.3.3" xref="S3.E2.m1.3.3.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.3.1a" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.1.1.3.3.4" xref="S3.E2.m1.3.3.1.1.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.3.1b" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.1.1.3.3.5" xref="S3.E2.m1.3.3.1.1.3.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.3.1c" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.1.1.3.3.6" xref="S3.E2.m1.3.3.1.1.3.3.6.cmml">l</mi></mrow><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.3.3.1.1.3.2.3" xref="S3.E2.m1.3.3.1.1.3.2.3a.cmml">StarAlign</mtext></msubsup><mo id="S3.E2.m1.3.3.1.1.4" xref="S3.E2.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.5" xref="S3.E2.m1.3.3.1.1.5.cmml"><mfrac id="S3.E2.m1.3.3.1.1.5.2" xref="S3.E2.m1.3.3.1.1.5.2.cmml"><mn id="S3.E2.m1.3.3.1.1.5.2.2" xref="S3.E2.m1.3.3.1.1.5.2.2.cmml">1</mn><mrow id="S3.E2.m1.3.3.1.1.5.2.3" xref="S3.E2.m1.3.3.1.1.5.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.5.2.3.2" xref="S3.E2.m1.3.3.1.1.5.2.3.2.cmml">S</mi><mo lspace="0.052em" rspace="0.052em" id="S3.E2.m1.3.3.1.1.5.2.3.1" xref="S3.E2.m1.3.3.1.1.5.2.3.1.cmml">+</mo><mn id="S3.E2.m1.3.3.1.1.5.2.3.3" xref="S3.E2.m1.3.3.1.1.5.2.3.3.cmml">1</mn></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.5.1" xref="S3.E2.m1.3.3.1.1.5.1.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.5.3" xref="S3.E2.m1.3.3.1.1.5.3.cmml"><munderover id="S3.E2.m1.3.3.1.1.5.3.1" xref="S3.E2.m1.3.3.1.1.5.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.3.3.1.1.5.3.1.2.2" xref="S3.E2.m1.3.3.1.1.5.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.3.3.1.1.5.3.1.2.3" xref="S3.E2.m1.3.3.1.1.5.3.1.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.5.3.1.2.3.2" xref="S3.E2.m1.3.3.1.1.5.3.1.2.3.2.cmml">k</mi><mo id="S3.E2.m1.3.3.1.1.5.3.1.2.3.1" xref="S3.E2.m1.3.3.1.1.5.3.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.3.3.1.1.5.3.1.2.3.3" xref="S3.E2.m1.3.3.1.1.5.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E2.m1.3.3.1.1.5.3.1.3" xref="S3.E2.m1.3.3.1.1.5.3.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.5.3.1.3.2" xref="S3.E2.m1.3.3.1.1.5.3.1.3.2.cmml">S</mi><mo id="S3.E2.m1.3.3.1.1.5.3.1.3.1" xref="S3.E2.m1.3.3.1.1.5.3.1.3.1.cmml">+</mo><mn id="S3.E2.m1.3.3.1.1.5.3.1.3.3" xref="S3.E2.m1.3.3.1.1.5.3.1.3.3.cmml">1</mn></mrow></munderover><mrow id="S3.E2.m1.3.3.1.1.5.3.2" xref="S3.E2.m1.3.3.1.1.5.3.2.cmml"><msubsup id="S3.E2.m1.3.3.1.1.5.3.2.2" xref="S3.E2.m1.3.3.1.1.5.3.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.5.3.2.2.2.2" xref="S3.E2.m1.3.3.1.1.5.3.2.2.2.2.cmml">R</mi><mrow id="S3.E2.m1.3.3.1.1.5.3.2.2.3" xref="S3.E2.m1.3.3.1.1.5.3.2.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.5.3.2.2.3.2" xref="S3.E2.m1.3.3.1.1.5.3.2.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.5.3.2.2.3.1" xref="S3.E2.m1.3.3.1.1.5.3.2.2.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.1.1.5.3.2.2.3.3" xref="S3.E2.m1.3.3.1.1.5.3.2.2.3.3.cmml">T</mi></mrow><mtext class="ltx_mathvariant_monospace" id="S3.E2.m1.3.3.1.1.5.3.2.2.2.3" xref="S3.E2.m1.3.3.1.1.5.3.2.2.2.3a.cmml">Align</mtext></msubsup><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.5.3.2.1" xref="S3.E2.m1.3.3.1.1.5.3.2.1.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.5.3.2.3.2" xref="S3.E2.m1.3.3.1.1.5.3.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.5.3.2.3.2.1" xref="S3.E2.m1.3.3.1.1.5.3.2.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E2.m1.3.3.1.1.5.3.2.3.2.2" xref="S3.E2.m1.3.3.1.1.5.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.1.1.6" xref="S3.E2.m1.3.3.1.1.6.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml"><mfrac id="S3.E2.m1.3.3.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.3.cmml"><mn id="S3.E2.m1.3.3.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.1.3.2.cmml">1</mn><mrow id="S3.E2.m1.3.3.1.1.1.3.3" xref="S3.E2.m1.3.3.1.1.1.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.1.3.3.2.cmml">S</mi><mo lspace="0.052em" rspace="0.052em" id="S3.E2.m1.3.3.1.1.1.3.3.1" xref="S3.E2.m1.3.3.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E2.m1.3.3.1.1.1.3.3.3" xref="S3.E2.m1.3.3.1.1.1.3.3.3.cmml">1</mn></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.cmml"><munderover id="S3.E2.m1.3.3.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E2.m1.3.3.1.1.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.2.2.3" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.2.2.3.2" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E2.m1.3.3.1.1.1.1.2.2.3.1" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.3.3.1.1.1.1.2.2.3.3" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E2.m1.3.3.1.1.1.1.2.3" xref="S3.E2.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.2.3.2" xref="S3.E2.m1.3.3.1.1.1.1.2.3.2.cmml">S</mi><mo id="S3.E2.m1.3.3.1.1.1.1.2.3.1" xref="S3.E2.m1.3.3.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E2.m1.3.3.1.1.1.1.2.3.3" xref="S3.E2.m1.3.3.1.1.1.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml">R</mi><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3.cmml">T</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.3.2.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.1.cmml">​</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3.2.cmml">G</mi><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3.3.cmml">T</mi></msub></mrow><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">⋅</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.2.cmml">G</mi><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><and id="S3.E2.m1.3.3.1.1a.cmml" xref="S3.E2.m1.3.3.1"></and><apply id="S3.E2.m1.3.3.1.1b.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.4.cmml" xref="S3.E2.m1.3.3.1.1.4"></eq><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3">subscript</csymbol><apply id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3">superscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2.2">𝑅</ci><ci id="S3.E2.m1.3.3.1.1.3.2.3a.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E2.m1.3.3.1.1.3.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.2.3">StarAlign</mtext></ci></apply><apply id="S3.E2.m1.3.3.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3"><times id="S3.E2.m1.3.3.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3.1"></times><ci id="S3.E2.m1.3.3.1.1.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.3.2">𝑡</ci><ci id="S3.E2.m1.3.3.1.1.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3.3">𝑜</ci><ci id="S3.E2.m1.3.3.1.1.3.3.4.cmml" xref="S3.E2.m1.3.3.1.1.3.3.4">𝑡</ci><ci id="S3.E2.m1.3.3.1.1.3.3.5.cmml" xref="S3.E2.m1.3.3.1.1.3.3.5">𝑎</ci><ci id="S3.E2.m1.3.3.1.1.3.3.6.cmml" xref="S3.E2.m1.3.3.1.1.3.3.6">𝑙</ci></apply></apply><apply id="S3.E2.m1.3.3.1.1.5.cmml" xref="S3.E2.m1.3.3.1.1.5"><times id="S3.E2.m1.3.3.1.1.5.1.cmml" xref="S3.E2.m1.3.3.1.1.5.1"></times><apply id="S3.E2.m1.3.3.1.1.5.2.cmml" xref="S3.E2.m1.3.3.1.1.5.2"><divide id="S3.E2.m1.3.3.1.1.5.2.1.cmml" xref="S3.E2.m1.3.3.1.1.5.2"></divide><cn type="integer" id="S3.E2.m1.3.3.1.1.5.2.2.cmml" xref="S3.E2.m1.3.3.1.1.5.2.2">1</cn><apply id="S3.E2.m1.3.3.1.1.5.2.3.cmml" xref="S3.E2.m1.3.3.1.1.5.2.3"><plus id="S3.E2.m1.3.3.1.1.5.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.5.2.3.1"></plus><ci id="S3.E2.m1.3.3.1.1.5.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.5.2.3.2">𝑆</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.5.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.5.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.3.3.1.1.5.3.cmml" xref="S3.E2.m1.3.3.1.1.5.3"><apply id="S3.E2.m1.3.3.1.1.5.3.1.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.5.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1">superscript</csymbol><apply id="S3.E2.m1.3.3.1.1.5.3.1.2.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.5.3.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1">subscript</csymbol><sum id="S3.E2.m1.3.3.1.1.5.3.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1.2.2"></sum><apply id="S3.E2.m1.3.3.1.1.5.3.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1.2.3"><eq id="S3.E2.m1.3.3.1.1.5.3.1.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1.2.3.1"></eq><ci id="S3.E2.m1.3.3.1.1.5.3.1.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.5.3.1.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.3.3.1.1.5.3.1.3.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1.3"><plus id="S3.E2.m1.3.3.1.1.5.3.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1.3.1"></plus><ci id="S3.E2.m1.3.3.1.1.5.3.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1.3.2">𝑆</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.5.3.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.5.3.1.3.3">1</cn></apply></apply><apply id="S3.E2.m1.3.3.1.1.5.3.2.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2"><times id="S3.E2.m1.3.3.1.1.5.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2.1"></times><apply id="S3.E2.m1.3.3.1.1.5.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.5.3.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2.2">subscript</csymbol><apply id="S3.E2.m1.3.3.1.1.5.3.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.5.3.2.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2.2">superscript</csymbol><ci id="S3.E2.m1.3.3.1.1.5.3.2.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2.2.2.2">𝑅</ci><ci id="S3.E2.m1.3.3.1.1.5.3.2.2.2.3a.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2.2.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E2.m1.3.3.1.1.5.3.2.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2.2.2.3">Align</mtext></ci></apply><apply id="S3.E2.m1.3.3.1.1.5.3.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2.2.3"><times id="S3.E2.m1.3.3.1.1.5.3.2.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2.2.3.1"></times><ci id="S3.E2.m1.3.3.1.1.5.3.2.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2.2.3.2">𝑘</ci><ci id="S3.E2.m1.3.3.1.1.5.3.2.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.5.3.2.2.3.3">𝑇</ci></apply></apply><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝜃</ci></apply></apply></apply></apply><apply id="S3.E2.m1.3.3.1.1c.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.6.cmml" xref="S3.E2.m1.3.3.1.1.6"></eq><share href="#S3.E2.m1.3.3.1.1.5.cmml" id="S3.E2.m1.3.3.1.1d.cmml" xref="S3.E2.m1.3.3.1"></share><apply id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"><times id="S3.E2.m1.3.3.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.2"></times><apply id="S3.E2.m1.3.3.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.3"><divide id="S3.E2.m1.3.3.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.3"></divide><cn type="integer" id="S3.E2.m1.3.3.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.3.2">1</cn><apply id="S3.E2.m1.3.3.1.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.3.3"><plus id="S3.E2.m1.3.3.1.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.3.3.1"></plus><ci id="S3.E2.m1.3.3.1.1.1.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.3.3.2">𝑆</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.1.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E2.m1.3.3.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1"><apply id="S3.E2.m1.3.3.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3"><eq id="S3.E2.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3"><plus id="S3.E2.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3.1"></plus><ci id="S3.E2.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3.2">𝑆</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1"><minus id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.1"></minus><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2"><times id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2">𝑅</ci><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3"><times id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.2">𝑘</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.3.3">𝑇</ci></apply></apply><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝜃</ci></apply><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3"><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.1">⋅</ci><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2"><times id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.1"></times><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.2">𝛿</ci><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3.2">𝐺</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.2.3.3">𝑇</ci></apply></apply><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.2">𝐺</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">R^{\texttt{StarAlign}}_{total}=\frac{1}{S\!+\!1}\sum_{k=1}^{S+1}R^{\texttt{Align}}_{kT}(\theta)=\frac{1}{S\!+\!1}\sum_{k=1}^{S+1}\left(R_{kT}(\theta)-\delta G_{T}\cdot G_{k}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">with <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\delta</annotation></semantics></math> a hyperparameter. Using dot product’s distributive property we get:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.2" class="ltx_Math" alttext="R^{\texttt{StarAlign}}_{total}=R_{T}(\theta)+\frac{1}{S\!+\!1}\sum_{k=1}^{S+1}R_{k}(\theta)-\delta G_{T}\cdot\sum_{k=1}^{S+1}\frac{G_{k}}{S\!+\!1}" display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.3" xref="S3.E3.m1.2.3.cmml"><msubsup id="S3.E3.m1.2.3.2" xref="S3.E3.m1.2.3.2.cmml"><mi id="S3.E3.m1.2.3.2.2.2" xref="S3.E3.m1.2.3.2.2.2.cmml">R</mi><mrow id="S3.E3.m1.2.3.2.3" xref="S3.E3.m1.2.3.2.3.cmml"><mi id="S3.E3.m1.2.3.2.3.2" xref="S3.E3.m1.2.3.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.2.3.1" xref="S3.E3.m1.2.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.2.3.2.3.3" xref="S3.E3.m1.2.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.2.3.1a" xref="S3.E3.m1.2.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.2.3.2.3.4" xref="S3.E3.m1.2.3.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.2.3.1b" xref="S3.E3.m1.2.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.2.3.2.3.5" xref="S3.E3.m1.2.3.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.2.3.1c" xref="S3.E3.m1.2.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.2.3.2.3.6" xref="S3.E3.m1.2.3.2.3.6.cmml">l</mi></mrow><mtext class="ltx_mathvariant_monospace" id="S3.E3.m1.2.3.2.2.3" xref="S3.E3.m1.2.3.2.2.3a.cmml">StarAlign</mtext></msubsup><mo id="S3.E3.m1.2.3.1" xref="S3.E3.m1.2.3.1.cmml">=</mo><mrow id="S3.E3.m1.2.3.3" xref="S3.E3.m1.2.3.3.cmml"><mrow id="S3.E3.m1.2.3.3.2" xref="S3.E3.m1.2.3.3.2.cmml"><mrow id="S3.E3.m1.2.3.3.2.2" xref="S3.E3.m1.2.3.3.2.2.cmml"><msub id="S3.E3.m1.2.3.3.2.2.2" xref="S3.E3.m1.2.3.3.2.2.2.cmml"><mi id="S3.E3.m1.2.3.3.2.2.2.2" xref="S3.E3.m1.2.3.3.2.2.2.2.cmml">R</mi><mi id="S3.E3.m1.2.3.3.2.2.2.3" xref="S3.E3.m1.2.3.3.2.2.2.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.3.2.2.1" xref="S3.E3.m1.2.3.3.2.2.1.cmml">​</mo><mrow id="S3.E3.m1.2.3.3.2.2.3.2" xref="S3.E3.m1.2.3.3.2.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.3.3.2.2.3.2.1" xref="S3.E3.m1.2.3.3.2.2.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E3.m1.2.3.3.2.2.3.2.2" xref="S3.E3.m1.2.3.3.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.3.3.2.1" xref="S3.E3.m1.2.3.3.2.1.cmml">+</mo><mrow id="S3.E3.m1.2.3.3.2.3" xref="S3.E3.m1.2.3.3.2.3.cmml"><mfrac id="S3.E3.m1.2.3.3.2.3.2" xref="S3.E3.m1.2.3.3.2.3.2.cmml"><mn id="S3.E3.m1.2.3.3.2.3.2.2" xref="S3.E3.m1.2.3.3.2.3.2.2.cmml">1</mn><mrow id="S3.E3.m1.2.3.3.2.3.2.3" xref="S3.E3.m1.2.3.3.2.3.2.3.cmml"><mi id="S3.E3.m1.2.3.3.2.3.2.3.2" xref="S3.E3.m1.2.3.3.2.3.2.3.2.cmml">S</mi><mo lspace="0.052em" rspace="0.052em" id="S3.E3.m1.2.3.3.2.3.2.3.1" xref="S3.E3.m1.2.3.3.2.3.2.3.1.cmml">+</mo><mn id="S3.E3.m1.2.3.3.2.3.2.3.3" xref="S3.E3.m1.2.3.3.2.3.2.3.3.cmml">1</mn></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.3.2.3.1" xref="S3.E3.m1.2.3.3.2.3.1.cmml">​</mo><mrow id="S3.E3.m1.2.3.3.2.3.3" xref="S3.E3.m1.2.3.3.2.3.3.cmml"><munderover id="S3.E3.m1.2.3.3.2.3.3.1" xref="S3.E3.m1.2.3.3.2.3.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.2.3.3.2.3.3.1.2.2" xref="S3.E3.m1.2.3.3.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.2.3.3.2.3.3.1.2.3" xref="S3.E3.m1.2.3.3.2.3.3.1.2.3.cmml"><mi id="S3.E3.m1.2.3.3.2.3.3.1.2.3.2" xref="S3.E3.m1.2.3.3.2.3.3.1.2.3.2.cmml">k</mi><mo id="S3.E3.m1.2.3.3.2.3.3.1.2.3.1" xref="S3.E3.m1.2.3.3.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.2.3.3.2.3.3.1.2.3.3" xref="S3.E3.m1.2.3.3.2.3.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E3.m1.2.3.3.2.3.3.1.3" xref="S3.E3.m1.2.3.3.2.3.3.1.3.cmml"><mi id="S3.E3.m1.2.3.3.2.3.3.1.3.2" xref="S3.E3.m1.2.3.3.2.3.3.1.3.2.cmml">S</mi><mo id="S3.E3.m1.2.3.3.2.3.3.1.3.1" xref="S3.E3.m1.2.3.3.2.3.3.1.3.1.cmml">+</mo><mn id="S3.E3.m1.2.3.3.2.3.3.1.3.3" xref="S3.E3.m1.2.3.3.2.3.3.1.3.3.cmml">1</mn></mrow></munderover><mrow id="S3.E3.m1.2.3.3.2.3.3.2" xref="S3.E3.m1.2.3.3.2.3.3.2.cmml"><msub id="S3.E3.m1.2.3.3.2.3.3.2.2" xref="S3.E3.m1.2.3.3.2.3.3.2.2.cmml"><mi id="S3.E3.m1.2.3.3.2.3.3.2.2.2" xref="S3.E3.m1.2.3.3.2.3.3.2.2.2.cmml">R</mi><mi id="S3.E3.m1.2.3.3.2.3.3.2.2.3" xref="S3.E3.m1.2.3.3.2.3.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.3.2.3.3.2.1" xref="S3.E3.m1.2.3.3.2.3.3.2.1.cmml">​</mo><mrow id="S3.E3.m1.2.3.3.2.3.3.2.3.2" xref="S3.E3.m1.2.3.3.2.3.3.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.3.3.2.3.3.2.3.2.1" xref="S3.E3.m1.2.3.3.2.3.3.2.cmml">(</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S3.E3.m1.2.3.3.2.3.3.2.3.2.2" xref="S3.E3.m1.2.3.3.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.2.3.3.1" xref="S3.E3.m1.2.3.3.1.cmml">−</mo><mrow id="S3.E3.m1.2.3.3.3" xref="S3.E3.m1.2.3.3.3.cmml"><mrow id="S3.E3.m1.2.3.3.3.2" xref="S3.E3.m1.2.3.3.3.2.cmml"><mi id="S3.E3.m1.2.3.3.3.2.2" xref="S3.E3.m1.2.3.3.3.2.2.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.3.3.3.2.1" xref="S3.E3.m1.2.3.3.3.2.1.cmml">​</mo><msub id="S3.E3.m1.2.3.3.3.2.3" xref="S3.E3.m1.2.3.3.3.2.3.cmml"><mi id="S3.E3.m1.2.3.3.3.2.3.2" xref="S3.E3.m1.2.3.3.3.2.3.2.cmml">G</mi><mi id="S3.E3.m1.2.3.3.3.2.3.3" xref="S3.E3.m1.2.3.3.3.2.3.3.cmml">T</mi></msub></mrow><mo lspace="0.222em" rspace="0.055em" id="S3.E3.m1.2.3.3.3.1" xref="S3.E3.m1.2.3.3.3.1.cmml">⋅</mo><mrow id="S3.E3.m1.2.3.3.3.3" xref="S3.E3.m1.2.3.3.3.3.cmml"><munderover id="S3.E3.m1.2.3.3.3.3.1" xref="S3.E3.m1.2.3.3.3.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.2.3.3.3.3.1.2.2" xref="S3.E3.m1.2.3.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.2.3.3.3.3.1.2.3" xref="S3.E3.m1.2.3.3.3.3.1.2.3.cmml"><mi id="S3.E3.m1.2.3.3.3.3.1.2.3.2" xref="S3.E3.m1.2.3.3.3.3.1.2.3.2.cmml">k</mi><mo id="S3.E3.m1.2.3.3.3.3.1.2.3.1" xref="S3.E3.m1.2.3.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.2.3.3.3.3.1.2.3.3" xref="S3.E3.m1.2.3.3.3.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E3.m1.2.3.3.3.3.1.3" xref="S3.E3.m1.2.3.3.3.3.1.3.cmml"><mi id="S3.E3.m1.2.3.3.3.3.1.3.2" xref="S3.E3.m1.2.3.3.3.3.1.3.2.cmml">S</mi><mo id="S3.E3.m1.2.3.3.3.3.1.3.1" xref="S3.E3.m1.2.3.3.3.3.1.3.1.cmml">+</mo><mn id="S3.E3.m1.2.3.3.3.3.1.3.3" xref="S3.E3.m1.2.3.3.3.3.1.3.3.cmml">1</mn></mrow></munderover><mfrac id="S3.E3.m1.2.3.3.3.3.2" xref="S3.E3.m1.2.3.3.3.3.2.cmml"><msub id="S3.E3.m1.2.3.3.3.3.2.2" xref="S3.E3.m1.2.3.3.3.3.2.2.cmml"><mi id="S3.E3.m1.2.3.3.3.3.2.2.2" xref="S3.E3.m1.2.3.3.3.3.2.2.2.cmml">G</mi><mi id="S3.E3.m1.2.3.3.3.3.2.2.3" xref="S3.E3.m1.2.3.3.3.3.2.2.3.cmml">k</mi></msub><mrow id="S3.E3.m1.2.3.3.3.3.2.3" xref="S3.E3.m1.2.3.3.3.3.2.3.cmml"><mi id="S3.E3.m1.2.3.3.3.3.2.3.2" xref="S3.E3.m1.2.3.3.3.3.2.3.2.cmml">S</mi><mo lspace="0.052em" rspace="0.052em" id="S3.E3.m1.2.3.3.3.3.2.3.1" xref="S3.E3.m1.2.3.3.3.3.2.3.1.cmml">+</mo><mn id="S3.E3.m1.2.3.3.3.3.2.3.3" xref="S3.E3.m1.2.3.3.3.3.2.3.3.cmml">1</mn></mrow></mfrac></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.3.cmml" xref="S3.E3.m1.2.3"><eq id="S3.E3.m1.2.3.1.cmml" xref="S3.E3.m1.2.3.1"></eq><apply id="S3.E3.m1.2.3.2.cmml" xref="S3.E3.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.2.1.cmml" xref="S3.E3.m1.2.3.2">subscript</csymbol><apply id="S3.E3.m1.2.3.2.2.cmml" xref="S3.E3.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.2.2.1.cmml" xref="S3.E3.m1.2.3.2">superscript</csymbol><ci id="S3.E3.m1.2.3.2.2.2.cmml" xref="S3.E3.m1.2.3.2.2.2">𝑅</ci><ci id="S3.E3.m1.2.3.2.2.3a.cmml" xref="S3.E3.m1.2.3.2.2.3"><mtext class="ltx_mathvariant_monospace" mathsize="70%" id="S3.E3.m1.2.3.2.2.3.cmml" xref="S3.E3.m1.2.3.2.2.3">StarAlign</mtext></ci></apply><apply id="S3.E3.m1.2.3.2.3.cmml" xref="S3.E3.m1.2.3.2.3"><times id="S3.E3.m1.2.3.2.3.1.cmml" xref="S3.E3.m1.2.3.2.3.1"></times><ci id="S3.E3.m1.2.3.2.3.2.cmml" xref="S3.E3.m1.2.3.2.3.2">𝑡</ci><ci id="S3.E3.m1.2.3.2.3.3.cmml" xref="S3.E3.m1.2.3.2.3.3">𝑜</ci><ci id="S3.E3.m1.2.3.2.3.4.cmml" xref="S3.E3.m1.2.3.2.3.4">𝑡</ci><ci id="S3.E3.m1.2.3.2.3.5.cmml" xref="S3.E3.m1.2.3.2.3.5">𝑎</ci><ci id="S3.E3.m1.2.3.2.3.6.cmml" xref="S3.E3.m1.2.3.2.3.6">𝑙</ci></apply></apply><apply id="S3.E3.m1.2.3.3.cmml" xref="S3.E3.m1.2.3.3"><minus id="S3.E3.m1.2.3.3.1.cmml" xref="S3.E3.m1.2.3.3.1"></minus><apply id="S3.E3.m1.2.3.3.2.cmml" xref="S3.E3.m1.2.3.3.2"><plus id="S3.E3.m1.2.3.3.2.1.cmml" xref="S3.E3.m1.2.3.3.2.1"></plus><apply id="S3.E3.m1.2.3.3.2.2.cmml" xref="S3.E3.m1.2.3.3.2.2"><times id="S3.E3.m1.2.3.3.2.2.1.cmml" xref="S3.E3.m1.2.3.3.2.2.1"></times><apply id="S3.E3.m1.2.3.3.2.2.2.cmml" xref="S3.E3.m1.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.2.2.2.1.cmml" xref="S3.E3.m1.2.3.3.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.3.3.2.2.2.2.cmml" xref="S3.E3.m1.2.3.3.2.2.2.2">𝑅</ci><ci id="S3.E3.m1.2.3.3.2.2.2.3.cmml" xref="S3.E3.m1.2.3.3.2.2.2.3">𝑇</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝜃</ci></apply><apply id="S3.E3.m1.2.3.3.2.3.cmml" xref="S3.E3.m1.2.3.3.2.3"><times id="S3.E3.m1.2.3.3.2.3.1.cmml" xref="S3.E3.m1.2.3.3.2.3.1"></times><apply id="S3.E3.m1.2.3.3.2.3.2.cmml" xref="S3.E3.m1.2.3.3.2.3.2"><divide id="S3.E3.m1.2.3.3.2.3.2.1.cmml" xref="S3.E3.m1.2.3.3.2.3.2"></divide><cn type="integer" id="S3.E3.m1.2.3.3.2.3.2.2.cmml" xref="S3.E3.m1.2.3.3.2.3.2.2">1</cn><apply id="S3.E3.m1.2.3.3.2.3.2.3.cmml" xref="S3.E3.m1.2.3.3.2.3.2.3"><plus id="S3.E3.m1.2.3.3.2.3.2.3.1.cmml" xref="S3.E3.m1.2.3.3.2.3.2.3.1"></plus><ci id="S3.E3.m1.2.3.3.2.3.2.3.2.cmml" xref="S3.E3.m1.2.3.3.2.3.2.3.2">𝑆</ci><cn type="integer" id="S3.E3.m1.2.3.3.2.3.2.3.3.cmml" xref="S3.E3.m1.2.3.3.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.2.3.3.2.3.3.cmml" xref="S3.E3.m1.2.3.3.2.3.3"><apply id="S3.E3.m1.2.3.3.2.3.3.1.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.2.3.3.1.1.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1">superscript</csymbol><apply id="S3.E3.m1.2.3.3.2.3.3.1.2.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.2.3.3.1.2.1.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1">subscript</csymbol><sum id="S3.E3.m1.2.3.3.2.3.3.1.2.2.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1.2.2"></sum><apply id="S3.E3.m1.2.3.3.2.3.3.1.2.3.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1.2.3"><eq id="S3.E3.m1.2.3.3.2.3.3.1.2.3.1.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1.2.3.1"></eq><ci id="S3.E3.m1.2.3.3.2.3.3.1.2.3.2.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E3.m1.2.3.3.2.3.3.1.2.3.3.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.2.3.3.2.3.3.1.3.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1.3"><plus id="S3.E3.m1.2.3.3.2.3.3.1.3.1.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1.3.1"></plus><ci id="S3.E3.m1.2.3.3.2.3.3.1.3.2.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1.3.2">𝑆</ci><cn type="integer" id="S3.E3.m1.2.3.3.2.3.3.1.3.3.cmml" xref="S3.E3.m1.2.3.3.2.3.3.1.3.3">1</cn></apply></apply><apply id="S3.E3.m1.2.3.3.2.3.3.2.cmml" xref="S3.E3.m1.2.3.3.2.3.3.2"><times id="S3.E3.m1.2.3.3.2.3.3.2.1.cmml" xref="S3.E3.m1.2.3.3.2.3.3.2.1"></times><apply id="S3.E3.m1.2.3.3.2.3.3.2.2.cmml" xref="S3.E3.m1.2.3.3.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.2.3.3.2.2.1.cmml" xref="S3.E3.m1.2.3.3.2.3.3.2.2">subscript</csymbol><ci id="S3.E3.m1.2.3.3.2.3.3.2.2.2.cmml" xref="S3.E3.m1.2.3.3.2.3.3.2.2.2">𝑅</ci><ci id="S3.E3.m1.2.3.3.2.3.3.2.2.3.cmml" xref="S3.E3.m1.2.3.3.2.3.3.2.2.3">𝑘</ci></apply><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝜃</ci></apply></apply></apply></apply><apply id="S3.E3.m1.2.3.3.3.cmml" xref="S3.E3.m1.2.3.3.3"><ci id="S3.E3.m1.2.3.3.3.1.cmml" xref="S3.E3.m1.2.3.3.3.1">⋅</ci><apply id="S3.E3.m1.2.3.3.3.2.cmml" xref="S3.E3.m1.2.3.3.3.2"><times id="S3.E3.m1.2.3.3.3.2.1.cmml" xref="S3.E3.m1.2.3.3.3.2.1"></times><ci id="S3.E3.m1.2.3.3.3.2.2.cmml" xref="S3.E3.m1.2.3.3.3.2.2">𝛿</ci><apply id="S3.E3.m1.2.3.3.3.2.3.cmml" xref="S3.E3.m1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.3.2.3.1.cmml" xref="S3.E3.m1.2.3.3.3.2.3">subscript</csymbol><ci id="S3.E3.m1.2.3.3.3.2.3.2.cmml" xref="S3.E3.m1.2.3.3.3.2.3.2">𝐺</ci><ci id="S3.E3.m1.2.3.3.3.2.3.3.cmml" xref="S3.E3.m1.2.3.3.3.2.3.3">𝑇</ci></apply></apply><apply id="S3.E3.m1.2.3.3.3.3.cmml" xref="S3.E3.m1.2.3.3.3.3"><apply id="S3.E3.m1.2.3.3.3.3.1.cmml" xref="S3.E3.m1.2.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.3.3.1.1.cmml" xref="S3.E3.m1.2.3.3.3.3.1">superscript</csymbol><apply id="S3.E3.m1.2.3.3.3.3.1.2.cmml" xref="S3.E3.m1.2.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.3.3.1.2.1.cmml" xref="S3.E3.m1.2.3.3.3.3.1">subscript</csymbol><sum id="S3.E3.m1.2.3.3.3.3.1.2.2.cmml" xref="S3.E3.m1.2.3.3.3.3.1.2.2"></sum><apply id="S3.E3.m1.2.3.3.3.3.1.2.3.cmml" xref="S3.E3.m1.2.3.3.3.3.1.2.3"><eq id="S3.E3.m1.2.3.3.3.3.1.2.3.1.cmml" xref="S3.E3.m1.2.3.3.3.3.1.2.3.1"></eq><ci id="S3.E3.m1.2.3.3.3.3.1.2.3.2.cmml" xref="S3.E3.m1.2.3.3.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E3.m1.2.3.3.3.3.1.2.3.3.cmml" xref="S3.E3.m1.2.3.3.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.2.3.3.3.3.1.3.cmml" xref="S3.E3.m1.2.3.3.3.3.1.3"><plus id="S3.E3.m1.2.3.3.3.3.1.3.1.cmml" xref="S3.E3.m1.2.3.3.3.3.1.3.1"></plus><ci id="S3.E3.m1.2.3.3.3.3.1.3.2.cmml" xref="S3.E3.m1.2.3.3.3.3.1.3.2">𝑆</ci><cn type="integer" id="S3.E3.m1.2.3.3.3.3.1.3.3.cmml" xref="S3.E3.m1.2.3.3.3.3.1.3.3">1</cn></apply></apply><apply id="S3.E3.m1.2.3.3.3.3.2.cmml" xref="S3.E3.m1.2.3.3.3.3.2"><divide id="S3.E3.m1.2.3.3.3.3.2.1.cmml" xref="S3.E3.m1.2.3.3.3.3.2"></divide><apply id="S3.E3.m1.2.3.3.3.3.2.2.cmml" xref="S3.E3.m1.2.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.3.3.3.3.2.2.1.cmml" xref="S3.E3.m1.2.3.3.3.3.2.2">subscript</csymbol><ci id="S3.E3.m1.2.3.3.3.3.2.2.2.cmml" xref="S3.E3.m1.2.3.3.3.3.2.2.2">𝐺</ci><ci id="S3.E3.m1.2.3.3.3.3.2.2.3.cmml" xref="S3.E3.m1.2.3.3.3.3.2.2.3">𝑘</ci></apply><apply id="S3.E3.m1.2.3.3.3.3.2.3.cmml" xref="S3.E3.m1.2.3.3.3.3.2.3"><plus id="S3.E3.m1.2.3.3.3.3.2.3.1.cmml" xref="S3.E3.m1.2.3.3.3.3.2.3.1"></plus><ci id="S3.E3.m1.2.3.3.3.3.2.3.2.cmml" xref="S3.E3.m1.2.3.3.3.3.2.3.2">𝑆</ci><cn type="integer" id="S3.E3.m1.2.3.3.3.3.2.3.3.cmml" xref="S3.E3.m1.2.3.3.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">R^{\texttt{StarAlign}}_{total}=R_{T}(\theta)+\frac{1}{S\!+\!1}\sum_{k=1}^{S+1}R_{k}(\theta)-\delta G_{T}\cdot\sum_{k=1}^{S+1}\frac{G_{k}}{S\!+\!1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.7" class="ltx_p">This allows us to interpret the effect of optimizing Eq. <a href="#S3.E2" title="In 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We minimize the target domain’s cost, regularized by the average cost over all domains, which mitigates overfitting the limited data <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{T}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝒟</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mathcal{D}_{T}</annotation></semantics></math>. The third term forces the average gradient over all domain data, <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\sum_{k=1}^{S+1}\frac{G_{k}}{S\!+\!1}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><msubsup id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.cmml"><mo id="S3.SS1.p3.2.m2.1.1.1.2.2" xref="S3.SS1.p3.2.m2.1.1.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p3.2.m2.1.1.1.2.3" xref="S3.SS1.p3.2.m2.1.1.1.2.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.2.3.2" xref="S3.SS1.p3.2.m2.1.1.1.2.3.2.cmml">k</mi><mo id="S3.SS1.p3.2.m2.1.1.1.2.3.1" xref="S3.SS1.p3.2.m2.1.1.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p3.2.m2.1.1.1.2.3.3" xref="S3.SS1.p3.2.m2.1.1.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p3.2.m2.1.1.1.3" xref="S3.SS1.p3.2.m2.1.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.1.3.2.cmml">S</mi><mo id="S3.SS1.p3.2.m2.1.1.1.3.1" xref="S3.SS1.p3.2.m2.1.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p3.2.m2.1.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mfrac id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml"><msub id="S3.SS1.p3.2.m2.1.1.2.2" xref="S3.SS1.p3.2.m2.1.1.2.2.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2.2.2" xref="S3.SS1.p3.2.m2.1.1.2.2.2.cmml">G</mi><mi id="S3.SS1.p3.2.m2.1.1.2.2.3" xref="S3.SS1.p3.2.m2.1.1.2.2.3.cmml">k</mi></msub><mrow id="S3.SS1.p3.2.m2.1.1.2.3" xref="S3.SS1.p3.2.m2.1.1.2.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2.3.2" xref="S3.SS1.p3.2.m2.1.1.2.3.2.cmml">S</mi><mo lspace="0.052em" rspace="0.052em" id="S3.SS1.p3.2.m2.1.1.2.3.1" xref="S3.SS1.p3.2.m2.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p3.2.m2.1.1.2.3.3" xref="S3.SS1.p3.2.m2.1.1.2.3.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><apply id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1">superscript</csymbol><apply id="S3.SS1.p3.2.m2.1.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1">subscript</csymbol><sum id="S3.SS1.p3.2.m2.1.1.1.2.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.2.2"></sum><apply id="S3.SS1.p3.2.m2.1.1.1.2.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.2.3"><eq id="S3.SS1.p3.2.m2.1.1.1.2.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.2.3.1"></eq><ci id="S3.SS1.p3.2.m2.1.1.1.2.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p3.2.m2.1.1.1.2.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p3.2.m2.1.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.3"><plus id="S3.SS1.p3.2.m2.1.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.3.1"></plus><ci id="S3.SS1.p3.2.m2.1.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.3.2">𝑆</ci><cn type="integer" id="S3.SS1.p3.2.m2.1.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2"><divide id="S3.SS1.p3.2.m2.1.1.2.1.cmml" xref="S3.SS1.p3.2.m2.1.1.2"></divide><apply id="S3.SS1.p3.2.m2.1.1.2.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.2.2.1.cmml" xref="S3.SS1.p3.2.m2.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.2.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2.2.2">𝐺</ci><ci id="S3.SS1.p3.2.m2.1.1.2.2.3.cmml" xref="S3.SS1.p3.2.m2.1.1.2.2.3">𝑘</ci></apply><apply id="S3.SS1.p3.2.m2.1.1.2.3.cmml" xref="S3.SS1.p3.2.m2.1.1.2.3"><plus id="S3.SS1.p3.2.m2.1.1.2.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.2.3.1"></plus><ci id="S3.SS1.p3.2.m2.1.1.2.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2.3.2">𝑆</ci><cn type="integer" id="S3.SS1.p3.2.m2.1.1.2.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.2.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\sum_{k=1}^{S+1}\frac{G_{k}}{S\!+\!1}</annotation></semantics></math>, to align with the gradients from the target domain <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="G_{T}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><msub id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">G</mi><mi id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">𝐺</ci><ci id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">G_{T}</annotation></semantics></math>. We clarify that domain pairs summed in Eq. <a href="#S3.E2" title="In 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> include the pair target-to-target with <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="R_{TT}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><msub id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml">R</mi><mrow id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.2" xref="S3.SS1.p3.4.m4.1.1.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.4.m4.1.1.3.1" xref="S3.SS1.p3.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.4.m4.1.1.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2">𝑅</ci><apply id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3"><times id="S3.SS1.p3.4.m4.1.1.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.1"></times><ci id="S3.SS1.p3.4.m4.1.1.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2">𝑇</ci><ci id="S3.SS1.p3.4.m4.1.1.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">R_{TT}</annotation></semantics></math> and <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="G_{T}\cdot G_{T}" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mrow id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml"><msub id="S3.SS1.p3.5.m5.1.1.2" xref="S3.SS1.p3.5.m5.1.1.2.cmml"><mi id="S3.SS1.p3.5.m5.1.1.2.2" xref="S3.SS1.p3.5.m5.1.1.2.2.cmml">G</mi><mi id="S3.SS1.p3.5.m5.1.1.2.3" xref="S3.SS1.p3.5.m5.1.1.2.3.cmml">T</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.5.m5.1.1.1" xref="S3.SS1.p3.5.m5.1.1.1.cmml">⋅</mo><msub id="S3.SS1.p3.5.m5.1.1.3" xref="S3.SS1.p3.5.m5.1.1.3.cmml"><mi id="S3.SS1.p3.5.m5.1.1.3.2" xref="S3.SS1.p3.5.m5.1.1.3.2.cmml">G</mi><mi id="S3.SS1.p3.5.m5.1.1.3.3" xref="S3.SS1.p3.5.m5.1.1.3.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><apply id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1"><ci id="S3.SS1.p3.5.m5.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1.1">⋅</ci><apply id="S3.SS1.p3.5.m5.1.1.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.2.1.cmml" xref="S3.SS1.p3.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.2.2.cmml" xref="S3.SS1.p3.5.m5.1.1.2.2">𝐺</ci><ci id="S3.SS1.p3.5.m5.1.1.2.3.cmml" xref="S3.SS1.p3.5.m5.1.1.2.3">𝑇</ci></apply><apply id="S3.SS1.p3.5.m5.1.1.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.1.1.3.1.cmml" xref="S3.SS1.p3.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.5.m5.1.1.3.2.cmml" xref="S3.SS1.p3.5.m5.1.1.3.2">𝐺</ci><ci id="S3.SS1.p3.5.m5.1.1.3.3.cmml" xref="S3.SS1.p3.5.m5.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">G_{T}\cdot G_{T}</annotation></semantics></math> terms. This ensures that the average gradient of all domains <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="\sum_{k=1}^{S+1}\frac{G_{k}}{S\!+\!1}" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><mrow id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml"><msubsup id="S3.SS1.p3.6.m6.1.1.1" xref="S3.SS1.p3.6.m6.1.1.1.cmml"><mo id="S3.SS1.p3.6.m6.1.1.1.2.2" xref="S3.SS1.p3.6.m6.1.1.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p3.6.m6.1.1.1.2.3" xref="S3.SS1.p3.6.m6.1.1.1.2.3.cmml"><mi id="S3.SS1.p3.6.m6.1.1.1.2.3.2" xref="S3.SS1.p3.6.m6.1.1.1.2.3.2.cmml">k</mi><mo id="S3.SS1.p3.6.m6.1.1.1.2.3.1" xref="S3.SS1.p3.6.m6.1.1.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p3.6.m6.1.1.1.2.3.3" xref="S3.SS1.p3.6.m6.1.1.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS1.p3.6.m6.1.1.1.3" xref="S3.SS1.p3.6.m6.1.1.1.3.cmml"><mi id="S3.SS1.p3.6.m6.1.1.1.3.2" xref="S3.SS1.p3.6.m6.1.1.1.3.2.cmml">S</mi><mo id="S3.SS1.p3.6.m6.1.1.1.3.1" xref="S3.SS1.p3.6.m6.1.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p3.6.m6.1.1.1.3.3" xref="S3.SS1.p3.6.m6.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mfrac id="S3.SS1.p3.6.m6.1.1.2" xref="S3.SS1.p3.6.m6.1.1.2.cmml"><msub id="S3.SS1.p3.6.m6.1.1.2.2" xref="S3.SS1.p3.6.m6.1.1.2.2.cmml"><mi id="S3.SS1.p3.6.m6.1.1.2.2.2" xref="S3.SS1.p3.6.m6.1.1.2.2.2.cmml">G</mi><mi id="S3.SS1.p3.6.m6.1.1.2.2.3" xref="S3.SS1.p3.6.m6.1.1.2.2.3.cmml">k</mi></msub><mrow id="S3.SS1.p3.6.m6.1.1.2.3" xref="S3.SS1.p3.6.m6.1.1.2.3.cmml"><mi id="S3.SS1.p3.6.m6.1.1.2.3.2" xref="S3.SS1.p3.6.m6.1.1.2.3.2.cmml">S</mi><mo lspace="0.052em" rspace="0.052em" id="S3.SS1.p3.6.m6.1.1.2.3.1" xref="S3.SS1.p3.6.m6.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p3.6.m6.1.1.2.3.3" xref="S3.SS1.p3.6.m6.1.1.2.3.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><apply id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1"><apply id="S3.SS1.p3.6.m6.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1">superscript</csymbol><apply id="S3.SS1.p3.6.m6.1.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.1.2.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1">subscript</csymbol><sum id="S3.SS1.p3.6.m6.1.1.1.2.2.cmml" xref="S3.SS1.p3.6.m6.1.1.1.2.2"></sum><apply id="S3.SS1.p3.6.m6.1.1.1.2.3.cmml" xref="S3.SS1.p3.6.m6.1.1.1.2.3"><eq id="S3.SS1.p3.6.m6.1.1.1.2.3.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1.2.3.1"></eq><ci id="S3.SS1.p3.6.m6.1.1.1.2.3.2.cmml" xref="S3.SS1.p3.6.m6.1.1.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS1.p3.6.m6.1.1.1.2.3.3.cmml" xref="S3.SS1.p3.6.m6.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p3.6.m6.1.1.1.3.cmml" xref="S3.SS1.p3.6.m6.1.1.1.3"><plus id="S3.SS1.p3.6.m6.1.1.1.3.1.cmml" xref="S3.SS1.p3.6.m6.1.1.1.3.1"></plus><ci id="S3.SS1.p3.6.m6.1.1.1.3.2.cmml" xref="S3.SS1.p3.6.m6.1.1.1.3.2">𝑆</ci><cn type="integer" id="S3.SS1.p3.6.m6.1.1.1.3.3.cmml" xref="S3.SS1.p3.6.m6.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p3.6.m6.1.1.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2"><divide id="S3.SS1.p3.6.m6.1.1.2.1.cmml" xref="S3.SS1.p3.6.m6.1.1.2"></divide><apply id="S3.SS1.p3.6.m6.1.1.2.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.6.m6.1.1.2.2.1.cmml" xref="S3.SS1.p3.6.m6.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p3.6.m6.1.1.2.2.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2.2.2">𝐺</ci><ci id="S3.SS1.p3.6.m6.1.1.2.2.3.cmml" xref="S3.SS1.p3.6.m6.1.1.2.2.3">𝑘</ci></apply><apply id="S3.SS1.p3.6.m6.1.1.2.3.cmml" xref="S3.SS1.p3.6.m6.1.1.2.3"><plus id="S3.SS1.p3.6.m6.1.1.2.3.1.cmml" xref="S3.SS1.p3.6.m6.1.1.2.3.1"></plus><ci id="S3.SS1.p3.6.m6.1.1.2.3.2.cmml" xref="S3.SS1.p3.6.m6.1.1.2.3.2">𝑆</ci><cn type="integer" id="S3.SS1.p3.6.m6.1.1.2.3.3.cmml" xref="S3.SS1.p3.6.m6.1.1.2.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">\sum_{k=1}^{S+1}\frac{G_{k}}{S\!+\!1}</annotation></semantics></math> in Eq. <a href="#S3.E3" title="In 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> always has a component along the direction of <math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="G_{T}" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><msub id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml"><mi id="S3.SS1.p3.7.m7.1.1.2" xref="S3.SS1.p3.7.m7.1.1.2.cmml">G</mi><mi id="S3.SS1.p3.7.m7.1.1.3" xref="S3.SS1.p3.7.m7.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><apply id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m7.1.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p3.7.m7.1.1.2.cmml" xref="S3.SS1.p3.7.m7.1.1.2">𝐺</ci><ci id="S3.SS1.p3.7.m7.1.1.3.cmml" xref="S3.SS1.p3.7.m7.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">G_{T}</annotation></semantics></math>, avoiding zero or very low dot products, for instance due to almost perpendicular gradients in high dimensional spaces, leading to smoother optimization trajectory. We found this effective in preliminary experiments.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.2" class="ltx_p">Directly optimising dot-products in Eq. <a href="#S3.E2" title="In 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> is computationally expensive as it requires second-order derivatives. Instead, minimizing Eq. <a href="#S3.E2" title="In 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> is approximated via Alg. <a href="#alg1" title="Algorithm 1 ‣ 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and first-order derivatives in <em id="S3.SS1.p4.2.1" class="ltx_emph ltx_font_italic">L4-L9</em>. This is based on the result in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> that the update step <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\beta(\hat{\theta}-\theta)" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">β</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p4.1.m1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p4.1.m1.1.1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p4.1.m1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS1.p4.1.m1.1.1.1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.2.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.2.cmml">θ</mi><mo id="S3.SS1.p4.1.m1.1.1.1.1.1.2.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.SS1.p4.1.m1.1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.3.cmml">θ</mi></mrow><mo stretchy="false" id="S3.SS1.p4.1.m1.1.1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><times id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2"></times><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">𝛽</ci><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1"><minus id="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1"></minus><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2"><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.1">^</ci><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.2">𝜃</ci></apply><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\beta(\hat{\theta}-\theta)</annotation></semantics></math> (<em id="S3.SS1.p4.2.2" class="ltx_emph ltx_font_italic">L9</em>) approximates optimisation of Eq. <a href="#S3.E2" title="In 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> for a pair of domains. <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\beta</annotation></semantics></math> is a scaling hyperparameter. This was used in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> for <em id="S3.SS1.p4.2.3" class="ltx_emph ltx_font_italic">centralised</em> multi-source <span title="" class="ltx_glossaryref">DG</span>, aligning gradients of <em id="S3.SS1.p4.2.4" class="ltx_emph ltx_font_italic">source-source</em> pairs to learn a general model (<em id="S3.SS1.p4.2.5" class="ltx_emph ltx_font_italic">no target</em>). Here, we minimize Eq. <a href="#S3.E2" title="In 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> to align <em id="S3.SS1.p4.2.6" class="ltx_emph ltx_font_italic">source-target</em> pairs of gradients and learn a <em id="S3.SS1.p4.2.7" class="ltx_emph ltx_font_italic">target-specific</em> model.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Centralised gradient alignment for source-target domain pairs</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><math id="alg1.l1.m1.1" class="ltx_Math" alttext="\theta_{T}" display="inline"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi mathsize="90%" id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">θ</mi><mi mathsize="90%" id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝜃</ci><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\theta_{T}</annotation></semantics></math><span id="alg1.l1.2" class="ltx_text" style="font-size:90%;">: Model pre-trained on source data </span><math id="alg1.l1.m2.3" class="ltx_Math" alttext="\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}" display="inline"><semantics id="alg1.l1.m2.3a"><mrow id="alg1.l1.m2.3.3.2" xref="alg1.l1.m2.3.3.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l1.m2.3.3.2.3" xref="alg1.l1.m2.3.3.3.cmml">{</mo><msub id="alg1.l1.m2.2.2.1.1" xref="alg1.l1.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l1.m2.2.2.1.1.2" xref="alg1.l1.m2.2.2.1.1.2.cmml">𝒟</mi><mn mathsize="90%" id="alg1.l1.m2.2.2.1.1.3" xref="alg1.l1.m2.2.2.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="alg1.l1.m2.3.3.2.4" xref="alg1.l1.m2.3.3.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">…</mi><mo mathsize="90%" id="alg1.l1.m2.3.3.2.5" xref="alg1.l1.m2.3.3.3.cmml">,</mo><msub id="alg1.l1.m2.3.3.2.2" xref="alg1.l1.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l1.m2.3.3.2.2.2" xref="alg1.l1.m2.3.3.2.2.2.cmml">𝒟</mi><mi mathsize="90%" id="alg1.l1.m2.3.3.2.2.3" xref="alg1.l1.m2.3.3.2.2.3.cmml">S</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l1.m2.3.3.2.6" xref="alg1.l1.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.3b"><set id="alg1.l1.m2.3.3.3.cmml" xref="alg1.l1.m2.3.3.2"><apply id="alg1.l1.m2.2.2.1.1.cmml" xref="alg1.l1.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.2.2.1.1.1.cmml" xref="alg1.l1.m2.2.2.1.1">subscript</csymbol><ci id="alg1.l1.m2.2.2.1.1.2.cmml" xref="alg1.l1.m2.2.2.1.1.2">𝒟</ci><cn type="integer" id="alg1.l1.m2.2.2.1.1.3.cmml" xref="alg1.l1.m2.2.2.1.1.3">1</cn></apply><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">…</ci><apply id="alg1.l1.m2.3.3.2.2.cmml" xref="alg1.l1.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l1.m2.3.3.2.2.1.cmml" xref="alg1.l1.m2.3.3.2.2">subscript</csymbol><ci id="alg1.l1.m2.3.3.2.2.2.cmml" xref="alg1.l1.m2.3.3.2.2.2">𝒟</ci><ci id="alg1.l1.m2.3.3.2.2.3.cmml" xref="alg1.l1.m2.3.3.2.2.3">𝑆</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.3c">\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}</annotation></semantics></math><span id="alg1.l1.3" class="ltx_text" style="font-size:90%;">, deployed to Target
</span>
</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.l2.3" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l2.m1.2" class="ltx_Math" alttext="j=1,2\dots" display="inline"><semantics id="alg1.l2.m1.2a"><mrow id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml"><mi mathsize="90%" id="alg1.l2.m1.2.2.3" xref="alg1.l2.m1.2.2.3.cmml">j</mi><mo mathsize="90%" id="alg1.l2.m1.2.2.2" xref="alg1.l2.m1.2.2.2.cmml">=</mo><mrow id="alg1.l2.m1.2.2.1.1" xref="alg1.l2.m1.2.2.1.2.cmml"><mn mathsize="90%" id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">1</mn><mo mathsize="90%" id="alg1.l2.m1.2.2.1.1.2" xref="alg1.l2.m1.2.2.1.2.cmml">,</mo><mrow id="alg1.l2.m1.2.2.1.1.1" xref="alg1.l2.m1.2.2.1.1.1.cmml"><mn mathsize="90%" id="alg1.l2.m1.2.2.1.1.1.2" xref="alg1.l2.m1.2.2.1.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="alg1.l2.m1.2.2.1.1.1.1" xref="alg1.l2.m1.2.2.1.1.1.1.cmml">​</mo><mi mathsize="90%" mathvariant="normal" id="alg1.l2.m1.2.2.1.1.1.3" xref="alg1.l2.m1.2.2.1.1.1.3.cmml">…</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><apply id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2"><eq id="alg1.l2.m1.2.2.2.cmml" xref="alg1.l2.m1.2.2.2"></eq><ci id="alg1.l2.m1.2.2.3.cmml" xref="alg1.l2.m1.2.2.3">𝑗</ci><list id="alg1.l2.m1.2.2.1.2.cmml" xref="alg1.l2.m1.2.2.1.1"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">1</cn><apply id="alg1.l2.m1.2.2.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1.1"><times id="alg1.l2.m1.2.2.1.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1.1.1"></times><cn type="integer" id="alg1.l2.m1.2.2.1.1.1.2.cmml" xref="alg1.l2.m1.2.2.1.1.1.2">2</cn><ci id="alg1.l2.m1.2.2.1.1.1.3.cmml" xref="alg1.l2.m1.2.2.1.1.1.3">…</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">j=1,2\dots</annotation></semantics></math><span id="alg1.l2.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l2.5" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l2.6" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg1.l3.2" class="ltx_text" style="font-size:90%;">    </span><span id="alg1.l3.3" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.l3.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l3.m1.4" class="ltx_Math" alttext="\mathcal{D}_{k}\in\{\mathcal{D}_{1},\dots,\mathcal{D}_{S},\mathcal{D}_{T}\}" display="inline"><semantics id="alg1.l3.m1.4a"><mrow id="alg1.l3.m1.4.4" xref="alg1.l3.m1.4.4.cmml"><msub id="alg1.l3.m1.4.4.5" xref="alg1.l3.m1.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l3.m1.4.4.5.2" xref="alg1.l3.m1.4.4.5.2.cmml">𝒟</mi><mi mathsize="90%" id="alg1.l3.m1.4.4.5.3" xref="alg1.l3.m1.4.4.5.3.cmml">k</mi></msub><mo mathsize="90%" id="alg1.l3.m1.4.4.4" xref="alg1.l3.m1.4.4.4.cmml">∈</mo><mrow id="alg1.l3.m1.4.4.3.3" xref="alg1.l3.m1.4.4.3.4.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l3.m1.4.4.3.3.4" xref="alg1.l3.m1.4.4.3.4.cmml">{</mo><msub id="alg1.l3.m1.2.2.1.1.1" xref="alg1.l3.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l3.m1.2.2.1.1.1.2" xref="alg1.l3.m1.2.2.1.1.1.2.cmml">𝒟</mi><mn mathsize="90%" id="alg1.l3.m1.2.2.1.1.1.3" xref="alg1.l3.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="alg1.l3.m1.4.4.3.3.5" xref="alg1.l3.m1.4.4.3.4.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">…</mi><mo mathsize="90%" id="alg1.l3.m1.4.4.3.3.6" xref="alg1.l3.m1.4.4.3.4.cmml">,</mo><msub id="alg1.l3.m1.3.3.2.2.2" xref="alg1.l3.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l3.m1.3.3.2.2.2.2" xref="alg1.l3.m1.3.3.2.2.2.2.cmml">𝒟</mi><mi mathsize="90%" id="alg1.l3.m1.3.3.2.2.2.3" xref="alg1.l3.m1.3.3.2.2.2.3.cmml">S</mi></msub><mo mathsize="90%" id="alg1.l3.m1.4.4.3.3.7" xref="alg1.l3.m1.4.4.3.4.cmml">,</mo><msub id="alg1.l3.m1.4.4.3.3.3" xref="alg1.l3.m1.4.4.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l3.m1.4.4.3.3.3.2" xref="alg1.l3.m1.4.4.3.3.3.2.cmml">𝒟</mi><mi mathsize="90%" id="alg1.l3.m1.4.4.3.3.3.3" xref="alg1.l3.m1.4.4.3.3.3.3.cmml">T</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l3.m1.4.4.3.3.8" xref="alg1.l3.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.4b"><apply id="alg1.l3.m1.4.4.cmml" xref="alg1.l3.m1.4.4"><in id="alg1.l3.m1.4.4.4.cmml" xref="alg1.l3.m1.4.4.4"></in><apply id="alg1.l3.m1.4.4.5.cmml" xref="alg1.l3.m1.4.4.5"><csymbol cd="ambiguous" id="alg1.l3.m1.4.4.5.1.cmml" xref="alg1.l3.m1.4.4.5">subscript</csymbol><ci id="alg1.l3.m1.4.4.5.2.cmml" xref="alg1.l3.m1.4.4.5.2">𝒟</ci><ci id="alg1.l3.m1.4.4.5.3.cmml" xref="alg1.l3.m1.4.4.5.3">𝑘</ci></apply><set id="alg1.l3.m1.4.4.3.4.cmml" xref="alg1.l3.m1.4.4.3.3"><apply id="alg1.l3.m1.2.2.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.2.2.1.1.1.2.cmml" xref="alg1.l3.m1.2.2.1.1.1.2">𝒟</ci><cn type="integer" id="alg1.l3.m1.2.2.1.1.1.3.cmml" xref="alg1.l3.m1.2.2.1.1.1.3">1</cn></apply><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">…</ci><apply id="alg1.l3.m1.3.3.2.2.2.cmml" xref="alg1.l3.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.3.3.2.2.2.1.cmml" xref="alg1.l3.m1.3.3.2.2.2">subscript</csymbol><ci id="alg1.l3.m1.3.3.2.2.2.2.cmml" xref="alg1.l3.m1.3.3.2.2.2.2">𝒟</ci><ci id="alg1.l3.m1.3.3.2.2.2.3.cmml" xref="alg1.l3.m1.3.3.2.2.2.3">𝑆</ci></apply><apply id="alg1.l3.m1.4.4.3.3.3.cmml" xref="alg1.l3.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.4.4.3.3.3.1.cmml" xref="alg1.l3.m1.4.4.3.3.3">subscript</csymbol><ci id="alg1.l3.m1.4.4.3.3.3.2.cmml" xref="alg1.l3.m1.4.4.3.3.3.2">𝒟</ci><ci id="alg1.l3.m1.4.4.3.3.3.3.cmml" xref="alg1.l3.m1.4.4.3.3.3.3">𝑇</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.4c">\mathcal{D}_{k}\in\{\mathcal{D}_{1},\dots,\mathcal{D}_{S},\mathcal{D}_{T}\}</annotation></semantics></math><span id="alg1.l3.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l3.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l3.7" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.2.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg1.l4.3" class="ltx_text" style="font-size:90%;">         </span><math id="alg1.l4.m1.1" class="ltx_Math" alttext="\hat{\theta}_{k}\leftarrow\theta_{T}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mover accent="true" id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml"><mi mathsize="90%" id="alg1.l4.m1.1.1.2.2.2" xref="alg1.l4.m1.1.1.2.2.2.cmml">θ</mi><mo mathsize="90%" id="alg1.l4.m1.1.1.2.2.1" xref="alg1.l4.m1.1.1.2.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml">k</mi></msub><mo mathsize="90%" stretchy="false" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">←</mo><msub id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi mathsize="90%" id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">θ</mi><mi mathsize="90%" id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">←</ci><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2">subscript</csymbol><apply id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2"><ci id="alg1.l4.m1.1.1.2.2.1.cmml" xref="alg1.l4.m1.1.1.2.2.1">^</ci><ci id="alg1.l4.m1.1.1.2.2.2.cmml" xref="alg1.l4.m1.1.1.2.2.2">𝜃</ci></apply><ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">𝜃</ci><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\hat{\theta}_{k}\leftarrow\theta_{T}</annotation></semantics></math><span id="alg1.l4.4" class="ltx_text" style="font-size:90%;">; </span><math id="alg1.l4.m2.1" class="ltx_Math" alttext="\theta_{k}\leftarrow\theta_{T}" display="inline"><semantics id="alg1.l4.m2.1a"><mrow id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><msub id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml"><mi mathsize="90%" id="alg1.l4.m2.1.1.2.2" xref="alg1.l4.m2.1.1.2.2.cmml">θ</mi><mi mathsize="90%" id="alg1.l4.m2.1.1.2.3" xref="alg1.l4.m2.1.1.2.3.cmml">k</mi></msub><mo mathsize="90%" stretchy="false" id="alg1.l4.m2.1.1.1" xref="alg1.l4.m2.1.1.1.cmml">←</mo><msub id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml"><mi mathsize="90%" id="alg1.l4.m2.1.1.3.2" xref="alg1.l4.m2.1.1.3.2.cmml">θ</mi><mi mathsize="90%" id="alg1.l4.m2.1.1.3.3" xref="alg1.l4.m2.1.1.3.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><ci id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1.1">←</ci><apply id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.2.1.cmml" xref="alg1.l4.m2.1.1.2">subscript</csymbol><ci id="alg1.l4.m2.1.1.2.2.cmml" xref="alg1.l4.m2.1.1.2.2">𝜃</ci><ci id="alg1.l4.m2.1.1.2.3.cmml" xref="alg1.l4.m2.1.1.2.3">𝑘</ci></apply><apply id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.3.1.cmml" xref="alg1.l4.m2.1.1.3">subscript</csymbol><ci id="alg1.l4.m2.1.1.3.2.cmml" xref="alg1.l4.m2.1.1.3.2">𝜃</ci><ci id="alg1.l4.m2.1.1.3.3.cmml" xref="alg1.l4.m2.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\theta_{k}\leftarrow\theta_{T}</annotation></semantics></math><span id="alg1.l4.5" class="ltx_text" style="font-size:90%;">    </span><math id="alg1.l4.m3.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg1.l4.m3.1a"><mrow id="alg1.l4.m3.1.1" xref="alg1.l4.m3.1.1.cmml"><mrow id="alg1.l4.m3.1.1.2" xref="alg1.l4.m3.1.1.2a.cmml"></mrow><mo mathsize="90%" id="alg1.l4.m3.1.1.3" xref="alg1.l4.m3.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m3.1b"><apply id="alg1.l4.m3.1.1.cmml" xref="alg1.l4.m3.1.1"><csymbol cd="latexml" id="alg1.l4.m3.1.1.1.cmml" xref="alg1.l4.m3.1.1">limit-from</csymbol><ci id="alg1.l4.m3.1.1.2a.cmml" xref="alg1.l4.m3.1.1.2"><mrow id="alg1.l4.m3.1.1.2.cmml" xref="alg1.l4.m3.1.1.2"></mrow></ci><ci id="alg1.l4.m3.1.1.3.cmml" xref="alg1.l4.m3.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m3.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math><span id="alg1.l4.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l4.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">Create copies of deployed model <math id="alg1.l4.1.m1.1" class="ltx_Math" alttext="\theta_{T}" display="inline"><semantics id="alg1.l4.1.m1.1a"><msub id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml"><mi id="alg1.l4.1.m1.1.1.2" xref="alg1.l4.1.m1.1.1.2.cmml">θ</mi><mi id="alg1.l4.1.m1.1.1.3" xref="alg1.l4.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><apply id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.1.m1.1.1.1.cmml" xref="alg1.l4.1.m1.1.1">subscript</csymbol><ci id="alg1.l4.1.m1.1.1.2.cmml" xref="alg1.l4.1.m1.1.1.2">𝜃</ci><ci id="alg1.l4.1.m1.1.1.3.cmml" xref="alg1.l4.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">\theta_{T}</annotation></semantics></math></span><span id="alg1.l4.7" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.2.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg1.l5.3" class="ltx_text" style="font-size:90%;">         </span><math id="alg1.l5.m1.1" class="ltx_Math" alttext="d_{T}\sim\mathcal{D}_{T}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi mathsize="90%" id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">d</mi><mi mathsize="90%" id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">T</mi></msub><mo mathsize="90%" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">∼</mo><msub id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">𝒟</mi><mi mathsize="90%" id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="latexml" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">similar-to</csymbol><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝑑</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑇</ci></apply><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">𝒟</ci><ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">d_{T}\sim\mathcal{D}_{T}</annotation></semantics></math><span id="alg1.l5.4" class="ltx_text" style="font-size:90%;">        </span><math id="alg1.l5.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mrow id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2a.cmml"></mrow><mo mathsize="90%" id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="latexml" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">limit-from</csymbol><ci id="alg1.l5.m2.1.1.2a.cmml" xref="alg1.l5.m2.1.1.2"><mrow id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2"></mrow></ci><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math><span id="alg1.l5.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">Sample batch from domain <math id="alg1.l5.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l5.1.m1.1a"><mi id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">T</annotation></semantics></math></span><span id="alg1.l5.6" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.2.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg1.l6.3" class="ltx_text" style="font-size:90%;">         </span><math id="alg1.l6.m1.2" class="ltx_Math" alttext="\hat{\theta}_{k}\!\leftarrow\!\hat{\theta}_{k}-\alpha\nabla_{\hat{\theta}_{k}}\mathcal{L}(\hat{\theta}_{k};d_{T})" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml"><msub id="alg1.l6.m1.2.2.4" xref="alg1.l6.m1.2.2.4.cmml"><mover accent="true" id="alg1.l6.m1.2.2.4.2" xref="alg1.l6.m1.2.2.4.2.cmml"><mi mathsize="90%" id="alg1.l6.m1.2.2.4.2.2" xref="alg1.l6.m1.2.2.4.2.2.cmml">θ</mi><mo mathsize="90%" id="alg1.l6.m1.2.2.4.2.1" xref="alg1.l6.m1.2.2.4.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l6.m1.2.2.4.3" xref="alg1.l6.m1.2.2.4.3.cmml">k</mi></msub><mo lspace="0.108em" mathsize="90%" rspace="0.108em" stretchy="false" id="alg1.l6.m1.2.2.3" xref="alg1.l6.m1.2.2.3.cmml">←</mo><mrow id="alg1.l6.m1.2.2.2" xref="alg1.l6.m1.2.2.2.cmml"><msub id="alg1.l6.m1.2.2.2.4" xref="alg1.l6.m1.2.2.2.4.cmml"><mover accent="true" id="alg1.l6.m1.2.2.2.4.2" xref="alg1.l6.m1.2.2.2.4.2.cmml"><mi mathsize="90%" id="alg1.l6.m1.2.2.2.4.2.2" xref="alg1.l6.m1.2.2.2.4.2.2.cmml">θ</mi><mo mathsize="90%" id="alg1.l6.m1.2.2.2.4.2.1" xref="alg1.l6.m1.2.2.2.4.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l6.m1.2.2.2.4.3" xref="alg1.l6.m1.2.2.2.4.3.cmml">k</mi></msub><mo mathsize="90%" id="alg1.l6.m1.2.2.2.3" xref="alg1.l6.m1.2.2.2.3.cmml">−</mo><mrow id="alg1.l6.m1.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l6.m1.2.2.2.2.4" xref="alg1.l6.m1.2.2.2.2.4.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="alg1.l6.m1.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l6.m1.2.2.2.2.5" xref="alg1.l6.m1.2.2.2.2.5.cmml"><msub id="alg1.l6.m1.2.2.2.2.5.1" xref="alg1.l6.m1.2.2.2.2.5.1.cmml"><mo mathsize="90%" rspace="0.167em" id="alg1.l6.m1.2.2.2.2.5.1.2" xref="alg1.l6.m1.2.2.2.2.5.1.2.cmml">∇</mo><msub id="alg1.l6.m1.2.2.2.2.5.1.3" xref="alg1.l6.m1.2.2.2.2.5.1.3.cmml"><mover accent="true" id="alg1.l6.m1.2.2.2.2.5.1.3.2" xref="alg1.l6.m1.2.2.2.2.5.1.3.2.cmml"><mi mathsize="90%" id="alg1.l6.m1.2.2.2.2.5.1.3.2.2" xref="alg1.l6.m1.2.2.2.2.5.1.3.2.2.cmml">θ</mi><mo mathsize="90%" id="alg1.l6.m1.2.2.2.2.5.1.3.2.1" xref="alg1.l6.m1.2.2.2.2.5.1.3.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l6.m1.2.2.2.2.5.1.3.3" xref="alg1.l6.m1.2.2.2.2.5.1.3.3.cmml">k</mi></msub></msub><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l6.m1.2.2.2.2.5.2" xref="alg1.l6.m1.2.2.2.2.5.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.2.2.3a" xref="alg1.l6.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l6.m1.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l6.m1.2.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.3.cmml">(</mo><msub id="alg1.l6.m1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l6.m1.1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mo mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.1.1.2.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l6.m1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo mathsize="90%" id="alg1.l6.m1.2.2.2.2.2.2.4" xref="alg1.l6.m1.2.2.2.2.2.3.cmml">;</mo><msub id="alg1.l6.m1.2.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l6.m1.2.2.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.2.2.cmml">d</mi><mi mathsize="90%" id="alg1.l6.m1.2.2.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.2.2.3.cmml">T</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l6.m1.2.2.2.2.2.2.5" xref="alg1.l6.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2"><ci id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.3">←</ci><apply id="alg1.l6.m1.2.2.4.cmml" xref="alg1.l6.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.4.1.cmml" xref="alg1.l6.m1.2.2.4">subscript</csymbol><apply id="alg1.l6.m1.2.2.4.2.cmml" xref="alg1.l6.m1.2.2.4.2"><ci id="alg1.l6.m1.2.2.4.2.1.cmml" xref="alg1.l6.m1.2.2.4.2.1">^</ci><ci id="alg1.l6.m1.2.2.4.2.2.cmml" xref="alg1.l6.m1.2.2.4.2.2">𝜃</ci></apply><ci id="alg1.l6.m1.2.2.4.3.cmml" xref="alg1.l6.m1.2.2.4.3">𝑘</ci></apply><apply id="alg1.l6.m1.2.2.2.cmml" xref="alg1.l6.m1.2.2.2"><minus id="alg1.l6.m1.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.3"></minus><apply id="alg1.l6.m1.2.2.2.4.cmml" xref="alg1.l6.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.4.1.cmml" xref="alg1.l6.m1.2.2.2.4">subscript</csymbol><apply id="alg1.l6.m1.2.2.2.4.2.cmml" xref="alg1.l6.m1.2.2.2.4.2"><ci id="alg1.l6.m1.2.2.2.4.2.1.cmml" xref="alg1.l6.m1.2.2.2.4.2.1">^</ci><ci id="alg1.l6.m1.2.2.2.4.2.2.cmml" xref="alg1.l6.m1.2.2.2.4.2.2">𝜃</ci></apply><ci id="alg1.l6.m1.2.2.2.4.3.cmml" xref="alg1.l6.m1.2.2.2.4.3">𝑘</ci></apply><apply id="alg1.l6.m1.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2"><times id="alg1.l6.m1.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.3"></times><ci id="alg1.l6.m1.2.2.2.2.4.cmml" xref="alg1.l6.m1.2.2.2.2.4">𝛼</ci><apply id="alg1.l6.m1.2.2.2.2.5.cmml" xref="alg1.l6.m1.2.2.2.2.5"><apply id="alg1.l6.m1.2.2.2.2.5.1.cmml" xref="alg1.l6.m1.2.2.2.2.5.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.5.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.5.1">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.5.1.2.cmml" xref="alg1.l6.m1.2.2.2.2.5.1.2">∇</ci><apply id="alg1.l6.m1.2.2.2.2.5.1.3.cmml" xref="alg1.l6.m1.2.2.2.2.5.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.5.1.3.1.cmml" xref="alg1.l6.m1.2.2.2.2.5.1.3">subscript</csymbol><apply id="alg1.l6.m1.2.2.2.2.5.1.3.2.cmml" xref="alg1.l6.m1.2.2.2.2.5.1.3.2"><ci id="alg1.l6.m1.2.2.2.2.5.1.3.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.5.1.3.2.1">^</ci><ci id="alg1.l6.m1.2.2.2.2.5.1.3.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.5.1.3.2.2">𝜃</ci></apply><ci id="alg1.l6.m1.2.2.2.2.5.1.3.3.cmml" xref="alg1.l6.m1.2.2.2.2.5.1.3.3">𝑘</ci></apply></apply><ci id="alg1.l6.m1.2.2.2.2.5.2.cmml" xref="alg1.l6.m1.2.2.2.2.5.2">ℒ</ci></apply><list id="alg1.l6.m1.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.2"><apply id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2"><ci id="alg1.l6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.1">^</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.2">𝜃</ci></apply><ci id="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l6.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.2.2">𝑑</ci><ci id="alg1.l6.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.2.3">𝑇</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">\hat{\theta}_{k}\!\leftarrow\!\hat{\theta}_{k}-\alpha\nabla_{\hat{\theta}_{k}}\mathcal{L}(\hat{\theta}_{k};d_{T})</annotation></semantics></math><span id="alg1.l6.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l6.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg1.l6.m2.1a"><mrow id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mrow id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2a.cmml"></mrow><mo mathsize="90%" id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="latexml" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">limit-from</csymbol><ci id="alg1.l6.m2.1.1.2a.cmml" xref="alg1.l6.m2.1.1.2"><mrow id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2"></mrow></ci><ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math><span id="alg1.l6.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l6.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">Compute gradient of <math id="alg1.l6.1.m1.1" class="ltx_Math" alttext="d_{T}" display="inline"><semantics id="alg1.l6.1.m1.1a"><msub id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml"><mi id="alg1.l6.1.m1.1.1.2" xref="alg1.l6.1.m1.1.1.2.cmml">d</mi><mi id="alg1.l6.1.m1.1.1.3" xref="alg1.l6.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><apply id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.1.m1.1.1.1.cmml" xref="alg1.l6.1.m1.1.1">subscript</csymbol><ci id="alg1.l6.1.m1.1.1.2.cmml" xref="alg1.l6.1.m1.1.1.2">𝑑</ci><ci id="alg1.l6.1.m1.1.1.3.cmml" xref="alg1.l6.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">d_{T}</annotation></semantics></math> and update model</span><span id="alg1.l6.6" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.2.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg1.l7.3" class="ltx_text" style="font-size:90%;">         </span><math id="alg1.l7.m1.1" class="ltx_Math" alttext="d_{k}\sim\mathcal{D}_{k}" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msub id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi mathsize="90%" id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">d</mi><mi mathsize="90%" id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">k</mi></msub><mo mathsize="90%" id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">∼</mo><msub id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">𝒟</mi><mi mathsize="90%" id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="latexml" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">similar-to</csymbol><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝑑</ci><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3">subscript</csymbol><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">𝒟</ci><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">d_{k}\sim\mathcal{D}_{k}</annotation></semantics></math><span id="alg1.l7.4" class="ltx_text" style="font-size:90%;">         </span><math id="alg1.l7.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg1.l7.m2.1a"><mrow id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml"><mrow id="alg1.l7.m2.1.1.2" xref="alg1.l7.m2.1.1.2a.cmml"></mrow><mo mathsize="90%" id="alg1.l7.m2.1.1.3" xref="alg1.l7.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1"><csymbol cd="latexml" id="alg1.l7.m2.1.1.1.cmml" xref="alg1.l7.m2.1.1">limit-from</csymbol><ci id="alg1.l7.m2.1.1.2a.cmml" xref="alg1.l7.m2.1.1.2"><mrow id="alg1.l7.m2.1.1.2.cmml" xref="alg1.l7.m2.1.1.2"></mrow></ci><ci id="alg1.l7.m2.1.1.3.cmml" xref="alg1.l7.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math><span id="alg1.l7.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l7.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">Sample batch from domain <math id="alg1.l7.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l7.1.m1.1a"><mi id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">k</annotation></semantics></math></span><span id="alg1.l7.6" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.2.1.1" class="ltx_text" style="font-size:80%;">8:</span></span><span id="alg1.l8.3" class="ltx_text" style="font-size:90%;">         </span><math id="alg1.l8.m1.2" class="ltx_Math" alttext="\hat{\theta}_{k}\!\leftarrow\hat{\theta}_{k}-\alpha\nabla_{\hat{\theta}_{k}}\mathcal{L}(\hat{\theta}_{k};d_{k})" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml"><msub id="alg1.l8.m1.2.2.4" xref="alg1.l8.m1.2.2.4.cmml"><mover accent="true" id="alg1.l8.m1.2.2.4.2" xref="alg1.l8.m1.2.2.4.2.cmml"><mi mathsize="90%" id="alg1.l8.m1.2.2.4.2.2" xref="alg1.l8.m1.2.2.4.2.2.cmml">θ</mi><mo mathsize="90%" id="alg1.l8.m1.2.2.4.2.1" xref="alg1.l8.m1.2.2.4.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l8.m1.2.2.4.3" xref="alg1.l8.m1.2.2.4.3.cmml">k</mi></msub><mo lspace="0.108em" mathsize="90%" stretchy="false" id="alg1.l8.m1.2.2.3" xref="alg1.l8.m1.2.2.3.cmml">←</mo><mrow id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.2.cmml"><msub id="alg1.l8.m1.2.2.2.4" xref="alg1.l8.m1.2.2.2.4.cmml"><mover accent="true" id="alg1.l8.m1.2.2.2.4.2" xref="alg1.l8.m1.2.2.2.4.2.cmml"><mi mathsize="90%" id="alg1.l8.m1.2.2.2.4.2.2" xref="alg1.l8.m1.2.2.2.4.2.2.cmml">θ</mi><mo mathsize="90%" id="alg1.l8.m1.2.2.2.4.2.1" xref="alg1.l8.m1.2.2.2.4.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l8.m1.2.2.2.4.3" xref="alg1.l8.m1.2.2.2.4.3.cmml">k</mi></msub><mo mathsize="90%" id="alg1.l8.m1.2.2.2.3" xref="alg1.l8.m1.2.2.2.3.cmml">−</mo><mrow id="alg1.l8.m1.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l8.m1.2.2.2.2.4" xref="alg1.l8.m1.2.2.2.2.4.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="alg1.l8.m1.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l8.m1.2.2.2.2.5" xref="alg1.l8.m1.2.2.2.2.5.cmml"><msub id="alg1.l8.m1.2.2.2.2.5.1" xref="alg1.l8.m1.2.2.2.2.5.1.cmml"><mo mathsize="90%" rspace="0.167em" id="alg1.l8.m1.2.2.2.2.5.1.2" xref="alg1.l8.m1.2.2.2.2.5.1.2.cmml">∇</mo><msub id="alg1.l8.m1.2.2.2.2.5.1.3" xref="alg1.l8.m1.2.2.2.2.5.1.3.cmml"><mover accent="true" id="alg1.l8.m1.2.2.2.2.5.1.3.2" xref="alg1.l8.m1.2.2.2.2.5.1.3.2.cmml"><mi mathsize="90%" id="alg1.l8.m1.2.2.2.2.5.1.3.2.2" xref="alg1.l8.m1.2.2.2.2.5.1.3.2.2.cmml">θ</mi><mo mathsize="90%" id="alg1.l8.m1.2.2.2.2.5.1.3.2.1" xref="alg1.l8.m1.2.2.2.2.5.1.3.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l8.m1.2.2.2.2.5.1.3.3" xref="alg1.l8.m1.2.2.2.2.5.1.3.3.cmml">k</mi></msub></msub><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="alg1.l8.m1.2.2.2.2.5.2" xref="alg1.l8.m1.2.2.2.2.5.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.2.3a" xref="alg1.l8.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l8.m1.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l8.m1.2.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.3.cmml">(</mo><msub id="alg1.l8.m1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l8.m1.1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="alg1.l8.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mo mathsize="90%" id="alg1.l8.m1.1.1.1.1.1.1.1.2.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l8.m1.1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo mathsize="90%" id="alg1.l8.m1.2.2.2.2.2.2.4" xref="alg1.l8.m1.2.2.2.2.2.3.cmml">;</mo><msub id="alg1.l8.m1.2.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="alg1.l8.m1.2.2.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.2.2.cmml">d</mi><mi mathsize="90%" id="alg1.l8.m1.2.2.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.2.2.3.cmml">k</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l8.m1.2.2.2.2.2.2.5" xref="alg1.l8.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"><ci id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2.3">←</ci><apply id="alg1.l8.m1.2.2.4.cmml" xref="alg1.l8.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.4.1.cmml" xref="alg1.l8.m1.2.2.4">subscript</csymbol><apply id="alg1.l8.m1.2.2.4.2.cmml" xref="alg1.l8.m1.2.2.4.2"><ci id="alg1.l8.m1.2.2.4.2.1.cmml" xref="alg1.l8.m1.2.2.4.2.1">^</ci><ci id="alg1.l8.m1.2.2.4.2.2.cmml" xref="alg1.l8.m1.2.2.4.2.2">𝜃</ci></apply><ci id="alg1.l8.m1.2.2.4.3.cmml" xref="alg1.l8.m1.2.2.4.3">𝑘</ci></apply><apply id="alg1.l8.m1.2.2.2.cmml" xref="alg1.l8.m1.2.2.2"><minus id="alg1.l8.m1.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.3"></minus><apply id="alg1.l8.m1.2.2.2.4.cmml" xref="alg1.l8.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.4.1.cmml" xref="alg1.l8.m1.2.2.2.4">subscript</csymbol><apply id="alg1.l8.m1.2.2.2.4.2.cmml" xref="alg1.l8.m1.2.2.2.4.2"><ci id="alg1.l8.m1.2.2.2.4.2.1.cmml" xref="alg1.l8.m1.2.2.2.4.2.1">^</ci><ci id="alg1.l8.m1.2.2.2.4.2.2.cmml" xref="alg1.l8.m1.2.2.2.4.2.2">𝜃</ci></apply><ci id="alg1.l8.m1.2.2.2.4.3.cmml" xref="alg1.l8.m1.2.2.2.4.3">𝑘</ci></apply><apply id="alg1.l8.m1.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2"><times id="alg1.l8.m1.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.3"></times><ci id="alg1.l8.m1.2.2.2.2.4.cmml" xref="alg1.l8.m1.2.2.2.2.4">𝛼</ci><apply id="alg1.l8.m1.2.2.2.2.5.cmml" xref="alg1.l8.m1.2.2.2.2.5"><apply id="alg1.l8.m1.2.2.2.2.5.1.cmml" xref="alg1.l8.m1.2.2.2.2.5.1"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.5.1.1.cmml" xref="alg1.l8.m1.2.2.2.2.5.1">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.5.1.2.cmml" xref="alg1.l8.m1.2.2.2.2.5.1.2">∇</ci><apply id="alg1.l8.m1.2.2.2.2.5.1.3.cmml" xref="alg1.l8.m1.2.2.2.2.5.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.5.1.3.1.cmml" xref="alg1.l8.m1.2.2.2.2.5.1.3">subscript</csymbol><apply id="alg1.l8.m1.2.2.2.2.5.1.3.2.cmml" xref="alg1.l8.m1.2.2.2.2.5.1.3.2"><ci id="alg1.l8.m1.2.2.2.2.5.1.3.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.5.1.3.2.1">^</ci><ci id="alg1.l8.m1.2.2.2.2.5.1.3.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.5.1.3.2.2">𝜃</ci></apply><ci id="alg1.l8.m1.2.2.2.2.5.1.3.3.cmml" xref="alg1.l8.m1.2.2.2.2.5.1.3.3">𝑘</ci></apply></apply><ci id="alg1.l8.m1.2.2.2.2.5.2.cmml" xref="alg1.l8.m1.2.2.2.2.5.2">ℒ</ci></apply><list id="alg1.l8.m1.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.2"><apply id="alg1.l8.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l8.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2"><ci id="alg1.l8.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.1">^</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.2.2">𝜃</ci></apply><ci id="alg1.l8.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l8.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2.2">𝑑</ci><ci id="alg1.l8.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2.3">𝑘</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">\hat{\theta}_{k}\!\leftarrow\hat{\theta}_{k}-\alpha\nabla_{\hat{\theta}_{k}}\mathcal{L}(\hat{\theta}_{k};d_{k})</annotation></semantics></math><span id="alg1.l8.4" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l8.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg1.l8.m2.1a"><mrow id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml"><mrow id="alg1.l8.m2.1.1.2" xref="alg1.l8.m2.1.1.2a.cmml"></mrow><mo mathsize="90%" id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"><csymbol cd="latexml" id="alg1.l8.m2.1.1.1.cmml" xref="alg1.l8.m2.1.1">limit-from</csymbol><ci id="alg1.l8.m2.1.1.2a.cmml" xref="alg1.l8.m2.1.1.2"><mrow id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1.2"></mrow></ci><ci id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math><span id="alg1.l8.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l8.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">Compute gradient of <math id="alg1.l8.1.m1.1" class="ltx_Math" alttext="d_{k}" display="inline"><semantics id="alg1.l8.1.m1.1a"><msub id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml"><mi id="alg1.l8.1.m1.1.1.2" xref="alg1.l8.1.m1.1.1.2.cmml">d</mi><mi id="alg1.l8.1.m1.1.1.3" xref="alg1.l8.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><apply id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.1.m1.1.1.1.cmml" xref="alg1.l8.1.m1.1.1">subscript</csymbol><ci id="alg1.l8.1.m1.1.1.2.cmml" xref="alg1.l8.1.m1.1.1.2">𝑑</ci><ci id="alg1.l8.1.m1.1.1.3.cmml" xref="alg1.l8.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">d_{k}</annotation></semantics></math> and update model</span><span id="alg1.l8.6" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg1.l9.2" class="ltx_text" style="font-size:90%;">         </span><math id="alg1.l9.m1.1" class="ltx_Math" alttext="\theta_{k}\leftarrow\theta_{k}+\beta(\hat{\theta}_{k}-\theta_{k})" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi mathsize="90%" id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">θ</mi><mi mathsize="90%" id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">k</mi></msub><mo mathsize="90%" stretchy="false" id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">←</mo><mrow id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml"><msub id="alg1.l9.m1.1.1.1.3" xref="alg1.l9.m1.1.1.1.3.cmml"><mi mathsize="90%" id="alg1.l9.m1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.3.2.cmml">θ</mi><mi mathsize="90%" id="alg1.l9.m1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.3.3.cmml">k</mi></msub><mo mathsize="90%" id="alg1.l9.m1.1.1.1.2" xref="alg1.l9.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l9.m1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.3.cmml">β</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l9.m1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l9.m1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l9.m1.1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="alg1.l9.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.2.cmml"><mi mathsize="90%" id="alg1.l9.m1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.2.2.cmml">θ</mi><mo mathsize="90%" id="alg1.l9.m1.1.1.1.1.1.1.1.2.2.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi mathsize="90%" id="alg1.l9.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo mathsize="90%" id="alg1.l9.m1.1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l9.m1.1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="alg1.l9.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.1.1.1.1.3.2.cmml">θ</mi><mi mathsize="90%" id="alg1.l9.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo maxsize="90%" minsize="90%" id="alg1.l9.m1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">←</ci><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝜃</ci><ci id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">𝑘</ci></apply><apply id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"><plus id="alg1.l9.m1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.2"></plus><apply id="alg1.l9.m1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.3.2">𝜃</ci><ci id="alg1.l9.m1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.3.3">𝑘</ci></apply><apply id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1"><times id="alg1.l9.m1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.2"></times><ci id="alg1.l9.m1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.3">𝛽</ci><apply id="alg1.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1"><minus id="alg1.l9.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1"></minus><apply id="alg1.l9.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.2"><ci id="alg1.l9.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.2.2">𝜃</ci></apply><ci id="alg1.l9.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l9.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.3.2">𝜃</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\theta_{k}\leftarrow\theta_{k}+\beta(\hat{\theta}_{k}-\theta_{k})</annotation></semantics></math><span id="alg1.l9.3" class="ltx_text" style="font-size:90%;">    </span><math id="alg1.l9.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg1.l9.m2.1a"><mrow id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mrow id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2a.cmml"></mrow><mo mathsize="90%" id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="latexml" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">limit-from</csymbol><ci id="alg1.l9.m2.1.1.2a.cmml" xref="alg1.l9.m2.1.1.2"><mrow id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2"></mrow></ci><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math><span id="alg1.l9.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l9.5" class="ltx_text ltx_font_typewriter" style="font-size:90%;">1st order approximation update</span><span id="alg1.l9.6" class="ltx_text" style="font-size:90%;">
    </span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg1.l10.2" class="ltx_text" style="font-size:90%;">    </span><math id="alg1.l10.m1.1" class="ltx_Math" alttext="\theta_{T}\leftarrow\frac{1}{S+1}\sum_{k=1}^{S+1}\theta_{k}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msub id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi mathsize="90%" id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">θ</mi><mi mathsize="90%" id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">T</mi></msub><mo mathsize="90%" stretchy="false" id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">←</mo><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mfrac id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml"><mn mathsize="90%" id="alg1.l10.m1.1.1.3.2.2" xref="alg1.l10.m1.1.1.3.2.2.cmml">1</mn><mrow id="alg1.l10.m1.1.1.3.2.3" xref="alg1.l10.m1.1.1.3.2.3.cmml"><mi mathsize="90%" id="alg1.l10.m1.1.1.3.2.3.2" xref="alg1.l10.m1.1.1.3.2.3.2.cmml">S</mi><mo mathsize="90%" id="alg1.l10.m1.1.1.3.2.3.1" xref="alg1.l10.m1.1.1.3.2.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l10.m1.1.1.3.2.3.3" xref="alg1.l10.m1.1.1.3.2.3.3.cmml">1</mn></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">​</mo><mrow id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml"><msubsup id="alg1.l10.m1.1.1.3.3.1" xref="alg1.l10.m1.1.1.3.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="alg1.l10.m1.1.1.3.3.1.2.2" xref="alg1.l10.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l10.m1.1.1.3.3.1.2.3" xref="alg1.l10.m1.1.1.3.3.1.2.3.cmml"><mi mathsize="90%" id="alg1.l10.m1.1.1.3.3.1.2.3.2" xref="alg1.l10.m1.1.1.3.3.1.2.3.2.cmml">k</mi><mo mathsize="90%" id="alg1.l10.m1.1.1.3.3.1.2.3.1" xref="alg1.l10.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="alg1.l10.m1.1.1.3.3.1.2.3.3" xref="alg1.l10.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l10.m1.1.1.3.3.1.3" xref="alg1.l10.m1.1.1.3.3.1.3.cmml"><mi mathsize="90%" id="alg1.l10.m1.1.1.3.3.1.3.2" xref="alg1.l10.m1.1.1.3.3.1.3.2.cmml">S</mi><mo mathsize="90%" id="alg1.l10.m1.1.1.3.3.1.3.1" xref="alg1.l10.m1.1.1.3.3.1.3.1.cmml">+</mo><mn mathsize="90%" id="alg1.l10.m1.1.1.3.3.1.3.3" xref="alg1.l10.m1.1.1.3.3.1.3.3.cmml">1</mn></mrow></msubsup><msub id="alg1.l10.m1.1.1.3.3.2" xref="alg1.l10.m1.1.1.3.3.2.cmml"><mi mathsize="90%" id="alg1.l10.m1.1.1.3.3.2.2" xref="alg1.l10.m1.1.1.3.3.2.2.cmml">θ</mi><mi mathsize="90%" id="alg1.l10.m1.1.1.3.3.2.3" xref="alg1.l10.m1.1.1.3.3.2.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝜃</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑇</ci></apply><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><times id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></times><apply id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2"><divide id="alg1.l10.m1.1.1.3.2.1.cmml" xref="alg1.l10.m1.1.1.3.2"></divide><cn type="integer" id="alg1.l10.m1.1.1.3.2.2.cmml" xref="alg1.l10.m1.1.1.3.2.2">1</cn><apply id="alg1.l10.m1.1.1.3.2.3.cmml" xref="alg1.l10.m1.1.1.3.2.3"><plus id="alg1.l10.m1.1.1.3.2.3.1.cmml" xref="alg1.l10.m1.1.1.3.2.3.1"></plus><ci id="alg1.l10.m1.1.1.3.2.3.2.cmml" xref="alg1.l10.m1.1.1.3.2.3.2">𝑆</ci><cn type="integer" id="alg1.l10.m1.1.1.3.2.3.3.cmml" xref="alg1.l10.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3"><apply id="alg1.l10.m1.1.1.3.3.1.cmml" xref="alg1.l10.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.3.1.1.cmml" xref="alg1.l10.m1.1.1.3.3.1">superscript</csymbol><apply id="alg1.l10.m1.1.1.3.3.1.2.cmml" xref="alg1.l10.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.3.1.2.1.cmml" xref="alg1.l10.m1.1.1.3.3.1">subscript</csymbol><sum id="alg1.l10.m1.1.1.3.3.1.2.2.cmml" xref="alg1.l10.m1.1.1.3.3.1.2.2"></sum><apply id="alg1.l10.m1.1.1.3.3.1.2.3.cmml" xref="alg1.l10.m1.1.1.3.3.1.2.3"><eq id="alg1.l10.m1.1.1.3.3.1.2.3.1.cmml" xref="alg1.l10.m1.1.1.3.3.1.2.3.1"></eq><ci id="alg1.l10.m1.1.1.3.3.1.2.3.2.cmml" xref="alg1.l10.m1.1.1.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.l10.m1.1.1.3.3.1.2.3.3.cmml" xref="alg1.l10.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="alg1.l10.m1.1.1.3.3.1.3.cmml" xref="alg1.l10.m1.1.1.3.3.1.3"><plus id="alg1.l10.m1.1.1.3.3.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.3.1.3.1"></plus><ci id="alg1.l10.m1.1.1.3.3.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.3.1.3.2">𝑆</ci><cn type="integer" id="alg1.l10.m1.1.1.3.3.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3.1.3.3">1</cn></apply></apply><apply id="alg1.l10.m1.1.1.3.3.2.cmml" xref="alg1.l10.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.3.2.1.cmml" xref="alg1.l10.m1.1.1.3.3.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.3.2.2.cmml" xref="alg1.l10.m1.1.1.3.3.2.2">𝜃</ci><ci id="alg1.l10.m1.1.1.3.3.2.3.cmml" xref="alg1.l10.m1.1.1.3.3.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\theta_{T}\leftarrow\frac{1}{S+1}\sum_{k=1}^{S+1}\theta_{k}</annotation></semantics></math><span id="alg1.l10.3" class="ltx_text" style="font-size:90%;">   </span><math id="alg1.l10.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg1.l10.m2.1a"><mrow id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><mrow id="alg1.l10.m2.1.1.2" xref="alg1.l10.m2.1.1.2a.cmml"></mrow><mo mathsize="90%" id="alg1.l10.m2.1.1.3" xref="alg1.l10.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><csymbol cd="latexml" id="alg1.l10.m2.1.1.1.cmml" xref="alg1.l10.m2.1.1">limit-from</csymbol><ci id="alg1.l10.m2.1.1.2a.cmml" xref="alg1.l10.m2.1.1.2"><mrow id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1.2"></mrow></ci><ci id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math><span id="alg1.l10.4" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l10.5" class="ltx_text ltx_font_typewriter" style="font-size:90%;">Update model with avg. over domains</span><span id="alg1.l10.6" class="ltx_text" style="font-size:90%;">
</span>
</div>
</div>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Source-Target Remote Gradient Alignment for FedPDA</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.3" class="ltx_p">We assume a model pre-trained on source data <math id="S3.SS2.p1.1.m1.3" class="ltx_Math" alttext="\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}" display="inline"><semantics id="S3.SS2.p1.1.m1.3a"><mrow id="S3.SS2.p1.1.m1.3.3.2" xref="S3.SS2.p1.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.3.3.2.3" xref="S3.SS2.p1.1.m1.3.3.3.cmml">{</mo><msub id="S3.SS2.p1.1.m1.2.2.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.2.2.1.1.2" xref="S3.SS2.p1.1.m1.2.2.1.1.2.cmml">𝒟</mi><mn id="S3.SS2.p1.1.m1.2.2.1.1.3" xref="S3.SS2.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.1.m1.3.3.2.4" xref="S3.SS2.p1.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p1.1.m1.3.3.2.5" xref="S3.SS2.p1.1.m1.3.3.3.cmml">,</mo><msub id="S3.SS2.p1.1.m1.3.3.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.3.3.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.cmml">𝒟</mi><mi id="S3.SS2.p1.1.m1.3.3.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.2.3.cmml">S</mi></msub><mo stretchy="false" id="S3.SS2.p1.1.m1.3.3.2.6" xref="S3.SS2.p1.1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.3b"><set id="S3.SS2.p1.1.m1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3.2"><apply id="S3.SS2.p1.1.m1.2.2.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.2">𝒟</ci><cn type="integer" id="S3.SS2.p1.1.m1.2.2.1.1.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">…</ci><apply id="S3.SS2.p1.1.m1.3.3.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2">𝒟</ci><ci id="S3.SS2.p1.1.m1.3.3.2.2.3.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.3">𝑆</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.3c">\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}</annotation></semantics></math> is deployed on a computational node with access to target data <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="D_{T}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">D</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝐷</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">D_{T}</annotation></semantics></math> but not source data.
Below, we describe the case when each source dataset <math id="S3.SS2.p1.3.m3.3" class="ltx_Math" alttext="\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}" display="inline"><semantics id="S3.SS2.p1.3.m3.3a"><mrow id="S3.SS2.p1.3.m3.3.3.2" xref="S3.SS2.p1.3.m3.3.3.3.cmml"><mo stretchy="false" id="S3.SS2.p1.3.m3.3.3.2.3" xref="S3.SS2.p1.3.m3.3.3.3.cmml">{</mo><msub id="S3.SS2.p1.3.m3.2.2.1.1" xref="S3.SS2.p1.3.m3.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.2.2.1.1.2" xref="S3.SS2.p1.3.m3.2.2.1.1.2.cmml">𝒟</mi><mn id="S3.SS2.p1.3.m3.2.2.1.1.3" xref="S3.SS2.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.3.m3.3.3.2.4" xref="S3.SS2.p1.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS2.p1.3.m3.3.3.2.5" xref="S3.SS2.p1.3.m3.3.3.3.cmml">,</mo><msub id="S3.SS2.p1.3.m3.3.3.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.3.3.2.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.2.cmml">𝒟</mi><mi id="S3.SS2.p1.3.m3.3.3.2.2.3" xref="S3.SS2.p1.3.m3.3.3.2.2.3.cmml">S</mi></msub><mo stretchy="false" id="S3.SS2.p1.3.m3.3.3.2.6" xref="S3.SS2.p1.3.m3.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.3b"><set id="S3.SS2.p1.3.m3.3.3.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2"><apply id="S3.SS2.p1.3.m3.2.2.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.2">𝒟</ci><cn type="integer" id="S3.SS2.p1.3.m3.2.2.1.1.3.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">…</ci><apply id="S3.SS2.p1.3.m3.3.3.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.3.3.2.2.1.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2">𝒟</ci><ci id="S3.SS2.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.3">𝑆</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.3c">\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}</annotation></semantics></math> is held in a separate compute node (e.g. federation).
We now derive the distributed <span id="S3.SS2.p1.3.1" class="ltx_text ltx_font_typewriter">StarAlign</span> Algorithm <a href="#alg2" title="Algorithm 2 ‣ 3.2 Source-Target Remote Gradient Alignment for FedPDA ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, approximating minimization of Eq. <a href="#S3.E2" title="In 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> without data exchange between nodes.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.6" class="ltx_p">The aim is to approximate execution of Alg. <a href="#alg1" title="Algorithm 1 ‣ 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> on the target node. Lack of access to source data, however, prevents calculation of source gradients in <em id="S3.SS2.p2.6.1" class="ltx_emph ltx_font_italic">L8</em> of Alg. <a href="#alg1" title="Algorithm 1 ‣ 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Instead, we approximate the gradient of each source domain <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{s}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝒟</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathcal{D}_{s}</annotation></semantics></math> separately, by computing the average gradient direction <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\overline{g}_{s}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mover accent="true" id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.2.2.cmml">g</mi><mo id="S3.SS2.p2.2.m2.1.1.2.1" xref="S3.SS2.p2.2.m2.1.1.2.1.cmml">¯</mo></mover><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><apply id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2"><ci id="S3.SS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1.2.1">¯</ci><ci id="S3.SS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2.2">𝑔</ci></apply><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\overline{g}_{s}</annotation></semantics></math> on the specific source node. For this, we perform <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\tau</annotation></semantics></math> local optimisation steps on source node <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">s</annotation></semantics></math> and average their gradients, obtaining <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="\overline{g}_{s}" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mover accent="true" id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2.2" xref="S3.SS2.p2.5.m5.1.1.2.2.cmml">g</mi><mo id="S3.SS2.p2.5.m5.1.1.2.1" xref="S3.SS2.p2.5.m5.1.1.2.1.cmml">¯</mo></mover><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2"><ci id="S3.SS2.p2.5.m5.1.1.2.1.cmml" xref="S3.SS2.p2.5.m5.1.1.2.1">¯</ci><ci id="S3.SS2.p2.5.m5.1.1.2.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2.2">𝑔</ci></apply><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\overline{g}_{s}</annotation></semantics></math>. By transferring <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="\overline{g}_{s}" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><msub id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mover accent="true" id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml"><mi id="S3.SS2.p2.6.m6.1.1.2.2" xref="S3.SS2.p2.6.m6.1.1.2.2.cmml">g</mi><mo id="S3.SS2.p2.6.m6.1.1.2.1" xref="S3.SS2.p2.6.m6.1.1.2.1.cmml">¯</mo></mover><mi id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">subscript</csymbol><apply id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2"><ci id="S3.SS2.p2.6.m6.1.1.2.1.cmml" xref="S3.SS2.p2.6.m6.1.1.2.1">¯</ci><ci id="S3.SS2.p2.6.m6.1.1.2.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2.2">𝑔</ci></apply><ci id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\overline{g}_{s}</annotation></semantics></math> from each source node to the target node, we can approximate the updates in <em id="S3.SS2.p2.6.2" class="ltx_emph ltx_font_italic">L8</em> of Alg. <a href="#alg1" title="Algorithm 1 ‣ 3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> on the target node.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.3.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Distributed <span id="alg2.4.2" class="ltx_text ltx_font_typewriter">StarAlign</span> algorithm for FedPDA</figcaption>
<div id="alg2.5" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><math id="alg2.l1.m1.1" class="ltx_Math" alttext="\theta_{T}" display="inline"><semantics id="alg2.l1.m1.1a"><msub id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><mi id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml">θ</mi><mi id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1">subscript</csymbol><ci id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2">𝜃</ci><ci id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\theta_{T}</annotation></semantics></math>: Model pre-trained on source data <math id="alg2.l1.m2.3" class="ltx_Math" alttext="\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}" display="inline"><semantics id="alg2.l1.m2.3a"><mrow id="alg2.l1.m2.3.3.2" xref="alg2.l1.m2.3.3.3.cmml"><mo stretchy="false" id="alg2.l1.m2.3.3.2.3" xref="alg2.l1.m2.3.3.3.cmml">{</mo><msub id="alg2.l1.m2.2.2.1.1" xref="alg2.l1.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m2.2.2.1.1.2" xref="alg2.l1.m2.2.2.1.1.2.cmml">𝒟</mi><mn id="alg2.l1.m2.2.2.1.1.3" xref="alg2.l1.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="alg2.l1.m2.3.3.2.4" xref="alg2.l1.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml">…</mi><mo id="alg2.l1.m2.3.3.2.5" xref="alg2.l1.m2.3.3.3.cmml">,</mo><msub id="alg2.l1.m2.3.3.2.2" xref="alg2.l1.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m2.3.3.2.2.2" xref="alg2.l1.m2.3.3.2.2.2.cmml">𝒟</mi><mi id="alg2.l1.m2.3.3.2.2.3" xref="alg2.l1.m2.3.3.2.2.3.cmml">S</mi></msub><mo stretchy="false" id="alg2.l1.m2.3.3.2.6" xref="alg2.l1.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.3b"><set id="alg2.l1.m2.3.3.3.cmml" xref="alg2.l1.m2.3.3.2"><apply id="alg2.l1.m2.2.2.1.1.cmml" xref="alg2.l1.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.2.2.1.1.1.cmml" xref="alg2.l1.m2.2.2.1.1">subscript</csymbol><ci id="alg2.l1.m2.2.2.1.1.2.cmml" xref="alg2.l1.m2.2.2.1.1.2">𝒟</ci><cn type="integer" id="alg2.l1.m2.2.2.1.1.3.cmml" xref="alg2.l1.m2.2.2.1.1.3">1</cn></apply><ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">…</ci><apply id="alg2.l1.m2.3.3.2.2.cmml" xref="alg2.l1.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg2.l1.m2.3.3.2.2.1.cmml" xref="alg2.l1.m2.3.3.2.2">subscript</csymbol><ci id="alg2.l1.m2.3.3.2.2.2.cmml" xref="alg2.l1.m2.3.3.2.2.2">𝒟</ci><ci id="alg2.l1.m2.3.3.2.2.3.cmml" xref="alg2.l1.m2.3.3.2.2.3">𝑆</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.3c">\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}</annotation></semantics></math>, deployed to Target node

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.2.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg2.l2.3" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l2.m1.1" class="ltx_Math" alttext="j=1" display="inline"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">j</mi><mo id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">=</mo><mn id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><eq id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></eq><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝑗</ci><cn type="integer" id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">j=1</annotation></semantics></math> to <math id="alg2.l2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg2.l2.m2.1a"><mi id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b"><ci id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.1c">E</annotation></semantics></math> <span id="alg2.l2.4" class="ltx_text ltx_font_bold">do</span>     <math id="alg2.l2.m3.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l2.m3.1a"><mrow id="alg2.l2.m3.1.1" xref="alg2.l2.m3.1.1.cmml"><mrow id="alg2.l2.m3.1.1.2" xref="alg2.l2.m3.1.1.2a.cmml"></mrow><mo id="alg2.l2.m3.1.1.3" xref="alg2.l2.m3.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m3.1b"><apply id="alg2.l2.m3.1.1.cmml" xref="alg2.l2.m3.1.1"><csymbol cd="latexml" id="alg2.l2.m3.1.1.1.cmml" xref="alg2.l2.m3.1.1">limit-from</csymbol><ci id="alg2.l2.m3.1.1.2a.cmml" xref="alg2.l2.m3.1.1.2"><mrow id="alg2.l2.m3.1.1.2.cmml" xref="alg2.l2.m3.1.1.2"></mrow></ci><ci id="alg2.l2.m3.1.1.3.cmml" xref="alg2.l2.m3.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m3.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l2.1" class="ltx_text ltx_font_typewriter">where <math id="alg2.l2.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg2.l2.1.m1.1a"><mi id="alg2.l2.1.m1.1.1" xref="alg2.l2.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.1.m1.1b"><ci id="alg2.l2.1.m1.1.1.cmml" xref="alg2.l2.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.1.m1.1c">E</annotation></semantics></math> total communication rounds</span>

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg2.l3.2" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l3.m1.3" class="ltx_Math" alttext="\mathcal{D}_{s}\in\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}" display="inline"><semantics id="alg2.l3.m1.3a"><mrow id="alg2.l3.m1.3.3" xref="alg2.l3.m1.3.3.cmml"><msub id="alg2.l3.m1.3.3.4" xref="alg2.l3.m1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.3.3.4.2" xref="alg2.l3.m1.3.3.4.2.cmml">𝒟</mi><mi id="alg2.l3.m1.3.3.4.3" xref="alg2.l3.m1.3.3.4.3.cmml">s</mi></msub><mo id="alg2.l3.m1.3.3.3" xref="alg2.l3.m1.3.3.3.cmml">∈</mo><mrow id="alg2.l3.m1.3.3.2.2" xref="alg2.l3.m1.3.3.2.3.cmml"><mo stretchy="false" id="alg2.l3.m1.3.3.2.2.3" xref="alg2.l3.m1.3.3.2.3.cmml">{</mo><msub id="alg2.l3.m1.2.2.1.1.1" xref="alg2.l3.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.2.2.1.1.1.2" xref="alg2.l3.m1.2.2.1.1.1.2.cmml">𝒟</mi><mn id="alg2.l3.m1.2.2.1.1.1.3" xref="alg2.l3.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="alg2.l3.m1.3.3.2.2.4" xref="alg2.l3.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">…</mi><mo id="alg2.l3.m1.3.3.2.2.5" xref="alg2.l3.m1.3.3.2.3.cmml">,</mo><msub id="alg2.l3.m1.3.3.2.2.2" xref="alg2.l3.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m1.3.3.2.2.2.2" xref="alg2.l3.m1.3.3.2.2.2.2.cmml">𝒟</mi><mi id="alg2.l3.m1.3.3.2.2.2.3" xref="alg2.l3.m1.3.3.2.2.2.3.cmml">S</mi></msub><mo stretchy="false" id="alg2.l3.m1.3.3.2.2.6" xref="alg2.l3.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.3b"><apply id="alg2.l3.m1.3.3.cmml" xref="alg2.l3.m1.3.3"><in id="alg2.l3.m1.3.3.3.cmml" xref="alg2.l3.m1.3.3.3"></in><apply id="alg2.l3.m1.3.3.4.cmml" xref="alg2.l3.m1.3.3.4"><csymbol cd="ambiguous" id="alg2.l3.m1.3.3.4.1.cmml" xref="alg2.l3.m1.3.3.4">subscript</csymbol><ci id="alg2.l3.m1.3.3.4.2.cmml" xref="alg2.l3.m1.3.3.4.2">𝒟</ci><ci id="alg2.l3.m1.3.3.4.3.cmml" xref="alg2.l3.m1.3.3.4.3">𝑠</ci></apply><set id="alg2.l3.m1.3.3.2.3.cmml" xref="alg2.l3.m1.3.3.2.2"><apply id="alg2.l3.m1.2.2.1.1.1.cmml" xref="alg2.l3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.2.2.1.1.1.1.cmml" xref="alg2.l3.m1.2.2.1.1.1">subscript</csymbol><ci id="alg2.l3.m1.2.2.1.1.1.2.cmml" xref="alg2.l3.m1.2.2.1.1.1.2">𝒟</ci><cn type="integer" id="alg2.l3.m1.2.2.1.1.1.3.cmml" xref="alg2.l3.m1.2.2.1.1.1.3">1</cn></apply><ci id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">…</ci><apply id="alg2.l3.m1.3.3.2.2.2.cmml" xref="alg2.l3.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg2.l3.m1.3.3.2.2.2.1.cmml" xref="alg2.l3.m1.3.3.2.2.2">subscript</csymbol><ci id="alg2.l3.m1.3.3.2.2.2.2.cmml" xref="alg2.l3.m1.3.3.2.2.2.2">𝒟</ci><ci id="alg2.l3.m1.3.3.2.2.2.3.cmml" xref="alg2.l3.m1.3.3.2.2.2.3">𝑆</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.3c">\mathcal{D}_{s}\in\{\mathcal{D}_{1},\dots,\mathcal{D}_{S}\}</annotation></semantics></math> <span id="alg2.l3.3" class="ltx_text ltx_font_bold">in parallel</span>  <span id="alg2.l3.4" class="ltx_text ltx_font_bold">do</span>  <math id="alg2.l3.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l3.m2.1a"><mrow id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml"><mrow id="alg2.l3.m2.1.1.2" xref="alg2.l3.m2.1.1.2a.cmml"></mrow><mo id="alg2.l3.m2.1.1.3" xref="alg2.l3.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><apply id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1"><csymbol cd="latexml" id="alg2.l3.m2.1.1.1.cmml" xref="alg2.l3.m2.1.1">limit-from</csymbol><ci id="alg2.l3.m2.1.1.2a.cmml" xref="alg2.l3.m2.1.1.2"><mrow id="alg2.l3.m2.1.1.2.cmml" xref="alg2.l3.m2.1.1.2"></mrow></ci><ci id="alg2.l3.m2.1.1.3.cmml" xref="alg2.l3.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l3.5" class="ltx_text ltx_framed ltx_framed_underline"><em id="alg2.l3.5.1" class="ltx_emph ltx_font_italic">Performed at each Source node</em></span>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>         <math id="alg2.l4.m1.1" class="ltx_Math" alttext="\theta_{s}\leftarrow\theta_{T}" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><msub id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml"><mi id="alg2.l4.m1.1.1.2.2" xref="alg2.l4.m1.1.1.2.2.cmml">θ</mi><mi id="alg2.l4.m1.1.1.2.3" xref="alg2.l4.m1.1.1.2.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">←</mo><msub id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml"><mi id="alg2.l4.m1.1.1.3.2" xref="alg2.l4.m1.1.1.3.2.cmml">θ</mi><mi id="alg2.l4.m1.1.1.3.3" xref="alg2.l4.m1.1.1.3.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><ci id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1">←</ci><apply id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.2.1.cmml" xref="alg2.l4.m1.1.1.2">subscript</csymbol><ci id="alg2.l4.m1.1.1.2.2.cmml" xref="alg2.l4.m1.1.1.2.2">𝜃</ci><ci id="alg2.l4.m1.1.1.2.3.cmml" xref="alg2.l4.m1.1.1.2.3">𝑠</ci></apply><apply id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.3">subscript</csymbol><ci id="alg2.l4.m1.1.1.3.2.cmml" xref="alg2.l4.m1.1.1.3.2">𝜃</ci><ci id="alg2.l4.m1.1.1.3.3.cmml" xref="alg2.l4.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\theta_{s}\leftarrow\theta_{T}</annotation></semantics></math>        <math id="alg2.l4.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l4.m2.1a"><mrow id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml"><mrow id="alg2.l4.m2.1.1.2" xref="alg2.l4.m2.1.1.2a.cmml"></mrow><mo id="alg2.l4.m2.1.1.3" xref="alg2.l4.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><apply id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1"><csymbol cd="latexml" id="alg2.l4.m2.1.1.1.cmml" xref="alg2.l4.m2.1.1">limit-from</csymbol><ci id="alg2.l4.m2.1.1.2a.cmml" xref="alg2.l4.m2.1.1.2"><mrow id="alg2.l4.m2.1.1.2.cmml" xref="alg2.l4.m2.1.1.2"></mrow></ci><ci id="alg2.l4.m2.1.1.3.cmml" xref="alg2.l4.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l4.2" class="ltx_text ltx_font_typewriter">Obtain latest model from Target node</span>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>         <span id="alg2.l5.2" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l5.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mi id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">i</mi><mo id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">=</mo><mn id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><eq id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1"></eq><ci id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2">𝑖</ci><cn type="integer" id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">i=1</annotation></semantics></math> to <math id="alg2.l5.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg2.l5.m2.1a"><mi id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><ci id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">\tau</annotation></semantics></math> <span id="alg2.l5.3" class="ltx_text ltx_font_bold">do</span>    <math id="alg2.l5.m3.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l5.m3.1a"><mrow id="alg2.l5.m3.1.1" xref="alg2.l5.m3.1.1.cmml"><mrow id="alg2.l5.m3.1.1.2" xref="alg2.l5.m3.1.1.2a.cmml"></mrow><mo id="alg2.l5.m3.1.1.3" xref="alg2.l5.m3.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m3.1b"><apply id="alg2.l5.m3.1.1.cmml" xref="alg2.l5.m3.1.1"><csymbol cd="latexml" id="alg2.l5.m3.1.1.1.cmml" xref="alg2.l5.m3.1.1">limit-from</csymbol><ci id="alg2.l5.m3.1.1.2a.cmml" xref="alg2.l5.m3.1.1.2"><mrow id="alg2.l5.m3.1.1.2.cmml" xref="alg2.l5.m3.1.1.2"></mrow></ci><ci id="alg2.l5.m3.1.1.3.cmml" xref="alg2.l5.m3.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m3.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l5.4" class="ltx_text ltx_font_typewriter">Local iterations</span>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>              <math id="alg2.l6.m1.1" class="ltx_Math" alttext="d_{s}\sim\mathcal{D}_{s}" display="inline"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><msub id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml"><mi id="alg2.l6.m1.1.1.2.2" xref="alg2.l6.m1.1.1.2.2.cmml">d</mi><mi id="alg2.l6.m1.1.1.2.3" xref="alg2.l6.m1.1.1.2.3.cmml">s</mi></msub><mo id="alg2.l6.m1.1.1.1" xref="alg2.l6.m1.1.1.1.cmml">∼</mo><msub id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.1.1.3.2" xref="alg2.l6.m1.1.1.3.2.cmml">𝒟</mi><mi id="alg2.l6.m1.1.1.3.3" xref="alg2.l6.m1.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><csymbol cd="latexml" id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1">similar-to</csymbol><apply id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1.2">subscript</csymbol><ci id="alg2.l6.m1.1.1.2.2.cmml" xref="alg2.l6.m1.1.1.2.2">𝑑</ci><ci id="alg2.l6.m1.1.1.2.3.cmml" xref="alg2.l6.m1.1.1.2.3">𝑠</ci></apply><apply id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.3">subscript</csymbol><ci id="alg2.l6.m1.1.1.3.2.cmml" xref="alg2.l6.m1.1.1.3.2">𝒟</ci><ci id="alg2.l6.m1.1.1.3.3.cmml" xref="alg2.l6.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">d_{s}\sim\mathcal{D}_{s}</annotation></semantics></math>        <math id="alg2.l6.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l6.m2.1a"><mrow id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml"><mrow id="alg2.l6.m2.1.1.2" xref="alg2.l6.m2.1.1.2a.cmml"></mrow><mo id="alg2.l6.m2.1.1.3" xref="alg2.l6.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><apply id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1"><csymbol cd="latexml" id="alg2.l6.m2.1.1.1.cmml" xref="alg2.l6.m2.1.1">limit-from</csymbol><ci id="alg2.l6.m2.1.1.2a.cmml" xref="alg2.l6.m2.1.1.2"><mrow id="alg2.l6.m2.1.1.2.cmml" xref="alg2.l6.m2.1.1.2"></mrow></ci><ci id="alg2.l6.m2.1.1.3.cmml" xref="alg2.l6.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l6.2" class="ltx_text ltx_font_typewriter">Sample batch</span>

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>              <math id="alg2.l7.m1.2" class="ltx_Math" alttext="g_{s}^{i}\leftarrow\nabla_{\theta_{s}}\mathcal{L}(\theta_{s};d_{s})" display="inline"><semantics id="alg2.l7.m1.2a"><mrow id="alg2.l7.m1.2.2" xref="alg2.l7.m1.2.2.cmml"><msubsup id="alg2.l7.m1.2.2.4" xref="alg2.l7.m1.2.2.4.cmml"><mi id="alg2.l7.m1.2.2.4.2.2" xref="alg2.l7.m1.2.2.4.2.2.cmml">g</mi><mi id="alg2.l7.m1.2.2.4.2.3" xref="alg2.l7.m1.2.2.4.2.3.cmml">s</mi><mi id="alg2.l7.m1.2.2.4.3" xref="alg2.l7.m1.2.2.4.3.cmml">i</mi></msubsup><mo stretchy="false" id="alg2.l7.m1.2.2.3" xref="alg2.l7.m1.2.2.3.cmml">←</mo><mrow id="alg2.l7.m1.2.2.2" xref="alg2.l7.m1.2.2.2.cmml"><mrow id="alg2.l7.m1.2.2.2.4" xref="alg2.l7.m1.2.2.2.4.cmml"><msub id="alg2.l7.m1.2.2.2.4.1" xref="alg2.l7.m1.2.2.2.4.1.cmml"><mo rspace="0.167em" id="alg2.l7.m1.2.2.2.4.1.2" xref="alg2.l7.m1.2.2.2.4.1.2.cmml">∇</mo><msub id="alg2.l7.m1.2.2.2.4.1.3" xref="alg2.l7.m1.2.2.2.4.1.3.cmml"><mi id="alg2.l7.m1.2.2.2.4.1.3.2" xref="alg2.l7.m1.2.2.2.4.1.3.2.cmml">θ</mi><mi id="alg2.l7.m1.2.2.2.4.1.3.3" xref="alg2.l7.m1.2.2.2.4.1.3.3.cmml">s</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m1.2.2.2.4.2" xref="alg2.l7.m1.2.2.2.4.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.2.3" xref="alg2.l7.m1.2.2.2.3.cmml">​</mo><mrow id="alg2.l7.m1.2.2.2.2.2" xref="alg2.l7.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l7.m1.2.2.2.2.2.3" xref="alg2.l7.m1.2.2.2.2.3.cmml">(</mo><msub id="alg2.l7.m1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l7.m1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="alg2.l7.m1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="alg2.l7.m1.2.2.2.2.2.4" xref="alg2.l7.m1.2.2.2.2.3.cmml">;</mo><msub id="alg2.l7.m1.2.2.2.2.2.2" xref="alg2.l7.m1.2.2.2.2.2.2.cmml"><mi id="alg2.l7.m1.2.2.2.2.2.2.2" xref="alg2.l7.m1.2.2.2.2.2.2.2.cmml">d</mi><mi id="alg2.l7.m1.2.2.2.2.2.2.3" xref="alg2.l7.m1.2.2.2.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l7.m1.2.2.2.2.2.5" xref="alg2.l7.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.2b"><apply id="alg2.l7.m1.2.2.cmml" xref="alg2.l7.m1.2.2"><ci id="alg2.l7.m1.2.2.3.cmml" xref="alg2.l7.m1.2.2.3">←</ci><apply id="alg2.l7.m1.2.2.4.cmml" xref="alg2.l7.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l7.m1.2.2.4.1.cmml" xref="alg2.l7.m1.2.2.4">superscript</csymbol><apply id="alg2.l7.m1.2.2.4.2.cmml" xref="alg2.l7.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l7.m1.2.2.4.2.1.cmml" xref="alg2.l7.m1.2.2.4">subscript</csymbol><ci id="alg2.l7.m1.2.2.4.2.2.cmml" xref="alg2.l7.m1.2.2.4.2.2">𝑔</ci><ci id="alg2.l7.m1.2.2.4.2.3.cmml" xref="alg2.l7.m1.2.2.4.2.3">𝑠</ci></apply><ci id="alg2.l7.m1.2.2.4.3.cmml" xref="alg2.l7.m1.2.2.4.3">𝑖</ci></apply><apply id="alg2.l7.m1.2.2.2.cmml" xref="alg2.l7.m1.2.2.2"><times id="alg2.l7.m1.2.2.2.3.cmml" xref="alg2.l7.m1.2.2.2.3"></times><apply id="alg2.l7.m1.2.2.2.4.cmml" xref="alg2.l7.m1.2.2.2.4"><apply id="alg2.l7.m1.2.2.2.4.1.cmml" xref="alg2.l7.m1.2.2.2.4.1"><csymbol cd="ambiguous" id="alg2.l7.m1.2.2.2.4.1.1.cmml" xref="alg2.l7.m1.2.2.2.4.1">subscript</csymbol><ci id="alg2.l7.m1.2.2.2.4.1.2.cmml" xref="alg2.l7.m1.2.2.2.4.1.2">∇</ci><apply id="alg2.l7.m1.2.2.2.4.1.3.cmml" xref="alg2.l7.m1.2.2.2.4.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.2.2.2.4.1.3.1.cmml" xref="alg2.l7.m1.2.2.2.4.1.3">subscript</csymbol><ci id="alg2.l7.m1.2.2.2.4.1.3.2.cmml" xref="alg2.l7.m1.2.2.2.4.1.3.2">𝜃</ci><ci id="alg2.l7.m1.2.2.2.4.1.3.3.cmml" xref="alg2.l7.m1.2.2.2.4.1.3.3">𝑠</ci></apply></apply><ci id="alg2.l7.m1.2.2.2.4.2.cmml" xref="alg2.l7.m1.2.2.2.4.2">ℒ</ci></apply><list id="alg2.l7.m1.2.2.2.2.3.cmml" xref="alg2.l7.m1.2.2.2.2.2"><apply id="alg2.l7.m1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.2">𝜃</ci><ci id="alg2.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="alg2.l7.m1.2.2.2.2.2.2.cmml" xref="alg2.l7.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l7.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l7.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l7.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l7.m1.2.2.2.2.2.2.2">𝑑</ci><ci id="alg2.l7.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l7.m1.2.2.2.2.2.2.3">𝑠</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.2c">g_{s}^{i}\leftarrow\nabla_{\theta_{s}}\mathcal{L}(\theta_{s};d_{s})</annotation></semantics></math>    <math id="alg2.l7.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l7.m2.1a"><mrow id="alg2.l7.m2.1.1" xref="alg2.l7.m2.1.1.cmml"><mrow id="alg2.l7.m2.1.1.2" xref="alg2.l7.m2.1.1.2a.cmml"></mrow><mo id="alg2.l7.m2.1.1.3" xref="alg2.l7.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.1b"><apply id="alg2.l7.m2.1.1.cmml" xref="alg2.l7.m2.1.1"><csymbol cd="latexml" id="alg2.l7.m2.1.1.1.cmml" xref="alg2.l7.m2.1.1">limit-from</csymbol><ci id="alg2.l7.m2.1.1.2a.cmml" xref="alg2.l7.m2.1.1.2"><mrow id="alg2.l7.m2.1.1.2.cmml" xref="alg2.l7.m2.1.1.2"></mrow></ci><ci id="alg2.l7.m2.1.1.3.cmml" xref="alg2.l7.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l7.2" class="ltx_text ltx_font_typewriter">Compute gradient</span>

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>              <math id="alg2.l8.m1.1" class="ltx_Math" alttext="\theta_{s}\leftarrow\theta_{s}-\alpha g_{s}^{i}" display="inline"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><msub id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml"><mi id="alg2.l8.m1.1.1.2.2" xref="alg2.l8.m1.1.1.2.2.cmml">θ</mi><mi id="alg2.l8.m1.1.1.2.3" xref="alg2.l8.m1.1.1.2.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml">←</mo><mrow id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml"><msub id="alg2.l8.m1.1.1.3.2" xref="alg2.l8.m1.1.1.3.2.cmml"><mi id="alg2.l8.m1.1.1.3.2.2" xref="alg2.l8.m1.1.1.3.2.2.cmml">θ</mi><mi id="alg2.l8.m1.1.1.3.2.3" xref="alg2.l8.m1.1.1.3.2.3.cmml">s</mi></msub><mo id="alg2.l8.m1.1.1.3.1" xref="alg2.l8.m1.1.1.3.1.cmml">−</mo><mrow id="alg2.l8.m1.1.1.3.3" xref="alg2.l8.m1.1.1.3.3.cmml"><mi id="alg2.l8.m1.1.1.3.3.2" xref="alg2.l8.m1.1.1.3.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.3.3.1" xref="alg2.l8.m1.1.1.3.3.1.cmml">​</mo><msubsup id="alg2.l8.m1.1.1.3.3.3" xref="alg2.l8.m1.1.1.3.3.3.cmml"><mi id="alg2.l8.m1.1.1.3.3.3.2.2" xref="alg2.l8.m1.1.1.3.3.3.2.2.cmml">g</mi><mi id="alg2.l8.m1.1.1.3.3.3.2.3" xref="alg2.l8.m1.1.1.3.3.3.2.3.cmml">s</mi><mi id="alg2.l8.m1.1.1.3.3.3.3" xref="alg2.l8.m1.1.1.3.3.3.3.cmml">i</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><ci id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1">←</ci><apply id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.2.1.cmml" xref="alg2.l8.m1.1.1.2">subscript</csymbol><ci id="alg2.l8.m1.1.1.2.2.cmml" xref="alg2.l8.m1.1.1.2.2">𝜃</ci><ci id="alg2.l8.m1.1.1.2.3.cmml" xref="alg2.l8.m1.1.1.2.3">𝑠</ci></apply><apply id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3"><minus id="alg2.l8.m1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.3.1"></minus><apply id="alg2.l8.m1.1.1.3.2.cmml" xref="alg2.l8.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.3.2.1.cmml" xref="alg2.l8.m1.1.1.3.2">subscript</csymbol><ci id="alg2.l8.m1.1.1.3.2.2.cmml" xref="alg2.l8.m1.1.1.3.2.2">𝜃</ci><ci id="alg2.l8.m1.1.1.3.2.3.cmml" xref="alg2.l8.m1.1.1.3.2.3">𝑠</ci></apply><apply id="alg2.l8.m1.1.1.3.3.cmml" xref="alg2.l8.m1.1.1.3.3"><times id="alg2.l8.m1.1.1.3.3.1.cmml" xref="alg2.l8.m1.1.1.3.3.1"></times><ci id="alg2.l8.m1.1.1.3.3.2.cmml" xref="alg2.l8.m1.1.1.3.3.2">𝛼</ci><apply id="alg2.l8.m1.1.1.3.3.3.cmml" xref="alg2.l8.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.3.3.3.1.cmml" xref="alg2.l8.m1.1.1.3.3.3">superscript</csymbol><apply id="alg2.l8.m1.1.1.3.3.3.2.cmml" xref="alg2.l8.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.3.3.3.2.1.cmml" xref="alg2.l8.m1.1.1.3.3.3">subscript</csymbol><ci id="alg2.l8.m1.1.1.3.3.3.2.2.cmml" xref="alg2.l8.m1.1.1.3.3.3.2.2">𝑔</ci><ci id="alg2.l8.m1.1.1.3.3.3.2.3.cmml" xref="alg2.l8.m1.1.1.3.3.3.2.3">𝑠</ci></apply><ci id="alg2.l8.m1.1.1.3.3.3.3.cmml" xref="alg2.l8.m1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\theta_{s}\leftarrow\theta_{s}-\alpha g_{s}^{i}</annotation></semantics></math>      <math id="alg2.l8.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l8.m2.1a"><mrow id="alg2.l8.m2.1.1" xref="alg2.l8.m2.1.1.cmml"><mrow id="alg2.l8.m2.1.1.2" xref="alg2.l8.m2.1.1.2a.cmml"></mrow><mo id="alg2.l8.m2.1.1.3" xref="alg2.l8.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m2.1b"><apply id="alg2.l8.m2.1.1.cmml" xref="alg2.l8.m2.1.1"><csymbol cd="latexml" id="alg2.l8.m2.1.1.1.cmml" xref="alg2.l8.m2.1.1">limit-from</csymbol><ci id="alg2.l8.m2.1.1.2a.cmml" xref="alg2.l8.m2.1.1.2"><mrow id="alg2.l8.m2.1.1.2.cmml" xref="alg2.l8.m2.1.1.2"></mrow></ci><ci id="alg2.l8.m2.1.1.3.cmml" xref="alg2.l8.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l8.2" class="ltx_text ltx_font_typewriter">Update model</span>
         
</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>         <math id="alg2.l9.m1.1" class="ltx_Math" alttext="\overline{g}_{s}=\frac{1}{\tau}\sum_{i=1}^{\tau}g_{s}^{i}" display="inline"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><msub id="alg2.l9.m1.1.1.2" xref="alg2.l9.m1.1.1.2.cmml"><mover accent="true" id="alg2.l9.m1.1.1.2.2" xref="alg2.l9.m1.1.1.2.2.cmml"><mi id="alg2.l9.m1.1.1.2.2.2" xref="alg2.l9.m1.1.1.2.2.2.cmml">g</mi><mo id="alg2.l9.m1.1.1.2.2.1" xref="alg2.l9.m1.1.1.2.2.1.cmml">¯</mo></mover><mi id="alg2.l9.m1.1.1.2.3" xref="alg2.l9.m1.1.1.2.3.cmml">s</mi></msub><mo id="alg2.l9.m1.1.1.1" xref="alg2.l9.m1.1.1.1.cmml">=</mo><mrow id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml"><mfrac id="alg2.l9.m1.1.1.3.2" xref="alg2.l9.m1.1.1.3.2.cmml"><mn id="alg2.l9.m1.1.1.3.2.2" xref="alg2.l9.m1.1.1.3.2.2.cmml">1</mn><mi id="alg2.l9.m1.1.1.3.2.3" xref="alg2.l9.m1.1.1.3.2.3.cmml">τ</mi></mfrac><mo lspace="0em" rspace="0em" id="alg2.l9.m1.1.1.3.1" xref="alg2.l9.m1.1.1.3.1.cmml">​</mo><mrow id="alg2.l9.m1.1.1.3.3" xref="alg2.l9.m1.1.1.3.3.cmml"><msubsup id="alg2.l9.m1.1.1.3.3.1" xref="alg2.l9.m1.1.1.3.3.1.cmml"><mo id="alg2.l9.m1.1.1.3.3.1.2.2" xref="alg2.l9.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="alg2.l9.m1.1.1.3.3.1.2.3" xref="alg2.l9.m1.1.1.3.3.1.2.3.cmml"><mi id="alg2.l9.m1.1.1.3.3.1.2.3.2" xref="alg2.l9.m1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="alg2.l9.m1.1.1.3.3.1.2.3.1" xref="alg2.l9.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="alg2.l9.m1.1.1.3.3.1.2.3.3" xref="alg2.l9.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg2.l9.m1.1.1.3.3.1.3" xref="alg2.l9.m1.1.1.3.3.1.3.cmml">τ</mi></msubsup><msubsup id="alg2.l9.m1.1.1.3.3.2" xref="alg2.l9.m1.1.1.3.3.2.cmml"><mi id="alg2.l9.m1.1.1.3.3.2.2.2" xref="alg2.l9.m1.1.1.3.3.2.2.2.cmml">g</mi><mi id="alg2.l9.m1.1.1.3.3.2.2.3" xref="alg2.l9.m1.1.1.3.3.2.2.3.cmml">s</mi><mi id="alg2.l9.m1.1.1.3.3.2.3" xref="alg2.l9.m1.1.1.3.3.2.3.cmml">i</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><eq id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1"></eq><apply id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1.2">subscript</csymbol><apply id="alg2.l9.m1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.2.2"><ci id="alg2.l9.m1.1.1.2.2.1.cmml" xref="alg2.l9.m1.1.1.2.2.1">¯</ci><ci id="alg2.l9.m1.1.1.2.2.2.cmml" xref="alg2.l9.m1.1.1.2.2.2">𝑔</ci></apply><ci id="alg2.l9.m1.1.1.2.3.cmml" xref="alg2.l9.m1.1.1.2.3">𝑠</ci></apply><apply id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3"><times id="alg2.l9.m1.1.1.3.1.cmml" xref="alg2.l9.m1.1.1.3.1"></times><apply id="alg2.l9.m1.1.1.3.2.cmml" xref="alg2.l9.m1.1.1.3.2"><divide id="alg2.l9.m1.1.1.3.2.1.cmml" xref="alg2.l9.m1.1.1.3.2"></divide><cn type="integer" id="alg2.l9.m1.1.1.3.2.2.cmml" xref="alg2.l9.m1.1.1.3.2.2">1</cn><ci id="alg2.l9.m1.1.1.3.2.3.cmml" xref="alg2.l9.m1.1.1.3.2.3">𝜏</ci></apply><apply id="alg2.l9.m1.1.1.3.3.cmml" xref="alg2.l9.m1.1.1.3.3"><apply id="alg2.l9.m1.1.1.3.3.1.cmml" xref="alg2.l9.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.3.3.1.1.cmml" xref="alg2.l9.m1.1.1.3.3.1">superscript</csymbol><apply id="alg2.l9.m1.1.1.3.3.1.2.cmml" xref="alg2.l9.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.3.3.1.2.1.cmml" xref="alg2.l9.m1.1.1.3.3.1">subscript</csymbol><sum id="alg2.l9.m1.1.1.3.3.1.2.2.cmml" xref="alg2.l9.m1.1.1.3.3.1.2.2"></sum><apply id="alg2.l9.m1.1.1.3.3.1.2.3.cmml" xref="alg2.l9.m1.1.1.3.3.1.2.3"><eq id="alg2.l9.m1.1.1.3.3.1.2.3.1.cmml" xref="alg2.l9.m1.1.1.3.3.1.2.3.1"></eq><ci id="alg2.l9.m1.1.1.3.3.1.2.3.2.cmml" xref="alg2.l9.m1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="alg2.l9.m1.1.1.3.3.1.2.3.3.cmml" xref="alg2.l9.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg2.l9.m1.1.1.3.3.1.3.cmml" xref="alg2.l9.m1.1.1.3.3.1.3">𝜏</ci></apply><apply id="alg2.l9.m1.1.1.3.3.2.cmml" xref="alg2.l9.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.3.3.2.1.cmml" xref="alg2.l9.m1.1.1.3.3.2">superscript</csymbol><apply id="alg2.l9.m1.1.1.3.3.2.2.cmml" xref="alg2.l9.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.3.3.2.2.1.cmml" xref="alg2.l9.m1.1.1.3.3.2">subscript</csymbol><ci id="alg2.l9.m1.1.1.3.3.2.2.2.cmml" xref="alg2.l9.m1.1.1.3.3.2.2.2">𝑔</ci><ci id="alg2.l9.m1.1.1.3.3.2.2.3.cmml" xref="alg2.l9.m1.1.1.3.3.2.2.3">𝑠</ci></apply><ci id="alg2.l9.m1.1.1.3.3.2.3.cmml" xref="alg2.l9.m1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">\overline{g}_{s}=\frac{1}{\tau}\sum_{i=1}^{\tau}g_{s}^{i}</annotation></semantics></math>  <math id="alg2.l9.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l9.m2.1a"><mrow id="alg2.l9.m2.1.1" xref="alg2.l9.m2.1.1.cmml"><mrow id="alg2.l9.m2.1.1.2" xref="alg2.l9.m2.1.1.2a.cmml"></mrow><mo id="alg2.l9.m2.1.1.3" xref="alg2.l9.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m2.1b"><apply id="alg2.l9.m2.1.1.cmml" xref="alg2.l9.m2.1.1"><csymbol cd="latexml" id="alg2.l9.m2.1.1.1.cmml" xref="alg2.l9.m2.1.1">limit-from</csymbol><ci id="alg2.l9.m2.1.1.2a.cmml" xref="alg2.l9.m2.1.1.2"><mrow id="alg2.l9.m2.1.1.2.cmml" xref="alg2.l9.m2.1.1.2"></mrow></ci><ci id="alg2.l9.m2.1.1.3.cmml" xref="alg2.l9.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l9.2" class="ltx_text ltx_framed ltx_framed_underline"><em id="alg2.l9.2.1" class="ltx_emph ltx_font_italic">Compute avg. gradient and <span id="alg2.l9.2.1.1" class="ltx_text ltx_font_bold">SEND</span> to Target node</em></span>
     
</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     <span id="alg2.l10.2" class="ltx_text ltx_font_bold">for</span>  <math id="alg2.l10.m1.4" class="ltx_Math" alttext="k\in\{1,\dots,S,T\}" display="inline"><semantics id="alg2.l10.m1.4a"><mrow id="alg2.l10.m1.4.5" xref="alg2.l10.m1.4.5.cmml"><mi id="alg2.l10.m1.4.5.2" xref="alg2.l10.m1.4.5.2.cmml">k</mi><mo id="alg2.l10.m1.4.5.1" xref="alg2.l10.m1.4.5.1.cmml">∈</mo><mrow id="alg2.l10.m1.4.5.3.2" xref="alg2.l10.m1.4.5.3.1.cmml"><mo stretchy="false" id="alg2.l10.m1.4.5.3.2.1" xref="alg2.l10.m1.4.5.3.1.cmml">{</mo><mn id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml">1</mn><mo id="alg2.l10.m1.4.5.3.2.2" xref="alg2.l10.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.l10.m1.2.2" xref="alg2.l10.m1.2.2.cmml">…</mi><mo id="alg2.l10.m1.4.5.3.2.3" xref="alg2.l10.m1.4.5.3.1.cmml">,</mo><mi id="alg2.l10.m1.3.3" xref="alg2.l10.m1.3.3.cmml">S</mi><mo id="alg2.l10.m1.4.5.3.2.4" xref="alg2.l10.m1.4.5.3.1.cmml">,</mo><mi id="alg2.l10.m1.4.4" xref="alg2.l10.m1.4.4.cmml">T</mi><mo stretchy="false" id="alg2.l10.m1.4.5.3.2.5" xref="alg2.l10.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.4b"><apply id="alg2.l10.m1.4.5.cmml" xref="alg2.l10.m1.4.5"><in id="alg2.l10.m1.4.5.1.cmml" xref="alg2.l10.m1.4.5.1"></in><ci id="alg2.l10.m1.4.5.2.cmml" xref="alg2.l10.m1.4.5.2">𝑘</ci><set id="alg2.l10.m1.4.5.3.1.cmml" xref="alg2.l10.m1.4.5.3.2"><cn type="integer" id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1">1</cn><ci id="alg2.l10.m1.2.2.cmml" xref="alg2.l10.m1.2.2">…</ci><ci id="alg2.l10.m1.3.3.cmml" xref="alg2.l10.m1.3.3">𝑆</ci><ci id="alg2.l10.m1.4.4.cmml" xref="alg2.l10.m1.4.4">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.4c">k\in\{1,\dots,S,T\}</annotation></semantics></math>  <span id="alg2.l10.3" class="ltx_text ltx_font_bold">do</span> <math id="alg2.l10.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l10.m2.1a"><mrow id="alg2.l10.m2.1.1" xref="alg2.l10.m2.1.1.cmml"><mrow id="alg2.l10.m2.1.1.2" xref="alg2.l10.m2.1.1.2a.cmml"></mrow><mo id="alg2.l10.m2.1.1.3" xref="alg2.l10.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m2.1b"><apply id="alg2.l10.m2.1.1.cmml" xref="alg2.l10.m2.1.1"><csymbol cd="latexml" id="alg2.l10.m2.1.1.1.cmml" xref="alg2.l10.m2.1.1">limit-from</csymbol><ci id="alg2.l10.m2.1.1.2a.cmml" xref="alg2.l10.m2.1.1.2"><mrow id="alg2.l10.m2.1.1.2.cmml" xref="alg2.l10.m2.1.1.2"></mrow></ci><ci id="alg2.l10.m2.1.1.3.cmml" xref="alg2.l10.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l10.4" class="ltx_text ltx_framed ltx_framed_underline"><em id="alg2.l10.4.1" class="ltx_emph ltx_font_italic">Code below is performed at Target node</em></span>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>         <math id="alg2.l11.m1.1" class="ltx_Math" alttext="\theta_{k}\leftarrow\theta_{T}" display="inline"><semantics id="alg2.l11.m1.1a"><mrow id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml"><msub id="alg2.l11.m1.1.1.2" xref="alg2.l11.m1.1.1.2.cmml"><mi id="alg2.l11.m1.1.1.2.2" xref="alg2.l11.m1.1.1.2.2.cmml">θ</mi><mi id="alg2.l11.m1.1.1.2.3" xref="alg2.l11.m1.1.1.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg2.l11.m1.1.1.1" xref="alg2.l11.m1.1.1.1.cmml">←</mo><msub id="alg2.l11.m1.1.1.3" xref="alg2.l11.m1.1.1.3.cmml"><mi id="alg2.l11.m1.1.1.3.2" xref="alg2.l11.m1.1.1.3.2.cmml">θ</mi><mi id="alg2.l11.m1.1.1.3.3" xref="alg2.l11.m1.1.1.3.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1"><ci id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1">←</ci><apply id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.2.1.cmml" xref="alg2.l11.m1.1.1.2">subscript</csymbol><ci id="alg2.l11.m1.1.1.2.2.cmml" xref="alg2.l11.m1.1.1.2.2">𝜃</ci><ci id="alg2.l11.m1.1.1.2.3.cmml" xref="alg2.l11.m1.1.1.2.3">𝑘</ci></apply><apply id="alg2.l11.m1.1.1.3.cmml" xref="alg2.l11.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.3.1.cmml" xref="alg2.l11.m1.1.1.3">subscript</csymbol><ci id="alg2.l11.m1.1.1.3.2.cmml" xref="alg2.l11.m1.1.1.3.2">𝜃</ci><ci id="alg2.l11.m1.1.1.3.3.cmml" xref="alg2.l11.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">\theta_{k}\leftarrow\theta_{T}</annotation></semantics></math>; <math id="alg2.l11.m2.1" class="ltx_Math" alttext="\hat{\theta}_{k}\leftarrow\theta_{T}" display="inline"><semantics id="alg2.l11.m2.1a"><mrow id="alg2.l11.m2.1.1" xref="alg2.l11.m2.1.1.cmml"><msub id="alg2.l11.m2.1.1.2" xref="alg2.l11.m2.1.1.2.cmml"><mover accent="true" id="alg2.l11.m2.1.1.2.2" xref="alg2.l11.m2.1.1.2.2.cmml"><mi id="alg2.l11.m2.1.1.2.2.2" xref="alg2.l11.m2.1.1.2.2.2.cmml">θ</mi><mo id="alg2.l11.m2.1.1.2.2.1" xref="alg2.l11.m2.1.1.2.2.1.cmml">^</mo></mover><mi id="alg2.l11.m2.1.1.2.3" xref="alg2.l11.m2.1.1.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg2.l11.m2.1.1.1" xref="alg2.l11.m2.1.1.1.cmml">←</mo><msub id="alg2.l11.m2.1.1.3" xref="alg2.l11.m2.1.1.3.cmml"><mi id="alg2.l11.m2.1.1.3.2" xref="alg2.l11.m2.1.1.3.2.cmml">θ</mi><mi id="alg2.l11.m2.1.1.3.3" xref="alg2.l11.m2.1.1.3.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m2.1b"><apply id="alg2.l11.m2.1.1.cmml" xref="alg2.l11.m2.1.1"><ci id="alg2.l11.m2.1.1.1.cmml" xref="alg2.l11.m2.1.1.1">←</ci><apply id="alg2.l11.m2.1.1.2.cmml" xref="alg2.l11.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l11.m2.1.1.2.1.cmml" xref="alg2.l11.m2.1.1.2">subscript</csymbol><apply id="alg2.l11.m2.1.1.2.2.cmml" xref="alg2.l11.m2.1.1.2.2"><ci id="alg2.l11.m2.1.1.2.2.1.cmml" xref="alg2.l11.m2.1.1.2.2.1">^</ci><ci id="alg2.l11.m2.1.1.2.2.2.cmml" xref="alg2.l11.m2.1.1.2.2.2">𝜃</ci></apply><ci id="alg2.l11.m2.1.1.2.3.cmml" xref="alg2.l11.m2.1.1.2.3">𝑘</ci></apply><apply id="alg2.l11.m2.1.1.3.cmml" xref="alg2.l11.m2.1.1.3"><csymbol cd="ambiguous" id="alg2.l11.m2.1.1.3.1.cmml" xref="alg2.l11.m2.1.1.3">subscript</csymbol><ci id="alg2.l11.m2.1.1.3.2.cmml" xref="alg2.l11.m2.1.1.3.2">𝜃</ci><ci id="alg2.l11.m2.1.1.3.3.cmml" xref="alg2.l11.m2.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m2.1c">\hat{\theta}_{k}\leftarrow\theta_{T}</annotation></semantics></math>

</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>         <span id="alg2.l12.2" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l12.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="alg2.l12.m1.1a"><mrow id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><mi id="alg2.l12.m1.1.1.2" xref="alg2.l12.m1.1.1.2.cmml">i</mi><mo id="alg2.l12.m1.1.1.1" xref="alg2.l12.m1.1.1.1.cmml">=</mo><mn id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><eq id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1"></eq><ci id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2">𝑖</ci><cn type="integer" id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">i=1</annotation></semantics></math> to <math id="alg2.l12.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg2.l12.m2.1a"><mi id="alg2.l12.m2.1.1" xref="alg2.l12.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg2.l12.m2.1b"><ci id="alg2.l12.m2.1.1.cmml" xref="alg2.l12.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m2.1c">\tau</annotation></semantics></math> <span id="alg2.l12.3" class="ltx_text ltx_font_bold">do</span>       <math id="alg2.l12.m3.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l12.m3.1a"><mrow id="alg2.l12.m3.1.1" xref="alg2.l12.m3.1.1.cmml"><mrow id="alg2.l12.m3.1.1.2" xref="alg2.l12.m3.1.1.2a.cmml"></mrow><mo id="alg2.l12.m3.1.1.3" xref="alg2.l12.m3.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m3.1b"><apply id="alg2.l12.m3.1.1.cmml" xref="alg2.l12.m3.1.1"><csymbol cd="latexml" id="alg2.l12.m3.1.1.1.cmml" xref="alg2.l12.m3.1.1">limit-from</csymbol><ci id="alg2.l12.m3.1.1.2a.cmml" xref="alg2.l12.m3.1.1.2"><mrow id="alg2.l12.m3.1.1.2.cmml" xref="alg2.l12.m3.1.1.2"></mrow></ci><ci id="alg2.l12.m3.1.1.3.cmml" xref="alg2.l12.m3.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m3.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l12.4" class="ltx_text ltx_font_typewriter">Local iterations</span>

</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>              <math id="alg2.l13.m1.1" class="ltx_Math" alttext="d_{T}\sim\mathcal{D}_{T}" display="inline"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><msub id="alg2.l13.m1.1.1.2" xref="alg2.l13.m1.1.1.2.cmml"><mi id="alg2.l13.m1.1.1.2.2" xref="alg2.l13.m1.1.1.2.2.cmml">d</mi><mi id="alg2.l13.m1.1.1.2.3" xref="alg2.l13.m1.1.1.2.3.cmml">T</mi></msub><mo id="alg2.l13.m1.1.1.1" xref="alg2.l13.m1.1.1.1.cmml">∼</mo><msub id="alg2.l13.m1.1.1.3" xref="alg2.l13.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l13.m1.1.1.3.2" xref="alg2.l13.m1.1.1.3.2.cmml">𝒟</mi><mi id="alg2.l13.m1.1.1.3.3" xref="alg2.l13.m1.1.1.3.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><csymbol cd="latexml" id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1">similar-to</csymbol><apply id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.2.1.cmml" xref="alg2.l13.m1.1.1.2">subscript</csymbol><ci id="alg2.l13.m1.1.1.2.2.cmml" xref="alg2.l13.m1.1.1.2.2">𝑑</ci><ci id="alg2.l13.m1.1.1.2.3.cmml" xref="alg2.l13.m1.1.1.2.3">𝑇</ci></apply><apply id="alg2.l13.m1.1.1.3.cmml" xref="alg2.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.3.1.cmml" xref="alg2.l13.m1.1.1.3">subscript</csymbol><ci id="alg2.l13.m1.1.1.3.2.cmml" xref="alg2.l13.m1.1.1.3.2">𝒟</ci><ci id="alg2.l13.m1.1.1.3.3.cmml" xref="alg2.l13.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">d_{T}\sim\mathcal{D}_{T}</annotation></semantics></math>          <math id="alg2.l13.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l13.m2.1a"><mrow id="alg2.l13.m2.1.1" xref="alg2.l13.m2.1.1.cmml"><mrow id="alg2.l13.m2.1.1.2" xref="alg2.l13.m2.1.1.2a.cmml"></mrow><mo id="alg2.l13.m2.1.1.3" xref="alg2.l13.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m2.1b"><apply id="alg2.l13.m2.1.1.cmml" xref="alg2.l13.m2.1.1"><csymbol cd="latexml" id="alg2.l13.m2.1.1.1.cmml" xref="alg2.l13.m2.1.1">limit-from</csymbol><ci id="alg2.l13.m2.1.1.2a.cmml" xref="alg2.l13.m2.1.1.2"><mrow id="alg2.l13.m2.1.1.2.cmml" xref="alg2.l13.m2.1.1.2"></mrow></ci><ci id="alg2.l13.m2.1.1.3.cmml" xref="alg2.l13.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l13.2" class="ltx_text ltx_font_typewriter">Sample batch</span>

</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l14.2.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>              <math id="alg2.l14.m1.2" class="ltx_Math" alttext="\hat{\theta}_{k}\leftarrow\hat{\theta}_{k}-\alpha\nabla_{\hat{\theta}_{k}}\mathcal{L}(\hat{\theta}_{k};d_{T})" display="inline"><semantics id="alg2.l14.m1.2a"><mrow id="alg2.l14.m1.2.2" xref="alg2.l14.m1.2.2.cmml"><msub id="alg2.l14.m1.2.2.4" xref="alg2.l14.m1.2.2.4.cmml"><mover accent="true" id="alg2.l14.m1.2.2.4.2" xref="alg2.l14.m1.2.2.4.2.cmml"><mi id="alg2.l14.m1.2.2.4.2.2" xref="alg2.l14.m1.2.2.4.2.2.cmml">θ</mi><mo id="alg2.l14.m1.2.2.4.2.1" xref="alg2.l14.m1.2.2.4.2.1.cmml">^</mo></mover><mi id="alg2.l14.m1.2.2.4.3" xref="alg2.l14.m1.2.2.4.3.cmml">k</mi></msub><mo stretchy="false" id="alg2.l14.m1.2.2.3" xref="alg2.l14.m1.2.2.3.cmml">←</mo><mrow id="alg2.l14.m1.2.2.2" xref="alg2.l14.m1.2.2.2.cmml"><msub id="alg2.l14.m1.2.2.2.4" xref="alg2.l14.m1.2.2.2.4.cmml"><mover accent="true" id="alg2.l14.m1.2.2.2.4.2" xref="alg2.l14.m1.2.2.2.4.2.cmml"><mi id="alg2.l14.m1.2.2.2.4.2.2" xref="alg2.l14.m1.2.2.2.4.2.2.cmml">θ</mi><mo id="alg2.l14.m1.2.2.2.4.2.1" xref="alg2.l14.m1.2.2.2.4.2.1.cmml">^</mo></mover><mi id="alg2.l14.m1.2.2.2.4.3" xref="alg2.l14.m1.2.2.2.4.3.cmml">k</mi></msub><mo id="alg2.l14.m1.2.2.2.3" xref="alg2.l14.m1.2.2.2.3.cmml">−</mo><mrow id="alg2.l14.m1.2.2.2.2" xref="alg2.l14.m1.2.2.2.2.cmml"><mi id="alg2.l14.m1.2.2.2.2.4" xref="alg2.l14.m1.2.2.2.2.4.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="alg2.l14.m1.2.2.2.2.3" xref="alg2.l14.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg2.l14.m1.2.2.2.2.5" xref="alg2.l14.m1.2.2.2.2.5.cmml"><msub id="alg2.l14.m1.2.2.2.2.5.1" xref="alg2.l14.m1.2.2.2.2.5.1.cmml"><mo rspace="0.167em" id="alg2.l14.m1.2.2.2.2.5.1.2" xref="alg2.l14.m1.2.2.2.2.5.1.2.cmml">∇</mo><msub id="alg2.l14.m1.2.2.2.2.5.1.3" xref="alg2.l14.m1.2.2.2.2.5.1.3.cmml"><mover accent="true" id="alg2.l14.m1.2.2.2.2.5.1.3.2" xref="alg2.l14.m1.2.2.2.2.5.1.3.2.cmml"><mi id="alg2.l14.m1.2.2.2.2.5.1.3.2.2" xref="alg2.l14.m1.2.2.2.2.5.1.3.2.2.cmml">θ</mi><mo id="alg2.l14.m1.2.2.2.2.5.1.3.2.1" xref="alg2.l14.m1.2.2.2.2.5.1.3.2.1.cmml">^</mo></mover><mi id="alg2.l14.m1.2.2.2.2.5.1.3.3" xref="alg2.l14.m1.2.2.2.2.5.1.3.3.cmml">k</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="alg2.l14.m1.2.2.2.2.5.2" xref="alg2.l14.m1.2.2.2.2.5.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l14.m1.2.2.2.2.3a" xref="alg2.l14.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg2.l14.m1.2.2.2.2.2.2" xref="alg2.l14.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l14.m1.2.2.2.2.2.2.3" xref="alg2.l14.m1.2.2.2.2.2.3.cmml">(</mo><msub id="alg2.l14.m1.1.1.1.1.1.1.1" xref="alg2.l14.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg2.l14.m1.1.1.1.1.1.1.1.2" xref="alg2.l14.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg2.l14.m1.1.1.1.1.1.1.1.2.2" xref="alg2.l14.m1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mo id="alg2.l14.m1.1.1.1.1.1.1.1.2.1" xref="alg2.l14.m1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="alg2.l14.m1.1.1.1.1.1.1.1.3" xref="alg2.l14.m1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="alg2.l14.m1.2.2.2.2.2.2.4" xref="alg2.l14.m1.2.2.2.2.2.3.cmml">;</mo><msub id="alg2.l14.m1.2.2.2.2.2.2.2" xref="alg2.l14.m1.2.2.2.2.2.2.2.cmml"><mi id="alg2.l14.m1.2.2.2.2.2.2.2.2" xref="alg2.l14.m1.2.2.2.2.2.2.2.2.cmml">d</mi><mi id="alg2.l14.m1.2.2.2.2.2.2.2.3" xref="alg2.l14.m1.2.2.2.2.2.2.2.3.cmml">T</mi></msub><mo stretchy="false" id="alg2.l14.m1.2.2.2.2.2.2.5" xref="alg2.l14.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.2b"><apply id="alg2.l14.m1.2.2.cmml" xref="alg2.l14.m1.2.2"><ci id="alg2.l14.m1.2.2.3.cmml" xref="alg2.l14.m1.2.2.3">←</ci><apply id="alg2.l14.m1.2.2.4.cmml" xref="alg2.l14.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.l14.m1.2.2.4.1.cmml" xref="alg2.l14.m1.2.2.4">subscript</csymbol><apply id="alg2.l14.m1.2.2.4.2.cmml" xref="alg2.l14.m1.2.2.4.2"><ci id="alg2.l14.m1.2.2.4.2.1.cmml" xref="alg2.l14.m1.2.2.4.2.1">^</ci><ci id="alg2.l14.m1.2.2.4.2.2.cmml" xref="alg2.l14.m1.2.2.4.2.2">𝜃</ci></apply><ci id="alg2.l14.m1.2.2.4.3.cmml" xref="alg2.l14.m1.2.2.4.3">𝑘</ci></apply><apply id="alg2.l14.m1.2.2.2.cmml" xref="alg2.l14.m1.2.2.2"><minus id="alg2.l14.m1.2.2.2.3.cmml" xref="alg2.l14.m1.2.2.2.3"></minus><apply id="alg2.l14.m1.2.2.2.4.cmml" xref="alg2.l14.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg2.l14.m1.2.2.2.4.1.cmml" xref="alg2.l14.m1.2.2.2.4">subscript</csymbol><apply id="alg2.l14.m1.2.2.2.4.2.cmml" xref="alg2.l14.m1.2.2.2.4.2"><ci id="alg2.l14.m1.2.2.2.4.2.1.cmml" xref="alg2.l14.m1.2.2.2.4.2.1">^</ci><ci id="alg2.l14.m1.2.2.2.4.2.2.cmml" xref="alg2.l14.m1.2.2.2.4.2.2">𝜃</ci></apply><ci id="alg2.l14.m1.2.2.2.4.3.cmml" xref="alg2.l14.m1.2.2.2.4.3">𝑘</ci></apply><apply id="alg2.l14.m1.2.2.2.2.cmml" xref="alg2.l14.m1.2.2.2.2"><times id="alg2.l14.m1.2.2.2.2.3.cmml" xref="alg2.l14.m1.2.2.2.2.3"></times><ci id="alg2.l14.m1.2.2.2.2.4.cmml" xref="alg2.l14.m1.2.2.2.2.4">𝛼</ci><apply id="alg2.l14.m1.2.2.2.2.5.cmml" xref="alg2.l14.m1.2.2.2.2.5"><apply id="alg2.l14.m1.2.2.2.2.5.1.cmml" xref="alg2.l14.m1.2.2.2.2.5.1"><csymbol cd="ambiguous" id="alg2.l14.m1.2.2.2.2.5.1.1.cmml" xref="alg2.l14.m1.2.2.2.2.5.1">subscript</csymbol><ci id="alg2.l14.m1.2.2.2.2.5.1.2.cmml" xref="alg2.l14.m1.2.2.2.2.5.1.2">∇</ci><apply id="alg2.l14.m1.2.2.2.2.5.1.3.cmml" xref="alg2.l14.m1.2.2.2.2.5.1.3"><csymbol cd="ambiguous" id="alg2.l14.m1.2.2.2.2.5.1.3.1.cmml" xref="alg2.l14.m1.2.2.2.2.5.1.3">subscript</csymbol><apply id="alg2.l14.m1.2.2.2.2.5.1.3.2.cmml" xref="alg2.l14.m1.2.2.2.2.5.1.3.2"><ci id="alg2.l14.m1.2.2.2.2.5.1.3.2.1.cmml" xref="alg2.l14.m1.2.2.2.2.5.1.3.2.1">^</ci><ci id="alg2.l14.m1.2.2.2.2.5.1.3.2.2.cmml" xref="alg2.l14.m1.2.2.2.2.5.1.3.2.2">𝜃</ci></apply><ci id="alg2.l14.m1.2.2.2.2.5.1.3.3.cmml" xref="alg2.l14.m1.2.2.2.2.5.1.3.3">𝑘</ci></apply></apply><ci id="alg2.l14.m1.2.2.2.2.5.2.cmml" xref="alg2.l14.m1.2.2.2.2.5.2">ℒ</ci></apply><list id="alg2.l14.m1.2.2.2.2.2.3.cmml" xref="alg2.l14.m1.2.2.2.2.2.2"><apply id="alg2.l14.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l14.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l14.m1.1.1.1.1.1.1.1.2"><ci id="alg2.l14.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l14.m1.1.1.1.1.1.1.1.2.1">^</ci><ci id="alg2.l14.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l14.m1.1.1.1.1.1.1.1.2.2">𝜃</ci></apply><ci id="alg2.l14.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l14.m1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg2.l14.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l14.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l14.m1.2.2.2.2.2.2.2.1.cmml" xref="alg2.l14.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l14.m1.2.2.2.2.2.2.2.2.cmml" xref="alg2.l14.m1.2.2.2.2.2.2.2.2">𝑑</ci><ci id="alg2.l14.m1.2.2.2.2.2.2.2.3.cmml" xref="alg2.l14.m1.2.2.2.2.2.2.2.3">𝑇</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.2c">\hat{\theta}_{k}\leftarrow\hat{\theta}_{k}-\alpha\nabla_{\hat{\theta}_{k}}\mathcal{L}(\hat{\theta}_{k};d_{T})</annotation></semantics></math>  <math id="alg2.l14.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l14.m2.1a"><mrow id="alg2.l14.m2.1.1" xref="alg2.l14.m2.1.1.cmml"><mrow id="alg2.l14.m2.1.1.2" xref="alg2.l14.m2.1.1.2a.cmml"></mrow><mo id="alg2.l14.m2.1.1.3" xref="alg2.l14.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m2.1b"><apply id="alg2.l14.m2.1.1.cmml" xref="alg2.l14.m2.1.1"><csymbol cd="latexml" id="alg2.l14.m2.1.1.1.cmml" xref="alg2.l14.m2.1.1">limit-from</csymbol><ci id="alg2.l14.m2.1.1.2a.cmml" xref="alg2.l14.m2.1.1.2"><mrow id="alg2.l14.m2.1.1.2.cmml" xref="alg2.l14.m2.1.1.2"></mrow></ci><ci id="alg2.l14.m2.1.1.3.cmml" xref="alg2.l14.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l14.1" class="ltx_text ltx_font_typewriter">Compute gradient on <math id="alg2.l14.1.m1.1" class="ltx_Math" alttext="d_{T}" display="inline"><semantics id="alg2.l14.1.m1.1a"><msub id="alg2.l14.1.m1.1.1" xref="alg2.l14.1.m1.1.1.cmml"><mi id="alg2.l14.1.m1.1.1.2" xref="alg2.l14.1.m1.1.1.2.cmml">d</mi><mi id="alg2.l14.1.m1.1.1.3" xref="alg2.l14.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l14.1.m1.1b"><apply id="alg2.l14.1.m1.1.1.cmml" xref="alg2.l14.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l14.1.m1.1.1.1.cmml" xref="alg2.l14.1.m1.1.1">subscript</csymbol><ci id="alg2.l14.1.m1.1.1.2.cmml" xref="alg2.l14.1.m1.1.1.2">𝑑</ci><ci id="alg2.l14.1.m1.1.1.3.cmml" xref="alg2.l14.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.1.m1.1c">d_{T}</annotation></semantics></math> and update</span>

</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>              <span id="alg2.l15.2" class="ltx_text ltx_font_bold">if</span> <math id="alg2.l15.m1.1" class="ltx_Math" alttext="k\neq T" display="inline"><semantics id="alg2.l15.m1.1a"><mrow id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mi id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml">k</mi><mo id="alg2.l15.m1.1.1.1" xref="alg2.l15.m1.1.1.1.cmml">≠</mo><mi id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><neq id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1"></neq><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">𝑘</ci><ci id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">k\neq T</annotation></semantics></math> <span id="alg2.l15.3" class="ltx_text ltx_font_bold">then</span> <math id="alg2.l15.m2.1" class="ltx_Math" alttext="\hat{\theta}_{k}\leftarrow\hat{\theta}_{k}-\alpha\overline{g}_{k}" display="inline"><semantics id="alg2.l15.m2.1a"><mrow id="alg2.l15.m2.1.1" xref="alg2.l15.m2.1.1.cmml"><msub id="alg2.l15.m2.1.1.2" xref="alg2.l15.m2.1.1.2.cmml"><mover accent="true" id="alg2.l15.m2.1.1.2.2" xref="alg2.l15.m2.1.1.2.2.cmml"><mi id="alg2.l15.m2.1.1.2.2.2" xref="alg2.l15.m2.1.1.2.2.2.cmml">θ</mi><mo id="alg2.l15.m2.1.1.2.2.1" xref="alg2.l15.m2.1.1.2.2.1.cmml">^</mo></mover><mi id="alg2.l15.m2.1.1.2.3" xref="alg2.l15.m2.1.1.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg2.l15.m2.1.1.1" xref="alg2.l15.m2.1.1.1.cmml">←</mo><mrow id="alg2.l15.m2.1.1.3" xref="alg2.l15.m2.1.1.3.cmml"><msub id="alg2.l15.m2.1.1.3.2" xref="alg2.l15.m2.1.1.3.2.cmml"><mover accent="true" id="alg2.l15.m2.1.1.3.2.2" xref="alg2.l15.m2.1.1.3.2.2.cmml"><mi id="alg2.l15.m2.1.1.3.2.2.2" xref="alg2.l15.m2.1.1.3.2.2.2.cmml">θ</mi><mo id="alg2.l15.m2.1.1.3.2.2.1" xref="alg2.l15.m2.1.1.3.2.2.1.cmml">^</mo></mover><mi id="alg2.l15.m2.1.1.3.2.3" xref="alg2.l15.m2.1.1.3.2.3.cmml">k</mi></msub><mo id="alg2.l15.m2.1.1.3.1" xref="alg2.l15.m2.1.1.3.1.cmml">−</mo><mrow id="alg2.l15.m2.1.1.3.3" xref="alg2.l15.m2.1.1.3.3.cmml"><mi id="alg2.l15.m2.1.1.3.3.2" xref="alg2.l15.m2.1.1.3.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m2.1.1.3.3.1" xref="alg2.l15.m2.1.1.3.3.1.cmml">​</mo><msub id="alg2.l15.m2.1.1.3.3.3" xref="alg2.l15.m2.1.1.3.3.3.cmml"><mover accent="true" id="alg2.l15.m2.1.1.3.3.3.2" xref="alg2.l15.m2.1.1.3.3.3.2.cmml"><mi id="alg2.l15.m2.1.1.3.3.3.2.2" xref="alg2.l15.m2.1.1.3.3.3.2.2.cmml">g</mi><mo id="alg2.l15.m2.1.1.3.3.3.2.1" xref="alg2.l15.m2.1.1.3.3.3.2.1.cmml">¯</mo></mover><mi id="alg2.l15.m2.1.1.3.3.3.3" xref="alg2.l15.m2.1.1.3.3.3.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m2.1b"><apply id="alg2.l15.m2.1.1.cmml" xref="alg2.l15.m2.1.1"><ci id="alg2.l15.m2.1.1.1.cmml" xref="alg2.l15.m2.1.1.1">←</ci><apply id="alg2.l15.m2.1.1.2.cmml" xref="alg2.l15.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l15.m2.1.1.2.1.cmml" xref="alg2.l15.m2.1.1.2">subscript</csymbol><apply id="alg2.l15.m2.1.1.2.2.cmml" xref="alg2.l15.m2.1.1.2.2"><ci id="alg2.l15.m2.1.1.2.2.1.cmml" xref="alg2.l15.m2.1.1.2.2.1">^</ci><ci id="alg2.l15.m2.1.1.2.2.2.cmml" xref="alg2.l15.m2.1.1.2.2.2">𝜃</ci></apply><ci id="alg2.l15.m2.1.1.2.3.cmml" xref="alg2.l15.m2.1.1.2.3">𝑘</ci></apply><apply id="alg2.l15.m2.1.1.3.cmml" xref="alg2.l15.m2.1.1.3"><minus id="alg2.l15.m2.1.1.3.1.cmml" xref="alg2.l15.m2.1.1.3.1"></minus><apply id="alg2.l15.m2.1.1.3.2.cmml" xref="alg2.l15.m2.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l15.m2.1.1.3.2.1.cmml" xref="alg2.l15.m2.1.1.3.2">subscript</csymbol><apply id="alg2.l15.m2.1.1.3.2.2.cmml" xref="alg2.l15.m2.1.1.3.2.2"><ci id="alg2.l15.m2.1.1.3.2.2.1.cmml" xref="alg2.l15.m2.1.1.3.2.2.1">^</ci><ci id="alg2.l15.m2.1.1.3.2.2.2.cmml" xref="alg2.l15.m2.1.1.3.2.2.2">𝜃</ci></apply><ci id="alg2.l15.m2.1.1.3.2.3.cmml" xref="alg2.l15.m2.1.1.3.2.3">𝑘</ci></apply><apply id="alg2.l15.m2.1.1.3.3.cmml" xref="alg2.l15.m2.1.1.3.3"><times id="alg2.l15.m2.1.1.3.3.1.cmml" xref="alg2.l15.m2.1.1.3.3.1"></times><ci id="alg2.l15.m2.1.1.3.3.2.cmml" xref="alg2.l15.m2.1.1.3.3.2">𝛼</ci><apply id="alg2.l15.m2.1.1.3.3.3.cmml" xref="alg2.l15.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="alg2.l15.m2.1.1.3.3.3.1.cmml" xref="alg2.l15.m2.1.1.3.3.3">subscript</csymbol><apply id="alg2.l15.m2.1.1.3.3.3.2.cmml" xref="alg2.l15.m2.1.1.3.3.3.2"><ci id="alg2.l15.m2.1.1.3.3.3.2.1.cmml" xref="alg2.l15.m2.1.1.3.3.3.2.1">¯</ci><ci id="alg2.l15.m2.1.1.3.3.3.2.2.cmml" xref="alg2.l15.m2.1.1.3.3.3.2.2">𝑔</ci></apply><ci id="alg2.l15.m2.1.1.3.3.3.3.cmml" xref="alg2.l15.m2.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m2.1c">\hat{\theta}_{k}\leftarrow\hat{\theta}_{k}-\alpha\overline{g}_{k}</annotation></semantics></math> <math id="alg2.l15.m3.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l15.m3.1a"><mrow id="alg2.l15.m3.1.1" xref="alg2.l15.m3.1.1.cmml"><mrow id="alg2.l15.m3.1.1.2" xref="alg2.l15.m3.1.1.2a.cmml"></mrow><mo id="alg2.l15.m3.1.1.3" xref="alg2.l15.m3.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m3.1b"><apply id="alg2.l15.m3.1.1.cmml" xref="alg2.l15.m3.1.1"><csymbol cd="latexml" id="alg2.l15.m3.1.1.1.cmml" xref="alg2.l15.m3.1.1">limit-from</csymbol><ci id="alg2.l15.m3.1.1.2a.cmml" xref="alg2.l15.m3.1.1.2"><mrow id="alg2.l15.m3.1.1.2.cmml" xref="alg2.l15.m3.1.1.2"></mrow></ci><ci id="alg2.l15.m3.1.1.3.cmml" xref="alg2.l15.m3.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m3.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l15.4" class="ltx_text ltx_font_typewriter">Update with average gradient</span>

</div>
<div id="alg2.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>              <span id="alg2.l16.2" class="ltx_text ltx_font_bold">else</span> Repeat L13-14: Resample <math id="alg2.l16.m1.1" class="ltx_Math" alttext="d_{T}^{\prime}\!\sim\!\mathcal{D}_{T}" display="inline"><semantics id="alg2.l16.m1.1a"><mrow id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml"><msubsup id="alg2.l16.m1.1.1.2" xref="alg2.l16.m1.1.1.2.cmml"><mi id="alg2.l16.m1.1.1.2.2.2" xref="alg2.l16.m1.1.1.2.2.2.cmml">d</mi><mi id="alg2.l16.m1.1.1.2.2.3" xref="alg2.l16.m1.1.1.2.2.3.cmml">T</mi><mo id="alg2.l16.m1.1.1.2.3" xref="alg2.l16.m1.1.1.2.3.cmml">′</mo></msubsup><mo lspace="0.108em" rspace="0.108em" id="alg2.l16.m1.1.1.1" xref="alg2.l16.m1.1.1.1.cmml">∼</mo><msub id="alg2.l16.m1.1.1.3" xref="alg2.l16.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l16.m1.1.1.3.2" xref="alg2.l16.m1.1.1.3.2.cmml">𝒟</mi><mi id="alg2.l16.m1.1.1.3.3" xref="alg2.l16.m1.1.1.3.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><apply id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1"><csymbol cd="latexml" id="alg2.l16.m1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1">similar-to</csymbol><apply id="alg2.l16.m1.1.1.2.cmml" xref="alg2.l16.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.2.1.cmml" xref="alg2.l16.m1.1.1.2">superscript</csymbol><apply id="alg2.l16.m1.1.1.2.2.cmml" xref="alg2.l16.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.2.2.1.cmml" xref="alg2.l16.m1.1.1.2">subscript</csymbol><ci id="alg2.l16.m1.1.1.2.2.2.cmml" xref="alg2.l16.m1.1.1.2.2.2">𝑑</ci><ci id="alg2.l16.m1.1.1.2.2.3.cmml" xref="alg2.l16.m1.1.1.2.2.3">𝑇</ci></apply><ci id="alg2.l16.m1.1.1.2.3.cmml" xref="alg2.l16.m1.1.1.2.3">′</ci></apply><apply id="alg2.l16.m1.1.1.3.cmml" xref="alg2.l16.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.3.1.cmml" xref="alg2.l16.m1.1.1.3">subscript</csymbol><ci id="alg2.l16.m1.1.1.3.2.cmml" xref="alg2.l16.m1.1.1.3.2">𝒟</ci><ci id="alg2.l16.m1.1.1.3.3.cmml" xref="alg2.l16.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">d_{T}^{\prime}\!\sim\!\mathcal{D}_{T}</annotation></semantics></math>, update <math id="alg2.l16.m2.2" class="ltx_Math" alttext="\hat{\theta}_{k}\!\leftarrow\!\hat{\theta}_{k}\!-\!\alpha\nabla_{\hat{\theta}_{k}}\mathcal{L}(\hat{\theta}_{k};d_{T}^{\prime})" display="inline"><semantics id="alg2.l16.m2.2a"><mrow id="alg2.l16.m2.2.2" xref="alg2.l16.m2.2.2.cmml"><msub id="alg2.l16.m2.2.2.4" xref="alg2.l16.m2.2.2.4.cmml"><mover accent="true" id="alg2.l16.m2.2.2.4.2" xref="alg2.l16.m2.2.2.4.2.cmml"><mi id="alg2.l16.m2.2.2.4.2.2" xref="alg2.l16.m2.2.2.4.2.2.cmml">θ</mi><mo id="alg2.l16.m2.2.2.4.2.1" xref="alg2.l16.m2.2.2.4.2.1.cmml">^</mo></mover><mi id="alg2.l16.m2.2.2.4.3" xref="alg2.l16.m2.2.2.4.3.cmml">k</mi></msub><mo lspace="0.108em" rspace="0.108em" stretchy="false" id="alg2.l16.m2.2.2.3" xref="alg2.l16.m2.2.2.3.cmml">←</mo><mrow id="alg2.l16.m2.2.2.2" xref="alg2.l16.m2.2.2.2.cmml"><msub id="alg2.l16.m2.2.2.2.4" xref="alg2.l16.m2.2.2.2.4.cmml"><mover accent="true" id="alg2.l16.m2.2.2.2.4.2" xref="alg2.l16.m2.2.2.2.4.2.cmml"><mi id="alg2.l16.m2.2.2.2.4.2.2" xref="alg2.l16.m2.2.2.2.4.2.2.cmml">θ</mi><mo id="alg2.l16.m2.2.2.2.4.2.1" xref="alg2.l16.m2.2.2.2.4.2.1.cmml">^</mo></mover><mi id="alg2.l16.m2.2.2.2.4.3" xref="alg2.l16.m2.2.2.2.4.3.cmml">k</mi></msub><mo rspace="0.052em" id="alg2.l16.m2.2.2.2.3" xref="alg2.l16.m2.2.2.2.3.cmml">−</mo><mrow id="alg2.l16.m2.2.2.2.2" xref="alg2.l16.m2.2.2.2.2.cmml"><mi id="alg2.l16.m2.2.2.2.2.4" xref="alg2.l16.m2.2.2.2.2.4.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="alg2.l16.m2.2.2.2.2.3" xref="alg2.l16.m2.2.2.2.2.3.cmml">​</mo><mrow id="alg2.l16.m2.2.2.2.2.5" xref="alg2.l16.m2.2.2.2.2.5.cmml"><msub id="alg2.l16.m2.2.2.2.2.5.1" xref="alg2.l16.m2.2.2.2.2.5.1.cmml"><mo rspace="0.167em" id="alg2.l16.m2.2.2.2.2.5.1.2" xref="alg2.l16.m2.2.2.2.2.5.1.2.cmml">∇</mo><msub id="alg2.l16.m2.2.2.2.2.5.1.3" xref="alg2.l16.m2.2.2.2.2.5.1.3.cmml"><mover accent="true" id="alg2.l16.m2.2.2.2.2.5.1.3.2" xref="alg2.l16.m2.2.2.2.2.5.1.3.2.cmml"><mi id="alg2.l16.m2.2.2.2.2.5.1.3.2.2" xref="alg2.l16.m2.2.2.2.2.5.1.3.2.2.cmml">θ</mi><mo id="alg2.l16.m2.2.2.2.2.5.1.3.2.1" xref="alg2.l16.m2.2.2.2.2.5.1.3.2.1.cmml">^</mo></mover><mi id="alg2.l16.m2.2.2.2.2.5.1.3.3" xref="alg2.l16.m2.2.2.2.2.5.1.3.3.cmml">k</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="alg2.l16.m2.2.2.2.2.5.2" xref="alg2.l16.m2.2.2.2.2.5.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l16.m2.2.2.2.2.3a" xref="alg2.l16.m2.2.2.2.2.3.cmml">​</mo><mrow id="alg2.l16.m2.2.2.2.2.2.2" xref="alg2.l16.m2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l16.m2.2.2.2.2.2.2.3" xref="alg2.l16.m2.2.2.2.2.2.3.cmml">(</mo><msub id="alg2.l16.m2.1.1.1.1.1.1.1" xref="alg2.l16.m2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg2.l16.m2.1.1.1.1.1.1.1.2" xref="alg2.l16.m2.1.1.1.1.1.1.1.2.cmml"><mi id="alg2.l16.m2.1.1.1.1.1.1.1.2.2" xref="alg2.l16.m2.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mo id="alg2.l16.m2.1.1.1.1.1.1.1.2.1" xref="alg2.l16.m2.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="alg2.l16.m2.1.1.1.1.1.1.1.3" xref="alg2.l16.m2.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="alg2.l16.m2.2.2.2.2.2.2.4" xref="alg2.l16.m2.2.2.2.2.2.3.cmml">;</mo><msubsup id="alg2.l16.m2.2.2.2.2.2.2.2" xref="alg2.l16.m2.2.2.2.2.2.2.2.cmml"><mi id="alg2.l16.m2.2.2.2.2.2.2.2.2.2" xref="alg2.l16.m2.2.2.2.2.2.2.2.2.2.cmml">d</mi><mi id="alg2.l16.m2.2.2.2.2.2.2.2.2.3" xref="alg2.l16.m2.2.2.2.2.2.2.2.2.3.cmml">T</mi><mo id="alg2.l16.m2.2.2.2.2.2.2.2.3" xref="alg2.l16.m2.2.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="alg2.l16.m2.2.2.2.2.2.2.5" xref="alg2.l16.m2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m2.2b"><apply id="alg2.l16.m2.2.2.cmml" xref="alg2.l16.m2.2.2"><ci id="alg2.l16.m2.2.2.3.cmml" xref="alg2.l16.m2.2.2.3">←</ci><apply id="alg2.l16.m2.2.2.4.cmml" xref="alg2.l16.m2.2.2.4"><csymbol cd="ambiguous" id="alg2.l16.m2.2.2.4.1.cmml" xref="alg2.l16.m2.2.2.4">subscript</csymbol><apply id="alg2.l16.m2.2.2.4.2.cmml" xref="alg2.l16.m2.2.2.4.2"><ci id="alg2.l16.m2.2.2.4.2.1.cmml" xref="alg2.l16.m2.2.2.4.2.1">^</ci><ci id="alg2.l16.m2.2.2.4.2.2.cmml" xref="alg2.l16.m2.2.2.4.2.2">𝜃</ci></apply><ci id="alg2.l16.m2.2.2.4.3.cmml" xref="alg2.l16.m2.2.2.4.3">𝑘</ci></apply><apply id="alg2.l16.m2.2.2.2.cmml" xref="alg2.l16.m2.2.2.2"><minus id="alg2.l16.m2.2.2.2.3.cmml" xref="alg2.l16.m2.2.2.2.3"></minus><apply id="alg2.l16.m2.2.2.2.4.cmml" xref="alg2.l16.m2.2.2.2.4"><csymbol cd="ambiguous" id="alg2.l16.m2.2.2.2.4.1.cmml" xref="alg2.l16.m2.2.2.2.4">subscript</csymbol><apply id="alg2.l16.m2.2.2.2.4.2.cmml" xref="alg2.l16.m2.2.2.2.4.2"><ci id="alg2.l16.m2.2.2.2.4.2.1.cmml" xref="alg2.l16.m2.2.2.2.4.2.1">^</ci><ci id="alg2.l16.m2.2.2.2.4.2.2.cmml" xref="alg2.l16.m2.2.2.2.4.2.2">𝜃</ci></apply><ci id="alg2.l16.m2.2.2.2.4.3.cmml" xref="alg2.l16.m2.2.2.2.4.3">𝑘</ci></apply><apply id="alg2.l16.m2.2.2.2.2.cmml" xref="alg2.l16.m2.2.2.2.2"><times id="alg2.l16.m2.2.2.2.2.3.cmml" xref="alg2.l16.m2.2.2.2.2.3"></times><ci id="alg2.l16.m2.2.2.2.2.4.cmml" xref="alg2.l16.m2.2.2.2.2.4">𝛼</ci><apply id="alg2.l16.m2.2.2.2.2.5.cmml" xref="alg2.l16.m2.2.2.2.2.5"><apply id="alg2.l16.m2.2.2.2.2.5.1.cmml" xref="alg2.l16.m2.2.2.2.2.5.1"><csymbol cd="ambiguous" id="alg2.l16.m2.2.2.2.2.5.1.1.cmml" xref="alg2.l16.m2.2.2.2.2.5.1">subscript</csymbol><ci id="alg2.l16.m2.2.2.2.2.5.1.2.cmml" xref="alg2.l16.m2.2.2.2.2.5.1.2">∇</ci><apply id="alg2.l16.m2.2.2.2.2.5.1.3.cmml" xref="alg2.l16.m2.2.2.2.2.5.1.3"><csymbol cd="ambiguous" id="alg2.l16.m2.2.2.2.2.5.1.3.1.cmml" xref="alg2.l16.m2.2.2.2.2.5.1.3">subscript</csymbol><apply id="alg2.l16.m2.2.2.2.2.5.1.3.2.cmml" xref="alg2.l16.m2.2.2.2.2.5.1.3.2"><ci id="alg2.l16.m2.2.2.2.2.5.1.3.2.1.cmml" xref="alg2.l16.m2.2.2.2.2.5.1.3.2.1">^</ci><ci id="alg2.l16.m2.2.2.2.2.5.1.3.2.2.cmml" xref="alg2.l16.m2.2.2.2.2.5.1.3.2.2">𝜃</ci></apply><ci id="alg2.l16.m2.2.2.2.2.5.1.3.3.cmml" xref="alg2.l16.m2.2.2.2.2.5.1.3.3">𝑘</ci></apply></apply><ci id="alg2.l16.m2.2.2.2.2.5.2.cmml" xref="alg2.l16.m2.2.2.2.2.5.2">ℒ</ci></apply><list id="alg2.l16.m2.2.2.2.2.2.3.cmml" xref="alg2.l16.m2.2.2.2.2.2.2"><apply id="alg2.l16.m2.1.1.1.1.1.1.1.cmml" xref="alg2.l16.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l16.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l16.m2.1.1.1.1.1.1.1.2.cmml" xref="alg2.l16.m2.1.1.1.1.1.1.1.2"><ci id="alg2.l16.m2.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l16.m2.1.1.1.1.1.1.1.2.1">^</ci><ci id="alg2.l16.m2.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l16.m2.1.1.1.1.1.1.1.2.2">𝜃</ci></apply><ci id="alg2.l16.m2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l16.m2.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg2.l16.m2.2.2.2.2.2.2.2.cmml" xref="alg2.l16.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l16.m2.2.2.2.2.2.2.2.1.cmml" xref="alg2.l16.m2.2.2.2.2.2.2.2">superscript</csymbol><apply id="alg2.l16.m2.2.2.2.2.2.2.2.2.cmml" xref="alg2.l16.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l16.m2.2.2.2.2.2.2.2.2.1.cmml" xref="alg2.l16.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l16.m2.2.2.2.2.2.2.2.2.2.cmml" xref="alg2.l16.m2.2.2.2.2.2.2.2.2.2">𝑑</ci><ci id="alg2.l16.m2.2.2.2.2.2.2.2.2.3.cmml" xref="alg2.l16.m2.2.2.2.2.2.2.2.2.3">𝑇</ci></apply><ci id="alg2.l16.m2.2.2.2.2.2.2.2.3.cmml" xref="alg2.l16.m2.2.2.2.2.2.2.2.3">′</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m2.2c">\hat{\theta}_{k}\!\leftarrow\!\hat{\theta}_{k}\!-\!\alpha\nabla_{\hat{\theta}_{k}}\mathcal{L}(\hat{\theta}_{k};d_{T}^{\prime})</annotation></semantics></math>
         
</div>
<div id="alg2.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>         <math id="alg2.l17.m1.1" class="ltx_Math" alttext="\theta_{k}\leftarrow\theta_{k}-\beta(\hat{\theta}_{k}-\theta_{k})" display="inline"><semantics id="alg2.l17.m1.1a"><mrow id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml"><msub id="alg2.l17.m1.1.1.3" xref="alg2.l17.m1.1.1.3.cmml"><mi id="alg2.l17.m1.1.1.3.2" xref="alg2.l17.m1.1.1.3.2.cmml">θ</mi><mi id="alg2.l17.m1.1.1.3.3" xref="alg2.l17.m1.1.1.3.3.cmml">k</mi></msub><mo stretchy="false" id="alg2.l17.m1.1.1.2" xref="alg2.l17.m1.1.1.2.cmml">←</mo><mrow id="alg2.l17.m1.1.1.1" xref="alg2.l17.m1.1.1.1.cmml"><msub id="alg2.l17.m1.1.1.1.3" xref="alg2.l17.m1.1.1.1.3.cmml"><mi id="alg2.l17.m1.1.1.1.3.2" xref="alg2.l17.m1.1.1.1.3.2.cmml">θ</mi><mi id="alg2.l17.m1.1.1.1.3.3" xref="alg2.l17.m1.1.1.1.3.3.cmml">k</mi></msub><mo id="alg2.l17.m1.1.1.1.2" xref="alg2.l17.m1.1.1.1.2.cmml">−</mo><mrow id="alg2.l17.m1.1.1.1.1" xref="alg2.l17.m1.1.1.1.1.cmml"><mi id="alg2.l17.m1.1.1.1.1.3" xref="alg2.l17.m1.1.1.1.1.3.cmml">β</mi><mo lspace="0em" rspace="0em" id="alg2.l17.m1.1.1.1.1.2" xref="alg2.l17.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l17.m1.1.1.1.1.1.1" xref="alg2.l17.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l17.m1.1.1.1.1.1.1.2" xref="alg2.l17.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l17.m1.1.1.1.1.1.1.1" xref="alg2.l17.m1.1.1.1.1.1.1.1.cmml"><msub id="alg2.l17.m1.1.1.1.1.1.1.1.2" xref="alg2.l17.m1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="alg2.l17.m1.1.1.1.1.1.1.1.2.2" xref="alg2.l17.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg2.l17.m1.1.1.1.1.1.1.1.2.2.2" xref="alg2.l17.m1.1.1.1.1.1.1.1.2.2.2.cmml">θ</mi><mo id="alg2.l17.m1.1.1.1.1.1.1.1.2.2.1" xref="alg2.l17.m1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="alg2.l17.m1.1.1.1.1.1.1.1.2.3" xref="alg2.l17.m1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo id="alg2.l17.m1.1.1.1.1.1.1.1.1" xref="alg2.l17.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg2.l17.m1.1.1.1.1.1.1.1.3" xref="alg2.l17.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg2.l17.m1.1.1.1.1.1.1.1.3.2" xref="alg2.l17.m1.1.1.1.1.1.1.1.3.2.cmml">θ</mi><mi id="alg2.l17.m1.1.1.1.1.1.1.1.3.3" xref="alg2.l17.m1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="alg2.l17.m1.1.1.1.1.1.1.3" xref="alg2.l17.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.1b"><apply id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1"><ci id="alg2.l17.m1.1.1.2.cmml" xref="alg2.l17.m1.1.1.2">←</ci><apply id="alg2.l17.m1.1.1.3.cmml" xref="alg2.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.3.1.cmml" xref="alg2.l17.m1.1.1.3">subscript</csymbol><ci id="alg2.l17.m1.1.1.3.2.cmml" xref="alg2.l17.m1.1.1.3.2">𝜃</ci><ci id="alg2.l17.m1.1.1.3.3.cmml" xref="alg2.l17.m1.1.1.3.3">𝑘</ci></apply><apply id="alg2.l17.m1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1"><minus id="alg2.l17.m1.1.1.1.2.cmml" xref="alg2.l17.m1.1.1.1.2"></minus><apply id="alg2.l17.m1.1.1.1.3.cmml" xref="alg2.l17.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.1.3.1.cmml" xref="alg2.l17.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l17.m1.1.1.1.3.2.cmml" xref="alg2.l17.m1.1.1.1.3.2">𝜃</ci><ci id="alg2.l17.m1.1.1.1.3.3.cmml" xref="alg2.l17.m1.1.1.1.3.3">𝑘</ci></apply><apply id="alg2.l17.m1.1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1.1"><times id="alg2.l17.m1.1.1.1.1.2.cmml" xref="alg2.l17.m1.1.1.1.1.2"></times><ci id="alg2.l17.m1.1.1.1.1.3.cmml" xref="alg2.l17.m1.1.1.1.1.3">𝛽</ci><apply id="alg2.l17.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1.1.1.1"><minus id="alg2.l17.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.1"></minus><apply id="alg2.l17.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="alg2.l17.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.2.2"><ci id="alg2.l17.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="alg2.l17.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.2.2.2">𝜃</ci></apply><ci id="alg2.l17.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="alg2.l17.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg2.l17.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.3.2">𝜃</ci><ci id="alg2.l17.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.1c">\theta_{k}\leftarrow\theta_{k}-\beta(\hat{\theta}_{k}-\theta_{k})</annotation></semantics></math>     <math id="alg2.l17.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l17.m2.1a"><mrow id="alg2.l17.m2.1.1" xref="alg2.l17.m2.1.1.cmml"><mrow id="alg2.l17.m2.1.1.2" xref="alg2.l17.m2.1.1.2a.cmml"></mrow><mo id="alg2.l17.m2.1.1.3" xref="alg2.l17.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m2.1b"><apply id="alg2.l17.m2.1.1.cmml" xref="alg2.l17.m2.1.1"><csymbol cd="latexml" id="alg2.l17.m2.1.1.1.cmml" xref="alg2.l17.m2.1.1">limit-from</csymbol><ci id="alg2.l17.m2.1.1.2a.cmml" xref="alg2.l17.m2.1.1.2"><mrow id="alg2.l17.m2.1.1.2.cmml" xref="alg2.l17.m2.1.1.2"></mrow></ci><ci id="alg2.l17.m2.1.1.3.cmml" xref="alg2.l17.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l17.2" class="ltx_text ltx_font_typewriter">1st order approximation update</span>
     
</div>
<div id="alg2.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l18.2.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>     <math id="alg2.l18.m1.1" class="ltx_Math" alttext="\theta_{T}=\frac{1}{S+1}\sum_{k=1}^{S+1}\theta_{k}" display="inline"><semantics id="alg2.l18.m1.1a"><mrow id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml"><msub id="alg2.l18.m1.1.1.2" xref="alg2.l18.m1.1.1.2.cmml"><mi id="alg2.l18.m1.1.1.2.2" xref="alg2.l18.m1.1.1.2.2.cmml">θ</mi><mi id="alg2.l18.m1.1.1.2.3" xref="alg2.l18.m1.1.1.2.3.cmml">T</mi></msub><mo id="alg2.l18.m1.1.1.1" xref="alg2.l18.m1.1.1.1.cmml">=</mo><mrow id="alg2.l18.m1.1.1.3" xref="alg2.l18.m1.1.1.3.cmml"><mfrac id="alg2.l18.m1.1.1.3.2" xref="alg2.l18.m1.1.1.3.2.cmml"><mn id="alg2.l18.m1.1.1.3.2.2" xref="alg2.l18.m1.1.1.3.2.2.cmml">1</mn><mrow id="alg2.l18.m1.1.1.3.2.3" xref="alg2.l18.m1.1.1.3.2.3.cmml"><mi id="alg2.l18.m1.1.1.3.2.3.2" xref="alg2.l18.m1.1.1.3.2.3.2.cmml">S</mi><mo id="alg2.l18.m1.1.1.3.2.3.1" xref="alg2.l18.m1.1.1.3.2.3.1.cmml">+</mo><mn id="alg2.l18.m1.1.1.3.2.3.3" xref="alg2.l18.m1.1.1.3.2.3.3.cmml">1</mn></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg2.l18.m1.1.1.3.1" xref="alg2.l18.m1.1.1.3.1.cmml">​</mo><mrow id="alg2.l18.m1.1.1.3.3" xref="alg2.l18.m1.1.1.3.3.cmml"><msubsup id="alg2.l18.m1.1.1.3.3.1" xref="alg2.l18.m1.1.1.3.3.1.cmml"><mo id="alg2.l18.m1.1.1.3.3.1.2.2" xref="alg2.l18.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="alg2.l18.m1.1.1.3.3.1.2.3" xref="alg2.l18.m1.1.1.3.3.1.2.3.cmml"><mi id="alg2.l18.m1.1.1.3.3.1.2.3.2" xref="alg2.l18.m1.1.1.3.3.1.2.3.2.cmml">k</mi><mo id="alg2.l18.m1.1.1.3.3.1.2.3.1" xref="alg2.l18.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="alg2.l18.m1.1.1.3.3.1.2.3.3" xref="alg2.l18.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mrow id="alg2.l18.m1.1.1.3.3.1.3" xref="alg2.l18.m1.1.1.3.3.1.3.cmml"><mi id="alg2.l18.m1.1.1.3.3.1.3.2" xref="alg2.l18.m1.1.1.3.3.1.3.2.cmml">S</mi><mo id="alg2.l18.m1.1.1.3.3.1.3.1" xref="alg2.l18.m1.1.1.3.3.1.3.1.cmml">+</mo><mn id="alg2.l18.m1.1.1.3.3.1.3.3" xref="alg2.l18.m1.1.1.3.3.1.3.3.cmml">1</mn></mrow></msubsup><msub id="alg2.l18.m1.1.1.3.3.2" xref="alg2.l18.m1.1.1.3.3.2.cmml"><mi id="alg2.l18.m1.1.1.3.3.2.2" xref="alg2.l18.m1.1.1.3.3.2.2.cmml">θ</mi><mi id="alg2.l18.m1.1.1.3.3.2.3" xref="alg2.l18.m1.1.1.3.3.2.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.1b"><apply id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1"><eq id="alg2.l18.m1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1"></eq><apply id="alg2.l18.m1.1.1.2.cmml" xref="alg2.l18.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.2.1.cmml" xref="alg2.l18.m1.1.1.2">subscript</csymbol><ci id="alg2.l18.m1.1.1.2.2.cmml" xref="alg2.l18.m1.1.1.2.2">𝜃</ci><ci id="alg2.l18.m1.1.1.2.3.cmml" xref="alg2.l18.m1.1.1.2.3">𝑇</ci></apply><apply id="alg2.l18.m1.1.1.3.cmml" xref="alg2.l18.m1.1.1.3"><times id="alg2.l18.m1.1.1.3.1.cmml" xref="alg2.l18.m1.1.1.3.1"></times><apply id="alg2.l18.m1.1.1.3.2.cmml" xref="alg2.l18.m1.1.1.3.2"><divide id="alg2.l18.m1.1.1.3.2.1.cmml" xref="alg2.l18.m1.1.1.3.2"></divide><cn type="integer" id="alg2.l18.m1.1.1.3.2.2.cmml" xref="alg2.l18.m1.1.1.3.2.2">1</cn><apply id="alg2.l18.m1.1.1.3.2.3.cmml" xref="alg2.l18.m1.1.1.3.2.3"><plus id="alg2.l18.m1.1.1.3.2.3.1.cmml" xref="alg2.l18.m1.1.1.3.2.3.1"></plus><ci id="alg2.l18.m1.1.1.3.2.3.2.cmml" xref="alg2.l18.m1.1.1.3.2.3.2">𝑆</ci><cn type="integer" id="alg2.l18.m1.1.1.3.2.3.3.cmml" xref="alg2.l18.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="alg2.l18.m1.1.1.3.3.cmml" xref="alg2.l18.m1.1.1.3.3"><apply id="alg2.l18.m1.1.1.3.3.1.cmml" xref="alg2.l18.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.3.1.1.cmml" xref="alg2.l18.m1.1.1.3.3.1">superscript</csymbol><apply id="alg2.l18.m1.1.1.3.3.1.2.cmml" xref="alg2.l18.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.3.1.2.1.cmml" xref="alg2.l18.m1.1.1.3.3.1">subscript</csymbol><sum id="alg2.l18.m1.1.1.3.3.1.2.2.cmml" xref="alg2.l18.m1.1.1.3.3.1.2.2"></sum><apply id="alg2.l18.m1.1.1.3.3.1.2.3.cmml" xref="alg2.l18.m1.1.1.3.3.1.2.3"><eq id="alg2.l18.m1.1.1.3.3.1.2.3.1.cmml" xref="alg2.l18.m1.1.1.3.3.1.2.3.1"></eq><ci id="alg2.l18.m1.1.1.3.3.1.2.3.2.cmml" xref="alg2.l18.m1.1.1.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg2.l18.m1.1.1.3.3.1.2.3.3.cmml" xref="alg2.l18.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="alg2.l18.m1.1.1.3.3.1.3.cmml" xref="alg2.l18.m1.1.1.3.3.1.3"><plus id="alg2.l18.m1.1.1.3.3.1.3.1.cmml" xref="alg2.l18.m1.1.1.3.3.1.3.1"></plus><ci id="alg2.l18.m1.1.1.3.3.1.3.2.cmml" xref="alg2.l18.m1.1.1.3.3.1.3.2">𝑆</ci><cn type="integer" id="alg2.l18.m1.1.1.3.3.1.3.3.cmml" xref="alg2.l18.m1.1.1.3.3.1.3.3">1</cn></apply></apply><apply id="alg2.l18.m1.1.1.3.3.2.cmml" xref="alg2.l18.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.3.2.1.cmml" xref="alg2.l18.m1.1.1.3.3.2">subscript</csymbol><ci id="alg2.l18.m1.1.1.3.3.2.2.cmml" xref="alg2.l18.m1.1.1.3.3.2.2">𝜃</ci><ci id="alg2.l18.m1.1.1.3.3.2.3.cmml" xref="alg2.l18.m1.1.1.3.3.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.1c">\theta_{T}=\frac{1}{S+1}\sum_{k=1}^{S+1}\theta_{k}</annotation></semantics></math> <math id="alg2.l18.m2.1" class="ltx_Math" alttext="\lx@algorithmicx@hfill\triangleright" display="inline"><semantics id="alg2.l18.m2.1a"><mrow id="alg2.l18.m2.1.1" xref="alg2.l18.m2.1.1.cmml"><mrow id="alg2.l18.m2.1.1.2" xref="alg2.l18.m2.1.1.2a.cmml"></mrow><mo id="alg2.l18.m2.1.1.3" xref="alg2.l18.m2.1.1.3.cmml">▷</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m2.1b"><apply id="alg2.l18.m2.1.1.cmml" xref="alg2.l18.m2.1.1"><csymbol cd="latexml" id="alg2.l18.m2.1.1.1.cmml" xref="alg2.l18.m2.1.1">limit-from</csymbol><ci id="alg2.l18.m2.1.1.2a.cmml" xref="alg2.l18.m2.1.1.2"><mrow id="alg2.l18.m2.1.1.2.cmml" xref="alg2.l18.m2.1.1.2"></mrow></ci><ci id="alg2.l18.m2.1.1.3.cmml" xref="alg2.l18.m2.1.1.3">▷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m2.1c">\lx@algorithmicx@hfill\triangleright</annotation></semantics></math> <span id="alg2.l18.1" class="ltx_text ltx_framed ltx_framed_underline"><em id="alg2.l18.1.1" class="ltx_emph ltx_font_italic">Update <math id="alg2.l18.1.1.m1.1" class="ltx_Math" alttext="\theta_{T}" display="inline"><semantics id="alg2.l18.1.1.m1.1a"><msub id="alg2.l18.1.1.m1.1.1" xref="alg2.l18.1.1.m1.1.1.cmml"><mi id="alg2.l18.1.1.m1.1.1.2" xref="alg2.l18.1.1.m1.1.1.2.cmml">θ</mi><mi id="alg2.l18.1.1.m1.1.1.3" xref="alg2.l18.1.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l18.1.1.m1.1b"><apply id="alg2.l18.1.1.m1.1.1.cmml" xref="alg2.l18.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l18.1.1.m1.1.1.1.cmml" xref="alg2.l18.1.1.m1.1.1">subscript</csymbol><ci id="alg2.l18.1.1.m1.1.1.2.cmml" xref="alg2.l18.1.1.m1.1.1.2">𝜃</ci><ci id="alg2.l18.1.1.m1.1.1.3.cmml" xref="alg2.l18.1.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.1.1.m1.1c">\theta_{T}</annotation></semantics></math> and <span id="alg2.l18.1.1.1" class="ltx_text ltx_font_bold">SEND</span> to Source nodes</em></span>

</div>
</div>
</figure>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.6" class="ltx_p">Alg. <a href="#alg2" title="Algorithm 2 ‣ 3.2 Source-Target Remote Gradient Alignment for FedPDA ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents the distributed <span id="S3.SS2.p3.6.1" class="ltx_text ltx_font_typewriter">StarAlign</span> method that aligns gradients between all source-target domain pairs. First, target and source node models get initialised with the pre-trained model <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\theta_{T}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">θ</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝜃</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\theta_{T}</annotation></semantics></math> (<em id="S3.SS2.p3.6.2" class="ltx_emph ltx_font_italic">L1</em>). Each source node <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">s</annotation></semantics></math> computes its average gradient direction <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\overline{g}_{s}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mover accent="true" id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2.2" xref="S3.SS2.p3.3.m3.1.1.2.2.cmml">g</mi><mo id="S3.SS2.p3.3.m3.1.1.2.1" xref="S3.SS2.p3.3.m3.1.1.2.1.cmml">¯</mo></mover><mi id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><apply id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2"><ci id="S3.SS2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1.2.1">¯</ci><ci id="S3.SS2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2.2">𝑔</ci></apply><ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\overline{g}_{s}</annotation></semantics></math> and communicates it to the target node (<em id="S3.SS2.p3.6.3" class="ltx_emph ltx_font_italic">L3-L9</em>).
After receiving the average gradient directions of source domains, the target node performs the interleaving approximated updates (<span id="S3.SS2.p3.6.4" class="ltx_text ltx_font_italic">L14-15</span>) for source and target domain gradients for each domain pair for <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><mi id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\tau</annotation></semantics></math> steps. <em id="S3.SS2.p3.6.5" class="ltx_emph ltx_font_italic">L16</em> implements the case of the target-target pair (Sec. <a href="#S3.SS1" title="3.1 Theoretical Derivation of Source-Target Alignment ‣ 3 Method ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>) with a second actual update rather than approximation. Finally, <span id="S3.SS2.p3.6.6" class="ltx_text ltx_font_italic">L17</span> performs the first-order approximation update. Note, that we perform this update step after <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">\tau</annotation></semantics></math> steps, which we found empirically to give better results than performing it after each interleaving update.
This process is repeated for <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">E</annotation></semantics></math> communication rounds.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text ltx_font_bold">Cancer detection:</span> We use Camelyon17 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> dataset. The goal is to predict whether a histology image contains cancer (binary classification). The data was collected from 5 different hospitals, which we treat as 5 domains.
<br class="ltx_break"><span id="S4.p1.1.2" class="ltx_text ltx_font_bold">Skin lesion diagnosis:</span> We train a model to classify 7 skin lesion types in dermatoscopic images. To create a multi-domain benchmark, we downloaded four public datasets acquired at 4 medical centers: HAM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, BCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, MSK <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> and D7P <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. Due to missing classes in MSK and D7P, we combine them in one that contains all classes. Therefore we experiment with 3 domains.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Test accuracy (%) on tumour detection (3 seeds averaged).</figcaption>
<div id="S4.T1.15" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:163.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-69.2pt,26.1pt) scale(0.757919615242522,0.757919615242522) ;">
<table id="S4.T1.15.15" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2">Method</th>
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><math id="S4.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="D_{T}" display="inline"><semantics id="S4.T1.1.1.1.1.m1.1a"><msub id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml"><mi id="S4.T1.1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.1.m1.1.1.2.cmml">D</mi><mi id="S4.T1.1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.1.m1.1.1.2">𝐷</ci><ci id="S4.T1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">D_{T}</annotation></semantics></math></th>
<th id="S4.T1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" colspan="5">Target domain</th>
<td id="S4.T1.1.1.1.4" class="ltx_td ltx_nopad_r ltx_border_tt"></td>
</tr>
<tr id="S4.T1.15.15.16.1" class="ltx_tr">
<th id="S4.T1.15.15.16.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Pre-Train</th>
<th id="S4.T1.15.15.16.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Adapt</th>
<th id="S4.T1.15.15.16.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">Lab.</th>
<th id="S4.T1.15.15.16.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t">Unlab.</th>
<th id="S4.T1.15.15.16.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Hospital 1</th>
<th id="S4.T1.15.15.16.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Hospital 2</th>
<th id="S4.T1.15.15.16.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Hospital 3</th>
<th id="S4.T1.15.15.16.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Hospital 4</th>
<th id="S4.T1.15.15.16.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Hospital 5</th>
<th id="S4.T1.15.15.16.1.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t">Average</th>
</tr>
<tr id="S4.T1.3.3.3" class="ltx_tr">
<th id="S4.T1.3.3.3.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAvg</th>
<th id="S4.T1.3.3.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">None</th>
<th id="S4.T1.2.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><math id="S4.T1.2.2.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.2.2.2.1.m1.1a"><mo id="S4.T1.2.2.2.1.m1.1.1" xref="S4.T1.2.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.1.m1.1b"><times id="S4.T1.2.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.1.m1.1c">\times</annotation></semantics></math></th>
<th id="S4.T1.3.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><math id="S4.T1.3.3.3.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.3.3.3.2.m1.1a"><mo id="S4.T1.3.3.3.2.m1.1.1" xref="S4.T1.3.3.3.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.2.m1.1b"><times id="S4.T1.3.3.3.2.m1.1.1.cmml" xref="S4.T1.3.3.3.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.2.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T1.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t">88.0</td>
<td id="S4.T1.3.3.3.6" class="ltx_td ltx_align_center ltx_border_t">80.5</td>
<td id="S4.T1.3.3.3.7" class="ltx_td ltx_align_center ltx_border_t">76.2</td>
<td id="S4.T1.3.3.3.8" class="ltx_td ltx_align_center ltx_border_t">85.4</td>
<td id="S4.T1.3.3.3.9" class="ltx_td ltx_align_center ltx_border_t">75.2</td>
<td id="S4.T1.3.3.3.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">81.1</td>
</tr>
<tr id="S4.T1.4.4.4" class="ltx_tr">
<th id="S4.T1.4.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">None</th>
<th id="S4.T1.4.4.4.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">From scratch</th>
<th id="S4.T1.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_row">✓</th>
<th id="S4.T1.4.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T1.4.4.4.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.4.4.4.1.m1.1a"><mo id="S4.T1.4.4.4.1.m1.1.1" xref="S4.T1.4.4.4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.1.m1.1b"><times id="S4.T1.4.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.1.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T1.4.4.4.5" class="ltx_td ltx_align_center">92.7</td>
<td id="S4.T1.4.4.4.6" class="ltx_td ltx_align_center">88.4</td>
<td id="S4.T1.4.4.4.7" class="ltx_td ltx_align_center">92.9</td>
<td id="S4.T1.4.4.4.8" class="ltx_td ltx_align_center">91.3</td>
<td id="S4.T1.4.4.4.9" class="ltx_td ltx_align_center">94.7</td>
<td id="S4.T1.4.4.4.10" class="ltx_td ltx_nopad_r ltx_align_center">92.0</td>
</tr>
<tr id="S4.T1.7.7.7" class="ltx_tr">
<th id="S4.T1.7.7.7.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedBN</th>
<th id="S4.T1.5.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">None (avg. <math id="S4.T1.5.5.5.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{S}" display="inline"><semantics id="S4.T1.5.5.5.1.m1.1a"><msub id="S4.T1.5.5.5.1.m1.1.1" xref="S4.T1.5.5.5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.5.5.5.1.m1.1.1.2" xref="S4.T1.5.5.5.1.m1.1.1.2.cmml">𝒟</mi><mi id="S4.T1.5.5.5.1.m1.1.1.3" xref="S4.T1.5.5.5.1.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.1.m1.1b"><apply id="S4.T1.5.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.5.5.5.1.m1.1.1.1.cmml" xref="S4.T1.5.5.5.1.m1.1.1">subscript</csymbol><ci id="S4.T1.5.5.5.1.m1.1.1.2.cmml" xref="S4.T1.5.5.5.1.m1.1.1.2">𝒟</ci><ci id="S4.T1.5.5.5.1.m1.1.1.3.cmml" xref="S4.T1.5.5.5.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.1.m1.1c">\mathcal{D}_{S}</annotation></semantics></math> BN stats)</th>
<th id="S4.T1.6.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T1.6.6.6.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.6.6.6.2.m1.1a"><mo id="S4.T1.6.6.6.2.m1.1.1" xref="S4.T1.6.6.6.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.2.m1.1b"><times id="S4.T1.6.6.6.2.m1.1.1.cmml" xref="S4.T1.6.6.6.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.2.m1.1c">\times</annotation></semantics></math></th>
<th id="S4.T1.7.7.7.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T1.7.7.7.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.7.7.7.3.m1.1a"><mo id="S4.T1.7.7.7.3.m1.1.1" xref="S4.T1.7.7.7.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.3.m1.1b"><times id="S4.T1.7.7.7.3.m1.1.1.cmml" xref="S4.T1.7.7.7.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.3.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T1.7.7.7.5" class="ltx_td ltx_align_center">50.3</td>
<td id="S4.T1.7.7.7.6" class="ltx_td ltx_align_center">53.8</td>
<td id="S4.T1.7.7.7.7" class="ltx_td ltx_align_center">70.7</td>
<td id="S4.T1.7.7.7.8" class="ltx_td ltx_align_center">50.0</td>
<td id="S4.T1.7.7.7.9" class="ltx_td ltx_align_center">74.3</td>
<td id="S4.T1.7.7.7.10" class="ltx_td ltx_nopad_r ltx_align_center">59.8</td>
</tr>
<tr id="S4.T1.9.9.9" class="ltx_tr">
<th id="S4.T1.9.9.9.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedBN</th>
<th id="S4.T1.8.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">None (<math id="S4.T1.8.8.8.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{T}" display="inline"><semantics id="S4.T1.8.8.8.1.m1.1a"><msub id="S4.T1.8.8.8.1.m1.1.1" xref="S4.T1.8.8.8.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.8.8.8.1.m1.1.1.2" xref="S4.T1.8.8.8.1.m1.1.1.2.cmml">𝒟</mi><mi id="S4.T1.8.8.8.1.m1.1.1.3" xref="S4.T1.8.8.8.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.8.1.m1.1b"><apply id="S4.T1.8.8.8.1.m1.1.1.cmml" xref="S4.T1.8.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.8.8.8.1.m1.1.1.1.cmml" xref="S4.T1.8.8.8.1.m1.1.1">subscript</csymbol><ci id="S4.T1.8.8.8.1.m1.1.1.2.cmml" xref="S4.T1.8.8.8.1.m1.1.1.2">𝒟</ci><ci id="S4.T1.8.8.8.1.m1.1.1.3.cmml" xref="S4.T1.8.8.8.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.8.1.m1.1c">\mathcal{D}_{T}</annotation></semantics></math> BN stats)</th>
<th id="S4.T1.9.9.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T1.9.9.9.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.9.9.9.2.m1.1a"><mo id="S4.T1.9.9.9.2.m1.1.1" xref="S4.T1.9.9.9.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.9.2.m1.1b"><times id="S4.T1.9.9.9.2.m1.1.1.cmml" xref="S4.T1.9.9.9.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.9.2.m1.1c">\times</annotation></semantics></math></th>
<th id="S4.T1.9.9.9.4" class="ltx_td ltx_align_center ltx_th ltx_th_row">✓</th>
<td id="S4.T1.9.9.9.5" class="ltx_td ltx_align_center">89.4</td>
<td id="S4.T1.9.9.9.6" class="ltx_td ltx_align_center">84.5</td>
<td id="S4.T1.9.9.9.7" class="ltx_td ltx_align_center">89.6</td>
<td id="S4.T1.9.9.9.8" class="ltx_td ltx_align_center">91.4</td>
<td id="S4.T1.9.9.9.9" class="ltx_td ltx_align_center">84.8</td>
<td id="S4.T1.9.9.9.10" class="ltx_td ltx_nopad_r ltx_align_center">87.9</td>
</tr>
<tr id="S4.T1.10.10.10" class="ltx_tr">
<th id="S4.T1.10.10.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedBN</th>
<th id="S4.T1.10.10.10.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">Fine-tuning</th>
<th id="S4.T1.10.10.10.4" class="ltx_td ltx_align_center ltx_th ltx_th_row">✓</th>
<th id="S4.T1.10.10.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T1.10.10.10.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.10.10.10.1.m1.1a"><mo id="S4.T1.10.10.10.1.m1.1.1" xref="S4.T1.10.10.10.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.10.10.10.1.m1.1b"><times id="S4.T1.10.10.10.1.m1.1.1.cmml" xref="S4.T1.10.10.10.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.10.10.1.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T1.10.10.10.5" class="ltx_td ltx_align_center">93.1</td>
<td id="S4.T1.10.10.10.6" class="ltx_td ltx_align_center">88.2</td>
<td id="S4.T1.10.10.10.7" class="ltx_td ltx_align_center">93.7</td>
<td id="S4.T1.10.10.10.8" class="ltx_td ltx_align_center">95.8</td>
<td id="S4.T1.10.10.10.9" class="ltx_td ltx_align_center"><span id="S4.T1.10.10.10.9.1" class="ltx_text ltx_font_bold">97.2</span></td>
<td id="S4.T1.10.10.10.10" class="ltx_td ltx_nopad_r ltx_align_center">93.6</td>
</tr>
<tr id="S4.T1.11.11.11" class="ltx_tr">
<th id="S4.T1.11.11.11.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedBN</th>
<th id="S4.T1.11.11.11.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">Supervised TENT</th>
<th id="S4.T1.11.11.11.4" class="ltx_td ltx_align_center ltx_th ltx_th_row">✓</th>
<th id="S4.T1.11.11.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T1.11.11.11.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.11.11.11.1.m1.1a"><mo id="S4.T1.11.11.11.1.m1.1.1" xref="S4.T1.11.11.11.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.11.1.m1.1b"><times id="S4.T1.11.11.11.1.m1.1.1.cmml" xref="S4.T1.11.11.11.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.11.1.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T1.11.11.11.5" class="ltx_td ltx_align_center">92.8</td>
<td id="S4.T1.11.11.11.6" class="ltx_td ltx_align_center">86.8</td>
<td id="S4.T1.11.11.11.7" class="ltx_td ltx_align_center">91.6</td>
<td id="S4.T1.11.11.11.8" class="ltx_td ltx_align_center">94.1</td>
<td id="S4.T1.11.11.11.9" class="ltx_td ltx_align_center">93.1</td>
<td id="S4.T1.11.11.11.10" class="ltx_td ltx_nopad_r ltx_align_center">91.7</td>
</tr>
<tr id="S4.T1.12.12.12" class="ltx_tr">
<th id="S4.T1.12.12.12.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedBN</th>
<th id="S4.T1.12.12.12.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedPDA: FedBN</th>
<th id="S4.T1.12.12.12.4" class="ltx_td ltx_align_center ltx_th ltx_th_row">✓</th>
<th id="S4.T1.12.12.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T1.12.12.12.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.12.12.12.1.m1.1a"><mo id="S4.T1.12.12.12.1.m1.1.1" xref="S4.T1.12.12.12.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.12.12.12.1.m1.1b"><times id="S4.T1.12.12.12.1.m1.1.1.cmml" xref="S4.T1.12.12.12.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.12.12.1.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T1.12.12.12.5" class="ltx_td ltx_align_center">91.7</td>
<td id="S4.T1.12.12.12.6" class="ltx_td ltx_align_center">75.7</td>
<td id="S4.T1.12.12.12.7" class="ltx_td ltx_align_center">94.7</td>
<td id="S4.T1.12.12.12.8" class="ltx_td ltx_align_center">83.3</td>
<td id="S4.T1.12.12.12.9" class="ltx_td ltx_align_center">55.2</td>
<td id="S4.T1.12.12.12.10" class="ltx_td ltx_nopad_r ltx_align_center">80.1</td>
</tr>
<tr id="S4.T1.13.13.13" class="ltx_tr">
<th id="S4.T1.13.13.13.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedBN</th>
<th id="S4.T1.13.13.13.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedPDA: PCGrad</th>
<th id="S4.T1.13.13.13.4" class="ltx_td ltx_align_center ltx_th ltx_th_row">✓</th>
<th id="S4.T1.13.13.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T1.13.13.13.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.13.13.13.1.m1.1a"><mo id="S4.T1.13.13.13.1.m1.1.1" xref="S4.T1.13.13.13.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.13.13.13.1.m1.1b"><times id="S4.T1.13.13.13.1.m1.1.1.cmml" xref="S4.T1.13.13.13.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.13.13.1.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T1.13.13.13.5" class="ltx_td ltx_align_center">93.8</td>
<td id="S4.T1.13.13.13.6" class="ltx_td ltx_align_center">90.0</td>
<td id="S4.T1.13.13.13.7" class="ltx_td ltx_align_center">94.9</td>
<td id="S4.T1.13.13.13.8" class="ltx_td ltx_align_center">95.1</td>
<td id="S4.T1.13.13.13.9" class="ltx_td ltx_align_center">95.0</td>
<td id="S4.T1.13.13.13.10" class="ltx_td ltx_nopad_r ltx_align_center">93.8</td>
</tr>
<tr id="S4.T1.14.14.14" class="ltx_tr">
<th id="S4.T1.14.14.14.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedBN</th>
<th id="S4.T1.14.14.14.3" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedPDA: StarAlign</th>
<th id="S4.T1.14.14.14.4" class="ltx_td ltx_align_center ltx_th ltx_th_row">✓</th>
<th id="S4.T1.14.14.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T1.14.14.14.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.14.14.14.1.m1.1a"><mo id="S4.T1.14.14.14.1.m1.1.1" xref="S4.T1.14.14.14.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.14.14.14.1.m1.1b"><times id="S4.T1.14.14.14.1.m1.1.1.cmml" xref="S4.T1.14.14.14.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.14.14.1.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T1.14.14.14.5" class="ltx_td ltx_align_center"><span id="S4.T1.14.14.14.5.1" class="ltx_text ltx_font_bold">95.0</span></td>
<td id="S4.T1.14.14.14.6" class="ltx_td ltx_align_center"><span id="S4.T1.14.14.14.6.1" class="ltx_text ltx_font_bold">91.4</span></td>
<td id="S4.T1.14.14.14.7" class="ltx_td ltx_align_center"><span id="S4.T1.14.14.14.7.1" class="ltx_text ltx_font_bold">96.8</span></td>
<td id="S4.T1.14.14.14.8" class="ltx_td ltx_align_center"><span id="S4.T1.14.14.14.8.1" class="ltx_text ltx_font_bold">96.8</span></td>
<td id="S4.T1.14.14.14.9" class="ltx_td ltx_align_center">94.5</td>
<td id="S4.T1.14.14.14.10" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T1.14.14.14.10.1" class="ltx_text ltx_font_bold">94.9</span></td>
</tr>
<tr id="S4.T1.15.15.15" class="ltx_tr">
<th id="S4.T1.15.15.15.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t">None</th>
<th id="S4.T1.15.15.15.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t">FDA-KD3A</th>
<th id="S4.T1.15.15.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t"><math id="S4.T1.15.15.15.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T1.15.15.15.1.m1.1a"><mo id="S4.T1.15.15.15.1.m1.1.1" xref="S4.T1.15.15.15.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T1.15.15.15.1.m1.1b"><times id="S4.T1.15.15.15.1.m1.1.1.cmml" xref="S4.T1.15.15.15.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.15.15.1.m1.1c">\times</annotation></semantics></math></th>
<th id="S4.T1.15.15.15.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t">✓</th>
<td id="S4.T1.15.15.15.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">94.3</td>
<td id="S4.T1.15.15.15.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.15.15.15.6.1" class="ltx_text ltx_font_bold">91.4</span></td>
<td id="S4.T1.15.15.15.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">90.4</td>
<td id="S4.T1.15.15.15.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">93.6</td>
<td id="S4.T1.15.15.15.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">94.3</td>
<td id="S4.T1.15.15.15.10" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t">92.8</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.13" class="ltx_p"><span id="S4.SS1.p1.13.2" class="ltx_text ltx_font_bold">Setup:</span> For all experiments we use DenseNet-121 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. We perform ‘leave-one-domain-out’ evaluations, iterating over each domain. One domain is held-out as target and the rest are used as source domains. Each domain dataset is divided into train, validation and test sets (60,20,20% respectively). The training sets are used for pre-training and in FedPDA for source domains. As we investigate how to adapt with limited labelled data in the target domain, we only use 1.8% of a target domain’s dataset as labelled for PDA on Camelyon17, and 6% for skin-lesion. The process is then repeated for other target domains held-out.
<br class="ltx_break"><span id="S4.SS1.p1.13.3" class="ltx_text ltx_font_bold">Metrics:</span> Each setting is repeated for 3 seeds. From each experiment we select 5 model snapshots with best validation performance and report their average performance on the test set (averaging <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="15" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><cn type="integer" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">15</annotation></semantics></math> models per setting). The two classes in Camelyon17 are balanced, therefore we report <span id="S4.SS1.p1.13.4" class="ltx_text ltx_font_italic">Accuracy</span> (Tab. <a href="#S4.T1" title="Table 1 ‣ 4 Experiments ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). Skin-lesion datasets have high class-imbalance and hence <em id="S4.SS1.p1.13.5" class="ltx_emph ltx_font_italic">Accuracy</em> is inappropriate because methods can increase it by collapsing and predicting solely the majority classes. Instead, we report <em id="S4.SS1.p1.13.6" class="ltx_emph ltx_font_italic">Weighted Accuracy</em> (Tab. <a href="#S4.T2" title="Table 2 ‣ 4.1 Experimental setup ‣ 4 Experiments ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) defined as: <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\sum_{c=1}^{C}\frac{1}{C}\text{acc}_{c}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><msubsup id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml"><mo id="S4.SS1.p1.2.m2.1.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.1.2.2.cmml">∑</mo><mrow id="S4.SS1.p1.2.m2.1.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.1.2.3.cmml"><mi id="S4.SS1.p1.2.m2.1.1.1.2.3.2" xref="S4.SS1.p1.2.m2.1.1.1.2.3.2.cmml">c</mi><mo id="S4.SS1.p1.2.m2.1.1.1.2.3.1" xref="S4.SS1.p1.2.m2.1.1.1.2.3.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.1.1.1.2.3.3" xref="S4.SS1.p1.2.m2.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.2.m2.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.3.cmml">C</mi></msubsup><mrow id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml"><mfrac id="S4.SS1.p1.2.m2.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.cmml"><mn id="S4.SS1.p1.2.m2.1.1.2.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.2.cmml">1</mn><mi id="S4.SS1.p1.2.m2.1.1.2.2.3" xref="S4.SS1.p1.2.m2.1.1.2.2.3.cmml">C</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.SS1.p1.2.m2.1.1.2.1" xref="S4.SS1.p1.2.m2.1.1.2.1.cmml">​</mo><msub id="S4.SS1.p1.2.m2.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.2.3.cmml"><mtext id="S4.SS1.p1.2.m2.1.1.2.3.2" xref="S4.SS1.p1.2.m2.1.1.2.3.2a.cmml">acc</mtext><mi id="S4.SS1.p1.2.m2.1.1.2.3.3" xref="S4.SS1.p1.2.m2.1.1.2.3.3.cmml">c</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><apply id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.2.m2.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1">subscript</csymbol><sum id="S4.SS1.p1.2.m2.1.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.2.2"></sum><apply id="S4.SS1.p1.2.m2.1.1.1.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.2.3"><eq id="S4.SS1.p1.2.m2.1.1.1.2.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.2.3.1"></eq><ci id="S4.SS1.p1.2.m2.1.1.1.2.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.2.3.2">𝑐</ci><cn type="integer" id="S4.SS1.p1.2.m2.1.1.1.2.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.SS1.p1.2.m2.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.3">𝐶</ci></apply><apply id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"><times id="S4.SS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2.1"></times><apply id="S4.SS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2"><divide id="S4.SS1.p1.2.m2.1.1.2.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2"></divide><cn type="integer" id="S4.SS1.p1.2.m2.1.1.2.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2.2">1</cn><ci id="S4.SS1.p1.2.m2.1.1.2.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2.3">𝐶</ci></apply><apply id="S4.SS1.p1.2.m2.1.1.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.2.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.3.2a.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3.2"><mtext id="S4.SS1.p1.2.m2.1.1.2.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3.2">acc</mtext></ci><ci id="S4.SS1.p1.2.m2.1.1.2.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\sum_{c=1}^{C}\frac{1}{C}\text{acc}_{c}</annotation></semantics></math>, where <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">C</annotation></semantics></math> the number of classes and <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="\text{acc}_{c}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mtext id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2a.cmml">acc</mtext><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2a.cmml" xref="S4.SS1.p1.4.m4.1.1.2"><mtext id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">acc</mtext></ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\text{acc}_{c}</annotation></semantics></math> represents accuracy for class <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">c</annotation></semantics></math>.
<br class="ltx_break"><span id="S4.SS1.p1.13.7" class="ltx_text ltx_font_bold">Methods:</span>
The ‘Pre-Train’ column in Table <a href="#S4.T1" title="Table 1 ‣ 4 Experiments ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S4.T2" title="Table 2 ‣ 4.1 Experimental setup ‣ 4 Experiments ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> indicates the pre-deployment training method, employing <span id="S4.SS1.p1.13.8" class="ltx_text ltx_font_typewriter">FedAvg</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> or <span id="S4.SS1.p1.13.9" class="ltx_text ltx_font_typewriter">FedBN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> with <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="\tau=100" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mrow id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><mi id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml">τ</mi><mo id="S4.SS1.p1.6.m6.1.1.1" xref="S4.SS1.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><eq id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1.1"></eq><ci id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2">𝜏</ci><cn type="integer" id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">\tau=100</annotation></semantics></math> local iterations per communication round.
<span id="S4.SS1.p1.13.10" class="ltx_text ltx_font_typewriter">FedBN</span> pre-training is used thereafter as it outperformed <span id="S4.SS1.p1.13.11" class="ltx_text ltx_font_typewriter">FedAvg</span> when BN statistics were adapted (<math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="D_{T}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><msub id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">D</mi><mi id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">𝐷</ci><ci id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">D_{T}</annotation></semantics></math><span id="S4.SS1.p1.13.12" class="ltx_text ltx_font_bold"> BN stats</span> below).
Column ‘Adapt’ indicates the post-deployment adaptation method. ‘Lab’ and ‘Unlab’ indicate whether labelled or unlabelled target data are used for adaptation. We compare <span id="S4.SS1.p1.13.13" class="ltx_text ltx_font_typewriter">StarAlign</span> with: no adaptation (<span id="S4.SS1.p1.13.14" class="ltx_text ltx_font_bold">None</span>), training the model just on target data (<span id="S4.SS1.p1.13.15" class="ltx_text ltx_font_bold">from scratch</span>), <span id="S4.SS1.p1.13.16" class="ltx_text ltx_font_typewriter">FedBN</span> without adaptation using average <span title="" class="ltx_glossaryref">Batch Normalization (BN)</span> statistics from source domains (<span id="S4.SS1.p1.8.1" class="ltx_text ltx_font_bold">avg. <math id="S4.SS1.p1.8.1.m1.1" class="ltx_Math" alttext="D_{S}" display="inline"><semantics id="S4.SS1.p1.8.1.m1.1a"><msub id="S4.SS1.p1.8.1.m1.1.1" xref="S4.SS1.p1.8.1.m1.1.1.cmml"><mi id="S4.SS1.p1.8.1.m1.1.1.2" xref="S4.SS1.p1.8.1.m1.1.1.2.cmml">D</mi><mi id="S4.SS1.p1.8.1.m1.1.1.3" xref="S4.SS1.p1.8.1.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.1.m1.1b"><apply id="S4.SS1.p1.8.1.m1.1.1.cmml" xref="S4.SS1.p1.8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.1.m1.1.1.1.cmml" xref="S4.SS1.p1.8.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.8.1.m1.1.1.2.cmml" xref="S4.SS1.p1.8.1.m1.1.1.2">𝐷</ci><ci id="S4.SS1.p1.8.1.m1.1.1.3.cmml" xref="S4.SS1.p1.8.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.1.m1.1c">D_{S}</annotation></semantics></math> BN stats</span>) and when estimating <span title="" class="ltx_glossaryref">BN</span> stats on unlabelled <math id="S4.SS1.p1.9.m8.1" class="ltx_Math" alttext="D_{T}" display="inline"><semantics id="S4.SS1.p1.9.m8.1a"><msub id="S4.SS1.p1.9.m8.1.1" xref="S4.SS1.p1.9.m8.1.1.cmml"><mi id="S4.SS1.p1.9.m8.1.1.2" xref="S4.SS1.p1.9.m8.1.1.2.cmml">D</mi><mi id="S4.SS1.p1.9.m8.1.1.3" xref="S4.SS1.p1.9.m8.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m8.1b"><apply id="S4.SS1.p1.9.m8.1.1.cmml" xref="S4.SS1.p1.9.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.9.m8.1.1.1.cmml" xref="S4.SS1.p1.9.m8.1.1">subscript</csymbol><ci id="S4.SS1.p1.9.m8.1.1.2.cmml" xref="S4.SS1.p1.9.m8.1.1.2">𝐷</ci><ci id="S4.SS1.p1.9.m8.1.1.3.cmml" xref="S4.SS1.p1.9.m8.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m8.1c">D_{T}</annotation></semantics></math> data (<math id="S4.SS1.p1.10.m9.1" class="ltx_Math" alttext="D_{T}" display="inline"><semantics id="S4.SS1.p1.10.m9.1a"><msub id="S4.SS1.p1.10.m9.1.1" xref="S4.SS1.p1.10.m9.1.1.cmml"><mi id="S4.SS1.p1.10.m9.1.1.2" xref="S4.SS1.p1.10.m9.1.1.2.cmml">D</mi><mi id="S4.SS1.p1.10.m9.1.1.3" xref="S4.SS1.p1.10.m9.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m9.1b"><apply id="S4.SS1.p1.10.m9.1.1.cmml" xref="S4.SS1.p1.10.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m9.1.1.1.cmml" xref="S4.SS1.p1.10.m9.1.1">subscript</csymbol><ci id="S4.SS1.p1.10.m9.1.1.2.cmml" xref="S4.SS1.p1.10.m9.1.1.2">𝐷</ci><ci id="S4.SS1.p1.10.m9.1.1.3.cmml" xref="S4.SS1.p1.10.m9.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m9.1c">D_{T}</annotation></semantics></math><span id="S4.SS1.p1.13.17" class="ltx_text ltx_font_bold"> BN stats</span>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, and <span id="S4.SS1.p1.13.18" class="ltx_text ltx_font_bold">fine-tuning</span> the model using only target labelled data. We also compare with the <span title="" class="ltx_glossaryref">PDA</span> method <span id="S4.SS1.p1.13.19" class="ltx_text ltx_font_bold">TENT</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, adapted to use labelled data (supervised) via cross entropy instead of unsupervised entropy for fair comparison, and the state-of-the-art FDA method <span id="S4.SS1.p1.13.20" class="ltx_text ltx_font_bold">KD3A</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
(using whole training set as unlabelled).
We also attempt to perform FedPDA by simply integrating the target domain node into the federated system and resuming <span id="S4.SS1.p1.13.21" class="ltx_text ltx_font_typewriter">FedBN</span> starting from the pre-trained model (<span id="S4.SS1.p1.13.22" class="ltx_text ltx_font_bold">FedPDA: FedBN</span>), and with another gradient alignment method, a variant of <span id="S4.SS1.p1.13.23" class="ltx_text ltx_font_bold">PCGrad</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, which we made applicable for FedPDA. <span id="S4.SS1.p1.13.24" class="ltx_text ltx_font_typewriter">PCGrad</span> projects gradients that point away from each other onto the normal plane of each other. <span id="S4.SS1.p1.13.25" class="ltx_text ltx_font_bold">StarAlign</span> uses <math id="S4.SS1.p1.11.m10.1" class="ltx_Math" alttext="\tau\!=\!100" display="inline"><semantics id="S4.SS1.p1.11.m10.1a"><mrow id="S4.SS1.p1.11.m10.1.1" xref="S4.SS1.p1.11.m10.1.1.cmml"><mi id="S4.SS1.p1.11.m10.1.1.2" xref="S4.SS1.p1.11.m10.1.1.2.cmml">τ</mi><mo lspace="0.108em" rspace="0.108em" id="S4.SS1.p1.11.m10.1.1.1" xref="S4.SS1.p1.11.m10.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.11.m10.1.1.3" xref="S4.SS1.p1.11.m10.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m10.1b"><apply id="S4.SS1.p1.11.m10.1.1.cmml" xref="S4.SS1.p1.11.m10.1.1"><eq id="S4.SS1.p1.11.m10.1.1.1.cmml" xref="S4.SS1.p1.11.m10.1.1.1"></eq><ci id="S4.SS1.p1.11.m10.1.1.2.cmml" xref="S4.SS1.p1.11.m10.1.1.2">𝜏</ci><cn type="integer" id="S4.SS1.p1.11.m10.1.1.3.cmml" xref="S4.SS1.p1.11.m10.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m10.1c">\tau\!=\!100</annotation></semantics></math>, and <math id="S4.SS1.p1.12.m11.1" class="ltx_Math" alttext="\beta\!=\!0.01" display="inline"><semantics id="S4.SS1.p1.12.m11.1a"><mrow id="S4.SS1.p1.12.m11.1.1" xref="S4.SS1.p1.12.m11.1.1.cmml"><mi id="S4.SS1.p1.12.m11.1.1.2" xref="S4.SS1.p1.12.m11.1.1.2.cmml">β</mi><mo lspace="0.108em" rspace="0.108em" id="S4.SS1.p1.12.m11.1.1.1" xref="S4.SS1.p1.12.m11.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.12.m11.1.1.3" xref="S4.SS1.p1.12.m11.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m11.1b"><apply id="S4.SS1.p1.12.m11.1.1.cmml" xref="S4.SS1.p1.12.m11.1.1"><eq id="S4.SS1.p1.12.m11.1.1.1.cmml" xref="S4.SS1.p1.12.m11.1.1.1"></eq><ci id="S4.SS1.p1.12.m11.1.1.2.cmml" xref="S4.SS1.p1.12.m11.1.1.2">𝛽</ci><cn type="float" id="S4.SS1.p1.12.m11.1.1.3.cmml" xref="S4.SS1.p1.12.m11.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m11.1c">\beta\!=\!0.01</annotation></semantics></math> or <math id="S4.SS1.p1.13.m12.1" class="ltx_Math" alttext="\beta\!=\!0.2" display="inline"><semantics id="S4.SS1.p1.13.m12.1a"><mrow id="S4.SS1.p1.13.m12.1.1" xref="S4.SS1.p1.13.m12.1.1.cmml"><mi id="S4.SS1.p1.13.m12.1.1.2" xref="S4.SS1.p1.13.m12.1.1.2.cmml">β</mi><mo lspace="0.108em" rspace="0.108em" id="S4.SS1.p1.13.m12.1.1.1" xref="S4.SS1.p1.13.m12.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.13.m12.1.1.3" xref="S4.SS1.p1.13.m12.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m12.1b"><apply id="S4.SS1.p1.13.m12.1.1.cmml" xref="S4.SS1.p1.13.m12.1.1"><eq id="S4.SS1.p1.13.m12.1.1.1.cmml" xref="S4.SS1.p1.13.m12.1.1.1"></eq><ci id="S4.SS1.p1.13.m12.1.1.2.cmml" xref="S4.SS1.p1.13.m12.1.1.2">𝛽</ci><cn type="float" id="S4.SS1.p1.13.m12.1.1.3.cmml" xref="S4.SS1.p1.13.m12.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m12.1c">\beta\!=\!0.2</annotation></semantics></math> for Camelyon17 and skin lesion tasks respectively, configured on validation set.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Test weighted accuracy (%) on skin lesion diagnosis (3 seeds averaged).</figcaption>
<div id="S4.T2.15" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:368.6pt;height:242.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(20.3pt,-13.4pt) scale(1.12390165911955,1.12390165911955) ;">
<table id="S4.T2.15.15" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span id="S4.T2.1.1.1.2.1" class="ltx_text" style="font-size:70%;">Methods</span></th>
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="D_{T}" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><msub id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml"><mi mathsize="70%" id="S4.T2.1.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.1.m1.1.1.2.cmml">D</mi><mi mathsize="70%" id="S4.T2.1.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2">𝐷</ci><ci id="S4.T2.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">D_{T}</annotation></semantics></math></th>
<th id="S4.T2.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" colspan="3"><span id="S4.T2.1.1.1.3.1" class="ltx_text" style="font-size:70%;">Target domain</span></th>
<td id="S4.T2.1.1.1.4" class="ltx_td ltx_nopad_r ltx_border_tt"></td>
</tr>
<tr id="S4.T2.15.15.16.1" class="ltx_tr">
<th id="S4.T2.15.15.16.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S4.T2.15.15.16.1.1.1" class="ltx_text" style="font-size:70%;">Pre-Train</span></th>
<th id="S4.T2.15.15.16.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S4.T2.15.15.16.1.2.1" class="ltx_text" style="font-size:70%;">Adapt</span></th>
<th id="S4.T2.15.15.16.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S4.T2.15.15.16.1.3.1" class="ltx_text" style="font-size:70%;">Lab.</span></th>
<th id="S4.T2.15.15.16.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S4.T2.15.15.16.1.4.1" class="ltx_text" style="font-size:70%;">Unlab.</span></th>
<th id="S4.T2.15.15.16.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.15.15.16.1.5.1" class="ltx_text" style="font-size:70%;">BCN</span></th>
<th id="S4.T2.15.15.16.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.15.15.16.1.6.1" class="ltx_text" style="font-size:70%;">HAM</span></th>
<th id="S4.T2.15.15.16.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.15.15.16.1.7.1" class="ltx_text" style="font-size:70%;">MSK &amp; D7P</span></th>
<th id="S4.T2.15.15.16.1.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T2.15.15.16.1.8.1" class="ltx_text" style="font-size:70%;">Average</span></th>
</tr>
<tr id="S4.T2.3.3.3" class="ltx_tr">
<th id="S4.T2.3.3.3.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T2.3.3.3.3.1" class="ltx_text" style="font-size:70%;">FedAvg</span></th>
<th id="S4.T2.3.3.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S4.T2.3.3.3.4.1" class="ltx_text" style="font-size:70%;">None</span></th>
<th id="S4.T2.2.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><math id="S4.T2.2.2.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.2.2.2.1.m1.1a"><mo mathsize="70%" id="S4.T2.2.2.2.1.m1.1.1" xref="S4.T2.2.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.1.m1.1b"><times id="S4.T2.2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.1.m1.1c">\times</annotation></semantics></math></th>
<th id="S4.T2.3.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><math id="S4.T2.3.3.3.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.3.3.3.2.m1.1a"><mo mathsize="70%" id="S4.T2.3.3.3.2.m1.1.1" xref="S4.T2.3.3.3.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.2.m1.1b"><times id="S4.T2.3.3.3.2.m1.1.1.cmml" xref="S4.T2.3.3.3.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.2.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T2.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.3.3.3.5.1" class="ltx_text" style="font-size:70%;">26.0</span></td>
<td id="S4.T2.3.3.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.3.3.3.6.1" class="ltx_text" style="font-size:70%;">37.6</span></td>
<td id="S4.T2.3.3.3.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.3.3.3.7.1" class="ltx_text" style="font-size:70%;">25.2</span></td>
<td id="S4.T2.3.3.3.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S4.T2.3.3.3.8.1" class="ltx_text" style="font-size:70%;">29.6</span></td>
</tr>
<tr id="S4.T2.4.4.4" class="ltx_tr">
<th id="S4.T2.4.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.4.4.4.2.1" class="ltx_text" style="font-size:70%;">None</span></th>
<th id="S4.T2.4.4.4.3" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.4.4.4.3.1" class="ltx_text" style="font-size:70%;">From scratch</span></th>
<th id="S4.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T2.4.4.4.4.1" class="ltx_text" style="font-size:70%;">✓</span></th>
<th id="S4.T2.4.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T2.4.4.4.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.4.4.4.1.m1.1a"><mo mathsize="70%" id="S4.T2.4.4.4.1.m1.1.1" xref="S4.T2.4.4.4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.1.m1.1b"><times id="S4.T2.4.4.4.1.m1.1.1.cmml" xref="S4.T2.4.4.4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.1.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T2.4.4.4.5" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.4.5.1" class="ltx_text" style="font-size:70%;">34.8</span></td>
<td id="S4.T2.4.4.4.6" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.4.6.1" class="ltx_text" style="font-size:70%;">40.0</span></td>
<td id="S4.T2.4.4.4.7" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.4.7.1" class="ltx_text" style="font-size:70%;">24.5</span></td>
<td id="S4.T2.4.4.4.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.4.4.4.8.1" class="ltx_text" style="font-size:70%;">33.1</span></td>
</tr>
<tr id="S4.T2.7.7.7" class="ltx_tr">
<th id="S4.T2.7.7.7.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.7.7.7.4.1" class="ltx_text" style="font-size:70%;">FedBN</span></th>
<th id="S4.T2.5.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.5.5.5.1.1" class="ltx_text" style="font-size:70%;">None (avg. </span><math id="S4.T2.5.5.5.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{S}" display="inline"><semantics id="S4.T2.5.5.5.1.m1.1a"><msub id="S4.T2.5.5.5.1.m1.1.1" xref="S4.T2.5.5.5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="70%" id="S4.T2.5.5.5.1.m1.1.1.2" xref="S4.T2.5.5.5.1.m1.1.1.2.cmml">𝒟</mi><mi mathsize="70%" id="S4.T2.5.5.5.1.m1.1.1.3" xref="S4.T2.5.5.5.1.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.1.m1.1b"><apply id="S4.T2.5.5.5.1.m1.1.1.cmml" xref="S4.T2.5.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.5.5.5.1.m1.1.1.1.cmml" xref="S4.T2.5.5.5.1.m1.1.1">subscript</csymbol><ci id="S4.T2.5.5.5.1.m1.1.1.2.cmml" xref="S4.T2.5.5.5.1.m1.1.1.2">𝒟</ci><ci id="S4.T2.5.5.5.1.m1.1.1.3.cmml" xref="S4.T2.5.5.5.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.1.m1.1c">\mathcal{D}_{S}</annotation></semantics></math><span id="S4.T2.5.5.5.1.2" class="ltx_text" style="font-size:70%;"> BN stats)</span>
</th>
<th id="S4.T2.6.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T2.6.6.6.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.6.6.6.2.m1.1a"><mo mathsize="70%" id="S4.T2.6.6.6.2.m1.1.1" xref="S4.T2.6.6.6.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.2.m1.1b"><times id="S4.T2.6.6.6.2.m1.1.1.cmml" xref="S4.T2.6.6.6.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.2.m1.1c">\times</annotation></semantics></math></th>
<th id="S4.T2.7.7.7.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T2.7.7.7.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.7.7.7.3.m1.1a"><mo mathsize="70%" id="S4.T2.7.7.7.3.m1.1.1" xref="S4.T2.7.7.7.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.3.m1.1b"><times id="S4.T2.7.7.7.3.m1.1.1.cmml" xref="S4.T2.7.7.7.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.3.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T2.7.7.7.5" class="ltx_td ltx_align_center"><span id="S4.T2.7.7.7.5.1" class="ltx_text" style="font-size:70%;">26.6</span></td>
<td id="S4.T2.7.7.7.6" class="ltx_td ltx_align_center"><span id="S4.T2.7.7.7.6.1" class="ltx_text" style="font-size:70%;">34.8</span></td>
<td id="S4.T2.7.7.7.7" class="ltx_td ltx_align_center"><span id="S4.T2.7.7.7.7.1" class="ltx_text" style="font-size:70%;">24.3</span></td>
<td id="S4.T2.7.7.7.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.7.7.7.8.1" class="ltx_text" style="font-size:70%;">28.6</span></td>
</tr>
<tr id="S4.T2.9.9.9" class="ltx_tr">
<th id="S4.T2.9.9.9.3" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.9.9.9.3.1" class="ltx_text" style="font-size:70%;">FedBN</span></th>
<th id="S4.T2.8.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<span id="S4.T2.8.8.8.1.1" class="ltx_text" style="font-size:70%;">None (</span><math id="S4.T2.8.8.8.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{T}" display="inline"><semantics id="S4.T2.8.8.8.1.m1.1a"><msub id="S4.T2.8.8.8.1.m1.1.1" xref="S4.T2.8.8.8.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="70%" id="S4.T2.8.8.8.1.m1.1.1.2" xref="S4.T2.8.8.8.1.m1.1.1.2.cmml">𝒟</mi><mi mathsize="70%" id="S4.T2.8.8.8.1.m1.1.1.3" xref="S4.T2.8.8.8.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.8.1.m1.1b"><apply id="S4.T2.8.8.8.1.m1.1.1.cmml" xref="S4.T2.8.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.8.8.8.1.m1.1.1.1.cmml" xref="S4.T2.8.8.8.1.m1.1.1">subscript</csymbol><ci id="S4.T2.8.8.8.1.m1.1.1.2.cmml" xref="S4.T2.8.8.8.1.m1.1.1.2">𝒟</ci><ci id="S4.T2.8.8.8.1.m1.1.1.3.cmml" xref="S4.T2.8.8.8.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.8.1.m1.1c">\mathcal{D}_{T}</annotation></semantics></math><span id="S4.T2.8.8.8.1.2" class="ltx_text" style="font-size:70%;"> BN stats)</span>
</th>
<th id="S4.T2.9.9.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T2.9.9.9.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.9.9.9.2.m1.1a"><mo mathsize="70%" id="S4.T2.9.9.9.2.m1.1.1" xref="S4.T2.9.9.9.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.9.2.m1.1b"><times id="S4.T2.9.9.9.2.m1.1.1.cmml" xref="S4.T2.9.9.9.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.9.2.m1.1c">\times</annotation></semantics></math></th>
<th id="S4.T2.9.9.9.4" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T2.9.9.9.4.1" class="ltx_text" style="font-size:70%;">✓</span></th>
<td id="S4.T2.9.9.9.5" class="ltx_td ltx_align_center"><span id="S4.T2.9.9.9.5.1" class="ltx_text" style="font-size:70%;">35.4</span></td>
<td id="S4.T2.9.9.9.6" class="ltx_td ltx_align_center"><span id="S4.T2.9.9.9.6.1" class="ltx_text" style="font-size:70%;">39.7</span></td>
<td id="S4.T2.9.9.9.7" class="ltx_td ltx_align_center"><span id="S4.T2.9.9.9.7.1" class="ltx_text" style="font-size:70%;">29.5</span></td>
<td id="S4.T2.9.9.9.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.9.9.9.8.1" class="ltx_text" style="font-size:70%;">34.9</span></td>
</tr>
<tr id="S4.T2.10.10.10" class="ltx_tr">
<th id="S4.T2.10.10.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.10.10.10.2.1" class="ltx_text" style="font-size:70%;">FedBN</span></th>
<th id="S4.T2.10.10.10.3" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.10.10.10.3.1" class="ltx_text" style="font-size:70%;">Fine-tuning</span></th>
<th id="S4.T2.10.10.10.4" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T2.10.10.10.4.1" class="ltx_text" style="font-size:70%;">✓</span></th>
<th id="S4.T2.10.10.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T2.10.10.10.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.10.10.10.1.m1.1a"><mo mathsize="70%" id="S4.T2.10.10.10.1.m1.1.1" xref="S4.T2.10.10.10.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.10.1.m1.1b"><times id="S4.T2.10.10.10.1.m1.1.1.cmml" xref="S4.T2.10.10.10.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.10.1.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T2.10.10.10.5" class="ltx_td ltx_align_center"><span id="S4.T2.10.10.10.5.1" class="ltx_text" style="font-size:70%;">37.6</span></td>
<td id="S4.T2.10.10.10.6" class="ltx_td ltx_align_center"><span id="S4.T2.10.10.10.6.1" class="ltx_text" style="font-size:70%;">46.2</span></td>
<td id="S4.T2.10.10.10.7" class="ltx_td ltx_align_center"><span id="S4.T2.10.10.10.7.1" class="ltx_text" style="font-size:70%;">25.5</span></td>
<td id="S4.T2.10.10.10.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.10.10.10.8.1" class="ltx_text" style="font-size:70%;">37.8</span></td>
</tr>
<tr id="S4.T2.11.11.11" class="ltx_tr">
<th id="S4.T2.11.11.11.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.11.11.11.2.1" class="ltx_text" style="font-size:70%;">FedBN</span></th>
<th id="S4.T2.11.11.11.3" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.11.11.11.3.1" class="ltx_text" style="font-size:70%;">Supervised TENT</span></th>
<th id="S4.T2.11.11.11.4" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T2.11.11.11.4.1" class="ltx_text" style="font-size:70%;">✓</span></th>
<th id="S4.T2.11.11.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T2.11.11.11.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.11.11.11.1.m1.1a"><mo mathsize="70%" id="S4.T2.11.11.11.1.m1.1.1" xref="S4.T2.11.11.11.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.11.1.m1.1b"><times id="S4.T2.11.11.11.1.m1.1.1.cmml" xref="S4.T2.11.11.11.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.11.1.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T2.11.11.11.5" class="ltx_td ltx_align_center"><span id="S4.T2.11.11.11.5.1" class="ltx_text" style="font-size:70%;">40.1</span></td>
<td id="S4.T2.11.11.11.6" class="ltx_td ltx_align_center"><span id="S4.T2.11.11.11.6.1" class="ltx_text" style="font-size:70%;">47.9</span></td>
<td id="S4.T2.11.11.11.7" class="ltx_td ltx_align_center"><span id="S4.T2.11.11.11.7.1" class="ltx_text" style="font-size:70%;">29.2</span></td>
<td id="S4.T2.11.11.11.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.11.11.11.8.1" class="ltx_text" style="font-size:70%;">39.0</span></td>
</tr>
<tr id="S4.T2.12.12.12" class="ltx_tr">
<th id="S4.T2.12.12.12.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.12.12.12.2.1" class="ltx_text" style="font-size:70%;">FedBN</span></th>
<th id="S4.T2.12.12.12.3" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.12.12.12.3.1" class="ltx_text" style="font-size:70%;">FedPDA: FedBN</span></th>
<th id="S4.T2.12.12.12.4" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T2.12.12.12.4.1" class="ltx_text" style="font-size:70%;">✓</span></th>
<th id="S4.T2.12.12.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T2.12.12.12.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.12.12.12.1.m1.1a"><mo mathsize="70%" id="S4.T2.12.12.12.1.m1.1.1" xref="S4.T2.12.12.12.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.12.1.m1.1b"><times id="S4.T2.12.12.12.1.m1.1.1.cmml" xref="S4.T2.12.12.12.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.12.1.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T2.12.12.12.5" class="ltx_td ltx_align_center"><span id="S4.T2.12.12.12.5.1" class="ltx_text" style="font-size:70%;">39.6</span></td>
<td id="S4.T2.12.12.12.6" class="ltx_td ltx_align_center"><span id="S4.T2.12.12.12.6.1" class="ltx_text" style="font-size:70%;">49.9</span></td>
<td id="S4.T2.12.12.12.7" class="ltx_td ltx_align_center"><span id="S4.T2.12.12.12.7.1" class="ltx_text" style="font-size:70%;">31.2</span></td>
<td id="S4.T2.12.12.12.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.12.12.12.8.1" class="ltx_text" style="font-size:70%;">40.2</span></td>
</tr>
<tr id="S4.T2.13.13.13" class="ltx_tr">
<th id="S4.T2.13.13.13.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.13.13.13.2.1" class="ltx_text" style="font-size:70%;">FedBN</span></th>
<th id="S4.T2.13.13.13.3" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.13.13.13.3.1" class="ltx_text" style="font-size:70%;">FedPDA: PCGrad</span></th>
<th id="S4.T2.13.13.13.4" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T2.13.13.13.4.1" class="ltx_text" style="font-size:70%;">✓</span></th>
<th id="S4.T2.13.13.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T2.13.13.13.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.13.13.13.1.m1.1a"><mo mathsize="70%" id="S4.T2.13.13.13.1.m1.1.1" xref="S4.T2.13.13.13.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.13.13.13.1.m1.1b"><times id="S4.T2.13.13.13.1.m1.1.1.cmml" xref="S4.T2.13.13.13.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.13.13.1.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T2.13.13.13.5" class="ltx_td ltx_align_center"><span id="S4.T2.13.13.13.5.1" class="ltx_text" style="font-size:70%;">38.4</span></td>
<td id="S4.T2.13.13.13.6" class="ltx_td ltx_align_center"><span id="S4.T2.13.13.13.6.1" class="ltx_text" style="font-size:70%;">48.3</span></td>
<td id="S4.T2.13.13.13.7" class="ltx_td ltx_align_center"><span id="S4.T2.13.13.13.7.1" class="ltx_text" style="font-size:70%;">22.4</span></td>
<td id="S4.T2.13.13.13.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.13.13.13.8.1" class="ltx_text" style="font-size:70%;">36.4</span></td>
</tr>
<tr id="S4.T2.14.14.14" class="ltx_tr">
<th id="S4.T2.14.14.14.2" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.14.14.14.2.1" class="ltx_text" style="font-size:70%;">FedBN</span></th>
<th id="S4.T2.14.14.14.3" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S4.T2.14.14.14.3.1" class="ltx_text" style="font-size:70%;">FedPDA: StarAlign</span></th>
<th id="S4.T2.14.14.14.4" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S4.T2.14.14.14.4.1" class="ltx_text" style="font-size:70%;">✓</span></th>
<th id="S4.T2.14.14.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><math id="S4.T2.14.14.14.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.14.14.14.1.m1.1a"><mo mathsize="70%" id="S4.T2.14.14.14.1.m1.1.1" xref="S4.T2.14.14.14.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.14.14.14.1.m1.1b"><times id="S4.T2.14.14.14.1.m1.1.1.cmml" xref="S4.T2.14.14.14.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.14.14.1.m1.1c">\times</annotation></semantics></math></th>
<td id="S4.T2.14.14.14.5" class="ltx_td ltx_align_center"><span id="S4.T2.14.14.14.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">44.4</span></td>
<td id="S4.T2.14.14.14.6" class="ltx_td ltx_align_center"><span id="S4.T2.14.14.14.6.1" class="ltx_text ltx_font_bold" style="font-size:70%;">53.6</span></td>
<td id="S4.T2.14.14.14.7" class="ltx_td ltx_align_center"><span id="S4.T2.14.14.14.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">33.5</span></td>
<td id="S4.T2.14.14.14.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.14.14.14.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">43.8</span></td>
</tr>
<tr id="S4.T2.15.15.15" class="ltx_tr">
<th id="S4.T2.15.15.15.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S4.T2.15.15.15.2.1" class="ltx_text" style="font-size:70%;">None</span></th>
<th id="S4.T2.15.15.15.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S4.T2.15.15.15.3.1" class="ltx_text" style="font-size:70%;">FDA-KD3A</span></th>
<th id="S4.T2.15.15.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t"><math id="S4.T2.15.15.15.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.T2.15.15.15.1.m1.1a"><mo mathsize="70%" id="S4.T2.15.15.15.1.m1.1.1" xref="S4.T2.15.15.15.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.T2.15.15.15.1.m1.1b"><times id="S4.T2.15.15.15.1.m1.1.1.cmml" xref="S4.T2.15.15.15.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.15.15.1.m1.1c">\times</annotation></semantics></math></th>
<th id="S4.T2.15.15.15.4" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t"><span id="S4.T2.15.15.15.4.1" class="ltx_text" style="font-size:70%;">✓</span></th>
<td id="S4.T2.15.15.15.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.15.15.15.5.1" class="ltx_text" style="font-size:70%;">41.4</span></td>
<td id="S4.T2.15.15.15.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.15.15.15.6.1" class="ltx_text" style="font-size:70%;">47.4</span></td>
<td id="S4.T2.15.15.15.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.15.15.15.7.1" class="ltx_text" style="font-size:70%;">31.8</span></td>
<td id="S4.T2.15.15.15.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T2.15.15.15.8.1" class="ltx_text" style="font-size:70%;">40.2</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Results and discussion</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p"><span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_bold">Camelyon17 results - Table <a href="#S4.T1" title="Table 1 ‣ 4 Experiments ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>:</span> <span id="S4.SS2.p1.1.2" class="ltx_text ltx_font_typewriter">StarAlign</span> achieves the highest average accuracy over 5 hospitals among all methods, only outperformed in 1 out of 5 settings. In our FedPDA framework, replacing <span id="S4.SS2.p1.1.3" class="ltx_text ltx_font_typewriter">StarAlign</span> with the prominent gradient alignment method <span id="S4.SS2.p1.1.4" class="ltx_text ltx_font_typewriter">PCGrad</span>, degrades the performance. This shows the potential of our proposed gradient alignment method.
<br class="ltx_break"><span id="S4.SS2.p1.1.5" class="ltx_text ltx_font_bold">Skin lesion diagnosis results - Table <a href="#S4.T2" title="Table 2 ‣ 4.1 Experimental setup ‣ 4 Experiments ‣ Post-Deployment Adaptation with Access to Source Data via Federated Learning and Source-Target Remote Gradient Alignment" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>:</span> We observe that performance of all methods in this task is lower than in Camelyon17. This is a much more challenging task due to very high class-imbalance and strong domain shift<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Our baselines achieve Accuracy 75-90% on source domains of the skin lesion task, comparable to existing literature <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, indicating they are well configured.</span></span></span>. It is extremely challenging to learn to predict the rarest minority classes under the influence of domain shift from very limited target data, which influences weighted-accuracy greatly. Accomplishing improvements in this challenging setting demonstrates promising capabilities of our method even in highly imbalanced datasets.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p"><span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_typewriter">StarAlign</span> consistently outperforms all compared methods. This includes PDA methods that cannot use source data (target <span id="S4.SS2.p2.1.2" class="ltx_text ltx_font_typewriter">fine-tuning</span> and <span id="S4.SS2.p2.1.3" class="ltx_text ltx_font_typewriter">Supervised TENT</span>) and the state-of-the-art FDA method <span id="S4.SS2.p2.1.4" class="ltx_text ltx_font_typewriter">KD3A</span>, showing the potential of FedPDA. When FedPDA is performed with <span id="S4.SS2.p2.1.5" class="ltx_text ltx_font_typewriter">StarAlign</span>, it outperforms FedPDA performed simply with a second round of <span id="S4.SS2.p2.1.6" class="ltx_text ltx_font_typewriter">FedBN</span> training when the target node is connected to the FL system along with source nodes. <span id="S4.SS2.p2.1.7" class="ltx_text ltx_font_typewriter">FedBN</span> can be viewed as Personalised <span title="" class="ltx_glossaryref">FL</span> method, as it learns one model per client via client-specific BN layers. Results demonstrate that learning one target-specific model with <span id="S4.SS2.p2.1.8" class="ltx_text ltx_font_typewriter">StarAlign</span> yields better results. It also outperforms FedPDA with <span id="S4.SS2.p2.1.9" class="ltx_text ltx_font_typewriter">PCGrad</span>, showing our gradient alignment method’s effectiveness. This shows <span id="S4.SS2.p2.1.10" class="ltx_text ltx_font_typewriter">StarAlign</span>’s potential to adapt a model to a distribution with high class imbalance and domain shift.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">This work presents FedPDA, a framework unifying <span title="" class="ltx_glossaryref">FL</span> and <span title="" class="ltx_glossaryref">PDA</span> without data exchange. FedPDA enables a pre-trained, deployed model to obtain information from source data via remote gradient communication to facilitate post-deployment adaptation. We introduce <span id="S5.p1.1.1" class="ltx_text ltx_font_typewriter">StarAlign</span> which aligns gradients from source domains with target domain gradients, distilling useful information from source data without data exchange to improve adaptation. We evaluated the method on two multi-center imaging databases and showed that <span id="S5.p1.1.2" class="ltx_text ltx_font_typewriter">StarAlign</span> surpasses previous methods and improves performance of deployed models on new domains.</p>
</div>
<section id="S5.SS0.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.0.1 </span>Acknowledgment:</h4>

<div id="S5.SS0.SSS1.p1" class="ltx_para">
<p id="S5.SS0.SSS1.p1.1" class="ltx_p">Felix Wagner is supported by the EPSRC Centre for Doctoral Training in Health Data Science (EP/S02428X/1), by the Angela Krosik Award from the Anglo-Austrian Society, and by an Oxford-Reuben scholarship. Pramit Saha is supported in part by the UK EPSRC Programme Grant EP/T028572/1 (VisualAI) and a UK EPSRC Doctoral Training Partnership award.
The authors also acknowledge the use of the University of Oxford Advanced Research Computing (ARC) facility in carrying out this work (http://dx.doi.org/10.5281/zenodo.22558).</p>
</div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Arivazhagan, M.G., Aggarwal, V., Singh, A.K., Choudhary, S.: Federated learning
with personalization layers. arXiv preprint arXiv:1912.00818 (2019)

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Bandi, P., Geessink, O., Manson, Q., Van Dijk, M., Balkenhol, M., Hermsen, M.,
Bejnordi, B.E., Lee, B., Paeng, K., Zhong, A., et al.: From detection of
individual metastases to classification of lymph node status at the patient
level: the camelyon17 challenge. IEEE Transactions on Medical Imaging (2018)

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Bateson, M., Kervadec, H., Dolz, J., Lombaert, H., Ayed, I.B.: Source-free
domain adaptation for image segmentation. Medical Image Analysis (2022)

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Ben-David, S., Blitzer, J., Crammer, K., Kulesza, A., Pereira, F., Vaughan,
J.W.: A theory of learning from different domains. Machine learning (2010)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Cassidy, B., Kendrick, C., Brodzicki, A., Jaworek-Korjakowska, J., Yap, M.H.:
Analysis of the isic image datasets: Usage, benchmarks and recommendations.
Medical Image Analysis (2022)

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Chen, C., Liu, Q., Jin, Y., Dou, Q., Heng, P.A.: Source-free domain adaptive
fundus image segmentation with denoised pseudo-labeling. In: MICCAI (2021)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Chidlovskii, B., Clinchant, S., Csurka, G.: Domain adaptation in the absence of
source domain data. In: SIGKDD (2016)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Codella, N.C., Gutman, D., Celebi, M.E., Helba, B., Marchetti, M.A., Dusza,
S.W., Kalloo, A., Liopyris, K., Mishra, N., Kittler, H., et al.: Skin lesion
analysis toward melanoma detection: A challenge at the 2017 international
symposium on biomedical imaging (isbi), hosted by the international skin
imaging collaboration (isic). In: ISBI (2018)

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Combalia, M., Codella, N.C., Rotemberg, V., Helba, B., Vilaplana, V., Reiter,
O., Carrera, C., Barreiro, A., Halpern, A.C., Puig, S., et al.: Bcn20000:
Dermoscopic lesions in the wild. arXiv preprint arXiv:1908.02288 (2019)

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Dou, Q., Coelho de Castro, D., Kamnitsas, K., Glocker, B.: Domain
generalization via model-agnostic learning of semantic features. NeurIPS
<span id="bib.bib10.1.1" class="ltx_text ltx_font_bold">32</span> (2019)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Feng, H., You, Z., Chen, M., Zhang, T., Zhu, M., Wu, F., Wu, C., Chen, W.:
Kd3a: Unsupervised multi-source decentralized domain adaptation via knowledge
distillation. In: ICML (2021)

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Ganin, Y., Ustinova, E., Ajakan, H., Germain, P., Larochelle, H., Laviolette,
F., Marchand, M., Lempitsky, V.: Domain-adversarial training of neural
networks. The journal of machine learning research (2016)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Geirhos, R., Temme, C.R., Rauber, J., Schütt, H.H., Bethge, M., Wichmann,
F.A.: Generalisation in humans and deep neural networks. NeurIPS (2018)

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Huang, G., Liu, Z., Van Der Maaten, L., Weinberger, K.Q.: Densely connected
convolutional networks. In: CVPR (2017)

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Jiang, M., Yang, H., Cheng, C., Dou, Q.: Iop-fl: Inside-outside personalization
for federated medical image segmentation. IEEE TMI (2023)

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Kamnitsas, K., Baumgartner, C., Ledig, C., Newcombe, V., Simpson, J., Kane, A.,
Menon, D., Nori, A., Criminisi, A., Rueckert, D., et al.: Unsupervised domain
adaptation in brain lesion segmentation with adversarial networks. In: IPMI
(2017)

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Karani, N., Erdil, E., Chaitanya, K., Konukoglu, E.: Test-time adaptable neural
networks for robust medical image segmentation. Medical Image Analysis
(2021)

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Karimireddy, S.P., Kale, S., Mohri, M., Reddi, S., Stich, S., Suresh, A.T.:
SCAFFOLD: Stochastic controlled averaging for federated learning. In: ICML
(2020)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Kawahara, J., Daneshvar, S., Argenziano, G., Hamarneh, G.: Seven-point
checklist and skin lesion classification using multitask multimodal neural
nets. IEEE journal of biomedical and health informatics (2018)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Li, D., Yang, Y., Song, Y.Z., Hospedales, T.: Learning to generalize:
Meta-learning for domain generalization. In: AAAI (2018)

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Li, T., Sahu, A.K., Zaheer, M., Sanjabi, M., Talwalkar, A., Smith, V.:
Federated optimization in heterogeneous networks. Proceedings of Machine
learning and systems (2020)

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Li, X., Gu, Y., Dvornek, N., Staib, L.H., Ventola, P., Duncan, J.S.: Multi-site
fmri analysis using privacy-preserving federated learning and domain
adaptation: Abide results. Medical Image Analysis (2020)

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Li, X., Jiang, M., Zhang, X., Kamp, M., Dou, Q.: Fed{bn}: Federated
learning on non-{iid} features via local batch normalization. In: ICLR
(2021)

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Liu, Q., Chen, C., Qin, J., Dou, Q., Heng, P.A.: Feddg: Federated domain
generalization on medical image segmentation via episodic learning in
continuous frequency space. In: CVPR (2021)

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., Arcas, B.A.y.:
Communication-Efficient Learning of Deep Networks from Decentralized Data.
In: AISTATS (2017)

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Muandet, K., Balduzzi, D., Schölkopf, B.: Domain generalization via
invariant feature representation. In: ICML (2013)

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Peng, X., Huang, Z., Zhu, Y., Saenko, K.: Federated adversarial domain
adaptation. arXiv preprint arXiv:1911.02054 (2019)

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Shi, Y., Seely, J., Torr, P., N, S., Hannun, A., Usunier, N., Synnaeve, G.:
Gradient matching for domain generalization. In: ICLR (2022)

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Tschandl, P., Rosendahl, C., Kittler, H.: The ham10000 dataset, a large
collection of multi-source dermatoscopic images of common pigmented skin
lesions. Scientific data (2018)

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Valvano, G., Leo, A., Tsaftaris, S.A.: Stop throwing away discriminators!
re-using adversaries for test-time training. In: MICCAI Workshop, DART, and
FAIR (2021)

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Wang, D., Shelhamer, E., Liu, S., Olshausen, B., Darrell, T.: Tent: Fully
test-time adaptation by entropy minimization. arXiv preprint arXiv:2006.10726
(2020)

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Yu, T., Kumar, S., Gupta, A., Levine, S., Hausman, K., Finn, C.: Gradient
surgery for multi-task learning. NeurIPS (2020)

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Zhao, Y., Li, M., Lai, L., Suda, N., Civin, D., Chandra, V.: Federated learning
with non-iid data. arXiv preprint arXiv:1806.00582 (2018)

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2308.16734" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2308.16735" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2308.16735">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2308.16735" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2308.16736" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 10:40:56 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
