<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2408.12300] Tackling Data Heterogeneity in Federated Learning via Loss Decomposition</title><meta property="og:description" content="Federated Learning (FL) is a rising approach towards collaborative and privacy-preserving machine learning where large-scale medical datasets remain localized to each client. However, the issue of data heterogeneity am…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tackling Data Heterogeneity in Federated Learning via Loss Decomposition">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Tackling Data Heterogeneity in Federated Learning via Loss Decomposition">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2408.12300">

<!--Generated on Thu Sep  5 16:19:33 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Federated Learning Data Heterogeneity Principal Gradients.">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="id1" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>
Department of Statistics and Actuarial Science, The University of Hong Kong, Hong Kong SAR, China 
<br class="ltx_break"><span id="id1.1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>liangqqu@hku.hk</span></span></span> </span></span></span><span id="id2" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">institutetext: </span>School of Cyberspace, Hangzhou Dianzi University, Hangzhou, China </span></span></span><span id="id3" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_note_type">institutetext: </span>New H3C Technologies Co., Ltd. </span></span></span><span id="id4" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_note_type">institutetext: </span>Computer Science and Engineering, University of California, Santa Cruz, USA
</span></span></span>
<h1 class="ltx_title ltx_title_document">Tackling Data Heterogeneity in Federated Learning via Loss Decomposition</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Shuang Zeng 
</span><span class="ltx_author_notes">1*1*</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pengxin Guo
</span><span class="ltx_author_notes">1*1*</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shuai Wang
</span><span class="ltx_author_notes">22</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jianbo Wang
</span><span class="ltx_author_notes">33</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuyin Zhou
</span><span class="ltx_author_notes">44</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Liangqiong Qu <sup id="id1.1.id1" class="ltx_sup">(🖂)</sup>
</span><span class="ltx_author_notes">* These authors contributed equally to this work.<sup id="id2.2.id1" class="ltx_sup">🖂</sup> Corresponding author.11</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">Federated Learning (FL) is a rising approach towards collaborative and privacy-preserving machine learning where large-scale medical datasets remain localized to each client. However, the issue of data heterogeneity among clients often compels local models to diverge, leading to suboptimal global models. To mitigate the impact of data heterogeneity on FL performance, we start with analyzing how FL training influence FL performance by decomposing the global loss into three terms: local loss, distribution shift loss and aggregation loss.
Remarkably, our loss decomposition reveals that existing local training-based FL methods attempt to reduce the distribution shift loss, while the global aggregation-based FL methods propose better aggregation strategies to reduce the aggregation loss. Nevertheless, a comprehensive joint effort to minimize all three terms is currently limited in the literature, leading to subpar performance when dealing with data heterogeneity challenges.
To fill this gap, we propose a novel FL method based on global loss decomposition, called FedLD, to jointly reduce these three loss terms. Our FedLD involves a margin control regularization in local training to reduce the distribution shift loss, and a principal gradient-based server aggregation strategy to reduce the aggregation loss.
Notably, under different levels of data heterogeneity, our strategies achieve better and more robust performance on retinal and chest X-ray classification compared to other FL algorithms. Our code is available at <a target="_blank" href="https://github.com/Zeng-Shuang/FedLD" title="" class="ltx_ref ltx_href">https://github.com/Zeng-Shuang/FedLD</a>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Federated Learning Data Heterogeneity Principal Gradients.
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL), where computations are performed locally at each client without sharing data, presents a promising approach to accessing large, representative data for training robust deep learning models with enhanced generalizability <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. In recent years, FL has witnessed some pivotal success on various medical applications, such as medical image segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, medical image classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, cancer boundary detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, among others <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Despite its widespread, FL suffers from data heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, as data can be non-independent and identically distributed (non-IID) across clients, which is particularly prevalent in medical scenarios <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Two main approaches have been proposed to tackle data heterogeneity in FL: (<span id="S1.p2.1.1" class="ltx_text ltx_font_bold">i</span>) regularizing <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">local training</span> to mitigate the deviation between local and global objectives and (<span id="S1.p2.1.3" class="ltx_text ltx_font_bold">ii</span>) designing more efficient <span id="S1.p2.1.4" class="ltx_text ltx_font_italic">global aggregation</span> strategies. For local training, methods such as FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, FedCM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, and FEDIIR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> utilize the difference between local and global models as a regularization term to mitigate the deviation between local and global objectives. However, these methods may suffer from additional communication costs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> or the inability of gradient differences to accurately capture model bias <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
For global aggregation, several works have been proposed to develop efficient global aggregation strategies, such as FedMA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, pFedLA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, RobFedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, and GAMF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. However, these strategies may incur extra computing resources <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> or overlook the impact of local training on overall performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2408.12300/assets/miccai-framework3.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="282" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Overview of the proposed FedLD. (1) Once each local client downloads the global model parameter <math id="S1.F1.2.m1.1" class="ltx_Math" alttext="\boldsymbol{w}" display="inline"><semantics id="S1.F1.2.m1.1b"><mi id="S1.F1.2.m1.1.1" xref="S1.F1.2.m1.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S1.F1.2.m1.1c"><ci id="S1.F1.2.m1.1.1.cmml" xref="S1.F1.2.m1.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.2.m1.1d">\boldsymbol{w}</annotation></semantics></math>, (2) it starts training locally with the cross-entropy loss and our proposed margin control regularization. (3) After that, each client uploads its local gradient to the global server. (4) Then, the global server aggregates these local gradients with our proposed principal gradient-based server aggregation, which includes three steps: First, use all local gradients to construct principal gradients; Second, calibrate principal gradients and use them to revise local gradients; Third, aggregate revised local gradients to generate the global gradient. (5) Finally, the server updates the global model parameter with the global gradient and sends it to local clients for the next round.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Most of the works address the issue of data heterogeneity by applying strategies either at the local or server side. In this paper, we ask: <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">How can the joint effect of local training and server aggregation be leveraged to improve FL performance in the presence of data heterogeneity?</span> To answer this, we decompose the global loss into three terms: local loss, distribution shift loss, and aggregation loss, which reveals that existing methods often focus on addressing only one or two of these terms, rather than all three. For example, in standard FL training, such as FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, only the local loss is minimized, while the other two terms are ignored. Remarkably, existing local training-based methods attempt to further reduce the distribution shift loss through additional local training regularization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, and global aggregation-based methods propose better aggregation strategies to minimize the aggregation loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">However, a comprehensive joint effort to minimize all three terms - local loss, distribution shift loss, and aggregation loss - is currently limited in the literature. To fill this gap, we propose a novel FL method based on global loss decomposition, called FedLD, to jointly reduce these three loss terms, as shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Our FedLD involves a margin control regularization in local training to reduce the distribution shift loss, and a principal gradient-based server aggregation strategy to minimize the aggregation loss. Specifically, our margin control regularization encourages local models to learn stable features instead of shortcut features by adding the <math id="S1.p4.1.m1.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="S1.p4.1.m1.1a"><msub id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mi id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2.cmml">l</mi><mn id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.1.cmml" xref="S1.p4.1.m1.1.1">subscript</csymbol><ci id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.2">𝑙</ci><cn type="integer" id="S1.p4.1.m1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">l_{2}</annotation></semantics></math>-norm of the output logits to the standard cross entropy loss, thereby reducing the distribution shift loss. On the other hand, the local models trained on heterogeneous data distribution in FL may exhibit different or even conflicting judgments, leading to potential conflicts in clients’ gradients. Naively aggregating these conflicting gradients in FL may lead to increased aggregation loss, thus resulting in poorly performing global model. Therefore, we propose a principal gradient-based server aggregation strategy to mitigate conflicting gradients by prioritizing principal directions that benefit all clients while discarding conflict-contributing directions, ultimately reducing the aggregation loss.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In summary, our key contributions are as follows: (i) We propose a novel global loss decomposition in FL, decomposing the global objective into local loss, distribution shift loss, and aggregation loss, which provides an analytical framework to assess the impact of these loss terms on FL performance.
(ii)
We provide a novel and practical algorithm, FedLD, which incorporates margin control regularization and a principal gradient-based server aggregation strategy to jointly reduce local loss, distribution shift loss, and aggregation loss.
(iii) We conduct extensive numerical studies on retinal and chest X-ray classification datasets to verify the performance of our algorithm, which outperforms several classic baselines under different levels of data heterogeneity.
</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methodology</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Problem Setup</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.9" class="ltx_p">In this work, we address the problem of data heterogeneity in cross-device FL involving a central server and <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">m</annotation></semantics></math> clients, for a supervised image classification task. Each client <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">i</annotation></semantics></math> has its own local data distribution, denoted by <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{P}_{i}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">𝒫</mi><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝒫</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\mathcal{P}_{i}</annotation></semantics></math>. Let <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">x</annotation></semantics></math> and <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">y</annotation></semantics></math> indicate the input features and labels extracted from client <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">i</annotation></semantics></math>’s local data distribution <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{P}_{i}" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><msub id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.1.1.2" xref="S2.SS1.p1.7.m7.1.1.2.cmml">𝒫</mi><mi id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2">𝒫</ci><ci id="S2.SS1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">\mathcal{P}_{i}</annotation></semantics></math>, respectively, such that <math id="S2.SS1.p1.8.m8.4" class="ltx_Math" alttext="(x,y)\sim\mathcal{P}_{i}(x,y)" display="inline"><semantics id="S2.SS1.p1.8.m8.4a"><mrow id="S2.SS1.p1.8.m8.4.5" xref="S2.SS1.p1.8.m8.4.5.cmml"><mrow id="S2.SS1.p1.8.m8.4.5.2.2" xref="S2.SS1.p1.8.m8.4.5.2.1.cmml"><mo stretchy="false" id="S2.SS1.p1.8.m8.4.5.2.2.1" xref="S2.SS1.p1.8.m8.4.5.2.1.cmml">(</mo><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">x</mi><mo id="S2.SS1.p1.8.m8.4.5.2.2.2" xref="S2.SS1.p1.8.m8.4.5.2.1.cmml">,</mo><mi id="S2.SS1.p1.8.m8.2.2" xref="S2.SS1.p1.8.m8.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS1.p1.8.m8.4.5.2.2.3" xref="S2.SS1.p1.8.m8.4.5.2.1.cmml">)</mo></mrow><mo id="S2.SS1.p1.8.m8.4.5.1" xref="S2.SS1.p1.8.m8.4.5.1.cmml">∼</mo><mrow id="S2.SS1.p1.8.m8.4.5.3" xref="S2.SS1.p1.8.m8.4.5.3.cmml"><msub id="S2.SS1.p1.8.m8.4.5.3.2" xref="S2.SS1.p1.8.m8.4.5.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.8.m8.4.5.3.2.2" xref="S2.SS1.p1.8.m8.4.5.3.2.2.cmml">𝒫</mi><mi id="S2.SS1.p1.8.m8.4.5.3.2.3" xref="S2.SS1.p1.8.m8.4.5.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.8.m8.4.5.3.1" xref="S2.SS1.p1.8.m8.4.5.3.1.cmml">​</mo><mrow id="S2.SS1.p1.8.m8.4.5.3.3.2" xref="S2.SS1.p1.8.m8.4.5.3.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.8.m8.4.5.3.3.2.1" xref="S2.SS1.p1.8.m8.4.5.3.3.1.cmml">(</mo><mi id="S2.SS1.p1.8.m8.3.3" xref="S2.SS1.p1.8.m8.3.3.cmml">x</mi><mo id="S2.SS1.p1.8.m8.4.5.3.3.2.2" xref="S2.SS1.p1.8.m8.4.5.3.3.1.cmml">,</mo><mi id="S2.SS1.p1.8.m8.4.4" xref="S2.SS1.p1.8.m8.4.4.cmml">y</mi><mo stretchy="false" id="S2.SS1.p1.8.m8.4.5.3.3.2.3" xref="S2.SS1.p1.8.m8.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.4b"><apply id="S2.SS1.p1.8.m8.4.5.cmml" xref="S2.SS1.p1.8.m8.4.5"><csymbol cd="latexml" id="S2.SS1.p1.8.m8.4.5.1.cmml" xref="S2.SS1.p1.8.m8.4.5.1">similar-to</csymbol><interval closure="open" id="S2.SS1.p1.8.m8.4.5.2.1.cmml" xref="S2.SS1.p1.8.m8.4.5.2.2"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝑥</ci><ci id="S2.SS1.p1.8.m8.2.2.cmml" xref="S2.SS1.p1.8.m8.2.2">𝑦</ci></interval><apply id="S2.SS1.p1.8.m8.4.5.3.cmml" xref="S2.SS1.p1.8.m8.4.5.3"><times id="S2.SS1.p1.8.m8.4.5.3.1.cmml" xref="S2.SS1.p1.8.m8.4.5.3.1"></times><apply id="S2.SS1.p1.8.m8.4.5.3.2.cmml" xref="S2.SS1.p1.8.m8.4.5.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.4.5.3.2.1.cmml" xref="S2.SS1.p1.8.m8.4.5.3.2">subscript</csymbol><ci id="S2.SS1.p1.8.m8.4.5.3.2.2.cmml" xref="S2.SS1.p1.8.m8.4.5.3.2.2">𝒫</ci><ci id="S2.SS1.p1.8.m8.4.5.3.2.3.cmml" xref="S2.SS1.p1.8.m8.4.5.3.2.3">𝑖</ci></apply><interval closure="open" id="S2.SS1.p1.8.m8.4.5.3.3.1.cmml" xref="S2.SS1.p1.8.m8.4.5.3.3.2"><ci id="S2.SS1.p1.8.m8.3.3.cmml" xref="S2.SS1.p1.8.m8.3.3">𝑥</ci><ci id="S2.SS1.p1.8.m8.4.4.cmml" xref="S2.SS1.p1.8.m8.4.4">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.4c">(x,y)\sim\mathcal{P}_{i}(x,y)</annotation></semantics></math>.
Then the objective is to minimize the aggregate loss function <math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{L}(\boldsymbol{w})" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><mrow id="S2.SS1.p1.9.m9.1.2" xref="S2.SS1.p1.9.m9.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.9.m9.1.2.2" xref="S2.SS1.p1.9.m9.1.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.9.m9.1.2.1" xref="S2.SS1.p1.9.m9.1.2.1.cmml">​</mo><mrow id="S2.SS1.p1.9.m9.1.2.3.2" xref="S2.SS1.p1.9.m9.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.9.m9.1.2.3.2.1" xref="S2.SS1.p1.9.m9.1.2.cmml">(</mo><mi id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml">𝒘</mi><mo stretchy="false" id="S2.SS1.p1.9.m9.1.2.3.2.2" xref="S2.SS1.p1.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.2.cmml" xref="S2.SS1.p1.9.m9.1.2"><times id="S2.SS1.p1.9.m9.1.2.1.cmml" xref="S2.SS1.p1.9.m9.1.2.1"></times><ci id="S2.SS1.p1.9.m9.1.2.2.cmml" xref="S2.SS1.p1.9.m9.1.2.2">ℒ</ci><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">𝒘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">\mathcal{L}(\boldsymbol{w})</annotation></semantics></math>, which is formulated as:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.3" class="ltx_Math" alttext="\mathcal{L}(\boldsymbol{w})=\sum_{i=1}^{m}\frac{n_{i}}{n}\mathcal{L}_{i}(\boldsymbol{w})," display="block"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.2.1" xref="S2.E1.m1.3.3.1.1.2.1.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.2.3.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2.3.2.1" xref="S2.E1.m1.3.3.1.1.2.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝒘</mi><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2.3.2.2" xref="S2.E1.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml"><munderover id="S2.E1.m1.3.3.1.1.3.1" xref="S2.E1.m1.3.3.1.1.3.1.cmml"><mo movablelimits="false" id="S2.E1.m1.3.3.1.1.3.1.2.2" xref="S2.E1.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1.1.3.1.2.3" xref="S2.E1.m1.3.3.1.1.3.1.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.3.1.2.3.2" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2.cmml">i</mi><mo id="S2.E1.m1.3.3.1.1.3.1.2.3.1" xref="S2.E1.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E1.m1.3.3.1.1.3.1.2.3.3" xref="S2.E1.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.3.3.1.1.3.1.3" xref="S2.E1.m1.3.3.1.1.3.1.3.cmml">m</mi></munderover><mrow id="S2.E1.m1.3.3.1.1.3.2" xref="S2.E1.m1.3.3.1.1.3.2.cmml"><mfrac id="S2.E1.m1.3.3.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.cmml"><msub id="S2.E1.m1.3.3.1.1.3.2.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.3.2.2.2.2" xref="S2.E1.m1.3.3.1.1.3.2.2.2.2.cmml">n</mi><mi id="S2.E1.m1.3.3.1.1.3.2.2.2.3" xref="S2.E1.m1.3.3.1.1.3.2.2.2.3.cmml">i</mi></msub><mi id="S2.E1.m1.3.3.1.1.3.2.2.3" xref="S2.E1.m1.3.3.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.3.2.1" xref="S2.E1.m1.3.3.1.1.3.2.1.cmml">​</mo><msub id="S2.E1.m1.3.3.1.1.3.2.3" xref="S2.E1.m1.3.3.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.3.2.3.2" xref="S2.E1.m1.3.3.1.1.3.2.3.2.cmml">ℒ</mi><mi id="S2.E1.m1.3.3.1.1.3.2.3.3" xref="S2.E1.m1.3.3.1.1.3.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.3.2.1a" xref="S2.E1.m1.3.3.1.1.3.2.1.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.3.2.4.2" xref="S2.E1.m1.3.3.1.1.3.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.3.2.4.2.1" xref="S2.E1.m1.3.3.1.1.3.2.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">𝒘</mi><mo stretchy="false" id="S2.E1.m1.3.3.1.1.3.2.4.2.2" xref="S2.E1.m1.3.3.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1"></eq><apply id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"><times id="S2.E1.m1.3.3.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.1"></times><ci id="S2.E1.m1.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2">ℒ</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝒘</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"><apply id="S2.E1.m1.3.3.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.3.1.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.3.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.2"></sum><apply id="S2.E1.m1.3.3.1.1.3.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3"><eq id="S2.E1.m1.3.3.1.1.3.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="S2.E1.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S2.E1.m1.3.3.1.1.3.1.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.3.3.1.1.3.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3.1.3">𝑚</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2"><times id="S2.E1.m1.3.3.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.1"></times><apply id="S2.E1.m1.3.3.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2"><divide id="S2.E1.m1.3.3.1.1.3.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2"></divide><apply id="S2.E1.m1.3.3.1.1.3.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.2.2">𝑛</ci><ci id="S2.E1.m1.3.3.1.1.3.2.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S2.E1.m1.3.3.1.1.3.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.2.3">𝑛</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.2">ℒ</ci><ci id="S2.E1.m1.3.3.1.1.3.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.2.3.3">𝑖</ci></apply><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝒘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\mathcal{L}(\boldsymbol{w})=\sum_{i=1}^{m}\frac{n_{i}}{n}\mathcal{L}_{i}(\boldsymbol{w}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.18" class="ltx_p">where <math id="S2.SS1.p1.10.m1.9" class="ltx_Math" alttext="\mathcal{L}_{i}(\boldsymbol{w})=\mathbb{E}_{(x,y)\sim\mathcal{P}_{i}(x,y)}\left[l\left(\boldsymbol{w};x,y\right)\right]" display="inline"><semantics id="S2.SS1.p1.10.m1.9a"><mrow id="S2.SS1.p1.10.m1.9.9" xref="S2.SS1.p1.10.m1.9.9.cmml"><mrow id="S2.SS1.p1.10.m1.9.9.3" xref="S2.SS1.p1.10.m1.9.9.3.cmml"><msub id="S2.SS1.p1.10.m1.9.9.3.2" xref="S2.SS1.p1.10.m1.9.9.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.10.m1.9.9.3.2.2" xref="S2.SS1.p1.10.m1.9.9.3.2.2.cmml">ℒ</mi><mi id="S2.SS1.p1.10.m1.9.9.3.2.3" xref="S2.SS1.p1.10.m1.9.9.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.10.m1.9.9.3.1" xref="S2.SS1.p1.10.m1.9.9.3.1.cmml">​</mo><mrow id="S2.SS1.p1.10.m1.9.9.3.3.2" xref="S2.SS1.p1.10.m1.9.9.3.cmml"><mo stretchy="false" id="S2.SS1.p1.10.m1.9.9.3.3.2.1" xref="S2.SS1.p1.10.m1.9.9.3.cmml">(</mo><mi id="S2.SS1.p1.10.m1.5.5" xref="S2.SS1.p1.10.m1.5.5.cmml">𝒘</mi><mo stretchy="false" id="S2.SS1.p1.10.m1.9.9.3.3.2.2" xref="S2.SS1.p1.10.m1.9.9.3.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.10.m1.9.9.2" xref="S2.SS1.p1.10.m1.9.9.2.cmml">=</mo><mrow id="S2.SS1.p1.10.m1.9.9.1" xref="S2.SS1.p1.10.m1.9.9.1.cmml"><msub id="S2.SS1.p1.10.m1.9.9.1.3" xref="S2.SS1.p1.10.m1.9.9.1.3.cmml"><mi id="S2.SS1.p1.10.m1.9.9.1.3.2" xref="S2.SS1.p1.10.m1.9.9.1.3.2.cmml">𝔼</mi><mrow id="S2.SS1.p1.10.m1.4.4.4" xref="S2.SS1.p1.10.m1.4.4.4.cmml"><mrow id="S2.SS1.p1.10.m1.4.4.4.6.2" xref="S2.SS1.p1.10.m1.4.4.4.6.1.cmml"><mo stretchy="false" id="S2.SS1.p1.10.m1.4.4.4.6.2.1" xref="S2.SS1.p1.10.m1.4.4.4.6.1.cmml">(</mo><mi id="S2.SS1.p1.10.m1.1.1.1.1" xref="S2.SS1.p1.10.m1.1.1.1.1.cmml">x</mi><mo id="S2.SS1.p1.10.m1.4.4.4.6.2.2" xref="S2.SS1.p1.10.m1.4.4.4.6.1.cmml">,</mo><mi id="S2.SS1.p1.10.m1.2.2.2.2" xref="S2.SS1.p1.10.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS1.p1.10.m1.4.4.4.6.2.3" xref="S2.SS1.p1.10.m1.4.4.4.6.1.cmml">)</mo></mrow><mo id="S2.SS1.p1.10.m1.4.4.4.5" xref="S2.SS1.p1.10.m1.4.4.4.5.cmml">∼</mo><mrow id="S2.SS1.p1.10.m1.4.4.4.7" xref="S2.SS1.p1.10.m1.4.4.4.7.cmml"><msub id="S2.SS1.p1.10.m1.4.4.4.7.2" xref="S2.SS1.p1.10.m1.4.4.4.7.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.10.m1.4.4.4.7.2.2" xref="S2.SS1.p1.10.m1.4.4.4.7.2.2.cmml">𝒫</mi><mi id="S2.SS1.p1.10.m1.4.4.4.7.2.3" xref="S2.SS1.p1.10.m1.4.4.4.7.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.10.m1.4.4.4.7.1" xref="S2.SS1.p1.10.m1.4.4.4.7.1.cmml">​</mo><mrow id="S2.SS1.p1.10.m1.4.4.4.7.3.2" xref="S2.SS1.p1.10.m1.4.4.4.7.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.10.m1.4.4.4.7.3.2.1" xref="S2.SS1.p1.10.m1.4.4.4.7.3.1.cmml">(</mo><mi id="S2.SS1.p1.10.m1.3.3.3.3" xref="S2.SS1.p1.10.m1.3.3.3.3.cmml">x</mi><mo id="S2.SS1.p1.10.m1.4.4.4.7.3.2.2" xref="S2.SS1.p1.10.m1.4.4.4.7.3.1.cmml">,</mo><mi id="S2.SS1.p1.10.m1.4.4.4.4" xref="S2.SS1.p1.10.m1.4.4.4.4.cmml">y</mi><mo stretchy="false" id="S2.SS1.p1.10.m1.4.4.4.7.3.2.3" xref="S2.SS1.p1.10.m1.4.4.4.7.3.1.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.10.m1.9.9.1.2" xref="S2.SS1.p1.10.m1.9.9.1.2.cmml">​</mo><mrow id="S2.SS1.p1.10.m1.9.9.1.1.1" xref="S2.SS1.p1.10.m1.9.9.1.1.2.cmml"><mo id="S2.SS1.p1.10.m1.9.9.1.1.1.2" xref="S2.SS1.p1.10.m1.9.9.1.1.2.1.cmml">[</mo><mrow id="S2.SS1.p1.10.m1.9.9.1.1.1.1" xref="S2.SS1.p1.10.m1.9.9.1.1.1.1.cmml"><mi id="S2.SS1.p1.10.m1.9.9.1.1.1.1.2" xref="S2.SS1.p1.10.m1.9.9.1.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.10.m1.9.9.1.1.1.1.1" xref="S2.SS1.p1.10.m1.9.9.1.1.1.1.1.cmml">​</mo><mrow id="S2.SS1.p1.10.m1.9.9.1.1.1.1.3.2" xref="S2.SS1.p1.10.m1.9.9.1.1.1.1.3.1.cmml"><mo id="S2.SS1.p1.10.m1.9.9.1.1.1.1.3.2.1" xref="S2.SS1.p1.10.m1.9.9.1.1.1.1.3.1.cmml">(</mo><mi id="S2.SS1.p1.10.m1.6.6" xref="S2.SS1.p1.10.m1.6.6.cmml">𝒘</mi><mo id="S2.SS1.p1.10.m1.9.9.1.1.1.1.3.2.2" xref="S2.SS1.p1.10.m1.9.9.1.1.1.1.3.1.cmml">;</mo><mi id="S2.SS1.p1.10.m1.7.7" xref="S2.SS1.p1.10.m1.7.7.cmml">x</mi><mo id="S2.SS1.p1.10.m1.9.9.1.1.1.1.3.2.3" xref="S2.SS1.p1.10.m1.9.9.1.1.1.1.3.1.cmml">,</mo><mi id="S2.SS1.p1.10.m1.8.8" xref="S2.SS1.p1.10.m1.8.8.cmml">y</mi><mo id="S2.SS1.p1.10.m1.9.9.1.1.1.1.3.2.4" xref="S2.SS1.p1.10.m1.9.9.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.10.m1.9.9.1.1.1.3" xref="S2.SS1.p1.10.m1.9.9.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m1.9b"><apply id="S2.SS1.p1.10.m1.9.9.cmml" xref="S2.SS1.p1.10.m1.9.9"><eq id="S2.SS1.p1.10.m1.9.9.2.cmml" xref="S2.SS1.p1.10.m1.9.9.2"></eq><apply id="S2.SS1.p1.10.m1.9.9.3.cmml" xref="S2.SS1.p1.10.m1.9.9.3"><times id="S2.SS1.p1.10.m1.9.9.3.1.cmml" xref="S2.SS1.p1.10.m1.9.9.3.1"></times><apply id="S2.SS1.p1.10.m1.9.9.3.2.cmml" xref="S2.SS1.p1.10.m1.9.9.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m1.9.9.3.2.1.cmml" xref="S2.SS1.p1.10.m1.9.9.3.2">subscript</csymbol><ci id="S2.SS1.p1.10.m1.9.9.3.2.2.cmml" xref="S2.SS1.p1.10.m1.9.9.3.2.2">ℒ</ci><ci id="S2.SS1.p1.10.m1.9.9.3.2.3.cmml" xref="S2.SS1.p1.10.m1.9.9.3.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.10.m1.5.5.cmml" xref="S2.SS1.p1.10.m1.5.5">𝒘</ci></apply><apply id="S2.SS1.p1.10.m1.9.9.1.cmml" xref="S2.SS1.p1.10.m1.9.9.1"><times id="S2.SS1.p1.10.m1.9.9.1.2.cmml" xref="S2.SS1.p1.10.m1.9.9.1.2"></times><apply id="S2.SS1.p1.10.m1.9.9.1.3.cmml" xref="S2.SS1.p1.10.m1.9.9.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m1.9.9.1.3.1.cmml" xref="S2.SS1.p1.10.m1.9.9.1.3">subscript</csymbol><ci id="S2.SS1.p1.10.m1.9.9.1.3.2.cmml" xref="S2.SS1.p1.10.m1.9.9.1.3.2">𝔼</ci><apply id="S2.SS1.p1.10.m1.4.4.4.cmml" xref="S2.SS1.p1.10.m1.4.4.4"><csymbol cd="latexml" id="S2.SS1.p1.10.m1.4.4.4.5.cmml" xref="S2.SS1.p1.10.m1.4.4.4.5">similar-to</csymbol><interval closure="open" id="S2.SS1.p1.10.m1.4.4.4.6.1.cmml" xref="S2.SS1.p1.10.m1.4.4.4.6.2"><ci id="S2.SS1.p1.10.m1.1.1.1.1.cmml" xref="S2.SS1.p1.10.m1.1.1.1.1">𝑥</ci><ci id="S2.SS1.p1.10.m1.2.2.2.2.cmml" xref="S2.SS1.p1.10.m1.2.2.2.2">𝑦</ci></interval><apply id="S2.SS1.p1.10.m1.4.4.4.7.cmml" xref="S2.SS1.p1.10.m1.4.4.4.7"><times id="S2.SS1.p1.10.m1.4.4.4.7.1.cmml" xref="S2.SS1.p1.10.m1.4.4.4.7.1"></times><apply id="S2.SS1.p1.10.m1.4.4.4.7.2.cmml" xref="S2.SS1.p1.10.m1.4.4.4.7.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m1.4.4.4.7.2.1.cmml" xref="S2.SS1.p1.10.m1.4.4.4.7.2">subscript</csymbol><ci id="S2.SS1.p1.10.m1.4.4.4.7.2.2.cmml" xref="S2.SS1.p1.10.m1.4.4.4.7.2.2">𝒫</ci><ci id="S2.SS1.p1.10.m1.4.4.4.7.2.3.cmml" xref="S2.SS1.p1.10.m1.4.4.4.7.2.3">𝑖</ci></apply><interval closure="open" id="S2.SS1.p1.10.m1.4.4.4.7.3.1.cmml" xref="S2.SS1.p1.10.m1.4.4.4.7.3.2"><ci id="S2.SS1.p1.10.m1.3.3.3.3.cmml" xref="S2.SS1.p1.10.m1.3.3.3.3">𝑥</ci><ci id="S2.SS1.p1.10.m1.4.4.4.4.cmml" xref="S2.SS1.p1.10.m1.4.4.4.4">𝑦</ci></interval></apply></apply></apply><apply id="S2.SS1.p1.10.m1.9.9.1.1.2.cmml" xref="S2.SS1.p1.10.m1.9.9.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.10.m1.9.9.1.1.2.1.cmml" xref="S2.SS1.p1.10.m1.9.9.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS1.p1.10.m1.9.9.1.1.1.1.cmml" xref="S2.SS1.p1.10.m1.9.9.1.1.1.1"><times id="S2.SS1.p1.10.m1.9.9.1.1.1.1.1.cmml" xref="S2.SS1.p1.10.m1.9.9.1.1.1.1.1"></times><ci id="S2.SS1.p1.10.m1.9.9.1.1.1.1.2.cmml" xref="S2.SS1.p1.10.m1.9.9.1.1.1.1.2">𝑙</ci><list id="S2.SS1.p1.10.m1.9.9.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.10.m1.9.9.1.1.1.1.3.2"><ci id="S2.SS1.p1.10.m1.6.6.cmml" xref="S2.SS1.p1.10.m1.6.6">𝒘</ci><ci id="S2.SS1.p1.10.m1.7.7.cmml" xref="S2.SS1.p1.10.m1.7.7">𝑥</ci><ci id="S2.SS1.p1.10.m1.8.8.cmml" xref="S2.SS1.p1.10.m1.8.8">𝑦</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m1.9c">\mathcal{L}_{i}(\boldsymbol{w})=\mathbb{E}_{(x,y)\sim\mathcal{P}_{i}(x,y)}\left[l\left(\boldsymbol{w};x,y\right)\right]</annotation></semantics></math> is the empirical loss of client <math id="S2.SS1.p1.11.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.11.m2.1a"><mi id="S2.SS1.p1.11.m2.1.1" xref="S2.SS1.p1.11.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m2.1b"><ci id="S2.SS1.p1.11.m2.1.1.cmml" xref="S2.SS1.p1.11.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m2.1c">i</annotation></semantics></math>, <math id="S2.SS1.p1.12.m3.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="S2.SS1.p1.12.m3.1a"><msub id="S2.SS1.p1.12.m3.1.1" xref="S2.SS1.p1.12.m3.1.1.cmml"><mi id="S2.SS1.p1.12.m3.1.1.2" xref="S2.SS1.p1.12.m3.1.1.2.cmml">n</mi><mi id="S2.SS1.p1.12.m3.1.1.3" xref="S2.SS1.p1.12.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m3.1b"><apply id="S2.SS1.p1.12.m3.1.1.cmml" xref="S2.SS1.p1.12.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m3.1.1.1.cmml" xref="S2.SS1.p1.12.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.12.m3.1.1.2.cmml" xref="S2.SS1.p1.12.m3.1.1.2">𝑛</ci><ci id="S2.SS1.p1.12.m3.1.1.3.cmml" xref="S2.SS1.p1.12.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m3.1c">n_{i}</annotation></semantics></math> is the number of samples for client <math id="S2.SS1.p1.13.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.13.m4.1a"><mi id="S2.SS1.p1.13.m4.1.1" xref="S2.SS1.p1.13.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m4.1b"><ci id="S2.SS1.p1.13.m4.1.1.cmml" xref="S2.SS1.p1.13.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m4.1c">i</annotation></semantics></math> and <math id="S2.SS1.p1.14.m5.1" class="ltx_Math" alttext="n=\sum_{i=1}^{m}{n_{i}}" display="inline"><semantics id="S2.SS1.p1.14.m5.1a"><mrow id="S2.SS1.p1.14.m5.1.1" xref="S2.SS1.p1.14.m5.1.1.cmml"><mi id="S2.SS1.p1.14.m5.1.1.2" xref="S2.SS1.p1.14.m5.1.1.2.cmml">n</mi><mo rspace="0.111em" id="S2.SS1.p1.14.m5.1.1.1" xref="S2.SS1.p1.14.m5.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.14.m5.1.1.3" xref="S2.SS1.p1.14.m5.1.1.3.cmml"><msubsup id="S2.SS1.p1.14.m5.1.1.3.1" xref="S2.SS1.p1.14.m5.1.1.3.1.cmml"><mo id="S2.SS1.p1.14.m5.1.1.3.1.2.2" xref="S2.SS1.p1.14.m5.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.SS1.p1.14.m5.1.1.3.1.2.3" xref="S2.SS1.p1.14.m5.1.1.3.1.2.3.cmml"><mi id="S2.SS1.p1.14.m5.1.1.3.1.2.3.2" xref="S2.SS1.p1.14.m5.1.1.3.1.2.3.2.cmml">i</mi><mo id="S2.SS1.p1.14.m5.1.1.3.1.2.3.1" xref="S2.SS1.p1.14.m5.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.SS1.p1.14.m5.1.1.3.1.2.3.3" xref="S2.SS1.p1.14.m5.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.14.m5.1.1.3.1.3" xref="S2.SS1.p1.14.m5.1.1.3.1.3.cmml">m</mi></msubsup><msub id="S2.SS1.p1.14.m5.1.1.3.2" xref="S2.SS1.p1.14.m5.1.1.3.2.cmml"><mi id="S2.SS1.p1.14.m5.1.1.3.2.2" xref="S2.SS1.p1.14.m5.1.1.3.2.2.cmml">n</mi><mi id="S2.SS1.p1.14.m5.1.1.3.2.3" xref="S2.SS1.p1.14.m5.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.14.m5.1b"><apply id="S2.SS1.p1.14.m5.1.1.cmml" xref="S2.SS1.p1.14.m5.1.1"><eq id="S2.SS1.p1.14.m5.1.1.1.cmml" xref="S2.SS1.p1.14.m5.1.1.1"></eq><ci id="S2.SS1.p1.14.m5.1.1.2.cmml" xref="S2.SS1.p1.14.m5.1.1.2">𝑛</ci><apply id="S2.SS1.p1.14.m5.1.1.3.cmml" xref="S2.SS1.p1.14.m5.1.1.3"><apply id="S2.SS1.p1.14.m5.1.1.3.1.cmml" xref="S2.SS1.p1.14.m5.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS1.p1.14.m5.1.1.3.1.1.cmml" xref="S2.SS1.p1.14.m5.1.1.3.1">superscript</csymbol><apply id="S2.SS1.p1.14.m5.1.1.3.1.2.cmml" xref="S2.SS1.p1.14.m5.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS1.p1.14.m5.1.1.3.1.2.1.cmml" xref="S2.SS1.p1.14.m5.1.1.3.1">subscript</csymbol><sum id="S2.SS1.p1.14.m5.1.1.3.1.2.2.cmml" xref="S2.SS1.p1.14.m5.1.1.3.1.2.2"></sum><apply id="S2.SS1.p1.14.m5.1.1.3.1.2.3.cmml" xref="S2.SS1.p1.14.m5.1.1.3.1.2.3"><eq id="S2.SS1.p1.14.m5.1.1.3.1.2.3.1.cmml" xref="S2.SS1.p1.14.m5.1.1.3.1.2.3.1"></eq><ci id="S2.SS1.p1.14.m5.1.1.3.1.2.3.2.cmml" xref="S2.SS1.p1.14.m5.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S2.SS1.p1.14.m5.1.1.3.1.2.3.3.cmml" xref="S2.SS1.p1.14.m5.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.14.m5.1.1.3.1.3.cmml" xref="S2.SS1.p1.14.m5.1.1.3.1.3">𝑚</ci></apply><apply id="S2.SS1.p1.14.m5.1.1.3.2.cmml" xref="S2.SS1.p1.14.m5.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.14.m5.1.1.3.2.1.cmml" xref="S2.SS1.p1.14.m5.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p1.14.m5.1.1.3.2.2.cmml" xref="S2.SS1.p1.14.m5.1.1.3.2.2">𝑛</ci><ci id="S2.SS1.p1.14.m5.1.1.3.2.3.cmml" xref="S2.SS1.p1.14.m5.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.14.m5.1c">n=\sum_{i=1}^{m}{n_{i}}</annotation></semantics></math>, and <math id="S2.SS1.p1.15.m6.1" class="ltx_Math" alttext="\boldsymbol{w}" display="inline"><semantics id="S2.SS1.p1.15.m6.1a"><mi id="S2.SS1.p1.15.m6.1.1" xref="S2.SS1.p1.15.m6.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.15.m6.1b"><ci id="S2.SS1.p1.15.m6.1.1.cmml" xref="S2.SS1.p1.15.m6.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.15.m6.1c">\boldsymbol{w}</annotation></semantics></math> denotes the global model parameter. In data heterogeneity setting, <math id="S2.SS1.p1.16.m7.1" class="ltx_Math" alttext="\mathcal{P}_{i}\neq\mathcal{P}_{j}" display="inline"><semantics id="S2.SS1.p1.16.m7.1a"><mrow id="S2.SS1.p1.16.m7.1.1" xref="S2.SS1.p1.16.m7.1.1.cmml"><msub id="S2.SS1.p1.16.m7.1.1.2" xref="S2.SS1.p1.16.m7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.16.m7.1.1.2.2" xref="S2.SS1.p1.16.m7.1.1.2.2.cmml">𝒫</mi><mi id="S2.SS1.p1.16.m7.1.1.2.3" xref="S2.SS1.p1.16.m7.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS1.p1.16.m7.1.1.1" xref="S2.SS1.p1.16.m7.1.1.1.cmml">≠</mo><msub id="S2.SS1.p1.16.m7.1.1.3" xref="S2.SS1.p1.16.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.16.m7.1.1.3.2" xref="S2.SS1.p1.16.m7.1.1.3.2.cmml">𝒫</mi><mi id="S2.SS1.p1.16.m7.1.1.3.3" xref="S2.SS1.p1.16.m7.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.16.m7.1b"><apply id="S2.SS1.p1.16.m7.1.1.cmml" xref="S2.SS1.p1.16.m7.1.1"><neq id="S2.SS1.p1.16.m7.1.1.1.cmml" xref="S2.SS1.p1.16.m7.1.1.1"></neq><apply id="S2.SS1.p1.16.m7.1.1.2.cmml" xref="S2.SS1.p1.16.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.16.m7.1.1.2.1.cmml" xref="S2.SS1.p1.16.m7.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.16.m7.1.1.2.2.cmml" xref="S2.SS1.p1.16.m7.1.1.2.2">𝒫</ci><ci id="S2.SS1.p1.16.m7.1.1.2.3.cmml" xref="S2.SS1.p1.16.m7.1.1.2.3">𝑖</ci></apply><apply id="S2.SS1.p1.16.m7.1.1.3.cmml" xref="S2.SS1.p1.16.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.16.m7.1.1.3.1.cmml" xref="S2.SS1.p1.16.m7.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.16.m7.1.1.3.2.cmml" xref="S2.SS1.p1.16.m7.1.1.3.2">𝒫</ci><ci id="S2.SS1.p1.16.m7.1.1.3.3.cmml" xref="S2.SS1.p1.16.m7.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.16.m7.1c">\mathcal{P}_{i}\neq\mathcal{P}_{j}</annotation></semantics></math> for different client <math id="S2.SS1.p1.17.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.17.m8.1a"><mi id="S2.SS1.p1.17.m8.1.1" xref="S2.SS1.p1.17.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.17.m8.1b"><ci id="S2.SS1.p1.17.m8.1.1.cmml" xref="S2.SS1.p1.17.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.17.m8.1c">i</annotation></semantics></math> and client <math id="S2.SS1.p1.18.m9.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS1.p1.18.m9.1a"><mi id="S2.SS1.p1.18.m9.1.1" xref="S2.SS1.p1.18.m9.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.18.m9.1b"><ci id="S2.SS1.p1.18.m9.1.1.cmml" xref="S2.SS1.p1.18.m9.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.18.m9.1c">j</annotation></semantics></math>. This disparity causes the local model to perform differently across clients, which degrades FL performance or even causes model divergence.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Global Loss Objective Decomposition</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.19" class="ltx_p">To better understand the influence of data heterogeneity on FedAvg in each round, we decompose the loss function in Eq.(<a href="#S2.E1" title="In 2.1 Problem Setup ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) as follows:
<span id="S2.SS2.p1.19.1" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S2.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}(\boldsymbol{w})=" display="inline"><semantics id="S2.E2X.2.1.1.m1.1a"><mrow id="S2.E2X.2.1.1.m1.1.2" xref="S2.E2X.2.1.1.m1.1.2.cmml"><mrow id="S2.E2X.2.1.1.m1.1.2.2" xref="S2.E2X.2.1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E2X.2.1.1.m1.1.2.2.2" xref="S2.E2X.2.1.1.m1.1.2.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.E2X.2.1.1.m1.1.2.2.1" xref="S2.E2X.2.1.1.m1.1.2.2.1.cmml">​</mo><mrow id="S2.E2X.2.1.1.m1.1.2.2.3.2" xref="S2.E2X.2.1.1.m1.1.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E2X.2.1.1.m1.1.2.2.3.2.1" xref="S2.E2X.2.1.1.m1.1.2.2.cmml">(</mo><mi mathsize="90%" id="S2.E2X.2.1.1.m1.1.1" xref="S2.E2X.2.1.1.m1.1.1.cmml">𝒘</mi><mo maxsize="90%" minsize="90%" id="S2.E2X.2.1.1.m1.1.2.2.3.2.2" xref="S2.E2X.2.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.E2X.2.1.1.m1.1.2.1" xref="S2.E2X.2.1.1.m1.1.2.1.cmml">=</mo><mi id="S2.E2X.2.1.1.m1.1.2.3" xref="S2.E2X.2.1.1.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S2.E2X.2.1.1.m1.1b"><apply id="S2.E2X.2.1.1.m1.1.2.cmml" xref="S2.E2X.2.1.1.m1.1.2"><eq id="S2.E2X.2.1.1.m1.1.2.1.cmml" xref="S2.E2X.2.1.1.m1.1.2.1"></eq><apply id="S2.E2X.2.1.1.m1.1.2.2.cmml" xref="S2.E2X.2.1.1.m1.1.2.2"><times id="S2.E2X.2.1.1.m1.1.2.2.1.cmml" xref="S2.E2X.2.1.1.m1.1.2.2.1"></times><ci id="S2.E2X.2.1.1.m1.1.2.2.2.cmml" xref="S2.E2X.2.1.1.m1.1.2.2.2">ℒ</ci><ci id="S2.E2X.2.1.1.m1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1">𝒘</ci></apply><csymbol cd="latexml" id="S2.E2X.2.1.1.m1.1.2.3.cmml" xref="S2.E2X.2.1.1.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2X.2.1.1.m1.1c">\displaystyle\mathcal{L}(\boldsymbol{w})=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\sum_{i=1}^{m}\frac{n_{i}}{n}\mathcal{L}_{i}(\boldsymbol{w})" display="inline"><semantics id="S2.E2X.3.2.2.m1.1a"><mrow id="S2.E2X.3.2.2.m1.1.2" xref="S2.E2X.3.2.2.m1.1.2.cmml"><mstyle displaystyle="true" id="S2.E2X.3.2.2.m1.1.2.1" xref="S2.E2X.3.2.2.m1.1.2.1.cmml"><munderover id="S2.E2X.3.2.2.m1.1.2.1a" xref="S2.E2X.3.2.2.m1.1.2.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E2X.3.2.2.m1.1.2.1.2.2" xref="S2.E2X.3.2.2.m1.1.2.1.2.2.cmml">∑</mo><mrow id="S2.E2X.3.2.2.m1.1.2.1.2.3" xref="S2.E2X.3.2.2.m1.1.2.1.2.3.cmml"><mi mathsize="90%" id="S2.E2X.3.2.2.m1.1.2.1.2.3.2" xref="S2.E2X.3.2.2.m1.1.2.1.2.3.2.cmml">i</mi><mo mathsize="90%" id="S2.E2X.3.2.2.m1.1.2.1.2.3.1" xref="S2.E2X.3.2.2.m1.1.2.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E2X.3.2.2.m1.1.2.1.2.3.3" xref="S2.E2X.3.2.2.m1.1.2.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E2X.3.2.2.m1.1.2.1.3" xref="S2.E2X.3.2.2.m1.1.2.1.3.cmml">m</mi></munderover></mstyle><mrow id="S2.E2X.3.2.2.m1.1.2.2" xref="S2.E2X.3.2.2.m1.1.2.2.cmml"><mstyle displaystyle="true" id="S2.E2X.3.2.2.m1.1.2.2.2" xref="S2.E2X.3.2.2.m1.1.2.2.2.cmml"><mfrac id="S2.E2X.3.2.2.m1.1.2.2.2a" xref="S2.E2X.3.2.2.m1.1.2.2.2.cmml"><msub id="S2.E2X.3.2.2.m1.1.2.2.2.2" xref="S2.E2X.3.2.2.m1.1.2.2.2.2.cmml"><mi mathsize="90%" id="S2.E2X.3.2.2.m1.1.2.2.2.2.2" xref="S2.E2X.3.2.2.m1.1.2.2.2.2.2.cmml">n</mi><mi mathsize="90%" id="S2.E2X.3.2.2.m1.1.2.2.2.2.3" xref="S2.E2X.3.2.2.m1.1.2.2.2.2.3.cmml">i</mi></msub><mi mathsize="90%" id="S2.E2X.3.2.2.m1.1.2.2.2.3" xref="S2.E2X.3.2.2.m1.1.2.2.2.3.cmml">n</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E2X.3.2.2.m1.1.2.2.1" xref="S2.E2X.3.2.2.m1.1.2.2.1.cmml">​</mo><msub id="S2.E2X.3.2.2.m1.1.2.2.3" xref="S2.E2X.3.2.2.m1.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E2X.3.2.2.m1.1.2.2.3.2" xref="S2.E2X.3.2.2.m1.1.2.2.3.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.E2X.3.2.2.m1.1.2.2.3.3" xref="S2.E2X.3.2.2.m1.1.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2X.3.2.2.m1.1.2.2.1a" xref="S2.E2X.3.2.2.m1.1.2.2.1.cmml">​</mo><mrow id="S2.E2X.3.2.2.m1.1.2.2.4.2" xref="S2.E2X.3.2.2.m1.1.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E2X.3.2.2.m1.1.2.2.4.2.1" xref="S2.E2X.3.2.2.m1.1.2.2.cmml">(</mo><mi mathsize="90%" id="S2.E2X.3.2.2.m1.1.1" xref="S2.E2X.3.2.2.m1.1.1.cmml">𝒘</mi><mo maxsize="90%" minsize="90%" id="S2.E2X.3.2.2.m1.1.2.2.4.2.2" xref="S2.E2X.3.2.2.m1.1.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2X.3.2.2.m1.1b"><apply id="S2.E2X.3.2.2.m1.1.2.cmml" xref="S2.E2X.3.2.2.m1.1.2"><apply id="S2.E2X.3.2.2.m1.1.2.1.cmml" xref="S2.E2X.3.2.2.m1.1.2.1"><csymbol cd="ambiguous" id="S2.E2X.3.2.2.m1.1.2.1.1.cmml" xref="S2.E2X.3.2.2.m1.1.2.1">superscript</csymbol><apply id="S2.E2X.3.2.2.m1.1.2.1.2.cmml" xref="S2.E2X.3.2.2.m1.1.2.1"><csymbol cd="ambiguous" id="S2.E2X.3.2.2.m1.1.2.1.2.1.cmml" xref="S2.E2X.3.2.2.m1.1.2.1">subscript</csymbol><sum id="S2.E2X.3.2.2.m1.1.2.1.2.2.cmml" xref="S2.E2X.3.2.2.m1.1.2.1.2.2"></sum><apply id="S2.E2X.3.2.2.m1.1.2.1.2.3.cmml" xref="S2.E2X.3.2.2.m1.1.2.1.2.3"><eq id="S2.E2X.3.2.2.m1.1.2.1.2.3.1.cmml" xref="S2.E2X.3.2.2.m1.1.2.1.2.3.1"></eq><ci id="S2.E2X.3.2.2.m1.1.2.1.2.3.2.cmml" xref="S2.E2X.3.2.2.m1.1.2.1.2.3.2">𝑖</ci><cn type="integer" id="S2.E2X.3.2.2.m1.1.2.1.2.3.3.cmml" xref="S2.E2X.3.2.2.m1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S2.E2X.3.2.2.m1.1.2.1.3.cmml" xref="S2.E2X.3.2.2.m1.1.2.1.3">𝑚</ci></apply><apply id="S2.E2X.3.2.2.m1.1.2.2.cmml" xref="S2.E2X.3.2.2.m1.1.2.2"><times id="S2.E2X.3.2.2.m1.1.2.2.1.cmml" xref="S2.E2X.3.2.2.m1.1.2.2.1"></times><apply id="S2.E2X.3.2.2.m1.1.2.2.2.cmml" xref="S2.E2X.3.2.2.m1.1.2.2.2"><divide id="S2.E2X.3.2.2.m1.1.2.2.2.1.cmml" xref="S2.E2X.3.2.2.m1.1.2.2.2"></divide><apply id="S2.E2X.3.2.2.m1.1.2.2.2.2.cmml" xref="S2.E2X.3.2.2.m1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2X.3.2.2.m1.1.2.2.2.2.1.cmml" xref="S2.E2X.3.2.2.m1.1.2.2.2.2">subscript</csymbol><ci id="S2.E2X.3.2.2.m1.1.2.2.2.2.2.cmml" xref="S2.E2X.3.2.2.m1.1.2.2.2.2.2">𝑛</ci><ci id="S2.E2X.3.2.2.m1.1.2.2.2.2.3.cmml" xref="S2.E2X.3.2.2.m1.1.2.2.2.2.3">𝑖</ci></apply><ci id="S2.E2X.3.2.2.m1.1.2.2.2.3.cmml" xref="S2.E2X.3.2.2.m1.1.2.2.2.3">𝑛</ci></apply><apply id="S2.E2X.3.2.2.m1.1.2.2.3.cmml" xref="S2.E2X.3.2.2.m1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E2X.3.2.2.m1.1.2.2.3.1.cmml" xref="S2.E2X.3.2.2.m1.1.2.2.3">subscript</csymbol><ci id="S2.E2X.3.2.2.m1.1.2.2.3.2.cmml" xref="S2.E2X.3.2.2.m1.1.2.2.3.2">ℒ</ci><ci id="S2.E2X.3.2.2.m1.1.2.2.3.3.cmml" xref="S2.E2X.3.2.2.m1.1.2.2.3.3">𝑖</ci></apply><ci id="S2.E2X.3.2.2.m1.1.1.cmml" xref="S2.E2X.3.2.2.m1.1.1">𝒘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2X.3.2.2.m1.1c">\displaystyle\sum_{i=1}^{m}\frac{n_{i}}{n}\mathcal{L}_{i}(\boldsymbol{w})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr id="S2.E2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S2.E2Xa.2.1.1.m1.1a"><mo mathsize="90%" id="S2.E2Xa.2.1.1.m1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S2.E2Xa.2.1.1.m1.1b"><eq id="S2.E2Xa.2.1.1.m1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S2.E2Xa.2.1.1.m1.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2Xa.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle\underbrace{\sum_{i=1}^{m}\frac{n_{i}}{n}\mathcal{L}_{i}\left(\boldsymbol{w}_{i}\right)}_{\begin{subarray}{c}\text{Local loss}\\
\end{subarray}}+\underbrace{\sum_{j=1}^{m}\sum_{i=1}^{m}\frac{n_{j}}{n}\frac{n_{i}}{n}\left(\mathcal{L}_{j}\left(\boldsymbol{w}_{i}\right)-\mathcal{L}_{i}\left(\boldsymbol{w}_{i}\right)\right)}_{\text{Distribution shift loss}}+\underbrace{\sum_{i=1}^{m}\frac{n_{i}}{n}\left(\mathcal{L}(\boldsymbol{w})-\mathcal{L}\left(\boldsymbol{w}_{i}\right)\right)}_{\text{Aggregation loss}}." display="inline"><semantics id="S2.E2Xa.3.2.2.m1.5a"><mrow id="S2.E2Xa.3.2.2.m1.5.5.1" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.cmml"><mrow id="S2.E2Xa.3.2.2.m1.5.5.1.1" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.cmml"><munder id="S2.E2Xa.3.2.2.m1.5.5.1.1.2" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.2.cmml"><munder accentunder="true" id="S2.E2Xa.3.2.2.m1.1.1" xref="S2.E2Xa.3.2.2.m1.1.1.cmml"><mrow id="S2.E2Xa.3.2.2.m1.1.1.1" xref="S2.E2Xa.3.2.2.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E2Xa.3.2.2.m1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.cmml"><munderover id="S2.E2Xa.3.2.2.m1.1.1.1.2a" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E2Xa.3.2.2.m1.1.1.1.2.2.2" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.cmml"><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.2" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.2.cmml">i</mi><mo mathsize="90%" id="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.1" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.3" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.1.1.1.2.3" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.3.cmml">m</mi></munderover></mstyle><mrow id="S2.E2Xa.3.2.2.m1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E2Xa.3.2.2.m1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3.cmml"><mfrac id="S2.E2Xa.3.2.2.m1.1.1.1.1.3a" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3.cmml"><msub id="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2.cmml"><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2.2" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml">n</mi><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2.3" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml">i</mi></msub><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.1.1.1.1.3.3" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3.3.cmml">n</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E2Xa.3.2.2.m1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.2.cmml">​</mo><msub id="S2.E2Xa.3.2.2.m1.1.1.1.1.4" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E2Xa.3.2.2.m1.1.1.1.1.4.2" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.4.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.1.1.1.1.4.3" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2Xa.3.2.2.m1.1.1.1.1.2a" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo mathsize="90%" id="S2.E2Xa.3.2.2.m1.1.1.2" xref="S2.E2Xa.3.2.2.m1.1.1.2.cmml">⏟</mo></munder><mtable id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mf" xref="S2.E2.m1.1.1.1.1.1.1.1a.2.cmml"><mtr id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mfa" xref="S2.E2.m1.1.1.1.1.1.1.1a.2.cmml"><mtd id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mfb" xref="S2.E2.m1.1.1.1.1.1.1.1a.2.cmml"><mtext id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1a.cmml">Local loss</mtext></mtd></mtr></mtable></munder><mo mathsize="90%" id="S2.E2Xa.3.2.2.m1.5.5.1.1.1" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.1.cmml">+</mo><munder id="S2.E2Xa.3.2.2.m1.5.5.1.1.3" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.3.cmml"><munder accentunder="true" id="S2.E2Xa.3.2.2.m1.2.2" xref="S2.E2Xa.3.2.2.m1.2.2.cmml"><mrow id="S2.E2Xa.3.2.2.m1.2.2.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.cmml"><mstyle displaystyle="true" id="S2.E2Xa.3.2.2.m1.2.2.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.cmml"><munderover id="S2.E2Xa.3.2.2.m1.2.2.1.2a" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E2Xa.3.2.2.m1.2.2.1.2.2.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.cmml"><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.2.cmml">j</mi><mo mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.2.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.3.cmml">m</mi></munderover></mstyle><mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S2.E2Xa.3.2.2.m1.2.2.1.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.cmml"><munderover id="S2.E2Xa.3.2.2.m1.2.2.1.1.2a" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.cmml"><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.2.cmml">i</mi><mo mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.3.cmml">m</mi></munderover></mstyle><mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.cmml"><mfrac id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3a" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.cmml"><msub id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2.cmml"><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2.2.cmml">n</mi><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2.3.cmml">j</mi></msub><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.cmml">n</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.2.cmml">​</mo><mstyle displaystyle="true" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.cmml"><mfrac id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4a" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.cmml"><msub id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2.cmml"><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2.2.cmml">n</mi><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2.3.cmml">i</mi></msub><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.3.cmml">n</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.2a" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml"><msub id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">ℒ</mi><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml"><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S2.E2Xa.3.2.2.m1.2.2.2" xref="S2.E2Xa.3.2.2.m1.2.2.2.cmml">⏟</mo></munder><mtext mathsize="90%" id="S2.E2Xa.3.2.2.m1.5.5.1.1.3.2" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.3.2a.cmml">Distribution shift loss</mtext></munder><mo mathsize="90%" id="S2.E2Xa.3.2.2.m1.5.5.1.1.1a" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.1.cmml">+</mo><munder id="S2.E2Xa.3.2.2.m1.5.5.1.1.4" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.4.cmml"><munder accentunder="true" id="S2.E2Xa.3.2.2.m1.4.4" xref="S2.E2Xa.3.2.2.m1.4.4.cmml"><mrow id="S2.E2Xa.3.2.2.m1.4.4.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.cmml"><mstyle displaystyle="true" id="S2.E2Xa.3.2.2.m1.4.4.2.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.cmml"><munderover id="S2.E2Xa.3.2.2.m1.4.4.2.3a" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E2Xa.3.2.2.m1.4.4.2.3.2.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.2.2.cmml">∑</mo><mrow id="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.cmml"><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.2.cmml">i</mi><mo mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.3.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.3.cmml">m</mi></munderover></mstyle><mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.cmml"><mstyle displaystyle="true" id="S2.E2Xa.3.2.2.m1.4.4.2.2.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3.cmml"><mfrac id="S2.E2Xa.3.2.2.m1.4.4.2.2.3a" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3.cmml"><msub id="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2.cmml"><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2.2.cmml">n</mi><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2.3.cmml">i</mi></msub><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.2.3.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3.3.cmml">n</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E2Xa.3.2.2.m1.4.4.2.2.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2.cmml">​</mo><mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.cmml"><mo id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.cmml">(</mo><mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.cmml"><mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.1.cmml">​</mo><mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.3.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.3.2.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.3.3.1.1" xref="S2.E2Xa.3.2.2.m1.3.3.1.1.cmml">𝒘</mi><mo maxsize="90%" minsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.3.2.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.2.cmml">−</mo><mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.cmml"><mo id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.3" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo mathsize="90%" id="S2.E2Xa.3.2.2.m1.4.4.3" xref="S2.E2Xa.3.2.2.m1.4.4.3.cmml">⏟</mo></munder><mtext mathsize="90%" id="S2.E2Xa.3.2.2.m1.5.5.1.1.4.2" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.4.2a.cmml">Aggregation loss</mtext></munder></mrow><mo lspace="0em" mathsize="90%" id="S2.E2Xa.3.2.2.m1.5.5.1.2" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2Xa.3.2.2.m1.5b"><apply id="S2.E2Xa.3.2.2.m1.5.5.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1"><plus id="S2.E2Xa.3.2.2.m1.5.5.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.1"></plus><apply id="S2.E2Xa.3.2.2.m1.5.5.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.5.5.1.1.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.2">subscript</csymbol><apply id="S2.E2Xa.3.2.2.m1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1"><ci id="S2.E2Xa.3.2.2.m1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.2">⏟</ci><apply id="S2.E2Xa.3.2.2.m1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1"><apply id="S2.E2Xa.3.2.2.m1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.1.1.1.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.2">superscript</csymbol><apply id="S2.E2Xa.3.2.2.m1.1.1.1.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.1.1.1.2.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.2">subscript</csymbol><sum id="S2.E2Xa.3.2.2.m1.1.1.1.2.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.2.2"></sum><apply id="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3"><eq id="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.1"></eq><ci id="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2Xa.3.2.2.m1.1.1.1.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.2.3">𝑚</ci></apply><apply id="S2.E2Xa.3.2.2.m1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1"><times id="S2.E2Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.2"></times><apply id="S2.E2Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3"><divide id="S2.E2Xa.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3"></divide><apply id="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2.2">𝑛</ci><ci id="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.E2Xa.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S2.E2Xa.3.2.2.m1.1.1.1.1.4.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.1.1.1.1.4.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.4">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.1.1.1.1.4.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.4.2">ℒ</ci><ci id="S2.E2Xa.3.2.2.m1.1.1.1.1.4.3.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.4.3">𝑖</ci></apply><apply id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.2">𝒘</ci><ci id="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><list id="S2.E2.m1.1.1.1.1.1.1.1a.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mf"><matrix id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mf.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mf"><matrixrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mfa.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mf"><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1a.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1"><mtext mathsize="70%" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.mf.1.1.1">Local loss</mtext></ci></matrixrow></matrix></list></apply><apply id="S2.E2Xa.3.2.2.m1.5.5.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.5.5.1.1.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.3">subscript</csymbol><apply id="S2.E2Xa.3.2.2.m1.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2"><ci id="S2.E2Xa.3.2.2.m1.2.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.2">⏟</ci><apply id="S2.E2Xa.3.2.2.m1.2.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1"><apply id="S2.E2Xa.3.2.2.m1.2.2.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.2">superscript</csymbol><apply id="S2.E2Xa.3.2.2.m1.2.2.1.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.2.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.2">subscript</csymbol><sum id="S2.E2Xa.3.2.2.m1.2.2.1.2.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.2.2"></sum><apply id="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3"><eq id="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.1"></eq><ci id="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.2">𝑗</ci><cn type="integer" id="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2Xa.3.2.2.m1.2.2.1.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.3">𝑚</ci></apply><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1"><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2">superscript</csymbol><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2">subscript</csymbol><sum id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.2"></sum><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3"><eq id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.1"></eq><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.2.3">𝑚</ci></apply><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1"><times id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.2"></times><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3"><divide id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3"></divide><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2.2">𝑛</ci><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.2.3">𝑗</ci></apply><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3.3">𝑛</ci></apply><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4"><divide id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4"></divide><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2.2">𝑛</ci><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.2.3">𝑖</ci></apply><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.4.3">𝑛</ci></apply><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1"><minus id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.3"></minus><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1"><times id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.2"></times><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2">ℒ</ci><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.3">𝑗</ci></apply><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝒘</ci><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2"><times id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.2"></times><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.2">ℒ</ci><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.3.3">𝑖</ci></apply><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.2">𝒘</ci><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.1.2.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply><ci id="S2.E2Xa.3.2.2.m1.5.5.1.1.3.2a.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.3.2"><mtext mathsize="63%" id="S2.E2Xa.3.2.2.m1.5.5.1.1.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.3.2">Distribution shift loss</mtext></ci></apply><apply id="S2.E2Xa.3.2.2.m1.5.5.1.1.4.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.5.5.1.1.4.1.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.4">subscript</csymbol><apply id="S2.E2Xa.3.2.2.m1.4.4.cmml" xref="S2.E2Xa.3.2.2.m1.4.4"><ci id="S2.E2Xa.3.2.2.m1.4.4.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.3">⏟</ci><apply id="S2.E2Xa.3.2.2.m1.4.4.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2"><apply id="S2.E2Xa.3.2.2.m1.4.4.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.3"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.4.4.2.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.3">superscript</csymbol><apply id="S2.E2Xa.3.2.2.m1.4.4.2.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.3"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.4.4.2.3.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.3">subscript</csymbol><sum id="S2.E2Xa.3.2.2.m1.4.4.2.3.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.2.2"></sum><apply id="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3"><eq id="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.1"></eq><ci id="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.2">𝑖</ci><cn type="integer" id="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E2Xa.3.2.2.m1.4.4.2.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.3">𝑚</ci></apply><apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2"><times id="S2.E2Xa.3.2.2.m1.4.4.2.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.2"></times><apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3"><divide id="S2.E2Xa.3.2.2.m1.4.4.2.2.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3"></divide><apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2.2">𝑛</ci><ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3.2.3">𝑖</ci></apply><ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.3.3">𝑛</ci></apply><apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1"><minus id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.2"></minus><apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3"><times id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.1"></times><ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.3.2">ℒ</ci><ci id="S2.E2Xa.3.2.2.m1.3.3.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.3.3.1.1">𝒘</ci></apply><apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1"><times id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.2"></times><ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.3">ℒ</ci><apply id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.2">𝒘</ci><ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply><ci id="S2.E2Xa.3.2.2.m1.5.5.1.1.4.2a.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.4.2"><mtext mathsize="63%" id="S2.E2Xa.3.2.2.m1.5.5.1.1.4.2.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.4.2">Aggregation loss</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2Xa.3.2.2.m1.5c">\displaystyle\underbrace{\sum_{i=1}^{m}\frac{n_{i}}{n}\mathcal{L}_{i}\left(\boldsymbol{w}_{i}\right)}_{\begin{subarray}{c}\text{Local loss}\\
\end{subarray}}+\underbrace{\sum_{j=1}^{m}\sum_{i=1}^{m}\frac{n_{j}}{n}\frac{n_{i}}{n}\left(\mathcal{L}_{j}\left(\boldsymbol{w}_{i}\right)-\mathcal{L}_{i}\left(\boldsymbol{w}_{i}\right)\right)}_{\text{Distribution shift loss}}+\underbrace{\sum_{i=1}^{m}\frac{n_{i}}{n}\left(\mathcal{L}(\boldsymbol{w})-\mathcal{L}\left(\boldsymbol{w}_{i}\right)\right)}_{\text{Aggregation loss}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S2.SS2.p1.18" class="ltx_p"><span id="S2.SS2.p1.18.18" class="ltx_text" style="font-size:90%;">Here <math id="S2.SS2.p1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{j}\left(\boldsymbol{w}_{i}\right)" display="inline"><semantics id="S2.SS2.p1.1.1.m1.1a"><mrow id="S2.SS2.p1.1.1.m1.1.1" xref="S2.SS2.p1.1.1.m1.1.1.cmml"><msub id="S2.SS2.p1.1.1.m1.1.1.3" xref="S2.SS2.p1.1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.1.m1.1.1.3.2" xref="S2.SS2.p1.1.1.m1.1.1.3.2.cmml">ℒ</mi><mi id="S2.SS2.p1.1.1.m1.1.1.3.3" xref="S2.SS2.p1.1.1.m1.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.1.m1.1.1.2" xref="S2.SS2.p1.1.1.m1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p1.1.1.m1.1.1.1.1" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.1.1.m1.1.1.1.1.2" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p1.1.1.m1.1.1.1.1.1" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.1.1.m1.1.1.1.1.1.2" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.2.cmml">𝒘</mi><mi id="S2.SS2.p1.1.1.m1.1.1.1.1.1.3" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS2.p1.1.1.m1.1.1.1.1.3" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.1.m1.1b"><apply id="S2.SS2.p1.1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.1.m1.1.1"><times id="S2.SS2.p1.1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.1.m1.1.1.2"></times><apply id="S2.SS2.p1.1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.1.m1.1.1.3.1.cmml" xref="S2.SS2.p1.1.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.1.1.m1.1.1.3.2.cmml" xref="S2.SS2.p1.1.1.m1.1.1.3.2">ℒ</ci><ci id="S2.SS2.p1.1.1.m1.1.1.3.3.cmml" xref="S2.SS2.p1.1.1.m1.1.1.3.3">𝑗</ci></apply><apply id="S2.SS2.p1.1.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.2">𝒘</ci><ci id="S2.SS2.p1.1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.1.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.1.m1.1c">\mathcal{L}_{j}\left(\boldsymbol{w}_{i}\right)</annotation></semantics></math> denotes the empirical loss of client <math id="S2.SS2.p1.2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p1.2.2.m2.1a"><mi id="S2.SS2.p1.2.2.m2.1.1" xref="S2.SS2.p1.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.2.m2.1b"><ci id="S2.SS2.p1.2.2.m2.1.1.cmml" xref="S2.SS2.p1.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.2.m2.1c">i</annotation></semantics></math>’s local model <math id="S2.SS2.p1.3.3.m3.1" class="ltx_Math" alttext="\boldsymbol{w}_{i}" display="inline"><semantics id="S2.SS2.p1.3.3.m3.1a"><msub id="S2.SS2.p1.3.3.m3.1.1" xref="S2.SS2.p1.3.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.3.m3.1.1.2" xref="S2.SS2.p1.3.3.m3.1.1.2.cmml">𝒘</mi><mi id="S2.SS2.p1.3.3.m3.1.1.3" xref="S2.SS2.p1.3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.3.m3.1b"><apply id="S2.SS2.p1.3.3.m3.1.1.cmml" xref="S2.SS2.p1.3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.3.m3.1.1.2">𝒘</ci><ci id="S2.SS2.p1.3.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.3.m3.1c">\boldsymbol{w}_{i}</annotation></semantics></math> when evaluated on the client <math id="S2.SS2.p1.4.4.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS2.p1.4.4.m4.1a"><mi id="S2.SS2.p1.4.4.m4.1.1" xref="S2.SS2.p1.4.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.4.m4.1b"><ci id="S2.SS2.p1.4.4.m4.1.1.cmml" xref="S2.SS2.p1.4.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.4.m4.1c">j</annotation></semantics></math>’s local dataset. The formula in Eq.(<a href="#S2.E2" title="In 2.2 Global Loss Objective Decomposition ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) holds because <math id="S2.SS2.p1.5.5.m5.2" class="ltx_Math" alttext="\sum_{j=1}^{m}\frac{n_{j}}{n}\mathcal{L}_{j}(\cdot)=\mathcal{L}(\cdot)" display="inline"><semantics id="S2.SS2.p1.5.5.m5.2a"><mrow id="S2.SS2.p1.5.5.m5.2.3" xref="S2.SS2.p1.5.5.m5.2.3.cmml"><mrow id="S2.SS2.p1.5.5.m5.2.3.2" xref="S2.SS2.p1.5.5.m5.2.3.2.cmml"><msubsup id="S2.SS2.p1.5.5.m5.2.3.2.1" xref="S2.SS2.p1.5.5.m5.2.3.2.1.cmml"><mo id="S2.SS2.p1.5.5.m5.2.3.2.1.2.2" xref="S2.SS2.p1.5.5.m5.2.3.2.1.2.2.cmml">∑</mo><mrow id="S2.SS2.p1.5.5.m5.2.3.2.1.2.3" xref="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.cmml"><mi id="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.2" xref="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.2.cmml">j</mi><mo id="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.1" xref="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.1.cmml">=</mo><mn id="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.3" xref="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS2.p1.5.5.m5.2.3.2.1.3" xref="S2.SS2.p1.5.5.m5.2.3.2.1.3.cmml">m</mi></msubsup><mrow id="S2.SS2.p1.5.5.m5.2.3.2.2" xref="S2.SS2.p1.5.5.m5.2.3.2.2.cmml"><mfrac id="S2.SS2.p1.5.5.m5.2.3.2.2.2" xref="S2.SS2.p1.5.5.m5.2.3.2.2.2.cmml"><msub id="S2.SS2.p1.5.5.m5.2.3.2.2.2.2" xref="S2.SS2.p1.5.5.m5.2.3.2.2.2.2.cmml"><mi id="S2.SS2.p1.5.5.m5.2.3.2.2.2.2.2" xref="S2.SS2.p1.5.5.m5.2.3.2.2.2.2.2.cmml">n</mi><mi id="S2.SS2.p1.5.5.m5.2.3.2.2.2.2.3" xref="S2.SS2.p1.5.5.m5.2.3.2.2.2.2.3.cmml">j</mi></msub><mi id="S2.SS2.p1.5.5.m5.2.3.2.2.2.3" xref="S2.SS2.p1.5.5.m5.2.3.2.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.SS2.p1.5.5.m5.2.3.2.2.1" xref="S2.SS2.p1.5.5.m5.2.3.2.2.1.cmml">​</mo><msub id="S2.SS2.p1.5.5.m5.2.3.2.2.3" xref="S2.SS2.p1.5.5.m5.2.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.5.5.m5.2.3.2.2.3.2" xref="S2.SS2.p1.5.5.m5.2.3.2.2.3.2.cmml">ℒ</mi><mi id="S2.SS2.p1.5.5.m5.2.3.2.2.3.3" xref="S2.SS2.p1.5.5.m5.2.3.2.2.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.5.5.m5.2.3.2.2.1a" xref="S2.SS2.p1.5.5.m5.2.3.2.2.1.cmml">​</mo><mrow id="S2.SS2.p1.5.5.m5.2.3.2.2.4.2" xref="S2.SS2.p1.5.5.m5.2.3.2.2.cmml"><mo stretchy="false" id="S2.SS2.p1.5.5.m5.2.3.2.2.4.2.1" xref="S2.SS2.p1.5.5.m5.2.3.2.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p1.5.5.m5.1.1" xref="S2.SS2.p1.5.5.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p1.5.5.m5.2.3.2.2.4.2.2" xref="S2.SS2.p1.5.5.m5.2.3.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS2.p1.5.5.m5.2.3.1" xref="S2.SS2.p1.5.5.m5.2.3.1.cmml">=</mo><mrow id="S2.SS2.p1.5.5.m5.2.3.3" xref="S2.SS2.p1.5.5.m5.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.5.5.m5.2.3.3.2" xref="S2.SS2.p1.5.5.m5.2.3.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.5.5.m5.2.3.3.1" xref="S2.SS2.p1.5.5.m5.2.3.3.1.cmml">​</mo><mrow id="S2.SS2.p1.5.5.m5.2.3.3.3.2" xref="S2.SS2.p1.5.5.m5.2.3.3.cmml"><mo stretchy="false" id="S2.SS2.p1.5.5.m5.2.3.3.3.2.1" xref="S2.SS2.p1.5.5.m5.2.3.3.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p1.5.5.m5.2.2" xref="S2.SS2.p1.5.5.m5.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p1.5.5.m5.2.3.3.3.2.2" xref="S2.SS2.p1.5.5.m5.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.5.m5.2b"><apply id="S2.SS2.p1.5.5.m5.2.3.cmml" xref="S2.SS2.p1.5.5.m5.2.3"><eq id="S2.SS2.p1.5.5.m5.2.3.1.cmml" xref="S2.SS2.p1.5.5.m5.2.3.1"></eq><apply id="S2.SS2.p1.5.5.m5.2.3.2.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2"><apply id="S2.SS2.p1.5.5.m5.2.3.2.1.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.5.m5.2.3.2.1.1.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.1">superscript</csymbol><apply id="S2.SS2.p1.5.5.m5.2.3.2.1.2.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.5.m5.2.3.2.1.2.1.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.1">subscript</csymbol><sum id="S2.SS2.p1.5.5.m5.2.3.2.1.2.2.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.1.2.2"></sum><apply id="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.1.2.3"><eq id="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.1.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.1"></eq><ci id="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.2.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.2">𝑗</ci><cn type="integer" id="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.3.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.1.2.3.3">1</cn></apply></apply><ci id="S2.SS2.p1.5.5.m5.2.3.2.1.3.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.1.3">𝑚</ci></apply><apply id="S2.SS2.p1.5.5.m5.2.3.2.2.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2"><times id="S2.SS2.p1.5.5.m5.2.3.2.2.1.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2.1"></times><apply id="S2.SS2.p1.5.5.m5.2.3.2.2.2.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2.2"><divide id="S2.SS2.p1.5.5.m5.2.3.2.2.2.1.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2.2"></divide><apply id="S2.SS2.p1.5.5.m5.2.3.2.2.2.2.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.5.5.m5.2.3.2.2.2.2.1.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.5.5.m5.2.3.2.2.2.2.2.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2.2.2.2">𝑛</ci><ci id="S2.SS2.p1.5.5.m5.2.3.2.2.2.2.3.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2.2.2.3">𝑗</ci></apply><ci id="S2.SS2.p1.5.5.m5.2.3.2.2.2.3.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2.2.3">𝑛</ci></apply><apply id="S2.SS2.p1.5.5.m5.2.3.2.2.3.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.5.5.m5.2.3.2.2.3.1.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2.3">subscript</csymbol><ci id="S2.SS2.p1.5.5.m5.2.3.2.2.3.2.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2.3.2">ℒ</ci><ci id="S2.SS2.p1.5.5.m5.2.3.2.2.3.3.cmml" xref="S2.SS2.p1.5.5.m5.2.3.2.2.3.3">𝑗</ci></apply><ci id="S2.SS2.p1.5.5.m5.1.1.cmml" xref="S2.SS2.p1.5.5.m5.1.1">⋅</ci></apply></apply><apply id="S2.SS2.p1.5.5.m5.2.3.3.cmml" xref="S2.SS2.p1.5.5.m5.2.3.3"><times id="S2.SS2.p1.5.5.m5.2.3.3.1.cmml" xref="S2.SS2.p1.5.5.m5.2.3.3.1"></times><ci id="S2.SS2.p1.5.5.m5.2.3.3.2.cmml" xref="S2.SS2.p1.5.5.m5.2.3.3.2">ℒ</ci><ci id="S2.SS2.p1.5.5.m5.2.2.cmml" xref="S2.SS2.p1.5.5.m5.2.2">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.5.m5.2c">\sum_{j=1}^{m}\frac{n_{j}}{n}\mathcal{L}_{j}(\cdot)=\mathcal{L}(\cdot)</annotation></semantics></math>. We can interpret different terms in Eq.(<a href="#S2.E2" title="In 2.2 Global Loss Objective Decomposition ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) as follows: (i) <math id="S2.SS2.p1.6.6.m6.1" class="ltx_Math" alttext="\mathcal{L}_{i}\left(\boldsymbol{w}_{i}\right)" display="inline"><semantics id="S2.SS2.p1.6.6.m6.1a"><mrow id="S2.SS2.p1.6.6.m6.1.1" xref="S2.SS2.p1.6.6.m6.1.1.cmml"><msub id="S2.SS2.p1.6.6.m6.1.1.3" xref="S2.SS2.p1.6.6.m6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.6.6.m6.1.1.3.2" xref="S2.SS2.p1.6.6.m6.1.1.3.2.cmml">ℒ</mi><mi id="S2.SS2.p1.6.6.m6.1.1.3.3" xref="S2.SS2.p1.6.6.m6.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.6.6.m6.1.1.2" xref="S2.SS2.p1.6.6.m6.1.1.2.cmml">​</mo><mrow id="S2.SS2.p1.6.6.m6.1.1.1.1" xref="S2.SS2.p1.6.6.m6.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.6.6.m6.1.1.1.1.2" xref="S2.SS2.p1.6.6.m6.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p1.6.6.m6.1.1.1.1.1" xref="S2.SS2.p1.6.6.m6.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.6.6.m6.1.1.1.1.1.2" xref="S2.SS2.p1.6.6.m6.1.1.1.1.1.2.cmml">𝒘</mi><mi id="S2.SS2.p1.6.6.m6.1.1.1.1.1.3" xref="S2.SS2.p1.6.6.m6.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS2.p1.6.6.m6.1.1.1.1.3" xref="S2.SS2.p1.6.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.6.m6.1b"><apply id="S2.SS2.p1.6.6.m6.1.1.cmml" xref="S2.SS2.p1.6.6.m6.1.1"><times id="S2.SS2.p1.6.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.6.m6.1.1.2"></times><apply id="S2.SS2.p1.6.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.6.6.m6.1.1.3.1.cmml" xref="S2.SS2.p1.6.6.m6.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.6.6.m6.1.1.3.2.cmml" xref="S2.SS2.p1.6.6.m6.1.1.3.2">ℒ</ci><ci id="S2.SS2.p1.6.6.m6.1.1.3.3.cmml" xref="S2.SS2.p1.6.6.m6.1.1.3.3">𝑖</ci></apply><apply id="S2.SS2.p1.6.6.m6.1.1.1.1.1.cmml" xref="S2.SS2.p1.6.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.6.6.m6.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.6.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.6.6.m6.1.1.1.1.1.2">𝒘</ci><ci id="S2.SS2.p1.6.6.m6.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.6.6.m6.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.6.m6.1c">\mathcal{L}_{i}\left(\boldsymbol{w}_{i}\right)</annotation></semantics></math> in the first term denotes the empirical loss of client <math id="S2.SS2.p1.7.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p1.7.7.m7.1a"><mi id="S2.SS2.p1.7.7.m7.1.1" xref="S2.SS2.p1.7.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.7.m7.1b"><ci id="S2.SS2.p1.7.7.m7.1.1.cmml" xref="S2.SS2.p1.7.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.7.m7.1c">i</annotation></semantics></math>’s local model <math id="S2.SS2.p1.8.8.m8.1" class="ltx_Math" alttext="\boldsymbol{w}_{i}" display="inline"><semantics id="S2.SS2.p1.8.8.m8.1a"><msub id="S2.SS2.p1.8.8.m8.1.1" xref="S2.SS2.p1.8.8.m8.1.1.cmml"><mi id="S2.SS2.p1.8.8.m8.1.1.2" xref="S2.SS2.p1.8.8.m8.1.1.2.cmml">𝒘</mi><mi id="S2.SS2.p1.8.8.m8.1.1.3" xref="S2.SS2.p1.8.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.8.m8.1b"><apply id="S2.SS2.p1.8.8.m8.1.1.cmml" xref="S2.SS2.p1.8.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.8.8.m8.1.1.1.cmml" xref="S2.SS2.p1.8.8.m8.1.1">subscript</csymbol><ci id="S2.SS2.p1.8.8.m8.1.1.2.cmml" xref="S2.SS2.p1.8.8.m8.1.1.2">𝒘</ci><ci id="S2.SS2.p1.8.8.m8.1.1.3.cmml" xref="S2.SS2.p1.8.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.8.m8.1c">\boldsymbol{w}_{i}</annotation></semantics></math> trained on its local dataset. We thus refer to the first term as the local loss. (ii) <math id="S2.SS2.p1.9.9.m9.2" class="ltx_Math" alttext="\mathcal{L}_{j}\left(\boldsymbol{w}_{i}\right)-\mathcal{L}_{i}\left(\boldsymbol{w}_{i}\right)" display="inline"><semantics id="S2.SS2.p1.9.9.m9.2a"><mrow id="S2.SS2.p1.9.9.m9.2.2" xref="S2.SS2.p1.9.9.m9.2.2.cmml"><mrow id="S2.SS2.p1.9.9.m9.1.1.1" xref="S2.SS2.p1.9.9.m9.1.1.1.cmml"><msub id="S2.SS2.p1.9.9.m9.1.1.1.3" xref="S2.SS2.p1.9.9.m9.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.9.9.m9.1.1.1.3.2" xref="S2.SS2.p1.9.9.m9.1.1.1.3.2.cmml">ℒ</mi><mi id="S2.SS2.p1.9.9.m9.1.1.1.3.3" xref="S2.SS2.p1.9.9.m9.1.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.9.9.m9.1.1.1.2" xref="S2.SS2.p1.9.9.m9.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p1.9.9.m9.1.1.1.1.1" xref="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.9.9.m9.1.1.1.1.1.2" xref="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p1.9.9.m9.1.1.1.1.1.1" xref="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.2" xref="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.2.cmml">𝒘</mi><mi id="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.3" xref="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS2.p1.9.9.m9.1.1.1.1.1.3" xref="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.9.9.m9.2.2.3" xref="S2.SS2.p1.9.9.m9.2.2.3.cmml">−</mo><mrow id="S2.SS2.p1.9.9.m9.2.2.2" xref="S2.SS2.p1.9.9.m9.2.2.2.cmml"><msub id="S2.SS2.p1.9.9.m9.2.2.2.3" xref="S2.SS2.p1.9.9.m9.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.9.9.m9.2.2.2.3.2" xref="S2.SS2.p1.9.9.m9.2.2.2.3.2.cmml">ℒ</mi><mi id="S2.SS2.p1.9.9.m9.2.2.2.3.3" xref="S2.SS2.p1.9.9.m9.2.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.9.9.m9.2.2.2.2" xref="S2.SS2.p1.9.9.m9.2.2.2.2.cmml">​</mo><mrow id="S2.SS2.p1.9.9.m9.2.2.2.1.1" xref="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.cmml"><mo id="S2.SS2.p1.9.9.m9.2.2.2.1.1.2" xref="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.cmml">(</mo><msub id="S2.SS2.p1.9.9.m9.2.2.2.1.1.1" xref="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.2" xref="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.2.cmml">𝒘</mi><mi id="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.3" xref="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS2.p1.9.9.m9.2.2.2.1.1.3" xref="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.9.m9.2b"><apply id="S2.SS2.p1.9.9.m9.2.2.cmml" xref="S2.SS2.p1.9.9.m9.2.2"><minus id="S2.SS2.p1.9.9.m9.2.2.3.cmml" xref="S2.SS2.p1.9.9.m9.2.2.3"></minus><apply id="S2.SS2.p1.9.9.m9.1.1.1.cmml" xref="S2.SS2.p1.9.9.m9.1.1.1"><times id="S2.SS2.p1.9.9.m9.1.1.1.2.cmml" xref="S2.SS2.p1.9.9.m9.1.1.1.2"></times><apply id="S2.SS2.p1.9.9.m9.1.1.1.3.cmml" xref="S2.SS2.p1.9.9.m9.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.9.9.m9.1.1.1.3.1.cmml" xref="S2.SS2.p1.9.9.m9.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.9.9.m9.1.1.1.3.2.cmml" xref="S2.SS2.p1.9.9.m9.1.1.1.3.2">ℒ</ci><ci id="S2.SS2.p1.9.9.m9.1.1.1.3.3.cmml" xref="S2.SS2.p1.9.9.m9.1.1.1.3.3">𝑗</ci></apply><apply id="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.9.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.9.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.2">𝒘</ci><ci id="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.9.9.m9.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.SS2.p1.9.9.m9.2.2.2.cmml" xref="S2.SS2.p1.9.9.m9.2.2.2"><times id="S2.SS2.p1.9.9.m9.2.2.2.2.cmml" xref="S2.SS2.p1.9.9.m9.2.2.2.2"></times><apply id="S2.SS2.p1.9.9.m9.2.2.2.3.cmml" xref="S2.SS2.p1.9.9.m9.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.9.9.m9.2.2.2.3.1.cmml" xref="S2.SS2.p1.9.9.m9.2.2.2.3">subscript</csymbol><ci id="S2.SS2.p1.9.9.m9.2.2.2.3.2.cmml" xref="S2.SS2.p1.9.9.m9.2.2.2.3.2">ℒ</ci><ci id="S2.SS2.p1.9.9.m9.2.2.2.3.3.cmml" xref="S2.SS2.p1.9.9.m9.2.2.2.3.3">𝑖</ci></apply><apply id="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.cmml" xref="S2.SS2.p1.9.9.m9.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.9.9.m9.2.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.2">𝒘</ci><ci id="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.9.9.m9.2.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.9.m9.2c">\mathcal{L}_{j}\left(\boldsymbol{w}_{i}\right)-\mathcal{L}_{i}\left(\boldsymbol{w}_{i}\right)</annotation></semantics></math> in the second term denotes the increase in the empirical loss of client <math id="S2.SS2.p1.10.10.m10.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p1.10.10.m10.1a"><mi id="S2.SS2.p1.10.10.m10.1.1" xref="S2.SS2.p1.10.10.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.10.m10.1b"><ci id="S2.SS2.p1.10.10.m10.1.1.cmml" xref="S2.SS2.p1.10.10.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.10.m10.1c">i</annotation></semantics></math>’s local model <math id="S2.SS2.p1.11.11.m11.1" class="ltx_Math" alttext="\boldsymbol{w}_{i}" display="inline"><semantics id="S2.SS2.p1.11.11.m11.1a"><msub id="S2.SS2.p1.11.11.m11.1.1" xref="S2.SS2.p1.11.11.m11.1.1.cmml"><mi id="S2.SS2.p1.11.11.m11.1.1.2" xref="S2.SS2.p1.11.11.m11.1.1.2.cmml">𝒘</mi><mi id="S2.SS2.p1.11.11.m11.1.1.3" xref="S2.SS2.p1.11.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.11.m11.1b"><apply id="S2.SS2.p1.11.11.m11.1.1.cmml" xref="S2.SS2.p1.11.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.11.11.m11.1.1.1.cmml" xref="S2.SS2.p1.11.11.m11.1.1">subscript</csymbol><ci id="S2.SS2.p1.11.11.m11.1.1.2.cmml" xref="S2.SS2.p1.11.11.m11.1.1.2">𝒘</ci><ci id="S2.SS2.p1.11.11.m11.1.1.3.cmml" xref="S2.SS2.p1.11.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.11.m11.1c">\boldsymbol{w}_{i}</annotation></semantics></math> when evaluated on client <math id="S2.SS2.p1.12.12.m12.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS2.p1.12.12.m12.1a"><mi id="S2.SS2.p1.12.12.m12.1.1" xref="S2.SS2.p1.12.12.m12.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.12.m12.1b"><ci id="S2.SS2.p1.12.12.m12.1.1.cmml" xref="S2.SS2.p1.12.12.m12.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.12.m12.1c">j</annotation></semantics></math>’s local dataset compared to client <math id="S2.SS2.p1.13.13.m13.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p1.13.13.m13.1a"><mi id="S2.SS2.p1.13.13.m13.1.1" xref="S2.SS2.p1.13.13.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.13.m13.1b"><ci id="S2.SS2.p1.13.13.m13.1.1.cmml" xref="S2.SS2.p1.13.13.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.13.m13.1c">i</annotation></semantics></math>’s local dataset. This increase arises from the data distribution shift between client <math id="S2.SS2.p1.14.14.m14.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p1.14.14.m14.1a"><mi id="S2.SS2.p1.14.14.m14.1.1" xref="S2.SS2.p1.14.14.m14.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.14.m14.1b"><ci id="S2.SS2.p1.14.14.m14.1.1.cmml" xref="S2.SS2.p1.14.14.m14.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.14.14.m14.1c">i</annotation></semantics></math> and client <math id="S2.SS2.p1.15.15.m15.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS2.p1.15.15.m15.1a"><mi id="S2.SS2.p1.15.15.m15.1.1" xref="S2.SS2.p1.15.15.m15.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.15.15.m15.1b"><ci id="S2.SS2.p1.15.15.m15.1.1.cmml" xref="S2.SS2.p1.15.15.m15.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.15.15.m15.1c">j</annotation></semantics></math>. We thus call the absolute value of the second term the distribution shift loss. (iii) <math id="S2.SS2.p1.16.16.m16.2" class="ltx_Math" alttext="\mathcal{L}(\boldsymbol{w})-\mathcal{L}\left(\boldsymbol{w}_{i}\right)" display="inline"><semantics id="S2.SS2.p1.16.16.m16.2a"><mrow id="S2.SS2.p1.16.16.m16.2.2" xref="S2.SS2.p1.16.16.m16.2.2.cmml"><mrow id="S2.SS2.p1.16.16.m16.2.2.3" xref="S2.SS2.p1.16.16.m16.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.16.16.m16.2.2.3.2" xref="S2.SS2.p1.16.16.m16.2.2.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.16.16.m16.2.2.3.1" xref="S2.SS2.p1.16.16.m16.2.2.3.1.cmml">​</mo><mrow id="S2.SS2.p1.16.16.m16.2.2.3.3.2" xref="S2.SS2.p1.16.16.m16.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.16.16.m16.2.2.3.3.2.1" xref="S2.SS2.p1.16.16.m16.2.2.3.cmml">(</mo><mi id="S2.SS2.p1.16.16.m16.1.1" xref="S2.SS2.p1.16.16.m16.1.1.cmml">𝒘</mi><mo stretchy="false" id="S2.SS2.p1.16.16.m16.2.2.3.3.2.2" xref="S2.SS2.p1.16.16.m16.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p1.16.16.m16.2.2.2" xref="S2.SS2.p1.16.16.m16.2.2.2.cmml">−</mo><mrow id="S2.SS2.p1.16.16.m16.2.2.1" xref="S2.SS2.p1.16.16.m16.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.16.16.m16.2.2.1.3" xref="S2.SS2.p1.16.16.m16.2.2.1.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.16.16.m16.2.2.1.2" xref="S2.SS2.p1.16.16.m16.2.2.1.2.cmml">​</mo><mrow id="S2.SS2.p1.16.16.m16.2.2.1.1.1" xref="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.cmml"><mo id="S2.SS2.p1.16.16.m16.2.2.1.1.1.2" xref="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p1.16.16.m16.2.2.1.1.1.1" xref="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.cmml"><mi id="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.2" xref="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.2.cmml">𝒘</mi><mi id="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.3" xref="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS2.p1.16.16.m16.2.2.1.1.1.3" xref="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.16.16.m16.2b"><apply id="S2.SS2.p1.16.16.m16.2.2.cmml" xref="S2.SS2.p1.16.16.m16.2.2"><minus id="S2.SS2.p1.16.16.m16.2.2.2.cmml" xref="S2.SS2.p1.16.16.m16.2.2.2"></minus><apply id="S2.SS2.p1.16.16.m16.2.2.3.cmml" xref="S2.SS2.p1.16.16.m16.2.2.3"><times id="S2.SS2.p1.16.16.m16.2.2.3.1.cmml" xref="S2.SS2.p1.16.16.m16.2.2.3.1"></times><ci id="S2.SS2.p1.16.16.m16.2.2.3.2.cmml" xref="S2.SS2.p1.16.16.m16.2.2.3.2">ℒ</ci><ci id="S2.SS2.p1.16.16.m16.1.1.cmml" xref="S2.SS2.p1.16.16.m16.1.1">𝒘</ci></apply><apply id="S2.SS2.p1.16.16.m16.2.2.1.cmml" xref="S2.SS2.p1.16.16.m16.2.2.1"><times id="S2.SS2.p1.16.16.m16.2.2.1.2.cmml" xref="S2.SS2.p1.16.16.m16.2.2.1.2"></times><ci id="S2.SS2.p1.16.16.m16.2.2.1.3.cmml" xref="S2.SS2.p1.16.16.m16.2.2.1.3">ℒ</ci><apply id="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.16.16.m16.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.1.cmml" xref="S2.SS2.p1.16.16.m16.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.2.cmml" xref="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.2">𝒘</ci><ci id="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.3.cmml" xref="S2.SS2.p1.16.16.m16.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.16.16.m16.2c">\mathcal{L}(\boldsymbol{w})-\mathcal{L}\left(\boldsymbol{w}_{i}\right)</annotation></semantics></math> in the third term denotes the increase in the empirical loss on all samples of local datasets for the global model (<math id="S2.SS2.p1.17.17.m17.1" class="ltx_Math" alttext="\boldsymbol{w}" display="inline"><semantics id="S2.SS2.p1.17.17.m17.1a"><mi id="S2.SS2.p1.17.17.m17.1.1" xref="S2.SS2.p1.17.17.m17.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.17.17.m17.1b"><ci id="S2.SS2.p1.17.17.m17.1.1.cmml" xref="S2.SS2.p1.17.17.m17.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.17.17.m17.1c">\boldsymbol{w}</annotation></semantics></math>, obtained after aggregating local models), compared with local model <math id="S2.SS2.p1.18.18.m18.1" class="ltx_Math" alttext="\boldsymbol{w}_{i}" display="inline"><semantics id="S2.SS2.p1.18.18.m18.1a"><msub id="S2.SS2.p1.18.18.m18.1.1" xref="S2.SS2.p1.18.18.m18.1.1.cmml"><mi id="S2.SS2.p1.18.18.m18.1.1.2" xref="S2.SS2.p1.18.18.m18.1.1.2.cmml">𝒘</mi><mi id="S2.SS2.p1.18.18.m18.1.1.3" xref="S2.SS2.p1.18.18.m18.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.18.18.m18.1b"><apply id="S2.SS2.p1.18.18.m18.1.1.cmml" xref="S2.SS2.p1.18.18.m18.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.18.18.m18.1.1.1.cmml" xref="S2.SS2.p1.18.18.m18.1.1">subscript</csymbol><ci id="S2.SS2.p1.18.18.m18.1.1.2.cmml" xref="S2.SS2.p1.18.18.m18.1.1.2">𝒘</ci><ci id="S2.SS2.p1.18.18.m18.1.1.3.cmml" xref="S2.SS2.p1.18.18.m18.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.18.18.m18.1c">\boldsymbol{w}_{i}</annotation></semantics></math>. As this increase comes from the server aggregation operation, we refer to the absolute value of this term as the aggregation loss.</span></p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2408.12300/assets/comparison_plot.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="329" height="177" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Distribution shift loss of different local training methods (red lines) and aggregation loss of different server aggregation methods (blue lines) under different levels of heterogeneity in one FL round.
</figcaption>
</figure>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p"><span id="S2.SS2.p2.1.1" class="ltx_text" style="font-size:90%;">The derived loss decomposition reveals that, in each round, FedAvg only minimizes the local loss (first term in Eq.(<a href="#S2.E2" title="In 2.2 Global Loss Objective Decomposition ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>)) through local training, while ignoring the distribution shift loss and aggregation loss. As shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2.2 Global Loss Objective Decomposition ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (dashed lines), both the distribution shift loss and aggregation loss increase with data heterogeneity. This results in poorer performance and slower convergence of the FedAvg algorithm when facing increased data heterogeneity challenges. This observation motivates us to explore methods that jointly minimize the decomposed three terms in Eq.(<a href="#S2.E2" title="In 2.2 Global Loss Objective Decomposition ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). To reduce the distribution shift loss, we need to improve the performance of each local model <math id="S2.SS2.p2.1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{w}_{i}" display="inline"><semantics id="S2.SS2.p2.1.1.m1.1a"><msub id="S2.SS2.p2.1.1.m1.1.1" xref="S2.SS2.p2.1.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.1.m1.1.1.2" xref="S2.SS2.p2.1.1.m1.1.1.2.cmml">𝒘</mi><mi id="S2.SS2.p2.1.1.m1.1.1.3" xref="S2.SS2.p2.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.1.m1.1b"><apply id="S2.SS2.p2.1.1.m1.1.1.cmml" xref="S2.SS2.p2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.1.m1.1.1.2">𝒘</ci><ci id="S2.SS2.p2.1.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.1.m1.1c">\boldsymbol{w}_{i}</annotation></semantics></math> on the data distributions of other clients during its local training step. To reduce the aggregation loss, we need to develop a more effective way to aggregate local models during server aggregation step. The overview of our method is shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, and we will elaborate these two compenents in the following. Furthermore, the detailed description of our algorithm can be found in supplementary material.</span></p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Margin Control in Clients’ Local Training</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.2" class="ltx_p"><span id="S2.SS3.p1.2.1" class="ltx_text" style="font-size:90%;">Shortcut learning refers to a machine learning model’s reliance on unstable correlations i.e. shortcut features </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS3.p1.2.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib4" title="" class="ltx_ref">4</a><span id="S2.SS3.p1.2.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.SS3.p1.2.4" class="ltx_text" style="font-size:90%;">. It can lead to poor performance when the relationship between the label and the shortcut feature changes </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS3.p1.2.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib12" title="" class="ltx_ref">12</a><span id="S2.SS3.p1.2.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.SS3.p1.2.7" class="ltx_text" style="font-size:90%;">.
This shortcut learning could be a key factor causing a local model </span><math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{w}_{i}" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><msub id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">𝒘</mi><mi mathsize="90%" id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝒘</ci><ci id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">\boldsymbol{w}_{i}</annotation></semantics></math><span id="S2.SS3.p1.2.8" class="ltx_text" style="font-size:90%;"> trained on its local dataset to perform worse on other datasets with different distributions. In other words, shortcut learning increases the distribution shift loss in Eq.(</span><a href="#S2.E2" title="In 2.2 Global Loss Objective Decomposition ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S2.SS3.p1.2.9" class="ltx_text" style="font-size:90%;">). This motivates us to find a method for mitigating shortcut learning in local training to reduce the distribution shift loss. </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS3.p1.2.10.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib21" title="" class="ltx_ref">21</a><span id="S2.SS3.p1.2.11.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.SS3.p1.2.12" class="ltx_text" style="font-size:90%;"> shows that training with cross entropy loss can lead to the preference for maximizing the margin i.e. range of the logits values, which in turn causes the model to rely more on shortcut features rather than stable features. Motivated by this, we penalize the margin in local training, aiming to reduce the reliance on shortcut features and encourage the model to learn more stable features, thereby reducing the distribution shift loss. Specifically, we use an approach which introduces a margin control regularization term by calculating the </span><math id="S2.SS3.p1.2.m2.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="S2.SS3.p1.2.m2.1a"><msub id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml">l</mi><mn mathsize="90%" id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2">𝑙</ci><cn type="integer" id="S2.SS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">l_{2}</annotation></semantics></math><span id="S2.SS3.p1.2.13" class="ltx_text" style="font-size:90%;">-norm of the output logits and adding it to the cross entropy loss as follows:</span></p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.5" class="ltx_Math" alttext="\mathcal{L}_{\text{marg-log }}=\mathcal{L}_{CE}\left(y,f_{\boldsymbol{w}}(x)\right)+\lambda\log\left(1+\left\|f_{\boldsymbol{w}}\left(x\right)\right\|_{2}^{2}\right)," display="block"><semantics id="S2.E3.m1.5a"><mrow id="S2.E3.m1.5.5.1" xref="S2.E3.m1.5.5.1.1.cmml"><mrow id="S2.E3.m1.5.5.1.1" xref="S2.E3.m1.5.5.1.1.cmml"><msub id="S2.E3.m1.5.5.1.1.4" xref="S2.E3.m1.5.5.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E3.m1.5.5.1.1.4.2" xref="S2.E3.m1.5.5.1.1.4.2.cmml">ℒ</mi><mtext mathsize="90%" id="S2.E3.m1.5.5.1.1.4.3" xref="S2.E3.m1.5.5.1.1.4.3a.cmml">marg-log </mtext></msub><mo mathsize="90%" id="S2.E3.m1.5.5.1.1.3" xref="S2.E3.m1.5.5.1.1.3.cmml">=</mo><mrow id="S2.E3.m1.5.5.1.1.2" xref="S2.E3.m1.5.5.1.1.2.cmml"><mrow id="S2.E3.m1.5.5.1.1.1.1" xref="S2.E3.m1.5.5.1.1.1.1.cmml"><msub id="S2.E3.m1.5.5.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E3.m1.5.5.1.1.1.1.3.2" xref="S2.E3.m1.5.5.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S2.E3.m1.5.5.1.1.1.1.3.3" xref="S2.E3.m1.5.5.1.1.1.1.3.3.cmml"><mi mathsize="90%" id="S2.E3.m1.5.5.1.1.1.1.3.3.2" xref="S2.E3.m1.5.5.1.1.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.1.1.3.3.1" xref="S2.E3.m1.5.5.1.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E3.m1.5.5.1.1.1.1.3.3.3" xref="S2.E3.m1.5.5.1.1.1.1.3.3.3.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S2.E3.m1.5.5.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.1.1.1.2.cmml">(</mo><mi mathsize="90%" id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">y</mi><mo mathsize="90%" id="S2.E3.m1.5.5.1.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.1.1.1.2.cmml">,</mo><mrow id="S2.E3.m1.5.5.1.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.5.5.1.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi mathsize="90%" id="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">𝒘</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.E3.m1.5.5.1.1.1.1.1.1.1.3.2.1" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mi mathsize="90%" id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">x</mi><mo maxsize="90%" minsize="90%" id="S2.E3.m1.5.5.1.1.1.1.1.1.1.3.2.2" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.5.5.1.1.1.1.1.1.4" xref="S2.E3.m1.5.5.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.E3.m1.5.5.1.1.2.3" xref="S2.E3.m1.5.5.1.1.2.3.cmml">+</mo><mrow id="S2.E3.m1.5.5.1.1.2.2" xref="S2.E3.m1.5.5.1.1.2.2.cmml"><mi mathsize="90%" id="S2.E3.m1.5.5.1.1.2.2.3" xref="S2.E3.m1.5.5.1.1.2.2.3.cmml">λ</mi><mo lspace="0.167em" rspace="0em" id="S2.E3.m1.5.5.1.1.2.2.2" xref="S2.E3.m1.5.5.1.1.2.2.2.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.2.2.1.1" xref="S2.E3.m1.5.5.1.1.2.2.1.2.cmml"><mi mathsize="90%" id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml">log</mi><mo id="S2.E3.m1.5.5.1.1.2.2.1.1a" xref="S2.E3.m1.5.5.1.1.2.2.1.2.cmml">⁡</mo><mrow id="S2.E3.m1.5.5.1.1.2.2.1.1.1" xref="S2.E3.m1.5.5.1.1.2.2.1.2.cmml"><mo id="S2.E3.m1.5.5.1.1.2.2.1.1.1.2" xref="S2.E3.m1.5.5.1.1.2.2.1.2.cmml">(</mo><mrow id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.cmml"><mn mathsize="90%" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.3.cmml">1</mn><mo mathsize="90%" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.2.cmml">+</mo><msubsup id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mi mathsize="90%" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">𝒘</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.3.2.1" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi mathsize="90%" id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">x</mi><mo id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn mathsize="90%" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.3.cmml">2</mn><mn mathsize="90%" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.3" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow><mo id="S2.E3.m1.5.5.1.1.2.2.1.1.1.3" xref="S2.E3.m1.5.5.1.1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S2.E3.m1.5.5.1.2" xref="S2.E3.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.5b"><apply id="S2.E3.m1.5.5.1.1.cmml" xref="S2.E3.m1.5.5.1"><eq id="S2.E3.m1.5.5.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.3"></eq><apply id="S2.E3.m1.5.5.1.1.4.cmml" xref="S2.E3.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.4.1.cmml" xref="S2.E3.m1.5.5.1.1.4">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.4.2.cmml" xref="S2.E3.m1.5.5.1.1.4.2">ℒ</ci><ci id="S2.E3.m1.5.5.1.1.4.3a.cmml" xref="S2.E3.m1.5.5.1.1.4.3"><mtext mathsize="63%" id="S2.E3.m1.5.5.1.1.4.3.cmml" xref="S2.E3.m1.5.5.1.1.4.3">marg-log </mtext></ci></apply><apply id="S2.E3.m1.5.5.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2"><plus id="S2.E3.m1.5.5.1.1.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.3"></plus><apply id="S2.E3.m1.5.5.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1"><times id="S2.E3.m1.5.5.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.2"></times><apply id="S2.E3.m1.5.5.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.3.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.1.1.3.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.2">ℒ</ci><apply id="S2.E3.m1.5.5.1.1.1.1.3.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.3"><times id="S2.E3.m1.5.5.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.3.1"></times><ci id="S2.E3.m1.5.5.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.3.2">𝐶</ci><ci id="S2.E3.m1.5.5.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.3.3.3">𝐸</ci></apply></apply><interval closure="open" id="S2.E3.m1.5.5.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1"><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝑦</ci><apply id="S2.E3.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1"><times id="S2.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.1"></times><apply id="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.5.5.1.1.1.1.1.1.1.2.3">𝒘</ci></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝑥</ci></apply></interval></apply><apply id="S2.E3.m1.5.5.1.1.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2"><times id="S2.E3.m1.5.5.1.1.2.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.2"></times><ci id="S2.E3.m1.5.5.1.1.2.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.3">𝜆</ci><apply id="S2.E3.m1.5.5.1.1.2.2.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1"><log id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4"></log><apply id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1"><plus id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.2"></plus><cn type="integer" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.3">1</cn><apply id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1">superscript</csymbol><apply id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1">subscript</csymbol><apply id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1"><times id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝒘</ci></apply><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">𝑥</ci></apply></apply><cn type="integer" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.1.3">2</cn></apply><cn type="integer" id="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.1.1.2.2.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.5c">\mathcal{L}_{\text{marg-log }}=\mathcal{L}_{CE}\left(y,f_{\boldsymbol{w}}(x)\right)+\lambda\log\left(1+\left\|f_{\boldsymbol{w}}\left(x\right)\right\|_{2}^{2}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p1.9" class="ltx_p"><span id="S2.SS3.p1.9.1" class="ltx_text" style="font-size:90%;">where
</span><math id="S2.SS3.p1.3.m1.8" class="ltx_Math" alttext="\mathcal{L}_{CE}\left(y,f_{\boldsymbol{w}}(x)\right)=-\sum_{i=1}^{C}y_{i}\log\left(\operatorname{softmax}\left(f_{\boldsymbol{w},i}(x)\right)\right)," display="inline"><semantics id="S2.SS3.p1.3.m1.8a"><mrow id="S2.SS3.p1.3.m1.8.8.1" xref="S2.SS3.p1.3.m1.8.8.1.1.cmml"><mrow id="S2.SS3.p1.3.m1.8.8.1.1" xref="S2.SS3.p1.3.m1.8.8.1.1.cmml"><mrow id="S2.SS3.p1.3.m1.8.8.1.1.1" xref="S2.SS3.p1.3.m1.8.8.1.1.1.cmml"><msub id="S2.SS3.p1.3.m1.8.8.1.1.1.3" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.1.3.2" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3.2.cmml">ℒ</mi><mrow id="S2.SS3.p1.3.m1.8.8.1.1.1.3.3" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.2" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.1" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.3" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.3.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.3.m1.8.8.1.1.1.2" xref="S2.SS3.p1.3.m1.8.8.1.1.1.2.cmml">​</mo><mrow id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.2.cmml"><mo id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.2" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.2.cmml">(</mo><mi mathsize="90%" id="S2.SS3.p1.3.m1.4.4" xref="S2.SS3.p1.3.m1.4.4.cmml">y</mi><mo mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.3" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.2.cmml">,</mo><mrow id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.cmml"><msub id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2.2" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2.2.cmml">f</mi><mi mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2.3" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2.3.cmml">𝒘</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.1" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.3.2" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.3.2.1" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mi mathsize="90%" id="S2.SS3.p1.3.m1.3.3" xref="S2.SS3.p1.3.m1.3.3.cmml">x</mi><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.3.2.2" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.4" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.3" xref="S2.SS3.p1.3.m1.8.8.1.1.3.cmml">=</mo><mrow id="S2.SS3.p1.3.m1.8.8.1.1.2" xref="S2.SS3.p1.3.m1.8.8.1.1.2.cmml"><mo mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.2a" xref="S2.SS3.p1.3.m1.8.8.1.1.2.cmml">−</mo><mrow id="S2.SS3.p1.3.m1.8.8.1.1.2.1" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.cmml"><msubsup id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.2" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.2.cmml">∑</mo><mrow id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.cmml"><mi mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.2" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.2.cmml">i</mi><mo mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.1" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.3" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.3" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.3.cmml">C</mi></msubsup><mrow id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.cmml"><msub id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3.cmml"><mi mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3.2" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3.2.cmml">y</mi><mi mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3.3" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.2" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.2.cmml">​</mo><mrow id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.2.cmml"><mi mathsize="90%" id="S2.SS3.p1.3.m1.7.7" xref="S2.SS3.p1.3.m1.7.7.cmml">log</mi><mo id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1a" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.2.cmml">⁡</mo><mrow id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.2.cmml"><mo id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.2" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.2.cmml">(</mo><mrow id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.SS3.p1.3.m1.6.6" xref="S2.SS3.p1.3.m1.6.6.cmml">softmax</mi><mo id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1a" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.2.cmml"><mo id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.2" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.2" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.2.2" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.2.2.cmml">f</mi><mrow id="S2.SS3.p1.3.m1.2.2.2.4" xref="S2.SS3.p1.3.m1.2.2.2.3.cmml"><mi mathsize="90%" id="S2.SS3.p1.3.m1.1.1.1.1" xref="S2.SS3.p1.3.m1.1.1.1.1.cmml">𝒘</mi><mo mathsize="90%" id="S2.SS3.p1.3.m1.2.2.2.4.1" xref="S2.SS3.p1.3.m1.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S2.SS3.p1.3.m1.2.2.2.2" xref="S2.SS3.p1.3.m1.2.2.2.2.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.3.2" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.3.2.1" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi mathsize="90%" id="S2.SS3.p1.3.m1.5.5" xref="S2.SS3.p1.3.m1.5.5.cmml">x</mi><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.3" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.3" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S2.SS3.p1.3.m1.8.8.1.2" xref="S2.SS3.p1.3.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m1.8b"><apply id="S2.SS3.p1.3.m1.8.8.1.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1"><eq id="S2.SS3.p1.3.m1.8.8.1.1.3.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.3"></eq><apply id="S2.SS3.p1.3.m1.8.8.1.1.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1"><times id="S2.SS3.p1.3.m1.8.8.1.1.1.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.2"></times><apply id="S2.SS3.p1.3.m1.8.8.1.1.1.3.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.8.8.1.1.1.3.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3">subscript</csymbol><ci id="S2.SS3.p1.3.m1.8.8.1.1.1.3.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3.2">ℒ</ci><apply id="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3.3"><times id="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.1"></times><ci id="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.2">𝐶</ci><ci id="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.3.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.3.3.3">𝐸</ci></apply></apply><interval closure="open" id="S2.SS3.p1.3.m1.8.8.1.1.1.1.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1"><ci id="S2.SS3.p1.3.m1.4.4.cmml" xref="S2.SS3.p1.3.m1.4.4">𝑦</ci><apply id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1"><times id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.1"></times><apply id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2.2">𝑓</ci><ci id="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2.3.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.1.1.1.1.2.3">𝒘</ci></apply><ci id="S2.SS3.p1.3.m1.3.3.cmml" xref="S2.SS3.p1.3.m1.3.3">𝑥</ci></apply></interval></apply><apply id="S2.SS3.p1.3.m1.8.8.1.1.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2"><minus id="S2.SS3.p1.3.m1.8.8.1.1.2.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2"></minus><apply id="S2.SS3.p1.3.m1.8.8.1.1.2.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1"><apply id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2">superscript</csymbol><apply id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2">subscript</csymbol><sum id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.2"></sum><apply id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3"><eq id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.1"></eq><ci id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.3.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.2.3.3">1</cn></apply></apply><ci id="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.3.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.2.3">𝐶</ci></apply><apply id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1"><times id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.2"></times><apply id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3">subscript</csymbol><ci id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3.2">𝑦</ci><ci id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3.3.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.3.3">𝑖</ci></apply><apply id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1"><log id="S2.SS3.p1.3.m1.7.7.cmml" xref="S2.SS3.p1.3.m1.7.7"></log><apply id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1"><ci id="S2.SS3.p1.3.m1.6.6.cmml" xref="S2.SS3.p1.3.m1.6.6">softmax</ci><apply id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1"><times id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS3.p1.3.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.1.2.2">𝑓</ci><list id="S2.SS3.p1.3.m1.2.2.2.3.cmml" xref="S2.SS3.p1.3.m1.2.2.2.4"><ci id="S2.SS3.p1.3.m1.1.1.1.1.cmml" xref="S2.SS3.p1.3.m1.1.1.1.1">𝒘</ci><ci id="S2.SS3.p1.3.m1.2.2.2.2.cmml" xref="S2.SS3.p1.3.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S2.SS3.p1.3.m1.5.5.cmml" xref="S2.SS3.p1.3.m1.5.5">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m1.8c">\mathcal{L}_{CE}\left(y,f_{\boldsymbol{w}}(x)\right)=-\sum_{i=1}^{C}y_{i}\log\left(\operatorname{softmax}\left(f_{\boldsymbol{w},i}(x)\right)\right),</annotation></semantics></math><span id="S2.SS3.p1.9.2" class="ltx_text" style="font-size:90%;"> is the standard cross-entropy loss function, and </span><math id="S2.SS3.p1.4.m2.11" class="ltx_Math" alttext="y=[y_{1},\cdots,y_{C}]^{\top},f_{\boldsymbol{w}}(x)=[f_{\boldsymbol{w},1}(x),\cdots,f_{\boldsymbol{w},C}(x)]^{\top}" display="inline"><semantics id="S2.SS3.p1.4.m2.11a"><mrow id="S2.SS3.p1.4.m2.11.11.2" xref="S2.SS3.p1.4.m2.11.11.3.cmml"><mrow id="S2.SS3.p1.4.m2.10.10.1.1" xref="S2.SS3.p1.4.m2.10.10.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p1.4.m2.10.10.1.1.4" xref="S2.SS3.p1.4.m2.10.10.1.1.4.cmml">y</mi><mo mathsize="90%" id="S2.SS3.p1.4.m2.10.10.1.1.3" xref="S2.SS3.p1.4.m2.10.10.1.1.3.cmml">=</mo><msup id="S2.SS3.p1.4.m2.10.10.1.1.2" xref="S2.SS3.p1.4.m2.10.10.1.1.2.cmml"><mrow id="S2.SS3.p1.4.m2.10.10.1.1.2.2.2" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.3" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.3.cmml">[</mo><msub id="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1" xref="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1.2" xref="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1.2.cmml">y</mi><mn mathsize="90%" id="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1.3" xref="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.4" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.SS3.p1.4.m2.5.5" xref="S2.SS3.p1.4.m2.5.5.cmml">⋯</mi><mo mathsize="90%" id="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.5" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.3.cmml">,</mo><msub id="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2.cmml"><mi mathsize="90%" id="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2.2" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2.2.cmml">y</mi><mi mathsize="90%" id="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2.3" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2.3.cmml">C</mi></msub><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.6" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.3.cmml">]</mo></mrow><mo mathsize="90%" id="S2.SS3.p1.4.m2.10.10.1.1.2.4" xref="S2.SS3.p1.4.m2.10.10.1.1.2.4.cmml">⊤</mo></msup></mrow><mo mathsize="90%" id="S2.SS3.p1.4.m2.11.11.2.3" xref="S2.SS3.p1.4.m2.11.11.3a.cmml">,</mo><mrow id="S2.SS3.p1.4.m2.11.11.2.2" xref="S2.SS3.p1.4.m2.11.11.2.2.cmml"><mrow id="S2.SS3.p1.4.m2.11.11.2.2.4" xref="S2.SS3.p1.4.m2.11.11.2.2.4.cmml"><msub id="S2.SS3.p1.4.m2.11.11.2.2.4.2" xref="S2.SS3.p1.4.m2.11.11.2.2.4.2.cmml"><mi mathsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.4.2.2" xref="S2.SS3.p1.4.m2.11.11.2.2.4.2.2.cmml">f</mi><mi mathsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.4.2.3" xref="S2.SS3.p1.4.m2.11.11.2.2.4.2.3.cmml">𝒘</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.4.m2.11.11.2.2.4.1" xref="S2.SS3.p1.4.m2.11.11.2.2.4.1.cmml">​</mo><mrow id="S2.SS3.p1.4.m2.11.11.2.2.4.3.2" xref="S2.SS3.p1.4.m2.11.11.2.2.4.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.4.3.2.1" xref="S2.SS3.p1.4.m2.11.11.2.2.4.cmml">(</mo><mi mathsize="90%" id="S2.SS3.p1.4.m2.6.6" xref="S2.SS3.p1.4.m2.6.6.cmml">x</mi><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.4.3.2.2" xref="S2.SS3.p1.4.m2.11.11.2.2.4.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.3" xref="S2.SS3.p1.4.m2.11.11.2.2.3.cmml">=</mo><msup id="S2.SS3.p1.4.m2.11.11.2.2.2" xref="S2.SS3.p1.4.m2.11.11.2.2.2.cmml"><mrow id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.3" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.3.cmml">[</mo><mrow id="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1" xref="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.cmml"><msub id="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.2" xref="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.2.2" xref="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.2.2.cmml">f</mi><mrow id="S2.SS3.p1.4.m2.2.2.2.4" xref="S2.SS3.p1.4.m2.2.2.2.3.cmml"><mi mathsize="90%" id="S2.SS3.p1.4.m2.1.1.1.1" xref="S2.SS3.p1.4.m2.1.1.1.1.cmml">𝒘</mi><mo mathsize="90%" id="S2.SS3.p1.4.m2.2.2.2.4.1" xref="S2.SS3.p1.4.m2.2.2.2.3.cmml">,</mo><mn mathsize="90%" id="S2.SS3.p1.4.m2.2.2.2.2" xref="S2.SS3.p1.4.m2.2.2.2.2.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.1" xref="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.1.cmml">​</mo><mrow id="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.3.2" xref="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.3.2.1" xref="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.cmml">(</mo><mi mathsize="90%" id="S2.SS3.p1.4.m2.7.7" xref="S2.SS3.p1.4.m2.7.7.cmml">x</mi><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.3.2.2" xref="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.4" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.SS3.p1.4.m2.9.9" xref="S2.SS3.p1.4.m2.9.9.cmml">⋯</mi><mo mathsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.5" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.3.cmml">,</mo><mrow id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.cmml"><msub id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.2" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.2.2" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.2.2.cmml">f</mi><mrow id="S2.SS3.p1.4.m2.4.4.2.4" xref="S2.SS3.p1.4.m2.4.4.2.3.cmml"><mi mathsize="90%" id="S2.SS3.p1.4.m2.3.3.1.1" xref="S2.SS3.p1.4.m2.3.3.1.1.cmml">𝒘</mi><mo mathsize="90%" id="S2.SS3.p1.4.m2.4.4.2.4.1" xref="S2.SS3.p1.4.m2.4.4.2.3.cmml">,</mo><mi mathsize="90%" id="S2.SS3.p1.4.m2.4.4.2.2" xref="S2.SS3.p1.4.m2.4.4.2.2.cmml">C</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.1" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.1.cmml">​</mo><mrow id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.3.2" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.3.2.1" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.cmml">(</mo><mi mathsize="90%" id="S2.SS3.p1.4.m2.8.8" xref="S2.SS3.p1.4.m2.8.8.cmml">x</mi><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.3.2.2" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.6" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.3.cmml">]</mo></mrow><mo mathsize="90%" id="S2.SS3.p1.4.m2.11.11.2.2.2.4" xref="S2.SS3.p1.4.m2.11.11.2.2.2.4.cmml">⊤</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m2.11b"><apply id="S2.SS3.p1.4.m2.11.11.3.cmml" xref="S2.SS3.p1.4.m2.11.11.2"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m2.11.11.3a.cmml" xref="S2.SS3.p1.4.m2.11.11.2.3">formulae-sequence</csymbol><apply id="S2.SS3.p1.4.m2.10.10.1.1.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1"><eq id="S2.SS3.p1.4.m2.10.10.1.1.3.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.3"></eq><ci id="S2.SS3.p1.4.m2.10.10.1.1.4.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.4">𝑦</ci><apply id="S2.SS3.p1.4.m2.10.10.1.1.2.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m2.10.10.1.1.2.3.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.2">superscript</csymbol><list id="S2.SS3.p1.4.m2.10.10.1.1.2.2.3.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.2"><apply id="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1.2">𝑦</ci><cn type="integer" id="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.SS3.p1.4.m2.5.5.cmml" xref="S2.SS3.p1.4.m2.5.5">⋯</ci><apply id="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2.1.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2">subscript</csymbol><ci id="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2.2.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2.2">𝑦</ci><ci id="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2.3.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.2.2.2.2.3">𝐶</ci></apply></list><csymbol cd="latexml" id="S2.SS3.p1.4.m2.10.10.1.1.2.4.cmml" xref="S2.SS3.p1.4.m2.10.10.1.1.2.4">top</csymbol></apply></apply><apply id="S2.SS3.p1.4.m2.11.11.2.2.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2"><eq id="S2.SS3.p1.4.m2.11.11.2.2.3.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.3"></eq><apply id="S2.SS3.p1.4.m2.11.11.2.2.4.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.4"><times id="S2.SS3.p1.4.m2.11.11.2.2.4.1.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.4.1"></times><apply id="S2.SS3.p1.4.m2.11.11.2.2.4.2.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.4.2"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m2.11.11.2.2.4.2.1.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.4.2">subscript</csymbol><ci id="S2.SS3.p1.4.m2.11.11.2.2.4.2.2.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.4.2.2">𝑓</ci><ci id="S2.SS3.p1.4.m2.11.11.2.2.4.2.3.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.4.2.3">𝒘</ci></apply><ci id="S2.SS3.p1.4.m2.6.6.cmml" xref="S2.SS3.p1.4.m2.6.6">𝑥</ci></apply><apply id="S2.SS3.p1.4.m2.11.11.2.2.2.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m2.11.11.2.2.2.3.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.2">superscript</csymbol><list id="S2.SS3.p1.4.m2.11.11.2.2.2.2.3.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2"><apply id="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1"><times id="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.1.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.1"></times><apply id="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.2.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.2.1.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.2">subscript</csymbol><ci id="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.2.2.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.1.1.1.1.2.2">𝑓</ci><list id="S2.SS3.p1.4.m2.2.2.2.3.cmml" xref="S2.SS3.p1.4.m2.2.2.2.4"><ci id="S2.SS3.p1.4.m2.1.1.1.1.cmml" xref="S2.SS3.p1.4.m2.1.1.1.1">𝒘</ci><cn type="integer" id="S2.SS3.p1.4.m2.2.2.2.2.cmml" xref="S2.SS3.p1.4.m2.2.2.2.2">1</cn></list></apply><ci id="S2.SS3.p1.4.m2.7.7.cmml" xref="S2.SS3.p1.4.m2.7.7">𝑥</ci></apply><ci id="S2.SS3.p1.4.m2.9.9.cmml" xref="S2.SS3.p1.4.m2.9.9">⋯</ci><apply id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2"><times id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.1.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.1"></times><apply id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.2.1.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.2.2.2.2.2.2">𝑓</ci><list id="S2.SS3.p1.4.m2.4.4.2.3.cmml" xref="S2.SS3.p1.4.m2.4.4.2.4"><ci id="S2.SS3.p1.4.m2.3.3.1.1.cmml" xref="S2.SS3.p1.4.m2.3.3.1.1">𝒘</ci><ci id="S2.SS3.p1.4.m2.4.4.2.2.cmml" xref="S2.SS3.p1.4.m2.4.4.2.2">𝐶</ci></list></apply><ci id="S2.SS3.p1.4.m2.8.8.cmml" xref="S2.SS3.p1.4.m2.8.8">𝑥</ci></apply></list><csymbol cd="latexml" id="S2.SS3.p1.4.m2.11.11.2.2.2.4.cmml" xref="S2.SS3.p1.4.m2.11.11.2.2.2.4">top</csymbol></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m2.11c">y=[y_{1},\cdots,y_{C}]^{\top},f_{\boldsymbol{w}}(x)=[f_{\boldsymbol{w},1}(x),\cdots,f_{\boldsymbol{w},C}(x)]^{\top}</annotation></semantics></math><span id="S2.SS3.p1.9.3" class="ltx_text" style="font-size:90%;">.
Here </span><math id="S2.SS3.p1.5.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S2.SS3.p1.5.m3.1a"><mi mathsize="90%" id="S2.SS3.p1.5.m3.1.1" xref="S2.SS3.p1.5.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m3.1b"><ci id="S2.SS3.p1.5.m3.1.1.cmml" xref="S2.SS3.p1.5.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m3.1c">C</annotation></semantics></math><span id="S2.SS3.p1.9.4" class="ltx_text" style="font-size:90%;"> is the number of classes for our classification task, </span><math id="S2.SS3.p1.6.m4.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.SS3.p1.6.m4.1a"><mi mathsize="90%" id="S2.SS3.p1.6.m4.1.1" xref="S2.SS3.p1.6.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m4.1b"><ci id="S2.SS3.p1.6.m4.1.1.cmml" xref="S2.SS3.p1.6.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.6.m4.1c">y</annotation></semantics></math><span id="S2.SS3.p1.9.5" class="ltx_text" style="font-size:90%;"> is the one-hot vector for the label, and </span><math id="S2.SS3.p1.7.m5.1" class="ltx_Math" alttext="f_{\boldsymbol{w}}(\cdot)" display="inline"><semantics id="S2.SS3.p1.7.m5.1a"><mrow id="S2.SS3.p1.7.m5.1.2" xref="S2.SS3.p1.7.m5.1.2.cmml"><msub id="S2.SS3.p1.7.m5.1.2.2" xref="S2.SS3.p1.7.m5.1.2.2.cmml"><mi mathsize="90%" id="S2.SS3.p1.7.m5.1.2.2.2" xref="S2.SS3.p1.7.m5.1.2.2.2.cmml">f</mi><mi mathsize="90%" id="S2.SS3.p1.7.m5.1.2.2.3" xref="S2.SS3.p1.7.m5.1.2.2.3.cmml">𝒘</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.7.m5.1.2.1" xref="S2.SS3.p1.7.m5.1.2.1.cmml">​</mo><mrow id="S2.SS3.p1.7.m5.1.2.3.2" xref="S2.SS3.p1.7.m5.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.7.m5.1.2.3.2.1" xref="S2.SS3.p1.7.m5.1.2.cmml">(</mo><mo lspace="0em" mathsize="90%" rspace="0em" id="S2.SS3.p1.7.m5.1.1" xref="S2.SS3.p1.7.m5.1.1.cmml">⋅</mo><mo maxsize="90%" minsize="90%" id="S2.SS3.p1.7.m5.1.2.3.2.2" xref="S2.SS3.p1.7.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.7.m5.1b"><apply id="S2.SS3.p1.7.m5.1.2.cmml" xref="S2.SS3.p1.7.m5.1.2"><times id="S2.SS3.p1.7.m5.1.2.1.cmml" xref="S2.SS3.p1.7.m5.1.2.1"></times><apply id="S2.SS3.p1.7.m5.1.2.2.cmml" xref="S2.SS3.p1.7.m5.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.7.m5.1.2.2.1.cmml" xref="S2.SS3.p1.7.m5.1.2.2">subscript</csymbol><ci id="S2.SS3.p1.7.m5.1.2.2.2.cmml" xref="S2.SS3.p1.7.m5.1.2.2.2">𝑓</ci><ci id="S2.SS3.p1.7.m5.1.2.2.3.cmml" xref="S2.SS3.p1.7.m5.1.2.2.3">𝒘</ci></apply><ci id="S2.SS3.p1.7.m5.1.1.cmml" xref="S2.SS3.p1.7.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.7.m5.1c">f_{\boldsymbol{w}}(\cdot)</annotation></semantics></math><span id="S2.SS3.p1.9.6" class="ltx_text" style="font-size:90%;"> is the output logits of the model </span><math id="S2.SS3.p1.8.m6.1" class="ltx_Math" alttext="\boldsymbol{w}" display="inline"><semantics id="S2.SS3.p1.8.m6.1a"><mi mathsize="90%" id="S2.SS3.p1.8.m6.1.1" xref="S2.SS3.p1.8.m6.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.8.m6.1b"><ci id="S2.SS3.p1.8.m6.1.1.cmml" xref="S2.SS3.p1.8.m6.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.8.m6.1c">\boldsymbol{w}</annotation></semantics></math><span id="S2.SS3.p1.9.7" class="ltx_text" style="font-size:90%;">. Margin control regularization helps to mitigate the reliance on shortcut features and encourages the model to focus on stable features. As shown in Fig. </span><a href="#S2.F2" title="Figure 2 ‣ 2.2 Global Loss Objective Decomposition ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S2.SS3.p1.9.8" class="ltx_text" style="font-size:90%;"> (red lines), margin control regularization helps to reduce the distribution shift loss. While </span><math id="S2.SS3.p1.9.m7.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="S2.SS3.p1.9.m7.1a"><msub id="S2.SS3.p1.9.m7.1.1" xref="S2.SS3.p1.9.m7.1.1.cmml"><mi mathsize="90%" id="S2.SS3.p1.9.m7.1.1.2" xref="S2.SS3.p1.9.m7.1.1.2.cmml">l</mi><mn mathsize="90%" id="S2.SS3.p1.9.m7.1.1.3" xref="S2.SS3.p1.9.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.9.m7.1b"><apply id="S2.SS3.p1.9.m7.1.1.cmml" xref="S2.SS3.p1.9.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.9.m7.1.1.1.cmml" xref="S2.SS3.p1.9.m7.1.1">subscript</csymbol><ci id="S2.SS3.p1.9.m7.1.1.2.cmml" xref="S2.SS3.p1.9.m7.1.1.2">𝑙</ci><cn type="integer" id="S2.SS3.p1.9.m7.1.1.3.cmml" xref="S2.SS3.p1.9.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.9.m7.1c">l_{2}</annotation></semantics></math><span id="S2.SS3.p1.9.9" class="ltx_text" style="font-size:90%;">-norm regularization on output logits was also used in FedSR </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS3.p1.9.10.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib19" title="" class="ltx_ref">19</a><span id="S2.SS3.p1.9.11.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.SS3.p1.9.12" class="ltx_text" style="font-size:90%;"> to align representations from different clients with a common reference, our margin control regularization is motivated by shortcut learning. This allows us to use other regularization techniques, such as evaluating log loss on a margin multiplied by a decreasing function or penalizing large margins by setting thresholds.</span></p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Principal Gradient-based Server Aggregation</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.1" class="ltx_p"><span id="S2.SS4.p1.1.1" class="ltx_text" style="font-size:90%;">One of the key factors contributing to the performance degradation of FL in data heterogeneity is the conflicting gradients of local models trained on diverse local datasets </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS4.p1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a><span id="S2.SS4.p1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.SS4.p1.1.4" class="ltx_text" style="font-size:90%;">. Consider a scenario of FL training on two clients with datasets A and B. These datasets are unevenly distributed subsets of the same population, where dataset A predominantly contains "class A" data, and dataset B mainly comprises "class B" data. The models trained on these two datasets may exhibit different or even conflicting judgments, leading to potential conflicts in the gradients of the clients trained on these datasets.
Naively aggregating the conflicting gradients in FL may lead to a poorly performing global model, thus increasing the aggregation loss in Eq.(</span><a href="#S2.E2" title="In 2.2 Global Loss Objective Decomposition ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S2.SS4.p1.1.5" class="ltx_text" style="font-size:90%;">). Therefore, we propose a principal gradient-based server aggregation approach to amend these conflicting gradients and force them to follow a direction that maximally benefits all participating clients. The specific steps are:</span></p>
</div>
<div id="S2.SS4.p2" class="ltx_para ltx_noindent">
<p id="S2.SS4.p2.5" class="ltx_p"><span id="S2.SS4.p2.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Step 1: Principal Gradients Construction.</span><span id="S2.SS4.p2.5.2" class="ltx_text" style="font-size:90%;"> For client </span><math id="S2.SS4.p2.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS4.p2.1.m1.1a"><mi mathsize="90%" id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.1b"><ci id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.1c">i</annotation></semantics></math><span id="S2.SS4.p2.5.3" class="ltx_text" style="font-size:90%;">, we flatten its local gradients into a vector, denoted as </span><math id="S2.SS4.p2.2.m2.1" class="ltx_Math" alttext="\boldsymbol{g}_{i}\in\mathbb{R}^{d\times 1}" display="inline"><semantics id="S2.SS4.p2.2.m2.1a"><mrow id="S2.SS4.p2.2.m2.1.1" xref="S2.SS4.p2.2.m2.1.1.cmml"><msub id="S2.SS4.p2.2.m2.1.1.2" xref="S2.SS4.p2.2.m2.1.1.2.cmml"><mi mathsize="90%" id="S2.SS4.p2.2.m2.1.1.2.2" xref="S2.SS4.p2.2.m2.1.1.2.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.SS4.p2.2.m2.1.1.2.3" xref="S2.SS4.p2.2.m2.1.1.2.3.cmml">i</mi></msub><mo mathsize="90%" id="S2.SS4.p2.2.m2.1.1.1" xref="S2.SS4.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S2.SS4.p2.2.m2.1.1.3" xref="S2.SS4.p2.2.m2.1.1.3.cmml"><mi mathsize="90%" id="S2.SS4.p2.2.m2.1.1.3.2" xref="S2.SS4.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.p2.2.m2.1.1.3.3" xref="S2.SS4.p2.2.m2.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS4.p2.2.m2.1.1.3.3.2" xref="S2.SS4.p2.2.m2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS4.p2.2.m2.1.1.3.3.1" xref="S2.SS4.p2.2.m2.1.1.3.3.1.cmml">×</mo><mn mathsize="90%" id="S2.SS4.p2.2.m2.1.1.3.3.3" xref="S2.SS4.p2.2.m2.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.2.m2.1b"><apply id="S2.SS4.p2.2.m2.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1"><in id="S2.SS4.p2.2.m2.1.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1.1"></in><apply id="S2.SS4.p2.2.m2.1.1.2.cmml" xref="S2.SS4.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p2.2.m2.1.1.2.1.cmml" xref="S2.SS4.p2.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS4.p2.2.m2.1.1.2.2.cmml" xref="S2.SS4.p2.2.m2.1.1.2.2">𝒈</ci><ci id="S2.SS4.p2.2.m2.1.1.2.3.cmml" xref="S2.SS4.p2.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S2.SS4.p2.2.m2.1.1.3.cmml" xref="S2.SS4.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p2.2.m2.1.1.3.1.cmml" xref="S2.SS4.p2.2.m2.1.1.3">superscript</csymbol><ci id="S2.SS4.p2.2.m2.1.1.3.2.cmml" xref="S2.SS4.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S2.SS4.p2.2.m2.1.1.3.3.cmml" xref="S2.SS4.p2.2.m2.1.1.3.3"><times id="S2.SS4.p2.2.m2.1.1.3.3.1.cmml" xref="S2.SS4.p2.2.m2.1.1.3.3.1"></times><ci id="S2.SS4.p2.2.m2.1.1.3.3.2.cmml" xref="S2.SS4.p2.2.m2.1.1.3.3.2">𝑑</ci><cn type="integer" id="S2.SS4.p2.2.m2.1.1.3.3.3.cmml" xref="S2.SS4.p2.2.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.2.m2.1c">\boldsymbol{g}_{i}\in\mathbb{R}^{d\times 1}</annotation></semantics></math><span id="S2.SS4.p2.5.4" class="ltx_text" style="font-size:90%;">, where </span><math id="S2.SS4.p2.3.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS4.p2.3.m3.1a"><mi mathsize="90%" id="S2.SS4.p2.3.m3.1.1" xref="S2.SS4.p2.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.3.m3.1b"><ci id="S2.SS4.p2.3.m3.1.1.cmml" xref="S2.SS4.p2.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.3.m3.1c">d</annotation></semantics></math><span id="S2.SS4.p2.5.5" class="ltx_text" style="font-size:90%;"> is the flattened dimension of the local gradients and is usually fairly large for modern deep learning architectures.
All the participating local gradient vectors make up a matrix </span><math id="S2.SS4.p2.4.m4.3" class="ltx_Math" alttext="\boldsymbol{G}=[\boldsymbol{g}_{1},\cdots,\boldsymbol{g}_{m}]" display="inline"><semantics id="S2.SS4.p2.4.m4.3a"><mrow id="S2.SS4.p2.4.m4.3.3" xref="S2.SS4.p2.4.m4.3.3.cmml"><mi mathsize="90%" id="S2.SS4.p2.4.m4.3.3.4" xref="S2.SS4.p2.4.m4.3.3.4.cmml">𝑮</mi><mo mathsize="90%" id="S2.SS4.p2.4.m4.3.3.3" xref="S2.SS4.p2.4.m4.3.3.3.cmml">=</mo><mrow id="S2.SS4.p2.4.m4.3.3.2.2" xref="S2.SS4.p2.4.m4.3.3.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS4.p2.4.m4.3.3.2.2.3" xref="S2.SS4.p2.4.m4.3.3.2.3.cmml">[</mo><msub id="S2.SS4.p2.4.m4.2.2.1.1.1" xref="S2.SS4.p2.4.m4.2.2.1.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p2.4.m4.2.2.1.1.1.2" xref="S2.SS4.p2.4.m4.2.2.1.1.1.2.cmml">𝒈</mi><mn mathsize="90%" id="S2.SS4.p2.4.m4.2.2.1.1.1.3" xref="S2.SS4.p2.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S2.SS4.p2.4.m4.3.3.2.2.4" xref="S2.SS4.p2.4.m4.3.3.2.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.SS4.p2.4.m4.1.1" xref="S2.SS4.p2.4.m4.1.1.cmml">⋯</mi><mo mathsize="90%" id="S2.SS4.p2.4.m4.3.3.2.2.5" xref="S2.SS4.p2.4.m4.3.3.2.3.cmml">,</mo><msub id="S2.SS4.p2.4.m4.3.3.2.2.2" xref="S2.SS4.p2.4.m4.3.3.2.2.2.cmml"><mi mathsize="90%" id="S2.SS4.p2.4.m4.3.3.2.2.2.2" xref="S2.SS4.p2.4.m4.3.3.2.2.2.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.SS4.p2.4.m4.3.3.2.2.2.3" xref="S2.SS4.p2.4.m4.3.3.2.2.2.3.cmml">m</mi></msub><mo maxsize="90%" minsize="90%" id="S2.SS4.p2.4.m4.3.3.2.2.6" xref="S2.SS4.p2.4.m4.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.4.m4.3b"><apply id="S2.SS4.p2.4.m4.3.3.cmml" xref="S2.SS4.p2.4.m4.3.3"><eq id="S2.SS4.p2.4.m4.3.3.3.cmml" xref="S2.SS4.p2.4.m4.3.3.3"></eq><ci id="S2.SS4.p2.4.m4.3.3.4.cmml" xref="S2.SS4.p2.4.m4.3.3.4">𝑮</ci><list id="S2.SS4.p2.4.m4.3.3.2.3.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2"><apply id="S2.SS4.p2.4.m4.2.2.1.1.1.cmml" xref="S2.SS4.p2.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS4.p2.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS4.p2.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS4.p2.4.m4.2.2.1.1.1.2">𝒈</ci><cn type="integer" id="S2.SS4.p2.4.m4.2.2.1.1.1.3.cmml" xref="S2.SS4.p2.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS4.p2.4.m4.1.1.cmml" xref="S2.SS4.p2.4.m4.1.1">⋯</ci><apply id="S2.SS4.p2.4.m4.3.3.2.2.2.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p2.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S2.SS4.p2.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2.2.2">𝒈</ci><ci id="S2.SS4.p2.4.m4.3.3.2.2.2.3.cmml" xref="S2.SS4.p2.4.m4.3.3.2.2.2.3">𝑚</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.4.m4.3c">\boldsymbol{G}=[\boldsymbol{g}_{1},\cdots,\boldsymbol{g}_{m}]</annotation></semantics></math><span id="S2.SS4.p2.5.6" class="ltx_text" style="font-size:90%;">. Next, we perform singular value decomposition (SVD) on matrix </span><math id="S2.SS4.p2.5.m5.1" class="ltx_Math" alttext="\boldsymbol{G}" display="inline"><semantics id="S2.SS4.p2.5.m5.1a"><mi mathsize="90%" id="S2.SS4.p2.5.m5.1.1" xref="S2.SS4.p2.5.m5.1.1.cmml">𝑮</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.5.m5.1b"><ci id="S2.SS4.p2.5.m5.1.1.cmml" xref="S2.SS4.p2.5.m5.1.1">𝑮</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.5.m5.1c">\boldsymbol{G}</annotation></semantics></math><span id="S2.SS4.p2.5.7" class="ltx_text" style="font-size:90%;">, generating a series of eigenvalues and their corresponding eigenvectors, expressed as:</span></p>
<table id="S4.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.2" class="ltx_Math" alttext="\displaystyle\lambda_{z},\boldsymbol{v}_{z}" display="inline"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.2" xref="S2.E4.m1.2.2.3.cmml"><msub id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.2.cmml">λ</mi><mi mathsize="90%" id="S2.E4.m1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.3.cmml">z</mi></msub><mo mathsize="90%" id="S2.E4.m1.2.2.2.3" xref="S2.E4.m1.2.2.3.cmml">,</mo><msub id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.2.cmml"><mi mathsize="90%" id="S2.E4.m1.2.2.2.2.2" xref="S2.E4.m1.2.2.2.2.2.cmml">𝒗</mi><mi mathsize="90%" id="S2.E4.m1.2.2.2.2.3" xref="S2.E4.m1.2.2.2.2.3.cmml">z</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><list id="S2.E4.m1.2.2.3.cmml" xref="S2.E4.m1.2.2.2"><apply id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.2">𝜆</ci><ci id="S2.E4.m1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.3">𝑧</ci></apply><apply id="S2.E4.m1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.2.1.cmml" xref="S2.E4.m1.2.2.2.2">subscript</csymbol><ci id="S2.E4.m1.2.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2.2">𝒗</ci><ci id="S2.E4.m1.2.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.2.3">𝑧</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">\displaystyle\lambda_{z},\boldsymbol{v}_{z}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E4.m2.1" class="ltx_Math" alttext="\displaystyle=\text{SVD}_{z}\left(\frac{1}{m}{\boldsymbol{G}}{\boldsymbol{G}^{\top}}\right)," display="inline"><semantics id="S2.E4.m2.1a"><mrow id="S2.E4.m2.1.1.1" xref="S2.E4.m2.1.1.1.1.cmml"><mrow id="S2.E4.m2.1.1.1.1" xref="S2.E4.m2.1.1.1.1.cmml"><mi id="S2.E4.m2.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.3.cmml"></mi><mo mathsize="90%" id="S2.E4.m2.1.1.1.1.2" xref="S2.E4.m2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E4.m2.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.cmml"><msub id="S2.E4.m2.1.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.1.3.cmml"><mtext mathsize="90%" id="S2.E4.m2.1.1.1.1.1.3.2" xref="S2.E4.m2.1.1.1.1.1.3.2a.cmml">SVD</mtext><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.1.3.3" xref="S2.E4.m2.1.1.1.1.1.3.3.cmml">z</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m2.1.1.1.1.1.2" xref="S2.E4.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m2.1.1.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m2.1.1.1.1.1.1.1.2" xref="S2.E4.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m2.1.1.1.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E4.m2.1.1.1.1.1.1.1.1.2" xref="S2.E4.m2.1.1.1.1.1.1.1.1.2.cmml"><mfrac id="S2.E4.m2.1.1.1.1.1.1.1.1.2a" xref="S2.E4.m2.1.1.1.1.1.1.1.1.2.cmml"><mn mathsize="90%" id="S2.E4.m2.1.1.1.1.1.1.1.1.2.2" xref="S2.E4.m2.1.1.1.1.1.1.1.1.2.2.cmml">1</mn><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.1.1.1.1.2.3" xref="S2.E4.m2.1.1.1.1.1.1.1.1.2.3.cmml">m</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E4.m2.1.1.1.1.1.1.1.1.1" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.1.1.1.1.3.cmml">𝑮</mi><mo lspace="0em" rspace="0em" id="S2.E4.m2.1.1.1.1.1.1.1.1.1a" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml">​</mo><msup id="S2.E4.m2.1.1.1.1.1.1.1.1.4" xref="S2.E4.m2.1.1.1.1.1.1.1.1.4.cmml"><mi mathsize="90%" id="S2.E4.m2.1.1.1.1.1.1.1.1.4.2" xref="S2.E4.m2.1.1.1.1.1.1.1.1.4.2.cmml">𝑮</mi><mo mathsize="90%" id="S2.E4.m2.1.1.1.1.1.1.1.1.4.3" xref="S2.E4.m2.1.1.1.1.1.1.1.1.4.3.cmml">⊤</mo></msup></mrow><mo id="S2.E4.m2.1.1.1.1.1.1.1.3" xref="S2.E4.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo mathsize="90%" id="S2.E4.m2.1.1.1.2" xref="S2.E4.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.1b"><apply id="S2.E4.m2.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1"><eq id="S2.E4.m2.1.1.1.1.2.cmml" xref="S2.E4.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E4.m2.1.1.1.1.3.cmml" xref="S2.E4.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E4.m2.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1"><times id="S2.E4.m2.1.1.1.1.1.2.cmml" xref="S2.E4.m2.1.1.1.1.1.2"></times><apply id="S2.E4.m2.1.1.1.1.1.3.cmml" xref="S2.E4.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.1.3.1.cmml" xref="S2.E4.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m2.1.1.1.1.1.3.2a.cmml" xref="S2.E4.m2.1.1.1.1.1.3.2"><mtext mathsize="90%" id="S2.E4.m2.1.1.1.1.1.3.2.cmml" xref="S2.E4.m2.1.1.1.1.1.3.2">SVD</mtext></ci><ci id="S2.E4.m2.1.1.1.1.1.3.3.cmml" xref="S2.E4.m2.1.1.1.1.1.3.3">𝑧</ci></apply><apply id="S2.E4.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1"><times id="S2.E4.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E4.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.2"><divide id="S2.E4.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.2"></divide><cn type="integer" id="S2.E4.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.2.2">1</cn><ci id="S2.E4.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="S2.E4.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.3">𝑮</ci><apply id="S2.E4.m2.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E4.m2.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S2.E4.m2.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.4.2">𝑮</ci><csymbol cd="latexml" id="S2.E4.m2.1.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E4.m2.1.1.1.1.1.1.1.1.4.3">top</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.1c">\displaystyle=\text{SVD}_{z}\left(\frac{1}{m}{\boldsymbol{G}}{\boldsymbol{G}^{\top}}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS4.p2.9" class="ltx_p"><span id="S2.SS4.p2.9.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.SS4.p2.6.m1.1" class="ltx_Math" alttext="\lambda_{z}" display="inline"><semantics id="S2.SS4.p2.6.m1.1a"><msub id="S2.SS4.p2.6.m1.1.1" xref="S2.SS4.p2.6.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p2.6.m1.1.1.2" xref="S2.SS4.p2.6.m1.1.1.2.cmml">λ</mi><mi mathsize="90%" id="S2.SS4.p2.6.m1.1.1.3" xref="S2.SS4.p2.6.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.6.m1.1b"><apply id="S2.SS4.p2.6.m1.1.1.cmml" xref="S2.SS4.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.6.m1.1.1.1.cmml" xref="S2.SS4.p2.6.m1.1.1">subscript</csymbol><ci id="S2.SS4.p2.6.m1.1.1.2.cmml" xref="S2.SS4.p2.6.m1.1.1.2">𝜆</ci><ci id="S2.SS4.p2.6.m1.1.1.3.cmml" xref="S2.SS4.p2.6.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.6.m1.1c">\lambda_{z}</annotation></semantics></math><span id="S2.SS4.p2.9.2" class="ltx_text" style="font-size:90%;"> and </span><math id="S2.SS4.p2.7.m2.1" class="ltx_Math" alttext="\boldsymbol{v}_{z}" display="inline"><semantics id="S2.SS4.p2.7.m2.1a"><msub id="S2.SS4.p2.7.m2.1.1" xref="S2.SS4.p2.7.m2.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p2.7.m2.1.1.2" xref="S2.SS4.p2.7.m2.1.1.2.cmml">𝒗</mi><mi mathsize="90%" id="S2.SS4.p2.7.m2.1.1.3" xref="S2.SS4.p2.7.m2.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.7.m2.1b"><apply id="S2.SS4.p2.7.m2.1.1.cmml" xref="S2.SS4.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.7.m2.1.1.1.cmml" xref="S2.SS4.p2.7.m2.1.1">subscript</csymbol><ci id="S2.SS4.p2.7.m2.1.1.2.cmml" xref="S2.SS4.p2.7.m2.1.1.2">𝒗</ci><ci id="S2.SS4.p2.7.m2.1.1.3.cmml" xref="S2.SS4.p2.7.m2.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.7.m2.1c">\boldsymbol{v}_{z}</annotation></semantics></math><span id="S2.SS4.p2.9.3" class="ltx_text" style="font-size:90%;"> represent the </span><math id="S2.SS4.p2.8.m3.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S2.SS4.p2.8.m3.1a"><mi mathsize="90%" id="S2.SS4.p2.8.m3.1.1" xref="S2.SS4.p2.8.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.8.m3.1b"><ci id="S2.SS4.p2.8.m3.1.1.cmml" xref="S2.SS4.p2.8.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.8.m3.1c">z</annotation></semantics></math><span id="S2.SS4.p2.9.4" class="ltx_text" style="font-size:90%;">-th largest eigenvalue and its corresponding eigenvector, respectively. However, the high dimension of </span><math id="S2.SS4.p2.9.m4.1" class="ltx_Math" alttext="\boldsymbol{G}\boldsymbol{G}^{\top}\in\mathbb{R}^{d\times d}" display="inline"><semantics id="S2.SS4.p2.9.m4.1a"><mrow id="S2.SS4.p2.9.m4.1.1" xref="S2.SS4.p2.9.m4.1.1.cmml"><mrow id="S2.SS4.p2.9.m4.1.1.2" xref="S2.SS4.p2.9.m4.1.1.2.cmml"><mi mathsize="90%" id="S2.SS4.p2.9.m4.1.1.2.2" xref="S2.SS4.p2.9.m4.1.1.2.2.cmml">𝑮</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p2.9.m4.1.1.2.1" xref="S2.SS4.p2.9.m4.1.1.2.1.cmml">​</mo><msup id="S2.SS4.p2.9.m4.1.1.2.3" xref="S2.SS4.p2.9.m4.1.1.2.3.cmml"><mi mathsize="90%" id="S2.SS4.p2.9.m4.1.1.2.3.2" xref="S2.SS4.p2.9.m4.1.1.2.3.2.cmml">𝑮</mi><mo mathsize="90%" id="S2.SS4.p2.9.m4.1.1.2.3.3" xref="S2.SS4.p2.9.m4.1.1.2.3.3.cmml">⊤</mo></msup></mrow><mo mathsize="90%" id="S2.SS4.p2.9.m4.1.1.1" xref="S2.SS4.p2.9.m4.1.1.1.cmml">∈</mo><msup id="S2.SS4.p2.9.m4.1.1.3" xref="S2.SS4.p2.9.m4.1.1.3.cmml"><mi mathsize="90%" id="S2.SS4.p2.9.m4.1.1.3.2" xref="S2.SS4.p2.9.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.p2.9.m4.1.1.3.3" xref="S2.SS4.p2.9.m4.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS4.p2.9.m4.1.1.3.3.2" xref="S2.SS4.p2.9.m4.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS4.p2.9.m4.1.1.3.3.1" xref="S2.SS4.p2.9.m4.1.1.3.3.1.cmml">×</mo><mi mathsize="90%" id="S2.SS4.p2.9.m4.1.1.3.3.3" xref="S2.SS4.p2.9.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.9.m4.1b"><apply id="S2.SS4.p2.9.m4.1.1.cmml" xref="S2.SS4.p2.9.m4.1.1"><in id="S2.SS4.p2.9.m4.1.1.1.cmml" xref="S2.SS4.p2.9.m4.1.1.1"></in><apply id="S2.SS4.p2.9.m4.1.1.2.cmml" xref="S2.SS4.p2.9.m4.1.1.2"><times id="S2.SS4.p2.9.m4.1.1.2.1.cmml" xref="S2.SS4.p2.9.m4.1.1.2.1"></times><ci id="S2.SS4.p2.9.m4.1.1.2.2.cmml" xref="S2.SS4.p2.9.m4.1.1.2.2">𝑮</ci><apply id="S2.SS4.p2.9.m4.1.1.2.3.cmml" xref="S2.SS4.p2.9.m4.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS4.p2.9.m4.1.1.2.3.1.cmml" xref="S2.SS4.p2.9.m4.1.1.2.3">superscript</csymbol><ci id="S2.SS4.p2.9.m4.1.1.2.3.2.cmml" xref="S2.SS4.p2.9.m4.1.1.2.3.2">𝑮</ci><csymbol cd="latexml" id="S2.SS4.p2.9.m4.1.1.2.3.3.cmml" xref="S2.SS4.p2.9.m4.1.1.2.3.3">top</csymbol></apply></apply><apply id="S2.SS4.p2.9.m4.1.1.3.cmml" xref="S2.SS4.p2.9.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p2.9.m4.1.1.3.1.cmml" xref="S2.SS4.p2.9.m4.1.1.3">superscript</csymbol><ci id="S2.SS4.p2.9.m4.1.1.3.2.cmml" xref="S2.SS4.p2.9.m4.1.1.3.2">ℝ</ci><apply id="S2.SS4.p2.9.m4.1.1.3.3.cmml" xref="S2.SS4.p2.9.m4.1.1.3.3"><times id="S2.SS4.p2.9.m4.1.1.3.3.1.cmml" xref="S2.SS4.p2.9.m4.1.1.3.3.1"></times><ci id="S2.SS4.p2.9.m4.1.1.3.3.2.cmml" xref="S2.SS4.p2.9.m4.1.1.3.3.2">𝑑</ci><ci id="S2.SS4.p2.9.m4.1.1.3.3.3.cmml" xref="S2.SS4.p2.9.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.9.m4.1c">\boldsymbol{G}\boldsymbol{G}^{\top}\in\mathbb{R}^{d\times d}</annotation></semantics></math><span id="S2.SS4.p2.9.5" class="ltx_text" style="font-size:90%;"> makes naive SVD complex and prohibitive. Thus, we construct a bijection </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS4.p2.9.6.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib27" title="" class="ltx_ref">27</a><span id="S2.SS4.p2.9.7.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.SS4.p2.9.8" class="ltx_text" style="font-size:90%;"> to reduce computational complexity as follows:</span></p>
<table id="S4.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E5.m1.1" class="ltx_Math" alttext="\displaystyle{\boldsymbol{G}^{\top}}{\boldsymbol{G}}\boldsymbol{e}_{z}" display="inline"><semantics id="S2.E5.m1.1a"><mrow id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml"><msup id="S2.E5.m1.1.1.2" xref="S2.E5.m1.1.1.2.cmml"><mi mathsize="90%" id="S2.E5.m1.1.1.2.2" xref="S2.E5.m1.1.1.2.2.cmml">𝑮</mi><mo mathsize="90%" id="S2.E5.m1.1.1.2.3" xref="S2.E5.m1.1.1.2.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.cmml">​</mo><mi mathsize="90%" id="S2.E5.m1.1.1.3" xref="S2.E5.m1.1.1.3.cmml">𝑮</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1a" xref="S2.E5.m1.1.1.1.cmml">​</mo><msub id="S2.E5.m1.1.1.4" xref="S2.E5.m1.1.1.4.cmml"><mi mathsize="90%" id="S2.E5.m1.1.1.4.2" xref="S2.E5.m1.1.1.4.2.cmml">𝒆</mi><mi mathsize="90%" id="S2.E5.m1.1.1.4.3" xref="S2.E5.m1.1.1.4.3.cmml">z</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1"><times id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"></times><apply id="S2.E5.m1.1.1.2.cmml" xref="S2.E5.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.2.1.cmml" xref="S2.E5.m1.1.1.2">superscript</csymbol><ci id="S2.E5.m1.1.1.2.2.cmml" xref="S2.E5.m1.1.1.2.2">𝑮</ci><csymbol cd="latexml" id="S2.E5.m1.1.1.2.3.cmml" xref="S2.E5.m1.1.1.2.3">top</csymbol></apply><ci id="S2.E5.m1.1.1.3.cmml" xref="S2.E5.m1.1.1.3">𝑮</ci><apply id="S2.E5.m1.1.1.4.cmml" xref="S2.E5.m1.1.1.4"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.4.1.cmml" xref="S2.E5.m1.1.1.4">subscript</csymbol><ci id="S2.E5.m1.1.1.4.2.cmml" xref="S2.E5.m1.1.1.4.2">𝒆</ci><ci id="S2.E5.m1.1.1.4.3.cmml" xref="S2.E5.m1.1.1.4.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\displaystyle{\boldsymbol{G}^{\top}}{\boldsymbol{G}}\boldsymbol{e}_{z}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5.m2.1" class="ltx_Math" alttext="\displaystyle=\lambda_{z}\boldsymbol{e}_{z}\quad\Longrightarrow\quad{\boldsymbol{G}}{\boldsymbol{G}^{\top}}{\boldsymbol{G}}\boldsymbol{e}_{z}=\lambda_{z}{\boldsymbol{G}}\boldsymbol{e}_{z}\quad\Longrightarrow\quad\boldsymbol{v}_{z}={\boldsymbol{G}}\boldsymbol{e}_{z}." display="inline"><semantics id="S2.E5.m2.1a"><mrow id="S2.E5.m2.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mrow id="S2.E5.m2.1.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.2.cmml"></mi><mo mathsize="90%" id="S2.E5.m2.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.3.cmml">=</mo><mrow id="S2.E5.m2.1.1.1.1.4" xref="S2.E5.m2.1.1.1.1.4.cmml"><msub id="S2.E5.m2.1.1.1.1.4.2" xref="S2.E5.m2.1.1.1.1.4.2.cmml"><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.4.2.2" xref="S2.E5.m2.1.1.1.1.4.2.2.cmml">λ</mi><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.4.2.3" xref="S2.E5.m2.1.1.1.1.4.2.3.cmml">z</mi></msub><mo lspace="0em" rspace="0em" id="S2.E5.m2.1.1.1.1.4.1" xref="S2.E5.m2.1.1.1.1.4.1.cmml">​</mo><msub id="S2.E5.m2.1.1.1.1.4.3" xref="S2.E5.m2.1.1.1.1.4.3.cmml"><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.4.3.2" xref="S2.E5.m2.1.1.1.1.4.3.2.cmml">𝒆</mi><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.4.3.3" xref="S2.E5.m2.1.1.1.1.4.3.3.cmml">z</mi></msub></mrow><mo mathsize="90%" rspace="1.178em" stretchy="false" id="S2.E5.m2.1.1.1.1.5" xref="S2.E5.m2.1.1.1.1.5.cmml">⟹</mo><mrow id="S2.E5.m2.1.1.1.1.6" xref="S2.E5.m2.1.1.1.1.6.cmml"><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.6.2" xref="S2.E5.m2.1.1.1.1.6.2.cmml">𝑮</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.1.1.1.1.6.1" xref="S2.E5.m2.1.1.1.1.6.1.cmml">​</mo><msup id="S2.E5.m2.1.1.1.1.6.3" xref="S2.E5.m2.1.1.1.1.6.3.cmml"><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.6.3.2" xref="S2.E5.m2.1.1.1.1.6.3.2.cmml">𝑮</mi><mo mathsize="90%" id="S2.E5.m2.1.1.1.1.6.3.3" xref="S2.E5.m2.1.1.1.1.6.3.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S2.E5.m2.1.1.1.1.6.1a" xref="S2.E5.m2.1.1.1.1.6.1.cmml">​</mo><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.6.4" xref="S2.E5.m2.1.1.1.1.6.4.cmml">𝑮</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.1.1.1.1.6.1b" xref="S2.E5.m2.1.1.1.1.6.1.cmml">​</mo><msub id="S2.E5.m2.1.1.1.1.6.5" xref="S2.E5.m2.1.1.1.1.6.5.cmml"><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.6.5.2" xref="S2.E5.m2.1.1.1.1.6.5.2.cmml">𝒆</mi><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.6.5.3" xref="S2.E5.m2.1.1.1.1.6.5.3.cmml">z</mi></msub></mrow><mo mathsize="90%" id="S2.E5.m2.1.1.1.1.7" xref="S2.E5.m2.1.1.1.1.7.cmml">=</mo><mrow id="S2.E5.m2.1.1.1.1.8" xref="S2.E5.m2.1.1.1.1.8.cmml"><msub id="S2.E5.m2.1.1.1.1.8.2" xref="S2.E5.m2.1.1.1.1.8.2.cmml"><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.8.2.2" xref="S2.E5.m2.1.1.1.1.8.2.2.cmml">λ</mi><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.8.2.3" xref="S2.E5.m2.1.1.1.1.8.2.3.cmml">z</mi></msub><mo lspace="0em" rspace="0em" id="S2.E5.m2.1.1.1.1.8.1" xref="S2.E5.m2.1.1.1.1.8.1.cmml">​</mo><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.8.3" xref="S2.E5.m2.1.1.1.1.8.3.cmml">𝑮</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.1.1.1.1.8.1a" xref="S2.E5.m2.1.1.1.1.8.1.cmml">​</mo><msub id="S2.E5.m2.1.1.1.1.8.4" xref="S2.E5.m2.1.1.1.1.8.4.cmml"><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.8.4.2" xref="S2.E5.m2.1.1.1.1.8.4.2.cmml">𝒆</mi><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.8.4.3" xref="S2.E5.m2.1.1.1.1.8.4.3.cmml">z</mi></msub></mrow><mo mathsize="90%" rspace="1.178em" stretchy="false" id="S2.E5.m2.1.1.1.1.9" xref="S2.E5.m2.1.1.1.1.9.cmml">⟹</mo><msub id="S2.E5.m2.1.1.1.1.10" xref="S2.E5.m2.1.1.1.1.10.cmml"><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.10.2" xref="S2.E5.m2.1.1.1.1.10.2.cmml">𝒗</mi><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.10.3" xref="S2.E5.m2.1.1.1.1.10.3.cmml">z</mi></msub><mo mathsize="90%" id="S2.E5.m2.1.1.1.1.11" xref="S2.E5.m2.1.1.1.1.11.cmml">=</mo><mrow id="S2.E5.m2.1.1.1.1.12" xref="S2.E5.m2.1.1.1.1.12.cmml"><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.12.2" xref="S2.E5.m2.1.1.1.1.12.2.cmml">𝑮</mi><mo lspace="0em" rspace="0em" id="S2.E5.m2.1.1.1.1.12.1" xref="S2.E5.m2.1.1.1.1.12.1.cmml">​</mo><msub id="S2.E5.m2.1.1.1.1.12.3" xref="S2.E5.m2.1.1.1.1.12.3.cmml"><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.12.3.2" xref="S2.E5.m2.1.1.1.1.12.3.2.cmml">𝒆</mi><mi mathsize="90%" id="S2.E5.m2.1.1.1.1.12.3.3" xref="S2.E5.m2.1.1.1.1.12.3.3.cmml">z</mi></msub></mrow></mrow><mo lspace="0em" mathsize="90%" id="S2.E5.m2.1.1.1.2" xref="S2.E5.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.1b"><apply id="S2.E5.m2.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1"><and id="S2.E5.m2.1.1.1.1a.cmml" xref="S2.E5.m2.1.1.1"></and><apply id="S2.E5.m2.1.1.1.1b.cmml" xref="S2.E5.m2.1.1.1"><eq id="S2.E5.m2.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S2.E5.m2.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.2">absent</csymbol><apply id="S2.E5.m2.1.1.1.1.4.cmml" xref="S2.E5.m2.1.1.1.1.4"><times id="S2.E5.m2.1.1.1.1.4.1.cmml" xref="S2.E5.m2.1.1.1.1.4.1"></times><apply id="S2.E5.m2.1.1.1.1.4.2.cmml" xref="S2.E5.m2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.4.2.1.cmml" xref="S2.E5.m2.1.1.1.1.4.2">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.4.2.2.cmml" xref="S2.E5.m2.1.1.1.1.4.2.2">𝜆</ci><ci id="S2.E5.m2.1.1.1.1.4.2.3.cmml" xref="S2.E5.m2.1.1.1.1.4.2.3">𝑧</ci></apply><apply id="S2.E5.m2.1.1.1.1.4.3.cmml" xref="S2.E5.m2.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.4.3.1.cmml" xref="S2.E5.m2.1.1.1.1.4.3">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.4.3.2.cmml" xref="S2.E5.m2.1.1.1.1.4.3.2">𝒆</ci><ci id="S2.E5.m2.1.1.1.1.4.3.3.cmml" xref="S2.E5.m2.1.1.1.1.4.3.3">𝑧</ci></apply></apply></apply><apply id="S2.E5.m2.1.1.1.1c.cmml" xref="S2.E5.m2.1.1.1"><ci id="S2.E5.m2.1.1.1.1.5.cmml" xref="S2.E5.m2.1.1.1.1.5">⟹</ci><share href="#S2.E5.m2.1.1.1.1.4.cmml" id="S2.E5.m2.1.1.1.1d.cmml" xref="S2.E5.m2.1.1.1"></share><apply id="S2.E5.m2.1.1.1.1.6.cmml" xref="S2.E5.m2.1.1.1.1.6"><times id="S2.E5.m2.1.1.1.1.6.1.cmml" xref="S2.E5.m2.1.1.1.1.6.1"></times><ci id="S2.E5.m2.1.1.1.1.6.2.cmml" xref="S2.E5.m2.1.1.1.1.6.2">𝑮</ci><apply id="S2.E5.m2.1.1.1.1.6.3.cmml" xref="S2.E5.m2.1.1.1.1.6.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.6.3.1.cmml" xref="S2.E5.m2.1.1.1.1.6.3">superscript</csymbol><ci id="S2.E5.m2.1.1.1.1.6.3.2.cmml" xref="S2.E5.m2.1.1.1.1.6.3.2">𝑮</ci><csymbol cd="latexml" id="S2.E5.m2.1.1.1.1.6.3.3.cmml" xref="S2.E5.m2.1.1.1.1.6.3.3">top</csymbol></apply><ci id="S2.E5.m2.1.1.1.1.6.4.cmml" xref="S2.E5.m2.1.1.1.1.6.4">𝑮</ci><apply id="S2.E5.m2.1.1.1.1.6.5.cmml" xref="S2.E5.m2.1.1.1.1.6.5"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.6.5.1.cmml" xref="S2.E5.m2.1.1.1.1.6.5">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.6.5.2.cmml" xref="S2.E5.m2.1.1.1.1.6.5.2">𝒆</ci><ci id="S2.E5.m2.1.1.1.1.6.5.3.cmml" xref="S2.E5.m2.1.1.1.1.6.5.3">𝑧</ci></apply></apply></apply><apply id="S2.E5.m2.1.1.1.1e.cmml" xref="S2.E5.m2.1.1.1"><eq id="S2.E5.m2.1.1.1.1.7.cmml" xref="S2.E5.m2.1.1.1.1.7"></eq><share href="#S2.E5.m2.1.1.1.1.6.cmml" id="S2.E5.m2.1.1.1.1f.cmml" xref="S2.E5.m2.1.1.1"></share><apply id="S2.E5.m2.1.1.1.1.8.cmml" xref="S2.E5.m2.1.1.1.1.8"><times id="S2.E5.m2.1.1.1.1.8.1.cmml" xref="S2.E5.m2.1.1.1.1.8.1"></times><apply id="S2.E5.m2.1.1.1.1.8.2.cmml" xref="S2.E5.m2.1.1.1.1.8.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.8.2.1.cmml" xref="S2.E5.m2.1.1.1.1.8.2">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.8.2.2.cmml" xref="S2.E5.m2.1.1.1.1.8.2.2">𝜆</ci><ci id="S2.E5.m2.1.1.1.1.8.2.3.cmml" xref="S2.E5.m2.1.1.1.1.8.2.3">𝑧</ci></apply><ci id="S2.E5.m2.1.1.1.1.8.3.cmml" xref="S2.E5.m2.1.1.1.1.8.3">𝑮</ci><apply id="S2.E5.m2.1.1.1.1.8.4.cmml" xref="S2.E5.m2.1.1.1.1.8.4"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.8.4.1.cmml" xref="S2.E5.m2.1.1.1.1.8.4">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.8.4.2.cmml" xref="S2.E5.m2.1.1.1.1.8.4.2">𝒆</ci><ci id="S2.E5.m2.1.1.1.1.8.4.3.cmml" xref="S2.E5.m2.1.1.1.1.8.4.3">𝑧</ci></apply></apply></apply><apply id="S2.E5.m2.1.1.1.1g.cmml" xref="S2.E5.m2.1.1.1"><ci id="S2.E5.m2.1.1.1.1.9.cmml" xref="S2.E5.m2.1.1.1.1.9">⟹</ci><share href="#S2.E5.m2.1.1.1.1.8.cmml" id="S2.E5.m2.1.1.1.1h.cmml" xref="S2.E5.m2.1.1.1"></share><apply id="S2.E5.m2.1.1.1.1.10.cmml" xref="S2.E5.m2.1.1.1.1.10"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.10.1.cmml" xref="S2.E5.m2.1.1.1.1.10">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.10.2.cmml" xref="S2.E5.m2.1.1.1.1.10.2">𝒗</ci><ci id="S2.E5.m2.1.1.1.1.10.3.cmml" xref="S2.E5.m2.1.1.1.1.10.3">𝑧</ci></apply></apply><apply id="S2.E5.m2.1.1.1.1i.cmml" xref="S2.E5.m2.1.1.1"><eq id="S2.E5.m2.1.1.1.1.11.cmml" xref="S2.E5.m2.1.1.1.1.11"></eq><share href="#S2.E5.m2.1.1.1.1.10.cmml" id="S2.E5.m2.1.1.1.1j.cmml" xref="S2.E5.m2.1.1.1"></share><apply id="S2.E5.m2.1.1.1.1.12.cmml" xref="S2.E5.m2.1.1.1.1.12"><times id="S2.E5.m2.1.1.1.1.12.1.cmml" xref="S2.E5.m2.1.1.1.1.12.1"></times><ci id="S2.E5.m2.1.1.1.1.12.2.cmml" xref="S2.E5.m2.1.1.1.1.12.2">𝑮</ci><apply id="S2.E5.m2.1.1.1.1.12.3.cmml" xref="S2.E5.m2.1.1.1.1.12.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.12.3.1.cmml" xref="S2.E5.m2.1.1.1.1.12.3">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.12.3.2.cmml" xref="S2.E5.m2.1.1.1.1.12.3.2">𝒆</ci><ci id="S2.E5.m2.1.1.1.1.12.3.3.cmml" xref="S2.E5.m2.1.1.1.1.12.3.3">𝑧</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.1c">\displaystyle=\lambda_{z}\boldsymbol{e}_{z}\quad\Longrightarrow\quad{\boldsymbol{G}}{\boldsymbol{G}^{\top}}{\boldsymbol{G}}\boldsymbol{e}_{z}=\lambda_{z}{\boldsymbol{G}}\boldsymbol{e}_{z}\quad\Longrightarrow\quad\boldsymbol{v}_{z}={\boldsymbol{G}}\boldsymbol{e}_{z}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS4.p2.17" class="ltx_p"><span id="S2.SS4.p2.17.1" class="ltx_text" style="font-size:90%;">Here </span><math id="S2.SS4.p2.10.m1.1" class="ltx_Math" alttext="\boldsymbol{e}_{z}" display="inline"><semantics id="S2.SS4.p2.10.m1.1a"><msub id="S2.SS4.p2.10.m1.1.1" xref="S2.SS4.p2.10.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p2.10.m1.1.1.2" xref="S2.SS4.p2.10.m1.1.1.2.cmml">𝒆</mi><mi mathsize="90%" id="S2.SS4.p2.10.m1.1.1.3" xref="S2.SS4.p2.10.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.10.m1.1b"><apply id="S2.SS4.p2.10.m1.1.1.cmml" xref="S2.SS4.p2.10.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.10.m1.1.1.1.cmml" xref="S2.SS4.p2.10.m1.1.1">subscript</csymbol><ci id="S2.SS4.p2.10.m1.1.1.2.cmml" xref="S2.SS4.p2.10.m1.1.1.2">𝒆</ci><ci id="S2.SS4.p2.10.m1.1.1.3.cmml" xref="S2.SS4.p2.10.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.10.m1.1c">\boldsymbol{e}_{z}</annotation></semantics></math><span id="S2.SS4.p2.17.2" class="ltx_text" style="font-size:90%;"> represents the </span><math id="S2.SS4.p2.11.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S2.SS4.p2.11.m2.1a"><mi mathsize="90%" id="S2.SS4.p2.11.m2.1.1" xref="S2.SS4.p2.11.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.11.m2.1b"><ci id="S2.SS4.p2.11.m2.1.1.cmml" xref="S2.SS4.p2.11.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.11.m2.1c">z</annotation></semantics></math><span id="S2.SS4.p2.17.3" class="ltx_text" style="font-size:90%;">-th largest eigenvector of the matrix </span><math id="S2.SS4.p2.12.m3.1" class="ltx_Math" alttext="{\boldsymbol{G}^{\top}}{\boldsymbol{G}}" display="inline"><semantics id="S2.SS4.p2.12.m3.1a"><mrow id="S2.SS4.p2.12.m3.1.1" xref="S2.SS4.p2.12.m3.1.1.cmml"><msup id="S2.SS4.p2.12.m3.1.1.2" xref="S2.SS4.p2.12.m3.1.1.2.cmml"><mi mathsize="90%" id="S2.SS4.p2.12.m3.1.1.2.2" xref="S2.SS4.p2.12.m3.1.1.2.2.cmml">𝑮</mi><mo mathsize="90%" id="S2.SS4.p2.12.m3.1.1.2.3" xref="S2.SS4.p2.12.m3.1.1.2.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S2.SS4.p2.12.m3.1.1.1" xref="S2.SS4.p2.12.m3.1.1.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p2.12.m3.1.1.3" xref="S2.SS4.p2.12.m3.1.1.3.cmml">𝑮</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.12.m3.1b"><apply id="S2.SS4.p2.12.m3.1.1.cmml" xref="S2.SS4.p2.12.m3.1.1"><times id="S2.SS4.p2.12.m3.1.1.1.cmml" xref="S2.SS4.p2.12.m3.1.1.1"></times><apply id="S2.SS4.p2.12.m3.1.1.2.cmml" xref="S2.SS4.p2.12.m3.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p2.12.m3.1.1.2.1.cmml" xref="S2.SS4.p2.12.m3.1.1.2">superscript</csymbol><ci id="S2.SS4.p2.12.m3.1.1.2.2.cmml" xref="S2.SS4.p2.12.m3.1.1.2.2">𝑮</ci><csymbol cd="latexml" id="S2.SS4.p2.12.m3.1.1.2.3.cmml" xref="S2.SS4.p2.12.m3.1.1.2.3">top</csymbol></apply><ci id="S2.SS4.p2.12.m3.1.1.3.cmml" xref="S2.SS4.p2.12.m3.1.1.3">𝑮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.12.m3.1c">{\boldsymbol{G}^{\top}}{\boldsymbol{G}}</annotation></semantics></math><span id="S2.SS4.p2.17.4" class="ltx_text" style="font-size:90%;">. In this way, we can transform the computation of SVD for </span><math id="S2.SS4.p2.13.m4.1" class="ltx_Math" alttext="\boldsymbol{G}\boldsymbol{G}^{\top}\in\mathbb{R}^{d\times d}" display="inline"><semantics id="S2.SS4.p2.13.m4.1a"><mrow id="S2.SS4.p2.13.m4.1.1" xref="S2.SS4.p2.13.m4.1.1.cmml"><mrow id="S2.SS4.p2.13.m4.1.1.2" xref="S2.SS4.p2.13.m4.1.1.2.cmml"><mi mathsize="90%" id="S2.SS4.p2.13.m4.1.1.2.2" xref="S2.SS4.p2.13.m4.1.1.2.2.cmml">𝑮</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p2.13.m4.1.1.2.1" xref="S2.SS4.p2.13.m4.1.1.2.1.cmml">​</mo><msup id="S2.SS4.p2.13.m4.1.1.2.3" xref="S2.SS4.p2.13.m4.1.1.2.3.cmml"><mi mathsize="90%" id="S2.SS4.p2.13.m4.1.1.2.3.2" xref="S2.SS4.p2.13.m4.1.1.2.3.2.cmml">𝑮</mi><mo mathsize="90%" id="S2.SS4.p2.13.m4.1.1.2.3.3" xref="S2.SS4.p2.13.m4.1.1.2.3.3.cmml">⊤</mo></msup></mrow><mo mathsize="90%" id="S2.SS4.p2.13.m4.1.1.1" xref="S2.SS4.p2.13.m4.1.1.1.cmml">∈</mo><msup id="S2.SS4.p2.13.m4.1.1.3" xref="S2.SS4.p2.13.m4.1.1.3.cmml"><mi mathsize="90%" id="S2.SS4.p2.13.m4.1.1.3.2" xref="S2.SS4.p2.13.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.p2.13.m4.1.1.3.3" xref="S2.SS4.p2.13.m4.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS4.p2.13.m4.1.1.3.3.2" xref="S2.SS4.p2.13.m4.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS4.p2.13.m4.1.1.3.3.1" xref="S2.SS4.p2.13.m4.1.1.3.3.1.cmml">×</mo><mi mathsize="90%" id="S2.SS4.p2.13.m4.1.1.3.3.3" xref="S2.SS4.p2.13.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.13.m4.1b"><apply id="S2.SS4.p2.13.m4.1.1.cmml" xref="S2.SS4.p2.13.m4.1.1"><in id="S2.SS4.p2.13.m4.1.1.1.cmml" xref="S2.SS4.p2.13.m4.1.1.1"></in><apply id="S2.SS4.p2.13.m4.1.1.2.cmml" xref="S2.SS4.p2.13.m4.1.1.2"><times id="S2.SS4.p2.13.m4.1.1.2.1.cmml" xref="S2.SS4.p2.13.m4.1.1.2.1"></times><ci id="S2.SS4.p2.13.m4.1.1.2.2.cmml" xref="S2.SS4.p2.13.m4.1.1.2.2">𝑮</ci><apply id="S2.SS4.p2.13.m4.1.1.2.3.cmml" xref="S2.SS4.p2.13.m4.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS4.p2.13.m4.1.1.2.3.1.cmml" xref="S2.SS4.p2.13.m4.1.1.2.3">superscript</csymbol><ci id="S2.SS4.p2.13.m4.1.1.2.3.2.cmml" xref="S2.SS4.p2.13.m4.1.1.2.3.2">𝑮</ci><csymbol cd="latexml" id="S2.SS4.p2.13.m4.1.1.2.3.3.cmml" xref="S2.SS4.p2.13.m4.1.1.2.3.3">top</csymbol></apply></apply><apply id="S2.SS4.p2.13.m4.1.1.3.cmml" xref="S2.SS4.p2.13.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p2.13.m4.1.1.3.1.cmml" xref="S2.SS4.p2.13.m4.1.1.3">superscript</csymbol><ci id="S2.SS4.p2.13.m4.1.1.3.2.cmml" xref="S2.SS4.p2.13.m4.1.1.3.2">ℝ</ci><apply id="S2.SS4.p2.13.m4.1.1.3.3.cmml" xref="S2.SS4.p2.13.m4.1.1.3.3"><times id="S2.SS4.p2.13.m4.1.1.3.3.1.cmml" xref="S2.SS4.p2.13.m4.1.1.3.3.1"></times><ci id="S2.SS4.p2.13.m4.1.1.3.3.2.cmml" xref="S2.SS4.p2.13.m4.1.1.3.3.2">𝑑</ci><ci id="S2.SS4.p2.13.m4.1.1.3.3.3.cmml" xref="S2.SS4.p2.13.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.13.m4.1c">\boldsymbol{G}\boldsymbol{G}^{\top}\in\mathbb{R}^{d\times d}</annotation></semantics></math><span id="S2.SS4.p2.17.5" class="ltx_text" style="font-size:90%;"> in Eq.(</span><a href="#S2.E4" title="In 2.4 Principal Gradient-based Server Aggregation ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref ltx_markedasmath ltx_font_italic" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">4</span></a><span id="S2.SS4.p2.17.6" class="ltx_text" style="font-size:90%;">) to the computation of SVD for </span><math id="S2.SS4.p2.15.m6.1" class="ltx_Math" alttext="\boldsymbol{G}^{\top}\boldsymbol{G}\in\mathbb{R}^{m\times m}" display="inline"><semantics id="S2.SS4.p2.15.m6.1a"><mrow id="S2.SS4.p2.15.m6.1.1" xref="S2.SS4.p2.15.m6.1.1.cmml"><mrow id="S2.SS4.p2.15.m6.1.1.2" xref="S2.SS4.p2.15.m6.1.1.2.cmml"><msup id="S2.SS4.p2.15.m6.1.1.2.2" xref="S2.SS4.p2.15.m6.1.1.2.2.cmml"><mi mathsize="90%" id="S2.SS4.p2.15.m6.1.1.2.2.2" xref="S2.SS4.p2.15.m6.1.1.2.2.2.cmml">𝑮</mi><mo mathsize="90%" id="S2.SS4.p2.15.m6.1.1.2.2.3" xref="S2.SS4.p2.15.m6.1.1.2.2.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S2.SS4.p2.15.m6.1.1.2.1" xref="S2.SS4.p2.15.m6.1.1.2.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p2.15.m6.1.1.2.3" xref="S2.SS4.p2.15.m6.1.1.2.3.cmml">𝑮</mi></mrow><mo mathsize="90%" id="S2.SS4.p2.15.m6.1.1.1" xref="S2.SS4.p2.15.m6.1.1.1.cmml">∈</mo><msup id="S2.SS4.p2.15.m6.1.1.3" xref="S2.SS4.p2.15.m6.1.1.3.cmml"><mi mathsize="90%" id="S2.SS4.p2.15.m6.1.1.3.2" xref="S2.SS4.p2.15.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.p2.15.m6.1.1.3.3" xref="S2.SS4.p2.15.m6.1.1.3.3.cmml"><mi mathsize="90%" id="S2.SS4.p2.15.m6.1.1.3.3.2" xref="S2.SS4.p2.15.m6.1.1.3.3.2.cmml">m</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.SS4.p2.15.m6.1.1.3.3.1" xref="S2.SS4.p2.15.m6.1.1.3.3.1.cmml">×</mo><mi mathsize="90%" id="S2.SS4.p2.15.m6.1.1.3.3.3" xref="S2.SS4.p2.15.m6.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.15.m6.1b"><apply id="S2.SS4.p2.15.m6.1.1.cmml" xref="S2.SS4.p2.15.m6.1.1"><in id="S2.SS4.p2.15.m6.1.1.1.cmml" xref="S2.SS4.p2.15.m6.1.1.1"></in><apply id="S2.SS4.p2.15.m6.1.1.2.cmml" xref="S2.SS4.p2.15.m6.1.1.2"><times id="S2.SS4.p2.15.m6.1.1.2.1.cmml" xref="S2.SS4.p2.15.m6.1.1.2.1"></times><apply id="S2.SS4.p2.15.m6.1.1.2.2.cmml" xref="S2.SS4.p2.15.m6.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS4.p2.15.m6.1.1.2.2.1.cmml" xref="S2.SS4.p2.15.m6.1.1.2.2">superscript</csymbol><ci id="S2.SS4.p2.15.m6.1.1.2.2.2.cmml" xref="S2.SS4.p2.15.m6.1.1.2.2.2">𝑮</ci><csymbol cd="latexml" id="S2.SS4.p2.15.m6.1.1.2.2.3.cmml" xref="S2.SS4.p2.15.m6.1.1.2.2.3">top</csymbol></apply><ci id="S2.SS4.p2.15.m6.1.1.2.3.cmml" xref="S2.SS4.p2.15.m6.1.1.2.3">𝑮</ci></apply><apply id="S2.SS4.p2.15.m6.1.1.3.cmml" xref="S2.SS4.p2.15.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p2.15.m6.1.1.3.1.cmml" xref="S2.SS4.p2.15.m6.1.1.3">superscript</csymbol><ci id="S2.SS4.p2.15.m6.1.1.3.2.cmml" xref="S2.SS4.p2.15.m6.1.1.3.2">ℝ</ci><apply id="S2.SS4.p2.15.m6.1.1.3.3.cmml" xref="S2.SS4.p2.15.m6.1.1.3.3"><times id="S2.SS4.p2.15.m6.1.1.3.3.1.cmml" xref="S2.SS4.p2.15.m6.1.1.3.3.1"></times><ci id="S2.SS4.p2.15.m6.1.1.3.3.2.cmml" xref="S2.SS4.p2.15.m6.1.1.3.3.2">𝑚</ci><ci id="S2.SS4.p2.15.m6.1.1.3.3.3.cmml" xref="S2.SS4.p2.15.m6.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.15.m6.1c">\boldsymbol{G}^{\top}\boldsymbol{G}\in\mathbb{R}^{m\times m}</annotation></semantics></math><span id="S2.SS4.p2.17.7" class="ltx_text" style="font-size:90%;">, which is much cheaper, as </span><math id="S2.SS4.p2.16.m7.1" class="ltx_Math" alttext="m\ll d" display="inline"><semantics id="S2.SS4.p2.16.m7.1a"><mrow id="S2.SS4.p2.16.m7.1.1" xref="S2.SS4.p2.16.m7.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p2.16.m7.1.1.2" xref="S2.SS4.p2.16.m7.1.1.2.cmml">m</mi><mo mathsize="90%" id="S2.SS4.p2.16.m7.1.1.1" xref="S2.SS4.p2.16.m7.1.1.1.cmml">≪</mo><mi mathsize="90%" id="S2.SS4.p2.16.m7.1.1.3" xref="S2.SS4.p2.16.m7.1.1.3.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.16.m7.1b"><apply id="S2.SS4.p2.16.m7.1.1.cmml" xref="S2.SS4.p2.16.m7.1.1"><csymbol cd="latexml" id="S2.SS4.p2.16.m7.1.1.1.cmml" xref="S2.SS4.p2.16.m7.1.1.1">much-less-than</csymbol><ci id="S2.SS4.p2.16.m7.1.1.2.cmml" xref="S2.SS4.p2.16.m7.1.1.2">𝑚</ci><ci id="S2.SS4.p2.16.m7.1.1.3.cmml" xref="S2.SS4.p2.16.m7.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.16.m7.1c">m\ll d</annotation></semantics></math><span id="S2.SS4.p2.17.8" class="ltx_text" style="font-size:90%;">. After performing SVD in Eq.(</span><a href="#S2.E5" title="In 2.4 Principal Gradient-based Server Aggregation ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">5</span></a><span id="S2.SS4.p2.17.9" class="ltx_text" style="font-size:90%;">), we obtain a set of eigenvectors </span><math id="S2.SS4.p2.17.m8.3" class="ltx_Math" alttext="\boldsymbol{V}=\{\boldsymbol{v}_{1},\cdots,\boldsymbol{v}_{m}\}" display="inline"><semantics id="S2.SS4.p2.17.m8.3a"><mrow id="S2.SS4.p2.17.m8.3.3" xref="S2.SS4.p2.17.m8.3.3.cmml"><mi mathsize="90%" id="S2.SS4.p2.17.m8.3.3.4" xref="S2.SS4.p2.17.m8.3.3.4.cmml">𝑽</mi><mo mathsize="90%" id="S2.SS4.p2.17.m8.3.3.3" xref="S2.SS4.p2.17.m8.3.3.3.cmml">=</mo><mrow id="S2.SS4.p2.17.m8.3.3.2.2" xref="S2.SS4.p2.17.m8.3.3.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS4.p2.17.m8.3.3.2.2.3" xref="S2.SS4.p2.17.m8.3.3.2.3.cmml">{</mo><msub id="S2.SS4.p2.17.m8.2.2.1.1.1" xref="S2.SS4.p2.17.m8.2.2.1.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p2.17.m8.2.2.1.1.1.2" xref="S2.SS4.p2.17.m8.2.2.1.1.1.2.cmml">𝒗</mi><mn mathsize="90%" id="S2.SS4.p2.17.m8.2.2.1.1.1.3" xref="S2.SS4.p2.17.m8.2.2.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S2.SS4.p2.17.m8.3.3.2.2.4" xref="S2.SS4.p2.17.m8.3.3.2.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.SS4.p2.17.m8.1.1" xref="S2.SS4.p2.17.m8.1.1.cmml">⋯</mi><mo mathsize="90%" id="S2.SS4.p2.17.m8.3.3.2.2.5" xref="S2.SS4.p2.17.m8.3.3.2.3.cmml">,</mo><msub id="S2.SS4.p2.17.m8.3.3.2.2.2" xref="S2.SS4.p2.17.m8.3.3.2.2.2.cmml"><mi mathsize="90%" id="S2.SS4.p2.17.m8.3.3.2.2.2.2" xref="S2.SS4.p2.17.m8.3.3.2.2.2.2.cmml">𝒗</mi><mi mathsize="90%" id="S2.SS4.p2.17.m8.3.3.2.2.2.3" xref="S2.SS4.p2.17.m8.3.3.2.2.2.3.cmml">m</mi></msub><mo maxsize="90%" minsize="90%" id="S2.SS4.p2.17.m8.3.3.2.2.6" xref="S2.SS4.p2.17.m8.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.17.m8.3b"><apply id="S2.SS4.p2.17.m8.3.3.cmml" xref="S2.SS4.p2.17.m8.3.3"><eq id="S2.SS4.p2.17.m8.3.3.3.cmml" xref="S2.SS4.p2.17.m8.3.3.3"></eq><ci id="S2.SS4.p2.17.m8.3.3.4.cmml" xref="S2.SS4.p2.17.m8.3.3.4">𝑽</ci><set id="S2.SS4.p2.17.m8.3.3.2.3.cmml" xref="S2.SS4.p2.17.m8.3.3.2.2"><apply id="S2.SS4.p2.17.m8.2.2.1.1.1.cmml" xref="S2.SS4.p2.17.m8.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.17.m8.2.2.1.1.1.1.cmml" xref="S2.SS4.p2.17.m8.2.2.1.1.1">subscript</csymbol><ci id="S2.SS4.p2.17.m8.2.2.1.1.1.2.cmml" xref="S2.SS4.p2.17.m8.2.2.1.1.1.2">𝒗</ci><cn type="integer" id="S2.SS4.p2.17.m8.2.2.1.1.1.3.cmml" xref="S2.SS4.p2.17.m8.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS4.p2.17.m8.1.1.cmml" xref="S2.SS4.p2.17.m8.1.1">⋯</ci><apply id="S2.SS4.p2.17.m8.3.3.2.2.2.cmml" xref="S2.SS4.p2.17.m8.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p2.17.m8.3.3.2.2.2.1.cmml" xref="S2.SS4.p2.17.m8.3.3.2.2.2">subscript</csymbol><ci id="S2.SS4.p2.17.m8.3.3.2.2.2.2.cmml" xref="S2.SS4.p2.17.m8.3.3.2.2.2.2">𝒗</ci><ci id="S2.SS4.p2.17.m8.3.3.2.2.2.3.cmml" xref="S2.SS4.p2.17.m8.3.3.2.2.2.3">𝑚</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.17.m8.3c">\boldsymbol{V}=\{\boldsymbol{v}_{1},\cdots,\boldsymbol{v}_{m}\}</annotation></semantics></math><span id="S2.SS4.p2.17.10" class="ltx_text" style="font-size:90%;"> and consider them as the principal gradients.</span></p>
</div>
<div id="S2.SS4.p3" class="ltx_para ltx_noindent">
<p id="S2.SS4.p3.2" class="ltx_p"><span id="S2.SS4.p3.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Step 2: Local Gradients Revision based on Calibrated Principal Gradients.</span><span id="S2.SS4.p3.2.2" class="ltx_text" style="font-size:90%;"> These eigenvectors are ordered based on the magnitude of the eigenvalues and are unoriented, since a negative multiple of an eigenvector is also a valid eigenvector. However, we need to determine the directions of these eigenvectors so that they point to the directions that can reduce the loss. For simplicity, we use the mean of local gradients </span><math id="S2.SS4.p3.1.m1.1" class="ltx_Math" alttext="\hat{\boldsymbol{g}}=\frac{1}{m}\sum_{i}\boldsymbol{g}_{i}" display="inline"><semantics id="S2.SS4.p3.1.m1.1a"><mrow id="S2.SS4.p3.1.m1.1.1" xref="S2.SS4.p3.1.m1.1.1.cmml"><mover accent="true" id="S2.SS4.p3.1.m1.1.1.2" xref="S2.SS4.p3.1.m1.1.1.2.cmml"><mi mathsize="90%" id="S2.SS4.p3.1.m1.1.1.2.2" xref="S2.SS4.p3.1.m1.1.1.2.2.cmml">𝒈</mi><mo mathsize="90%" id="S2.SS4.p3.1.m1.1.1.2.1" xref="S2.SS4.p3.1.m1.1.1.2.1.cmml">^</mo></mover><mo mathsize="90%" id="S2.SS4.p3.1.m1.1.1.1" xref="S2.SS4.p3.1.m1.1.1.1.cmml">=</mo><mrow id="S2.SS4.p3.1.m1.1.1.3" xref="S2.SS4.p3.1.m1.1.1.3.cmml"><mfrac id="S2.SS4.p3.1.m1.1.1.3.2" xref="S2.SS4.p3.1.m1.1.1.3.2.cmml"><mn mathsize="90%" id="S2.SS4.p3.1.m1.1.1.3.2.2" xref="S2.SS4.p3.1.m1.1.1.3.2.2.cmml">1</mn><mi mathsize="90%" id="S2.SS4.p3.1.m1.1.1.3.2.3" xref="S2.SS4.p3.1.m1.1.1.3.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.SS4.p3.1.m1.1.1.3.1" xref="S2.SS4.p3.1.m1.1.1.3.1.cmml">​</mo><mrow id="S2.SS4.p3.1.m1.1.1.3.3" xref="S2.SS4.p3.1.m1.1.1.3.3.cmml"><msub id="S2.SS4.p3.1.m1.1.1.3.3.1" xref="S2.SS4.p3.1.m1.1.1.3.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="S2.SS4.p3.1.m1.1.1.3.3.1.2" xref="S2.SS4.p3.1.m1.1.1.3.3.1.2.cmml">∑</mo><mi mathsize="90%" id="S2.SS4.p3.1.m1.1.1.3.3.1.3" xref="S2.SS4.p3.1.m1.1.1.3.3.1.3.cmml">i</mi></msub><msub id="S2.SS4.p3.1.m1.1.1.3.3.2" xref="S2.SS4.p3.1.m1.1.1.3.3.2.cmml"><mi mathsize="90%" id="S2.SS4.p3.1.m1.1.1.3.3.2.2" xref="S2.SS4.p3.1.m1.1.1.3.3.2.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.SS4.p3.1.m1.1.1.3.3.2.3" xref="S2.SS4.p3.1.m1.1.1.3.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.1.m1.1b"><apply id="S2.SS4.p3.1.m1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1"><eq id="S2.SS4.p3.1.m1.1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1.1"></eq><apply id="S2.SS4.p3.1.m1.1.1.2.cmml" xref="S2.SS4.p3.1.m1.1.1.2"><ci id="S2.SS4.p3.1.m1.1.1.2.1.cmml" xref="S2.SS4.p3.1.m1.1.1.2.1">^</ci><ci id="S2.SS4.p3.1.m1.1.1.2.2.cmml" xref="S2.SS4.p3.1.m1.1.1.2.2">𝒈</ci></apply><apply id="S2.SS4.p3.1.m1.1.1.3.cmml" xref="S2.SS4.p3.1.m1.1.1.3"><times id="S2.SS4.p3.1.m1.1.1.3.1.cmml" xref="S2.SS4.p3.1.m1.1.1.3.1"></times><apply id="S2.SS4.p3.1.m1.1.1.3.2.cmml" xref="S2.SS4.p3.1.m1.1.1.3.2"><divide id="S2.SS4.p3.1.m1.1.1.3.2.1.cmml" xref="S2.SS4.p3.1.m1.1.1.3.2"></divide><cn type="integer" id="S2.SS4.p3.1.m1.1.1.3.2.2.cmml" xref="S2.SS4.p3.1.m1.1.1.3.2.2">1</cn><ci id="S2.SS4.p3.1.m1.1.1.3.2.3.cmml" xref="S2.SS4.p3.1.m1.1.1.3.2.3">𝑚</ci></apply><apply id="S2.SS4.p3.1.m1.1.1.3.3.cmml" xref="S2.SS4.p3.1.m1.1.1.3.3"><apply id="S2.SS4.p3.1.m1.1.1.3.3.1.cmml" xref="S2.SS4.p3.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.1.1.3.3.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1.3.3.1">subscript</csymbol><sum id="S2.SS4.p3.1.m1.1.1.3.3.1.2.cmml" xref="S2.SS4.p3.1.m1.1.1.3.3.1.2"></sum><ci id="S2.SS4.p3.1.m1.1.1.3.3.1.3.cmml" xref="S2.SS4.p3.1.m1.1.1.3.3.1.3">𝑖</ci></apply><apply id="S2.SS4.p3.1.m1.1.1.3.3.2.cmml" xref="S2.SS4.p3.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.1.1.3.3.2.1.cmml" xref="S2.SS4.p3.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S2.SS4.p3.1.m1.1.1.3.3.2.2.cmml" xref="S2.SS4.p3.1.m1.1.1.3.3.2.2">𝒈</ci><ci id="S2.SS4.p3.1.m1.1.1.3.3.2.3.cmml" xref="S2.SS4.p3.1.m1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.1.m1.1c">\hat{\boldsymbol{g}}=\frac{1}{m}\sum_{i}\boldsymbol{g}_{i}</annotation></semantics></math><span id="S2.SS4.p3.2.3" class="ltx_text" style="font-size:90%;"> as a reference for calibrating the principal gradient direction. Specifically, we adjust the </span><math id="S2.SS4.p3.2.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S2.SS4.p3.2.m2.1a"><mi mathsize="90%" id="S2.SS4.p3.2.m2.1.1" xref="S2.SS4.p3.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.2.m2.1b"><ci id="S2.SS4.p3.2.m2.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.2.m2.1c">z</annotation></semantics></math><span id="S2.SS4.p3.2.4" class="ltx_text" style="font-size:90%;">-th largest oriented eigenvector to be positively related to the reference by following the calibration process:</span></p>
<table id="S2.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E6.m1.5" class="ltx_Math" alttext="\bar{\boldsymbol{v}}_{z}=\begin{cases}\boldsymbol{v}_{z},&amp;\text{ if }\left\langle\boldsymbol{v}_{z},\hat{\boldsymbol{g}}\right\rangle\geq 0\\
-\boldsymbol{v}_{z},&amp;\text{ otherwise }\end{cases}." display="block"><semantics id="S2.E6.m1.5a"><mrow id="S2.E6.m1.5.5.1" xref="S2.E6.m1.5.5.1.1.cmml"><mrow id="S2.E6.m1.5.5.1.1" xref="S2.E6.m1.5.5.1.1.cmml"><msub id="S2.E6.m1.5.5.1.1.2" xref="S2.E6.m1.5.5.1.1.2.cmml"><mover accent="true" id="S2.E6.m1.5.5.1.1.2.2" xref="S2.E6.m1.5.5.1.1.2.2.cmml"><mi mathsize="90%" id="S2.E6.m1.5.5.1.1.2.2.2" xref="S2.E6.m1.5.5.1.1.2.2.2.cmml">𝒗</mi><mo mathsize="90%" id="S2.E6.m1.5.5.1.1.2.2.1" xref="S2.E6.m1.5.5.1.1.2.2.1.cmml">¯</mo></mover><mi mathsize="90%" id="S2.E6.m1.5.5.1.1.2.3" xref="S2.E6.m1.5.5.1.1.2.3.cmml">z</mi></msub><mo mathsize="90%" id="S2.E6.m1.5.5.1.1.1" xref="S2.E6.m1.5.5.1.1.1.cmml">=</mo><mrow id="S2.E6.m1.4.4" xref="S2.E6.m1.5.5.1.1.3.1.cmml"><mo id="S2.E6.m1.4.4.5" xref="S2.E6.m1.5.5.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S2.E6.m1.4.4.4" xref="S2.E6.m1.5.5.1.1.3.1.cmml"><mtr id="S2.E6.m1.4.4.4a" xref="S2.E6.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E6.m1.4.4.4b" xref="S2.E6.m1.5.5.1.1.3.1.cmml"><mrow id="S2.E6.m1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E6.m1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E6.m1.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.cmml">𝒗</mi><mi mathsize="90%" id="S2.E6.m1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.1.1.3.cmml">z</mi></msub><mo mathsize="90%" id="S2.E6.m1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E6.m1.4.4.4c" xref="S2.E6.m1.5.5.1.1.3.1.cmml"><mrow id="S2.E6.m1.2.2.2.2.2.1" xref="S2.E6.m1.2.2.2.2.2.1.cmml"><mrow id="S2.E6.m1.2.2.2.2.2.1.2" xref="S2.E6.m1.2.2.2.2.2.1.2.cmml"><mtext mathsize="90%" id="S2.E6.m1.2.2.2.2.2.1.2.3" xref="S2.E6.m1.2.2.2.2.2.1.2.3a.cmml"> if </mtext><mo lspace="0em" rspace="0em" id="S2.E6.m1.2.2.2.2.2.1.2.2" xref="S2.E6.m1.2.2.2.2.2.1.2.2.cmml">​</mo><mrow id="S2.E6.m1.2.2.2.2.2.1.2.1.1" xref="S2.E6.m1.2.2.2.2.2.1.2.1.2.cmml"><mo id="S2.E6.m1.2.2.2.2.2.1.2.1.1.2" xref="S2.E6.m1.2.2.2.2.2.1.2.1.2.cmml">⟨</mo><msub id="S2.E6.m1.2.2.2.2.2.1.2.1.1.1" xref="S2.E6.m1.2.2.2.2.2.1.2.1.1.1.cmml"><mi mathsize="90%" id="S2.E6.m1.2.2.2.2.2.1.2.1.1.1.2" xref="S2.E6.m1.2.2.2.2.2.1.2.1.1.1.2.cmml">𝒗</mi><mi mathsize="90%" id="S2.E6.m1.2.2.2.2.2.1.2.1.1.1.3" xref="S2.E6.m1.2.2.2.2.2.1.2.1.1.1.3.cmml">z</mi></msub><mo mathsize="90%" id="S2.E6.m1.2.2.2.2.2.1.2.1.1.3" xref="S2.E6.m1.2.2.2.2.2.1.2.1.2.cmml">,</mo><mover accent="true" id="S2.E6.m1.2.2.2.2.2.1.1" xref="S2.E6.m1.2.2.2.2.2.1.1.cmml"><mi mathsize="90%" id="S2.E6.m1.2.2.2.2.2.1.1.2" xref="S2.E6.m1.2.2.2.2.2.1.1.2.cmml">𝒈</mi><mo mathsize="90%" id="S2.E6.m1.2.2.2.2.2.1.1.1" xref="S2.E6.m1.2.2.2.2.2.1.1.1.cmml">^</mo></mover><mo id="S2.E6.m1.2.2.2.2.2.1.2.1.1.4" xref="S2.E6.m1.2.2.2.2.2.1.2.1.2.cmml">⟩</mo></mrow></mrow><mo mathsize="90%" id="S2.E6.m1.2.2.2.2.2.1.3" xref="S2.E6.m1.2.2.2.2.2.1.3.cmml">≥</mo><mn mathsize="90%" id="S2.E6.m1.2.2.2.2.2.1.4" xref="S2.E6.m1.2.2.2.2.2.1.4.cmml">0</mn></mrow></mtd></mtr><mtr id="S2.E6.m1.4.4.4d" xref="S2.E6.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E6.m1.4.4.4e" xref="S2.E6.m1.5.5.1.1.3.1.cmml"><mrow id="S2.E6.m1.3.3.3.3.1.1.1" xref="S2.E6.m1.3.3.3.3.1.1.1.1.cmml"><mrow id="S2.E6.m1.3.3.3.3.1.1.1.1" xref="S2.E6.m1.3.3.3.3.1.1.1.1.cmml"><mo mathsize="90%" id="S2.E6.m1.3.3.3.3.1.1.1.1a" xref="S2.E6.m1.3.3.3.3.1.1.1.1.cmml">−</mo><msub id="S2.E6.m1.3.3.3.3.1.1.1.1.2" xref="S2.E6.m1.3.3.3.3.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.E6.m1.3.3.3.3.1.1.1.1.2.2" xref="S2.E6.m1.3.3.3.3.1.1.1.1.2.2.cmml">𝒗</mi><mi mathsize="90%" id="S2.E6.m1.3.3.3.3.1.1.1.1.2.3" xref="S2.E6.m1.3.3.3.3.1.1.1.1.2.3.cmml">z</mi></msub></mrow><mo mathsize="90%" id="S2.E6.m1.3.3.3.3.1.1.1.2" xref="S2.E6.m1.3.3.3.3.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E6.m1.4.4.4f" xref="S2.E6.m1.5.5.1.1.3.1.cmml"><mtext mathsize="90%" id="S2.E6.m1.4.4.4.4.2.1" xref="S2.E6.m1.4.4.4.4.2.1a.cmml"> otherwise </mtext></mtd></mtr></mtable></mrow></mrow><mo lspace="0em" mathsize="90%" id="S2.E6.m1.5.5.1.2" xref="S2.E6.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.5b"><apply id="S2.E6.m1.5.5.1.1.cmml" xref="S2.E6.m1.5.5.1"><eq id="S2.E6.m1.5.5.1.1.1.cmml" xref="S2.E6.m1.5.5.1.1.1"></eq><apply id="S2.E6.m1.5.5.1.1.2.cmml" xref="S2.E6.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.5.5.1.1.2.1.cmml" xref="S2.E6.m1.5.5.1.1.2">subscript</csymbol><apply id="S2.E6.m1.5.5.1.1.2.2.cmml" xref="S2.E6.m1.5.5.1.1.2.2"><ci id="S2.E6.m1.5.5.1.1.2.2.1.cmml" xref="S2.E6.m1.5.5.1.1.2.2.1">¯</ci><ci id="S2.E6.m1.5.5.1.1.2.2.2.cmml" xref="S2.E6.m1.5.5.1.1.2.2.2">𝒗</ci></apply><ci id="S2.E6.m1.5.5.1.1.2.3.cmml" xref="S2.E6.m1.5.5.1.1.2.3">𝑧</ci></apply><apply id="S2.E6.m1.5.5.1.1.3.1.cmml" xref="S2.E6.m1.4.4"><csymbol cd="latexml" id="S2.E6.m1.5.5.1.1.3.1.1.cmml" xref="S2.E6.m1.4.4.5">cases</csymbol><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2">𝒗</ci><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.3">𝑧</ci></apply><apply id="S2.E6.m1.2.2.2.2.2.1.cmml" xref="S2.E6.m1.2.2.2.2.2.1"><geq id="S2.E6.m1.2.2.2.2.2.1.3.cmml" xref="S2.E6.m1.2.2.2.2.2.1.3"></geq><apply id="S2.E6.m1.2.2.2.2.2.1.2.cmml" xref="S2.E6.m1.2.2.2.2.2.1.2"><times id="S2.E6.m1.2.2.2.2.2.1.2.2.cmml" xref="S2.E6.m1.2.2.2.2.2.1.2.2"></times><ci id="S2.E6.m1.2.2.2.2.2.1.2.3a.cmml" xref="S2.E6.m1.2.2.2.2.2.1.2.3"><mtext mathsize="90%" id="S2.E6.m1.2.2.2.2.2.1.2.3.cmml" xref="S2.E6.m1.2.2.2.2.2.1.2.3"> if </mtext></ci><list id="S2.E6.m1.2.2.2.2.2.1.2.1.2.cmml" xref="S2.E6.m1.2.2.2.2.2.1.2.1.1"><apply id="S2.E6.m1.2.2.2.2.2.1.2.1.1.1.cmml" xref="S2.E6.m1.2.2.2.2.2.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.2.2.1.2.1.1.1.1.cmml" xref="S2.E6.m1.2.2.2.2.2.1.2.1.1.1">subscript</csymbol><ci id="S2.E6.m1.2.2.2.2.2.1.2.1.1.1.2.cmml" xref="S2.E6.m1.2.2.2.2.2.1.2.1.1.1.2">𝒗</ci><ci id="S2.E6.m1.2.2.2.2.2.1.2.1.1.1.3.cmml" xref="S2.E6.m1.2.2.2.2.2.1.2.1.1.1.3">𝑧</ci></apply><apply id="S2.E6.m1.2.2.2.2.2.1.1.cmml" xref="S2.E6.m1.2.2.2.2.2.1.1"><ci id="S2.E6.m1.2.2.2.2.2.1.1.1.cmml" xref="S2.E6.m1.2.2.2.2.2.1.1.1">^</ci><ci id="S2.E6.m1.2.2.2.2.2.1.1.2.cmml" xref="S2.E6.m1.2.2.2.2.2.1.1.2">𝒈</ci></apply></list></apply><cn type="integer" id="S2.E6.m1.2.2.2.2.2.1.4.cmml" xref="S2.E6.m1.2.2.2.2.2.1.4">0</cn></apply><apply id="S2.E6.m1.3.3.3.3.1.1.1.1.cmml" xref="S2.E6.m1.3.3.3.3.1.1.1"><minus id="S2.E6.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.3.3.1.1.1"></minus><apply id="S2.E6.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="S2.E6.m1.3.3.3.3.1.1.1.1.2">subscript</csymbol><ci id="S2.E6.m1.3.3.3.3.1.1.1.1.2.2.cmml" xref="S2.E6.m1.3.3.3.3.1.1.1.1.2.2">𝒗</ci><ci id="S2.E6.m1.3.3.3.3.1.1.1.1.2.3.cmml" xref="S2.E6.m1.3.3.3.3.1.1.1.1.2.3">𝑧</ci></apply></apply><ci id="S2.E6.m1.4.4.4.4.2.1a.cmml" xref="S2.E6.m1.4.4.4.4.2.1"><mtext mathsize="90%" id="S2.E6.m1.4.4.4.4.2.1.cmml" xref="S2.E6.m1.4.4.4.4.2.1"> otherwise </mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.5c">\bar{\boldsymbol{v}}_{z}=\begin{cases}\boldsymbol{v}_{z},&amp;\text{ if }\left\langle\boldsymbol{v}_{z},\hat{\boldsymbol{g}}\right\rangle\geq 0\\
-\boldsymbol{v}_{z},&amp;\text{ otherwise }\end{cases}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS4.p4" class="ltx_para">
<p id="S2.SS4.p4.11" class="ltx_p"><span id="S2.SS4.p4.11.1" class="ltx_text" style="font-size:90%;">Next, we select the eigenvectors with the top </span><math id="S2.SS4.p4.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.SS4.p4.1.m1.1a"><mi mathsize="90%" id="S2.SS4.p4.1.m1.1.1" xref="S2.SS4.p4.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.1.m1.1b"><ci id="S2.SS4.p4.1.m1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.1.m1.1c">L</annotation></semantics></math><span id="S2.SS4.p4.11.2" class="ltx_text" style="font-size:90%;"> largest eigenvalues, i.e. </span><math id="S2.SS4.p4.2.m2.3" class="ltx_Math" alttext="\{\bar{\boldsymbol{v}}_{1},\cdots,\bar{\boldsymbol{v}}_{L}\}" display="inline"><semantics id="S2.SS4.p4.2.m2.3a"><mrow id="S2.SS4.p4.2.m2.3.3.2" xref="S2.SS4.p4.2.m2.3.3.3.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS4.p4.2.m2.3.3.2.3" xref="S2.SS4.p4.2.m2.3.3.3.cmml">{</mo><msub id="S2.SS4.p4.2.m2.2.2.1.1" xref="S2.SS4.p4.2.m2.2.2.1.1.cmml"><mover accent="true" id="S2.SS4.p4.2.m2.2.2.1.1.2" xref="S2.SS4.p4.2.m2.2.2.1.1.2.cmml"><mi mathsize="90%" id="S2.SS4.p4.2.m2.2.2.1.1.2.2" xref="S2.SS4.p4.2.m2.2.2.1.1.2.2.cmml">𝒗</mi><mo mathsize="90%" id="S2.SS4.p4.2.m2.2.2.1.1.2.1" xref="S2.SS4.p4.2.m2.2.2.1.1.2.1.cmml">¯</mo></mover><mn mathsize="90%" id="S2.SS4.p4.2.m2.2.2.1.1.3" xref="S2.SS4.p4.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S2.SS4.p4.2.m2.3.3.2.4" xref="S2.SS4.p4.2.m2.3.3.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.SS4.p4.2.m2.1.1" xref="S2.SS4.p4.2.m2.1.1.cmml">⋯</mi><mo mathsize="90%" id="S2.SS4.p4.2.m2.3.3.2.5" xref="S2.SS4.p4.2.m2.3.3.3.cmml">,</mo><msub id="S2.SS4.p4.2.m2.3.3.2.2" xref="S2.SS4.p4.2.m2.3.3.2.2.cmml"><mover accent="true" id="S2.SS4.p4.2.m2.3.3.2.2.2" xref="S2.SS4.p4.2.m2.3.3.2.2.2.cmml"><mi mathsize="90%" id="S2.SS4.p4.2.m2.3.3.2.2.2.2" xref="S2.SS4.p4.2.m2.3.3.2.2.2.2.cmml">𝒗</mi><mo mathsize="90%" id="S2.SS4.p4.2.m2.3.3.2.2.2.1" xref="S2.SS4.p4.2.m2.3.3.2.2.2.1.cmml">¯</mo></mover><mi mathsize="90%" id="S2.SS4.p4.2.m2.3.3.2.2.3" xref="S2.SS4.p4.2.m2.3.3.2.2.3.cmml">L</mi></msub><mo maxsize="90%" minsize="90%" id="S2.SS4.p4.2.m2.3.3.2.6" xref="S2.SS4.p4.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.2.m2.3b"><set id="S2.SS4.p4.2.m2.3.3.3.cmml" xref="S2.SS4.p4.2.m2.3.3.2"><apply id="S2.SS4.p4.2.m2.2.2.1.1.cmml" xref="S2.SS4.p4.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.2.m2.2.2.1.1.1.cmml" xref="S2.SS4.p4.2.m2.2.2.1.1">subscript</csymbol><apply id="S2.SS4.p4.2.m2.2.2.1.1.2.cmml" xref="S2.SS4.p4.2.m2.2.2.1.1.2"><ci id="S2.SS4.p4.2.m2.2.2.1.1.2.1.cmml" xref="S2.SS4.p4.2.m2.2.2.1.1.2.1">¯</ci><ci id="S2.SS4.p4.2.m2.2.2.1.1.2.2.cmml" xref="S2.SS4.p4.2.m2.2.2.1.1.2.2">𝒗</ci></apply><cn type="integer" id="S2.SS4.p4.2.m2.2.2.1.1.3.cmml" xref="S2.SS4.p4.2.m2.2.2.1.1.3">1</cn></apply><ci id="S2.SS4.p4.2.m2.1.1.cmml" xref="S2.SS4.p4.2.m2.1.1">⋯</ci><apply id="S2.SS4.p4.2.m2.3.3.2.2.cmml" xref="S2.SS4.p4.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS4.p4.2.m2.3.3.2.2.1.cmml" xref="S2.SS4.p4.2.m2.3.3.2.2">subscript</csymbol><apply id="S2.SS4.p4.2.m2.3.3.2.2.2.cmml" xref="S2.SS4.p4.2.m2.3.3.2.2.2"><ci id="S2.SS4.p4.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS4.p4.2.m2.3.3.2.2.2.1">¯</ci><ci id="S2.SS4.p4.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS4.p4.2.m2.3.3.2.2.2.2">𝒗</ci></apply><ci id="S2.SS4.p4.2.m2.3.3.2.2.3.cmml" xref="S2.SS4.p4.2.m2.3.3.2.2.3">𝐿</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.2.m2.3c">\{\bar{\boldsymbol{v}}_{1},\cdots,\bar{\boldsymbol{v}}_{L}\}</annotation></semantics></math><span id="S2.SS4.p4.11.3" class="ltx_text" style="font-size:90%;">, to form the principal coordinate system for local gradient projection. For each client </span><math id="S2.SS4.p4.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS4.p4.3.m3.1a"><mi mathsize="90%" id="S2.SS4.p4.3.m3.1.1" xref="S2.SS4.p4.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.3.m3.1b"><ci id="S2.SS4.p4.3.m3.1.1.cmml" xref="S2.SS4.p4.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.3.m3.1c">i</annotation></semantics></math><span id="S2.SS4.p4.11.4" class="ltx_text" style="font-size:90%;">, we project its local gradient </span><math id="S2.SS4.p4.4.m4.1" class="ltx_Math" alttext="\boldsymbol{g}_{i}" display="inline"><semantics id="S2.SS4.p4.4.m4.1a"><msub id="S2.SS4.p4.4.m4.1.1" xref="S2.SS4.p4.4.m4.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p4.4.m4.1.1.2" xref="S2.SS4.p4.4.m4.1.1.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.SS4.p4.4.m4.1.1.3" xref="S2.SS4.p4.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.4.m4.1b"><apply id="S2.SS4.p4.4.m4.1.1.cmml" xref="S2.SS4.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.4.m4.1.1.1.cmml" xref="S2.SS4.p4.4.m4.1.1">subscript</csymbol><ci id="S2.SS4.p4.4.m4.1.1.2.cmml" xref="S2.SS4.p4.4.m4.1.1.2">𝒈</ci><ci id="S2.SS4.p4.4.m4.1.1.3.cmml" xref="S2.SS4.p4.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.4.m4.1c">\boldsymbol{g}_{i}</annotation></semantics></math><span id="S2.SS4.p4.11.5" class="ltx_text" style="font-size:90%;"> onto this principal coordinate system, with the projection of </span><math id="S2.SS4.p4.5.m5.1" class="ltx_Math" alttext="\boldsymbol{g}_{i}" display="inline"><semantics id="S2.SS4.p4.5.m5.1a"><msub id="S2.SS4.p4.5.m5.1.1" xref="S2.SS4.p4.5.m5.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p4.5.m5.1.1.2" xref="S2.SS4.p4.5.m5.1.1.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.SS4.p4.5.m5.1.1.3" xref="S2.SS4.p4.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.5.m5.1b"><apply id="S2.SS4.p4.5.m5.1.1.cmml" xref="S2.SS4.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.5.m5.1.1.1.cmml" xref="S2.SS4.p4.5.m5.1.1">subscript</csymbol><ci id="S2.SS4.p4.5.m5.1.1.2.cmml" xref="S2.SS4.p4.5.m5.1.1.2">𝒈</ci><ci id="S2.SS4.p4.5.m5.1.1.3.cmml" xref="S2.SS4.p4.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.5.m5.1c">\boldsymbol{g}_{i}</annotation></semantics></math><span id="S2.SS4.p4.11.6" class="ltx_text" style="font-size:90%;"> on the </span><math id="S2.SS4.p4.6.m6.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS4.p4.6.m6.1a"><mi mathsize="90%" id="S2.SS4.p4.6.m6.1.1" xref="S2.SS4.p4.6.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.6.m6.1b"><ci id="S2.SS4.p4.6.m6.1.1.cmml" xref="S2.SS4.p4.6.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.6.m6.1c">l</annotation></semantics></math><span id="S2.SS4.p4.11.7" class="ltx_text" style="font-size:90%;">-th eigenvector (axis) is calculated as
</span><math id="S2.SS4.p4.7.m7.5" class="ltx_Math" alttext="\boldsymbol{g}_{i,l}^{\prime}=\frac{\boldsymbol{g}_{i}\bar{\boldsymbol{v}}_{l}}{\left\|\bar{\boldsymbol{v}}_{l}\right\|\left\|\bar{\boldsymbol{v}}_{l}\right\|}\bar{\boldsymbol{v}}_{l}." display="inline"><semantics id="S2.SS4.p4.7.m7.5a"><mrow id="S2.SS4.p4.7.m7.5.5.1" xref="S2.SS4.p4.7.m7.5.5.1.1.cmml"><mrow id="S2.SS4.p4.7.m7.5.5.1.1" xref="S2.SS4.p4.7.m7.5.5.1.1.cmml"><msubsup id="S2.SS4.p4.7.m7.5.5.1.1.2" xref="S2.SS4.p4.7.m7.5.5.1.1.2.cmml"><mi mathsize="90%" id="S2.SS4.p4.7.m7.5.5.1.1.2.2.2" xref="S2.SS4.p4.7.m7.5.5.1.1.2.2.2.cmml">𝒈</mi><mrow id="S2.SS4.p4.7.m7.2.2.2.4" xref="S2.SS4.p4.7.m7.2.2.2.3.cmml"><mi mathsize="90%" id="S2.SS4.p4.7.m7.1.1.1.1" xref="S2.SS4.p4.7.m7.1.1.1.1.cmml">i</mi><mo mathsize="90%" id="S2.SS4.p4.7.m7.2.2.2.4.1" xref="S2.SS4.p4.7.m7.2.2.2.3.cmml">,</mo><mi mathsize="90%" id="S2.SS4.p4.7.m7.2.2.2.2" xref="S2.SS4.p4.7.m7.2.2.2.2.cmml">l</mi></mrow><mo mathsize="90%" id="S2.SS4.p4.7.m7.5.5.1.1.2.3" xref="S2.SS4.p4.7.m7.5.5.1.1.2.3.cmml">′</mo></msubsup><mo mathsize="90%" id="S2.SS4.p4.7.m7.5.5.1.1.1" xref="S2.SS4.p4.7.m7.5.5.1.1.1.cmml">=</mo><mrow id="S2.SS4.p4.7.m7.5.5.1.1.3" xref="S2.SS4.p4.7.m7.5.5.1.1.3.cmml"><mfrac id="S2.SS4.p4.7.m7.4.4" xref="S2.SS4.p4.7.m7.4.4.cmml"><mrow id="S2.SS4.p4.7.m7.4.4.4" xref="S2.SS4.p4.7.m7.4.4.4.cmml"><msub id="S2.SS4.p4.7.m7.4.4.4.2" xref="S2.SS4.p4.7.m7.4.4.4.2.cmml"><mi mathsize="90%" id="S2.SS4.p4.7.m7.4.4.4.2.2" xref="S2.SS4.p4.7.m7.4.4.4.2.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.SS4.p4.7.m7.4.4.4.2.3" xref="S2.SS4.p4.7.m7.4.4.4.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS4.p4.7.m7.4.4.4.1" xref="S2.SS4.p4.7.m7.4.4.4.1.cmml">​</mo><msub id="S2.SS4.p4.7.m7.4.4.4.3" xref="S2.SS4.p4.7.m7.4.4.4.3.cmml"><mover accent="true" id="S2.SS4.p4.7.m7.4.4.4.3.2" xref="S2.SS4.p4.7.m7.4.4.4.3.2.cmml"><mi mathsize="90%" id="S2.SS4.p4.7.m7.4.4.4.3.2.2" xref="S2.SS4.p4.7.m7.4.4.4.3.2.2.cmml">𝒗</mi><mo mathsize="90%" id="S2.SS4.p4.7.m7.4.4.4.3.2.1" xref="S2.SS4.p4.7.m7.4.4.4.3.2.1.cmml">¯</mo></mover><mi mathsize="90%" id="S2.SS4.p4.7.m7.4.4.4.3.3" xref="S2.SS4.p4.7.m7.4.4.4.3.3.cmml">l</mi></msub></mrow><mrow id="S2.SS4.p4.7.m7.4.4.2" xref="S2.SS4.p4.7.m7.4.4.2.cmml"><mrow id="S2.SS4.p4.7.m7.3.3.1.1.1" xref="S2.SS4.p4.7.m7.3.3.1.1.2.cmml"><mo id="S2.SS4.p4.7.m7.3.3.1.1.1.2" xref="S2.SS4.p4.7.m7.3.3.1.1.2.1.cmml">‖</mo><msub id="S2.SS4.p4.7.m7.3.3.1.1.1.1" xref="S2.SS4.p4.7.m7.3.3.1.1.1.1.cmml"><mover accent="true" id="S2.SS4.p4.7.m7.3.3.1.1.1.1.2" xref="S2.SS4.p4.7.m7.3.3.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.SS4.p4.7.m7.3.3.1.1.1.1.2.2" xref="S2.SS4.p4.7.m7.3.3.1.1.1.1.2.2.cmml">𝒗</mi><mo mathsize="90%" id="S2.SS4.p4.7.m7.3.3.1.1.1.1.2.1" xref="S2.SS4.p4.7.m7.3.3.1.1.1.1.2.1.cmml">¯</mo></mover><mi mathsize="90%" id="S2.SS4.p4.7.m7.3.3.1.1.1.1.3" xref="S2.SS4.p4.7.m7.3.3.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.SS4.p4.7.m7.3.3.1.1.1.3" xref="S2.SS4.p4.7.m7.3.3.1.1.2.1.cmml">‖</mo></mrow><mo lspace="0em" rspace="0em" id="S2.SS4.p4.7.m7.4.4.2.3" xref="S2.SS4.p4.7.m7.4.4.2.3.cmml">​</mo><mrow id="S2.SS4.p4.7.m7.4.4.2.2.1" xref="S2.SS4.p4.7.m7.4.4.2.2.2.cmml"><mo id="S2.SS4.p4.7.m7.4.4.2.2.1.2" xref="S2.SS4.p4.7.m7.4.4.2.2.2.1.cmml">‖</mo><msub id="S2.SS4.p4.7.m7.4.4.2.2.1.1" xref="S2.SS4.p4.7.m7.4.4.2.2.1.1.cmml"><mover accent="true" id="S2.SS4.p4.7.m7.4.4.2.2.1.1.2" xref="S2.SS4.p4.7.m7.4.4.2.2.1.1.2.cmml"><mi mathsize="90%" id="S2.SS4.p4.7.m7.4.4.2.2.1.1.2.2" xref="S2.SS4.p4.7.m7.4.4.2.2.1.1.2.2.cmml">𝒗</mi><mo mathsize="90%" id="S2.SS4.p4.7.m7.4.4.2.2.1.1.2.1" xref="S2.SS4.p4.7.m7.4.4.2.2.1.1.2.1.cmml">¯</mo></mover><mi mathsize="90%" id="S2.SS4.p4.7.m7.4.4.2.2.1.1.3" xref="S2.SS4.p4.7.m7.4.4.2.2.1.1.3.cmml">l</mi></msub><mo id="S2.SS4.p4.7.m7.4.4.2.2.1.3" xref="S2.SS4.p4.7.m7.4.4.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.SS4.p4.7.m7.5.5.1.1.3.1" xref="S2.SS4.p4.7.m7.5.5.1.1.3.1.cmml">​</mo><msub id="S2.SS4.p4.7.m7.5.5.1.1.3.2" xref="S2.SS4.p4.7.m7.5.5.1.1.3.2.cmml"><mover accent="true" id="S2.SS4.p4.7.m7.5.5.1.1.3.2.2" xref="S2.SS4.p4.7.m7.5.5.1.1.3.2.2.cmml"><mi mathsize="90%" id="S2.SS4.p4.7.m7.5.5.1.1.3.2.2.2" xref="S2.SS4.p4.7.m7.5.5.1.1.3.2.2.2.cmml">𝒗</mi><mo mathsize="90%" id="S2.SS4.p4.7.m7.5.5.1.1.3.2.2.1" xref="S2.SS4.p4.7.m7.5.5.1.1.3.2.2.1.cmml">¯</mo></mover><mi mathsize="90%" id="S2.SS4.p4.7.m7.5.5.1.1.3.2.3" xref="S2.SS4.p4.7.m7.5.5.1.1.3.2.3.cmml">l</mi></msub></mrow></mrow><mo lspace="0em" mathsize="90%" id="S2.SS4.p4.7.m7.5.5.1.2" xref="S2.SS4.p4.7.m7.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.7.m7.5b"><apply id="S2.SS4.p4.7.m7.5.5.1.1.cmml" xref="S2.SS4.p4.7.m7.5.5.1"><eq id="S2.SS4.p4.7.m7.5.5.1.1.1.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.1"></eq><apply id="S2.SS4.p4.7.m7.5.5.1.1.2.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p4.7.m7.5.5.1.1.2.1.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.2">superscript</csymbol><apply id="S2.SS4.p4.7.m7.5.5.1.1.2.2.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p4.7.m7.5.5.1.1.2.2.1.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.2">subscript</csymbol><ci id="S2.SS4.p4.7.m7.5.5.1.1.2.2.2.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.2.2.2">𝒈</ci><list id="S2.SS4.p4.7.m7.2.2.2.3.cmml" xref="S2.SS4.p4.7.m7.2.2.2.4"><ci id="S2.SS4.p4.7.m7.1.1.1.1.cmml" xref="S2.SS4.p4.7.m7.1.1.1.1">𝑖</ci><ci id="S2.SS4.p4.7.m7.2.2.2.2.cmml" xref="S2.SS4.p4.7.m7.2.2.2.2">𝑙</ci></list></apply><ci id="S2.SS4.p4.7.m7.5.5.1.1.2.3.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.2.3">′</ci></apply><apply id="S2.SS4.p4.7.m7.5.5.1.1.3.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.3"><times id="S2.SS4.p4.7.m7.5.5.1.1.3.1.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.3.1"></times><apply id="S2.SS4.p4.7.m7.4.4.cmml" xref="S2.SS4.p4.7.m7.4.4"><divide id="S2.SS4.p4.7.m7.4.4.3.cmml" xref="S2.SS4.p4.7.m7.4.4"></divide><apply id="S2.SS4.p4.7.m7.4.4.4.cmml" xref="S2.SS4.p4.7.m7.4.4.4"><times id="S2.SS4.p4.7.m7.4.4.4.1.cmml" xref="S2.SS4.p4.7.m7.4.4.4.1"></times><apply id="S2.SS4.p4.7.m7.4.4.4.2.cmml" xref="S2.SS4.p4.7.m7.4.4.4.2"><csymbol cd="ambiguous" id="S2.SS4.p4.7.m7.4.4.4.2.1.cmml" xref="S2.SS4.p4.7.m7.4.4.4.2">subscript</csymbol><ci id="S2.SS4.p4.7.m7.4.4.4.2.2.cmml" xref="S2.SS4.p4.7.m7.4.4.4.2.2">𝒈</ci><ci id="S2.SS4.p4.7.m7.4.4.4.2.3.cmml" xref="S2.SS4.p4.7.m7.4.4.4.2.3">𝑖</ci></apply><apply id="S2.SS4.p4.7.m7.4.4.4.3.cmml" xref="S2.SS4.p4.7.m7.4.4.4.3"><csymbol cd="ambiguous" id="S2.SS4.p4.7.m7.4.4.4.3.1.cmml" xref="S2.SS4.p4.7.m7.4.4.4.3">subscript</csymbol><apply id="S2.SS4.p4.7.m7.4.4.4.3.2.cmml" xref="S2.SS4.p4.7.m7.4.4.4.3.2"><ci id="S2.SS4.p4.7.m7.4.4.4.3.2.1.cmml" xref="S2.SS4.p4.7.m7.4.4.4.3.2.1">¯</ci><ci id="S2.SS4.p4.7.m7.4.4.4.3.2.2.cmml" xref="S2.SS4.p4.7.m7.4.4.4.3.2.2">𝒗</ci></apply><ci id="S2.SS4.p4.7.m7.4.4.4.3.3.cmml" xref="S2.SS4.p4.7.m7.4.4.4.3.3">𝑙</ci></apply></apply><apply id="S2.SS4.p4.7.m7.4.4.2.cmml" xref="S2.SS4.p4.7.m7.4.4.2"><times id="S2.SS4.p4.7.m7.4.4.2.3.cmml" xref="S2.SS4.p4.7.m7.4.4.2.3"></times><apply id="S2.SS4.p4.7.m7.3.3.1.1.2.cmml" xref="S2.SS4.p4.7.m7.3.3.1.1.1"><csymbol cd="latexml" id="S2.SS4.p4.7.m7.3.3.1.1.2.1.cmml" xref="S2.SS4.p4.7.m7.3.3.1.1.1.2">norm</csymbol><apply id="S2.SS4.p4.7.m7.3.3.1.1.1.1.cmml" xref="S2.SS4.p4.7.m7.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.7.m7.3.3.1.1.1.1.1.cmml" xref="S2.SS4.p4.7.m7.3.3.1.1.1.1">subscript</csymbol><apply id="S2.SS4.p4.7.m7.3.3.1.1.1.1.2.cmml" xref="S2.SS4.p4.7.m7.3.3.1.1.1.1.2"><ci id="S2.SS4.p4.7.m7.3.3.1.1.1.1.2.1.cmml" xref="S2.SS4.p4.7.m7.3.3.1.1.1.1.2.1">¯</ci><ci id="S2.SS4.p4.7.m7.3.3.1.1.1.1.2.2.cmml" xref="S2.SS4.p4.7.m7.3.3.1.1.1.1.2.2">𝒗</ci></apply><ci id="S2.SS4.p4.7.m7.3.3.1.1.1.1.3.cmml" xref="S2.SS4.p4.7.m7.3.3.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S2.SS4.p4.7.m7.4.4.2.2.2.cmml" xref="S2.SS4.p4.7.m7.4.4.2.2.1"><csymbol cd="latexml" id="S2.SS4.p4.7.m7.4.4.2.2.2.1.cmml" xref="S2.SS4.p4.7.m7.4.4.2.2.1.2">norm</csymbol><apply id="S2.SS4.p4.7.m7.4.4.2.2.1.1.cmml" xref="S2.SS4.p4.7.m7.4.4.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.7.m7.4.4.2.2.1.1.1.cmml" xref="S2.SS4.p4.7.m7.4.4.2.2.1.1">subscript</csymbol><apply id="S2.SS4.p4.7.m7.4.4.2.2.1.1.2.cmml" xref="S2.SS4.p4.7.m7.4.4.2.2.1.1.2"><ci id="S2.SS4.p4.7.m7.4.4.2.2.1.1.2.1.cmml" xref="S2.SS4.p4.7.m7.4.4.2.2.1.1.2.1">¯</ci><ci id="S2.SS4.p4.7.m7.4.4.2.2.1.1.2.2.cmml" xref="S2.SS4.p4.7.m7.4.4.2.2.1.1.2.2">𝒗</ci></apply><ci id="S2.SS4.p4.7.m7.4.4.2.2.1.1.3.cmml" xref="S2.SS4.p4.7.m7.4.4.2.2.1.1.3">𝑙</ci></apply></apply></apply></apply><apply id="S2.SS4.p4.7.m7.5.5.1.1.3.2.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS4.p4.7.m7.5.5.1.1.3.2.1.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.3.2">subscript</csymbol><apply id="S2.SS4.p4.7.m7.5.5.1.1.3.2.2.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.3.2.2"><ci id="S2.SS4.p4.7.m7.5.5.1.1.3.2.2.1.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.3.2.2.1">¯</ci><ci id="S2.SS4.p4.7.m7.5.5.1.1.3.2.2.2.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.3.2.2.2">𝒗</ci></apply><ci id="S2.SS4.p4.7.m7.5.5.1.1.3.2.3.cmml" xref="S2.SS4.p4.7.m7.5.5.1.1.3.2.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.7.m7.5c">\boldsymbol{g}_{i,l}^{\prime}=\frac{\boldsymbol{g}_{i}\bar{\boldsymbol{v}}_{l}}{\left\|\bar{\boldsymbol{v}}_{l}\right\|\left\|\bar{\boldsymbol{v}}_{l}\right\|}\bar{\boldsymbol{v}}_{l}.</annotation></semantics></math><span id="S2.SS4.p4.11.8" class="ltx_text" style="font-size:90%;">
We then aggregate all the projections together into a weighted sum, using the </span><math id="S2.SS4.p4.8.m8.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS4.p4.8.m8.1a"><mi mathsize="90%" id="S2.SS4.p4.8.m8.1.1" xref="S2.SS4.p4.8.m8.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.8.m8.1b"><ci id="S2.SS4.p4.8.m8.1.1.cmml" xref="S2.SS4.p4.8.m8.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.8.m8.1c">l</annotation></semantics></math><span id="S2.SS4.p4.11.9" class="ltx_text" style="font-size:90%;">-th eigenvalue </span><math id="S2.SS4.p4.9.m9.1" class="ltx_Math" alttext="\lambda_{l}" display="inline"><semantics id="S2.SS4.p4.9.m9.1a"><msub id="S2.SS4.p4.9.m9.1.1" xref="S2.SS4.p4.9.m9.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p4.9.m9.1.1.2" xref="S2.SS4.p4.9.m9.1.1.2.cmml">λ</mi><mi mathsize="90%" id="S2.SS4.p4.9.m9.1.1.3" xref="S2.SS4.p4.9.m9.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.9.m9.1b"><apply id="S2.SS4.p4.9.m9.1.1.cmml" xref="S2.SS4.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.9.m9.1.1.1.cmml" xref="S2.SS4.p4.9.m9.1.1">subscript</csymbol><ci id="S2.SS4.p4.9.m9.1.1.2.cmml" xref="S2.SS4.p4.9.m9.1.1.2">𝜆</ci><ci id="S2.SS4.p4.9.m9.1.1.3.cmml" xref="S2.SS4.p4.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.9.m9.1c">\lambda_{l}</annotation></semantics></math><span id="S2.SS4.p4.11.10" class="ltx_text" style="font-size:90%;"> as the weight for the </span><math id="S2.SS4.p4.10.m10.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.SS4.p4.10.m10.1a"><mi mathsize="90%" id="S2.SS4.p4.10.m10.1.1" xref="S2.SS4.p4.10.m10.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.10.m10.1b"><ci id="S2.SS4.p4.10.m10.1.1.cmml" xref="S2.SS4.p4.10.m10.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.10.m10.1c">l</annotation></semantics></math><span id="S2.SS4.p4.11.11" class="ltx_text" style="font-size:90%;">-th axis. Additionally, we apply a length correction to the weighted sum by multiplying it by </span><math id="S2.SS4.p4.11.m11.4" class="ltx_Math" alttext="\frac{\left\|\boldsymbol{g}_{i}\right\|}{\|\boldsymbol{g}_{i,l}^{\prime}\|}" display="inline"><semantics id="S2.SS4.p4.11.m11.4a"><mfrac id="S2.SS4.p4.11.m11.4.4" xref="S2.SS4.p4.11.m11.4.4.cmml"><mrow id="S2.SS4.p4.11.m11.1.1.1.1" xref="S2.SS4.p4.11.m11.1.1.1.2.cmml"><mo id="S2.SS4.p4.11.m11.1.1.1.1.2" xref="S2.SS4.p4.11.m11.1.1.1.2.1.cmml">‖</mo><msub id="S2.SS4.p4.11.m11.1.1.1.1.1" xref="S2.SS4.p4.11.m11.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p4.11.m11.1.1.1.1.1.2" xref="S2.SS4.p4.11.m11.1.1.1.1.1.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.SS4.p4.11.m11.1.1.1.1.1.3" xref="S2.SS4.p4.11.m11.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS4.p4.11.m11.1.1.1.1.3" xref="S2.SS4.p4.11.m11.1.1.1.2.1.cmml">‖</mo></mrow><mrow id="S2.SS4.p4.11.m11.4.4.4.3" xref="S2.SS4.p4.11.m11.4.4.4.4.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS4.p4.11.m11.4.4.4.3.2" xref="S2.SS4.p4.11.m11.4.4.4.4.1.cmml">‖</mo><msubsup id="S2.SS4.p4.11.m11.4.4.4.3.1" xref="S2.SS4.p4.11.m11.4.4.4.3.1.cmml"><mi mathsize="90%" id="S2.SS4.p4.11.m11.4.4.4.3.1.2.2" xref="S2.SS4.p4.11.m11.4.4.4.3.1.2.2.cmml">𝒈</mi><mrow id="S2.SS4.p4.11.m11.3.3.3.2.2.4" xref="S2.SS4.p4.11.m11.3.3.3.2.2.3.cmml"><mi mathsize="90%" id="S2.SS4.p4.11.m11.2.2.2.1.1.1" xref="S2.SS4.p4.11.m11.2.2.2.1.1.1.cmml">i</mi><mo mathsize="90%" id="S2.SS4.p4.11.m11.3.3.3.2.2.4.1" xref="S2.SS4.p4.11.m11.3.3.3.2.2.3.cmml">,</mo><mi mathsize="90%" id="S2.SS4.p4.11.m11.3.3.3.2.2.2" xref="S2.SS4.p4.11.m11.3.3.3.2.2.2.cmml">l</mi></mrow><mo mathsize="90%" id="S2.SS4.p4.11.m11.4.4.4.3.1.3" xref="S2.SS4.p4.11.m11.4.4.4.3.1.3.cmml">′</mo></msubsup><mo maxsize="90%" minsize="90%" id="S2.SS4.p4.11.m11.4.4.4.3.3" xref="S2.SS4.p4.11.m11.4.4.4.4.1.cmml">‖</mo></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.11.m11.4b"><apply id="S2.SS4.p4.11.m11.4.4.cmml" xref="S2.SS4.p4.11.m11.4.4"><divide id="S2.SS4.p4.11.m11.4.4.5.cmml" xref="S2.SS4.p4.11.m11.4.4"></divide><apply id="S2.SS4.p4.11.m11.1.1.1.2.cmml" xref="S2.SS4.p4.11.m11.1.1.1.1"><csymbol cd="latexml" id="S2.SS4.p4.11.m11.1.1.1.2.1.cmml" xref="S2.SS4.p4.11.m11.1.1.1.1.2">norm</csymbol><apply id="S2.SS4.p4.11.m11.1.1.1.1.1.cmml" xref="S2.SS4.p4.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.11.m11.1.1.1.1.1.1.cmml" xref="S2.SS4.p4.11.m11.1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p4.11.m11.1.1.1.1.1.2.cmml" xref="S2.SS4.p4.11.m11.1.1.1.1.1.2">𝒈</ci><ci id="S2.SS4.p4.11.m11.1.1.1.1.1.3.cmml" xref="S2.SS4.p4.11.m11.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.SS4.p4.11.m11.4.4.4.4.cmml" xref="S2.SS4.p4.11.m11.4.4.4.3"><csymbol cd="latexml" id="S2.SS4.p4.11.m11.4.4.4.4.1.cmml" xref="S2.SS4.p4.11.m11.4.4.4.3.2">norm</csymbol><apply id="S2.SS4.p4.11.m11.4.4.4.3.1.cmml" xref="S2.SS4.p4.11.m11.4.4.4.3.1"><csymbol cd="ambiguous" id="S2.SS4.p4.11.m11.4.4.4.3.1.1.cmml" xref="S2.SS4.p4.11.m11.4.4.4.3.1">superscript</csymbol><apply id="S2.SS4.p4.11.m11.4.4.4.3.1.2.cmml" xref="S2.SS4.p4.11.m11.4.4.4.3.1"><csymbol cd="ambiguous" id="S2.SS4.p4.11.m11.4.4.4.3.1.2.1.cmml" xref="S2.SS4.p4.11.m11.4.4.4.3.1">subscript</csymbol><ci id="S2.SS4.p4.11.m11.4.4.4.3.1.2.2.cmml" xref="S2.SS4.p4.11.m11.4.4.4.3.1.2.2">𝒈</ci><list id="S2.SS4.p4.11.m11.3.3.3.2.2.3.cmml" xref="S2.SS4.p4.11.m11.3.3.3.2.2.4"><ci id="S2.SS4.p4.11.m11.2.2.2.1.1.1.cmml" xref="S2.SS4.p4.11.m11.2.2.2.1.1.1">𝑖</ci><ci id="S2.SS4.p4.11.m11.3.3.3.2.2.2.cmml" xref="S2.SS4.p4.11.m11.3.3.3.2.2.2">𝑙</ci></list></apply><ci id="S2.SS4.p4.11.m11.4.4.4.3.1.3.cmml" xref="S2.SS4.p4.11.m11.4.4.4.3.1.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.11.m11.4c">\frac{\left\|\boldsymbol{g}_{i}\right\|}{\|\boldsymbol{g}_{i,l}^{\prime}\|}</annotation></semantics></math><span id="S2.SS4.p4.11.12" class="ltx_text" style="font-size:90%;">:</span></p>
<table id="S2.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E7.m1.8" class="ltx_Math" alttext="\boldsymbol{g}_{i}^{revise}=\sum_{l=1}^{L}\frac{\|{\boldsymbol{g}}_{i}\|}{\|\boldsymbol{g}_{i,l}^{\prime}\|}\frac{\lambda_{l}}{\|\lambda_{l}\|}\boldsymbol{g}_{i,l}^{\prime}," display="block"><semantics id="S2.E7.m1.8a"><mrow id="S2.E7.m1.8.8.1" xref="S2.E7.m1.8.8.1.1.cmml"><mrow id="S2.E7.m1.8.8.1.1" xref="S2.E7.m1.8.8.1.1.cmml"><msubsup id="S2.E7.m1.8.8.1.1.2" xref="S2.E7.m1.8.8.1.1.2.cmml"><mi mathsize="90%" id="S2.E7.m1.8.8.1.1.2.2.2" xref="S2.E7.m1.8.8.1.1.2.2.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.E7.m1.8.8.1.1.2.2.3" xref="S2.E7.m1.8.8.1.1.2.2.3.cmml">i</mi><mrow id="S2.E7.m1.8.8.1.1.2.3" xref="S2.E7.m1.8.8.1.1.2.3.cmml"><mi mathsize="90%" id="S2.E7.m1.8.8.1.1.2.3.2" xref="S2.E7.m1.8.8.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.8.8.1.1.2.3.1" xref="S2.E7.m1.8.8.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E7.m1.8.8.1.1.2.3.3" xref="S2.E7.m1.8.8.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.8.8.1.1.2.3.1a" xref="S2.E7.m1.8.8.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E7.m1.8.8.1.1.2.3.4" xref="S2.E7.m1.8.8.1.1.2.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.8.8.1.1.2.3.1b" xref="S2.E7.m1.8.8.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E7.m1.8.8.1.1.2.3.5" xref="S2.E7.m1.8.8.1.1.2.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.8.8.1.1.2.3.1c" xref="S2.E7.m1.8.8.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E7.m1.8.8.1.1.2.3.6" xref="S2.E7.m1.8.8.1.1.2.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.8.8.1.1.2.3.1d" xref="S2.E7.m1.8.8.1.1.2.3.1.cmml">​</mo><mi mathsize="90%" id="S2.E7.m1.8.8.1.1.2.3.7" xref="S2.E7.m1.8.8.1.1.2.3.7.cmml">e</mi></mrow></msubsup><mo mathsize="90%" rspace="0.111em" id="S2.E7.m1.8.8.1.1.1" xref="S2.E7.m1.8.8.1.1.1.cmml">=</mo><mrow id="S2.E7.m1.8.8.1.1.3" xref="S2.E7.m1.8.8.1.1.3.cmml"><munderover id="S2.E7.m1.8.8.1.1.3.1" xref="S2.E7.m1.8.8.1.1.3.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E7.m1.8.8.1.1.3.1.2.2" xref="S2.E7.m1.8.8.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E7.m1.8.8.1.1.3.1.2.3" xref="S2.E7.m1.8.8.1.1.3.1.2.3.cmml"><mi mathsize="90%" id="S2.E7.m1.8.8.1.1.3.1.2.3.2" xref="S2.E7.m1.8.8.1.1.3.1.2.3.2.cmml">l</mi><mo mathsize="90%" id="S2.E7.m1.8.8.1.1.3.1.2.3.1" xref="S2.E7.m1.8.8.1.1.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.E7.m1.8.8.1.1.3.1.2.3.3" xref="S2.E7.m1.8.8.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.E7.m1.8.8.1.1.3.1.3" xref="S2.E7.m1.8.8.1.1.3.1.3.cmml">L</mi></munderover><mrow id="S2.E7.m1.8.8.1.1.3.2" xref="S2.E7.m1.8.8.1.1.3.2.cmml"><mfrac id="S2.E7.m1.4.4" xref="S2.E7.m1.4.4.cmml"><mrow id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E7.m1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.2.1.cmml">‖</mo><msub id="S2.E7.m1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E7.m1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.E7.m1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="S2.E7.m1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.2.1.cmml">‖</mo></mrow><mrow id="S2.E7.m1.4.4.4.3" xref="S2.E7.m1.4.4.4.4.cmml"><mo maxsize="90%" minsize="90%" id="S2.E7.m1.4.4.4.3.2" xref="S2.E7.m1.4.4.4.4.1.cmml">‖</mo><msubsup id="S2.E7.m1.4.4.4.3.1" xref="S2.E7.m1.4.4.4.3.1.cmml"><mi mathsize="90%" id="S2.E7.m1.4.4.4.3.1.2.2" xref="S2.E7.m1.4.4.4.3.1.2.2.cmml">𝒈</mi><mrow id="S2.E7.m1.3.3.3.2.2.4" xref="S2.E7.m1.3.3.3.2.2.3.cmml"><mi mathsize="90%" id="S2.E7.m1.2.2.2.1.1.1" xref="S2.E7.m1.2.2.2.1.1.1.cmml">i</mi><mo mathsize="90%" id="S2.E7.m1.3.3.3.2.2.4.1" xref="S2.E7.m1.3.3.3.2.2.3.cmml">,</mo><mi mathsize="90%" id="S2.E7.m1.3.3.3.2.2.2" xref="S2.E7.m1.3.3.3.2.2.2.cmml">l</mi></mrow><mo mathsize="90%" id="S2.E7.m1.4.4.4.3.1.3" xref="S2.E7.m1.4.4.4.3.1.3.cmml">′</mo></msubsup><mo maxsize="90%" minsize="90%" id="S2.E7.m1.4.4.4.3.3" xref="S2.E7.m1.4.4.4.4.1.cmml">‖</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E7.m1.8.8.1.1.3.2.1" xref="S2.E7.m1.8.8.1.1.3.2.1.cmml">​</mo><mfrac id="S2.E7.m1.5.5" xref="S2.E7.m1.5.5.cmml"><msub id="S2.E7.m1.5.5.3" xref="S2.E7.m1.5.5.3.cmml"><mi mathsize="90%" id="S2.E7.m1.5.5.3.2" xref="S2.E7.m1.5.5.3.2.cmml">λ</mi><mi mathsize="90%" id="S2.E7.m1.5.5.3.3" xref="S2.E7.m1.5.5.3.3.cmml">l</mi></msub><mrow id="S2.E7.m1.5.5.1.1" xref="S2.E7.m1.5.5.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S2.E7.m1.5.5.1.1.2" xref="S2.E7.m1.5.5.1.2.1.cmml">‖</mo><msub id="S2.E7.m1.5.5.1.1.1" xref="S2.E7.m1.5.5.1.1.1.cmml"><mi mathsize="90%" id="S2.E7.m1.5.5.1.1.1.2" xref="S2.E7.m1.5.5.1.1.1.2.cmml">λ</mi><mi mathsize="90%" id="S2.E7.m1.5.5.1.1.1.3" xref="S2.E7.m1.5.5.1.1.1.3.cmml">l</mi></msub><mo maxsize="90%" minsize="90%" id="S2.E7.m1.5.5.1.1.3" xref="S2.E7.m1.5.5.1.2.1.cmml">‖</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E7.m1.8.8.1.1.3.2.1a" xref="S2.E7.m1.8.8.1.1.3.2.1.cmml">​</mo><msubsup id="S2.E7.m1.8.8.1.1.3.2.2" xref="S2.E7.m1.8.8.1.1.3.2.2.cmml"><mi mathsize="90%" id="S2.E7.m1.8.8.1.1.3.2.2.2.2" xref="S2.E7.m1.8.8.1.1.3.2.2.2.2.cmml">𝒈</mi><mrow id="S2.E7.m1.7.7.2.4" xref="S2.E7.m1.7.7.2.3.cmml"><mi mathsize="90%" id="S2.E7.m1.6.6.1.1" xref="S2.E7.m1.6.6.1.1.cmml">i</mi><mo mathsize="90%" id="S2.E7.m1.7.7.2.4.1" xref="S2.E7.m1.7.7.2.3.cmml">,</mo><mi mathsize="90%" id="S2.E7.m1.7.7.2.2" xref="S2.E7.m1.7.7.2.2.cmml">l</mi></mrow><mo mathsize="90%" id="S2.E7.m1.8.8.1.1.3.2.2.3" xref="S2.E7.m1.8.8.1.1.3.2.2.3.cmml">′</mo></msubsup></mrow></mrow></mrow><mo mathsize="90%" id="S2.E7.m1.8.8.1.2" xref="S2.E7.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.8b"><apply id="S2.E7.m1.8.8.1.1.cmml" xref="S2.E7.m1.8.8.1"><eq id="S2.E7.m1.8.8.1.1.1.cmml" xref="S2.E7.m1.8.8.1.1.1"></eq><apply id="S2.E7.m1.8.8.1.1.2.cmml" xref="S2.E7.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.8.8.1.1.2.1.cmml" xref="S2.E7.m1.8.8.1.1.2">superscript</csymbol><apply id="S2.E7.m1.8.8.1.1.2.2.cmml" xref="S2.E7.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.8.8.1.1.2.2.1.cmml" xref="S2.E7.m1.8.8.1.1.2">subscript</csymbol><ci id="S2.E7.m1.8.8.1.1.2.2.2.cmml" xref="S2.E7.m1.8.8.1.1.2.2.2">𝒈</ci><ci id="S2.E7.m1.8.8.1.1.2.2.3.cmml" xref="S2.E7.m1.8.8.1.1.2.2.3">𝑖</ci></apply><apply id="S2.E7.m1.8.8.1.1.2.3.cmml" xref="S2.E7.m1.8.8.1.1.2.3"><times id="S2.E7.m1.8.8.1.1.2.3.1.cmml" xref="S2.E7.m1.8.8.1.1.2.3.1"></times><ci id="S2.E7.m1.8.8.1.1.2.3.2.cmml" xref="S2.E7.m1.8.8.1.1.2.3.2">𝑟</ci><ci id="S2.E7.m1.8.8.1.1.2.3.3.cmml" xref="S2.E7.m1.8.8.1.1.2.3.3">𝑒</ci><ci id="S2.E7.m1.8.8.1.1.2.3.4.cmml" xref="S2.E7.m1.8.8.1.1.2.3.4">𝑣</ci><ci id="S2.E7.m1.8.8.1.1.2.3.5.cmml" xref="S2.E7.m1.8.8.1.1.2.3.5">𝑖</ci><ci id="S2.E7.m1.8.8.1.1.2.3.6.cmml" xref="S2.E7.m1.8.8.1.1.2.3.6">𝑠</ci><ci id="S2.E7.m1.8.8.1.1.2.3.7.cmml" xref="S2.E7.m1.8.8.1.1.2.3.7">𝑒</ci></apply></apply><apply id="S2.E7.m1.8.8.1.1.3.cmml" xref="S2.E7.m1.8.8.1.1.3"><apply id="S2.E7.m1.8.8.1.1.3.1.cmml" xref="S2.E7.m1.8.8.1.1.3.1"><csymbol cd="ambiguous" id="S2.E7.m1.8.8.1.1.3.1.1.cmml" xref="S2.E7.m1.8.8.1.1.3.1">superscript</csymbol><apply id="S2.E7.m1.8.8.1.1.3.1.2.cmml" xref="S2.E7.m1.8.8.1.1.3.1"><csymbol cd="ambiguous" id="S2.E7.m1.8.8.1.1.3.1.2.1.cmml" xref="S2.E7.m1.8.8.1.1.3.1">subscript</csymbol><sum id="S2.E7.m1.8.8.1.1.3.1.2.2.cmml" xref="S2.E7.m1.8.8.1.1.3.1.2.2"></sum><apply id="S2.E7.m1.8.8.1.1.3.1.2.3.cmml" xref="S2.E7.m1.8.8.1.1.3.1.2.3"><eq id="S2.E7.m1.8.8.1.1.3.1.2.3.1.cmml" xref="S2.E7.m1.8.8.1.1.3.1.2.3.1"></eq><ci id="S2.E7.m1.8.8.1.1.3.1.2.3.2.cmml" xref="S2.E7.m1.8.8.1.1.3.1.2.3.2">𝑙</ci><cn type="integer" id="S2.E7.m1.8.8.1.1.3.1.2.3.3.cmml" xref="S2.E7.m1.8.8.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E7.m1.8.8.1.1.3.1.3.cmml" xref="S2.E7.m1.8.8.1.1.3.1.3">𝐿</ci></apply><apply id="S2.E7.m1.8.8.1.1.3.2.cmml" xref="S2.E7.m1.8.8.1.1.3.2"><times id="S2.E7.m1.8.8.1.1.3.2.1.cmml" xref="S2.E7.m1.8.8.1.1.3.2.1"></times><apply id="S2.E7.m1.4.4.cmml" xref="S2.E7.m1.4.4"><divide id="S2.E7.m1.4.4.5.cmml" xref="S2.E7.m1.4.4"></divide><apply id="S2.E7.m1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.1.1.1.2.1.cmml" xref="S2.E7.m1.1.1.1.1.2">norm</csymbol><apply id="S2.E7.m1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.2">𝒈</ci><ci id="S2.E7.m1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.E7.m1.4.4.4.4.cmml" xref="S2.E7.m1.4.4.4.3"><csymbol cd="latexml" id="S2.E7.m1.4.4.4.4.1.cmml" xref="S2.E7.m1.4.4.4.3.2">norm</csymbol><apply id="S2.E7.m1.4.4.4.3.1.cmml" xref="S2.E7.m1.4.4.4.3.1"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.4.3.1.1.cmml" xref="S2.E7.m1.4.4.4.3.1">superscript</csymbol><apply id="S2.E7.m1.4.4.4.3.1.2.cmml" xref="S2.E7.m1.4.4.4.3.1"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.4.3.1.2.1.cmml" xref="S2.E7.m1.4.4.4.3.1">subscript</csymbol><ci id="S2.E7.m1.4.4.4.3.1.2.2.cmml" xref="S2.E7.m1.4.4.4.3.1.2.2">𝒈</ci><list id="S2.E7.m1.3.3.3.2.2.3.cmml" xref="S2.E7.m1.3.3.3.2.2.4"><ci id="S2.E7.m1.2.2.2.1.1.1.cmml" xref="S2.E7.m1.2.2.2.1.1.1">𝑖</ci><ci id="S2.E7.m1.3.3.3.2.2.2.cmml" xref="S2.E7.m1.3.3.3.2.2.2">𝑙</ci></list></apply><ci id="S2.E7.m1.4.4.4.3.1.3.cmml" xref="S2.E7.m1.4.4.4.3.1.3">′</ci></apply></apply></apply><apply id="S2.E7.m1.5.5.cmml" xref="S2.E7.m1.5.5"><divide id="S2.E7.m1.5.5.2.cmml" xref="S2.E7.m1.5.5"></divide><apply id="S2.E7.m1.5.5.3.cmml" xref="S2.E7.m1.5.5.3"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.3.1.cmml" xref="S2.E7.m1.5.5.3">subscript</csymbol><ci id="S2.E7.m1.5.5.3.2.cmml" xref="S2.E7.m1.5.5.3.2">𝜆</ci><ci id="S2.E7.m1.5.5.3.3.cmml" xref="S2.E7.m1.5.5.3.3">𝑙</ci></apply><apply id="S2.E7.m1.5.5.1.2.cmml" xref="S2.E7.m1.5.5.1.1"><csymbol cd="latexml" id="S2.E7.m1.5.5.1.2.1.cmml" xref="S2.E7.m1.5.5.1.1.2">norm</csymbol><apply id="S2.E7.m1.5.5.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1">subscript</csymbol><ci id="S2.E7.m1.5.5.1.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.1.2">𝜆</ci><ci id="S2.E7.m1.5.5.1.1.1.3.cmml" xref="S2.E7.m1.5.5.1.1.1.3">𝑙</ci></apply></apply></apply><apply id="S2.E7.m1.8.8.1.1.3.2.2.cmml" xref="S2.E7.m1.8.8.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.8.8.1.1.3.2.2.1.cmml" xref="S2.E7.m1.8.8.1.1.3.2.2">superscript</csymbol><apply id="S2.E7.m1.8.8.1.1.3.2.2.2.cmml" xref="S2.E7.m1.8.8.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.8.8.1.1.3.2.2.2.1.cmml" xref="S2.E7.m1.8.8.1.1.3.2.2">subscript</csymbol><ci id="S2.E7.m1.8.8.1.1.3.2.2.2.2.cmml" xref="S2.E7.m1.8.8.1.1.3.2.2.2.2">𝒈</ci><list id="S2.E7.m1.7.7.2.3.cmml" xref="S2.E7.m1.7.7.2.4"><ci id="S2.E7.m1.6.6.1.1.cmml" xref="S2.E7.m1.6.6.1.1">𝑖</ci><ci id="S2.E7.m1.7.7.2.2.cmml" xref="S2.E7.m1.7.7.2.2">𝑙</ci></list></apply><ci id="S2.E7.m1.8.8.1.1.3.2.2.3.cmml" xref="S2.E7.m1.8.8.1.1.3.2.2.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.8c">\boldsymbol{g}_{i}^{revise}=\sum_{l=1}^{L}\frac{\|{\boldsymbol{g}}_{i}\|}{\|\boldsymbol{g}_{i,l}^{\prime}\|}\frac{\lambda_{l}}{\|\lambda_{l}\|}\boldsymbol{g}_{i,l}^{\prime},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.SS4.p4.16" class="ltx_p"><span id="S2.SS4.p4.16.1" class="ltx_text" style="font-size:90%;">where </span><math id="S2.SS4.p4.12.m1.1" class="ltx_Math" alttext="\boldsymbol{g}_{i}^{revise}" display="inline"><semantics id="S2.SS4.p4.12.m1.1a"><msubsup id="S2.SS4.p4.12.m1.1.1" xref="S2.SS4.p4.12.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p4.12.m1.1.1.2.2" xref="S2.SS4.p4.12.m1.1.1.2.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.SS4.p4.12.m1.1.1.2.3" xref="S2.SS4.p4.12.m1.1.1.2.3.cmml">i</mi><mrow id="S2.SS4.p4.12.m1.1.1.3" xref="S2.SS4.p4.12.m1.1.1.3.cmml"><mi mathsize="90%" id="S2.SS4.p4.12.m1.1.1.3.2" xref="S2.SS4.p4.12.m1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p4.12.m1.1.1.3.1" xref="S2.SS4.p4.12.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p4.12.m1.1.1.3.3" xref="S2.SS4.p4.12.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p4.12.m1.1.1.3.1a" xref="S2.SS4.p4.12.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p4.12.m1.1.1.3.4" xref="S2.SS4.p4.12.m1.1.1.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p4.12.m1.1.1.3.1b" xref="S2.SS4.p4.12.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p4.12.m1.1.1.3.5" xref="S2.SS4.p4.12.m1.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p4.12.m1.1.1.3.1c" xref="S2.SS4.p4.12.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p4.12.m1.1.1.3.6" xref="S2.SS4.p4.12.m1.1.1.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p4.12.m1.1.1.3.1d" xref="S2.SS4.p4.12.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p4.12.m1.1.1.3.7" xref="S2.SS4.p4.12.m1.1.1.3.7.cmml">e</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.12.m1.1b"><apply id="S2.SS4.p4.12.m1.1.1.cmml" xref="S2.SS4.p4.12.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.12.m1.1.1.1.cmml" xref="S2.SS4.p4.12.m1.1.1">superscript</csymbol><apply id="S2.SS4.p4.12.m1.1.1.2.cmml" xref="S2.SS4.p4.12.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.12.m1.1.1.2.1.cmml" xref="S2.SS4.p4.12.m1.1.1">subscript</csymbol><ci id="S2.SS4.p4.12.m1.1.1.2.2.cmml" xref="S2.SS4.p4.12.m1.1.1.2.2">𝒈</ci><ci id="S2.SS4.p4.12.m1.1.1.2.3.cmml" xref="S2.SS4.p4.12.m1.1.1.2.3">𝑖</ci></apply><apply id="S2.SS4.p4.12.m1.1.1.3.cmml" xref="S2.SS4.p4.12.m1.1.1.3"><times id="S2.SS4.p4.12.m1.1.1.3.1.cmml" xref="S2.SS4.p4.12.m1.1.1.3.1"></times><ci id="S2.SS4.p4.12.m1.1.1.3.2.cmml" xref="S2.SS4.p4.12.m1.1.1.3.2">𝑟</ci><ci id="S2.SS4.p4.12.m1.1.1.3.3.cmml" xref="S2.SS4.p4.12.m1.1.1.3.3">𝑒</ci><ci id="S2.SS4.p4.12.m1.1.1.3.4.cmml" xref="S2.SS4.p4.12.m1.1.1.3.4">𝑣</ci><ci id="S2.SS4.p4.12.m1.1.1.3.5.cmml" xref="S2.SS4.p4.12.m1.1.1.3.5">𝑖</ci><ci id="S2.SS4.p4.12.m1.1.1.3.6.cmml" xref="S2.SS4.p4.12.m1.1.1.3.6">𝑠</ci><ci id="S2.SS4.p4.12.m1.1.1.3.7.cmml" xref="S2.SS4.p4.12.m1.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.12.m1.1c">\boldsymbol{g}_{i}^{revise}</annotation></semantics></math><span id="S2.SS4.p4.16.2" class="ltx_text" style="font-size:90%;"> is the revised gradient for the local client </span><math id="S2.SS4.p4.13.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS4.p4.13.m2.1a"><mi mathsize="90%" id="S2.SS4.p4.13.m2.1.1" xref="S2.SS4.p4.13.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.13.m2.1b"><ci id="S2.SS4.p4.13.m2.1.1.cmml" xref="S2.SS4.p4.13.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.13.m2.1c">i</annotation></semantics></math><span id="S2.SS4.p4.16.3" class="ltx_text" style="font-size:90%;">. The length correction factor </span><math id="S2.SS4.p4.14.m3.4" class="ltx_Math" alttext="\frac{\left\|\boldsymbol{g}_{i}\right\|}{\|\boldsymbol{g}_{i,l}^{\prime}\|}" display="inline"><semantics id="S2.SS4.p4.14.m3.4a"><mfrac id="S2.SS4.p4.14.m3.4.4" xref="S2.SS4.p4.14.m3.4.4.cmml"><mrow id="S2.SS4.p4.14.m3.1.1.1.1" xref="S2.SS4.p4.14.m3.1.1.1.2.cmml"><mo id="S2.SS4.p4.14.m3.1.1.1.1.2" xref="S2.SS4.p4.14.m3.1.1.1.2.1.cmml">‖</mo><msub id="S2.SS4.p4.14.m3.1.1.1.1.1" xref="S2.SS4.p4.14.m3.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p4.14.m3.1.1.1.1.1.2" xref="S2.SS4.p4.14.m3.1.1.1.1.1.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.SS4.p4.14.m3.1.1.1.1.1.3" xref="S2.SS4.p4.14.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS4.p4.14.m3.1.1.1.1.3" xref="S2.SS4.p4.14.m3.1.1.1.2.1.cmml">‖</mo></mrow><mrow id="S2.SS4.p4.14.m3.4.4.4.3" xref="S2.SS4.p4.14.m3.4.4.4.4.cmml"><mo maxsize="90%" minsize="90%" id="S2.SS4.p4.14.m3.4.4.4.3.2" xref="S2.SS4.p4.14.m3.4.4.4.4.1.cmml">‖</mo><msubsup id="S2.SS4.p4.14.m3.4.4.4.3.1" xref="S2.SS4.p4.14.m3.4.4.4.3.1.cmml"><mi mathsize="90%" id="S2.SS4.p4.14.m3.4.4.4.3.1.2.2" xref="S2.SS4.p4.14.m3.4.4.4.3.1.2.2.cmml">𝒈</mi><mrow id="S2.SS4.p4.14.m3.3.3.3.2.2.4" xref="S2.SS4.p4.14.m3.3.3.3.2.2.3.cmml"><mi mathsize="90%" id="S2.SS4.p4.14.m3.2.2.2.1.1.1" xref="S2.SS4.p4.14.m3.2.2.2.1.1.1.cmml">i</mi><mo mathsize="90%" id="S2.SS4.p4.14.m3.3.3.3.2.2.4.1" xref="S2.SS4.p4.14.m3.3.3.3.2.2.3.cmml">,</mo><mi mathsize="90%" id="S2.SS4.p4.14.m3.3.3.3.2.2.2" xref="S2.SS4.p4.14.m3.3.3.3.2.2.2.cmml">l</mi></mrow><mo mathsize="90%" id="S2.SS4.p4.14.m3.4.4.4.3.1.3" xref="S2.SS4.p4.14.m3.4.4.4.3.1.3.cmml">′</mo></msubsup><mo maxsize="90%" minsize="90%" id="S2.SS4.p4.14.m3.4.4.4.3.3" xref="S2.SS4.p4.14.m3.4.4.4.4.1.cmml">‖</mo></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.14.m3.4b"><apply id="S2.SS4.p4.14.m3.4.4.cmml" xref="S2.SS4.p4.14.m3.4.4"><divide id="S2.SS4.p4.14.m3.4.4.5.cmml" xref="S2.SS4.p4.14.m3.4.4"></divide><apply id="S2.SS4.p4.14.m3.1.1.1.2.cmml" xref="S2.SS4.p4.14.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS4.p4.14.m3.1.1.1.2.1.cmml" xref="S2.SS4.p4.14.m3.1.1.1.1.2">norm</csymbol><apply id="S2.SS4.p4.14.m3.1.1.1.1.1.cmml" xref="S2.SS4.p4.14.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.14.m3.1.1.1.1.1.1.cmml" xref="S2.SS4.p4.14.m3.1.1.1.1.1">subscript</csymbol><ci id="S2.SS4.p4.14.m3.1.1.1.1.1.2.cmml" xref="S2.SS4.p4.14.m3.1.1.1.1.1.2">𝒈</ci><ci id="S2.SS4.p4.14.m3.1.1.1.1.1.3.cmml" xref="S2.SS4.p4.14.m3.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.SS4.p4.14.m3.4.4.4.4.cmml" xref="S2.SS4.p4.14.m3.4.4.4.3"><csymbol cd="latexml" id="S2.SS4.p4.14.m3.4.4.4.4.1.cmml" xref="S2.SS4.p4.14.m3.4.4.4.3.2">norm</csymbol><apply id="S2.SS4.p4.14.m3.4.4.4.3.1.cmml" xref="S2.SS4.p4.14.m3.4.4.4.3.1"><csymbol cd="ambiguous" id="S2.SS4.p4.14.m3.4.4.4.3.1.1.cmml" xref="S2.SS4.p4.14.m3.4.4.4.3.1">superscript</csymbol><apply id="S2.SS4.p4.14.m3.4.4.4.3.1.2.cmml" xref="S2.SS4.p4.14.m3.4.4.4.3.1"><csymbol cd="ambiguous" id="S2.SS4.p4.14.m3.4.4.4.3.1.2.1.cmml" xref="S2.SS4.p4.14.m3.4.4.4.3.1">subscript</csymbol><ci id="S2.SS4.p4.14.m3.4.4.4.3.1.2.2.cmml" xref="S2.SS4.p4.14.m3.4.4.4.3.1.2.2">𝒈</ci><list id="S2.SS4.p4.14.m3.3.3.3.2.2.3.cmml" xref="S2.SS4.p4.14.m3.3.3.3.2.2.4"><ci id="S2.SS4.p4.14.m3.2.2.2.1.1.1.cmml" xref="S2.SS4.p4.14.m3.2.2.2.1.1.1">𝑖</ci><ci id="S2.SS4.p4.14.m3.3.3.3.2.2.2.cmml" xref="S2.SS4.p4.14.m3.3.3.3.2.2.2">𝑙</ci></list></apply><ci id="S2.SS4.p4.14.m3.4.4.4.3.1.3.cmml" xref="S2.SS4.p4.14.m3.4.4.4.3.1.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.14.m3.4c">\frac{\left\|\boldsymbol{g}_{i}\right\|}{\|\boldsymbol{g}_{i,l}^{\prime}\|}</annotation></semantics></math><span id="S2.SS4.p4.16.4" class="ltx_text" style="font-size:90%;"> in Eq.(</span><a href="#S2.E7" title="In 2.4 Principal Gradient-based Server Aggregation ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">7</span></a><span id="S2.SS4.p4.16.5" class="ltx_text" style="font-size:90%;">) aims to ensure that the magnitude of the revised local gradient for client </span><math id="S2.SS4.p4.15.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS4.p4.15.m4.1a"><mi mathsize="90%" id="S2.SS4.p4.15.m4.1.1" xref="S2.SS4.p4.15.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.15.m4.1b"><ci id="S2.SS4.p4.15.m4.1.1.cmml" xref="S2.SS4.p4.15.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.15.m4.1c">i</annotation></semantics></math><span id="S2.SS4.p4.16.6" class="ltx_text" style="font-size:90%;"> remains the same as the original local gradient </span><math id="S2.SS4.p4.16.m5.1" class="ltx_Math" alttext="\boldsymbol{g}_{i}" display="inline"><semantics id="S2.SS4.p4.16.m5.1a"><msub id="S2.SS4.p4.16.m5.1.1" xref="S2.SS4.p4.16.m5.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p4.16.m5.1.1.2" xref="S2.SS4.p4.16.m5.1.1.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.SS4.p4.16.m5.1.1.3" xref="S2.SS4.p4.16.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.16.m5.1b"><apply id="S2.SS4.p4.16.m5.1.1.cmml" xref="S2.SS4.p4.16.m5.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.16.m5.1.1.1.cmml" xref="S2.SS4.p4.16.m5.1.1">subscript</csymbol><ci id="S2.SS4.p4.16.m5.1.1.2.cmml" xref="S2.SS4.p4.16.m5.1.1.2">𝒈</ci><ci id="S2.SS4.p4.16.m5.1.1.3.cmml" xref="S2.SS4.p4.16.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.16.m5.1c">\boldsymbol{g}_{i}</annotation></semantics></math><span id="S2.SS4.p4.16.7" class="ltx_text" style="font-size:90%;">. This is crucial because a reduced magnitude of the revised local gradient can hinder FL convergence </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.SS4.p4.16.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib1" title="" class="ltx_ref">1</a><span id="S2.SS4.p4.16.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S2.SS4.p4.16.10" class="ltx_text" style="font-size:90%;">.</span></p>
</div>
<div id="S2.SS4.p5" class="ltx_para ltx_noindent">
<p id="S2.SS4.p5.2" class="ltx_p"><span id="S2.SS4.p5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Step 3: Global Gradient Aggregation.</span><span id="S2.SS4.p5.2.2" class="ltx_text" style="font-size:90%;"> Last, we aggregate all the revised local gradients </span><math id="S2.SS4.p5.1.m1.1" class="ltx_Math" alttext="\boldsymbol{g}_{i}^{revise}" display="inline"><semantics id="S2.SS4.p5.1.m1.1a"><msubsup id="S2.SS4.p5.1.m1.1.1" xref="S2.SS4.p5.1.m1.1.1.cmml"><mi mathsize="90%" id="S2.SS4.p5.1.m1.1.1.2.2" xref="S2.SS4.p5.1.m1.1.1.2.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.SS4.p5.1.m1.1.1.2.3" xref="S2.SS4.p5.1.m1.1.1.2.3.cmml">i</mi><mrow id="S2.SS4.p5.1.m1.1.1.3" xref="S2.SS4.p5.1.m1.1.1.3.cmml"><mi mathsize="90%" id="S2.SS4.p5.1.m1.1.1.3.2" xref="S2.SS4.p5.1.m1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.1.m1.1.1.3.1" xref="S2.SS4.p5.1.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p5.1.m1.1.1.3.3" xref="S2.SS4.p5.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.1.m1.1.1.3.1a" xref="S2.SS4.p5.1.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p5.1.m1.1.1.3.4" xref="S2.SS4.p5.1.m1.1.1.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.1.m1.1.1.3.1b" xref="S2.SS4.p5.1.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p5.1.m1.1.1.3.5" xref="S2.SS4.p5.1.m1.1.1.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.1.m1.1.1.3.1c" xref="S2.SS4.p5.1.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p5.1.m1.1.1.3.6" xref="S2.SS4.p5.1.m1.1.1.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.1.m1.1.1.3.1d" xref="S2.SS4.p5.1.m1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p5.1.m1.1.1.3.7" xref="S2.SS4.p5.1.m1.1.1.3.7.cmml">e</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.1.m1.1b"><apply id="S2.SS4.p5.1.m1.1.1.cmml" xref="S2.SS4.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p5.1.m1.1.1.1.cmml" xref="S2.SS4.p5.1.m1.1.1">superscript</csymbol><apply id="S2.SS4.p5.1.m1.1.1.2.cmml" xref="S2.SS4.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p5.1.m1.1.1.2.1.cmml" xref="S2.SS4.p5.1.m1.1.1">subscript</csymbol><ci id="S2.SS4.p5.1.m1.1.1.2.2.cmml" xref="S2.SS4.p5.1.m1.1.1.2.2">𝒈</ci><ci id="S2.SS4.p5.1.m1.1.1.2.3.cmml" xref="S2.SS4.p5.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S2.SS4.p5.1.m1.1.1.3.cmml" xref="S2.SS4.p5.1.m1.1.1.3"><times id="S2.SS4.p5.1.m1.1.1.3.1.cmml" xref="S2.SS4.p5.1.m1.1.1.3.1"></times><ci id="S2.SS4.p5.1.m1.1.1.3.2.cmml" xref="S2.SS4.p5.1.m1.1.1.3.2">𝑟</ci><ci id="S2.SS4.p5.1.m1.1.1.3.3.cmml" xref="S2.SS4.p5.1.m1.1.1.3.3">𝑒</ci><ci id="S2.SS4.p5.1.m1.1.1.3.4.cmml" xref="S2.SS4.p5.1.m1.1.1.3.4">𝑣</ci><ci id="S2.SS4.p5.1.m1.1.1.3.5.cmml" xref="S2.SS4.p5.1.m1.1.1.3.5">𝑖</ci><ci id="S2.SS4.p5.1.m1.1.1.3.6.cmml" xref="S2.SS4.p5.1.m1.1.1.3.6">𝑠</ci><ci id="S2.SS4.p5.1.m1.1.1.3.7.cmml" xref="S2.SS4.p5.1.m1.1.1.3.7">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.1.m1.1c">\boldsymbol{g}_{i}^{revise}</annotation></semantics></math><span id="S2.SS4.p5.2.3" class="ltx_text" style="font-size:90%;"> to construct the global gradients in the server as:
</span><math id="S2.SS4.p5.2.m2.1" class="ltx_Math" alttext="\bar{\boldsymbol{g}}=\sum_{i=1}^{m}\frac{n_{i}}{n}\boldsymbol{g}_{i}^{revise}." display="inline"><semantics id="S2.SS4.p5.2.m2.1a"><mrow id="S2.SS4.p5.2.m2.1.1.1" xref="S2.SS4.p5.2.m2.1.1.1.1.cmml"><mrow id="S2.SS4.p5.2.m2.1.1.1.1" xref="S2.SS4.p5.2.m2.1.1.1.1.cmml"><mover accent="true" id="S2.SS4.p5.2.m2.1.1.1.1.2" xref="S2.SS4.p5.2.m2.1.1.1.1.2.cmml"><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.2.2" xref="S2.SS4.p5.2.m2.1.1.1.1.2.2.cmml">𝒈</mi><mo mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.2.1" xref="S2.SS4.p5.2.m2.1.1.1.1.2.1.cmml">¯</mo></mover><mo mathsize="90%" rspace="0.111em" id="S2.SS4.p5.2.m2.1.1.1.1.1" xref="S2.SS4.p5.2.m2.1.1.1.1.1.cmml">=</mo><mrow id="S2.SS4.p5.2.m2.1.1.1.1.3" xref="S2.SS4.p5.2.m2.1.1.1.1.3.cmml"><msubsup id="S2.SS4.p5.2.m2.1.1.1.1.3.1" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.2" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.cmml"><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.2" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.1" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.3" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.1.3" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.3.cmml">m</mi></msubsup><mrow id="S2.SS4.p5.2.m2.1.1.1.1.3.2" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.cmml"><mfrac id="S2.SS4.p5.2.m2.1.1.1.1.3.2.2" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.cmml"><msub id="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2.cmml"><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2.2" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2.2.cmml">n</mi><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2.3" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2.3.cmml">i</mi></msub><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.3" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.1" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.cmml"><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.2.2" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.2.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.2.3" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.2.3.cmml">i</mi><mrow id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.cmml"><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.2" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.1" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.3" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.1a" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.4" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.1b" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.5" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.1c" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.6" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.1d" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.7" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.7.cmml">e</mi></mrow></msubsup></mrow></mrow></mrow><mo lspace="0em" mathsize="90%" id="S2.SS4.p5.2.m2.1.1.1.2" xref="S2.SS4.p5.2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p5.2.m2.1b"><apply id="S2.SS4.p5.2.m2.1.1.1.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1"><eq id="S2.SS4.p5.2.m2.1.1.1.1.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.1"></eq><apply id="S2.SS4.p5.2.m2.1.1.1.1.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.2"><ci id="S2.SS4.p5.2.m2.1.1.1.1.2.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.2.1">¯</ci><ci id="S2.SS4.p5.2.m2.1.1.1.1.2.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.2.2">𝒈</ci></apply><apply id="S2.SS4.p5.2.m2.1.1.1.1.3.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3"><apply id="S2.SS4.p5.2.m2.1.1.1.1.3.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS4.p5.2.m2.1.1.1.1.3.1.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1">superscript</csymbol><apply id="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1">subscript</csymbol><sum id="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.2"></sum><apply id="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3"><eq id="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.1"></eq><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.3.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.1.3.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.1.3">𝑚</ci></apply><apply id="S2.SS4.p5.2.m2.1.1.1.1.3.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2"><times id="S2.SS4.p5.2.m2.1.1.1.1.3.2.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.1"></times><apply id="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.2"><divide id="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.2"></divide><apply id="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2.2">𝑛</ci><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2.3.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.3.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.2.3">𝑛</ci></apply><apply id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3">superscript</csymbol><apply id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.2.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.2.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.2.2">𝒈</ci><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.2.3.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.2.3">𝑖</ci></apply><apply id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3"><times id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.1.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.1"></times><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.2.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.2">𝑟</ci><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.3.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.3">𝑒</ci><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.4.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.4">𝑣</ci><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.5.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.5">𝑖</ci><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.6.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.6">𝑠</ci><ci id="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.7.cmml" xref="S2.SS4.p5.2.m2.1.1.1.1.3.2.3.3.7">𝑒</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p5.2.m2.1c">\bar{\boldsymbol{g}}=\sum_{i=1}^{m}\frac{n_{i}}{n}\boldsymbol{g}_{i}^{revise}.</annotation></semantics></math><span id="S2.SS4.p5.2.4" class="ltx_text" style="font-size:90%;"></span></p>
</div>
<div id="Thmremark1" class="ltx_theorem ltx_theorem_remark">
<h6 class="ltx_title ltx_font_italic ltx_title_theorem" style="font-size:90%;"><span class="ltx_tag ltx_tag_theorem">Remark 1</span></h6>
<div id="Thmremark1.p1" class="ltx_para">
<p id="Thmremark1.p1.1" class="ltx_p"><span id="Thmremark1.p1.1.1" class="ltx_text" style="font-size:90%;">To better comprehend the gradient projection based on SVD, let’s examine </span><math id="Thmremark1.p1.1.m1.1" class="ltx_Math" alttext="\frac{1}{m}{\boldsymbol{G}}{\boldsymbol{G}^{\top}}" display="inline"><semantics id="Thmremark1.p1.1.m1.1a"><mrow id="Thmremark1.p1.1.m1.1.1" xref="Thmremark1.p1.1.m1.1.1.cmml"><mfrac id="Thmremark1.p1.1.m1.1.1.2" xref="Thmremark1.p1.1.m1.1.1.2.cmml"><mn mathsize="90%" id="Thmremark1.p1.1.m1.1.1.2.2" xref="Thmremark1.p1.1.m1.1.1.2.2.cmml">1</mn><mi mathsize="90%" id="Thmremark1.p1.1.m1.1.1.2.3" xref="Thmremark1.p1.1.m1.1.1.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="Thmremark1.p1.1.m1.1.1.1" xref="Thmremark1.p1.1.m1.1.1.1.cmml">​</mo><mi mathsize="90%" id="Thmremark1.p1.1.m1.1.1.3" xref="Thmremark1.p1.1.m1.1.1.3.cmml">𝑮</mi><mo lspace="0em" rspace="0em" id="Thmremark1.p1.1.m1.1.1.1a" xref="Thmremark1.p1.1.m1.1.1.1.cmml">​</mo><msup id="Thmremark1.p1.1.m1.1.1.4" xref="Thmremark1.p1.1.m1.1.1.4.cmml"><mi mathsize="90%" id="Thmremark1.p1.1.m1.1.1.4.2" xref="Thmremark1.p1.1.m1.1.1.4.2.cmml">𝑮</mi><mo mathsize="90%" id="Thmremark1.p1.1.m1.1.1.4.3" xref="Thmremark1.p1.1.m1.1.1.4.3.cmml">⊤</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="Thmremark1.p1.1.m1.1b"><apply id="Thmremark1.p1.1.m1.1.1.cmml" xref="Thmremark1.p1.1.m1.1.1"><times id="Thmremark1.p1.1.m1.1.1.1.cmml" xref="Thmremark1.p1.1.m1.1.1.1"></times><apply id="Thmremark1.p1.1.m1.1.1.2.cmml" xref="Thmremark1.p1.1.m1.1.1.2"><divide id="Thmremark1.p1.1.m1.1.1.2.1.cmml" xref="Thmremark1.p1.1.m1.1.1.2"></divide><cn type="integer" id="Thmremark1.p1.1.m1.1.1.2.2.cmml" xref="Thmremark1.p1.1.m1.1.1.2.2">1</cn><ci id="Thmremark1.p1.1.m1.1.1.2.3.cmml" xref="Thmremark1.p1.1.m1.1.1.2.3">𝑚</ci></apply><ci id="Thmremark1.p1.1.m1.1.1.3.cmml" xref="Thmremark1.p1.1.m1.1.1.3">𝑮</ci><apply id="Thmremark1.p1.1.m1.1.1.4.cmml" xref="Thmremark1.p1.1.m1.1.1.4"><csymbol cd="ambiguous" id="Thmremark1.p1.1.m1.1.1.4.1.cmml" xref="Thmremark1.p1.1.m1.1.1.4">superscript</csymbol><ci id="Thmremark1.p1.1.m1.1.1.4.2.cmml" xref="Thmremark1.p1.1.m1.1.1.4.2">𝑮</ci><csymbol cd="latexml" id="Thmremark1.p1.1.m1.1.1.4.3.cmml" xref="Thmremark1.p1.1.m1.1.1.4.3">top</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmremark1.p1.1.m1.1c">\frac{1}{m}{\boldsymbol{G}}{\boldsymbol{G}^{\top}}</annotation></semantics></math><span id="Thmremark1.p1.1.2" class="ltx_text" style="font-size:90%;"> in (</span><a href="#S2.E4" title="In 2.4 Principal Gradient-based Server Aggregation ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">4</span></a><span id="Thmremark1.p1.1.3" class="ltx_text" style="font-size:90%;">) as:</span></p>
<table id="S2.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E8.m1.3" class="ltx_Math" alttext="\frac{1}{m}\boldsymbol{G}\boldsymbol{G}^{\top}=\frac{1}{m}\left[\boldsymbol{g}_{1},\cdots,\boldsymbol{g}_{m}\right]\otimes\left[\boldsymbol{g}_{1},\cdots,\boldsymbol{g}_{m}\right]=\frac{1}{m}\sum_{i}\boldsymbol{g}_{i}\otimes\boldsymbol{g}_{i}=\frac{1}{m}\sum_{i}\mathcal{I}_{i}=-\frac{1}{m}\sum_{i}\mathcal{H}_{i}." display="block"><semantics id="S2.E8.m1.3a"><mrow id="S2.E8.m1.3.3.1" xref="S2.E8.m1.3.3.1.1.cmml"><mrow id="S2.E8.m1.3.3.1.1" xref="S2.E8.m1.3.3.1.1.cmml"><mrow id="S2.E8.m1.3.3.1.1.6" xref="S2.E8.m1.3.3.1.1.6.cmml"><mfrac id="S2.E8.m1.3.3.1.1.6.2" xref="S2.E8.m1.3.3.1.1.6.2.cmml"><mn mathsize="90%" id="S2.E8.m1.3.3.1.1.6.2.2" xref="S2.E8.m1.3.3.1.1.6.2.2.cmml">1</mn><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.6.2.3" xref="S2.E8.m1.3.3.1.1.6.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E8.m1.3.3.1.1.6.1" xref="S2.E8.m1.3.3.1.1.6.1.cmml">​</mo><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.6.3" xref="S2.E8.m1.3.3.1.1.6.3.cmml">𝑮</mi><mo lspace="0em" rspace="0em" id="S2.E8.m1.3.3.1.1.6.1a" xref="S2.E8.m1.3.3.1.1.6.1.cmml">​</mo><msup id="S2.E8.m1.3.3.1.1.6.4" xref="S2.E8.m1.3.3.1.1.6.4.cmml"><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.6.4.2" xref="S2.E8.m1.3.3.1.1.6.4.2.cmml">𝑮</mi><mo mathsize="90%" id="S2.E8.m1.3.3.1.1.6.4.3" xref="S2.E8.m1.3.3.1.1.6.4.3.cmml">⊤</mo></msup></mrow><mo mathsize="90%" id="S2.E8.m1.3.3.1.1.7" xref="S2.E8.m1.3.3.1.1.7.cmml">=</mo><mrow id="S2.E8.m1.3.3.1.1.4" xref="S2.E8.m1.3.3.1.1.4.cmml"><mrow id="S2.E8.m1.3.3.1.1.2.2" xref="S2.E8.m1.3.3.1.1.2.2.cmml"><mfrac id="S2.E8.m1.3.3.1.1.2.2.4" xref="S2.E8.m1.3.3.1.1.2.2.4.cmml"><mn mathsize="90%" id="S2.E8.m1.3.3.1.1.2.2.4.2" xref="S2.E8.m1.3.3.1.1.2.2.4.2.cmml">1</mn><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.2.2.4.3" xref="S2.E8.m1.3.3.1.1.2.2.4.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E8.m1.3.3.1.1.2.2.3" xref="S2.E8.m1.3.3.1.1.2.2.3.cmml">​</mo><mrow id="S2.E8.m1.3.3.1.1.2.2.2.2" xref="S2.E8.m1.3.3.1.1.2.2.2.3.cmml"><mo id="S2.E8.m1.3.3.1.1.2.2.2.2.3" xref="S2.E8.m1.3.3.1.1.2.2.2.3.cmml">[</mo><msub id="S2.E8.m1.3.3.1.1.1.1.1.1.1" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml">𝒈</mi><mn mathsize="90%" id="S2.E8.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S2.E8.m1.3.3.1.1.2.2.2.2.4" xref="S2.E8.m1.3.3.1.1.2.2.2.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.E8.m1.1.1" xref="S2.E8.m1.1.1.cmml">⋯</mi><mo mathsize="90%" id="S2.E8.m1.3.3.1.1.2.2.2.2.5" xref="S2.E8.m1.3.3.1.1.2.2.2.3.cmml">,</mo><msub id="S2.E8.m1.3.3.1.1.2.2.2.2.2" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.cmml"><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.2.2.2.2.2.2" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.2.2.2.2.2.3" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.3.cmml">m</mi></msub><mo rspace="0.055em" id="S2.E8.m1.3.3.1.1.2.2.2.2.6" xref="S2.E8.m1.3.3.1.1.2.2.2.3.cmml">]</mo></mrow></mrow><mo mathsize="90%" rspace="0.222em" id="S2.E8.m1.3.3.1.1.4.5" xref="S2.E8.m1.3.3.1.1.4.5.cmml">⊗</mo><mrow id="S2.E8.m1.3.3.1.1.4.4.2" xref="S2.E8.m1.3.3.1.1.4.4.3.cmml"><mo id="S2.E8.m1.3.3.1.1.4.4.2.3" xref="S2.E8.m1.3.3.1.1.4.4.3.cmml">[</mo><msub id="S2.E8.m1.3.3.1.1.3.3.1.1" xref="S2.E8.m1.3.3.1.1.3.3.1.1.cmml"><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.3.3.1.1.2" xref="S2.E8.m1.3.3.1.1.3.3.1.1.2.cmml">𝒈</mi><mn mathsize="90%" id="S2.E8.m1.3.3.1.1.3.3.1.1.3" xref="S2.E8.m1.3.3.1.1.3.3.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="S2.E8.m1.3.3.1.1.4.4.2.4" xref="S2.E8.m1.3.3.1.1.4.4.3.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="S2.E8.m1.2.2" xref="S2.E8.m1.2.2.cmml">⋯</mi><mo mathsize="90%" id="S2.E8.m1.3.3.1.1.4.4.2.5" xref="S2.E8.m1.3.3.1.1.4.4.3.cmml">,</mo><msub id="S2.E8.m1.3.3.1.1.4.4.2.2" xref="S2.E8.m1.3.3.1.1.4.4.2.2.cmml"><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.4.4.2.2.2" xref="S2.E8.m1.3.3.1.1.4.4.2.2.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.4.4.2.2.3" xref="S2.E8.m1.3.3.1.1.4.4.2.2.3.cmml">m</mi></msub><mo id="S2.E8.m1.3.3.1.1.4.4.2.6" xref="S2.E8.m1.3.3.1.1.4.4.3.cmml">]</mo></mrow></mrow><mo mathsize="90%" id="S2.E8.m1.3.3.1.1.8" xref="S2.E8.m1.3.3.1.1.8.cmml">=</mo><mrow id="S2.E8.m1.3.3.1.1.9" xref="S2.E8.m1.3.3.1.1.9.cmml"><mfrac id="S2.E8.m1.3.3.1.1.9.2" xref="S2.E8.m1.3.3.1.1.9.2.cmml"><mn mathsize="90%" id="S2.E8.m1.3.3.1.1.9.2.2" xref="S2.E8.m1.3.3.1.1.9.2.2.cmml">1</mn><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.9.2.3" xref="S2.E8.m1.3.3.1.1.9.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E8.m1.3.3.1.1.9.1" xref="S2.E8.m1.3.3.1.1.9.1.cmml">​</mo><mrow id="S2.E8.m1.3.3.1.1.9.3" xref="S2.E8.m1.3.3.1.1.9.3.cmml"><munder id="S2.E8.m1.3.3.1.1.9.3.1" xref="S2.E8.m1.3.3.1.1.9.3.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E8.m1.3.3.1.1.9.3.1.2" xref="S2.E8.m1.3.3.1.1.9.3.1.2.cmml">∑</mo><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.9.3.1.3" xref="S2.E8.m1.3.3.1.1.9.3.1.3.cmml">i</mi></munder><mrow id="S2.E8.m1.3.3.1.1.9.3.2" xref="S2.E8.m1.3.3.1.1.9.3.2.cmml"><msub id="S2.E8.m1.3.3.1.1.9.3.2.2" xref="S2.E8.m1.3.3.1.1.9.3.2.2.cmml"><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.9.3.2.2.2" xref="S2.E8.m1.3.3.1.1.9.3.2.2.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.9.3.2.2.3" xref="S2.E8.m1.3.3.1.1.9.3.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S2.E8.m1.3.3.1.1.9.3.2.1" xref="S2.E8.m1.3.3.1.1.9.3.2.1.cmml">⊗</mo><msub id="S2.E8.m1.3.3.1.1.9.3.2.3" xref="S2.E8.m1.3.3.1.1.9.3.2.3.cmml"><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.9.3.2.3.2" xref="S2.E8.m1.3.3.1.1.9.3.2.3.2.cmml">𝒈</mi><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.9.3.2.3.3" xref="S2.E8.m1.3.3.1.1.9.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo mathsize="90%" id="S2.E8.m1.3.3.1.1.10" xref="S2.E8.m1.3.3.1.1.10.cmml">=</mo><mrow id="S2.E8.m1.3.3.1.1.11" xref="S2.E8.m1.3.3.1.1.11.cmml"><mfrac id="S2.E8.m1.3.3.1.1.11.2" xref="S2.E8.m1.3.3.1.1.11.2.cmml"><mn mathsize="90%" id="S2.E8.m1.3.3.1.1.11.2.2" xref="S2.E8.m1.3.3.1.1.11.2.2.cmml">1</mn><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.11.2.3" xref="S2.E8.m1.3.3.1.1.11.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E8.m1.3.3.1.1.11.1" xref="S2.E8.m1.3.3.1.1.11.1.cmml">​</mo><mrow id="S2.E8.m1.3.3.1.1.11.3" xref="S2.E8.m1.3.3.1.1.11.3.cmml"><munder id="S2.E8.m1.3.3.1.1.11.3.1" xref="S2.E8.m1.3.3.1.1.11.3.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E8.m1.3.3.1.1.11.3.1.2" xref="S2.E8.m1.3.3.1.1.11.3.1.2.cmml">∑</mo><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.11.3.1.3" xref="S2.E8.m1.3.3.1.1.11.3.1.3.cmml">i</mi></munder><msub id="S2.E8.m1.3.3.1.1.11.3.2" xref="S2.E8.m1.3.3.1.1.11.3.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E8.m1.3.3.1.1.11.3.2.2" xref="S2.E8.m1.3.3.1.1.11.3.2.2.cmml">ℐ</mi><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.11.3.2.3" xref="S2.E8.m1.3.3.1.1.11.3.2.3.cmml">i</mi></msub></mrow></mrow><mo mathsize="90%" id="S2.E8.m1.3.3.1.1.12" xref="S2.E8.m1.3.3.1.1.12.cmml">=</mo><mrow id="S2.E8.m1.3.3.1.1.13" xref="S2.E8.m1.3.3.1.1.13.cmml"><mo mathsize="90%" id="S2.E8.m1.3.3.1.1.13a" xref="S2.E8.m1.3.3.1.1.13.cmml">−</mo><mrow id="S2.E8.m1.3.3.1.1.13.2" xref="S2.E8.m1.3.3.1.1.13.2.cmml"><mfrac id="S2.E8.m1.3.3.1.1.13.2.2" xref="S2.E8.m1.3.3.1.1.13.2.2.cmml"><mn mathsize="90%" id="S2.E8.m1.3.3.1.1.13.2.2.2" xref="S2.E8.m1.3.3.1.1.13.2.2.2.cmml">1</mn><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.13.2.2.3" xref="S2.E8.m1.3.3.1.1.13.2.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E8.m1.3.3.1.1.13.2.1" xref="S2.E8.m1.3.3.1.1.13.2.1.cmml">​</mo><mrow id="S2.E8.m1.3.3.1.1.13.2.3" xref="S2.E8.m1.3.3.1.1.13.2.3.cmml"><munder id="S2.E8.m1.3.3.1.1.13.2.3.1" xref="S2.E8.m1.3.3.1.1.13.2.3.1.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S2.E8.m1.3.3.1.1.13.2.3.1.2" xref="S2.E8.m1.3.3.1.1.13.2.3.1.2.cmml">∑</mo><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.13.2.3.1.3" xref="S2.E8.m1.3.3.1.1.13.2.3.1.3.cmml">i</mi></munder><msub id="S2.E8.m1.3.3.1.1.13.2.3.2" xref="S2.E8.m1.3.3.1.1.13.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S2.E8.m1.3.3.1.1.13.2.3.2.2" xref="S2.E8.m1.3.3.1.1.13.2.3.2.2.cmml">ℋ</mi><mi mathsize="90%" id="S2.E8.m1.3.3.1.1.13.2.3.2.3" xref="S2.E8.m1.3.3.1.1.13.2.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><mo lspace="0em" mathsize="90%" id="S2.E8.m1.3.3.1.2" xref="S2.E8.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.3b"><apply id="S2.E8.m1.3.3.1.1.cmml" xref="S2.E8.m1.3.3.1"><and id="S2.E8.m1.3.3.1.1a.cmml" xref="S2.E8.m1.3.3.1"></and><apply id="S2.E8.m1.3.3.1.1b.cmml" xref="S2.E8.m1.3.3.1"><eq id="S2.E8.m1.3.3.1.1.7.cmml" xref="S2.E8.m1.3.3.1.1.7"></eq><apply id="S2.E8.m1.3.3.1.1.6.cmml" xref="S2.E8.m1.3.3.1.1.6"><times id="S2.E8.m1.3.3.1.1.6.1.cmml" xref="S2.E8.m1.3.3.1.1.6.1"></times><apply id="S2.E8.m1.3.3.1.1.6.2.cmml" xref="S2.E8.m1.3.3.1.1.6.2"><divide id="S2.E8.m1.3.3.1.1.6.2.1.cmml" xref="S2.E8.m1.3.3.1.1.6.2"></divide><cn type="integer" id="S2.E8.m1.3.3.1.1.6.2.2.cmml" xref="S2.E8.m1.3.3.1.1.6.2.2">1</cn><ci id="S2.E8.m1.3.3.1.1.6.2.3.cmml" xref="S2.E8.m1.3.3.1.1.6.2.3">𝑚</ci></apply><ci id="S2.E8.m1.3.3.1.1.6.3.cmml" xref="S2.E8.m1.3.3.1.1.6.3">𝑮</ci><apply id="S2.E8.m1.3.3.1.1.6.4.cmml" xref="S2.E8.m1.3.3.1.1.6.4"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.6.4.1.cmml" xref="S2.E8.m1.3.3.1.1.6.4">superscript</csymbol><ci id="S2.E8.m1.3.3.1.1.6.4.2.cmml" xref="S2.E8.m1.3.3.1.1.6.4.2">𝑮</ci><csymbol cd="latexml" id="S2.E8.m1.3.3.1.1.6.4.3.cmml" xref="S2.E8.m1.3.3.1.1.6.4.3">top</csymbol></apply></apply><apply id="S2.E8.m1.3.3.1.1.4.cmml" xref="S2.E8.m1.3.3.1.1.4"><csymbol cd="latexml" id="S2.E8.m1.3.3.1.1.4.5.cmml" xref="S2.E8.m1.3.3.1.1.4.5">tensor-product</csymbol><apply id="S2.E8.m1.3.3.1.1.2.2.cmml" xref="S2.E8.m1.3.3.1.1.2.2"><times id="S2.E8.m1.3.3.1.1.2.2.3.cmml" xref="S2.E8.m1.3.3.1.1.2.2.3"></times><apply id="S2.E8.m1.3.3.1.1.2.2.4.cmml" xref="S2.E8.m1.3.3.1.1.2.2.4"><divide id="S2.E8.m1.3.3.1.1.2.2.4.1.cmml" xref="S2.E8.m1.3.3.1.1.2.2.4"></divide><cn type="integer" id="S2.E8.m1.3.3.1.1.2.2.4.2.cmml" xref="S2.E8.m1.3.3.1.1.2.2.4.2">1</cn><ci id="S2.E8.m1.3.3.1.1.2.2.4.3.cmml" xref="S2.E8.m1.3.3.1.1.2.2.4.3">𝑚</ci></apply><list id="S2.E8.m1.3.3.1.1.2.2.2.3.cmml" xref="S2.E8.m1.3.3.1.1.2.2.2.2"><apply id="S2.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.2">𝒈</ci><cn type="integer" id="S2.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.E8.m1.1.1.cmml" xref="S2.E8.m1.1.1">⋯</ci><apply id="S2.E8.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.2">𝒈</ci><ci id="S2.E8.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.3">𝑚</ci></apply></list></apply><list id="S2.E8.m1.3.3.1.1.4.4.3.cmml" xref="S2.E8.m1.3.3.1.1.4.4.2"><apply id="S2.E8.m1.3.3.1.1.3.3.1.1.cmml" xref="S2.E8.m1.3.3.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.3.3.1.1.1.cmml" xref="S2.E8.m1.3.3.1.1.3.3.1.1">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.3.3.1.1.2.cmml" xref="S2.E8.m1.3.3.1.1.3.3.1.1.2">𝒈</ci><cn type="integer" id="S2.E8.m1.3.3.1.1.3.3.1.1.3.cmml" xref="S2.E8.m1.3.3.1.1.3.3.1.1.3">1</cn></apply><ci id="S2.E8.m1.2.2.cmml" xref="S2.E8.m1.2.2">⋯</ci><apply id="S2.E8.m1.3.3.1.1.4.4.2.2.cmml" xref="S2.E8.m1.3.3.1.1.4.4.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.4.4.2.2.1.cmml" xref="S2.E8.m1.3.3.1.1.4.4.2.2">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.4.4.2.2.2.cmml" xref="S2.E8.m1.3.3.1.1.4.4.2.2.2">𝒈</ci><ci id="S2.E8.m1.3.3.1.1.4.4.2.2.3.cmml" xref="S2.E8.m1.3.3.1.1.4.4.2.2.3">𝑚</ci></apply></list></apply></apply><apply id="S2.E8.m1.3.3.1.1c.cmml" xref="S2.E8.m1.3.3.1"><eq id="S2.E8.m1.3.3.1.1.8.cmml" xref="S2.E8.m1.3.3.1.1.8"></eq><share href="#S2.E8.m1.3.3.1.1.4.cmml" id="S2.E8.m1.3.3.1.1d.cmml" xref="S2.E8.m1.3.3.1"></share><apply id="S2.E8.m1.3.3.1.1.9.cmml" xref="S2.E8.m1.3.3.1.1.9"><times id="S2.E8.m1.3.3.1.1.9.1.cmml" xref="S2.E8.m1.3.3.1.1.9.1"></times><apply id="S2.E8.m1.3.3.1.1.9.2.cmml" xref="S2.E8.m1.3.3.1.1.9.2"><divide id="S2.E8.m1.3.3.1.1.9.2.1.cmml" xref="S2.E8.m1.3.3.1.1.9.2"></divide><cn type="integer" id="S2.E8.m1.3.3.1.1.9.2.2.cmml" xref="S2.E8.m1.3.3.1.1.9.2.2">1</cn><ci id="S2.E8.m1.3.3.1.1.9.2.3.cmml" xref="S2.E8.m1.3.3.1.1.9.2.3">𝑚</ci></apply><apply id="S2.E8.m1.3.3.1.1.9.3.cmml" xref="S2.E8.m1.3.3.1.1.9.3"><apply id="S2.E8.m1.3.3.1.1.9.3.1.cmml" xref="S2.E8.m1.3.3.1.1.9.3.1"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.9.3.1.1.cmml" xref="S2.E8.m1.3.3.1.1.9.3.1">subscript</csymbol><sum id="S2.E8.m1.3.3.1.1.9.3.1.2.cmml" xref="S2.E8.m1.3.3.1.1.9.3.1.2"></sum><ci id="S2.E8.m1.3.3.1.1.9.3.1.3.cmml" xref="S2.E8.m1.3.3.1.1.9.3.1.3">𝑖</ci></apply><apply id="S2.E8.m1.3.3.1.1.9.3.2.cmml" xref="S2.E8.m1.3.3.1.1.9.3.2"><csymbol cd="latexml" id="S2.E8.m1.3.3.1.1.9.3.2.1.cmml" xref="S2.E8.m1.3.3.1.1.9.3.2.1">tensor-product</csymbol><apply id="S2.E8.m1.3.3.1.1.9.3.2.2.cmml" xref="S2.E8.m1.3.3.1.1.9.3.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.9.3.2.2.1.cmml" xref="S2.E8.m1.3.3.1.1.9.3.2.2">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.9.3.2.2.2.cmml" xref="S2.E8.m1.3.3.1.1.9.3.2.2.2">𝒈</ci><ci id="S2.E8.m1.3.3.1.1.9.3.2.2.3.cmml" xref="S2.E8.m1.3.3.1.1.9.3.2.2.3">𝑖</ci></apply><apply id="S2.E8.m1.3.3.1.1.9.3.2.3.cmml" xref="S2.E8.m1.3.3.1.1.9.3.2.3"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.9.3.2.3.1.cmml" xref="S2.E8.m1.3.3.1.1.9.3.2.3">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.9.3.2.3.2.cmml" xref="S2.E8.m1.3.3.1.1.9.3.2.3.2">𝒈</ci><ci id="S2.E8.m1.3.3.1.1.9.3.2.3.3.cmml" xref="S2.E8.m1.3.3.1.1.9.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S2.E8.m1.3.3.1.1e.cmml" xref="S2.E8.m1.3.3.1"><eq id="S2.E8.m1.3.3.1.1.10.cmml" xref="S2.E8.m1.3.3.1.1.10"></eq><share href="#S2.E8.m1.3.3.1.1.9.cmml" id="S2.E8.m1.3.3.1.1f.cmml" xref="S2.E8.m1.3.3.1"></share><apply id="S2.E8.m1.3.3.1.1.11.cmml" xref="S2.E8.m1.3.3.1.1.11"><times id="S2.E8.m1.3.3.1.1.11.1.cmml" xref="S2.E8.m1.3.3.1.1.11.1"></times><apply id="S2.E8.m1.3.3.1.1.11.2.cmml" xref="S2.E8.m1.3.3.1.1.11.2"><divide id="S2.E8.m1.3.3.1.1.11.2.1.cmml" xref="S2.E8.m1.3.3.1.1.11.2"></divide><cn type="integer" id="S2.E8.m1.3.3.1.1.11.2.2.cmml" xref="S2.E8.m1.3.3.1.1.11.2.2">1</cn><ci id="S2.E8.m1.3.3.1.1.11.2.3.cmml" xref="S2.E8.m1.3.3.1.1.11.2.3">𝑚</ci></apply><apply id="S2.E8.m1.3.3.1.1.11.3.cmml" xref="S2.E8.m1.3.3.1.1.11.3"><apply id="S2.E8.m1.3.3.1.1.11.3.1.cmml" xref="S2.E8.m1.3.3.1.1.11.3.1"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.11.3.1.1.cmml" xref="S2.E8.m1.3.3.1.1.11.3.1">subscript</csymbol><sum id="S2.E8.m1.3.3.1.1.11.3.1.2.cmml" xref="S2.E8.m1.3.3.1.1.11.3.1.2"></sum><ci id="S2.E8.m1.3.3.1.1.11.3.1.3.cmml" xref="S2.E8.m1.3.3.1.1.11.3.1.3">𝑖</ci></apply><apply id="S2.E8.m1.3.3.1.1.11.3.2.cmml" xref="S2.E8.m1.3.3.1.1.11.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.11.3.2.1.cmml" xref="S2.E8.m1.3.3.1.1.11.3.2">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.11.3.2.2.cmml" xref="S2.E8.m1.3.3.1.1.11.3.2.2">ℐ</ci><ci id="S2.E8.m1.3.3.1.1.11.3.2.3.cmml" xref="S2.E8.m1.3.3.1.1.11.3.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S2.E8.m1.3.3.1.1g.cmml" xref="S2.E8.m1.3.3.1"><eq id="S2.E8.m1.3.3.1.1.12.cmml" xref="S2.E8.m1.3.3.1.1.12"></eq><share href="#S2.E8.m1.3.3.1.1.11.cmml" id="S2.E8.m1.3.3.1.1h.cmml" xref="S2.E8.m1.3.3.1"></share><apply id="S2.E8.m1.3.3.1.1.13.cmml" xref="S2.E8.m1.3.3.1.1.13"><minus id="S2.E8.m1.3.3.1.1.13.1.cmml" xref="S2.E8.m1.3.3.1.1.13"></minus><apply id="S2.E8.m1.3.3.1.1.13.2.cmml" xref="S2.E8.m1.3.3.1.1.13.2"><times id="S2.E8.m1.3.3.1.1.13.2.1.cmml" xref="S2.E8.m1.3.3.1.1.13.2.1"></times><apply id="S2.E8.m1.3.3.1.1.13.2.2.cmml" xref="S2.E8.m1.3.3.1.1.13.2.2"><divide id="S2.E8.m1.3.3.1.1.13.2.2.1.cmml" xref="S2.E8.m1.3.3.1.1.13.2.2"></divide><cn type="integer" id="S2.E8.m1.3.3.1.1.13.2.2.2.cmml" xref="S2.E8.m1.3.3.1.1.13.2.2.2">1</cn><ci id="S2.E8.m1.3.3.1.1.13.2.2.3.cmml" xref="S2.E8.m1.3.3.1.1.13.2.2.3">𝑚</ci></apply><apply id="S2.E8.m1.3.3.1.1.13.2.3.cmml" xref="S2.E8.m1.3.3.1.1.13.2.3"><apply id="S2.E8.m1.3.3.1.1.13.2.3.1.cmml" xref="S2.E8.m1.3.3.1.1.13.2.3.1"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.13.2.3.1.1.cmml" xref="S2.E8.m1.3.3.1.1.13.2.3.1">subscript</csymbol><sum id="S2.E8.m1.3.3.1.1.13.2.3.1.2.cmml" xref="S2.E8.m1.3.3.1.1.13.2.3.1.2"></sum><ci id="S2.E8.m1.3.3.1.1.13.2.3.1.3.cmml" xref="S2.E8.m1.3.3.1.1.13.2.3.1.3">𝑖</ci></apply><apply id="S2.E8.m1.3.3.1.1.13.2.3.2.cmml" xref="S2.E8.m1.3.3.1.1.13.2.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.13.2.3.2.1.cmml" xref="S2.E8.m1.3.3.1.1.13.2.3.2">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.13.2.3.2.2.cmml" xref="S2.E8.m1.3.3.1.1.13.2.3.2.2">ℋ</ci><ci id="S2.E8.m1.3.3.1.1.13.2.3.2.3.cmml" xref="S2.E8.m1.3.3.1.1.13.2.3.2.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.3c">\frac{1}{m}\boldsymbol{G}\boldsymbol{G}^{\top}=\frac{1}{m}\left[\boldsymbol{g}_{1},\cdots,\boldsymbol{g}_{m}\right]\otimes\left[\boldsymbol{g}_{1},\cdots,\boldsymbol{g}_{m}\right]=\frac{1}{m}\sum_{i}\boldsymbol{g}_{i}\otimes\boldsymbol{g}_{i}=\frac{1}{m}\sum_{i}\mathcal{I}_{i}=-\frac{1}{m}\sum_{i}\mathcal{H}_{i}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="Thmremark1.p1.9" class="ltx_p"><span id="Thmremark1.p1.9.1" class="ltx_text" style="font-size:90%;">The </span><math id="Thmremark1.p1.2.m1.1" class="ltx_Math" alttext="\mathcal{I}_{i}" display="inline"><semantics id="Thmremark1.p1.2.m1.1a"><msub id="Thmremark1.p1.2.m1.1.1" xref="Thmremark1.p1.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="Thmremark1.p1.2.m1.1.1.2" xref="Thmremark1.p1.2.m1.1.1.2.cmml">ℐ</mi><mi mathsize="90%" id="Thmremark1.p1.2.m1.1.1.3" xref="Thmremark1.p1.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmremark1.p1.2.m1.1b"><apply id="Thmremark1.p1.2.m1.1.1.cmml" xref="Thmremark1.p1.2.m1.1.1"><csymbol cd="ambiguous" id="Thmremark1.p1.2.m1.1.1.1.cmml" xref="Thmremark1.p1.2.m1.1.1">subscript</csymbol><ci id="Thmremark1.p1.2.m1.1.1.2.cmml" xref="Thmremark1.p1.2.m1.1.1.2">ℐ</ci><ci id="Thmremark1.p1.2.m1.1.1.3.cmml" xref="Thmremark1.p1.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmremark1.p1.2.m1.1c">\mathcal{I}_{i}</annotation></semantics></math><span id="Thmremark1.p1.9.2" class="ltx_text" style="font-size:90%;"> and </span><math id="Thmremark1.p1.3.m2.1" class="ltx_Math" alttext="\mathcal{H}_{i}" display="inline"><semantics id="Thmremark1.p1.3.m2.1a"><msub id="Thmremark1.p1.3.m2.1.1" xref="Thmremark1.p1.3.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="Thmremark1.p1.3.m2.1.1.2" xref="Thmremark1.p1.3.m2.1.1.2.cmml">ℋ</mi><mi mathsize="90%" id="Thmremark1.p1.3.m2.1.1.3" xref="Thmremark1.p1.3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Thmremark1.p1.3.m2.1b"><apply id="Thmremark1.p1.3.m2.1.1.cmml" xref="Thmremark1.p1.3.m2.1.1"><csymbol cd="ambiguous" id="Thmremark1.p1.3.m2.1.1.1.cmml" xref="Thmremark1.p1.3.m2.1.1">subscript</csymbol><ci id="Thmremark1.p1.3.m2.1.1.2.cmml" xref="Thmremark1.p1.3.m2.1.1.2">ℋ</ci><ci id="Thmremark1.p1.3.m2.1.1.3.cmml" xref="Thmremark1.p1.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmremark1.p1.3.m2.1c">\mathcal{H}_{i}</annotation></semantics></math><span id="Thmremark1.p1.9.3" class="ltx_text" style="font-size:90%;"> in the above formulation represent the Fisher Information matrix and Hessian matrix, respectively, and </span><math id="Thmremark1.p1.4.m3.1" class="ltx_Math" alttext="\otimes" display="inline"><semantics id="Thmremark1.p1.4.m3.1a"><mo mathsize="90%" id="Thmremark1.p1.4.m3.1.1" xref="Thmremark1.p1.4.m3.1.1.cmml">⊗</mo><annotation-xml encoding="MathML-Content" id="Thmremark1.p1.4.m3.1b"><csymbol cd="latexml" id="Thmremark1.p1.4.m3.1.1.cmml" xref="Thmremark1.p1.4.m3.1.1">tensor-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="Thmremark1.p1.4.m3.1c">\otimes</annotation></semantics></math><span id="Thmremark1.p1.9.4" class="ltx_text" style="font-size:90%;"> represents the tensor product in mathematics. The approximation is a positive semi-definite covariance matrix. The eigenvalue </span><math id="Thmremark1.p1.5.m4.1" class="ltx_Math" alttext="\lambda_{z}" display="inline"><semantics id="Thmremark1.p1.5.m4.1a"><msub id="Thmremark1.p1.5.m4.1.1" xref="Thmremark1.p1.5.m4.1.1.cmml"><mi mathsize="90%" id="Thmremark1.p1.5.m4.1.1.2" xref="Thmremark1.p1.5.m4.1.1.2.cmml">λ</mi><mi mathsize="90%" id="Thmremark1.p1.5.m4.1.1.3" xref="Thmremark1.p1.5.m4.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="Thmremark1.p1.5.m4.1b"><apply id="Thmremark1.p1.5.m4.1.1.cmml" xref="Thmremark1.p1.5.m4.1.1"><csymbol cd="ambiguous" id="Thmremark1.p1.5.m4.1.1.1.cmml" xref="Thmremark1.p1.5.m4.1.1">subscript</csymbol><ci id="Thmremark1.p1.5.m4.1.1.2.cmml" xref="Thmremark1.p1.5.m4.1.1.2">𝜆</ci><ci id="Thmremark1.p1.5.m4.1.1.3.cmml" xref="Thmremark1.p1.5.m4.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmremark1.p1.5.m4.1c">\lambda_{z}</annotation></semantics></math><span id="Thmremark1.p1.9.5" class="ltx_text" style="font-size:90%;"> and eigenvector </span><math id="Thmremark1.p1.6.m5.1" class="ltx_Math" alttext="v_{z}" display="inline"><semantics id="Thmremark1.p1.6.m5.1a"><msub id="Thmremark1.p1.6.m5.1.1" xref="Thmremark1.p1.6.m5.1.1.cmml"><mi mathsize="90%" id="Thmremark1.p1.6.m5.1.1.2" xref="Thmremark1.p1.6.m5.1.1.2.cmml">v</mi><mi mathsize="90%" id="Thmremark1.p1.6.m5.1.1.3" xref="Thmremark1.p1.6.m5.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="Thmremark1.p1.6.m5.1b"><apply id="Thmremark1.p1.6.m5.1.1.cmml" xref="Thmremark1.p1.6.m5.1.1"><csymbol cd="ambiguous" id="Thmremark1.p1.6.m5.1.1.1.cmml" xref="Thmremark1.p1.6.m5.1.1">subscript</csymbol><ci id="Thmremark1.p1.6.m5.1.1.2.cmml" xref="Thmremark1.p1.6.m5.1.1.2">𝑣</ci><ci id="Thmremark1.p1.6.m5.1.1.3.cmml" xref="Thmremark1.p1.6.m5.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmremark1.p1.6.m5.1c">v_{z}</annotation></semantics></math><span id="Thmremark1.p1.9.6" class="ltx_text" style="font-size:90%;"> is one-to-one correspondence and arranged based on the size of eigenvalue. For the eigenvalue </span><math id="Thmremark1.p1.7.m6.1" class="ltx_Math" alttext="\lambda_{z}" display="inline"><semantics id="Thmremark1.p1.7.m6.1a"><msub id="Thmremark1.p1.7.m6.1.1" xref="Thmremark1.p1.7.m6.1.1.cmml"><mi mathsize="90%" id="Thmremark1.p1.7.m6.1.1.2" xref="Thmremark1.p1.7.m6.1.1.2.cmml">λ</mi><mi mathsize="90%" id="Thmremark1.p1.7.m6.1.1.3" xref="Thmremark1.p1.7.m6.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="Thmremark1.p1.7.m6.1b"><apply id="Thmremark1.p1.7.m6.1.1.cmml" xref="Thmremark1.p1.7.m6.1.1"><csymbol cd="ambiguous" id="Thmremark1.p1.7.m6.1.1.1.cmml" xref="Thmremark1.p1.7.m6.1.1">subscript</csymbol><ci id="Thmremark1.p1.7.m6.1.1.2.cmml" xref="Thmremark1.p1.7.m6.1.1.2">𝜆</ci><ci id="Thmremark1.p1.7.m6.1.1.3.cmml" xref="Thmremark1.p1.7.m6.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmremark1.p1.7.m6.1c">\lambda_{z}</annotation></semantics></math><span id="Thmremark1.p1.9.7" class="ltx_text" style="font-size:90%;">, it is the curvature of the loss in the direction of </span><math id="Thmremark1.p1.8.m7.1" class="ltx_Math" alttext="\boldsymbol{v}_{z}" display="inline"><semantics id="Thmremark1.p1.8.m7.1a"><msub id="Thmremark1.p1.8.m7.1.1" xref="Thmremark1.p1.8.m7.1.1.cmml"><mi mathsize="90%" id="Thmremark1.p1.8.m7.1.1.2" xref="Thmremark1.p1.8.m7.1.1.2.cmml">𝒗</mi><mi mathsize="90%" id="Thmremark1.p1.8.m7.1.1.3" xref="Thmremark1.p1.8.m7.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="Thmremark1.p1.8.m7.1b"><apply id="Thmremark1.p1.8.m7.1.1.cmml" xref="Thmremark1.p1.8.m7.1.1"><csymbol cd="ambiguous" id="Thmremark1.p1.8.m7.1.1.1.cmml" xref="Thmremark1.p1.8.m7.1.1">subscript</csymbol><ci id="Thmremark1.p1.8.m7.1.1.2.cmml" xref="Thmremark1.p1.8.m7.1.1.2">𝒗</ci><ci id="Thmremark1.p1.8.m7.1.1.3.cmml" xref="Thmremark1.p1.8.m7.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmremark1.p1.8.m7.1c">\boldsymbol{v}_{z}</annotation></semantics></math><span id="Thmremark1.p1.9.8" class="ltx_text" style="font-size:90%;">. Since the distribution of the eigenvalues could affect the training behavior, e.g the first-order optimization methods slow down significantly when </span><math id="Thmremark1.p1.9.m8.1" class="ltx_Math" alttext="\left\{\lambda_{z}\right\}" display="inline"><semantics id="Thmremark1.p1.9.m8.1a"><mrow id="Thmremark1.p1.9.m8.1.1.1" xref="Thmremark1.p1.9.m8.1.1.2.cmml"><mo id="Thmremark1.p1.9.m8.1.1.1.2" xref="Thmremark1.p1.9.m8.1.1.2.cmml">{</mo><msub id="Thmremark1.p1.9.m8.1.1.1.1" xref="Thmremark1.p1.9.m8.1.1.1.1.cmml"><mi mathsize="90%" id="Thmremark1.p1.9.m8.1.1.1.1.2" xref="Thmremark1.p1.9.m8.1.1.1.1.2.cmml">λ</mi><mi mathsize="90%" id="Thmremark1.p1.9.m8.1.1.1.1.3" xref="Thmremark1.p1.9.m8.1.1.1.1.3.cmml">z</mi></msub><mo id="Thmremark1.p1.9.m8.1.1.1.3" xref="Thmremark1.p1.9.m8.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="Thmremark1.p1.9.m8.1b"><set id="Thmremark1.p1.9.m8.1.1.2.cmml" xref="Thmremark1.p1.9.m8.1.1.1"><apply id="Thmremark1.p1.9.m8.1.1.1.1.cmml" xref="Thmremark1.p1.9.m8.1.1.1.1"><csymbol cd="ambiguous" id="Thmremark1.p1.9.m8.1.1.1.1.1.cmml" xref="Thmremark1.p1.9.m8.1.1.1.1">subscript</csymbol><ci id="Thmremark1.p1.9.m8.1.1.1.1.2.cmml" xref="Thmremark1.p1.9.m8.1.1.1.1.2">𝜆</ci><ci id="Thmremark1.p1.9.m8.1.1.1.1.3.cmml" xref="Thmremark1.p1.9.m8.1.1.1.1.3">𝑧</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="Thmremark1.p1.9.m8.1c">\left\{\lambda_{z}\right\}</annotation></semantics></math><span id="Thmremark1.p1.9.9" class="ltx_text" style="font-size:90%;"> are highly spread out, we can get rid of those insignificant directions and only use the directions with the large curvature.
Thus, the proposed principal gradient-based server aggregation can mitigate conflicting gradients by prioritizing principal directions that benefit all clients while discarding conflict-contributing directions. The results in Fig. </span><a href="#S2.F2" title="Figure 2 ‣ 2.2 Global Loss Objective Decomposition ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="Thmremark1.p1.9.10" class="ltx_text" style="font-size:90%;"> (blue lines) also demonstrate the effectiveness of the proposed principal gradient-based server aggregation, as it significantly reduces aggregation loss.</span></p>
</div>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Experimental Setup</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.4" class="ltx_p"><span id="S3.SS1.p1.4.1" class="ltx_text" style="font-size:90%;">We evaluate our method on two medical image classification datasets: Retina </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.4.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib30" title="" class="ltx_ref">30</a><span id="S3.SS1.p1.4.3.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.4.4" class="ltx_text" style="font-size:90%;"> with 5 clients and COVID-FL </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.4.5.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib30" title="" class="ltx_ref">30</a><span id="S3.SS1.p1.4.6.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.4.7" class="ltx_text" style="font-size:90%;">, a real-world federated dataset with 12 clients that exhibits both shifts in label and feature distributions. Following </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.4.8.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib30" title="" class="ltx_ref">30</a><span id="S3.SS1.p1.4.9.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.4.10" class="ltx_text" style="font-size:90%;">, we construct different levels of data heterogeneity for Retina by constructing label shifts using Dirichlet distribution with </span><math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi mathsize="90%" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\alpha</annotation></semantics></math><span id="S3.SS1.p1.4.11" class="ltx_text" style="font-size:90%;"> 100, 0.1, 0.5 for split1, 2, 3 respectively, i.e., Split-1 (IID), Split-2 (moderate non-IID), and Split-3 (severe non-IID). The ResNet-50 </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.4.12.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib7" title="" class="ltx_ref">7</a><span id="S3.SS1.p1.4.13.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.4.14" class="ltx_text" style="font-size:90%;"> is adopted in all experiments. We compare our method with FedAvg </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.4.15.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib18" title="" class="ltx_ref">18</a><span id="S3.SS1.p1.4.16.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.4.17" class="ltx_text" style="font-size:90%;">, FedProx </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.4.18.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib13" title="" class="ltx_ref">13</a><span id="S3.SS1.p1.4.19.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.4.20" class="ltx_text" style="font-size:90%;">, FedBN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.4.21.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib15" title="" class="ltx_ref">15</a><span id="S3.SS1.p1.4.22.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.4.23" class="ltx_text" style="font-size:90%;">, FedPAC </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.4.24.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib28" title="" class="ltx_ref">28</a><span id="S3.SS1.p1.4.25.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.4.26" class="ltx_text" style="font-size:90%;">, and FedGH </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.4.27.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib34" title="" class="ltx_ref">34</a><span id="S3.SS1.p1.4.28.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.4.29" class="ltx_text" style="font-size:90%;">. For optimization, we adopt the SGD optimizer </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS1.p1.4.30.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib24" title="" class="ltx_ref">24</a><span id="S3.SS1.p1.4.31.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS1.p1.4.32" class="ltx_text" style="font-size:90%;"> with a learning rate of 0.01 for Retina and 0.005 for COVID-FL. The batch size is set to 50. The number of global communication rounds is set to 200, and the number of local training epochs is set to 1. We choose </span><math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi mathsize="90%" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\lambda</annotation></semantics></math><span id="S3.SS1.p1.4.33" class="ltx_text" style="font-size:90%;"> values of 0.1, 0.03, and 0.03 for Split-1, Split-2, and Split-3 of Retina, respectively, and 0.01 for COVID-FL. We set </span><math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="L=0.8m" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi mathsize="90%" id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">L</mi><mo mathsize="90%" id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mn mathsize="90%" id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">0.8</mn><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.1.1.3.1" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><eq id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></eq><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝐿</ci><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><times id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1"></times><cn type="float" id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">0.8</cn><ci id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">L=0.8m</annotation></semantics></math><span id="S3.SS1.p1.4.34" class="ltx_text" style="font-size:90%;">, where </span><math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi mathsize="90%" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">m</annotation></semantics></math><span id="S3.SS1.p1.4.35" class="ltx_text" style="font-size:90%;"> is the number of selected participating clients in each round. We set the client sampling rate to 1, unless otherwise stated.</span></p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Evaluation Results</h3>

<figure id="S3.T2" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.T2.fig1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:195.1pt;">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure">Table 1: </span>The comparison of final test accuracy (%) of different methods.</figcaption>
<table id="S3.T2.fig1.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.fig1.3.1.1" class="ltx_tr">
<th id="S3.T2.fig1.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S3.T2.fig1.3.1.1.1.1" class="ltx_text" style="font-size:90%;">Method</span></th>
<th id="S3.T2.fig1.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3"><span id="S3.T2.fig1.3.1.1.2.1" class="ltx_text" style="font-size:90%;">Retina</span></th>
<th id="S3.T2.fig1.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T2.fig1.3.1.1.3.1" class="ltx_text" style="font-size:90%;">COVID-FL</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.fig1.3.2.1" class="ltx_tr">
<th id="S3.T2.fig1.3.2.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<td id="S3.T2.fig1.3.2.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.2.1.2.1" class="ltx_text" style="font-size:90%;">Split-1</span></td>
<td id="S3.T2.fig1.3.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.2.1.3.1" class="ltx_text" style="font-size:90%;">Split-2</span></td>
<td id="S3.T2.fig1.3.2.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.2.1.4.1" class="ltx_text" style="font-size:90%;">Split-3</span></td>
<td id="S3.T2.fig1.3.2.1.5" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="S3.T2.fig1.3.3.2" class="ltx_tr">
<th id="S3.T2.fig1.3.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T2.fig1.3.3.2.1.1" class="ltx_text" style="font-size:90%;">FedAvg</span></th>
<td id="S3.T2.fig1.3.3.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.3.2.2.1" class="ltx_text" style="font-size:90%;">83.63</span></td>
<td id="S3.T2.fig1.3.3.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.3.2.3.1" class="ltx_text" style="font-size:90%;">82.26</span></td>
<td id="S3.T2.fig1.3.3.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.3.2.4.1" class="ltx_text" style="font-size:90%;">81.13</span></td>
<td id="S3.T2.fig1.3.3.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.3.2.5.1" class="ltx_text" style="font-size:90%;">79.86</span></td>
</tr>
<tr id="S3.T2.fig1.3.4.3" class="ltx_tr">
<th id="S3.T2.fig1.3.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T2.fig1.3.4.3.1.1" class="ltx_text" style="font-size:90%;">FedProx</span></th>
<td id="S3.T2.fig1.3.4.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.4.3.2.1" class="ltx_text" style="font-size:90%;">84.17</span></td>
<td id="S3.T2.fig1.3.4.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.4.3.3.1" class="ltx_text" style="font-size:90%;">83.53</span></td>
<td id="S3.T2.fig1.3.4.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.4.3.4.1" class="ltx_text" style="font-size:90%;">81.20</span></td>
<td id="S3.T2.fig1.3.4.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.4.3.5.1" class="ltx_text" style="font-size:90%;">81.88</span></td>
</tr>
<tr id="S3.T2.fig1.3.5.4" class="ltx_tr">
<th id="S3.T2.fig1.3.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T2.fig1.3.5.4.1.1" class="ltx_text" style="font-size:90%;">FedBN</span></th>
<td id="S3.T2.fig1.3.5.4.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.5.4.2.1" class="ltx_text" style="font-size:90%;">83.91</span></td>
<td id="S3.T2.fig1.3.5.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.5.4.3.1" class="ltx_text" style="font-size:90%;">75.91</span></td>
<td id="S3.T2.fig1.3.5.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.5.4.4.1" class="ltx_text" style="font-size:90%;">65.25</span></td>
<td id="S3.T2.fig1.3.5.4.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.5.4.5.1" class="ltx_text" style="font-size:90%;">56.34</span></td>
</tr>
<tr id="S3.T2.fig1.3.6.5" class="ltx_tr">
<th id="S3.T2.fig1.3.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T2.fig1.3.6.5.1.1" class="ltx_text" style="font-size:90%;">FedPAC</span></th>
<td id="S3.T2.fig1.3.6.5.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.6.5.2.1" class="ltx_text" style="font-size:90%;">78.01</span></td>
<td id="S3.T2.fig1.3.6.5.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.6.5.3.1" class="ltx_text" style="font-size:90%;">71.64</span></td>
<td id="S3.T2.fig1.3.6.5.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.6.5.4.1" class="ltx_text" style="font-size:90%;">52.81</span></td>
<td id="S3.T2.fig1.3.6.5.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.6.5.5.1" class="ltx_text" style="font-size:90%;">81.63</span></td>
</tr>
<tr id="S3.T2.fig1.3.7.6" class="ltx_tr">
<th id="S3.T2.fig1.3.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T2.fig1.3.7.6.1.1" class="ltx_text" style="font-size:90%;">FedGH</span></th>
<td id="S3.T2.fig1.3.7.6.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.7.6.2.1" class="ltx_text" style="font-size:90%;">83.90</span></td>
<td id="S3.T2.fig1.3.7.6.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.7.6.3.1" class="ltx_text" style="font-size:90%;">83.33</span></td>
<td id="S3.T2.fig1.3.7.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.7.6.4.1" class="ltx_text" style="font-size:90%;">81.56</span></td>
<td id="S3.T2.fig1.3.7.6.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.fig1.3.7.6.5.1" class="ltx_text" style="font-size:90%;">82.26</span></td>
</tr>
<tr id="S3.T2.fig1.3.8.7" class="ltx_tr">
<th id="S3.T2.fig1.3.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t"><span id="S3.T2.fig1.3.8.7.1.1" class="ltx_text" style="font-size:90%;">Ours</span></th>
<td id="S3.T2.fig1.3.8.7.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig1.3.8.7.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">85.20</span></td>
<td id="S3.T2.fig1.3.8.7.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig1.3.8.7.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">83.83</span></td>
<td id="S3.T2.fig1.3.8.7.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig1.3.8.7.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">82.30</span></td>
<td id="S3.T2.fig1.3.8.7.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.fig1.3.8.7.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">83.87</span></td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.T2.8" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:195.1pt;">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_figure">Table 2: </span>Ablation study. <span id="S3.T2.8.15.1" class="ltx_text ltx_font_bold">Margin</span> denotes margin control regularization. <span id="S3.T2.8.16.2" class="ltx_text ltx_font_bold">Principal</span> denotes principal gradient-based server aggregation.</figcaption>
<table id="S3.T2.8.8" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.8.8.9.1" class="ltx_tr">
<th id="S3.T2.8.8.9.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S3.T2.8.8.9.1.1.1" class="ltx_text" style="font-size:90%;">Margin</span></th>
<th id="S3.T2.8.8.9.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S3.T2.8.8.9.1.2.1" class="ltx_text" style="font-size:90%;">Principal</span></th>
<th id="S3.T2.8.8.9.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3"><span id="S3.T2.8.8.9.1.3.1" class="ltx_text" style="font-size:90%;">Retina</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.8.8.10.1" class="ltx_tr">
<th id="S3.T2.8.8.10.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S3.T2.8.8.10.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<td id="S3.T2.8.8.10.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.8.8.10.1.3.1" class="ltx_text" style="font-size:90%;">Split-1</span></td>
<td id="S3.T2.8.8.10.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.8.8.10.1.4.1" class="ltx_text" style="font-size:90%;">Split-2</span></td>
<td id="S3.T2.8.8.10.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.8.8.10.1.5.1" class="ltx_text" style="font-size:90%;">Split-3</span></td>
</tr>
<tr id="S3.T2.2.2.2" class="ltx_tr">
<th id="S3.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><math id="S3.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.T2.1.1.1.1.m1.1a"><mo mathsize="90%" id="S3.T2.1.1.1.1.m1.1.1" xref="S3.T2.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.1.m1.1b"><times id="S3.T2.1.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.1.m1.1c">\times</annotation></semantics></math></th>
<th id="S3.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><math id="S3.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.T2.2.2.2.2.m1.1a"><mo mathsize="90%" id="S3.T2.2.2.2.2.m1.1.1" xref="S3.T2.2.2.2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.2.m1.1b"><times id="S3.T2.2.2.2.2.m1.1.1.cmml" xref="S3.T2.2.2.2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.2.m1.1c">\times</annotation></semantics></math></th>
<td id="S3.T2.2.2.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.2.2.2.3.1" class="ltx_text" style="font-size:90%;">83.63</span></td>
<td id="S3.T2.2.2.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.2.2.2.4.1" class="ltx_text" style="font-size:90%;">82.26</span></td>
<td id="S3.T2.2.2.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.2.2.2.5.1" class="ltx_text" style="font-size:90%;">81.13</span></td>
</tr>
<tr id="S3.T2.4.4.4" class="ltx_tr">
<th id="S3.T2.3.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><math id="S3.T2.3.3.3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.T2.3.3.3.1.m1.1a"><mo mathsize="90%" id="S3.T2.3.3.3.1.m1.1.1" xref="S3.T2.3.3.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.3.1.m1.1b"><times id="S3.T2.3.3.3.1.m1.1.1.cmml" xref="S3.T2.3.3.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.3.1.m1.1c">\times</annotation></semantics></math></th>
<th id="S3.T2.4.4.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><math id="S3.T2.4.4.4.2.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S3.T2.4.4.4.2.m1.1a"><mi mathsize="90%" mathvariant="normal" id="S3.T2.4.4.4.2.m1.1.1" xref="S3.T2.4.4.4.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.4.2.m1.1b"><ci id="S3.T2.4.4.4.2.m1.1.1.cmml" xref="S3.T2.4.4.4.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.4.2.m1.1c">\checkmark</annotation></semantics></math></th>
<td id="S3.T2.4.4.4.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.4.4.4.3.1" class="ltx_text" style="font-size:90%;">84.76</span></td>
<td id="S3.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.4.4.4.4.1" class="ltx_text" style="font-size:90%;">82.67</span></td>
<td id="S3.T2.4.4.4.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.4.4.4.5.1" class="ltx_text" style="font-size:90%;">81.66</span></td>
</tr>
<tr id="S3.T2.6.6.6" class="ltx_tr">
<th id="S3.T2.5.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><math id="S3.T2.5.5.5.1.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S3.T2.5.5.5.1.m1.1a"><mi mathsize="90%" mathvariant="normal" id="S3.T2.5.5.5.1.m1.1.1" xref="S3.T2.5.5.5.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S3.T2.5.5.5.1.m1.1b"><ci id="S3.T2.5.5.5.1.m1.1.1.cmml" xref="S3.T2.5.5.5.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.5.5.5.1.m1.1c">\checkmark</annotation></semantics></math></th>
<th id="S3.T2.6.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><math id="S3.T2.6.6.6.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S3.T2.6.6.6.2.m1.1a"><mo mathsize="90%" id="S3.T2.6.6.6.2.m1.1.1" xref="S3.T2.6.6.6.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T2.6.6.6.2.m1.1b"><times id="S3.T2.6.6.6.2.m1.1.1.cmml" xref="S3.T2.6.6.6.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.6.6.6.2.m1.1c">\times</annotation></semantics></math></th>
<td id="S3.T2.6.6.6.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.6.6.6.3.1" class="ltx_text" style="font-size:90%;">84.63</span></td>
<td id="S3.T2.6.6.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.6.6.6.4.1" class="ltx_text" style="font-size:90%;">83.5</span></td>
<td id="S3.T2.6.6.6.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.6.6.6.5.1" class="ltx_text" style="font-size:90%;">81.96</span></td>
</tr>
<tr id="S3.T2.8.8.8" class="ltx_tr">
<th id="S3.T2.7.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t"><math id="S3.T2.7.7.7.1.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S3.T2.7.7.7.1.m1.1a"><mi mathsize="90%" mathvariant="normal" id="S3.T2.7.7.7.1.m1.1.1" xref="S3.T2.7.7.7.1.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S3.T2.7.7.7.1.m1.1b"><ci id="S3.T2.7.7.7.1.m1.1.1.cmml" xref="S3.T2.7.7.7.1.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.7.7.7.1.m1.1c">\checkmark</annotation></semantics></math></th>
<th id="S3.T2.8.8.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_t"><math id="S3.T2.8.8.8.2.m1.1" class="ltx_Math" alttext="\checkmark" display="inline"><semantics id="S3.T2.8.8.8.2.m1.1a"><mi mathsize="90%" mathvariant="normal" id="S3.T2.8.8.8.2.m1.1.1" xref="S3.T2.8.8.8.2.m1.1.1.cmml">✓</mi><annotation-xml encoding="MathML-Content" id="S3.T2.8.8.8.2.m1.1b"><ci id="S3.T2.8.8.8.2.m1.1.1.cmml" xref="S3.T2.8.8.8.2.m1.1.1">✓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.8.8.8.2.m1.1c">\checkmark</annotation></semantics></math></th>
<td id="S3.T2.8.8.8.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.8.8.8.3.1" class="ltx_text" style="font-size:90%;">85.20</span></td>
<td id="S3.T2.8.8.8.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.8.8.8.4.1" class="ltx_text" style="font-size:90%;">83.83</span></td>
<td id="S3.T2.8.8.8.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T2.8.8.8.5.1" class="ltx_text" style="font-size:90%;">82.30</span></td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p"><span id="S3.SS2.p1.1.1" class="ltx_text" style="font-size:90%;">As demonstrated in Table </span><a href="#S3.T2" title="Table 2 ‣ 3.2 Evaluation Results ‣ 3 Experiments ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S3.SS2.p1.1.2" class="ltx_text" style="font-size:90%;">, our method outperforms all compared methods in all datasets with all levels of data heterogeneity. Importantly, as the data heterogeneity increases (i.e., from Split-1 to Split-3 in Retina), the performance improvement compared to the second-best method (i.e., FedGH) also increases (i.e., from 0.04% to 2.20%), which demonstrates the ability of our method to effectively alleviate the negative impact of data heterogeneity.</span></p>
</div>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>The comparison of final test accuracy (%) of different methods on Retina with 50 clients. We apply client sampling with rate 0.1 for FL training.</figcaption>
<table id="S3.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T3.3.1.1" class="ltx_tr">
<th id="S3.T3.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T3.3.1.1.1.1" class="ltx_text" style="font-size:90%;">Method</span></th>
<td id="S3.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.3.1.1.2.1" class="ltx_text" style="font-size:90%;">FedAvg</span></td>
<td id="S3.T3.3.1.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.3.1.1.3.1" class="ltx_text" style="font-size:90%;">FedProx</span></td>
<td id="S3.T3.3.1.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.3.1.1.4.1" class="ltx_text" style="font-size:90%;">FedBN</span></td>
<td id="S3.T3.3.1.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.3.1.1.5.1" class="ltx_text" style="font-size:90%;">FedPAC</span></td>
<td id="S3.T3.3.1.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.3.1.1.6.1" class="ltx_text" style="font-size:90%;">FedGH</span></td>
<td id="S3.T3.3.1.1.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T3.3.1.1.7.1" class="ltx_text" style="font-size:90%;">Ours</span></td>
</tr>
<tr id="S3.T3.3.2.2" class="ltx_tr">
<th id="S3.T3.3.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t"><span id="S3.T3.3.2.2.1.1" class="ltx_text" style="font-size:90%;">Accuracy (%)</span></th>
<td id="S3.T3.3.2.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T3.3.2.2.2.1" class="ltx_text" style="font-size:90%;">67.43</span></td>
<td id="S3.T3.3.2.2.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T3.3.2.2.3.1" class="ltx_text" style="font-size:90%;">69.87</span></td>
<td id="S3.T3.3.2.2.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T3.3.2.2.4.1" class="ltx_text" style="font-size:90%;">68.40</span></td>
<td id="S3.T3.3.2.2.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T3.3.2.2.5.1" class="ltx_text" style="font-size:90%;">66.59</span></td>
<td id="S3.T3.3.2.2.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T3.3.2.2.6.1" class="ltx_text" style="font-size:90%;">70.33</span></td>
<td id="S3.T3.3.2.2.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S3.T3.3.2.2.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">71.30</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Analysis</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p"><span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Ablation Study.</span><span id="S3.SS3.p1.1.2" class="ltx_text" style="font-size:90%;">
As demonstrated in Table </span><a href="#S3.T2" title="Table 2 ‣ 3.2 Evaluation Results ‣ 3 Experiments ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S3.SS3.p1.1.3" class="ltx_text" style="font-size:90%;">, both of them can help improve the average test accuracy and the combination of them is able to achieve the most satisfactory model performance, which demonstrates the effectiveness of each component.</span></p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.1" class="ltx_p"><span id="S3.SS3.p2.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Ability of Loss Reduction.</span><span id="S3.SS3.p2.1.2" class="ltx_text" style="font-size:90%;">
We simulate different levels of data heterogeneity using the Dirichlet distribution </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS3.p2.1.3.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib8" title="" class="ltx_ref">8</a><span id="S3.SS3.p2.1.4.2" class="ltx_text" style="font-size:90%;">]</span></cite><span id="S3.SS3.p2.1.5" class="ltx_text" style="font-size:90%;"> with the concentration parameter </span><math id="S3.SS3.p2.1.m1.5" class="ltx_Math" alttext="\alpha\in\{100,10,1,0.1,0.01\}" display="inline"><semantics id="S3.SS3.p2.1.m1.5a"><mrow id="S3.SS3.p2.1.m1.5.6" xref="S3.SS3.p2.1.m1.5.6.cmml"><mi mathsize="90%" id="S3.SS3.p2.1.m1.5.6.2" xref="S3.SS3.p2.1.m1.5.6.2.cmml">α</mi><mo mathsize="90%" id="S3.SS3.p2.1.m1.5.6.1" xref="S3.SS3.p2.1.m1.5.6.1.cmml">∈</mo><mrow id="S3.SS3.p2.1.m1.5.6.3.2" xref="S3.SS3.p2.1.m1.5.6.3.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.SS3.p2.1.m1.5.6.3.2.1" xref="S3.SS3.p2.1.m1.5.6.3.1.cmml">{</mo><mn mathsize="90%" id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">100</mn><mo mathsize="90%" id="S3.SS3.p2.1.m1.5.6.3.2.2" xref="S3.SS3.p2.1.m1.5.6.3.1.cmml">,</mo><mn mathsize="90%" id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml">10</mn><mo mathsize="90%" id="S3.SS3.p2.1.m1.5.6.3.2.3" xref="S3.SS3.p2.1.m1.5.6.3.1.cmml">,</mo><mn mathsize="90%" id="S3.SS3.p2.1.m1.3.3" xref="S3.SS3.p2.1.m1.3.3.cmml">1</mn><mo mathsize="90%" id="S3.SS3.p2.1.m1.5.6.3.2.4" xref="S3.SS3.p2.1.m1.5.6.3.1.cmml">,</mo><mn mathsize="90%" id="S3.SS3.p2.1.m1.4.4" xref="S3.SS3.p2.1.m1.4.4.cmml">0.1</mn><mo mathsize="90%" id="S3.SS3.p2.1.m1.5.6.3.2.5" xref="S3.SS3.p2.1.m1.5.6.3.1.cmml">,</mo><mn mathsize="90%" id="S3.SS3.p2.1.m1.5.5" xref="S3.SS3.p2.1.m1.5.5.cmml">0.01</mn><mo maxsize="90%" minsize="90%" id="S3.SS3.p2.1.m1.5.6.3.2.6" xref="S3.SS3.p2.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.5b"><apply id="S3.SS3.p2.1.m1.5.6.cmml" xref="S3.SS3.p2.1.m1.5.6"><in id="S3.SS3.p2.1.m1.5.6.1.cmml" xref="S3.SS3.p2.1.m1.5.6.1"></in><ci id="S3.SS3.p2.1.m1.5.6.2.cmml" xref="S3.SS3.p2.1.m1.5.6.2">𝛼</ci><set id="S3.SS3.p2.1.m1.5.6.3.1.cmml" xref="S3.SS3.p2.1.m1.5.6.3.2"><cn type="integer" id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">100</cn><cn type="integer" id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2">10</cn><cn type="integer" id="S3.SS3.p2.1.m1.3.3.cmml" xref="S3.SS3.p2.1.m1.3.3">1</cn><cn type="float" id="S3.SS3.p2.1.m1.4.4.cmml" xref="S3.SS3.p2.1.m1.4.4">0.1</cn><cn type="float" id="S3.SS3.p2.1.m1.5.5.cmml" xref="S3.SS3.p2.1.m1.5.5">0.01</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.5c">\alpha\in\{100,10,1,0.1,0.01\}</annotation></semantics></math><span id="S3.SS3.p2.1.6" class="ltx_text" style="font-size:90%;">
on the Retina dataset. First, we train local models with or without margin control regularization. Second, we aggregate the local models trained in the naive way with principal gradient-based aggregation or naive server aggregation. As shown in Fig. </span><a href="#S2.F2" title="Figure 2 ‣ 2.2 Global Loss Objective Decomposition ‣ 2 Methodology ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">2</span></a><span id="S3.SS3.p2.1.7" class="ltx_text" style="font-size:90%;">, margin control regularization significantly reduces distribution shift loss compared with naive local training (red lines), and principal gradient-based aggregation significantly reduces aggregation loss compared with naive server aggregation (blue lines).</span></p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.1" class="ltx_p"><span id="S3.SS3.p3.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Generalization to Multiple Clients.</span><span id="S3.SS3.p3.1.2" class="ltx_text" style="font-size:90%;">
We further simulate 50 clients on the Retina dataset using the Dirichlet distribution with the concentration parameter </span><math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi mathsize="90%" id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">α</mi><mo mathsize="90%" id="S3.SS3.p3.1.m1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><eq id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1"></eq><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝛼</ci><cn type="float" id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\alpha=0.5</annotation></semantics></math><span id="S3.SS3.p3.1.3" class="ltx_text" style="font-size:90%;">. As shown in Table </span><a href="#S3.T3" title="Table 3 ‣ 3.2 Evaluation Results ‣ 3 Experiments ‣ Tackling Data Heterogeneity in Federated Learning via Loss Decomposition" class="ltx_ref" style="font-size:90%;"><span class="ltx_text ltx_ref_tag">3</span></a><span id="S3.SS3.p3.1.4" class="ltx_text" style="font-size:90%;">, our method also achieves the best result with multiple clients, which demonstrates the generalizability of our method.</span></p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section" style="font-size:90%;">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusion</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text" style="font-size:90%;">In this paper, we propose a global loss decomposition to understand the impact of data heterogeneity on FL performance, which decomposes the global loss into three terms: local loss, distribution shift loss and aggregation loss. We then propose two strategies, margin control regularization and principal gradient-based server aggregation, to reduce them jointly, thus tackling data heterogeneity in FL. Our loss decomposition provides an analytical tool for analysing the impact of different operations on FL performance, and our proposed margin control regularization and principal gradient-based server aggregation can seamlessly integrate into any FL frameworks. Extensive experiments demonstrate that our algorithm effectively reduces the impact of data heterogeneity on FL performance.</span></p>
</div>
<div id="S4.p2" class="ltx_para">
<span id="S4.p2.1" class="ltx_ERROR undefined">{credits}</span>
</div>
<section id="S4.SS0.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsubsection">4.0.1 </span>Acknowledgements</h4>

<div id="S4.SS0.SSS1.p1" class="ltx_para">
<p id="S4.SS0.SSS1.p1.1" class="ltx_p"><span id="S4.SS0.SSS1.p1.1.1" class="ltx_text" style="font-size:90%;">This work was supported by National Natural Science Foundation of China (62306253) Early career fund (27204623), Guangdong Natural Science Fund-General Programme (2024A1515010233), and UCSC hellman fellowship.</span></p>
</div>
</section>
<section id="S4.SS0.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection" style="font-size:90%;">
<span class="ltx_tag ltx_tag_subsubsection">4.0.2 </span><span id="S4.SS0.SSS2.1.1" class="ltx_ERROR undefined">\discintname</span>
</h4>

<div id="S4.SS0.SSS2.p1" class="ltx_para">
<p id="S4.SS0.SSS2.p1.1" class="ltx_p"><span id="S4.SS0.SSS2.p1.1.1" class="ltx_text" style="font-size:90%;">The authors have no competing interests to declare that are relevant to the content of this article.</span></p>
</div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
An, X., Shen, L., Hu, H., Luo, Y.: Federated learning with manifold regularization and normalized update reaggregation. Advances in Neural Information Processing Systems </span><span id="bib.bib1.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">36</span><span id="bib.bib1.3.3" class="ltx_text" style="font-size:90%;"> (2024)
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Charles, Z., Garrett, Z., Huo, Z., Shmulyian, S., Smith, V.: On large-cohort training for federated learning. Advances in neural information processing systems </span><span id="bib.bib2.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">34</span><span id="bib.bib2.3.3" class="ltx_text" style="font-size:90%;">, 20461–20475 (2021)
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Dayan, I., Roth, H.R., Zhong, A., Harouni, A., Gentili, A., Abidin, A.Z., Liu, A., Costa, A.B., Wood, B.J., Tsai, C.S., et al.: Federated learning for predicting clinical outcomes in patients with covid-19. Nature medicine </span><span id="bib.bib3.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">27</span><span id="bib.bib3.3.3" class="ltx_text" style="font-size:90%;">(10), 1735–1743 (2021)
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Geirhos, R., Jacobsen, J.H., Michaelis, C., Zemel, R., Brendel, W., Bethge, M., Wichmann, F.A.: Shortcut learning in deep neural networks. Nature Machine Intelligence </span><span id="bib.bib4.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">2</span><span id="bib.bib4.3.3" class="ltx_text" style="font-size:90%;">(11), 665–673 (2020)
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Guo, Y., Guo, K., Cao, X., Wu, T., Chang, Y.: Out-of-distribution generalization of federated learning via implicit invariant relationships (2023)
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Hamilton, W.L., Ying, R., Leskovec, J.: Representation learning on graphs: Methods and applications. arXiv preprint arXiv:1709.05584 (2017)
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
He, K., Zhang, X., Ren, S., Sun, J.: Deep residual learning for image recognition. In: Proceedings of the IEEE conference on computer vision and pattern recognition. pp. 770–778 (2016)
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Hsu, T.M.H., Qi, H., Brown, M.: Measuring the effects of non-identical data distribution for federated visual classification. arXiv preprint arXiv:1909.06335 (2019)
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Kaissis, G.A., Makowski, M.R., Rückert, D., Braren, R.F.: Secure, privacy-preserving and federated machine learning in medical imaging. Nature Machine Intelligence </span><span id="bib.bib9.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">2</span><span id="bib.bib9.3.3" class="ltx_text" style="font-size:90%;">(6), 305–311 (2020)
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Kalra, S., Wen, J., Cresswell, J.C., Volkovs, M., Tizhoosh, H.: Decentralized federated learning through proxy model sharing. Nature communications </span><span id="bib.bib10.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">14</span><span id="bib.bib10.3.3" class="ltx_text" style="font-size:90%;">(1),  2899 (2023)
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Karimireddy, S.P., Kale, S., Mohri, M., Reddi, S., Stich, S., Suresh, A.T.: Scaffold: Stochastic controlled averaging for federated learning. In: International conference on machine learning. pp. 5132–5143. PMLR (2020)
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Koh, P.W., Sagawa, S., Marklund, H., Xie, S.M., Zhang, M., Balsubramani, A., Hu, W., Yasunaga, M., Phillips, R.L., Gao, I., et al.: Wilds: A benchmark of in-the-wild distribution shifts. In: International Conference on Machine Learning. pp. 5637–5664. PMLR (2021)
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Li, T., Sahu, A.K., Zaheer, M., Sanjabi, M., Talwalkar, A., Smith, V.: Federated optimization in heterogeneous networks. Proceedings of Machine learning and systems </span><span id="bib.bib13.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">2</span><span id="bib.bib13.3.3" class="ltx_text" style="font-size:90%;">, 429–450 (2020)
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Li, X., Gu, Y., Dvornek, N., Staib, L.H., Ventola, P., Duncan, J.S.: Multi-site fmri analysis using privacy-preserving federated learning and domain adaptation: Abide results. Medical Image Analysis </span><span id="bib.bib14.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">65</span><span id="bib.bib14.3.3" class="ltx_text" style="font-size:90%;">, 101765 (2020)
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Li, X., Jiang, M., Zhang, X., Kamp, M., Dou, Q.: Fedbn: Federated learning on non-iid features via local batch normalization. arXiv preprint arXiv:2102.07623 (2021)
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Liu, C., Lou, C., Wang, R., Xi, A.Y., Shen, L., Yan, J.: Deep neural network fusion via graph matching with applications to model ensemble and federated learning. In: International Conference on Machine Learning. pp. 13857–13869. PMLR (2022)
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Ma, X., Zhang, J., Guo, S., Xu, W.: Layer-wised model aggregation for personalized federated learning. In: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. pp. 10092–10101 (2022)
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
McMahan, B., Moore, E., Ramage, D., Hampson, S., y Arcas, B.A.: Communication-efficient learning of deep networks from decentralized data. In: Artificial intelligence and statistics. pp. 1273–1282. PMLR (2017)
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Nguyen, A.T., Torr, P., Lim, S.N.: Fedsr: A simple and effective domain generalization method for federated learning. Advances in Neural Information Processing Systems </span><span id="bib.bib19.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">35</span><span id="bib.bib19.3.3" class="ltx_text" style="font-size:90%;">, 38831–38843 (2022)
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Pati, S., Baid, U., Edwards, B., Sheller, M., Wang, S.H., Reina, G.A., Foley, P., Gruzdev, A., Karkada, D., Davatzikos, C., et al.: Federated learning enables big data for rare cancer boundary detection. Nature communications </span><span id="bib.bib20.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">13</span><span id="bib.bib20.3.3" class="ltx_text" style="font-size:90%;">(1),  7346 (2022)
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Puli, A.M., Zhang, L., Wald, Y., Ranganath, R.: Don’t blame dataset shift! shortcut learning due to gradients and cross entropy. Advances in Neural Information Processing Systems </span><span id="bib.bib21.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">36</span><span id="bib.bib21.3.3" class="ltx_text" style="font-size:90%;"> (2024)
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Qu, L., Balachandar, N., Rubin, D.L.: An experimental study of data heterogeneity in federated learning methods for medical imaging. arXiv preprint arXiv:2107.08371 (2021)
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Qu, L., Zhou, Y., Liang, P.P., Xia, Y., Wang, F., Adeli, E., Fei-Fei, L., Rubin, D.: Rethinking architecture design for tackling data heterogeneity in federated learning. In: Proceedings of the IEEE/CVF conference on computer vision and pattern recognition. pp. 10061–10071 (2022)
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Ruder, S.: An overview of gradient descent optimization algorithms. arXiv preprint arXiv:1609.04747 (2016)
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Uddin, M.P., Xiang, Y., Yearwood, J., Gao, L.: Robust federated averaging via outlier pruning. IEEE Signal Processing Letters </span><span id="bib.bib25.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">29</span><span id="bib.bib25.3.3" class="ltx_text" style="font-size:90%;">, 409–413 (2021)
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Wang, H., Yurochkin, M., Sun, Y., Papailiopoulos, D., Khazaeni, Y.: Federated learning with matched averaging. arXiv preprint arXiv:2002.06440 (2020)
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Wang, Z., Grigsby, J., Qi, Y.: Pgrad: Learning principal gradients for domain generalization. arXiv preprint arXiv:2305.01134 (2023)
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Xu, J., Tong, X., Huang, S.L.: Personalized federated learning with feature alignment and classifier collaboration. arXiv preprint arXiv:2306.11867 (2023)
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Xu, J., Wang, S., Wang, L., Yao, A.C.C.: Fedcm: Federated learning with client-level momentum. arXiv preprint arXiv:2106.10874 (2021)
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Yan, R., Qu, L., Wei, Q., Huang, S.C., Shen, L., Rubin, D., Xing, L., Zhou, Y.: Label-efficient self-supervised federated learning for tackling data heterogeneity in medical imaging. IEEE Transactions on Medical Imaging (2023)
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Yang, C., Wang, Q., Xu, M., Chen, Z., Bian, K., Liu, Y., Liu, X.: Characterizing impacts of heterogeneity in federated learning upon large-scale smartphone data. In: Proceedings of the Web Conference 2021. pp. 935–946 (2021)
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Zhang, J., Zeng, S., Zhang, M., Wang, R., Wang, F., Zhou, Y., Liang, P.P., Qu, L.: Flhetbench: Benchmarking device and state heterogeneity in federated learning. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. pp. 12098–12108 (2024)
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Zhang, M., Qu, L., Singh, P., Kalpathy-Cramer, J., Rubin, D.L.: Splitavg: A heterogeneity-aware federated deep learning method for medical imaging. IEEE Journal of Biomedical and Health Informatics </span><span id="bib.bib33.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">26</span><span id="bib.bib33.3.3" class="ltx_text" style="font-size:90%;">(9), 4635–4644 (2022)
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Zhang, X., Sun, W., Chen, Y.: Tackling the non-iid issue in heterogeneous federated learning by gradient harmonization. arXiv preprint arXiv:2309.06692 (2023)
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Ziller, A., Usynin, D., Braren, R., Makowski, M., Rueckert, D., Kaissis, G.: Medical imaging deep learning with differential privacy. Scientific Reports </span><span id="bib.bib35.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">11</span><span id="bib.bib35.3.3" class="ltx_text" style="font-size:90%;">(1), 13524 (2021)
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2408.12299" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2408.12300" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2408.12300">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2408.12300" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2408.12301" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Sep  5 16:19:33 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
