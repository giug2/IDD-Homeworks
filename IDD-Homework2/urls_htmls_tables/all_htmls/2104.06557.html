<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2104.06557] Towards Causal Federated Learning For enhanced robustness and privacy</title><meta property="og:description" content="Federated Learning is an emerging privacy-preserving distributed machine learning approach to building a shared model by performing distributed training locally on participating devices (clients) and aggregating the lo…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Towards Causal Federated Learning For enhanced robustness and privacy">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Towards Causal Federated Learning For enhanced robustness and privacy">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2104.06557">

<!--Generated on Sun Mar 17 02:29:03 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Towards Causal Federated Learning 
<br class="ltx_break">For enhanced robustness and privacy</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sreya Francis<sup id="id6.6.id1" class="ltx_sup"><span id="id6.6.id1.1" class="ltx_text ltx_font_italic">1,2</span></sup>, Irene Tenison<sup id="id7.7.id2" class="ltx_sup"><span id="id7.7.id2.1" class="ltx_text ltx_font_italic">1,2</span></sup>, Irina Rish<sup id="id8.8.id3" class="ltx_sup"><span id="id8.8.id3.1" class="ltx_text ltx_font_italic">1,2</span></sup>
<br class="ltx_break">MILA<sup id="id9.9.id4" class="ltx_sup"><span id="id9.9.id4.1" class="ltx_text ltx_font_italic">1</span></sup>,
University of Montreal<sup id="id10.10.id5" class="ltx_sup"><span id="id10.10.id5.1" class="ltx_text ltx_font_italic">2</span></sup>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id11.id1" class="ltx_p">Federated Learning is an emerging privacy-preserving distributed machine learning approach to building a shared model by performing distributed training locally on participating devices (clients) and aggregating the local models into a global one. As this approach prevents data collection and aggregation, it helps in reducing associated privacy risks to a great extent.
However, the data samples across all participating clients are
usually not independent and identically distributed (non-i.i.d.), and Out of Distribution (OOD) generalization for the learned models can be poor. Besides this challenge, federated learning also remains vulnerable to various attacks on security wherein a few malicious participating entities work towards inserting backdoors, degrading the generated aggregated model as well as inferring the data owned by participating entities. In this paper, we propose an approach for learning invariant (causal) features common to all participating clients in a federated learning setup and analyse empirically how it enhances the Out of Distribution (OOD) accuracy as well as the privacy of the final learned model.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Existing Threats</h2>

<section id="S1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1 </span>Domain shift issues</h3>

<div id="S1.SS1.p1" class="ltx_para ltx_noindent">
<p id="S1.SS1.p1.9" class="ltx_p">While federated learning promises better privacy and efficiency, most of the existing methods ignore the fact
that the data on each client node are collected in a non-i.i.d manner, leading to data distribution shift issues between nodes <cite class="ltx_cite ltx_citemacro_citep">(Quionero-Candela et al., <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>. For example, one device may take photos mostly indoors, while another mostly outdoors.
Let <math id="S1.SS1.p1.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S1.SS1.p1.1.m1.1a"><mi id="S1.SS1.p1.1.m1.1.1" xref="S1.SS1.p1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.p1.1.m1.1b"><ci id="S1.SS1.p1.1.m1.1.1.cmml" xref="S1.SS1.p1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p1.1.m1.1c">A</annotation></semantics></math> and <math id="S1.SS1.p1.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S1.SS1.p1.2.m2.1a"><mi id="S1.SS1.p1.2.m2.1.1" xref="S1.SS1.p1.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S1.SS1.p1.2.m2.1b"><ci id="S1.SS1.p1.2.m2.1.1.cmml" xref="S1.SS1.p1.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p1.2.m2.1c">B</annotation></semantics></math> be two clients, and let <math id="S1.SS1.p1.3.m3.1" class="ltx_Math" alttext="P_{A}" display="inline"><semantics id="S1.SS1.p1.3.m3.1a"><msub id="S1.SS1.p1.3.m3.1.1" xref="S1.SS1.p1.3.m3.1.1.cmml"><mi id="S1.SS1.p1.3.m3.1.1.2" xref="S1.SS1.p1.3.m3.1.1.2.cmml">P</mi><mi id="S1.SS1.p1.3.m3.1.1.3" xref="S1.SS1.p1.3.m3.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S1.SS1.p1.3.m3.1b"><apply id="S1.SS1.p1.3.m3.1.1.cmml" xref="S1.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S1.SS1.p1.3.m3.1.1.1.cmml" xref="S1.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S1.SS1.p1.3.m3.1.1.2.cmml" xref="S1.SS1.p1.3.m3.1.1.2">𝑃</ci><ci id="S1.SS1.p1.3.m3.1.1.3.cmml" xref="S1.SS1.p1.3.m3.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p1.3.m3.1c">P_{A}</annotation></semantics></math> and <math id="S1.SS1.p1.4.m4.1" class="ltx_Math" alttext="P_{B}" display="inline"><semantics id="S1.SS1.p1.4.m4.1a"><msub id="S1.SS1.p1.4.m4.1.1" xref="S1.SS1.p1.4.m4.1.1.cmml"><mi id="S1.SS1.p1.4.m4.1.1.2" xref="S1.SS1.p1.4.m4.1.1.2.cmml">P</mi><mi id="S1.SS1.p1.4.m4.1.1.3" xref="S1.SS1.p1.4.m4.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S1.SS1.p1.4.m4.1b"><apply id="S1.SS1.p1.4.m4.1.1.cmml" xref="S1.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S1.SS1.p1.4.m4.1.1.1.cmml" xref="S1.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S1.SS1.p1.4.m4.1.1.2.cmml" xref="S1.SS1.p1.4.m4.1.1.2">𝑃</ci><ci id="S1.SS1.p1.4.m4.1.1.3.cmml" xref="S1.SS1.p1.4.m4.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p1.4.m4.1c">P_{B}</annotation></semantics></math> be their associated data distributions, respectively, in a Federated learning setup. In many real-word scenarios, <math id="S1.SS1.p1.5.m5.1" class="ltx_Math" alttext="P_{A}\neq P_{B}" display="inline"><semantics id="S1.SS1.p1.5.m5.1a"><mrow id="S1.SS1.p1.5.m5.1.1" xref="S1.SS1.p1.5.m5.1.1.cmml"><msub id="S1.SS1.p1.5.m5.1.1.2" xref="S1.SS1.p1.5.m5.1.1.2.cmml"><mi id="S1.SS1.p1.5.m5.1.1.2.2" xref="S1.SS1.p1.5.m5.1.1.2.2.cmml">P</mi><mi id="S1.SS1.p1.5.m5.1.1.2.3" xref="S1.SS1.p1.5.m5.1.1.2.3.cmml">A</mi></msub><mo id="S1.SS1.p1.5.m5.1.1.1" xref="S1.SS1.p1.5.m5.1.1.1.cmml">≠</mo><msub id="S1.SS1.p1.5.m5.1.1.3" xref="S1.SS1.p1.5.m5.1.1.3.cmml"><mi id="S1.SS1.p1.5.m5.1.1.3.2" xref="S1.SS1.p1.5.m5.1.1.3.2.cmml">P</mi><mi id="S1.SS1.p1.5.m5.1.1.3.3" xref="S1.SS1.p1.5.m5.1.1.3.3.cmml">B</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.p1.5.m5.1b"><apply id="S1.SS1.p1.5.m5.1.1.cmml" xref="S1.SS1.p1.5.m5.1.1"><neq id="S1.SS1.p1.5.m5.1.1.1.cmml" xref="S1.SS1.p1.5.m5.1.1.1"></neq><apply id="S1.SS1.p1.5.m5.1.1.2.cmml" xref="S1.SS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S1.SS1.p1.5.m5.1.1.2.1.cmml" xref="S1.SS1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S1.SS1.p1.5.m5.1.1.2.2.cmml" xref="S1.SS1.p1.5.m5.1.1.2.2">𝑃</ci><ci id="S1.SS1.p1.5.m5.1.1.2.3.cmml" xref="S1.SS1.p1.5.m5.1.1.2.3">𝐴</ci></apply><apply id="S1.SS1.p1.5.m5.1.1.3.cmml" xref="S1.SS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S1.SS1.p1.5.m5.1.1.3.1.cmml" xref="S1.SS1.p1.5.m5.1.1.3">subscript</csymbol><ci id="S1.SS1.p1.5.m5.1.1.3.2.cmml" xref="S1.SS1.p1.5.m5.1.1.3.2">𝑃</ci><ci id="S1.SS1.p1.5.m5.1.1.3.3.cmml" xref="S1.SS1.p1.5.m5.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p1.5.m5.1c">P_{A}\neq P_{B}</annotation></semantics></math>. The participating clients can have varying marginal distributions, <math id="S1.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{P}_{A}(x)" display="inline"><semantics id="S1.SS1.p1.6.m6.1a"><mrow id="S1.SS1.p1.6.m6.1.2" xref="S1.SS1.p1.6.m6.1.2.cmml"><msub id="S1.SS1.p1.6.m6.1.2.2" xref="S1.SS1.p1.6.m6.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.SS1.p1.6.m6.1.2.2.2" xref="S1.SS1.p1.6.m6.1.2.2.2.cmml">𝒫</mi><mi id="S1.SS1.p1.6.m6.1.2.2.3" xref="S1.SS1.p1.6.m6.1.2.2.3.cmml">A</mi></msub><mo lspace="0em" rspace="0em" id="S1.SS1.p1.6.m6.1.2.1" xref="S1.SS1.p1.6.m6.1.2.1.cmml">​</mo><mrow id="S1.SS1.p1.6.m6.1.2.3.2" xref="S1.SS1.p1.6.m6.1.2.cmml"><mo stretchy="false" id="S1.SS1.p1.6.m6.1.2.3.2.1" xref="S1.SS1.p1.6.m6.1.2.cmml">(</mo><mi id="S1.SS1.p1.6.m6.1.1" xref="S1.SS1.p1.6.m6.1.1.cmml">x</mi><mo stretchy="false" id="S1.SS1.p1.6.m6.1.2.3.2.2" xref="S1.SS1.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.p1.6.m6.1b"><apply id="S1.SS1.p1.6.m6.1.2.cmml" xref="S1.SS1.p1.6.m6.1.2"><times id="S1.SS1.p1.6.m6.1.2.1.cmml" xref="S1.SS1.p1.6.m6.1.2.1"></times><apply id="S1.SS1.p1.6.m6.1.2.2.cmml" xref="S1.SS1.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="S1.SS1.p1.6.m6.1.2.2.1.cmml" xref="S1.SS1.p1.6.m6.1.2.2">subscript</csymbol><ci id="S1.SS1.p1.6.m6.1.2.2.2.cmml" xref="S1.SS1.p1.6.m6.1.2.2.2">𝒫</ci><ci id="S1.SS1.p1.6.m6.1.2.2.3.cmml" xref="S1.SS1.p1.6.m6.1.2.2.3">𝐴</ci></apply><ci id="S1.SS1.p1.6.m6.1.1.cmml" xref="S1.SS1.p1.6.m6.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p1.6.m6.1c">\mathcal{P}_{A}(x)</annotation></semantics></math>, although <math id="S1.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{P}(y\mid x)" display="inline"><semantics id="S1.SS1.p1.7.m7.1a"><mrow id="S1.SS1.p1.7.m7.1.1" xref="S1.SS1.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.SS1.p1.7.m7.1.1.3" xref="S1.SS1.p1.7.m7.1.1.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S1.SS1.p1.7.m7.1.1.2" xref="S1.SS1.p1.7.m7.1.1.2.cmml">​</mo><mrow id="S1.SS1.p1.7.m7.1.1.1.1" xref="S1.SS1.p1.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.SS1.p1.7.m7.1.1.1.1.2" xref="S1.SS1.p1.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S1.SS1.p1.7.m7.1.1.1.1.1" xref="S1.SS1.p1.7.m7.1.1.1.1.1.cmml"><mi id="S1.SS1.p1.7.m7.1.1.1.1.1.2" xref="S1.SS1.p1.7.m7.1.1.1.1.1.2.cmml">y</mi><mo id="S1.SS1.p1.7.m7.1.1.1.1.1.1" xref="S1.SS1.p1.7.m7.1.1.1.1.1.1.cmml">∣</mo><mi id="S1.SS1.p1.7.m7.1.1.1.1.1.3" xref="S1.SS1.p1.7.m7.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S1.SS1.p1.7.m7.1.1.1.1.3" xref="S1.SS1.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.p1.7.m7.1b"><apply id="S1.SS1.p1.7.m7.1.1.cmml" xref="S1.SS1.p1.7.m7.1.1"><times id="S1.SS1.p1.7.m7.1.1.2.cmml" xref="S1.SS1.p1.7.m7.1.1.2"></times><ci id="S1.SS1.p1.7.m7.1.1.3.cmml" xref="S1.SS1.p1.7.m7.1.1.3">𝒫</ci><apply id="S1.SS1.p1.7.m7.1.1.1.1.1.cmml" xref="S1.SS1.p1.7.m7.1.1.1.1"><csymbol cd="latexml" id="S1.SS1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S1.SS1.p1.7.m7.1.1.1.1.1.1">conditional</csymbol><ci id="S1.SS1.p1.7.m7.1.1.1.1.1.2.cmml" xref="S1.SS1.p1.7.m7.1.1.1.1.1.2">𝑦</ci><ci id="S1.SS1.p1.7.m7.1.1.1.1.1.3.cmml" xref="S1.SS1.p1.7.m7.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p1.7.m7.1c">\mathcal{P}(y\mid x)</annotation></semantics></math> remains the same, resulting into the so-called covariate shift; another example of shift is when marginal distributions of the class label, <math id="S1.SS1.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{P}_{A}(y)" display="inline"><semantics id="S1.SS1.p1.8.m8.1a"><mrow id="S1.SS1.p1.8.m8.1.2" xref="S1.SS1.p1.8.m8.1.2.cmml"><msub id="S1.SS1.p1.8.m8.1.2.2" xref="S1.SS1.p1.8.m8.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.SS1.p1.8.m8.1.2.2.2" xref="S1.SS1.p1.8.m8.1.2.2.2.cmml">𝒫</mi><mi id="S1.SS1.p1.8.m8.1.2.2.3" xref="S1.SS1.p1.8.m8.1.2.2.3.cmml">A</mi></msub><mo lspace="0em" rspace="0em" id="S1.SS1.p1.8.m8.1.2.1" xref="S1.SS1.p1.8.m8.1.2.1.cmml">​</mo><mrow id="S1.SS1.p1.8.m8.1.2.3.2" xref="S1.SS1.p1.8.m8.1.2.cmml"><mo stretchy="false" id="S1.SS1.p1.8.m8.1.2.3.2.1" xref="S1.SS1.p1.8.m8.1.2.cmml">(</mo><mi id="S1.SS1.p1.8.m8.1.1" xref="S1.SS1.p1.8.m8.1.1.cmml">y</mi><mo stretchy="false" id="S1.SS1.p1.8.m8.1.2.3.2.2" xref="S1.SS1.p1.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.p1.8.m8.1b"><apply id="S1.SS1.p1.8.m8.1.2.cmml" xref="S1.SS1.p1.8.m8.1.2"><times id="S1.SS1.p1.8.m8.1.2.1.cmml" xref="S1.SS1.p1.8.m8.1.2.1"></times><apply id="S1.SS1.p1.8.m8.1.2.2.cmml" xref="S1.SS1.p1.8.m8.1.2.2"><csymbol cd="ambiguous" id="S1.SS1.p1.8.m8.1.2.2.1.cmml" xref="S1.SS1.p1.8.m8.1.2.2">subscript</csymbol><ci id="S1.SS1.p1.8.m8.1.2.2.2.cmml" xref="S1.SS1.p1.8.m8.1.2.2.2">𝒫</ci><ci id="S1.SS1.p1.8.m8.1.2.2.3.cmml" xref="S1.SS1.p1.8.m8.1.2.2.3">𝐴</ci></apply><ci id="S1.SS1.p1.8.m8.1.1.cmml" xref="S1.SS1.p1.8.m8.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p1.8.m8.1c">\mathcal{P}_{A}(y)</annotation></semantics></math>, may vary across clients, even if <math id="S1.SS1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{P}(x\mid y)" display="inline"><semantics id="S1.SS1.p1.9.m9.1a"><mrow id="S1.SS1.p1.9.m9.1.1" xref="S1.SS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.SS1.p1.9.m9.1.1.3" xref="S1.SS1.p1.9.m9.1.1.3.cmml">𝒫</mi><mo lspace="0em" rspace="0em" id="S1.SS1.p1.9.m9.1.1.2" xref="S1.SS1.p1.9.m9.1.1.2.cmml">​</mo><mrow id="S1.SS1.p1.9.m9.1.1.1.1" xref="S1.SS1.p1.9.m9.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.SS1.p1.9.m9.1.1.1.1.2" xref="S1.SS1.p1.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S1.SS1.p1.9.m9.1.1.1.1.1" xref="S1.SS1.p1.9.m9.1.1.1.1.1.cmml"><mi id="S1.SS1.p1.9.m9.1.1.1.1.1.2" xref="S1.SS1.p1.9.m9.1.1.1.1.1.2.cmml">x</mi><mo id="S1.SS1.p1.9.m9.1.1.1.1.1.1" xref="S1.SS1.p1.9.m9.1.1.1.1.1.1.cmml">∣</mo><mi id="S1.SS1.p1.9.m9.1.1.1.1.1.3" xref="S1.SS1.p1.9.m9.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S1.SS1.p1.9.m9.1.1.1.1.3" xref="S1.SS1.p1.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.SS1.p1.9.m9.1b"><apply id="S1.SS1.p1.9.m9.1.1.cmml" xref="S1.SS1.p1.9.m9.1.1"><times id="S1.SS1.p1.9.m9.1.1.2.cmml" xref="S1.SS1.p1.9.m9.1.1.2"></times><ci id="S1.SS1.p1.9.m9.1.1.3.cmml" xref="S1.SS1.p1.9.m9.1.1.3">𝒫</ci><apply id="S1.SS1.p1.9.m9.1.1.1.1.1.cmml" xref="S1.SS1.p1.9.m9.1.1.1.1"><csymbol cd="latexml" id="S1.SS1.p1.9.m9.1.1.1.1.1.1.cmml" xref="S1.SS1.p1.9.m9.1.1.1.1.1.1">conditional</csymbol><ci id="S1.SS1.p1.9.m9.1.1.1.1.1.2.cmml" xref="S1.SS1.p1.9.m9.1.1.1.1.1.2">𝑥</ci><ci id="S1.SS1.p1.9.m9.1.1.1.1.1.3.cmml" xref="S1.SS1.p1.9.m9.1.1.1.1.1.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.SS1.p1.9.m9.1c">\mathcal{P}(x\mid y)</annotation></semantics></math> is the same, and so on <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
</section>
<section id="S1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.2 </span>Privacy Threats</h3>

<div id="S1.SS2.p1" class="ltx_para ltx_noindent">
<p id="S1.SS2.p1.1" class="ltx_p">Although the Federated Learning process makes considerable efforts to keep the user’s data private,
an attacker can analyze the weights of the sent updates to make conclusions about the data of users <cite class="ltx_cite ltx_citemacro_citep">(Geyer et al., <a href="#bib.bib5" title="" class="ltx_ref">2017</a>)</cite>.
Certain machine learning algorithms such as Neural Networks and Recurrent Language models are known to memorize data labelling and patterns. In such cases, a user’s data may risk losing its privacy since they are represented in the model  <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib8" title="" class="ltx_ref">2017</a>)</cite>.
While this might sound unlikely if not done on purpose, there have been experiments that show it is possible to reconstruct some data points <cite class="ltx_cite ltx_citemacro_citep">(Fredrikson et al., <a href="#bib.bib3" title="" class="ltx_ref">2015</a>)</cite>.
FL algorithms are vulnerable to some attacks, namely membership inference  <cite class="ltx_cite ltx_citemacro_citep">(Salem et al., <a href="#bib.bib12" title="" class="ltx_ref">2018</a>)</cite> <cite class="ltx_cite ltx_citemacro_citep">(Shokri et al., <a href="#bib.bib13" title="" class="ltx_ref">2017</a>)</cite>, model inversion <cite class="ltx_cite ltx_citemacro_citep">(Fredrikson et al., <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite> and model extraction <cite class="ltx_cite ltx_citemacro_citep">(Tramèr et al., <a href="#bib.bib15" title="" class="ltx_ref">2016</a>)</cite>.
Membership Inference typically determine whether a point is in
the training dataset or not. <cite class="ltx_cite ltx_citemacro_citep">(Shokri et al., <a href="#bib.bib13" title="" class="ltx_ref">2017</a>)</cite> propose a shadow training technique for this attack involving training k shadow models to mimic the behavior of target model initially, then accordingly train an attack (membership inference) model. Model Inversion attacks try to use black-box access to estimate the feature values from training dataset. <cite class="ltx_cite ltx_citemacro_citep">(Fredrikson et al., <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite> explored model inversion attacks in two settings: decision trees and neural networks.
Model Extraction attacks try to duplicate the parameters of target model. <cite class="ltx_cite ltx_citemacro_citep">(Tramèr et al., <a href="#bib.bib15" title="" class="ltx_ref">2016</a>)</cite> propose effective attack methods to logistic regression, neural networks and decision trees.</p>
</div>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>How can causal learning enhance federated learning</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">Generalization to out-of-distribution (OOD) data in participating clients is still a challenging aspect for federated learning. This is because most statistical learning algorithms used in federated learning strongly rely on the i.i.d. assumption on client data, while in practice domain shift among participating client domains is common. As compared to associational models that are being used in federated learning, models that are learnt with respect to causal features always exhibit better generalization to non-iid data i.e. data from different distributions.
As far as privacy is concerned, one of the main attacks posed to federated learning is membership inference attacks wherein only the model predictions can be observed by the attacker <cite class="ltx_cite ltx_citemacro_citep">(Yeom et al., <a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite>,
<cite class="ltx_cite ltx_citemacro_citep">(Nasr et al., <a href="#bib.bib10" title="" class="ltx_ref">2018b</a>)</cite>. In <cite class="ltx_cite ltx_citemacro_citep">(Nasr et al., <a href="#bib.bib10" title="" class="ltx_ref">2018b</a>)</cite>, it has been proved that the distribution of the training data as well as the generalizability of the model significantly contribute to the membership leakage. Particularly, they show that overfitted models are more susceptible to membership inference attacks than generalized models. Hence it can be inferred that such inference attacks can be nullified to a greater extent with learning networks that exhibit better generalization. In <cite class="ltx_cite ltx_citemacro_citep">(Tople et al., <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite>, the generalization property of causal learning has been proven wherein they establish a theoretical link between causality and privacy. It is shown that models learnt using causal features generalize better to unseen data, especially on data from different distributions than the train distribution. It was also proved that causal models provide better differential privacy guarantees as compared to the current associational models that we use.
With our approach, we explore how causal learning can enhance the out of distribution robustness as well as the impact it can have on privacy enhancement in a federated learning setup.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Approach - <span id="S3.1.1" class="ltx_text ltx_font_bold">CausalFed</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Implementation workflow</h3>

<figure id="S3.F1" class="ltx_figure"><img src="/html/2104.06557/assets/x1.jpg" id="S3.F1.g1" class="ltx_graphics ltx_img_landscape" width="610" height="305" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span> Causal Federated Learning</figcaption>
</figure>
<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.5" class="ltx_p">Keeping the data private, we propose an approach to collaboratively learn causal features common to all the participanting clients in a federated learning setup. In our federated causal learning framework, the client layer (local) is the one where in each of the participating client entities do the local training for extracting features from their respective input data and outputs the respective features in the form of numerical vectors. Consider client data <math id="S3.SS1.p1.1.m1.2" class="ltx_Math" alttext="\mathcal{D}_{C}={(x_{i}^{C},y_{i}^{C})}_{i=1}^{N_{C}}" display="inline"><semantics id="S3.SS1.p1.1.m1.2a"><mrow id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml"><msub id="S3.SS1.p1.1.m1.2.2.4" xref="S3.SS1.p1.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.2.2.4.2" xref="S3.SS1.p1.1.m1.2.2.4.2.cmml">𝒟</mi><mi id="S3.SS1.p1.1.m1.2.2.4.3" xref="S3.SS1.p1.1.m1.2.2.4.3.cmml">C</mi></msub><mo id="S3.SS1.p1.1.m1.2.2.3" xref="S3.SS1.p1.1.m1.2.2.3.cmml">=</mo><msubsup id="S3.SS1.p1.1.m1.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.cmml"><mrow id="S3.SS1.p1.1.m1.2.2.2.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.2.2.2.2.2.2.3" xref="S3.SS1.p1.1.m1.2.2.2.2.2.3.cmml">(</mo><msubsup id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.3.cmml">C</mi></msubsup><mo id="S3.SS1.p1.1.m1.2.2.2.2.2.2.4" xref="S3.SS1.p1.1.m1.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.SS1.p1.1.m1.2.2.2.2.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.2.2" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.2.3" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.2.3.cmml">i</mi><mi id="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.3" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.3.cmml">C</mi></msubsup><mo stretchy="false" id="S3.SS1.p1.1.m1.2.2.2.2.2.2.5" xref="S3.SS1.p1.1.m1.2.2.2.2.2.3.cmml">)</mo></mrow><mrow id="S3.SS1.p1.1.m1.2.2.2.2.4" xref="S3.SS1.p1.1.m1.2.2.2.2.4.cmml"><mi id="S3.SS1.p1.1.m1.2.2.2.2.4.2" xref="S3.SS1.p1.1.m1.2.2.2.2.4.2.cmml">i</mi><mo id="S3.SS1.p1.1.m1.2.2.2.2.4.1" xref="S3.SS1.p1.1.m1.2.2.2.2.4.1.cmml">=</mo><mn id="S3.SS1.p1.1.m1.2.2.2.2.4.3" xref="S3.SS1.p1.1.m1.2.2.2.2.4.3.cmml">1</mn></mrow><msub id="S3.SS1.p1.1.m1.2.2.2.4" xref="S3.SS1.p1.1.m1.2.2.2.4.cmml"><mi id="S3.SS1.p1.1.m1.2.2.2.4.2" xref="S3.SS1.p1.1.m1.2.2.2.4.2.cmml">N</mi><mi id="S3.SS1.p1.1.m1.2.2.2.4.3" xref="S3.SS1.p1.1.m1.2.2.2.4.3.cmml">C</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.2b"><apply id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2"><eq id="S3.SS1.p1.1.m1.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.3"></eq><apply id="S3.SS1.p1.1.m1.2.2.4.cmml" xref="S3.SS1.p1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.4.1.cmml" xref="S3.SS1.p1.1.m1.2.2.4">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.4.2.cmml" xref="S3.SS1.p1.1.m1.2.2.4.2">𝒟</ci><ci id="S3.SS1.p1.1.m1.2.2.4.3.cmml" xref="S3.SS1.p1.1.m1.2.2.4.3">𝐶</ci></apply><apply id="S3.SS1.p1.1.m1.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2">superscript</csymbol><apply id="S3.SS1.p1.1.m1.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2">subscript</csymbol><interval closure="open" id="S3.SS1.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2"><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.3">𝐶</ci></apply><apply id="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.2">superscript</csymbol><apply id="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.2.2.2.3">𝐶</ci></apply></interval><apply id="S3.SS1.p1.1.m1.2.2.2.2.4.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.4"><eq id="S3.SS1.p1.1.m1.2.2.2.2.4.1.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.4.1"></eq><ci id="S3.SS1.p1.1.m1.2.2.2.2.4.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.4.2">𝑖</ci><cn type="integer" id="S3.SS1.p1.1.m1.2.2.2.2.4.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2.2.4.3">1</cn></apply></apply><apply id="S3.SS1.p1.1.m1.2.2.2.4.cmml" xref="S3.SS1.p1.1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.2.4.1.cmml" xref="S3.SS1.p1.1.m1.2.2.2.4">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.2.4.2.cmml" xref="S3.SS1.p1.1.m1.2.2.2.4.2">𝑁</ci><ci id="S3.SS1.p1.1.m1.2.2.2.4.3.cmml" xref="S3.SS1.p1.1.m1.2.2.2.4.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.2c">\mathcal{D}_{C}={(x_{i}^{C},y_{i}^{C})}_{i=1}^{N_{C}}</annotation></semantics></math>
where <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="x_{i}^{C}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msubsup id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2.2" xref="S3.SS1.p1.2.m2.1.1.2.2.cmml">x</mi><mi id="S3.SS1.p1.2.m2.1.1.2.3" xref="S3.SS1.p1.2.m2.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">C</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2.2">𝑥</ci><ci id="S3.SS1.p1.2.m2.1.1.2.3.cmml" xref="S3.SS1.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">x_{i}^{C}</annotation></semantics></math> is <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msup id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">i</mi><mrow id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m3.1.1.3.1" xref="S3.SS1.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑖</ci><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><times id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.1"></times><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">i^{th}</annotation></semantics></math> input and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="y_{i}^{C}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msubsup id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2.2" xref="S3.SS1.p1.4.m4.1.1.2.2.cmml">y</mi><mi id="S3.SS1.p1.4.m4.1.1.2.3" xref="S3.SS1.p1.4.m4.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">C</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">superscript</csymbol><apply id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2.2">𝑦</ci><ci id="S3.SS1.p1.4.m4.1.1.2.3.cmml" xref="S3.SS1.p1.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">y_{i}^{C}</annotation></semantics></math> is <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msup id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">i</mi><mrow id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.5.m5.1.1.3.1" xref="S3.SS1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑖</ci><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><times id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.1"></times><ci id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">𝑡</ci><ci id="S3.SS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">i^{th}</annotation></semantics></math> label for client C. The hidden representation of each participating client is produced by neural network as</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="h_{i}^{C}=\phi^{C}(x_{i}^{C})" display="block"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><msubsup id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.3.2.2" xref="S3.Ex1.m1.1.1.3.2.2.cmml">h</mi><mi id="S3.Ex1.m1.1.1.3.2.3" xref="S3.Ex1.m1.1.1.3.2.3.cmml">i</mi><mi id="S3.Ex1.m1.1.1.3.3" xref="S3.Ex1.m1.1.1.3.3.cmml">C</mi></msubsup><mo id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml"><msup id="S3.Ex1.m1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.3.2.cmml">ϕ</mi><mi id="S3.Ex1.m1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.3.3.cmml">C</mi></msup><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.cmml">C</mi></msubsup><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><eq id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2"></eq><apply id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.3">superscript</csymbol><apply id="S3.Ex1.m1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.3.2.1.cmml" xref="S3.Ex1.m1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.3.2.2.cmml" xref="S3.Ex1.m1.1.1.3.2.2">ℎ</ci><ci id="S3.Ex1.m1.1.1.3.2.3.cmml" xref="S3.Ex1.m1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.Ex1.m1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.3.3">𝐶</ci></apply><apply id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><times id="S3.Ex1.m1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.2"></times><apply id="S3.Ex1.m1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.3.2">italic-ϕ</ci><ci id="S3.Ex1.m1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.3.3">𝐶</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">h_{i}^{C}=\phi^{C}(x_{i}^{C})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.6" class="ltx_p">where <math id="S3.SS1.p1.6.m1.1" class="ltx_Math" alttext="h^{C}\in\mathcal{R}^{N_{C}\times d}" display="inline"><semantics id="S3.SS1.p1.6.m1.1a"><mrow id="S3.SS1.p1.6.m1.1.1" xref="S3.SS1.p1.6.m1.1.1.cmml"><msup id="S3.SS1.p1.6.m1.1.1.2" xref="S3.SS1.p1.6.m1.1.1.2.cmml"><mi id="S3.SS1.p1.6.m1.1.1.2.2" xref="S3.SS1.p1.6.m1.1.1.2.2.cmml">h</mi><mi id="S3.SS1.p1.6.m1.1.1.2.3" xref="S3.SS1.p1.6.m1.1.1.2.3.cmml">C</mi></msup><mo id="S3.SS1.p1.6.m1.1.1.1" xref="S3.SS1.p1.6.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.6.m1.1.1.3" xref="S3.SS1.p1.6.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m1.1.1.3.2" xref="S3.SS1.p1.6.m1.1.1.3.2.cmml">ℛ</mi><mrow id="S3.SS1.p1.6.m1.1.1.3.3" xref="S3.SS1.p1.6.m1.1.1.3.3.cmml"><msub id="S3.SS1.p1.6.m1.1.1.3.3.2" xref="S3.SS1.p1.6.m1.1.1.3.3.2.cmml"><mi id="S3.SS1.p1.6.m1.1.1.3.3.2.2" xref="S3.SS1.p1.6.m1.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS1.p1.6.m1.1.1.3.3.2.3" xref="S3.SS1.p1.6.m1.1.1.3.3.2.3.cmml">C</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.6.m1.1.1.3.3.1" xref="S3.SS1.p1.6.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.6.m1.1.1.3.3.3" xref="S3.SS1.p1.6.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m1.1b"><apply id="S3.SS1.p1.6.m1.1.1.cmml" xref="S3.SS1.p1.6.m1.1.1"><in id="S3.SS1.p1.6.m1.1.1.1.cmml" xref="S3.SS1.p1.6.m1.1.1.1"></in><apply id="S3.SS1.p1.6.m1.1.1.2.cmml" xref="S3.SS1.p1.6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m1.1.1.2.1.cmml" xref="S3.SS1.p1.6.m1.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.6.m1.1.1.2.2.cmml" xref="S3.SS1.p1.6.m1.1.1.2.2">ℎ</ci><ci id="S3.SS1.p1.6.m1.1.1.2.3.cmml" xref="S3.SS1.p1.6.m1.1.1.2.3">𝐶</ci></apply><apply id="S3.SS1.p1.6.m1.1.1.3.cmml" xref="S3.SS1.p1.6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m1.1.1.3.1.cmml" xref="S3.SS1.p1.6.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.6.m1.1.1.3.2.cmml" xref="S3.SS1.p1.6.m1.1.1.3.2">ℛ</ci><apply id="S3.SS1.p1.6.m1.1.1.3.3.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3"><times id="S3.SS1.p1.6.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3.1"></times><apply id="S3.SS1.p1.6.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m1.1.1.3.3.2.1.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p1.6.m1.1.1.3.3.2.2.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS1.p1.6.m1.1.1.3.3.2.3.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3.2.3">𝐶</ci></apply><ci id="S3.SS1.p1.6.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m1.1c">h^{C}\in\mathcal{R}^{N_{C}\times d}</annotation></semantics></math>
, d is the dimension of hidden representation layer.
The global server layer is for the participating clients to exchange intermediate training components and train the federated model in collaboration by minimizing the empirical
average loss as well as regularizing the model by the gradient norm of the loss for all the participating entities/environments as:</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<table id="S3.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex2.m1.4" class="ltx_math_unparsed" alttext="\sum_{C,i}^{S,N_{C}}\mathcal{L}_{d}(w\circ h_{i},y_{i})+\lambda\sum_{C}^{S}{\Bigl{\|}\nabla_{w|w=1.0}\sum_{i}^{N_{C}}\mathcal{L}_{d}(w\circ h_{i},y_{i})\Bigl{\|}}^{2}" display="block"><semantics id="S3.Ex2.m1.4a"><mrow id="S3.Ex2.m1.4b"><munderover id="S3.Ex2.m1.4.5"><mo movablelimits="false" id="S3.Ex2.m1.4.5.2.2">∑</mo><mrow id="S3.Ex2.m1.2.2.2.4"><mi id="S3.Ex2.m1.1.1.1.1">C</mi><mo id="S3.Ex2.m1.2.2.2.4.1">,</mo><mi id="S3.Ex2.m1.2.2.2.2">i</mi></mrow><mrow id="S3.Ex2.m1.4.4.2.2"><mi id="S3.Ex2.m1.3.3.1.1">S</mi><mo id="S3.Ex2.m1.4.4.2.2.2">,</mo><msub id="S3.Ex2.m1.4.4.2.2.1"><mi id="S3.Ex2.m1.4.4.2.2.1.2">N</mi><mi id="S3.Ex2.m1.4.4.2.2.1.3">C</mi></msub></mrow></munderover><msub id="S3.Ex2.m1.4.6"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.4.6.2">ℒ</mi><mi id="S3.Ex2.m1.4.6.3">d</mi></msub><mrow id="S3.Ex2.m1.4.7"><mo stretchy="false" id="S3.Ex2.m1.4.7.1">(</mo><mi id="S3.Ex2.m1.4.7.2">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.Ex2.m1.4.7.3">∘</mo><msub id="S3.Ex2.m1.4.7.4"><mi id="S3.Ex2.m1.4.7.4.2">h</mi><mi id="S3.Ex2.m1.4.7.4.3">i</mi></msub><mo id="S3.Ex2.m1.4.7.5">,</mo><msub id="S3.Ex2.m1.4.7.6"><mi id="S3.Ex2.m1.4.7.6.2">y</mi><mi id="S3.Ex2.m1.4.7.6.3">i</mi></msub><mo stretchy="false" id="S3.Ex2.m1.4.7.7">)</mo></mrow><mo id="S3.Ex2.m1.4.8">+</mo><mi id="S3.Ex2.m1.4.9">λ</mi><munderover id="S3.Ex2.m1.4.10"><mo movablelimits="false" rspace="0em" id="S3.Ex2.m1.4.10.2.2">∑</mo><mi id="S3.Ex2.m1.4.10.2.3">C</mi><mi id="S3.Ex2.m1.4.10.3">S</mi></munderover><mrow id="S3.Ex2.m1.4.11"><mo fence="true" lspace="0em" mathsize="160%" rspace="0em" id="S3.Ex2.m1.4.11.1">∥</mo><msub id="S3.Ex2.m1.4.11.2"><mo id="S3.Ex2.m1.4.11.2.2">∇</mo><mrow id="S3.Ex2.m1.4.11.2.3"><mrow id="S3.Ex2.m1.4.11.2.3.2"><mi id="S3.Ex2.m1.4.11.2.3.2.2">w</mi><mo fence="false" id="S3.Ex2.m1.4.11.2.3.2.1">|</mo><mi id="S3.Ex2.m1.4.11.2.3.2.3">w</mi></mrow><mo id="S3.Ex2.m1.4.11.2.3.1">=</mo><mn id="S3.Ex2.m1.4.11.2.3.3">1.0</mn></mrow></msub><munderover id="S3.Ex2.m1.4.11.3"><mo movablelimits="false" id="S3.Ex2.m1.4.11.3.2.2">∑</mo><mi id="S3.Ex2.m1.4.11.3.2.3">i</mi><msub id="S3.Ex2.m1.4.11.3.3"><mi id="S3.Ex2.m1.4.11.3.3.2">N</mi><mi id="S3.Ex2.m1.4.11.3.3.3">C</mi></msub></munderover><msub id="S3.Ex2.m1.4.11.4"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.4.11.4.2">ℒ</mi><mi id="S3.Ex2.m1.4.11.4.3">d</mi></msub><mrow id="S3.Ex2.m1.4.11.5"><mo stretchy="false" id="S3.Ex2.m1.4.11.5.1">(</mo><mi id="S3.Ex2.m1.4.11.5.2">w</mi><mo lspace="0.222em" rspace="0.222em" id="S3.Ex2.m1.4.11.5.3">∘</mo><msub id="S3.Ex2.m1.4.11.5.4"><mi id="S3.Ex2.m1.4.11.5.4.2">h</mi><mi id="S3.Ex2.m1.4.11.5.4.3">i</mi></msub><mo id="S3.Ex2.m1.4.11.5.5">,</mo><msub id="S3.Ex2.m1.4.11.5.6"><mi id="S3.Ex2.m1.4.11.5.6.2">y</mi><mi id="S3.Ex2.m1.4.11.5.6.3">i</mi></msub><mo stretchy="false" id="S3.Ex2.m1.4.11.5.7">)</mo></mrow><msup id="S3.Ex2.m1.4.11.6"><mo fence="true" lspace="0em" mathsize="160%" id="S3.Ex2.m1.4.11.6.2">∥</mo><mn id="S3.Ex2.m1.4.11.6.3">2</mn></msup></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex2.m1.4c">\sum_{C,i}^{S,N_{C}}\mathcal{L}_{d}(w\circ h_{i},y_{i})+\lambda\sum_{C}^{S}{\Bigl{\|}\nabla_{w|w=1.0}\sum_{i}^{N_{C}}\mathcal{L}_{d}(w\circ h_{i},y_{i})\Bigl{\|}}^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.6" class="ltx_p">where S equals set of clients/ source domains, <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="N_{C}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">N</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑁</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">N_{C}</annotation></semantics></math> equals number of samples per client <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">C</annotation></semantics></math>, <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{d}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><msub id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">ℒ</mi><mi id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">ℒ</ci><ci id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\mathcal{L}_{d}</annotation></semantics></math> equals classification loss, and <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">h</annotation></semantics></math>, <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">y</annotation></semantics></math> to represent the hidden representation and its
corresponding true class label and <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><mi id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><ci id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">\lambda</annotation></semantics></math> is hyperparameter.
With Invariant Risk Minimization (IRM) <cite class="ltx_cite ltx_citemacro_citep">(Arjovsky et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite> we attempt to learn invariant predictors in a federated learning setup that can attain an optimal empirical risk on all the participating client domains. <a href="#A1.SS5" title="A.5 CasualFedGSD - Alternative approach to CausalFed ‣ Appendix A Appendix ‣ Towards Causal Federated Learning For enhanced robustness and privacy" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.5</span></a> lists an alternative approach called CausalFedGSD for the same problem.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Algorithm</h3>

<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.5.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> CausalFed</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.1" class="ltx_p ltx_figure_panel"><span id="alg1.1.1" class="ltx_text ltx_markedasmath ltx_font_bold">ServerCausalUpdate:</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.6" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\text{Initialize }\mathbf{W}_{0}^{s}" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mtext id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2a.cmml">Initialize </mtext><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">​</mo><msubsup id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml"><mi id="alg1.l1.m1.1.1.3.2.2" xref="alg1.l1.m1.1.1.3.2.2.cmml">𝐖</mi><mn id="alg1.l1.m1.1.1.3.2.3" xref="alg1.l1.m1.1.1.3.2.3.cmml">0</mn><mi id="alg1.l1.m1.1.1.3.3" xref="alg1.l1.m1.1.1.3.3.cmml">s</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><times id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1"></times><ci id="alg1.l1.m1.1.1.2a.cmml" xref="alg1.l1.m1.1.1.2"><mtext id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">Initialize </mtext></ci><apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3">superscript</csymbol><apply id="alg1.l1.m1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.3.2.1.cmml" xref="alg1.l1.m1.1.1.3">subscript</csymbol><ci id="alg1.l1.m1.1.1.3.2.2.cmml" xref="alg1.l1.m1.1.1.3.2.2">𝐖</ci><cn type="integer" id="alg1.l1.m1.1.1.3.2.3.cmml" xref="alg1.l1.m1.1.1.3.2.3">0</cn></apply><ci id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\text{Initialize }\mathbf{W}_{0}^{s}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">for</span> <span id="alg1.l2.2" class="ltx_text ltx_markedasmath">each server epoch, t = 1,2,..k </span> <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">     <span id="alg1.l3.1" class="ltx_text ltx_markedasmath">Select random set of S clients</span>

</div>
<div id="alg1.l4" class="ltx_listingline">     <span id="alg1.l4.1" class="ltx_text ltx_markedasmath">Share initial model with the selected clients</span>

</div>
<div id="alg1.l5" class="ltx_listingline">     <span id="alg1.l5.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\text{each client }k\in S" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mrow id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mtext id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2a.cmml">each client </mtext><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.2.1" xref="alg1.l5.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">k</mi></mrow><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">∈</mo><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><in id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></in><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><times id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2.1"></times><ci id="alg1.l5.m1.1.1.2.2a.cmml" xref="alg1.l5.m1.1.1.2.2"><mtext id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">each client </mtext></ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\text{each client }k\in S</annotation></semantics></math> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l6" class="ltx_listingline">        <math id="alg1.l6.m1.4" class="ltx_Math" alttext="(\bm{\phi}(x^{k}_{t}),\mathbf{Y}^{k})\leftarrow ClientRepresentation(k,\mathbf{W}_{t}^{k})" display="inline"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml"><mrow id="alg1.l6.m1.3.3.2.2" xref="alg1.l6.m1.3.3.2.3.cmml"><mo stretchy="false" id="alg1.l6.m1.3.3.2.2.3" xref="alg1.l6.m1.3.3.2.3.cmml">(</mo><mrow id="alg1.l6.m1.2.2.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l6.m1.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="alg1.l6.m1.2.2.1.1.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.1.1.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l6.m1.2.2.1.1.1.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.1.1.1.2.2" xref="alg1.l6.m1.2.2.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="alg1.l6.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.1.1.1.3.cmml">t</mi><mi id="alg1.l6.m1.2.2.1.1.1.1.1.1.2.3" xref="alg1.l6.m1.2.2.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l6.m1.2.2.1.1.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l6.m1.3.3.2.2.4" xref="alg1.l6.m1.3.3.2.3.cmml">,</mo><msup id="alg1.l6.m1.3.3.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.cmml"><mi id="alg1.l6.m1.3.3.2.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.2.cmml">𝐘</mi><mi id="alg1.l6.m1.3.3.2.2.2.3" xref="alg1.l6.m1.3.3.2.2.2.3.cmml">k</mi></msup><mo stretchy="false" id="alg1.l6.m1.3.3.2.2.5" xref="alg1.l6.m1.3.3.2.3.cmml">)</mo></mrow><mo stretchy="false" id="alg1.l6.m1.4.4.4" xref="alg1.l6.m1.4.4.4.cmml">←</mo><mrow id="alg1.l6.m1.4.4.3" xref="alg1.l6.m1.4.4.3.cmml"><mi id="alg1.l6.m1.4.4.3.3" xref="alg1.l6.m1.4.4.3.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.4" xref="alg1.l6.m1.4.4.3.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2a" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.5" xref="alg1.l6.m1.4.4.3.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2b" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.6" xref="alg1.l6.m1.4.4.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2c" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.7" xref="alg1.l6.m1.4.4.3.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2d" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.8" xref="alg1.l6.m1.4.4.3.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2e" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.9" xref="alg1.l6.m1.4.4.3.9.cmml">R</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2f" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.10" xref="alg1.l6.m1.4.4.3.10.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2g" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.11" xref="alg1.l6.m1.4.4.3.11.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2h" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.12" xref="alg1.l6.m1.4.4.3.12.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2i" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.13" xref="alg1.l6.m1.4.4.3.13.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2j" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.14" xref="alg1.l6.m1.4.4.3.14.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2k" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.15" xref="alg1.l6.m1.4.4.3.15.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2l" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.16" xref="alg1.l6.m1.4.4.3.16.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2m" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.17" xref="alg1.l6.m1.4.4.3.17.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2n" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.18" xref="alg1.l6.m1.4.4.3.18.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2o" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.19" xref="alg1.l6.m1.4.4.3.19.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2p" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.20" xref="alg1.l6.m1.4.4.3.20.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2q" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.21" xref="alg1.l6.m1.4.4.3.21.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2r" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mi id="alg1.l6.m1.4.4.3.22" xref="alg1.l6.m1.4.4.3.22.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.4.4.3.2s" xref="alg1.l6.m1.4.4.3.2.cmml">​</mo><mrow id="alg1.l6.m1.4.4.3.1.1" xref="alg1.l6.m1.4.4.3.1.2.cmml"><mo stretchy="false" id="alg1.l6.m1.4.4.3.1.1.2" xref="alg1.l6.m1.4.4.3.1.2.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">k</mi><mo id="alg1.l6.m1.4.4.3.1.1.3" xref="alg1.l6.m1.4.4.3.1.2.cmml">,</mo><msubsup id="alg1.l6.m1.4.4.3.1.1.1" xref="alg1.l6.m1.4.4.3.1.1.1.cmml"><mi id="alg1.l6.m1.4.4.3.1.1.1.2.2" xref="alg1.l6.m1.4.4.3.1.1.1.2.2.cmml">𝐖</mi><mi id="alg1.l6.m1.4.4.3.1.1.1.2.3" xref="alg1.l6.m1.4.4.3.1.1.1.2.3.cmml">t</mi><mi id="alg1.l6.m1.4.4.3.1.1.1.3" xref="alg1.l6.m1.4.4.3.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l6.m1.4.4.3.1.1.4" xref="alg1.l6.m1.4.4.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4"><ci id="alg1.l6.m1.4.4.4.cmml" xref="alg1.l6.m1.4.4.4">←</ci><interval closure="open" id="alg1.l6.m1.3.3.2.3.cmml" xref="alg1.l6.m1.3.3.2.2"><apply id="alg1.l6.m1.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1"><times id="alg1.l6.m1.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.2"></times><ci id="alg1.l6.m1.2.2.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.3">bold-italic-ϕ</ci><apply id="alg1.l6.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="alg1.l6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="alg1.l6.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1.1.2.2">𝑥</ci><ci id="alg1.l6.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="alg1.l6.m1.3.3.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.2.2.2">superscript</csymbol><ci id="alg1.l6.m1.3.3.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2.2">𝐘</ci><ci id="alg1.l6.m1.3.3.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.2.3">𝑘</ci></apply></interval><apply id="alg1.l6.m1.4.4.3.cmml" xref="alg1.l6.m1.4.4.3"><times id="alg1.l6.m1.4.4.3.2.cmml" xref="alg1.l6.m1.4.4.3.2"></times><ci id="alg1.l6.m1.4.4.3.3.cmml" xref="alg1.l6.m1.4.4.3.3">𝐶</ci><ci id="alg1.l6.m1.4.4.3.4.cmml" xref="alg1.l6.m1.4.4.3.4">𝑙</ci><ci id="alg1.l6.m1.4.4.3.5.cmml" xref="alg1.l6.m1.4.4.3.5">𝑖</ci><ci id="alg1.l6.m1.4.4.3.6.cmml" xref="alg1.l6.m1.4.4.3.6">𝑒</ci><ci id="alg1.l6.m1.4.4.3.7.cmml" xref="alg1.l6.m1.4.4.3.7">𝑛</ci><ci id="alg1.l6.m1.4.4.3.8.cmml" xref="alg1.l6.m1.4.4.3.8">𝑡</ci><ci id="alg1.l6.m1.4.4.3.9.cmml" xref="alg1.l6.m1.4.4.3.9">𝑅</ci><ci id="alg1.l6.m1.4.4.3.10.cmml" xref="alg1.l6.m1.4.4.3.10">𝑒</ci><ci id="alg1.l6.m1.4.4.3.11.cmml" xref="alg1.l6.m1.4.4.3.11">𝑝</ci><ci id="alg1.l6.m1.4.4.3.12.cmml" xref="alg1.l6.m1.4.4.3.12">𝑟</ci><ci id="alg1.l6.m1.4.4.3.13.cmml" xref="alg1.l6.m1.4.4.3.13">𝑒</ci><ci id="alg1.l6.m1.4.4.3.14.cmml" xref="alg1.l6.m1.4.4.3.14">𝑠</ci><ci id="alg1.l6.m1.4.4.3.15.cmml" xref="alg1.l6.m1.4.4.3.15">𝑒</ci><ci id="alg1.l6.m1.4.4.3.16.cmml" xref="alg1.l6.m1.4.4.3.16">𝑛</ci><ci id="alg1.l6.m1.4.4.3.17.cmml" xref="alg1.l6.m1.4.4.3.17">𝑡</ci><ci id="alg1.l6.m1.4.4.3.18.cmml" xref="alg1.l6.m1.4.4.3.18">𝑎</ci><ci id="alg1.l6.m1.4.4.3.19.cmml" xref="alg1.l6.m1.4.4.3.19">𝑡</ci><ci id="alg1.l6.m1.4.4.3.20.cmml" xref="alg1.l6.m1.4.4.3.20">𝑖</ci><ci id="alg1.l6.m1.4.4.3.21.cmml" xref="alg1.l6.m1.4.4.3.21">𝑜</ci><ci id="alg1.l6.m1.4.4.3.22.cmml" xref="alg1.l6.m1.4.4.3.22">𝑛</ci><interval closure="open" id="alg1.l6.m1.4.4.3.1.2.cmml" xref="alg1.l6.m1.4.4.3.1.1"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑘</ci><apply id="alg1.l6.m1.4.4.3.1.1.1.cmml" xref="alg1.l6.m1.4.4.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.1.1.1.1.cmml" xref="alg1.l6.m1.4.4.3.1.1.1">superscript</csymbol><apply id="alg1.l6.m1.4.4.3.1.1.1.2.cmml" xref="alg1.l6.m1.4.4.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.1.1.1.2.1.cmml" xref="alg1.l6.m1.4.4.3.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.4.4.3.1.1.1.2.2.cmml" xref="alg1.l6.m1.4.4.3.1.1.1.2.2">𝐖</ci><ci id="alg1.l6.m1.4.4.3.1.1.1.2.3.cmml" xref="alg1.l6.m1.4.4.3.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l6.m1.4.4.3.1.1.1.3.cmml" xref="alg1.l6.m1.4.4.3.1.1.1.3">𝑘</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">(\bm{\phi}(x^{k}_{t}),\mathbf{Y}^{k})\leftarrow ClientRepresentation(k,\mathbf{W}_{t}^{k})</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">        <math id="alg1.l7.m1.1" class="ltx_Math" alttext="\text{Evaluate loss }\mathcal{L}_{k}" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mtext id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2a.cmml">Evaluate loss </mtext><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">​</mo><msub id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">ℒ</mi><mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><times id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></times><ci id="alg1.l7.m1.1.1.2a.cmml" xref="alg1.l7.m1.1.1.2"><mtext id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">Evaluate loss </mtext></ci><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3">subscript</csymbol><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">ℒ</ci><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\text{Evaluate loss }\mathcal{L}_{k}</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">     <span id="alg1.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l9" class="ltx_listingline">     <math id="alg1.l9.m1.1" class="ltx_math_unparsed" alttext="\mathcal{L}_{s}=\sum_{k}^{S}\mathcal{L}_{k}+\lambda\sum_{k}^{S}{\Bigl{\|}\nabla\mathcal{L}_{k}\Bigl{\|}}^{2}" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1b"><msub id="alg1.l9.m1.1.1"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.1.2">ℒ</mi><mi id="alg1.l9.m1.1.1.3">s</mi></msub><mo rspace="0.111em" id="alg1.l9.m1.1.2">=</mo><msubsup id="alg1.l9.m1.1.3"><mo id="alg1.l9.m1.1.3.2.2">∑</mo><mi id="alg1.l9.m1.1.3.2.3">k</mi><mi id="alg1.l9.m1.1.3.3">S</mi></msubsup><msub id="alg1.l9.m1.1.4"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.4.2">ℒ</mi><mi id="alg1.l9.m1.1.4.3">k</mi></msub><mo id="alg1.l9.m1.1.5">+</mo><mi id="alg1.l9.m1.1.6">λ</mi><msubsup id="alg1.l9.m1.1.7"><mo rspace="0em" id="alg1.l9.m1.1.7.2.2">∑</mo><mi id="alg1.l9.m1.1.7.2.3">k</mi><mi id="alg1.l9.m1.1.7.3">S</mi></msubsup><mrow id="alg1.l9.m1.1.8"><mo fence="true" lspace="0em" mathsize="160%" rspace="0em" id="alg1.l9.m1.1.8.1">∥</mo><mo rspace="0.167em" id="alg1.l9.m1.1.8.2">∇</mo><msub id="alg1.l9.m1.1.8.3"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.8.3.2">ℒ</mi><mi id="alg1.l9.m1.1.8.3.3">k</mi></msub><msup id="alg1.l9.m1.1.8.4"><mo fence="true" lspace="0em" mathsize="160%" id="alg1.l9.m1.1.8.4.2">∥</mo><mn id="alg1.l9.m1.1.8.4.3">2</mn></msup></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\mathcal{L}_{s}=\sum_{k}^{S}\mathcal{L}_{k}+\lambda\sum_{k}^{S}{\Bigl{\|}\nabla\mathcal{L}_{k}\Bigl{\|}}^{2}</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">     <math id="alg1.l10.m1.1" class="ltx_Math" alttext="\mathbf{W}_{t+1}^{s}\leftarrow\mathbf{W}_{t}^{s}-\eta\nabla\mathcal{L}_{s}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msubsup id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi id="alg1.l10.m1.1.1.2.2.2" xref="alg1.l10.m1.1.1.2.2.2.cmml">𝐖</mi><mrow id="alg1.l10.m1.1.1.2.2.3" xref="alg1.l10.m1.1.1.2.2.3.cmml"><mi id="alg1.l10.m1.1.1.2.2.3.2" xref="alg1.l10.m1.1.1.2.2.3.2.cmml">t</mi><mo id="alg1.l10.m1.1.1.2.2.3.1" xref="alg1.l10.m1.1.1.2.2.3.1.cmml">+</mo><mn id="alg1.l10.m1.1.1.2.2.3.3" xref="alg1.l10.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">s</mi></msubsup><mo stretchy="false" id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">←</mo><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><msubsup id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml"><mi id="alg1.l10.m1.1.1.3.2.2.2" xref="alg1.l10.m1.1.1.3.2.2.2.cmml">𝐖</mi><mi id="alg1.l10.m1.1.1.3.2.2.3" xref="alg1.l10.m1.1.1.3.2.2.3.cmml">t</mi><mi id="alg1.l10.m1.1.1.3.2.3" xref="alg1.l10.m1.1.1.3.2.3.cmml">s</mi></msubsup><mo id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml"><mi id="alg1.l10.m1.1.1.3.3.2" xref="alg1.l10.m1.1.1.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l10.m1.1.1.3.3.1" xref="alg1.l10.m1.1.1.3.3.1.cmml">​</mo><mrow id="alg1.l10.m1.1.1.3.3.3" xref="alg1.l10.m1.1.1.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l10.m1.1.1.3.3.3.1" xref="alg1.l10.m1.1.1.3.3.3.1.cmml">∇</mo><msub id="alg1.l10.m1.1.1.3.3.3.2" xref="alg1.l10.m1.1.1.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.1.1.3.3.3.2.2" xref="alg1.l10.m1.1.1.3.3.3.2.2.cmml">ℒ</mi><mi id="alg1.l10.m1.1.1.3.3.3.2.3" xref="alg1.l10.m1.1.1.3.3.3.2.3.cmml">s</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2">superscript</csymbol><apply id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.2.1.cmml" xref="alg1.l10.m1.1.1.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.2.cmml" xref="alg1.l10.m1.1.1.2.2.2">𝐖</ci><apply id="alg1.l10.m1.1.1.2.2.3.cmml" xref="alg1.l10.m1.1.1.2.2.3"><plus id="alg1.l10.m1.1.1.2.2.3.1.cmml" xref="alg1.l10.m1.1.1.2.2.3.1"></plus><ci id="alg1.l10.m1.1.1.2.2.3.2.cmml" xref="alg1.l10.m1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l10.m1.1.1.2.2.3.3.cmml" xref="alg1.l10.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑠</ci></apply><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><minus id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></minus><apply id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.2.1.cmml" xref="alg1.l10.m1.1.1.3.2">superscript</csymbol><apply id="alg1.l10.m1.1.1.3.2.2.cmml" xref="alg1.l10.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.2.2.1.cmml" xref="alg1.l10.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.2.2.cmml" xref="alg1.l10.m1.1.1.3.2.2.2">𝐖</ci><ci id="alg1.l10.m1.1.1.3.2.2.3.cmml" xref="alg1.l10.m1.1.1.3.2.2.3">𝑡</ci></apply><ci id="alg1.l10.m1.1.1.3.2.3.cmml" xref="alg1.l10.m1.1.1.3.2.3">𝑠</ci></apply><apply id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3"><times id="alg1.l10.m1.1.1.3.3.1.cmml" xref="alg1.l10.m1.1.1.3.3.1"></times><ci id="alg1.l10.m1.1.1.3.3.2.cmml" xref="alg1.l10.m1.1.1.3.3.2">𝜂</ci><apply id="alg1.l10.m1.1.1.3.3.3.cmml" xref="alg1.l10.m1.1.1.3.3.3"><ci id="alg1.l10.m1.1.1.3.3.3.1.cmml" xref="alg1.l10.m1.1.1.3.3.3.1">∇</ci><apply id="alg1.l10.m1.1.1.3.3.3.2.cmml" xref="alg1.l10.m1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.3.3.2.1.cmml" xref="alg1.l10.m1.1.1.3.3.3.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.3.3.2.2.cmml" xref="alg1.l10.m1.1.1.3.3.3.2.2">ℒ</ci><ci id="alg1.l10.m1.1.1.3.3.3.2.3.cmml" xref="alg1.l10.m1.1.1.3.3.3.2.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\mathbf{W}_{t+1}^{s}\leftarrow\mathbf{W}_{t}^{s}-\eta\nabla\mathcal{L}_{s}</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">  <span id="alg1.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">  <math id="alg1.l12.m1.1" class="ltx_Math" alttext="\mathbf{W}_{t}^{k}\leftarrow ClientUpdate(\nabla\mathcal{L}_{s})" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msubsup id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.3.2.2" xref="alg1.l12.m1.1.1.3.2.2.cmml">𝐖</mi><mi id="alg1.l12.m1.1.1.3.2.3" xref="alg1.l12.m1.1.1.3.2.3.cmml">t</mi><mi id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">←</mo><mrow id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml"><mi id="alg1.l12.m1.1.1.1.3" xref="alg1.l12.m1.1.1.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l12.m1.1.1.1.4" xref="alg1.l12.m1.1.1.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2a" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l12.m1.1.1.1.5" xref="alg1.l12.m1.1.1.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2b" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l12.m1.1.1.1.6" xref="alg1.l12.m1.1.1.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2c" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l12.m1.1.1.1.7" xref="alg1.l12.m1.1.1.1.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2d" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l12.m1.1.1.1.8" xref="alg1.l12.m1.1.1.1.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2e" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l12.m1.1.1.1.9" xref="alg1.l12.m1.1.1.1.9.cmml">U</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2f" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l12.m1.1.1.1.10" xref="alg1.l12.m1.1.1.1.10.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2g" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l12.m1.1.1.1.11" xref="alg1.l12.m1.1.1.1.11.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2h" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l12.m1.1.1.1.12" xref="alg1.l12.m1.1.1.1.12.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2i" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l12.m1.1.1.1.13" xref="alg1.l12.m1.1.1.1.13.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2j" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l12.m1.1.1.1.14" xref="alg1.l12.m1.1.1.1.14.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.1.2k" xref="alg1.l12.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l12.m1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l12.m1.1.1.1.1.1.2" xref="alg1.l12.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l12.m1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="alg1.l12.m1.1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.1.cmml">∇</mo><msub id="alg1.l12.m1.1.1.1.1.1.1.2" xref="alg1.l12.m1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.1.1.1.1.1.2.2" xref="alg1.l12.m1.1.1.1.1.1.1.2.2.cmml">ℒ</mi><mi id="alg1.l12.m1.1.1.1.1.1.1.2.3" xref="alg1.l12.m1.1.1.1.1.1.1.2.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="alg1.l12.m1.1.1.1.1.1.3" xref="alg1.l12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">←</ci><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3">superscript</csymbol><apply id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.2.1.cmml" xref="alg1.l12.m1.1.1.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.2.2">𝐖</ci><ci id="alg1.l12.m1.1.1.3.2.3.cmml" xref="alg1.l12.m1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3">𝑘</ci></apply><apply id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"><times id="alg1.l12.m1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.2"></times><ci id="alg1.l12.m1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.3">𝐶</ci><ci id="alg1.l12.m1.1.1.1.4.cmml" xref="alg1.l12.m1.1.1.1.4">𝑙</ci><ci id="alg1.l12.m1.1.1.1.5.cmml" xref="alg1.l12.m1.1.1.1.5">𝑖</ci><ci id="alg1.l12.m1.1.1.1.6.cmml" xref="alg1.l12.m1.1.1.1.6">𝑒</ci><ci id="alg1.l12.m1.1.1.1.7.cmml" xref="alg1.l12.m1.1.1.1.7">𝑛</ci><ci id="alg1.l12.m1.1.1.1.8.cmml" xref="alg1.l12.m1.1.1.1.8">𝑡</ci><ci id="alg1.l12.m1.1.1.1.9.cmml" xref="alg1.l12.m1.1.1.1.9">𝑈</ci><ci id="alg1.l12.m1.1.1.1.10.cmml" xref="alg1.l12.m1.1.1.1.10">𝑝</ci><ci id="alg1.l12.m1.1.1.1.11.cmml" xref="alg1.l12.m1.1.1.1.11">𝑑</ci><ci id="alg1.l12.m1.1.1.1.12.cmml" xref="alg1.l12.m1.1.1.1.12">𝑎</ci><ci id="alg1.l12.m1.1.1.1.13.cmml" xref="alg1.l12.m1.1.1.1.13">𝑡</ci><ci id="alg1.l12.m1.1.1.1.14.cmml" xref="alg1.l12.m1.1.1.1.14">𝑒</ci><apply id="alg1.l12.m1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1"><ci id="alg1.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1">∇</ci><apply id="alg1.l12.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2.2">ℒ</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\mathbf{W}_{t}^{k}\leftarrow ClientUpdate(\nabla\mathcal{L}_{s})</annotation></semantics></math>

</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.2" class="ltx_p ltx_figure_panel"><span id="alg1.2.m1.1.1.1" class="ltx_text ltx_markedasmath ltx_font_bold">ClientRepresentation(<math id="alg1.2.m1.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{W}_{t}^{k}" display="inline"><semantics id="alg1.2.m1.1.1.1.m1.1a"><msubsup id="alg1.2.m1.1.1.1.m1.1.1" xref="alg1.2.m1.1.1.1.m1.1.1.cmml"><mi id="alg1.2.m1.1.1.1.m1.1.1.2.2" xref="alg1.2.m1.1.1.1.m1.1.1.2.2.cmml">𝐖</mi><mi id="alg1.2.m1.1.1.1.m1.1.1.2.3" xref="alg1.2.m1.1.1.1.m1.1.1.2.3.cmml">t</mi><mi id="alg1.2.m1.1.1.1.m1.1.1.3" xref="alg1.2.m1.1.1.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.2.m1.1.1.1.m1.1b"><apply id="alg1.2.m1.1.1.1.m1.1.1.cmml" xref="alg1.2.m1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.2.m1.1.1.1.m1.1.1.1.cmml" xref="alg1.2.m1.1.1.1.m1.1.1">superscript</csymbol><apply id="alg1.2.m1.1.1.1.m1.1.1.2.cmml" xref="alg1.2.m1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.2.m1.1.1.1.m1.1.1.2.1.cmml" xref="alg1.2.m1.1.1.1.m1.1.1">subscript</csymbol><ci id="alg1.2.m1.1.1.1.m1.1.1.2.2.cmml" xref="alg1.2.m1.1.1.1.m1.1.1.2.2">𝐖</ci><ci id="alg1.2.m1.1.1.1.m1.1.1.2.3.cmml" xref="alg1.2.m1.1.1.1.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.2.m1.1.1.1.m1.1.1.3.cmml" xref="alg1.2.m1.1.1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m1.1.1.1.m1.1c">\mathbf{W}_{t}^{k}</annotation></semantics></math>):</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.7" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1a" class="ltx_listingline">  <span id="alg1.l1a.1" class="ltx_text ltx_font_bold">if</span> <span id="alg1.l1a.2" class="ltx_text">k is first client to start training</span> <span id="alg1.l1a.3" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l2a" class="ltx_listingline">     <math id="alg1.l2a.m1.1" class="ltx_Math" alttext="\mathbf{W}_{t}^{k}\leftarrow\text{initial weights from server}" display="inline"><semantics id="alg1.l2a.m1.1a"><mrow id="alg1.l2a.m1.1.1" xref="alg1.l2a.m1.1.1.cmml"><msubsup id="alg1.l2a.m1.1.1.2" xref="alg1.l2a.m1.1.1.2.cmml"><mi id="alg1.l2a.m1.1.1.2.2.2" xref="alg1.l2a.m1.1.1.2.2.2.cmml">𝐖</mi><mi id="alg1.l2a.m1.1.1.2.2.3" xref="alg1.l2a.m1.1.1.2.2.3.cmml">t</mi><mi id="alg1.l2a.m1.1.1.2.3" xref="alg1.l2a.m1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l2a.m1.1.1.1" xref="alg1.l2a.m1.1.1.1.cmml">←</mo><mtext id="alg1.l2a.m1.1.1.3" xref="alg1.l2a.m1.1.1.3a.cmml">initial weights from server</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2a.m1.1b"><apply id="alg1.l2a.m1.1.1.cmml" xref="alg1.l2a.m1.1.1"><ci id="alg1.l2a.m1.1.1.1.cmml" xref="alg1.l2a.m1.1.1.1">←</ci><apply id="alg1.l2a.m1.1.1.2.cmml" xref="alg1.l2a.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2a.m1.1.1.2.1.cmml" xref="alg1.l2a.m1.1.1.2">superscript</csymbol><apply id="alg1.l2a.m1.1.1.2.2.cmml" xref="alg1.l2a.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2a.m1.1.1.2.2.1.cmml" xref="alg1.l2a.m1.1.1.2">subscript</csymbol><ci id="alg1.l2a.m1.1.1.2.2.2.cmml" xref="alg1.l2a.m1.1.1.2.2.2">𝐖</ci><ci id="alg1.l2a.m1.1.1.2.2.3.cmml" xref="alg1.l2a.m1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l2a.m1.1.1.2.3.cmml" xref="alg1.l2a.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l2a.m1.1.1.3a.cmml" xref="alg1.l2a.m1.1.1.3"><mtext id="alg1.l2a.m1.1.1.3.cmml" xref="alg1.l2a.m1.1.1.3">initial weights from server</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2a.m1.1c">\mathbf{W}_{t}^{k}\leftarrow\text{initial weights from server}</annotation></semantics></math>

</div>
<div id="alg1.l3a" class="ltx_listingline">  <span id="alg1.l3a.1" class="ltx_text ltx_font_bold">else</span>



</div>
<div id="alg1.l4a" class="ltx_listingline">     <math id="alg1.l4a.m1.1" class="ltx_Math" alttext="\mathbf{W}_{t}^{k}\leftarrow\mathbf{W}_{t-1}^{k-1}\text{from the previous }ClientUpdate(\nabla\mathcal{L}_{s})" display="inline"><semantics id="alg1.l4a.m1.1a"><mrow id="alg1.l4a.m1.1.1" xref="alg1.l4a.m1.1.1.cmml"><msubsup id="alg1.l4a.m1.1.1.3" xref="alg1.l4a.m1.1.1.3.cmml"><mi id="alg1.l4a.m1.1.1.3.2.2" xref="alg1.l4a.m1.1.1.3.2.2.cmml">𝐖</mi><mi id="alg1.l4a.m1.1.1.3.2.3" xref="alg1.l4a.m1.1.1.3.2.3.cmml">t</mi><mi id="alg1.l4a.m1.1.1.3.3" xref="alg1.l4a.m1.1.1.3.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l4a.m1.1.1.2" xref="alg1.l4a.m1.1.1.2.cmml">←</mo><mrow id="alg1.l4a.m1.1.1.1" xref="alg1.l4a.m1.1.1.1.cmml"><msubsup id="alg1.l4a.m1.1.1.1.3" xref="alg1.l4a.m1.1.1.1.3.cmml"><mi id="alg1.l4a.m1.1.1.1.3.2.2" xref="alg1.l4a.m1.1.1.1.3.2.2.cmml">𝐖</mi><mrow id="alg1.l4a.m1.1.1.1.3.2.3" xref="alg1.l4a.m1.1.1.1.3.2.3.cmml"><mi id="alg1.l4a.m1.1.1.1.3.2.3.2" xref="alg1.l4a.m1.1.1.1.3.2.3.2.cmml">t</mi><mo id="alg1.l4a.m1.1.1.1.3.2.3.1" xref="alg1.l4a.m1.1.1.1.3.2.3.1.cmml">−</mo><mn id="alg1.l4a.m1.1.1.1.3.2.3.3" xref="alg1.l4a.m1.1.1.1.3.2.3.3.cmml">1</mn></mrow><mrow id="alg1.l4a.m1.1.1.1.3.3" xref="alg1.l4a.m1.1.1.1.3.3.cmml"><mi id="alg1.l4a.m1.1.1.1.3.3.2" xref="alg1.l4a.m1.1.1.1.3.3.2.cmml">k</mi><mo id="alg1.l4a.m1.1.1.1.3.3.1" xref="alg1.l4a.m1.1.1.1.3.3.1.cmml">−</mo><mn id="alg1.l4a.m1.1.1.1.3.3.3" xref="alg1.l4a.m1.1.1.1.3.3.3.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mtext id="alg1.l4a.m1.1.1.1.4" xref="alg1.l4a.m1.1.1.1.4a.cmml">from the previous </mtext><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2a" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l4a.m1.1.1.1.5" xref="alg1.l4a.m1.1.1.1.5.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2b" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l4a.m1.1.1.1.6" xref="alg1.l4a.m1.1.1.1.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2c" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l4a.m1.1.1.1.7" xref="alg1.l4a.m1.1.1.1.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2d" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l4a.m1.1.1.1.8" xref="alg1.l4a.m1.1.1.1.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2e" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l4a.m1.1.1.1.9" xref="alg1.l4a.m1.1.1.1.9.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2f" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l4a.m1.1.1.1.10" xref="alg1.l4a.m1.1.1.1.10.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2g" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l4a.m1.1.1.1.11" xref="alg1.l4a.m1.1.1.1.11.cmml">U</mi><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2h" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l4a.m1.1.1.1.12" xref="alg1.l4a.m1.1.1.1.12.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2i" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l4a.m1.1.1.1.13" xref="alg1.l4a.m1.1.1.1.13.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2j" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l4a.m1.1.1.1.14" xref="alg1.l4a.m1.1.1.1.14.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2k" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l4a.m1.1.1.1.15" xref="alg1.l4a.m1.1.1.1.15.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2l" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l4a.m1.1.1.1.16" xref="alg1.l4a.m1.1.1.1.16.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l4a.m1.1.1.1.2m" xref="alg1.l4a.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l4a.m1.1.1.1.1.1" xref="alg1.l4a.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l4a.m1.1.1.1.1.1.2" xref="alg1.l4a.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l4a.m1.1.1.1.1.1.1" xref="alg1.l4a.m1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="alg1.l4a.m1.1.1.1.1.1.1.1" xref="alg1.l4a.m1.1.1.1.1.1.1.1.cmml">∇</mo><msub id="alg1.l4a.m1.1.1.1.1.1.1.2" xref="alg1.l4a.m1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l4a.m1.1.1.1.1.1.1.2.2" xref="alg1.l4a.m1.1.1.1.1.1.1.2.2.cmml">ℒ</mi><mi id="alg1.l4a.m1.1.1.1.1.1.1.2.3" xref="alg1.l4a.m1.1.1.1.1.1.1.2.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="alg1.l4a.m1.1.1.1.1.1.3" xref="alg1.l4a.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4a.m1.1b"><apply id="alg1.l4a.m1.1.1.cmml" xref="alg1.l4a.m1.1.1"><ci id="alg1.l4a.m1.1.1.2.cmml" xref="alg1.l4a.m1.1.1.2">←</ci><apply id="alg1.l4a.m1.1.1.3.cmml" xref="alg1.l4a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4a.m1.1.1.3.1.cmml" xref="alg1.l4a.m1.1.1.3">superscript</csymbol><apply id="alg1.l4a.m1.1.1.3.2.cmml" xref="alg1.l4a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4a.m1.1.1.3.2.1.cmml" xref="alg1.l4a.m1.1.1.3">subscript</csymbol><ci id="alg1.l4a.m1.1.1.3.2.2.cmml" xref="alg1.l4a.m1.1.1.3.2.2">𝐖</ci><ci id="alg1.l4a.m1.1.1.3.2.3.cmml" xref="alg1.l4a.m1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l4a.m1.1.1.3.3.cmml" xref="alg1.l4a.m1.1.1.3.3">𝑘</ci></apply><apply id="alg1.l4a.m1.1.1.1.cmml" xref="alg1.l4a.m1.1.1.1"><times id="alg1.l4a.m1.1.1.1.2.cmml" xref="alg1.l4a.m1.1.1.1.2"></times><apply id="alg1.l4a.m1.1.1.1.3.cmml" xref="alg1.l4a.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4a.m1.1.1.1.3.1.cmml" xref="alg1.l4a.m1.1.1.1.3">superscript</csymbol><apply id="alg1.l4a.m1.1.1.1.3.2.cmml" xref="alg1.l4a.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4a.m1.1.1.1.3.2.1.cmml" xref="alg1.l4a.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l4a.m1.1.1.1.3.2.2.cmml" xref="alg1.l4a.m1.1.1.1.3.2.2">𝐖</ci><apply id="alg1.l4a.m1.1.1.1.3.2.3.cmml" xref="alg1.l4a.m1.1.1.1.3.2.3"><minus id="alg1.l4a.m1.1.1.1.3.2.3.1.cmml" xref="alg1.l4a.m1.1.1.1.3.2.3.1"></minus><ci id="alg1.l4a.m1.1.1.1.3.2.3.2.cmml" xref="alg1.l4a.m1.1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l4a.m1.1.1.1.3.2.3.3.cmml" xref="alg1.l4a.m1.1.1.1.3.2.3.3">1</cn></apply></apply><apply id="alg1.l4a.m1.1.1.1.3.3.cmml" xref="alg1.l4a.m1.1.1.1.3.3"><minus id="alg1.l4a.m1.1.1.1.3.3.1.cmml" xref="alg1.l4a.m1.1.1.1.3.3.1"></minus><ci id="alg1.l4a.m1.1.1.1.3.3.2.cmml" xref="alg1.l4a.m1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="alg1.l4a.m1.1.1.1.3.3.3.cmml" xref="alg1.l4a.m1.1.1.1.3.3.3">1</cn></apply></apply><ci id="alg1.l4a.m1.1.1.1.4a.cmml" xref="alg1.l4a.m1.1.1.1.4"><mtext id="alg1.l4a.m1.1.1.1.4.cmml" xref="alg1.l4a.m1.1.1.1.4">from the previous </mtext></ci><ci id="alg1.l4a.m1.1.1.1.5.cmml" xref="alg1.l4a.m1.1.1.1.5">𝐶</ci><ci id="alg1.l4a.m1.1.1.1.6.cmml" xref="alg1.l4a.m1.1.1.1.6">𝑙</ci><ci id="alg1.l4a.m1.1.1.1.7.cmml" xref="alg1.l4a.m1.1.1.1.7">𝑖</ci><ci id="alg1.l4a.m1.1.1.1.8.cmml" xref="alg1.l4a.m1.1.1.1.8">𝑒</ci><ci id="alg1.l4a.m1.1.1.1.9.cmml" xref="alg1.l4a.m1.1.1.1.9">𝑛</ci><ci id="alg1.l4a.m1.1.1.1.10.cmml" xref="alg1.l4a.m1.1.1.1.10">𝑡</ci><ci id="alg1.l4a.m1.1.1.1.11.cmml" xref="alg1.l4a.m1.1.1.1.11">𝑈</ci><ci id="alg1.l4a.m1.1.1.1.12.cmml" xref="alg1.l4a.m1.1.1.1.12">𝑝</ci><ci id="alg1.l4a.m1.1.1.1.13.cmml" xref="alg1.l4a.m1.1.1.1.13">𝑑</ci><ci id="alg1.l4a.m1.1.1.1.14.cmml" xref="alg1.l4a.m1.1.1.1.14">𝑎</ci><ci id="alg1.l4a.m1.1.1.1.15.cmml" xref="alg1.l4a.m1.1.1.1.15">𝑡</ci><ci id="alg1.l4a.m1.1.1.1.16.cmml" xref="alg1.l4a.m1.1.1.1.16">𝑒</ci><apply id="alg1.l4a.m1.1.1.1.1.1.1.cmml" xref="alg1.l4a.m1.1.1.1.1.1"><ci id="alg1.l4a.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l4a.m1.1.1.1.1.1.1.1">∇</ci><apply id="alg1.l4a.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l4a.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4a.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l4a.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l4a.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l4a.m1.1.1.1.1.1.1.2.2">ℒ</ci><ci id="alg1.l4a.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l4a.m1.1.1.1.1.1.1.2.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4a.m1.1c">\mathbf{W}_{t}^{k}\leftarrow\mathbf{W}_{t-1}^{k-1}\text{from the previous }ClientUpdate(\nabla\mathcal{L}_{s})</annotation></semantics></math>

</div>
<div id="alg1.l5a" class="ltx_listingline">  <span id="alg1.l5a.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5a.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l6a" class="ltx_listingline">  <span id="alg1.l6a.1" class="ltx_text ltx_font_bold">for</span> <span id="alg1.l6a.2" class="ltx_text ltx_markedasmath">each local client epoch, i=1,2,..k</span> <span id="alg1.l6a.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l7a" class="ltx_listingline">     <math id="alg1.l7a.m1.1" class="ltx_Math" alttext="\text{Calculate hidden representation }\bm{\phi}(x^{k}_{t})" display="inline"><semantics id="alg1.l7a.m1.1a"><mrow id="alg1.l7a.m1.1.1" xref="alg1.l7a.m1.1.1.cmml"><mtext id="alg1.l7a.m1.1.1.3" xref="alg1.l7a.m1.1.1.3a.cmml">Calculate hidden representation </mtext><mo lspace="0em" rspace="0em" id="alg1.l7a.m1.1.1.2" xref="alg1.l7a.m1.1.1.2.cmml">​</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l7a.m1.1.1.4" xref="alg1.l7a.m1.1.1.4.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="alg1.l7a.m1.1.1.2a" xref="alg1.l7a.m1.1.1.2.cmml">​</mo><mrow id="alg1.l7a.m1.1.1.1.1" xref="alg1.l7a.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7a.m1.1.1.1.1.2" xref="alg1.l7a.m1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l7a.m1.1.1.1.1.1" xref="alg1.l7a.m1.1.1.1.1.1.cmml"><mi id="alg1.l7a.m1.1.1.1.1.1.2.2" xref="alg1.l7a.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="alg1.l7a.m1.1.1.1.1.1.3" xref="alg1.l7a.m1.1.1.1.1.1.3.cmml">t</mi><mi id="alg1.l7a.m1.1.1.1.1.1.2.3" xref="alg1.l7a.m1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l7a.m1.1.1.1.1.3" xref="alg1.l7a.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7a.m1.1b"><apply id="alg1.l7a.m1.1.1.cmml" xref="alg1.l7a.m1.1.1"><times id="alg1.l7a.m1.1.1.2.cmml" xref="alg1.l7a.m1.1.1.2"></times><ci id="alg1.l7a.m1.1.1.3a.cmml" xref="alg1.l7a.m1.1.1.3"><mtext id="alg1.l7a.m1.1.1.3.cmml" xref="alg1.l7a.m1.1.1.3">Calculate hidden representation </mtext></ci><ci id="alg1.l7a.m1.1.1.4.cmml" xref="alg1.l7a.m1.1.1.4">bold-italic-ϕ</ci><apply id="alg1.l7a.m1.1.1.1.1.1.cmml" xref="alg1.l7a.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7a.m1.1.1.1.1.1.1.cmml" xref="alg1.l7a.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l7a.m1.1.1.1.1.1.2.cmml" xref="alg1.l7a.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7a.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l7a.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l7a.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l7a.m1.1.1.1.1.1.2.2">𝑥</ci><ci id="alg1.l7a.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l7a.m1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l7a.m1.1.1.1.1.1.3.cmml" xref="alg1.l7a.m1.1.1.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7a.m1.1c">\text{Calculate hidden representation }\bm{\phi}(x^{k}_{t})</annotation></semantics></math>

</div>
<div id="alg1.l8a" class="ltx_listingline">  <span id="alg1.l8a.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8a.2" class="ltx_text ltx_font_bold">forreturn</span> <math id="alg1.l8a.m1.1" class="ltx_Math" alttext="\bm{\phi}(x^{k}_{t})\text{ and }\mathbf{Y^{k}}\text{ to server}" display="inline"><semantics id="alg1.l8a.m1.1a"><mrow id="alg1.l8a.m1.1.1" xref="alg1.l8a.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l8a.m1.1.1.3" xref="alg1.l8a.m1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="alg1.l8a.m1.1.1.2" xref="alg1.l8a.m1.1.1.2.cmml">​</mo><mrow id="alg1.l8a.m1.1.1.1.1" xref="alg1.l8a.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l8a.m1.1.1.1.1.2" xref="alg1.l8a.m1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l8a.m1.1.1.1.1.1" xref="alg1.l8a.m1.1.1.1.1.1.cmml"><mi id="alg1.l8a.m1.1.1.1.1.1.2.2" xref="alg1.l8a.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="alg1.l8a.m1.1.1.1.1.1.3" xref="alg1.l8a.m1.1.1.1.1.1.3.cmml">t</mi><mi id="alg1.l8a.m1.1.1.1.1.1.2.3" xref="alg1.l8a.m1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l8a.m1.1.1.1.1.3" xref="alg1.l8a.m1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.l8a.m1.1.1.2a" xref="alg1.l8a.m1.1.1.2.cmml">​</mo><mtext id="alg1.l8a.m1.1.1.4" xref="alg1.l8a.m1.1.1.4a.cmml"> and </mtext><mo lspace="0em" rspace="0em" id="alg1.l8a.m1.1.1.2b" xref="alg1.l8a.m1.1.1.2.cmml">​</mo><msup id="alg1.l8a.m1.1.1.5" xref="alg1.l8a.m1.1.1.5.cmml"><mi id="alg1.l8a.m1.1.1.5.2" xref="alg1.l8a.m1.1.1.5.2.cmml">𝐘</mi><mi id="alg1.l8a.m1.1.1.5.3" xref="alg1.l8a.m1.1.1.5.3.cmml">𝐤</mi></msup><mo lspace="0em" rspace="0em" id="alg1.l8a.m1.1.1.2c" xref="alg1.l8a.m1.1.1.2.cmml">​</mo><mtext id="alg1.l8a.m1.1.1.6" xref="alg1.l8a.m1.1.1.6a.cmml"> to server</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8a.m1.1b"><apply id="alg1.l8a.m1.1.1.cmml" xref="alg1.l8a.m1.1.1"><times id="alg1.l8a.m1.1.1.2.cmml" xref="alg1.l8a.m1.1.1.2"></times><ci id="alg1.l8a.m1.1.1.3.cmml" xref="alg1.l8a.m1.1.1.3">bold-italic-ϕ</ci><apply id="alg1.l8a.m1.1.1.1.1.1.cmml" xref="alg1.l8a.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8a.m1.1.1.1.1.1.1.cmml" xref="alg1.l8a.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l8a.m1.1.1.1.1.1.2.cmml" xref="alg1.l8a.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8a.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l8a.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l8a.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l8a.m1.1.1.1.1.1.2.2">𝑥</ci><ci id="alg1.l8a.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l8a.m1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l8a.m1.1.1.1.1.1.3.cmml" xref="alg1.l8a.m1.1.1.1.1.1.3">𝑡</ci></apply><ci id="alg1.l8a.m1.1.1.4a.cmml" xref="alg1.l8a.m1.1.1.4"><mtext id="alg1.l8a.m1.1.1.4.cmml" xref="alg1.l8a.m1.1.1.4"> and </mtext></ci><apply id="alg1.l8a.m1.1.1.5.cmml" xref="alg1.l8a.m1.1.1.5"><csymbol cd="ambiguous" id="alg1.l8a.m1.1.1.5.1.cmml" xref="alg1.l8a.m1.1.1.5">superscript</csymbol><ci id="alg1.l8a.m1.1.1.5.2.cmml" xref="alg1.l8a.m1.1.1.5.2">𝐘</ci><ci id="alg1.l8a.m1.1.1.5.3.cmml" xref="alg1.l8a.m1.1.1.5.3">𝐤</ci></apply><ci id="alg1.l8a.m1.1.1.6a.cmml" xref="alg1.l8a.m1.1.1.6"><mtext id="alg1.l8a.m1.1.1.6.cmml" xref="alg1.l8a.m1.1.1.6"> to server</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8a.m1.1c">\bm{\phi}(x^{k}_{t})\text{ and }\mathbf{Y^{k}}\text{ to server}</annotation></semantics></math>

</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.3" class="ltx_p ltx_figure_panel"><span id="alg1.3.1" class="ltx_text ltx_markedasmath ltx_font_bold">ClientUpdate:</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.8" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1b" class="ltx_listingline">  <span id="alg1.l1b.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l1b.m1.1" class="ltx_Math" alttext="\text{each client }k\in S" display="inline"><semantics id="alg1.l1b.m1.1a"><mrow id="alg1.l1b.m1.1.1" xref="alg1.l1b.m1.1.1.cmml"><mrow id="alg1.l1b.m1.1.1.2" xref="alg1.l1b.m1.1.1.2.cmml"><mtext id="alg1.l1b.m1.1.1.2.2" xref="alg1.l1b.m1.1.1.2.2a.cmml">each client </mtext><mo lspace="0em" rspace="0em" id="alg1.l1b.m1.1.1.2.1" xref="alg1.l1b.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l1b.m1.1.1.2.3" xref="alg1.l1b.m1.1.1.2.3.cmml">k</mi></mrow><mo id="alg1.l1b.m1.1.1.1" xref="alg1.l1b.m1.1.1.1.cmml">∈</mo><mi id="alg1.l1b.m1.1.1.3" xref="alg1.l1b.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1b.m1.1b"><apply id="alg1.l1b.m1.1.1.cmml" xref="alg1.l1b.m1.1.1"><in id="alg1.l1b.m1.1.1.1.cmml" xref="alg1.l1b.m1.1.1.1"></in><apply id="alg1.l1b.m1.1.1.2.cmml" xref="alg1.l1b.m1.1.1.2"><times id="alg1.l1b.m1.1.1.2.1.cmml" xref="alg1.l1b.m1.1.1.2.1"></times><ci id="alg1.l1b.m1.1.1.2.2a.cmml" xref="alg1.l1b.m1.1.1.2.2"><mtext id="alg1.l1b.m1.1.1.2.2.cmml" xref="alg1.l1b.m1.1.1.2.2">each client </mtext></ci><ci id="alg1.l1b.m1.1.1.2.3.cmml" xref="alg1.l1b.m1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l1b.m1.1.1.3.cmml" xref="alg1.l1b.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1b.m1.1c">\text{each client }k\in S</annotation></semantics></math> <span id="alg1.l1b.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l2b" class="ltx_listingline">     <math id="alg1.l2b.m1.1" class="ltx_Math" alttext="\mathbf{W}_{t+1}^{k}\leftarrow\mathbf{W}_{t}^{k}-\eta\nabla\mathcal{L}_{s}" display="inline"><semantics id="alg1.l2b.m1.1a"><mrow id="alg1.l2b.m1.1.1" xref="alg1.l2b.m1.1.1.cmml"><msubsup id="alg1.l2b.m1.1.1.2" xref="alg1.l2b.m1.1.1.2.cmml"><mi id="alg1.l2b.m1.1.1.2.2.2" xref="alg1.l2b.m1.1.1.2.2.2.cmml">𝐖</mi><mrow id="alg1.l2b.m1.1.1.2.2.3" xref="alg1.l2b.m1.1.1.2.2.3.cmml"><mi id="alg1.l2b.m1.1.1.2.2.3.2" xref="alg1.l2b.m1.1.1.2.2.3.2.cmml">t</mi><mo id="alg1.l2b.m1.1.1.2.2.3.1" xref="alg1.l2b.m1.1.1.2.2.3.1.cmml">+</mo><mn id="alg1.l2b.m1.1.1.2.2.3.3" xref="alg1.l2b.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="alg1.l2b.m1.1.1.2.3" xref="alg1.l2b.m1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l2b.m1.1.1.1" xref="alg1.l2b.m1.1.1.1.cmml">←</mo><mrow id="alg1.l2b.m1.1.1.3" xref="alg1.l2b.m1.1.1.3.cmml"><msubsup id="alg1.l2b.m1.1.1.3.2" xref="alg1.l2b.m1.1.1.3.2.cmml"><mi id="alg1.l2b.m1.1.1.3.2.2.2" xref="alg1.l2b.m1.1.1.3.2.2.2.cmml">𝐖</mi><mi id="alg1.l2b.m1.1.1.3.2.2.3" xref="alg1.l2b.m1.1.1.3.2.2.3.cmml">t</mi><mi id="alg1.l2b.m1.1.1.3.2.3" xref="alg1.l2b.m1.1.1.3.2.3.cmml">k</mi></msubsup><mo id="alg1.l2b.m1.1.1.3.1" xref="alg1.l2b.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l2b.m1.1.1.3.3" xref="alg1.l2b.m1.1.1.3.3.cmml"><mi id="alg1.l2b.m1.1.1.3.3.2" xref="alg1.l2b.m1.1.1.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l2b.m1.1.1.3.3.1" xref="alg1.l2b.m1.1.1.3.3.1.cmml">​</mo><mrow id="alg1.l2b.m1.1.1.3.3.3" xref="alg1.l2b.m1.1.1.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l2b.m1.1.1.3.3.3.1" xref="alg1.l2b.m1.1.1.3.3.3.1.cmml">∇</mo><msub id="alg1.l2b.m1.1.1.3.3.3.2" xref="alg1.l2b.m1.1.1.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2b.m1.1.1.3.3.3.2.2" xref="alg1.l2b.m1.1.1.3.3.3.2.2.cmml">ℒ</mi><mi id="alg1.l2b.m1.1.1.3.3.3.2.3" xref="alg1.l2b.m1.1.1.3.3.3.2.3.cmml">s</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2b.m1.1b"><apply id="alg1.l2b.m1.1.1.cmml" xref="alg1.l2b.m1.1.1"><ci id="alg1.l2b.m1.1.1.1.cmml" xref="alg1.l2b.m1.1.1.1">←</ci><apply id="alg1.l2b.m1.1.1.2.cmml" xref="alg1.l2b.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2b.m1.1.1.2.1.cmml" xref="alg1.l2b.m1.1.1.2">superscript</csymbol><apply id="alg1.l2b.m1.1.1.2.2.cmml" xref="alg1.l2b.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2b.m1.1.1.2.2.1.cmml" xref="alg1.l2b.m1.1.1.2">subscript</csymbol><ci id="alg1.l2b.m1.1.1.2.2.2.cmml" xref="alg1.l2b.m1.1.1.2.2.2">𝐖</ci><apply id="alg1.l2b.m1.1.1.2.2.3.cmml" xref="alg1.l2b.m1.1.1.2.2.3"><plus id="alg1.l2b.m1.1.1.2.2.3.1.cmml" xref="alg1.l2b.m1.1.1.2.2.3.1"></plus><ci id="alg1.l2b.m1.1.1.2.2.3.2.cmml" xref="alg1.l2b.m1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l2b.m1.1.1.2.2.3.3.cmml" xref="alg1.l2b.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="alg1.l2b.m1.1.1.2.3.cmml" xref="alg1.l2b.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l2b.m1.1.1.3.cmml" xref="alg1.l2b.m1.1.1.3"><minus id="alg1.l2b.m1.1.1.3.1.cmml" xref="alg1.l2b.m1.1.1.3.1"></minus><apply id="alg1.l2b.m1.1.1.3.2.cmml" xref="alg1.l2b.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l2b.m1.1.1.3.2.1.cmml" xref="alg1.l2b.m1.1.1.3.2">superscript</csymbol><apply id="alg1.l2b.m1.1.1.3.2.2.cmml" xref="alg1.l2b.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l2b.m1.1.1.3.2.2.1.cmml" xref="alg1.l2b.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l2b.m1.1.1.3.2.2.2.cmml" xref="alg1.l2b.m1.1.1.3.2.2.2">𝐖</ci><ci id="alg1.l2b.m1.1.1.3.2.2.3.cmml" xref="alg1.l2b.m1.1.1.3.2.2.3">𝑡</ci></apply><ci id="alg1.l2b.m1.1.1.3.2.3.cmml" xref="alg1.l2b.m1.1.1.3.2.3">𝑘</ci></apply><apply id="alg1.l2b.m1.1.1.3.3.cmml" xref="alg1.l2b.m1.1.1.3.3"><times id="alg1.l2b.m1.1.1.3.3.1.cmml" xref="alg1.l2b.m1.1.1.3.3.1"></times><ci id="alg1.l2b.m1.1.1.3.3.2.cmml" xref="alg1.l2b.m1.1.1.3.3.2">𝜂</ci><apply id="alg1.l2b.m1.1.1.3.3.3.cmml" xref="alg1.l2b.m1.1.1.3.3.3"><ci id="alg1.l2b.m1.1.1.3.3.3.1.cmml" xref="alg1.l2b.m1.1.1.3.3.3.1">∇</ci><apply id="alg1.l2b.m1.1.1.3.3.3.2.cmml" xref="alg1.l2b.m1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l2b.m1.1.1.3.3.3.2.1.cmml" xref="alg1.l2b.m1.1.1.3.3.3.2">subscript</csymbol><ci id="alg1.l2b.m1.1.1.3.3.3.2.2.cmml" xref="alg1.l2b.m1.1.1.3.3.3.2.2">ℒ</ci><ci id="alg1.l2b.m1.1.1.3.3.3.2.3.cmml" xref="alg1.l2b.m1.1.1.3.3.3.2.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2b.m1.1c">\mathbf{W}_{t+1}^{k}\leftarrow\mathbf{W}_{t}^{k}-\eta\nabla\mathcal{L}_{s}</annotation></semantics></math>

</div>
<div id="alg1.l3b" class="ltx_listingline">  <span id="alg1.l3b.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l3b.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l4b" class="ltx_listingline">  <math id="alg1.l4b.m1.1" class="ltx_Math" alttext="\textbf{return }\mathbf{W}_{t+1}^{k}\text{ to server }" display="inline"><semantics id="alg1.l4b.m1.1a"><mrow id="alg1.l4b.m1.1.1" xref="alg1.l4b.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="alg1.l4b.m1.1.1.2" xref="alg1.l4b.m1.1.1.2a.cmml">return </mtext><mo lspace="0em" rspace="0em" id="alg1.l4b.m1.1.1.1" xref="alg1.l4b.m1.1.1.1.cmml">​</mo><msubsup id="alg1.l4b.m1.1.1.3" xref="alg1.l4b.m1.1.1.3.cmml"><mi id="alg1.l4b.m1.1.1.3.2.2" xref="alg1.l4b.m1.1.1.3.2.2.cmml">𝐖</mi><mrow id="alg1.l4b.m1.1.1.3.2.3" xref="alg1.l4b.m1.1.1.3.2.3.cmml"><mi id="alg1.l4b.m1.1.1.3.2.3.2" xref="alg1.l4b.m1.1.1.3.2.3.2.cmml">t</mi><mo id="alg1.l4b.m1.1.1.3.2.3.1" xref="alg1.l4b.m1.1.1.3.2.3.1.cmml">+</mo><mn id="alg1.l4b.m1.1.1.3.2.3.3" xref="alg1.l4b.m1.1.1.3.2.3.3.cmml">1</mn></mrow><mi id="alg1.l4b.m1.1.1.3.3" xref="alg1.l4b.m1.1.1.3.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l4b.m1.1.1.1a" xref="alg1.l4b.m1.1.1.1.cmml">​</mo><mtext id="alg1.l4b.m1.1.1.4" xref="alg1.l4b.m1.1.1.4a.cmml"> to server </mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4b.m1.1b"><apply id="alg1.l4b.m1.1.1.cmml" xref="alg1.l4b.m1.1.1"><times id="alg1.l4b.m1.1.1.1.cmml" xref="alg1.l4b.m1.1.1.1"></times><ci id="alg1.l4b.m1.1.1.2a.cmml" xref="alg1.l4b.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="alg1.l4b.m1.1.1.2.cmml" xref="alg1.l4b.m1.1.1.2">return </mtext></ci><apply id="alg1.l4b.m1.1.1.3.cmml" xref="alg1.l4b.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4b.m1.1.1.3.1.cmml" xref="alg1.l4b.m1.1.1.3">superscript</csymbol><apply id="alg1.l4b.m1.1.1.3.2.cmml" xref="alg1.l4b.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4b.m1.1.1.3.2.1.cmml" xref="alg1.l4b.m1.1.1.3">subscript</csymbol><ci id="alg1.l4b.m1.1.1.3.2.2.cmml" xref="alg1.l4b.m1.1.1.3.2.2">𝐖</ci><apply id="alg1.l4b.m1.1.1.3.2.3.cmml" xref="alg1.l4b.m1.1.1.3.2.3"><plus id="alg1.l4b.m1.1.1.3.2.3.1.cmml" xref="alg1.l4b.m1.1.1.3.2.3.1"></plus><ci id="alg1.l4b.m1.1.1.3.2.3.2.cmml" xref="alg1.l4b.m1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="alg1.l4b.m1.1.1.3.2.3.3.cmml" xref="alg1.l4b.m1.1.1.3.2.3.3">1</cn></apply></apply><ci id="alg1.l4b.m1.1.1.3.3.cmml" xref="alg1.l4b.m1.1.1.3.3">𝑘</ci></apply><ci id="alg1.l4b.m1.1.1.4a.cmml" xref="alg1.l4b.m1.1.1.4"><mtext id="alg1.l4b.m1.1.1.4.cmml" xref="alg1.l4b.m1.1.1.4"> to server </mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4b.m1.1c">\textbf{return }\mathbf{W}_{t+1}^{k}\text{ to server }</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Dataset Details</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text ltx_font_bold">Colored MNIST</span>: Unlike the MNIST dataset which consists of digits 0-9 in grayscale, the colored MNIST dataset consists of input images with digits 0-4 colored red and labelled 0 while digits 5-9 are colored green with label with shape of the digit as the causal feature. In our causal federated learning setup, we split the dataset to two environments, each corresponding to a participant/client.
We sample 2000 data points per client/server domain.
Within the client environments, 80 - 90 % of inputs have their color correlated to the digit whereas within the central server test enviroment has just 10% color-digit correlation which helps in testing the robustness despite the spurious correlation within the inputs.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.2" class="ltx_p"><span id="S4.p2.2.1" class="ltx_text ltx_font_bold">Rotated MNIST</span>: This dataset consist of original MNIST split to multiple client/participating environments by rotating each digit[0-9] with angles <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="0^{\circ},15^{\circ},30^{\circ},45^{\circ},\text{ and }60^{\circ}." display="inline"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1.1"><mrow id="S4.p2.1.m1.1.1.1.1.5" xref="S4.p2.1.m1.1.1.1.1.6.cmml"><msup id="S4.p2.1.m1.1.1.1.1.1.1" xref="S4.p2.1.m1.1.1.1.1.1.1.cmml"><mn id="S4.p2.1.m1.1.1.1.1.1.1.2" xref="S4.p2.1.m1.1.1.1.1.1.1.2.cmml">0</mn><mo id="S4.p2.1.m1.1.1.1.1.1.1.3" xref="S4.p2.1.m1.1.1.1.1.1.1.3.cmml">∘</mo></msup><mo id="S4.p2.1.m1.1.1.1.1.5.6" xref="S4.p2.1.m1.1.1.1.1.6.cmml">,</mo><msup id="S4.p2.1.m1.1.1.1.1.2.2" xref="S4.p2.1.m1.1.1.1.1.2.2.cmml"><mn id="S4.p2.1.m1.1.1.1.1.2.2.2" xref="S4.p2.1.m1.1.1.1.1.2.2.2.cmml">15</mn><mo id="S4.p2.1.m1.1.1.1.1.2.2.3" xref="S4.p2.1.m1.1.1.1.1.2.2.3.cmml">∘</mo></msup><mo id="S4.p2.1.m1.1.1.1.1.5.7" xref="S4.p2.1.m1.1.1.1.1.6.cmml">,</mo><msup id="S4.p2.1.m1.1.1.1.1.3.3" xref="S4.p2.1.m1.1.1.1.1.3.3.cmml"><mn id="S4.p2.1.m1.1.1.1.1.3.3.2" xref="S4.p2.1.m1.1.1.1.1.3.3.2.cmml">30</mn><mo id="S4.p2.1.m1.1.1.1.1.3.3.3" xref="S4.p2.1.m1.1.1.1.1.3.3.3.cmml">∘</mo></msup><mo id="S4.p2.1.m1.1.1.1.1.5.8" xref="S4.p2.1.m1.1.1.1.1.6.cmml">,</mo><msup id="S4.p2.1.m1.1.1.1.1.4.4" xref="S4.p2.1.m1.1.1.1.1.4.4.cmml"><mn id="S4.p2.1.m1.1.1.1.1.4.4.2" xref="S4.p2.1.m1.1.1.1.1.4.4.2.cmml">45</mn><mo id="S4.p2.1.m1.1.1.1.1.4.4.3" xref="S4.p2.1.m1.1.1.1.1.4.4.3.cmml">∘</mo></msup><mo id="S4.p2.1.m1.1.1.1.1.5.9" xref="S4.p2.1.m1.1.1.1.1.6.cmml">,</mo><mrow id="S4.p2.1.m1.1.1.1.1.5.5" xref="S4.p2.1.m1.1.1.1.1.5.5.cmml"><mtext id="S4.p2.1.m1.1.1.1.1.5.5.2" xref="S4.p2.1.m1.1.1.1.1.5.5.2a.cmml"> and </mtext><mo lspace="0em" rspace="0em" id="S4.p2.1.m1.1.1.1.1.5.5.1" xref="S4.p2.1.m1.1.1.1.1.5.5.1.cmml">​</mo><msup id="S4.p2.1.m1.1.1.1.1.5.5.3" xref="S4.p2.1.m1.1.1.1.1.5.5.3.cmml"><mn id="S4.p2.1.m1.1.1.1.1.5.5.3.2" xref="S4.p2.1.m1.1.1.1.1.5.5.3.2.cmml">60</mn><mo id="S4.p2.1.m1.1.1.1.1.5.5.3.3" xref="S4.p2.1.m1.1.1.1.1.5.5.3.3.cmml">∘</mo></msup></mrow></mrow><mo lspace="0em" id="S4.p2.1.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><list id="S4.p2.1.m1.1.1.1.1.6.cmml" xref="S4.p2.1.m1.1.1.1.1.5"><apply id="S4.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1.1.1.1">superscript</csymbol><cn type="integer" id="S4.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.1.1.1.1.2">0</cn><compose id="S4.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.1.1.1.1.3"></compose></apply><apply id="S4.p2.1.m1.1.1.1.1.2.2.cmml" xref="S4.p2.1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.1.2.2.1.cmml" xref="S4.p2.1.m1.1.1.1.1.2.2">superscript</csymbol><cn type="integer" id="S4.p2.1.m1.1.1.1.1.2.2.2.cmml" xref="S4.p2.1.m1.1.1.1.1.2.2.2">15</cn><compose id="S4.p2.1.m1.1.1.1.1.2.2.3.cmml" xref="S4.p2.1.m1.1.1.1.1.2.2.3"></compose></apply><apply id="S4.p2.1.m1.1.1.1.1.3.3.cmml" xref="S4.p2.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.1.3.3.1.cmml" xref="S4.p2.1.m1.1.1.1.1.3.3">superscript</csymbol><cn type="integer" id="S4.p2.1.m1.1.1.1.1.3.3.2.cmml" xref="S4.p2.1.m1.1.1.1.1.3.3.2">30</cn><compose id="S4.p2.1.m1.1.1.1.1.3.3.3.cmml" xref="S4.p2.1.m1.1.1.1.1.3.3.3"></compose></apply><apply id="S4.p2.1.m1.1.1.1.1.4.4.cmml" xref="S4.p2.1.m1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.1.4.4.1.cmml" xref="S4.p2.1.m1.1.1.1.1.4.4">superscript</csymbol><cn type="integer" id="S4.p2.1.m1.1.1.1.1.4.4.2.cmml" xref="S4.p2.1.m1.1.1.1.1.4.4.2">45</cn><compose id="S4.p2.1.m1.1.1.1.1.4.4.3.cmml" xref="S4.p2.1.m1.1.1.1.1.4.4.3"></compose></apply><apply id="S4.p2.1.m1.1.1.1.1.5.5.cmml" xref="S4.p2.1.m1.1.1.1.1.5.5"><times id="S4.p2.1.m1.1.1.1.1.5.5.1.cmml" xref="S4.p2.1.m1.1.1.1.1.5.5.1"></times><ci id="S4.p2.1.m1.1.1.1.1.5.5.2a.cmml" xref="S4.p2.1.m1.1.1.1.1.5.5.2"><mtext id="S4.p2.1.m1.1.1.1.1.5.5.2.cmml" xref="S4.p2.1.m1.1.1.1.1.5.5.2"> and </mtext></ci><apply id="S4.p2.1.m1.1.1.1.1.5.5.3.cmml" xref="S4.p2.1.m1.1.1.1.1.5.5.3"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.1.5.5.3.1.cmml" xref="S4.p2.1.m1.1.1.1.1.5.5.3">superscript</csymbol><cn type="integer" id="S4.p2.1.m1.1.1.1.1.5.5.3.2.cmml" xref="S4.p2.1.m1.1.1.1.1.5.5.3.2">60</cn><compose id="S4.p2.1.m1.1.1.1.1.5.5.3.3.cmml" xref="S4.p2.1.m1.1.1.1.1.5.5.3.3"></compose></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">0^{\circ},15^{\circ},30^{\circ},45^{\circ},\text{ and }60^{\circ}.</annotation></semantics></math> We sample 1000 data points per client/server environment. The server side test domain consist of digits with angles <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="75^{\circ}\text{ and }90^{\circ}" display="inline"><semantics id="S4.p2.2.m2.1a"><mrow id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><msup id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml"><mn id="S4.p2.2.m2.1.1.2.2" xref="S4.p2.2.m2.1.1.2.2.cmml">75</mn><mo id="S4.p2.2.m2.1.1.2.3" xref="S4.p2.2.m2.1.1.2.3.cmml">∘</mo></msup><mo lspace="0em" rspace="0em" id="S4.p2.2.m2.1.1.1" xref="S4.p2.2.m2.1.1.1.cmml">​</mo><mtext id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3a.cmml"> and </mtext><mo lspace="0em" rspace="0em" id="S4.p2.2.m2.1.1.1a" xref="S4.p2.2.m2.1.1.1.cmml">​</mo><msup id="S4.p2.2.m2.1.1.4" xref="S4.p2.2.m2.1.1.4.cmml"><mn id="S4.p2.2.m2.1.1.4.2" xref="S4.p2.2.m2.1.1.4.2.cmml">90</mn><mo id="S4.p2.2.m2.1.1.4.3" xref="S4.p2.2.m2.1.1.4.3.cmml">∘</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><times id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1"></times><apply id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.2.1.cmml" xref="S4.p2.2.m2.1.1.2">superscript</csymbol><cn type="integer" id="S4.p2.2.m2.1.1.2.2.cmml" xref="S4.p2.2.m2.1.1.2.2">75</cn><compose id="S4.p2.2.m2.1.1.2.3.cmml" xref="S4.p2.2.m2.1.1.2.3"></compose></apply><ci id="S4.p2.2.m2.1.1.3a.cmml" xref="S4.p2.2.m2.1.1.3"><mtext id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3"> and </mtext></ci><apply id="S4.p2.2.m2.1.1.4.cmml" xref="S4.p2.2.m2.1.1.4"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.4.1.cmml" xref="S4.p2.2.m2.1.1.4">superscript</csymbol><cn type="integer" id="S4.p2.2.m2.1.1.4.2.cmml" xref="S4.p2.2.m2.1.1.4.2">90</cn><compose id="S4.p2.2.m2.1.1.4.3.cmml" xref="S4.p2.2.m2.1.1.4.3"></compose></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">75^{\circ}\text{ and }90^{\circ}</annotation></semantics></math></p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.2" class="ltx_p"><span id="S4.p3.2.1" class="ltx_text ltx_font_bold">Rotated Fashion MNIST</span>: Fashion-MNIST is a dataset of Zalando’s article images—consisting of a training set of 60,000 examples and a test set of 10,000 examples. Here again we split the dataset to multiple client/participating environments by rotating each fashion item with angles <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="0^{\circ},15^{\circ},30^{\circ},45^{\circ},\text{ and }60^{\circ}." display="inline"><semantics id="S4.p3.1.m1.1a"><mrow id="S4.p3.1.m1.1.1.1"><mrow id="S4.p3.1.m1.1.1.1.1.5" xref="S4.p3.1.m1.1.1.1.1.6.cmml"><msup id="S4.p3.1.m1.1.1.1.1.1.1" xref="S4.p3.1.m1.1.1.1.1.1.1.cmml"><mn id="S4.p3.1.m1.1.1.1.1.1.1.2" xref="S4.p3.1.m1.1.1.1.1.1.1.2.cmml">0</mn><mo id="S4.p3.1.m1.1.1.1.1.1.1.3" xref="S4.p3.1.m1.1.1.1.1.1.1.3.cmml">∘</mo></msup><mo id="S4.p3.1.m1.1.1.1.1.5.6" xref="S4.p3.1.m1.1.1.1.1.6.cmml">,</mo><msup id="S4.p3.1.m1.1.1.1.1.2.2" xref="S4.p3.1.m1.1.1.1.1.2.2.cmml"><mn id="S4.p3.1.m1.1.1.1.1.2.2.2" xref="S4.p3.1.m1.1.1.1.1.2.2.2.cmml">15</mn><mo id="S4.p3.1.m1.1.1.1.1.2.2.3" xref="S4.p3.1.m1.1.1.1.1.2.2.3.cmml">∘</mo></msup><mo id="S4.p3.1.m1.1.1.1.1.5.7" xref="S4.p3.1.m1.1.1.1.1.6.cmml">,</mo><msup id="S4.p3.1.m1.1.1.1.1.3.3" xref="S4.p3.1.m1.1.1.1.1.3.3.cmml"><mn id="S4.p3.1.m1.1.1.1.1.3.3.2" xref="S4.p3.1.m1.1.1.1.1.3.3.2.cmml">30</mn><mo id="S4.p3.1.m1.1.1.1.1.3.3.3" xref="S4.p3.1.m1.1.1.1.1.3.3.3.cmml">∘</mo></msup><mo id="S4.p3.1.m1.1.1.1.1.5.8" xref="S4.p3.1.m1.1.1.1.1.6.cmml">,</mo><msup id="S4.p3.1.m1.1.1.1.1.4.4" xref="S4.p3.1.m1.1.1.1.1.4.4.cmml"><mn id="S4.p3.1.m1.1.1.1.1.4.4.2" xref="S4.p3.1.m1.1.1.1.1.4.4.2.cmml">45</mn><mo id="S4.p3.1.m1.1.1.1.1.4.4.3" xref="S4.p3.1.m1.1.1.1.1.4.4.3.cmml">∘</mo></msup><mo id="S4.p3.1.m1.1.1.1.1.5.9" xref="S4.p3.1.m1.1.1.1.1.6.cmml">,</mo><mrow id="S4.p3.1.m1.1.1.1.1.5.5" xref="S4.p3.1.m1.1.1.1.1.5.5.cmml"><mtext id="S4.p3.1.m1.1.1.1.1.5.5.2" xref="S4.p3.1.m1.1.1.1.1.5.5.2a.cmml"> and </mtext><mo lspace="0em" rspace="0em" id="S4.p3.1.m1.1.1.1.1.5.5.1" xref="S4.p3.1.m1.1.1.1.1.5.5.1.cmml">​</mo><msup id="S4.p3.1.m1.1.1.1.1.5.5.3" xref="S4.p3.1.m1.1.1.1.1.5.5.3.cmml"><mn id="S4.p3.1.m1.1.1.1.1.5.5.3.2" xref="S4.p3.1.m1.1.1.1.1.5.5.3.2.cmml">60</mn><mo id="S4.p3.1.m1.1.1.1.1.5.5.3.3" xref="S4.p3.1.m1.1.1.1.1.5.5.3.3.cmml">∘</mo></msup></mrow></mrow><mo lspace="0em" id="S4.p3.1.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><list id="S4.p3.1.m1.1.1.1.1.6.cmml" xref="S4.p3.1.m1.1.1.1.1.5"><apply id="S4.p3.1.m1.1.1.1.1.1.1.cmml" xref="S4.p3.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.p3.1.m1.1.1.1.1.1.1">superscript</csymbol><cn type="integer" id="S4.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.1.1.1.1.2">0</cn><compose id="S4.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.1.1.1.1.3"></compose></apply><apply id="S4.p3.1.m1.1.1.1.1.2.2.cmml" xref="S4.p3.1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.1.1.2.2.1.cmml" xref="S4.p3.1.m1.1.1.1.1.2.2">superscript</csymbol><cn type="integer" id="S4.p3.1.m1.1.1.1.1.2.2.2.cmml" xref="S4.p3.1.m1.1.1.1.1.2.2.2">15</cn><compose id="S4.p3.1.m1.1.1.1.1.2.2.3.cmml" xref="S4.p3.1.m1.1.1.1.1.2.2.3"></compose></apply><apply id="S4.p3.1.m1.1.1.1.1.3.3.cmml" xref="S4.p3.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.1.1.3.3.1.cmml" xref="S4.p3.1.m1.1.1.1.1.3.3">superscript</csymbol><cn type="integer" id="S4.p3.1.m1.1.1.1.1.3.3.2.cmml" xref="S4.p3.1.m1.1.1.1.1.3.3.2">30</cn><compose id="S4.p3.1.m1.1.1.1.1.3.3.3.cmml" xref="S4.p3.1.m1.1.1.1.1.3.3.3"></compose></apply><apply id="S4.p3.1.m1.1.1.1.1.4.4.cmml" xref="S4.p3.1.m1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.1.1.4.4.1.cmml" xref="S4.p3.1.m1.1.1.1.1.4.4">superscript</csymbol><cn type="integer" id="S4.p3.1.m1.1.1.1.1.4.4.2.cmml" xref="S4.p3.1.m1.1.1.1.1.4.4.2">45</cn><compose id="S4.p3.1.m1.1.1.1.1.4.4.3.cmml" xref="S4.p3.1.m1.1.1.1.1.4.4.3"></compose></apply><apply id="S4.p3.1.m1.1.1.1.1.5.5.cmml" xref="S4.p3.1.m1.1.1.1.1.5.5"><times id="S4.p3.1.m1.1.1.1.1.5.5.1.cmml" xref="S4.p3.1.m1.1.1.1.1.5.5.1"></times><ci id="S4.p3.1.m1.1.1.1.1.5.5.2a.cmml" xref="S4.p3.1.m1.1.1.1.1.5.5.2"><mtext id="S4.p3.1.m1.1.1.1.1.5.5.2.cmml" xref="S4.p3.1.m1.1.1.1.1.5.5.2"> and </mtext></ci><apply id="S4.p3.1.m1.1.1.1.1.5.5.3.cmml" xref="S4.p3.1.m1.1.1.1.1.5.5.3"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.1.1.5.5.3.1.cmml" xref="S4.p3.1.m1.1.1.1.1.5.5.3">superscript</csymbol><cn type="integer" id="S4.p3.1.m1.1.1.1.1.5.5.3.2.cmml" xref="S4.p3.1.m1.1.1.1.1.5.5.3.2">60</cn><compose id="S4.p3.1.m1.1.1.1.1.5.5.3.3.cmml" xref="S4.p3.1.m1.1.1.1.1.5.5.3.3"></compose></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">0^{\circ},15^{\circ},30^{\circ},45^{\circ},\text{ and }60^{\circ}.</annotation></semantics></math> We sample 10000 data points per client/server environment. The server side test domain consist of fashion items with angles <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="75^{\circ}\text{ and }90^{\circ}" display="inline"><semantics id="S4.p3.2.m2.1a"><mrow id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><msup id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml"><mn id="S4.p3.2.m2.1.1.2.2" xref="S4.p3.2.m2.1.1.2.2.cmml">75</mn><mo id="S4.p3.2.m2.1.1.2.3" xref="S4.p3.2.m2.1.1.2.3.cmml">∘</mo></msup><mo lspace="0em" rspace="0em" id="S4.p3.2.m2.1.1.1" xref="S4.p3.2.m2.1.1.1.cmml">​</mo><mtext id="S4.p3.2.m2.1.1.3" xref="S4.p3.2.m2.1.1.3a.cmml"> and </mtext><mo lspace="0em" rspace="0em" id="S4.p3.2.m2.1.1.1a" xref="S4.p3.2.m2.1.1.1.cmml">​</mo><msup id="S4.p3.2.m2.1.1.4" xref="S4.p3.2.m2.1.1.4.cmml"><mn id="S4.p3.2.m2.1.1.4.2" xref="S4.p3.2.m2.1.1.4.2.cmml">90</mn><mo id="S4.p3.2.m2.1.1.4.3" xref="S4.p3.2.m2.1.1.4.3.cmml">∘</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><times id="S4.p3.2.m2.1.1.1.cmml" xref="S4.p3.2.m2.1.1.1"></times><apply id="S4.p3.2.m2.1.1.2.cmml" xref="S4.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.p3.2.m2.1.1.2.1.cmml" xref="S4.p3.2.m2.1.1.2">superscript</csymbol><cn type="integer" id="S4.p3.2.m2.1.1.2.2.cmml" xref="S4.p3.2.m2.1.1.2.2">75</cn><compose id="S4.p3.2.m2.1.1.2.3.cmml" xref="S4.p3.2.m2.1.1.2.3"></compose></apply><ci id="S4.p3.2.m2.1.1.3a.cmml" xref="S4.p3.2.m2.1.1.3"><mtext id="S4.p3.2.m2.1.1.3.cmml" xref="S4.p3.2.m2.1.1.3"> and </mtext></ci><apply id="S4.p3.2.m2.1.1.4.cmml" xref="S4.p3.2.m2.1.1.4"><csymbol cd="ambiguous" id="S4.p3.2.m2.1.1.4.1.cmml" xref="S4.p3.2.m2.1.1.4">superscript</csymbol><cn type="integer" id="S4.p3.2.m2.1.1.4.2.cmml" xref="S4.p3.2.m2.1.1.4.2">90</cn><compose id="S4.p3.2.m2.1.1.4.3.cmml" xref="S4.p3.2.m2.1.1.4.3"></compose></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">75^{\circ}\text{ and }90^{\circ}</annotation></semantics></math></p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">In our experiments, we compare the performance of federated averaging (Fed-Avg) with the following approaches:</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.5" class="ltx_p"><span id="S5.p2.5.1" class="ltx_text ltx_font_bold">Fed-ERM</span>
Within the CausalFed setup, this approach minimizes the empirical average of loss over training data points and treats the data from different domains as i.i.d.
ERM loss is given by:</p>
<table id="S5.Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.Ex3.m1.6" class="ltx_Math" alttext="\sum_{C,i}^{S,N_{C}}\mathcal{L}_{s}(w\circ h_{i},y_{i})" display="block"><semantics id="S5.Ex3.m1.6a"><mrow id="S5.Ex3.m1.6.6" xref="S5.Ex3.m1.6.6.cmml"><munderover id="S5.Ex3.m1.6.6.3" xref="S5.Ex3.m1.6.6.3.cmml"><mo movablelimits="false" id="S5.Ex3.m1.6.6.3.2.2" xref="S5.Ex3.m1.6.6.3.2.2.cmml">∑</mo><mrow id="S5.Ex3.m1.2.2.2.4" xref="S5.Ex3.m1.2.2.2.3.cmml"><mi id="S5.Ex3.m1.1.1.1.1" xref="S5.Ex3.m1.1.1.1.1.cmml">C</mi><mo id="S5.Ex3.m1.2.2.2.4.1" xref="S5.Ex3.m1.2.2.2.3.cmml">,</mo><mi id="S5.Ex3.m1.2.2.2.2" xref="S5.Ex3.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S5.Ex3.m1.4.4.2.2" xref="S5.Ex3.m1.4.4.2.3.cmml"><mi id="S5.Ex3.m1.3.3.1.1" xref="S5.Ex3.m1.3.3.1.1.cmml">S</mi><mo id="S5.Ex3.m1.4.4.2.2.2" xref="S5.Ex3.m1.4.4.2.3.cmml">,</mo><msub id="S5.Ex3.m1.4.4.2.2.1" xref="S5.Ex3.m1.4.4.2.2.1.cmml"><mi id="S5.Ex3.m1.4.4.2.2.1.2" xref="S5.Ex3.m1.4.4.2.2.1.2.cmml">N</mi><mi id="S5.Ex3.m1.4.4.2.2.1.3" xref="S5.Ex3.m1.4.4.2.2.1.3.cmml">C</mi></msub></mrow></munderover><mrow id="S5.Ex3.m1.6.6.2" xref="S5.Ex3.m1.6.6.2.cmml"><msub id="S5.Ex3.m1.6.6.2.4" xref="S5.Ex3.m1.6.6.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.Ex3.m1.6.6.2.4.2" xref="S5.Ex3.m1.6.6.2.4.2.cmml">ℒ</mi><mi id="S5.Ex3.m1.6.6.2.4.3" xref="S5.Ex3.m1.6.6.2.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S5.Ex3.m1.6.6.2.3" xref="S5.Ex3.m1.6.6.2.3.cmml">​</mo><mrow id="S5.Ex3.m1.6.6.2.2.2" xref="S5.Ex3.m1.6.6.2.2.3.cmml"><mo stretchy="false" id="S5.Ex3.m1.6.6.2.2.2.3" xref="S5.Ex3.m1.6.6.2.2.3.cmml">(</mo><mrow id="S5.Ex3.m1.5.5.1.1.1.1" xref="S5.Ex3.m1.5.5.1.1.1.1.cmml"><mi id="S5.Ex3.m1.5.5.1.1.1.1.2" xref="S5.Ex3.m1.5.5.1.1.1.1.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S5.Ex3.m1.5.5.1.1.1.1.1" xref="S5.Ex3.m1.5.5.1.1.1.1.1.cmml">∘</mo><msub id="S5.Ex3.m1.5.5.1.1.1.1.3" xref="S5.Ex3.m1.5.5.1.1.1.1.3.cmml"><mi id="S5.Ex3.m1.5.5.1.1.1.1.3.2" xref="S5.Ex3.m1.5.5.1.1.1.1.3.2.cmml">h</mi><mi id="S5.Ex3.m1.5.5.1.1.1.1.3.3" xref="S5.Ex3.m1.5.5.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S5.Ex3.m1.6.6.2.2.2.4" xref="S5.Ex3.m1.6.6.2.2.3.cmml">,</mo><msub id="S5.Ex3.m1.6.6.2.2.2.2" xref="S5.Ex3.m1.6.6.2.2.2.2.cmml"><mi id="S5.Ex3.m1.6.6.2.2.2.2.2" xref="S5.Ex3.m1.6.6.2.2.2.2.2.cmml">y</mi><mi id="S5.Ex3.m1.6.6.2.2.2.2.3" xref="S5.Ex3.m1.6.6.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S5.Ex3.m1.6.6.2.2.2.5" xref="S5.Ex3.m1.6.6.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex3.m1.6b"><apply id="S5.Ex3.m1.6.6.cmml" xref="S5.Ex3.m1.6.6"><apply id="S5.Ex3.m1.6.6.3.cmml" xref="S5.Ex3.m1.6.6.3"><csymbol cd="ambiguous" id="S5.Ex3.m1.6.6.3.1.cmml" xref="S5.Ex3.m1.6.6.3">superscript</csymbol><apply id="S5.Ex3.m1.6.6.3.2.cmml" xref="S5.Ex3.m1.6.6.3"><csymbol cd="ambiguous" id="S5.Ex3.m1.6.6.3.2.1.cmml" xref="S5.Ex3.m1.6.6.3">subscript</csymbol><sum id="S5.Ex3.m1.6.6.3.2.2.cmml" xref="S5.Ex3.m1.6.6.3.2.2"></sum><list id="S5.Ex3.m1.2.2.2.3.cmml" xref="S5.Ex3.m1.2.2.2.4"><ci id="S5.Ex3.m1.1.1.1.1.cmml" xref="S5.Ex3.m1.1.1.1.1">𝐶</ci><ci id="S5.Ex3.m1.2.2.2.2.cmml" xref="S5.Ex3.m1.2.2.2.2">𝑖</ci></list></apply><list id="S5.Ex3.m1.4.4.2.3.cmml" xref="S5.Ex3.m1.4.4.2.2"><ci id="S5.Ex3.m1.3.3.1.1.cmml" xref="S5.Ex3.m1.3.3.1.1">𝑆</ci><apply id="S5.Ex3.m1.4.4.2.2.1.cmml" xref="S5.Ex3.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="S5.Ex3.m1.4.4.2.2.1.1.cmml" xref="S5.Ex3.m1.4.4.2.2.1">subscript</csymbol><ci id="S5.Ex3.m1.4.4.2.2.1.2.cmml" xref="S5.Ex3.m1.4.4.2.2.1.2">𝑁</ci><ci id="S5.Ex3.m1.4.4.2.2.1.3.cmml" xref="S5.Ex3.m1.4.4.2.2.1.3">𝐶</ci></apply></list></apply><apply id="S5.Ex3.m1.6.6.2.cmml" xref="S5.Ex3.m1.6.6.2"><times id="S5.Ex3.m1.6.6.2.3.cmml" xref="S5.Ex3.m1.6.6.2.3"></times><apply id="S5.Ex3.m1.6.6.2.4.cmml" xref="S5.Ex3.m1.6.6.2.4"><csymbol cd="ambiguous" id="S5.Ex3.m1.6.6.2.4.1.cmml" xref="S5.Ex3.m1.6.6.2.4">subscript</csymbol><ci id="S5.Ex3.m1.6.6.2.4.2.cmml" xref="S5.Ex3.m1.6.6.2.4.2">ℒ</ci><ci id="S5.Ex3.m1.6.6.2.4.3.cmml" xref="S5.Ex3.m1.6.6.2.4.3">𝑠</ci></apply><interval closure="open" id="S5.Ex3.m1.6.6.2.2.3.cmml" xref="S5.Ex3.m1.6.6.2.2.2"><apply id="S5.Ex3.m1.5.5.1.1.1.1.cmml" xref="S5.Ex3.m1.5.5.1.1.1.1"><compose id="S5.Ex3.m1.5.5.1.1.1.1.1.cmml" xref="S5.Ex3.m1.5.5.1.1.1.1.1"></compose><ci id="S5.Ex3.m1.5.5.1.1.1.1.2.cmml" xref="S5.Ex3.m1.5.5.1.1.1.1.2">𝑤</ci><apply id="S5.Ex3.m1.5.5.1.1.1.1.3.cmml" xref="S5.Ex3.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex3.m1.5.5.1.1.1.1.3.1.cmml" xref="S5.Ex3.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S5.Ex3.m1.5.5.1.1.1.1.3.2.cmml" xref="S5.Ex3.m1.5.5.1.1.1.1.3.2">ℎ</ci><ci id="S5.Ex3.m1.5.5.1.1.1.1.3.3.cmml" xref="S5.Ex3.m1.5.5.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S5.Ex3.m1.6.6.2.2.2.2.cmml" xref="S5.Ex3.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S5.Ex3.m1.6.6.2.2.2.2.1.cmml" xref="S5.Ex3.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S5.Ex3.m1.6.6.2.2.2.2.2.cmml" xref="S5.Ex3.m1.6.6.2.2.2.2.2">𝑦</ci><ci id="S5.Ex3.m1.6.6.2.2.2.2.3.cmml" xref="S5.Ex3.m1.6.6.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex3.m1.6c">\sum_{C,i}^{S,N_{C}}\mathcal{L}_{s}(w\circ h_{i},y_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S5.p2.3" class="ltx_p">where S equals set of clients/ source domains, <math id="S5.p2.1.m1.1" class="ltx_Math" alttext="N_{C}" display="inline"><semantics id="S5.p2.1.m1.1a"><msub id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml"><mi id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2.cmml">N</mi><mi id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1">subscript</csymbol><ci id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">𝑁</ci><ci id="S5.p2.1.m1.1.1.3.cmml" xref="S5.p2.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">N_{C}</annotation></semantics></math> equals number of samples per client <math id="S5.p2.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S5.p2.2.m2.1a"><mi id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b"><ci id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">C</annotation></semantics></math>, <math id="S5.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{s}" display="inline"><semantics id="S5.p2.3.m3.1a"><msub id="S5.p2.3.m3.1.1" xref="S5.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p2.3.m3.1.1.2" xref="S5.p2.3.m3.1.1.2.cmml">ℒ</mi><mi id="S5.p2.3.m3.1.1.3" xref="S5.p2.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S5.p2.3.m3.1b"><apply id="S5.p2.3.m3.1.1.cmml" xref="S5.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.p2.3.m3.1.1.1.cmml" xref="S5.p2.3.m3.1.1">subscript</csymbol><ci id="S5.p2.3.m3.1.1.2.cmml" xref="S5.p2.3.m3.1.1.2">ℒ</ci><ci id="S5.p2.3.m3.1.1.3.cmml" xref="S5.p2.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.3.m3.1c">\mathcal{L}_{s}</annotation></semantics></math> equals classification loss. 
<br class="ltx_break"><span id="S5.p2.3.1" class="ltx_text ltx_font_bold">CausalFed-RM</span>
In this approach, we minimize the random match(RMatch) causal loss <cite class="ltx_cite ltx_citemacro_citep">(Mahajan et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite> within the CausalFed setup. RMatch loss is given by:</p>
<table id="S5.Ex4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.Ex4.m1.13" class="ltx_Math" alttext="\sum_{C,i}^{S,N_{C}}\mathcal{L}_{s}(w\circ h_{i},y_{i})+\lambda*\sum_{\Omega(j,k)=1\mid j\sim N_{C},k\sim N_{C^{\prime}}}\operatorname{Dist}(h_{j},h_{k})" display="block"><semantics id="S5.Ex4.m1.13a"><mrow id="S5.Ex4.m1.13.13" xref="S5.Ex4.m1.13.13.cmml"><mrow id="S5.Ex4.m1.11.11.2" xref="S5.Ex4.m1.11.11.2.cmml"><munderover id="S5.Ex4.m1.11.11.2.3" xref="S5.Ex4.m1.11.11.2.3.cmml"><mo movablelimits="false" id="S5.Ex4.m1.11.11.2.3.2.2" xref="S5.Ex4.m1.11.11.2.3.2.2.cmml">∑</mo><mrow id="S5.Ex4.m1.2.2.2.4" xref="S5.Ex4.m1.2.2.2.3.cmml"><mi id="S5.Ex4.m1.1.1.1.1" xref="S5.Ex4.m1.1.1.1.1.cmml">C</mi><mo id="S5.Ex4.m1.2.2.2.4.1" xref="S5.Ex4.m1.2.2.2.3.cmml">,</mo><mi id="S5.Ex4.m1.2.2.2.2" xref="S5.Ex4.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S5.Ex4.m1.4.4.2.2" xref="S5.Ex4.m1.4.4.2.3.cmml"><mi id="S5.Ex4.m1.3.3.1.1" xref="S5.Ex4.m1.3.3.1.1.cmml">S</mi><mo id="S5.Ex4.m1.4.4.2.2.2" xref="S5.Ex4.m1.4.4.2.3.cmml">,</mo><msub id="S5.Ex4.m1.4.4.2.2.1" xref="S5.Ex4.m1.4.4.2.2.1.cmml"><mi id="S5.Ex4.m1.4.4.2.2.1.2" xref="S5.Ex4.m1.4.4.2.2.1.2.cmml">N</mi><mi id="S5.Ex4.m1.4.4.2.2.1.3" xref="S5.Ex4.m1.4.4.2.2.1.3.cmml">C</mi></msub></mrow></munderover><mrow id="S5.Ex4.m1.11.11.2.2" xref="S5.Ex4.m1.11.11.2.2.cmml"><msub id="S5.Ex4.m1.11.11.2.2.4" xref="S5.Ex4.m1.11.11.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.Ex4.m1.11.11.2.2.4.2" xref="S5.Ex4.m1.11.11.2.2.4.2.cmml">ℒ</mi><mi id="S5.Ex4.m1.11.11.2.2.4.3" xref="S5.Ex4.m1.11.11.2.2.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S5.Ex4.m1.11.11.2.2.3" xref="S5.Ex4.m1.11.11.2.2.3.cmml">​</mo><mrow id="S5.Ex4.m1.11.11.2.2.2.2" xref="S5.Ex4.m1.11.11.2.2.2.3.cmml"><mo stretchy="false" id="S5.Ex4.m1.11.11.2.2.2.2.3" xref="S5.Ex4.m1.11.11.2.2.2.3.cmml">(</mo><mrow id="S5.Ex4.m1.10.10.1.1.1.1.1" xref="S5.Ex4.m1.10.10.1.1.1.1.1.cmml"><mi id="S5.Ex4.m1.10.10.1.1.1.1.1.2" xref="S5.Ex4.m1.10.10.1.1.1.1.1.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="S5.Ex4.m1.10.10.1.1.1.1.1.1" xref="S5.Ex4.m1.10.10.1.1.1.1.1.1.cmml">∘</mo><msub id="S5.Ex4.m1.10.10.1.1.1.1.1.3" xref="S5.Ex4.m1.10.10.1.1.1.1.1.3.cmml"><mi id="S5.Ex4.m1.10.10.1.1.1.1.1.3.2" xref="S5.Ex4.m1.10.10.1.1.1.1.1.3.2.cmml">h</mi><mi id="S5.Ex4.m1.10.10.1.1.1.1.1.3.3" xref="S5.Ex4.m1.10.10.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S5.Ex4.m1.11.11.2.2.2.2.4" xref="S5.Ex4.m1.11.11.2.2.2.3.cmml">,</mo><msub id="S5.Ex4.m1.11.11.2.2.2.2.2" xref="S5.Ex4.m1.11.11.2.2.2.2.2.cmml"><mi id="S5.Ex4.m1.11.11.2.2.2.2.2.2" xref="S5.Ex4.m1.11.11.2.2.2.2.2.2.cmml">y</mi><mi id="S5.Ex4.m1.11.11.2.2.2.2.2.3" xref="S5.Ex4.m1.11.11.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S5.Ex4.m1.11.11.2.2.2.2.5" xref="S5.Ex4.m1.11.11.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S5.Ex4.m1.13.13.5" xref="S5.Ex4.m1.13.13.5.cmml">+</mo><mrow id="S5.Ex4.m1.13.13.4" xref="S5.Ex4.m1.13.13.4.cmml"><mi id="S5.Ex4.m1.13.13.4.4" xref="S5.Ex4.m1.13.13.4.4.cmml">λ</mi><mo lspace="0.222em" rspace="0.055em" id="S5.Ex4.m1.13.13.4.3" xref="S5.Ex4.m1.13.13.4.3.cmml">∗</mo><mrow id="S5.Ex4.m1.13.13.4.2" xref="S5.Ex4.m1.13.13.4.2.cmml"><munder id="S5.Ex4.m1.13.13.4.2.3" xref="S5.Ex4.m1.13.13.4.2.3.cmml"><mo movablelimits="false" id="S5.Ex4.m1.13.13.4.2.3.2" xref="S5.Ex4.m1.13.13.4.2.3.2.cmml">∑</mo><mrow id="S5.Ex4.m1.8.8.4.4" xref="S5.Ex4.m1.8.8.4.5.cmml"><mrow id="S5.Ex4.m1.7.7.3.3.1" xref="S5.Ex4.m1.7.7.3.3.1.cmml"><mrow id="S5.Ex4.m1.7.7.3.3.1.2" xref="S5.Ex4.m1.7.7.3.3.1.2.cmml"><mi mathvariant="normal" id="S5.Ex4.m1.7.7.3.3.1.2.2" xref="S5.Ex4.m1.7.7.3.3.1.2.2.cmml">Ω</mi><mo lspace="0em" rspace="0em" id="S5.Ex4.m1.7.7.3.3.1.2.1" xref="S5.Ex4.m1.7.7.3.3.1.2.1.cmml">​</mo><mrow id="S5.Ex4.m1.7.7.3.3.1.2.3.2" xref="S5.Ex4.m1.7.7.3.3.1.2.3.1.cmml"><mo stretchy="false" id="S5.Ex4.m1.7.7.3.3.1.2.3.2.1" xref="S5.Ex4.m1.7.7.3.3.1.2.3.1.cmml">(</mo><mi id="S5.Ex4.m1.5.5.1.1" xref="S5.Ex4.m1.5.5.1.1.cmml">j</mi><mo id="S5.Ex4.m1.7.7.3.3.1.2.3.2.2" xref="S5.Ex4.m1.7.7.3.3.1.2.3.1.cmml">,</mo><mi id="S5.Ex4.m1.6.6.2.2" xref="S5.Ex4.m1.6.6.2.2.cmml">k</mi><mo stretchy="false" id="S5.Ex4.m1.7.7.3.3.1.2.3.2.3" xref="S5.Ex4.m1.7.7.3.3.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S5.Ex4.m1.7.7.3.3.1.3" xref="S5.Ex4.m1.7.7.3.3.1.3.cmml">=</mo><mrow id="S5.Ex4.m1.7.7.3.3.1.4" xref="S5.Ex4.m1.7.7.3.3.1.4.cmml"><mn id="S5.Ex4.m1.7.7.3.3.1.4.2" xref="S5.Ex4.m1.7.7.3.3.1.4.2.cmml">1</mn><mo id="S5.Ex4.m1.7.7.3.3.1.4.1" xref="S5.Ex4.m1.7.7.3.3.1.4.1.cmml">∣</mo><mi id="S5.Ex4.m1.7.7.3.3.1.4.3" xref="S5.Ex4.m1.7.7.3.3.1.4.3.cmml">j</mi></mrow><mo id="S5.Ex4.m1.7.7.3.3.1.5" xref="S5.Ex4.m1.7.7.3.3.1.5.cmml">∼</mo><msub id="S5.Ex4.m1.7.7.3.3.1.6" xref="S5.Ex4.m1.7.7.3.3.1.6.cmml"><mi id="S5.Ex4.m1.7.7.3.3.1.6.2" xref="S5.Ex4.m1.7.7.3.3.1.6.2.cmml">N</mi><mi id="S5.Ex4.m1.7.7.3.3.1.6.3" xref="S5.Ex4.m1.7.7.3.3.1.6.3.cmml">C</mi></msub></mrow><mo id="S5.Ex4.m1.8.8.4.4.3" xref="S5.Ex4.m1.8.8.4.5a.cmml">,</mo><mrow id="S5.Ex4.m1.8.8.4.4.2" xref="S5.Ex4.m1.8.8.4.4.2.cmml"><mi id="S5.Ex4.m1.8.8.4.4.2.2" xref="S5.Ex4.m1.8.8.4.4.2.2.cmml">k</mi><mo id="S5.Ex4.m1.8.8.4.4.2.1" xref="S5.Ex4.m1.8.8.4.4.2.1.cmml">∼</mo><msub id="S5.Ex4.m1.8.8.4.4.2.3" xref="S5.Ex4.m1.8.8.4.4.2.3.cmml"><mi id="S5.Ex4.m1.8.8.4.4.2.3.2" xref="S5.Ex4.m1.8.8.4.4.2.3.2.cmml">N</mi><msup id="S5.Ex4.m1.8.8.4.4.2.3.3" xref="S5.Ex4.m1.8.8.4.4.2.3.3.cmml"><mi id="S5.Ex4.m1.8.8.4.4.2.3.3.2" xref="S5.Ex4.m1.8.8.4.4.2.3.3.2.cmml">C</mi><mo id="S5.Ex4.m1.8.8.4.4.2.3.3.3" xref="S5.Ex4.m1.8.8.4.4.2.3.3.3.cmml">′</mo></msup></msub></mrow></mrow></munder><mrow id="S5.Ex4.m1.13.13.4.2.2.2" xref="S5.Ex4.m1.13.13.4.2.2.3.cmml"><mi id="S5.Ex4.m1.9.9" xref="S5.Ex4.m1.9.9.cmml">Dist</mi><mo id="S5.Ex4.m1.13.13.4.2.2.2a" xref="S5.Ex4.m1.13.13.4.2.2.3.cmml">⁡</mo><mrow id="S5.Ex4.m1.13.13.4.2.2.2.2" xref="S5.Ex4.m1.13.13.4.2.2.3.cmml"><mo stretchy="false" id="S5.Ex4.m1.13.13.4.2.2.2.2.3" xref="S5.Ex4.m1.13.13.4.2.2.3.cmml">(</mo><msub id="S5.Ex4.m1.12.12.3.1.1.1.1.1" xref="S5.Ex4.m1.12.12.3.1.1.1.1.1.cmml"><mi id="S5.Ex4.m1.12.12.3.1.1.1.1.1.2" xref="S5.Ex4.m1.12.12.3.1.1.1.1.1.2.cmml">h</mi><mi id="S5.Ex4.m1.12.12.3.1.1.1.1.1.3" xref="S5.Ex4.m1.12.12.3.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S5.Ex4.m1.13.13.4.2.2.2.2.4" xref="S5.Ex4.m1.13.13.4.2.2.3.cmml">,</mo><msub id="S5.Ex4.m1.13.13.4.2.2.2.2.2" xref="S5.Ex4.m1.13.13.4.2.2.2.2.2.cmml"><mi id="S5.Ex4.m1.13.13.4.2.2.2.2.2.2" xref="S5.Ex4.m1.13.13.4.2.2.2.2.2.2.cmml">h</mi><mi id="S5.Ex4.m1.13.13.4.2.2.2.2.2.3" xref="S5.Ex4.m1.13.13.4.2.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S5.Ex4.m1.13.13.4.2.2.2.2.5" xref="S5.Ex4.m1.13.13.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex4.m1.13b"><apply id="S5.Ex4.m1.13.13.cmml" xref="S5.Ex4.m1.13.13"><plus id="S5.Ex4.m1.13.13.5.cmml" xref="S5.Ex4.m1.13.13.5"></plus><apply id="S5.Ex4.m1.11.11.2.cmml" xref="S5.Ex4.m1.11.11.2"><apply id="S5.Ex4.m1.11.11.2.3.cmml" xref="S5.Ex4.m1.11.11.2.3"><csymbol cd="ambiguous" id="S5.Ex4.m1.11.11.2.3.1.cmml" xref="S5.Ex4.m1.11.11.2.3">superscript</csymbol><apply id="S5.Ex4.m1.11.11.2.3.2.cmml" xref="S5.Ex4.m1.11.11.2.3"><csymbol cd="ambiguous" id="S5.Ex4.m1.11.11.2.3.2.1.cmml" xref="S5.Ex4.m1.11.11.2.3">subscript</csymbol><sum id="S5.Ex4.m1.11.11.2.3.2.2.cmml" xref="S5.Ex4.m1.11.11.2.3.2.2"></sum><list id="S5.Ex4.m1.2.2.2.3.cmml" xref="S5.Ex4.m1.2.2.2.4"><ci id="S5.Ex4.m1.1.1.1.1.cmml" xref="S5.Ex4.m1.1.1.1.1">𝐶</ci><ci id="S5.Ex4.m1.2.2.2.2.cmml" xref="S5.Ex4.m1.2.2.2.2">𝑖</ci></list></apply><list id="S5.Ex4.m1.4.4.2.3.cmml" xref="S5.Ex4.m1.4.4.2.2"><ci id="S5.Ex4.m1.3.3.1.1.cmml" xref="S5.Ex4.m1.3.3.1.1">𝑆</ci><apply id="S5.Ex4.m1.4.4.2.2.1.cmml" xref="S5.Ex4.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="S5.Ex4.m1.4.4.2.2.1.1.cmml" xref="S5.Ex4.m1.4.4.2.2.1">subscript</csymbol><ci id="S5.Ex4.m1.4.4.2.2.1.2.cmml" xref="S5.Ex4.m1.4.4.2.2.1.2">𝑁</ci><ci id="S5.Ex4.m1.4.4.2.2.1.3.cmml" xref="S5.Ex4.m1.4.4.2.2.1.3">𝐶</ci></apply></list></apply><apply id="S5.Ex4.m1.11.11.2.2.cmml" xref="S5.Ex4.m1.11.11.2.2"><times id="S5.Ex4.m1.11.11.2.2.3.cmml" xref="S5.Ex4.m1.11.11.2.2.3"></times><apply id="S5.Ex4.m1.11.11.2.2.4.cmml" xref="S5.Ex4.m1.11.11.2.2.4"><csymbol cd="ambiguous" id="S5.Ex4.m1.11.11.2.2.4.1.cmml" xref="S5.Ex4.m1.11.11.2.2.4">subscript</csymbol><ci id="S5.Ex4.m1.11.11.2.2.4.2.cmml" xref="S5.Ex4.m1.11.11.2.2.4.2">ℒ</ci><ci id="S5.Ex4.m1.11.11.2.2.4.3.cmml" xref="S5.Ex4.m1.11.11.2.2.4.3">𝑠</ci></apply><interval closure="open" id="S5.Ex4.m1.11.11.2.2.2.3.cmml" xref="S5.Ex4.m1.11.11.2.2.2.2"><apply id="S5.Ex4.m1.10.10.1.1.1.1.1.cmml" xref="S5.Ex4.m1.10.10.1.1.1.1.1"><compose id="S5.Ex4.m1.10.10.1.1.1.1.1.1.cmml" xref="S5.Ex4.m1.10.10.1.1.1.1.1.1"></compose><ci id="S5.Ex4.m1.10.10.1.1.1.1.1.2.cmml" xref="S5.Ex4.m1.10.10.1.1.1.1.1.2">𝑤</ci><apply id="S5.Ex4.m1.10.10.1.1.1.1.1.3.cmml" xref="S5.Ex4.m1.10.10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex4.m1.10.10.1.1.1.1.1.3.1.cmml" xref="S5.Ex4.m1.10.10.1.1.1.1.1.3">subscript</csymbol><ci id="S5.Ex4.m1.10.10.1.1.1.1.1.3.2.cmml" xref="S5.Ex4.m1.10.10.1.1.1.1.1.3.2">ℎ</ci><ci id="S5.Ex4.m1.10.10.1.1.1.1.1.3.3.cmml" xref="S5.Ex4.m1.10.10.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S5.Ex4.m1.11.11.2.2.2.2.2.cmml" xref="S5.Ex4.m1.11.11.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.Ex4.m1.11.11.2.2.2.2.2.1.cmml" xref="S5.Ex4.m1.11.11.2.2.2.2.2">subscript</csymbol><ci id="S5.Ex4.m1.11.11.2.2.2.2.2.2.cmml" xref="S5.Ex4.m1.11.11.2.2.2.2.2.2">𝑦</ci><ci id="S5.Ex4.m1.11.11.2.2.2.2.2.3.cmml" xref="S5.Ex4.m1.11.11.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="S5.Ex4.m1.13.13.4.cmml" xref="S5.Ex4.m1.13.13.4"><times id="S5.Ex4.m1.13.13.4.3.cmml" xref="S5.Ex4.m1.13.13.4.3"></times><ci id="S5.Ex4.m1.13.13.4.4.cmml" xref="S5.Ex4.m1.13.13.4.4">𝜆</ci><apply id="S5.Ex4.m1.13.13.4.2.cmml" xref="S5.Ex4.m1.13.13.4.2"><apply id="S5.Ex4.m1.13.13.4.2.3.cmml" xref="S5.Ex4.m1.13.13.4.2.3"><csymbol cd="ambiguous" id="S5.Ex4.m1.13.13.4.2.3.1.cmml" xref="S5.Ex4.m1.13.13.4.2.3">subscript</csymbol><sum id="S5.Ex4.m1.13.13.4.2.3.2.cmml" xref="S5.Ex4.m1.13.13.4.2.3.2"></sum><apply id="S5.Ex4.m1.8.8.4.5.cmml" xref="S5.Ex4.m1.8.8.4.4"><csymbol cd="ambiguous" id="S5.Ex4.m1.8.8.4.5a.cmml" xref="S5.Ex4.m1.8.8.4.4.3">formulae-sequence</csymbol><apply id="S5.Ex4.m1.7.7.3.3.1.cmml" xref="S5.Ex4.m1.7.7.3.3.1"><and id="S5.Ex4.m1.7.7.3.3.1a.cmml" xref="S5.Ex4.m1.7.7.3.3.1"></and><apply id="S5.Ex4.m1.7.7.3.3.1b.cmml" xref="S5.Ex4.m1.7.7.3.3.1"><eq id="S5.Ex4.m1.7.7.3.3.1.3.cmml" xref="S5.Ex4.m1.7.7.3.3.1.3"></eq><apply id="S5.Ex4.m1.7.7.3.3.1.2.cmml" xref="S5.Ex4.m1.7.7.3.3.1.2"><times id="S5.Ex4.m1.7.7.3.3.1.2.1.cmml" xref="S5.Ex4.m1.7.7.3.3.1.2.1"></times><ci id="S5.Ex4.m1.7.7.3.3.1.2.2.cmml" xref="S5.Ex4.m1.7.7.3.3.1.2.2">Ω</ci><interval closure="open" id="S5.Ex4.m1.7.7.3.3.1.2.3.1.cmml" xref="S5.Ex4.m1.7.7.3.3.1.2.3.2"><ci id="S5.Ex4.m1.5.5.1.1.cmml" xref="S5.Ex4.m1.5.5.1.1">𝑗</ci><ci id="S5.Ex4.m1.6.6.2.2.cmml" xref="S5.Ex4.m1.6.6.2.2">𝑘</ci></interval></apply><apply id="S5.Ex4.m1.7.7.3.3.1.4.cmml" xref="S5.Ex4.m1.7.7.3.3.1.4"><csymbol cd="latexml" id="S5.Ex4.m1.7.7.3.3.1.4.1.cmml" xref="S5.Ex4.m1.7.7.3.3.1.4.1">conditional</csymbol><cn type="integer" id="S5.Ex4.m1.7.7.3.3.1.4.2.cmml" xref="S5.Ex4.m1.7.7.3.3.1.4.2">1</cn><ci id="S5.Ex4.m1.7.7.3.3.1.4.3.cmml" xref="S5.Ex4.m1.7.7.3.3.1.4.3">𝑗</ci></apply></apply><apply id="S5.Ex4.m1.7.7.3.3.1c.cmml" xref="S5.Ex4.m1.7.7.3.3.1"><csymbol cd="latexml" id="S5.Ex4.m1.7.7.3.3.1.5.cmml" xref="S5.Ex4.m1.7.7.3.3.1.5">similar-to</csymbol><share href="#S5.Ex4.m1.7.7.3.3.1.4.cmml" id="S5.Ex4.m1.7.7.3.3.1d.cmml" xref="S5.Ex4.m1.7.7.3.3.1"></share><apply id="S5.Ex4.m1.7.7.3.3.1.6.cmml" xref="S5.Ex4.m1.7.7.3.3.1.6"><csymbol cd="ambiguous" id="S5.Ex4.m1.7.7.3.3.1.6.1.cmml" xref="S5.Ex4.m1.7.7.3.3.1.6">subscript</csymbol><ci id="S5.Ex4.m1.7.7.3.3.1.6.2.cmml" xref="S5.Ex4.m1.7.7.3.3.1.6.2">𝑁</ci><ci id="S5.Ex4.m1.7.7.3.3.1.6.3.cmml" xref="S5.Ex4.m1.7.7.3.3.1.6.3">𝐶</ci></apply></apply></apply><apply id="S5.Ex4.m1.8.8.4.4.2.cmml" xref="S5.Ex4.m1.8.8.4.4.2"><csymbol cd="latexml" id="S5.Ex4.m1.8.8.4.4.2.1.cmml" xref="S5.Ex4.m1.8.8.4.4.2.1">similar-to</csymbol><ci id="S5.Ex4.m1.8.8.4.4.2.2.cmml" xref="S5.Ex4.m1.8.8.4.4.2.2">𝑘</ci><apply id="S5.Ex4.m1.8.8.4.4.2.3.cmml" xref="S5.Ex4.m1.8.8.4.4.2.3"><csymbol cd="ambiguous" id="S5.Ex4.m1.8.8.4.4.2.3.1.cmml" xref="S5.Ex4.m1.8.8.4.4.2.3">subscript</csymbol><ci id="S5.Ex4.m1.8.8.4.4.2.3.2.cmml" xref="S5.Ex4.m1.8.8.4.4.2.3.2">𝑁</ci><apply id="S5.Ex4.m1.8.8.4.4.2.3.3.cmml" xref="S5.Ex4.m1.8.8.4.4.2.3.3"><csymbol cd="ambiguous" id="S5.Ex4.m1.8.8.4.4.2.3.3.1.cmml" xref="S5.Ex4.m1.8.8.4.4.2.3.3">superscript</csymbol><ci id="S5.Ex4.m1.8.8.4.4.2.3.3.2.cmml" xref="S5.Ex4.m1.8.8.4.4.2.3.3.2">𝐶</ci><ci id="S5.Ex4.m1.8.8.4.4.2.3.3.3.cmml" xref="S5.Ex4.m1.8.8.4.4.2.3.3.3">′</ci></apply></apply></apply></apply></apply><apply id="S5.Ex4.m1.13.13.4.2.2.3.cmml" xref="S5.Ex4.m1.13.13.4.2.2.2"><ci id="S5.Ex4.m1.9.9.cmml" xref="S5.Ex4.m1.9.9">Dist</ci><apply id="S5.Ex4.m1.12.12.3.1.1.1.1.1.cmml" xref="S5.Ex4.m1.12.12.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.Ex4.m1.12.12.3.1.1.1.1.1.1.cmml" xref="S5.Ex4.m1.12.12.3.1.1.1.1.1">subscript</csymbol><ci id="S5.Ex4.m1.12.12.3.1.1.1.1.1.2.cmml" xref="S5.Ex4.m1.12.12.3.1.1.1.1.1.2">ℎ</ci><ci id="S5.Ex4.m1.12.12.3.1.1.1.1.1.3.cmml" xref="S5.Ex4.m1.12.12.3.1.1.1.1.1.3">𝑗</ci></apply><apply id="S5.Ex4.m1.13.13.4.2.2.2.2.2.cmml" xref="S5.Ex4.m1.13.13.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.Ex4.m1.13.13.4.2.2.2.2.2.1.cmml" xref="S5.Ex4.m1.13.13.4.2.2.2.2.2">subscript</csymbol><ci id="S5.Ex4.m1.13.13.4.2.2.2.2.2.2.cmml" xref="S5.Ex4.m1.13.13.4.2.2.2.2.2.2">ℎ</ci><ci id="S5.Ex4.m1.13.13.4.2.2.2.2.2.3.cmml" xref="S5.Ex4.m1.13.13.4.2.2.2.2.2.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex4.m1.13c">\sum_{C,i}^{S,N_{C}}\mathcal{L}_{s}(w\circ h_{i},y_{i})+\lambda*\sum_{\Omega(j,k)=1\mid j\sim N_{C},k\sim N_{C^{\prime}}}\operatorname{Dist}(h_{j},h_{k})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S5.p2.4" class="ltx_p">where <math id="S5.p2.4.m1.1" class="ltx_Math" alttext="\Omega" display="inline"><semantics id="S5.p2.4.m1.1a"><mi mathvariant="normal" id="S5.p2.4.m1.1.1" xref="S5.p2.4.m1.1.1.cmml">Ω</mi><annotation-xml encoding="MathML-Content" id="S5.p2.4.m1.1b"><ci id="S5.p2.4.m1.1.1.cmml" xref="S5.p2.4.m1.1.1">Ω</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.4.m1.1c">\Omega</annotation></semantics></math> represents the match function used to randomly pair the data points across the different client domains.
<br class="ltx_break"><span id="S5.p2.4.1" class="ltx_text ltx_font_bold">CausalFed-IRM</span>
In this approach, we minimize the IRM loss <cite class="ltx_cite ltx_citemacro_citep">(Arjovsky et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite> within the CausalFed setup.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Train Results</figcaption>
<table id="S5.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="S5.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T1.1.1.1.2.1" class="ltx_text ltx_font_bold">Arch</span></th>
<th id="S5.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T1.1.1.1.3.1" class="ltx_text ltx_font_bold">Fed-Avg</span></th>
<th id="S5.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T1.1.1.1.4.1" class="ltx_text ltx_font_bold">Fed-ERM</span></th>
<th id="S5.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T1.1.1.1.5.1" class="ltx_text ltx_font_bold">CausalFed-RM</span></th>
<th id="S5.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T1.1.1.1.6.1" class="ltx_text ltx_font_bold">CausalFed-IRM</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.1.2.1" class="ltx_tr">
<td id="S5.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">Colored MNIST</td>
<td id="S5.T1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">ResNet18</td>
<td id="S5.T1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">80.3%</td>
<td id="S5.T1.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t">
<span id="S5.T1.1.2.1.4.1" class="ltx_text ltx_font_bold">82.97</span> %</td>
<td id="S5.T1.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t">60.42 %</td>
<td id="S5.T1.1.2.1.6" class="ltx_td ltx_align_left ltx_border_t">59.33 %</td>
</tr>
<tr id="S5.T1.1.3.2" class="ltx_tr">
<td id="S5.T1.1.3.2.1" class="ltx_td ltx_align_left ltx_border_t">Rotated MNIST</td>
<td id="S5.T1.1.3.2.2" class="ltx_td ltx_align_left ltx_border_t">ResNet18</td>
<td id="S5.T1.1.3.2.3" class="ltx_td ltx_align_left ltx_border_t">85.2%</td>
<td id="S5.T1.1.3.2.4" class="ltx_td ltx_align_left ltx_border_t">
<span id="S5.T1.1.3.2.4.1" class="ltx_text ltx_font_bold">86.5</span> %</td>
<td id="S5.T1.1.3.2.5" class="ltx_td ltx_align_left ltx_border_t">79.8 %</td>
<td id="S5.T1.1.3.2.6" class="ltx_td ltx_align_left ltx_border_t">80.2 %</td>
</tr>
<tr id="S5.T1.1.4.3" class="ltx_tr">
<td id="S5.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">Rotated FMNIST</td>
<td id="S5.T1.1.4.3.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">LeNet</td>
<td id="S5.T1.1.4.3.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">81.4%</td>
<td id="S5.T1.1.4.3.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">
<span id="S5.T1.1.4.3.4.1" class="ltx_text ltx_font_bold">82.3</span> %</td>
<td id="S5.T1.1.4.3.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">72.1 %</td>
<td id="S5.T1.1.4.3.6" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">71.5 %</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Test Results</figcaption>
<table id="S5.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.1.1.1" class="ltx_tr">
<th id="S5.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="S5.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.1.1.1.2.1" class="ltx_text ltx_font_bold">Arch</span></th>
<th id="S5.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.1.1.1.3.1" class="ltx_text ltx_font_bold">Fed-Avg</span></th>
<th id="S5.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.1.1.1.4.1" class="ltx_text ltx_font_bold">Fed-ERM</span></th>
<th id="S5.T2.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.1.1.1.5.1" class="ltx_text ltx_font_bold">CausalFed-RM</span></th>
<th id="S5.T2.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T2.1.1.1.6.1" class="ltx_text ltx_font_bold">CausalFed-IRM</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.1.2.1" class="ltx_tr">
<td id="S5.T2.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">Colored MNIST</td>
<td id="S5.T2.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">ResNet18</td>
<td id="S5.T2.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">11%</td>
<td id="S5.T2.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t">10.2 %</td>
<td id="S5.T2.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t">
<span id="S5.T2.1.2.1.5.1" class="ltx_text ltx_font_bold">65.62</span> %</td>
<td id="S5.T2.1.2.1.6" class="ltx_td ltx_align_left ltx_border_t">60.3 %</td>
</tr>
<tr id="S5.T2.1.3.2" class="ltx_tr">
<td id="S5.T2.1.3.2.1" class="ltx_td ltx_align_left ltx_border_t">Rotated MNIST</td>
<td id="S5.T2.1.3.2.2" class="ltx_td ltx_align_left ltx_border_t">ResNet18</td>
<td id="S5.T2.1.3.2.3" class="ltx_td ltx_align_left ltx_border_t">82.7%</td>
<td id="S5.T2.1.3.2.4" class="ltx_td ltx_align_left ltx_border_t">82.9 %</td>
<td id="S5.T2.1.3.2.5" class="ltx_td ltx_align_left ltx_border_t">
<span id="S5.T2.1.3.2.5.1" class="ltx_text ltx_font_bold">90.2</span> %</td>
<td id="S5.T2.1.3.2.6" class="ltx_td ltx_align_left ltx_border_t">89.1 %</td>
</tr>
<tr id="S5.T2.1.4.3" class="ltx_tr">
<td id="S5.T2.1.4.3.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">Rotated FMNIST</td>
<td id="S5.T2.1.4.3.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">LeNet</td>
<td id="S5.T2.1.4.3.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">72%</td>
<td id="S5.T2.1.4.3.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">71.6 %</td>
<td id="S5.T2.1.4.3.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">
<span id="S5.T2.1.4.3.5.1" class="ltx_text ltx_font_bold">74.6</span> %</td>
<td id="S5.T2.1.4.3.6" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">73.9 %</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.1" class="ltx_p">We observed that when clients have out of distribution data in a federated setup, FedAvg as well as FedERM does not fare well in the server side test data set though they give highly accurate results on train data(iid) whereas CausalFed-RM and CausalFed-IRM perfoms much better on test data(non iid).</p>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.1" class="ltx_p"><span id="S5.p4.1.1" class="ltx_text ltx_font_bold">Privacy Leakage</span> In our experiments, within the CausalFed setup, we analyse the privacy leakage on 3 common attacks namely, Membership inference attack, Property inference attack and Backdoor attack. The privacy leakage on each of the attacks is measured by testing the accuracy of attack model. Details on each of the attacks are added in <a href="#A1.SS2" title="A.2 Inference Attack ‣ Appendix A Appendix ‣ Towards Causal Federated Learning For enhanced robustness and privacy" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a> <a href="#A1.SS3" title="A.3 Backdoor Attack ‣ Appendix A Appendix ‣ Towards Causal Federated Learning For enhanced robustness and privacy" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.3</span></a>.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Leakage on inference attack</figcaption>
<table id="S5.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.1.1.1" class="ltx_tr">
<th id="S5.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.1.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="S5.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.1.1.1.2.1" class="ltx_text ltx_font_bold">Fed-Avg</span></th>
<th id="S5.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.1.1.1.3.1" class="ltx_text ltx_font_bold">Fed-ERM</span></th>
<th id="S5.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.1.1.1.4.1" class="ltx_text ltx_font_bold">CausalFed-RM</span></th>
<th id="S5.T3.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.1.1.1.5.1" class="ltx_text ltx_font_bold">CausalFed-IRM</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.1.2.1" class="ltx_tr">
<td id="S5.T3.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">Colored MNIST</td>
<td id="S5.T3.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">79.21 %</td>
<td id="S5.T3.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">79.45 %</td>
<td id="S5.T3.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t">58.57 %</td>
<td id="S5.T3.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t">56.9 %</td>
</tr>
<tr id="S5.T3.1.3.2" class="ltx_tr">
<td id="S5.T3.1.3.2.1" class="ltx_td ltx_align_left ltx_border_t">Rotated MNIST</td>
<td id="S5.T3.1.3.2.2" class="ltx_td ltx_align_left ltx_border_t">84.4 %</td>
<td id="S5.T3.1.3.2.3" class="ltx_td ltx_align_left ltx_border_t">85.24 %</td>
<td id="S5.T3.1.3.2.4" class="ltx_td ltx_align_left ltx_border_t">68.3 %</td>
<td id="S5.T3.1.3.2.5" class="ltx_td ltx_align_left ltx_border_t">64.4 %</td>
</tr>
<tr id="S5.T3.1.4.3" class="ltx_tr">
<td id="S5.T3.1.4.3.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">Rotated FMNIST</td>
<td id="S5.T3.1.4.3.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">76.61 %</td>
<td id="S5.T3.1.4.3.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">78.23 %</td>
<td id="S5.T3.1.4.3.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">57.55 %</td>
<td id="S5.T3.1.4.3.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">55.7 %</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.p5" class="ltx_para ltx_noindent">
<p id="S5.p5.1" class="ltx_p">We observe that in our setup with an out of distribution(OOD) test set, the membership inference attack accuracy of a federated causal client adversary model is much lesser as compared to a federated setup with associational client models. It was also observed that federated causal models provide better pivacy guarantees against property inference attacks which could be owed to the fact that inversion based on learning correlations between attributes and final prediction, e.g., using color to predict the digit, can be eliminated by causal models, since a non-causal feature will not be included in our final causal federated model.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">In this work, we show that CausalFed is more accurate than non-privacy-preserving federated learning approaches as well as superior to non-federated associational learning approaches in comparison to existing privacy enhancing approaches in federated setup which suffer from pretty high accuracy loss. We were able to experiment and confirm that causal feature learning can enhance out of distribution robustness in federated learning. Moving forward, we need to analyse the performance of this approach in real world datsets as well as compare various other causal learning approaches which can further enhance the out of distribution robustness and improve leakage protection in our current setup. We believe that CausalFed and CausalFedGSD serve as an initial approach to perform causal learning in a federated setting that offers several extensions for future work.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arjovsky et al. (2019)</span>
<span class="ltx_bibblock">
Martin Arjovsky, Léon Bottou, Ishaan Gulrajani, and David Lopez Paz.

</span>
<span class="ltx_bibblock">Invariant risk minimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv:1907.02893</em>, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">C et al. (2019)</span>
<span class="ltx_bibblock">
Melis C, Song E, De Cristofaro, and V. Shmatikov.

</span>
<span class="ltx_bibblock">Exploiting unintended feature leakage in collaborative learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE Symposium on Security and Privacy</em>, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fredrikson et al. (2015)</span>
<span class="ltx_bibblock">
Matt Fredrikson, Jha S, and Ristenpart T.

</span>
<span class="ltx_bibblock">Model inversion attacks that exploit confidence information and basic
countermeasures.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">ACM</em>, pp.  pp. 1322–1333, 2015.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fredrikson et al. (2018)</span>
<span class="ltx_bibblock">
Matt Fredrikson, Somesh Jha, and Thomas Ristenpart.

</span>
<span class="ltx_bibblock">Model inversion attacks that exploit confidence information and basic
countermeasures.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv:1806.01246</em>, 2018.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geyer et al. (2017)</span>
<span class="ltx_bibblock">
Robin C. Geyer, Tassilo Klein, and Moin Nabi.

</span>
<span class="ltx_bibblock">Differentially private federated learning: A client level
perspective.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv:1712.07557</em>, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2019)</span>
<span class="ltx_bibblock">
Peter Kairouz, Brendan Mcmahan, Brendan Avent, Aurélien Bellet, Mehdi Bennis,
Arjun Nitin Bhagoji, Keith Bonawitz, Zachary Charles, Graham Cormode, and
Rachel Cummings.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arxiv</em>, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mahajan et al. (2020)</span>
<span class="ltx_bibblock">
D Mahajan, S Tople, and A Sharma.

</span>
<span class="ltx_bibblock">Domain generalization using causal matching.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv:2006.07500</em>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
H Brendan McMahan, Ramage D.Talwar, and K.Zhang.

</span>
<span class="ltx_bibblock">Learning differentially private language models without losing
accuracy.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv:1710.06963</em>, 2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nasr et al. (2018a)</span>
<span class="ltx_bibblock">
Nasr, Reza Shokri, and Amir Houmansadr.

</span>
<span class="ltx_bibblock">Comprehensive privacy analysis of deep learning: Passive and active
white-box inference attacks against centralized and federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv:1812.00910</em>, 2018a.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nasr et al. (2018b)</span>
<span class="ltx_bibblock">
Milad Nasr, Reza Shokri, and Amir Houmansadr.

</span>
<span class="ltx_bibblock">Comprehensive privacy analysis of deep learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv:1812.00910</em>, 2018b.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quionero-Candela et al. (2019)</span>
<span class="ltx_bibblock">
Joaquin Quionero-Candela, Masashi Sugiyama, Anton Schwaighofer, , and Neil D
Lawrence.

</span>
<span class="ltx_bibblock">Dataset shift in machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">ISBN 0262170051</em>, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Salem et al. (2018)</span>
<span class="ltx_bibblock">
Ahmed Salem, Yang Zhang, Mathias Humbert, Pascal Berrang, Mario Fritz, and
Michael Backes.

</span>
<span class="ltx_bibblock">Mlleaks model and data independent membership inference attacks and
defenses.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv:1806.01246</em>, 2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shokri et al. (2017)</span>
<span class="ltx_bibblock">
Reza Shokri, Marco Stronati, Congzheng Song, and Vitaly Shmatikov.

</span>
<span class="ltx_bibblock">Membership inference attacks against machine learning models.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv:1806.01245</em>, 2017.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tople et al. (2020)</span>
<span class="ltx_bibblock">
Shruti Tople, Amit Sharma, and Aditya V. Noris.

</span>
<span class="ltx_bibblock">Alleviating privacy attacks via causal learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv:1909.12732</em>, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tramèr et al. (2016)</span>
<span class="ltx_bibblock">
Florian Tramèr, Fan Zhang, Ari Juels, Michael K Reiter, , and Thomas
Ristenpart.

</span>
<span class="ltx_bibblock">Stealing machine learning models via prediction apis.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv:1806.01246</em>, 2016.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yeom et al. (2018)</span>
<span class="ltx_bibblock">
S. Yeom, I. Giacomelli, M. Fredrikson, and S. Jh.

</span>
<span class="ltx_bibblock">Privacy risk in machine learning: Analyzing the connection to
overfitting.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv:1709.01604</em>, 2018.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2018)</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv:1806.00582</em>, 2018.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Objective Functions</h3>

<div id="A1.SS1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS1.p1.5" class="ltx_p"><span id="A1.SS1.p1.5.1" class="ltx_text ltx_font_bold">ERM</span>
This approach minimizes the empirical average of loss over training data points and treats the data from different domains as i.i.d.
ERM loss is given by:</p>
<table id="A1.Ex5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex5.m1.6" class="ltx_Math" alttext="\sum_{C,i}^{S,N_{C}}\mathcal{L}_{s}(w\circ h_{i},y_{i})" display="block"><semantics id="A1.Ex5.m1.6a"><mrow id="A1.Ex5.m1.6.6" xref="A1.Ex5.m1.6.6.cmml"><munderover id="A1.Ex5.m1.6.6.3" xref="A1.Ex5.m1.6.6.3.cmml"><mo movablelimits="false" id="A1.Ex5.m1.6.6.3.2.2" xref="A1.Ex5.m1.6.6.3.2.2.cmml">∑</mo><mrow id="A1.Ex5.m1.2.2.2.4" xref="A1.Ex5.m1.2.2.2.3.cmml"><mi id="A1.Ex5.m1.1.1.1.1" xref="A1.Ex5.m1.1.1.1.1.cmml">C</mi><mo id="A1.Ex5.m1.2.2.2.4.1" xref="A1.Ex5.m1.2.2.2.3.cmml">,</mo><mi id="A1.Ex5.m1.2.2.2.2" xref="A1.Ex5.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="A1.Ex5.m1.4.4.2.2" xref="A1.Ex5.m1.4.4.2.3.cmml"><mi id="A1.Ex5.m1.3.3.1.1" xref="A1.Ex5.m1.3.3.1.1.cmml">S</mi><mo id="A1.Ex5.m1.4.4.2.2.2" xref="A1.Ex5.m1.4.4.2.3.cmml">,</mo><msub id="A1.Ex5.m1.4.4.2.2.1" xref="A1.Ex5.m1.4.4.2.2.1.cmml"><mi id="A1.Ex5.m1.4.4.2.2.1.2" xref="A1.Ex5.m1.4.4.2.2.1.2.cmml">N</mi><mi id="A1.Ex5.m1.4.4.2.2.1.3" xref="A1.Ex5.m1.4.4.2.2.1.3.cmml">C</mi></msub></mrow></munderover><mrow id="A1.Ex5.m1.6.6.2" xref="A1.Ex5.m1.6.6.2.cmml"><msub id="A1.Ex5.m1.6.6.2.4" xref="A1.Ex5.m1.6.6.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex5.m1.6.6.2.4.2" xref="A1.Ex5.m1.6.6.2.4.2.cmml">ℒ</mi><mi id="A1.Ex5.m1.6.6.2.4.3" xref="A1.Ex5.m1.6.6.2.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex5.m1.6.6.2.3" xref="A1.Ex5.m1.6.6.2.3.cmml">​</mo><mrow id="A1.Ex5.m1.6.6.2.2.2" xref="A1.Ex5.m1.6.6.2.2.3.cmml"><mo stretchy="false" id="A1.Ex5.m1.6.6.2.2.2.3" xref="A1.Ex5.m1.6.6.2.2.3.cmml">(</mo><mrow id="A1.Ex5.m1.5.5.1.1.1.1" xref="A1.Ex5.m1.5.5.1.1.1.1.cmml"><mi id="A1.Ex5.m1.5.5.1.1.1.1.2" xref="A1.Ex5.m1.5.5.1.1.1.1.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="A1.Ex5.m1.5.5.1.1.1.1.1" xref="A1.Ex5.m1.5.5.1.1.1.1.1.cmml">∘</mo><msub id="A1.Ex5.m1.5.5.1.1.1.1.3" xref="A1.Ex5.m1.5.5.1.1.1.1.3.cmml"><mi id="A1.Ex5.m1.5.5.1.1.1.1.3.2" xref="A1.Ex5.m1.5.5.1.1.1.1.3.2.cmml">h</mi><mi id="A1.Ex5.m1.5.5.1.1.1.1.3.3" xref="A1.Ex5.m1.5.5.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A1.Ex5.m1.6.6.2.2.2.4" xref="A1.Ex5.m1.6.6.2.2.3.cmml">,</mo><msub id="A1.Ex5.m1.6.6.2.2.2.2" xref="A1.Ex5.m1.6.6.2.2.2.2.cmml"><mi id="A1.Ex5.m1.6.6.2.2.2.2.2" xref="A1.Ex5.m1.6.6.2.2.2.2.2.cmml">y</mi><mi id="A1.Ex5.m1.6.6.2.2.2.2.3" xref="A1.Ex5.m1.6.6.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.Ex5.m1.6.6.2.2.2.5" xref="A1.Ex5.m1.6.6.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex5.m1.6b"><apply id="A1.Ex5.m1.6.6.cmml" xref="A1.Ex5.m1.6.6"><apply id="A1.Ex5.m1.6.6.3.cmml" xref="A1.Ex5.m1.6.6.3"><csymbol cd="ambiguous" id="A1.Ex5.m1.6.6.3.1.cmml" xref="A1.Ex5.m1.6.6.3">superscript</csymbol><apply id="A1.Ex5.m1.6.6.3.2.cmml" xref="A1.Ex5.m1.6.6.3"><csymbol cd="ambiguous" id="A1.Ex5.m1.6.6.3.2.1.cmml" xref="A1.Ex5.m1.6.6.3">subscript</csymbol><sum id="A1.Ex5.m1.6.6.3.2.2.cmml" xref="A1.Ex5.m1.6.6.3.2.2"></sum><list id="A1.Ex5.m1.2.2.2.3.cmml" xref="A1.Ex5.m1.2.2.2.4"><ci id="A1.Ex5.m1.1.1.1.1.cmml" xref="A1.Ex5.m1.1.1.1.1">𝐶</ci><ci id="A1.Ex5.m1.2.2.2.2.cmml" xref="A1.Ex5.m1.2.2.2.2">𝑖</ci></list></apply><list id="A1.Ex5.m1.4.4.2.3.cmml" xref="A1.Ex5.m1.4.4.2.2"><ci id="A1.Ex5.m1.3.3.1.1.cmml" xref="A1.Ex5.m1.3.3.1.1">𝑆</ci><apply id="A1.Ex5.m1.4.4.2.2.1.cmml" xref="A1.Ex5.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="A1.Ex5.m1.4.4.2.2.1.1.cmml" xref="A1.Ex5.m1.4.4.2.2.1">subscript</csymbol><ci id="A1.Ex5.m1.4.4.2.2.1.2.cmml" xref="A1.Ex5.m1.4.4.2.2.1.2">𝑁</ci><ci id="A1.Ex5.m1.4.4.2.2.1.3.cmml" xref="A1.Ex5.m1.4.4.2.2.1.3">𝐶</ci></apply></list></apply><apply id="A1.Ex5.m1.6.6.2.cmml" xref="A1.Ex5.m1.6.6.2"><times id="A1.Ex5.m1.6.6.2.3.cmml" xref="A1.Ex5.m1.6.6.2.3"></times><apply id="A1.Ex5.m1.6.6.2.4.cmml" xref="A1.Ex5.m1.6.6.2.4"><csymbol cd="ambiguous" id="A1.Ex5.m1.6.6.2.4.1.cmml" xref="A1.Ex5.m1.6.6.2.4">subscript</csymbol><ci id="A1.Ex5.m1.6.6.2.4.2.cmml" xref="A1.Ex5.m1.6.6.2.4.2">ℒ</ci><ci id="A1.Ex5.m1.6.6.2.4.3.cmml" xref="A1.Ex5.m1.6.6.2.4.3">𝑠</ci></apply><interval closure="open" id="A1.Ex5.m1.6.6.2.2.3.cmml" xref="A1.Ex5.m1.6.6.2.2.2"><apply id="A1.Ex5.m1.5.5.1.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1"><compose id="A1.Ex5.m1.5.5.1.1.1.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.1"></compose><ci id="A1.Ex5.m1.5.5.1.1.1.1.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.2">𝑤</ci><apply id="A1.Ex5.m1.5.5.1.1.1.1.3.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.1.1.1.1.3.1.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex5.m1.5.5.1.1.1.1.3.2.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.3.2">ℎ</ci><ci id="A1.Ex5.m1.5.5.1.1.1.1.3.3.cmml" xref="A1.Ex5.m1.5.5.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="A1.Ex5.m1.6.6.2.2.2.2.cmml" xref="A1.Ex5.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex5.m1.6.6.2.2.2.2.1.cmml" xref="A1.Ex5.m1.6.6.2.2.2.2">subscript</csymbol><ci id="A1.Ex5.m1.6.6.2.2.2.2.2.cmml" xref="A1.Ex5.m1.6.6.2.2.2.2.2">𝑦</ci><ci id="A1.Ex5.m1.6.6.2.2.2.2.3.cmml" xref="A1.Ex5.m1.6.6.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex5.m1.6c">\sum_{C,i}^{S,N_{C}}\mathcal{L}_{s}(w\circ h_{i},y_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS1.p1.3" class="ltx_p">where S equals set of clients/ source domains, <math id="A1.SS1.p1.1.m1.1" class="ltx_Math" alttext="N_{C}" display="inline"><semantics id="A1.SS1.p1.1.m1.1a"><msub id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml"><mi id="A1.SS1.p1.1.m1.1.1.2" xref="A1.SS1.p1.1.m1.1.1.2.cmml">N</mi><mi id="A1.SS1.p1.1.m1.1.1.3" xref="A1.SS1.p1.1.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.1b"><apply id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS1.p1.1.m1.1.1.2.cmml" xref="A1.SS1.p1.1.m1.1.1.2">𝑁</ci><ci id="A1.SS1.p1.1.m1.1.1.3.cmml" xref="A1.SS1.p1.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.1c">N_{C}</annotation></semantics></math> equals number of samples per client <math id="A1.SS1.p1.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A1.SS1.p1.2.m2.1a"><mi id="A1.SS1.p1.2.m2.1.1" xref="A1.SS1.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.2.m2.1b"><ci id="A1.SS1.p1.2.m2.1.1.cmml" xref="A1.SS1.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.2.m2.1c">C</annotation></semantics></math>, <math id="A1.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{s}" display="inline"><semantics id="A1.SS1.p1.3.m3.1a"><msub id="A1.SS1.p1.3.m3.1.1" xref="A1.SS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS1.p1.3.m3.1.1.2" xref="A1.SS1.p1.3.m3.1.1.2.cmml">ℒ</mi><mi id="A1.SS1.p1.3.m3.1.1.3" xref="A1.SS1.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.3.m3.1b"><apply id="A1.SS1.p1.3.m3.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS1.p1.3.m3.1.1.1.cmml" xref="A1.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS1.p1.3.m3.1.1.2.cmml" xref="A1.SS1.p1.3.m3.1.1.2">ℒ</ci><ci id="A1.SS1.p1.3.m3.1.1.3.cmml" xref="A1.SS1.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.3.m3.1c">\mathcal{L}_{s}</annotation></semantics></math> equals classification loss. 
<br class="ltx_break"><span id="A1.SS1.p1.3.1" class="ltx_text ltx_font_bold">RMatch</span>
RMatch loss is given by:</p>
<table id="A1.Ex6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.Ex6.m1.13" class="ltx_Math" alttext="\sum_{C,i}^{S,N_{C}}\mathcal{L}_{s}(w\circ h_{i},y_{i})+\lambda*\sum_{\Omega(j,k)=1\mid j\sim N_{C},k\sim N_{C^{\prime}}}\operatorname{Dist}(h_{j},h_{k})" display="block"><semantics id="A1.Ex6.m1.13a"><mrow id="A1.Ex6.m1.13.13" xref="A1.Ex6.m1.13.13.cmml"><mrow id="A1.Ex6.m1.11.11.2" xref="A1.Ex6.m1.11.11.2.cmml"><munderover id="A1.Ex6.m1.11.11.2.3" xref="A1.Ex6.m1.11.11.2.3.cmml"><mo movablelimits="false" id="A1.Ex6.m1.11.11.2.3.2.2" xref="A1.Ex6.m1.11.11.2.3.2.2.cmml">∑</mo><mrow id="A1.Ex6.m1.2.2.2.4" xref="A1.Ex6.m1.2.2.2.3.cmml"><mi id="A1.Ex6.m1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.cmml">C</mi><mo id="A1.Ex6.m1.2.2.2.4.1" xref="A1.Ex6.m1.2.2.2.3.cmml">,</mo><mi id="A1.Ex6.m1.2.2.2.2" xref="A1.Ex6.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="A1.Ex6.m1.4.4.2.2" xref="A1.Ex6.m1.4.4.2.3.cmml"><mi id="A1.Ex6.m1.3.3.1.1" xref="A1.Ex6.m1.3.3.1.1.cmml">S</mi><mo id="A1.Ex6.m1.4.4.2.2.2" xref="A1.Ex6.m1.4.4.2.3.cmml">,</mo><msub id="A1.Ex6.m1.4.4.2.2.1" xref="A1.Ex6.m1.4.4.2.2.1.cmml"><mi id="A1.Ex6.m1.4.4.2.2.1.2" xref="A1.Ex6.m1.4.4.2.2.1.2.cmml">N</mi><mi id="A1.Ex6.m1.4.4.2.2.1.3" xref="A1.Ex6.m1.4.4.2.2.1.3.cmml">C</mi></msub></mrow></munderover><mrow id="A1.Ex6.m1.11.11.2.2" xref="A1.Ex6.m1.11.11.2.2.cmml"><msub id="A1.Ex6.m1.11.11.2.2.4" xref="A1.Ex6.m1.11.11.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.Ex6.m1.11.11.2.2.4.2" xref="A1.Ex6.m1.11.11.2.2.4.2.cmml">ℒ</mi><mi id="A1.Ex6.m1.11.11.2.2.4.3" xref="A1.Ex6.m1.11.11.2.2.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="A1.Ex6.m1.11.11.2.2.3" xref="A1.Ex6.m1.11.11.2.2.3.cmml">​</mo><mrow id="A1.Ex6.m1.11.11.2.2.2.2" xref="A1.Ex6.m1.11.11.2.2.2.3.cmml"><mo stretchy="false" id="A1.Ex6.m1.11.11.2.2.2.2.3" xref="A1.Ex6.m1.11.11.2.2.2.3.cmml">(</mo><mrow id="A1.Ex6.m1.10.10.1.1.1.1.1" xref="A1.Ex6.m1.10.10.1.1.1.1.1.cmml"><mi id="A1.Ex6.m1.10.10.1.1.1.1.1.2" xref="A1.Ex6.m1.10.10.1.1.1.1.1.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="A1.Ex6.m1.10.10.1.1.1.1.1.1" xref="A1.Ex6.m1.10.10.1.1.1.1.1.1.cmml">∘</mo><msub id="A1.Ex6.m1.10.10.1.1.1.1.1.3" xref="A1.Ex6.m1.10.10.1.1.1.1.1.3.cmml"><mi id="A1.Ex6.m1.10.10.1.1.1.1.1.3.2" xref="A1.Ex6.m1.10.10.1.1.1.1.1.3.2.cmml">h</mi><mi id="A1.Ex6.m1.10.10.1.1.1.1.1.3.3" xref="A1.Ex6.m1.10.10.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="A1.Ex6.m1.11.11.2.2.2.2.4" xref="A1.Ex6.m1.11.11.2.2.2.3.cmml">,</mo><msub id="A1.Ex6.m1.11.11.2.2.2.2.2" xref="A1.Ex6.m1.11.11.2.2.2.2.2.cmml"><mi id="A1.Ex6.m1.11.11.2.2.2.2.2.2" xref="A1.Ex6.m1.11.11.2.2.2.2.2.2.cmml">y</mi><mi id="A1.Ex6.m1.11.11.2.2.2.2.2.3" xref="A1.Ex6.m1.11.11.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.Ex6.m1.11.11.2.2.2.2.5" xref="A1.Ex6.m1.11.11.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.Ex6.m1.13.13.5" xref="A1.Ex6.m1.13.13.5.cmml">+</mo><mrow id="A1.Ex6.m1.13.13.4" xref="A1.Ex6.m1.13.13.4.cmml"><mi id="A1.Ex6.m1.13.13.4.4" xref="A1.Ex6.m1.13.13.4.4.cmml">λ</mi><mo lspace="0.222em" rspace="0.055em" id="A1.Ex6.m1.13.13.4.3" xref="A1.Ex6.m1.13.13.4.3.cmml">∗</mo><mrow id="A1.Ex6.m1.13.13.4.2" xref="A1.Ex6.m1.13.13.4.2.cmml"><munder id="A1.Ex6.m1.13.13.4.2.3" xref="A1.Ex6.m1.13.13.4.2.3.cmml"><mo movablelimits="false" id="A1.Ex6.m1.13.13.4.2.3.2" xref="A1.Ex6.m1.13.13.4.2.3.2.cmml">∑</mo><mrow id="A1.Ex6.m1.8.8.4.4" xref="A1.Ex6.m1.8.8.4.5.cmml"><mrow id="A1.Ex6.m1.7.7.3.3.1" xref="A1.Ex6.m1.7.7.3.3.1.cmml"><mrow id="A1.Ex6.m1.7.7.3.3.1.2" xref="A1.Ex6.m1.7.7.3.3.1.2.cmml"><mi mathvariant="normal" id="A1.Ex6.m1.7.7.3.3.1.2.2" xref="A1.Ex6.m1.7.7.3.3.1.2.2.cmml">Ω</mi><mo lspace="0em" rspace="0em" id="A1.Ex6.m1.7.7.3.3.1.2.1" xref="A1.Ex6.m1.7.7.3.3.1.2.1.cmml">​</mo><mrow id="A1.Ex6.m1.7.7.3.3.1.2.3.2" xref="A1.Ex6.m1.7.7.3.3.1.2.3.1.cmml"><mo stretchy="false" id="A1.Ex6.m1.7.7.3.3.1.2.3.2.1" xref="A1.Ex6.m1.7.7.3.3.1.2.3.1.cmml">(</mo><mi id="A1.Ex6.m1.5.5.1.1" xref="A1.Ex6.m1.5.5.1.1.cmml">j</mi><mo id="A1.Ex6.m1.7.7.3.3.1.2.3.2.2" xref="A1.Ex6.m1.7.7.3.3.1.2.3.1.cmml">,</mo><mi id="A1.Ex6.m1.6.6.2.2" xref="A1.Ex6.m1.6.6.2.2.cmml">k</mi><mo stretchy="false" id="A1.Ex6.m1.7.7.3.3.1.2.3.2.3" xref="A1.Ex6.m1.7.7.3.3.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="A1.Ex6.m1.7.7.3.3.1.3" xref="A1.Ex6.m1.7.7.3.3.1.3.cmml">=</mo><mrow id="A1.Ex6.m1.7.7.3.3.1.4" xref="A1.Ex6.m1.7.7.3.3.1.4.cmml"><mn id="A1.Ex6.m1.7.7.3.3.1.4.2" xref="A1.Ex6.m1.7.7.3.3.1.4.2.cmml">1</mn><mo id="A1.Ex6.m1.7.7.3.3.1.4.1" xref="A1.Ex6.m1.7.7.3.3.1.4.1.cmml">∣</mo><mi id="A1.Ex6.m1.7.7.3.3.1.4.3" xref="A1.Ex6.m1.7.7.3.3.1.4.3.cmml">j</mi></mrow><mo id="A1.Ex6.m1.7.7.3.3.1.5" xref="A1.Ex6.m1.7.7.3.3.1.5.cmml">∼</mo><msub id="A1.Ex6.m1.7.7.3.3.1.6" xref="A1.Ex6.m1.7.7.3.3.1.6.cmml"><mi id="A1.Ex6.m1.7.7.3.3.1.6.2" xref="A1.Ex6.m1.7.7.3.3.1.6.2.cmml">N</mi><mi id="A1.Ex6.m1.7.7.3.3.1.6.3" xref="A1.Ex6.m1.7.7.3.3.1.6.3.cmml">C</mi></msub></mrow><mo id="A1.Ex6.m1.8.8.4.4.3" xref="A1.Ex6.m1.8.8.4.5a.cmml">,</mo><mrow id="A1.Ex6.m1.8.8.4.4.2" xref="A1.Ex6.m1.8.8.4.4.2.cmml"><mi id="A1.Ex6.m1.8.8.4.4.2.2" xref="A1.Ex6.m1.8.8.4.4.2.2.cmml">k</mi><mo id="A1.Ex6.m1.8.8.4.4.2.1" xref="A1.Ex6.m1.8.8.4.4.2.1.cmml">∼</mo><msub id="A1.Ex6.m1.8.8.4.4.2.3" xref="A1.Ex6.m1.8.8.4.4.2.3.cmml"><mi id="A1.Ex6.m1.8.8.4.4.2.3.2" xref="A1.Ex6.m1.8.8.4.4.2.3.2.cmml">N</mi><msup id="A1.Ex6.m1.8.8.4.4.2.3.3" xref="A1.Ex6.m1.8.8.4.4.2.3.3.cmml"><mi id="A1.Ex6.m1.8.8.4.4.2.3.3.2" xref="A1.Ex6.m1.8.8.4.4.2.3.3.2.cmml">C</mi><mo id="A1.Ex6.m1.8.8.4.4.2.3.3.3" xref="A1.Ex6.m1.8.8.4.4.2.3.3.3.cmml">′</mo></msup></msub></mrow></mrow></munder><mrow id="A1.Ex6.m1.13.13.4.2.2.2" xref="A1.Ex6.m1.13.13.4.2.2.3.cmml"><mi id="A1.Ex6.m1.9.9" xref="A1.Ex6.m1.9.9.cmml">Dist</mi><mo id="A1.Ex6.m1.13.13.4.2.2.2a" xref="A1.Ex6.m1.13.13.4.2.2.3.cmml">⁡</mo><mrow id="A1.Ex6.m1.13.13.4.2.2.2.2" xref="A1.Ex6.m1.13.13.4.2.2.3.cmml"><mo stretchy="false" id="A1.Ex6.m1.13.13.4.2.2.2.2.3" xref="A1.Ex6.m1.13.13.4.2.2.3.cmml">(</mo><msub id="A1.Ex6.m1.12.12.3.1.1.1.1.1" xref="A1.Ex6.m1.12.12.3.1.1.1.1.1.cmml"><mi id="A1.Ex6.m1.12.12.3.1.1.1.1.1.2" xref="A1.Ex6.m1.12.12.3.1.1.1.1.1.2.cmml">h</mi><mi id="A1.Ex6.m1.12.12.3.1.1.1.1.1.3" xref="A1.Ex6.m1.12.12.3.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.Ex6.m1.13.13.4.2.2.2.2.4" xref="A1.Ex6.m1.13.13.4.2.2.3.cmml">,</mo><msub id="A1.Ex6.m1.13.13.4.2.2.2.2.2" xref="A1.Ex6.m1.13.13.4.2.2.2.2.2.cmml"><mi id="A1.Ex6.m1.13.13.4.2.2.2.2.2.2" xref="A1.Ex6.m1.13.13.4.2.2.2.2.2.2.cmml">h</mi><mi id="A1.Ex6.m1.13.13.4.2.2.2.2.2.3" xref="A1.Ex6.m1.13.13.4.2.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="A1.Ex6.m1.13.13.4.2.2.2.2.5" xref="A1.Ex6.m1.13.13.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.Ex6.m1.13b"><apply id="A1.Ex6.m1.13.13.cmml" xref="A1.Ex6.m1.13.13"><plus id="A1.Ex6.m1.13.13.5.cmml" xref="A1.Ex6.m1.13.13.5"></plus><apply id="A1.Ex6.m1.11.11.2.cmml" xref="A1.Ex6.m1.11.11.2"><apply id="A1.Ex6.m1.11.11.2.3.cmml" xref="A1.Ex6.m1.11.11.2.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.11.11.2.3.1.cmml" xref="A1.Ex6.m1.11.11.2.3">superscript</csymbol><apply id="A1.Ex6.m1.11.11.2.3.2.cmml" xref="A1.Ex6.m1.11.11.2.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.11.11.2.3.2.1.cmml" xref="A1.Ex6.m1.11.11.2.3">subscript</csymbol><sum id="A1.Ex6.m1.11.11.2.3.2.2.cmml" xref="A1.Ex6.m1.11.11.2.3.2.2"></sum><list id="A1.Ex6.m1.2.2.2.3.cmml" xref="A1.Ex6.m1.2.2.2.4"><ci id="A1.Ex6.m1.1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1">𝐶</ci><ci id="A1.Ex6.m1.2.2.2.2.cmml" xref="A1.Ex6.m1.2.2.2.2">𝑖</ci></list></apply><list id="A1.Ex6.m1.4.4.2.3.cmml" xref="A1.Ex6.m1.4.4.2.2"><ci id="A1.Ex6.m1.3.3.1.1.cmml" xref="A1.Ex6.m1.3.3.1.1">𝑆</ci><apply id="A1.Ex6.m1.4.4.2.2.1.cmml" xref="A1.Ex6.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="A1.Ex6.m1.4.4.2.2.1.1.cmml" xref="A1.Ex6.m1.4.4.2.2.1">subscript</csymbol><ci id="A1.Ex6.m1.4.4.2.2.1.2.cmml" xref="A1.Ex6.m1.4.4.2.2.1.2">𝑁</ci><ci id="A1.Ex6.m1.4.4.2.2.1.3.cmml" xref="A1.Ex6.m1.4.4.2.2.1.3">𝐶</ci></apply></list></apply><apply id="A1.Ex6.m1.11.11.2.2.cmml" xref="A1.Ex6.m1.11.11.2.2"><times id="A1.Ex6.m1.11.11.2.2.3.cmml" xref="A1.Ex6.m1.11.11.2.2.3"></times><apply id="A1.Ex6.m1.11.11.2.2.4.cmml" xref="A1.Ex6.m1.11.11.2.2.4"><csymbol cd="ambiguous" id="A1.Ex6.m1.11.11.2.2.4.1.cmml" xref="A1.Ex6.m1.11.11.2.2.4">subscript</csymbol><ci id="A1.Ex6.m1.11.11.2.2.4.2.cmml" xref="A1.Ex6.m1.11.11.2.2.4.2">ℒ</ci><ci id="A1.Ex6.m1.11.11.2.2.4.3.cmml" xref="A1.Ex6.m1.11.11.2.2.4.3">𝑠</ci></apply><interval closure="open" id="A1.Ex6.m1.11.11.2.2.2.3.cmml" xref="A1.Ex6.m1.11.11.2.2.2.2"><apply id="A1.Ex6.m1.10.10.1.1.1.1.1.cmml" xref="A1.Ex6.m1.10.10.1.1.1.1.1"><compose id="A1.Ex6.m1.10.10.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.10.10.1.1.1.1.1.1"></compose><ci id="A1.Ex6.m1.10.10.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.10.10.1.1.1.1.1.2">𝑤</ci><apply id="A1.Ex6.m1.10.10.1.1.1.1.1.3.cmml" xref="A1.Ex6.m1.10.10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.10.10.1.1.1.1.1.3.1.cmml" xref="A1.Ex6.m1.10.10.1.1.1.1.1.3">subscript</csymbol><ci id="A1.Ex6.m1.10.10.1.1.1.1.1.3.2.cmml" xref="A1.Ex6.m1.10.10.1.1.1.1.1.3.2">ℎ</ci><ci id="A1.Ex6.m1.10.10.1.1.1.1.1.3.3.cmml" xref="A1.Ex6.m1.10.10.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="A1.Ex6.m1.11.11.2.2.2.2.2.cmml" xref="A1.Ex6.m1.11.11.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex6.m1.11.11.2.2.2.2.2.1.cmml" xref="A1.Ex6.m1.11.11.2.2.2.2.2">subscript</csymbol><ci id="A1.Ex6.m1.11.11.2.2.2.2.2.2.cmml" xref="A1.Ex6.m1.11.11.2.2.2.2.2.2">𝑦</ci><ci id="A1.Ex6.m1.11.11.2.2.2.2.2.3.cmml" xref="A1.Ex6.m1.11.11.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="A1.Ex6.m1.13.13.4.cmml" xref="A1.Ex6.m1.13.13.4"><times id="A1.Ex6.m1.13.13.4.3.cmml" xref="A1.Ex6.m1.13.13.4.3"></times><ci id="A1.Ex6.m1.13.13.4.4.cmml" xref="A1.Ex6.m1.13.13.4.4">𝜆</ci><apply id="A1.Ex6.m1.13.13.4.2.cmml" xref="A1.Ex6.m1.13.13.4.2"><apply id="A1.Ex6.m1.13.13.4.2.3.cmml" xref="A1.Ex6.m1.13.13.4.2.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.13.13.4.2.3.1.cmml" xref="A1.Ex6.m1.13.13.4.2.3">subscript</csymbol><sum id="A1.Ex6.m1.13.13.4.2.3.2.cmml" xref="A1.Ex6.m1.13.13.4.2.3.2"></sum><apply id="A1.Ex6.m1.8.8.4.5.cmml" xref="A1.Ex6.m1.8.8.4.4"><csymbol cd="ambiguous" id="A1.Ex6.m1.8.8.4.5a.cmml" xref="A1.Ex6.m1.8.8.4.4.3">formulae-sequence</csymbol><apply id="A1.Ex6.m1.7.7.3.3.1.cmml" xref="A1.Ex6.m1.7.7.3.3.1"><and id="A1.Ex6.m1.7.7.3.3.1a.cmml" xref="A1.Ex6.m1.7.7.3.3.1"></and><apply id="A1.Ex6.m1.7.7.3.3.1b.cmml" xref="A1.Ex6.m1.7.7.3.3.1"><eq id="A1.Ex6.m1.7.7.3.3.1.3.cmml" xref="A1.Ex6.m1.7.7.3.3.1.3"></eq><apply id="A1.Ex6.m1.7.7.3.3.1.2.cmml" xref="A1.Ex6.m1.7.7.3.3.1.2"><times id="A1.Ex6.m1.7.7.3.3.1.2.1.cmml" xref="A1.Ex6.m1.7.7.3.3.1.2.1"></times><ci id="A1.Ex6.m1.7.7.3.3.1.2.2.cmml" xref="A1.Ex6.m1.7.7.3.3.1.2.2">Ω</ci><interval closure="open" id="A1.Ex6.m1.7.7.3.3.1.2.3.1.cmml" xref="A1.Ex6.m1.7.7.3.3.1.2.3.2"><ci id="A1.Ex6.m1.5.5.1.1.cmml" xref="A1.Ex6.m1.5.5.1.1">𝑗</ci><ci id="A1.Ex6.m1.6.6.2.2.cmml" xref="A1.Ex6.m1.6.6.2.2">𝑘</ci></interval></apply><apply id="A1.Ex6.m1.7.7.3.3.1.4.cmml" xref="A1.Ex6.m1.7.7.3.3.1.4"><csymbol cd="latexml" id="A1.Ex6.m1.7.7.3.3.1.4.1.cmml" xref="A1.Ex6.m1.7.7.3.3.1.4.1">conditional</csymbol><cn type="integer" id="A1.Ex6.m1.7.7.3.3.1.4.2.cmml" xref="A1.Ex6.m1.7.7.3.3.1.4.2">1</cn><ci id="A1.Ex6.m1.7.7.3.3.1.4.3.cmml" xref="A1.Ex6.m1.7.7.3.3.1.4.3">𝑗</ci></apply></apply><apply id="A1.Ex6.m1.7.7.3.3.1c.cmml" xref="A1.Ex6.m1.7.7.3.3.1"><csymbol cd="latexml" id="A1.Ex6.m1.7.7.3.3.1.5.cmml" xref="A1.Ex6.m1.7.7.3.3.1.5">similar-to</csymbol><share href="#A1.Ex6.m1.7.7.3.3.1.4.cmml" id="A1.Ex6.m1.7.7.3.3.1d.cmml" xref="A1.Ex6.m1.7.7.3.3.1"></share><apply id="A1.Ex6.m1.7.7.3.3.1.6.cmml" xref="A1.Ex6.m1.7.7.3.3.1.6"><csymbol cd="ambiguous" id="A1.Ex6.m1.7.7.3.3.1.6.1.cmml" xref="A1.Ex6.m1.7.7.3.3.1.6">subscript</csymbol><ci id="A1.Ex6.m1.7.7.3.3.1.6.2.cmml" xref="A1.Ex6.m1.7.7.3.3.1.6.2">𝑁</ci><ci id="A1.Ex6.m1.7.7.3.3.1.6.3.cmml" xref="A1.Ex6.m1.7.7.3.3.1.6.3">𝐶</ci></apply></apply></apply><apply id="A1.Ex6.m1.8.8.4.4.2.cmml" xref="A1.Ex6.m1.8.8.4.4.2"><csymbol cd="latexml" id="A1.Ex6.m1.8.8.4.4.2.1.cmml" xref="A1.Ex6.m1.8.8.4.4.2.1">similar-to</csymbol><ci id="A1.Ex6.m1.8.8.4.4.2.2.cmml" xref="A1.Ex6.m1.8.8.4.4.2.2">𝑘</ci><apply id="A1.Ex6.m1.8.8.4.4.2.3.cmml" xref="A1.Ex6.m1.8.8.4.4.2.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.8.8.4.4.2.3.1.cmml" xref="A1.Ex6.m1.8.8.4.4.2.3">subscript</csymbol><ci id="A1.Ex6.m1.8.8.4.4.2.3.2.cmml" xref="A1.Ex6.m1.8.8.4.4.2.3.2">𝑁</ci><apply id="A1.Ex6.m1.8.8.4.4.2.3.3.cmml" xref="A1.Ex6.m1.8.8.4.4.2.3.3"><csymbol cd="ambiguous" id="A1.Ex6.m1.8.8.4.4.2.3.3.1.cmml" xref="A1.Ex6.m1.8.8.4.4.2.3.3">superscript</csymbol><ci id="A1.Ex6.m1.8.8.4.4.2.3.3.2.cmml" xref="A1.Ex6.m1.8.8.4.4.2.3.3.2">𝐶</ci><ci id="A1.Ex6.m1.8.8.4.4.2.3.3.3.cmml" xref="A1.Ex6.m1.8.8.4.4.2.3.3.3">′</ci></apply></apply></apply></apply></apply><apply id="A1.Ex6.m1.13.13.4.2.2.3.cmml" xref="A1.Ex6.m1.13.13.4.2.2.2"><ci id="A1.Ex6.m1.9.9.cmml" xref="A1.Ex6.m1.9.9">Dist</ci><apply id="A1.Ex6.m1.12.12.3.1.1.1.1.1.cmml" xref="A1.Ex6.m1.12.12.3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.Ex6.m1.12.12.3.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.12.12.3.1.1.1.1.1">subscript</csymbol><ci id="A1.Ex6.m1.12.12.3.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.12.12.3.1.1.1.1.1.2">ℎ</ci><ci id="A1.Ex6.m1.12.12.3.1.1.1.1.1.3.cmml" xref="A1.Ex6.m1.12.12.3.1.1.1.1.1.3">𝑗</ci></apply><apply id="A1.Ex6.m1.13.13.4.2.2.2.2.2.cmml" xref="A1.Ex6.m1.13.13.4.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.Ex6.m1.13.13.4.2.2.2.2.2.1.cmml" xref="A1.Ex6.m1.13.13.4.2.2.2.2.2">subscript</csymbol><ci id="A1.Ex6.m1.13.13.4.2.2.2.2.2.2.cmml" xref="A1.Ex6.m1.13.13.4.2.2.2.2.2.2">ℎ</ci><ci id="A1.Ex6.m1.13.13.4.2.2.2.2.2.3.cmml" xref="A1.Ex6.m1.13.13.4.2.2.2.2.2.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.Ex6.m1.13c">\sum_{C,i}^{S,N_{C}}\mathcal{L}_{s}(w\circ h_{i},y_{i})+\lambda*\sum_{\Omega(j,k)=1\mid j\sim N_{C},k\sim N_{C^{\prime}}}\operatorname{Dist}(h_{j},h_{k})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS1.p1.4" class="ltx_p">where <math id="A1.SS1.p1.4.m1.1" class="ltx_Math" alttext="\Omega" display="inline"><semantics id="A1.SS1.p1.4.m1.1a"><mi mathvariant="normal" id="A1.SS1.p1.4.m1.1.1" xref="A1.SS1.p1.4.m1.1.1.cmml">Ω</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.4.m1.1b"><ci id="A1.SS1.p1.4.m1.1.1.cmml" xref="A1.SS1.p1.4.m1.1.1">Ω</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.4.m1.1c">\Omega</annotation></semantics></math> represents the match function used to randomly pair the data points across the different client domains <cite class="ltx_cite ltx_citemacro_citep">(Mahajan et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Inference Attack</h3>

<section id="A1.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.1 </span>Membership Inference</h4>

<div id="A1.SS2.SSS1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS2.SSS1.p1.1" class="ltx_p">The main idea is that each training data point affects the gradients of the loss function such that the adversary can use Stochastic
Gradient Descent algorithm (SGD) to extract information from
other clients’ data <cite class="ltx_cite ltx_citemacro_citep">(Nasr et al., <a href="#bib.bib9" title="" class="ltx_ref">2018a</a>)</cite>. The adversary can perform
gradient ascent on a target data point before local parameter update. SGD reduces the gradient,in case the considered data point is part of a client’s set resulting in a succesful membership inference. Attack can come from both the client side and the server side. An adversarial client can observe the aggregated model updates and extract information about the union of the training dataset of all other participants by injecting adversarial model updates.
For a server side attack, it can control the view of each target participant on the aggregated model updates and extract information
from its dataset.</p>
</div>
<div id="A1.SS2.SSS1.p2" class="ltx_para ltx_noindent">
<p id="A1.SS2.SSS1.p2.1" class="ltx_p">In our implementation, we sample 2,000 datapoints
for Rotated-MNIST and 10,000 datapoints for Fashion-MNIST from the original train and test dataset to create the attack-train and attack-test dataset. We use pytorch code provided by <cite class="ltx_cite ltx_citemacro_citep">(Shokri et al., <a href="#bib.bib13" title="" class="ltx_ref">2017</a>)</cite><cite class="ltx_cite ltx_citemacro_citep">(Nasr et al., <a href="#bib.bib9" title="" class="ltx_ref">2018a</a>)</cite></p>
</div>
</section>
<section id="A1.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.2 </span>Property Inference</h4>

<div id="A1.SS2.SSS2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS2.SSS2.p1.1" class="ltx_p">The main idea behind this attack is that, at each round,
each client’s contribution is based on a batch of their local
training data, so the attacker can infer properties that characterize the target dataset for which the adversary needs sample train data, which is labeled with the attribute to be infered.<cite class="ltx_cite ltx_citemacro_citep">(C et al., <a href="#bib.bib2" title="" class="ltx_ref">2019</a>)</cite> It is aimed at
infering properties of client data that are uncorrelated with the
features that characterize the classes of the model. In our experiments we decided on client domain as the attribute which is to be inferred by the adversary. Another such attribute that is uncorrelated with the final prediction is the color of the input.</p>
</div>
<div id="A1.SS2.SSS2.p2" class="ltx_para ltx_noindent">
<p id="A1.SS2.SSS2.p2.1" class="ltx_p">We observe that federated causal models provide better pivacy guarantees against this attack which could be owed to the fact that inversion based on learning correlations between
attributes and final prediction, e.g., using color to predict the digit, can be eliminated by causal models, since a
non-causal feature will not be included in the our final causal federated model.</p>
</div>
</section>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Backdoor Attack</h3>

<div id="A1.SS3.p1" class="ltx_para ltx_noindent">
<p id="A1.SS3.p1.1" class="ltx_p">For an initial analysis, we experimented with two backdoor attacks:</p>
<ul id="A1.I1" class="ltx_itemize">
<li id="A1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i1.p1" class="ltx_para">
<p id="A1.I1.i1.p1.1" class="ltx_p">A single-pixel attack, where in the attacker changes the top-left pixel color of all the inputs, and mislabels them.</p>
</div>
</li>
<li id="A1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A1.I1.i2.p1" class="ltx_para ltx_noindent">
<p id="A1.I1.i2.p1.1" class="ltx_p">A semantic backdoor where in the attacker selects certain
features as the backdoors and misclassifies them. For example, the attacker classifies digits rotated <math id="A1.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="15^{\circ}" display="inline"><semantics id="A1.I1.i2.p1.1.m1.1a"><msup id="A1.I1.i2.p1.1.m1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.cmml"><mn id="A1.I1.i2.p1.1.m1.1.1.2" xref="A1.I1.i2.p1.1.m1.1.1.2.cmml">15</mn><mo id="A1.I1.i2.p1.1.m1.1.1.3" xref="A1.I1.i2.p1.1.m1.1.1.3.cmml">∘</mo></msup><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.1.m1.1b"><apply id="A1.I1.i2.p1.1.m1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I1.i2.p1.1.m1.1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1">superscript</csymbol><cn type="integer" id="A1.I1.i2.p1.1.m1.1.1.2.cmml" xref="A1.I1.i2.p1.1.m1.1.1.2">15</cn><compose id="A1.I1.i2.p1.1.m1.1.1.3.cmml" xref="A1.I1.i2.p1.1.m1.1.1.3"></compose></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.1.m1.1c">15^{\circ}</annotation></semantics></math> with label 7 as 0</p>
</div>
</li>
</ul>
<p id="A1.SS3.p1.2" class="ltx_p">In both the cases, CausalFed exhibited better resilience as compared to FedAvg.</p>
</div>
</section>
<section id="A1.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Network Architecture</h3>

<figure id="A1.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Network Architecture</figcaption>
<table id="A1.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T4.1.1.1" class="ltx_tr">
<th id="A1.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T4.1.1.1.1.1" class="ltx_text ltx_font_bold">Architecture</span></th>
<th id="A1.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T4.1.1.1.2.1" class="ltx_text ltx_font_bold">No of Layers</span></th>
<th id="A1.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T4.1.1.1.3.1" class="ltx_text ltx_font_bold">Kernel spec</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T4.1.2.1" class="ltx_tr">
<td id="A1.T4.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">LeNet</td>
<td id="A1.T4.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">5</td>
<td id="A1.T4.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">(5x5), (2x2)</td>
</tr>
<tr id="A1.T4.1.3.2" class="ltx_tr">
<td id="A1.T4.1.3.2.1" class="ltx_td ltx_align_left ltx_border_t">AlexNet</td>
<td id="A1.T4.1.3.2.2" class="ltx_td ltx_align_left ltx_border_t">8</td>
<td id="A1.T4.1.3.2.3" class="ltx_td ltx_align_left ltx_border_t">(11x11), (5x5), (3x3)</td>
</tr>
<tr id="A1.T4.1.4.3" class="ltx_tr">
<td id="A1.T4.1.4.3.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">ResNet18</td>
<td id="A1.T4.1.4.3.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">18</td>
<td id="A1.T4.1.4.3.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">(7x7), (3x3)</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A1.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>CasualFedGSD - Alternative approach to CausalFed</h3>

<figure id="A1.F2" class="ltx_figure"><img src="/html/2104.06557/assets/x2.jpg" id="A1.F2.g1" class="ltx_graphics ltx_img_landscape" width="348" height="218" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span> Causal Federated Learning</figcaption>
</figure>
<div id="A1.SS5.p1" class="ltx_para ltx_noindent">
<p id="A1.SS5.p1.1" class="ltx_p">In  <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib17" title="" class="ltx_ref">2018</a>)</cite>, it has been shown that globally shared data can reduce EMD(earth mover’s distance) between the data distribution on clients and the population distribution which can help in improved test accuracy.As this globally shared data is a separate dataset from that of the client, this approach is not privacy sensitive.</p>
</div>
<div id="A1.SS5.p2" class="ltx_para ltx_noindent">
<p id="A1.SS5.p2.1" class="ltx_p">With the CausalFed approach, there can be privacy concerns regarding sharing the client data representation to the global server due to which depending on a global data set(with different enviroments) to enhance causal feature learning within a federated learning setup seems plausible.
As we have no control on the clients’ data, we can distribute a small subset of global data containing a distribution over all the classes/enviroments from the server side to the clients during the initialization stage of federated learning.</p>
</div>
<div id="A1.SS5.p3" class="ltx_para ltx_noindent">
<p id="A1.SS5.p3.1" class="ltx_p">The local model of each client is learned by minimizing the empirical average loss as well as regularizing the model by the gradient norm of the loss for both the shared data from server(Global Environment) and private data from each client(Local Environment). This enhances the learning of causal/invariant features common to both the client and global data environments without losing the privacy of client side data.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.4.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> CausalFedGSD</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.1" class="ltx_p ltx_figure_panel"><span id="alg2.1.1" class="ltx_text ltx_markedasmath ltx_font_bold">ServerUpdate:</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg2.5" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg2.l1" class="ltx_listingline">  <math id="alg2.l1.m1.1" class="ltx_Math" alttext="\text{G }\leftarrow\text{distribution over all environments present in server}" display="inline"><semantics id="alg2.l1.m1.1a"><mrow id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><mtext id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2a.cmml">G </mtext><mo stretchy="false" id="alg2.l1.m1.1.1.1" xref="alg2.l1.m1.1.1.1.cmml">←</mo><mtext id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3a.cmml">distribution over all environments present in server</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><ci id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1">←</ci><ci id="alg2.l1.m1.1.1.2a.cmml" xref="alg2.l1.m1.1.1.2"><mtext id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2">G </mtext></ci><ci id="alg2.l1.m1.1.1.3a.cmml" xref="alg2.l1.m1.1.1.3"><mtext id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3">distribution over all environments present in server</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\text{G }\leftarrow\text{distribution over all environments present in server}</annotation></semantics></math>

</div>
<div id="alg2.l2" class="ltx_listingline">  <math id="alg2.l2.m1.1" class="ltx_Math" alttext="\text{Initialize }w_{0}" display="inline"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mtext id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2a.cmml">Initialize </mtext><mo lspace="0em" rspace="0em" id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">​</mo><msub id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml"><mi id="alg2.l2.m1.1.1.3.2" xref="alg2.l2.m1.1.1.3.2.cmml">w</mi><mn id="alg2.l2.m1.1.1.3.3" xref="alg2.l2.m1.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><times id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></times><ci id="alg2.l2.m1.1.1.2a.cmml" xref="alg2.l2.m1.1.1.2"><mtext id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">Initialize </mtext></ci><apply id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.3">subscript</csymbol><ci id="alg2.l2.m1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.3.2">𝑤</ci><cn type="integer" id="alg2.l2.m1.1.1.3.3.cmml" xref="alg2.l2.m1.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\text{Initialize }w_{0}</annotation></semantics></math>

</div>
<div id="alg2.l3" class="ltx_listingline">  <math id="alg2.l3.m1.1" class="ltx_Math" alttext="\text{Initialize random portion of G as }G_{0}" display="inline"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mtext id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2a.cmml">Initialize random portion of G as </mtext><mo lspace="0em" rspace="0em" id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">​</mo><msub id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml"><mi id="alg2.l3.m1.1.1.3.2" xref="alg2.l3.m1.1.1.3.2.cmml">G</mi><mn id="alg2.l3.m1.1.1.3.3" xref="alg2.l3.m1.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><times id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"></times><ci id="alg2.l3.m1.1.1.2a.cmml" xref="alg2.l3.m1.1.1.2"><mtext id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">Initialize random portion of G as </mtext></ci><apply id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.1.cmml" xref="alg2.l3.m1.1.1.3">subscript</csymbol><ci id="alg2.l3.m1.1.1.3.2.cmml" xref="alg2.l3.m1.1.1.3.2">𝐺</ci><cn type="integer" id="alg2.l3.m1.1.1.3.3.cmml" xref="alg2.l3.m1.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">\text{Initialize random portion of G as }G_{0}</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">  <span id="alg2.l4.1" class="ltx_text ltx_font_bold">for</span> <span id="alg2.l4.2" class="ltx_text ltx_markedasmath">each server epoch, t = 1,2,..k </span> <span id="alg2.l4.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l5" class="ltx_listingline">     <span id="alg2.l5.1" class="ltx_text ltx_markedasmath">Select random set of S clients</span>

</div>
<div id="alg2.l6" class="ltx_listingline">     <span id="alg2.l6.m1.1.1.1" class="ltx_text ltx_markedasmath">Share <math id="alg2.l6.m1.1.1.1.m1.1" class="ltx_Math" alttext="G_{0}" display="inline"><semantics id="alg2.l6.m1.1.1.1.m1.1a"><msub id="alg2.l6.m1.1.1.1.m1.1.1" xref="alg2.l6.m1.1.1.1.m1.1.1.cmml"><mi id="alg2.l6.m1.1.1.1.m1.1.1.2" xref="alg2.l6.m1.1.1.1.m1.1.1.2.cmml">G</mi><mn id="alg2.l6.m1.1.1.1.m1.1.1.3" xref="alg2.l6.m1.1.1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1.1.1.m1.1b"><apply id="alg2.l6.m1.1.1.1.m1.1.1.cmml" xref="alg2.l6.m1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.m1.1.1">subscript</csymbol><ci id="alg2.l6.m1.1.1.1.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.m1.1.1.2">𝐺</ci><cn type="integer" id="alg2.l6.m1.1.1.1.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1.1.1.m1.1c">G_{0}</annotation></semantics></math> and initial model with the selected clients</span>

</div>
<div id="alg2.l7" class="ltx_listingline">     <span id="alg2.l7.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l7.m1.1" class="ltx_Math" alttext="\text{each client }k\in S" display="inline"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><mrow id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml"><mtext id="alg2.l7.m1.1.1.2.2" xref="alg2.l7.m1.1.1.2.2a.cmml">each client </mtext><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.2.1" xref="alg2.l7.m1.1.1.2.1.cmml">​</mo><mi id="alg2.l7.m1.1.1.2.3" xref="alg2.l7.m1.1.1.2.3.cmml">k</mi></mrow><mo id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml">∈</mo><mi id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><in id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1"></in><apply id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2"><times id="alg2.l7.m1.1.1.2.1.cmml" xref="alg2.l7.m1.1.1.2.1"></times><ci id="alg2.l7.m1.1.1.2.2a.cmml" xref="alg2.l7.m1.1.1.2.2"><mtext id="alg2.l7.m1.1.1.2.2.cmml" xref="alg2.l7.m1.1.1.2.2">each client </mtext></ci><ci id="alg2.l7.m1.1.1.2.3.cmml" xref="alg2.l7.m1.1.1.2.3">𝑘</ci></apply><ci id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">\text{each client }k\in S</annotation></semantics></math> <span id="alg2.l7.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l8" class="ltx_listingline">        <math id="alg2.l8.m1.2" class="ltx_Math" alttext="w^{k}_{t+1}=ClientUpdate(k,w_{t})" display="inline"><semantics id="alg2.l8.m1.2a"><mrow id="alg2.l8.m1.2.2" xref="alg2.l8.m1.2.2.cmml"><msubsup id="alg2.l8.m1.2.2.3" xref="alg2.l8.m1.2.2.3.cmml"><mi id="alg2.l8.m1.2.2.3.2.2" xref="alg2.l8.m1.2.2.3.2.2.cmml">w</mi><mrow id="alg2.l8.m1.2.2.3.3" xref="alg2.l8.m1.2.2.3.3.cmml"><mi id="alg2.l8.m1.2.2.3.3.2" xref="alg2.l8.m1.2.2.3.3.2.cmml">t</mi><mo id="alg2.l8.m1.2.2.3.3.1" xref="alg2.l8.m1.2.2.3.3.1.cmml">+</mo><mn id="alg2.l8.m1.2.2.3.3.3" xref="alg2.l8.m1.2.2.3.3.3.cmml">1</mn></mrow><mi id="alg2.l8.m1.2.2.3.2.3" xref="alg2.l8.m1.2.2.3.2.3.cmml">k</mi></msubsup><mo id="alg2.l8.m1.2.2.2" xref="alg2.l8.m1.2.2.2.cmml">=</mo><mrow id="alg2.l8.m1.2.2.1" xref="alg2.l8.m1.2.2.1.cmml"><mi id="alg2.l8.m1.2.2.1.3" xref="alg2.l8.m1.2.2.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.1.2" xref="alg2.l8.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l8.m1.2.2.1.4" xref="alg2.l8.m1.2.2.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.1.2a" xref="alg2.l8.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l8.m1.2.2.1.5" xref="alg2.l8.m1.2.2.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.1.2b" xref="alg2.l8.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l8.m1.2.2.1.6" xref="alg2.l8.m1.2.2.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.1.2c" xref="alg2.l8.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l8.m1.2.2.1.7" xref="alg2.l8.m1.2.2.1.7.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.1.2d" xref="alg2.l8.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l8.m1.2.2.1.8" xref="alg2.l8.m1.2.2.1.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.1.2e" xref="alg2.l8.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l8.m1.2.2.1.9" xref="alg2.l8.m1.2.2.1.9.cmml">U</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.1.2f" xref="alg2.l8.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l8.m1.2.2.1.10" xref="alg2.l8.m1.2.2.1.10.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.1.2g" xref="alg2.l8.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l8.m1.2.2.1.11" xref="alg2.l8.m1.2.2.1.11.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.1.2h" xref="alg2.l8.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l8.m1.2.2.1.12" xref="alg2.l8.m1.2.2.1.12.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.1.2i" xref="alg2.l8.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l8.m1.2.2.1.13" xref="alg2.l8.m1.2.2.1.13.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.1.2j" xref="alg2.l8.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l8.m1.2.2.1.14" xref="alg2.l8.m1.2.2.1.14.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.1.2k" xref="alg2.l8.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l8.m1.2.2.1.1.1" xref="alg2.l8.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l8.m1.2.2.1.1.1.2" xref="alg2.l8.m1.2.2.1.1.2.cmml">(</mo><mi id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml">k</mi><mo id="alg2.l8.m1.2.2.1.1.1.3" xref="alg2.l8.m1.2.2.1.1.2.cmml">,</mo><msub id="alg2.l8.m1.2.2.1.1.1.1" xref="alg2.l8.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l8.m1.2.2.1.1.1.1.2" xref="alg2.l8.m1.2.2.1.1.1.1.2.cmml">w</mi><mi id="alg2.l8.m1.2.2.1.1.1.1.3" xref="alg2.l8.m1.2.2.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="alg2.l8.m1.2.2.1.1.1.4" xref="alg2.l8.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.2b"><apply id="alg2.l8.m1.2.2.cmml" xref="alg2.l8.m1.2.2"><eq id="alg2.l8.m1.2.2.2.cmml" xref="alg2.l8.m1.2.2.2"></eq><apply id="alg2.l8.m1.2.2.3.cmml" xref="alg2.l8.m1.2.2.3"><csymbol cd="ambiguous" id="alg2.l8.m1.2.2.3.1.cmml" xref="alg2.l8.m1.2.2.3">subscript</csymbol><apply id="alg2.l8.m1.2.2.3.2.cmml" xref="alg2.l8.m1.2.2.3"><csymbol cd="ambiguous" id="alg2.l8.m1.2.2.3.2.1.cmml" xref="alg2.l8.m1.2.2.3">superscript</csymbol><ci id="alg2.l8.m1.2.2.3.2.2.cmml" xref="alg2.l8.m1.2.2.3.2.2">𝑤</ci><ci id="alg2.l8.m1.2.2.3.2.3.cmml" xref="alg2.l8.m1.2.2.3.2.3">𝑘</ci></apply><apply id="alg2.l8.m1.2.2.3.3.cmml" xref="alg2.l8.m1.2.2.3.3"><plus id="alg2.l8.m1.2.2.3.3.1.cmml" xref="alg2.l8.m1.2.2.3.3.1"></plus><ci id="alg2.l8.m1.2.2.3.3.2.cmml" xref="alg2.l8.m1.2.2.3.3.2">𝑡</ci><cn type="integer" id="alg2.l8.m1.2.2.3.3.3.cmml" xref="alg2.l8.m1.2.2.3.3.3">1</cn></apply></apply><apply id="alg2.l8.m1.2.2.1.cmml" xref="alg2.l8.m1.2.2.1"><times id="alg2.l8.m1.2.2.1.2.cmml" xref="alg2.l8.m1.2.2.1.2"></times><ci id="alg2.l8.m1.2.2.1.3.cmml" xref="alg2.l8.m1.2.2.1.3">𝐶</ci><ci id="alg2.l8.m1.2.2.1.4.cmml" xref="alg2.l8.m1.2.2.1.4">𝑙</ci><ci id="alg2.l8.m1.2.2.1.5.cmml" xref="alg2.l8.m1.2.2.1.5">𝑖</ci><ci id="alg2.l8.m1.2.2.1.6.cmml" xref="alg2.l8.m1.2.2.1.6">𝑒</ci><ci id="alg2.l8.m1.2.2.1.7.cmml" xref="alg2.l8.m1.2.2.1.7">𝑛</ci><ci id="alg2.l8.m1.2.2.1.8.cmml" xref="alg2.l8.m1.2.2.1.8">𝑡</ci><ci id="alg2.l8.m1.2.2.1.9.cmml" xref="alg2.l8.m1.2.2.1.9">𝑈</ci><ci id="alg2.l8.m1.2.2.1.10.cmml" xref="alg2.l8.m1.2.2.1.10">𝑝</ci><ci id="alg2.l8.m1.2.2.1.11.cmml" xref="alg2.l8.m1.2.2.1.11">𝑑</ci><ci id="alg2.l8.m1.2.2.1.12.cmml" xref="alg2.l8.m1.2.2.1.12">𝑎</ci><ci id="alg2.l8.m1.2.2.1.13.cmml" xref="alg2.l8.m1.2.2.1.13">𝑡</ci><ci id="alg2.l8.m1.2.2.1.14.cmml" xref="alg2.l8.m1.2.2.1.14">𝑒</ci><interval closure="open" id="alg2.l8.m1.2.2.1.1.2.cmml" xref="alg2.l8.m1.2.2.1.1.1"><ci id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">𝑘</ci><apply id="alg2.l8.m1.2.2.1.1.1.1.cmml" xref="alg2.l8.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l8.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l8.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l8.m1.2.2.1.1.1.1.2">𝑤</ci><ci id="alg2.l8.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l8.m1.2.2.1.1.1.1.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.2c">w^{k}_{t+1}=ClientUpdate(k,w_{t})</annotation></semantics></math>

</div>
<div id="alg2.l9" class="ltx_listingline">     <span id="alg2.l9.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l9.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l10" class="ltx_listingline">     <math id="alg2.l10.m1.1" class="ltx_Math" alttext="w_{t+1}=\sum_{k=1}^{K}\frac{n_{k}}{n}w_{t+1}^{k}" display="inline"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><msub id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml"><mi id="alg2.l10.m1.1.1.2.2" xref="alg2.l10.m1.1.1.2.2.cmml">w</mi><mrow id="alg2.l10.m1.1.1.2.3" xref="alg2.l10.m1.1.1.2.3.cmml"><mi id="alg2.l10.m1.1.1.2.3.2" xref="alg2.l10.m1.1.1.2.3.2.cmml">t</mi><mo id="alg2.l10.m1.1.1.2.3.1" xref="alg2.l10.m1.1.1.2.3.1.cmml">+</mo><mn id="alg2.l10.m1.1.1.2.3.3" xref="alg2.l10.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" id="alg2.l10.m1.1.1.1" xref="alg2.l10.m1.1.1.1.cmml">=</mo><mrow id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml"><msubsup id="alg2.l10.m1.1.1.3.1" xref="alg2.l10.m1.1.1.3.1.cmml"><mo id="alg2.l10.m1.1.1.3.1.2.2" xref="alg2.l10.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg2.l10.m1.1.1.3.1.2.3" xref="alg2.l10.m1.1.1.3.1.2.3.cmml"><mi id="alg2.l10.m1.1.1.3.1.2.3.2" xref="alg2.l10.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg2.l10.m1.1.1.3.1.2.3.1" xref="alg2.l10.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg2.l10.m1.1.1.3.1.2.3.3" xref="alg2.l10.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg2.l10.m1.1.1.3.1.3" xref="alg2.l10.m1.1.1.3.1.3.cmml">K</mi></msubsup><mrow id="alg2.l10.m1.1.1.3.2" xref="alg2.l10.m1.1.1.3.2.cmml"><mfrac id="alg2.l10.m1.1.1.3.2.2" xref="alg2.l10.m1.1.1.3.2.2.cmml"><msub id="alg2.l10.m1.1.1.3.2.2.2" xref="alg2.l10.m1.1.1.3.2.2.2.cmml"><mi id="alg2.l10.m1.1.1.3.2.2.2.2" xref="alg2.l10.m1.1.1.3.2.2.2.2.cmml">n</mi><mi id="alg2.l10.m1.1.1.3.2.2.2.3" xref="alg2.l10.m1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="alg2.l10.m1.1.1.3.2.2.3" xref="alg2.l10.m1.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.1.3.2.1" xref="alg2.l10.m1.1.1.3.2.1.cmml">​</mo><msubsup id="alg2.l10.m1.1.1.3.2.3" xref="alg2.l10.m1.1.1.3.2.3.cmml"><mi id="alg2.l10.m1.1.1.3.2.3.2.2" xref="alg2.l10.m1.1.1.3.2.3.2.2.cmml">w</mi><mrow id="alg2.l10.m1.1.1.3.2.3.2.3" xref="alg2.l10.m1.1.1.3.2.3.2.3.cmml"><mi id="alg2.l10.m1.1.1.3.2.3.2.3.2" xref="alg2.l10.m1.1.1.3.2.3.2.3.2.cmml">t</mi><mo id="alg2.l10.m1.1.1.3.2.3.2.3.1" xref="alg2.l10.m1.1.1.3.2.3.2.3.1.cmml">+</mo><mn id="alg2.l10.m1.1.1.3.2.3.2.3.3" xref="alg2.l10.m1.1.1.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="alg2.l10.m1.1.1.3.2.3.3" xref="alg2.l10.m1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><eq id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1"></eq><apply id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.2.1.cmml" xref="alg2.l10.m1.1.1.2">subscript</csymbol><ci id="alg2.l10.m1.1.1.2.2.cmml" xref="alg2.l10.m1.1.1.2.2">𝑤</ci><apply id="alg2.l10.m1.1.1.2.3.cmml" xref="alg2.l10.m1.1.1.2.3"><plus id="alg2.l10.m1.1.1.2.3.1.cmml" xref="alg2.l10.m1.1.1.2.3.1"></plus><ci id="alg2.l10.m1.1.1.2.3.2.cmml" xref="alg2.l10.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg2.l10.m1.1.1.2.3.3.cmml" xref="alg2.l10.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3"><apply id="alg2.l10.m1.1.1.3.1.cmml" xref="alg2.l10.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.1.1.cmml" xref="alg2.l10.m1.1.1.3.1">superscript</csymbol><apply id="alg2.l10.m1.1.1.3.1.2.cmml" xref="alg2.l10.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.1.2.1.cmml" xref="alg2.l10.m1.1.1.3.1">subscript</csymbol><sum id="alg2.l10.m1.1.1.3.1.2.2.cmml" xref="alg2.l10.m1.1.1.3.1.2.2"></sum><apply id="alg2.l10.m1.1.1.3.1.2.3.cmml" xref="alg2.l10.m1.1.1.3.1.2.3"><eq id="alg2.l10.m1.1.1.3.1.2.3.1.cmml" xref="alg2.l10.m1.1.1.3.1.2.3.1"></eq><ci id="alg2.l10.m1.1.1.3.1.2.3.2.cmml" xref="alg2.l10.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg2.l10.m1.1.1.3.1.2.3.3.cmml" xref="alg2.l10.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg2.l10.m1.1.1.3.1.3.cmml" xref="alg2.l10.m1.1.1.3.1.3">𝐾</ci></apply><apply id="alg2.l10.m1.1.1.3.2.cmml" xref="alg2.l10.m1.1.1.3.2"><times id="alg2.l10.m1.1.1.3.2.1.cmml" xref="alg2.l10.m1.1.1.3.2.1"></times><apply id="alg2.l10.m1.1.1.3.2.2.cmml" xref="alg2.l10.m1.1.1.3.2.2"><divide id="alg2.l10.m1.1.1.3.2.2.1.cmml" xref="alg2.l10.m1.1.1.3.2.2"></divide><apply id="alg2.l10.m1.1.1.3.2.2.2.cmml" xref="alg2.l10.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.2.2.2.1.cmml" xref="alg2.l10.m1.1.1.3.2.2.2">subscript</csymbol><ci id="alg2.l10.m1.1.1.3.2.2.2.2.cmml" xref="alg2.l10.m1.1.1.3.2.2.2.2">𝑛</ci><ci id="alg2.l10.m1.1.1.3.2.2.2.3.cmml" xref="alg2.l10.m1.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="alg2.l10.m1.1.1.3.2.2.3.cmml" xref="alg2.l10.m1.1.1.3.2.2.3">𝑛</ci></apply><apply id="alg2.l10.m1.1.1.3.2.3.cmml" xref="alg2.l10.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.2.3.1.cmml" xref="alg2.l10.m1.1.1.3.2.3">superscript</csymbol><apply id="alg2.l10.m1.1.1.3.2.3.2.cmml" xref="alg2.l10.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.3.2.3.2.1.cmml" xref="alg2.l10.m1.1.1.3.2.3">subscript</csymbol><ci id="alg2.l10.m1.1.1.3.2.3.2.2.cmml" xref="alg2.l10.m1.1.1.3.2.3.2.2">𝑤</ci><apply id="alg2.l10.m1.1.1.3.2.3.2.3.cmml" xref="alg2.l10.m1.1.1.3.2.3.2.3"><plus id="alg2.l10.m1.1.1.3.2.3.2.3.1.cmml" xref="alg2.l10.m1.1.1.3.2.3.2.3.1"></plus><ci id="alg2.l10.m1.1.1.3.2.3.2.3.2.cmml" xref="alg2.l10.m1.1.1.3.2.3.2.3.2">𝑡</ci><cn type="integer" id="alg2.l10.m1.1.1.3.2.3.2.3.3.cmml" xref="alg2.l10.m1.1.1.3.2.3.2.3.3">1</cn></apply></apply><ci id="alg2.l10.m1.1.1.3.2.3.3.cmml" xref="alg2.l10.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">w_{t+1}=\sum_{k=1}^{K}\frac{n_{k}}{n}w_{t+1}^{k}</annotation></semantics></math>

</div>
<div id="alg2.l11" class="ltx_listingline">  <span id="alg2.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.2" class="ltx_p ltx_figure_panel"><span id="alg2.2.1" class="ltx_text ltx_markedasmath ltx_font_bold">ClientUpdate(w):</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg2.6" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg2.l1a" class="ltx_listingline">  <math id="alg2.l1a.m1.2" class="ltx_Math" alttext="\mathcal{E}_{\mathrm{tr}}\in[\text{Client Env}]\bigcup[\text{Global Env}]" display="inline"><semantics id="alg2.l1a.m1.2a"><mrow id="alg2.l1a.m1.2.3" xref="alg2.l1a.m1.2.3.cmml"><msub id="alg2.l1a.m1.2.3.2" xref="alg2.l1a.m1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l1a.m1.2.3.2.2" xref="alg2.l1a.m1.2.3.2.2.cmml">ℰ</mi><mi id="alg2.l1a.m1.2.3.2.3" xref="alg2.l1a.m1.2.3.2.3.cmml">tr</mi></msub><mo id="alg2.l1a.m1.2.3.1" xref="alg2.l1a.m1.2.3.1.cmml">∈</mo><mrow id="alg2.l1a.m1.2.3.3" xref="alg2.l1a.m1.2.3.3.cmml"><mrow id="alg2.l1a.m1.2.3.3.2.2" xref="alg2.l1a.m1.2.3.3.2.1.cmml"><mo stretchy="false" id="alg2.l1a.m1.2.3.3.2.2.1" xref="alg2.l1a.m1.2.3.3.2.1.1.cmml">[</mo><mtext id="alg2.l1a.m1.1.1" xref="alg2.l1a.m1.1.1a.cmml">Client Env</mtext><mo stretchy="false" id="alg2.l1a.m1.2.3.3.2.2.2" xref="alg2.l1a.m1.2.3.3.2.1.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="alg2.l1a.m1.2.3.3.1" xref="alg2.l1a.m1.2.3.3.1.cmml">​</mo><mrow id="alg2.l1a.m1.2.3.3.3" xref="alg2.l1a.m1.2.3.3.3.cmml"><mo rspace="0em" id="alg2.l1a.m1.2.3.3.3.1" xref="alg2.l1a.m1.2.3.3.3.1.cmml">⋃</mo><mrow id="alg2.l1a.m1.2.3.3.3.2.2" xref="alg2.l1a.m1.2.3.3.3.2.1.cmml"><mo stretchy="false" id="alg2.l1a.m1.2.3.3.3.2.2.1" xref="alg2.l1a.m1.2.3.3.3.2.1.1.cmml">[</mo><mtext id="alg2.l1a.m1.2.2" xref="alg2.l1a.m1.2.2a.cmml">Global Env</mtext><mo stretchy="false" id="alg2.l1a.m1.2.3.3.3.2.2.2" xref="alg2.l1a.m1.2.3.3.3.2.1.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1a.m1.2b"><apply id="alg2.l1a.m1.2.3.cmml" xref="alg2.l1a.m1.2.3"><in id="alg2.l1a.m1.2.3.1.cmml" xref="alg2.l1a.m1.2.3.1"></in><apply id="alg2.l1a.m1.2.3.2.cmml" xref="alg2.l1a.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.l1a.m1.2.3.2.1.cmml" xref="alg2.l1a.m1.2.3.2">subscript</csymbol><ci id="alg2.l1a.m1.2.3.2.2.cmml" xref="alg2.l1a.m1.2.3.2.2">ℰ</ci><ci id="alg2.l1a.m1.2.3.2.3.cmml" xref="alg2.l1a.m1.2.3.2.3">tr</ci></apply><apply id="alg2.l1a.m1.2.3.3.cmml" xref="alg2.l1a.m1.2.3.3"><times id="alg2.l1a.m1.2.3.3.1.cmml" xref="alg2.l1a.m1.2.3.3.1"></times><apply id="alg2.l1a.m1.2.3.3.2.1.cmml" xref="alg2.l1a.m1.2.3.3.2.2"><csymbol cd="latexml" id="alg2.l1a.m1.2.3.3.2.1.1.cmml" xref="alg2.l1a.m1.2.3.3.2.2.1">delimited-[]</csymbol><ci id="alg2.l1a.m1.1.1a.cmml" xref="alg2.l1a.m1.1.1"><mtext id="alg2.l1a.m1.1.1.cmml" xref="alg2.l1a.m1.1.1">Client Env</mtext></ci></apply><apply id="alg2.l1a.m1.2.3.3.3.cmml" xref="alg2.l1a.m1.2.3.3.3"><union id="alg2.l1a.m1.2.3.3.3.1.cmml" xref="alg2.l1a.m1.2.3.3.3.1"></union><apply id="alg2.l1a.m1.2.3.3.3.2.1.cmml" xref="alg2.l1a.m1.2.3.3.3.2.2"><csymbol cd="latexml" id="alg2.l1a.m1.2.3.3.3.2.1.1.cmml" xref="alg2.l1a.m1.2.3.3.3.2.2.1">delimited-[]</csymbol><ci id="alg2.l1a.m1.2.2a.cmml" xref="alg2.l1a.m1.2.2"><mtext id="alg2.l1a.m1.2.2.cmml" xref="alg2.l1a.m1.2.2">Global Env</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1a.m1.2c">\mathcal{E}_{\mathrm{tr}}\in[\text{Client Env}]\bigcup[\text{Global Env}]</annotation></semantics></math>

</div>
<div id="alg2.l2a" class="ltx_listingline">  <span id="alg2.l2a.1" class="ltx_text ltx_font_bold">for</span> <span id="alg2.l2a.2" class="ltx_text ltx_markedasmath">each local client epoch, t=1,2,..k</span> <span id="alg2.l2a.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l3a" class="ltx_listingline">     <math id="alg2.l3a.m1.6" class="ltx_Math" alttext="L_{\mathrm{IRM}}(\Phi,w^{k}_{t})=\sum_{e\in\mathcal{E}_{\mathrm{tr}}}R^{e}(w\circ\Phi)+\lambda\cdot\mathbb{D}(w,\Phi,e)" display="inline"><semantics id="alg2.l3a.m1.6a"><mrow id="alg2.l3a.m1.6.6" xref="alg2.l3a.m1.6.6.cmml"><mrow id="alg2.l3a.m1.5.5.1" xref="alg2.l3a.m1.5.5.1.cmml"><msub id="alg2.l3a.m1.5.5.1.3" xref="alg2.l3a.m1.5.5.1.3.cmml"><mi id="alg2.l3a.m1.5.5.1.3.2" xref="alg2.l3a.m1.5.5.1.3.2.cmml">L</mi><mi id="alg2.l3a.m1.5.5.1.3.3" xref="alg2.l3a.m1.5.5.1.3.3.cmml">IRM</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l3a.m1.5.5.1.2" xref="alg2.l3a.m1.5.5.1.2.cmml">​</mo><mrow id="alg2.l3a.m1.5.5.1.1.1" xref="alg2.l3a.m1.5.5.1.1.2.cmml"><mo stretchy="false" id="alg2.l3a.m1.5.5.1.1.1.2" xref="alg2.l3a.m1.5.5.1.1.2.cmml">(</mo><mi mathvariant="normal" id="alg2.l3a.m1.1.1" xref="alg2.l3a.m1.1.1.cmml">Φ</mi><mo id="alg2.l3a.m1.5.5.1.1.1.3" xref="alg2.l3a.m1.5.5.1.1.2.cmml">,</mo><msubsup id="alg2.l3a.m1.5.5.1.1.1.1" xref="alg2.l3a.m1.5.5.1.1.1.1.cmml"><mi id="alg2.l3a.m1.5.5.1.1.1.1.2.2" xref="alg2.l3a.m1.5.5.1.1.1.1.2.2.cmml">w</mi><mi id="alg2.l3a.m1.5.5.1.1.1.1.3" xref="alg2.l3a.m1.5.5.1.1.1.1.3.cmml">t</mi><mi id="alg2.l3a.m1.5.5.1.1.1.1.2.3" xref="alg2.l3a.m1.5.5.1.1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg2.l3a.m1.5.5.1.1.1.4" xref="alg2.l3a.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="alg2.l3a.m1.6.6.3" xref="alg2.l3a.m1.6.6.3.cmml">=</mo><mrow id="alg2.l3a.m1.6.6.2" xref="alg2.l3a.m1.6.6.2.cmml"><mrow id="alg2.l3a.m1.6.6.2.1" xref="alg2.l3a.m1.6.6.2.1.cmml"><msub id="alg2.l3a.m1.6.6.2.1.2" xref="alg2.l3a.m1.6.6.2.1.2.cmml"><mo id="alg2.l3a.m1.6.6.2.1.2.2" xref="alg2.l3a.m1.6.6.2.1.2.2.cmml">∑</mo><mrow id="alg2.l3a.m1.6.6.2.1.2.3" xref="alg2.l3a.m1.6.6.2.1.2.3.cmml"><mi id="alg2.l3a.m1.6.6.2.1.2.3.2" xref="alg2.l3a.m1.6.6.2.1.2.3.2.cmml">e</mi><mo id="alg2.l3a.m1.6.6.2.1.2.3.1" xref="alg2.l3a.m1.6.6.2.1.2.3.1.cmml">∈</mo><msub id="alg2.l3a.m1.6.6.2.1.2.3.3" xref="alg2.l3a.m1.6.6.2.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3a.m1.6.6.2.1.2.3.3.2" xref="alg2.l3a.m1.6.6.2.1.2.3.3.2.cmml">ℰ</mi><mi id="alg2.l3a.m1.6.6.2.1.2.3.3.3" xref="alg2.l3a.m1.6.6.2.1.2.3.3.3.cmml">tr</mi></msub></mrow></msub><mrow id="alg2.l3a.m1.6.6.2.1.1" xref="alg2.l3a.m1.6.6.2.1.1.cmml"><msup id="alg2.l3a.m1.6.6.2.1.1.3" xref="alg2.l3a.m1.6.6.2.1.1.3.cmml"><mi id="alg2.l3a.m1.6.6.2.1.1.3.2" xref="alg2.l3a.m1.6.6.2.1.1.3.2.cmml">R</mi><mi id="alg2.l3a.m1.6.6.2.1.1.3.3" xref="alg2.l3a.m1.6.6.2.1.1.3.3.cmml">e</mi></msup><mo lspace="0em" rspace="0em" id="alg2.l3a.m1.6.6.2.1.1.2" xref="alg2.l3a.m1.6.6.2.1.1.2.cmml">​</mo><mrow id="alg2.l3a.m1.6.6.2.1.1.1.1" xref="alg2.l3a.m1.6.6.2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l3a.m1.6.6.2.1.1.1.1.2" xref="alg2.l3a.m1.6.6.2.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l3a.m1.6.6.2.1.1.1.1.1" xref="alg2.l3a.m1.6.6.2.1.1.1.1.1.cmml"><mi id="alg2.l3a.m1.6.6.2.1.1.1.1.1.2" xref="alg2.l3a.m1.6.6.2.1.1.1.1.1.2.cmml">w</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l3a.m1.6.6.2.1.1.1.1.1.1" xref="alg2.l3a.m1.6.6.2.1.1.1.1.1.1.cmml">∘</mo><mi mathvariant="normal" id="alg2.l3a.m1.6.6.2.1.1.1.1.1.3" xref="alg2.l3a.m1.6.6.2.1.1.1.1.1.3.cmml">Φ</mi></mrow><mo stretchy="false" id="alg2.l3a.m1.6.6.2.1.1.1.1.3" xref="alg2.l3a.m1.6.6.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg2.l3a.m1.6.6.2.2" xref="alg2.l3a.m1.6.6.2.2.cmml">+</mo><mrow id="alg2.l3a.m1.6.6.2.3" xref="alg2.l3a.m1.6.6.2.3.cmml"><mrow id="alg2.l3a.m1.6.6.2.3.2" xref="alg2.l3a.m1.6.6.2.3.2.cmml"><mi id="alg2.l3a.m1.6.6.2.3.2.2" xref="alg2.l3a.m1.6.6.2.3.2.2.cmml">λ</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l3a.m1.6.6.2.3.2.1" xref="alg2.l3a.m1.6.6.2.3.2.1.cmml">⋅</mo><mi id="alg2.l3a.m1.6.6.2.3.2.3" xref="alg2.l3a.m1.6.6.2.3.2.3.cmml">𝔻</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l3a.m1.6.6.2.3.1" xref="alg2.l3a.m1.6.6.2.3.1.cmml">​</mo><mrow id="alg2.l3a.m1.6.6.2.3.3.2" xref="alg2.l3a.m1.6.6.2.3.3.1.cmml"><mo stretchy="false" id="alg2.l3a.m1.6.6.2.3.3.2.1" xref="alg2.l3a.m1.6.6.2.3.3.1.cmml">(</mo><mi id="alg2.l3a.m1.2.2" xref="alg2.l3a.m1.2.2.cmml">w</mi><mo id="alg2.l3a.m1.6.6.2.3.3.2.2" xref="alg2.l3a.m1.6.6.2.3.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.l3a.m1.3.3" xref="alg2.l3a.m1.3.3.cmml">Φ</mi><mo id="alg2.l3a.m1.6.6.2.3.3.2.3" xref="alg2.l3a.m1.6.6.2.3.3.1.cmml">,</mo><mi id="alg2.l3a.m1.4.4" xref="alg2.l3a.m1.4.4.cmml">e</mi><mo stretchy="false" id="alg2.l3a.m1.6.6.2.3.3.2.4" xref="alg2.l3a.m1.6.6.2.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3a.m1.6b"><apply id="alg2.l3a.m1.6.6.cmml" xref="alg2.l3a.m1.6.6"><eq id="alg2.l3a.m1.6.6.3.cmml" xref="alg2.l3a.m1.6.6.3"></eq><apply id="alg2.l3a.m1.5.5.1.cmml" xref="alg2.l3a.m1.5.5.1"><times id="alg2.l3a.m1.5.5.1.2.cmml" xref="alg2.l3a.m1.5.5.1.2"></times><apply id="alg2.l3a.m1.5.5.1.3.cmml" xref="alg2.l3a.m1.5.5.1.3"><csymbol cd="ambiguous" id="alg2.l3a.m1.5.5.1.3.1.cmml" xref="alg2.l3a.m1.5.5.1.3">subscript</csymbol><ci id="alg2.l3a.m1.5.5.1.3.2.cmml" xref="alg2.l3a.m1.5.5.1.3.2">𝐿</ci><ci id="alg2.l3a.m1.5.5.1.3.3.cmml" xref="alg2.l3a.m1.5.5.1.3.3">IRM</ci></apply><interval closure="open" id="alg2.l3a.m1.5.5.1.1.2.cmml" xref="alg2.l3a.m1.5.5.1.1.1"><ci id="alg2.l3a.m1.1.1.cmml" xref="alg2.l3a.m1.1.1">Φ</ci><apply id="alg2.l3a.m1.5.5.1.1.1.1.cmml" xref="alg2.l3a.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3a.m1.5.5.1.1.1.1.1.cmml" xref="alg2.l3a.m1.5.5.1.1.1.1">subscript</csymbol><apply id="alg2.l3a.m1.5.5.1.1.1.1.2.cmml" xref="alg2.l3a.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3a.m1.5.5.1.1.1.1.2.1.cmml" xref="alg2.l3a.m1.5.5.1.1.1.1">superscript</csymbol><ci id="alg2.l3a.m1.5.5.1.1.1.1.2.2.cmml" xref="alg2.l3a.m1.5.5.1.1.1.1.2.2">𝑤</ci><ci id="alg2.l3a.m1.5.5.1.1.1.1.2.3.cmml" xref="alg2.l3a.m1.5.5.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg2.l3a.m1.5.5.1.1.1.1.3.cmml" xref="alg2.l3a.m1.5.5.1.1.1.1.3">𝑡</ci></apply></interval></apply><apply id="alg2.l3a.m1.6.6.2.cmml" xref="alg2.l3a.m1.6.6.2"><plus id="alg2.l3a.m1.6.6.2.2.cmml" xref="alg2.l3a.m1.6.6.2.2"></plus><apply id="alg2.l3a.m1.6.6.2.1.cmml" xref="alg2.l3a.m1.6.6.2.1"><apply id="alg2.l3a.m1.6.6.2.1.2.cmml" xref="alg2.l3a.m1.6.6.2.1.2"><csymbol cd="ambiguous" id="alg2.l3a.m1.6.6.2.1.2.1.cmml" xref="alg2.l3a.m1.6.6.2.1.2">subscript</csymbol><sum id="alg2.l3a.m1.6.6.2.1.2.2.cmml" xref="alg2.l3a.m1.6.6.2.1.2.2"></sum><apply id="alg2.l3a.m1.6.6.2.1.2.3.cmml" xref="alg2.l3a.m1.6.6.2.1.2.3"><in id="alg2.l3a.m1.6.6.2.1.2.3.1.cmml" xref="alg2.l3a.m1.6.6.2.1.2.3.1"></in><ci id="alg2.l3a.m1.6.6.2.1.2.3.2.cmml" xref="alg2.l3a.m1.6.6.2.1.2.3.2">𝑒</ci><apply id="alg2.l3a.m1.6.6.2.1.2.3.3.cmml" xref="alg2.l3a.m1.6.6.2.1.2.3.3"><csymbol cd="ambiguous" id="alg2.l3a.m1.6.6.2.1.2.3.3.1.cmml" xref="alg2.l3a.m1.6.6.2.1.2.3.3">subscript</csymbol><ci id="alg2.l3a.m1.6.6.2.1.2.3.3.2.cmml" xref="alg2.l3a.m1.6.6.2.1.2.3.3.2">ℰ</ci><ci id="alg2.l3a.m1.6.6.2.1.2.3.3.3.cmml" xref="alg2.l3a.m1.6.6.2.1.2.3.3.3">tr</ci></apply></apply></apply><apply id="alg2.l3a.m1.6.6.2.1.1.cmml" xref="alg2.l3a.m1.6.6.2.1.1"><times id="alg2.l3a.m1.6.6.2.1.1.2.cmml" xref="alg2.l3a.m1.6.6.2.1.1.2"></times><apply id="alg2.l3a.m1.6.6.2.1.1.3.cmml" xref="alg2.l3a.m1.6.6.2.1.1.3"><csymbol cd="ambiguous" id="alg2.l3a.m1.6.6.2.1.1.3.1.cmml" xref="alg2.l3a.m1.6.6.2.1.1.3">superscript</csymbol><ci id="alg2.l3a.m1.6.6.2.1.1.3.2.cmml" xref="alg2.l3a.m1.6.6.2.1.1.3.2">𝑅</ci><ci id="alg2.l3a.m1.6.6.2.1.1.3.3.cmml" xref="alg2.l3a.m1.6.6.2.1.1.3.3">𝑒</ci></apply><apply id="alg2.l3a.m1.6.6.2.1.1.1.1.1.cmml" xref="alg2.l3a.m1.6.6.2.1.1.1.1"><compose id="alg2.l3a.m1.6.6.2.1.1.1.1.1.1.cmml" xref="alg2.l3a.m1.6.6.2.1.1.1.1.1.1"></compose><ci id="alg2.l3a.m1.6.6.2.1.1.1.1.1.2.cmml" xref="alg2.l3a.m1.6.6.2.1.1.1.1.1.2">𝑤</ci><ci id="alg2.l3a.m1.6.6.2.1.1.1.1.1.3.cmml" xref="alg2.l3a.m1.6.6.2.1.1.1.1.1.3">Φ</ci></apply></apply></apply><apply id="alg2.l3a.m1.6.6.2.3.cmml" xref="alg2.l3a.m1.6.6.2.3"><times id="alg2.l3a.m1.6.6.2.3.1.cmml" xref="alg2.l3a.m1.6.6.2.3.1"></times><apply id="alg2.l3a.m1.6.6.2.3.2.cmml" xref="alg2.l3a.m1.6.6.2.3.2"><ci id="alg2.l3a.m1.6.6.2.3.2.1.cmml" xref="alg2.l3a.m1.6.6.2.3.2.1">⋅</ci><ci id="alg2.l3a.m1.6.6.2.3.2.2.cmml" xref="alg2.l3a.m1.6.6.2.3.2.2">𝜆</ci><ci id="alg2.l3a.m1.6.6.2.3.2.3.cmml" xref="alg2.l3a.m1.6.6.2.3.2.3">𝔻</ci></apply><vector id="alg2.l3a.m1.6.6.2.3.3.1.cmml" xref="alg2.l3a.m1.6.6.2.3.3.2"><ci id="alg2.l3a.m1.2.2.cmml" xref="alg2.l3a.m1.2.2">𝑤</ci><ci id="alg2.l3a.m1.3.3.cmml" xref="alg2.l3a.m1.3.3">Φ</ci><ci id="alg2.l3a.m1.4.4.cmml" xref="alg2.l3a.m1.4.4">𝑒</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3a.m1.6c">L_{\mathrm{IRM}}(\Phi,w^{k}_{t})=\sum_{e\in\mathcal{E}_{\mathrm{tr}}}R^{e}(w\circ\Phi)+\lambda\cdot\mathbb{D}(w,\Phi,e)</annotation></semantics></math>

</div>
<div id="alg2.l4a" class="ltx_listingline">     <math id="alg2.l4a.m1.1" class="ltx_Math" alttext="w^{k}_{t}=w^{k}_{t}-\eta\nabla L_{\mathrm{IRM}}(w^{k}_{t})" display="inline"><semantics id="alg2.l4a.m1.1a"><mrow id="alg2.l4a.m1.1.1" xref="alg2.l4a.m1.1.1.cmml"><msubsup id="alg2.l4a.m1.1.1.3" xref="alg2.l4a.m1.1.1.3.cmml"><mi id="alg2.l4a.m1.1.1.3.2.2" xref="alg2.l4a.m1.1.1.3.2.2.cmml">w</mi><mi id="alg2.l4a.m1.1.1.3.3" xref="alg2.l4a.m1.1.1.3.3.cmml">t</mi><mi id="alg2.l4a.m1.1.1.3.2.3" xref="alg2.l4a.m1.1.1.3.2.3.cmml">k</mi></msubsup><mo id="alg2.l4a.m1.1.1.2" xref="alg2.l4a.m1.1.1.2.cmml">=</mo><mrow id="alg2.l4a.m1.1.1.1" xref="alg2.l4a.m1.1.1.1.cmml"><msubsup id="alg2.l4a.m1.1.1.1.3" xref="alg2.l4a.m1.1.1.1.3.cmml"><mi id="alg2.l4a.m1.1.1.1.3.2.2" xref="alg2.l4a.m1.1.1.1.3.2.2.cmml">w</mi><mi id="alg2.l4a.m1.1.1.1.3.3" xref="alg2.l4a.m1.1.1.1.3.3.cmml">t</mi><mi id="alg2.l4a.m1.1.1.1.3.2.3" xref="alg2.l4a.m1.1.1.1.3.2.3.cmml">k</mi></msubsup><mo id="alg2.l4a.m1.1.1.1.2" xref="alg2.l4a.m1.1.1.1.2.cmml">−</mo><mrow id="alg2.l4a.m1.1.1.1.1" xref="alg2.l4a.m1.1.1.1.1.cmml"><mi id="alg2.l4a.m1.1.1.1.1.3" xref="alg2.l4a.m1.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg2.l4a.m1.1.1.1.1.2" xref="alg2.l4a.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l4a.m1.1.1.1.1.4" xref="alg2.l4a.m1.1.1.1.1.4.cmml"><mo rspace="0.167em" id="alg2.l4a.m1.1.1.1.1.4.1" xref="alg2.l4a.m1.1.1.1.1.4.1.cmml">∇</mo><msub id="alg2.l4a.m1.1.1.1.1.4.2" xref="alg2.l4a.m1.1.1.1.1.4.2.cmml"><mi id="alg2.l4a.m1.1.1.1.1.4.2.2" xref="alg2.l4a.m1.1.1.1.1.4.2.2.cmml">L</mi><mi id="alg2.l4a.m1.1.1.1.1.4.2.3" xref="alg2.l4a.m1.1.1.1.1.4.2.3.cmml">IRM</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg2.l4a.m1.1.1.1.1.2a" xref="alg2.l4a.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l4a.m1.1.1.1.1.1.1" xref="alg2.l4a.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l4a.m1.1.1.1.1.1.1.2" xref="alg2.l4a.m1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg2.l4a.m1.1.1.1.1.1.1.1" xref="alg2.l4a.m1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l4a.m1.1.1.1.1.1.1.1.2.2" xref="alg2.l4a.m1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg2.l4a.m1.1.1.1.1.1.1.1.3" xref="alg2.l4a.m1.1.1.1.1.1.1.1.3.cmml">t</mi><mi id="alg2.l4a.m1.1.1.1.1.1.1.1.2.3" xref="alg2.l4a.m1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg2.l4a.m1.1.1.1.1.1.1.3" xref="alg2.l4a.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4a.m1.1b"><apply id="alg2.l4a.m1.1.1.cmml" xref="alg2.l4a.m1.1.1"><eq id="alg2.l4a.m1.1.1.2.cmml" xref="alg2.l4a.m1.1.1.2"></eq><apply id="alg2.l4a.m1.1.1.3.cmml" xref="alg2.l4a.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4a.m1.1.1.3.1.cmml" xref="alg2.l4a.m1.1.1.3">subscript</csymbol><apply id="alg2.l4a.m1.1.1.3.2.cmml" xref="alg2.l4a.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4a.m1.1.1.3.2.1.cmml" xref="alg2.l4a.m1.1.1.3">superscript</csymbol><ci id="alg2.l4a.m1.1.1.3.2.2.cmml" xref="alg2.l4a.m1.1.1.3.2.2">𝑤</ci><ci id="alg2.l4a.m1.1.1.3.2.3.cmml" xref="alg2.l4a.m1.1.1.3.2.3">𝑘</ci></apply><ci id="alg2.l4a.m1.1.1.3.3.cmml" xref="alg2.l4a.m1.1.1.3.3">𝑡</ci></apply><apply id="alg2.l4a.m1.1.1.1.cmml" xref="alg2.l4a.m1.1.1.1"><minus id="alg2.l4a.m1.1.1.1.2.cmml" xref="alg2.l4a.m1.1.1.1.2"></minus><apply id="alg2.l4a.m1.1.1.1.3.cmml" xref="alg2.l4a.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4a.m1.1.1.1.3.1.cmml" xref="alg2.l4a.m1.1.1.1.3">subscript</csymbol><apply id="alg2.l4a.m1.1.1.1.3.2.cmml" xref="alg2.l4a.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4a.m1.1.1.1.3.2.1.cmml" xref="alg2.l4a.m1.1.1.1.3">superscript</csymbol><ci id="alg2.l4a.m1.1.1.1.3.2.2.cmml" xref="alg2.l4a.m1.1.1.1.3.2.2">𝑤</ci><ci id="alg2.l4a.m1.1.1.1.3.2.3.cmml" xref="alg2.l4a.m1.1.1.1.3.2.3">𝑘</ci></apply><ci id="alg2.l4a.m1.1.1.1.3.3.cmml" xref="alg2.l4a.m1.1.1.1.3.3">𝑡</ci></apply><apply id="alg2.l4a.m1.1.1.1.1.cmml" xref="alg2.l4a.m1.1.1.1.1"><times id="alg2.l4a.m1.1.1.1.1.2.cmml" xref="alg2.l4a.m1.1.1.1.1.2"></times><ci id="alg2.l4a.m1.1.1.1.1.3.cmml" xref="alg2.l4a.m1.1.1.1.1.3">𝜂</ci><apply id="alg2.l4a.m1.1.1.1.1.4.cmml" xref="alg2.l4a.m1.1.1.1.1.4"><ci id="alg2.l4a.m1.1.1.1.1.4.1.cmml" xref="alg2.l4a.m1.1.1.1.1.4.1">∇</ci><apply id="alg2.l4a.m1.1.1.1.1.4.2.cmml" xref="alg2.l4a.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="alg2.l4a.m1.1.1.1.1.4.2.1.cmml" xref="alg2.l4a.m1.1.1.1.1.4.2">subscript</csymbol><ci id="alg2.l4a.m1.1.1.1.1.4.2.2.cmml" xref="alg2.l4a.m1.1.1.1.1.4.2.2">𝐿</ci><ci id="alg2.l4a.m1.1.1.1.1.4.2.3.cmml" xref="alg2.l4a.m1.1.1.1.1.4.2.3">IRM</ci></apply></apply><apply id="alg2.l4a.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l4a.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4a.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l4a.m1.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l4a.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l4a.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4a.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l4a.m1.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l4a.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l4a.m1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="alg2.l4a.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l4a.m1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg2.l4a.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l4a.m1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4a.m1.1c">w^{k}_{t}=w^{k}_{t}-\eta\nabla L_{\mathrm{IRM}}(w^{k}_{t})</annotation></semantics></math>

</div>
<div id="alg2.l5a" class="ltx_listingline">  <span id="alg2.l5a.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l5a.1" class="ltx_text ltx_font_bold">for<span id="alg2.l5a.1.1" class="ltx_text ltx_markedasmath ltx_font_medium">return w to server</span></span>

</div>
</div>
</div>
</div>
</figure>
<figure id="A1.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Train Results</figcaption>
<table id="A1.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T5.1.1.1" class="ltx_tr">
<th id="A1.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T5.1.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="A1.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T5.1.1.1.2.1" class="ltx_text ltx_font_bold">Arch</span></th>
<th id="A1.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T5.1.1.1.3.1" class="ltx_text ltx_font_bold">Fed-Avg</span></th>
<th id="A1.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T5.1.1.1.4.1" class="ltx_text ltx_font_bold">Fed-ERM</span></th>
<th id="A1.T5.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T5.1.1.1.5.1" class="ltx_text ltx_font_bold">CausalFedGSD-RM</span></th>
<th id="A1.T5.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T5.1.1.1.6.1" class="ltx_text ltx_font_bold">CausalFedGSD-IRM</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T5.1.2.1" class="ltx_tr">
<td id="A1.T5.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">Colored MNIST</td>
<td id="A1.T5.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">ResNet18</td>
<td id="A1.T5.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">80.3%</td>
<td id="A1.T5.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t">
<span id="A1.T5.1.2.1.4.1" class="ltx_text ltx_font_bold">82.97</span> %</td>
<td id="A1.T5.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t">57.42 %</td>
<td id="A1.T5.1.2.1.6" class="ltx_td ltx_align_left ltx_border_t">55.32 %</td>
</tr>
<tr id="A1.T5.1.3.2" class="ltx_tr">
<td id="A1.T5.1.3.2.1" class="ltx_td ltx_align_left ltx_border_t">Rotated MNIST</td>
<td id="A1.T5.1.3.2.2" class="ltx_td ltx_align_left ltx_border_t">ResNet18</td>
<td id="A1.T5.1.3.2.3" class="ltx_td ltx_align_left ltx_border_t">85.2%</td>
<td id="A1.T5.1.3.2.4" class="ltx_td ltx_align_left ltx_border_t">
<span id="A1.T5.1.3.2.4.1" class="ltx_text ltx_font_bold">86.5</span> %</td>
<td id="A1.T5.1.3.2.5" class="ltx_td ltx_align_left ltx_border_t">73.7 %</td>
<td id="A1.T5.1.3.2.6" class="ltx_td ltx_align_left ltx_border_t">77.2 %</td>
</tr>
<tr id="A1.T5.1.4.3" class="ltx_tr">
<td id="A1.T5.1.4.3.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">Rotated FMNIST</td>
<td id="A1.T5.1.4.3.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">LeNet</td>
<td id="A1.T5.1.4.3.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">81.4%</td>
<td id="A1.T5.1.4.3.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">
<span id="A1.T5.1.4.3.4.1" class="ltx_text ltx_font_bold">82.3</span> %</td>
<td id="A1.T5.1.4.3.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">69.2 %</td>
<td id="A1.T5.1.4.3.6" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">68.6 %</td>
</tr>
</tbody>
</table>
</figure>
<figure id="A1.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Test Results</figcaption>
<table id="A1.T6.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T6.1.1.1" class="ltx_tr">
<th id="A1.T6.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T6.1.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="A1.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T6.1.1.1.2.1" class="ltx_text ltx_font_bold">Arch</span></th>
<th id="A1.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T6.1.1.1.3.1" class="ltx_text ltx_font_bold">Fed-Avg</span></th>
<th id="A1.T6.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T6.1.1.1.4.1" class="ltx_text ltx_font_bold">Fed-ERM</span></th>
<th id="A1.T6.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T6.1.1.1.5.1" class="ltx_text ltx_font_bold">CausalFedGSD-RM</span></th>
<th id="A1.T6.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="A1.T6.1.1.1.6.1" class="ltx_text ltx_font_bold">CausalFedGSD-IRM</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T6.1.2.1" class="ltx_tr">
<td id="A1.T6.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">Colored MNIST</td>
<td id="A1.T6.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">ResNet18</td>
<td id="A1.T6.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">11%</td>
<td id="A1.T6.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t">10.2 %</td>
<td id="A1.T6.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t">
<span id="A1.T6.1.2.1.5.1" class="ltx_text ltx_font_bold">55.62</span> %</td>
<td id="A1.T6.1.2.1.6" class="ltx_td ltx_align_left ltx_border_t">52.3 %</td>
</tr>
<tr id="A1.T6.1.3.2" class="ltx_tr">
<td id="A1.T6.1.3.2.1" class="ltx_td ltx_align_left ltx_border_t">Rotated MNIST</td>
<td id="A1.T6.1.3.2.2" class="ltx_td ltx_align_left ltx_border_t">ResNet18</td>
<td id="A1.T6.1.3.2.3" class="ltx_td ltx_align_left ltx_border_t">82.7%</td>
<td id="A1.T6.1.3.2.4" class="ltx_td ltx_align_left ltx_border_t">82.9 %</td>
<td id="A1.T6.1.3.2.5" class="ltx_td ltx_align_left ltx_border_t">
<span id="A1.T6.1.3.2.5.1" class="ltx_text ltx_font_bold">85.2</span> %</td>
<td id="A1.T6.1.3.2.6" class="ltx_td ltx_align_left ltx_border_t">83.1 %</td>
</tr>
<tr id="A1.T6.1.4.3" class="ltx_tr">
<td id="A1.T6.1.4.3.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">Rotated FMNIST</td>
<td id="A1.T6.1.4.3.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">LeNet</td>
<td id="A1.T6.1.4.3.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">72%</td>
<td id="A1.T6.1.4.3.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">71.6 %</td>
<td id="A1.T6.1.4.3.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">
<span id="A1.T6.1.4.3.5.1" class="ltx_text ltx_font_bold">71.9</span> %</td>
<td id="A1.T6.1.4.3.6" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">70.2 %</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2104.06556" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2104.06557" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2104.06557">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2104.06557" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2104.06558" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Mar 17 02:29:03 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
