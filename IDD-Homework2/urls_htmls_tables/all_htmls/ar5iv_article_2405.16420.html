<article class="ltx_document ltx_authors_1line">
 <h1 class="ltx_title ltx_title_document">
  M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Zheng Wang
    <sup class="ltx_sup" id="id1.1.id1">
     1
    </sup>
    , Shu Xian Teo
    <sup class="ltx_sup" id="id2.2.id2">
     1
    </sup>
    , Jieer Ouyang
    <sup class="ltx_sup" id="id3.3.id3">
     1
    </sup>
    , Yongjun Xu
    <sup class="ltx_sup" id="id4.4.id4">
     1
    </sup>
    , Wei Shi
    <sup class="ltx_sup" id="id5.5.id5">
     1
    </sup>
    <br class="ltx_break"/>
    <sup class="ltx_sup" id="id6.6.id6">
     1
    </sup>
    Huawei Technologies, Co., Ltd.
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id7.7.id7">
     {wangzheng155,teo.shu.xian,ouyang.jieer,xuyongjun6,w.shi}@huawei.com
    </span>
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id8.id1">
   Retrieval-Augmented Generation (RAG) enhances Large Language Models (LLMs) by retrieving relevant memories from an external database. However, existing RAG methods typically organize all memories in a whole database, potentially limiting focus on crucial memories and introducing noise. In this paper, we introduce a multiple partition paradigm for RAG (called
   <span class="ltx_text ltx_font_typewriter" id="id8.id1.1">
    M-RAG
   </span>
   ), where each database partition serves as a basic unit for RAG execution. Based on this paradigm, we propose a novel framework that leverages LLMs with Multi-Agent Reinforcement Learning to optimize different language generation tasks explicitly. Through comprehensive experiments conducted on seven datasets, spanning three language generation tasks and involving three distinct language model architectures, we confirm that
   <span class="ltx_text ltx_font_typewriter" id="id8.id1.2">
    M-RAG
   </span>
   consistently outperforms various baseline methods, achieving improvements of 11%, 8%, and 12% for text summarization, machine translation, and dialogue generation, respectively.
  </p>
 </div>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <div class="ltx_para" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    Introduced by
    <cite class="ltx_cite ltx_citemacro_cite">
     Lewis et al. (
     <a class="ltx_ref" href="#bib.bib26" title="">
      2020
     </a>
     )
    </cite>
    , Retrieval-Augmented Generation (RAG) represents a paradigm within the domain of Large Language Models (LLMs) to augment generative tasks. More specifically, RAG incorporates an initial retrieval step where LLMs query an external database to acquire relevant information before progressing to answer questions or generate text. This process not only guides the subsequent generation step but also guarantees that the responses are firmly anchored in the retrieved information (referred to as memories). Consequently, it enhances LLM performance, and has attracted growing research interests
    <cite class="ltx_cite ltx_citemacro_cite">
     Gao et al. (
     <a class="ltx_ref" href="#bib.bib11" title="">
      2023
     </a>
     )
    </cite>
    in recent years.
   </p>
  </div>
  <div class="ltx_para" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    While the majority of existing studies
    <cite class="ltx_cite ltx_citemacro_cite">
     Asai et al. (
     <a class="ltx_ref" href="#bib.bib3" title="">
      2023
     </a>
     ); Cheng et al. (
     <a class="ltx_ref" href="#bib.bib8" title="">
      2023b
     </a>
     ); Ma et al. (
     <a class="ltx_ref" href="#bib.bib34" title="">
      2023
     </a>
     )
    </cite>
    adopt a retrieval approach that considers
    <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">
     a database as a whole
    </em>
    , which tends to yield a coarse-grained retrieval. The collective organization of all memories may hinder the focus on crucial memories and introduce noise, particularly due to the inherent challenges of Approximate k-Nearest Neighbor (AKNN) search when applied to large datasets. In this context, we investigate a retrieval approach that aims to search within a partition of the database, corresponding retrieval at a fine-grained level, which is designed to enhance the generation process by targeting specific memories.
Moreover, in quite a few vector database systems, database partitions are regarded as fundamental units for analysis. This facilitates the construction and maintenance of index structures
    <cite class="ltx_cite ltx_citemacro_cite">
     Pan et al. (
     <a class="ltx_ref" href="#bib.bib43" title="">
      2023
     </a>
     )
    </cite>
    , ensures the protection of user privacy data (stored in specific partitions with access rights)
    <cite class="ltx_cite ltx_citemacro_cite">
     Xue et al. (
     <a class="ltx_ref" href="#bib.bib59" title="">
      2017
     </a>
     )
    </cite>
    , and supports distributed architectures
    <cite class="ltx_cite ltx_citemacro_cite">
     Guo et al. (
     <a class="ltx_ref" href="#bib.bib14" title="">
      2022
     </a>
     )
    </cite>
    . Therefore, in this work, we propose to take
    <em class="ltx_emph ltx_font_italic" id="S1.p2.1.2">
     a partition as a basic entity
    </em>
    in the execution of RAG, which is less explored in current methods.
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F1">
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S1.F1.4">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="S1.F1.4.4">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row" id="S1.F1.1.1.1">
       <span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S1.F1.1.1.1.1" style="width:104.1pt;">
        <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="343" id="S1.F1.1.1.1.1.g1" src="/html/2405.16420/assets/x1.png" width="461"/>
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S1.F1.2.2.2">
       <span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S1.F1.2.2.2.1" style="width:104.1pt;">
        <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="337" id="S1.F1.2.2.2.1.g1" src="/html/2405.16420/assets/x2.png" width="461"/>
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S1.F1.3.3.3">
       <span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S1.F1.3.3.3.1" style="width:104.1pt;">
        <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="333" id="S1.F1.3.3.3.1.g1" src="/html/2405.16420/assets/x3.png" width="461"/>
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S1.F1.4.4.4">
       <span class="ltx_inline-block ltx_minipage ltx_align_middle" id="S1.F1.4.4.4.1" style="width:104.1pt;">
        <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="345" id="S1.F1.4.4.4.1.g1" src="/html/2405.16420/assets/x4.png" width="461"/>
       </span>
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="S1.F1.4.5.1">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S1.F1.4.5.1.1">
       (a) Summ. (ROUGE-1)
      </th>
      <td class="ltx_td ltx_align_center" id="S1.F1.4.5.1.2">
       (b) Summ. (Runtime)
      </td>
      <td class="ltx_td ltx_align_center" id="S1.F1.4.5.1.3">
       (c) Machine translation
      </td>
      <td class="ltx_td ltx_align_center" id="S1.F1.4.5.1.4">
       (d) Dialogue generation
      </td>
     </tr>
    </tbody>
   </table>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 1:
    </span>
    Comparison with database partitioning strategies for language generation tasks.
   </figcaption>
  </figure>
  <div class="ltx_para" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    We discuss our proposal with a motivating experiment illustrated in Figure
    <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    . We investigate various strategies for partitioning a database (elaborated in Section
    <a class="ltx_ref" href="#S3.SS1" title="3.1 Discussion on Partitioning a Database ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      3.1
     </span>
    </a>
    ), and perform RAG with varying the number of partitions for three generation tasks: summarization, translation, and dialogue generation, where we explore all partitions for the retrieval, and the best result (assessed based on a development set) across different partitions is reported. We observe that the optimal performance is typically not achieved through retrieval based on the entire database (#Partitions
    <math alttext="=1" class="ltx_Math" display="inline" id="S1.p3.1.m1.1">
     <semantics id="S1.p3.1.m1.1a">
      <mrow id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">
       <mi id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">
       </mi>
       <mo id="S1.p3.1.m1.1.1.1" xref="S1.p3.1.m1.1.1.1.cmml">
        =
       </mo>
       <mn id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">
        1
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b">
       <apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">
        <eq id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1.1">
        </eq>
        <csymbol cd="latexml" id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">
         absent
        </csymbol>
        <cn id="S1.p3.1.m1.1.1.3.cmml" type="integer" xref="S1.p3.1.m1.1.1.3">
         1
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">
       =1
      </annotation>
     </semantics>
    </math>
    ). This observation inspires us to investigate a novel RAG setting with multiple partitions. To achieve this, the task should address three significant challenges, summarized below. (1) Determining a strategy for partitioning a database and the number of partitions. (2) Developing a method for selecting a suitable partition for a given input query to discover effective memories. (3) Enhancing memory quality, including inherent issues such as hallucination, or irrelevant context, which can impact the grounding of LLM generation.
   </p>
  </div>
  <div class="ltx_para" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    Building upon the aforementioned discussion, we introduce a new solution called
    <span class="ltx_text ltx_font_typewriter" id="S1.p4.1.1">
     M-RAG
    </span>
    , designed to facilitate RAG across multiple partitions of a database.
    <span class="ltx_text ltx_font_typewriter" id="S1.p4.1.2">
     M-RAG
    </span>
    addresses all of the three challenges. For (1), we draw insights from the literature on vector database management
    <cite class="ltx_cite ltx_citemacro_cite">
     Pan et al. (
     <a class="ltx_ref" href="#bib.bib43" title="">
      2023
     </a>
     ); Han et al. (
     <a class="ltx_ref" href="#bib.bib15" title="">
      2023
     </a>
     )
    </cite>
    and assess various strategies, namely Randomization
    <cite class="ltx_cite ltx_citemacro_cite">
     Indyk and Motwani (
     <a class="ltx_ref" href="#bib.bib17" title="">
      1998
     </a>
     )
    </cite>
    , Clustering
    <cite class="ltx_cite ltx_citemacro_cite">
     Jegou et al. (
     <a class="ltx_ref" href="#bib.bib19" title="">
      2010
     </a>
     )
    </cite>
    , Indexing
    <cite class="ltx_cite ltx_citemacro_cite">
     Malkov et al. (
     <a class="ltx_ref" href="#bib.bib36" title="">
      2014
     </a>
     ); Malkov and Yashunin (
     <a class="ltx_ref" href="#bib.bib35" title="">
      2018
     </a>
     )
    </cite>
    , and Category
    <cite class="ltx_cite ltx_citemacro_cite">
     Gollapudi et al. (
     <a class="ltx_ref" href="#bib.bib12" title="">
      2023
     </a>
     )
    </cite>
    , through empirical studies. The effectiveness of these strategies, along with the corresponding number of partitions, is evaluated across different generative tasks on a development set in our experiments. For (2), with multiple partitions at play, we formulate partition selection as a multi-armed bandit problem
    <cite class="ltx_cite ltx_citemacro_cite">
     Slivkins et al. (
     <a class="ltx_ref" href="#bib.bib46" title="">
      2019
     </a>
     )
    </cite>
    . In this context, an agent, denoted as Agent-S, iteratively selects one among several partitions. The characteristics of each partition are only partially known at the time of selection, and Agent-S gains a better understanding over time by maximizing cumulative rewards in the environment. To optimize the decision policy, we leverage reinforcement learning with a carefully designed Markov Decision Process (MDP). For (3), after selecting a partition and obtaining memories for generation, we introduce another agent, denoted as Agent-R. This agent generates a pool of candidate memories iteratively through the use of LLMs. Once a candidate is selected, Agent-R evaluates its quality by demonstrating it to generate a hypothesis. The identification of a high-quality hypothesis determined by a specific performance metric, triggers a boosting process, where it signals the exploration and replacement of the previous memory with a superior one, and continues the process. Further, we integrate the efforts of Agent-S and Agent-R through multi-agent reinforcement learning. With a shared objective of enhancing text generation for a given input query, they are jointly optimized through end-to-end training.
   </p>
  </div>
  <div class="ltx_para" id="S1.p5">
   <p class="ltx_p" id="S1.p5.1">
    Our contributions can be summarized as follows: (1) we propose a multiple partition paradigm for RAG, aiming to facilitate fine-grained retrieval and concentrate on pivotal memories to enhance overall performance. In addition, the utilization of multiple partitions benefits other aspects of RAG, including facilitating the construction and maintenance of indices, protecting user privacy data within specific partitions, and supporting distributed parallel processing across different partitions. (2) We introduce
    <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.1">
     M-RAG
    </span>
    , a new solution based on multi-agent reinforcement learning that tackles the three challenges in executing RAG across multiple partitions. We show that the training objective of
    <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.2">
     M-RAG
    </span>
    is well aligned with that of text generation tasks. (3) We conduct extensive experiments on
    <em class="ltx_emph ltx_font_italic" id="S1.p5.1.3">
     seven
    </em>
    datasets for
    <em class="ltx_emph ltx_font_italic" id="S1.p5.1.4">
     three
    </em>
    generation tasks on
    <em class="ltx_emph ltx_font_italic" id="S1.p5.1.5">
     three
    </em>
    distinct language model architectures, including a recent Mixture of Experts (MoE) architecture
    <cite class="ltx_cite ltx_citemacro_cite">
     Jiang et al. (
     <a class="ltx_ref" href="#bib.bib21" title="">
      2024
     </a>
     )
    </cite>
    . The results demonstrate the effectiveness of
    <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.6">
     M-RAG
    </span>
    across diverse RAG baselines. In comparison to the best baseline approach,
    <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.7">
     M-RAG
    </span>
    exhibits improvements of 11%, 8%, and 12% for text summarization, machine translation, and dialogue generation tasks, respectively.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Related Work
  </h2>
  <div class="ltx_para" id="S2.p1">
   <p class="ltx_p" id="S2.p1.1">
    <span class="ltx_text ltx_font_bold" id="S2.p1.1.1">
     Retrieval-Augmented Generation.
    </span>
    We review the literature of Retrieval-Augmented Generation (RAG) in terms of (1) Naive RAG, (2) Advanced RAG, and (3) Modular RAG.
For (1), Naive RAG follows a standard process including indexing, retrieval, and generation
    <cite class="ltx_cite ltx_citemacro_cite">
     Ma et al. (
     <a class="ltx_ref" href="#bib.bib34" title="">
      2023
     </a>
     )
    </cite>
    . However, its quality faces significant challenges such as low precision, hallucination, and redundancy during the process.
For (2), Advanced RAG is further developed to overcome the shortcomings of Naive RAG. Specifically, during the indexing stage, the objective is to enhance the quality of the indexed content by optimizing data embedding
    <cite class="ltx_cite ltx_citemacro_cite">
     Li et al. (
     <a class="ltx_ref" href="#bib.bib29" title="">
      2023
     </a>
     )
    </cite>
    . During the retrieval stage, the focus is on identifying the appropriate context by calculating the similarity between the query and chunks, where the techniques involve fine-tuning embedding models
    <cite class="ltx_cite ltx_citemacro_cite">
     Xiao et al. (
     <a class="ltx_ref" href="#bib.bib57" title="">
      2023
     </a>
     )
    </cite>
    , or learning dynamic embeddings for different context
    <cite class="ltx_cite ltx_citemacro_cite">
     Karpukhin et al. (
     <a class="ltx_ref" href="#bib.bib23" title="">
      2020
     </a>
     )
    </cite>
    . During the generation stage, it merges the retrieved context with the query as an input into large language models (LLMs), where it addresses challenges posed by context window limits with re-ranking the most relevant content
    <cite class="ltx_cite ltx_citemacro_cite">
     Jiang et al. (
     <a class="ltx_ref" href="#bib.bib22" title="">
      2023b
     </a>
     ); Zhuang et al. (
     <a class="ltx_ref" href="#bib.bib61" title="">
      2023
     </a>
     )
    </cite>
    , or compressing prompts
    <cite class="ltx_cite ltx_citemacro_cite">
     Litman et al. (
     <a class="ltx_ref" href="#bib.bib33" title="">
      2020
     </a>
     ); Xu et al. (
     <a class="ltx_ref" href="#bib.bib58" title="">
      2023
     </a>
     )
    </cite>
    . In addition, Self-RAG
    <cite class="ltx_cite ltx_citemacro_cite">
     Asai et al. (
     <a class="ltx_ref" href="#bib.bib3" title="">
      2023
     </a>
     )
    </cite>
    is proposed to identify whether retrieval is necessary, or the retrieved context is relevant, which helps language models to produce meaningful generation
    <cite class="ltx_cite ltx_citemacro_cite">
     Asai et al. (
     <a class="ltx_ref" href="#bib.bib3" title="">
      2023
     </a>
     )
    </cite>
    .
For (3), Modular RAG diverges from the traditional Naive RAG structure by incorporating external modules to further enhance the performance, including search module
    <cite class="ltx_cite ltx_citemacro_cite">
     Wang et al. (
     <a class="ltx_ref" href="#bib.bib50" title="">
      2023a
     </a>
     )
    </cite>
    , memory module
    <cite class="ltx_cite ltx_citemacro_cite">
     Wang et al. (
     <a class="ltx_ref" href="#bib.bib49" title="">
      2022
     </a>
     ); Cheng et al. (
     <a class="ltx_ref" href="#bib.bib8" title="">
      2023b
     </a>
     )
    </cite>
    , tuning module
    <cite class="ltx_cite ltx_citemacro_cite">
     Lin et al. (
     <a class="ltx_ref" href="#bib.bib32" title="">
      2023
     </a>
     )
    </cite>
    , and task adapter
    <cite class="ltx_cite ltx_citemacro_cite">
     Cheng et al. (
     <a class="ltx_ref" href="#bib.bib7" title="">
      2023a
     </a>
     ); Dai et al. (
     <a class="ltx_ref" href="#bib.bib10" title="">
      2023
     </a>
     )
    </cite>
    . Specifically, Selfmem
    <cite class="ltx_cite ltx_citemacro_cite">
     Cheng et al. (
     <a class="ltx_ref" href="#bib.bib8" title="">
      2023b
     </a>
     )
    </cite>
    incorporates a retrieval-enhanced generator to iteratively create a memory pool, it then trains a selector to choose one of the memories from the pool to generate responses.
The work
    <cite class="ltx_cite ltx_citemacro_cite">
     Gao et al. (
     <a class="ltx_ref" href="#bib.bib11" title="">
      2023
     </a>
     )
    </cite>
    provides a comprehensive survey of RAG for LLMs. Our work differs from existing RAG studies in two aspects. First, we introduce a multiple partition setting, where each partition serves as a fundamental entity for retrieval, rather than retrieving from the entire database. Second, we introduce an
    <span class="ltx_text ltx_font_typewriter" id="S2.p1.1.2">
     M-RAG
    </span>
    framework built upon multi-agent reinforcement learning, which tackles three distinct challenges posed by this novel setting.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S2.p2">
   <p class="ltx_p" id="S2.p2.1">
    <span class="ltx_text ltx_font_bold" id="S2.p2.1.1">
     Reinforcement Learning for LLMs.
    </span>
    Recently, reinforcement learning has seen broad applications across a variety of language-related tasks for Large Language Models (LLMs). This includes tasks such as text summarization
    <cite class="ltx_cite ltx_citemacro_cite">
     Wu et al. (
     <a class="ltx_ref" href="#bib.bib54" title="">
      2021a
     </a>
     )
    </cite>
    , machine translation
    <cite class="ltx_cite ltx_citemacro_cite">
     Kreutzer et al. (
     <a class="ltx_ref" href="#bib.bib24" title="">
      2018
     </a>
     )
    </cite>
    , dialogue systems
    <cite class="ltx_cite ltx_citemacro_cite">
     Jaques et al. (
     <a class="ltx_ref" href="#bib.bib18" title="">
      2019
     </a>
     ); Yi et al. (
     <a class="ltx_ref" href="#bib.bib60" title="">
      2019
     </a>
     )
    </cite>
    , semantic parsing
    <cite class="ltx_cite ltx_citemacro_cite">
     Lawrence and Riezler (
     <a class="ltx_ref" href="#bib.bib25" title="">
      2018
     </a>
     )
    </cite>
    , and review generation
    <cite class="ltx_cite ltx_citemacro_cite">
     Cho et al. (
     <a class="ltx_ref" href="#bib.bib9" title="">
      2018
     </a>
     )
    </cite>
    . For example, WebGPT
    <cite class="ltx_cite ltx_citemacro_cite">
     Nakano et al. (
     <a class="ltx_ref" href="#bib.bib39" title="">
      2021
     </a>
     )
    </cite>
    incorporates a reinforcement learning framework to autonomously train the GPT-3 model using a search engine during the text generation process. Further, InstructGPT
    <cite class="ltx_cite ltx_citemacro_cite">
     Ouyang et al. (
     <a class="ltx_ref" href="#bib.bib42" title="">
      2022
     </a>
     )
    </cite>
    collects a dataset containing desired model outputs provided by human labelers. Subsequently, it employs Reinforcement Learning from Human Feedback (RLHF) to fine-tune GPT-3
    <cite class="ltx_cite ltx_citemacro_cite">
     Brown et al. (
     <a class="ltx_ref" href="#bib.bib5" title="">
      2020
     </a>
     )
    </cite>
    . In addition, R3
    <cite class="ltx_cite ltx_citemacro_cite">
     Ma et al. (
     <a class="ltx_ref" href="#bib.bib34" title="">
      2023
     </a>
     )
    </cite>
    introduces a Rewrite-Retrieve-Read process, where the LLM performance serves as a reinforcement learning incentive for a rewriting module. This approach empowers the rewriter to enhance retrieval queries, consequently improving the reader’s performance in downstream tasks. MMQS
    <cite class="ltx_cite ltx_citemacro_cite">
     Wang et al. (
     <a class="ltx_ref" href="#bib.bib51" title="">
      2024
     </a>
     )
    </cite>
    introduces a new multimodal question suggestion task with a multi-agent version of RLHF.
In this work, we propose a novel multi-agent reinforcement learning framework utilizing two agents to collaboratively optimize text generation tasks. To our best knowledge, this is the first of its kind.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S2.p3">
   <p class="ltx_p" id="S2.p3.1">
    <span class="ltx_text ltx_font_bold" id="S2.p3.1.1">
     Multi-source Knowledge-grounded Dialogue System (MKDS).
    </span>
    We review the literature on MKDS
    <cite class="ltx_cite ltx_citemacro_cite">
     Wu et al. (
     <a class="ltx_ref" href="#bib.bib55" title="">
      2021b
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib56" title="">
      2022
     </a>
     )
    </cite>
    , and highlight differences with our
    <span class="ltx_text ltx_font_typewriter" id="S2.p3.1.2">
     M-RAG
    </span>
    regarding (1) datasets, (2) solutions, and (3) tasks. For (1), MKDS uses multi-source heterogeneous data (plain text, tables, knowledge graphs), each contributing uniquely to dialogue generation.
    <span class="ltx_text ltx_font_typewriter" id="S2.p3.1.3">
     M-RAG
    </span>
    uses a single-source homogeneous dataset, initially vectorized and indexed for RAG retrieval. We explore partitioning strategies to create multiple homogeneous partitions for effective retrieval. For (2), MKDS employs an encoder-decoder framework with varied attention weights for different knowledge sources, trained with a small dialogue model like MSKE-Dialog (59.14M parameters)
    <cite class="ltx_cite ltx_citemacro_cite">
     Wu et al. (
     <a class="ltx_ref" href="#bib.bib55" title="">
      2021b
     </a>
     )
    </cite>
    .
    <span class="ltx_text ltx_font_typewriter" id="S2.p3.1.4">
     M-RAG
    </span>
    uses a Retrieval-then-Generation approach with two RL agents (Agent-S and Agent-R) focusing on retrieval and generation, respectively. For (3),
    <span class="ltx_text ltx_font_typewriter" id="S2.p3.1.5">
     M-RAG
    </span>
    leverages LLMs for diverse language generation tasks, including text summarization, machine translation, and dialogue generation, unlike MKDS’s specific focus on dialogue generation
    <cite class="ltx_cite ltx_citemacro_cite">
     Wu et al. (
     <a class="ltx_ref" href="#bib.bib55" title="">
      2021b
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib56" title="">
      2022
     </a>
     )
    </cite>
    .
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Methodology
  </h2>
  <figure class="ltx_figure" id="S3.F2">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="122" id="S3.F2.g1" src="/html/2405.16420/assets/x5.png" width="461"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 2:
    </span>
    Illustration of
    <span class="ltx_text ltx_font_typewriter" id="S3.F2.3.1">
     M-RAG
    </span>
    training in a summarization task: The
    <span class="ltx_text ltx_font_typewriter" id="S3.F2.4.2">
     M-RAG
    </span>
    initiates training with multiple partitions (Section
    <a class="ltx_ref" href="#S3.SS1" title="3.1 Discussion on Partitioning a Database ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      3.1
     </span>
    </a>
    ), it then selects a partition to perform retrieval via Agent-S (Section
    <a class="ltx_ref" href="#S3.SS2" title="3.2 Agent-S: Selecting a Database Partition ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      3.2
     </span>
    </a>
    ), and refines the memories within the selected partition via Agent-R (Section
    <a class="ltx_ref" href="#S3.SS3" title="3.3 Agent-R: Refining Memories in the Selected Partition ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      3.3
     </span>
    </a>
    ). Both agents are collaboratively trained to enhance generation capabilities through multi-agent reinforcement learning (Section
    <a class="ltx_ref" href="#S3.SS4" title="3.4 The M-RAG Framework ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      3.4
     </span>
    </a>
    ). For inference, it includes elements (1), (2), (3), (4), (11), and (12).
   </figcaption>
  </figure>
  <div class="ltx_para" id="S3.p1">
   <p class="ltx_p" id="S3.p1.12">
    A task involving
    <span class="ltx_text ltx_font_typewriter" id="S3.p1.12.1">
     M-RAG
    </span>
    can be formulated below. Given a database
    <math alttext="\mathbb{D}=\{(x_{i},y_{i})\}_{i=1}^{|\mathbb{D}|}" class="ltx_Math" display="inline" id="S3.p1.1.m1.2">
     <semantics id="S3.p1.1.m1.2a">
      <mrow id="S3.p1.1.m1.2.2" xref="S3.p1.1.m1.2.2.cmml">
       <mi id="S3.p1.1.m1.2.2.3" xref="S3.p1.1.m1.2.2.3.cmml">
        𝔻
       </mi>
       <mo id="S3.p1.1.m1.2.2.2" xref="S3.p1.1.m1.2.2.2.cmml">
        =
       </mo>
       <msubsup id="S3.p1.1.m1.2.2.1" xref="S3.p1.1.m1.2.2.1.cmml">
        <mrow id="S3.p1.1.m1.2.2.1.1.1.1" xref="S3.p1.1.m1.2.2.1.1.1.2.cmml">
         <mo id="S3.p1.1.m1.2.2.1.1.1.1.2" stretchy="false" xref="S3.p1.1.m1.2.2.1.1.1.2.cmml">
          {
         </mo>
         <mrow id="S3.p1.1.m1.2.2.1.1.1.1.1.2" xref="S3.p1.1.m1.2.2.1.1.1.1.1.3.cmml">
          <mo id="S3.p1.1.m1.2.2.1.1.1.1.1.2.3" stretchy="false" xref="S3.p1.1.m1.2.2.1.1.1.1.1.3.cmml">
           (
          </mo>
          <msub id="S3.p1.1.m1.2.2.1.1.1.1.1.1.1" xref="S3.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml">
           <mi id="S3.p1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.p1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml">
            x
           </mi>
           <mi id="S3.p1.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.p1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml">
            i
           </mi>
          </msub>
          <mo id="S3.p1.1.m1.2.2.1.1.1.1.1.2.4" xref="S3.p1.1.m1.2.2.1.1.1.1.1.3.cmml">
           ,
          </mo>
          <msub id="S3.p1.1.m1.2.2.1.1.1.1.1.2.2" xref="S3.p1.1.m1.2.2.1.1.1.1.1.2.2.cmml">
           <mi id="S3.p1.1.m1.2.2.1.1.1.1.1.2.2.2" xref="S3.p1.1.m1.2.2.1.1.1.1.1.2.2.2.cmml">
            y
           </mi>
           <mi id="S3.p1.1.m1.2.2.1.1.1.1.1.2.2.3" xref="S3.p1.1.m1.2.2.1.1.1.1.1.2.2.3.cmml">
            i
           </mi>
          </msub>
          <mo id="S3.p1.1.m1.2.2.1.1.1.1.1.2.5" stretchy="false" xref="S3.p1.1.m1.2.2.1.1.1.1.1.3.cmml">
           )
          </mo>
         </mrow>
         <mo id="S3.p1.1.m1.2.2.1.1.1.1.3" stretchy="false" xref="S3.p1.1.m1.2.2.1.1.1.2.cmml">
          }
         </mo>
        </mrow>
        <mrow id="S3.p1.1.m1.2.2.1.1.3" xref="S3.p1.1.m1.2.2.1.1.3.cmml">
         <mi id="S3.p1.1.m1.2.2.1.1.3.2" xref="S3.p1.1.m1.2.2.1.1.3.2.cmml">
          i
         </mi>
         <mo id="S3.p1.1.m1.2.2.1.1.3.1" xref="S3.p1.1.m1.2.2.1.1.3.1.cmml">
          =
         </mo>
         <mn id="S3.p1.1.m1.2.2.1.1.3.3" xref="S3.p1.1.m1.2.2.1.1.3.3.cmml">
          1
         </mn>
        </mrow>
        <mrow id="S3.p1.1.m1.1.1.1.3" xref="S3.p1.1.m1.1.1.1.2.cmml">
         <mo id="S3.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.p1.1.m1.1.1.1.2.1.cmml">
          |
         </mo>
         <mi id="S3.p1.1.m1.1.1.1.1" xref="S3.p1.1.m1.1.1.1.1.cmml">
          𝔻
         </mi>
         <mo id="S3.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.p1.1.m1.1.1.1.2.1.cmml">
          |
         </mo>
        </mrow>
       </msubsup>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.2b">
       <apply id="S3.p1.1.m1.2.2.cmml" xref="S3.p1.1.m1.2.2">
        <eq id="S3.p1.1.m1.2.2.2.cmml" xref="S3.p1.1.m1.2.2.2">
        </eq>
        <ci id="S3.p1.1.m1.2.2.3.cmml" xref="S3.p1.1.m1.2.2.3">
         𝔻
        </ci>
        <apply id="S3.p1.1.m1.2.2.1.cmml" xref="S3.p1.1.m1.2.2.1">
         <csymbol cd="ambiguous" id="S3.p1.1.m1.2.2.1.2.cmml" xref="S3.p1.1.m1.2.2.1">
          superscript
         </csymbol>
         <apply id="S3.p1.1.m1.2.2.1.1.cmml" xref="S3.p1.1.m1.2.2.1">
          <csymbol cd="ambiguous" id="S3.p1.1.m1.2.2.1.1.2.cmml" xref="S3.p1.1.m1.2.2.1">
           subscript
          </csymbol>
          <set id="S3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.p1.1.m1.2.2.1.1.1.1">
           <interval closure="open" id="S3.p1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.p1.1.m1.2.2.1.1.1.1.1.2">
            <apply id="S3.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.p1.1.m1.2.2.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S3.p1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.1.m1.2.2.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S3.p1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.1.m1.2.2.1.1.1.1.1.1.1.2">
              𝑥
             </ci>
             <ci id="S3.p1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.1.m1.2.2.1.1.1.1.1.1.1.3">
              𝑖
             </ci>
            </apply>
            <apply id="S3.p1.1.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.p1.1.m1.2.2.1.1.1.1.1.2.2">
             <csymbol cd="ambiguous" id="S3.p1.1.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.p1.1.m1.2.2.1.1.1.1.1.2.2">
              subscript
             </csymbol>
             <ci id="S3.p1.1.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.p1.1.m1.2.2.1.1.1.1.1.2.2.2">
              𝑦
             </ci>
             <ci id="S3.p1.1.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="S3.p1.1.m1.2.2.1.1.1.1.1.2.2.3">
              𝑖
             </ci>
            </apply>
           </interval>
          </set>
          <apply id="S3.p1.1.m1.2.2.1.1.3.cmml" xref="S3.p1.1.m1.2.2.1.1.3">
           <eq id="S3.p1.1.m1.2.2.1.1.3.1.cmml" xref="S3.p1.1.m1.2.2.1.1.3.1">
           </eq>
           <ci id="S3.p1.1.m1.2.2.1.1.3.2.cmml" xref="S3.p1.1.m1.2.2.1.1.3.2">
            𝑖
           </ci>
           <cn id="S3.p1.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S3.p1.1.m1.2.2.1.1.3.3">
            1
           </cn>
          </apply>
         </apply>
         <apply id="S3.p1.1.m1.1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.1.3">
          <abs id="S3.p1.1.m1.1.1.1.2.1.cmml" xref="S3.p1.1.m1.1.1.1.3.1">
          </abs>
          <ci id="S3.p1.1.m1.1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1.1">
           𝔻
          </ci>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.1.m1.2c">
       \mathbb{D}=\{(x_{i},y_{i})\}_{i=1}^{|\mathbb{D}|}
      </annotation>
     </semantics>
    </math>
    for a language generation task (e.g., summarization), where each pair
    <math alttext="(x,y)" class="ltx_Math" display="inline" id="S3.p1.2.m2.2">
     <semantics id="S3.p1.2.m2.2a">
      <mrow id="S3.p1.2.m2.2.3.2" xref="S3.p1.2.m2.2.3.1.cmml">
       <mo id="S3.p1.2.m2.2.3.2.1" stretchy="false" xref="S3.p1.2.m2.2.3.1.cmml">
        (
       </mo>
       <mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">
        x
       </mi>
       <mo id="S3.p1.2.m2.2.3.2.2" xref="S3.p1.2.m2.2.3.1.cmml">
        ,
       </mo>
       <mi id="S3.p1.2.m2.2.2" xref="S3.p1.2.m2.2.2.cmml">
        y
       </mi>
       <mo id="S3.p1.2.m2.2.3.2.3" stretchy="false" xref="S3.p1.2.m2.2.3.1.cmml">
        )
       </mo>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.2b">
       <interval closure="open" id="S3.p1.2.m2.2.3.1.cmml" xref="S3.p1.2.m2.2.3.2">
        <ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">
         𝑥
        </ci>
        <ci id="S3.p1.2.m2.2.2.cmml" xref="S3.p1.2.m2.2.2">
         𝑦
        </ci>
       </interval>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.2.m2.2c">
       (x,y)
      </annotation>
     </semantics>
    </math>
    represents a document and its corresponding summary stored in
    <math alttext="\mathbb{D}" class="ltx_Math" display="inline" id="S3.p1.3.m3.1">
     <semantics id="S3.p1.3.m3.1a">
      <mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">
       𝔻
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b">
       <ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">
        𝔻
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">
       \mathbb{D}
      </annotation>
     </semantics>
    </math>
    . The
    <span class="ltx_text ltx_font_typewriter" id="S3.p1.12.2">
     M-RAG
    </span>
    initiates the process by partitioning
    <math alttext="\mathbb{D}" class="ltx_Math" display="inline" id="S3.p1.4.m4.1">
     <semantics id="S3.p1.4.m4.1a">
      <mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">
       𝔻
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b">
       <ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">
        𝔻
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">
       \mathbb{D}
      </annotation>
     </semantics>
    </math>
    into multiple partitions. This can be achieved through methods like clustering or by leveraging inherent category labels in the data. The resulting partitions are denoted as
    <math alttext="\mathbb{D}=\{D_{m}\}_{m=1}^{|M|}" class="ltx_Math" display="inline" id="S3.p1.5.m5.2">
     <semantics id="S3.p1.5.m5.2a">
      <mrow id="S3.p1.5.m5.2.2" xref="S3.p1.5.m5.2.2.cmml">
       <mi id="S3.p1.5.m5.2.2.3" xref="S3.p1.5.m5.2.2.3.cmml">
        𝔻
       </mi>
       <mo id="S3.p1.5.m5.2.2.2" xref="S3.p1.5.m5.2.2.2.cmml">
        =
       </mo>
       <msubsup id="S3.p1.5.m5.2.2.1" xref="S3.p1.5.m5.2.2.1.cmml">
        <mrow id="S3.p1.5.m5.2.2.1.1.1.1" xref="S3.p1.5.m5.2.2.1.1.1.2.cmml">
         <mo id="S3.p1.5.m5.2.2.1.1.1.1.2" stretchy="false" xref="S3.p1.5.m5.2.2.1.1.1.2.cmml">
          {
         </mo>
         <msub id="S3.p1.5.m5.2.2.1.1.1.1.1" xref="S3.p1.5.m5.2.2.1.1.1.1.1.cmml">
          <mi id="S3.p1.5.m5.2.2.1.1.1.1.1.2" xref="S3.p1.5.m5.2.2.1.1.1.1.1.2.cmml">
           D
          </mi>
          <mi id="S3.p1.5.m5.2.2.1.1.1.1.1.3" xref="S3.p1.5.m5.2.2.1.1.1.1.1.3.cmml">
           m
          </mi>
         </msub>
         <mo id="S3.p1.5.m5.2.2.1.1.1.1.3" stretchy="false" xref="S3.p1.5.m5.2.2.1.1.1.2.cmml">
          }
         </mo>
        </mrow>
        <mrow id="S3.p1.5.m5.2.2.1.1.3" xref="S3.p1.5.m5.2.2.1.1.3.cmml">
         <mi id="S3.p1.5.m5.2.2.1.1.3.2" xref="S3.p1.5.m5.2.2.1.1.3.2.cmml">
          m
         </mi>
         <mo id="S3.p1.5.m5.2.2.1.1.3.1" xref="S3.p1.5.m5.2.2.1.1.3.1.cmml">
          =
         </mo>
         <mn id="S3.p1.5.m5.2.2.1.1.3.3" xref="S3.p1.5.m5.2.2.1.1.3.3.cmml">
          1
         </mn>
        </mrow>
        <mrow id="S3.p1.5.m5.1.1.1.3" xref="S3.p1.5.m5.1.1.1.2.cmml">
         <mo id="S3.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S3.p1.5.m5.1.1.1.2.1.cmml">
          |
         </mo>
         <mi id="S3.p1.5.m5.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.cmml">
          M
         </mi>
         <mo id="S3.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S3.p1.5.m5.1.1.1.2.1.cmml">
          |
         </mo>
        </mrow>
       </msubsup>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.2b">
       <apply id="S3.p1.5.m5.2.2.cmml" xref="S3.p1.5.m5.2.2">
        <eq id="S3.p1.5.m5.2.2.2.cmml" xref="S3.p1.5.m5.2.2.2">
        </eq>
        <ci id="S3.p1.5.m5.2.2.3.cmml" xref="S3.p1.5.m5.2.2.3">
         𝔻
        </ci>
        <apply id="S3.p1.5.m5.2.2.1.cmml" xref="S3.p1.5.m5.2.2.1">
         <csymbol cd="ambiguous" id="S3.p1.5.m5.2.2.1.2.cmml" xref="S3.p1.5.m5.2.2.1">
          superscript
         </csymbol>
         <apply id="S3.p1.5.m5.2.2.1.1.cmml" xref="S3.p1.5.m5.2.2.1">
          <csymbol cd="ambiguous" id="S3.p1.5.m5.2.2.1.1.2.cmml" xref="S3.p1.5.m5.2.2.1">
           subscript
          </csymbol>
          <set id="S3.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.p1.5.m5.2.2.1.1.1.1">
           <apply id="S3.p1.5.m5.2.2.1.1.1.1.1.cmml" xref="S3.p1.5.m5.2.2.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S3.p1.5.m5.2.2.1.1.1.1.1.1.cmml" xref="S3.p1.5.m5.2.2.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="S3.p1.5.m5.2.2.1.1.1.1.1.2.cmml" xref="S3.p1.5.m5.2.2.1.1.1.1.1.2">
             𝐷
            </ci>
            <ci id="S3.p1.5.m5.2.2.1.1.1.1.1.3.cmml" xref="S3.p1.5.m5.2.2.1.1.1.1.1.3">
             𝑚
            </ci>
           </apply>
          </set>
          <apply id="S3.p1.5.m5.2.2.1.1.3.cmml" xref="S3.p1.5.m5.2.2.1.1.3">
           <eq id="S3.p1.5.m5.2.2.1.1.3.1.cmml" xref="S3.p1.5.m5.2.2.1.1.3.1">
           </eq>
           <ci id="S3.p1.5.m5.2.2.1.1.3.2.cmml" xref="S3.p1.5.m5.2.2.1.1.3.2">
            𝑚
           </ci>
           <cn id="S3.p1.5.m5.2.2.1.1.3.3.cmml" type="integer" xref="S3.p1.5.m5.2.2.1.1.3.3">
            1
           </cn>
          </apply>
         </apply>
         <apply id="S3.p1.5.m5.1.1.1.2.cmml" xref="S3.p1.5.m5.1.1.1.3">
          <abs id="S3.p1.5.m5.1.1.1.2.1.cmml" xref="S3.p1.5.m5.1.1.1.3.1">
          </abs>
          <ci id="S3.p1.5.m5.1.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1.1">
           𝑀
          </ci>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.5.m5.2c">
       \mathbb{D}=\{D_{m}\}_{m=1}^{|M|}
      </annotation>
     </semantics>
    </math>
    , where each
    <math alttext="D_{m}" class="ltx_Math" display="inline" id="S3.p1.6.m6.1">
     <semantics id="S3.p1.6.m6.1a">
      <msub id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">
       <mi id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml">
        D
       </mi>
       <mi id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">
        m
       </mi>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b">
       <apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">
        <csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1">
         subscript
        </csymbol>
        <ci id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2">
         𝐷
        </ci>
        <ci id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3">
         𝑚
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">
       D_{m}
      </annotation>
     </semantics>
    </math>
    <math alttext="(1\leq m\leq M)" class="ltx_Math" display="inline" id="S3.p1.7.m7.1">
     <semantics id="S3.p1.7.m7.1a">
      <mrow id="S3.p1.7.m7.1.1.1" xref="S3.p1.7.m7.1.1.1.1.cmml">
       <mo id="S3.p1.7.m7.1.1.1.2" stretchy="false" xref="S3.p1.7.m7.1.1.1.1.cmml">
        (
       </mo>
       <mrow id="S3.p1.7.m7.1.1.1.1" xref="S3.p1.7.m7.1.1.1.1.cmml">
        <mn id="S3.p1.7.m7.1.1.1.1.2" xref="S3.p1.7.m7.1.1.1.1.2.cmml">
         1
        </mn>
        <mo id="S3.p1.7.m7.1.1.1.1.3" xref="S3.p1.7.m7.1.1.1.1.3.cmml">
         ≤
        </mo>
        <mi id="S3.p1.7.m7.1.1.1.1.4" xref="S3.p1.7.m7.1.1.1.1.4.cmml">
         m
        </mi>
        <mo id="S3.p1.7.m7.1.1.1.1.5" xref="S3.p1.7.m7.1.1.1.1.5.cmml">
         ≤
        </mo>
        <mi id="S3.p1.7.m7.1.1.1.1.6" xref="S3.p1.7.m7.1.1.1.1.6.cmml">
         M
        </mi>
       </mrow>
       <mo id="S3.p1.7.m7.1.1.1.3" stretchy="false" xref="S3.p1.7.m7.1.1.1.1.cmml">
        )
       </mo>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b">
       <apply id="S3.p1.7.m7.1.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1">
        <and id="S3.p1.7.m7.1.1.1.1a.cmml" xref="S3.p1.7.m7.1.1.1">
        </and>
        <apply id="S3.p1.7.m7.1.1.1.1b.cmml" xref="S3.p1.7.m7.1.1.1">
         <leq id="S3.p1.7.m7.1.1.1.1.3.cmml" xref="S3.p1.7.m7.1.1.1.1.3">
         </leq>
         <cn id="S3.p1.7.m7.1.1.1.1.2.cmml" type="integer" xref="S3.p1.7.m7.1.1.1.1.2">
          1
         </cn>
         <ci id="S3.p1.7.m7.1.1.1.1.4.cmml" xref="S3.p1.7.m7.1.1.1.1.4">
          𝑚
         </ci>
        </apply>
        <apply id="S3.p1.7.m7.1.1.1.1c.cmml" xref="S3.p1.7.m7.1.1.1">
         <leq id="S3.p1.7.m7.1.1.1.1.5.cmml" xref="S3.p1.7.m7.1.1.1.1.5">
         </leq>
         <share href="#S3.p1.7.m7.1.1.1.1.4.cmml" id="S3.p1.7.m7.1.1.1.1d.cmml" xref="S3.p1.7.m7.1.1.1">
         </share>
         <ci id="S3.p1.7.m7.1.1.1.1.6.cmml" xref="S3.p1.7.m7.1.1.1.1.6">
          𝑀
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">
       (1\leq m\leq M)
      </annotation>
     </semantics>
    </math>
    supports an independent RAG process (Section
    <a class="ltx_ref" href="#S3.SS1" title="3.1 Discussion on Partitioning a Database ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      3.1
     </span>
    </a>
    ).
The
    <span class="ltx_text ltx_font_typewriter" id="S3.p1.12.3">
     M-RAG
    </span>
    framework comprises both training and inference processes, as outlined in Algorithm
    <a class="ltx_ref" href="#alg1" title="In 3.3 Agent-R: Refining Memories in the Selected Partition ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    . For training, Agent-S learns to select a specific
    <math alttext="D_{m}" class="ltx_Math" display="inline" id="S3.p1.8.m8.1">
     <semantics id="S3.p1.8.m8.1a">
      <msub id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">
       <mi id="S3.p1.8.m8.1.1.2" xref="S3.p1.8.m8.1.1.2.cmml">
        D
       </mi>
       <mi id="S3.p1.8.m8.1.1.3" xref="S3.p1.8.m8.1.1.3.cmml">
        m
       </mi>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b">
       <apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">
        <csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1">
         subscript
        </csymbol>
        <ci id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1.2">
         𝐷
        </ci>
        <ci id="S3.p1.8.m8.1.1.3.cmml" xref="S3.p1.8.m8.1.1.3">
         𝑚
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">
       D_{m}
      </annotation>
     </semantics>
    </math>
    for an input text pair (Section
    <a class="ltx_ref" href="#S3.SS2" title="3.2 Agent-S: Selecting a Database Partition ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      3.2
     </span>
    </a>
    ). Subsequently, Agent-R refines the retrieved memories, represented as
    <math alttext="(\tilde{x},\tilde{y})\in D_{m}" class="ltx_Math" display="inline" id="S3.p1.9.m9.2">
     <semantics id="S3.p1.9.m9.2a">
      <mrow id="S3.p1.9.m9.2.3" xref="S3.p1.9.m9.2.3.cmml">
       <mrow id="S3.p1.9.m9.2.3.2.2" xref="S3.p1.9.m9.2.3.2.1.cmml">
        <mo id="S3.p1.9.m9.2.3.2.2.1" stretchy="false" xref="S3.p1.9.m9.2.3.2.1.cmml">
         (
        </mo>
        <mover accent="true" id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">
         <mi id="S3.p1.9.m9.1.1.2" xref="S3.p1.9.m9.1.1.2.cmml">
          x
         </mi>
         <mo id="S3.p1.9.m9.1.1.1" xref="S3.p1.9.m9.1.1.1.cmml">
          ~
         </mo>
        </mover>
        <mo id="S3.p1.9.m9.2.3.2.2.2" xref="S3.p1.9.m9.2.3.2.1.cmml">
         ,
        </mo>
        <mover accent="true" id="S3.p1.9.m9.2.2" xref="S3.p1.9.m9.2.2.cmml">
         <mi id="S3.p1.9.m9.2.2.2" xref="S3.p1.9.m9.2.2.2.cmml">
          y
         </mi>
         <mo id="S3.p1.9.m9.2.2.1" xref="S3.p1.9.m9.2.2.1.cmml">
          ~
         </mo>
        </mover>
        <mo id="S3.p1.9.m9.2.3.2.2.3" stretchy="false" xref="S3.p1.9.m9.2.3.2.1.cmml">
         )
        </mo>
       </mrow>
       <mo id="S3.p1.9.m9.2.3.1" xref="S3.p1.9.m9.2.3.1.cmml">
        ∈
       </mo>
       <msub id="S3.p1.9.m9.2.3.3" xref="S3.p1.9.m9.2.3.3.cmml">
        <mi id="S3.p1.9.m9.2.3.3.2" xref="S3.p1.9.m9.2.3.3.2.cmml">
         D
        </mi>
        <mi id="S3.p1.9.m9.2.3.3.3" xref="S3.p1.9.m9.2.3.3.3.cmml">
         m
        </mi>
       </msub>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.2b">
       <apply id="S3.p1.9.m9.2.3.cmml" xref="S3.p1.9.m9.2.3">
        <in id="S3.p1.9.m9.2.3.1.cmml" xref="S3.p1.9.m9.2.3.1">
        </in>
        <interval closure="open" id="S3.p1.9.m9.2.3.2.1.cmml" xref="S3.p1.9.m9.2.3.2.2">
         <apply id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">
          <ci id="S3.p1.9.m9.1.1.1.cmml" xref="S3.p1.9.m9.1.1.1">
           ~
          </ci>
          <ci id="S3.p1.9.m9.1.1.2.cmml" xref="S3.p1.9.m9.1.1.2">
           𝑥
          </ci>
         </apply>
         <apply id="S3.p1.9.m9.2.2.cmml" xref="S3.p1.9.m9.2.2">
          <ci id="S3.p1.9.m9.2.2.1.cmml" xref="S3.p1.9.m9.2.2.1">
           ~
          </ci>
          <ci id="S3.p1.9.m9.2.2.2.cmml" xref="S3.p1.9.m9.2.2.2">
           𝑦
          </ci>
         </apply>
        </interval>
        <apply id="S3.p1.9.m9.2.3.3.cmml" xref="S3.p1.9.m9.2.3.3">
         <csymbol cd="ambiguous" id="S3.p1.9.m9.2.3.3.1.cmml" xref="S3.p1.9.m9.2.3.3">
          subscript
         </csymbol>
         <ci id="S3.p1.9.m9.2.3.3.2.cmml" xref="S3.p1.9.m9.2.3.3.2">
          𝐷
         </ci>
         <ci id="S3.p1.9.m9.2.3.3.3.cmml" xref="S3.p1.9.m9.2.3.3.3">
          𝑚
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.9.m9.2c">
       (\tilde{x},\tilde{y})\in D_{m}
      </annotation>
     </semantics>
    </math>
    , within the selected partition
    <math alttext="D_{m}" class="ltx_Math" display="inline" id="S3.p1.10.m10.1">
     <semantics id="S3.p1.10.m10.1a">
      <msub id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml">
       <mi id="S3.p1.10.m10.1.1.2" xref="S3.p1.10.m10.1.1.2.cmml">
        D
       </mi>
       <mi id="S3.p1.10.m10.1.1.3" xref="S3.p1.10.m10.1.1.3.cmml">
        m
       </mi>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b">
       <apply id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1">
        <csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.cmml" xref="S3.p1.10.m10.1.1">
         subscript
        </csymbol>
        <ci id="S3.p1.10.m10.1.1.2.cmml" xref="S3.p1.10.m10.1.1.2">
         𝐷
        </ci>
        <ci id="S3.p1.10.m10.1.1.3.cmml" xref="S3.p1.10.m10.1.1.3">
         𝑚
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">
       D_{m}
      </annotation>
     </semantics>
    </math>
    (Section
    <a class="ltx_ref" href="#S3.SS3" title="3.3 Agent-R: Refining Memories in the Selected Partition ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      3.3
     </span>
    </a>
    ). Finally, the two agents are collaboratively trained with multi-agent reinforcement learning (see Section
    <a class="ltx_ref" href="#S3.SS4" title="3.4 The M-RAG Framework ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      3.4
     </span>
    </a>
    ). Figure
    <a class="ltx_ref" href="#S3.F2" title="Figure 2 ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    illustrates the training process of
    <span class="ltx_text ltx_font_typewriter" id="S3.p1.12.4">
     M-RAG
    </span>
    . For inference, the refined
    <math alttext="\mathbb{D}" class="ltx_Math" display="inline" id="S3.p1.11.m11.1">
     <semantics id="S3.p1.11.m11.1a">
      <mi id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml">
       𝔻
      </mi>
      <annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b">
       <ci id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1">
        𝔻
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">
       \mathbb{D}
      </annotation>
     </semantics>
    </math>
    is utilized to support a LLM in generating hypotheses, where a
    <math alttext="D_{m}" class="ltx_Math" display="inline" id="S3.p1.12.m12.1">
     <semantics id="S3.p1.12.m12.1a">
      <msub id="S3.p1.12.m12.1.1" xref="S3.p1.12.m12.1.1.cmml">
       <mi id="S3.p1.12.m12.1.1.2" xref="S3.p1.12.m12.1.1.2.cmml">
        D
       </mi>
       <mi id="S3.p1.12.m12.1.1.3" xref="S3.p1.12.m12.1.1.3.cmml">
        m
       </mi>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.1b">
       <apply id="S3.p1.12.m12.1.1.cmml" xref="S3.p1.12.m12.1.1">
        <csymbol cd="ambiguous" id="S3.p1.12.m12.1.1.1.cmml" xref="S3.p1.12.m12.1.1">
         subscript
        </csymbol>
        <ci id="S3.p1.12.m12.1.1.2.cmml" xref="S3.p1.12.m12.1.1.2">
         𝐷
        </ci>
        <ci id="S3.p1.12.m12.1.1.3.cmml" xref="S3.p1.12.m12.1.1.3">
         𝑚
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S3.p1.12.m12.1c">
       D_{m}
      </annotation>
     </semantics>
    </math>
    is selected by the trained Agent-S.
   </p>
  </div>
  <section class="ltx_subsection" id="S3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.1
    </span>
    Discussion on Partitioning a Database
   </h3>
   <div class="ltx_para" id="S3.SS1.p1">
    <p class="ltx_p" id="S3.SS1.p1.1">
     As
     <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.1">
      M-RAG
     </span>
     relies on multiple partitions for RAG operations, we investigate various strategies to partition an external database (typically the training corpus). The results of these strategies are then validated through empirical studies. We review the literature, including recent vector database surveys
     <cite class="ltx_cite ltx_citemacro_cite">
      Pan et al. (
      <a class="ltx_ref" href="#bib.bib43" title="">
       2023
      </a>
      ); Han et al. (
      <a class="ltx_ref" href="#bib.bib15" title="">
       2023
      </a>
      )
     </cite>
     , and identify the following strategies: namely (1) Randomization
     <cite class="ltx_cite ltx_citemacro_cite">
      Indyk and Motwani (
      <a class="ltx_ref" href="#bib.bib17" title="">
       1998
      </a>
      )
     </cite>
     , (2) Clustering
     <cite class="ltx_cite ltx_citemacro_cite">
      Jegou et al. (
      <a class="ltx_ref" href="#bib.bib19" title="">
       2010
      </a>
      )
     </cite>
     , (3) Indexing
     <cite class="ltx_cite ltx_citemacro_cite">
      Malkov et al. (
      <a class="ltx_ref" href="#bib.bib36" title="">
       2014
      </a>
      ); Malkov and Yashunin (
      <a class="ltx_ref" href="#bib.bib35" title="">
       2018
      </a>
      )
     </cite>
     and (4) Category
     <cite class="ltx_cite ltx_citemacro_cite">
      Gollapudi et al. (
      <a class="ltx_ref" href="#bib.bib12" title="">
       2023
      </a>
      )
     </cite>
     .
Specifically, for (1), it targets the utilization of probability amplification techniques, such as locality-sensitive hashing (LSH), to hash similar items (data vectors) into the same bucket with a high probability. For (2), it involves clustering data vectors using K-means, where this clustering concept is widely applied in Inverted File Index (IVF) for tasks like Approximate k-Nearest Neighbor (AKNN) search. For (3), navigable graph indexes, such as HNSW
     <cite class="ltx_cite ltx_citemacro_cite">
      Malkov and Yashunin (
      <a class="ltx_ref" href="#bib.bib35" title="">
       2018
      </a>
      )
     </cite>
     or NSW
     <cite class="ltx_cite ltx_citemacro_cite">
      Malkov et al. (
      <a class="ltx_ref" href="#bib.bib36" title="">
       2014
      </a>
      )
     </cite>
     , are designed to facilitate easy traversal of different regions within a vector database. To achieve effective partitions, we employ graph partitioning with spectral clustering on a navigable graph. For (4), it involves assigning data vectors to partitions based on their respective categories. For example, in the DailyDialog dataset
     <cite class="ltx_cite ltx_citemacro_cite">
      Li et al. (
      <a class="ltx_ref" href="#bib.bib30" title="">
       2017
      </a>
      )
     </cite>
     , which includes 7 emotion categories (e.g., joy, anger) and 10 topic categories (e.g., work, health), vectors are partitioned according to their category labels. We note that a single vector may be assigned to multiple partitions, due to the characteristics of the dataset, where a dialogue spans multiple categories.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS1.p2">
    <p class="ltx_p" id="S3.SS1.p2.1">
     In Figure
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     , we perform experiments on a development set, manipulating the number of partitions wrt the 4 strategies across three language generation tasks (summarization, translation, and dialogue generation). The results demonstrate the effectiveness of the strategies, and we conclude the selected strategies with the number of partitions as follows. We choose Indexing (4 partitions), Randomization (3 partitions), and Category (10 partitions) for the summarization, translation, and dialogue generation tasks, respectively. In addition, as shown in Figure
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     (a) and (b), we observe that both Top-1 and Top-3 retrieval methods exhibit comparable performance. For enhanced efficiency, we default to Top-1 retrieval in the rest of the paper.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.2
    </span>
    Agent-S: Selecting a Database Partition
   </h3>
   <div class="ltx_para" id="S3.SS2.p1">
    <p class="ltx_p" id="S3.SS2.p1.1">
     During the training process of an Agent-S to select a partition from
     <math alttext="\mathbb{D}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1">
      <semantics id="S3.SS2.p1.1.m1.1a">
       <mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">
        𝔻
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b">
        <ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">
         𝔻
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">
        \mathbb{D}
       </annotation>
      </semantics>
     </math>
     , the environment is naturally modeled as a bandit setting. In this context, when a random partition is selected, the language model generates a response for the query with feedback (typically based on a specific performance metric), and concludes the episode. The selection process can be formulated as a Markov Decision Process (MDP), involving states, actions, and rewards.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p2">
    <p class="ltx_p" id="S3.SS2.p2.7">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.7.1">
      States.
     </span>
     Given a training pair
     <math alttext="(x,y)" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.2">
      <semantics id="S3.SS2.p2.1.m1.2a">
       <mrow id="S3.SS2.p2.1.m1.2.3.2" xref="S3.SS2.p2.1.m1.2.3.1.cmml">
        <mo id="S3.SS2.p2.1.m1.2.3.2.1" stretchy="false" xref="S3.SS2.p2.1.m1.2.3.1.cmml">
         (
        </mo>
        <mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">
         x
        </mi>
        <mo id="S3.SS2.p2.1.m1.2.3.2.2" xref="S3.SS2.p2.1.m1.2.3.1.cmml">
         ,
        </mo>
        <mi id="S3.SS2.p2.1.m1.2.2" xref="S3.SS2.p2.1.m1.2.2.cmml">
         y
        </mi>
        <mo id="S3.SS2.p2.1.m1.2.3.2.3" stretchy="false" xref="S3.SS2.p2.1.m1.2.3.1.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.2b">
        <interval closure="open" id="S3.SS2.p2.1.m1.2.3.1.cmml" xref="S3.SS2.p2.1.m1.2.3.2">
         <ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">
          𝑥
         </ci>
         <ci id="S3.SS2.p2.1.m1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2">
          𝑦
         </ci>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.2c">
        (x,y)
       </annotation>
      </semantics>
     </math>
     and a set of database partitions
     <math alttext="\mathbb{D}=\{D_{m}\}_{m=1}^{|M|}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.2">
      <semantics id="S3.SS2.p2.2.m2.2a">
       <mrow id="S3.SS2.p2.2.m2.2.2" xref="S3.SS2.p2.2.m2.2.2.cmml">
        <mi id="S3.SS2.p2.2.m2.2.2.3" xref="S3.SS2.p2.2.m2.2.2.3.cmml">
         𝔻
        </mi>
        <mo id="S3.SS2.p2.2.m2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.cmml">
         =
        </mo>
        <msubsup id="S3.SS2.p2.2.m2.2.2.1" xref="S3.SS2.p2.2.m2.2.2.1.cmml">
         <mrow id="S3.SS2.p2.2.m2.2.2.1.1.1.1" xref="S3.SS2.p2.2.m2.2.2.1.1.1.2.cmml">
          <mo id="S3.SS2.p2.2.m2.2.2.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.2.m2.2.2.1.1.1.2.cmml">
           {
          </mo>
          <msub id="S3.SS2.p2.2.m2.2.2.1.1.1.1.1" xref="S3.SS2.p2.2.m2.2.2.1.1.1.1.1.cmml">
           <mi id="S3.SS2.p2.2.m2.2.2.1.1.1.1.1.2" xref="S3.SS2.p2.2.m2.2.2.1.1.1.1.1.2.cmml">
            D
           </mi>
           <mi id="S3.SS2.p2.2.m2.2.2.1.1.1.1.1.3" xref="S3.SS2.p2.2.m2.2.2.1.1.1.1.1.3.cmml">
            m
           </mi>
          </msub>
          <mo id="S3.SS2.p2.2.m2.2.2.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.2.m2.2.2.1.1.1.2.cmml">
           }
          </mo>
         </mrow>
         <mrow id="S3.SS2.p2.2.m2.2.2.1.1.3" xref="S3.SS2.p2.2.m2.2.2.1.1.3.cmml">
          <mi id="S3.SS2.p2.2.m2.2.2.1.1.3.2" xref="S3.SS2.p2.2.m2.2.2.1.1.3.2.cmml">
           m
          </mi>
          <mo id="S3.SS2.p2.2.m2.2.2.1.1.3.1" xref="S3.SS2.p2.2.m2.2.2.1.1.3.1.cmml">
           =
          </mo>
          <mn id="S3.SS2.p2.2.m2.2.2.1.1.3.3" xref="S3.SS2.p2.2.m2.2.2.1.1.3.3.cmml">
           1
          </mn>
         </mrow>
         <mrow id="S3.SS2.p2.2.m2.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.1.2.cmml">
          <mo id="S3.SS2.p2.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS2.p2.2.m2.1.1.1.2.1.cmml">
           |
          </mo>
          <mi id="S3.SS2.p2.2.m2.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.cmml">
           M
          </mi>
          <mo id="S3.SS2.p2.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS2.p2.2.m2.1.1.1.2.1.cmml">
           |
          </mo>
         </mrow>
        </msubsup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.2b">
        <apply id="S3.SS2.p2.2.m2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2">
         <eq id="S3.SS2.p2.2.m2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2">
         </eq>
         <ci id="S3.SS2.p2.2.m2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.2.3">
          𝔻
         </ci>
         <apply id="S3.SS2.p2.2.m2.2.2.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1">
          <csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.1.2.cmml" xref="S3.SS2.p2.2.m2.2.2.1">
           superscript
          </csymbol>
          <apply id="S3.SS2.p2.2.m2.2.2.1.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1">
           <csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.2.2.1">
            subscript
           </csymbol>
           <set id="S3.SS2.p2.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.1.1">
            <apply id="S3.SS2.p2.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S3.SS2.p2.2.m2.2.2.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.1.1.1.2">
              𝐷
             </ci>
             <ci id="S3.SS2.p2.2.m2.2.2.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.1.1.1.3">
              𝑚
             </ci>
            </apply>
           </set>
           <apply id="S3.SS2.p2.2.m2.2.2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.3">
            <eq id="S3.SS2.p2.2.m2.2.2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.3.1">
            </eq>
            <ci id="S3.SS2.p2.2.m2.2.2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.3.2">
             𝑚
            </ci>
            <cn id="S3.SS2.p2.2.m2.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS2.p2.2.m2.2.2.1.1.3.3">
             1
            </cn>
           </apply>
          </apply>
          <apply id="S3.SS2.p2.2.m2.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.3">
           <abs id="S3.SS2.p2.2.m2.1.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.3.1">
           </abs>
           <ci id="S3.SS2.p2.2.m2.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1">
            𝑀
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.2c">
        \mathbb{D}=\{D_{m}\}_{m=1}^{|M|}
       </annotation>
      </semantics>
     </math>
     , the state
     <math alttext="s^{(S)}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1">
      <semantics id="S3.SS2.p2.3.m3.1a">
       <msup id="S3.SS2.p2.3.m3.1.2" xref="S3.SS2.p2.3.m3.1.2.cmml">
        <mi id="S3.SS2.p2.3.m3.1.2.2" xref="S3.SS2.p2.3.m3.1.2.2.cmml">
         s
        </mi>
        <mrow id="S3.SS2.p2.3.m3.1.1.1.3" xref="S3.SS2.p2.3.m3.1.2.cmml">
         <mo id="S3.SS2.p2.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS2.p2.3.m3.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p2.3.m3.1.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.1.cmml">
          S
         </mi>
         <mo id="S3.SS2.p2.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS2.p2.3.m3.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b">
        <apply id="S3.SS2.p2.3.m3.1.2.cmml" xref="S3.SS2.p2.3.m3.1.2">
         <csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS2.p2.3.m3.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.2.2">
          𝑠
         </ci>
         <ci id="S3.SS2.p2.3.m3.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1.1">
          𝑆
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">
        s^{(S)}
       </annotation>
      </semantics>
     </math>
     is defined by assessing the semantic relevance, typically quantified by measures such as cosine similarity
     <math alttext="\text{sim}(\cdot,\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.2">
      <semantics id="S3.SS2.p2.4.m4.2a">
       <mrow id="S3.SS2.p2.4.m4.2.3" xref="S3.SS2.p2.4.m4.2.3.cmml">
        <mtext id="S3.SS2.p2.4.m4.2.3.2" xref="S3.SS2.p2.4.m4.2.3.2a.cmml">
         sim
        </mtext>
        <mo id="S3.SS2.p2.4.m4.2.3.1" lspace="0em" rspace="0em" xref="S3.SS2.p2.4.m4.2.3.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p2.4.m4.2.3.3.2" xref="S3.SS2.p2.4.m4.2.3.3.1.cmml">
         <mo id="S3.SS2.p2.4.m4.2.3.3.2.1" stretchy="false" xref="S3.SS2.p2.4.m4.2.3.3.1.cmml">
          (
         </mo>
         <mo id="S3.SS2.p2.4.m4.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p2.4.m4.1.1.cmml">
          ⋅
         </mo>
         <mo id="S3.SS2.p2.4.m4.2.3.3.2.2" rspace="0em" xref="S3.SS2.p2.4.m4.2.3.3.1.cmml">
          ,
         </mo>
         <mo id="S3.SS2.p2.4.m4.2.2" lspace="0em" rspace="0em" xref="S3.SS2.p2.4.m4.2.2.cmml">
          ⋅
         </mo>
         <mo id="S3.SS2.p2.4.m4.2.3.3.2.3" stretchy="false" xref="S3.SS2.p2.4.m4.2.3.3.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.2b">
        <apply id="S3.SS2.p2.4.m4.2.3.cmml" xref="S3.SS2.p2.4.m4.2.3">
         <times id="S3.SS2.p2.4.m4.2.3.1.cmml" xref="S3.SS2.p2.4.m4.2.3.1">
         </times>
         <ci id="S3.SS2.p2.4.m4.2.3.2a.cmml" xref="S3.SS2.p2.4.m4.2.3.2">
          <mtext id="S3.SS2.p2.4.m4.2.3.2.cmml" xref="S3.SS2.p2.4.m4.2.3.2">
           sim
          </mtext>
         </ci>
         <interval closure="open" id="S3.SS2.p2.4.m4.2.3.3.1.cmml" xref="S3.SS2.p2.4.m4.2.3.3.2">
          <ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">
           ⋅
          </ci>
          <ci id="S3.SS2.p2.4.m4.2.2.cmml" xref="S3.SS2.p2.4.m4.2.2">
           ⋅
          </ci>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.2c">
        \text{sim}(\cdot,\cdot)
       </annotation>
      </semantics>
     </math>
     , between the input
     <math alttext="(x,y)" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.2">
      <semantics id="S3.SS2.p2.5.m5.2a">
       <mrow id="S3.SS2.p2.5.m5.2.3.2" xref="S3.SS2.p2.5.m5.2.3.1.cmml">
        <mo id="S3.SS2.p2.5.m5.2.3.2.1" stretchy="false" xref="S3.SS2.p2.5.m5.2.3.1.cmml">
         (
        </mo>
        <mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">
         x
        </mi>
        <mo id="S3.SS2.p2.5.m5.2.3.2.2" xref="S3.SS2.p2.5.m5.2.3.1.cmml">
         ,
        </mo>
        <mi id="S3.SS2.p2.5.m5.2.2" xref="S3.SS2.p2.5.m5.2.2.cmml">
         y
        </mi>
        <mo id="S3.SS2.p2.5.m5.2.3.2.3" stretchy="false" xref="S3.SS2.p2.5.m5.2.3.1.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.2b">
        <interval closure="open" id="S3.SS2.p2.5.m5.2.3.1.cmml" xref="S3.SS2.p2.5.m5.2.3.2">
         <ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">
          𝑥
         </ci>
         <ci id="S3.SS2.p2.5.m5.2.2.cmml" xref="S3.SS2.p2.5.m5.2.2">
          𝑦
         </ci>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.2c">
        (x,y)
       </annotation>
      </semantics>
     </math>
     and the stored memories
     <math alttext="(\tilde{x},\tilde{y})" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.2">
      <semantics id="S3.SS2.p2.6.m6.2a">
       <mrow id="S3.SS2.p2.6.m6.2.3.2" xref="S3.SS2.p2.6.m6.2.3.1.cmml">
        <mo id="S3.SS2.p2.6.m6.2.3.2.1" stretchy="false" xref="S3.SS2.p2.6.m6.2.3.1.cmml">
         (
        </mo>
        <mover accent="true" id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">
         <mi id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml">
          x
         </mi>
         <mo id="S3.SS2.p2.6.m6.1.1.1" xref="S3.SS2.p2.6.m6.1.1.1.cmml">
          ~
         </mo>
        </mover>
        <mo id="S3.SS2.p2.6.m6.2.3.2.2" xref="S3.SS2.p2.6.m6.2.3.1.cmml">
         ,
        </mo>
        <mover accent="true" id="S3.SS2.p2.6.m6.2.2" xref="S3.SS2.p2.6.m6.2.2.cmml">
         <mi id="S3.SS2.p2.6.m6.2.2.2" xref="S3.SS2.p2.6.m6.2.2.2.cmml">
          y
         </mi>
         <mo id="S3.SS2.p2.6.m6.2.2.1" xref="S3.SS2.p2.6.m6.2.2.1.cmml">
          ~
         </mo>
        </mover>
        <mo id="S3.SS2.p2.6.m6.2.3.2.3" stretchy="false" xref="S3.SS2.p2.6.m6.2.3.1.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.2b">
        <interval closure="open" id="S3.SS2.p2.6.m6.2.3.1.cmml" xref="S3.SS2.p2.6.m6.2.3.2">
         <apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">
          <ci id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1.1">
           ~
          </ci>
          <ci id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2">
           𝑥
          </ci>
         </apply>
         <apply id="S3.SS2.p2.6.m6.2.2.cmml" xref="S3.SS2.p2.6.m6.2.2">
          <ci id="S3.SS2.p2.6.m6.2.2.1.cmml" xref="S3.SS2.p2.6.m6.2.2.1">
           ~
          </ci>
          <ci id="S3.SS2.p2.6.m6.2.2.2.cmml" xref="S3.SS2.p2.6.m6.2.2.2">
           𝑦
          </ci>
         </apply>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.2c">
        (\tilde{x},\tilde{y})
       </annotation>
      </semantics>
     </math>
     within each
     <math alttext="D_{m}" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.1">
      <semantics id="S3.SS2.p2.7.m7.1a">
       <msub id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">
        <mi id="S3.SS2.p2.7.m7.1.1.2" xref="S3.SS2.p2.7.m7.1.1.2.cmml">
         D
        </mi>
        <mi id="S3.SS2.p2.7.m7.1.1.3" xref="S3.SS2.p2.7.m7.1.1.3.cmml">
         m
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b">
        <apply id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2">
          𝐷
         </ci>
         <ci id="S3.SS2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3">
          𝑚
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">
        D_{m}
       </annotation>
      </semantics>
     </math>
     .
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
     <tbody id="S3.E1">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle s^{(S)}=\{\max\limits_{(\tilde{x},\tilde{y})\in D_{m}}\text{sim}(\sigma(\tilde{x}\oplus\tilde{y}),\sigma(x\oplus y))\}_{m=1}^{|M|}," class="ltx_Math" display="inline" id="S3.E1.m1.5">
         <semantics id="S3.E1.m1.5a">
          <mrow id="S3.E1.m1.5.5.1" xref="S3.E1.m1.5.5.1.1.cmml">
           <mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml">
            <msup id="S3.E1.m1.5.5.1.1.3" xref="S3.E1.m1.5.5.1.1.3.cmml">
             <mi id="S3.E1.m1.5.5.1.1.3.2" xref="S3.E1.m1.5.5.1.1.3.2.cmml">
              s
             </mi>
             <mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.3.cmml">
              <mo id="S3.E1.m1.1.1.1.3.1" stretchy="false" xref="S3.E1.m1.5.5.1.1.3.cmml">
               (
              </mo>
              <mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">
               S
              </mi>
              <mo id="S3.E1.m1.1.1.1.3.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.3.cmml">
               )
              </mo>
             </mrow>
            </msup>
            <mo id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml">
             =
            </mo>
            <msubsup id="S3.E1.m1.5.5.1.1.1" xref="S3.E1.m1.5.5.1.1.1.cmml">
             <mrow id="S3.E1.m1.5.5.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.2.cmml">
              <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.2.cmml">
               {
              </mo>
              <mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml">
               <mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1.4" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.cmml">
                <munder id="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.1.cmml">
                 <mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.1.2.cmml">
                  max
                 </mi>
                 <mrow id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.2.cmml">
                  <mrow id="S3.E1.m1.3.3.2.4.2" xref="S3.E1.m1.3.3.2.4.1.cmml">
                   <mo id="S3.E1.m1.3.3.2.4.2.1" stretchy="false" xref="S3.E1.m1.3.3.2.4.1.cmml">
                    (
                   </mo>
                   <mover accent="true" id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml">
                    <mi id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml">
                     x
                    </mi>
                    <mo id="S3.E1.m1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml">
                     ~
                    </mo>
                   </mover>
                   <mo id="S3.E1.m1.3.3.2.4.2.2" xref="S3.E1.m1.3.3.2.4.1.cmml">
                    ,
                   </mo>
                   <mover accent="true" id="S3.E1.m1.3.3.2.2" xref="S3.E1.m1.3.3.2.2.cmml">
                    <mi id="S3.E1.m1.3.3.2.2.2" xref="S3.E1.m1.3.3.2.2.2.cmml">
                     y
                    </mi>
                    <mo id="S3.E1.m1.3.3.2.2.1" xref="S3.E1.m1.3.3.2.2.1.cmml">
                     ~
                    </mo>
                   </mover>
                   <mo id="S3.E1.m1.3.3.2.4.2.3" stretchy="false" xref="S3.E1.m1.3.3.2.4.1.cmml">
                    )
                   </mo>
                  </mrow>
                  <mo id="S3.E1.m1.3.3.2.3" xref="S3.E1.m1.3.3.2.3.cmml">
                   ∈
                  </mo>
                  <msub id="S3.E1.m1.3.3.2.5" xref="S3.E1.m1.3.3.2.5.cmml">
                   <mi id="S3.E1.m1.3.3.2.5.2" xref="S3.E1.m1.3.3.2.5.2.cmml">
                    D
                   </mi>
                   <mi id="S3.E1.m1.3.3.2.5.3" xref="S3.E1.m1.3.3.2.5.3.cmml">
                    m
                   </mi>
                  </msub>
                 </mrow>
                </munder>
                <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.4a" lspace="0.167em" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.cmml">
                 ⁡
                </mo>
                <mtext id="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.2a.cmml">
                 sim
                </mtext>
               </mrow>
               <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.3.cmml">
                ​
               </mo>
               <mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">
                <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">
                 (
                </mo>
                <mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">
                 <mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">
                  σ
                 </mi>
                 <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">
                  ​
                 </mo>
                 <mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   (
                  </mo>
                  <mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   <mover accent="true" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    <mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">
                     x
                    </mi>
                    <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">
                     ~
                    </mo>
                   </mover>
                   <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                    ⊕
                   </mo>
                   <mover accent="true" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                    <mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                     y
                    </mi>
                    <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">
                     ~
                    </mo>
                   </mover>
                  </mrow>
                  <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.4" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">
                 ,
                </mo>
                <mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml">
                 <mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.3.cmml">
                  σ
                 </mi>
                 <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.2" lspace="0em" rspace="0em" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.2.cmml">
                  ​
                 </mo>
                 <mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">
                  <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">
                   (
                  </mo>
                  <mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">
                   <mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml">
                    x
                   </mi>
                   <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml">
                    ⊕
                   </mo>
                   <mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml">
                    y
                   </mi>
                  </mrow>
                  <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="S3.E1.m1.5.5.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.5.5.1.1.1.1.1.2.cmml">
               }
              </mo>
             </mrow>
             <mrow id="S3.E1.m1.5.5.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.3.cmml">
              <mi id="S3.E1.m1.5.5.1.1.1.1.3.2" xref="S3.E1.m1.5.5.1.1.1.1.3.2.cmml">
               m
              </mi>
              <mo id="S3.E1.m1.5.5.1.1.1.1.3.1" xref="S3.E1.m1.5.5.1.1.1.1.3.1.cmml">
               =
              </mo>
              <mn id="S3.E1.m1.5.5.1.1.1.1.3.3" xref="S3.E1.m1.5.5.1.1.1.1.3.3.cmml">
               1
              </mn>
             </mrow>
             <mrow id="S3.E1.m1.4.4.1.3" xref="S3.E1.m1.4.4.1.2.cmml">
              <mo id="S3.E1.m1.4.4.1.3.1" stretchy="false" xref="S3.E1.m1.4.4.1.2.1.cmml">
               |
              </mo>
              <mi id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml">
               M
              </mi>
              <mo id="S3.E1.m1.4.4.1.3.2" stretchy="false" xref="S3.E1.m1.4.4.1.2.1.cmml">
               |
              </mo>
             </mrow>
            </msubsup>
           </mrow>
           <mo id="S3.E1.m1.5.5.1.2" xref="S3.E1.m1.5.5.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b">
           <apply id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1">
            <eq id="S3.E1.m1.5.5.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2">
            </eq>
            <apply id="S3.E1.m1.5.5.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.3">
             <csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.3">
              superscript
             </csymbol>
             <ci id="S3.E1.m1.5.5.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.3.2">
              𝑠
             </ci>
             <ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">
              𝑆
             </ci>
            </apply>
            <apply id="S3.E1.m1.5.5.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1">
             <csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1">
              superscript
             </csymbol>
             <apply id="S3.E1.m1.5.5.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1">
              <csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1">
               subscript
              </csymbol>
              <set id="S3.E1.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1">
               <apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1">
                <times id="S3.E1.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.3">
                </times>
                <apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.4">
                 <apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.1">
                  <csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.1">
                   subscript
                  </csymbol>
                  <max id="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.1.2">
                  </max>
                  <apply id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2">
                   <in id="S3.E1.m1.3.3.2.3.cmml" xref="S3.E1.m1.3.3.2.3">
                   </in>
                   <interval closure="open" id="S3.E1.m1.3.3.2.4.1.cmml" xref="S3.E1.m1.3.3.2.4.2">
                    <apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1.1">
                     <ci id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1">
                      ~
                     </ci>
                     <ci id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2">
                      𝑥
                     </ci>
                    </apply>
                    <apply id="S3.E1.m1.3.3.2.2.cmml" xref="S3.E1.m1.3.3.2.2">
                     <ci id="S3.E1.m1.3.3.2.2.1.cmml" xref="S3.E1.m1.3.3.2.2.1">
                      ~
                     </ci>
                     <ci id="S3.E1.m1.3.3.2.2.2.cmml" xref="S3.E1.m1.3.3.2.2.2">
                      𝑦
                     </ci>
                    </apply>
                   </interval>
                   <apply id="S3.E1.m1.3.3.2.5.cmml" xref="S3.E1.m1.3.3.2.5">
                    <csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.5.1.cmml" xref="S3.E1.m1.3.3.2.5">
                     subscript
                    </csymbol>
                    <ci id="S3.E1.m1.3.3.2.5.2.cmml" xref="S3.E1.m1.3.3.2.5.2">
                     𝐷
                    </ci>
                    <ci id="S3.E1.m1.3.3.2.5.3.cmml" xref="S3.E1.m1.3.3.2.5.3">
                     𝑚
                    </ci>
                   </apply>
                  </apply>
                 </apply>
                 <ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.2a.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.2">
                  <mtext id="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.4.2">
                   sim
                  </mtext>
                 </ci>
                </apply>
                <interval closure="open" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2">
                 <apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1">
                  <times id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2">
                  </times>
                  <ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">
                   𝜎
                  </ci>
                  <apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1">
                   <csymbol cd="latexml" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
                    direct-sum
                   </csymbol>
                   <apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                    <ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">
                     ~
                    </ci>
                    <ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">
                     𝑥
                    </ci>
                   </apply>
                   <apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                    <ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1">
                     ~
                    </ci>
                    <ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">
                     𝑦
                    </ci>
                   </apply>
                  </apply>
                 </apply>
                 <apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2">
                  <times id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.2">
                  </times>
                  <ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.3">
                   𝜎
                  </ci>
                  <apply id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1">
                   <csymbol cd="latexml" id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.1">
                    direct-sum
                   </csymbol>
                   <ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.2">
                    𝑥
                   </ci>
                   <ci id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.1.1.3">
                    𝑦
                   </ci>
                  </apply>
                 </apply>
                </interval>
               </apply>
              </set>
              <apply id="S3.E1.m1.5.5.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3">
               <eq id="S3.E1.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.1">
               </eq>
               <ci id="S3.E1.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.2">
                𝑚
               </ci>
               <cn id="S3.E1.m1.5.5.1.1.1.1.3.3.cmml" type="integer" xref="S3.E1.m1.5.5.1.1.1.1.3.3">
                1
               </cn>
              </apply>
             </apply>
             <apply id="S3.E1.m1.4.4.1.2.cmml" xref="S3.E1.m1.4.4.1.3">
              <abs id="S3.E1.m1.4.4.1.2.1.cmml" xref="S3.E1.m1.4.4.1.3.1">
              </abs>
              <ci id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1.1">
               𝑀
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E1.m1.5c">
           \displaystyle s^{(S)}=\{\max\limits_{(\tilde{x},\tilde{y})\in D_{m}}\text{sim}(\sigma(\tilde{x}\oplus\tilde{y}),\sigma(x\oplus y))\}_{m=1}^{|M|},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (1)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS2.p2.9">
     where
     <math alttext="\oplus" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m1.1">
      <semantics id="S3.SS2.p2.8.m1.1a">
       <mo id="S3.SS2.p2.8.m1.1.1" xref="S3.SS2.p2.8.m1.1.1.cmml">
        ⊕
       </mo>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m1.1b">
        <csymbol cd="latexml" id="S3.SS2.p2.8.m1.1.1.cmml" xref="S3.SS2.p2.8.m1.1.1">
         direct-sum
        </csymbol>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.8.m1.1c">
        \oplus
       </annotation>
      </semantics>
     </math>
     denotes the concatenation operation, and
     <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p2.9.m2.1">
      <semantics id="S3.SS2.p2.9.m2.1a">
       <mrow id="S3.SS2.p2.9.m2.1.2" xref="S3.SS2.p2.9.m2.1.2.cmml">
        <mi id="S3.SS2.p2.9.m2.1.2.2" xref="S3.SS2.p2.9.m2.1.2.2.cmml">
         σ
        </mi>
        <mo id="S3.SS2.p2.9.m2.1.2.1" lspace="0em" rspace="0em" xref="S3.SS2.p2.9.m2.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS2.p2.9.m2.1.2.3.2" xref="S3.SS2.p2.9.m2.1.2.cmml">
         <mo id="S3.SS2.p2.9.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.p2.9.m2.1.2.cmml">
          (
         </mo>
         <mo id="S3.SS2.p2.9.m2.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p2.9.m2.1.1.cmml">
          ⋅
         </mo>
         <mo id="S3.SS2.p2.9.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.p2.9.m2.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m2.1b">
        <apply id="S3.SS2.p2.9.m2.1.2.cmml" xref="S3.SS2.p2.9.m2.1.2">
         <times id="S3.SS2.p2.9.m2.1.2.1.cmml" xref="S3.SS2.p2.9.m2.1.2.1">
         </times>
         <ci id="S3.SS2.p2.9.m2.1.2.2.cmml" xref="S3.SS2.p2.9.m2.1.2.2">
          𝜎
         </ci>
         <ci id="S3.SS2.p2.9.m2.1.1.cmml" xref="S3.SS2.p2.9.m2.1.1">
          ⋅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.9.m2.1c">
        \sigma(\cdot)
       </annotation>
      </semantics>
     </math>
     denotes an embedded model utilized to obtain text representations, such as the CPT-Text
     <cite class="ltx_cite ltx_citemacro_cite">
      Neelakantan et al. (
      <a class="ltx_ref" href="#bib.bib41" title="">
       2022
      </a>
      )
     </cite>
     . We consider the Top-1 retrieved memories to construct the state.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p3">
    <p class="ltx_p" id="S3.SS2.p3.2">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p3.2.1">
      Actions.
     </span>
     Let
     <math alttext="a^{(S)}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1">
      <semantics id="S3.SS2.p3.1.m1.1a">
       <msup id="S3.SS2.p3.1.m1.1.2" xref="S3.SS2.p3.1.m1.1.2.cmml">
        <mi id="S3.SS2.p3.1.m1.1.2.2" xref="S3.SS2.p3.1.m1.1.2.2.cmml">
         a
        </mi>
        <mrow id="S3.SS2.p3.1.m1.1.1.1.3" xref="S3.SS2.p3.1.m1.1.2.cmml">
         <mo id="S3.SS2.p3.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.p3.1.m1.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p3.1.m1.1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.1.cmml">
          S
         </mi>
         <mo id="S3.SS2.p3.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.p3.1.m1.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b">
        <apply id="S3.SS2.p3.1.m1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.2">
         <csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.2.1.cmml" xref="S3.SS2.p3.1.m1.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS2.p3.1.m1.1.2.2.cmml" xref="S3.SS2.p3.1.m1.1.2.2">
          𝑎
         </ci>
         <ci id="S3.SS2.p3.1.m1.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1">
          𝑆
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">
        a^{(S)}
       </annotation>
      </semantics>
     </math>
     represent an action undertaken by Agent-S. The design of actions corresponds to that of the state
     <math alttext="s^{(S)}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1">
      <semantics id="S3.SS2.p3.2.m2.1a">
       <msup id="S3.SS2.p3.2.m2.1.2" xref="S3.SS2.p3.2.m2.1.2.cmml">
        <mi id="S3.SS2.p3.2.m2.1.2.2" xref="S3.SS2.p3.2.m2.1.2.2.cmml">
         s
        </mi>
        <mrow id="S3.SS2.p3.2.m2.1.1.1.3" xref="S3.SS2.p3.2.m2.1.2.cmml">
         <mo id="S3.SS2.p3.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS2.p3.2.m2.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p3.2.m2.1.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.1.cmml">
          S
         </mi>
         <mo id="S3.SS2.p3.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS2.p3.2.m2.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b">
        <apply id="S3.SS2.p3.2.m2.1.2.cmml" xref="S3.SS2.p3.2.m2.1.2">
         <csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.2.1.cmml" xref="S3.SS2.p3.2.m2.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS2.p3.2.m2.1.2.2.cmml" xref="S3.SS2.p3.2.m2.1.2.2">
          𝑠
         </ci>
         <ci id="S3.SS2.p3.2.m2.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1">
          𝑆
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">
        s^{(S)}
       </annotation>
      </semantics>
     </math>
     . Specifically, the actions are defined as follows:
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
     <tbody id="S3.E2">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle a^{(S)}=m\ (1\leq m\leq M)," class="ltx_Math" display="inline" id="S3.E2.m1.2">
         <semantics id="S3.E2.m1.2a">
          <mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml">
           <mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml">
            <msup id="S3.E2.m1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.1.3.cmml">
             <mi id="S3.E2.m1.2.2.1.1.3.2" xref="S3.E2.m1.2.2.1.1.3.2.cmml">
              a
             </mi>
             <mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.3.cmml">
              <mo id="S3.E2.m1.1.1.1.3.1" stretchy="false" xref="S3.E2.m1.2.2.1.1.3.cmml">
               (
              </mo>
              <mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">
               S
              </mi>
              <mo id="S3.E2.m1.1.1.1.3.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.3.cmml">
               )
              </mo>
             </mrow>
            </msup>
            <mo id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.1.2.cmml">
             =
            </mo>
            <mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml">
             <mi id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml">
              m
             </mi>
             <mo id="S3.E2.m1.2.2.1.1.1.2" lspace="0.500em" rspace="0em" xref="S3.E2.m1.2.2.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml">
              <mo id="S3.E2.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="S3.E2.m1.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml">
               <mn id="S3.E2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml">
                1
               </mn>
               <mo id="S3.E2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml">
                ≤
               </mo>
               <mi id="S3.E2.m1.2.2.1.1.1.1.1.1.4" xref="S3.E2.m1.2.2.1.1.1.1.1.1.4.cmml">
                m
               </mi>
               <mo id="S3.E2.m1.2.2.1.1.1.1.1.1.5" xref="S3.E2.m1.2.2.1.1.1.1.1.1.5.cmml">
                ≤
               </mo>
               <mi id="S3.E2.m1.2.2.1.1.1.1.1.1.6" xref="S3.E2.m1.2.2.1.1.1.1.1.1.6.cmml">
                M
               </mi>
              </mrow>
              <mo id="S3.E2.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b">
           <apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1">
            <eq id="S3.E2.m1.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.2">
            </eq>
            <apply id="S3.E2.m1.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3">
             <csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3">
              superscript
             </csymbol>
             <ci id="S3.E2.m1.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.2">
              𝑎
             </ci>
             <ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">
              𝑆
             </ci>
            </apply>
            <apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1">
             <times id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2">
             </times>
             <ci id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3">
              𝑚
             </ci>
             <apply id="S3.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1">
              <and id="S3.E2.m1.2.2.1.1.1.1.1.1a.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1">
              </and>
              <apply id="S3.E2.m1.2.2.1.1.1.1.1.1b.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1">
               <leq id="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3">
               </leq>
               <cn id="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2">
                1
               </cn>
               <ci id="S3.E2.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.4">
                𝑚
               </ci>
              </apply>
              <apply id="S3.E2.m1.2.2.1.1.1.1.1.1c.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1">
               <leq id="S3.E2.m1.2.2.1.1.1.1.1.1.5.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.5">
               </leq>
               <share href="#S3.E2.m1.2.2.1.1.1.1.1.1.4.cmml" id="S3.E2.m1.2.2.1.1.1.1.1.1d.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1">
               </share>
               <ci id="S3.E2.m1.2.2.1.1.1.1.1.1.6.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.6">
                𝑀
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E2.m1.2c">
           \displaystyle a^{(S)}=m\ (1\leq m\leq M),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (2)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS2.p3.4">
     where action
     <math alttext="a^{(S)}=m" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m1.1">
      <semantics id="S3.SS2.p3.3.m1.1a">
       <mrow id="S3.SS2.p3.3.m1.1.2" xref="S3.SS2.p3.3.m1.1.2.cmml">
        <msup id="S3.SS2.p3.3.m1.1.2.2" xref="S3.SS2.p3.3.m1.1.2.2.cmml">
         <mi id="S3.SS2.p3.3.m1.1.2.2.2" xref="S3.SS2.p3.3.m1.1.2.2.2.cmml">
          a
         </mi>
         <mrow id="S3.SS2.p3.3.m1.1.1.1.3" xref="S3.SS2.p3.3.m1.1.2.2.cmml">
          <mo id="S3.SS2.p3.3.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.p3.3.m1.1.2.2.cmml">
           (
          </mo>
          <mi id="S3.SS2.p3.3.m1.1.1.1.1" xref="S3.SS2.p3.3.m1.1.1.1.1.cmml">
           S
          </mi>
          <mo id="S3.SS2.p3.3.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.p3.3.m1.1.2.2.cmml">
           )
          </mo>
         </mrow>
        </msup>
        <mo id="S3.SS2.p3.3.m1.1.2.1" xref="S3.SS2.p3.3.m1.1.2.1.cmml">
         =
        </mo>
        <mi id="S3.SS2.p3.3.m1.1.2.3" xref="S3.SS2.p3.3.m1.1.2.3.cmml">
         m
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m1.1b">
        <apply id="S3.SS2.p3.3.m1.1.2.cmml" xref="S3.SS2.p3.3.m1.1.2">
         <eq id="S3.SS2.p3.3.m1.1.2.1.cmml" xref="S3.SS2.p3.3.m1.1.2.1">
         </eq>
         <apply id="S3.SS2.p3.3.m1.1.2.2.cmml" xref="S3.SS2.p3.3.m1.1.2.2">
          <csymbol cd="ambiguous" id="S3.SS2.p3.3.m1.1.2.2.1.cmml" xref="S3.SS2.p3.3.m1.1.2.2">
           superscript
          </csymbol>
          <ci id="S3.SS2.p3.3.m1.1.2.2.2.cmml" xref="S3.SS2.p3.3.m1.1.2.2.2">
           𝑎
          </ci>
          <ci id="S3.SS2.p3.3.m1.1.1.1.1.cmml" xref="S3.SS2.p3.3.m1.1.1.1.1">
           𝑆
          </ci>
         </apply>
         <ci id="S3.SS2.p3.3.m1.1.2.3.cmml" xref="S3.SS2.p3.3.m1.1.2.3">
          𝑚
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.3.m1.1c">
        a^{(S)}=m
       </annotation>
      </semantics>
     </math>
     means to select the
     <math alttext="D_{m}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m2.1">
      <semantics id="S3.SS2.p3.4.m2.1a">
       <msub id="S3.SS2.p3.4.m2.1.1" xref="S3.SS2.p3.4.m2.1.1.cmml">
        <mi id="S3.SS2.p3.4.m2.1.1.2" xref="S3.SS2.p3.4.m2.1.1.2.cmml">
         D
        </mi>
        <mi id="S3.SS2.p3.4.m2.1.1.3" xref="S3.SS2.p3.4.m2.1.1.3.cmml">
         m
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m2.1b">
        <apply id="S3.SS2.p3.4.m2.1.1.cmml" xref="S3.SS2.p3.4.m2.1.1">
         <csymbol cd="ambiguous" id="S3.SS2.p3.4.m2.1.1.1.cmml" xref="S3.SS2.p3.4.m2.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS2.p3.4.m2.1.1.2.cmml" xref="S3.SS2.p3.4.m2.1.1.2">
          𝐷
         </ci>
         <ci id="S3.SS2.p3.4.m2.1.1.3.cmml" xref="S3.SS2.p3.4.m2.1.1.3">
          𝑚
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p3.4.m2.1c">
        D_{m}
       </annotation>
      </semantics>
     </math>
     for subsequent the generation task.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS2.p4">
    <p class="ltx_p" id="S3.SS2.p4.6">
     <span class="ltx_text ltx_font_bold" id="S3.SS2.p4.6.1">
      Rewards.
     </span>
     The reward is denoted by
     <math alttext="r^{(S)}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1">
      <semantics id="S3.SS2.p4.1.m1.1a">
       <msup id="S3.SS2.p4.1.m1.1.2" xref="S3.SS2.p4.1.m1.1.2.cmml">
        <mi id="S3.SS2.p4.1.m1.1.2.2" xref="S3.SS2.p4.1.m1.1.2.2.cmml">
         r
        </mi>
        <mrow id="S3.SS2.p4.1.m1.1.1.1.3" xref="S3.SS2.p4.1.m1.1.2.cmml">
         <mo id="S3.SS2.p4.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.p4.1.m1.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p4.1.m1.1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.1.cmml">
          S
         </mi>
         <mo id="S3.SS2.p4.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.p4.1.m1.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b">
        <apply id="S3.SS2.p4.1.m1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.2">
         <csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.2.1.cmml" xref="S3.SS2.p4.1.m1.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS2.p4.1.m1.1.2.2.cmml" xref="S3.SS2.p4.1.m1.1.2.2">
          𝑟
         </ci>
         <ci id="S3.SS2.p4.1.m1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1.1">
          𝑆
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">
        r^{(S)}
       </annotation>
      </semantics>
     </math>
     . When the action
     <math alttext="a^{(S)}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1">
      <semantics id="S3.SS2.p4.2.m2.1a">
       <msup id="S3.SS2.p4.2.m2.1.2" xref="S3.SS2.p4.2.m2.1.2.cmml">
        <mi id="S3.SS2.p4.2.m2.1.2.2" xref="S3.SS2.p4.2.m2.1.2.2.cmml">
         a
        </mi>
        <mrow id="S3.SS2.p4.2.m2.1.1.1.3" xref="S3.SS2.p4.2.m2.1.2.cmml">
         <mo id="S3.SS2.p4.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS2.p4.2.m2.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS2.p4.2.m2.1.1.1.1" xref="S3.SS2.p4.2.m2.1.1.1.1.cmml">
          S
         </mi>
         <mo id="S3.SS2.p4.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS2.p4.2.m2.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b">
        <apply id="S3.SS2.p4.2.m2.1.2.cmml" xref="S3.SS2.p4.2.m2.1.2">
         <csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.2.1.cmml" xref="S3.SS2.p4.2.m2.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS2.p4.2.m2.1.2.2.cmml" xref="S3.SS2.p4.2.m2.1.2.2">
          𝑎
         </ci>
         <ci id="S3.SS2.p4.2.m2.1.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1.1">
          𝑆
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">
        a^{(S)}
       </annotation>
      </semantics>
     </math>
     involves exploring a partition, the reward cannot be immediately observed, as no response has been received for the query
     <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1">
      <semantics id="S3.SS2.p4.3.m3.1a">
       <mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">
        x
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b">
        <ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">
         𝑥
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">
        x
       </annotation>
      </semantics>
     </math>
     . However, when the action involves selecting a partition for Agent-R to refine the memories within the partition, the stored response
     <math alttext="\tilde{y}" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.1">
      <semantics id="S3.SS2.p4.4.m4.1a">
       <mover accent="true" id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">
        <mi id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml">
         y
        </mi>
        <mo id="S3.SS2.p4.4.m4.1.1.1" xref="S3.SS2.p4.4.m4.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b">
        <apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">
         <ci id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1.1">
          ~
         </ci>
         <ci id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2">
          𝑦
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">
        \tilde{y}
       </annotation>
      </semantics>
     </math>
     is updated, and some reward signal can be obtained (for example, by measuring the difference between the results on the original memory and that on the refined memory). Therefore, we make Agent-S and Agent-R are trained with multi-agent reinforcement learning, since they cooperate towards the same objective of learning a policy that produces a response (hypothesis) as similar as possible to the reference
     <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.1">
      <semantics id="S3.SS2.p4.5.m5.1a">
       <mi id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">
        y
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b">
        <ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">
         𝑦
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">
        y
       </annotation>
      </semantics>
     </math>
     for the
     <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p4.6.m6.1">
      <semantics id="S3.SS2.p4.6.m6.1a">
       <mi id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml">
        x
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b">
        <ci id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">
         𝑥
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">
        x
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.3
    </span>
    Agent-R: Refining Memories in the Selected Partition
   </h3>
   <div class="ltx_para" id="S3.SS3.p1">
    <p class="ltx_p" id="S3.SS3.p1.7">
     Next, we formulate the task of refining the retrieved memories carried out by Agent-R within a selected partition. To accomplish this, Agent-R explores potential responses denoted by
     <math alttext="\hat{y}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1">
      <semantics id="S3.SS3.p1.1.m1.1a">
       <mover accent="true" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">
        <mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">
         y
        </mi>
        <mo id="S3.SS3.p1.1.m1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.cmml">
         ^
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b">
        <apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">
         <ci id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1">
          ^
         </ci>
         <ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">
          𝑦
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">
        \hat{y}
       </annotation>
      </semantics>
     </math>
     through LLMs for the retrieved
     <math alttext="\tilde{x}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1">
      <semantics id="S3.SS3.p1.2.m2.1a">
       <mover accent="true" id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">
        <mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">
         x
        </mi>
        <mo id="S3.SS3.p1.2.m2.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b">
        <apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">
         <ci id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1">
          ~
         </ci>
         <ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">
          𝑥
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">
        \tilde{x}
       </annotation>
      </semantics>
     </math>
     , and generates a candidate pool
     <math alttext="\mathbb{C}=\{\hat{y}_{k}\leftarrow\text{LLM}(\tilde{x})\}_{k=1}^{|K|}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.3">
      <semantics id="S3.SS3.p1.3.m3.3a">
       <mrow id="S3.SS3.p1.3.m3.3.3" xref="S3.SS3.p1.3.m3.3.3.cmml">
        <mi id="S3.SS3.p1.3.m3.3.3.3" xref="S3.SS3.p1.3.m3.3.3.3.cmml">
         ℂ
        </mi>
        <mo id="S3.SS3.p1.3.m3.3.3.2" xref="S3.SS3.p1.3.m3.3.3.2.cmml">
         =
        </mo>
        <msubsup id="S3.SS3.p1.3.m3.3.3.1" xref="S3.SS3.p1.3.m3.3.3.1.cmml">
         <mrow id="S3.SS3.p1.3.m3.3.3.1.1.1.1" xref="S3.SS3.p1.3.m3.3.3.1.1.1.2.cmml">
          <mo id="S3.SS3.p1.3.m3.3.3.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.3.m3.3.3.1.1.1.2.cmml">
           {
          </mo>
          <mrow id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.cmml">
           <msub id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.cmml">
            <mover accent="true" id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.2" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.2.cmml">
             <mi id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.2.2" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.2.2.cmml">
              y
             </mi>
             <mo id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.2.1" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.2.1.cmml">
              ^
             </mo>
            </mover>
            <mi id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.3" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.3.cmml">
             k
            </mi>
           </msub>
           <mo id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.1" stretchy="false" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.1.cmml">
            ←
           </mo>
           <mrow id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.cmml">
            <mtext id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.2" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.2a.cmml">
             LLM
            </mtext>
            <mo id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.1" lspace="0em" rspace="0em" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.1.cmml">
             ​
            </mo>
            <mrow id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.3.2" xref="S3.SS3.p1.3.m3.2.2.cmml">
             <mo id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.SS3.p1.3.m3.2.2.cmml">
              (
             </mo>
             <mover accent="true" id="S3.SS3.p1.3.m3.2.2" xref="S3.SS3.p1.3.m3.2.2.cmml">
              <mi id="S3.SS3.p1.3.m3.2.2.2" xref="S3.SS3.p1.3.m3.2.2.2.cmml">
               x
              </mi>
              <mo id="S3.SS3.p1.3.m3.2.2.1" xref="S3.SS3.p1.3.m3.2.2.1.cmml">
               ~
              </mo>
             </mover>
             <mo id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.SS3.p1.3.m3.2.2.cmml">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <mo id="S3.SS3.p1.3.m3.3.3.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.3.m3.3.3.1.1.1.2.cmml">
           }
          </mo>
         </mrow>
         <mrow id="S3.SS3.p1.3.m3.3.3.1.1.3" xref="S3.SS3.p1.3.m3.3.3.1.1.3.cmml">
          <mi id="S3.SS3.p1.3.m3.3.3.1.1.3.2" xref="S3.SS3.p1.3.m3.3.3.1.1.3.2.cmml">
           k
          </mi>
          <mo id="S3.SS3.p1.3.m3.3.3.1.1.3.1" xref="S3.SS3.p1.3.m3.3.3.1.1.3.1.cmml">
           =
          </mo>
          <mn id="S3.SS3.p1.3.m3.3.3.1.1.3.3" xref="S3.SS3.p1.3.m3.3.3.1.1.3.3.cmml">
           1
          </mn>
         </mrow>
         <mrow id="S3.SS3.p1.3.m3.1.1.1.3" xref="S3.SS3.p1.3.m3.1.1.1.2.cmml">
          <mo id="S3.SS3.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.3.m3.1.1.1.2.1.cmml">
           |
          </mo>
          <mi id="S3.SS3.p1.3.m3.1.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.1.cmml">
           K
          </mi>
          <mo id="S3.SS3.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.3.m3.1.1.1.2.1.cmml">
           |
          </mo>
         </mrow>
        </msubsup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.3b">
        <apply id="S3.SS3.p1.3.m3.3.3.cmml" xref="S3.SS3.p1.3.m3.3.3">
         <eq id="S3.SS3.p1.3.m3.3.3.2.cmml" xref="S3.SS3.p1.3.m3.3.3.2">
         </eq>
         <ci id="S3.SS3.p1.3.m3.3.3.3.cmml" xref="S3.SS3.p1.3.m3.3.3.3">
          ℂ
         </ci>
         <apply id="S3.SS3.p1.3.m3.3.3.1.cmml" xref="S3.SS3.p1.3.m3.3.3.1">
          <csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.3.3.1.2.cmml" xref="S3.SS3.p1.3.m3.3.3.1">
           superscript
          </csymbol>
          <apply id="S3.SS3.p1.3.m3.3.3.1.1.cmml" xref="S3.SS3.p1.3.m3.3.3.1">
           <csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.3.3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.3.3.1">
            subscript
           </csymbol>
           <set id="S3.SS3.p1.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1">
            <apply id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1">
             <ci id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.1">
              ←
             </ci>
             <apply id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2">
              <csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2">
               subscript
              </csymbol>
              <apply id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.2">
               <ci id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.2.1">
                ^
               </ci>
               <ci id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.2.2">
                𝑦
               </ci>
              </apply>
              <ci id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.2.3">
               𝑘
              </ci>
             </apply>
             <apply id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3">
              <times id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.1">
              </times>
              <ci id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.2a.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.2">
               <mtext id="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.2">
                LLM
               </mtext>
              </ci>
              <apply id="S3.SS3.p1.3.m3.2.2.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.1.1.1.3.3.2">
               <ci id="S3.SS3.p1.3.m3.2.2.1.cmml" xref="S3.SS3.p1.3.m3.2.2.1">
                ~
               </ci>
               <ci id="S3.SS3.p1.3.m3.2.2.2.cmml" xref="S3.SS3.p1.3.m3.2.2.2">
                𝑥
               </ci>
              </apply>
             </apply>
            </apply>
           </set>
           <apply id="S3.SS3.p1.3.m3.3.3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.3">
            <eq id="S3.SS3.p1.3.m3.3.3.1.1.3.1.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.3.1">
            </eq>
            <ci id="S3.SS3.p1.3.m3.3.3.1.1.3.2.cmml" xref="S3.SS3.p1.3.m3.3.3.1.1.3.2">
             𝑘
            </ci>
            <cn id="S3.SS3.p1.3.m3.3.3.1.1.3.3.cmml" type="integer" xref="S3.SS3.p1.3.m3.3.3.1.1.3.3">
             1
            </cn>
           </apply>
          </apply>
          <apply id="S3.SS3.p1.3.m3.1.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.1.3">
           <abs id="S3.SS3.p1.3.m3.1.1.1.2.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.3.1">
           </abs>
           <ci id="S3.SS3.p1.3.m3.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1">
            𝐾
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.3c">
        \mathbb{C}=\{\hat{y}_{k}\leftarrow\text{LLM}(\tilde{x})\}_{k=1}^{|K|}
       </annotation>
      </semantics>
     </math>
     for selection, where
     <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1">
      <semantics id="S3.SS3.p1.4.m4.1a">
       <mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b">
        <ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">
        K
       </annotation>
      </semantics>
     </math>
     denotes the number of candidates. Upon selecting a candidate, Agent-R evaluates its quality by demonstrating the new memory
     <math alttext="(\tilde{x},\hat{y}_{k})" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.2">
      <semantics id="S3.SS3.p1.5.m5.2a">
       <mrow id="S3.SS3.p1.5.m5.2.2.1" xref="S3.SS3.p1.5.m5.2.2.2.cmml">
        <mo id="S3.SS3.p1.5.m5.2.2.1.2" stretchy="false" xref="S3.SS3.p1.5.m5.2.2.2.cmml">
         (
        </mo>
        <mover accent="true" id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">
         <mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">
          x
         </mi>
         <mo id="S3.SS3.p1.5.m5.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.cmml">
          ~
         </mo>
        </mover>
        <mo id="S3.SS3.p1.5.m5.2.2.1.3" xref="S3.SS3.p1.5.m5.2.2.2.cmml">
         ,
        </mo>
        <msub id="S3.SS3.p1.5.m5.2.2.1.1" xref="S3.SS3.p1.5.m5.2.2.1.1.cmml">
         <mover accent="true" id="S3.SS3.p1.5.m5.2.2.1.1.2" xref="S3.SS3.p1.5.m5.2.2.1.1.2.cmml">
          <mi id="S3.SS3.p1.5.m5.2.2.1.1.2.2" xref="S3.SS3.p1.5.m5.2.2.1.1.2.2.cmml">
           y
          </mi>
          <mo id="S3.SS3.p1.5.m5.2.2.1.1.2.1" xref="S3.SS3.p1.5.m5.2.2.1.1.2.1.cmml">
           ^
          </mo>
         </mover>
         <mi id="S3.SS3.p1.5.m5.2.2.1.1.3" xref="S3.SS3.p1.5.m5.2.2.1.1.3.cmml">
          k
         </mi>
        </msub>
        <mo id="S3.SS3.p1.5.m5.2.2.1.4" stretchy="false" xref="S3.SS3.p1.5.m5.2.2.2.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.2b">
        <interval closure="open" id="S3.SS3.p1.5.m5.2.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1">
         <apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">
          <ci id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1">
           ~
          </ci>
          <ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">
           𝑥
          </ci>
         </apply>
         <apply id="S3.SS3.p1.5.m5.2.2.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1">
          <csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1">
           subscript
          </csymbol>
          <apply id="S3.SS3.p1.5.m5.2.2.1.1.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.2">
           <ci id="S3.SS3.p1.5.m5.2.2.1.1.2.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.2.1">
            ^
           </ci>
           <ci id="S3.SS3.p1.5.m5.2.2.1.1.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.2.2">
            𝑦
           </ci>
          </apply>
          <ci id="S3.SS3.p1.5.m5.2.2.1.1.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.3">
           𝑘
          </ci>
         </apply>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.2c">
        (\tilde{x},\hat{y}_{k})
       </annotation>
      </semantics>
     </math>
     to generate a hypothesis
     <math alttext="h\leftarrow\text{LLM}(x\oplus(\tilde{x},\hat{y}_{k}))" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.2">
      <semantics id="S3.SS3.p1.6.m6.2a">
       <mrow id="S3.SS3.p1.6.m6.2.2" xref="S3.SS3.p1.6.m6.2.2.cmml">
        <mi id="S3.SS3.p1.6.m6.2.2.3" xref="S3.SS3.p1.6.m6.2.2.3.cmml">
         h
        </mi>
        <mo id="S3.SS3.p1.6.m6.2.2.2" stretchy="false" xref="S3.SS3.p1.6.m6.2.2.2.cmml">
         ←
        </mo>
        <mrow id="S3.SS3.p1.6.m6.2.2.1" xref="S3.SS3.p1.6.m6.2.2.1.cmml">
         <mtext id="S3.SS3.p1.6.m6.2.2.1.3" xref="S3.SS3.p1.6.m6.2.2.1.3a.cmml">
          LLM
         </mtext>
         <mo id="S3.SS3.p1.6.m6.2.2.1.2" lspace="0em" rspace="0em" xref="S3.SS3.p1.6.m6.2.2.1.2.cmml">
          ​
         </mo>
         <mrow id="S3.SS3.p1.6.m6.2.2.1.1.1" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.cmml">
          <mo id="S3.SS3.p1.6.m6.2.2.1.1.1.2" stretchy="false" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.cmml">
           (
          </mo>
          <mrow id="S3.SS3.p1.6.m6.2.2.1.1.1.1" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.cmml">
           <mi id="S3.SS3.p1.6.m6.2.2.1.1.1.1.3" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.3.cmml">
            x
           </mi>
           <mo id="S3.SS3.p1.6.m6.2.2.1.1.1.1.2" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.2.cmml">
            ⊕
           </mo>
           <mrow id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.2.cmml">
            <mo id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.2.cmml">
             (
            </mo>
            <mover accent="true" id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">
             <mi id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">
              x
             </mi>
             <mo id="S3.SS3.p1.6.m6.1.1.1" xref="S3.SS3.p1.6.m6.1.1.1.cmml">
              ~
             </mo>
            </mover>
            <mo id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.3" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.2.cmml">
             ,
            </mo>
            <msub id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml">
             <mover accent="true" id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.2" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.2.cmml">
              <mi id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.2.2.cmml">
               y
              </mi>
              <mo id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.2.1" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.2.1.cmml">
               ^
              </mo>
             </mover>
             <mi id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.3" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.3.cmml">
              k
             </mi>
            </msub>
            <mo id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.4" stretchy="false" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.2.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <mo id="S3.SS3.p1.6.m6.2.2.1.1.1.3" stretchy="false" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.2b">
        <apply id="S3.SS3.p1.6.m6.2.2.cmml" xref="S3.SS3.p1.6.m6.2.2">
         <ci id="S3.SS3.p1.6.m6.2.2.2.cmml" xref="S3.SS3.p1.6.m6.2.2.2">
          ←
         </ci>
         <ci id="S3.SS3.p1.6.m6.2.2.3.cmml" xref="S3.SS3.p1.6.m6.2.2.3">
          ℎ
         </ci>
         <apply id="S3.SS3.p1.6.m6.2.2.1.cmml" xref="S3.SS3.p1.6.m6.2.2.1">
          <times id="S3.SS3.p1.6.m6.2.2.1.2.cmml" xref="S3.SS3.p1.6.m6.2.2.1.2">
          </times>
          <ci id="S3.SS3.p1.6.m6.2.2.1.3a.cmml" xref="S3.SS3.p1.6.m6.2.2.1.3">
           <mtext id="S3.SS3.p1.6.m6.2.2.1.3.cmml" xref="S3.SS3.p1.6.m6.2.2.1.3">
            LLM
           </mtext>
          </ci>
          <apply id="S3.SS3.p1.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1">
           <csymbol cd="latexml" id="S3.SS3.p1.6.m6.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.2">
            direct-sum
           </csymbol>
           <ci id="S3.SS3.p1.6.m6.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.3">
            𝑥
           </ci>
           <interval closure="open" id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1">
            <apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">
             <ci id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1.1">
              ~
             </ci>
             <ci id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">
              𝑥
             </ci>
            </apply>
            <apply id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <apply id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.2">
              <ci id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.2.1">
               ^
              </ci>
              <ci id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.2.2">
               𝑦
              </ci>
             </apply>
             <ci id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.1.1.3">
              𝑘
             </ci>
            </apply>
           </interval>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.2c">
        h\leftarrow\text{LLM}(x\oplus(\tilde{x},\hat{y}_{k}))
       </annotation>
      </semantics>
     </math>
     . In summary, a high-quality hypothesis
     <math alttext="h" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.1">
      <semantics id="S3.SS3.p1.7.m7.1a">
       <mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">
        h
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b">
        <ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">
         ℎ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">
        h
       </annotation>
      </semantics>
     </math>
     benefits from superior memory, which can be then refined through the produced hypothesis for subsequent selections. Consequently, Agent-R iterates in a boosting process optimized via reinforcement learning, where the states, actions, and rewards are detailed below.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p2">
    <p class="ltx_p" id="S3.SS3.p2.4">
     <span class="ltx_text ltx_font_bold" id="S3.SS3.p2.4.1">
      States.
     </span>
     The state
     <math alttext="s^{(R)}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1">
      <semantics id="S3.SS3.p2.1.m1.1a">
       <msup id="S3.SS3.p2.1.m1.1.2" xref="S3.SS3.p2.1.m1.1.2.cmml">
        <mi id="S3.SS3.p2.1.m1.1.2.2" xref="S3.SS3.p2.1.m1.1.2.2.cmml">
         s
        </mi>
        <mrow id="S3.SS3.p2.1.m1.1.1.1.3" xref="S3.SS3.p2.1.m1.1.2.cmml">
         <mo id="S3.SS3.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p2.1.m1.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS3.p2.1.m1.1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.1.cmml">
          R
         </mi>
         <mo id="S3.SS3.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p2.1.m1.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b">
        <apply id="S3.SS3.p2.1.m1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.2">
         <csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS3.p2.1.m1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.2.2">
          𝑠
         </ci>
         <ci id="S3.SS3.p2.1.m1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1">
          𝑅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">
        s^{(R)}
       </annotation>
      </semantics>
     </math>
     is defined to assess the semantic relevance between the produced hypothesis
     <math alttext="h" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1">
      <semantics id="S3.SS3.p2.2.m2.1a">
       <mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">
        h
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b">
        <ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">
         ℎ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">
        h
       </annotation>
      </semantics>
     </math>
     and the selected
     <math alttext="\hat{y}_{k}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1">
      <semantics id="S3.SS3.p2.3.m3.1a">
       <msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">
        <mover accent="true" id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">
         <mi id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml">
          y
         </mi>
         <mo id="S3.SS3.p2.3.m3.1.1.2.1" xref="S3.SS3.p2.3.m3.1.1.2.1.cmml">
          ^
         </mo>
        </mover>
        <mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">
         k
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b">
        <apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">
         <csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">
          subscript
         </csymbol>
         <apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">
          <ci id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1">
           ^
          </ci>
          <ci id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">
           𝑦
          </ci>
         </apply>
         <ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">
          𝑘
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">
        \hat{y}_{k}
       </annotation>
      </semantics>
     </math>
     from the pool
     <math alttext="\mathbb{C}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1">
      <semantics id="S3.SS3.p2.4.m4.1a">
       <mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">
        ℂ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b">
        <ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">
         ℂ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">
        \mathbb{C}
       </annotation>
      </semantics>
     </math>
     . The rationale is to identify a memory that closely resembles the hypothesis, which aligns with the human intuition that a superior demonstration sample often leads to better generation results, that is
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
     <tbody id="S3.E3">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle s^{(R)}=\{\text{sim}(\sigma(h),\sigma(\hat{y}_{k}))\}_{k=1}^{|K|}," class="ltx_Math" display="inline" id="S3.E3.m1.4">
         <semantics id="S3.E3.m1.4a">
          <mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.1.cmml">
           <mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml">
            <msup id="S3.E3.m1.4.4.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml">
             <mi id="S3.E3.m1.4.4.1.1.3.2" xref="S3.E3.m1.4.4.1.1.3.2.cmml">
              s
             </mi>
             <mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml">
              <mo id="S3.E3.m1.1.1.1.3.1" stretchy="false" xref="S3.E3.m1.4.4.1.1.3.cmml">
               (
              </mo>
              <mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">
               R
              </mi>
              <mo id="S3.E3.m1.1.1.1.3.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.3.cmml">
               )
              </mo>
             </mrow>
            </msup>
            <mo id="S3.E3.m1.4.4.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml">
             =
            </mo>
            <msubsup id="S3.E3.m1.4.4.1.1.1" xref="S3.E3.m1.4.4.1.1.1.cmml">
             <mrow id="S3.E3.m1.4.4.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.2.cmml">
              <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.2.cmml">
               {
              </mo>
              <mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.cmml">
               <mtext id="S3.E3.m1.4.4.1.1.1.1.1.1.1.4" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.4a.cmml">
                sim
               </mtext>
               <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.3.cmml">
                ​
               </mo>
               <mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.3.cmml">
                <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.3.cmml">
                 (
                </mo>
                <mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">
                 <mi id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">
                  σ
                 </mi>
                 <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" lspace="0em" rspace="0em" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  ​
                 </mo>
                 <mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">
                  <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">
                   (
                  </mo>
                  <mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">
                   h
                  </mi>
                  <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.4" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.3.cmml">
                 ,
                </mo>
                <mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml">
                 <mi id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.cmml">
                  σ
                 </mi>
                 <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.2" lspace="0em" rspace="0em" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.2.cmml">
                  ​
                 </mo>
                 <mrow id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">
                  <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">
                   (
                  </mo>
                  <msub id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">
                   <mover accent="true" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml">
                    <mi id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml">
                     y
                    </mi>
                    <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.2.1" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml">
                     ^
                    </mo>
                   </mover>
                   <mi id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml">
                    k
                   </mi>
                  </msub>
                  <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.3.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="S3.E3.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.4.4.1.1.1.1.1.2.cmml">
               }
              </mo>
             </mrow>
             <mrow id="S3.E3.m1.4.4.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.3.cmml">
              <mi id="S3.E3.m1.4.4.1.1.1.1.3.2" xref="S3.E3.m1.4.4.1.1.1.1.3.2.cmml">
               k
              </mi>
              <mo id="S3.E3.m1.4.4.1.1.1.1.3.1" xref="S3.E3.m1.4.4.1.1.1.1.3.1.cmml">
               =
              </mo>
              <mn id="S3.E3.m1.4.4.1.1.1.1.3.3" xref="S3.E3.m1.4.4.1.1.1.1.3.3.cmml">
               1
              </mn>
             </mrow>
             <mrow id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.2.2.1.2.cmml">
              <mo id="S3.E3.m1.2.2.1.3.1" stretchy="false" xref="S3.E3.m1.2.2.1.2.1.cmml">
               |
              </mo>
              <mi id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml">
               K
              </mi>
              <mo id="S3.E3.m1.2.2.1.3.2" stretchy="false" xref="S3.E3.m1.2.2.1.2.1.cmml">
               |
              </mo>
             </mrow>
            </msubsup>
           </mrow>
           <mo id="S3.E3.m1.4.4.1.2" xref="S3.E3.m1.4.4.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b">
           <apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1">
            <eq id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2">
            </eq>
            <apply id="S3.E3.m1.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3">
             <csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3">
              superscript
             </csymbol>
             <ci id="S3.E3.m1.4.4.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2">
              𝑠
             </ci>
             <ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">
              𝑅
             </ci>
            </apply>
            <apply id="S3.E3.m1.4.4.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1">
             <csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1">
              superscript
             </csymbol>
             <apply id="S3.E3.m1.4.4.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1">
              <csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1">
               subscript
              </csymbol>
              <set id="S3.E3.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1">
               <apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1">
                <times id="S3.E3.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.3">
                </times>
                <ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.4a.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.4">
                 <mtext id="S3.E3.m1.4.4.1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.4">
                  sim
                 </mtext>
                </ci>
                <interval closure="open" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2">
                 <apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1">
                  <times id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.1">
                  </times>
                  <ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">
                   𝜎
                  </ci>
                  <ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">
                   ℎ
                  </ci>
                 </apply>
                 <apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2">
                  <times id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.2">
                  </times>
                  <ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.3">
                   𝜎
                  </ci>
                  <apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1">
                   <csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1">
                    subscript
                   </csymbol>
                   <apply id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.2">
                    <ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.2.1">
                     ^
                    </ci>
                    <ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.2.2">
                     𝑦
                    </ci>
                   </apply>
                   <ci id="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1.1.1.2.2.2.1.1.1.3">
                    𝑘
                   </ci>
                  </apply>
                 </apply>
                </interval>
               </apply>
              </set>
              <apply id="S3.E3.m1.4.4.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.3">
               <eq id="S3.E3.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.3.1">
               </eq>
               <ci id="S3.E3.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.3.2">
                𝑘
               </ci>
               <cn id="S3.E3.m1.4.4.1.1.1.1.3.3.cmml" type="integer" xref="S3.E3.m1.4.4.1.1.1.1.3.3">
                1
               </cn>
              </apply>
             </apply>
             <apply id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1.3">
              <abs id="S3.E3.m1.2.2.1.2.1.cmml" xref="S3.E3.m1.2.2.1.3.1">
              </abs>
              <ci id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1">
               𝐾
              </ci>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E3.m1.4c">
           \displaystyle s^{(R)}=\{\text{sim}(\sigma(h),\sigma(\hat{y}_{k}))\}_{k=1}^{|K|},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (3)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS3.p2.6">
     where
     <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m1.1">
      <semantics id="S3.SS3.p2.5.m1.1a">
       <mrow id="S3.SS3.p2.5.m1.1.2" xref="S3.SS3.p2.5.m1.1.2.cmml">
        <mi id="S3.SS3.p2.5.m1.1.2.2" xref="S3.SS3.p2.5.m1.1.2.2.cmml">
         σ
        </mi>
        <mo id="S3.SS3.p2.5.m1.1.2.1" lspace="0em" rspace="0em" xref="S3.SS3.p2.5.m1.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS3.p2.5.m1.1.2.3.2" xref="S3.SS3.p2.5.m1.1.2.cmml">
         <mo id="S3.SS3.p2.5.m1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.5.m1.1.2.cmml">
          (
         </mo>
         <mo id="S3.SS3.p2.5.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p2.5.m1.1.1.cmml">
          ⋅
         </mo>
         <mo id="S3.SS3.p2.5.m1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.5.m1.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m1.1b">
        <apply id="S3.SS3.p2.5.m1.1.2.cmml" xref="S3.SS3.p2.5.m1.1.2">
         <times id="S3.SS3.p2.5.m1.1.2.1.cmml" xref="S3.SS3.p2.5.m1.1.2.1">
         </times>
         <ci id="S3.SS3.p2.5.m1.1.2.2.cmml" xref="S3.SS3.p2.5.m1.1.2.2">
          𝜎
         </ci>
         <ci id="S3.SS3.p2.5.m1.1.1.cmml" xref="S3.SS3.p2.5.m1.1.1">
          ⋅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.5.m1.1c">
        \sigma(\cdot)
       </annotation>
      </semantics>
     </math>
     denotes an embedded model, and
     <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m2.1">
      <semantics id="S3.SS3.p2.6.m2.1a">
       <mi id="S3.SS3.p2.6.m2.1.1" xref="S3.SS3.p2.6.m2.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m2.1b">
        <ci id="S3.SS3.p2.6.m2.1.1.cmml" xref="S3.SS3.p2.6.m2.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.6.m2.1c">
        K
       </annotation>
      </semantics>
     </math>
     governs the constructed state space.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p3">
    <p class="ltx_p" id="S3.SS3.p3.2">
     <span class="ltx_text ltx_font_bold" id="S3.SS3.p3.2.1">
      Actions.
     </span>
     Let
     <math alttext="a^{(R)}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1">
      <semantics id="S3.SS3.p3.1.m1.1a">
       <msup id="S3.SS3.p3.1.m1.1.2" xref="S3.SS3.p3.1.m1.1.2.cmml">
        <mi id="S3.SS3.p3.1.m1.1.2.2" xref="S3.SS3.p3.1.m1.1.2.2.cmml">
         a
        </mi>
        <mrow id="S3.SS3.p3.1.m1.1.1.1.3" xref="S3.SS3.p3.1.m1.1.2.cmml">
         <mo id="S3.SS3.p3.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.1.m1.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS3.p3.1.m1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.cmml">
          R
         </mi>
         <mo id="S3.SS3.p3.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.1.m1.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b">
        <apply id="S3.SS3.p3.1.m1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.2">
         <csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS3.p3.1.m1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.1.2.2">
          𝑎
         </ci>
         <ci id="S3.SS3.p3.1.m1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1">
          𝑅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">
        a^{(R)}
       </annotation>
      </semantics>
     </math>
     represent an action taken by Agent-R. The design is consistent with the state
     <math alttext="s^{(R)}" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1">
      <semantics id="S3.SS3.p3.2.m2.1a">
       <msup id="S3.SS3.p3.2.m2.1.2" xref="S3.SS3.p3.2.m2.1.2.cmml">
        <mi id="S3.SS3.p3.2.m2.1.2.2" xref="S3.SS3.p3.2.m2.1.2.2.cmml">
         s
        </mi>
        <mrow id="S3.SS3.p3.2.m2.1.1.1.3" xref="S3.SS3.p3.2.m2.1.2.cmml">
         <mo id="S3.SS3.p3.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.2.m2.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS3.p3.2.m2.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.cmml">
          R
         </mi>
         <mo id="S3.SS3.p3.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.2.m2.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b">
        <apply id="S3.SS3.p3.2.m2.1.2.cmml" xref="S3.SS3.p3.2.m2.1.2">
         <csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.2.1.cmml" xref="S3.SS3.p3.2.m2.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS3.p3.2.m2.1.2.2.cmml" xref="S3.SS3.p3.2.m2.1.2.2">
          𝑠
         </ci>
         <ci id="S3.SS3.p3.2.m2.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1">
          𝑅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">
        s^{(R)}
       </annotation>
      </semantics>
     </math>
     , which involves selecting a candidate memory from the pool, that is
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx4">
     <tbody id="S3.E4">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle a^{(R)}=k\ (1\leq k\leq K)." class="ltx_Math" display="inline" id="S3.E4.m1.2">
         <semantics id="S3.E4.m1.2a">
          <mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml">
           <mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">
            <msup id="S3.E4.m1.2.2.1.1.3" xref="S3.E4.m1.2.2.1.1.3.cmml">
             <mi id="S3.E4.m1.2.2.1.1.3.2" xref="S3.E4.m1.2.2.1.1.3.2.cmml">
              a
             </mi>
             <mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.3.cmml">
              <mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.2.2.1.1.3.cmml">
               (
              </mo>
              <mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">
               R
              </mi>
              <mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.2.2.1.1.3.cmml">
               )
              </mo>
             </mrow>
            </msup>
            <mo id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.cmml">
             =
            </mo>
            <mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml">
             <mi id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.3.cmml">
              k
             </mi>
             <mo id="S3.E4.m1.2.2.1.1.1.2" lspace="0.500em" rspace="0em" xref="S3.E4.m1.2.2.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="S3.E4.m1.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">
              <mo id="S3.E4.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="S3.E4.m1.2.2.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">
               <mn id="S3.E4.m1.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml">
                1
               </mn>
               <mo id="S3.E4.m1.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml">
                ≤
               </mo>
               <mi id="S3.E4.m1.2.2.1.1.1.1.1.1.4" xref="S3.E4.m1.2.2.1.1.1.1.1.1.4.cmml">
                k
               </mi>
               <mo id="S3.E4.m1.2.2.1.1.1.1.1.1.5" xref="S3.E4.m1.2.2.1.1.1.1.1.1.5.cmml">
                ≤
               </mo>
               <mi id="S3.E4.m1.2.2.1.1.1.1.1.1.6" xref="S3.E4.m1.2.2.1.1.1.1.1.1.6.cmml">
                K
               </mi>
              </mrow>
              <mo id="S3.E4.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S3.E4.m1.2.2.1.2" lspace="0em" xref="S3.E4.m1.2.2.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b">
           <apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1">
            <eq id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2">
            </eq>
            <apply id="S3.E4.m1.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3">
             <csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.3">
              superscript
             </csymbol>
             <ci id="S3.E4.m1.2.2.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3.2">
              𝑎
             </ci>
             <ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">
              𝑅
             </ci>
            </apply>
            <apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1">
             <times id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2">
             </times>
             <ci id="S3.E4.m1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3">
              𝑘
             </ci>
             <apply id="S3.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1">
              <and id="S3.E4.m1.2.2.1.1.1.1.1.1a.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1">
              </and>
              <apply id="S3.E4.m1.2.2.1.1.1.1.1.1b.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1">
               <leq id="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3">
               </leq>
               <cn id="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2">
                1
               </cn>
               <ci id="S3.E4.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.4">
                𝑘
               </ci>
              </apply>
              <apply id="S3.E4.m1.2.2.1.1.1.1.1.1c.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1">
               <leq id="S3.E4.m1.2.2.1.1.1.1.1.1.5.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.5">
               </leq>
               <share href="#S3.E4.m1.2.2.1.1.1.1.1.1.4.cmml" id="S3.E4.m1.2.2.1.1.1.1.1.1d.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1">
               </share>
               <ci id="S3.E4.m1.2.2.1.1.1.1.1.1.6.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.6">
                𝐾
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E4.m1.2c">
           \displaystyle a^{(R)}=k\ (1\leq k\leq K).
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (4)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p4">
    <p class="ltx_p" id="S3.SS3.p4.10">
     <span class="ltx_text ltx_font_bold" id="S3.SS3.p4.10.1">
      Rewards.
     </span>
     We denote the reward of Agent-R as
     <math alttext="r_{t}^{(R)}" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1">
      <semantics id="S3.SS3.p4.1.m1.1a">
       <msubsup id="S3.SS3.p4.1.m1.1.2" xref="S3.SS3.p4.1.m1.1.2.cmml">
        <mi id="S3.SS3.p4.1.m1.1.2.2.2" xref="S3.SS3.p4.1.m1.1.2.2.2.cmml">
         r
        </mi>
        <mi id="S3.SS3.p4.1.m1.1.2.2.3" xref="S3.SS3.p4.1.m1.1.2.2.3.cmml">
         t
        </mi>
        <mrow id="S3.SS3.p4.1.m1.1.1.1.3" xref="S3.SS3.p4.1.m1.1.2.cmml">
         <mo id="S3.SS3.p4.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p4.1.m1.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS3.p4.1.m1.1.1.1.1" xref="S3.SS3.p4.1.m1.1.1.1.1.cmml">
          R
         </mi>
         <mo id="S3.SS3.p4.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p4.1.m1.1.2.cmml">
          )
         </mo>
        </mrow>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b">
        <apply id="S3.SS3.p4.1.m1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.2">
         <csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.2.1.cmml" xref="S3.SS3.p4.1.m1.1.2">
          superscript
         </csymbol>
         <apply id="S3.SS3.p4.1.m1.1.2.2.cmml" xref="S3.SS3.p4.1.m1.1.2">
          <csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.2.2.1.cmml" xref="S3.SS3.p4.1.m1.1.2">
           subscript
          </csymbol>
          <ci id="S3.SS3.p4.1.m1.1.2.2.2.cmml" xref="S3.SS3.p4.1.m1.1.2.2.2">
           𝑟
          </ci>
          <ci id="S3.SS3.p4.1.m1.1.2.2.3.cmml" xref="S3.SS3.p4.1.m1.1.2.2.3">
           𝑡
          </ci>
         </apply>
         <ci id="S3.SS3.p4.1.m1.1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1.1.1">
          𝑅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">
        r_{t}^{(R)}
       </annotation>
      </semantics>
     </math>
     , which corresponds to the transition from the current state
     <math alttext="\mathbf{s}_{t}^{(R)}" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.1">
      <semantics id="S3.SS3.p4.2.m2.1a">
       <msubsup id="S3.SS3.p4.2.m2.1.2" xref="S3.SS3.p4.2.m2.1.2.cmml">
        <mi id="S3.SS3.p4.2.m2.1.2.2.2" xref="S3.SS3.p4.2.m2.1.2.2.2.cmml">
         𝐬
        </mi>
        <mi id="S3.SS3.p4.2.m2.1.2.2.3" xref="S3.SS3.p4.2.m2.1.2.2.3.cmml">
         t
        </mi>
        <mrow id="S3.SS3.p4.2.m2.1.1.1.3" xref="S3.SS3.p4.2.m2.1.2.cmml">
         <mo id="S3.SS3.p4.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.p4.2.m2.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS3.p4.2.m2.1.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.1.cmml">
          R
         </mi>
         <mo id="S3.SS3.p4.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.p4.2.m2.1.2.cmml">
          )
         </mo>
        </mrow>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b">
        <apply id="S3.SS3.p4.2.m2.1.2.cmml" xref="S3.SS3.p4.2.m2.1.2">
         <csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.2.1.cmml" xref="S3.SS3.p4.2.m2.1.2">
          superscript
         </csymbol>
         <apply id="S3.SS3.p4.2.m2.1.2.2.cmml" xref="S3.SS3.p4.2.m2.1.2">
          <csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.2.2.1.cmml" xref="S3.SS3.p4.2.m2.1.2">
           subscript
          </csymbol>
          <ci id="S3.SS3.p4.2.m2.1.2.2.2.cmml" xref="S3.SS3.p4.2.m2.1.2.2.2">
           𝐬
          </ci>
          <ci id="S3.SS3.p4.2.m2.1.2.2.3.cmml" xref="S3.SS3.p4.2.m2.1.2.2.3">
           𝑡
          </ci>
         </apply>
         <ci id="S3.SS3.p4.2.m2.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1">
          𝑅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">
        \mathbf{s}_{t}^{(R)}
       </annotation>
      </semantics>
     </math>
     to the next state
     <math alttext="\mathbf{s}_{t+1}^{(R)}" class="ltx_Math" display="inline" id="S3.SS3.p4.3.m3.1">
      <semantics id="S3.SS3.p4.3.m3.1a">
       <msubsup id="S3.SS3.p4.3.m3.1.2" xref="S3.SS3.p4.3.m3.1.2.cmml">
        <mi id="S3.SS3.p4.3.m3.1.2.2.2" xref="S3.SS3.p4.3.m3.1.2.2.2.cmml">
         𝐬
        </mi>
        <mrow id="S3.SS3.p4.3.m3.1.2.2.3" xref="S3.SS3.p4.3.m3.1.2.2.3.cmml">
         <mi id="S3.SS3.p4.3.m3.1.2.2.3.2" xref="S3.SS3.p4.3.m3.1.2.2.3.2.cmml">
          t
         </mi>
         <mo id="S3.SS3.p4.3.m3.1.2.2.3.1" xref="S3.SS3.p4.3.m3.1.2.2.3.1.cmml">
          +
         </mo>
         <mn id="S3.SS3.p4.3.m3.1.2.2.3.3" xref="S3.SS3.p4.3.m3.1.2.2.3.3.cmml">
          1
         </mn>
        </mrow>
        <mrow id="S3.SS3.p4.3.m3.1.1.1.3" xref="S3.SS3.p4.3.m3.1.2.cmml">
         <mo id="S3.SS3.p4.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.p4.3.m3.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS3.p4.3.m3.1.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.1.cmml">
          R
         </mi>
         <mo id="S3.SS3.p4.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.p4.3.m3.1.2.cmml">
          )
         </mo>
        </mrow>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b">
        <apply id="S3.SS3.p4.3.m3.1.2.cmml" xref="S3.SS3.p4.3.m3.1.2">
         <csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.2.1.cmml" xref="S3.SS3.p4.3.m3.1.2">
          superscript
         </csymbol>
         <apply id="S3.SS3.p4.3.m3.1.2.2.cmml" xref="S3.SS3.p4.3.m3.1.2">
          <csymbol cd="ambiguous" id="S3.SS3.p4.3.m3.1.2.2.1.cmml" xref="S3.SS3.p4.3.m3.1.2">
           subscript
          </csymbol>
          <ci id="S3.SS3.p4.3.m3.1.2.2.2.cmml" xref="S3.SS3.p4.3.m3.1.2.2.2">
           𝐬
          </ci>
          <apply id="S3.SS3.p4.3.m3.1.2.2.3.cmml" xref="S3.SS3.p4.3.m3.1.2.2.3">
           <plus id="S3.SS3.p4.3.m3.1.2.2.3.1.cmml" xref="S3.SS3.p4.3.m3.1.2.2.3.1">
           </plus>
           <ci id="S3.SS3.p4.3.m3.1.2.2.3.2.cmml" xref="S3.SS3.p4.3.m3.1.2.2.3.2">
            𝑡
           </ci>
           <cn id="S3.SS3.p4.3.m3.1.2.2.3.3.cmml" type="integer" xref="S3.SS3.p4.3.m3.1.2.2.3.3">
            1
           </cn>
          </apply>
         </apply>
         <ci id="S3.SS3.p4.3.m3.1.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1.1">
          𝑅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">
        \mathbf{s}_{t+1}^{(R)}
       </annotation>
      </semantics>
     </math>
     after taking action
     <math alttext="a_{t}^{(R)}" class="ltx_Math" display="inline" id="S3.SS3.p4.4.m4.1">
      <semantics id="S3.SS3.p4.4.m4.1a">
       <msubsup id="S3.SS3.p4.4.m4.1.2" xref="S3.SS3.p4.4.m4.1.2.cmml">
        <mi id="S3.SS3.p4.4.m4.1.2.2.2" xref="S3.SS3.p4.4.m4.1.2.2.2.cmml">
         a
        </mi>
        <mi id="S3.SS3.p4.4.m4.1.2.2.3" xref="S3.SS3.p4.4.m4.1.2.2.3.cmml">
         t
        </mi>
        <mrow id="S3.SS3.p4.4.m4.1.1.1.3" xref="S3.SS3.p4.4.m4.1.2.cmml">
         <mo id="S3.SS3.p4.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS3.p4.4.m4.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS3.p4.4.m4.1.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.1.cmml">
          R
         </mi>
         <mo id="S3.SS3.p4.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS3.p4.4.m4.1.2.cmml">
          )
         </mo>
        </mrow>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b">
        <apply id="S3.SS3.p4.4.m4.1.2.cmml" xref="S3.SS3.p4.4.m4.1.2">
         <csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.2.1.cmml" xref="S3.SS3.p4.4.m4.1.2">
          superscript
         </csymbol>
         <apply id="S3.SS3.p4.4.m4.1.2.2.cmml" xref="S3.SS3.p4.4.m4.1.2">
          <csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.2.2.1.cmml" xref="S3.SS3.p4.4.m4.1.2">
           subscript
          </csymbol>
          <ci id="S3.SS3.p4.4.m4.1.2.2.2.cmml" xref="S3.SS3.p4.4.m4.1.2.2.2">
           𝑎
          </ci>
          <ci id="S3.SS3.p4.4.m4.1.2.2.3.cmml" xref="S3.SS3.p4.4.m4.1.2.2.3">
           𝑡
          </ci>
         </apply>
         <ci id="S3.SS3.p4.4.m4.1.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1">
          𝑅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">
        a_{t}^{(R)}
       </annotation>
      </semantics>
     </math>
     . Specifically, when a memory
     <math alttext="(\tilde{x},\hat{y}_{k})" class="ltx_Math" display="inline" id="S3.SS3.p4.5.m5.2">
      <semantics id="S3.SS3.p4.5.m5.2a">
       <mrow id="S3.SS3.p4.5.m5.2.2.1" xref="S3.SS3.p4.5.m5.2.2.2.cmml">
        <mo id="S3.SS3.p4.5.m5.2.2.1.2" stretchy="false" xref="S3.SS3.p4.5.m5.2.2.2.cmml">
         (
        </mo>
        <mover accent="true" id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">
         <mi id="S3.SS3.p4.5.m5.1.1.2" xref="S3.SS3.p4.5.m5.1.1.2.cmml">
          x
         </mi>
         <mo id="S3.SS3.p4.5.m5.1.1.1" xref="S3.SS3.p4.5.m5.1.1.1.cmml">
          ~
         </mo>
        </mover>
        <mo id="S3.SS3.p4.5.m5.2.2.1.3" xref="S3.SS3.p4.5.m5.2.2.2.cmml">
         ,
        </mo>
        <msub id="S3.SS3.p4.5.m5.2.2.1.1" xref="S3.SS3.p4.5.m5.2.2.1.1.cmml">
         <mover accent="true" id="S3.SS3.p4.5.m5.2.2.1.1.2" xref="S3.SS3.p4.5.m5.2.2.1.1.2.cmml">
          <mi id="S3.SS3.p4.5.m5.2.2.1.1.2.2" xref="S3.SS3.p4.5.m5.2.2.1.1.2.2.cmml">
           y
          </mi>
          <mo id="S3.SS3.p4.5.m5.2.2.1.1.2.1" xref="S3.SS3.p4.5.m5.2.2.1.1.2.1.cmml">
           ^
          </mo>
         </mover>
         <mi id="S3.SS3.p4.5.m5.2.2.1.1.3" xref="S3.SS3.p4.5.m5.2.2.1.1.3.cmml">
          k
         </mi>
        </msub>
        <mo id="S3.SS3.p4.5.m5.2.2.1.4" stretchy="false" xref="S3.SS3.p4.5.m5.2.2.2.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.2b">
        <interval closure="open" id="S3.SS3.p4.5.m5.2.2.2.cmml" xref="S3.SS3.p4.5.m5.2.2.1">
         <apply id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">
          <ci id="S3.SS3.p4.5.m5.1.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1.1">
           ~
          </ci>
          <ci id="S3.SS3.p4.5.m5.1.1.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2">
           𝑥
          </ci>
         </apply>
         <apply id="S3.SS3.p4.5.m5.2.2.1.1.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1">
          <csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.2.2.1.1.1.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1">
           subscript
          </csymbol>
          <apply id="S3.SS3.p4.5.m5.2.2.1.1.2.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.2">
           <ci id="S3.SS3.p4.5.m5.2.2.1.1.2.1.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.2.1">
            ^
           </ci>
           <ci id="S3.SS3.p4.5.m5.2.2.1.1.2.2.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.2.2">
            𝑦
           </ci>
          </apply>
          <ci id="S3.SS3.p4.5.m5.2.2.1.1.3.cmml" xref="S3.SS3.p4.5.m5.2.2.1.1.3">
           𝑘
          </ci>
         </apply>
        </interval>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.2c">
        (\tilde{x},\hat{y}_{k})
       </annotation>
      </semantics>
     </math>
     is updated, the hypothesis changes from
     <math alttext="h" class="ltx_Math" display="inline" id="S3.SS3.p4.6.m6.1">
      <semantics id="S3.SS3.p4.6.m6.1a">
       <mi id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml">
        h
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b">
        <ci id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">
         ℎ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">
        h
       </annotation>
      </semantics>
     </math>
     to
     <math alttext="h^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.p4.7.m7.1">
      <semantics id="S3.SS3.p4.7.m7.1a">
       <msup id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml">
        <mi id="S3.SS3.p4.7.m7.1.1.2" xref="S3.SS3.p4.7.m7.1.1.2.cmml">
         h
        </mi>
        <mo id="S3.SS3.p4.7.m7.1.1.3" xref="S3.SS3.p4.7.m7.1.1.3.cmml">
         ′
        </mo>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b">
        <apply id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1">
         <csymbol cd="ambiguous" id="S3.SS3.p4.7.m7.1.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS3.p4.7.m7.1.1.2.cmml" xref="S3.SS3.p4.7.m7.1.1.2">
          ℎ
         </ci>
         <ci id="S3.SS3.p4.7.m7.1.1.3.cmml" xref="S3.SS3.p4.7.m7.1.1.3">
          ′
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">
        h^{\prime}
       </annotation>
      </semantics>
     </math>
     accordingly. We remark that the best hypothesis (denoted as
     <math alttext="h^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.p4.8.m8.1">
      <semantics id="S3.SS3.p4.8.m8.1a">
       <msup id="S3.SS3.p4.8.m8.1.1" xref="S3.SS3.p4.8.m8.1.1.cmml">
        <mi id="S3.SS3.p4.8.m8.1.1.2" xref="S3.SS3.p4.8.m8.1.1.2.cmml">
         h
        </mi>
        <mo id="S3.SS3.p4.8.m8.1.1.3" xref="S3.SS3.p4.8.m8.1.1.3.cmml">
         ′
        </mo>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.8.m8.1b">
        <apply id="S3.SS3.p4.8.m8.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1">
         <csymbol cd="ambiguous" id="S3.SS3.p4.8.m8.1.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS3.p4.8.m8.1.1.2.cmml" xref="S3.SS3.p4.8.m8.1.1.2">
          ℎ
         </ci>
         <ci id="S3.SS3.p4.8.m8.1.1.3.cmml" xref="S3.SS3.p4.8.m8.1.1.3">
          ′
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.8.m8.1c">
        h^{\prime}
       </annotation>
      </semantics>
     </math>
     ) identified at state
     <math alttext="s^{(R)}" class="ltx_Math" display="inline" id="S3.SS3.p4.9.m9.1">
      <semantics id="S3.SS3.p4.9.m9.1a">
       <msup id="S3.SS3.p4.9.m9.1.2" xref="S3.SS3.p4.9.m9.1.2.cmml">
        <mi id="S3.SS3.p4.9.m9.1.2.2" xref="S3.SS3.p4.9.m9.1.2.2.cmml">
         s
        </mi>
        <mrow id="S3.SS3.p4.9.m9.1.1.1.3" xref="S3.SS3.p4.9.m9.1.2.cmml">
         <mo id="S3.SS3.p4.9.m9.1.1.1.3.1" stretchy="false" xref="S3.SS3.p4.9.m9.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS3.p4.9.m9.1.1.1.1" xref="S3.SS3.p4.9.m9.1.1.1.1.cmml">
          R
         </mi>
         <mo id="S3.SS3.p4.9.m9.1.1.1.3.2" stretchy="false" xref="S3.SS3.p4.9.m9.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.9.m9.1b">
        <apply id="S3.SS3.p4.9.m9.1.2.cmml" xref="S3.SS3.p4.9.m9.1.2">
         <csymbol cd="ambiguous" id="S3.SS3.p4.9.m9.1.2.1.cmml" xref="S3.SS3.p4.9.m9.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS3.p4.9.m9.1.2.2.cmml" xref="S3.SS3.p4.9.m9.1.2.2">
          𝑠
         </ci>
         <ci id="S3.SS3.p4.9.m9.1.1.1.1.cmml" xref="S3.SS3.p4.9.m9.1.1.1.1">
          𝑅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.9.m9.1c">
        s^{(R)}
       </annotation>
      </semantics>
     </math>
     is maintained according to a specific metric
     <math alttext="\Delta(\cdot,\cdot)" class="ltx_Math" display="inline" id="S3.SS3.p4.10.m10.2">
      <semantics id="S3.SS3.p4.10.m10.2a">
       <mrow id="S3.SS3.p4.10.m10.2.3" xref="S3.SS3.p4.10.m10.2.3.cmml">
        <mi id="S3.SS3.p4.10.m10.2.3.2" mathvariant="normal" xref="S3.SS3.p4.10.m10.2.3.2.cmml">
         Δ
        </mi>
        <mo id="S3.SS3.p4.10.m10.2.3.1" lspace="0em" rspace="0em" xref="S3.SS3.p4.10.m10.2.3.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS3.p4.10.m10.2.3.3.2" xref="S3.SS3.p4.10.m10.2.3.3.1.cmml">
         <mo id="S3.SS3.p4.10.m10.2.3.3.2.1" stretchy="false" xref="S3.SS3.p4.10.m10.2.3.3.1.cmml">
          (
         </mo>
         <mo id="S3.SS3.p4.10.m10.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p4.10.m10.1.1.cmml">
          ⋅
         </mo>
         <mo id="S3.SS3.p4.10.m10.2.3.3.2.2" rspace="0em" xref="S3.SS3.p4.10.m10.2.3.3.1.cmml">
          ,
         </mo>
         <mo id="S3.SS3.p4.10.m10.2.2" lspace="0em" rspace="0em" xref="S3.SS3.p4.10.m10.2.2.cmml">
          ⋅
         </mo>
         <mo id="S3.SS3.p4.10.m10.2.3.3.2.3" stretchy="false" xref="S3.SS3.p4.10.m10.2.3.3.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p4.10.m10.2b">
        <apply id="S3.SS3.p4.10.m10.2.3.cmml" xref="S3.SS3.p4.10.m10.2.3">
         <times id="S3.SS3.p4.10.m10.2.3.1.cmml" xref="S3.SS3.p4.10.m10.2.3.1">
         </times>
         <ci id="S3.SS3.p4.10.m10.2.3.2.cmml" xref="S3.SS3.p4.10.m10.2.3.2">
          Δ
         </ci>
         <interval closure="open" id="S3.SS3.p4.10.m10.2.3.3.1.cmml" xref="S3.SS3.p4.10.m10.2.3.3.2">
          <ci id="S3.SS3.p4.10.m10.1.1.cmml" xref="S3.SS3.p4.10.m10.1.1">
           ⋅
          </ci>
          <ci id="S3.SS3.p4.10.m10.2.2.cmml" xref="S3.SS3.p4.10.m10.2.2">
           ⋅
          </ci>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p4.10.m10.2c">
        \Delta(\cdot,\cdot)
       </annotation>
      </semantics>
     </math>
     (e.g., ROUGE for text summarization, BLEU for machine translation, BLEU and Distinct for dialogue generation), and the reward is defined as:
    </p>
   </div>
   <figure class="ltx_float ltx_algorithm" id="alg1">
    <div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg1.35">
     <div class="ltx_listingline" id="alg1.2.2">
      <span class="ltx_text ltx_font_bold" id="alg1.2.2.1">
       Require :
      </span>
      a database
      <math alttext="\mathbb{D}" class="ltx_Math" display="inline" id="alg1.1.1.m1.1">
       <semantics id="alg1.1.1.m1.1a">
        <mi id="alg1.1.1.m1.1.1" xref="alg1.1.1.m1.1.1.cmml">
         𝔻
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.1.1.m1.1b">
         <ci id="alg1.1.1.m1.1.1.cmml" xref="alg1.1.1.m1.1.1">
          𝔻
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.1.1.m1.1c">
         \mathbb{D}
        </annotation>
       </semantics>
      </math>
      ; a frozen
      <math alttext="\text{LLM}(\cdot)" class="ltx_Math" display="inline" id="alg1.2.2.m2.1">
       <semantics id="alg1.2.2.m2.1a">
        <mrow id="alg1.2.2.m2.1.2" xref="alg1.2.2.m2.1.2.cmml">
         <mtext id="alg1.2.2.m2.1.2.2" xref="alg1.2.2.m2.1.2.2a.cmml">
          LLM
         </mtext>
         <mo id="alg1.2.2.m2.1.2.1" lspace="0em" rspace="0em" xref="alg1.2.2.m2.1.2.1.cmml">
          ​
         </mo>
         <mrow id="alg1.2.2.m2.1.2.3.2" xref="alg1.2.2.m2.1.2.cmml">
          <mo id="alg1.2.2.m2.1.2.3.2.1" stretchy="false" xref="alg1.2.2.m2.1.2.cmml">
           (
          </mo>
          <mo id="alg1.2.2.m2.1.1" lspace="0em" rspace="0em" xref="alg1.2.2.m2.1.1.cmml">
           ⋅
          </mo>
          <mo id="alg1.2.2.m2.1.2.3.2.2" stretchy="false" xref="alg1.2.2.m2.1.2.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.2.2.m2.1b">
         <apply id="alg1.2.2.m2.1.2.cmml" xref="alg1.2.2.m2.1.2">
          <times id="alg1.2.2.m2.1.2.1.cmml" xref="alg1.2.2.m2.1.2.1">
          </times>
          <ci id="alg1.2.2.m2.1.2.2a.cmml" xref="alg1.2.2.m2.1.2.2">
           <mtext id="alg1.2.2.m2.1.2.2.cmml" xref="alg1.2.2.m2.1.2.2">
            LLM
           </mtext>
          </ci>
          <ci id="alg1.2.2.m2.1.1.cmml" xref="alg1.2.2.m2.1.1">
           ⋅
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.2.2.m2.1c">
         \text{LLM}(\cdot)
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.3.3">
      <span class="ltx_tag ltx_tag_listingline">
       1
      </span>
      obtain
      <math alttext="\mathbb{D}=\{D_{m}\}_{m=1}^{|M|}" class="ltx_Math" display="inline" id="alg1.3.3.m1.2">
       <semantics id="alg1.3.3.m1.2a">
        <mrow id="alg1.3.3.m1.2.2" xref="alg1.3.3.m1.2.2.cmml">
         <mi id="alg1.3.3.m1.2.2.3" xref="alg1.3.3.m1.2.2.3.cmml">
          𝔻
         </mi>
         <mo id="alg1.3.3.m1.2.2.2" xref="alg1.3.3.m1.2.2.2.cmml">
          =
         </mo>
         <msubsup id="alg1.3.3.m1.2.2.1" xref="alg1.3.3.m1.2.2.1.cmml">
          <mrow id="alg1.3.3.m1.2.2.1.1.1.1" xref="alg1.3.3.m1.2.2.1.1.1.2.cmml">
           <mo id="alg1.3.3.m1.2.2.1.1.1.1.2" stretchy="false" xref="alg1.3.3.m1.2.2.1.1.1.2.cmml">
            {
           </mo>
           <msub id="alg1.3.3.m1.2.2.1.1.1.1.1" xref="alg1.3.3.m1.2.2.1.1.1.1.1.cmml">
            <mi id="alg1.3.3.m1.2.2.1.1.1.1.1.2" xref="alg1.3.3.m1.2.2.1.1.1.1.1.2.cmml">
             D
            </mi>
            <mi id="alg1.3.3.m1.2.2.1.1.1.1.1.3" xref="alg1.3.3.m1.2.2.1.1.1.1.1.3.cmml">
             m
            </mi>
           </msub>
           <mo id="alg1.3.3.m1.2.2.1.1.1.1.3" stretchy="false" xref="alg1.3.3.m1.2.2.1.1.1.2.cmml">
            }
           </mo>
          </mrow>
          <mrow id="alg1.3.3.m1.2.2.1.1.3" xref="alg1.3.3.m1.2.2.1.1.3.cmml">
           <mi id="alg1.3.3.m1.2.2.1.1.3.2" xref="alg1.3.3.m1.2.2.1.1.3.2.cmml">
            m
           </mi>
           <mo id="alg1.3.3.m1.2.2.1.1.3.1" xref="alg1.3.3.m1.2.2.1.1.3.1.cmml">
            =
           </mo>
           <mn id="alg1.3.3.m1.2.2.1.1.3.3" xref="alg1.3.3.m1.2.2.1.1.3.3.cmml">
            1
           </mn>
          </mrow>
          <mrow id="alg1.3.3.m1.1.1.1.3" xref="alg1.3.3.m1.1.1.1.2.cmml">
           <mo id="alg1.3.3.m1.1.1.1.3.1" stretchy="false" xref="alg1.3.3.m1.1.1.1.2.1.cmml">
            |
           </mo>
           <mi id="alg1.3.3.m1.1.1.1.1" xref="alg1.3.3.m1.1.1.1.1.cmml">
            M
           </mi>
           <mo id="alg1.3.3.m1.1.1.1.3.2" stretchy="false" xref="alg1.3.3.m1.1.1.1.2.1.cmml">
            |
           </mo>
          </mrow>
         </msubsup>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.3.3.m1.2b">
         <apply id="alg1.3.3.m1.2.2.cmml" xref="alg1.3.3.m1.2.2">
          <eq id="alg1.3.3.m1.2.2.2.cmml" xref="alg1.3.3.m1.2.2.2">
          </eq>
          <ci id="alg1.3.3.m1.2.2.3.cmml" xref="alg1.3.3.m1.2.2.3">
           𝔻
          </ci>
          <apply id="alg1.3.3.m1.2.2.1.cmml" xref="alg1.3.3.m1.2.2.1">
           <csymbol cd="ambiguous" id="alg1.3.3.m1.2.2.1.2.cmml" xref="alg1.3.3.m1.2.2.1">
            superscript
           </csymbol>
           <apply id="alg1.3.3.m1.2.2.1.1.cmml" xref="alg1.3.3.m1.2.2.1">
            <csymbol cd="ambiguous" id="alg1.3.3.m1.2.2.1.1.2.cmml" xref="alg1.3.3.m1.2.2.1">
             subscript
            </csymbol>
            <set id="alg1.3.3.m1.2.2.1.1.1.2.cmml" xref="alg1.3.3.m1.2.2.1.1.1.1">
             <apply id="alg1.3.3.m1.2.2.1.1.1.1.1.cmml" xref="alg1.3.3.m1.2.2.1.1.1.1.1">
              <csymbol cd="ambiguous" id="alg1.3.3.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.3.3.m1.2.2.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="alg1.3.3.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.3.3.m1.2.2.1.1.1.1.1.2">
               𝐷
              </ci>
              <ci id="alg1.3.3.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.3.3.m1.2.2.1.1.1.1.1.3">
               𝑚
              </ci>
             </apply>
            </set>
            <apply id="alg1.3.3.m1.2.2.1.1.3.cmml" xref="alg1.3.3.m1.2.2.1.1.3">
             <eq id="alg1.3.3.m1.2.2.1.1.3.1.cmml" xref="alg1.3.3.m1.2.2.1.1.3.1">
             </eq>
             <ci id="alg1.3.3.m1.2.2.1.1.3.2.cmml" xref="alg1.3.3.m1.2.2.1.1.3.2">
              𝑚
             </ci>
             <cn id="alg1.3.3.m1.2.2.1.1.3.3.cmml" type="integer" xref="alg1.3.3.m1.2.2.1.1.3.3">
              1
             </cn>
            </apply>
           </apply>
           <apply id="alg1.3.3.m1.1.1.1.2.cmml" xref="alg1.3.3.m1.1.1.1.3">
            <abs id="alg1.3.3.m1.1.1.1.2.1.cmml" xref="alg1.3.3.m1.1.1.1.3.1">
            </abs>
            <ci id="alg1.3.3.m1.1.1.1.1.cmml" xref="alg1.3.3.m1.1.1.1.1">
             𝑀
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.3.3.m1.2c">
         \mathbb{D}=\{D_{m}\}_{m=1}^{|M|}
        </annotation>
       </semantics>
      </math>
      via a partitioning strategy
     </div>
     <div class="ltx_listingline" id="alg1.5.5">
      <span class="ltx_tag ltx_tag_listingline">
       2
      </span>
      initialize Ag-S
      <math alttext="\pi_{\theta}(a^{(S)}|s^{(S)})" class="ltx_Math" display="inline" id="alg1.4.4.m1.3">
       <semantics id="alg1.4.4.m1.3a">
        <mrow id="alg1.4.4.m1.3.3" xref="alg1.4.4.m1.3.3.cmml">
         <msub id="alg1.4.4.m1.3.3.3" xref="alg1.4.4.m1.3.3.3.cmml">
          <mi id="alg1.4.4.m1.3.3.3.2" xref="alg1.4.4.m1.3.3.3.2.cmml">
           π
          </mi>
          <mi id="alg1.4.4.m1.3.3.3.3" xref="alg1.4.4.m1.3.3.3.3.cmml">
           θ
          </mi>
         </msub>
         <mo id="alg1.4.4.m1.3.3.2" lspace="0em" rspace="0em" xref="alg1.4.4.m1.3.3.2.cmml">
          ​
         </mo>
         <mrow id="alg1.4.4.m1.3.3.1.1" xref="alg1.4.4.m1.3.3.1.1.1.cmml">
          <mo id="alg1.4.4.m1.3.3.1.1.2" stretchy="false" xref="alg1.4.4.m1.3.3.1.1.1.cmml">
           (
          </mo>
          <mrow id="alg1.4.4.m1.3.3.1.1.1" xref="alg1.4.4.m1.3.3.1.1.1.cmml">
           <msup id="alg1.4.4.m1.3.3.1.1.1.2" xref="alg1.4.4.m1.3.3.1.1.1.2.cmml">
            <mi id="alg1.4.4.m1.3.3.1.1.1.2.2" xref="alg1.4.4.m1.3.3.1.1.1.2.2.cmml">
             a
            </mi>
            <mrow id="alg1.4.4.m1.1.1.1.3" xref="alg1.4.4.m1.3.3.1.1.1.2.cmml">
             <mo id="alg1.4.4.m1.1.1.1.3.1" stretchy="false" xref="alg1.4.4.m1.3.3.1.1.1.2.cmml">
              (
             </mo>
             <mi id="alg1.4.4.m1.1.1.1.1" xref="alg1.4.4.m1.1.1.1.1.cmml">
              S
             </mi>
             <mo id="alg1.4.4.m1.1.1.1.3.2" stretchy="false" xref="alg1.4.4.m1.3.3.1.1.1.2.cmml">
              )
             </mo>
            </mrow>
           </msup>
           <mo fence="false" id="alg1.4.4.m1.3.3.1.1.1.1" xref="alg1.4.4.m1.3.3.1.1.1.1.cmml">
            |
           </mo>
           <msup id="alg1.4.4.m1.3.3.1.1.1.3" xref="alg1.4.4.m1.3.3.1.1.1.3.cmml">
            <mi id="alg1.4.4.m1.3.3.1.1.1.3.2" xref="alg1.4.4.m1.3.3.1.1.1.3.2.cmml">
             s
            </mi>
            <mrow id="alg1.4.4.m1.2.2.1.3" xref="alg1.4.4.m1.3.3.1.1.1.3.cmml">
             <mo id="alg1.4.4.m1.2.2.1.3.1" stretchy="false" xref="alg1.4.4.m1.3.3.1.1.1.3.cmml">
              (
             </mo>
             <mi id="alg1.4.4.m1.2.2.1.1" xref="alg1.4.4.m1.2.2.1.1.cmml">
              S
             </mi>
             <mo id="alg1.4.4.m1.2.2.1.3.2" stretchy="false" xref="alg1.4.4.m1.3.3.1.1.1.3.cmml">
              )
             </mo>
            </mrow>
           </msup>
          </mrow>
          <mo id="alg1.4.4.m1.3.3.1.1.3" stretchy="false" xref="alg1.4.4.m1.3.3.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.4.4.m1.3b">
         <apply id="alg1.4.4.m1.3.3.cmml" xref="alg1.4.4.m1.3.3">
          <times id="alg1.4.4.m1.3.3.2.cmml" xref="alg1.4.4.m1.3.3.2">
          </times>
          <apply id="alg1.4.4.m1.3.3.3.cmml" xref="alg1.4.4.m1.3.3.3">
           <csymbol cd="ambiguous" id="alg1.4.4.m1.3.3.3.1.cmml" xref="alg1.4.4.m1.3.3.3">
            subscript
           </csymbol>
           <ci id="alg1.4.4.m1.3.3.3.2.cmml" xref="alg1.4.4.m1.3.3.3.2">
            𝜋
           </ci>
           <ci id="alg1.4.4.m1.3.3.3.3.cmml" xref="alg1.4.4.m1.3.3.3.3">
            𝜃
           </ci>
          </apply>
          <apply id="alg1.4.4.m1.3.3.1.1.1.cmml" xref="alg1.4.4.m1.3.3.1.1">
           <csymbol cd="latexml" id="alg1.4.4.m1.3.3.1.1.1.1.cmml" xref="alg1.4.4.m1.3.3.1.1.1.1">
            conditional
           </csymbol>
           <apply id="alg1.4.4.m1.3.3.1.1.1.2.cmml" xref="alg1.4.4.m1.3.3.1.1.1.2">
            <csymbol cd="ambiguous" id="alg1.4.4.m1.3.3.1.1.1.2.1.cmml" xref="alg1.4.4.m1.3.3.1.1.1.2">
             superscript
            </csymbol>
            <ci id="alg1.4.4.m1.3.3.1.1.1.2.2.cmml" xref="alg1.4.4.m1.3.3.1.1.1.2.2">
             𝑎
            </ci>
            <ci id="alg1.4.4.m1.1.1.1.1.cmml" xref="alg1.4.4.m1.1.1.1.1">
             𝑆
            </ci>
           </apply>
           <apply id="alg1.4.4.m1.3.3.1.1.1.3.cmml" xref="alg1.4.4.m1.3.3.1.1.1.3">
            <csymbol cd="ambiguous" id="alg1.4.4.m1.3.3.1.1.1.3.1.cmml" xref="alg1.4.4.m1.3.3.1.1.1.3">
             superscript
            </csymbol>
            <ci id="alg1.4.4.m1.3.3.1.1.1.3.2.cmml" xref="alg1.4.4.m1.3.3.1.1.1.3.2">
             𝑠
            </ci>
            <ci id="alg1.4.4.m1.2.2.1.1.cmml" xref="alg1.4.4.m1.2.2.1.1">
             𝑆
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.4.4.m1.3c">
         \pi_{\theta}(a^{(S)}|s^{(S)})
        </annotation>
       </semantics>
      </math>
      , Ag-R
      <math alttext="\pi_{\phi}(a^{(R)}|s^{(R)})" class="ltx_Math" display="inline" id="alg1.5.5.m2.3">
       <semantics id="alg1.5.5.m2.3a">
        <mrow id="alg1.5.5.m2.3.3" xref="alg1.5.5.m2.3.3.cmml">
         <msub id="alg1.5.5.m2.3.3.3" xref="alg1.5.5.m2.3.3.3.cmml">
          <mi id="alg1.5.5.m2.3.3.3.2" xref="alg1.5.5.m2.3.3.3.2.cmml">
           π
          </mi>
          <mi id="alg1.5.5.m2.3.3.3.3" xref="alg1.5.5.m2.3.3.3.3.cmml">
           ϕ
          </mi>
         </msub>
         <mo id="alg1.5.5.m2.3.3.2" lspace="0em" rspace="0em" xref="alg1.5.5.m2.3.3.2.cmml">
          ​
         </mo>
         <mrow id="alg1.5.5.m2.3.3.1.1" xref="alg1.5.5.m2.3.3.1.1.1.cmml">
          <mo id="alg1.5.5.m2.3.3.1.1.2" stretchy="false" xref="alg1.5.5.m2.3.3.1.1.1.cmml">
           (
          </mo>
          <mrow id="alg1.5.5.m2.3.3.1.1.1" xref="alg1.5.5.m2.3.3.1.1.1.cmml">
           <msup id="alg1.5.5.m2.3.3.1.1.1.2" xref="alg1.5.5.m2.3.3.1.1.1.2.cmml">
            <mi id="alg1.5.5.m2.3.3.1.1.1.2.2" xref="alg1.5.5.m2.3.3.1.1.1.2.2.cmml">
             a
            </mi>
            <mrow id="alg1.5.5.m2.1.1.1.3" xref="alg1.5.5.m2.3.3.1.1.1.2.cmml">
             <mo id="alg1.5.5.m2.1.1.1.3.1" stretchy="false" xref="alg1.5.5.m2.3.3.1.1.1.2.cmml">
              (
             </mo>
             <mi id="alg1.5.5.m2.1.1.1.1" xref="alg1.5.5.m2.1.1.1.1.cmml">
              R
             </mi>
             <mo id="alg1.5.5.m2.1.1.1.3.2" stretchy="false" xref="alg1.5.5.m2.3.3.1.1.1.2.cmml">
              )
             </mo>
            </mrow>
           </msup>
           <mo fence="false" id="alg1.5.5.m2.3.3.1.1.1.1" xref="alg1.5.5.m2.3.3.1.1.1.1.cmml">
            |
           </mo>
           <msup id="alg1.5.5.m2.3.3.1.1.1.3" xref="alg1.5.5.m2.3.3.1.1.1.3.cmml">
            <mi id="alg1.5.5.m2.3.3.1.1.1.3.2" xref="alg1.5.5.m2.3.3.1.1.1.3.2.cmml">
             s
            </mi>
            <mrow id="alg1.5.5.m2.2.2.1.3" xref="alg1.5.5.m2.3.3.1.1.1.3.cmml">
             <mo id="alg1.5.5.m2.2.2.1.3.1" stretchy="false" xref="alg1.5.5.m2.3.3.1.1.1.3.cmml">
              (
             </mo>
             <mi id="alg1.5.5.m2.2.2.1.1" xref="alg1.5.5.m2.2.2.1.1.cmml">
              R
             </mi>
             <mo id="alg1.5.5.m2.2.2.1.3.2" stretchy="false" xref="alg1.5.5.m2.3.3.1.1.1.3.cmml">
              )
             </mo>
            </mrow>
           </msup>
          </mrow>
          <mo id="alg1.5.5.m2.3.3.1.1.3" stretchy="false" xref="alg1.5.5.m2.3.3.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.5.5.m2.3b">
         <apply id="alg1.5.5.m2.3.3.cmml" xref="alg1.5.5.m2.3.3">
          <times id="alg1.5.5.m2.3.3.2.cmml" xref="alg1.5.5.m2.3.3.2">
          </times>
          <apply id="alg1.5.5.m2.3.3.3.cmml" xref="alg1.5.5.m2.3.3.3">
           <csymbol cd="ambiguous" id="alg1.5.5.m2.3.3.3.1.cmml" xref="alg1.5.5.m2.3.3.3">
            subscript
           </csymbol>
           <ci id="alg1.5.5.m2.3.3.3.2.cmml" xref="alg1.5.5.m2.3.3.3.2">
            𝜋
           </ci>
           <ci id="alg1.5.5.m2.3.3.3.3.cmml" xref="alg1.5.5.m2.3.3.3.3">
            italic-ϕ
           </ci>
          </apply>
          <apply id="alg1.5.5.m2.3.3.1.1.1.cmml" xref="alg1.5.5.m2.3.3.1.1">
           <csymbol cd="latexml" id="alg1.5.5.m2.3.3.1.1.1.1.cmml" xref="alg1.5.5.m2.3.3.1.1.1.1">
            conditional
           </csymbol>
           <apply id="alg1.5.5.m2.3.3.1.1.1.2.cmml" xref="alg1.5.5.m2.3.3.1.1.1.2">
            <csymbol cd="ambiguous" id="alg1.5.5.m2.3.3.1.1.1.2.1.cmml" xref="alg1.5.5.m2.3.3.1.1.1.2">
             superscript
            </csymbol>
            <ci id="alg1.5.5.m2.3.3.1.1.1.2.2.cmml" xref="alg1.5.5.m2.3.3.1.1.1.2.2">
             𝑎
            </ci>
            <ci id="alg1.5.5.m2.1.1.1.1.cmml" xref="alg1.5.5.m2.1.1.1.1">
             𝑅
            </ci>
           </apply>
           <apply id="alg1.5.5.m2.3.3.1.1.1.3.cmml" xref="alg1.5.5.m2.3.3.1.1.1.3">
            <csymbol cd="ambiguous" id="alg1.5.5.m2.3.3.1.1.1.3.1.cmml" xref="alg1.5.5.m2.3.3.1.1.1.3">
             superscript
            </csymbol>
            <ci id="alg1.5.5.m2.3.3.1.1.1.3.2.cmml" xref="alg1.5.5.m2.3.3.1.1.1.3.2">
             𝑠
            </ci>
            <ci id="alg1.5.5.m2.2.2.1.1.cmml" xref="alg1.5.5.m2.2.2.1.1">
             𝑅
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.5.5.m2.3c">
         \pi_{\phi}(a^{(R)}|s^{(R)})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.35.36">
      <span class="ltx_tag ltx_tag_listingline">
       3
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.35.36.1">
       while
      </span>
      <em class="ltx_emph ltx_font_italic" id="alg1.35.36.2">
       not converged on a validation set
      </em>
      <span class="ltx_text ltx_font_bold" id="alg1.35.36.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.6.6">
      <span class="ltx_tag ltx_tag_listingline">
       4
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      sample a text pair
      <math alttext="(x,y)" class="ltx_Math" display="inline" id="alg1.6.6.m1.2">
       <semantics id="alg1.6.6.m1.2a">
        <mrow id="alg1.6.6.m1.2.3.2" xref="alg1.6.6.m1.2.3.1.cmml">
         <mo id="alg1.6.6.m1.2.3.2.1" stretchy="false" xref="alg1.6.6.m1.2.3.1.cmml">
          (
         </mo>
         <mi id="alg1.6.6.m1.1.1" xref="alg1.6.6.m1.1.1.cmml">
          x
         </mi>
         <mo id="alg1.6.6.m1.2.3.2.2" xref="alg1.6.6.m1.2.3.1.cmml">
          ,
         </mo>
         <mi id="alg1.6.6.m1.2.2" xref="alg1.6.6.m1.2.2.cmml">
          y
         </mi>
         <mo id="alg1.6.6.m1.2.3.2.3" stretchy="false" xref="alg1.6.6.m1.2.3.1.cmml">
          )
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.6.6.m1.2b">
         <interval closure="open" id="alg1.6.6.m1.2.3.1.cmml" xref="alg1.6.6.m1.2.3.2">
          <ci id="alg1.6.6.m1.1.1.cmml" xref="alg1.6.6.m1.1.1">
           𝑥
          </ci>
          <ci id="alg1.6.6.m1.2.2.cmml" xref="alg1.6.6.m1.2.2">
           𝑦
          </ci>
         </interval>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.6.6.m1.2c">
         (x,y)
        </annotation>
       </semantics>
      </math>
      from the training set
     </div>
     <div class="ltx_listingline" id="alg1.9.9">
      <span class="ltx_tag ltx_tag_listingline">
       5
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      construct
      <math alttext="s_{1}^{(S)}" class="ltx_Math" display="inline" id="alg1.7.7.m1.1">
       <semantics id="alg1.7.7.m1.1a">
        <msubsup id="alg1.7.7.m1.1.2" xref="alg1.7.7.m1.1.2.cmml">
         <mi id="alg1.7.7.m1.1.2.2.2" xref="alg1.7.7.m1.1.2.2.2.cmml">
          s
         </mi>
         <mn id="alg1.7.7.m1.1.2.2.3" xref="alg1.7.7.m1.1.2.2.3.cmml">
          1
         </mn>
         <mrow id="alg1.7.7.m1.1.1.1.3" xref="alg1.7.7.m1.1.2.cmml">
          <mo id="alg1.7.7.m1.1.1.1.3.1" stretchy="false" xref="alg1.7.7.m1.1.2.cmml">
           (
          </mo>
          <mi id="alg1.7.7.m1.1.1.1.1" xref="alg1.7.7.m1.1.1.1.1.cmml">
           S
          </mi>
          <mo id="alg1.7.7.m1.1.1.1.3.2" stretchy="false" xref="alg1.7.7.m1.1.2.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="alg1.7.7.m1.1b">
         <apply id="alg1.7.7.m1.1.2.cmml" xref="alg1.7.7.m1.1.2">
          <csymbol cd="ambiguous" id="alg1.7.7.m1.1.2.1.cmml" xref="alg1.7.7.m1.1.2">
           superscript
          </csymbol>
          <apply id="alg1.7.7.m1.1.2.2.cmml" xref="alg1.7.7.m1.1.2">
           <csymbol cd="ambiguous" id="alg1.7.7.m1.1.2.2.1.cmml" xref="alg1.7.7.m1.1.2">
            subscript
           </csymbol>
           <ci id="alg1.7.7.m1.1.2.2.2.cmml" xref="alg1.7.7.m1.1.2.2.2">
            𝑠
           </ci>
           <cn id="alg1.7.7.m1.1.2.2.3.cmml" type="integer" xref="alg1.7.7.m1.1.2.2.3">
            1
           </cn>
          </apply>
          <ci id="alg1.7.7.m1.1.1.1.1.cmml" xref="alg1.7.7.m1.1.1.1.1">
           𝑆
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.7.7.m1.1c">
         s_{1}^{(S)}
        </annotation>
       </semantics>
      </math>
      with
      <math alttext="(x,y)" class="ltx_Math" display="inline" id="alg1.8.8.m2.2">
       <semantics id="alg1.8.8.m2.2a">
        <mrow id="alg1.8.8.m2.2.3.2" xref="alg1.8.8.m2.2.3.1.cmml">
         <mo id="alg1.8.8.m2.2.3.2.1" stretchy="false" xref="alg1.8.8.m2.2.3.1.cmml">
          (
         </mo>
         <mi id="alg1.8.8.m2.1.1" xref="alg1.8.8.m2.1.1.cmml">
          x
         </mi>
         <mo id="alg1.8.8.m2.2.3.2.2" xref="alg1.8.8.m2.2.3.1.cmml">
          ,
         </mo>
         <mi id="alg1.8.8.m2.2.2" xref="alg1.8.8.m2.2.2.cmml">
          y
         </mi>
         <mo id="alg1.8.8.m2.2.3.2.3" stretchy="false" xref="alg1.8.8.m2.2.3.1.cmml">
          )
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.8.8.m2.2b">
         <interval closure="open" id="alg1.8.8.m2.2.3.1.cmml" xref="alg1.8.8.m2.2.3.2">
          <ci id="alg1.8.8.m2.1.1.cmml" xref="alg1.8.8.m2.1.1">
           𝑥
          </ci>
          <ci id="alg1.8.8.m2.2.2.cmml" xref="alg1.8.8.m2.2.2">
           𝑦
          </ci>
         </interval>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.8.8.m2.2c">
         (x,y)
        </annotation>
       </semantics>
      </math>
      on
      <math alttext="\mathbb{D}" class="ltx_Math" display="inline" id="alg1.9.9.m3.1">
       <semantics id="alg1.9.9.m3.1a">
        <mi id="alg1.9.9.m3.1.1" xref="alg1.9.9.m3.1.1.cmml">
         𝔻
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.9.9.m3.1b">
         <ci id="alg1.9.9.m3.1.1.cmml" xref="alg1.9.9.m3.1.1">
          𝔻
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.9.9.m3.1c">
         \mathbb{D}
        </annotation>
       </semantics>
      </math>
      by Eq
      <a class="ltx_ref" href="#S3.E1" title="In 3.2 Agent-S: Selecting a Database Partition ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
       <span class="ltx_text ltx_ref_tag">
        1
       </span>
      </a>
     </div>
     <div class="ltx_listingline" id="alg1.10.10">
      <span class="ltx_tag ltx_tag_listingline">
       6
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.10.10.2">
       for
      </span>
      <em class="ltx_emph ltx_font_italic" id="alg1.10.10.1">
       <math alttext="i=1,2,..." class="ltx_Math" display="inline" id="alg1.10.10.1.m1.3">
        <semantics id="alg1.10.10.1.m1.3a">
         <mrow id="alg1.10.10.1.m1.3.4" xref="alg1.10.10.1.m1.3.4.cmml">
          <mi id="alg1.10.10.1.m1.3.4.2" xref="alg1.10.10.1.m1.3.4.2.cmml">
           i
          </mi>
          <mo id="alg1.10.10.1.m1.3.4.1" xref="alg1.10.10.1.m1.3.4.1.cmml">
           =
          </mo>
          <mrow id="alg1.10.10.1.m1.3.4.3.2" xref="alg1.10.10.1.m1.3.4.3.1.cmml">
           <mn id="alg1.10.10.1.m1.1.1" xref="alg1.10.10.1.m1.1.1.cmml">
            1
           </mn>
           <mo id="alg1.10.10.1.m1.3.4.3.2.1" xref="alg1.10.10.1.m1.3.4.3.1.cmml">
            ,
           </mo>
           <mn id="alg1.10.10.1.m1.2.2" xref="alg1.10.10.1.m1.2.2.cmml">
            2
           </mn>
           <mo id="alg1.10.10.1.m1.3.4.3.2.2" xref="alg1.10.10.1.m1.3.4.3.1.cmml">
            ,
           </mo>
           <mi id="alg1.10.10.1.m1.3.3" mathvariant="normal" xref="alg1.10.10.1.m1.3.3.cmml">
            …
           </mi>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="alg1.10.10.1.m1.3b">
          <apply id="alg1.10.10.1.m1.3.4.cmml" xref="alg1.10.10.1.m1.3.4">
           <eq id="alg1.10.10.1.m1.3.4.1.cmml" xref="alg1.10.10.1.m1.3.4.1">
           </eq>
           <ci id="alg1.10.10.1.m1.3.4.2.cmml" xref="alg1.10.10.1.m1.3.4.2">
            𝑖
           </ci>
           <list id="alg1.10.10.1.m1.3.4.3.1.cmml" xref="alg1.10.10.1.m1.3.4.3.2">
            <cn id="alg1.10.10.1.m1.1.1.cmml" type="integer" xref="alg1.10.10.1.m1.1.1">
             1
            </cn>
            <cn id="alg1.10.10.1.m1.2.2.cmml" type="integer" xref="alg1.10.10.1.m1.2.2">
             2
            </cn>
            <ci id="alg1.10.10.1.m1.3.3.cmml" xref="alg1.10.10.1.m1.3.3">
             …
            </ci>
           </list>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.10.10.1.m1.3c">
          i=1,2,...
         </annotation>
        </semantics>
       </math>
      </em>
      <span class="ltx_text ltx_font_bold" id="alg1.10.10.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.11.11">
      <span class="ltx_tag ltx_tag_listingline">
       7
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      sample
      <math alttext="m=a_{i}^{(S)}\sim\pi_{\theta}(a|s_{i}^{(S)})" class="ltx_Math" display="inline" id="alg1.11.11.m1.3">
       <semantics id="alg1.11.11.m1.3a">
        <mrow id="alg1.11.11.m1.3.3" xref="alg1.11.11.m1.3.3.cmml">
         <mi id="alg1.11.11.m1.3.3.3" xref="alg1.11.11.m1.3.3.3.cmml">
          m
         </mi>
         <mo id="alg1.11.11.m1.3.3.4" xref="alg1.11.11.m1.3.3.4.cmml">
          =
         </mo>
         <msubsup id="alg1.11.11.m1.3.3.5" xref="alg1.11.11.m1.3.3.5.cmml">
          <mi id="alg1.11.11.m1.3.3.5.2.2" xref="alg1.11.11.m1.3.3.5.2.2.cmml">
           a
          </mi>
          <mi id="alg1.11.11.m1.3.3.5.2.3" xref="alg1.11.11.m1.3.3.5.2.3.cmml">
           i
          </mi>
          <mrow id="alg1.11.11.m1.1.1.1.3" xref="alg1.11.11.m1.3.3.5.cmml">
           <mo id="alg1.11.11.m1.1.1.1.3.1" stretchy="false" xref="alg1.11.11.m1.3.3.5.cmml">
            (
           </mo>
           <mi id="alg1.11.11.m1.1.1.1.1" xref="alg1.11.11.m1.1.1.1.1.cmml">
            S
           </mi>
           <mo id="alg1.11.11.m1.1.1.1.3.2" stretchy="false" xref="alg1.11.11.m1.3.3.5.cmml">
            )
           </mo>
          </mrow>
         </msubsup>
         <mo id="alg1.11.11.m1.3.3.6" xref="alg1.11.11.m1.3.3.6.cmml">
          ∼
         </mo>
         <mrow id="alg1.11.11.m1.3.3.1" xref="alg1.11.11.m1.3.3.1.cmml">
          <msub id="alg1.11.11.m1.3.3.1.3" xref="alg1.11.11.m1.3.3.1.3.cmml">
           <mi id="alg1.11.11.m1.3.3.1.3.2" xref="alg1.11.11.m1.3.3.1.3.2.cmml">
            π
           </mi>
           <mi id="alg1.11.11.m1.3.3.1.3.3" xref="alg1.11.11.m1.3.3.1.3.3.cmml">
            θ
           </mi>
          </msub>
          <mo id="alg1.11.11.m1.3.3.1.2" lspace="0em" rspace="0em" xref="alg1.11.11.m1.3.3.1.2.cmml">
           ​
          </mo>
          <mrow id="alg1.11.11.m1.3.3.1.1.1" xref="alg1.11.11.m1.3.3.1.1.1.1.cmml">
           <mo id="alg1.11.11.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.11.11.m1.3.3.1.1.1.1.cmml">
            (
           </mo>
           <mrow id="alg1.11.11.m1.3.3.1.1.1.1" xref="alg1.11.11.m1.3.3.1.1.1.1.cmml">
            <mi id="alg1.11.11.m1.3.3.1.1.1.1.2" xref="alg1.11.11.m1.3.3.1.1.1.1.2.cmml">
             a
            </mi>
            <mo fence="false" id="alg1.11.11.m1.3.3.1.1.1.1.1" xref="alg1.11.11.m1.3.3.1.1.1.1.1.cmml">
             |
            </mo>
            <msubsup id="alg1.11.11.m1.3.3.1.1.1.1.3" xref="alg1.11.11.m1.3.3.1.1.1.1.3.cmml">
             <mi id="alg1.11.11.m1.3.3.1.1.1.1.3.2.2" xref="alg1.11.11.m1.3.3.1.1.1.1.3.2.2.cmml">
              s
             </mi>
             <mi id="alg1.11.11.m1.3.3.1.1.1.1.3.2.3" xref="alg1.11.11.m1.3.3.1.1.1.1.3.2.3.cmml">
              i
             </mi>
             <mrow id="alg1.11.11.m1.2.2.1.3" xref="alg1.11.11.m1.3.3.1.1.1.1.3.cmml">
              <mo id="alg1.11.11.m1.2.2.1.3.1" stretchy="false" xref="alg1.11.11.m1.3.3.1.1.1.1.3.cmml">
               (
              </mo>
              <mi id="alg1.11.11.m1.2.2.1.1" xref="alg1.11.11.m1.2.2.1.1.cmml">
               S
              </mi>
              <mo id="alg1.11.11.m1.2.2.1.3.2" stretchy="false" xref="alg1.11.11.m1.3.3.1.1.1.1.3.cmml">
               )
              </mo>
             </mrow>
            </msubsup>
           </mrow>
           <mo id="alg1.11.11.m1.3.3.1.1.1.3" stretchy="false" xref="alg1.11.11.m1.3.3.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.11.11.m1.3b">
         <apply id="alg1.11.11.m1.3.3.cmml" xref="alg1.11.11.m1.3.3">
          <and id="alg1.11.11.m1.3.3a.cmml" xref="alg1.11.11.m1.3.3">
          </and>
          <apply id="alg1.11.11.m1.3.3b.cmml" xref="alg1.11.11.m1.3.3">
           <eq id="alg1.11.11.m1.3.3.4.cmml" xref="alg1.11.11.m1.3.3.4">
           </eq>
           <ci id="alg1.11.11.m1.3.3.3.cmml" xref="alg1.11.11.m1.3.3.3">
            𝑚
           </ci>
           <apply id="alg1.11.11.m1.3.3.5.cmml" xref="alg1.11.11.m1.3.3.5">
            <csymbol cd="ambiguous" id="alg1.11.11.m1.3.3.5.1.cmml" xref="alg1.11.11.m1.3.3.5">
             superscript
            </csymbol>
            <apply id="alg1.11.11.m1.3.3.5.2.cmml" xref="alg1.11.11.m1.3.3.5">
             <csymbol cd="ambiguous" id="alg1.11.11.m1.3.3.5.2.1.cmml" xref="alg1.11.11.m1.3.3.5">
              subscript
             </csymbol>
             <ci id="alg1.11.11.m1.3.3.5.2.2.cmml" xref="alg1.11.11.m1.3.3.5.2.2">
              𝑎
             </ci>
             <ci id="alg1.11.11.m1.3.3.5.2.3.cmml" xref="alg1.11.11.m1.3.3.5.2.3">
              𝑖
             </ci>
            </apply>
            <ci id="alg1.11.11.m1.1.1.1.1.cmml" xref="alg1.11.11.m1.1.1.1.1">
             𝑆
            </ci>
           </apply>
          </apply>
          <apply id="alg1.11.11.m1.3.3c.cmml" xref="alg1.11.11.m1.3.3">
           <csymbol cd="latexml" id="alg1.11.11.m1.3.3.6.cmml" xref="alg1.11.11.m1.3.3.6">
            similar-to
           </csymbol>
           <share href="#alg1.11.11.m1.3.3.5.cmml" id="alg1.11.11.m1.3.3d.cmml" xref="alg1.11.11.m1.3.3">
           </share>
           <apply id="alg1.11.11.m1.3.3.1.cmml" xref="alg1.11.11.m1.3.3.1">
            <times id="alg1.11.11.m1.3.3.1.2.cmml" xref="alg1.11.11.m1.3.3.1.2">
            </times>
            <apply id="alg1.11.11.m1.3.3.1.3.cmml" xref="alg1.11.11.m1.3.3.1.3">
             <csymbol cd="ambiguous" id="alg1.11.11.m1.3.3.1.3.1.cmml" xref="alg1.11.11.m1.3.3.1.3">
              subscript
             </csymbol>
             <ci id="alg1.11.11.m1.3.3.1.3.2.cmml" xref="alg1.11.11.m1.3.3.1.3.2">
              𝜋
             </ci>
             <ci id="alg1.11.11.m1.3.3.1.3.3.cmml" xref="alg1.11.11.m1.3.3.1.3.3">
              𝜃
             </ci>
            </apply>
            <apply id="alg1.11.11.m1.3.3.1.1.1.1.cmml" xref="alg1.11.11.m1.3.3.1.1.1">
             <csymbol cd="latexml" id="alg1.11.11.m1.3.3.1.1.1.1.1.cmml" xref="alg1.11.11.m1.3.3.1.1.1.1.1">
              conditional
             </csymbol>
             <ci id="alg1.11.11.m1.3.3.1.1.1.1.2.cmml" xref="alg1.11.11.m1.3.3.1.1.1.1.2">
              𝑎
             </ci>
             <apply id="alg1.11.11.m1.3.3.1.1.1.1.3.cmml" xref="alg1.11.11.m1.3.3.1.1.1.1.3">
              <csymbol cd="ambiguous" id="alg1.11.11.m1.3.3.1.1.1.1.3.1.cmml" xref="alg1.11.11.m1.3.3.1.1.1.1.3">
               superscript
              </csymbol>
              <apply id="alg1.11.11.m1.3.3.1.1.1.1.3.2.cmml" xref="alg1.11.11.m1.3.3.1.1.1.1.3">
               <csymbol cd="ambiguous" id="alg1.11.11.m1.3.3.1.1.1.1.3.2.1.cmml" xref="alg1.11.11.m1.3.3.1.1.1.1.3">
                subscript
               </csymbol>
               <ci id="alg1.11.11.m1.3.3.1.1.1.1.3.2.2.cmml" xref="alg1.11.11.m1.3.3.1.1.1.1.3.2.2">
                𝑠
               </ci>
               <ci id="alg1.11.11.m1.3.3.1.1.1.1.3.2.3.cmml" xref="alg1.11.11.m1.3.3.1.1.1.1.3.2.3">
                𝑖
               </ci>
              </apply>
              <ci id="alg1.11.11.m1.2.2.1.1.cmml" xref="alg1.11.11.m1.2.2.1.1">
               𝑆
              </ci>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.11.11.m1.3c">
         m=a_{i}^{(S)}\sim\pi_{\theta}(a|s_{i}^{(S)})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.12.12">
      <span class="ltx_tag ltx_tag_listingline">
       8
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <math alttext="r_{i}^{(S)}\leftarrow 0" class="ltx_Math" display="inline" id="alg1.12.12.m1.1">
       <semantics id="alg1.12.12.m1.1a">
        <mrow id="alg1.12.12.m1.1.2" xref="alg1.12.12.m1.1.2.cmml">
         <msubsup id="alg1.12.12.m1.1.2.2" xref="alg1.12.12.m1.1.2.2.cmml">
          <mi id="alg1.12.12.m1.1.2.2.2.2" xref="alg1.12.12.m1.1.2.2.2.2.cmml">
           r
          </mi>
          <mi id="alg1.12.12.m1.1.2.2.2.3" xref="alg1.12.12.m1.1.2.2.2.3.cmml">
           i
          </mi>
          <mrow id="alg1.12.12.m1.1.1.1.3" xref="alg1.12.12.m1.1.2.2.cmml">
           <mo id="alg1.12.12.m1.1.1.1.3.1" stretchy="false" xref="alg1.12.12.m1.1.2.2.cmml">
            (
           </mo>
           <mi id="alg1.12.12.m1.1.1.1.1" xref="alg1.12.12.m1.1.1.1.1.cmml">
            S
           </mi>
           <mo id="alg1.12.12.m1.1.1.1.3.2" stretchy="false" xref="alg1.12.12.m1.1.2.2.cmml">
            )
           </mo>
          </mrow>
         </msubsup>
         <mo id="alg1.12.12.m1.1.2.1" stretchy="false" xref="alg1.12.12.m1.1.2.1.cmml">
          ←
         </mo>
         <mn id="alg1.12.12.m1.1.2.3" xref="alg1.12.12.m1.1.2.3.cmml">
          0
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.12.12.m1.1b">
         <apply id="alg1.12.12.m1.1.2.cmml" xref="alg1.12.12.m1.1.2">
          <ci id="alg1.12.12.m1.1.2.1.cmml" xref="alg1.12.12.m1.1.2.1">
           ←
          </ci>
          <apply id="alg1.12.12.m1.1.2.2.cmml" xref="alg1.12.12.m1.1.2.2">
           <csymbol cd="ambiguous" id="alg1.12.12.m1.1.2.2.1.cmml" xref="alg1.12.12.m1.1.2.2">
            superscript
           </csymbol>
           <apply id="alg1.12.12.m1.1.2.2.2.cmml" xref="alg1.12.12.m1.1.2.2">
            <csymbol cd="ambiguous" id="alg1.12.12.m1.1.2.2.2.1.cmml" xref="alg1.12.12.m1.1.2.2">
             subscript
            </csymbol>
            <ci id="alg1.12.12.m1.1.2.2.2.2.cmml" xref="alg1.12.12.m1.1.2.2.2.2">
             𝑟
            </ci>
            <ci id="alg1.12.12.m1.1.2.2.2.3.cmml" xref="alg1.12.12.m1.1.2.2.2.3">
             𝑖
            </ci>
           </apply>
           <ci id="alg1.12.12.m1.1.1.1.1.cmml" xref="alg1.12.12.m1.1.1.1.1">
            𝑆
           </ci>
          </apply>
          <cn id="alg1.12.12.m1.1.2.3.cmml" type="integer" xref="alg1.12.12.m1.1.2.3">
           0
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.12.12.m1.1c">
         r_{i}^{(S)}\leftarrow 0
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.13.13">
      <span class="ltx_tag ltx_tag_listingline">
       9
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <math alttext="h\leftarrow\text{LLM}(x\oplus(\tilde{x},\tilde{y})\in D_{m})" class="ltx_Math" display="inline" id="alg1.13.13.m1.3">
       <semantics id="alg1.13.13.m1.3a">
        <mrow id="alg1.13.13.m1.3.3" xref="alg1.13.13.m1.3.3.cmml">
         <mi id="alg1.13.13.m1.3.3.3" xref="alg1.13.13.m1.3.3.3.cmml">
          h
         </mi>
         <mo id="alg1.13.13.m1.3.3.2" stretchy="false" xref="alg1.13.13.m1.3.3.2.cmml">
          ←
         </mo>
         <mrow id="alg1.13.13.m1.3.3.1" xref="alg1.13.13.m1.3.3.1.cmml">
          <mtext id="alg1.13.13.m1.3.3.1.3" xref="alg1.13.13.m1.3.3.1.3a.cmml">
           LLM
          </mtext>
          <mo id="alg1.13.13.m1.3.3.1.2" lspace="0em" rspace="0em" xref="alg1.13.13.m1.3.3.1.2.cmml">
           ​
          </mo>
          <mrow id="alg1.13.13.m1.3.3.1.1.1" xref="alg1.13.13.m1.3.3.1.1.1.1.cmml">
           <mo id="alg1.13.13.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.13.13.m1.3.3.1.1.1.1.cmml">
            (
           </mo>
           <mrow id="alg1.13.13.m1.3.3.1.1.1.1" xref="alg1.13.13.m1.3.3.1.1.1.1.cmml">
            <mrow id="alg1.13.13.m1.3.3.1.1.1.1.2" xref="alg1.13.13.m1.3.3.1.1.1.1.2.cmml">
             <mi id="alg1.13.13.m1.3.3.1.1.1.1.2.2" xref="alg1.13.13.m1.3.3.1.1.1.1.2.2.cmml">
              x
             </mi>
             <mo id="alg1.13.13.m1.3.3.1.1.1.1.2.1" xref="alg1.13.13.m1.3.3.1.1.1.1.2.1.cmml">
              ⊕
             </mo>
             <mrow id="alg1.13.13.m1.3.3.1.1.1.1.2.3.2" xref="alg1.13.13.m1.3.3.1.1.1.1.2.3.1.cmml">
              <mo id="alg1.13.13.m1.3.3.1.1.1.1.2.3.2.1" stretchy="false" xref="alg1.13.13.m1.3.3.1.1.1.1.2.3.1.cmml">
               (
              </mo>
              <mover accent="true" id="alg1.13.13.m1.1.1" xref="alg1.13.13.m1.1.1.cmml">
               <mi id="alg1.13.13.m1.1.1.2" xref="alg1.13.13.m1.1.1.2.cmml">
                x
               </mi>
               <mo id="alg1.13.13.m1.1.1.1" xref="alg1.13.13.m1.1.1.1.cmml">
                ~
               </mo>
              </mover>
              <mo id="alg1.13.13.m1.3.3.1.1.1.1.2.3.2.2" xref="alg1.13.13.m1.3.3.1.1.1.1.2.3.1.cmml">
               ,
              </mo>
              <mover accent="true" id="alg1.13.13.m1.2.2" xref="alg1.13.13.m1.2.2.cmml">
               <mi id="alg1.13.13.m1.2.2.2" xref="alg1.13.13.m1.2.2.2.cmml">
                y
               </mi>
               <mo id="alg1.13.13.m1.2.2.1" xref="alg1.13.13.m1.2.2.1.cmml">
                ~
               </mo>
              </mover>
              <mo id="alg1.13.13.m1.3.3.1.1.1.1.2.3.2.3" stretchy="false" xref="alg1.13.13.m1.3.3.1.1.1.1.2.3.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
            <mo id="alg1.13.13.m1.3.3.1.1.1.1.1" xref="alg1.13.13.m1.3.3.1.1.1.1.1.cmml">
             ∈
            </mo>
            <msub id="alg1.13.13.m1.3.3.1.1.1.1.3" xref="alg1.13.13.m1.3.3.1.1.1.1.3.cmml">
             <mi id="alg1.13.13.m1.3.3.1.1.1.1.3.2" xref="alg1.13.13.m1.3.3.1.1.1.1.3.2.cmml">
              D
             </mi>
             <mi id="alg1.13.13.m1.3.3.1.1.1.1.3.3" xref="alg1.13.13.m1.3.3.1.1.1.1.3.3.cmml">
              m
             </mi>
            </msub>
           </mrow>
           <mo id="alg1.13.13.m1.3.3.1.1.1.3" stretchy="false" xref="alg1.13.13.m1.3.3.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.13.13.m1.3b">
         <apply id="alg1.13.13.m1.3.3.cmml" xref="alg1.13.13.m1.3.3">
          <ci id="alg1.13.13.m1.3.3.2.cmml" xref="alg1.13.13.m1.3.3.2">
           ←
          </ci>
          <ci id="alg1.13.13.m1.3.3.3.cmml" xref="alg1.13.13.m1.3.3.3">
           ℎ
          </ci>
          <apply id="alg1.13.13.m1.3.3.1.cmml" xref="alg1.13.13.m1.3.3.1">
           <times id="alg1.13.13.m1.3.3.1.2.cmml" xref="alg1.13.13.m1.3.3.1.2">
           </times>
           <ci id="alg1.13.13.m1.3.3.1.3a.cmml" xref="alg1.13.13.m1.3.3.1.3">
            <mtext id="alg1.13.13.m1.3.3.1.3.cmml" xref="alg1.13.13.m1.3.3.1.3">
             LLM
            </mtext>
           </ci>
           <apply id="alg1.13.13.m1.3.3.1.1.1.1.cmml" xref="alg1.13.13.m1.3.3.1.1.1">
            <in id="alg1.13.13.m1.3.3.1.1.1.1.1.cmml" xref="alg1.13.13.m1.3.3.1.1.1.1.1">
            </in>
            <apply id="alg1.13.13.m1.3.3.1.1.1.1.2.cmml" xref="alg1.13.13.m1.3.3.1.1.1.1.2">
             <csymbol cd="latexml" id="alg1.13.13.m1.3.3.1.1.1.1.2.1.cmml" xref="alg1.13.13.m1.3.3.1.1.1.1.2.1">
              direct-sum
             </csymbol>
             <ci id="alg1.13.13.m1.3.3.1.1.1.1.2.2.cmml" xref="alg1.13.13.m1.3.3.1.1.1.1.2.2">
              𝑥
             </ci>
             <interval closure="open" id="alg1.13.13.m1.3.3.1.1.1.1.2.3.1.cmml" xref="alg1.13.13.m1.3.3.1.1.1.1.2.3.2">
              <apply id="alg1.13.13.m1.1.1.cmml" xref="alg1.13.13.m1.1.1">
               <ci id="alg1.13.13.m1.1.1.1.cmml" xref="alg1.13.13.m1.1.1.1">
                ~
               </ci>
               <ci id="alg1.13.13.m1.1.1.2.cmml" xref="alg1.13.13.m1.1.1.2">
                𝑥
               </ci>
              </apply>
              <apply id="alg1.13.13.m1.2.2.cmml" xref="alg1.13.13.m1.2.2">
               <ci id="alg1.13.13.m1.2.2.1.cmml" xref="alg1.13.13.m1.2.2.1">
                ~
               </ci>
               <ci id="alg1.13.13.m1.2.2.2.cmml" xref="alg1.13.13.m1.2.2.2">
                𝑦
               </ci>
              </apply>
             </interval>
            </apply>
            <apply id="alg1.13.13.m1.3.3.1.1.1.1.3.cmml" xref="alg1.13.13.m1.3.3.1.1.1.1.3">
             <csymbol cd="ambiguous" id="alg1.13.13.m1.3.3.1.1.1.1.3.1.cmml" xref="alg1.13.13.m1.3.3.1.1.1.1.3">
              subscript
             </csymbol>
             <ci id="alg1.13.13.m1.3.3.1.1.1.1.3.2.cmml" xref="alg1.13.13.m1.3.3.1.1.1.1.3.2">
              𝐷
             </ci>
             <ci id="alg1.13.13.m1.3.3.1.1.1.1.3.3.cmml" xref="alg1.13.13.m1.3.3.1.1.1.1.3.3">
              𝑚
             </ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.13.13.m1.3c">
         h\leftarrow\text{LLM}(x\oplus(\tilde{x},\tilde{y})\in D_{m})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.16.16">
      <span class="ltx_tag ltx_tag_listingline">
       10
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      construct
      <math alttext="s_{1}^{(R)}" class="ltx_Math" display="inline" id="alg1.14.14.m1.1">
       <semantics id="alg1.14.14.m1.1a">
        <msubsup id="alg1.14.14.m1.1.2" xref="alg1.14.14.m1.1.2.cmml">
         <mi id="alg1.14.14.m1.1.2.2.2" xref="alg1.14.14.m1.1.2.2.2.cmml">
          s
         </mi>
         <mn id="alg1.14.14.m1.1.2.2.3" xref="alg1.14.14.m1.1.2.2.3.cmml">
          1
         </mn>
         <mrow id="alg1.14.14.m1.1.1.1.3" xref="alg1.14.14.m1.1.2.cmml">
          <mo id="alg1.14.14.m1.1.1.1.3.1" stretchy="false" xref="alg1.14.14.m1.1.2.cmml">
           (
          </mo>
          <mi id="alg1.14.14.m1.1.1.1.1" xref="alg1.14.14.m1.1.1.1.1.cmml">
           R
          </mi>
          <mo id="alg1.14.14.m1.1.1.1.3.2" stretchy="false" xref="alg1.14.14.m1.1.2.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="alg1.14.14.m1.1b">
         <apply id="alg1.14.14.m1.1.2.cmml" xref="alg1.14.14.m1.1.2">
          <csymbol cd="ambiguous" id="alg1.14.14.m1.1.2.1.cmml" xref="alg1.14.14.m1.1.2">
           superscript
          </csymbol>
          <apply id="alg1.14.14.m1.1.2.2.cmml" xref="alg1.14.14.m1.1.2">
           <csymbol cd="ambiguous" id="alg1.14.14.m1.1.2.2.1.cmml" xref="alg1.14.14.m1.1.2">
            subscript
           </csymbol>
           <ci id="alg1.14.14.m1.1.2.2.2.cmml" xref="alg1.14.14.m1.1.2.2.2">
            𝑠
           </ci>
           <cn id="alg1.14.14.m1.1.2.2.3.cmml" type="integer" xref="alg1.14.14.m1.1.2.2.3">
            1
           </cn>
          </apply>
          <ci id="alg1.14.14.m1.1.1.1.1.cmml" xref="alg1.14.14.m1.1.1.1.1">
           𝑅
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.14.14.m1.1c">
         s_{1}^{(R)}
        </annotation>
       </semantics>
      </math>
      with
      <math alttext="h" class="ltx_Math" display="inline" id="alg1.15.15.m2.1">
       <semantics id="alg1.15.15.m2.1a">
        <mi id="alg1.15.15.m2.1.1" xref="alg1.15.15.m2.1.1.cmml">
         h
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.15.15.m2.1b">
         <ci id="alg1.15.15.m2.1.1.cmml" xref="alg1.15.15.m2.1.1">
          ℎ
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.15.15.m2.1c">
         h
        </annotation>
       </semantics>
      </math>
      on
      <math alttext="\mathbb{C}=\{\hat{y}_{k}\leftarrow\text{LLM}(\tilde{x})\}_{k=1}^{|K|}" class="ltx_Math" display="inline" id="alg1.16.16.m3.3">
       <semantics id="alg1.16.16.m3.3a">
        <mrow id="alg1.16.16.m3.3.3" xref="alg1.16.16.m3.3.3.cmml">
         <mi id="alg1.16.16.m3.3.3.3" xref="alg1.16.16.m3.3.3.3.cmml">
          ℂ
         </mi>
         <mo id="alg1.16.16.m3.3.3.2" xref="alg1.16.16.m3.3.3.2.cmml">
          =
         </mo>
         <msubsup id="alg1.16.16.m3.3.3.1" xref="alg1.16.16.m3.3.3.1.cmml">
          <mrow id="alg1.16.16.m3.3.3.1.1.1.1" xref="alg1.16.16.m3.3.3.1.1.1.2.cmml">
           <mo id="alg1.16.16.m3.3.3.1.1.1.1.2" stretchy="false" xref="alg1.16.16.m3.3.3.1.1.1.2.cmml">
            {
           </mo>
           <mrow id="alg1.16.16.m3.3.3.1.1.1.1.1" xref="alg1.16.16.m3.3.3.1.1.1.1.1.cmml">
            <msub id="alg1.16.16.m3.3.3.1.1.1.1.1.2" xref="alg1.16.16.m3.3.3.1.1.1.1.1.2.cmml">
             <mover accent="true" id="alg1.16.16.m3.3.3.1.1.1.1.1.2.2" xref="alg1.16.16.m3.3.3.1.1.1.1.1.2.2.cmml">
              <mi id="alg1.16.16.m3.3.3.1.1.1.1.1.2.2.2" xref="alg1.16.16.m3.3.3.1.1.1.1.1.2.2.2.cmml">
               y
              </mi>
              <mo id="alg1.16.16.m3.3.3.1.1.1.1.1.2.2.1" xref="alg1.16.16.m3.3.3.1.1.1.1.1.2.2.1.cmml">
               ^
              </mo>
             </mover>
             <mi id="alg1.16.16.m3.3.3.1.1.1.1.1.2.3" xref="alg1.16.16.m3.3.3.1.1.1.1.1.2.3.cmml">
              k
             </mi>
            </msub>
            <mo id="alg1.16.16.m3.3.3.1.1.1.1.1.1" stretchy="false" xref="alg1.16.16.m3.3.3.1.1.1.1.1.1.cmml">
             ←
            </mo>
            <mrow id="alg1.16.16.m3.3.3.1.1.1.1.1.3" xref="alg1.16.16.m3.3.3.1.1.1.1.1.3.cmml">
             <mtext id="alg1.16.16.m3.3.3.1.1.1.1.1.3.2" xref="alg1.16.16.m3.3.3.1.1.1.1.1.3.2a.cmml">
              LLM
             </mtext>
             <mo id="alg1.16.16.m3.3.3.1.1.1.1.1.3.1" lspace="0em" rspace="0em" xref="alg1.16.16.m3.3.3.1.1.1.1.1.3.1.cmml">
              ​
             </mo>
             <mrow id="alg1.16.16.m3.3.3.1.1.1.1.1.3.3.2" xref="alg1.16.16.m3.2.2.cmml">
              <mo id="alg1.16.16.m3.3.3.1.1.1.1.1.3.3.2.1" stretchy="false" xref="alg1.16.16.m3.2.2.cmml">
               (
              </mo>
              <mover accent="true" id="alg1.16.16.m3.2.2" xref="alg1.16.16.m3.2.2.cmml">
               <mi id="alg1.16.16.m3.2.2.2" xref="alg1.16.16.m3.2.2.2.cmml">
                x
               </mi>
               <mo id="alg1.16.16.m3.2.2.1" xref="alg1.16.16.m3.2.2.1.cmml">
                ~
               </mo>
              </mover>
              <mo id="alg1.16.16.m3.3.3.1.1.1.1.1.3.3.2.2" stretchy="false" xref="alg1.16.16.m3.2.2.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="alg1.16.16.m3.3.3.1.1.1.1.3" stretchy="false" xref="alg1.16.16.m3.3.3.1.1.1.2.cmml">
            }
           </mo>
          </mrow>
          <mrow id="alg1.16.16.m3.3.3.1.1.3" xref="alg1.16.16.m3.3.3.1.1.3.cmml">
           <mi id="alg1.16.16.m3.3.3.1.1.3.2" xref="alg1.16.16.m3.3.3.1.1.3.2.cmml">
            k
           </mi>
           <mo id="alg1.16.16.m3.3.3.1.1.3.1" xref="alg1.16.16.m3.3.3.1.1.3.1.cmml">
            =
           </mo>
           <mn id="alg1.16.16.m3.3.3.1.1.3.3" xref="alg1.16.16.m3.3.3.1.1.3.3.cmml">
            1
           </mn>
          </mrow>
          <mrow id="alg1.16.16.m3.1.1.1.3" xref="alg1.16.16.m3.1.1.1.2.cmml">
           <mo id="alg1.16.16.m3.1.1.1.3.1" stretchy="false" xref="alg1.16.16.m3.1.1.1.2.1.cmml">
            |
           </mo>
           <mi id="alg1.16.16.m3.1.1.1.1" xref="alg1.16.16.m3.1.1.1.1.cmml">
            K
           </mi>
           <mo id="alg1.16.16.m3.1.1.1.3.2" stretchy="false" xref="alg1.16.16.m3.1.1.1.2.1.cmml">
            |
           </mo>
          </mrow>
         </msubsup>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.16.16.m3.3b">
         <apply id="alg1.16.16.m3.3.3.cmml" xref="alg1.16.16.m3.3.3">
          <eq id="alg1.16.16.m3.3.3.2.cmml" xref="alg1.16.16.m3.3.3.2">
          </eq>
          <ci id="alg1.16.16.m3.3.3.3.cmml" xref="alg1.16.16.m3.3.3.3">
           ℂ
          </ci>
          <apply id="alg1.16.16.m3.3.3.1.cmml" xref="alg1.16.16.m3.3.3.1">
           <csymbol cd="ambiguous" id="alg1.16.16.m3.3.3.1.2.cmml" xref="alg1.16.16.m3.3.3.1">
            superscript
           </csymbol>
           <apply id="alg1.16.16.m3.3.3.1.1.cmml" xref="alg1.16.16.m3.3.3.1">
            <csymbol cd="ambiguous" id="alg1.16.16.m3.3.3.1.1.2.cmml" xref="alg1.16.16.m3.3.3.1">
             subscript
            </csymbol>
            <set id="alg1.16.16.m3.3.3.1.1.1.2.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1">
             <apply id="alg1.16.16.m3.3.3.1.1.1.1.1.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1">
              <ci id="alg1.16.16.m3.3.3.1.1.1.1.1.1.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1.1">
               ←
              </ci>
              <apply id="alg1.16.16.m3.3.3.1.1.1.1.1.2.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1.2">
               <csymbol cd="ambiguous" id="alg1.16.16.m3.3.3.1.1.1.1.1.2.1.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1.2">
                subscript
               </csymbol>
               <apply id="alg1.16.16.m3.3.3.1.1.1.1.1.2.2.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1.2.2">
                <ci id="alg1.16.16.m3.3.3.1.1.1.1.1.2.2.1.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1.2.2.1">
                 ^
                </ci>
                <ci id="alg1.16.16.m3.3.3.1.1.1.1.1.2.2.2.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1.2.2.2">
                 𝑦
                </ci>
               </apply>
               <ci id="alg1.16.16.m3.3.3.1.1.1.1.1.2.3.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1.2.3">
                𝑘
               </ci>
              </apply>
              <apply id="alg1.16.16.m3.3.3.1.1.1.1.1.3.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1.3">
               <times id="alg1.16.16.m3.3.3.1.1.1.1.1.3.1.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1.3.1">
               </times>
               <ci id="alg1.16.16.m3.3.3.1.1.1.1.1.3.2a.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1.3.2">
                <mtext id="alg1.16.16.m3.3.3.1.1.1.1.1.3.2.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1.3.2">
                 LLM
                </mtext>
               </ci>
               <apply id="alg1.16.16.m3.2.2.cmml" xref="alg1.16.16.m3.3.3.1.1.1.1.1.3.3.2">
                <ci id="alg1.16.16.m3.2.2.1.cmml" xref="alg1.16.16.m3.2.2.1">
                 ~
                </ci>
                <ci id="alg1.16.16.m3.2.2.2.cmml" xref="alg1.16.16.m3.2.2.2">
                 𝑥
                </ci>
               </apply>
              </apply>
             </apply>
            </set>
            <apply id="alg1.16.16.m3.3.3.1.1.3.cmml" xref="alg1.16.16.m3.3.3.1.1.3">
             <eq id="alg1.16.16.m3.3.3.1.1.3.1.cmml" xref="alg1.16.16.m3.3.3.1.1.3.1">
             </eq>
             <ci id="alg1.16.16.m3.3.3.1.1.3.2.cmml" xref="alg1.16.16.m3.3.3.1.1.3.2">
              𝑘
             </ci>
             <cn id="alg1.16.16.m3.3.3.1.1.3.3.cmml" type="integer" xref="alg1.16.16.m3.3.3.1.1.3.3">
              1
             </cn>
            </apply>
           </apply>
           <apply id="alg1.16.16.m3.1.1.1.2.cmml" xref="alg1.16.16.m3.1.1.1.3">
            <abs id="alg1.16.16.m3.1.1.1.2.1.cmml" xref="alg1.16.16.m3.1.1.1.3.1">
            </abs>
            <ci id="alg1.16.16.m3.1.1.1.1.cmml" xref="alg1.16.16.m3.1.1.1.1">
             𝐾
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.16.16.m3.3c">
         \mathbb{C}=\{\hat{y}_{k}\leftarrow\text{LLM}(\tilde{x})\}_{k=1}^{|K|}
        </annotation>
       </semantics>
      </math>
      by Eq
      <a class="ltx_ref" href="#S3.E3" title="In 3.3 Agent-R: Refining Memories in the Selected Partition ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
       <span class="ltx_text ltx_ref_tag">
        3
       </span>
      </a>
     </div>
     <div class="ltx_listingline" id="alg1.35.37">
      <span class="ltx_tag ltx_tag_listingline">
       11
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.17.17">
      <span class="ltx_tag ltx_tag_listingline">
       12
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.17.17.2">
       for
      </span>
      <em class="ltx_emph ltx_font_italic" id="alg1.17.17.1">
       <math alttext="j=1,2,..." class="ltx_Math" display="inline" id="alg1.17.17.1.m1.3">
        <semantics id="alg1.17.17.1.m1.3a">
         <mrow id="alg1.17.17.1.m1.3.4" xref="alg1.17.17.1.m1.3.4.cmml">
          <mi id="alg1.17.17.1.m1.3.4.2" xref="alg1.17.17.1.m1.3.4.2.cmml">
           j
          </mi>
          <mo id="alg1.17.17.1.m1.3.4.1" xref="alg1.17.17.1.m1.3.4.1.cmml">
           =
          </mo>
          <mrow id="alg1.17.17.1.m1.3.4.3.2" xref="alg1.17.17.1.m1.3.4.3.1.cmml">
           <mn id="alg1.17.17.1.m1.1.1" xref="alg1.17.17.1.m1.1.1.cmml">
            1
           </mn>
           <mo id="alg1.17.17.1.m1.3.4.3.2.1" xref="alg1.17.17.1.m1.3.4.3.1.cmml">
            ,
           </mo>
           <mn id="alg1.17.17.1.m1.2.2" xref="alg1.17.17.1.m1.2.2.cmml">
            2
           </mn>
           <mo id="alg1.17.17.1.m1.3.4.3.2.2" xref="alg1.17.17.1.m1.3.4.3.1.cmml">
            ,
           </mo>
           <mi id="alg1.17.17.1.m1.3.3" mathvariant="normal" xref="alg1.17.17.1.m1.3.3.cmml">
            …
           </mi>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="alg1.17.17.1.m1.3b">
          <apply id="alg1.17.17.1.m1.3.4.cmml" xref="alg1.17.17.1.m1.3.4">
           <eq id="alg1.17.17.1.m1.3.4.1.cmml" xref="alg1.17.17.1.m1.3.4.1">
           </eq>
           <ci id="alg1.17.17.1.m1.3.4.2.cmml" xref="alg1.17.17.1.m1.3.4.2">
            𝑗
           </ci>
           <list id="alg1.17.17.1.m1.3.4.3.1.cmml" xref="alg1.17.17.1.m1.3.4.3.2">
            <cn id="alg1.17.17.1.m1.1.1.cmml" type="integer" xref="alg1.17.17.1.m1.1.1">
             1
            </cn>
            <cn id="alg1.17.17.1.m1.2.2.cmml" type="integer" xref="alg1.17.17.1.m1.2.2">
             2
            </cn>
            <ci id="alg1.17.17.1.m1.3.3.cmml" xref="alg1.17.17.1.m1.3.3">
             …
            </ci>
           </list>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.17.17.1.m1.3c">
          j=1,2,...
         </annotation>
        </semantics>
       </math>
      </em>
      <span class="ltx_text ltx_font_bold" id="alg1.17.17.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.18.18">
      <span class="ltx_tag ltx_tag_listingline">
       13
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      sample
      <math alttext="k=a_{j}^{(R)}\sim\pi_{\phi}(a|s_{j}^{(R)})" class="ltx_Math" display="inline" id="alg1.18.18.m1.3">
       <semantics id="alg1.18.18.m1.3a">
        <mrow id="alg1.18.18.m1.3.3" xref="alg1.18.18.m1.3.3.cmml">
         <mi id="alg1.18.18.m1.3.3.3" xref="alg1.18.18.m1.3.3.3.cmml">
          k
         </mi>
         <mo id="alg1.18.18.m1.3.3.4" xref="alg1.18.18.m1.3.3.4.cmml">
          =
         </mo>
         <msubsup id="alg1.18.18.m1.3.3.5" xref="alg1.18.18.m1.3.3.5.cmml">
          <mi id="alg1.18.18.m1.3.3.5.2.2" xref="alg1.18.18.m1.3.3.5.2.2.cmml">
           a
          </mi>
          <mi id="alg1.18.18.m1.3.3.5.2.3" xref="alg1.18.18.m1.3.3.5.2.3.cmml">
           j
          </mi>
          <mrow id="alg1.18.18.m1.1.1.1.3" xref="alg1.18.18.m1.3.3.5.cmml">
           <mo id="alg1.18.18.m1.1.1.1.3.1" stretchy="false" xref="alg1.18.18.m1.3.3.5.cmml">
            (
           </mo>
           <mi id="alg1.18.18.m1.1.1.1.1" xref="alg1.18.18.m1.1.1.1.1.cmml">
            R
           </mi>
           <mo id="alg1.18.18.m1.1.1.1.3.2" stretchy="false" xref="alg1.18.18.m1.3.3.5.cmml">
            )
           </mo>
          </mrow>
         </msubsup>
         <mo id="alg1.18.18.m1.3.3.6" xref="alg1.18.18.m1.3.3.6.cmml">
          ∼
         </mo>
         <mrow id="alg1.18.18.m1.3.3.1" xref="alg1.18.18.m1.3.3.1.cmml">
          <msub id="alg1.18.18.m1.3.3.1.3" xref="alg1.18.18.m1.3.3.1.3.cmml">
           <mi id="alg1.18.18.m1.3.3.1.3.2" xref="alg1.18.18.m1.3.3.1.3.2.cmml">
            π
           </mi>
           <mi id="alg1.18.18.m1.3.3.1.3.3" xref="alg1.18.18.m1.3.3.1.3.3.cmml">
            ϕ
           </mi>
          </msub>
          <mo id="alg1.18.18.m1.3.3.1.2" lspace="0em" rspace="0em" xref="alg1.18.18.m1.3.3.1.2.cmml">
           ​
          </mo>
          <mrow id="alg1.18.18.m1.3.3.1.1.1" xref="alg1.18.18.m1.3.3.1.1.1.1.cmml">
           <mo id="alg1.18.18.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.18.18.m1.3.3.1.1.1.1.cmml">
            (
           </mo>
           <mrow id="alg1.18.18.m1.3.3.1.1.1.1" xref="alg1.18.18.m1.3.3.1.1.1.1.cmml">
            <mi id="alg1.18.18.m1.3.3.1.1.1.1.2" xref="alg1.18.18.m1.3.3.1.1.1.1.2.cmml">
             a
            </mi>
            <mo fence="false" id="alg1.18.18.m1.3.3.1.1.1.1.1" xref="alg1.18.18.m1.3.3.1.1.1.1.1.cmml">
             |
            </mo>
            <msubsup id="alg1.18.18.m1.3.3.1.1.1.1.3" xref="alg1.18.18.m1.3.3.1.1.1.1.3.cmml">
             <mi id="alg1.18.18.m1.3.3.1.1.1.1.3.2.2" xref="alg1.18.18.m1.3.3.1.1.1.1.3.2.2.cmml">
              s
             </mi>
             <mi id="alg1.18.18.m1.3.3.1.1.1.1.3.2.3" xref="alg1.18.18.m1.3.3.1.1.1.1.3.2.3.cmml">
              j
             </mi>
             <mrow id="alg1.18.18.m1.2.2.1.3" xref="alg1.18.18.m1.3.3.1.1.1.1.3.cmml">
              <mo id="alg1.18.18.m1.2.2.1.3.1" stretchy="false" xref="alg1.18.18.m1.3.3.1.1.1.1.3.cmml">
               (
              </mo>
              <mi id="alg1.18.18.m1.2.2.1.1" xref="alg1.18.18.m1.2.2.1.1.cmml">
               R
              </mi>
              <mo id="alg1.18.18.m1.2.2.1.3.2" stretchy="false" xref="alg1.18.18.m1.3.3.1.1.1.1.3.cmml">
               )
              </mo>
             </mrow>
            </msubsup>
           </mrow>
           <mo id="alg1.18.18.m1.3.3.1.1.1.3" stretchy="false" xref="alg1.18.18.m1.3.3.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.18.18.m1.3b">
         <apply id="alg1.18.18.m1.3.3.cmml" xref="alg1.18.18.m1.3.3">
          <and id="alg1.18.18.m1.3.3a.cmml" xref="alg1.18.18.m1.3.3">
          </and>
          <apply id="alg1.18.18.m1.3.3b.cmml" xref="alg1.18.18.m1.3.3">
           <eq id="alg1.18.18.m1.3.3.4.cmml" xref="alg1.18.18.m1.3.3.4">
           </eq>
           <ci id="alg1.18.18.m1.3.3.3.cmml" xref="alg1.18.18.m1.3.3.3">
            𝑘
           </ci>
           <apply id="alg1.18.18.m1.3.3.5.cmml" xref="alg1.18.18.m1.3.3.5">
            <csymbol cd="ambiguous" id="alg1.18.18.m1.3.3.5.1.cmml" xref="alg1.18.18.m1.3.3.5">
             superscript
            </csymbol>
            <apply id="alg1.18.18.m1.3.3.5.2.cmml" xref="alg1.18.18.m1.3.3.5">
             <csymbol cd="ambiguous" id="alg1.18.18.m1.3.3.5.2.1.cmml" xref="alg1.18.18.m1.3.3.5">
              subscript
             </csymbol>
             <ci id="alg1.18.18.m1.3.3.5.2.2.cmml" xref="alg1.18.18.m1.3.3.5.2.2">
              𝑎
             </ci>
             <ci id="alg1.18.18.m1.3.3.5.2.3.cmml" xref="alg1.18.18.m1.3.3.5.2.3">
              𝑗
             </ci>
            </apply>
            <ci id="alg1.18.18.m1.1.1.1.1.cmml" xref="alg1.18.18.m1.1.1.1.1">
             𝑅
            </ci>
           </apply>
          </apply>
          <apply id="alg1.18.18.m1.3.3c.cmml" xref="alg1.18.18.m1.3.3">
           <csymbol cd="latexml" id="alg1.18.18.m1.3.3.6.cmml" xref="alg1.18.18.m1.3.3.6">
            similar-to
           </csymbol>
           <share href="#alg1.18.18.m1.3.3.5.cmml" id="alg1.18.18.m1.3.3d.cmml" xref="alg1.18.18.m1.3.3">
           </share>
           <apply id="alg1.18.18.m1.3.3.1.cmml" xref="alg1.18.18.m1.3.3.1">
            <times id="alg1.18.18.m1.3.3.1.2.cmml" xref="alg1.18.18.m1.3.3.1.2">
            </times>
            <apply id="alg1.18.18.m1.3.3.1.3.cmml" xref="alg1.18.18.m1.3.3.1.3">
             <csymbol cd="ambiguous" id="alg1.18.18.m1.3.3.1.3.1.cmml" xref="alg1.18.18.m1.3.3.1.3">
              subscript
             </csymbol>
             <ci id="alg1.18.18.m1.3.3.1.3.2.cmml" xref="alg1.18.18.m1.3.3.1.3.2">
              𝜋
             </ci>
             <ci id="alg1.18.18.m1.3.3.1.3.3.cmml" xref="alg1.18.18.m1.3.3.1.3.3">
              italic-ϕ
             </ci>
            </apply>
            <apply id="alg1.18.18.m1.3.3.1.1.1.1.cmml" xref="alg1.18.18.m1.3.3.1.1.1">
             <csymbol cd="latexml" id="alg1.18.18.m1.3.3.1.1.1.1.1.cmml" xref="alg1.18.18.m1.3.3.1.1.1.1.1">
              conditional
             </csymbol>
             <ci id="alg1.18.18.m1.3.3.1.1.1.1.2.cmml" xref="alg1.18.18.m1.3.3.1.1.1.1.2">
              𝑎
             </ci>
             <apply id="alg1.18.18.m1.3.3.1.1.1.1.3.cmml" xref="alg1.18.18.m1.3.3.1.1.1.1.3">
              <csymbol cd="ambiguous" id="alg1.18.18.m1.3.3.1.1.1.1.3.1.cmml" xref="alg1.18.18.m1.3.3.1.1.1.1.3">
               superscript
              </csymbol>
              <apply id="alg1.18.18.m1.3.3.1.1.1.1.3.2.cmml" xref="alg1.18.18.m1.3.3.1.1.1.1.3">
               <csymbol cd="ambiguous" id="alg1.18.18.m1.3.3.1.1.1.1.3.2.1.cmml" xref="alg1.18.18.m1.3.3.1.1.1.1.3">
                subscript
               </csymbol>
               <ci id="alg1.18.18.m1.3.3.1.1.1.1.3.2.2.cmml" xref="alg1.18.18.m1.3.3.1.1.1.1.3.2.2">
                𝑠
               </ci>
               <ci id="alg1.18.18.m1.3.3.1.1.1.1.3.2.3.cmml" xref="alg1.18.18.m1.3.3.1.1.1.1.3.2.3">
                𝑗
               </ci>
              </apply>
              <ci id="alg1.18.18.m1.2.2.1.1.cmml" xref="alg1.18.18.m1.2.2.1.1">
               𝑅
              </ci>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.18.18.m1.3c">
         k=a_{j}^{(R)}\sim\pi_{\phi}(a|s_{j}^{(R)})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.19.19">
      <span class="ltx_tag ltx_tag_listingline">
       14
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <math alttext="h^{\prime}\leftarrow\text{LLM}(x\oplus(\tilde{x},\hat{y}_{k}))" class="ltx_Math" display="inline" id="alg1.19.19.m1.2">
       <semantics id="alg1.19.19.m1.2a">
        <mrow id="alg1.19.19.m1.2.2" xref="alg1.19.19.m1.2.2.cmml">
         <msup id="alg1.19.19.m1.2.2.3" xref="alg1.19.19.m1.2.2.3.cmml">
          <mi id="alg1.19.19.m1.2.2.3.2" xref="alg1.19.19.m1.2.2.3.2.cmml">
           h
          </mi>
          <mo id="alg1.19.19.m1.2.2.3.3" xref="alg1.19.19.m1.2.2.3.3.cmml">
           ′
          </mo>
         </msup>
         <mo id="alg1.19.19.m1.2.2.2" stretchy="false" xref="alg1.19.19.m1.2.2.2.cmml">
          ←
         </mo>
         <mrow id="alg1.19.19.m1.2.2.1" xref="alg1.19.19.m1.2.2.1.cmml">
          <mtext id="alg1.19.19.m1.2.2.1.3" xref="alg1.19.19.m1.2.2.1.3a.cmml">
           LLM
          </mtext>
          <mo id="alg1.19.19.m1.2.2.1.2" lspace="0em" rspace="0em" xref="alg1.19.19.m1.2.2.1.2.cmml">
           ​
          </mo>
          <mrow id="alg1.19.19.m1.2.2.1.1.1" xref="alg1.19.19.m1.2.2.1.1.1.1.cmml">
           <mo id="alg1.19.19.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.19.19.m1.2.2.1.1.1.1.cmml">
            (
           </mo>
           <mrow id="alg1.19.19.m1.2.2.1.1.1.1" xref="alg1.19.19.m1.2.2.1.1.1.1.cmml">
            <mi id="alg1.19.19.m1.2.2.1.1.1.1.3" xref="alg1.19.19.m1.2.2.1.1.1.1.3.cmml">
             x
            </mi>
            <mo id="alg1.19.19.m1.2.2.1.1.1.1.2" xref="alg1.19.19.m1.2.2.1.1.1.1.2.cmml">
             ⊕
            </mo>
            <mrow id="alg1.19.19.m1.2.2.1.1.1.1.1.1" xref="alg1.19.19.m1.2.2.1.1.1.1.1.2.cmml">
             <mo id="alg1.19.19.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="alg1.19.19.m1.2.2.1.1.1.1.1.2.cmml">
              (
             </mo>
             <mover accent="true" id="alg1.19.19.m1.1.1" xref="alg1.19.19.m1.1.1.cmml">
              <mi id="alg1.19.19.m1.1.1.2" xref="alg1.19.19.m1.1.1.2.cmml">
               x
              </mi>
              <mo id="alg1.19.19.m1.1.1.1" xref="alg1.19.19.m1.1.1.1.cmml">
               ~
              </mo>
             </mover>
             <mo id="alg1.19.19.m1.2.2.1.1.1.1.1.1.3" xref="alg1.19.19.m1.2.2.1.1.1.1.1.2.cmml">
              ,
             </mo>
             <msub id="alg1.19.19.m1.2.2.1.1.1.1.1.1.1" xref="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.cmml">
              <mover accent="true" id="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.2" xref="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.2.cmml">
               <mi id="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.2.2" xref="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">
                y
               </mi>
               <mo id="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.2.1" xref="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">
                ^
               </mo>
              </mover>
              <mi id="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.3" xref="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.3.cmml">
               k
              </mi>
             </msub>
             <mo id="alg1.19.19.m1.2.2.1.1.1.1.1.1.4" stretchy="false" xref="alg1.19.19.m1.2.2.1.1.1.1.1.2.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="alg1.19.19.m1.2.2.1.1.1.3" stretchy="false" xref="alg1.19.19.m1.2.2.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.19.19.m1.2b">
         <apply id="alg1.19.19.m1.2.2.cmml" xref="alg1.19.19.m1.2.2">
          <ci id="alg1.19.19.m1.2.2.2.cmml" xref="alg1.19.19.m1.2.2.2">
           ←
          </ci>
          <apply id="alg1.19.19.m1.2.2.3.cmml" xref="alg1.19.19.m1.2.2.3">
           <csymbol cd="ambiguous" id="alg1.19.19.m1.2.2.3.1.cmml" xref="alg1.19.19.m1.2.2.3">
            superscript
           </csymbol>
           <ci id="alg1.19.19.m1.2.2.3.2.cmml" xref="alg1.19.19.m1.2.2.3.2">
            ℎ
           </ci>
           <ci id="alg1.19.19.m1.2.2.3.3.cmml" xref="alg1.19.19.m1.2.2.3.3">
            ′
           </ci>
          </apply>
          <apply id="alg1.19.19.m1.2.2.1.cmml" xref="alg1.19.19.m1.2.2.1">
           <times id="alg1.19.19.m1.2.2.1.2.cmml" xref="alg1.19.19.m1.2.2.1.2">
           </times>
           <ci id="alg1.19.19.m1.2.2.1.3a.cmml" xref="alg1.19.19.m1.2.2.1.3">
            <mtext id="alg1.19.19.m1.2.2.1.3.cmml" xref="alg1.19.19.m1.2.2.1.3">
             LLM
            </mtext>
           </ci>
           <apply id="alg1.19.19.m1.2.2.1.1.1.1.cmml" xref="alg1.19.19.m1.2.2.1.1.1">
            <csymbol cd="latexml" id="alg1.19.19.m1.2.2.1.1.1.1.2.cmml" xref="alg1.19.19.m1.2.2.1.1.1.1.2">
             direct-sum
            </csymbol>
            <ci id="alg1.19.19.m1.2.2.1.1.1.1.3.cmml" xref="alg1.19.19.m1.2.2.1.1.1.1.3">
             𝑥
            </ci>
            <interval closure="open" id="alg1.19.19.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.19.19.m1.2.2.1.1.1.1.1.1">
             <apply id="alg1.19.19.m1.1.1.cmml" xref="alg1.19.19.m1.1.1">
              <ci id="alg1.19.19.m1.1.1.1.cmml" xref="alg1.19.19.m1.1.1.1">
               ~
              </ci>
              <ci id="alg1.19.19.m1.1.1.2.cmml" xref="alg1.19.19.m1.1.1.2">
               𝑥
              </ci>
             </apply>
             <apply id="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.19.19.m1.2.2.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.19.19.m1.2.2.1.1.1.1.1.1.1">
               subscript
              </csymbol>
              <apply id="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.2">
               <ci id="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.2.1">
                ^
               </ci>
               <ci id="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.2.2">
                𝑦
               </ci>
              </apply>
              <ci id="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.19.19.m1.2.2.1.1.1.1.1.1.1.3">
               𝑘
              </ci>
             </apply>
            </interval>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.19.19.m1.2c">
         h^{\prime}\leftarrow\text{LLM}(x\oplus(\tilde{x},\hat{y}_{k}))
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.35.38">
      <span class="ltx_tag ltx_tag_listingline">
       15
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.20.20">
      <span class="ltx_tag ltx_tag_listingline">
       16
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.20.20.2">
       if
      </span>
      <em class="ltx_emph ltx_font_italic" id="alg1.20.20.1">
       <math alttext="\Delta(h^{\prime},y)&gt;\Delta(h,y)" class="ltx_Math" display="inline" id="alg1.20.20.1.m1.4">
        <semantics id="alg1.20.20.1.m1.4a">
         <mrow id="alg1.20.20.1.m1.4.4" xref="alg1.20.20.1.m1.4.4.cmml">
          <mrow id="alg1.20.20.1.m1.4.4.1" xref="alg1.20.20.1.m1.4.4.1.cmml">
           <mi id="alg1.20.20.1.m1.4.4.1.3" mathvariant="normal" xref="alg1.20.20.1.m1.4.4.1.3.cmml">
            Δ
           </mi>
           <mo id="alg1.20.20.1.m1.4.4.1.2" lspace="0em" rspace="0em" xref="alg1.20.20.1.m1.4.4.1.2.cmml">
            ​
           </mo>
           <mrow id="alg1.20.20.1.m1.4.4.1.1.1" xref="alg1.20.20.1.m1.4.4.1.1.2.cmml">
            <mo id="alg1.20.20.1.m1.4.4.1.1.1.2" stretchy="false" xref="alg1.20.20.1.m1.4.4.1.1.2.cmml">
             (
            </mo>
            <msup id="alg1.20.20.1.m1.4.4.1.1.1.1" xref="alg1.20.20.1.m1.4.4.1.1.1.1.cmml">
             <mi id="alg1.20.20.1.m1.4.4.1.1.1.1.2" xref="alg1.20.20.1.m1.4.4.1.1.1.1.2.cmml">
              h
             </mi>
             <mo id="alg1.20.20.1.m1.4.4.1.1.1.1.3" xref="alg1.20.20.1.m1.4.4.1.1.1.1.3.cmml">
              ′
             </mo>
            </msup>
            <mo id="alg1.20.20.1.m1.4.4.1.1.1.3" xref="alg1.20.20.1.m1.4.4.1.1.2.cmml">
             ,
            </mo>
            <mi id="alg1.20.20.1.m1.1.1" xref="alg1.20.20.1.m1.1.1.cmml">
             y
            </mi>
            <mo id="alg1.20.20.1.m1.4.4.1.1.1.4" stretchy="false" xref="alg1.20.20.1.m1.4.4.1.1.2.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <mo id="alg1.20.20.1.m1.4.4.2" xref="alg1.20.20.1.m1.4.4.2.cmml">
           &gt;
          </mo>
          <mrow id="alg1.20.20.1.m1.4.4.3" xref="alg1.20.20.1.m1.4.4.3.cmml">
           <mi id="alg1.20.20.1.m1.4.4.3.2" mathvariant="normal" xref="alg1.20.20.1.m1.4.4.3.2.cmml">
            Δ
           </mi>
           <mo id="alg1.20.20.1.m1.4.4.3.1" lspace="0em" rspace="0em" xref="alg1.20.20.1.m1.4.4.3.1.cmml">
            ​
           </mo>
           <mrow id="alg1.20.20.1.m1.4.4.3.3.2" xref="alg1.20.20.1.m1.4.4.3.3.1.cmml">
            <mo id="alg1.20.20.1.m1.4.4.3.3.2.1" stretchy="false" xref="alg1.20.20.1.m1.4.4.3.3.1.cmml">
             (
            </mo>
            <mi id="alg1.20.20.1.m1.2.2" xref="alg1.20.20.1.m1.2.2.cmml">
             h
            </mi>
            <mo id="alg1.20.20.1.m1.4.4.3.3.2.2" xref="alg1.20.20.1.m1.4.4.3.3.1.cmml">
             ,
            </mo>
            <mi id="alg1.20.20.1.m1.3.3" xref="alg1.20.20.1.m1.3.3.cmml">
             y
            </mi>
            <mo id="alg1.20.20.1.m1.4.4.3.3.2.3" stretchy="false" xref="alg1.20.20.1.m1.4.4.3.3.1.cmml">
             )
            </mo>
           </mrow>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="alg1.20.20.1.m1.4b">
          <apply id="alg1.20.20.1.m1.4.4.cmml" xref="alg1.20.20.1.m1.4.4">
           <gt id="alg1.20.20.1.m1.4.4.2.cmml" xref="alg1.20.20.1.m1.4.4.2">
           </gt>
           <apply id="alg1.20.20.1.m1.4.4.1.cmml" xref="alg1.20.20.1.m1.4.4.1">
            <times id="alg1.20.20.1.m1.4.4.1.2.cmml" xref="alg1.20.20.1.m1.4.4.1.2">
            </times>
            <ci id="alg1.20.20.1.m1.4.4.1.3.cmml" xref="alg1.20.20.1.m1.4.4.1.3">
             Δ
            </ci>
            <interval closure="open" id="alg1.20.20.1.m1.4.4.1.1.2.cmml" xref="alg1.20.20.1.m1.4.4.1.1.1">
             <apply id="alg1.20.20.1.m1.4.4.1.1.1.1.cmml" xref="alg1.20.20.1.m1.4.4.1.1.1.1">
              <csymbol cd="ambiguous" id="alg1.20.20.1.m1.4.4.1.1.1.1.1.cmml" xref="alg1.20.20.1.m1.4.4.1.1.1.1">
               superscript
              </csymbol>
              <ci id="alg1.20.20.1.m1.4.4.1.1.1.1.2.cmml" xref="alg1.20.20.1.m1.4.4.1.1.1.1.2">
               ℎ
              </ci>
              <ci id="alg1.20.20.1.m1.4.4.1.1.1.1.3.cmml" xref="alg1.20.20.1.m1.4.4.1.1.1.1.3">
               ′
              </ci>
             </apply>
             <ci id="alg1.20.20.1.m1.1.1.cmml" xref="alg1.20.20.1.m1.1.1">
              𝑦
             </ci>
            </interval>
           </apply>
           <apply id="alg1.20.20.1.m1.4.4.3.cmml" xref="alg1.20.20.1.m1.4.4.3">
            <times id="alg1.20.20.1.m1.4.4.3.1.cmml" xref="alg1.20.20.1.m1.4.4.3.1">
            </times>
            <ci id="alg1.20.20.1.m1.4.4.3.2.cmml" xref="alg1.20.20.1.m1.4.4.3.2">
             Δ
            </ci>
            <interval closure="open" id="alg1.20.20.1.m1.4.4.3.3.1.cmml" xref="alg1.20.20.1.m1.4.4.3.3.2">
             <ci id="alg1.20.20.1.m1.2.2.cmml" xref="alg1.20.20.1.m1.2.2">
              ℎ
             </ci>
             <ci id="alg1.20.20.1.m1.3.3.cmml" xref="alg1.20.20.1.m1.3.3">
              𝑦
             </ci>
            </interval>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.20.20.1.m1.4c">
          \Delta(h^{\prime},y)&gt;\Delta(h,y)
         </annotation>
        </semantics>
       </math>
      </em>
      <span class="ltx_text ltx_font_bold" id="alg1.20.20.3">
       then
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.21.21">
      <span class="ltx_tag ltx_tag_listingline">
       17
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <math alttext="r_{j}^{(R)}\leftarrow\Delta(h^{\prime},y)-\Delta(h,y)" class="ltx_Math" display="inline" id="alg1.21.21.m1.5">
       <semantics id="alg1.21.21.m1.5a">
        <mrow id="alg1.21.21.m1.5.5" xref="alg1.21.21.m1.5.5.cmml">
         <msubsup id="alg1.21.21.m1.5.5.3" xref="alg1.21.21.m1.5.5.3.cmml">
          <mi id="alg1.21.21.m1.5.5.3.2.2" xref="alg1.21.21.m1.5.5.3.2.2.cmml">
           r
          </mi>
          <mi id="alg1.21.21.m1.5.5.3.2.3" xref="alg1.21.21.m1.5.5.3.2.3.cmml">
           j
          </mi>
          <mrow id="alg1.21.21.m1.1.1.1.3" xref="alg1.21.21.m1.5.5.3.cmml">
           <mo id="alg1.21.21.m1.1.1.1.3.1" stretchy="false" xref="alg1.21.21.m1.5.5.3.cmml">
            (
           </mo>
           <mi id="alg1.21.21.m1.1.1.1.1" xref="alg1.21.21.m1.1.1.1.1.cmml">
            R
           </mi>
           <mo id="alg1.21.21.m1.1.1.1.3.2" stretchy="false" xref="alg1.21.21.m1.5.5.3.cmml">
            )
           </mo>
          </mrow>
         </msubsup>
         <mo id="alg1.21.21.m1.5.5.2" stretchy="false" xref="alg1.21.21.m1.5.5.2.cmml">
          ←
         </mo>
         <mrow id="alg1.21.21.m1.5.5.1" xref="alg1.21.21.m1.5.5.1.cmml">
          <mrow id="alg1.21.21.m1.5.5.1.1" xref="alg1.21.21.m1.5.5.1.1.cmml">
           <mi id="alg1.21.21.m1.5.5.1.1.3" mathvariant="normal" xref="alg1.21.21.m1.5.5.1.1.3.cmml">
            Δ
           </mi>
           <mo id="alg1.21.21.m1.5.5.1.1.2" lspace="0em" rspace="0em" xref="alg1.21.21.m1.5.5.1.1.2.cmml">
            ​
           </mo>
           <mrow id="alg1.21.21.m1.5.5.1.1.1.1" xref="alg1.21.21.m1.5.5.1.1.1.2.cmml">
            <mo id="alg1.21.21.m1.5.5.1.1.1.1.2" stretchy="false" xref="alg1.21.21.m1.5.5.1.1.1.2.cmml">
             (
            </mo>
            <msup id="alg1.21.21.m1.5.5.1.1.1.1.1" xref="alg1.21.21.m1.5.5.1.1.1.1.1.cmml">
             <mi id="alg1.21.21.m1.5.5.1.1.1.1.1.2" xref="alg1.21.21.m1.5.5.1.1.1.1.1.2.cmml">
              h
             </mi>
             <mo id="alg1.21.21.m1.5.5.1.1.1.1.1.3" xref="alg1.21.21.m1.5.5.1.1.1.1.1.3.cmml">
              ′
             </mo>
            </msup>
            <mo id="alg1.21.21.m1.5.5.1.1.1.1.3" xref="alg1.21.21.m1.5.5.1.1.1.2.cmml">
             ,
            </mo>
            <mi id="alg1.21.21.m1.2.2" xref="alg1.21.21.m1.2.2.cmml">
             y
            </mi>
            <mo id="alg1.21.21.m1.5.5.1.1.1.1.4" stretchy="false" xref="alg1.21.21.m1.5.5.1.1.1.2.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <mo id="alg1.21.21.m1.5.5.1.2" xref="alg1.21.21.m1.5.5.1.2.cmml">
           −
          </mo>
          <mrow id="alg1.21.21.m1.5.5.1.3" xref="alg1.21.21.m1.5.5.1.3.cmml">
           <mi id="alg1.21.21.m1.5.5.1.3.2" mathvariant="normal" xref="alg1.21.21.m1.5.5.1.3.2.cmml">
            Δ
           </mi>
           <mo id="alg1.21.21.m1.5.5.1.3.1" lspace="0em" rspace="0em" xref="alg1.21.21.m1.5.5.1.3.1.cmml">
            ​
           </mo>
           <mrow id="alg1.21.21.m1.5.5.1.3.3.2" xref="alg1.21.21.m1.5.5.1.3.3.1.cmml">
            <mo id="alg1.21.21.m1.5.5.1.3.3.2.1" stretchy="false" xref="alg1.21.21.m1.5.5.1.3.3.1.cmml">
             (
            </mo>
            <mi id="alg1.21.21.m1.3.3" xref="alg1.21.21.m1.3.3.cmml">
             h
            </mi>
            <mo id="alg1.21.21.m1.5.5.1.3.3.2.2" xref="alg1.21.21.m1.5.5.1.3.3.1.cmml">
             ,
            </mo>
            <mi id="alg1.21.21.m1.4.4" xref="alg1.21.21.m1.4.4.cmml">
             y
            </mi>
            <mo id="alg1.21.21.m1.5.5.1.3.3.2.3" stretchy="false" xref="alg1.21.21.m1.5.5.1.3.3.1.cmml">
             )
            </mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.21.21.m1.5b">
         <apply id="alg1.21.21.m1.5.5.cmml" xref="alg1.21.21.m1.5.5">
          <ci id="alg1.21.21.m1.5.5.2.cmml" xref="alg1.21.21.m1.5.5.2">
           ←
          </ci>
          <apply id="alg1.21.21.m1.5.5.3.cmml" xref="alg1.21.21.m1.5.5.3">
           <csymbol cd="ambiguous" id="alg1.21.21.m1.5.5.3.1.cmml" xref="alg1.21.21.m1.5.5.3">
            superscript
           </csymbol>
           <apply id="alg1.21.21.m1.5.5.3.2.cmml" xref="alg1.21.21.m1.5.5.3">
            <csymbol cd="ambiguous" id="alg1.21.21.m1.5.5.3.2.1.cmml" xref="alg1.21.21.m1.5.5.3">
             subscript
            </csymbol>
            <ci id="alg1.21.21.m1.5.5.3.2.2.cmml" xref="alg1.21.21.m1.5.5.3.2.2">
             𝑟
            </ci>
            <ci id="alg1.21.21.m1.5.5.3.2.3.cmml" xref="alg1.21.21.m1.5.5.3.2.3">
             𝑗
            </ci>
           </apply>
           <ci id="alg1.21.21.m1.1.1.1.1.cmml" xref="alg1.21.21.m1.1.1.1.1">
            𝑅
           </ci>
          </apply>
          <apply id="alg1.21.21.m1.5.5.1.cmml" xref="alg1.21.21.m1.5.5.1">
           <minus id="alg1.21.21.m1.5.5.1.2.cmml" xref="alg1.21.21.m1.5.5.1.2">
           </minus>
           <apply id="alg1.21.21.m1.5.5.1.1.cmml" xref="alg1.21.21.m1.5.5.1.1">
            <times id="alg1.21.21.m1.5.5.1.1.2.cmml" xref="alg1.21.21.m1.5.5.1.1.2">
            </times>
            <ci id="alg1.21.21.m1.5.5.1.1.3.cmml" xref="alg1.21.21.m1.5.5.1.1.3">
             Δ
            </ci>
            <interval closure="open" id="alg1.21.21.m1.5.5.1.1.1.2.cmml" xref="alg1.21.21.m1.5.5.1.1.1.1">
             <apply id="alg1.21.21.m1.5.5.1.1.1.1.1.cmml" xref="alg1.21.21.m1.5.5.1.1.1.1.1">
              <csymbol cd="ambiguous" id="alg1.21.21.m1.5.5.1.1.1.1.1.1.cmml" xref="alg1.21.21.m1.5.5.1.1.1.1.1">
               superscript
              </csymbol>
              <ci id="alg1.21.21.m1.5.5.1.1.1.1.1.2.cmml" xref="alg1.21.21.m1.5.5.1.1.1.1.1.2">
               ℎ
              </ci>
              <ci id="alg1.21.21.m1.5.5.1.1.1.1.1.3.cmml" xref="alg1.21.21.m1.5.5.1.1.1.1.1.3">
               ′
              </ci>
             </apply>
             <ci id="alg1.21.21.m1.2.2.cmml" xref="alg1.21.21.m1.2.2">
              𝑦
             </ci>
            </interval>
           </apply>
           <apply id="alg1.21.21.m1.5.5.1.3.cmml" xref="alg1.21.21.m1.5.5.1.3">
            <times id="alg1.21.21.m1.5.5.1.3.1.cmml" xref="alg1.21.21.m1.5.5.1.3.1">
            </times>
            <ci id="alg1.21.21.m1.5.5.1.3.2.cmml" xref="alg1.21.21.m1.5.5.1.3.2">
             Δ
            </ci>
            <interval closure="open" id="alg1.21.21.m1.5.5.1.3.3.1.cmml" xref="alg1.21.21.m1.5.5.1.3.3.2">
             <ci id="alg1.21.21.m1.3.3.cmml" xref="alg1.21.21.m1.3.3">
              ℎ
             </ci>
             <ci id="alg1.21.21.m1.4.4.cmml" xref="alg1.21.21.m1.4.4">
              𝑦
             </ci>
            </interval>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.21.21.m1.5c">
         r_{j}^{(R)}\leftarrow\Delta(h^{\prime},y)-\Delta(h,y)
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.23.23">
      <span class="ltx_tag ltx_tag_listingline">
       18
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <math alttext="D_{m}.{\tilde{y}}\leftarrow\hat{y}_{k}" class="ltx_Math" display="inline" id="alg1.22.22.m1.2">
       <semantics id="alg1.22.22.m1.2a">
        <mrow id="alg1.22.22.m1.2.2.2" xref="alg1.22.22.m1.2.2.3.cmml">
         <msub id="alg1.22.22.m1.1.1.1.1" xref="alg1.22.22.m1.1.1.1.1.cmml">
          <mi id="alg1.22.22.m1.1.1.1.1.2" xref="alg1.22.22.m1.1.1.1.1.2.cmml">
           D
          </mi>
          <mi id="alg1.22.22.m1.1.1.1.1.3" xref="alg1.22.22.m1.1.1.1.1.3.cmml">
           m
          </mi>
         </msub>
         <mo id="alg1.22.22.m1.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg1.22.22.m1.2.2.3a.cmml">
          .
         </mo>
         <mrow id="alg1.22.22.m1.2.2.2.2" xref="alg1.22.22.m1.2.2.2.2.cmml">
          <mover accent="true" id="alg1.22.22.m1.2.2.2.2.2" xref="alg1.22.22.m1.2.2.2.2.2.cmml">
           <mi id="alg1.22.22.m1.2.2.2.2.2.2" xref="alg1.22.22.m1.2.2.2.2.2.2.cmml">
            y
           </mi>
           <mo id="alg1.22.22.m1.2.2.2.2.2.1" xref="alg1.22.22.m1.2.2.2.2.2.1.cmml">
            ~
           </mo>
          </mover>
          <mo id="alg1.22.22.m1.2.2.2.2.1" stretchy="false" xref="alg1.22.22.m1.2.2.2.2.1.cmml">
           ←
          </mo>
          <msub id="alg1.22.22.m1.2.2.2.2.3" xref="alg1.22.22.m1.2.2.2.2.3.cmml">
           <mover accent="true" id="alg1.22.22.m1.2.2.2.2.3.2" xref="alg1.22.22.m1.2.2.2.2.3.2.cmml">
            <mi id="alg1.22.22.m1.2.2.2.2.3.2.2" xref="alg1.22.22.m1.2.2.2.2.3.2.2.cmml">
             y
            </mi>
            <mo id="alg1.22.22.m1.2.2.2.2.3.2.1" xref="alg1.22.22.m1.2.2.2.2.3.2.1.cmml">
             ^
            </mo>
           </mover>
           <mi id="alg1.22.22.m1.2.2.2.2.3.3" xref="alg1.22.22.m1.2.2.2.2.3.3.cmml">
            k
           </mi>
          </msub>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.22.22.m1.2b">
         <apply id="alg1.22.22.m1.2.2.3.cmml" xref="alg1.22.22.m1.2.2.2">
          <csymbol cd="ambiguous" id="alg1.22.22.m1.2.2.3a.cmml" xref="alg1.22.22.m1.2.2.2.3">
           formulae-sequence
          </csymbol>
          <apply id="alg1.22.22.m1.1.1.1.1.cmml" xref="alg1.22.22.m1.1.1.1.1">
           <csymbol cd="ambiguous" id="alg1.22.22.m1.1.1.1.1.1.cmml" xref="alg1.22.22.m1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="alg1.22.22.m1.1.1.1.1.2.cmml" xref="alg1.22.22.m1.1.1.1.1.2">
            𝐷
           </ci>
           <ci id="alg1.22.22.m1.1.1.1.1.3.cmml" xref="alg1.22.22.m1.1.1.1.1.3">
            𝑚
           </ci>
          </apply>
          <apply id="alg1.22.22.m1.2.2.2.2.cmml" xref="alg1.22.22.m1.2.2.2.2">
           <ci id="alg1.22.22.m1.2.2.2.2.1.cmml" xref="alg1.22.22.m1.2.2.2.2.1">
            ←
           </ci>
           <apply id="alg1.22.22.m1.2.2.2.2.2.cmml" xref="alg1.22.22.m1.2.2.2.2.2">
            <ci id="alg1.22.22.m1.2.2.2.2.2.1.cmml" xref="alg1.22.22.m1.2.2.2.2.2.1">
             ~
            </ci>
            <ci id="alg1.22.22.m1.2.2.2.2.2.2.cmml" xref="alg1.22.22.m1.2.2.2.2.2.2">
             𝑦
            </ci>
           </apply>
           <apply id="alg1.22.22.m1.2.2.2.2.3.cmml" xref="alg1.22.22.m1.2.2.2.2.3">
            <csymbol cd="ambiguous" id="alg1.22.22.m1.2.2.2.2.3.1.cmml" xref="alg1.22.22.m1.2.2.2.2.3">
             subscript
            </csymbol>
            <apply id="alg1.22.22.m1.2.2.2.2.3.2.cmml" xref="alg1.22.22.m1.2.2.2.2.3.2">
             <ci id="alg1.22.22.m1.2.2.2.2.3.2.1.cmml" xref="alg1.22.22.m1.2.2.2.2.3.2.1">
              ^
             </ci>
             <ci id="alg1.22.22.m1.2.2.2.2.3.2.2.cmml" xref="alg1.22.22.m1.2.2.2.2.3.2.2">
              𝑦
             </ci>
            </apply>
            <ci id="alg1.22.22.m1.2.2.2.2.3.3.cmml" xref="alg1.22.22.m1.2.2.2.2.3.3">
             𝑘
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.22.22.m1.2c">
         D_{m}.{\tilde{y}}\leftarrow\hat{y}_{k}
        </annotation>
       </semantics>
      </math>
      ,
      <math alttext="h\leftarrow h^{\prime}" class="ltx_Math" display="inline" id="alg1.23.23.m2.1">
       <semantics id="alg1.23.23.m2.1a">
        <mrow id="alg1.23.23.m2.1.1" xref="alg1.23.23.m2.1.1.cmml">
         <mi id="alg1.23.23.m2.1.1.2" xref="alg1.23.23.m2.1.1.2.cmml">
          h
         </mi>
         <mo id="alg1.23.23.m2.1.1.1" stretchy="false" xref="alg1.23.23.m2.1.1.1.cmml">
          ←
         </mo>
         <msup id="alg1.23.23.m2.1.1.3" xref="alg1.23.23.m2.1.1.3.cmml">
          <mi id="alg1.23.23.m2.1.1.3.2" xref="alg1.23.23.m2.1.1.3.2.cmml">
           h
          </mi>
          <mo id="alg1.23.23.m2.1.1.3.3" xref="alg1.23.23.m2.1.1.3.3.cmml">
           ′
          </mo>
         </msup>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.23.23.m2.1b">
         <apply id="alg1.23.23.m2.1.1.cmml" xref="alg1.23.23.m2.1.1">
          <ci id="alg1.23.23.m2.1.1.1.cmml" xref="alg1.23.23.m2.1.1.1">
           ←
          </ci>
          <ci id="alg1.23.23.m2.1.1.2.cmml" xref="alg1.23.23.m2.1.1.2">
           ℎ
          </ci>
          <apply id="alg1.23.23.m2.1.1.3.cmml" xref="alg1.23.23.m2.1.1.3">
           <csymbol cd="ambiguous" id="alg1.23.23.m2.1.1.3.1.cmml" xref="alg1.23.23.m2.1.1.3">
            superscript
           </csymbol>
           <ci id="alg1.23.23.m2.1.1.3.2.cmml" xref="alg1.23.23.m2.1.1.3.2">
            ℎ
           </ci>
           <ci id="alg1.23.23.m2.1.1.3.3.cmml" xref="alg1.23.23.m2.1.1.3.3">
            ′
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.23.23.m2.1c">
         h\leftarrow h^{\prime}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.35.39">
      <span class="ltx_tag ltx_tag_listingline">
       19
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.35.40">
      <span class="ltx_tag ltx_tag_listingline">
       20
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.35.40.1">
       else
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.24.24">
      <span class="ltx_tag ltx_tag_listingline">
       21
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <math alttext="r_{j}^{(R)}\leftarrow 0" class="ltx_Math" display="inline" id="alg1.24.24.m1.1">
       <semantics id="alg1.24.24.m1.1a">
        <mrow id="alg1.24.24.m1.1.2" xref="alg1.24.24.m1.1.2.cmml">
         <msubsup id="alg1.24.24.m1.1.2.2" xref="alg1.24.24.m1.1.2.2.cmml">
          <mi id="alg1.24.24.m1.1.2.2.2.2" xref="alg1.24.24.m1.1.2.2.2.2.cmml">
           r
          </mi>
          <mi id="alg1.24.24.m1.1.2.2.2.3" xref="alg1.24.24.m1.1.2.2.2.3.cmml">
           j
          </mi>
          <mrow id="alg1.24.24.m1.1.1.1.3" xref="alg1.24.24.m1.1.2.2.cmml">
           <mo id="alg1.24.24.m1.1.1.1.3.1" stretchy="false" xref="alg1.24.24.m1.1.2.2.cmml">
            (
           </mo>
           <mi id="alg1.24.24.m1.1.1.1.1" xref="alg1.24.24.m1.1.1.1.1.cmml">
            R
           </mi>
           <mo id="alg1.24.24.m1.1.1.1.3.2" stretchy="false" xref="alg1.24.24.m1.1.2.2.cmml">
            )
           </mo>
          </mrow>
         </msubsup>
         <mo id="alg1.24.24.m1.1.2.1" stretchy="false" xref="alg1.24.24.m1.1.2.1.cmml">
          ←
         </mo>
         <mn id="alg1.24.24.m1.1.2.3" xref="alg1.24.24.m1.1.2.3.cmml">
          0
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.24.24.m1.1b">
         <apply id="alg1.24.24.m1.1.2.cmml" xref="alg1.24.24.m1.1.2">
          <ci id="alg1.24.24.m1.1.2.1.cmml" xref="alg1.24.24.m1.1.2.1">
           ←
          </ci>
          <apply id="alg1.24.24.m1.1.2.2.cmml" xref="alg1.24.24.m1.1.2.2">
           <csymbol cd="ambiguous" id="alg1.24.24.m1.1.2.2.1.cmml" xref="alg1.24.24.m1.1.2.2">
            superscript
           </csymbol>
           <apply id="alg1.24.24.m1.1.2.2.2.cmml" xref="alg1.24.24.m1.1.2.2">
            <csymbol cd="ambiguous" id="alg1.24.24.m1.1.2.2.2.1.cmml" xref="alg1.24.24.m1.1.2.2">
             subscript
            </csymbol>
            <ci id="alg1.24.24.m1.1.2.2.2.2.cmml" xref="alg1.24.24.m1.1.2.2.2.2">
             𝑟
            </ci>
            <ci id="alg1.24.24.m1.1.2.2.2.3.cmml" xref="alg1.24.24.m1.1.2.2.2.3">
             𝑗
            </ci>
           </apply>
           <ci id="alg1.24.24.m1.1.1.1.1.cmml" xref="alg1.24.24.m1.1.1.1.1">
            𝑅
           </ci>
          </apply>
          <cn id="alg1.24.24.m1.1.2.3.cmml" type="integer" xref="alg1.24.24.m1.1.2.3">
           0
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.24.24.m1.1c">
         r_{j}^{(R)}\leftarrow 0
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.27.27">
      <span class="ltx_tag ltx_tag_listingline">
       22
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      construct
      <math alttext="s_{j+1}^{(R)}" class="ltx_Math" display="inline" id="alg1.25.25.m1.1">
       <semantics id="alg1.25.25.m1.1a">
        <msubsup id="alg1.25.25.m1.1.2" xref="alg1.25.25.m1.1.2.cmml">
         <mi id="alg1.25.25.m1.1.2.2.2" xref="alg1.25.25.m1.1.2.2.2.cmml">
          s
         </mi>
         <mrow id="alg1.25.25.m1.1.2.2.3" xref="alg1.25.25.m1.1.2.2.3.cmml">
          <mi id="alg1.25.25.m1.1.2.2.3.2" xref="alg1.25.25.m1.1.2.2.3.2.cmml">
           j
          </mi>
          <mo id="alg1.25.25.m1.1.2.2.3.1" xref="alg1.25.25.m1.1.2.2.3.1.cmml">
           +
          </mo>
          <mn id="alg1.25.25.m1.1.2.2.3.3" xref="alg1.25.25.m1.1.2.2.3.3.cmml">
           1
          </mn>
         </mrow>
         <mrow id="alg1.25.25.m1.1.1.1.3" xref="alg1.25.25.m1.1.2.cmml">
          <mo id="alg1.25.25.m1.1.1.1.3.1" stretchy="false" xref="alg1.25.25.m1.1.2.cmml">
           (
          </mo>
          <mi id="alg1.25.25.m1.1.1.1.1" xref="alg1.25.25.m1.1.1.1.1.cmml">
           R
          </mi>
          <mo id="alg1.25.25.m1.1.1.1.3.2" stretchy="false" xref="alg1.25.25.m1.1.2.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="alg1.25.25.m1.1b">
         <apply id="alg1.25.25.m1.1.2.cmml" xref="alg1.25.25.m1.1.2">
          <csymbol cd="ambiguous" id="alg1.25.25.m1.1.2.1.cmml" xref="alg1.25.25.m1.1.2">
           superscript
          </csymbol>
          <apply id="alg1.25.25.m1.1.2.2.cmml" xref="alg1.25.25.m1.1.2">
           <csymbol cd="ambiguous" id="alg1.25.25.m1.1.2.2.1.cmml" xref="alg1.25.25.m1.1.2">
            subscript
           </csymbol>
           <ci id="alg1.25.25.m1.1.2.2.2.cmml" xref="alg1.25.25.m1.1.2.2.2">
            𝑠
           </ci>
           <apply id="alg1.25.25.m1.1.2.2.3.cmml" xref="alg1.25.25.m1.1.2.2.3">
            <plus id="alg1.25.25.m1.1.2.2.3.1.cmml" xref="alg1.25.25.m1.1.2.2.3.1">
            </plus>
            <ci id="alg1.25.25.m1.1.2.2.3.2.cmml" xref="alg1.25.25.m1.1.2.2.3.2">
             𝑗
            </ci>
            <cn id="alg1.25.25.m1.1.2.2.3.3.cmml" type="integer" xref="alg1.25.25.m1.1.2.2.3.3">
             1
            </cn>
           </apply>
          </apply>
          <ci id="alg1.25.25.m1.1.1.1.1.cmml" xref="alg1.25.25.m1.1.1.1.1">
           𝑅
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.25.25.m1.1c">
         s_{j+1}^{(R)}
        </annotation>
       </semantics>
      </math>
      with
      <math alttext="h" class="ltx_Math" display="inline" id="alg1.26.26.m2.1">
       <semantics id="alg1.26.26.m2.1a">
        <mi id="alg1.26.26.m2.1.1" xref="alg1.26.26.m2.1.1.cmml">
         h
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.26.26.m2.1b">
         <ci id="alg1.26.26.m2.1.1.cmml" xref="alg1.26.26.m2.1.1">
          ℎ
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.26.26.m2.1c">
         h
        </annotation>
       </semantics>
      </math>
      on a new
      <math alttext="\mathbb{C}" class="ltx_Math" display="inline" id="alg1.27.27.m3.1">
       <semantics id="alg1.27.27.m3.1a">
        <mi id="alg1.27.27.m3.1.1" xref="alg1.27.27.m3.1.1.cmml">
         ℂ
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.27.27.m3.1b">
         <ci id="alg1.27.27.m3.1.1.cmml" xref="alg1.27.27.m3.1.1">
          ℂ
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.27.27.m3.1c">
         \mathbb{C}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.28.28">
      <span class="ltx_tag ltx_tag_listingline">
       23
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <math alttext="r_{i}^{(S)}\leftarrow r_{i}^{(S)}+r_{j}^{(R)}" class="ltx_Math" display="inline" id="alg1.28.28.m1.3">
       <semantics id="alg1.28.28.m1.3a">
        <mrow id="alg1.28.28.m1.3.4" xref="alg1.28.28.m1.3.4.cmml">
         <msubsup id="alg1.28.28.m1.3.4.2" xref="alg1.28.28.m1.3.4.2.cmml">
          <mi id="alg1.28.28.m1.3.4.2.2.2" xref="alg1.28.28.m1.3.4.2.2.2.cmml">
           r
          </mi>
          <mi id="alg1.28.28.m1.3.4.2.2.3" xref="alg1.28.28.m1.3.4.2.2.3.cmml">
           i
          </mi>
          <mrow id="alg1.28.28.m1.1.1.1.3" xref="alg1.28.28.m1.3.4.2.cmml">
           <mo id="alg1.28.28.m1.1.1.1.3.1" stretchy="false" xref="alg1.28.28.m1.3.4.2.cmml">
            (
           </mo>
           <mi id="alg1.28.28.m1.1.1.1.1" xref="alg1.28.28.m1.1.1.1.1.cmml">
            S
           </mi>
           <mo id="alg1.28.28.m1.1.1.1.3.2" stretchy="false" xref="alg1.28.28.m1.3.4.2.cmml">
            )
           </mo>
          </mrow>
         </msubsup>
         <mo id="alg1.28.28.m1.3.4.1" stretchy="false" xref="alg1.28.28.m1.3.4.1.cmml">
          ←
         </mo>
         <mrow id="alg1.28.28.m1.3.4.3" xref="alg1.28.28.m1.3.4.3.cmml">
          <msubsup id="alg1.28.28.m1.3.4.3.2" xref="alg1.28.28.m1.3.4.3.2.cmml">
           <mi id="alg1.28.28.m1.3.4.3.2.2.2" xref="alg1.28.28.m1.3.4.3.2.2.2.cmml">
            r
           </mi>
           <mi id="alg1.28.28.m1.3.4.3.2.2.3" xref="alg1.28.28.m1.3.4.3.2.2.3.cmml">
            i
           </mi>
           <mrow id="alg1.28.28.m1.2.2.1.3" xref="alg1.28.28.m1.3.4.3.2.cmml">
            <mo id="alg1.28.28.m1.2.2.1.3.1" stretchy="false" xref="alg1.28.28.m1.3.4.3.2.cmml">
             (
            </mo>
            <mi id="alg1.28.28.m1.2.2.1.1" xref="alg1.28.28.m1.2.2.1.1.cmml">
             S
            </mi>
            <mo id="alg1.28.28.m1.2.2.1.3.2" stretchy="false" xref="alg1.28.28.m1.3.4.3.2.cmml">
             )
            </mo>
           </mrow>
          </msubsup>
          <mo id="alg1.28.28.m1.3.4.3.1" xref="alg1.28.28.m1.3.4.3.1.cmml">
           +
          </mo>
          <msubsup id="alg1.28.28.m1.3.4.3.3" xref="alg1.28.28.m1.3.4.3.3.cmml">
           <mi id="alg1.28.28.m1.3.4.3.3.2.2" xref="alg1.28.28.m1.3.4.3.3.2.2.cmml">
            r
           </mi>
           <mi id="alg1.28.28.m1.3.4.3.3.2.3" xref="alg1.28.28.m1.3.4.3.3.2.3.cmml">
            j
           </mi>
           <mrow id="alg1.28.28.m1.3.3.1.3" xref="alg1.28.28.m1.3.4.3.3.cmml">
            <mo id="alg1.28.28.m1.3.3.1.3.1" stretchy="false" xref="alg1.28.28.m1.3.4.3.3.cmml">
             (
            </mo>
            <mi id="alg1.28.28.m1.3.3.1.1" xref="alg1.28.28.m1.3.3.1.1.cmml">
             R
            </mi>
            <mo id="alg1.28.28.m1.3.3.1.3.2" stretchy="false" xref="alg1.28.28.m1.3.4.3.3.cmml">
             )
            </mo>
           </mrow>
          </msubsup>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.28.28.m1.3b">
         <apply id="alg1.28.28.m1.3.4.cmml" xref="alg1.28.28.m1.3.4">
          <ci id="alg1.28.28.m1.3.4.1.cmml" xref="alg1.28.28.m1.3.4.1">
           ←
          </ci>
          <apply id="alg1.28.28.m1.3.4.2.cmml" xref="alg1.28.28.m1.3.4.2">
           <csymbol cd="ambiguous" id="alg1.28.28.m1.3.4.2.1.cmml" xref="alg1.28.28.m1.3.4.2">
            superscript
           </csymbol>
           <apply id="alg1.28.28.m1.3.4.2.2.cmml" xref="alg1.28.28.m1.3.4.2">
            <csymbol cd="ambiguous" id="alg1.28.28.m1.3.4.2.2.1.cmml" xref="alg1.28.28.m1.3.4.2">
             subscript
            </csymbol>
            <ci id="alg1.28.28.m1.3.4.2.2.2.cmml" xref="alg1.28.28.m1.3.4.2.2.2">
             𝑟
            </ci>
            <ci id="alg1.28.28.m1.3.4.2.2.3.cmml" xref="alg1.28.28.m1.3.4.2.2.3">
             𝑖
            </ci>
           </apply>
           <ci id="alg1.28.28.m1.1.1.1.1.cmml" xref="alg1.28.28.m1.1.1.1.1">
            𝑆
           </ci>
          </apply>
          <apply id="alg1.28.28.m1.3.4.3.cmml" xref="alg1.28.28.m1.3.4.3">
           <plus id="alg1.28.28.m1.3.4.3.1.cmml" xref="alg1.28.28.m1.3.4.3.1">
           </plus>
           <apply id="alg1.28.28.m1.3.4.3.2.cmml" xref="alg1.28.28.m1.3.4.3.2">
            <csymbol cd="ambiguous" id="alg1.28.28.m1.3.4.3.2.1.cmml" xref="alg1.28.28.m1.3.4.3.2">
             superscript
            </csymbol>
            <apply id="alg1.28.28.m1.3.4.3.2.2.cmml" xref="alg1.28.28.m1.3.4.3.2">
             <csymbol cd="ambiguous" id="alg1.28.28.m1.3.4.3.2.2.1.cmml" xref="alg1.28.28.m1.3.4.3.2">
              subscript
             </csymbol>
             <ci id="alg1.28.28.m1.3.4.3.2.2.2.cmml" xref="alg1.28.28.m1.3.4.3.2.2.2">
              𝑟
             </ci>
             <ci id="alg1.28.28.m1.3.4.3.2.2.3.cmml" xref="alg1.28.28.m1.3.4.3.2.2.3">
              𝑖
             </ci>
            </apply>
            <ci id="alg1.28.28.m1.2.2.1.1.cmml" xref="alg1.28.28.m1.2.2.1.1">
             𝑆
            </ci>
           </apply>
           <apply id="alg1.28.28.m1.3.4.3.3.cmml" xref="alg1.28.28.m1.3.4.3.3">
            <csymbol cd="ambiguous" id="alg1.28.28.m1.3.4.3.3.1.cmml" xref="alg1.28.28.m1.3.4.3.3">
             superscript
            </csymbol>
            <apply id="alg1.28.28.m1.3.4.3.3.2.cmml" xref="alg1.28.28.m1.3.4.3.3">
             <csymbol cd="ambiguous" id="alg1.28.28.m1.3.4.3.3.2.1.cmml" xref="alg1.28.28.m1.3.4.3.3">
              subscript
             </csymbol>
             <ci id="alg1.28.28.m1.3.4.3.3.2.2.cmml" xref="alg1.28.28.m1.3.4.3.3.2.2">
              𝑟
             </ci>
             <ci id="alg1.28.28.m1.3.4.3.3.2.3.cmml" xref="alg1.28.28.m1.3.4.3.3.2.3">
              𝑗
             </ci>
            </apply>
            <ci id="alg1.28.28.m1.3.3.1.1.cmml" xref="alg1.28.28.m1.3.3.1.1">
             𝑅
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.28.28.m1.3c">
         r_{i}^{(S)}\leftarrow r_{i}^{(S)}+r_{j}^{(R)}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.35.41">
      <span class="ltx_tag ltx_tag_listingline">
       24
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.31.31">
      <span class="ltx_tag ltx_tag_listingline">
       25
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      construct
      <math alttext="s_{i+1}^{(S)}" class="ltx_Math" display="inline" id="alg1.29.29.m1.1">
       <semantics id="alg1.29.29.m1.1a">
        <msubsup id="alg1.29.29.m1.1.2" xref="alg1.29.29.m1.1.2.cmml">
         <mi id="alg1.29.29.m1.1.2.2.2" xref="alg1.29.29.m1.1.2.2.2.cmml">
          s
         </mi>
         <mrow id="alg1.29.29.m1.1.2.2.3" xref="alg1.29.29.m1.1.2.2.3.cmml">
          <mi id="alg1.29.29.m1.1.2.2.3.2" xref="alg1.29.29.m1.1.2.2.3.2.cmml">
           i
          </mi>
          <mo id="alg1.29.29.m1.1.2.2.3.1" xref="alg1.29.29.m1.1.2.2.3.1.cmml">
           +
          </mo>
          <mn id="alg1.29.29.m1.1.2.2.3.3" xref="alg1.29.29.m1.1.2.2.3.3.cmml">
           1
          </mn>
         </mrow>
         <mrow id="alg1.29.29.m1.1.1.1.3" xref="alg1.29.29.m1.1.2.cmml">
          <mo id="alg1.29.29.m1.1.1.1.3.1" stretchy="false" xref="alg1.29.29.m1.1.2.cmml">
           (
          </mo>
          <mi id="alg1.29.29.m1.1.1.1.1" xref="alg1.29.29.m1.1.1.1.1.cmml">
           S
          </mi>
          <mo id="alg1.29.29.m1.1.1.1.3.2" stretchy="false" xref="alg1.29.29.m1.1.2.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="alg1.29.29.m1.1b">
         <apply id="alg1.29.29.m1.1.2.cmml" xref="alg1.29.29.m1.1.2">
          <csymbol cd="ambiguous" id="alg1.29.29.m1.1.2.1.cmml" xref="alg1.29.29.m1.1.2">
           superscript
          </csymbol>
          <apply id="alg1.29.29.m1.1.2.2.cmml" xref="alg1.29.29.m1.1.2">
           <csymbol cd="ambiguous" id="alg1.29.29.m1.1.2.2.1.cmml" xref="alg1.29.29.m1.1.2">
            subscript
           </csymbol>
           <ci id="alg1.29.29.m1.1.2.2.2.cmml" xref="alg1.29.29.m1.1.2.2.2">
            𝑠
           </ci>
           <apply id="alg1.29.29.m1.1.2.2.3.cmml" xref="alg1.29.29.m1.1.2.2.3">
            <plus id="alg1.29.29.m1.1.2.2.3.1.cmml" xref="alg1.29.29.m1.1.2.2.3.1">
            </plus>
            <ci id="alg1.29.29.m1.1.2.2.3.2.cmml" xref="alg1.29.29.m1.1.2.2.3.2">
             𝑖
            </ci>
            <cn id="alg1.29.29.m1.1.2.2.3.3.cmml" type="integer" xref="alg1.29.29.m1.1.2.2.3.3">
             1
            </cn>
           </apply>
          </apply>
          <ci id="alg1.29.29.m1.1.1.1.1.cmml" xref="alg1.29.29.m1.1.1.1.1">
           𝑆
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.29.29.m1.1c">
         s_{i+1}^{(S)}
        </annotation>
       </semantics>
      </math>
      by updating
      <math alttext="(\tilde{x},\tilde{y})" class="ltx_Math" display="inline" id="alg1.30.30.m2.2">
       <semantics id="alg1.30.30.m2.2a">
        <mrow id="alg1.30.30.m2.2.3.2" xref="alg1.30.30.m2.2.3.1.cmml">
         <mo id="alg1.30.30.m2.2.3.2.1" stretchy="false" xref="alg1.30.30.m2.2.3.1.cmml">
          (
         </mo>
         <mover accent="true" id="alg1.30.30.m2.1.1" xref="alg1.30.30.m2.1.1.cmml">
          <mi id="alg1.30.30.m2.1.1.2" xref="alg1.30.30.m2.1.1.2.cmml">
           x
          </mi>
          <mo id="alg1.30.30.m2.1.1.1" xref="alg1.30.30.m2.1.1.1.cmml">
           ~
          </mo>
         </mover>
         <mo id="alg1.30.30.m2.2.3.2.2" xref="alg1.30.30.m2.2.3.1.cmml">
          ,
         </mo>
         <mover accent="true" id="alg1.30.30.m2.2.2" xref="alg1.30.30.m2.2.2.cmml">
          <mi id="alg1.30.30.m2.2.2.2" xref="alg1.30.30.m2.2.2.2.cmml">
           y
          </mi>
          <mo id="alg1.30.30.m2.2.2.1" xref="alg1.30.30.m2.2.2.1.cmml">
           ~
          </mo>
         </mover>
         <mo id="alg1.30.30.m2.2.3.2.3" stretchy="false" xref="alg1.30.30.m2.2.3.1.cmml">
          )
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.30.30.m2.2b">
         <interval closure="open" id="alg1.30.30.m2.2.3.1.cmml" xref="alg1.30.30.m2.2.3.2">
          <apply id="alg1.30.30.m2.1.1.cmml" xref="alg1.30.30.m2.1.1">
           <ci id="alg1.30.30.m2.1.1.1.cmml" xref="alg1.30.30.m2.1.1.1">
            ~
           </ci>
           <ci id="alg1.30.30.m2.1.1.2.cmml" xref="alg1.30.30.m2.1.1.2">
            𝑥
           </ci>
          </apply>
          <apply id="alg1.30.30.m2.2.2.cmml" xref="alg1.30.30.m2.2.2">
           <ci id="alg1.30.30.m2.2.2.1.cmml" xref="alg1.30.30.m2.2.2.1">
            ~
           </ci>
           <ci id="alg1.30.30.m2.2.2.2.cmml" xref="alg1.30.30.m2.2.2.2">
            𝑦
           </ci>
          </apply>
         </interval>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.30.30.m2.2c">
         (\tilde{x},\tilde{y})
        </annotation>
       </semantics>
      </math>
      and
      <math alttext="(x,y)" class="ltx_Math" display="inline" id="alg1.31.31.m3.2">
       <semantics id="alg1.31.31.m3.2a">
        <mrow id="alg1.31.31.m3.2.3.2" xref="alg1.31.31.m3.2.3.1.cmml">
         <mo id="alg1.31.31.m3.2.3.2.1" stretchy="false" xref="alg1.31.31.m3.2.3.1.cmml">
          (
         </mo>
         <mi id="alg1.31.31.m3.1.1" xref="alg1.31.31.m3.1.1.cmml">
          x
         </mi>
         <mo id="alg1.31.31.m3.2.3.2.2" xref="alg1.31.31.m3.2.3.1.cmml">
          ,
         </mo>
         <mi id="alg1.31.31.m3.2.2" xref="alg1.31.31.m3.2.2.cmml">
          y
         </mi>
         <mo id="alg1.31.31.m3.2.3.2.3" stretchy="false" xref="alg1.31.31.m3.2.3.1.cmml">
          )
         </mo>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.31.31.m3.2b">
         <interval closure="open" id="alg1.31.31.m3.2.3.1.cmml" xref="alg1.31.31.m3.2.3.2">
          <ci id="alg1.31.31.m3.1.1.cmml" xref="alg1.31.31.m3.1.1">
           𝑥
          </ci>
          <ci id="alg1.31.31.m3.2.2.cmml" xref="alg1.31.31.m3.2.2">
           𝑦
          </ci>
         </interval>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.31.31.m3.2c">
         (x,y)
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.33.33">
      <span class="ltx_tag ltx_tag_listingline">
       26
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
      optimize
      <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg1.32.32.m1.1">
       <semantics id="alg1.32.32.m1.1a">
        <msub id="alg1.32.32.m1.1.1" xref="alg1.32.32.m1.1.1.cmml">
         <mi id="alg1.32.32.m1.1.1.2" xref="alg1.32.32.m1.1.1.2.cmml">
          π
         </mi>
         <mi id="alg1.32.32.m1.1.1.3" xref="alg1.32.32.m1.1.1.3.cmml">
          θ
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.32.32.m1.1b">
         <apply id="alg1.32.32.m1.1.1.cmml" xref="alg1.32.32.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.32.32.m1.1.1.1.cmml" xref="alg1.32.32.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg1.32.32.m1.1.1.2.cmml" xref="alg1.32.32.m1.1.1.2">
           𝜋
          </ci>
          <ci id="alg1.32.32.m1.1.1.3.cmml" xref="alg1.32.32.m1.1.1.3">
           𝜃
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.32.32.m1.1c">
         \pi_{\theta}
        </annotation>
       </semantics>
      </math>
      and
      <math alttext="\pi_{\phi}" class="ltx_Math" display="inline" id="alg1.33.33.m2.1">
       <semantics id="alg1.33.33.m2.1a">
        <msub id="alg1.33.33.m2.1.1" xref="alg1.33.33.m2.1.1.cmml">
         <mi id="alg1.33.33.m2.1.1.2" xref="alg1.33.33.m2.1.1.2.cmml">
          π
         </mi>
         <mi id="alg1.33.33.m2.1.1.3" xref="alg1.33.33.m2.1.1.3.cmml">
          ϕ
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.33.33.m2.1b">
         <apply id="alg1.33.33.m2.1.1.cmml" xref="alg1.33.33.m2.1.1">
          <csymbol cd="ambiguous" id="alg1.33.33.m2.1.1.1.cmml" xref="alg1.33.33.m2.1.1">
           subscript
          </csymbol>
          <ci id="alg1.33.33.m2.1.1.2.cmml" xref="alg1.33.33.m2.1.1.2">
           𝜋
          </ci>
          <ci id="alg1.33.33.m2.1.1.3.cmml" xref="alg1.33.33.m2.1.1.3">
           italic-ϕ
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.33.33.m2.1c">
         \pi_{\phi}
        </annotation>
       </semantics>
      </math>
      via DQN
     </div>
     <div class="ltx_listingline" id="alg1.35.42">
      <span class="ltx_tag ltx_tag_listingline">
       27
      </span>
      <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;">
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.35.35">
      generate final hypotheses via
      <math alttext="\text{LLM}(\cdot)" class="ltx_Math" display="inline" id="alg1.34.34.m1.1">
       <semantics id="alg1.34.34.m1.1a">
        <mrow id="alg1.34.34.m1.1.2" xref="alg1.34.34.m1.1.2.cmml">
         <mtext id="alg1.34.34.m1.1.2.2" xref="alg1.34.34.m1.1.2.2a.cmml">
          LLM
         </mtext>
         <mo id="alg1.34.34.m1.1.2.1" lspace="0em" rspace="0em" xref="alg1.34.34.m1.1.2.1.cmml">
          ​
         </mo>
         <mrow id="alg1.34.34.m1.1.2.3.2" xref="alg1.34.34.m1.1.2.cmml">
          <mo id="alg1.34.34.m1.1.2.3.2.1" stretchy="false" xref="alg1.34.34.m1.1.2.cmml">
           (
          </mo>
          <mo id="alg1.34.34.m1.1.1" lspace="0em" rspace="0em" xref="alg1.34.34.m1.1.1.cmml">
           ⋅
          </mo>
          <mo id="alg1.34.34.m1.1.2.3.2.2" stretchy="false" xref="alg1.34.34.m1.1.2.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.34.34.m1.1b">
         <apply id="alg1.34.34.m1.1.2.cmml" xref="alg1.34.34.m1.1.2">
          <times id="alg1.34.34.m1.1.2.1.cmml" xref="alg1.34.34.m1.1.2.1">
          </times>
          <ci id="alg1.34.34.m1.1.2.2a.cmml" xref="alg1.34.34.m1.1.2.2">
           <mtext id="alg1.34.34.m1.1.2.2.cmml" xref="alg1.34.34.m1.1.2.2">
            LLM
           </mtext>
          </ci>
          <ci id="alg1.34.34.m1.1.1.cmml" xref="alg1.34.34.m1.1.1">
           ⋅
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.34.34.m1.1c">
         \text{LLM}(\cdot)
        </annotation>
       </semantics>
      </math>
      on
      <math alttext="\mathbb{D}" class="ltx_Math" display="inline" id="alg1.35.35.m2.1">
       <semantics id="alg1.35.35.m2.1a">
        <mi id="alg1.35.35.m2.1.1" xref="alg1.35.35.m2.1.1.cmml">
         𝔻
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.35.35.m2.1b">
         <ci id="alg1.35.35.m2.1.1.cmml" xref="alg1.35.35.m2.1.1">
          𝔻
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.35.35.m2.1c">
         \mathbb{D}
        </annotation>
       </semantics>
      </math>
      (where the trained Ag-S selects a partition)
     </div>
    </div>
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_float">
      <span class="ltx_text ltx_font_bold" id="alg1.38.1.1">
       Algorithm 1
      </span>
     </span>
     The
     <span class="ltx_text ltx_font_typewriter" id="alg1.39.2">
      M-RAG
     </span>
     Framework
    </figcaption>
   </figure>
   <div class="ltx_para" id="S3.SS3.p5">
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx5">
     <tbody id="S3.E5">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle r^{(R)}=\Delta(h^{\prime},y)-\Delta(h,y)," class="ltx_Math" display="inline" id="S3.E5.m1.5">
         <semantics id="S3.E5.m1.5a">
          <mrow id="S3.E5.m1.5.5.1" xref="S3.E5.m1.5.5.1.1.cmml">
           <mrow id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml">
            <msup id="S3.E5.m1.5.5.1.1.3" xref="S3.E5.m1.5.5.1.1.3.cmml">
             <mi id="S3.E5.m1.5.5.1.1.3.2" xref="S3.E5.m1.5.5.1.1.3.2.cmml">
              r
             </mi>
             <mrow id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.3.cmml">
              <mo id="S3.E5.m1.1.1.1.3.1" stretchy="false" xref="S3.E5.m1.5.5.1.1.3.cmml">
               (
              </mo>
              <mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">
               R
              </mi>
              <mo id="S3.E5.m1.1.1.1.3.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.3.cmml">
               )
              </mo>
             </mrow>
            </msup>
            <mo id="S3.E5.m1.5.5.1.1.2" xref="S3.E5.m1.5.5.1.1.2.cmml">
             =
            </mo>
            <mrow id="S3.E5.m1.5.5.1.1.1" xref="S3.E5.m1.5.5.1.1.1.cmml">
             <mrow id="S3.E5.m1.5.5.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.cmml">
              <mi id="S3.E5.m1.5.5.1.1.1.1.3" mathvariant="normal" xref="S3.E5.m1.5.5.1.1.1.1.3.cmml">
               Δ
              </mi>
              <mo id="S3.E5.m1.5.5.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E5.m1.5.5.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="S3.E5.m1.5.5.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.2.cmml">
               <mo id="S3.E5.m1.5.5.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.1.2.cmml">
                (
               </mo>
               <msup id="S3.E5.m1.5.5.1.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.cmml">
                <mi id="S3.E5.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.2.cmml">
                 h
                </mi>
                <mo id="S3.E5.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.3.cmml">
                 ′
                </mo>
               </msup>
               <mo id="S3.E5.m1.5.5.1.1.1.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.1.1.2.cmml">
                ,
               </mo>
               <mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">
                y
               </mi>
               <mo id="S3.E5.m1.5.5.1.1.1.1.1.1.4" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.1.2.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <mo id="S3.E5.m1.5.5.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.2.cmml">
              −
             </mo>
             <mrow id="S3.E5.m1.5.5.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.3.cmml">
              <mi id="S3.E5.m1.5.5.1.1.1.3.2" mathvariant="normal" xref="S3.E5.m1.5.5.1.1.1.3.2.cmml">
               Δ
              </mi>
              <mo id="S3.E5.m1.5.5.1.1.1.3.1" lspace="0em" rspace="0em" xref="S3.E5.m1.5.5.1.1.1.3.1.cmml">
               ​
              </mo>
              <mrow id="S3.E5.m1.5.5.1.1.1.3.3.2" xref="S3.E5.m1.5.5.1.1.1.3.3.1.cmml">
               <mo id="S3.E5.m1.5.5.1.1.1.3.3.2.1" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.3.3.1.cmml">
                (
               </mo>
               <mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">
                h
               </mi>
               <mo id="S3.E5.m1.5.5.1.1.1.3.3.2.2" xref="S3.E5.m1.5.5.1.1.1.3.3.1.cmml">
                ,
               </mo>
               <mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">
                y
               </mi>
               <mo id="S3.E5.m1.5.5.1.1.1.3.3.2.3" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.3.3.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S3.E5.m1.5.5.1.2" xref="S3.E5.m1.5.5.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b">
           <apply id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1">
            <eq id="S3.E5.m1.5.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.2">
            </eq>
            <apply id="S3.E5.m1.5.5.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.3">
             <csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.3.1.cmml" xref="S3.E5.m1.5.5.1.1.3">
              superscript
             </csymbol>
             <ci id="S3.E5.m1.5.5.1.1.3.2.cmml" xref="S3.E5.m1.5.5.1.1.3.2">
              𝑟
             </ci>
             <ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">
              𝑅
             </ci>
            </apply>
            <apply id="S3.E5.m1.5.5.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1">
             <minus id="S3.E5.m1.5.5.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.2">
             </minus>
             <apply id="S3.E5.m1.5.5.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1">
              <times id="S3.E5.m1.5.5.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.2">
              </times>
              <ci id="S3.E5.m1.5.5.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.3">
               Δ
              </ci>
              <interval closure="open" id="S3.E5.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1">
               <apply id="S3.E5.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1">
                 superscript
                </csymbol>
                <ci id="S3.E5.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.2">
                 ℎ
                </ci>
                <ci id="S3.E5.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.1.3">
                 ′
                </ci>
               </apply>
               <ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">
                𝑦
               </ci>
              </interval>
             </apply>
             <apply id="S3.E5.m1.5.5.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.3">
              <times id="S3.E5.m1.5.5.1.1.1.3.1.cmml" xref="S3.E5.m1.5.5.1.1.1.3.1">
              </times>
              <ci id="S3.E5.m1.5.5.1.1.1.3.2.cmml" xref="S3.E5.m1.5.5.1.1.1.3.2">
               Δ
              </ci>
              <interval closure="open" id="S3.E5.m1.5.5.1.1.1.3.3.1.cmml" xref="S3.E5.m1.5.5.1.1.1.3.3.2">
               <ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">
                ℎ
               </ci>
               <ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">
                𝑦
               </ci>
              </interval>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E5.m1.5c">
           \displaystyle r^{(R)}=\Delta(h^{\prime},y)-\Delta(h,y),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (5)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS3.p5.4">
     where
     <math alttext="y" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.1">
      <semantics id="S3.SS3.p5.1.m1.1a">
       <mi id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">
        y
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b">
        <ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">
         𝑦
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">
        y
       </annotation>
      </semantics>
     </math>
     denotes the reference result. In this reward definition, we observe that the objective of the Markov Decision Process (MDP), which aims to maximize cumulative rewards, aligns with Agent-R’s goal of discovering the best hypothesis among the memories. To illustrate, we consider the process through a sequence of states:
     <math alttext="s^{(R)}_{1},s^{(R)}_{2},...,s^{(R)}_{N}" class="ltx_Math" display="inline" id="S3.SS3.p5.2.m2.7">
      <semantics id="S3.SS3.p5.2.m2.7a">
       <mrow id="S3.SS3.p5.2.m2.7.7.3" xref="S3.SS3.p5.2.m2.7.7.4.cmml">
        <msubsup id="S3.SS3.p5.2.m2.5.5.1.1" xref="S3.SS3.p5.2.m2.5.5.1.1.cmml">
         <mi id="S3.SS3.p5.2.m2.5.5.1.1.2.2" xref="S3.SS3.p5.2.m2.5.5.1.1.2.2.cmml">
          s
         </mi>
         <mn id="S3.SS3.p5.2.m2.5.5.1.1.3" xref="S3.SS3.p5.2.m2.5.5.1.1.3.cmml">
          1
         </mn>
         <mrow id="S3.SS3.p5.2.m2.1.1.1.3" xref="S3.SS3.p5.2.m2.5.5.1.1.cmml">
          <mo id="S3.SS3.p5.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.p5.2.m2.5.5.1.1.cmml">
           (
          </mo>
          <mi id="S3.SS3.p5.2.m2.1.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.1.cmml">
           R
          </mi>
          <mo id="S3.SS3.p5.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.p5.2.m2.5.5.1.1.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS3.p5.2.m2.7.7.3.4" xref="S3.SS3.p5.2.m2.7.7.4.cmml">
         ,
        </mo>
        <msubsup id="S3.SS3.p5.2.m2.6.6.2.2" xref="S3.SS3.p5.2.m2.6.6.2.2.cmml">
         <mi id="S3.SS3.p5.2.m2.6.6.2.2.2.2" xref="S3.SS3.p5.2.m2.6.6.2.2.2.2.cmml">
          s
         </mi>
         <mn id="S3.SS3.p5.2.m2.6.6.2.2.3" xref="S3.SS3.p5.2.m2.6.6.2.2.3.cmml">
          2
         </mn>
         <mrow id="S3.SS3.p5.2.m2.2.2.1.3" xref="S3.SS3.p5.2.m2.6.6.2.2.cmml">
          <mo id="S3.SS3.p5.2.m2.2.2.1.3.1" stretchy="false" xref="S3.SS3.p5.2.m2.6.6.2.2.cmml">
           (
          </mo>
          <mi id="S3.SS3.p5.2.m2.2.2.1.1" xref="S3.SS3.p5.2.m2.2.2.1.1.cmml">
           R
          </mi>
          <mo id="S3.SS3.p5.2.m2.2.2.1.3.2" stretchy="false" xref="S3.SS3.p5.2.m2.6.6.2.2.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS3.p5.2.m2.7.7.3.5" xref="S3.SS3.p5.2.m2.7.7.4.cmml">
         ,
        </mo>
        <mi id="S3.SS3.p5.2.m2.4.4" mathvariant="normal" xref="S3.SS3.p5.2.m2.4.4.cmml">
         …
        </mi>
        <mo id="S3.SS3.p5.2.m2.7.7.3.6" xref="S3.SS3.p5.2.m2.7.7.4.cmml">
         ,
        </mo>
        <msubsup id="S3.SS3.p5.2.m2.7.7.3.3" xref="S3.SS3.p5.2.m2.7.7.3.3.cmml">
         <mi id="S3.SS3.p5.2.m2.7.7.3.3.2.2" xref="S3.SS3.p5.2.m2.7.7.3.3.2.2.cmml">
          s
         </mi>
         <mi id="S3.SS3.p5.2.m2.7.7.3.3.3" xref="S3.SS3.p5.2.m2.7.7.3.3.3.cmml">
          N
         </mi>
         <mrow id="S3.SS3.p5.2.m2.3.3.1.3" xref="S3.SS3.p5.2.m2.7.7.3.3.cmml">
          <mo id="S3.SS3.p5.2.m2.3.3.1.3.1" stretchy="false" xref="S3.SS3.p5.2.m2.7.7.3.3.cmml">
           (
          </mo>
          <mi id="S3.SS3.p5.2.m2.3.3.1.1" xref="S3.SS3.p5.2.m2.3.3.1.1.cmml">
           R
          </mi>
          <mo id="S3.SS3.p5.2.m2.3.3.1.3.2" stretchy="false" xref="S3.SS3.p5.2.m2.7.7.3.3.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.7b">
        <list id="S3.SS3.p5.2.m2.7.7.4.cmml" xref="S3.SS3.p5.2.m2.7.7.3">
         <apply id="S3.SS3.p5.2.m2.5.5.1.1.cmml" xref="S3.SS3.p5.2.m2.5.5.1.1">
          <csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.5.5.1.1.1.cmml" xref="S3.SS3.p5.2.m2.5.5.1.1">
           subscript
          </csymbol>
          <apply id="S3.SS3.p5.2.m2.5.5.1.1.2.cmml" xref="S3.SS3.p5.2.m2.5.5.1.1">
           <csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.5.5.1.1.2.1.cmml" xref="S3.SS3.p5.2.m2.5.5.1.1">
            superscript
           </csymbol>
           <ci id="S3.SS3.p5.2.m2.5.5.1.1.2.2.cmml" xref="S3.SS3.p5.2.m2.5.5.1.1.2.2">
            𝑠
           </ci>
           <ci id="S3.SS3.p5.2.m2.1.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1">
            𝑅
           </ci>
          </apply>
          <cn id="S3.SS3.p5.2.m2.5.5.1.1.3.cmml" type="integer" xref="S3.SS3.p5.2.m2.5.5.1.1.3">
           1
          </cn>
         </apply>
         <apply id="S3.SS3.p5.2.m2.6.6.2.2.cmml" xref="S3.SS3.p5.2.m2.6.6.2.2">
          <csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.6.6.2.2.1.cmml" xref="S3.SS3.p5.2.m2.6.6.2.2">
           subscript
          </csymbol>
          <apply id="S3.SS3.p5.2.m2.6.6.2.2.2.cmml" xref="S3.SS3.p5.2.m2.6.6.2.2">
           <csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.6.6.2.2.2.1.cmml" xref="S3.SS3.p5.2.m2.6.6.2.2">
            superscript
           </csymbol>
           <ci id="S3.SS3.p5.2.m2.6.6.2.2.2.2.cmml" xref="S3.SS3.p5.2.m2.6.6.2.2.2.2">
            𝑠
           </ci>
           <ci id="S3.SS3.p5.2.m2.2.2.1.1.cmml" xref="S3.SS3.p5.2.m2.2.2.1.1">
            𝑅
           </ci>
          </apply>
          <cn id="S3.SS3.p5.2.m2.6.6.2.2.3.cmml" type="integer" xref="S3.SS3.p5.2.m2.6.6.2.2.3">
           2
          </cn>
         </apply>
         <ci id="S3.SS3.p5.2.m2.4.4.cmml" xref="S3.SS3.p5.2.m2.4.4">
          …
         </ci>
         <apply id="S3.SS3.p5.2.m2.7.7.3.3.cmml" xref="S3.SS3.p5.2.m2.7.7.3.3">
          <csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.7.7.3.3.1.cmml" xref="S3.SS3.p5.2.m2.7.7.3.3">
           subscript
          </csymbol>
          <apply id="S3.SS3.p5.2.m2.7.7.3.3.2.cmml" xref="S3.SS3.p5.2.m2.7.7.3.3">
           <csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.7.7.3.3.2.1.cmml" xref="S3.SS3.p5.2.m2.7.7.3.3">
            superscript
           </csymbol>
           <ci id="S3.SS3.p5.2.m2.7.7.3.3.2.2.cmml" xref="S3.SS3.p5.2.m2.7.7.3.3.2.2">
            𝑠
           </ci>
           <ci id="S3.SS3.p5.2.m2.3.3.1.1.cmml" xref="S3.SS3.p5.2.m2.3.3.1.1">
            𝑅
           </ci>
          </apply>
          <ci id="S3.SS3.p5.2.m2.7.7.3.3.3.cmml" xref="S3.SS3.p5.2.m2.7.7.3.3.3">
           𝑁
          </ci>
         </apply>
        </list>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.7c">
        s^{(R)}_{1},s^{(R)}_{2},...,s^{(R)}_{N}
       </annotation>
      </semantics>
     </math>
     , concluding at
     <math alttext="s^{(R)}_{N}" class="ltx_Math" display="inline" id="S3.SS3.p5.3.m3.1">
      <semantics id="S3.SS3.p5.3.m3.1a">
       <msubsup id="S3.SS3.p5.3.m3.1.2" xref="S3.SS3.p5.3.m3.1.2.cmml">
        <mi id="S3.SS3.p5.3.m3.1.2.2.2" xref="S3.SS3.p5.3.m3.1.2.2.2.cmml">
         s
        </mi>
        <mi id="S3.SS3.p5.3.m3.1.2.3" xref="S3.SS3.p5.3.m3.1.2.3.cmml">
         N
        </mi>
        <mrow id="S3.SS3.p5.3.m3.1.1.1.3" xref="S3.SS3.p5.3.m3.1.2.cmml">
         <mo id="S3.SS3.p5.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS3.p5.3.m3.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS3.p5.3.m3.1.1.1.1" xref="S3.SS3.p5.3.m3.1.1.1.1.cmml">
          R
         </mi>
         <mo id="S3.SS3.p5.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS3.p5.3.m3.1.2.cmml">
          )
         </mo>
        </mrow>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b">
        <apply id="S3.SS3.p5.3.m3.1.2.cmml" xref="S3.SS3.p5.3.m3.1.2">
         <csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.2.1.cmml" xref="S3.SS3.p5.3.m3.1.2">
          subscript
         </csymbol>
         <apply id="S3.SS3.p5.3.m3.1.2.2.cmml" xref="S3.SS3.p5.3.m3.1.2">
          <csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.2.2.1.cmml" xref="S3.SS3.p5.3.m3.1.2">
           superscript
          </csymbol>
          <ci id="S3.SS3.p5.3.m3.1.2.2.2.cmml" xref="S3.SS3.p5.3.m3.1.2.2.2">
           𝑠
          </ci>
          <ci id="S3.SS3.p5.3.m3.1.1.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1.1.1">
           𝑅
          </ci>
         </apply>
         <ci id="S3.SS3.p5.3.m3.1.2.3.cmml" xref="S3.SS3.p5.3.m3.1.2.3">
          𝑁
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">
        s^{(R)}_{N}
       </annotation>
      </semantics>
     </math>
     . The rewards received at these states, except for the termination state, can be denoted as
     <math alttext="r^{(R)}_{1},r^{(R)}_{2},...,r^{(R)}_{N-1}" class="ltx_Math" display="inline" id="S3.SS3.p5.4.m4.7">
      <semantics id="S3.SS3.p5.4.m4.7a">
       <mrow id="S3.SS3.p5.4.m4.7.7.3" xref="S3.SS3.p5.4.m4.7.7.4.cmml">
        <msubsup id="S3.SS3.p5.4.m4.5.5.1.1" xref="S3.SS3.p5.4.m4.5.5.1.1.cmml">
         <mi id="S3.SS3.p5.4.m4.5.5.1.1.2.2" xref="S3.SS3.p5.4.m4.5.5.1.1.2.2.cmml">
          r
         </mi>
         <mn id="S3.SS3.p5.4.m4.5.5.1.1.3" xref="S3.SS3.p5.4.m4.5.5.1.1.3.cmml">
          1
         </mn>
         <mrow id="S3.SS3.p5.4.m4.1.1.1.3" xref="S3.SS3.p5.4.m4.5.5.1.1.cmml">
          <mo id="S3.SS3.p5.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS3.p5.4.m4.5.5.1.1.cmml">
           (
          </mo>
          <mi id="S3.SS3.p5.4.m4.1.1.1.1" xref="S3.SS3.p5.4.m4.1.1.1.1.cmml">
           R
          </mi>
          <mo id="S3.SS3.p5.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS3.p5.4.m4.5.5.1.1.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS3.p5.4.m4.7.7.3.4" xref="S3.SS3.p5.4.m4.7.7.4.cmml">
         ,
        </mo>
        <msubsup id="S3.SS3.p5.4.m4.6.6.2.2" xref="S3.SS3.p5.4.m4.6.6.2.2.cmml">
         <mi id="S3.SS3.p5.4.m4.6.6.2.2.2.2" xref="S3.SS3.p5.4.m4.6.6.2.2.2.2.cmml">
          r
         </mi>
         <mn id="S3.SS3.p5.4.m4.6.6.2.2.3" xref="S3.SS3.p5.4.m4.6.6.2.2.3.cmml">
          2
         </mn>
         <mrow id="S3.SS3.p5.4.m4.2.2.1.3" xref="S3.SS3.p5.4.m4.6.6.2.2.cmml">
          <mo id="S3.SS3.p5.4.m4.2.2.1.3.1" stretchy="false" xref="S3.SS3.p5.4.m4.6.6.2.2.cmml">
           (
          </mo>
          <mi id="S3.SS3.p5.4.m4.2.2.1.1" xref="S3.SS3.p5.4.m4.2.2.1.1.cmml">
           R
          </mi>
          <mo id="S3.SS3.p5.4.m4.2.2.1.3.2" stretchy="false" xref="S3.SS3.p5.4.m4.6.6.2.2.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS3.p5.4.m4.7.7.3.5" xref="S3.SS3.p5.4.m4.7.7.4.cmml">
         ,
        </mo>
        <mi id="S3.SS3.p5.4.m4.4.4" mathvariant="normal" xref="S3.SS3.p5.4.m4.4.4.cmml">
         …
        </mi>
        <mo id="S3.SS3.p5.4.m4.7.7.3.6" xref="S3.SS3.p5.4.m4.7.7.4.cmml">
         ,
        </mo>
        <msubsup id="S3.SS3.p5.4.m4.7.7.3.3" xref="S3.SS3.p5.4.m4.7.7.3.3.cmml">
         <mi id="S3.SS3.p5.4.m4.7.7.3.3.2.2" xref="S3.SS3.p5.4.m4.7.7.3.3.2.2.cmml">
          r
         </mi>
         <mrow id="S3.SS3.p5.4.m4.7.7.3.3.3" xref="S3.SS3.p5.4.m4.7.7.3.3.3.cmml">
          <mi id="S3.SS3.p5.4.m4.7.7.3.3.3.2" xref="S3.SS3.p5.4.m4.7.7.3.3.3.2.cmml">
           N
          </mi>
          <mo id="S3.SS3.p5.4.m4.7.7.3.3.3.1" xref="S3.SS3.p5.4.m4.7.7.3.3.3.1.cmml">
           −
          </mo>
          <mn id="S3.SS3.p5.4.m4.7.7.3.3.3.3" xref="S3.SS3.p5.4.m4.7.7.3.3.3.3.cmml">
           1
          </mn>
         </mrow>
         <mrow id="S3.SS3.p5.4.m4.3.3.1.3" xref="S3.SS3.p5.4.m4.7.7.3.3.cmml">
          <mo id="S3.SS3.p5.4.m4.3.3.1.3.1" stretchy="false" xref="S3.SS3.p5.4.m4.7.7.3.3.cmml">
           (
          </mo>
          <mi id="S3.SS3.p5.4.m4.3.3.1.1" xref="S3.SS3.p5.4.m4.3.3.1.1.cmml">
           R
          </mi>
          <mo id="S3.SS3.p5.4.m4.3.3.1.3.2" stretchy="false" xref="S3.SS3.p5.4.m4.7.7.3.3.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p5.4.m4.7b">
        <list id="S3.SS3.p5.4.m4.7.7.4.cmml" xref="S3.SS3.p5.4.m4.7.7.3">
         <apply id="S3.SS3.p5.4.m4.5.5.1.1.cmml" xref="S3.SS3.p5.4.m4.5.5.1.1">
          <csymbol cd="ambiguous" id="S3.SS3.p5.4.m4.5.5.1.1.1.cmml" xref="S3.SS3.p5.4.m4.5.5.1.1">
           subscript
          </csymbol>
          <apply id="S3.SS3.p5.4.m4.5.5.1.1.2.cmml" xref="S3.SS3.p5.4.m4.5.5.1.1">
           <csymbol cd="ambiguous" id="S3.SS3.p5.4.m4.5.5.1.1.2.1.cmml" xref="S3.SS3.p5.4.m4.5.5.1.1">
            superscript
           </csymbol>
           <ci id="S3.SS3.p5.4.m4.5.5.1.1.2.2.cmml" xref="S3.SS3.p5.4.m4.5.5.1.1.2.2">
            𝑟
           </ci>
           <ci id="S3.SS3.p5.4.m4.1.1.1.1.cmml" xref="S3.SS3.p5.4.m4.1.1.1.1">
            𝑅
           </ci>
          </apply>
          <cn id="S3.SS3.p5.4.m4.5.5.1.1.3.cmml" type="integer" xref="S3.SS3.p5.4.m4.5.5.1.1.3">
           1
          </cn>
         </apply>
         <apply id="S3.SS3.p5.4.m4.6.6.2.2.cmml" xref="S3.SS3.p5.4.m4.6.6.2.2">
          <csymbol cd="ambiguous" id="S3.SS3.p5.4.m4.6.6.2.2.1.cmml" xref="S3.SS3.p5.4.m4.6.6.2.2">
           subscript
          </csymbol>
          <apply id="S3.SS3.p5.4.m4.6.6.2.2.2.cmml" xref="S3.SS3.p5.4.m4.6.6.2.2">
           <csymbol cd="ambiguous" id="S3.SS3.p5.4.m4.6.6.2.2.2.1.cmml" xref="S3.SS3.p5.4.m4.6.6.2.2">
            superscript
           </csymbol>
           <ci id="S3.SS3.p5.4.m4.6.6.2.2.2.2.cmml" xref="S3.SS3.p5.4.m4.6.6.2.2.2.2">
            𝑟
           </ci>
           <ci id="S3.SS3.p5.4.m4.2.2.1.1.cmml" xref="S3.SS3.p5.4.m4.2.2.1.1">
            𝑅
           </ci>
          </apply>
          <cn id="S3.SS3.p5.4.m4.6.6.2.2.3.cmml" type="integer" xref="S3.SS3.p5.4.m4.6.6.2.2.3">
           2
          </cn>
         </apply>
         <ci id="S3.SS3.p5.4.m4.4.4.cmml" xref="S3.SS3.p5.4.m4.4.4">
          …
         </ci>
         <apply id="S3.SS3.p5.4.m4.7.7.3.3.cmml" xref="S3.SS3.p5.4.m4.7.7.3.3">
          <csymbol cd="ambiguous" id="S3.SS3.p5.4.m4.7.7.3.3.1.cmml" xref="S3.SS3.p5.4.m4.7.7.3.3">
           subscript
          </csymbol>
          <apply id="S3.SS3.p5.4.m4.7.7.3.3.2.cmml" xref="S3.SS3.p5.4.m4.7.7.3.3">
           <csymbol cd="ambiguous" id="S3.SS3.p5.4.m4.7.7.3.3.2.1.cmml" xref="S3.SS3.p5.4.m4.7.7.3.3">
            superscript
           </csymbol>
           <ci id="S3.SS3.p5.4.m4.7.7.3.3.2.2.cmml" xref="S3.SS3.p5.4.m4.7.7.3.3.2.2">
            𝑟
           </ci>
           <ci id="S3.SS3.p5.4.m4.3.3.1.1.cmml" xref="S3.SS3.p5.4.m4.3.3.1.1">
            𝑅
           </ci>
          </apply>
          <apply id="S3.SS3.p5.4.m4.7.7.3.3.3.cmml" xref="S3.SS3.p5.4.m4.7.7.3.3.3">
           <minus id="S3.SS3.p5.4.m4.7.7.3.3.3.1.cmml" xref="S3.SS3.p5.4.m4.7.7.3.3.3.1">
           </minus>
           <ci id="S3.SS3.p5.4.m4.7.7.3.3.3.2.cmml" xref="S3.SS3.p5.4.m4.7.7.3.3.3.2">
            𝑁
           </ci>
           <cn id="S3.SS3.p5.4.m4.7.7.3.3.3.3.cmml" type="integer" xref="S3.SS3.p5.4.m4.7.7.3.3.3.3">
            1
           </cn>
          </apply>
         </apply>
        </list>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p5.4.m4.7c">
        r^{(R)}_{1},r^{(R)}_{2},...,r^{(R)}_{N-1}
       </annotation>
      </semantics>
     </math>
     . When future rewards are not discounted, we have:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S3.E6">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E6X">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\sum_{t=2}^{N}r^{(R)}_{t-1}" class="ltx_Math" display="inline" id="S3.E6X.2.1.1.m1.1">
         <semantics id="S3.E6X.2.1.1.m1.1a">
          <mrow id="S3.E6X.2.1.1.m1.1.2" xref="S3.E6X.2.1.1.m1.1.2.cmml">
           <mstyle displaystyle="true" id="S3.E6X.2.1.1.m1.1.2.1" xref="S3.E6X.2.1.1.m1.1.2.1.cmml">
            <munderover id="S3.E6X.2.1.1.m1.1.2.1a" xref="S3.E6X.2.1.1.m1.1.2.1.cmml">
             <mo id="S3.E6X.2.1.1.m1.1.2.1.2.2" movablelimits="false" xref="S3.E6X.2.1.1.m1.1.2.1.2.2.cmml">
              ∑
             </mo>
             <mrow id="S3.E6X.2.1.1.m1.1.2.1.2.3" xref="S3.E6X.2.1.1.m1.1.2.1.2.3.cmml">
              <mi id="S3.E6X.2.1.1.m1.1.2.1.2.3.2" xref="S3.E6X.2.1.1.m1.1.2.1.2.3.2.cmml">
               t
              </mi>
              <mo id="S3.E6X.2.1.1.m1.1.2.1.2.3.1" xref="S3.E6X.2.1.1.m1.1.2.1.2.3.1.cmml">
               =
              </mo>
              <mn id="S3.E6X.2.1.1.m1.1.2.1.2.3.3" xref="S3.E6X.2.1.1.m1.1.2.1.2.3.3.cmml">
               2
              </mn>
             </mrow>
             <mi id="S3.E6X.2.1.1.m1.1.2.1.3" xref="S3.E6X.2.1.1.m1.1.2.1.3.cmml">
              N
             </mi>
            </munderover>
           </mstyle>
           <msubsup id="S3.E6X.2.1.1.m1.1.2.2" xref="S3.E6X.2.1.1.m1.1.2.2.cmml">
            <mi id="S3.E6X.2.1.1.m1.1.2.2.2.2" xref="S3.E6X.2.1.1.m1.1.2.2.2.2.cmml">
             r
            </mi>
            <mrow id="S3.E6X.2.1.1.m1.1.2.2.3" xref="S3.E6X.2.1.1.m1.1.2.2.3.cmml">
             <mi id="S3.E6X.2.1.1.m1.1.2.2.3.2" xref="S3.E6X.2.1.1.m1.1.2.2.3.2.cmml">
              t
             </mi>
             <mo id="S3.E6X.2.1.1.m1.1.2.2.3.1" xref="S3.E6X.2.1.1.m1.1.2.2.3.1.cmml">
              −
             </mo>
             <mn id="S3.E6X.2.1.1.m1.1.2.2.3.3" xref="S3.E6X.2.1.1.m1.1.2.2.3.3.cmml">
              1
             </mn>
            </mrow>
            <mrow id="S3.E6X.2.1.1.m1.1.1.1.3" xref="S3.E6X.2.1.1.m1.1.2.2.cmml">
             <mo id="S3.E6X.2.1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.E6X.2.1.1.m1.1.2.2.cmml">
              (
             </mo>
             <mi id="S3.E6X.2.1.1.m1.1.1.1.1" xref="S3.E6X.2.1.1.m1.1.1.1.1.cmml">
              R
             </mi>
             <mo id="S3.E6X.2.1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.E6X.2.1.1.m1.1.2.2.cmml">
              )
             </mo>
            </mrow>
           </msubsup>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E6X.2.1.1.m1.1b">
           <apply id="S3.E6X.2.1.1.m1.1.2.cmml" xref="S3.E6X.2.1.1.m1.1.2">
            <apply id="S3.E6X.2.1.1.m1.1.2.1.cmml" xref="S3.E6X.2.1.1.m1.1.2.1">
             <csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.1.2.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.2.1">
              superscript
             </csymbol>
             <apply id="S3.E6X.2.1.1.m1.1.2.1.2.cmml" xref="S3.E6X.2.1.1.m1.1.2.1">
              <csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.1.2.1.2.1.cmml" xref="S3.E6X.2.1.1.m1.1.2.1">
               subscript
              </csymbol>
              <sum id="S3.E6X.2.1.1.m1.1.2.1.2.2.cmml" xref="S3.E6X.2.1.1.m1.1.2.1.2.2">
              </sum>
              <apply id="S3.E6X.2.1.1.m1.1.2.1.2.3.cmml" xref="S3.E6X.2.1.1.m1.1.2.1.2.3">
               <eq id="S3.E6X.2.1.1.m1.1.2.1.2.3.1.cmml" xref="S3.E6X.2.1.1.m1.1.2.1.2.3.1">
               </eq>
               <ci id="S3.E6X.2.1.1.m1.1.2.1.2.3.2.cmml" xref="S3.E6X.2.1.1.m1.1.2.1.2.3.2">
                𝑡
               </ci>
               <cn id="S3.E6X.2.1.1.m1.1.2.1.2.3.3.cmml" type="integer" xref="S3.E6X.2.1.1.m1.1.2.1.2.3.3">
                2
               </cn>
              </apply>
             </apply>
             <ci id="S3.E6X.2.1.1.m1.1.2.1.3.cmml" xref="S3.E6X.2.1.1.m1.1.2.1.3">
              𝑁
             </ci>
            </apply>
            <apply id="S3.E6X.2.1.1.m1.1.2.2.cmml" xref="S3.E6X.2.1.1.m1.1.2.2">
             <csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.1.2.2.1.cmml" xref="S3.E6X.2.1.1.m1.1.2.2">
              subscript
             </csymbol>
             <apply id="S3.E6X.2.1.1.m1.1.2.2.2.cmml" xref="S3.E6X.2.1.1.m1.1.2.2">
              <csymbol cd="ambiguous" id="S3.E6X.2.1.1.m1.1.2.2.2.1.cmml" xref="S3.E6X.2.1.1.m1.1.2.2">
               superscript
              </csymbol>
              <ci id="S3.E6X.2.1.1.m1.1.2.2.2.2.cmml" xref="S3.E6X.2.1.1.m1.1.2.2.2.2">
               𝑟
              </ci>
              <ci id="S3.E6X.2.1.1.m1.1.1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1.1.1">
               𝑅
              </ci>
             </apply>
             <apply id="S3.E6X.2.1.1.m1.1.2.2.3.cmml" xref="S3.E6X.2.1.1.m1.1.2.2.3">
              <minus id="S3.E6X.2.1.1.m1.1.2.2.3.1.cmml" xref="S3.E6X.2.1.1.m1.1.2.2.3.1">
              </minus>
              <ci id="S3.E6X.2.1.1.m1.1.2.2.3.2.cmml" xref="S3.E6X.2.1.1.m1.1.2.2.3.2">
               𝑡
              </ci>
              <cn id="S3.E6X.2.1.1.m1.1.2.2.3.3.cmml" type="integer" xref="S3.E6X.2.1.1.m1.1.2.2.3.3">
               1
              </cn>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E6X.2.1.1.m1.1c">
           \displaystyle\sum_{t=2}^{N}r^{(R)}_{t-1}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle=\sum_{t=2}^{N}(\Delta(h_{t},y)-\Delta(h_{t-1},y))" class="ltx_Math" display="inline" id="S3.E6X.3.2.2.m1.3">
         <semantics id="S3.E6X.3.2.2.m1.3a">
          <mrow id="S3.E6X.3.2.2.m1.3.3" xref="S3.E6X.3.2.2.m1.3.3.cmml">
           <mi id="S3.E6X.3.2.2.m1.3.3.3" xref="S3.E6X.3.2.2.m1.3.3.3.cmml">
           </mi>
           <mo id="S3.E6X.3.2.2.m1.3.3.2" xref="S3.E6X.3.2.2.m1.3.3.2.cmml">
            =
           </mo>
           <mrow id="S3.E6X.3.2.2.m1.3.3.1" xref="S3.E6X.3.2.2.m1.3.3.1.cmml">
            <mstyle displaystyle="true" id="S3.E6X.3.2.2.m1.3.3.1.2" xref="S3.E6X.3.2.2.m1.3.3.1.2.cmml">
             <munderover id="S3.E6X.3.2.2.m1.3.3.1.2a" xref="S3.E6X.3.2.2.m1.3.3.1.2.cmml">
              <mo id="S3.E6X.3.2.2.m1.3.3.1.2.2.2" movablelimits="false" xref="S3.E6X.3.2.2.m1.3.3.1.2.2.2.cmml">
               ∑
              </mo>
              <mrow id="S3.E6X.3.2.2.m1.3.3.1.2.2.3" xref="S3.E6X.3.2.2.m1.3.3.1.2.2.3.cmml">
               <mi id="S3.E6X.3.2.2.m1.3.3.1.2.2.3.2" xref="S3.E6X.3.2.2.m1.3.3.1.2.2.3.2.cmml">
                t
               </mi>
               <mo id="S3.E6X.3.2.2.m1.3.3.1.2.2.3.1" xref="S3.E6X.3.2.2.m1.3.3.1.2.2.3.1.cmml">
                =
               </mo>
               <mn id="S3.E6X.3.2.2.m1.3.3.1.2.2.3.3" xref="S3.E6X.3.2.2.m1.3.3.1.2.2.3.3.cmml">
                2
               </mn>
              </mrow>
              <mi id="S3.E6X.3.2.2.m1.3.3.1.2.3" xref="S3.E6X.3.2.2.m1.3.3.1.2.3.cmml">
               N
              </mi>
             </munderover>
            </mstyle>
            <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.cmml">
             <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.cmml">
              (
             </mo>
             <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.cmml">
              <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.cmml">
               <mi id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.3" mathvariant="normal" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml">
                Δ
               </mi>
               <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">
                <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">
                 (
                </mo>
                <msub id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml">
                 <mi id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">
                  h
                 </mi>
                 <mi id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">
                  t
                 </mi>
                </msub>
                <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">
                 ,
                </mo>
                <mi id="S3.E6X.3.2.2.m1.1.1" xref="S3.E6X.3.2.2.m1.1.1.cmml">
                 y
                </mi>
                <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.3.cmml">
               −
              </mo>
              <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.cmml">
               <mi id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.3" mathvariant="normal" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.3.cmml">
                Δ
               </mi>
               <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.2" lspace="0em" rspace="0em" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.2.cmml">
                ​
               </mo>
               <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.2.cmml">
                <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.2.cmml">
                 (
                </mo>
                <msub id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.cmml">
                 <mi id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2.cmml">
                  h
                 </mi>
                 <mrow id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.cmml">
                  <mi id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.2" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.2.cmml">
                   t
                  </mi>
                  <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.1" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.1.cmml">
                   −
                  </mo>
                  <mn id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.3.cmml">
                   1
                  </mn>
                 </mrow>
                </msub>
                <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.3" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.2.cmml">
                 ,
                </mo>
                <mi id="S3.E6X.3.2.2.m1.2.2" xref="S3.E6X.3.2.2.m1.2.2.cmml">
                 y
                </mi>
                <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.4" stretchy="false" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.2.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
             </mrow>
             <mo id="S3.E6X.3.2.2.m1.3.3.1.1.1.3" stretchy="false" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E6X.3.2.2.m1.3b">
           <apply id="S3.E6X.3.2.2.m1.3.3.cmml" xref="S3.E6X.3.2.2.m1.3.3">
            <eq id="S3.E6X.3.2.2.m1.3.3.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.2">
            </eq>
            <csymbol cd="latexml" id="S3.E6X.3.2.2.m1.3.3.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.3">
             absent
            </csymbol>
            <apply id="S3.E6X.3.2.2.m1.3.3.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1">
             <apply id="S3.E6X.3.2.2.m1.3.3.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.2">
              <csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.3.3.1.2.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.2">
               superscript
              </csymbol>
              <apply id="S3.E6X.3.2.2.m1.3.3.1.2.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.2">
               <csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.3.3.1.2.2.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.2">
                subscript
               </csymbol>
               <sum id="S3.E6X.3.2.2.m1.3.3.1.2.2.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.2.2.2">
               </sum>
               <apply id="S3.E6X.3.2.2.m1.3.3.1.2.2.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.2.2.3">
                <eq id="S3.E6X.3.2.2.m1.3.3.1.2.2.3.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.2.2.3.1">
                </eq>
                <ci id="S3.E6X.3.2.2.m1.3.3.1.2.2.3.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.2.2.3.2">
                 𝑡
                </ci>
                <cn id="S3.E6X.3.2.2.m1.3.3.1.2.2.3.3.cmml" type="integer" xref="S3.E6X.3.2.2.m1.3.3.1.2.2.3.3">
                 2
                </cn>
               </apply>
              </apply>
              <ci id="S3.E6X.3.2.2.m1.3.3.1.2.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.2.3">
               𝑁
              </ci>
             </apply>
             <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1">
              <minus id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.3">
              </minus>
              <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1">
               <times id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.2">
               </times>
               <ci id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.3">
                Δ
               </ci>
               <interval closure="open" id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1">
                <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2">
                  ℎ
                 </ci>
                 <ci id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3">
                  𝑡
                 </ci>
                </apply>
                <ci id="S3.E6X.3.2.2.m1.1.1.cmml" xref="S3.E6X.3.2.2.m1.1.1">
                 𝑦
                </ci>
               </interval>
              </apply>
              <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2">
               <times id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.2">
               </times>
               <ci id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.3">
                Δ
               </ci>
               <interval closure="open" id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1">
                <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1">
                 <csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2">
                  ℎ
                 </ci>
                 <apply id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3">
                  <minus id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.1">
                  </minus>
                  <ci id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.2">
                   𝑡
                  </ci>
                  <cn id="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.3.cmml" type="integer" xref="S3.E6X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.3">
                   1
                  </cn>
                 </apply>
                </apply>
                <ci id="S3.E6X.3.2.2.m1.2.2.cmml" xref="S3.E6X.3.2.2.m1.2.2">
                 𝑦
                </ci>
               </interval>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E6X.3.2.2.m1.3c">
           \displaystyle=\sum_{t=2}^{N}(\Delta(h_{t},y)-\Delta(h_{t-1},y))
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_right">
         (6)
        </span>
       </td>
      </tr>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E6Xa">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle=\Delta(h_{N},y)-\Delta(h_{1},y)," class="ltx_Math" display="inline" id="S3.E6Xa.2.1.1.m1.3">
         <semantics id="S3.E6Xa.2.1.1.m1.3a">
          <mrow id="S3.E6Xa.2.1.1.m1.3.3.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.cmml">
           <mrow id="S3.E6Xa.2.1.1.m1.3.3.1.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.cmml">
            <mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.4" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.4.cmml">
            </mi>
            <mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3.cmml">
             =
            </mo>
            <mrow id="S3.E6Xa.2.1.1.m1.3.3.1.1.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.cmml">
             <mrow id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.cmml">
              <mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.3" mathvariant="normal" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml">
               Δ
              </mi>
              <mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml">
               <mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml">
                (
               </mo>
               <msub id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">
                <mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">
                 h
                </mi>
                <mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml">
                 N
                </mi>
               </msub>
               <mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml">
                ,
               </mo>
               <mi id="S3.E6Xa.2.1.1.m1.1.1" xref="S3.E6Xa.2.1.1.m1.1.1.cmml">
                y
               </mi>
               <mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.4" stretchy="false" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3.cmml">
              −
             </mo>
             <mrow id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.cmml">
              <mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.3" mathvariant="normal" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.3.cmml">
               Δ
              </mi>
              <mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.2" lspace="0em" rspace="0em" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.2.cmml">
               ​
              </mo>
              <mrow id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.2.cmml">
               <mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.2" stretchy="false" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.2.cmml">
                (
               </mo>
               <msub id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.cmml">
                <mi id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2.cmml">
                 h
                </mi>
                <mn id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.3.cmml">
                 1
                </mn>
               </msub>
               <mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.3" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.2.cmml">
                ,
               </mo>
               <mi id="S3.E6Xa.2.1.1.m1.2.2" xref="S3.E6Xa.2.1.1.m1.2.2.cmml">
                y
               </mi>
               <mo id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.4" stretchy="false" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.2.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S3.E6Xa.2.1.1.m1.3.3.1.2" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E6Xa.2.1.1.m1.3b">
           <apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1">
            <eq id="S3.E6Xa.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.3">
            </eq>
            <csymbol cd="latexml" id="S3.E6Xa.2.1.1.m1.3.3.1.1.4.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.4">
             absent
            </csymbol>
            <apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2">
             <minus id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.3">
             </minus>
             <apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1">
              <times id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.2">
              </times>
              <ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.3">
               Δ
              </ci>
              <interval closure="open" id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1">
               <apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1">
                 subscript
                </csymbol>
                <ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2">
                 ℎ
                </ci>
                <ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3">
                 𝑁
                </ci>
               </apply>
               <ci id="S3.E6Xa.2.1.1.m1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.1.1">
                𝑦
               </ci>
              </interval>
             </apply>
             <apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2">
              <times id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.2">
              </times>
              <ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.3.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.3">
               Δ
              </ci>
              <interval closure="open" id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1">
               <apply id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1">
                <csymbol cd="ambiguous" id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1">
                 subscript
                </csymbol>
                <ci id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2.cmml" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2">
                 ℎ
                </ci>
                <cn id="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.3.cmml" type="integer" xref="S3.E6Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.3">
                 1
                </cn>
               </apply>
               <ci id="S3.E6Xa.2.1.1.m1.2.2.cmml" xref="S3.E6Xa.2.1.1.m1.2.2">
                𝑦
               </ci>
              </interval>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E6Xa.2.1.1.m1.3c">
           \displaystyle=\Delta(h_{N},y)-\Delta(h_{1},y),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS3.p5.6">
     where
     <math alttext="\Delta(h_{N},y)" class="ltx_Math" display="inline" id="S3.SS3.p5.5.m1.2">
      <semantics id="S3.SS3.p5.5.m1.2a">
       <mrow id="S3.SS3.p5.5.m1.2.2" xref="S3.SS3.p5.5.m1.2.2.cmml">
        <mi id="S3.SS3.p5.5.m1.2.2.3" mathvariant="normal" xref="S3.SS3.p5.5.m1.2.2.3.cmml">
         Δ
        </mi>
        <mo id="S3.SS3.p5.5.m1.2.2.2" lspace="0em" rspace="0em" xref="S3.SS3.p5.5.m1.2.2.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS3.p5.5.m1.2.2.1.1" xref="S3.SS3.p5.5.m1.2.2.1.2.cmml">
         <mo id="S3.SS3.p5.5.m1.2.2.1.1.2" stretchy="false" xref="S3.SS3.p5.5.m1.2.2.1.2.cmml">
          (
         </mo>
         <msub id="S3.SS3.p5.5.m1.2.2.1.1.1" xref="S3.SS3.p5.5.m1.2.2.1.1.1.cmml">
          <mi id="S3.SS3.p5.5.m1.2.2.1.1.1.2" xref="S3.SS3.p5.5.m1.2.2.1.1.1.2.cmml">
           h
          </mi>
          <mi id="S3.SS3.p5.5.m1.2.2.1.1.1.3" xref="S3.SS3.p5.5.m1.2.2.1.1.1.3.cmml">
           N
          </mi>
         </msub>
         <mo id="S3.SS3.p5.5.m1.2.2.1.1.3" xref="S3.SS3.p5.5.m1.2.2.1.2.cmml">
          ,
         </mo>
         <mi id="S3.SS3.p5.5.m1.1.1" xref="S3.SS3.p5.5.m1.1.1.cmml">
          y
         </mi>
         <mo id="S3.SS3.p5.5.m1.2.2.1.1.4" stretchy="false" xref="S3.SS3.p5.5.m1.2.2.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p5.5.m1.2b">
        <apply id="S3.SS3.p5.5.m1.2.2.cmml" xref="S3.SS3.p5.5.m1.2.2">
         <times id="S3.SS3.p5.5.m1.2.2.2.cmml" xref="S3.SS3.p5.5.m1.2.2.2">
         </times>
         <ci id="S3.SS3.p5.5.m1.2.2.3.cmml" xref="S3.SS3.p5.5.m1.2.2.3">
          Δ
         </ci>
         <interval closure="open" id="S3.SS3.p5.5.m1.2.2.1.2.cmml" xref="S3.SS3.p5.5.m1.2.2.1.1">
          <apply id="S3.SS3.p5.5.m1.2.2.1.1.1.cmml" xref="S3.SS3.p5.5.m1.2.2.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS3.p5.5.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p5.5.m1.2.2.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.SS3.p5.5.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p5.5.m1.2.2.1.1.1.2">
            ℎ
           </ci>
           <ci id="S3.SS3.p5.5.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p5.5.m1.2.2.1.1.1.3">
            𝑁
           </ci>
          </apply>
          <ci id="S3.SS3.p5.5.m1.1.1.cmml" xref="S3.SS3.p5.5.m1.1.1">
           𝑦
          </ci>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p5.5.m1.2c">
        \Delta(h_{N},y)
       </annotation>
      </semantics>
     </math>
     corresponds to the highest hypothesis value found throughout the entire iteration, and
     <math alttext="\Delta(h_{1},y)" class="ltx_Math" display="inline" id="S3.SS3.p5.6.m2.2">
      <semantics id="S3.SS3.p5.6.m2.2a">
       <mrow id="S3.SS3.p5.6.m2.2.2" xref="S3.SS3.p5.6.m2.2.2.cmml">
        <mi id="S3.SS3.p5.6.m2.2.2.3" mathvariant="normal" xref="S3.SS3.p5.6.m2.2.2.3.cmml">
         Δ
        </mi>
        <mo id="S3.SS3.p5.6.m2.2.2.2" lspace="0em" rspace="0em" xref="S3.SS3.p5.6.m2.2.2.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS3.p5.6.m2.2.2.1.1" xref="S3.SS3.p5.6.m2.2.2.1.2.cmml">
         <mo id="S3.SS3.p5.6.m2.2.2.1.1.2" stretchy="false" xref="S3.SS3.p5.6.m2.2.2.1.2.cmml">
          (
         </mo>
         <msub id="S3.SS3.p5.6.m2.2.2.1.1.1" xref="S3.SS3.p5.6.m2.2.2.1.1.1.cmml">
          <mi id="S3.SS3.p5.6.m2.2.2.1.1.1.2" xref="S3.SS3.p5.6.m2.2.2.1.1.1.2.cmml">
           h
          </mi>
          <mn id="S3.SS3.p5.6.m2.2.2.1.1.1.3" xref="S3.SS3.p5.6.m2.2.2.1.1.1.3.cmml">
           1
          </mn>
         </msub>
         <mo id="S3.SS3.p5.6.m2.2.2.1.1.3" xref="S3.SS3.p5.6.m2.2.2.1.2.cmml">
          ,
         </mo>
         <mi id="S3.SS3.p5.6.m2.1.1" xref="S3.SS3.p5.6.m2.1.1.cmml">
          y
         </mi>
         <mo id="S3.SS3.p5.6.m2.2.2.1.1.4" stretchy="false" xref="S3.SS3.p5.6.m2.2.2.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p5.6.m2.2b">
        <apply id="S3.SS3.p5.6.m2.2.2.cmml" xref="S3.SS3.p5.6.m2.2.2">
         <times id="S3.SS3.p5.6.m2.2.2.2.cmml" xref="S3.SS3.p5.6.m2.2.2.2">
         </times>
         <ci id="S3.SS3.p5.6.m2.2.2.3.cmml" xref="S3.SS3.p5.6.m2.2.2.3">
          Δ
         </ci>
         <interval closure="open" id="S3.SS3.p5.6.m2.2.2.1.2.cmml" xref="S3.SS3.p5.6.m2.2.2.1.1">
          <apply id="S3.SS3.p5.6.m2.2.2.1.1.1.cmml" xref="S3.SS3.p5.6.m2.2.2.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS3.p5.6.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p5.6.m2.2.2.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.SS3.p5.6.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p5.6.m2.2.2.1.1.1.2">
            ℎ
           </ci>
           <cn id="S3.SS3.p5.6.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.p5.6.m2.2.2.1.1.1.3">
            1
           </cn>
          </apply>
          <ci id="S3.SS3.p5.6.m2.1.1.cmml" xref="S3.SS3.p5.6.m2.1.1">
           𝑦
          </ci>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p5.6.m2.2c">
        \Delta(h_{1},y)
       </annotation>
      </semantics>
     </math>
     represents an initial value that remains constant. Therefore, maximizing cumulative rewards is equivalent to maximizing the discovered hypothesis value. Finally, the cumulative reward is shared with Agent-S to align with the training objective, that is
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx6">
     <tbody id="S3.E7">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle r^{(S)}=\Delta(h_{N},y)-\Delta(h_{1},y)." class="ltx_Math" display="inline" id="S3.E7.m1.4">
         <semantics id="S3.E7.m1.4a">
          <mrow id="S3.E7.m1.4.4.1" xref="S3.E7.m1.4.4.1.1.cmml">
           <mrow id="S3.E7.m1.4.4.1.1" xref="S3.E7.m1.4.4.1.1.cmml">
            <msup id="S3.E7.m1.4.4.1.1.4" xref="S3.E7.m1.4.4.1.1.4.cmml">
             <mi id="S3.E7.m1.4.4.1.1.4.2" xref="S3.E7.m1.4.4.1.1.4.2.cmml">
              r
             </mi>
             <mrow id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.4.4.1.1.4.cmml">
              <mo id="S3.E7.m1.1.1.1.3.1" stretchy="false" xref="S3.E7.m1.4.4.1.1.4.cmml">
               (
              </mo>
              <mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">
               S
              </mi>
              <mo id="S3.E7.m1.1.1.1.3.2" stretchy="false" xref="S3.E7.m1.4.4.1.1.4.cmml">
               )
              </mo>
             </mrow>
            </msup>
            <mo id="S3.E7.m1.4.4.1.1.3" xref="S3.E7.m1.4.4.1.1.3.cmml">
             =
            </mo>
            <mrow id="S3.E7.m1.4.4.1.1.2" xref="S3.E7.m1.4.4.1.1.2.cmml">
             <mrow id="S3.E7.m1.4.4.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.cmml">
              <mi id="S3.E7.m1.4.4.1.1.1.1.3" mathvariant="normal" xref="S3.E7.m1.4.4.1.1.1.1.3.cmml">
               Δ
              </mi>
              <mo id="S3.E7.m1.4.4.1.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E7.m1.4.4.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="S3.E7.m1.4.4.1.1.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.1.2.cmml">
               <mo id="S3.E7.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.4.4.1.1.1.1.1.2.cmml">
                (
               </mo>
               <msub id="S3.E7.m1.4.4.1.1.1.1.1.1.1" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.cmml">
                <mi id="S3.E7.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml">
                 h
                </mi>
                <mi id="S3.E7.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.3.cmml">
                 N
                </mi>
               </msub>
               <mo id="S3.E7.m1.4.4.1.1.1.1.1.1.3" xref="S3.E7.m1.4.4.1.1.1.1.1.2.cmml">
                ,
               </mo>
               <mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">
                y
               </mi>
               <mo id="S3.E7.m1.4.4.1.1.1.1.1.1.4" stretchy="false" xref="S3.E7.m1.4.4.1.1.1.1.1.2.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <mo id="S3.E7.m1.4.4.1.1.2.3" xref="S3.E7.m1.4.4.1.1.2.3.cmml">
              −
             </mo>
             <mrow id="S3.E7.m1.4.4.1.1.2.2" xref="S3.E7.m1.4.4.1.1.2.2.cmml">
              <mi id="S3.E7.m1.4.4.1.1.2.2.3" mathvariant="normal" xref="S3.E7.m1.4.4.1.1.2.2.3.cmml">
               Δ
              </mi>
              <mo id="S3.E7.m1.4.4.1.1.2.2.2" lspace="0em" rspace="0em" xref="S3.E7.m1.4.4.1.1.2.2.2.cmml">
               ​
              </mo>
              <mrow id="S3.E7.m1.4.4.1.1.2.2.1.1" xref="S3.E7.m1.4.4.1.1.2.2.1.2.cmml">
               <mo id="S3.E7.m1.4.4.1.1.2.2.1.1.2" stretchy="false" xref="S3.E7.m1.4.4.1.1.2.2.1.2.cmml">
                (
               </mo>
               <msub id="S3.E7.m1.4.4.1.1.2.2.1.1.1" xref="S3.E7.m1.4.4.1.1.2.2.1.1.1.cmml">
                <mi id="S3.E7.m1.4.4.1.1.2.2.1.1.1.2" xref="S3.E7.m1.4.4.1.1.2.2.1.1.1.2.cmml">
                 h
                </mi>
                <mn id="S3.E7.m1.4.4.1.1.2.2.1.1.1.3" xref="S3.E7.m1.4.4.1.1.2.2.1.1.1.3.cmml">
                 1
                </mn>
               </msub>
               <mo id="S3.E7.m1.4.4.1.1.2.2.1.1.3" xref="S3.E7.m1.4.4.1.1.2.2.1.2.cmml">
                ,
               </mo>
               <mi id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml">
                y
               </mi>
               <mo id="S3.E7.m1.4.4.1.1.2.2.1.1.4" stretchy="false" xref="S3.E7.m1.4.4.1.1.2.2.1.2.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S3.E7.m1.4.4.1.2" lspace="0em" xref="S3.E7.m1.4.4.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E7.m1.4b">
           <apply id="S3.E7.m1.4.4.1.1.cmml" xref="S3.E7.m1.4.4.1">
            <eq id="S3.E7.m1.4.4.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.3">
            </eq>
            <apply id="S3.E7.m1.4.4.1.1.4.cmml" xref="S3.E7.m1.4.4.1.1.4">
             <csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.4.1.cmml" xref="S3.E7.m1.4.4.1.1.4">
              superscript
             </csymbol>
             <ci id="S3.E7.m1.4.4.1.1.4.2.cmml" xref="S3.E7.m1.4.4.1.1.4.2">
              𝑟
             </ci>
             <ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">
              𝑆
             </ci>
            </apply>
            <apply id="S3.E7.m1.4.4.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.2">
             <minus id="S3.E7.m1.4.4.1.1.2.3.cmml" xref="S3.E7.m1.4.4.1.1.2.3">
             </minus>
             <apply id="S3.E7.m1.4.4.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1">
              <times id="S3.E7.m1.4.4.1.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.2">
              </times>
              <ci id="S3.E7.m1.4.4.1.1.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.3">
               Δ
              </ci>
              <interval closure="open" id="S3.E7.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1">
               <apply id="S3.E7.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1">
                 subscript
                </csymbol>
                <ci id="S3.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.2">
                 ℎ
                </ci>
                <ci id="S3.E7.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.4.4.1.1.1.1.1.1.1.3">
                 𝑁
                </ci>
               </apply>
               <ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">
                𝑦
               </ci>
              </interval>
             </apply>
             <apply id="S3.E7.m1.4.4.1.1.2.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2">
              <times id="S3.E7.m1.4.4.1.1.2.2.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2.2">
              </times>
              <ci id="S3.E7.m1.4.4.1.1.2.2.3.cmml" xref="S3.E7.m1.4.4.1.1.2.2.3">
               Δ
              </ci>
              <interval closure="open" id="S3.E7.m1.4.4.1.1.2.2.1.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2.1.1">
               <apply id="S3.E7.m1.4.4.1.1.2.2.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.2.2.1.1.1">
                <csymbol cd="ambiguous" id="S3.E7.m1.4.4.1.1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.4.4.1.1.2.2.1.1.1">
                 subscript
                </csymbol>
                <ci id="S3.E7.m1.4.4.1.1.2.2.1.1.1.2.cmml" xref="S3.E7.m1.4.4.1.1.2.2.1.1.1.2">
                 ℎ
                </ci>
                <cn id="S3.E7.m1.4.4.1.1.2.2.1.1.1.3.cmml" type="integer" xref="S3.E7.m1.4.4.1.1.2.2.1.1.1.3">
                 1
                </cn>
               </apply>
               <ci id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3">
                𝑦
               </ci>
              </interval>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E7.m1.4c">
           \displaystyle r^{(S)}=\Delta(h_{N},y)-\Delta(h_{1},y).
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (7)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.4
    </span>
    The
    <span class="ltx_text ltx_font_typewriter" id="S3.SS4.1.1">
     M-RAG
    </span>
    Framework
   </h3>
   <div class="ltx_para ltx_noindent" id="S3.SS4.p1">
    <p class="ltx_p" id="S3.SS4.p1.8">
     <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.8.1">
      Policy Learning via DQN.
     </span>
     In a MDP, the primary challenge lies in determining an optimal policy that guides an agent to select actions at states, with the aim of maximizing cumulative rewards. Given that the states within our MDPs are continuous, we employ Deep Q-Networks (DQN) with replay memory
     <cite class="ltx_cite ltx_citemacro_cite">
      Mnih et al. (
      <a class="ltx_ref" href="#bib.bib38" title="">
       2013
      </a>
      )
     </cite>
     to learn the policy, denoted as
     <math alttext="\pi_{\theta}(a^{(S)}|s^{(S)})" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.3">
      <semantics id="S3.SS4.p1.1.m1.3a">
       <mrow id="S3.SS4.p1.1.m1.3.3" xref="S3.SS4.p1.1.m1.3.3.cmml">
        <msub id="S3.SS4.p1.1.m1.3.3.3" xref="S3.SS4.p1.1.m1.3.3.3.cmml">
         <mi id="S3.SS4.p1.1.m1.3.3.3.2" xref="S3.SS4.p1.1.m1.3.3.3.2.cmml">
          π
         </mi>
         <mi id="S3.SS4.p1.1.m1.3.3.3.3" xref="S3.SS4.p1.1.m1.3.3.3.3.cmml">
          θ
         </mi>
        </msub>
        <mo id="S3.SS4.p1.1.m1.3.3.2" lspace="0em" rspace="0em" xref="S3.SS4.p1.1.m1.3.3.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS4.p1.1.m1.3.3.1.1" xref="S3.SS4.p1.1.m1.3.3.1.1.1.cmml">
         <mo id="S3.SS4.p1.1.m1.3.3.1.1.2" stretchy="false" xref="S3.SS4.p1.1.m1.3.3.1.1.1.cmml">
          (
         </mo>
         <mrow id="S3.SS4.p1.1.m1.3.3.1.1.1" xref="S3.SS4.p1.1.m1.3.3.1.1.1.cmml">
          <msup id="S3.SS4.p1.1.m1.3.3.1.1.1.2" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2.cmml">
           <mi id="S3.SS4.p1.1.m1.3.3.1.1.1.2.2" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2.2.cmml">
            a
           </mi>
           <mrow id="S3.SS4.p1.1.m1.1.1.1.3" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2.cmml">
            <mo id="S3.SS4.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2.cmml">
             (
            </mo>
            <mi id="S3.SS4.p1.1.m1.1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.1.cmml">
             S
            </mi>
            <mo id="S3.SS4.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2.cmml">
             )
            </mo>
           </mrow>
          </msup>
          <mo fence="false" id="S3.SS4.p1.1.m1.3.3.1.1.1.1" xref="S3.SS4.p1.1.m1.3.3.1.1.1.1.cmml">
           |
          </mo>
          <msup id="S3.SS4.p1.1.m1.3.3.1.1.1.3" xref="S3.SS4.p1.1.m1.3.3.1.1.1.3.cmml">
           <mi id="S3.SS4.p1.1.m1.3.3.1.1.1.3.2" xref="S3.SS4.p1.1.m1.3.3.1.1.1.3.2.cmml">
            s
           </mi>
           <mrow id="S3.SS4.p1.1.m1.2.2.1.3" xref="S3.SS4.p1.1.m1.3.3.1.1.1.3.cmml">
            <mo id="S3.SS4.p1.1.m1.2.2.1.3.1" stretchy="false" xref="S3.SS4.p1.1.m1.3.3.1.1.1.3.cmml">
             (
            </mo>
            <mi id="S3.SS4.p1.1.m1.2.2.1.1" xref="S3.SS4.p1.1.m1.2.2.1.1.cmml">
             S
            </mi>
            <mo id="S3.SS4.p1.1.m1.2.2.1.3.2" stretchy="false" xref="S3.SS4.p1.1.m1.3.3.1.1.1.3.cmml">
             )
            </mo>
           </mrow>
          </msup>
         </mrow>
         <mo id="S3.SS4.p1.1.m1.3.3.1.1.3" stretchy="false" xref="S3.SS4.p1.1.m1.3.3.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.3b">
        <apply id="S3.SS4.p1.1.m1.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3">
         <times id="S3.SS4.p1.1.m1.3.3.2.cmml" xref="S3.SS4.p1.1.m1.3.3.2">
         </times>
         <apply id="S3.SS4.p1.1.m1.3.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3.3">
          <csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.3.3.3.1.cmml" xref="S3.SS4.p1.1.m1.3.3.3">
           subscript
          </csymbol>
          <ci id="S3.SS4.p1.1.m1.3.3.3.2.cmml" xref="S3.SS4.p1.1.m1.3.3.3.2">
           𝜋
          </ci>
          <ci id="S3.SS4.p1.1.m1.3.3.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3.3.3">
           𝜃
          </ci>
         </apply>
         <apply id="S3.SS4.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1">
          <csymbol cd="latexml" id="S3.SS4.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.1">
           conditional
          </csymbol>
          <apply id="S3.SS4.p1.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2">
           <csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.3.3.1.1.1.2.1.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2">
            superscript
           </csymbol>
           <ci id="S3.SS4.p1.1.m1.3.3.1.1.1.2.2.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.2.2">
            𝑎
           </ci>
           <ci id="S3.SS4.p1.1.m1.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1">
            𝑆
           </ci>
          </apply>
          <apply id="S3.SS4.p1.1.m1.3.3.1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.3">
           <csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.3">
            superscript
           </csymbol>
           <ci id="S3.SS4.p1.1.m1.3.3.1.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.3.3.1.1.1.3.2">
            𝑠
           </ci>
           <ci id="S3.SS4.p1.1.m1.2.2.1.1.cmml" xref="S3.SS4.p1.1.m1.2.2.1.1">
            𝑆
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.3c">
        \pi_{\theta}(a^{(S)}|s^{(S)})
       </annotation>
      </semantics>
     </math>
     for Agent-S (resp.
     <math alttext="\pi_{\phi}(a^{(R)}|s^{(R)})" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.3">
      <semantics id="S3.SS4.p1.2.m2.3a">
       <mrow id="S3.SS4.p1.2.m2.3.3" xref="S3.SS4.p1.2.m2.3.3.cmml">
        <msub id="S3.SS4.p1.2.m2.3.3.3" xref="S3.SS4.p1.2.m2.3.3.3.cmml">
         <mi id="S3.SS4.p1.2.m2.3.3.3.2" xref="S3.SS4.p1.2.m2.3.3.3.2.cmml">
          π
         </mi>
         <mi id="S3.SS4.p1.2.m2.3.3.3.3" xref="S3.SS4.p1.2.m2.3.3.3.3.cmml">
          ϕ
         </mi>
        </msub>
        <mo id="S3.SS4.p1.2.m2.3.3.2" lspace="0em" rspace="0em" xref="S3.SS4.p1.2.m2.3.3.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS4.p1.2.m2.3.3.1.1" xref="S3.SS4.p1.2.m2.3.3.1.1.1.cmml">
         <mo id="S3.SS4.p1.2.m2.3.3.1.1.2" stretchy="false" xref="S3.SS4.p1.2.m2.3.3.1.1.1.cmml">
          (
         </mo>
         <mrow id="S3.SS4.p1.2.m2.3.3.1.1.1" xref="S3.SS4.p1.2.m2.3.3.1.1.1.cmml">
          <msup id="S3.SS4.p1.2.m2.3.3.1.1.1.2" xref="S3.SS4.p1.2.m2.3.3.1.1.1.2.cmml">
           <mi id="S3.SS4.p1.2.m2.3.3.1.1.1.2.2" xref="S3.SS4.p1.2.m2.3.3.1.1.1.2.2.cmml">
            a
           </mi>
           <mrow id="S3.SS4.p1.2.m2.1.1.1.3" xref="S3.SS4.p1.2.m2.3.3.1.1.1.2.cmml">
            <mo id="S3.SS4.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS4.p1.2.m2.3.3.1.1.1.2.cmml">
             (
            </mo>
            <mi id="S3.SS4.p1.2.m2.1.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.1.cmml">
             R
            </mi>
            <mo id="S3.SS4.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS4.p1.2.m2.3.3.1.1.1.2.cmml">
             )
            </mo>
           </mrow>
          </msup>
          <mo fence="false" id="S3.SS4.p1.2.m2.3.3.1.1.1.1" xref="S3.SS4.p1.2.m2.3.3.1.1.1.1.cmml">
           |
          </mo>
          <msup id="S3.SS4.p1.2.m2.3.3.1.1.1.3" xref="S3.SS4.p1.2.m2.3.3.1.1.1.3.cmml">
           <mi id="S3.SS4.p1.2.m2.3.3.1.1.1.3.2" xref="S3.SS4.p1.2.m2.3.3.1.1.1.3.2.cmml">
            s
           </mi>
           <mrow id="S3.SS4.p1.2.m2.2.2.1.3" xref="S3.SS4.p1.2.m2.3.3.1.1.1.3.cmml">
            <mo id="S3.SS4.p1.2.m2.2.2.1.3.1" stretchy="false" xref="S3.SS4.p1.2.m2.3.3.1.1.1.3.cmml">
             (
            </mo>
            <mi id="S3.SS4.p1.2.m2.2.2.1.1" xref="S3.SS4.p1.2.m2.2.2.1.1.cmml">
             R
            </mi>
            <mo id="S3.SS4.p1.2.m2.2.2.1.3.2" stretchy="false" xref="S3.SS4.p1.2.m2.3.3.1.1.1.3.cmml">
             )
            </mo>
           </mrow>
          </msup>
         </mrow>
         <mo id="S3.SS4.p1.2.m2.3.3.1.1.3" stretchy="false" xref="S3.SS4.p1.2.m2.3.3.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.3b">
        <apply id="S3.SS4.p1.2.m2.3.3.cmml" xref="S3.SS4.p1.2.m2.3.3">
         <times id="S3.SS4.p1.2.m2.3.3.2.cmml" xref="S3.SS4.p1.2.m2.3.3.2">
         </times>
         <apply id="S3.SS4.p1.2.m2.3.3.3.cmml" xref="S3.SS4.p1.2.m2.3.3.3">
          <csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.3.3.3.1.cmml" xref="S3.SS4.p1.2.m2.3.3.3">
           subscript
          </csymbol>
          <ci id="S3.SS4.p1.2.m2.3.3.3.2.cmml" xref="S3.SS4.p1.2.m2.3.3.3.2">
           𝜋
          </ci>
          <ci id="S3.SS4.p1.2.m2.3.3.3.3.cmml" xref="S3.SS4.p1.2.m2.3.3.3.3">
           italic-ϕ
          </ci>
         </apply>
         <apply id="S3.SS4.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS4.p1.2.m2.3.3.1.1">
          <csymbol cd="latexml" id="S3.SS4.p1.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.3.3.1.1.1.1">
           conditional
          </csymbol>
          <apply id="S3.SS4.p1.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS4.p1.2.m2.3.3.1.1.1.2">
           <csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.3.3.1.1.1.2.1.cmml" xref="S3.SS4.p1.2.m2.3.3.1.1.1.2">
            superscript
           </csymbol>
           <ci id="S3.SS4.p1.2.m2.3.3.1.1.1.2.2.cmml" xref="S3.SS4.p1.2.m2.3.3.1.1.1.2.2">
            𝑎
           </ci>
           <ci id="S3.SS4.p1.2.m2.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1">
            𝑅
           </ci>
          </apply>
          <apply id="S3.SS4.p1.2.m2.3.3.1.1.1.3.cmml" xref="S3.SS4.p1.2.m2.3.3.1.1.1.3">
           <csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.3.3.1.1.1.3.1.cmml" xref="S3.SS4.p1.2.m2.3.3.1.1.1.3">
            superscript
           </csymbol>
           <ci id="S3.SS4.p1.2.m2.3.3.1.1.1.3.2.cmml" xref="S3.SS4.p1.2.m2.3.3.1.1.1.3.2">
            𝑠
           </ci>
           <ci id="S3.SS4.p1.2.m2.2.2.1.1.cmml" xref="S3.SS4.p1.2.m2.2.2.1.1">
            𝑅
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.3c">
        \pi_{\phi}(a^{(R)}|s^{(R)})
       </annotation>
      </semantics>
     </math>
     for Agent-R). The policy samples an action
     <math alttext="a^{(S)}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1">
      <semantics id="S3.SS4.p1.3.m3.1a">
       <msup id="S3.SS4.p1.3.m3.1.2" xref="S3.SS4.p1.3.m3.1.2.cmml">
        <mi id="S3.SS4.p1.3.m3.1.2.2" xref="S3.SS4.p1.3.m3.1.2.2.cmml">
         a
        </mi>
        <mrow id="S3.SS4.p1.3.m3.1.1.1.3" xref="S3.SS4.p1.3.m3.1.2.cmml">
         <mo id="S3.SS4.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS4.p1.3.m3.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS4.p1.3.m3.1.1.1.1" xref="S3.SS4.p1.3.m3.1.1.1.1.cmml">
          S
         </mi>
         <mo id="S3.SS4.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS4.p1.3.m3.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b">
        <apply id="S3.SS4.p1.3.m3.1.2.cmml" xref="S3.SS4.p1.3.m3.1.2">
         <csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.2.1.cmml" xref="S3.SS4.p1.3.m3.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS4.p1.3.m3.1.2.2.cmml" xref="S3.SS4.p1.3.m3.1.2.2">
          𝑎
         </ci>
         <ci id="S3.SS4.p1.3.m3.1.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1.1.1">
          𝑆
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">
        a^{(S)}
       </annotation>
      </semantics>
     </math>
     (resp.
     <math alttext="a^{(R)}" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m4.1">
      <semantics id="S3.SS4.p1.4.m4.1a">
       <msup id="S3.SS4.p1.4.m4.1.2" xref="S3.SS4.p1.4.m4.1.2.cmml">
        <mi id="S3.SS4.p1.4.m4.1.2.2" xref="S3.SS4.p1.4.m4.1.2.2.cmml">
         a
        </mi>
        <mrow id="S3.SS4.p1.4.m4.1.1.1.3" xref="S3.SS4.p1.4.m4.1.2.cmml">
         <mo id="S3.SS4.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS4.p1.4.m4.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS4.p1.4.m4.1.1.1.1" xref="S3.SS4.p1.4.m4.1.1.1.1.cmml">
          R
         </mi>
         <mo id="S3.SS4.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS4.p1.4.m4.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b">
        <apply id="S3.SS4.p1.4.m4.1.2.cmml" xref="S3.SS4.p1.4.m4.1.2">
         <csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.2.1.cmml" xref="S3.SS4.p1.4.m4.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS4.p1.4.m4.1.2.2.cmml" xref="S3.SS4.p1.4.m4.1.2.2">
          𝑎
         </ci>
         <ci id="S3.SS4.p1.4.m4.1.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1.1">
          𝑅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">
        a^{(R)}
       </annotation>
      </semantics>
     </math>
     ) at a given state
     <math alttext="s^{(S)}" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m5.1">
      <semantics id="S3.SS4.p1.5.m5.1a">
       <msup id="S3.SS4.p1.5.m5.1.2" xref="S3.SS4.p1.5.m5.1.2.cmml">
        <mi id="S3.SS4.p1.5.m5.1.2.2" xref="S3.SS4.p1.5.m5.1.2.2.cmml">
         s
        </mi>
        <mrow id="S3.SS4.p1.5.m5.1.1.1.3" xref="S3.SS4.p1.5.m5.1.2.cmml">
         <mo id="S3.SS4.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS4.p1.5.m5.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS4.p1.5.m5.1.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.1.cmml">
          S
         </mi>
         <mo id="S3.SS4.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS4.p1.5.m5.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b">
        <apply id="S3.SS4.p1.5.m5.1.2.cmml" xref="S3.SS4.p1.5.m5.1.2">
         <csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.2.1.cmml" xref="S3.SS4.p1.5.m5.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS4.p1.5.m5.1.2.2.cmml" xref="S3.SS4.p1.5.m5.1.2.2">
          𝑠
         </ci>
         <ci id="S3.SS4.p1.5.m5.1.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1">
          𝑆
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">
        s^{(S)}
       </annotation>
      </semantics>
     </math>
     (resp.
     <math alttext="s^{(R)}" class="ltx_Math" display="inline" id="S3.SS4.p1.6.m6.1">
      <semantics id="S3.SS4.p1.6.m6.1a">
       <msup id="S3.SS4.p1.6.m6.1.2" xref="S3.SS4.p1.6.m6.1.2.cmml">
        <mi id="S3.SS4.p1.6.m6.1.2.2" xref="S3.SS4.p1.6.m6.1.2.2.cmml">
         s
        </mi>
        <mrow id="S3.SS4.p1.6.m6.1.1.1.3" xref="S3.SS4.p1.6.m6.1.2.cmml">
         <mo id="S3.SS4.p1.6.m6.1.1.1.3.1" stretchy="false" xref="S3.SS4.p1.6.m6.1.2.cmml">
          (
         </mo>
         <mi id="S3.SS4.p1.6.m6.1.1.1.1" xref="S3.SS4.p1.6.m6.1.1.1.1.cmml">
          R
         </mi>
         <mo id="S3.SS4.p1.6.m6.1.1.1.3.2" stretchy="false" xref="S3.SS4.p1.6.m6.1.2.cmml">
          )
         </mo>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b">
        <apply id="S3.SS4.p1.6.m6.1.2.cmml" xref="S3.SS4.p1.6.m6.1.2">
         <csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.1.2.1.cmml" xref="S3.SS4.p1.6.m6.1.2">
          superscript
         </csymbol>
         <ci id="S3.SS4.p1.6.m6.1.2.2.cmml" xref="S3.SS4.p1.6.m6.1.2.2">
          𝑠
         </ci>
         <ci id="S3.SS4.p1.6.m6.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1.1.1">
          𝑅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">
        s^{(R)}
       </annotation>
      </semantics>
     </math>
     ) via DQN, with parameters denoted by
     <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS4.p1.7.m7.1">
      <semantics id="S3.SS4.p1.7.m7.1a">
       <mi id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml">
        θ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b">
        <ci id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">
         𝜃
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">
        \theta
       </annotation>
      </semantics>
     </math>
     (resp.
     <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS4.p1.8.m8.1">
      <semantics id="S3.SS4.p1.8.m8.1a">
       <mi id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml">
        ϕ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b">
        <ci id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">
         italic-ϕ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">
        \phi
       </annotation>
      </semantics>
     </math>
     ).
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS4.p2">
    <p class="ltx_p" id="S3.SS4.p2.2">
     <span class="ltx_text ltx_font_bold" id="S3.SS4.p2.2.1">
      Combining Agent-S and Agent-R.
     </span>
     We present the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p2.2.2">
      M-RAG
     </span>
     framework in Algorithm
     <a class="ltx_ref" href="#alg1" title="In 3.3 Agent-R: Refining Memories in the Selected Partition ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     , which combines the functionalities of Agent-S and Agent-R on multiple partitions (line 1). The algorithm comprises two main phases: training and inference. During the training phase (lines 2-22), we randomly sample text pairs from the training set (line 4). For each pair, we generate episodes to iteratively train Agent-S and Agent-R, with the MDPs outlined in (lines 6-21) and (lines 11-20), respectively. Experiences of
     <math alttext="(s^{(S)}_{t},a^{(S)}_{t},r^{(S)}_{t},s^{(S)}_{t+1})" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.8">
      <semantics id="S3.SS4.p2.1.m1.8a">
       <mrow id="S3.SS4.p2.1.m1.8.8.4" xref="S3.SS4.p2.1.m1.8.8.5.cmml">
        <mo id="S3.SS4.p2.1.m1.8.8.4.5" stretchy="false" xref="S3.SS4.p2.1.m1.8.8.5.cmml">
         (
        </mo>
        <msubsup id="S3.SS4.p2.1.m1.5.5.1.1" xref="S3.SS4.p2.1.m1.5.5.1.1.cmml">
         <mi id="S3.SS4.p2.1.m1.5.5.1.1.2.2" xref="S3.SS4.p2.1.m1.5.5.1.1.2.2.cmml">
          s
         </mi>
         <mi id="S3.SS4.p2.1.m1.5.5.1.1.3" xref="S3.SS4.p2.1.m1.5.5.1.1.3.cmml">
          t
         </mi>
         <mrow id="S3.SS4.p2.1.m1.1.1.1.3" xref="S3.SS4.p2.1.m1.5.5.1.1.cmml">
          <mo id="S3.SS4.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS4.p2.1.m1.5.5.1.1.cmml">
           (
          </mo>
          <mi id="S3.SS4.p2.1.m1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.cmml">
           S
          </mi>
          <mo id="S3.SS4.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS4.p2.1.m1.5.5.1.1.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS4.p2.1.m1.8.8.4.6" xref="S3.SS4.p2.1.m1.8.8.5.cmml">
         ,
        </mo>
        <msubsup id="S3.SS4.p2.1.m1.6.6.2.2" xref="S3.SS4.p2.1.m1.6.6.2.2.cmml">
         <mi id="S3.SS4.p2.1.m1.6.6.2.2.2.2" xref="S3.SS4.p2.1.m1.6.6.2.2.2.2.cmml">
          a
         </mi>
         <mi id="S3.SS4.p2.1.m1.6.6.2.2.3" xref="S3.SS4.p2.1.m1.6.6.2.2.3.cmml">
          t
         </mi>
         <mrow id="S3.SS4.p2.1.m1.2.2.1.3" xref="S3.SS4.p2.1.m1.6.6.2.2.cmml">
          <mo id="S3.SS4.p2.1.m1.2.2.1.3.1" stretchy="false" xref="S3.SS4.p2.1.m1.6.6.2.2.cmml">
           (
          </mo>
          <mi id="S3.SS4.p2.1.m1.2.2.1.1" xref="S3.SS4.p2.1.m1.2.2.1.1.cmml">
           S
          </mi>
          <mo id="S3.SS4.p2.1.m1.2.2.1.3.2" stretchy="false" xref="S3.SS4.p2.1.m1.6.6.2.2.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS4.p2.1.m1.8.8.4.7" xref="S3.SS4.p2.1.m1.8.8.5.cmml">
         ,
        </mo>
        <msubsup id="S3.SS4.p2.1.m1.7.7.3.3" xref="S3.SS4.p2.1.m1.7.7.3.3.cmml">
         <mi id="S3.SS4.p2.1.m1.7.7.3.3.2.2" xref="S3.SS4.p2.1.m1.7.7.3.3.2.2.cmml">
          r
         </mi>
         <mi id="S3.SS4.p2.1.m1.7.7.3.3.3" xref="S3.SS4.p2.1.m1.7.7.3.3.3.cmml">
          t
         </mi>
         <mrow id="S3.SS4.p2.1.m1.3.3.1.3" xref="S3.SS4.p2.1.m1.7.7.3.3.cmml">
          <mo id="S3.SS4.p2.1.m1.3.3.1.3.1" stretchy="false" xref="S3.SS4.p2.1.m1.7.7.3.3.cmml">
           (
          </mo>
          <mi id="S3.SS4.p2.1.m1.3.3.1.1" xref="S3.SS4.p2.1.m1.3.3.1.1.cmml">
           S
          </mi>
          <mo id="S3.SS4.p2.1.m1.3.3.1.3.2" stretchy="false" xref="S3.SS4.p2.1.m1.7.7.3.3.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS4.p2.1.m1.8.8.4.8" xref="S3.SS4.p2.1.m1.8.8.5.cmml">
         ,
        </mo>
        <msubsup id="S3.SS4.p2.1.m1.8.8.4.4" xref="S3.SS4.p2.1.m1.8.8.4.4.cmml">
         <mi id="S3.SS4.p2.1.m1.8.8.4.4.2.2" xref="S3.SS4.p2.1.m1.8.8.4.4.2.2.cmml">
          s
         </mi>
         <mrow id="S3.SS4.p2.1.m1.8.8.4.4.3" xref="S3.SS4.p2.1.m1.8.8.4.4.3.cmml">
          <mi id="S3.SS4.p2.1.m1.8.8.4.4.3.2" xref="S3.SS4.p2.1.m1.8.8.4.4.3.2.cmml">
           t
          </mi>
          <mo id="S3.SS4.p2.1.m1.8.8.4.4.3.1" xref="S3.SS4.p2.1.m1.8.8.4.4.3.1.cmml">
           +
          </mo>
          <mn id="S3.SS4.p2.1.m1.8.8.4.4.3.3" xref="S3.SS4.p2.1.m1.8.8.4.4.3.3.cmml">
           1
          </mn>
         </mrow>
         <mrow id="S3.SS4.p2.1.m1.4.4.1.3" xref="S3.SS4.p2.1.m1.8.8.4.4.cmml">
          <mo id="S3.SS4.p2.1.m1.4.4.1.3.1" stretchy="false" xref="S3.SS4.p2.1.m1.8.8.4.4.cmml">
           (
          </mo>
          <mi id="S3.SS4.p2.1.m1.4.4.1.1" xref="S3.SS4.p2.1.m1.4.4.1.1.cmml">
           S
          </mi>
          <mo id="S3.SS4.p2.1.m1.4.4.1.3.2" stretchy="false" xref="S3.SS4.p2.1.m1.8.8.4.4.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS4.p2.1.m1.8.8.4.9" stretchy="false" xref="S3.SS4.p2.1.m1.8.8.5.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.8b">
        <vector id="S3.SS4.p2.1.m1.8.8.5.cmml" xref="S3.SS4.p2.1.m1.8.8.4">
         <apply id="S3.SS4.p2.1.m1.5.5.1.1.cmml" xref="S3.SS4.p2.1.m1.5.5.1.1">
          <csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.5.5.1.1.1.cmml" xref="S3.SS4.p2.1.m1.5.5.1.1">
           subscript
          </csymbol>
          <apply id="S3.SS4.p2.1.m1.5.5.1.1.2.cmml" xref="S3.SS4.p2.1.m1.5.5.1.1">
           <csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.5.5.1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.5.5.1.1">
            superscript
           </csymbol>
           <ci id="S3.SS4.p2.1.m1.5.5.1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.5.5.1.1.2.2">
            𝑠
           </ci>
           <ci id="S3.SS4.p2.1.m1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1">
            𝑆
           </ci>
          </apply>
          <ci id="S3.SS4.p2.1.m1.5.5.1.1.3.cmml" xref="S3.SS4.p2.1.m1.5.5.1.1.3">
           𝑡
          </ci>
         </apply>
         <apply id="S3.SS4.p2.1.m1.6.6.2.2.cmml" xref="S3.SS4.p2.1.m1.6.6.2.2">
          <csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.6.6.2.2.1.cmml" xref="S3.SS4.p2.1.m1.6.6.2.2">
           subscript
          </csymbol>
          <apply id="S3.SS4.p2.1.m1.6.6.2.2.2.cmml" xref="S3.SS4.p2.1.m1.6.6.2.2">
           <csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.6.6.2.2.2.1.cmml" xref="S3.SS4.p2.1.m1.6.6.2.2">
            superscript
           </csymbol>
           <ci id="S3.SS4.p2.1.m1.6.6.2.2.2.2.cmml" xref="S3.SS4.p2.1.m1.6.6.2.2.2.2">
            𝑎
           </ci>
           <ci id="S3.SS4.p2.1.m1.2.2.1.1.cmml" xref="S3.SS4.p2.1.m1.2.2.1.1">
            𝑆
           </ci>
          </apply>
          <ci id="S3.SS4.p2.1.m1.6.6.2.2.3.cmml" xref="S3.SS4.p2.1.m1.6.6.2.2.3">
           𝑡
          </ci>
         </apply>
         <apply id="S3.SS4.p2.1.m1.7.7.3.3.cmml" xref="S3.SS4.p2.1.m1.7.7.3.3">
          <csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.7.7.3.3.1.cmml" xref="S3.SS4.p2.1.m1.7.7.3.3">
           subscript
          </csymbol>
          <apply id="S3.SS4.p2.1.m1.7.7.3.3.2.cmml" xref="S3.SS4.p2.1.m1.7.7.3.3">
           <csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.7.7.3.3.2.1.cmml" xref="S3.SS4.p2.1.m1.7.7.3.3">
            superscript
           </csymbol>
           <ci id="S3.SS4.p2.1.m1.7.7.3.3.2.2.cmml" xref="S3.SS4.p2.1.m1.7.7.3.3.2.2">
            𝑟
           </ci>
           <ci id="S3.SS4.p2.1.m1.3.3.1.1.cmml" xref="S3.SS4.p2.1.m1.3.3.1.1">
            𝑆
           </ci>
          </apply>
          <ci id="S3.SS4.p2.1.m1.7.7.3.3.3.cmml" xref="S3.SS4.p2.1.m1.7.7.3.3.3">
           𝑡
          </ci>
         </apply>
         <apply id="S3.SS4.p2.1.m1.8.8.4.4.cmml" xref="S3.SS4.p2.1.m1.8.8.4.4">
          <csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.8.8.4.4.1.cmml" xref="S3.SS4.p2.1.m1.8.8.4.4">
           subscript
          </csymbol>
          <apply id="S3.SS4.p2.1.m1.8.8.4.4.2.cmml" xref="S3.SS4.p2.1.m1.8.8.4.4">
           <csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.8.8.4.4.2.1.cmml" xref="S3.SS4.p2.1.m1.8.8.4.4">
            superscript
           </csymbol>
           <ci id="S3.SS4.p2.1.m1.8.8.4.4.2.2.cmml" xref="S3.SS4.p2.1.m1.8.8.4.4.2.2">
            𝑠
           </ci>
           <ci id="S3.SS4.p2.1.m1.4.4.1.1.cmml" xref="S3.SS4.p2.1.m1.4.4.1.1">
            𝑆
           </ci>
          </apply>
          <apply id="S3.SS4.p2.1.m1.8.8.4.4.3.cmml" xref="S3.SS4.p2.1.m1.8.8.4.4.3">
           <plus id="S3.SS4.p2.1.m1.8.8.4.4.3.1.cmml" xref="S3.SS4.p2.1.m1.8.8.4.4.3.1">
           </plus>
           <ci id="S3.SS4.p2.1.m1.8.8.4.4.3.2.cmml" xref="S3.SS4.p2.1.m1.8.8.4.4.3.2">
            𝑡
           </ci>
           <cn id="S3.SS4.p2.1.m1.8.8.4.4.3.3.cmml" type="integer" xref="S3.SS4.p2.1.m1.8.8.4.4.3.3">
            1
           </cn>
          </apply>
         </apply>
        </vector>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.8c">
        (s^{(S)}_{t},a^{(S)}_{t},r^{(S)}_{t},s^{(S)}_{t+1})
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="(s^{(R)}_{t},a^{(R)}_{t},r^{(R)}_{t},s^{(R)}_{t+1})" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.8">
      <semantics id="S3.SS4.p2.2.m2.8a">
       <mrow id="S3.SS4.p2.2.m2.8.8.4" xref="S3.SS4.p2.2.m2.8.8.5.cmml">
        <mo id="S3.SS4.p2.2.m2.8.8.4.5" stretchy="false" xref="S3.SS4.p2.2.m2.8.8.5.cmml">
         (
        </mo>
        <msubsup id="S3.SS4.p2.2.m2.5.5.1.1" xref="S3.SS4.p2.2.m2.5.5.1.1.cmml">
         <mi id="S3.SS4.p2.2.m2.5.5.1.1.2.2" xref="S3.SS4.p2.2.m2.5.5.1.1.2.2.cmml">
          s
         </mi>
         <mi id="S3.SS4.p2.2.m2.5.5.1.1.3" xref="S3.SS4.p2.2.m2.5.5.1.1.3.cmml">
          t
         </mi>
         <mrow id="S3.SS4.p2.2.m2.1.1.1.3" xref="S3.SS4.p2.2.m2.5.5.1.1.cmml">
          <mo id="S3.SS4.p2.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS4.p2.2.m2.5.5.1.1.cmml">
           (
          </mo>
          <mi id="S3.SS4.p2.2.m2.1.1.1.1" xref="S3.SS4.p2.2.m2.1.1.1.1.cmml">
           R
          </mi>
          <mo id="S3.SS4.p2.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS4.p2.2.m2.5.5.1.1.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS4.p2.2.m2.8.8.4.6" xref="S3.SS4.p2.2.m2.8.8.5.cmml">
         ,
        </mo>
        <msubsup id="S3.SS4.p2.2.m2.6.6.2.2" xref="S3.SS4.p2.2.m2.6.6.2.2.cmml">
         <mi id="S3.SS4.p2.2.m2.6.6.2.2.2.2" xref="S3.SS4.p2.2.m2.6.6.2.2.2.2.cmml">
          a
         </mi>
         <mi id="S3.SS4.p2.2.m2.6.6.2.2.3" xref="S3.SS4.p2.2.m2.6.6.2.2.3.cmml">
          t
         </mi>
         <mrow id="S3.SS4.p2.2.m2.2.2.1.3" xref="S3.SS4.p2.2.m2.6.6.2.2.cmml">
          <mo id="S3.SS4.p2.2.m2.2.2.1.3.1" stretchy="false" xref="S3.SS4.p2.2.m2.6.6.2.2.cmml">
           (
          </mo>
          <mi id="S3.SS4.p2.2.m2.2.2.1.1" xref="S3.SS4.p2.2.m2.2.2.1.1.cmml">
           R
          </mi>
          <mo id="S3.SS4.p2.2.m2.2.2.1.3.2" stretchy="false" xref="S3.SS4.p2.2.m2.6.6.2.2.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS4.p2.2.m2.8.8.4.7" xref="S3.SS4.p2.2.m2.8.8.5.cmml">
         ,
        </mo>
        <msubsup id="S3.SS4.p2.2.m2.7.7.3.3" xref="S3.SS4.p2.2.m2.7.7.3.3.cmml">
         <mi id="S3.SS4.p2.2.m2.7.7.3.3.2.2" xref="S3.SS4.p2.2.m2.7.7.3.3.2.2.cmml">
          r
         </mi>
         <mi id="S3.SS4.p2.2.m2.7.7.3.3.3" xref="S3.SS4.p2.2.m2.7.7.3.3.3.cmml">
          t
         </mi>
         <mrow id="S3.SS4.p2.2.m2.3.3.1.3" xref="S3.SS4.p2.2.m2.7.7.3.3.cmml">
          <mo id="S3.SS4.p2.2.m2.3.3.1.3.1" stretchy="false" xref="S3.SS4.p2.2.m2.7.7.3.3.cmml">
           (
          </mo>
          <mi id="S3.SS4.p2.2.m2.3.3.1.1" xref="S3.SS4.p2.2.m2.3.3.1.1.cmml">
           R
          </mi>
          <mo id="S3.SS4.p2.2.m2.3.3.1.3.2" stretchy="false" xref="S3.SS4.p2.2.m2.7.7.3.3.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS4.p2.2.m2.8.8.4.8" xref="S3.SS4.p2.2.m2.8.8.5.cmml">
         ,
        </mo>
        <msubsup id="S3.SS4.p2.2.m2.8.8.4.4" xref="S3.SS4.p2.2.m2.8.8.4.4.cmml">
         <mi id="S3.SS4.p2.2.m2.8.8.4.4.2.2" xref="S3.SS4.p2.2.m2.8.8.4.4.2.2.cmml">
          s
         </mi>
         <mrow id="S3.SS4.p2.2.m2.8.8.4.4.3" xref="S3.SS4.p2.2.m2.8.8.4.4.3.cmml">
          <mi id="S3.SS4.p2.2.m2.8.8.4.4.3.2" xref="S3.SS4.p2.2.m2.8.8.4.4.3.2.cmml">
           t
          </mi>
          <mo id="S3.SS4.p2.2.m2.8.8.4.4.3.1" xref="S3.SS4.p2.2.m2.8.8.4.4.3.1.cmml">
           +
          </mo>
          <mn id="S3.SS4.p2.2.m2.8.8.4.4.3.3" xref="S3.SS4.p2.2.m2.8.8.4.4.3.3.cmml">
           1
          </mn>
         </mrow>
         <mrow id="S3.SS4.p2.2.m2.4.4.1.3" xref="S3.SS4.p2.2.m2.8.8.4.4.cmml">
          <mo id="S3.SS4.p2.2.m2.4.4.1.3.1" stretchy="false" xref="S3.SS4.p2.2.m2.8.8.4.4.cmml">
           (
          </mo>
          <mi id="S3.SS4.p2.2.m2.4.4.1.1" xref="S3.SS4.p2.2.m2.4.4.1.1.cmml">
           R
          </mi>
          <mo id="S3.SS4.p2.2.m2.4.4.1.3.2" stretchy="false" xref="S3.SS4.p2.2.m2.8.8.4.4.cmml">
           )
          </mo>
         </mrow>
        </msubsup>
        <mo id="S3.SS4.p2.2.m2.8.8.4.9" stretchy="false" xref="S3.SS4.p2.2.m2.8.8.5.cmml">
         )
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.8b">
        <vector id="S3.SS4.p2.2.m2.8.8.5.cmml" xref="S3.SS4.p2.2.m2.8.8.4">
         <apply id="S3.SS4.p2.2.m2.5.5.1.1.cmml" xref="S3.SS4.p2.2.m2.5.5.1.1">
          <csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.5.5.1.1.1.cmml" xref="S3.SS4.p2.2.m2.5.5.1.1">
           subscript
          </csymbol>
          <apply id="S3.SS4.p2.2.m2.5.5.1.1.2.cmml" xref="S3.SS4.p2.2.m2.5.5.1.1">
           <csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.5.5.1.1.2.1.cmml" xref="S3.SS4.p2.2.m2.5.5.1.1">
            superscript
           </csymbol>
           <ci id="S3.SS4.p2.2.m2.5.5.1.1.2.2.cmml" xref="S3.SS4.p2.2.m2.5.5.1.1.2.2">
            𝑠
           </ci>
           <ci id="S3.SS4.p2.2.m2.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1">
            𝑅
           </ci>
          </apply>
          <ci id="S3.SS4.p2.2.m2.5.5.1.1.3.cmml" xref="S3.SS4.p2.2.m2.5.5.1.1.3">
           𝑡
          </ci>
         </apply>
         <apply id="S3.SS4.p2.2.m2.6.6.2.2.cmml" xref="S3.SS4.p2.2.m2.6.6.2.2">
          <csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.6.6.2.2.1.cmml" xref="S3.SS4.p2.2.m2.6.6.2.2">
           subscript
          </csymbol>
          <apply id="S3.SS4.p2.2.m2.6.6.2.2.2.cmml" xref="S3.SS4.p2.2.m2.6.6.2.2">
           <csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.6.6.2.2.2.1.cmml" xref="S3.SS4.p2.2.m2.6.6.2.2">
            superscript
           </csymbol>
           <ci id="S3.SS4.p2.2.m2.6.6.2.2.2.2.cmml" xref="S3.SS4.p2.2.m2.6.6.2.2.2.2">
            𝑎
           </ci>
           <ci id="S3.SS4.p2.2.m2.2.2.1.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1">
            𝑅
           </ci>
          </apply>
          <ci id="S3.SS4.p2.2.m2.6.6.2.2.3.cmml" xref="S3.SS4.p2.2.m2.6.6.2.2.3">
           𝑡
          </ci>
         </apply>
         <apply id="S3.SS4.p2.2.m2.7.7.3.3.cmml" xref="S3.SS4.p2.2.m2.7.7.3.3">
          <csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.7.7.3.3.1.cmml" xref="S3.SS4.p2.2.m2.7.7.3.3">
           subscript
          </csymbol>
          <apply id="S3.SS4.p2.2.m2.7.7.3.3.2.cmml" xref="S3.SS4.p2.2.m2.7.7.3.3">
           <csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.7.7.3.3.2.1.cmml" xref="S3.SS4.p2.2.m2.7.7.3.3">
            superscript
           </csymbol>
           <ci id="S3.SS4.p2.2.m2.7.7.3.3.2.2.cmml" xref="S3.SS4.p2.2.m2.7.7.3.3.2.2">
            𝑟
           </ci>
           <ci id="S3.SS4.p2.2.m2.3.3.1.1.cmml" xref="S3.SS4.p2.2.m2.3.3.1.1">
            𝑅
           </ci>
          </apply>
          <ci id="S3.SS4.p2.2.m2.7.7.3.3.3.cmml" xref="S3.SS4.p2.2.m2.7.7.3.3.3">
           𝑡
          </ci>
         </apply>
         <apply id="S3.SS4.p2.2.m2.8.8.4.4.cmml" xref="S3.SS4.p2.2.m2.8.8.4.4">
          <csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.8.8.4.4.1.cmml" xref="S3.SS4.p2.2.m2.8.8.4.4">
           subscript
          </csymbol>
          <apply id="S3.SS4.p2.2.m2.8.8.4.4.2.cmml" xref="S3.SS4.p2.2.m2.8.8.4.4">
           <csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.8.8.4.4.2.1.cmml" xref="S3.SS4.p2.2.m2.8.8.4.4">
            superscript
           </csymbol>
           <ci id="S3.SS4.p2.2.m2.8.8.4.4.2.2.cmml" xref="S3.SS4.p2.2.m2.8.8.4.4.2.2">
            𝑠
           </ci>
           <ci id="S3.SS4.p2.2.m2.4.4.1.1.cmml" xref="S3.SS4.p2.2.m2.4.4.1.1">
            𝑅
           </ci>
          </apply>
          <apply id="S3.SS4.p2.2.m2.8.8.4.4.3.cmml" xref="S3.SS4.p2.2.m2.8.8.4.4.3">
           <plus id="S3.SS4.p2.2.m2.8.8.4.4.3.1.cmml" xref="S3.SS4.p2.2.m2.8.8.4.4.3.1">
           </plus>
           <ci id="S3.SS4.p2.2.m2.8.8.4.4.3.2.cmml" xref="S3.SS4.p2.2.m2.8.8.4.4.3.2">
            𝑡
           </ci>
           <cn id="S3.SS4.p2.2.m2.8.8.4.4.3.3.cmml" type="integer" xref="S3.SS4.p2.2.m2.8.8.4.4.3.3">
            1
           </cn>
          </apply>
         </apply>
        </vector>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.8c">
        (s^{(R)}_{t},a^{(R)}_{t},r^{(R)}_{t},s^{(R)}_{t+1})
       </annotation>
      </semantics>
     </math>
     are stored during the iteration, and a minibatch is sampled to optimize the two agents via DQN (line 22).
    </p>
   </div>
   <div class="ltx_para" id="S3.SS4.p3">
    <p class="ltx_p" id="S3.SS4.p3.3">
     During the inference phase (line 23), final hypotheses are generated via a LLM based on the refined
     <math alttext="\mathbb{D}" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1">
      <semantics id="S3.SS4.p3.1.m1.1a">
       <mi id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml">
        𝔻
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b">
        <ci id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">
         𝔻
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">
        \mathbb{D}
       </annotation>
      </semantics>
     </math>
     , where a partition is selected by the trained Agent-S, and the
     <math alttext="\tilde{y}" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.1">
      <semantics id="S3.SS4.p3.2.m2.1a">
       <mover accent="true" id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml">
        <mi id="S3.SS4.p3.2.m2.1.1.2" xref="S3.SS4.p3.2.m2.1.1.2.cmml">
         y
        </mi>
        <mo id="S3.SS4.p3.2.m2.1.1.1" xref="S3.SS4.p3.2.m2.1.1.1.cmml">
         ~
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b">
        <apply id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">
         <ci id="S3.SS4.p3.2.m2.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1">
          ~
         </ci>
         <ci id="S3.SS4.p3.2.m2.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2">
          𝑦
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">
        \tilde{y}
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="y" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m3.1">
      <semantics id="S3.SS4.p3.3.m3.1a">
       <mi id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml">
        y
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b">
        <ci id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">
         𝑦
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">
        y
       </annotation>
      </semantics>
     </math>
     (unknown during inference) are omitted to construct the state by Eq
     <a class="ltx_ref" href="#S3.E1" title="In 3.2 Agent-S: Selecting a Database Partition ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     .
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS4.p4">
    <p class="ltx_p" id="S3.SS4.p4.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS4.p4.1.1">
      Time Complexity.
     </span>
     We discuss the complexity of
     <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p4.1.2">
      M-RAG
     </span>
     compared to a Naive RAG setup introduced in Section
     <a class="ltx_ref" href="#S2" title="2 Related Work ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     in terms of the three steps: (1) indexing, (2) retrieval, and (3) generation as shown in Figure
     <a class="ltx_ref" href="#S3.F2" title="Figure 2 ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     . In terms of inference, involving (1) and (2), it is worth noting that the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p4.1.3">
      M-RAG
     </span>
     exhibits a complexity comparable to that of a Naive RAG setup, with the additional complexity (3) only being involved during training.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS4.p5">
    <p class="ltx_p" id="S3.SS4.p5.5">
     For (1), the complexity associated with constructing multiple partitions (e.g., using the HNSW index structure) is represented as
     <math alttext="O(M\cdot N\log N)" class="ltx_Math" display="inline" id="S3.SS4.p5.1.m1.1">
      <semantics id="S3.SS4.p5.1.m1.1a">
       <mrow id="S3.SS4.p5.1.m1.1.1" xref="S3.SS4.p5.1.m1.1.1.cmml">
        <mi id="S3.SS4.p5.1.m1.1.1.3" xref="S3.SS4.p5.1.m1.1.1.3.cmml">
         O
        </mi>
        <mo id="S3.SS4.p5.1.m1.1.1.2" lspace="0em" rspace="0em" xref="S3.SS4.p5.1.m1.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS4.p5.1.m1.1.1.1.1" xref="S3.SS4.p5.1.m1.1.1.1.1.1.cmml">
         <mo id="S3.SS4.p5.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p5.1.m1.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S3.SS4.p5.1.m1.1.1.1.1.1" xref="S3.SS4.p5.1.m1.1.1.1.1.1.cmml">
          <mrow id="S3.SS4.p5.1.m1.1.1.1.1.1.2" xref="S3.SS4.p5.1.m1.1.1.1.1.1.2.cmml">
           <mi id="S3.SS4.p5.1.m1.1.1.1.1.1.2.2" xref="S3.SS4.p5.1.m1.1.1.1.1.1.2.2.cmml">
            M
           </mi>
           <mo id="S3.SS4.p5.1.m1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p5.1.m1.1.1.1.1.1.2.1.cmml">
            ⋅
           </mo>
           <mi id="S3.SS4.p5.1.m1.1.1.1.1.1.2.3" xref="S3.SS4.p5.1.m1.1.1.1.1.1.2.3.cmml">
            N
           </mi>
          </mrow>
          <mo id="S3.SS4.p5.1.m1.1.1.1.1.1.1" lspace="0.167em" rspace="0em" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mrow id="S3.SS4.p5.1.m1.1.1.1.1.1.3" xref="S3.SS4.p5.1.m1.1.1.1.1.1.3.cmml">
           <mi id="S3.SS4.p5.1.m1.1.1.1.1.1.3.1" xref="S3.SS4.p5.1.m1.1.1.1.1.1.3.1.cmml">
            log
           </mi>
           <mo id="S3.SS4.p5.1.m1.1.1.1.1.1.3a" lspace="0.167em" xref="S3.SS4.p5.1.m1.1.1.1.1.1.3.cmml">
            ⁡
           </mo>
           <mi id="S3.SS4.p5.1.m1.1.1.1.1.1.3.2" xref="S3.SS4.p5.1.m1.1.1.1.1.1.3.2.cmml">
            N
           </mi>
          </mrow>
         </mrow>
         <mo id="S3.SS4.p5.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p5.1.m1.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.1.m1.1b">
        <apply id="S3.SS4.p5.1.m1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1">
         <times id="S3.SS4.p5.1.m1.1.1.2.cmml" xref="S3.SS4.p5.1.m1.1.1.2">
         </times>
         <ci id="S3.SS4.p5.1.m1.1.1.3.cmml" xref="S3.SS4.p5.1.m1.1.1.3">
          𝑂
         </ci>
         <apply id="S3.SS4.p5.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1">
          <times id="S3.SS4.p5.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.1">
          </times>
          <apply id="S3.SS4.p5.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.2">
           <ci id="S3.SS4.p5.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.2.1">
            ⋅
           </ci>
           <ci id="S3.SS4.p5.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.2.2">
            𝑀
           </ci>
           <ci id="S3.SS4.p5.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.2.3">
            𝑁
           </ci>
          </apply>
          <apply id="S3.SS4.p5.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.3">
           <log id="S3.SS4.p5.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.3.1">
           </log>
           <ci id="S3.SS4.p5.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p5.1.m1.1.1.1.1.1.3.2">
            𝑁
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.1.m1.1c">
        O(M\cdot N\log N)
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="M" class="ltx_Math" display="inline" id="S3.SS4.p5.2.m2.1">
      <semantics id="S3.SS4.p5.2.m2.1a">
       <mi id="S3.SS4.p5.2.m2.1.1" xref="S3.SS4.p5.2.m2.1.1.cmml">
        M
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.2.m2.1b">
        <ci id="S3.SS4.p5.2.m2.1.1.cmml" xref="S3.SS4.p5.2.m2.1.1">
         𝑀
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.2.m2.1c">
        M
       </annotation>
      </semantics>
     </math>
     indicates the number of partitions and
     <math alttext="N" class="ltx_Math" display="inline" id="S3.SS4.p5.3.m3.1">
      <semantics id="S3.SS4.p5.3.m3.1a">
       <mi id="S3.SS4.p5.3.m3.1.1" xref="S3.SS4.p5.3.m3.1.1.cmml">
        N
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.3.m3.1b">
        <ci id="S3.SS4.p5.3.m3.1.1.cmml" xref="S3.SS4.p5.3.m3.1.1">
         𝑁
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.3.m3.1c">
        N
       </annotation>
      </semantics>
     </math>
     indicates the maximum number of memories within a partition. This approach proves to be faster compared to a Naive RAG setup, which organizes all data within a single index structure with a construction complexity of
     <math alttext="O(N^{\prime}\log N^{\prime})" class="ltx_Math" display="inline" id="S3.SS4.p5.4.m4.1">
      <semantics id="S3.SS4.p5.4.m4.1a">
       <mrow id="S3.SS4.p5.4.m4.1.1" xref="S3.SS4.p5.4.m4.1.1.cmml">
        <mi id="S3.SS4.p5.4.m4.1.1.3" xref="S3.SS4.p5.4.m4.1.1.3.cmml">
         O
        </mi>
        <mo id="S3.SS4.p5.4.m4.1.1.2" lspace="0em" rspace="0em" xref="S3.SS4.p5.4.m4.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS4.p5.4.m4.1.1.1.1" xref="S3.SS4.p5.4.m4.1.1.1.1.1.cmml">
         <mo id="S3.SS4.p5.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS4.p5.4.m4.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S3.SS4.p5.4.m4.1.1.1.1.1" xref="S3.SS4.p5.4.m4.1.1.1.1.1.cmml">
          <msup id="S3.SS4.p5.4.m4.1.1.1.1.1.2" xref="S3.SS4.p5.4.m4.1.1.1.1.1.2.cmml">
           <mi id="S3.SS4.p5.4.m4.1.1.1.1.1.2.2" xref="S3.SS4.p5.4.m4.1.1.1.1.1.2.2.cmml">
            N
           </mi>
           <mo id="S3.SS4.p5.4.m4.1.1.1.1.1.2.3" xref="S3.SS4.p5.4.m4.1.1.1.1.1.2.3.cmml">
            ′
           </mo>
          </msup>
          <mo id="S3.SS4.p5.4.m4.1.1.1.1.1.1" lspace="0.167em" rspace="0em" xref="S3.SS4.p5.4.m4.1.1.1.1.1.1.cmml">
           ​
          </mo>
          <mrow id="S3.SS4.p5.4.m4.1.1.1.1.1.3" xref="S3.SS4.p5.4.m4.1.1.1.1.1.3.cmml">
           <mi id="S3.SS4.p5.4.m4.1.1.1.1.1.3.1" xref="S3.SS4.p5.4.m4.1.1.1.1.1.3.1.cmml">
            log
           </mi>
           <mo id="S3.SS4.p5.4.m4.1.1.1.1.1.3a" lspace="0.167em" xref="S3.SS4.p5.4.m4.1.1.1.1.1.3.cmml">
            ⁡
           </mo>
           <msup id="S3.SS4.p5.4.m4.1.1.1.1.1.3.2" xref="S3.SS4.p5.4.m4.1.1.1.1.1.3.2.cmml">
            <mi id="S3.SS4.p5.4.m4.1.1.1.1.1.3.2.2" xref="S3.SS4.p5.4.m4.1.1.1.1.1.3.2.2.cmml">
             N
            </mi>
            <mo id="S3.SS4.p5.4.m4.1.1.1.1.1.3.2.3" xref="S3.SS4.p5.4.m4.1.1.1.1.1.3.2.3.cmml">
             ′
            </mo>
           </msup>
          </mrow>
         </mrow>
         <mo id="S3.SS4.p5.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS4.p5.4.m4.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.4.m4.1b">
        <apply id="S3.SS4.p5.4.m4.1.1.cmml" xref="S3.SS4.p5.4.m4.1.1">
         <times id="S3.SS4.p5.4.m4.1.1.2.cmml" xref="S3.SS4.p5.4.m4.1.1.2">
         </times>
         <ci id="S3.SS4.p5.4.m4.1.1.3.cmml" xref="S3.SS4.p5.4.m4.1.1.3">
          𝑂
         </ci>
         <apply id="S3.SS4.p5.4.m4.1.1.1.1.1.cmml" xref="S3.SS4.p5.4.m4.1.1.1.1">
          <times id="S3.SS4.p5.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.p5.4.m4.1.1.1.1.1.1">
          </times>
          <apply id="S3.SS4.p5.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS4.p5.4.m4.1.1.1.1.1.2">
           <csymbol cd="ambiguous" id="S3.SS4.p5.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p5.4.m4.1.1.1.1.1.2">
            superscript
           </csymbol>
           <ci id="S3.SS4.p5.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p5.4.m4.1.1.1.1.1.2.2">
            𝑁
           </ci>
           <ci id="S3.SS4.p5.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p5.4.m4.1.1.1.1.1.2.3">
            ′
           </ci>
          </apply>
          <apply id="S3.SS4.p5.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS4.p5.4.m4.1.1.1.1.1.3">
           <log id="S3.SS4.p5.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p5.4.m4.1.1.1.1.1.3.1">
           </log>
           <apply id="S3.SS4.p5.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p5.4.m4.1.1.1.1.1.3.2">
            <csymbol cd="ambiguous" id="S3.SS4.p5.4.m4.1.1.1.1.1.3.2.1.cmml" xref="S3.SS4.p5.4.m4.1.1.1.1.1.3.2">
             superscript
            </csymbol>
            <ci id="S3.SS4.p5.4.m4.1.1.1.1.1.3.2.2.cmml" xref="S3.SS4.p5.4.m4.1.1.1.1.1.3.2.2">
             𝑁
            </ci>
            <ci id="S3.SS4.p5.4.m4.1.1.1.1.1.3.2.3.cmml" xref="S3.SS4.p5.4.m4.1.1.1.1.1.3.2.3">
             ′
            </ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.4.m4.1c">
        O(N^{\prime}\log N^{\prime})
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="N^{\prime}" class="ltx_Math" display="inline" id="S3.SS4.p5.5.m5.1">
      <semantics id="S3.SS4.p5.5.m5.1a">
       <msup id="S3.SS4.p5.5.m5.1.1" xref="S3.SS4.p5.5.m5.1.1.cmml">
        <mi id="S3.SS4.p5.5.m5.1.1.2" xref="S3.SS4.p5.5.m5.1.1.2.cmml">
         N
        </mi>
        <mo id="S3.SS4.p5.5.m5.1.1.3" xref="S3.SS4.p5.5.m5.1.1.3.cmml">
         ′
        </mo>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p5.5.m5.1b">
        <apply id="S3.SS4.p5.5.m5.1.1.cmml" xref="S3.SS4.p5.5.m5.1.1">
         <csymbol cd="ambiguous" id="S3.SS4.p5.5.m5.1.1.1.cmml" xref="S3.SS4.p5.5.m5.1.1">
          superscript
         </csymbol>
         <ci id="S3.SS4.p5.5.m5.1.1.2.cmml" xref="S3.SS4.p5.5.m5.1.1.2">
          𝑁
         </ci>
         <ci id="S3.SS4.p5.5.m5.1.1.3.cmml" xref="S3.SS4.p5.5.m5.1.1.3">
          ′
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p5.5.m5.1c">
        N^{\prime}
       </annotation>
      </semantics>
     </math>
     represents the total number of memories in the database.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS4.p6">
    <p class="ltx_p" id="S3.SS4.p6.4">
     For (2), the complexity of Agent-S is approximately
     <math alttext="O(M\cdot\log N)" class="ltx_Math" display="inline" id="S3.SS4.p6.1.m1.1">
      <semantics id="S3.SS4.p6.1.m1.1a">
       <mrow id="S3.SS4.p6.1.m1.1.1" xref="S3.SS4.p6.1.m1.1.1.cmml">
        <mi id="S3.SS4.p6.1.m1.1.1.3" xref="S3.SS4.p6.1.m1.1.1.3.cmml">
         O
        </mi>
        <mo id="S3.SS4.p6.1.m1.1.1.2" lspace="0em" rspace="0em" xref="S3.SS4.p6.1.m1.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS4.p6.1.m1.1.1.1.1" xref="S3.SS4.p6.1.m1.1.1.1.1.1.cmml">
         <mo id="S3.SS4.p6.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p6.1.m1.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S3.SS4.p6.1.m1.1.1.1.1.1" xref="S3.SS4.p6.1.m1.1.1.1.1.1.cmml">
          <mi id="S3.SS4.p6.1.m1.1.1.1.1.1.2" xref="S3.SS4.p6.1.m1.1.1.1.1.1.2.cmml">
           M
          </mi>
          <mo id="S3.SS4.p6.1.m1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p6.1.m1.1.1.1.1.1.1.cmml">
           ⋅
          </mo>
          <mrow id="S3.SS4.p6.1.m1.1.1.1.1.1.3" xref="S3.SS4.p6.1.m1.1.1.1.1.1.3.cmml">
           <mi id="S3.SS4.p6.1.m1.1.1.1.1.1.3.1" xref="S3.SS4.p6.1.m1.1.1.1.1.1.3.1.cmml">
            log
           </mi>
           <mo id="S3.SS4.p6.1.m1.1.1.1.1.1.3a" lspace="0.167em" xref="S3.SS4.p6.1.m1.1.1.1.1.1.3.cmml">
            ⁡
           </mo>
           <mi id="S3.SS4.p6.1.m1.1.1.1.1.1.3.2" xref="S3.SS4.p6.1.m1.1.1.1.1.1.3.2.cmml">
            N
           </mi>
          </mrow>
         </mrow>
         <mo id="S3.SS4.p6.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p6.1.m1.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p6.1.m1.1b">
        <apply id="S3.SS4.p6.1.m1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1">
         <times id="S3.SS4.p6.1.m1.1.1.2.cmml" xref="S3.SS4.p6.1.m1.1.1.2">
         </times>
         <ci id="S3.SS4.p6.1.m1.1.1.3.cmml" xref="S3.SS4.p6.1.m1.1.1.3">
          𝑂
         </ci>
         <apply id="S3.SS4.p6.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1.1.1">
          <ci id="S3.SS4.p6.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.1.m1.1.1.1.1.1.1">
           ⋅
          </ci>
          <ci id="S3.SS4.p6.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.1.m1.1.1.1.1.1.2">
           𝑀
          </ci>
          <apply id="S3.SS4.p6.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.1.m1.1.1.1.1.1.3">
           <log id="S3.SS4.p6.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p6.1.m1.1.1.1.1.1.3.1">
           </log>
           <ci id="S3.SS4.p6.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p6.1.m1.1.1.1.1.1.3.2">
            𝑁
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p6.1.m1.1c">
        O(M\cdot\log N)
       </annotation>
      </semantics>
     </math>
     , where an AKNN search is performed within each partition, incurring a cost of
     <math alttext="O(M\cdot\log N)" class="ltx_Math" display="inline" id="S3.SS4.p6.2.m2.1">
      <semantics id="S3.SS4.p6.2.m2.1a">
       <mrow id="S3.SS4.p6.2.m2.1.1" xref="S3.SS4.p6.2.m2.1.1.cmml">
        <mi id="S3.SS4.p6.2.m2.1.1.3" xref="S3.SS4.p6.2.m2.1.1.3.cmml">
         O
        </mi>
        <mo id="S3.SS4.p6.2.m2.1.1.2" lspace="0em" rspace="0em" xref="S3.SS4.p6.2.m2.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS4.p6.2.m2.1.1.1.1" xref="S3.SS4.p6.2.m2.1.1.1.1.1.cmml">
         <mo id="S3.SS4.p6.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS4.p6.2.m2.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S3.SS4.p6.2.m2.1.1.1.1.1" xref="S3.SS4.p6.2.m2.1.1.1.1.1.cmml">
          <mi id="S3.SS4.p6.2.m2.1.1.1.1.1.2" xref="S3.SS4.p6.2.m2.1.1.1.1.1.2.cmml">
           M
          </mi>
          <mo id="S3.SS4.p6.2.m2.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p6.2.m2.1.1.1.1.1.1.cmml">
           ⋅
          </mo>
          <mrow id="S3.SS4.p6.2.m2.1.1.1.1.1.3" xref="S3.SS4.p6.2.m2.1.1.1.1.1.3.cmml">
           <mi id="S3.SS4.p6.2.m2.1.1.1.1.1.3.1" xref="S3.SS4.p6.2.m2.1.1.1.1.1.3.1.cmml">
            log
           </mi>
           <mo id="S3.SS4.p6.2.m2.1.1.1.1.1.3a" lspace="0.167em" xref="S3.SS4.p6.2.m2.1.1.1.1.1.3.cmml">
            ⁡
           </mo>
           <mi id="S3.SS4.p6.2.m2.1.1.1.1.1.3.2" xref="S3.SS4.p6.2.m2.1.1.1.1.1.3.2.cmml">
            N
           </mi>
          </mrow>
         </mrow>
         <mo id="S3.SS4.p6.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS4.p6.2.m2.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p6.2.m2.1b">
        <apply id="S3.SS4.p6.2.m2.1.1.cmml" xref="S3.SS4.p6.2.m2.1.1">
         <times id="S3.SS4.p6.2.m2.1.1.2.cmml" xref="S3.SS4.p6.2.m2.1.1.2">
         </times>
         <ci id="S3.SS4.p6.2.m2.1.1.3.cmml" xref="S3.SS4.p6.2.m2.1.1.3">
          𝑂
         </ci>
         <apply id="S3.SS4.p6.2.m2.1.1.1.1.1.cmml" xref="S3.SS4.p6.2.m2.1.1.1.1">
          <ci id="S3.SS4.p6.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.2.m2.1.1.1.1.1.1">
           ⋅
          </ci>
          <ci id="S3.SS4.p6.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.2.m2.1.1.1.1.1.2">
           𝑀
          </ci>
          <apply id="S3.SS4.p6.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS4.p6.2.m2.1.1.1.1.1.3">
           <log id="S3.SS4.p6.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p6.2.m2.1.1.1.1.1.3.1">
           </log>
           <ci id="S3.SS4.p6.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p6.2.m2.1.1.1.1.1.3.2">
            𝑁
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p6.2.m2.1c">
        O(M\cdot\log N)
       </annotation>
      </semantics>
     </math>
     with HNSW. Additionally, sampling actions via Agent-S requires
     <math alttext="O(1)" class="ltx_Math" display="inline" id="S3.SS4.p6.3.m3.1">
      <semantics id="S3.SS4.p6.3.m3.1a">
       <mrow id="S3.SS4.p6.3.m3.1.2" xref="S3.SS4.p6.3.m3.1.2.cmml">
        <mi id="S3.SS4.p6.3.m3.1.2.2" xref="S3.SS4.p6.3.m3.1.2.2.cmml">
         O
        </mi>
        <mo id="S3.SS4.p6.3.m3.1.2.1" lspace="0em" rspace="0em" xref="S3.SS4.p6.3.m3.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S3.SS4.p6.3.m3.1.2.3.2" xref="S3.SS4.p6.3.m3.1.2.cmml">
         <mo id="S3.SS4.p6.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS4.p6.3.m3.1.2.cmml">
          (
         </mo>
         <mn id="S3.SS4.p6.3.m3.1.1" xref="S3.SS4.p6.3.m3.1.1.cmml">
          1
         </mn>
         <mo id="S3.SS4.p6.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS4.p6.3.m3.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p6.3.m3.1b">
        <apply id="S3.SS4.p6.3.m3.1.2.cmml" xref="S3.SS4.p6.3.m3.1.2">
         <times id="S3.SS4.p6.3.m3.1.2.1.cmml" xref="S3.SS4.p6.3.m3.1.2.1">
         </times>
         <ci id="S3.SS4.p6.3.m3.1.2.2.cmml" xref="S3.SS4.p6.3.m3.1.2.2">
          𝑂
         </ci>
         <cn id="S3.SS4.p6.3.m3.1.1.cmml" type="integer" xref="S3.SS4.p6.3.m3.1.1">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p6.3.m3.1c">
        O(1)
       </annotation>
      </semantics>
     </math>
     complexity, owing to its lightweight neural network architecture. In contrast, for the Naive RAG setup, conducting the AKNN search within the entire database costs
     <math alttext="O(\log N^{\prime})" class="ltx_Math" display="inline" id="S3.SS4.p6.4.m4.1">
      <semantics id="S3.SS4.p6.4.m4.1a">
       <mrow id="S3.SS4.p6.4.m4.1.1" xref="S3.SS4.p6.4.m4.1.1.cmml">
        <mi id="S3.SS4.p6.4.m4.1.1.3" xref="S3.SS4.p6.4.m4.1.1.3.cmml">
         O
        </mi>
        <mo id="S3.SS4.p6.4.m4.1.1.2" lspace="0em" rspace="0em" xref="S3.SS4.p6.4.m4.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS4.p6.4.m4.1.1.1.1" xref="S3.SS4.p6.4.m4.1.1.1.1.1.cmml">
         <mo id="S3.SS4.p6.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS4.p6.4.m4.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S3.SS4.p6.4.m4.1.1.1.1.1" xref="S3.SS4.p6.4.m4.1.1.1.1.1.cmml">
          <mi id="S3.SS4.p6.4.m4.1.1.1.1.1.1" xref="S3.SS4.p6.4.m4.1.1.1.1.1.1.cmml">
           log
          </mi>
          <mo id="S3.SS4.p6.4.m4.1.1.1.1.1a" lspace="0.167em" xref="S3.SS4.p6.4.m4.1.1.1.1.1.cmml">
           ⁡
          </mo>
          <msup id="S3.SS4.p6.4.m4.1.1.1.1.1.2" xref="S3.SS4.p6.4.m4.1.1.1.1.1.2.cmml">
           <mi id="S3.SS4.p6.4.m4.1.1.1.1.1.2.2" xref="S3.SS4.p6.4.m4.1.1.1.1.1.2.2.cmml">
            N
           </mi>
           <mo id="S3.SS4.p6.4.m4.1.1.1.1.1.2.3" xref="S3.SS4.p6.4.m4.1.1.1.1.1.2.3.cmml">
            ′
           </mo>
          </msup>
         </mrow>
         <mo id="S3.SS4.p6.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS4.p6.4.m4.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p6.4.m4.1b">
        <apply id="S3.SS4.p6.4.m4.1.1.cmml" xref="S3.SS4.p6.4.m4.1.1">
         <times id="S3.SS4.p6.4.m4.1.1.2.cmml" xref="S3.SS4.p6.4.m4.1.1.2">
         </times>
         <ci id="S3.SS4.p6.4.m4.1.1.3.cmml" xref="S3.SS4.p6.4.m4.1.1.3">
          𝑂
         </ci>
         <apply id="S3.SS4.p6.4.m4.1.1.1.1.1.cmml" xref="S3.SS4.p6.4.m4.1.1.1.1">
          <log id="S3.SS4.p6.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.p6.4.m4.1.1.1.1.1.1">
          </log>
          <apply id="S3.SS4.p6.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS4.p6.4.m4.1.1.1.1.1.2">
           <csymbol cd="ambiguous" id="S3.SS4.p6.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p6.4.m4.1.1.1.1.1.2">
            superscript
           </csymbol>
           <ci id="S3.SS4.p6.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p6.4.m4.1.1.1.1.1.2.2">
            𝑁
           </ci>
           <ci id="S3.SS4.p6.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p6.4.m4.1.1.1.1.1.2.3">
            ′
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p6.4.m4.1c">
        O(\log N^{\prime})
       </annotation>
      </semantics>
     </math>
     , which is marginally faster than the
     <span class="ltx_text ltx_font_typewriter" id="S3.SS4.p6.4.1">
      M-RAG
     </span>
     setup.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS4.p7">
    <p class="ltx_p" id="S3.SS4.p7.4">
     For (3), the complexity of Agent-R is roughly
     <math alttext="O(C\cdot E^{2})" class="ltx_Math" display="inline" id="S3.SS4.p7.1.m1.1">
      <semantics id="S3.SS4.p7.1.m1.1a">
       <mrow id="S3.SS4.p7.1.m1.1.1" xref="S3.SS4.p7.1.m1.1.1.cmml">
        <mi id="S3.SS4.p7.1.m1.1.1.3" xref="S3.SS4.p7.1.m1.1.1.3.cmml">
         O
        </mi>
        <mo id="S3.SS4.p7.1.m1.1.1.2" lspace="0em" rspace="0em" xref="S3.SS4.p7.1.m1.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS4.p7.1.m1.1.1.1.1" xref="S3.SS4.p7.1.m1.1.1.1.1.1.cmml">
         <mo id="S3.SS4.p7.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p7.1.m1.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S3.SS4.p7.1.m1.1.1.1.1.1" xref="S3.SS4.p7.1.m1.1.1.1.1.1.cmml">
          <mi id="S3.SS4.p7.1.m1.1.1.1.1.1.2" xref="S3.SS4.p7.1.m1.1.1.1.1.1.2.cmml">
           C
          </mi>
          <mo id="S3.SS4.p7.1.m1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p7.1.m1.1.1.1.1.1.1.cmml">
           ⋅
          </mo>
          <msup id="S3.SS4.p7.1.m1.1.1.1.1.1.3" xref="S3.SS4.p7.1.m1.1.1.1.1.1.3.cmml">
           <mi id="S3.SS4.p7.1.m1.1.1.1.1.1.3.2" xref="S3.SS4.p7.1.m1.1.1.1.1.1.3.2.cmml">
            E
           </mi>
           <mn id="S3.SS4.p7.1.m1.1.1.1.1.1.3.3" xref="S3.SS4.p7.1.m1.1.1.1.1.1.3.3.cmml">
            2
           </mn>
          </msup>
         </mrow>
         <mo id="S3.SS4.p7.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p7.1.m1.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p7.1.m1.1b">
        <apply id="S3.SS4.p7.1.m1.1.1.cmml" xref="S3.SS4.p7.1.m1.1.1">
         <times id="S3.SS4.p7.1.m1.1.1.2.cmml" xref="S3.SS4.p7.1.m1.1.1.2">
         </times>
         <ci id="S3.SS4.p7.1.m1.1.1.3.cmml" xref="S3.SS4.p7.1.m1.1.1.3">
          𝑂
         </ci>
         <apply id="S3.SS4.p7.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.p7.1.m1.1.1.1.1">
          <ci id="S3.SS4.p7.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p7.1.m1.1.1.1.1.1.1">
           ⋅
          </ci>
          <ci id="S3.SS4.p7.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.p7.1.m1.1.1.1.1.1.2">
           𝐶
          </ci>
          <apply id="S3.SS4.p7.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.p7.1.m1.1.1.1.1.1.3">
           <csymbol cd="ambiguous" id="S3.SS4.p7.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p7.1.m1.1.1.1.1.1.3">
            superscript
           </csymbol>
           <ci id="S3.SS4.p7.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p7.1.m1.1.1.1.1.1.3.2">
            𝐸
           </ci>
           <cn id="S3.SS4.p7.1.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS4.p7.1.m1.1.1.1.1.1.3.3">
            2
           </cn>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p7.1.m1.1c">
        O(C\cdot E^{2})
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="E" class="ltx_Math" display="inline" id="S3.SS4.p7.2.m2.1">
      <semantics id="S3.SS4.p7.2.m2.1a">
       <mi id="S3.SS4.p7.2.m2.1.1" xref="S3.SS4.p7.2.m2.1.1.cmml">
        E
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p7.2.m2.1b">
        <ci id="S3.SS4.p7.2.m2.1.1.cmml" xref="S3.SS4.p7.2.m2.1.1">
         𝐸
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p7.2.m2.1c">
        E
       </annotation>
      </semantics>
     </math>
     tokens are generated via a LLM based on the transformer attention mechanism, and
     <math alttext="C" class="ltx_Math" display="inline" id="S3.SS4.p7.3.m3.1">
      <semantics id="S3.SS4.p7.3.m3.1a">
       <mi id="S3.SS4.p7.3.m3.1.1" xref="S3.SS4.p7.3.m3.1.1.cmml">
        C
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p7.3.m3.1b">
        <ci id="S3.SS4.p7.3.m3.1.1.cmml" xref="S3.SS4.p7.3.m3.1.1">
         𝐶
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p7.3.m3.1c">
        C
       </annotation>
      </semantics>
     </math>
     represents the number of its MDP iterations. This component predominantly influences the overall training complexity. In contrast, for a Naive RAG setup, it runs only once during the inference procedure to produce the generation outcomes, with a complexity of approximately
     <math alttext="O(E^{2})" class="ltx_Math" display="inline" id="S3.SS4.p7.4.m4.1">
      <semantics id="S3.SS4.p7.4.m4.1a">
       <mrow id="S3.SS4.p7.4.m4.1.1" xref="S3.SS4.p7.4.m4.1.1.cmml">
        <mi id="S3.SS4.p7.4.m4.1.1.3" xref="S3.SS4.p7.4.m4.1.1.3.cmml">
         O
        </mi>
        <mo id="S3.SS4.p7.4.m4.1.1.2" lspace="0em" rspace="0em" xref="S3.SS4.p7.4.m4.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS4.p7.4.m4.1.1.1.1" xref="S3.SS4.p7.4.m4.1.1.1.1.1.cmml">
         <mo id="S3.SS4.p7.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS4.p7.4.m4.1.1.1.1.1.cmml">
          (
         </mo>
         <msup id="S3.SS4.p7.4.m4.1.1.1.1.1" xref="S3.SS4.p7.4.m4.1.1.1.1.1.cmml">
          <mi id="S3.SS4.p7.4.m4.1.1.1.1.1.2" xref="S3.SS4.p7.4.m4.1.1.1.1.1.2.cmml">
           E
          </mi>
          <mn id="S3.SS4.p7.4.m4.1.1.1.1.1.3" xref="S3.SS4.p7.4.m4.1.1.1.1.1.3.cmml">
           2
          </mn>
         </msup>
         <mo id="S3.SS4.p7.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS4.p7.4.m4.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS4.p7.4.m4.1b">
        <apply id="S3.SS4.p7.4.m4.1.1.cmml" xref="S3.SS4.p7.4.m4.1.1">
         <times id="S3.SS4.p7.4.m4.1.1.2.cmml" xref="S3.SS4.p7.4.m4.1.1.2">
         </times>
         <ci id="S3.SS4.p7.4.m4.1.1.3.cmml" xref="S3.SS4.p7.4.m4.1.1.3">
          𝑂
         </ci>
         <apply id="S3.SS4.p7.4.m4.1.1.1.1.1.cmml" xref="S3.SS4.p7.4.m4.1.1.1.1">
          <csymbol cd="ambiguous" id="S3.SS4.p7.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.p7.4.m4.1.1.1.1">
           superscript
          </csymbol>
          <ci id="S3.SS4.p7.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS4.p7.4.m4.1.1.1.1.1.2">
           𝐸
          </ci>
          <cn id="S3.SS4.p7.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.p7.4.m4.1.1.1.1.1.3">
           2
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS4.p7.4.m4.1c">
        O(E^{2})
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   Experiments
  </h2>
  <section class="ltx_subsection" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    Experimental Setup
   </h3>
   <div class="ltx_para ltx_noindent" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.4">
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.4.1">
      Datasets.
     </span>
     By following
     <cite class="ltx_cite ltx_citemacro_cite">
      Cheng et al. (
      <a class="ltx_ref" href="#bib.bib8" title="">
       2023b
      </a>
      )
     </cite>
     , we conduct experiments on seven datasets for three generation tasks: (1) text summarization (XSum
     <cite class="ltx_cite ltx_citemacro_citep">
      Narayan et al.,
      <a class="ltx_ref" href="#bib.bib40" title="">
       2018
      </a>
     </cite>
     and BigPatent
     <cite class="ltx_cite ltx_citemacro_citep">
      Sharma et al.,
      <a class="ltx_ref" href="#bib.bib45" title="">
       2019
      </a>
     </cite>
     ), (2) machine translation (JRC-Acquis
     <cite class="ltx_cite ltx_citemacro_citep">
      Steinberger et al.,
      <a class="ltx_ref" href="#bib.bib47" title="">
       2006
      </a>
     </cite>
     with Es
     <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1">
      <semantics id="S4.SS1.p1.1.m1.1a">
       <mo id="S4.SS1.p1.1.m1.1.1" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.cmml">
        →
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b">
        <ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">
         →
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">
        \rightarrow
       </annotation>
      </semantics>
     </math>
     En, En
     <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1">
      <semantics id="S4.SS1.p1.2.m2.1a">
       <mo id="S4.SS1.p1.2.m2.1.1" stretchy="false" xref="S4.SS1.p1.2.m2.1.1.cmml">
        →
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b">
        <ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">
         →
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">
        \rightarrow
       </annotation>
      </semantics>
     </math>
     Es, De
     <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1">
      <semantics id="S4.SS1.p1.3.m3.1a">
       <mo id="S4.SS1.p1.3.m3.1.1" stretchy="false" xref="S4.SS1.p1.3.m3.1.1.cmml">
        →
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b">
        <ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">
         →
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">
        \rightarrow
       </annotation>
      </semantics>
     </math>
     En, and En
     <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1">
      <semantics id="S4.SS1.p1.4.m4.1a">
       <mo id="S4.SS1.p1.4.m4.1.1" stretchy="false" xref="S4.SS1.p1.4.m4.1.1.cmml">
        →
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b">
        <ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">
         →
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">
        \rightarrow
       </annotation>
      </semantics>
     </math>
     De), and (3) dialogue generation (DailyDialog
     <cite class="ltx_cite ltx_citemacro_citep">
      Li et al.,
      <a class="ltx_ref" href="#bib.bib30" title="">
       2017
      </a>
     </cite>
     ). Specifically, XSum comprises single-document summaries for highly abstractive articles sourced from BBC news. BigPatent comprises 1.3 million records of U.S. patent documents accompanied by human-written abstractive summaries. JRC-Acquis serves as a collection of parallel legislative texts of European Union Law, commonly employed as a benchmark in machine translation tasks. DailyDialog comprises multi-turn dialogues centered around daily life topics. The detailed statistics for these datasets are available in
     <cite class="ltx_cite ltx_citemacro_cite">
      Cheng et al. (
      <a class="ltx_ref" href="#bib.bib8" title="">
       2023b
      </a>
      )
     </cite>
     .
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS1.p2">
    <p class="ltx_p" id="S4.SS1.p2.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">
      Baselines.
     </span>
     We carefully review the literature including a recent survey paper
     <cite class="ltx_cite ltx_citemacro_cite">
      Gao et al. (
      <a class="ltx_ref" href="#bib.bib11" title="">
       2023
      </a>
      )
     </cite>
     , and identify the following RAGs, namely Naive RAG
     <cite class="ltx_cite ltx_citemacro_cite">
      Ma et al. (
      <a class="ltx_ref" href="#bib.bib34" title="">
       2023
      </a>
      )
     </cite>
     , Self-RAG
     <cite class="ltx_cite ltx_citemacro_cite">
      Asai et al. (
      <a class="ltx_ref" href="#bib.bib3" title="">
       2023
      </a>
      )
     </cite>
     , and Selfmem
     <cite class="ltx_cite ltx_citemacro_cite">
      Cheng et al. (
      <a class="ltx_ref" href="#bib.bib8" title="">
       2023b
      </a>
      )
     </cite>
     , which correspond to three kinds of RAG techniques as described in Section
     <a class="ltx_ref" href="#S2" title="2 Related Work ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     . In addition, we incorporate the RAGs into three typical language model architectures, namely Mixtral 8
     <math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1">
      <semantics id="S4.SS1.p2.1.m1.1a">
       <mo id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">
        ×
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b">
        <times id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">
        </times>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">
        \times
       </annotation>
      </semantics>
     </math>
     7B
     <cite class="ltx_cite ltx_citemacro_cite">
      Jiang et al. (
      <a class="ltx_ref" href="#bib.bib21" title="">
       2024
      </a>
      )
     </cite>
     , Llama 2 13B
     <cite class="ltx_cite ltx_citemacro_cite">
      Touvron et al. (
      <a class="ltx_ref" href="#bib.bib48" title="">
       2023
      </a>
      )
     </cite>
     , Phi-2 2.7B
     <cite class="ltx_cite ltx_citemacro_cite">
      Abdin et al. (
      <a class="ltx_ref" href="#bib.bib1" title="">
       2023
      </a>
      )
     </cite>
     , Gemma 7B
     <cite class="ltx_cite ltx_citemacro_cite">
      Mesnard et al. (
      <a class="ltx_ref" href="#bib.bib37" title="">
       2024
      </a>
      )
     </cite>
     , and Mistral 7B
     <cite class="ltx_cite ltx_citemacro_cite">
      Jiang et al. (
      <a class="ltx_ref" href="#bib.bib20" title="">
       2023a
      </a>
      )
     </cite>
     for the evaluation.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS1.p3">
    <p class="ltx_p" id="S4.SS1.p3.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">
      Evaluation Metrics.
     </span>
     We evaluate the effectiveness of
     <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p3.1.2">
      M-RAG
     </span>
     in terms of the three generation tasks by following
     <cite class="ltx_cite ltx_citemacro_cite">
      Cheng et al. (
      <a class="ltx_ref" href="#bib.bib8" title="">
       2023b
      </a>
      )
     </cite>
     . (1) For summarization, ROUGE (R-1/2/L)
     <cite class="ltx_cite ltx_citemacro_cite">
      Lin (
      <a class="ltx_ref" href="#bib.bib31" title="">
       2004
      </a>
      )
     </cite>
     is used. (2) For machine translation, BLEU
     <cite class="ltx_cite ltx_citemacro_cite">
      Post (
      <a class="ltx_ref" href="#bib.bib44" title="">
       2018
      </a>
      )
     </cite>
     is used. (3) For dialogue generation, BLEU (B-1/2) and Distinct (D-1/2)
     <cite class="ltx_cite ltx_citemacro_cite">
      Li et al. (
      <a class="ltx_ref" href="#bib.bib28" title="">
       2016
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib27" title="">
       2021
      </a>
      )
     </cite>
     are used. Overall, a higher evaluation metric (i.e., ROUGE, BLEU, Distinct) indicates a better result. We remark that all results are statistically significant, as confirmed by a t-test with
     <math alttext="p&lt;0.05" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1">
      <semantics id="S4.SS1.p3.1.m1.1a">
       <mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">
        <mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">
         p
        </mi>
        <mo id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.cmml">
         &lt;
        </mo>
        <mn id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">
         0.05
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b">
        <apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">
         <lt id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1">
         </lt>
         <ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">
          𝑝
         </ci>
         <cn id="S4.SS1.p3.1.m1.1.1.3.cmml" type="float" xref="S4.SS1.p3.1.m1.1.1.3">
          0.05
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">
        p&lt;0.05
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS1.p4">
    <p class="ltx_p" id="S4.SS1.p4.5">
     <span class="ltx_text ltx_font_bold" id="S4.SS1.p4.5.1">
      Implementation Details.
     </span>
     We implement
     <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p4.5.2">
      M-RAG
     </span>
     and adapt other baselines using Python 3.7 and LlamaIndex. The database partitioning strategies for Randomization
     <span class="ltx_note ltx_role_footnote" id="footnote1">
      <sup class="ltx_note_mark">
       1
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         1
        </sup>
        <span class="ltx_tag ltx_tag_note">
         1
        </span>
        https://pypi.org/project/graph-partition/
       </span>
      </span>
     </span>
     and Indexing
     <span class="ltx_note ltx_role_footnote" id="footnote2">
      <sup class="ltx_note_mark">
       2
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         2
        </sup>
        <span class="ltx_tag ltx_tag_note">
         2
        </span>
        https://pypi.org/project/LocalitySensitiveHashing/
       </span>
      </span>
     </span>
     utilize existing libraries. The Agent-S (resp. Agent-R) is instantiated through a two-layered feedforward neural network. The first layer consists of 25 neurons using the tanh activation function, and the second layer comprises
     <math alttext="M" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1">
      <semantics id="S4.SS1.p4.1.m1.1a">
       <mi id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">
        M
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b">
        <ci id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">
         𝑀
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">
        M
       </annotation>
      </semantics>
     </math>
     (resp.
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1">
      <semantics id="S4.SS1.p4.2.m2.1a">
       <mi id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b">
        <ci id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">
        K
       </annotation>
      </semantics>
     </math>
     ) neurons corresponding to the action space with a linear activation function. The hyperparameters
     <math alttext="M" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1">
      <semantics id="S4.SS1.p4.3.m3.1a">
       <mi id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml">
        M
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b">
        <ci id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">
         𝑀
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">
        M
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m4.1">
      <semantics id="S4.SS1.p4.4.m4.1a">
       <mi id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b">
        <ci id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">
        K
       </annotation>
      </semantics>
     </math>
     are empirically set to 4 and 3, respectively. Some of the built-in RL codes can be found in the GitHub repositories referenced in
     <cite class="ltx_cite ltx_citemacro_cite">
      Wang et al. (
      <a class="ltx_ref" href="#bib.bib52" title="">
       2023b
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib53" title="">
       2021
      </a>
      )
     </cite>
     . During training, we randomly sample 10% of text pairs from the training set, while the remaining data is utilized for constructing the database with multiple partitions. The MDP iterations are determined by performance evaluation on a validation set. Evaluation metrics, such as ROUGE, BLEU, and Distinct, are obtained from
     <cite class="ltx_cite ltx_citemacro_cite">
      Cheng et al. (
      <a class="ltx_ref" href="#bib.bib8" title="">
       2023b
      </a>
      )
     </cite>
     . The language models with 4-bit quantization, including Mixtral 8
     <math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p4.5.m5.1">
      <semantics id="S4.SS1.p4.5.m5.1a">
       <mo id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml">
        ×
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b">
        <times id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1">
        </times>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">
        \times
       </annotation>
      </semantics>
     </math>
     7B, Llama 2 13B, Phi-2 2.7B, Gemma 7B, and Mistral 7B, are available for download via the link
     <span class="ltx_note ltx_role_footnote" id="footnote3">
      <sup class="ltx_note_mark">
       3
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         3
        </sup>
        <span class="ltx_tag ltx_tag_note">
         3
        </span>
        https://huggingface.co/TheBloke
       </span>
      </span>
     </span>
     . To boost training efficiency, we cache the QA pairs generated by the LLMs during training.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.2
    </span>
    Experimental Results
   </h3>
   <figure class="ltx_table" id="S4.T1">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 1:
     </span>
     Text summarization.
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.5">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S4.T1.5.6.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.5.6.1.1" rowspan="2">
        <span class="ltx_text" id="S4.T1.5.6.1.1.1">
         LLM
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.5.6.1.2" rowspan="2">
        <span class="ltx_text" id="S4.T1.5.6.1.2.1">
         RAG
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.T1.5.6.1.3">
        XSum
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S4.T1.5.6.1.4">
        BigPatent
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T1.5.7.2">
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.7.2.1">
        R-1
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.7.2.2">
        R-2
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.7.2.3">
        R-L
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.7.2.4">
        R-1
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.7.2.5">
        R-2
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.7.2.6">
        R-L
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T1.1.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.1.1.1">
        Mixtral 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T1.1.1.1.m1.1">
         <semantics id="S4.T1.1.1.1.m1.1a">
          <mo id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b">
           <times id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.1.1.2">
        None
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3">
        25.40
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.4">
        6.39
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.5">
        18.30
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.6">
        47.41
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.7">
        16.63
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.8">
        25.14
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T1.2.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.2.2.1">
        Mixtral 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T1.2.2.1.m1.1">
         <semantics id="S4.T1.2.2.1.m1.1a">
          <mo id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b">
           <times id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.2.2.2">
        Naive
       </th>
       <td class="ltx_td ltx_align_center" id="S4.T1.2.2.3">
        43.82
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.2.2.4">
        22.07
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.5">
        37.44
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.2.2.6">
        60.11
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.2.2.7">
        38.33
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.2.2.8">
        43.44
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T1.3.3">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.3.3.1">
        Mixtral 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T1.3.3.1.m1.1">
         <semantics id="S4.T1.3.3.1.m1.1a">
          <mo id="S4.T1.3.3.1.m1.1.1" xref="S4.T1.3.3.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b">
           <times id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.3.3.2">
        Selfmem
       </th>
       <td class="ltx_td ltx_align_center" id="S4.T1.3.3.3">
        44.67
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.3.3.4">
        22.38
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.3.5">
        37.86
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.3.3.6">
        64.12
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.3.3.7">
        39.21
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.3.3.8">
        46.21
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T1.4.4">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.4.1">
        Mixtral 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T1.4.4.1.m1.1">
         <semantics id="S4.T1.4.4.1.m1.1a">
          <mo id="S4.T1.4.4.1.m1.1.1" xref="S4.T1.4.4.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T1.4.4.1.m1.1b">
           <times id="S4.T1.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T1.4.4.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.4.2">
        Self-RAG
       </th>
       <td class="ltx_td ltx_align_center" id="S4.T1.4.4.3">
        44.01
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.4.4.4">
        22.26
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.4.5">
        37.51
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.4.4.6">
        63.59
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.4.4.7">
        38.65
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.4.4.8">
        45.25
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T1.5.5">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.5.5.1">
        Mixtral 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T1.5.5.1.m1.1">
         <semantics id="S4.T1.5.5.1.m1.1a">
          <mo id="S4.T1.5.5.1.m1.1.1" xref="S4.T1.5.5.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T1.5.5.1.m1.1b">
           <times id="S4.T1.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T1.5.5.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.5.5.2">
        <span class="ltx_text ltx_font_typewriter" id="S4.T1.5.5.2.1">
         M-RAG
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.3">
        <span class="ltx_text ltx_font_bold" id="S4.T1.5.5.3.1">
         48.13
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.4">
        <span class="ltx_text ltx_font_bold" id="S4.T1.5.5.4.1">
         24.66
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.5.5.5">
        <span class="ltx_text ltx_font_bold" id="S4.T1.5.5.5.1">
         39.43
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.6">
        <span class="ltx_text ltx_font_bold" id="S4.T1.5.5.6.1">
         71.34
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.7">
        <span class="ltx_text ltx_font_bold" id="S4.T1.5.5.7.1">
         42.24
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.5.5.8">
        <span class="ltx_text ltx_font_bold" id="S4.T1.5.5.8.1">
         47.22
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T1.5.8.3">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.8.3.1">
        Llama 2 13B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.5.8.3.2">
        <span class="ltx_text ltx_font_typewriter" id="S4.T1.5.8.3.2.1">
         M-RAG
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S4.T1.5.8.3.3">
        37.18
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.5.8.3.4">
        18.02
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.8.3.5">
        26.44
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.5.8.3.6">
        60.31
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.5.8.3.7">
        37.33
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T1.5.8.3.8">
        33.47
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T1.5.9.4">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T1.5.9.4.1">
        Phi-2 2.7B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T1.5.9.4.2">
        <span class="ltx_text ltx_font_typewriter" id="S4.T1.5.9.4.2.1">
         M-RAG
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.5.9.4.3">
        30.70
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.5.9.4.4">
        11.57
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T1.5.9.4.5">
        26.20
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.5.9.4.6">
        31.25
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.5.9.4.7">
        14.72
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T1.5.9.4.8">
        18.98
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <figure class="ltx_table" id="S4.T2">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 2:
     </span>
     Machine translation.
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.9">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S4.T2.4.4">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.4.5" rowspan="2">
        <span class="ltx_text" id="S4.T2.4.4.5.1">
         LLM
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.4.6" rowspan="2">
        <span class="ltx_text" id="S4.T2.4.4.6.1">
         RAG
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S4.T2.1.1.1">
        Es
        <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1">
         <semantics id="S4.T2.1.1.1.m1.1a">
          <mo id="S4.T2.1.1.1.m1.1.1" stretchy="false" xref="S4.T2.1.1.1.m1.1.1.cmml">
           →
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b">
           <ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">
            →
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">
           \rightarrow
          </annotation>
         </semantics>
        </math>
        En
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S4.T2.2.2.2">
        En
        <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.2.2.2.m1.1">
         <semantics id="S4.T2.2.2.2.m1.1a">
          <mo id="S4.T2.2.2.2.m1.1.1" stretchy="false" xref="S4.T2.2.2.2.m1.1.1.cmml">
           →
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m1.1b">
           <ci id="S4.T2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1">
            →
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.2.2.2.m1.1c">
           \rightarrow
          </annotation>
         </semantics>
        </math>
        Es
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S4.T2.3.3.3">
        De
        <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.3.3.3.m1.1">
         <semantics id="S4.T2.3.3.3.m1.1a">
          <mo id="S4.T2.3.3.3.m1.1.1" stretchy="false" xref="S4.T2.3.3.3.m1.1.1.cmml">
           →
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.m1.1b">
           <ci id="S4.T2.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.m1.1.1">
            →
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.3.3.3.m1.1c">
           \rightarrow
          </annotation>
         </semantics>
        </math>
        En
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T2.4.4.4">
        En
        <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T2.4.4.4.m1.1">
         <semantics id="S4.T2.4.4.4.m1.1a">
          <mo id="S4.T2.4.4.4.m1.1.1" stretchy="false" xref="S4.T2.4.4.4.m1.1.1.cmml">
           →
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.m1.1b">
           <ci id="S4.T2.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.m1.1.1">
            →
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.4.4.4.m1.1c">
           \rightarrow
          </annotation>
         </semantics>
        </math>
        De
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T2.9.10.1">
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.10.1.1">
        Dev
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.9.10.1.2">
        Test
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.10.1.3">
        Dev
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.9.10.1.4">
        Test
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.10.1.5">
        Dev
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.9.10.1.6">
        Test
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.10.1.7">
        Dev
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.10.1.8">
        Test
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T2.5.5">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.5.5.1">
        Mixtral 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T2.5.5.1.m1.1">
         <semantics id="S4.T2.5.5.1.m1.1a">
          <mo id="S4.T2.5.5.1.m1.1.1" xref="S4.T2.5.5.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.5.5.1.m1.1b">
           <times id="S4.T2.5.5.1.m1.1.1.cmml" xref="S4.T2.5.5.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.5.5.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.5.5.2">
        None
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.5.3">
        34.34
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.5.4">
        34.81
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.5.5">
        32.60
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.5.6">
        28.32
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.5.7">
        43.75
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.5.5.8">
        44.09
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.5.9">
        43.78
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.5.10">
        42.24
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T2.6.6">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.6.6.1">
        Mixtral 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T2.6.6.1.m1.1">
         <semantics id="S4.T2.6.6.1.m1.1a">
          <mo id="S4.T2.6.6.1.m1.1.1" xref="S4.T2.6.6.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.6.6.1.m1.1b">
           <times id="S4.T2.6.6.1.m1.1.1.cmml" xref="S4.T2.6.6.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.6.6.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.6.6.2">
        Naive
       </th>
       <td class="ltx_td ltx_align_center" id="S4.T2.6.6.3">
        36.64
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.6.6.4">
        36.22
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.6.6.5">
        33.18
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.6.6.6">
        30.70
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.6.6.7">
        47.84
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.6.6.8">
        46.77
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.6.6.9">
        45.83
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.6.6.10">
        44.23
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T2.7.7">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.7.1">
        Mixtral 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T2.7.7.1.m1.1">
         <semantics id="S4.T2.7.7.1.m1.1a">
          <mo id="S4.T2.7.7.1.m1.1.1" xref="S4.T2.7.7.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.7.7.1.m1.1b">
           <times id="S4.T2.7.7.1.m1.1.1.cmml" xref="S4.T2.7.7.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.7.7.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.7.7.2">
        Selfmem
       </th>
       <td class="ltx_td ltx_align_center" id="S4.T2.7.7.3">
        37.65
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.7.4">
        37.11
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.7.7.5">
        34.12
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.7.6">
        31.86
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.7.7.7">
        48.08
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.7.7.8">
        47.31
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.7.7.9">
        51.38
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.7.7.10">
        49.81
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T2.8.8">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.8.8.1">
        Mixtral 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T2.8.8.1.m1.1">
         <semantics id="S4.T2.8.8.1.m1.1a">
          <mo id="S4.T2.8.8.1.m1.1.1" xref="S4.T2.8.8.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.8.8.1.m1.1b">
           <times id="S4.T2.8.8.1.m1.1.1.cmml" xref="S4.T2.8.8.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.8.8.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.8.8.2">
        Self-RAG
       </th>
       <td class="ltx_td ltx_align_center" id="S4.T2.8.8.3">
        37.17
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.8.8.4">
        36.82
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.8.8.5">
        33.80
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.8.8.6">
        31.61
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.8.8.7">
        47.99
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.8.8.8">
        47.27
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.8.8.9">
        50.10
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.8.8.10">
        48.75
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T2.9.9">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.9.9.1">
        Mixtral 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T2.9.9.1.m1.1">
         <semantics id="S4.T2.9.9.1.m1.1a">
          <mo id="S4.T2.9.9.1.m1.1.1" xref="S4.T2.9.9.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T2.9.9.1.m1.1b">
           <times id="S4.T2.9.9.1.m1.1.1.cmml" xref="S4.T2.9.9.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T2.9.9.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.9.9.2">
        <span class="ltx_text ltx_font_typewriter" id="S4.T2.9.9.2.1">
         M-RAG
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.9.3">
        <span class="ltx_text ltx_font_bold" id="S4.T2.9.9.3.1">
         39.11
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.9.9.4">
        <span class="ltx_text ltx_font_bold" id="S4.T2.9.9.4.1">
         39.98
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.9.5">
        <span class="ltx_text ltx_font_bold" id="S4.T2.9.9.5.1">
         35.18
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.9.9.6">
        <span class="ltx_text ltx_font_bold" id="S4.T2.9.9.6.1">
         32.70
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.9.7">
        <span class="ltx_text ltx_font_bold" id="S4.T2.9.9.7.1">
         49.16
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T2.9.9.8">
        <span class="ltx_text ltx_font_bold" id="S4.T2.9.9.8.1">
         48.15
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.9.9">
        <span class="ltx_text ltx_font_bold" id="S4.T2.9.9.9.1">
         53.76
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.9.10">
        <span class="ltx_text ltx_font_bold" id="S4.T2.9.9.10.1">
         50.75
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T2.9.11.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T2.9.11.2.1">
        Llama 2 13B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.9.11.2.2">
        <span class="ltx_text ltx_font_typewriter" id="S4.T2.9.11.2.2.1">
         M-RAG
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S4.T2.9.11.2.3">
        30.41
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.9.11.2.4">
        30.03
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.9.11.2.5">
        26.40
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.9.11.2.6">
        22.03
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.9.11.2.7">
        41.10
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T2.9.11.2.8">
        42.22
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.9.11.2.9">
        45.98
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T2.9.11.2.10">
        42.58
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T2.9.12.3">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T2.9.12.3.1">
        Phi-2 2.7B
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T2.9.12.3.2">
        <span class="ltx_text ltx_font_typewriter" id="S4.T2.9.12.3.2.1">
         M-RAG
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.9.12.3.3">
        22.83
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T2.9.12.3.4">
        24.22
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.9.12.3.5">
        17.64
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T2.9.12.3.6">
        16.60
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.9.12.3.7">
        34.21
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T2.9.12.3.8">
        34.71
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.9.12.3.9">
        40.01
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T2.9.12.3.10">
        37.08
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p1">
    <p class="ltx_p" id="S4.SS2.p1.2">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.2.1">
      (1) Effectiveness evaluation (partitioning strategies).
     </span>
     We conduct experiments to evaluate various partitioning strategies across text summarization (XSum), machine translation (Es
     <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1">
      <semantics id="S4.SS2.p1.1.m1.1a">
       <mo id="S4.SS2.p1.1.m1.1.1" stretchy="false" xref="S4.SS2.p1.1.m1.1.1.cmml">
        →
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b">
        <ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">
         →
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">
        \rightarrow
       </annotation>
      </semantics>
     </math>
     En), and dialogue generation (DailyDialog) tasks with Mixtral 8
     <math alttext="\times" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1">
      <semantics id="S4.SS2.p1.2.m2.1a">
       <mo id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">
        ×
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b">
        <times id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">
        </times>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">
        \times
       </annotation>
      </semantics>
     </math>
     7B. The best results, based on a development set across different partitions, are reported. As shown in Figure
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     , we observe that retrieval based on the entire database generally fails to achieve optimal performance. Moreover, the performance slightly decreases as the number of partitions increases. This is attributed to the AKNN search, where a smaller partition size recalls more similar memories, which may not align well with the LLM preferences and impede the focus on crucial memories. Additionally, we observe that the RAG with Top-1 retrieval exhibits faster runtime compared to the Top-3 due to a shorter input length for the LLM, while maintaining comparable performance.
    </p>
   </div>
   <figure class="ltx_table" id="S4.T3">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 3:
     </span>
     Dialogue generation.
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.6">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S4.T3.6.7.1">
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.6.7.1.1" rowspan="2" style="padding-left:1.8pt;padding-right:1.8pt;">
        <span class="ltx_text" id="S4.T3.6.7.1.1.1">
         LLM
        </span>
       </th>
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.6.7.1.2" rowspan="2" style="padding-left:1.8pt;padding-right:1.8pt;">
        <span class="ltx_text" id="S4.T3.6.7.1.2.1">
         RAG
        </span>
       </th>
       <td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" colspan="4" id="S4.T3.6.7.1.3" style="padding-left:1.8pt;padding-right:1.8pt;">
        DailyDialog
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T3.6.8.2">
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.6.8.2.1" style="padding-left:1.8pt;padding-right:1.8pt;">
        B-1
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.6.8.2.2" style="padding-left:1.8pt;padding-right:1.8pt;">
        B-2
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.6.8.2.3" style="padding-left:1.8pt;padding-right:1.8pt;">
        D-1
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.6.8.2.4" style="padding-left:1.8pt;padding-right:1.8pt;">
        D-2
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T3.1.1">
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.1" style="padding-left:1.8pt;padding-right:1.8pt;">
        Mix. 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.1.1.1.m1.1">
         <semantics id="S4.T3.1.1.1.m1.1a">
          <mo id="S4.T3.1.1.1.m1.1.1" xref="S4.T3.1.1.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.m1.1b">
           <times id="S4.T3.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T3.1.1.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.2" style="padding-left:1.8pt;padding-right:1.8pt;">
        None
       </th>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.1.1.3" style="padding-left:1.8pt;padding-right:1.8pt;">
        15.52
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.1.1.4" style="padding-left:1.8pt;padding-right:1.8pt;">
        7.05
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.1.1.5" style="padding-left:1.8pt;padding-right:1.8pt;">
        61.49
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.1.1.6" style="padding-left:1.8pt;padding-right:1.8pt;">
        89.51
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T3.2.2">
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.2.2.1" style="padding-left:1.8pt;padding-right:1.8pt;">
        Mix. 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.2.2.1.m1.1">
         <semantics id="S4.T3.2.2.1.m1.1a">
          <mo id="S4.T3.2.2.1.m1.1.1" xref="S4.T3.2.2.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T3.2.2.1.m1.1b">
           <times id="S4.T3.2.2.1.m1.1.1.cmml" xref="S4.T3.2.2.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T3.2.2.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.2.2.2" style="padding-left:1.8pt;padding-right:1.8pt;">
        Naive
       </th>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.2.2.3" style="padding-left:1.8pt;padding-right:1.8pt;">
        37.44
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.2.2.4" style="padding-left:1.8pt;padding-right:1.8pt;">
        29.16
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.2.2.5" style="padding-left:1.8pt;padding-right:1.8pt;">
        89.42
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.2.2.6" style="padding-left:1.8pt;padding-right:1.8pt;">
        92.55
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T3.3.3">
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.1" style="padding-left:1.8pt;padding-right:1.8pt;">
        Mix. 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.3.3.1.m1.1">
         <semantics id="S4.T3.3.3.1.m1.1a">
          <mo id="S4.T3.3.3.1.m1.1.1" xref="S4.T3.3.3.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T3.3.3.1.m1.1b">
           <times id="S4.T3.3.3.1.m1.1.1.cmml" xref="S4.T3.3.3.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T3.3.3.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.3.3.2" style="padding-left:1.8pt;padding-right:1.8pt;">
        Selfmem
       </th>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.3.3.3" style="padding-left:1.8pt;padding-right:1.8pt;">
        38.16
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.3.3.4" style="padding-left:1.8pt;padding-right:1.8pt;">
        29.92
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.3.3.5" style="padding-left:1.8pt;padding-right:1.8pt;">
        89.23
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.3.3.6" style="padding-left:1.8pt;padding-right:1.8pt;">
        95.23
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T3.4.4">
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.4.1" style="padding-left:1.8pt;padding-right:1.8pt;">
        Mix. 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.4.4.1.m1.1">
         <semantics id="S4.T3.4.4.1.m1.1a">
          <mo id="S4.T3.4.4.1.m1.1.1" xref="S4.T3.4.4.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T3.4.4.1.m1.1b">
           <times id="S4.T3.4.4.1.m1.1.1.cmml" xref="S4.T3.4.4.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T3.4.4.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.4.2" style="padding-left:1.8pt;padding-right:1.8pt;">
        Self-RAG
       </th>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.4.4.3" style="padding-left:1.8pt;padding-right:1.8pt;">
        37.76
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.4.4.4" style="padding-left:1.8pt;padding-right:1.8pt;">
        29.79
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.4.4.5" style="padding-left:1.8pt;padding-right:1.8pt;">
        88.24
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.4.4.6" style="padding-left:1.8pt;padding-right:1.8pt;">
        95.34
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T3.5.5">
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.5.5.1" style="padding-left:1.8pt;padding-right:1.8pt;">
        Mix. 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.5.5.1.m1.1">
         <semantics id="S4.T3.5.5.1.m1.1a">
          <mo id="S4.T3.5.5.1.m1.1.1" xref="S4.T3.5.5.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T3.5.5.1.m1.1b">
           <times id="S4.T3.5.5.1.m1.1.1.cmml" xref="S4.T3.5.5.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T3.5.5.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.5.5.2" style="padding-left:1.8pt;padding-right:1.8pt;">
        <span class="ltx_text ltx_font_typewriter" id="S4.T3.5.5.2.1">
         M-RAG
        </span>
       </th>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.5.5.3" style="padding-left:1.8pt;padding-right:1.8pt;">
        <span class="ltx_text ltx_font_bold" id="S4.T3.5.5.3.1">
         42.61
        </span>
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.5.5.4" style="padding-left:1.8pt;padding-right:1.8pt;">
        <span class="ltx_text ltx_font_bold" id="S4.T3.5.5.4.1">
         32.97
        </span>
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.5.5.5" style="padding-left:1.8pt;padding-right:1.8pt;">
        88.82
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.5.5.6" style="padding-left:1.8pt;padding-right:1.8pt;">
        95.74
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T3.6.9.3">
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.6.9.3.1" style="padding-left:1.8pt;padding-right:1.8pt;">
        Llama 2 13B
       </th>
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.6.9.3.2" style="padding-left:1.8pt;padding-right:1.8pt;">
        <span class="ltx_text ltx_font_typewriter" id="S4.T3.6.9.3.2.1">
         M-RAG
        </span>
       </th>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.6.9.3.3" style="padding-left:1.8pt;padding-right:1.8pt;">
        31.29
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.6.9.3.4" style="padding-left:1.8pt;padding-right:1.8pt;">
        17.63
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.6.9.3.5" style="padding-left:1.8pt;padding-right:1.8pt;">
        63.19
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.6.9.3.6" style="padding-left:1.8pt;padding-right:1.8pt;">
        88.20
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T3.6.10.4">
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.6.10.4.1" style="padding-left:1.8pt;padding-right:1.8pt;">
        Phi-2 2.7B
       </th>
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.6.10.4.2" style="padding-left:1.8pt;padding-right:1.8pt;">
        <span class="ltx_text ltx_font_typewriter" id="S4.T3.6.10.4.2.1">
         M-RAG
        </span>
       </th>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.6.10.4.3" style="padding-left:1.8pt;padding-right:1.8pt;">
        7.71
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.6.10.4.4" style="padding-left:1.8pt;padding-right:1.8pt;">
        3.93
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.6.10.4.5" style="padding-left:1.8pt;padding-right:1.8pt;">
        44.21
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S4.T3.6.10.4.6" style="padding-left:1.8pt;padding-right:1.8pt;">
        82.86
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T3.6.6">
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.6.6.1" style="padding-left:1.8pt;padding-right:1.8pt;">
        Mix. 8
        <math alttext="\times" class="ltx_Math" display="inline" id="S4.T3.6.6.1.m1.1">
         <semantics id="S4.T3.6.6.1.m1.1a">
          <mo id="S4.T3.6.6.1.m1.1.1" xref="S4.T3.6.6.1.m1.1.1.cmml">
           ×
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T3.6.6.1.m1.1b">
           <times id="S4.T3.6.6.1.m1.1.1.cmml" xref="S4.T3.6.6.1.m1.1.1">
           </times>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T3.6.6.1.m1.1c">
           \times
          </annotation>
         </semantics>
        </math>
        7B
       </th>
       <th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S4.T3.6.6.2" style="padding-left:1.8pt;padding-right:1.8pt;">
        <span class="ltx_text ltx_font_typewriter" id="S4.T3.6.6.2.1">
         M-RAG(D)
        </span>
       </th>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" id="S4.T3.6.6.3" style="padding-left:1.8pt;padding-right:1.8pt;">
        39.14
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" id="S4.T3.6.6.4" style="padding-left:1.8pt;padding-right:1.8pt;">
        30.98
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" id="S4.T3.6.6.5" style="padding-left:1.8pt;padding-right:1.8pt;">
        <span class="ltx_text ltx_font_bold" id="S4.T3.6.6.5.1">
         93.14
        </span>
       </td>
       <td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" id="S4.T3.6.6.6" style="padding-left:1.8pt;padding-right:1.8pt;">
        <span class="ltx_text ltx_font_bold" id="S4.T3.6.6.6.1">
         98.34
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p2">
    <p class="ltx_p" id="S4.SS2.p2.3">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p2.3.1">
      (2) Effectiveness evaluation (text summarization).
     </span>
     We compare the performance of the
     <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p2.3.2">
      M-RAG
     </span>
     against alternative RAG methods on three distinct language models: Mixtral 8
     <math alttext="\times" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1">
      <semantics id="S4.SS2.p2.1.m1.1a">
       <mo id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">
        ×
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b">
        <times id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">
        </times>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">
        \times
       </annotation>
      </semantics>
     </math>
     7B, Llama 2 13B, and Phi-2 2.7B. The corresponding results are outlined in Table
     <a class="ltx_ref" href="#S4.T1" title="Table 1 ‣ 4.2 Experimental Results ‣ 4 Experiments ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     . We observe consistent improvement in language models when utilizing the RAG framework (e.g., Naive) compared to models without RAG (e.g., None). In addition, the recent MoE architecture Mistral 8
     <math alttext="\times" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1">
      <semantics id="S4.SS2.p2.2.m2.1a">
       <mo id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">
        ×
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b">
        <times id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">
        </times>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">
        \times
       </annotation>
      </semantics>
     </math>
     7B generally outperforms the typical Llama 2 13B in the summarization task. Specifically, when considering Mistral 8
     <math alttext="\times" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1">
      <semantics id="S4.SS2.p2.3.m3.1a">
       <mo id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">
        ×
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b">
        <times id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">
        </times>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">
        \times
       </annotation>
      </semantics>
     </math>
     7B as a base model, the performance of
     <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p2.3.3">
      M-RAG
     </span>
     outperforms that of other baseline models on both datasets. For example, it achieves better results than the best baseline model Selfmem, by 8% and 11% in terms of R-1 on XSum and BigPatent, respectively.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p3">
    <p class="ltx_p" id="S4.SS2.p3.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">
      (3) Effectiveness evaluation (machine translation).
     </span>
     We further conduct experiments to evaluate the performance of
     <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p3.1.2">
      M-RAG
     </span>
     for machine translation, and the results are reported in Table
     <a class="ltx_ref" href="#S4.T2" title="Table 2 ‣ 4.2 Experimental Results ‣ 4 Experiments ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     . We observe that a consistent improvement in the performance of translation tasks with
     <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p3.1.3">
      M-RAG
     </span>
     across four datasets and three architectures. Notably, it surpasses the Selfmem by 8% in the Es
     <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1">
      <semantics id="S4.SS2.p3.1.m1.1a">
       <mo id="S4.SS2.p3.1.m1.1.1" stretchy="false" xref="S4.SS2.p3.1.m1.1.1.cmml">
        →
       </mo>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b">
        <ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">
         →
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">
        \rightarrow
       </annotation>
      </semantics>
     </math>
     En translation task.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p4">
    <p class="ltx_p" id="S4.SS2.p4.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p4.1.1">
      (4) Effectiveness evaluation (dialogue generation).
     </span>
     As shown in Table
     <a class="ltx_ref" href="#S4.T3" title="Table 3 ‣ 4.2 Experimental Results ‣ 4 Experiments ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     ,
     <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p4.1.2">
      M-RAG
     </span>
     further enhances the language model performance for dialogue generation tasks. It outperforms the Selfmem by 12% in terms of B-1. Notably, we can also use the Distinct score as the performance metric for optimizing the two agents, denoted by
     <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p4.1.3">
      M-RAG(D)
     </span>
     , and it results in a more diverse dialogue.
    </p>
   </div>
   <figure class="ltx_table" id="S4.T4">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 4:
     </span>
     Comparing
     <span class="ltx_text ltx_font_typewriter" id="S4.T4.3.1">
      M-RAG
     </span>
     on various 7B LLMs.
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T4.1">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S4.T4.1.1">
       <td class="ltx_td ltx_border_r ltx_border_t" id="S4.T4.1.1.2">
       </td>
       <td class="ltx_td ltx_border_r ltx_border_t" id="S4.T4.1.1.3">
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S4.T4.1.1.4">
        Summarization
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.1.1">
        Translation (Es
        <math alttext="\rightarrow" class="ltx_Math" display="inline" id="S4.T4.1.1.1.m1.1">
         <semantics id="S4.T4.1.1.1.m1.1a">
          <mo id="S4.T4.1.1.1.m1.1.1" stretchy="false" xref="S4.T4.1.1.1.m1.1.1.cmml">
           →
          </mo>
          <annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.m1.1b">
           <ci id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1">
            →
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T4.1.1.1.m1.1c">
           \rightarrow
          </annotation>
         </semantics>
        </math>
        En)
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T4.1.1.5">
        Dialogue
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T4.1.2.1">
       <td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.1.2.1.1">
        <span class="ltx_text" id="S4.T4.1.2.1.1.1">
         LLM
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.2.1.2">
        <span class="ltx_text" id="S4.T4.1.2.1.2.1">
         RAG
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.1.3">
        R-1
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.1.4">
        R-2
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.1.5">
        R-L
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.2.1.6">
        BLEU
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.1.7">
        B-1
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.1.8">
        B-2
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T4.1.3.2">
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T4.1.3.2.1">
        Gemma 7B
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.2.2">
        Selfmem
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.2.3">
        31.38
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.2.4">
        9.97
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.2.5">
        25.07
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.3.2.6">
        24.61
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.2.7">
        15.56
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.3.2.8">
        7.91
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T4.1.4.3">
       <td class="ltx_td ltx_align_left ltx_border_r" id="S4.T4.1.4.3.1">
        Gemma 7B
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.3.2">
        M-RAG
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T4.1.4.3.3">
        <span class="ltx_text ltx_font_bold" id="S4.T4.1.4.3.3.1">
         33.81
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T4.1.4.3.4">
        <span class="ltx_text ltx_font_bold" id="S4.T4.1.4.3.4.1">
         12.93
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.3.5">
        <span class="ltx_text ltx_font_bold" id="S4.T4.1.4.3.5.1">
         27.82
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.4.3.6">
        <span class="ltx_text ltx_font_bold" id="S4.T4.1.4.3.6.1">
         26.92
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T4.1.4.3.7">
        <span class="ltx_text ltx_font_bold" id="S4.T4.1.4.3.7.1">
         18.15
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T4.1.4.3.8">
        <span class="ltx_text ltx_font_bold" id="S4.T4.1.4.3.8.1">
         9.95
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T4.1.5.4">
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T4.1.5.4.1">
        Mistral 7B
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.5.4.2">
        Selfmem
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.5.4.3">
        35.40
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.5.4.4">
        12.68
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.5.4.5">
        27.06
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.5.4.6">
        26.26
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.5.4.7">
        18.28
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.5.4.8">
        10.05
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T4.1.6.5">
       <td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S4.T4.1.6.5.1">
        Mistral 7B
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T4.1.6.5.2">
        M-RAG
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.6.5.3">
        <span class="ltx_text ltx_font_bold" id="S4.T4.1.6.5.3.1">
         37.47
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.6.5.4">
        <span class="ltx_text ltx_font_bold" id="S4.T4.1.6.5.4.1">
         13.24
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T4.1.6.5.5">
        <span class="ltx_text ltx_font_bold" id="S4.T4.1.6.5.5.1">
         30.49
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T4.1.6.5.6">
        <span class="ltx_text ltx_font_bold" id="S4.T4.1.6.5.6.1">
         32.65
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.6.5.7">
        <span class="ltx_text ltx_font_bold" id="S4.T4.1.6.5.7.1">
         24.52
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.6.5.8">
        <span class="ltx_text ltx_font_bold" id="S4.T4.1.6.5.8.1">
         11.53
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <figure class="ltx_table" id="S4.T5">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 5:
     </span>
     Ablation study.
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.1">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="S4.T5.1.1.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;">
        Components
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.1.2" style="padding-left:4.0pt;padding-right:4.0pt;">
        R-1
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.1.3" style="padding-left:4.0pt;padding-right:4.0pt;">
        R-2
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.1.1.4" style="padding-left:4.0pt;padding-right:4.0pt;">
        R-L
       </th>
      </tr>
      <tr class="ltx_tr" id="S4.T5.1.2.2">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.2.2.1" style="padding-left:4.0pt;padding-right:4.0pt;">
        <span class="ltx_text ltx_font_typewriter" id="S4.T5.1.2.2.1.1">
         M-RAG
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.2.2.2" style="padding-left:4.0pt;padding-right:4.0pt;">
        <span class="ltx_text ltx_font_bold" id="S4.T5.1.2.2.2.1">
         48.13
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.2.2.3" style="padding-left:4.0pt;padding-right:4.0pt;">
        <span class="ltx_text ltx_font_bold" id="S4.T5.1.2.2.3.1">
         24.66
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.2.2.4" style="padding-left:4.0pt;padding-right:4.0pt;">
        <span class="ltx_text ltx_font_bold" id="S4.T5.1.2.2.4.1">
         39.43
        </span>
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S4.T5.1.3.1">
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.1.1" style="padding-left:4.0pt;padding-right:4.0pt;">
        w/o Agent-S (single DB)
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.1.2" style="padding-left:4.0pt;padding-right:4.0pt;">
        44.20
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.1.3" style="padding-left:4.0pt;padding-right:4.0pt;">
        22.72
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.1.4" style="padding-left:4.0pt;padding-right:4.0pt;">
        37.40
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T5.1.4.2">
       <td class="ltx_td ltx_align_center" id="S4.T5.1.4.2.1" style="padding-left:4.0pt;padding-right:4.0pt;">
        w/o Agent-R (greedy)
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T5.1.4.2.2" style="padding-left:4.0pt;padding-right:4.0pt;">
        45.75
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T5.1.4.2.3" style="padding-left:4.0pt;padding-right:4.0pt;">
        23.21
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T5.1.4.2.4" style="padding-left:4.0pt;padding-right:4.0pt;">
        38.28
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T5.1.5.3">
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T5.1.5.3.1" style="padding-left:4.0pt;padding-right:4.0pt;">
        w/o Agent-S and Agent-R
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T5.1.5.3.2" style="padding-left:4.0pt;padding-right:4.0pt;">
        43.82
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T5.1.5.3.3" style="padding-left:4.0pt;padding-right:4.0pt;">
        22.07
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S4.T5.1.5.3.4" style="padding-left:4.0pt;padding-right:4.0pt;">
        37.44
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p5">
    <p class="ltx_p" id="S4.SS2.p5.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p5.1.1">
      (5) Effectiveness evaluation (results on 7B LLMs).
     </span>
     We increase the number of evaluated LLMs, e.g., comparing 7B models (Gemma 7B and Mistral 7B) to show more results. This comparison aims to assess the performance of
     <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p5.1.2">
      M-RAG
     </span>
     across the three generation tasks, against the best baseline method Selfmem. The results are presented in Table
     <a class="ltx_ref" href="#S4.T4" title="Table 4 ‣ 4.2 Experimental Results ‣ 4 Experiments ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     . In general,
     <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p5.1.3">
      M-RAG
     </span>
     consistently outperforms Selfmem on the 7B models.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p6">
    <p class="ltx_p" id="S4.SS2.p6.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p6.1.1">
      (6) Ablation study.
     </span>
     To evaluate the effectiveness of the two agents in
     <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p6.1.2">
      M-RAG
     </span>
     , we conduct an ablation study on XSum. We remove Agent-S and utilize the entire database for RAG; we replace Agent-R with a greedy rule to select a candidate memory from the pool according to Equation
     <a class="ltx_ref" href="#S3.E3" title="In 3.3 Agent-R: Refining Memories in the Selected Partition ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     ; and we remove both agents, which degrades to the Naive RAG. The results are presented in Table
     <a class="ltx_ref" href="#S4.T5" title="Table 5 ‣ 4.2 Experimental Results ‣ 4 Experiments ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     , demonstrating that both agents contribute to performance improvement. Specifically, removing Agent-S results in a significant decline in R-1 from 48.13 to 44.20. This underscores the role of the multiple partition setting in enhancing overall performance. Moreover, removing Agent-R leads to a reduction in R-1 from 48.13 to 45.75. This decline is attributed to the effectiveness of Agent-R in learning memory selection dynamically, as opposed to relying on a fixed rule for decision-making.
    </p>
   </div>
   <figure class="ltx_table" id="S4.T6">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 6:
     </span>
     Impacts of the number of
     <math alttext="M" class="ltx_Math" display="inline" id="S4.T6.2.m1.1">
      <semantics id="S4.T6.2.m1.1b">
       <mi id="S4.T6.2.m1.1.1" xref="S4.T6.2.m1.1.1.cmml">
        M
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.T6.2.m1.1c">
        <ci id="S4.T6.2.m1.1.1.cmml" xref="S4.T6.2.m1.1.1">
         𝑀
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.T6.2.m1.1d">
        M
       </annotation>
      </semantics>
     </math>
     in Agent-S.
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T6.3">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S4.T6.3.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T6.3.1.1" style="padding-left:2.2pt;padding-right:2.2pt;">
        <math alttext="M" class="ltx_Math" display="inline" id="S4.T6.3.1.1.m1.1">
         <semantics id="S4.T6.3.1.1.m1.1a">
          <mi id="S4.T6.3.1.1.m1.1.1" xref="S4.T6.3.1.1.m1.1.1.cmml">
           M
          </mi>
          <annotation-xml encoding="MathML-Content" id="S4.T6.3.1.1.m1.1b">
           <ci id="S4.T6.3.1.1.m1.1.1.cmml" xref="S4.T6.3.1.1.m1.1.1">
            𝑀
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T6.3.1.1.m1.1c">
           M
          </annotation>
         </semantics>
        </math>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.1.2" style="padding-left:2.2pt;padding-right:2.2pt;">
        1
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.1.3" style="padding-left:2.2pt;padding-right:2.2pt;">
        2
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.1.4" style="padding-left:2.2pt;padding-right:2.2pt;">
        3
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.1.5" style="padding-left:2.2pt;padding-right:2.2pt;">
        4
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.1.6" style="padding-left:2.2pt;padding-right:2.2pt;">
        5
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T6.3.2.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T6.3.2.1.1" style="padding-left:2.2pt;padding-right:2.2pt;">
        R-1
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.2.1.2" style="padding-left:2.2pt;padding-right:2.2pt;">
        44.20
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.2.1.3" style="padding-left:2.2pt;padding-right:2.2pt;">
        44.53
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.2.1.4" style="padding-left:2.2pt;padding-right:2.2pt;">
        46.27
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.2.1.5" style="padding-left:2.2pt;padding-right:2.2pt;">
        48.13
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.3.2.1.6" style="padding-left:2.2pt;padding-right:2.2pt;">
        47.21
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T6.3.3.2">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T6.3.3.2.1" style="padding-left:2.2pt;padding-right:2.2pt;">
        Index constr. (s)
       </th>
       <td class="ltx_td ltx_align_center" id="S4.T6.3.3.2.2" style="padding-left:2.2pt;padding-right:2.2pt;">
        299
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T6.3.3.2.3" style="padding-left:2.2pt;padding-right:2.2pt;">
        278
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T6.3.3.2.4" style="padding-left:2.2pt;padding-right:2.2pt;">
        257
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T6.3.3.2.5" style="padding-left:2.2pt;padding-right:2.2pt;">
        246
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T6.3.3.2.6" style="padding-left:2.2pt;padding-right:2.2pt;">
        227
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T6.3.4.3">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T6.3.4.3.1" style="padding-left:2.2pt;padding-right:2.2pt;">
        Retrieval (s)
       </th>
       <td class="ltx_td ltx_align_center" id="S4.T6.3.4.3.2" style="padding-left:2.2pt;padding-right:2.2pt;">
        0.61
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T6.3.4.3.3" style="padding-left:2.2pt;padding-right:2.2pt;">
        1.09
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T6.3.4.3.4" style="padding-left:2.2pt;padding-right:2.2pt;">
        1.54
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T6.3.4.3.5" style="padding-left:2.2pt;padding-right:2.2pt;">
        2.19
       </td>
       <td class="ltx_td ltx_align_center" id="S4.T6.3.4.3.6" style="padding-left:2.2pt;padding-right:2.2pt;">
        2.59
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T6.3.5.4">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T6.3.5.4.1" style="padding-left:2.2pt;padding-right:2.2pt;">
        Generation (s)
       </th>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T6.3.5.4.2" style="padding-left:2.2pt;padding-right:2.2pt;">
        83.59
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T6.3.5.4.3" style="padding-left:2.2pt;padding-right:2.2pt;">
        84.88
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T6.3.5.4.4" style="padding-left:2.2pt;padding-right:2.2pt;">
        82.81
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T6.3.5.4.5" style="padding-left:2.2pt;padding-right:2.2pt;">
        82.89
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T6.3.5.4.6" style="padding-left:2.2pt;padding-right:2.2pt;">
        86.64
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <figure class="ltx_table" id="S4.T7">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 7:
     </span>
     Impacts of the number of
     <math alttext="K" class="ltx_Math" display="inline" id="S4.T7.2.m1.1">
      <semantics id="S4.T7.2.m1.1b">
       <mi id="S4.T7.2.m1.1.1" xref="S4.T7.2.m1.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.T7.2.m1.1c">
        <ci id="S4.T7.2.m1.1.1.cmml" xref="S4.T7.2.m1.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.T7.2.m1.1d">
        K
       </annotation>
      </semantics>
     </math>
     in Agent-R.
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T7.3">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="S4.T7.3.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T7.3.1.1" style="padding-left:3.4pt;padding-right:3.4pt;">
        <math alttext="K" class="ltx_Math" display="inline" id="S4.T7.3.1.1.m1.1">
         <semantics id="S4.T7.3.1.1.m1.1a">
          <mi id="S4.T7.3.1.1.m1.1.1" xref="S4.T7.3.1.1.m1.1.1.cmml">
           K
          </mi>
          <annotation-xml encoding="MathML-Content" id="S4.T7.3.1.1.m1.1b">
           <ci id="S4.T7.3.1.1.m1.1.1.cmml" xref="S4.T7.3.1.1.m1.1.1">
            𝐾
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.T7.3.1.1.m1.1c">
           K
          </annotation>
         </semantics>
        </math>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.3.1.2" style="padding-left:3.4pt;padding-right:3.4pt;">
        1
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.3.1.3" style="padding-left:3.4pt;padding-right:3.4pt;">
        2
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.3.1.4" style="padding-left:3.4pt;padding-right:3.4pt;">
        3
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.3.1.5" style="padding-left:3.4pt;padding-right:3.4pt;">
        4
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.3.1.6" style="padding-left:3.4pt;padding-right:3.4pt;">
        5
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S4.T7.3.2.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T7.3.2.1.1" style="padding-left:3.4pt;padding-right:3.4pt;">
        R-1
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.3.2.1.2" style="padding-left:3.4pt;padding-right:3.4pt;">
        45.81
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.3.2.1.3" style="padding-left:3.4pt;padding-right:3.4pt;">
        46.54
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.3.2.1.4" style="padding-left:3.4pt;padding-right:3.4pt;">
        48.13
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.3.2.1.5" style="padding-left:3.4pt;padding-right:3.4pt;">
        48.18
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.3.2.1.6" style="padding-left:3.4pt;padding-right:3.4pt;">
        48.25
       </td>
      </tr>
      <tr class="ltx_tr" id="S4.T7.3.3.2">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T7.3.3.2.1" style="padding-left:3.4pt;padding-right:3.4pt;">
        Pool gen. (s)
       </th>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T7.3.3.2.2" style="padding-left:3.4pt;padding-right:3.4pt;">
        76
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T7.3.3.2.3" style="padding-left:3.4pt;padding-right:3.4pt;">
        191
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T7.3.3.2.4" style="padding-left:3.4pt;padding-right:3.4pt;">
        267
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T7.3.3.2.5" style="padding-left:3.4pt;padding-right:3.4pt;">
        290
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S4.T7.3.3.2.6" style="padding-left:3.4pt;padding-right:3.4pt;">
        359
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p7">
    <p class="ltx_p" id="S4.SS2.p7.5">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p7.1.1">
      (7) Parameter study (Agent-S state space
      <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.p7.1.1.m1.1">
       <semantics id="S4.SS2.p7.1.1.m1.1a">
        <mi id="S4.SS2.p7.1.1.m1.1.1" xref="S4.SS2.p7.1.1.m1.1.1.cmml">
         M
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.SS2.p7.1.1.m1.1b">
         <ci id="S4.SS2.p7.1.1.m1.1.1.cmml" xref="S4.SS2.p7.1.1.m1.1.1">
          𝑀
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS2.p7.1.1.m1.1c">
         M
        </annotation>
       </semantics>
      </math>
      ).
     </span>
     We study the effect of parameter
     <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.p7.2.m1.1">
      <semantics id="S4.SS2.p7.2.m1.1a">
       <mi id="S4.SS2.p7.2.m1.1.1" xref="S4.SS2.p7.2.m1.1.1.cmml">
        M
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p7.2.m1.1b">
        <ci id="S4.SS2.p7.2.m1.1.1.cmml" xref="S4.SS2.p7.2.m1.1.1">
         𝑀
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p7.2.m1.1c">
        M
       </annotation>
      </semantics>
     </math>
     , which controls
the state space of Agent-S and corresponds to the number of partitions. In Table
     <a class="ltx_ref" href="#S4.T6" title="Table 6 ‣ 4.2 Experimental Results ‣ 4 Experiments ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     , we observe that setting
     <math alttext="M=4" class="ltx_Math" display="inline" id="S4.SS2.p7.3.m2.1">
      <semantics id="S4.SS2.p7.3.m2.1a">
       <mrow id="S4.SS2.p7.3.m2.1.1" xref="S4.SS2.p7.3.m2.1.1.cmml">
        <mi id="S4.SS2.p7.3.m2.1.1.2" xref="S4.SS2.p7.3.m2.1.1.2.cmml">
         M
        </mi>
        <mo id="S4.SS2.p7.3.m2.1.1.1" xref="S4.SS2.p7.3.m2.1.1.1.cmml">
         =
        </mo>
        <mn id="S4.SS2.p7.3.m2.1.1.3" xref="S4.SS2.p7.3.m2.1.1.3.cmml">
         4
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p7.3.m2.1b">
        <apply id="S4.SS2.p7.3.m2.1.1.cmml" xref="S4.SS2.p7.3.m2.1.1">
         <eq id="S4.SS2.p7.3.m2.1.1.1.cmml" xref="S4.SS2.p7.3.m2.1.1.1">
         </eq>
         <ci id="S4.SS2.p7.3.m2.1.1.2.cmml" xref="S4.SS2.p7.3.m2.1.1.2">
          𝑀
         </ci>
         <cn id="S4.SS2.p7.3.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p7.3.m2.1.1.3">
          4
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p7.3.m2.1c">
        M=4
       </annotation>
      </semantics>
     </math>
     yields the best effectiveness while maintaining reasonable runtime in terms of index construction, retrieval, and generation. This is consistent with empirical studies illustrated in Figure
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     (a). When
     <math alttext="M=1" class="ltx_Math" display="inline" id="S4.SS2.p7.4.m3.1">
      <semantics id="S4.SS2.p7.4.m3.1a">
       <mrow id="S4.SS2.p7.4.m3.1.1" xref="S4.SS2.p7.4.m3.1.1.cmml">
        <mi id="S4.SS2.p7.4.m3.1.1.2" xref="S4.SS2.p7.4.m3.1.1.2.cmml">
         M
        </mi>
        <mo id="S4.SS2.p7.4.m3.1.1.1" xref="S4.SS2.p7.4.m3.1.1.1.cmml">
         =
        </mo>
        <mn id="S4.SS2.p7.4.m3.1.1.3" xref="S4.SS2.p7.4.m3.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p7.4.m3.1b">
        <apply id="S4.SS2.p7.4.m3.1.1.cmml" xref="S4.SS2.p7.4.m3.1.1">
         <eq id="S4.SS2.p7.4.m3.1.1.1.cmml" xref="S4.SS2.p7.4.m3.1.1.1">
         </eq>
         <ci id="S4.SS2.p7.4.m3.1.1.2.cmml" xref="S4.SS2.p7.4.m3.1.1.2">
          𝑀
         </ci>
         <cn id="S4.SS2.p7.4.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p7.4.m3.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p7.4.m3.1c">
        M=1
       </annotation>
      </semantics>
     </math>
     , it reduces to a single database for RAG. As
     <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.p7.5.m4.1">
      <semantics id="S4.SS2.p7.5.m4.1a">
       <mi id="S4.SS2.p7.5.m4.1.1" xref="S4.SS2.p7.5.m4.1.1.cmml">
        M
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p7.5.m4.1b">
        <ci id="S4.SS2.p7.5.m4.1.1.cmml" xref="S4.SS2.p7.5.m4.1.1">
         𝑀
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p7.5.m4.1c">
        M
       </annotation>
      </semantics>
     </math>
     increases, index construction accelerates on smaller partitions, while retrieval time sightly increases due to the additional time required for constructing states by querying each partition. As expected, the retrieval time is much smaller than the language generation time.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS2.p8">
    <p class="ltx_p" id="S4.SS2.p8.6">
     <span class="ltx_text ltx_font_bold" id="S4.SS2.p8.1.1">
      (8) Parameter study (Agent-R state space
      <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p8.1.1.m1.1">
       <semantics id="S4.SS2.p8.1.1.m1.1a">
        <mi id="S4.SS2.p8.1.1.m1.1.1" xref="S4.SS2.p8.1.1.m1.1.1.cmml">
         K
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.SS2.p8.1.1.m1.1b">
         <ci id="S4.SS2.p8.1.1.m1.1.1.cmml" xref="S4.SS2.p8.1.1.m1.1.1">
          𝐾
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS2.p8.1.1.m1.1c">
         K
        </annotation>
       </semantics>
      </math>
      ).
     </span>
     We study the effect of parameter
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p8.2.m1.1">
      <semantics id="S4.SS2.p8.2.m1.1a">
       <mi id="S4.SS2.p8.2.m1.1.1" xref="S4.SS2.p8.2.m1.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p8.2.m1.1b">
        <ci id="S4.SS2.p8.2.m1.1.1.cmml" xref="S4.SS2.p8.2.m1.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p8.2.m1.1c">
        K
       </annotation>
      </semantics>
     </math>
     in Agent-R, representing the state space of Agent-R, to choose one memory from a candidate pool with a size of
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p8.3.m2.1">
      <semantics id="S4.SS2.p8.3.m2.1a">
       <mi id="S4.SS2.p8.3.m2.1.1" xref="S4.SS2.p8.3.m2.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p8.3.m2.1b">
        <ci id="S4.SS2.p8.3.m2.1.1.cmml" xref="S4.SS2.p8.3.m2.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p8.3.m2.1c">
        K
       </annotation>
      </semantics>
     </math>
     . In Table
     <a class="ltx_ref" href="#S4.T7" title="Table 7 ‣ 4.2 Experimental Results ‣ 4 Experiments ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     , we observe a performance improvement as
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.p8.4.m3.1">
      <semantics id="S4.SS2.p8.4.m3.1a">
       <mi id="S4.SS2.p8.4.m3.1.1" xref="S4.SS2.p8.4.m3.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p8.4.m3.1b">
        <ci id="S4.SS2.p8.4.m3.1.1.cmml" xref="S4.SS2.p8.4.m3.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p8.4.m3.1c">
        K
       </annotation>
      </semantics>
     </math>
     increases from 1 to 3, and then remains stable. Particularly, when
     <math alttext="K=1" class="ltx_Math" display="inline" id="S4.SS2.p8.5.m4.1">
      <semantics id="S4.SS2.p8.5.m4.1a">
       <mrow id="S4.SS2.p8.5.m4.1.1" xref="S4.SS2.p8.5.m4.1.1.cmml">
        <mi id="S4.SS2.p8.5.m4.1.1.2" xref="S4.SS2.p8.5.m4.1.1.2.cmml">
         K
        </mi>
        <mo id="S4.SS2.p8.5.m4.1.1.1" xref="S4.SS2.p8.5.m4.1.1.1.cmml">
         =
        </mo>
        <mn id="S4.SS2.p8.5.m4.1.1.3" xref="S4.SS2.p8.5.m4.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p8.5.m4.1b">
        <apply id="S4.SS2.p8.5.m4.1.1.cmml" xref="S4.SS2.p8.5.m4.1.1">
         <eq id="S4.SS2.p8.5.m4.1.1.1.cmml" xref="S4.SS2.p8.5.m4.1.1.1">
         </eq>
         <ci id="S4.SS2.p8.5.m4.1.1.2.cmml" xref="S4.SS2.p8.5.m4.1.1.2">
          𝐾
         </ci>
         <cn id="S4.SS2.p8.5.m4.1.1.3.cmml" type="integer" xref="S4.SS2.p8.5.m4.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p8.5.m4.1c">
        K=1
       </annotation>
      </semantics>
     </math>
     ,
     <span class="ltx_text ltx_font_typewriter" id="S4.SS2.p8.6.2">
      M-RAG
     </span>
     exhibits the worst performance, possibly due to the limited exploration of potential memories for generating improved hypotheses. We choose the setting of
     <math alttext="K=3" class="ltx_Math" display="inline" id="S4.SS2.p8.6.m5.1">
      <semantics id="S4.SS2.p8.6.m5.1a">
       <mrow id="S4.SS2.p8.6.m5.1.1" xref="S4.SS2.p8.6.m5.1.1.cmml">
        <mi id="S4.SS2.p8.6.m5.1.1.2" xref="S4.SS2.p8.6.m5.1.1.2.cmml">
         K
        </mi>
        <mo id="S4.SS2.p8.6.m5.1.1.1" xref="S4.SS2.p8.6.m5.1.1.1.cmml">
         =
        </mo>
        <mn id="S4.SS2.p8.6.m5.1.1.3" xref="S4.SS2.p8.6.m5.1.1.3.cmml">
         3
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p8.6.m5.1b">
        <apply id="S4.SS2.p8.6.m5.1.1.cmml" xref="S4.SS2.p8.6.m5.1.1">
         <eq id="S4.SS2.p8.6.m5.1.1.1.cmml" xref="S4.SS2.p8.6.m5.1.1.1">
         </eq>
         <ci id="S4.SS2.p8.6.m5.1.1.2.cmml" xref="S4.SS2.p8.6.m5.1.1.2">
          𝐾
         </ci>
         <cn id="S4.SS2.p8.6.m5.1.1.3.cmml" type="integer" xref="S4.SS2.p8.6.m5.1.1.3">
          3
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p8.6.m5.1c">
        K=3
       </annotation>
      </semantics>
     </math>
     , as it demonstrates effective performance, and runs reasonably fast for generating the pool.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Conclusion and Limitations
  </h2>
  <div class="ltx_para" id="S5.p1">
   <p class="ltx_p" id="S5.p1.1">
    In this paper, we propose a multiple partition paradigm for RAG, which aims to refine retrieval processes and emphasize pivotal memories to improve overall performance. Additionally, we introduce
    <span class="ltx_text ltx_font_typewriter" id="S5.p1.1.1">
     M-RAG
    </span>
    , a novel framework with multi-agent reinforcement learning, which addresses key challenges inherent in executing RAG across multiple partitions. The training objective of
    <span class="ltx_text ltx_font_typewriter" id="S5.p1.1.2">
     M-RAG
    </span>
    is well aligned with that of text generation tasks, showcasing its potential to enhance system performance explicitly. Through extensive experiments conducted on seven datasets for three language generation tasks, we validate the effectiveness of
    <span class="ltx_text ltx_font_typewriter" id="S5.p1.1.3">
     M-RAG
    </span>
    .
   </p>
  </div>
  <div class="ltx_para" id="S5.p2">
   <p class="ltx_p" id="S5.p2.1">
    For limitations, we conduct experiments with quantized versions of language models due to computational constraints. However, the observed effectiveness gains are expected to remain consistent across different model sizes and should not significantly impact the overall trends of various RAG methods. Further, although the parameters of the LLMs remain fixed and only the parameters of Agent-S and Agent-R are trained, the training efficiency is limited, as indicated by the training time complexity discussed in Section
    <a class="ltx_ref" href="#S3.SS4" title="3.4 The M-RAG Framework ‣ 3 Methodology ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
     <span class="ltx_text ltx_ref_tag">
      3.4
     </span>
    </a>
    . This is due to the necessity of querying the LLMs during the training process. In future work, we intend to explore solutions to overcome these limitations.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Abdin et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Marah Abdin, Jyoti Aneja, ebastien Bubeck, and Caio Cesar Teodoro Mendes et al. 2023.
    </span>
    <span class="ltx_bibblock">
     Phi-2: The surprising power of small language models.
    </span>
    <span class="ltx_bibblock">
     https://www.microsoft.com/en-us/research/blog/phi-2-the-surprising-power-of-small-language-models.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Anderson et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Nathan Anderson, Caleb Wilson, and Stephen D. Richardson. 2022.
    </span>
    <span class="ltx_bibblock">
     Lingua: Addressing scenarios for live interpretation and automatic dubbing.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">
      AMTA
     </em>
     , pages 202–209.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Asai et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Akari Asai, Zeqiu Wu, Yizhong Wang, Avirup Sil, and Hannaneh Hajishirzi. 2023.
    </span>
    <span class="ltx_bibblock">
     Self-rag: Learning to retrieve, generate, and critique through self-reflection.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">
      CoRR
     </em>
     , abs/2310.11511.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Blagojevi (2023)
    </span>
    <span class="ltx_bibblock">
     V. Blagojevi. 2023.
    </span>
    <span class="ltx_bibblock">
     Enhancing rag pipelines in haystack: Introducing diversityranker and lostinthemiddleranker.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">
      https://towardsdatascience.com/enhancing-rag-pipelines-in-haystack-45f14e2bc9f5
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Brown et al. (2020)
    </span>
    <span class="ltx_bibblock">
     Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al. 2020.
    </span>
    <span class="ltx_bibblock">
     Language models are few-shot learners.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">
      NeurIPS
     </em>
     , 33:1877–1901.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Howard Chen, Ramakanth Pasunuru, Jason Weston, and Asli Celikyilmaz. 2023.
    </span>
    <span class="ltx_bibblock">
     Walking down the memory maze: Beyond context limit through interactive reading.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">
      CoRR
     </em>
     , abs/2310.05029.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cheng et al. (2023a)
    </span>
    <span class="ltx_bibblock">
     Daixuan Cheng, Shaohan Huang, Junyu Bi, Yuefeng Zhan, Jianfeng Liu, Yujing Wang, Hao Sun, Furu Wei, Weiwei Deng, and Qi Zhang. 2023a.
    </span>
    <span class="ltx_bibblock">
     UPRISE: universal prompt retrieval for improving zero-shot evaluation.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">
      EMNLP
     </em>
     , pages 12318–12337.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cheng et al. (2023b)
    </span>
    <span class="ltx_bibblock">
     Xin Cheng, Di Luo, Xiuying Chen, Lemao Liu, Dongyan Zhao, and Rui Yan. 2023b.
    </span>
    <span class="ltx_bibblock">
     Lift yourself up: Retrieval-augmented text generation with self memory.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">
      NeurIPS
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cho et al. (2018)
    </span>
    <span class="ltx_bibblock">
     Woon Sang Cho, Pengchuan Zhang, Yizhe Zhang, Xiujun Li, Michel Galley, Chris Brockett, Mengdi Wang, and Jianfeng Gao. 2018.
    </span>
    <span class="ltx_bibblock">
     Towards coherent and cohesive long-form text generation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">
      CoRR
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Dai et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Zhuyun Dai, Vincent Y. Zhao, Ji Ma, Yi Luan, Jianmo Ni, Jing Lu, Anton Bakalov, Kelvin Guu, Keith B. Hall, and Ming-Wei Chang. 2023.
    </span>
    <span class="ltx_bibblock">
     Promptagator: Few-shot dense retrieval from 8 examples.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">
      ICLR
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Gao et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Yunfan Gao, Yun Xiong, Xinyu Gao, Kangxiang Jia, Jinliu Pan, Yuxi Bi, Yi Dai, Jiawei Sun, Qianyu Guo, Meng Wang, and Haofen Wang. 2023.
    </span>
    <span class="ltx_bibblock">
     Retrieval-augmented generation for large language models: A survey.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">
      CoRR
     </em>
     , abs/2312.10997.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Gollapudi et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Siddharth Gollapudi, Neel Karia, Varun Sivashankar, Ravishankar Krishnaswamy, Nikit Begwani, Swapnil Raz, Yiyong Lin, Yin Zhang, Neelam Mahapatro, Premkumar Srinivasan, et al. 2023.
    </span>
    <span class="ltx_bibblock">
     Filtered-diskann: Graph algorithms for approximate nearest neighbor search with filters.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">
      WWW
     </em>
     , pages 3406–3416.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Gu et al. (2018)
    </span>
    <span class="ltx_bibblock">
     Jiatao Gu, Yong Wang, Kyunghyun Cho, and Victor O. K. Li. 2018.
    </span>
    <span class="ltx_bibblock">
     Search engine guided neural machine translation.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">
      AAAI
     </em>
     , pages 5133–5140. AAAI Press.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Guo et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Rentong Guo, Xiaofan Luan, Long Xiang, Xiao Yan, Xiaomeng Yi, Jigao Luo, Qianya Cheng, Weizhi Xu, Jiarui Luo, Frank Liu, et al. 2022.
    </span>
    <span class="ltx_bibblock">
     Manu: a cloud native vector database management system.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">
      PVLDB
     </em>
     , 15(12):3548–3561.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Han et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Yikun Han, Chunjiang Liu, and Pengfei Wang. 2023.
    </span>
    <span class="ltx_bibblock">
     A comprehensive survey on vector database: Storage and retrieval technique, challenge.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">
      CoRR
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hossain et al. (2020)
    </span>
    <span class="ltx_bibblock">
     Nabil Hossain, Marjan Ghazvininejad, and Luke Zettlemoyer. 2020.
    </span>
    <span class="ltx_bibblock">
     Simple and effective retrieve-edit-rerank text generation.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">
      ACL
     </em>
     , pages 2532–2538.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Indyk and Motwani (1998)
    </span>
    <span class="ltx_bibblock">
     Piotr Indyk and Rajeev Motwani. 1998.
    </span>
    <span class="ltx_bibblock">
     Approximate nearest neighbors: towards removing the curse of dimensionality.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">
      STOC
     </em>
     , pages 604–613.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jaques et al. (2019)
    </span>
    <span class="ltx_bibblock">
     Natasha Jaques, Asma Ghandeharioun, Judy Hanwen Shen, Craig Ferguson, Agata Lapedriza, Noah Jones, Shixiang Gu, and Rosalind Picard. 2019.
    </span>
    <span class="ltx_bibblock">
     Way off-policy batch deep reinforcement learning of implicit human preferences in dialog.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">
      CoRR
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jegou et al. (2010)
    </span>
    <span class="ltx_bibblock">
     Herve Jegou, Matthijs Douze, and Cordelia Schmid. 2010.
    </span>
    <span class="ltx_bibblock">
     Product quantization for nearest neighbor search.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">
      TPAMI
     </em>
     , 33(1):117–128.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jiang et al. (2023a)
    </span>
    <span class="ltx_bibblock">
     Albert Q. Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, and et al. 2023a.
    </span>
    <span class="ltx_bibblock">
     Mistral 7b.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">
      CoRR
     </em>
     , abs/2310.06825.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jiang et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Albert Q. Jiang, Alexandre Sablayrolles, Antoine Roux, and Arthur Mensch et al. 2024.
    </span>
    <span class="ltx_bibblock">
     Mixtral of experts.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">
      CoRR
     </em>
     , abs/2401.04088.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jiang et al. (2023b)
    </span>
    <span class="ltx_bibblock">
     Huiqiang Jiang, Qianhui Wu, Chin-Yew Lin, Yuqing Yang, and Lili Qiu. 2023b.
    </span>
    <span class="ltx_bibblock">
     Llmlingua: Compressing prompts for accelerated inference of large language models.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">
      EMNLP
     </em>
     , pages 13358–13376.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Karpukhin et al. (2020)
    </span>
    <span class="ltx_bibblock">
     Vladimir Karpukhin, Barlas Oguz, Sewon Min, Patrick S. H. Lewis, Ledell Wu, Sergey Edunov, Danqi Chen, and Wen-tau Yih. 2020.
    </span>
    <span class="ltx_bibblock">
     Dense passage retrieval for open-domain question answering.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">
      EMNLP (1)
     </em>
     , pages 6769–6781.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kreutzer et al. (2018)
    </span>
    <span class="ltx_bibblock">
     Julia Kreutzer, Shahram Khadivi, Evgeny Matusov, and Stefan Riezler. 2018.
    </span>
    <span class="ltx_bibblock">
     Can neural machine translation be improved with user feedback?
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">
      CoRR
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lawrence and Riezler (2018)
    </span>
    <span class="ltx_bibblock">
     Carolin Lawrence and Stefan Riezler. 2018.
    </span>
    <span class="ltx_bibblock">
     Improving a neural semantic parser by counterfactual learning from human bandit feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">
      CoRR
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lewis et al. (2020)
    </span>
    <span class="ltx_bibblock">
     Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim Rocktäschel, et al. 2020.
    </span>
    <span class="ltx_bibblock">
     Retrieval-augmented generation for knowledge-intensive nlp tasks.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">
      NeurIPS
     </em>
     , 33:9459–9474.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Jinpeng Li, Yingce Xia, Rui Yan, Hongda Sun, Dongyan Zhao, and Tie-Yan Liu. 2021.
    </span>
    <span class="ltx_bibblock">
     Stylized dialogue generation with multi-pass dual learning.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">
      NeurIPS
     </em>
     , pages 28470–28481.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al. (2016)
    </span>
    <span class="ltx_bibblock">
     Jiwei Li, Michel Galley, Chris Brockett, Jianfeng Gao, and Bill Dolan. 2016.
    </span>
    <span class="ltx_bibblock">
     A diversity-promoting objective function for neural conversation models.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">
      HLT-NAACL
     </em>
     , pages 110–119.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Xinze Li, Zhenghao Liu, Chenyan Xiong, Shi Yu, Yu Gu, Zhiyuan Liu, and Ge Yu. 2023.
    </span>
    <span class="ltx_bibblock">
     Structure-aware language model pretraining improves dense retrieval on structured data.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">
      ACL (Findings)
     </em>
     , pages 11560–11574.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al. (2017)
    </span>
    <span class="ltx_bibblock">
     Yanran Li, Hui Su, Xiaoyu Shen, Wenjie Li, Ziqiang Cao, and Shuzi Niu. 2017.
    </span>
    <span class="ltx_bibblock">
     Dailydialog: A manually labelled multi-turn dialogue dataset.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">
      IJCNLP(1)
     </em>
     , pages 986–995.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lin (2004)
    </span>
    <span class="ltx_bibblock">
     Chin-Yew Lin. 2004.
    </span>
    <span class="ltx_bibblock">
     ROUGE: A package for automatic evaluation of summaries.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">
      Text Summarization Branches Out
     </em>
     , pages 74–81.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lin et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Xi Victoria Lin, Xilun Chen, Mingda Chen, Weijia Shi, Maria Lomeli, Rich James, Pedro Rodriguez, Jacob Kahn, Gergely Szilvasy, Mike Lewis, Luke Zettlemoyer, and Scott Yih. 2023.
    </span>
    <span class="ltx_bibblock">
     RA-DIT: retrieval-augmented dual instruction tuning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">
      CoRR
     </em>
     , abs/2310.01352.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Litman et al. (2020)
    </span>
    <span class="ltx_bibblock">
     Ron Litman, Oron Anschel, Shahar Tsiper, Roee Litman, Shai Mazor, and R. Manmatha. 2020.
    </span>
    <span class="ltx_bibblock">
     SCATTER: selective context attentional scene text recognizer.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">
      CVPR
     </em>
     , pages 11959–11969.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ma et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Xinbei Ma, Yeyun Gong, Pengcheng He, Hai Zhao, and Nan Duan. 2023.
    </span>
    <span class="ltx_bibblock">
     Query rewriting for retrieval-augmented large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">
      EMNLP
     </em>
     , pages 5303–5315.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Malkov and Yashunin (2018)
    </span>
    <span class="ltx_bibblock">
     Yu A Malkov and Dmitry A Yashunin. 2018.
    </span>
    <span class="ltx_bibblock">
     Efficient and robust approximate nearest neighbor search using hierarchical navigable small world graphs.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">
      TPAMI
     </em>
     , 42(4):824–836.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Malkov et al. (2014)
    </span>
    <span class="ltx_bibblock">
     Yury Malkov, Alexander Ponomarenko, Andrey Logvinov, and Vladimir Krylov. 2014.
    </span>
    <span class="ltx_bibblock">
     Approximate nearest neighbor algorithm based on navigable small world graphs.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">
      Information Systems
     </em>
     , 45:61–68.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Mesnard et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Thomas Mesnard, Cassidy Hardin, Robert Dadashi, Surya Bhupatiraju, and et al. 2024.
    </span>
    <span class="ltx_bibblock">
     Gemma: Open models based on gemini research and technology.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">
      CoRR
     </em>
     , abs/2403.08295.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Mnih et al. (2013)
    </span>
    <span class="ltx_bibblock">
     Volodymyr Mnih, Koray Kavukcuoglu, David Silver, Alex Graves, Ioannis Antonoglou, Daan Wierstra, and Martin Riedmiller. 2013.
    </span>
    <span class="ltx_bibblock">
     Playing atari with deep reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">
      CoRR
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Nakano et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Reiichiro Nakano, Jacob Hilton, Suchir Balaji, and Jeff Wu et al. 2021.
    </span>
    <span class="ltx_bibblock">
     Webgpt: Browser-assisted question-answering with human feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">
      CoRR
     </em>
     , abs/2112.09332.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib40">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Narayan et al. (2018)
    </span>
    <span class="ltx_bibblock">
     Shashi Narayan, Shay B. Cohen, and Mirella Lapata. 2018.
    </span>
    <span class="ltx_bibblock">
     Don’t give me the details, just the summary! topic-aware convolutional neural networks for extreme summarization.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">
      EMNLP
     </em>
     , pages 1797–1807.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib41">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Neelakantan et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Arvind Neelakantan, Tao Xu, Raul Puri, Alec Radford, Jesse Michael Han, Jerry Tworek, Qiming Yuan, Nikolas Tezak, Jong Wook Kim, Chris Hallacy, et al. 2022.
    </span>
    <span class="ltx_bibblock">
     Text and code embeddings by contrastive pre-training.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">
      CoRR
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib42">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ouyang et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et al. 2022.
    </span>
    <span class="ltx_bibblock">
     Training language models to follow instructions with human feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">
      NeurIPS
     </em>
     , 35:27730–27744.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib43">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Pan et al. (2023)
    </span>
    <span class="ltx_bibblock">
     James Jie Pan, Jianguo Wang, and Guoliang Li. 2023.
    </span>
    <span class="ltx_bibblock">
     Survey of vector database management systems.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">
      CoRR
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib44">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Post (2018)
    </span>
    <span class="ltx_bibblock">
     Matt Post. 2018.
    </span>
    <span class="ltx_bibblock">
     A call for clarity in reporting BLEU scores.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">
      WMT
     </em>
     , pages 186–191.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib45">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Sharma et al. (2019)
    </span>
    <span class="ltx_bibblock">
     Eva Sharma, Chen Li, and Lu Wang. 2019.
    </span>
    <span class="ltx_bibblock">
     BIGPATENT: A large-scale dataset for abstractive and coherent summarization.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">
      ACL (1)
     </em>
     , pages 2204–2213.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib46">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Slivkins et al. (2019)
    </span>
    <span class="ltx_bibblock">
     Aleksandrs Slivkins et al. 2019.
    </span>
    <span class="ltx_bibblock">
     Introduction to multi-armed bandits.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">
      Foundations and Trends® in Machine Learning
     </em>
     , 12(1-2):1–286.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib47">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Steinberger et al. (2006)
    </span>
    <span class="ltx_bibblock">
     Ralf Steinberger, Bruno Pouliquen, Anna Widiger, Camelia Ignat, Tomaz Erjavec, Dan Tufis, and Dániel Varga. 2006.
    </span>
    <span class="ltx_bibblock">
     The jrc-acquis: A multilingual aligned parallel corpus with 20+ languages.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">
      LREC
     </em>
     , pages 2142–2147.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib48">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Touvron et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Hugo Touvron, Louis Martin, Kevin Stone, and Peter Albert et al. 2023.
    </span>
    <span class="ltx_bibblock">
     Llama 2: Open foundation and fine-tuned chat models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">
      CoRR
     </em>
     , abs/2307.09288.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib49">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Shuohang Wang, Yichong Xu, Yuwei Fang, Yang Liu, Siqi Sun, Ruochen Xu, Chenguang Zhu, and Michael Zeng. 2022.
    </span>
    <span class="ltx_bibblock">
     Training data is more valuable than you think: A simple and effective method by retrieving from training data.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">
      ACL
     </em>
     , pages 3170–3179.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib50">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. (2023a)
    </span>
    <span class="ltx_bibblock">
     Xintao Wang, Qianwen Yang, Yongting Qiu, Jiaqing Liang, Qianyu He, Zhouhong Gu, Yanghua Xiao, and Wei Wang. 2023a.
    </span>
    <span class="ltx_bibblock">
     Knowledgpt: Enhancing large language models with retrieval and storage access on knowledge bases.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">
      CoRR
     </em>
     , abs/2308.11761.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib51">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Zheng Wang, Bingzheng Gan, and Wei Shi. 2024.
    </span>
    <span class="ltx_bibblock">
     Multimodal query suggestion with multi-agent reinforcement learning from human feedback.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">
      WWW
     </em>
     , pages 1374–1385.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib52">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. (2023b)
    </span>
    <span class="ltx_bibblock">
     Zheng Wang, Cheng Long, Gao Cong, and Christian S. Jensen. 2023b.
    </span>
    <span class="ltx_bibblock">
     Collectively simplifying trajectories in a database: A query accuracy driven approach.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">
      CoRR
     </em>
     , abs/2311.11204.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib53">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Zheng Wang, Cheng Long, Gao Cong, and Qianru Zhang. 2021.
    </span>
    <span class="ltx_bibblock">
     Error-bounded online trajectory simplification with multi-agent reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">
      KDD
     </em>
     , pages 1758–1768.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib54">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et al. (2021a)
    </span>
    <span class="ltx_bibblock">
     Jeff Wu, Long Ouyang, Daniel M Ziegler, Nisan Stiennon, Ryan Lowe, Jan Leike, and Paul Christiano. 2021a.
    </span>
    <span class="ltx_bibblock">
     Recursively summarizing books with human feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">
      CoRR
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib55">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et al. (2021b)
    </span>
    <span class="ltx_bibblock">
     Sixing Wu, Ying Li, Minghui Wang, Dawei Zhang, Yang Zhou, and Zhonghai Wu. 2021b.
    </span>
    <span class="ltx_bibblock">
     More is better: Enhancing open-domain dialogue generation via multi-source heterogeneous knowledge.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">
      EMNLP
     </em>
     , pages 2286–2300.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib56">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Sixing Wu, Ying Li, Dawei Zhang, and Zhonghai Wu. 2022.
    </span>
    <span class="ltx_bibblock">
     KSAM: infusing multi-source knowledge into dialogue generation via knowledge source aware multi-head decoding.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">
      ACL (Findings)
     </em>
     , pages 353–363.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib57">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Xiao et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Shitao Xiao, Zheng Liu, Peitian Zhang, and Xingrun Xing. 2023.
    </span>
    <span class="ltx_bibblock">
     Lm-cocktail: Resilient tuning of language models via model merging.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">
      CoRR
     </em>
     , abs/2311.13534.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib58">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Xu et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Fangyuan Xu, Weijia Shi, and Eunsol Choi. 2023.
    </span>
    <span class="ltx_bibblock">
     RECOMP: improving retrieval-augmented lms with compression and selective augmentation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">
      CoRR
     </em>
     , abs/2310.04408.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib59">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Xue et al. (2017)
    </span>
    <span class="ltx_bibblock">
     Wenzhuo Xue, Hui Li, Yanguo Peng, Jiangtao Cui, and Yu Shi. 2017.
    </span>
    <span class="ltx_bibblock">
     Secure
     <math alttext="k" class="ltx_Math" display="inline" id="bib.bib59.1.m1.1">
      <semantics id="bib.bib59.1.m1.1a">
       <mi id="bib.bib59.1.m1.1.1" xref="bib.bib59.1.m1.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="bib.bib59.1.m1.1b">
        <ci id="bib.bib59.1.m1.1.1.cmml" xref="bib.bib59.1.m1.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="bib.bib59.1.m1.1c">
        k
       </annotation>
      </semantics>
     </math>
     nearest neighbors query for high-dimensional vectors in outsourced environments.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib59.2.1">
      IEEE TBD
     </em>
     , 4(4):586–599.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib60">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yi et al. (2019)
    </span>
    <span class="ltx_bibblock">
     Sanghyun Yi, Rahul Goel, Chandra Khatri, Alessandra Cervone, Tagyoung Chung, Behnam Hedayatnia, Anu Venkatesh, Raefer Gabriel, and Dilek Hakkani-Tur. 2019.
    </span>
    <span class="ltx_bibblock">
     Towards coherent and engaging spoken dialog response generation using automatic conversation evaluators.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">
      CoRR
     </em>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib61">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhuang et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Shengyao Zhuang, Bing Liu, Bevan Koopman, and Guido Zuccon. 2023.
    </span>
    <span class="ltx_bibblock">
     Open-source large language models are strong zero-shot query likelihood models for document ranking.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">
      EMNLP (Findings)
     </em>
     , pages 8807–8817.
    </span>
   </li>
  </ul>
 </section>
 <section class="ltx_appendix" id="A1">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Appendix
  </h2>
  <figure class="ltx_table" id="A1.T8">
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_table">
     Table 8:
    </span>
    Machine translation with BLEURT and COMET.
   </figcaption>
   <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T8.10">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="A1.T8.10.11.1">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="A1.T8.10.11.1.1" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;">
       <span class="ltx_text" id="A1.T8.10.11.1.1.1">
        LLM
       </span>
      </th>
      <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="A1.T8.10.11.1.2" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;">
       <span class="ltx_text" id="A1.T8.10.11.1.2.1">
        RAG
       </span>
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="4" id="A1.T8.10.11.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">
       BLEURT
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="4" id="A1.T8.10.11.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">
       COMET
      </th>
     </tr>
     <tr class="ltx_tr" id="A1.T8.8.8">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T8.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">
       Es
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.T8.1.1.1.m1.1">
        <semantics id="A1.T8.1.1.1.m1.1a">
         <mo id="A1.T8.1.1.1.m1.1.1" stretchy="false" xref="A1.T8.1.1.1.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A1.T8.1.1.1.m1.1b">
          <ci id="A1.T8.1.1.1.m1.1.1.cmml" xref="A1.T8.1.1.1.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.T8.1.1.1.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       En
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T8.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">
       En
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.T8.2.2.2.m1.1">
        <semantics id="A1.T8.2.2.2.m1.1a">
         <mo id="A1.T8.2.2.2.m1.1.1" stretchy="false" xref="A1.T8.2.2.2.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A1.T8.2.2.2.m1.1b">
          <ci id="A1.T8.2.2.2.m1.1.1.cmml" xref="A1.T8.2.2.2.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.T8.2.2.2.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Es
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T8.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">
       De
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.T8.3.3.3.m1.1">
        <semantics id="A1.T8.3.3.3.m1.1a">
         <mo id="A1.T8.3.3.3.m1.1.1" stretchy="false" xref="A1.T8.3.3.3.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A1.T8.3.3.3.m1.1b">
          <ci id="A1.T8.3.3.3.m1.1.1.cmml" xref="A1.T8.3.3.3.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.T8.3.3.3.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       En
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T8.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">
       En
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.T8.4.4.4.m1.1">
        <semantics id="A1.T8.4.4.4.m1.1a">
         <mo id="A1.T8.4.4.4.m1.1.1" stretchy="false" xref="A1.T8.4.4.4.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A1.T8.4.4.4.m1.1b">
          <ci id="A1.T8.4.4.4.m1.1.1.cmml" xref="A1.T8.4.4.4.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.T8.4.4.4.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       De
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T8.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">
       Es
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.T8.5.5.5.m1.1">
        <semantics id="A1.T8.5.5.5.m1.1a">
         <mo id="A1.T8.5.5.5.m1.1.1" stretchy="false" xref="A1.T8.5.5.5.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A1.T8.5.5.5.m1.1b">
          <ci id="A1.T8.5.5.5.m1.1.1.cmml" xref="A1.T8.5.5.5.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.T8.5.5.5.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       En
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T8.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">
       En
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.T8.6.6.6.m1.1">
        <semantics id="A1.T8.6.6.6.m1.1a">
         <mo id="A1.T8.6.6.6.m1.1.1" stretchy="false" xref="A1.T8.6.6.6.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A1.T8.6.6.6.m1.1b">
          <ci id="A1.T8.6.6.6.m1.1.1.cmml" xref="A1.T8.6.6.6.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.T8.6.6.6.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       Es
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T8.7.7.7" style="padding-left:3.0pt;padding-right:3.0pt;">
       De
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.T8.7.7.7.m1.1">
        <semantics id="A1.T8.7.7.7.m1.1a">
         <mo id="A1.T8.7.7.7.m1.1.1" stretchy="false" xref="A1.T8.7.7.7.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A1.T8.7.7.7.m1.1b">
          <ci id="A1.T8.7.7.7.m1.1.1.cmml" xref="A1.T8.7.7.7.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.T8.7.7.7.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       En
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T8.8.8.8" style="padding-left:3.0pt;padding-right:3.0pt;">
       En
       <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.T8.8.8.8.m1.1">
        <semantics id="A1.T8.8.8.8.m1.1a">
         <mo id="A1.T8.8.8.8.m1.1.1" stretchy="false" xref="A1.T8.8.8.8.m1.1.1.cmml">
          →
         </mo>
         <annotation-xml encoding="MathML-Content" id="A1.T8.8.8.8.m1.1b">
          <ci id="A1.T8.8.8.8.m1.1.1.cmml" xref="A1.T8.8.8.8.m1.1.1">
           →
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.T8.8.8.8.m1.1c">
          \rightarrow
         </annotation>
        </semantics>
       </math>
       De
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A1.T8.9.9">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T8.9.9.1" style="padding-left:3.0pt;padding-right:3.0pt;">
       Mixtral 8
       <math alttext="\times" class="ltx_Math" display="inline" id="A1.T8.9.9.1.m1.1">
        <semantics id="A1.T8.9.9.1.m1.1a">
         <mo id="A1.T8.9.9.1.m1.1.1" xref="A1.T8.9.9.1.m1.1.1.cmml">
          ×
         </mo>
         <annotation-xml encoding="MathML-Content" id="A1.T8.9.9.1.m1.1b">
          <times id="A1.T8.9.9.1.m1.1.1.cmml" xref="A1.T8.9.9.1.m1.1.1">
          </times>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.T8.9.9.1.m1.1c">
          \times
         </annotation>
        </semantics>
       </math>
       7B
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T8.9.9.2" style="padding-left:3.0pt;padding-right:3.0pt;">
       Selfmem
      </th>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.9.9.3" style="padding-left:3.0pt;padding-right:3.0pt;">
       63.63
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.9.9.4" style="padding-left:3.0pt;padding-right:3.0pt;">
       53.26
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.9.9.5" style="padding-left:3.0pt;padding-right:3.0pt;">
       59.93
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T8.9.9.6" style="padding-left:3.0pt;padding-right:3.0pt;">
       59.91
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.9.9.7" style="padding-left:3.0pt;padding-right:3.0pt;">
       75.65
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.9.9.8" style="padding-left:3.0pt;padding-right:3.0pt;">
       55.28
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.9.9.9" style="padding-left:3.0pt;padding-right:3.0pt;">
       60.41
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.9.9.10" style="padding-left:3.0pt;padding-right:3.0pt;">
       52.13
      </td>
     </tr>
     <tr class="ltx_tr" id="A1.T8.10.10">
      <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="A1.T8.10.10.1" style="padding-left:3.0pt;padding-right:3.0pt;">
       Mixtral 8
       <math alttext="\times" class="ltx_Math" display="inline" id="A1.T8.10.10.1.m1.1">
        <semantics id="A1.T8.10.10.1.m1.1a">
         <mo id="A1.T8.10.10.1.m1.1.1" xref="A1.T8.10.10.1.m1.1.1.cmml">
          ×
         </mo>
         <annotation-xml encoding="MathML-Content" id="A1.T8.10.10.1.m1.1b">
          <times id="A1.T8.10.10.1.m1.1.1.cmml" xref="A1.T8.10.10.1.m1.1.1">
          </times>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.T8.10.10.1.m1.1c">
          \times
         </annotation>
        </semantics>
       </math>
       7B
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="A1.T8.10.10.2" style="padding-left:3.0pt;padding-right:3.0pt;">
       M-RAG
      </th>
      <td class="ltx_td ltx_align_center ltx_border_b" id="A1.T8.10.10.3" style="padding-left:3.0pt;padding-right:3.0pt;">
       <span class="ltx_text ltx_font_bold" id="A1.T8.10.10.3.1">
        71.74
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b" id="A1.T8.10.10.4" style="padding-left:3.0pt;padding-right:3.0pt;">
       <span class="ltx_text ltx_font_bold" id="A1.T8.10.10.4.1">
        63.66
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b" id="A1.T8.10.10.5" style="padding-left:3.0pt;padding-right:3.0pt;">
       <span class="ltx_text ltx_font_bold" id="A1.T8.10.10.5.1">
        66.77
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A1.T8.10.10.6" style="padding-left:3.0pt;padding-right:3.0pt;">
       <span class="ltx_text ltx_font_bold" id="A1.T8.10.10.6.1">
        70.99
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b" id="A1.T8.10.10.7" style="padding-left:3.0pt;padding-right:3.0pt;">
       <span class="ltx_text ltx_font_bold" id="A1.T8.10.10.7.1">
        82.66
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b" id="A1.T8.10.10.8" style="padding-left:3.0pt;padding-right:3.0pt;">
       <span class="ltx_text ltx_font_bold" id="A1.T8.10.10.8.1">
        80.29
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b" id="A1.T8.10.10.9" style="padding-left:3.0pt;padding-right:3.0pt;">
       <span class="ltx_text ltx_font_bold" id="A1.T8.10.10.9.1">
        67.33
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b" id="A1.T8.10.10.10" style="padding-left:3.0pt;padding-right:3.0pt;">
       <span class="ltx_text ltx_font_bold" id="A1.T8.10.10.10.1">
        85.14
       </span>
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
  <section class="ltx_subsection" id="A1.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.1
    </span>
    Other Evaluation Metrics for Machine Translation
   </h3>
   <div class="ltx_para" id="A1.SS1.p1">
    <p class="ltx_p" id="A1.SS1.p1.1">
     We utilize BLEURT
     <span class="ltx_note ltx_role_footnote" id="footnote4">
      <sup class="ltx_note_mark">
       4
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         4
        </sup>
        <span class="ltx_tag ltx_tag_note">
         4
        </span>
        https://huggingface.co/spaces/evaluate-metric/bleurt
       </span>
      </span>
     </span>
     (with the checkpoint of BLEURT-20) and COMET
     <span class="ltx_note ltx_role_footnote" id="footnote5">
      <sup class="ltx_note_mark">
       5
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         5
        </sup>
        <span class="ltx_tag ltx_tag_note">
         5
        </span>
        https://huggingface.co/spaces/evaluate-metric/comet
       </span>
      </span>
     </span>
     (with wmt22-comet-da to obtain features) to evaluate the performance of machine translation, and then compare
     <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p1.1.1">
      M-RAG
     </span>
     with the best baseline method, Selfmem, on the Mixtral 8 × 7B. The results are reported in Table
     <a class="ltx_ref" href="#A1.T8" title="Table 8 ‣ Appendix A Appendix ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       8
      </span>
     </a>
     . Overall, we observe that
     <span class="ltx_text ltx_font_typewriter" id="A1.SS1.p1.1.2">
      M-RAG
     </span>
     consistently outperforms Selfmem across diverse translation datasets, as evidenced by various evaluation metrics.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A1.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.2
    </span>
    Further Discussion
   </h3>
   <div class="ltx_para ltx_noindent" id="A1.SS2.p1">
    <p class="ltx_p" id="A1.SS2.p1.1">
     <span class="ltx_text ltx_font_bold" id="A1.SS2.p1.1.1">
      Q1. Why applying RAG for summarization or translation?
     </span>
    </p>
   </div>
   <div class="ltx_para" id="A1.SS2.p2">
    <p class="ltx_p" id="A1.SS2.p2.1">
     Employing RAG for summarization or translation is based on two key factors: (1) We believe that the two tasks effectively capture the essence of text generation facilitated by LLMs; (2) the widespread adoption of summarization and translation tasks in retrieval-augmented literature
     <cite class="ltx_cite ltx_citemacro_cite">
      Cheng et al. (
      <a class="ltx_ref" href="#bib.bib8" title="">
       2023b
      </a>
      ); Gu et al. (
      <a class="ltx_ref" href="#bib.bib13" title="">
       2018
      </a>
      ); Hossain et al. (
      <a class="ltx_ref" href="#bib.bib16" title="">
       2020
      </a>
      )
     </cite>
     provides a standardized and comparable testbed for benchmarking our method. Here, certain text pairs are stored within an external database, such as (document, summary) pairs for summarization or (context, response) pairs for dialogue generation. These pairs are retrieved from the database and serve as demonstration examples to guide a LLM in conducting text generations. The underlying rationale of this paradigm is that better demonstrations typically prompt better generation outcomes.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A1.SS2.p3">
    <p class="ltx_p" id="A1.SS2.p3.1">
     <span class="ltx_text ltx_font_bold" id="A1.SS2.p3.1.1">
      Q2. Why applying such partitioning, what intuition behind that, instead of improving the quality of retrieval or introduce more dimensions in the scoring function to account for categories/partitions?
     </span>
    </p>
   </div>
   <div class="ltx_para" id="A1.SS2.p4">
    <p class="ltx_p" id="A1.SS2.p4.1">
     We recognize that database partitioning plays a crucial role in efficiently managing a database. However, this aspect has been relatively underexplored in the context of RAG, despite the necessity of accessing an external database to obtain essential information for LLM generation. To address this gap, we investigate a multiple partition paradigm for executing RAG. The rationale behind this approach is intuitive: with various attributes associated with the data in a database, queries should ideally be matched with their corresponding attributed data, thereby filtering out noise data.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS2.p5">
    <p class="ltx_p" id="A1.SS2.p5.1">
     We discuss our choice of employing partitioning for RAG instead of two alternative approaches: (1) improving the quality of retrieval or (2) introduce more dimensions in the scoring function to account for categories/partitions.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS2.p6">
    <p class="ltx_p" id="A1.SS2.p6.1">
     For (1), improving retrieval quality typically emphasizes the effectiveness of AKNN search, often measured using metrics such as recall. However, this focus is not entirely aligned with the primary objective of RAG, which is to generate a good response. In the
     <span class="ltx_text ltx_font_typewriter" id="A1.SS2.p6.1.1">
      M-RAG
     </span>
     framework, we prioritize the quality of LLM generation as an end-to-end metric explicitly guiding the retrieved information.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS2.p7">
    <p class="ltx_p" id="A1.SS2.p7.1">
     For (2), unlike attending to data categories or partitions, we observe that the multiple partition setup offers a cost-effective approach to enhance effectiveness, as confirmed in Figure
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     . In this context, no additional computation associated with the LLM is required. Instead, we can keep the LLM frozen, and explore (via Agent-S) or revise (via Agent-R) a relevant memory. This typically leads to improved generation results for the LLM.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A1.SS2.p8">
    <p class="ltx_p" id="A1.SS2.p8.1">
     <span class="ltx_text ltx_font_bold" id="A1.SS2.p8.1.1">
      Q3. What is the motivation of the Agent-R and the revision of the retrieved memory?
     </span>
    </p>
   </div>
   <div class="ltx_para" id="A1.SS2.p9">
    <p class="ltx_p" id="A1.SS2.p9.1">
     <span class="ltx_text ltx_font_typewriter" id="A1.SS2.p9.1.1">
      M-RAG
     </span>
     involves a Retrieval-then-Generation process employing LLMs, typically containing billions of parameters. Here, the LLM remains frozen while the retrieved memories undergo revision before being fed back into the LLM to enhance results. Common revision operations within the retrieved memory, such as re-ranking content
     <cite class="ltx_cite ltx_citemacro_cite">
      Blagojevi (
      <a class="ltx_ref" href="#bib.bib4" title="">
       2023
      </a>
      )
     </cite>
     , eliminating irrelevant context
     <cite class="ltx_cite ltx_citemacro_cite">
      Anderson et al. (
      <a class="ltx_ref" href="#bib.bib2" title="">
       2022
      </a>
      )
     </cite>
     , summarizing key information
     <cite class="ltx_cite ltx_citemacro_cite">
      Chen et al. (
      <a class="ltx_ref" href="#bib.bib6" title="">
       2023
      </a>
      )
     </cite>
     , and generating candidates for selection
     <cite class="ltx_cite ltx_citemacro_cite">
      Cheng et al. (
      <a class="ltx_ref" href="#bib.bib8" title="">
       2023b
      </a>
      )
     </cite>
     , have been extensively studied in retrieval-augmented literature, as highlighted in the survey paper
     <cite class="ltx_cite ltx_citemacro_cite">
      Gao et al. (
      <a class="ltx_ref" href="#bib.bib11" title="">
       2023
      </a>
      )
     </cite>
     . In our work, we conceptualize memory revision as a Markov Decision Process (MDP) and investigate a reinforcement learning solution employing the proposed Agent-R for this operation.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A1.SS2.p10">
    <p class="ltx_p" id="A1.SS2.p10.1">
     <span class="ltx_text ltx_font_bold" id="A1.SS2.p10.1.1">
      Q4.
      <span class="ltx_text ltx_font_typewriter" id="A1.SS2.p10.1.1.1">
       M-RAG
      </span>
      relies on the partitioning strategy. If the partitions are not well-optimized, it could lead to suboptimal retrieval and generation performance?
     </span>
    </p>
   </div>
   <div class="ltx_para" id="A1.SS2.p11">
    <p class="ltx_p" id="A1.SS2.p11.1">
     The performance of
     <span class="ltx_text ltx_font_typewriter" id="A1.SS2.p11.1.1">
      M-RAG
     </span>
     is preserved through several measures. First, we conduct an empirical study, depicted in Figure
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     , to investigate a partitioning strategy that outperforms retrieval from the entire database. This serves as a prerequisite for achieving performance improvements. Additionally, building upon this prerequisite, the challenge shifts to identifying suitable partitions and enhancing data quality within them, tasks that are addressed concurrently by two agents. As illustrated in the ablation study presented in Table
     <a class="ltx_ref" href="#S4.T5" title="Table 5 ‣ 4.2 Experimental Results ‣ 4 Experiments ‣ M-RAG: Reinforcing Large Language Model Performance through Retrieval-Augmented Generation with Multiple Partitions">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     , performance gains are still attainable even if one agent fails, suggesting that performance improvements can be expected with the
     <span class="ltx_text ltx_font_typewriter" id="A1.SS2.p11.1.2">
      M-RAG
     </span>
     approach.
    </p>
   </div>
  </section>
 </section>
</article>
