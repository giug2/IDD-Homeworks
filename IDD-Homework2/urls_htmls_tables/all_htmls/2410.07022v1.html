<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval</title>
<!--Generated on Wed Oct  9 16:04:51 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.07022v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S1" title="In Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S2" title="In Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3" title="In Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3.SS1" title="In 3 Methodology ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Autoencoders with Strong Variance Constraints (<span class="ltx_text ltx_font_typewriter">AE-SVC</span>)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3.SS2" title="In 3 Methodology ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Single Shot Similarity Space Distillation (<span class="ltx_text ltx_font_typewriter">(SS)<sub class="ltx_sub"><span class="ltx_text ltx_font_serif">2</span></sub>D</span>)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4" title="In Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Theoretical Analysis of <span class="ltx_text ltx_font_typewriter">AE-SVC</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S5" title="In Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S5.SS1" title="In 5 Experiments ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S5.SS2" title="In 5 Experiments ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S5.SS3" title="In 5 Experiments ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Limitations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S6" title="In Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Future Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1" title="In Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS1" title="In Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Invariance of Orthogonal Transformation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS2" title="In Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Cosine Scale Invariance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS3" title="In Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span><span class="ltx_text ltx_font_typewriter">AE-SVC</span> Additional Results with more foundation models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS4" title="In Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span><span class="ltx_text ltx_font_typewriter">(SS)<sub class="ltx_sub"><span class="ltx_text ltx_font_serif">2</span></sub>D</span> Additional Results with more datasets and foundation models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS5" title="In Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span><span class="ltx_text ltx_font_typewriter">AE-SVC</span> Additional Results on the Recall Metric</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS6" title="In Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.6 </span>Hyperparameters</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mohammad Omama, Po-han Li, Sandeep P. Chinchali

<br class="ltx_break"/>The University of Texas at Austin
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id5.1.id1">{mohd.omama,pohanli,sandeepc}@utexas.edu</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id4.4">Image retrieval is crucial in robotics and computer vision, with downstream applications in robot place recognition and vision-based product recommendations. Modern retrieval systems face two key challenges: scalability and efficiency.
State-of-the-art image retrieval systems train specific neural networks for each dataset, an approach that lacks scalability.
Furthermore, since retrieval speed is directly proportional to embedding size, existing systems that use large embeddings lack efficiency.
To tackle scalability, recent works propose using off-the-shelf foundation models. However, these models, though applicable across datasets, fall short in achieving performance comparable to that of dataset-specific models.
Our key observation is that, while foundation models capture necessary subtleties for effective retrieval, the underlying distribution of their embedding space can negatively impact cosine similarity searches.
We introduce Autoencoders with Strong Variance Constraints (<span class="ltx_text ltx_font_typewriter" id="id4.4.3">AE-SVC</span>), which, when used for projection, significantly improves the performance of foundation models. We provide an in-depth theoretical analysis of <span class="ltx_text ltx_font_typewriter" id="id4.4.4">AE-SVC</span>.
Addressing efficiency, we introduce Single-shot Similarity Space Distillation (<span class="ltx_text ltx_font_typewriter" id="id1.1.1">(SS)<sub class="ltx_sub" id="id1.1.1.1"><span class="ltx_text ltx_font_serif" id="id1.1.1.1.1">2</span></sub>D</span>), a novel approach to learn embeddings with adaptive sizes that offers a better trade-off between size and performance.
We conducted extensive experiments on four retrieval datasets, including Stanford Online Products (SoP) and Pittsburgh30k, using four different off-the-shelf foundation models, including DinoV2 and CLIP. <span class="ltx_text ltx_font_typewriter" id="id4.4.5">AE-SVC</span> demonstrates up to a <math alttext="16\%" class="ltx_Math" display="inline" id="id2.2.m1.1"><semantics id="id2.2.m1.1a"><mrow id="id2.2.m1.1.1" xref="id2.2.m1.1.1.cmml"><mn id="id2.2.m1.1.1.2" xref="id2.2.m1.1.1.2.cmml">16</mn><mo id="id2.2.m1.1.1.1" xref="id2.2.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="id2.2.m1.1b"><apply id="id2.2.m1.1.1.cmml" xref="id2.2.m1.1.1"><csymbol cd="latexml" id="id2.2.m1.1.1.1.cmml" xref="id2.2.m1.1.1.1">percent</csymbol><cn id="id2.2.m1.1.1.2.cmml" type="integer" xref="id2.2.m1.1.1.2">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m1.1c">16\%</annotation><annotation encoding="application/x-llamapun" id="id2.2.m1.1d">16 %</annotation></semantics></math> improvement in retrieval performance, while <span class="ltx_text ltx_font_typewriter" id="id3.3.2">(SS)<sub class="ltx_sub" id="id3.3.2.1"><span class="ltx_text ltx_font_serif" id="id3.3.2.1.1">2</span></sub>D</span> shows a further <math alttext="10\%" class="ltx_Math" display="inline" id="id4.4.m2.1"><semantics id="id4.4.m2.1a"><mrow id="id4.4.m2.1.1" xref="id4.4.m2.1.1.cmml"><mn id="id4.4.m2.1.1.2" xref="id4.4.m2.1.1.2.cmml">10</mn><mo id="id4.4.m2.1.1.1" xref="id4.4.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="id4.4.m2.1b"><apply id="id4.4.m2.1.1.cmml" xref="id4.4.m2.1.1"><csymbol cd="latexml" id="id4.4.m2.1.1.1.cmml" xref="id4.4.m2.1.1.1">percent</csymbol><cn id="id4.4.m2.1.1.2.cmml" type="integer" xref="id4.4.m2.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id4.4.m2.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="id4.4.m2.1d">10 %</annotation></semantics></math> improvement for smaller embedding sizes.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Image retrieval involves finding the closest match of a given image (query) in a vast database of images (often called the reference set). It has numerous applications, from product recommendations in e-commerce to place recognition in robotics. In general, state-of-the-art (SOTA) image retrieval systems are dataset-specific. They are trained in a contrastive manner on a training split of the data, typically hand-labeled for positive and negative pairs for each query. Imagine a scenario where a server has a vast reference database of fashion clothing images and receives query images from users to find the closest matches in the reference set. Creating a separate split and hand-labeling positive and negative pairs to train a dataset-specific model is infeasible. A more scalable solution is to use off-the-shelf feature extractors like Dino <cite class="ltx_cite ltx_citemacro_citep">(Caron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib5" title="">2021</a>)</cite>, DinoV2 <cite class="ltx_cite ltx_citemacro_citep">(Oquab et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib22" title="">2024</a>)</cite>, CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib25" title="">2021</a>)</cite>, and ViT <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib7" title="">2021</a>)</cite>.
However, the performance of off-the-shelf feature extractors is generally lower compared to dataset-specific models.
<span class="ltx_text ltx_font_bold" id="S1.p1.1.1">Q1 (Scalability): Is there a way to enhance the performance of these off-the-shelf models in a completely unsupervised way by using just the reference set?</span></p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="294" id="S1.F1.g1" src="extracted/5913932/figs/pipeline.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
<span class="ltx_text ltx_font_bold" id="S1.F1.8.4" style="font-size:90%;">Two-step pipeline for the proposed approach.<span class="ltx_text ltx_font_medium" id="S1.F1.8.4.5"> </span>(A)<span class="ltx_text ltx_font_medium" id="S1.F1.8.4.6"> <span class="ltx_text ltx_font_typewriter" id="S1.F1.8.4.6.1">AE-SVC</span> (discussed in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3.SS1" title="3.1 Autoencoders with Strong Variance Constraints (AE-SVC) ‣ 3 Methodology ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3.1</span></a>) trains an autoencoder with our constraints to improve foundation model embeddings. </span>(B)<span class="ltx_text ltx_font_medium" id="S1.F1.5.1.1"> <span class="ltx_text ltx_font_typewriter" id="S1.F1.5.1.1.1">(SS)<sub class="ltx_sub" id="S1.F1.5.1.1.1.1"><span class="ltx_text ltx_font_serif" id="S1.F1.5.1.1.1.1.1">2</span></sub>D</span> (discussed in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3.SS2" title="3.2 Single Shot Similarity Space Distillation ((SS)2D) ‣ 3 Methodology ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3.2</span></a>) uses the improved embeddings from <span class="ltx_text ltx_font_typewriter" id="S1.F1.5.1.1.2">AE-SVC</span> to learn adaptive embeddings for improved retrieval at any embedding size. </span>(C)<span class="ltx_text ltx_font_medium" id="S1.F1.6.2.2"> Once trained, <span class="ltx_text ltx_font_typewriter" id="S1.F1.6.2.2.1">(SS)<sub class="ltx_sub" id="S1.F1.6.2.2.1.1"><span class="ltx_text ltx_font_serif" id="S1.F1.6.2.2.1.1.1">2</span></sub>D</span> can be directly applied to foundation model embeddings to generate adaptive embeddings for improved retrieval. </span>(D)<span class="ltx_text ltx_font_medium" id="S1.F1.8.4.4"> <span class="ltx_text ltx_font_typewriter" id="S1.F1.8.4.4.3">AE-SVC</span> (orange) boosts performance significantly, while <span class="ltx_text ltx_font_typewriter" id="S1.F1.7.3.3.1">(SS)<sub class="ltx_sub" id="S1.F1.7.3.3.1.1"><span class="ltx_text ltx_font_serif" id="S1.F1.7.3.3.1.1.1">2</span></sub>D</span> (green) further enhances results with smaller embeddings. Dino (blue) achieves optimal performance at 9 GLOPs, whereas <span class="ltx_text ltx_font_typewriter" id="S1.F1.8.4.4.2">(SS)<sub class="ltx_sub" id="S1.F1.8.4.4.2.1"><span class="ltx_text ltx_font_serif" id="S1.F1.8.4.4.2.1.1">2</span></sub>D</span> on top of <span class="ltx_text ltx_font_typewriter" id="S1.F1.8.4.4.4">AE-SVC</span> achieves similar performance at only 2.5 GLOPs.
</span></span></figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.4">Another key problem in retrieval is that the retrieval speed is directly proportional to the size of the embeddings. For an embedding of size <math alttext="d" class="ltx_Math" display="inline" id="S1.p2.1.m1.1"><semantics id="S1.p2.1.m1.1a"><mi id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><ci id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S1.p2.1.m1.1d">italic_d</annotation></semantics></math> and a reference set with <math alttext="N" class="ltx_Math" display="inline" id="S1.p2.2.m2.1"><semantics id="S1.p2.2.m2.1a"><mi id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><ci id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.p2.2.m2.1d">italic_N</annotation></semantics></math> image vectors, the retrieval speed for a single query is <math alttext="O(d\times N)" class="ltx_Math" display="inline" id="S1.p2.3.m3.1"><semantics id="S1.p2.3.m3.1a"><mrow id="S1.p2.3.m3.1.1" xref="S1.p2.3.m3.1.1.cmml"><mi id="S1.p2.3.m3.1.1.3" xref="S1.p2.3.m3.1.1.3.cmml">O</mi><mo id="S1.p2.3.m3.1.1.2" xref="S1.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S1.p2.3.m3.1.1.1.1" xref="S1.p2.3.m3.1.1.1.1.1.cmml"><mo id="S1.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S1.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S1.p2.3.m3.1.1.1.1.1" xref="S1.p2.3.m3.1.1.1.1.1.cmml"><mi id="S1.p2.3.m3.1.1.1.1.1.2" xref="S1.p2.3.m3.1.1.1.1.1.2.cmml">d</mi><mo id="S1.p2.3.m3.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S1.p2.3.m3.1.1.1.1.1.1.cmml">×</mo><mi id="S1.p2.3.m3.1.1.1.1.1.3" xref="S1.p2.3.m3.1.1.1.1.1.3.cmml">N</mi></mrow><mo id="S1.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S1.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.3.m3.1b"><apply id="S1.p2.3.m3.1.1.cmml" xref="S1.p2.3.m3.1.1"><times id="S1.p2.3.m3.1.1.2.cmml" xref="S1.p2.3.m3.1.1.2"></times><ci id="S1.p2.3.m3.1.1.3.cmml" xref="S1.p2.3.m3.1.1.3">𝑂</ci><apply id="S1.p2.3.m3.1.1.1.1.1.cmml" xref="S1.p2.3.m3.1.1.1.1"><times id="S1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S1.p2.3.m3.1.1.1.1.1.1"></times><ci id="S1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S1.p2.3.m3.1.1.1.1.1.2">𝑑</ci><ci id="S1.p2.3.m3.1.1.1.1.1.3.cmml" xref="S1.p2.3.m3.1.1.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.3.m3.1c">O(d\times N)</annotation><annotation encoding="application/x-llamapun" id="S1.p2.3.m3.1d">italic_O ( italic_d × italic_N )</annotation></semantics></math>. This retrieval time becomes significant as the size of the reference set (<math alttext="N" class="ltx_Math" display="inline" id="S1.p2.4.m4.1"><semantics id="S1.p2.4.m4.1a"><mi id="S1.p2.4.m4.1.1" xref="S1.p2.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.p2.4.m4.1b"><ci id="S1.p2.4.m4.1.1.cmml" xref="S1.p2.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.p2.4.m4.1d">italic_N</annotation></semantics></math>) increases, with modern retrieval systems containing millions of images. Additionally, the embedding size directly affects the storage space required for the reference set and the communication bandwidth needed to send the query vector to the server in distributed image retrieval systems, which are common in product recommendations and robotic place recognition. Standard dimensionality reduction techniques, such as Principal Component Analysis (PCA), aim to preserve information, while Autoencoders (AEs) <cite class="ltx_cite ltx_citemacro_citep">(Hinton &amp; Salakhutdinov, <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib12" title="">2006</a>)</cite> and Variational Autoencoders (VAEs) <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Welling, <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib14" title="">2013</a>)</cite> focus on reconstruction quality. However, these methods are not optimized for retrieval tasks. Additionally, learning-based approaches like AEs and VAEs require separate training for each embedding size, which is impractical given varying compute, space, and communication constraints. <span class="ltx_text ltx_font_bold" id="S1.p2.4.1">Q2 (Efficiency): Is there an effective unsupervised dimensionality reduction method that strongly preserves the similarity structure of the full embeddings, and is adaptive, i.e., does not need to be trained for each dimension separately?</span></p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.4"><span class="ltx_text ltx_font_bold" id="S1.p3.4.5">Contributions:</span> To address <span class="ltx_text ltx_font_bold" id="S1.p3.4.6">Q1 (Scalability)</span>, we propose Autoencoders with Strong Variance Constraints (<span class="ltx_text ltx_font_typewriter" id="S1.p3.4.7">AE-SVC</span>). Our primary idea is that, while foundation models capture the necessary details for effective retrieval, the underlying distribution of their embeddings can negatively impact cosine similarity searches. <span class="ltx_text ltx_font_typewriter" id="S1.p3.4.8">AE-SVC</span> trains an autoencoder while enforcing three constraints on the latent space: an orthogonality constraint, a mean centering constraint, and a unit variance constraint. We empirically show and mathematically prove that these constraints cause a shift in the cosine similarity distribution, making it more discriminative. These constraints not only lead to more effective dimensionality reduction but also <span class="ltx_text ltx_font_bold" id="S1.p3.4.9">outperform the complete embeddings of foundation models</span>. We discuss the motivation and technical details of <span class="ltx_text ltx_font_typewriter" id="S1.p3.4.10">AE-SVC</span> in section <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3.SS1" title="3.1 Autoencoders with Strong Variance Constraints (AE-SVC) ‣ 3 Methodology ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3.1</span></a>. We also provide an in-depth mathematical analysis of <span class="ltx_text ltx_font_typewriter" id="S1.p3.4.11">AE-SVC</span> in section <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4" title="4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">4</span></a>. To address <span class="ltx_text ltx_font_bold" id="S1.p3.4.12">Q2 (Efficiency)</span>, we propose Single Shot Similarity Space Distillation (<span class="ltx_text ltx_font_typewriter" id="S1.p3.1.1">(SS)<sub class="ltx_sub" id="S1.p3.1.1.1"><span class="ltx_text ltx_font_serif" id="S1.p3.1.1.1.1">2</span></sub>D</span>). <span class="ltx_text ltx_font_typewriter" id="S1.p3.2.2">(SS)<sub class="ltx_sub" id="S1.p3.2.2.1"><span class="ltx_text ltx_font_serif" id="S1.p3.2.2.1.1">2</span></sub>D</span> aims at reducing embeddings to smaller ones while preserving their similarity relationships. The embedding learned with <span class="ltx_text ltx_font_typewriter" id="S1.p3.3.3">(SS)<sub class="ltx_sub" id="S1.p3.3.3.1"><span class="ltx_text ltx_font_serif" id="S1.p3.3.3.1.1">2</span></sub>D</span> is adaptive, <span class="ltx_text ltx_font_italic" id="S1.p3.4.13">i.e.</span>, smaller segments of the output embedding also perform well in retrieval tasks. In summary, our approach consists of two steps (as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">1</span></a>): first, we use <span class="ltx_text ltx_font_typewriter" id="S1.p3.4.14">AE-SVC</span> to enhance the baseline performance of foundation models. Then, we leverage the improved embeddings as a teacher for efficient dimensionality reduction through <span class="ltx_text ltx_font_typewriter" id="S1.p3.4.4">(SS)<sub class="ltx_sub" id="S1.p3.4.4.1"><span class="ltx_text ltx_font_serif" id="S1.p3.4.4.1.1">2</span></sub>D</span>.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.5">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">1</span></a>(D) also shows the retrieval performance versus retrieval speed in giga-FLOPs (floating operations) on the Pittsburgh30K dataset <cite class="ltx_cite ltx_citemacro_citep">(Torii et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib33" title="">2013</a>)</cite> using the Dino model <cite class="ltx_cite ltx_citemacro_citep">(Caron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib5" title="">2021</a>)</cite>. Note that retrieval speed is a function of the dimension <math alttext="d" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mi id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">italic_d</annotation></semantics></math> and the reference set size <math alttext="N" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mi id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><ci id="S1.p4.2.m2.1.1.cmml" xref="S1.p4.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">italic_N</annotation></semantics></math>, <math alttext="O(d\times N)" class="ltx_Math" display="inline" id="S1.p4.3.m3.1"><semantics id="S1.p4.3.m3.1a"><mrow id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml"><mi id="S1.p4.3.m3.1.1.3" xref="S1.p4.3.m3.1.1.3.cmml">O</mi><mo id="S1.p4.3.m3.1.1.2" xref="S1.p4.3.m3.1.1.2.cmml">⁢</mo><mrow id="S1.p4.3.m3.1.1.1.1" xref="S1.p4.3.m3.1.1.1.1.1.cmml"><mo id="S1.p4.3.m3.1.1.1.1.2" stretchy="false" xref="S1.p4.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S1.p4.3.m3.1.1.1.1.1" xref="S1.p4.3.m3.1.1.1.1.1.cmml"><mi id="S1.p4.3.m3.1.1.1.1.1.2" xref="S1.p4.3.m3.1.1.1.1.1.2.cmml">d</mi><mo id="S1.p4.3.m3.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S1.p4.3.m3.1.1.1.1.1.1.cmml">×</mo><mi id="S1.p4.3.m3.1.1.1.1.1.3" xref="S1.p4.3.m3.1.1.1.1.1.3.cmml">N</mi></mrow><mo id="S1.p4.3.m3.1.1.1.1.3" stretchy="false" xref="S1.p4.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><apply id="S1.p4.3.m3.1.1.cmml" xref="S1.p4.3.m3.1.1"><times id="S1.p4.3.m3.1.1.2.cmml" xref="S1.p4.3.m3.1.1.2"></times><ci id="S1.p4.3.m3.1.1.3.cmml" xref="S1.p4.3.m3.1.1.3">𝑂</ci><apply id="S1.p4.3.m3.1.1.1.1.1.cmml" xref="S1.p4.3.m3.1.1.1.1"><times id="S1.p4.3.m3.1.1.1.1.1.1.cmml" xref="S1.p4.3.m3.1.1.1.1.1.1"></times><ci id="S1.p4.3.m3.1.1.1.1.1.2.cmml" xref="S1.p4.3.m3.1.1.1.1.1.2">𝑑</ci><ci id="S1.p4.3.m3.1.1.1.1.1.3.cmml" xref="S1.p4.3.m3.1.1.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">O(d\times N)</annotation><annotation encoding="application/x-llamapun" id="S1.p4.3.m3.1d">italic_O ( italic_d × italic_N )</annotation></semantics></math>, with <math alttext="N=17,000" class="ltx_Math" display="inline" id="S1.p4.4.m4.2"><semantics id="S1.p4.4.m4.2a"><mrow id="S1.p4.4.m4.2.3" xref="S1.p4.4.m4.2.3.cmml"><mi id="S1.p4.4.m4.2.3.2" xref="S1.p4.4.m4.2.3.2.cmml">N</mi><mo id="S1.p4.4.m4.2.3.1" xref="S1.p4.4.m4.2.3.1.cmml">=</mo><mrow id="S1.p4.4.m4.2.3.3.2" xref="S1.p4.4.m4.2.3.3.1.cmml"><mn id="S1.p4.4.m4.1.1" xref="S1.p4.4.m4.1.1.cmml">17</mn><mo id="S1.p4.4.m4.2.3.3.2.1" xref="S1.p4.4.m4.2.3.3.1.cmml">,</mo><mn id="S1.p4.4.m4.2.2" xref="S1.p4.4.m4.2.2.cmml">000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.4.m4.2b"><apply id="S1.p4.4.m4.2.3.cmml" xref="S1.p4.4.m4.2.3"><eq id="S1.p4.4.m4.2.3.1.cmml" xref="S1.p4.4.m4.2.3.1"></eq><ci id="S1.p4.4.m4.2.3.2.cmml" xref="S1.p4.4.m4.2.3.2">𝑁</ci><list id="S1.p4.4.m4.2.3.3.1.cmml" xref="S1.p4.4.m4.2.3.3.2"><cn id="S1.p4.4.m4.1.1.cmml" type="integer" xref="S1.p4.4.m4.1.1">17</cn><cn id="S1.p4.4.m4.2.2.cmml" type="integer" xref="S1.p4.4.m4.2.2">000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.4.m4.2c">N=17,000</annotation><annotation encoding="application/x-llamapun" id="S1.p4.4.m4.2d">italic_N = 17 , 000</annotation></semantics></math> for Pittsburgh30K. The performance of PCA (blue) represents the default off-the-shelf Dino model. We can see that <span class="ltx_text ltx_font_typewriter" id="S1.p4.5.2">AE-SVC</span> (orange) significantly enhances the performance of the off-the-shelf Dino model (blue). Notice that it outperforms the complete Dino embedding. Applying <span class="ltx_text ltx_font_typewriter" id="S1.p4.5.1">(SS)<sub class="ltx_sub" id="S1.p4.5.1.1"><span class="ltx_text ltx_font_serif" id="S1.p4.5.1.1.1">2</span></sub>D</span> on top of <span class="ltx_text ltx_font_typewriter" id="S1.p4.5.3">AE-SVC</span> further improves retrieval performance at smaller embedding sizes (green). Section <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S5" title="5 Experiments ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">5</span></a> experimentally shows the advantages of the proposed approaches in detail on four different datasets using different foundation models.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Deep Metric Learning:</span>
Image retrieval is modeled as a Deep Metric Learning (DML) problem <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib37" title="">2017</a>)</cite>. DML focuses on learning latent representations where similar items are close and dissimilar items are far apart. Various techniques have been proposed <cite class="ltx_cite ltx_citemacro_citep">(Oh Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib20" title="">2016</a>; Schroff et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib28" title="">2015</a>; Ustinova &amp; Lempitsky, <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib36" title="">2016</a>; Sohn, <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib30" title="">2016</a>; Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib38" title="">2019</a>)</cite> to learn meaningful latent representations for effective retrieval, including contrastive loss <cite class="ltx_cite ltx_citemacro_citep">(Hadsell et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib10" title="">2006</a>)</cite> and triplet loss <cite class="ltx_cite ltx_citemacro_citep">(Schroff et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib28" title="">2015</a>)</cite>. More recent works use advanced N-pair loss <cite class="ltx_cite ltx_citemacro_citep">(Sohn, <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib30" title="">2016</a>)</cite> or multi-similarity loss <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib38" title="">2019</a>)</cite>. Analogous to image retrieval, Visual Place Recognition (VPR) is also modeled as a DML problem <cite class="ltx_cite ltx_citemacro_citep">(Garg et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib8" title="">2021</a>)</cite>. Various training objectives have been proposed for VPR <cite class="ltx_cite ltx_citemacro_citep">(Ge et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib9" title="">2020</a>; Xiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib40" title="">2023</a>; Leyva-Vallina et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib16" title="">2023</a>; Berton et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib3" title="">2022</a>)</cite> to learn latent representations for effective retrieval. However, all of these approaches are dataset-specific, meaning they train specific neural networks for each dataset.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Foundation Models in Image Retrieval:</span>
The rise of foundation models, such as DINOv2 <cite class="ltx_cite ltx_citemacro_citep">(Oquab et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib22" title="">2024</a>)</cite>, CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib25" title="">2021</a>)</cite>, ViT <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib7" title="">2021</a>)</cite>, has allowed recent works to explore the applicability of these off-the-shelf models in image retrieval. As shown in <cite class="ltx_cite ltx_citemacro_citep">(Keetha et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib13" title="">2023</a>; Lu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib19" title="">2024</a>)</cite>, off-the-shelf models, in some cases, can have comparable retrieval performance to dataset-specific models. However, these approaches either use the off-the-shelf models as-is <cite class="ltx_cite ltx_citemacro_citep">(Keetha et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib13" title="">2023</a>)</cite> or adapt them using a labeled held-out dataset <cite class="ltx_cite ltx_citemacro_citep">(Lu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib19" title="">2024</a>)</cite>. In stark contrast, our approach, <span class="ltx_text ltx_font_typewriter" id="S2.p2.1.2">AE-SVC</span>, exploits the inherent properties of the distribution to improve the performance of these off-the-shelf models without requiring any labeled data.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Distribution Constraints in Semi-supervised Representation Learning:</span>
Semi-supervised learning has seen significant advances with methods that leverage self-supervised objectives to learn robust representations. A notable approach is Barlow Twins, which employs an additional cross-correlation loss to align representations while minimizing redundancy across dimensions, promoting feature decorrelation <cite class="ltx_cite ltx_citemacro_citep">(Zbontar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib42" title="">2021</a>)</cite>. Extending this idea, VICReg introduces an additional variance constraint that ensures sufficient spread in the learned features, preventing collapse and further enhancing representation quality <cite class="ltx_cite ltx_citemacro_citep">(Bardes et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib2" title="">2022</a>)</cite>. However, to date, no work has specifically explored the impact of such constraints in the context of autoencoders for retrieval tasks. In this paper, we are the first to address this gap, providing a comprehensive theoretical analysis of these constraints and their impact on retrieval.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1"><span class="ltx_text ltx_font_bold" id="S2.p4.1.1">Similarity Preserving Knowledge Distillation:</span>
Similarity preserving knowledge distillation (SPKD) focuses on transferring knowledge from a teacher model to a student model, similar to standard distillation <cite class="ltx_cite ltx_citemacro_citep">(Hinton et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib11" title="">2015</a>; Buciluǎ et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib4" title="">2006</a>; Ba &amp; Caruana, <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib1" title="">2014</a>; Zagoruyko &amp; Komodakis, <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib41" title="">2017</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib43" title="">2019</a>; Passalis &amp; Tefas, <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib24" title="">2018</a>)</cite>, while maintaining the structure of similarity of the data in the feature space. One of the pioneering works in this area is the FitNets approach, which uses intermediate representations to guide the student model <cite class="ltx_cite ltx_citemacro_citep">(Romero et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib26" title="">2014</a>)</cite>. The attention transfer method extends this by aligning the attention maps of the student and teacher models <cite class="ltx_cite ltx_citemacro_citep">(Zagoruyko &amp; Komodakis, <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib41" title="">2017</a>)</cite>. More recent advancements include <cite class="ltx_cite ltx_citemacro_citep">(Tung &amp; Mori, <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib35" title="">2019</a>)</cite>, which explicitly preserves pairwise similarities between data points in the feature space during distillation. Contrastive Representation Distillation (CRD) further improves performance by using contrastive loss to maximize mutual information between teacher and student representations <cite class="ltx_cite ltx_citemacro_citep">(Tian et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib32" title="">2020</a>)</cite>. Additionally, the Relational Knowledge Distillation (RKD) approach emphasizes the importance of preserving the relational knowledge among data points <cite class="ltx_cite ltx_citemacro_citep">(Park et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib23" title="">2019</a>)</cite>. All of these works focus on training a lightweight student network to mimic a heavy teacher network.
We are the first to explore this idea in a dimensionality reduction setting for image retrieval.</p>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.1"><span class="ltx_text ltx_font_bold" id="S2.p5.1.1">Adaptive Feature Embeddings:</span>
A core requirement for dimensionality reduction in retrieval systems is adaptive embeddings due to varying compute constraints. Previous works on adaptive feature embeddings have created efficient and adaptive embedding spaces for compression <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib17" title="">2023</a>)</cite> and image classification <cite class="ltx_cite ltx_citemacro_citep">(Kusupati et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib15" title="">2022</a>)</cite>, while ours focuses on image retrieval. The key idea is to use only one neural network model to output a feature embedding ensuring that smaller sub-chunks of the embedding also perform well in retrieval tasks.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We now formally define the image retrieval problem:</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.10">Suppose we have a query set <math alttext="Q" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_Q</annotation></semantics></math> of <math alttext="M" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_M</annotation></semantics></math> query image feature vectors and a reference set <math alttext="R" class="ltx_Math" display="inline" id="S3.p2.3.m3.1"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">italic_R</annotation></semantics></math> of <math alttext="N" class="ltx_Math" display="inline" id="S3.p2.4.m4.1"><semantics id="S3.p2.4.m4.1a"><mi id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m4.1d">italic_N</annotation></semantics></math> reference image feature vectors, where each vector is <math alttext="d" class="ltx_Math" display="inline" id="S3.p2.5.m5.1"><semantics id="S3.p2.5.m5.1a"><mi id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m5.1d">italic_d</annotation></semantics></math>-dimensional. Given <math alttext="q_{j}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.p2.6.m6.1"><semantics id="S3.p2.6.m6.1a"><mrow id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><msub id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml"><mi id="S3.p2.6.m6.1.1.2.2" xref="S3.p2.6.m6.1.1.2.2.cmml">q</mi><mi id="S3.p2.6.m6.1.1.2.3" xref="S3.p2.6.m6.1.1.2.3.cmml">j</mi></msub><mo id="S3.p2.6.m6.1.1.1" xref="S3.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml"><mi id="S3.p2.6.m6.1.1.3.2" xref="S3.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mi id="S3.p2.6.m6.1.1.3.3" xref="S3.p2.6.m6.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><in id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1.1"></in><apply id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.2.1.cmml" xref="S3.p2.6.m6.1.1.2">subscript</csymbol><ci id="S3.p2.6.m6.1.1.2.2.cmml" xref="S3.p2.6.m6.1.1.2.2">𝑞</ci><ci id="S3.p2.6.m6.1.1.2.3.cmml" xref="S3.p2.6.m6.1.1.2.3">𝑗</ci></apply><apply id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.3.1.cmml" xref="S3.p2.6.m6.1.1.3">superscript</csymbol><ci id="S3.p2.6.m6.1.1.3.2.cmml" xref="S3.p2.6.m6.1.1.3.2">ℝ</ci><ci id="S3.p2.6.m6.1.1.3.3.cmml" xref="S3.p2.6.m6.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">q_{j}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.6.m6.1d">italic_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> randomly drawn from <math alttext="Q" class="ltx_Math" display="inline" id="S3.p2.7.m7.1"><semantics id="S3.p2.7.m7.1a"><mi id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><ci id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.p2.7.m7.1d">italic_Q</annotation></semantics></math>, the task is to identify the feature vector <math alttext="r_{i}" class="ltx_Math" display="inline" id="S3.p2.8.m8.1"><semantics id="S3.p2.8.m8.1a"><msub id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml"><mi id="S3.p2.8.m8.1.1.2" xref="S3.p2.8.m8.1.1.2.cmml">r</mi><mi id="S3.p2.8.m8.1.1.3" xref="S3.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><apply id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.1.cmml" xref="S3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.p2.8.m8.1.1.2.cmml" xref="S3.p2.8.m8.1.1.2">𝑟</ci><ci id="S3.p2.8.m8.1.1.3.cmml" xref="S3.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">r_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.8.m8.1d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="R" class="ltx_Math" display="inline" id="S3.p2.9.m9.1"><semantics id="S3.p2.9.m9.1a"><mi id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><ci id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.p2.9.m9.1d">italic_R</annotation></semantics></math> that has the smallest distance or highest similarity with <math alttext="q_{j}" class="ltx_Math" display="inline" id="S3.p2.10.m10.1"><semantics id="S3.p2.10.m10.1a"><msub id="S3.p2.10.m10.1.1" xref="S3.p2.10.m10.1.1.cmml"><mi id="S3.p2.10.m10.1.1.2" xref="S3.p2.10.m10.1.1.2.cmml">q</mi><mi id="S3.p2.10.m10.1.1.3" xref="S3.p2.10.m10.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.10.m10.1b"><apply id="S3.p2.10.m10.1.1.cmml" xref="S3.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p2.10.m10.1.1.1.cmml" xref="S3.p2.10.m10.1.1">subscript</csymbol><ci id="S3.p2.10.m10.1.1.2.cmml" xref="S3.p2.10.m10.1.1.2">𝑞</ci><ci id="S3.p2.10.m10.1.1.3.cmml" xref="S3.p2.10.m10.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m10.1c">q_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.10.m10.1d">italic_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>. This can be mathematically expressed as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{i}=\arg\min_{r\in R}\mathrm{dis}(q_{j},r)," class="ltx_Math" display="block" id="S3.Ex1.m1.2"><semantics id="S3.Ex1.m1.2a"><mrow id="S3.Ex1.m1.2.2.1" xref="S3.Ex1.m1.2.2.1.1.cmml"><mrow id="S3.Ex1.m1.2.2.1.1" xref="S3.Ex1.m1.2.2.1.1.cmml"><msub id="S3.Ex1.m1.2.2.1.1.3" xref="S3.Ex1.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1.m1.2.2.1.1.3.2" xref="S3.Ex1.m1.2.2.1.1.3.2.cmml">r</mi><mi id="S3.Ex1.m1.2.2.1.1.3.3" xref="S3.Ex1.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1.m1.2.2.1.1.2" xref="S3.Ex1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m1.2.2.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.cmml"><mrow id="S3.Ex1.m1.2.2.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.3.1" xref="S3.Ex1.m1.2.2.1.1.1.3.1.cmml">arg</mi><mo id="S3.Ex1.m1.2.2.1.1.1.3a" lspace="0.167em" xref="S3.Ex1.m1.2.2.1.1.1.3.cmml">⁡</mo><mrow id="S3.Ex1.m1.2.2.1.1.1.3.2" xref="S3.Ex1.m1.2.2.1.1.1.3.2.cmml"><munder id="S3.Ex1.m1.2.2.1.1.1.3.2.1" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.3.2.1.2" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1.2.cmml">min</mi><mrow id="S3.Ex1.m1.2.2.1.1.1.3.2.1.3" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.2" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.2.cmml">r</mi><mo id="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.1" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.1.cmml">∈</mo><mi id="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.3" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.3.cmml">R</mi></mrow></munder><mo id="S3.Ex1.m1.2.2.1.1.1.3.2a" lspace="0.167em" xref="S3.Ex1.m1.2.2.1.1.1.3.2.cmml">⁡</mo><mi id="S3.Ex1.m1.2.2.1.1.1.3.2.2" xref="S3.Ex1.m1.2.2.1.1.1.3.2.2.cmml">dis</mi></mrow></mrow><mo id="S3.Ex1.m1.2.2.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.2.2.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.Ex1.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="S3.Ex1.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.Ex1.m1.2.2.1.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">r</mi><mo id="S3.Ex1.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S3.Ex1.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1.m1.2.2.1.2" xref="S3.Ex1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.2b"><apply id="S3.Ex1.m1.2.2.1.1.cmml" xref="S3.Ex1.m1.2.2.1"><eq id="S3.Ex1.m1.2.2.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.2"></eq><apply id="S3.Ex1.m1.2.2.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1.m1.2.2.1.1.3.2">𝑟</ci><ci id="S3.Ex1.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1.m1.2.2.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1"><times id="S3.Ex1.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2"></times><apply id="S3.Ex1.m1.2.2.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3"><arg id="S3.Ex1.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.1"></arg><apply id="S3.Ex1.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.2"><apply id="S3.Ex1.m1.2.2.1.1.1.3.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.3.2.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1">subscript</csymbol><min id="S3.Ex1.m1.2.2.1.1.1.3.2.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1.2"></min><apply id="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1.3"><in id="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.1"></in><ci id="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.2">𝑟</ci><ci id="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.2.1.3.3">𝑅</ci></apply></apply><ci id="S3.Ex1.m1.2.2.1.1.1.3.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.2.2">dis</ci></apply></apply><interval closure="open" id="S3.Ex1.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1"><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.3">𝑗</ci></apply><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝑟</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.2c">r_{i}=\arg\min_{r\in R}\mathrm{dis}(q_{j},r),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.2d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_r ∈ italic_R end_POSTSUBSCRIPT roman_dis ( italic_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_r ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p2.13">with the distance <math alttext="\mathrm{dis}" class="ltx_Math" display="inline" id="S3.p2.11.m1.1"><semantics id="S3.p2.11.m1.1a"><mi id="S3.p2.11.m1.1.1" xref="S3.p2.11.m1.1.1.cmml">dis</mi><annotation-xml encoding="MathML-Content" id="S3.p2.11.m1.1b"><ci id="S3.p2.11.m1.1.1.cmml" xref="S3.p2.11.m1.1.1">dis</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m1.1c">\mathrm{dis}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.11.m1.1d">roman_dis</annotation></semantics></math> generally based on cosine similarity, i.e., <math alttext="\mathrm{dis}(q_{j},r_{i})=1-\mathrm{cos}(q_{j},r_{i})" class="ltx_Math" display="inline" id="S3.p2.12.m2.4"><semantics id="S3.p2.12.m2.4a"><mrow id="S3.p2.12.m2.4.4" xref="S3.p2.12.m2.4.4.cmml"><mrow id="S3.p2.12.m2.2.2.2" xref="S3.p2.12.m2.2.2.2.cmml"><mi id="S3.p2.12.m2.2.2.2.4" xref="S3.p2.12.m2.2.2.2.4.cmml">dis</mi><mo id="S3.p2.12.m2.2.2.2.3" xref="S3.p2.12.m2.2.2.2.3.cmml">⁢</mo><mrow id="S3.p2.12.m2.2.2.2.2.2" xref="S3.p2.12.m2.2.2.2.2.3.cmml"><mo id="S3.p2.12.m2.2.2.2.2.2.3" stretchy="false" xref="S3.p2.12.m2.2.2.2.2.3.cmml">(</mo><msub id="S3.p2.12.m2.1.1.1.1.1.1" xref="S3.p2.12.m2.1.1.1.1.1.1.cmml"><mi id="S3.p2.12.m2.1.1.1.1.1.1.2" xref="S3.p2.12.m2.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.p2.12.m2.1.1.1.1.1.1.3" xref="S3.p2.12.m2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.p2.12.m2.2.2.2.2.2.4" xref="S3.p2.12.m2.2.2.2.2.3.cmml">,</mo><msub id="S3.p2.12.m2.2.2.2.2.2.2" xref="S3.p2.12.m2.2.2.2.2.2.2.cmml"><mi id="S3.p2.12.m2.2.2.2.2.2.2.2" xref="S3.p2.12.m2.2.2.2.2.2.2.2.cmml">r</mi><mi id="S3.p2.12.m2.2.2.2.2.2.2.3" xref="S3.p2.12.m2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.p2.12.m2.2.2.2.2.2.5" stretchy="false" xref="S3.p2.12.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.p2.12.m2.4.4.5" xref="S3.p2.12.m2.4.4.5.cmml">=</mo><mrow id="S3.p2.12.m2.4.4.4" xref="S3.p2.12.m2.4.4.4.cmml"><mn id="S3.p2.12.m2.4.4.4.4" xref="S3.p2.12.m2.4.4.4.4.cmml">1</mn><mo id="S3.p2.12.m2.4.4.4.3" xref="S3.p2.12.m2.4.4.4.3.cmml">−</mo><mrow id="S3.p2.12.m2.4.4.4.2" xref="S3.p2.12.m2.4.4.4.2.cmml"><mi id="S3.p2.12.m2.4.4.4.2.4" xref="S3.p2.12.m2.4.4.4.2.4.cmml">cos</mi><mo id="S3.p2.12.m2.4.4.4.2.3" xref="S3.p2.12.m2.4.4.4.2.3.cmml">⁢</mo><mrow id="S3.p2.12.m2.4.4.4.2.2.2" xref="S3.p2.12.m2.4.4.4.2.2.3.cmml"><mo id="S3.p2.12.m2.4.4.4.2.2.2.3" stretchy="false" xref="S3.p2.12.m2.4.4.4.2.2.3.cmml">(</mo><msub id="S3.p2.12.m2.3.3.3.1.1.1.1" xref="S3.p2.12.m2.3.3.3.1.1.1.1.cmml"><mi id="S3.p2.12.m2.3.3.3.1.1.1.1.2" xref="S3.p2.12.m2.3.3.3.1.1.1.1.2.cmml">q</mi><mi id="S3.p2.12.m2.3.3.3.1.1.1.1.3" xref="S3.p2.12.m2.3.3.3.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.p2.12.m2.4.4.4.2.2.2.4" xref="S3.p2.12.m2.4.4.4.2.2.3.cmml">,</mo><msub id="S3.p2.12.m2.4.4.4.2.2.2.2" xref="S3.p2.12.m2.4.4.4.2.2.2.2.cmml"><mi id="S3.p2.12.m2.4.4.4.2.2.2.2.2" xref="S3.p2.12.m2.4.4.4.2.2.2.2.2.cmml">r</mi><mi id="S3.p2.12.m2.4.4.4.2.2.2.2.3" xref="S3.p2.12.m2.4.4.4.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.p2.12.m2.4.4.4.2.2.2.5" stretchy="false" xref="S3.p2.12.m2.4.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.12.m2.4b"><apply id="S3.p2.12.m2.4.4.cmml" xref="S3.p2.12.m2.4.4"><eq id="S3.p2.12.m2.4.4.5.cmml" xref="S3.p2.12.m2.4.4.5"></eq><apply id="S3.p2.12.m2.2.2.2.cmml" xref="S3.p2.12.m2.2.2.2"><times id="S3.p2.12.m2.2.2.2.3.cmml" xref="S3.p2.12.m2.2.2.2.3"></times><ci id="S3.p2.12.m2.2.2.2.4.cmml" xref="S3.p2.12.m2.2.2.2.4">dis</ci><interval closure="open" id="S3.p2.12.m2.2.2.2.2.3.cmml" xref="S3.p2.12.m2.2.2.2.2.2"><apply id="S3.p2.12.m2.1.1.1.1.1.1.cmml" xref="S3.p2.12.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.12.m2.1.1.1.1.1.1.1.cmml" xref="S3.p2.12.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.12.m2.1.1.1.1.1.1.2.cmml" xref="S3.p2.12.m2.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.p2.12.m2.1.1.1.1.1.1.3.cmml" xref="S3.p2.12.m2.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.p2.12.m2.2.2.2.2.2.2.cmml" xref="S3.p2.12.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.12.m2.2.2.2.2.2.2.1.cmml" xref="S3.p2.12.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p2.12.m2.2.2.2.2.2.2.2.cmml" xref="S3.p2.12.m2.2.2.2.2.2.2.2">𝑟</ci><ci id="S3.p2.12.m2.2.2.2.2.2.2.3.cmml" xref="S3.p2.12.m2.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S3.p2.12.m2.4.4.4.cmml" xref="S3.p2.12.m2.4.4.4"><minus id="S3.p2.12.m2.4.4.4.3.cmml" xref="S3.p2.12.m2.4.4.4.3"></minus><cn id="S3.p2.12.m2.4.4.4.4.cmml" type="integer" xref="S3.p2.12.m2.4.4.4.4">1</cn><apply id="S3.p2.12.m2.4.4.4.2.cmml" xref="S3.p2.12.m2.4.4.4.2"><times id="S3.p2.12.m2.4.4.4.2.3.cmml" xref="S3.p2.12.m2.4.4.4.2.3"></times><ci id="S3.p2.12.m2.4.4.4.2.4.cmml" xref="S3.p2.12.m2.4.4.4.2.4">cos</ci><interval closure="open" id="S3.p2.12.m2.4.4.4.2.2.3.cmml" xref="S3.p2.12.m2.4.4.4.2.2.2"><apply id="S3.p2.12.m2.3.3.3.1.1.1.1.cmml" xref="S3.p2.12.m2.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.12.m2.3.3.3.1.1.1.1.1.cmml" xref="S3.p2.12.m2.3.3.3.1.1.1.1">subscript</csymbol><ci id="S3.p2.12.m2.3.3.3.1.1.1.1.2.cmml" xref="S3.p2.12.m2.3.3.3.1.1.1.1.2">𝑞</ci><ci id="S3.p2.12.m2.3.3.3.1.1.1.1.3.cmml" xref="S3.p2.12.m2.3.3.3.1.1.1.1.3">𝑗</ci></apply><apply id="S3.p2.12.m2.4.4.4.2.2.2.2.cmml" xref="S3.p2.12.m2.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.12.m2.4.4.4.2.2.2.2.1.cmml" xref="S3.p2.12.m2.4.4.4.2.2.2.2">subscript</csymbol><ci id="S3.p2.12.m2.4.4.4.2.2.2.2.2.cmml" xref="S3.p2.12.m2.4.4.4.2.2.2.2.2">𝑟</ci><ci id="S3.p2.12.m2.4.4.4.2.2.2.2.3.cmml" xref="S3.p2.12.m2.4.4.4.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m2.4c">\mathrm{dis}(q_{j},r_{i})=1-\mathrm{cos}(q_{j},r_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.p2.12.m2.4d">roman_dis ( italic_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = 1 - roman_cos ( italic_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\mathrm{cos}" class="ltx_Math" display="inline" id="S3.p2.13.m3.1"><semantics id="S3.p2.13.m3.1a"><mi id="S3.p2.13.m3.1.1" xref="S3.p2.13.m3.1.1.cmml">cos</mi><annotation-xml encoding="MathML-Content" id="S3.p2.13.m3.1b"><ci id="S3.p2.13.m3.1.1.cmml" xref="S3.p2.13.m3.1.1">cos</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.13.m3.1c">\mathrm{cos}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.13.m3.1d">roman_cos</annotation></semantics></math> denotes the cosine similarity.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.4">We will now describe our approach in detail. First, we will explain the step-by-step procedure for <span class="ltx_text ltx_font_typewriter" id="S3.p3.4.3">AE-SVC</span>. Next, we will present an in-depth explanation of <span class="ltx_text ltx_font_typewriter" id="S3.p3.1.1">(SS)<sub class="ltx_sub" id="S3.p3.1.1.1"><span class="ltx_text ltx_font_serif" id="S3.p3.1.1.1.1">2</span></sub>D</span>. Note that both <span class="ltx_text ltx_font_typewriter" id="S3.p3.4.4">AE-SVC</span> and <span class="ltx_text ltx_font_typewriter" id="S3.p3.2.2">(SS)<sub class="ltx_sub" id="S3.p3.2.2.1"><span class="ltx_text ltx_font_serif" id="S3.p3.2.2.1.1">2</span></sub>D</span> utilize only the reference set <math alttext="R" class="ltx_Math" display="inline" id="S3.p3.3.m1.1"><semantics id="S3.p3.3.m1.1a"><mi id="S3.p3.3.m1.1.1" xref="S3.p3.3.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.p3.3.m1.1b"><ci id="S3.p3.3.m1.1.1.cmml" xref="S3.p3.3.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m1.1d">italic_R</annotation></semantics></math> during the training time. The query set <math alttext="Q" class="ltx_Math" display="inline" id="S3.p3.4.m2.1"><semantics id="S3.p3.4.m2.1a"><mi id="S3.p3.4.m2.1.1" xref="S3.p3.4.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.p3.4.m2.1b"><ci id="S3.p3.4.m2.1.1.cmml" xref="S3.p3.4.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m2.1d">italic_Q</annotation></semantics></math> is assumed to be unavailable to the user during training. A standard assumption when doing dimensionality reduction in image retrieval settings <cite class="ltx_cite ltx_citemacro_citep">(Keetha et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib13" title="">2023</a>)</cite>.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Autoencoders with Strong Variance Constraints (<span class="ltx_text ltx_font_typewriter" id="S3.SS1.1.1">AE-SVC</span>)</h3>
<figure class="ltx_figure ltx_align_floatright" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="270" id="S3.F2.g1" src="extracted/5913932/figs/method_vapca_motivation.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span> <span class="ltx_text ltx_font_bold" id="S3.F2.2.1" style="font-size:90%;">In standard dimensionality reduction (say PCA), cosine similarity is disproportionately influenced by high-variance dimensions, leading to poor retrieval.<span class="ltx_text ltx_font_medium" id="S3.F2.2.1.1"> Given a task to match the query with the correct clothing type. A query image of a white man in a tank-top may be incorrectly matched to a white man in a half-shirt due to the dominant person dimension. Ideally, both orthogonal dimensions should have an equal influence on cosine similarity.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p1.1.1">Motivation:</span> Our primary motivation for <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.2">AE-SVC</span> is that, while foundation models capture necessary subtleties for effective retrieval, the underlying distribution of their embedding space can negatively impact cosine similarity searches. In Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4" title="4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">4</span></a>, we discuss in mathematical detail that the discriminative power of the retrieval task is maximized when the variance of the cosine similarity distribution is minimized. <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.3">AE-SVC</span> introduces three constraints on the latent space: an orthogonality constraint, a mean centering constraint, and a unit variance constraint.
In Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4" title="4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">4</span></a>, we prove that these constraints on the latent space minimize the variance of the cosine similarity distribution. We now provide a more intuitive explanation of why these constraints are helpful. Consider the example illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3.F2" title="Figure 2 ‣ 3.1 Autoencoders with Strong Variance Constraints (AE-SVC) ‣ 3 Methodology ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">2</span></a>. We have a reference set comprising four categories of clothing: men’s tank-tops, men’s half-shirts, women’s tank-tops, and women’s half-shirts. The task is to match the query with the correct clothing type. After applying dimensionality reduction (like a standard PCA) to the reference set, we obtain two orthogonal dimensions: a person dimension (with high variance) and a shirt shape dimension (with low variance). If similarity is overly dependent on the high-variance dimension, as shown mathematically in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4" title="4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">4</span></a>, retrieval performance suffers. For instance, a query for a white man in a tank-top might incorrectly match with a white man in a half-shirt due to the dominant person dimension. Ideally, we need a space where both the person and shirt dimensions equally influence the distinction between men and women, as well as between half-shirts and tank-tops. The goal of <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.4">AE-SVC</span> is to learn a projection from the reference set <math alttext="R" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_R</annotation></semantics></math> such that the latent dimensions are orthogonal and have equal variance.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.7"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.7.2">Approach:</span>. <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p2.7.3">AE-SVC</span> (as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">1</span></a><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.7.4">(A)</span>) takes an input embedding <math alttext="I\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">I</mi><mo id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><in id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"></in><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝐼</ci><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">I\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_I ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> coming from the foundation model, encodes it to a latent representation <math alttext="z\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">z</mi><mo id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><in id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1"></in><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝑧</ci><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">ℝ</ci><ci id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">z\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, and produces a reconstruction <math alttext="I^{\prime}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><msup id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2.2" xref="S3.SS1.p2.3.m3.1.1.2.2.cmml">I</mi><mo id="S3.SS1.p2.3.m3.1.1.2.3" xref="S3.SS1.p2.3.m3.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><in id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"></in><apply id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.2">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2">𝐼</ci><ci id="S3.SS1.p2.3.m3.1.1.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.2.3">′</ci></apply><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">I^{\prime}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_I start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>. We have three additional losses to enforce the constraints mentioned above: an orthogonality constraint, a mean centering constraint, and a unit variance constraint. Note that we can choose any size for the latent representation <math alttext="z" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_z</annotation></semantics></math>. We show the results for multiple sizes of <math alttext="z" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_z</annotation></semantics></math>. However, since <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p2.7.5">AE-SVC</span> is used to guide <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p2.6.1">(SS)<sub class="ltx_sub" id="S3.SS1.p2.6.1.1"><span class="ltx_text ltx_font_serif" id="S3.SS1.p2.6.1.1.1">2</span></sub>D</span> later, we will use the best performing embedding, i.e., <math alttext="z\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m6.1"><semantics id="S3.SS1.p2.7.m6.1a"><mrow id="S3.SS1.p2.7.m6.1.1" xref="S3.SS1.p2.7.m6.1.1.cmml"><mi id="S3.SS1.p2.7.m6.1.1.2" xref="S3.SS1.p2.7.m6.1.1.2.cmml">z</mi><mo id="S3.SS1.p2.7.m6.1.1.1" xref="S3.SS1.p2.7.m6.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.7.m6.1.1.3" xref="S3.SS1.p2.7.m6.1.1.3.cmml"><mi id="S3.SS1.p2.7.m6.1.1.3.2" xref="S3.SS1.p2.7.m6.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.7.m6.1.1.3.3" xref="S3.SS1.p2.7.m6.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m6.1b"><apply id="S3.SS1.p2.7.m6.1.1.cmml" xref="S3.SS1.p2.7.m6.1.1"><in id="S3.SS1.p2.7.m6.1.1.1.cmml" xref="S3.SS1.p2.7.m6.1.1.1"></in><ci id="S3.SS1.p2.7.m6.1.1.2.cmml" xref="S3.SS1.p2.7.m6.1.1.2">𝑧</ci><apply id="S3.SS1.p2.7.m6.1.1.3.cmml" xref="S3.SS1.p2.7.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m6.1.1.3.1.cmml" xref="S3.SS1.p2.7.m6.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.7.m6.1.1.3.2.cmml" xref="S3.SS1.p2.7.m6.1.1.3.2">ℝ</ci><ci id="S3.SS1.p2.7.m6.1.1.3.3.cmml" xref="S3.SS1.p2.7.m6.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m6.1c">z\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m6.1d">italic_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, for this guidance.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.2"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.2.1">Reconstruction Loss:</span> We minimize the Mean Squared Error (MSE) between the input embedding <math alttext="I" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_I</annotation></semantics></math> and the reconstruction <math alttext="I^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><msup id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">I</mi><mo id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝐼</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">I^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_I start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{rec}}=\frac{1}{n}\sum_{i=1}^{n}\|I_{i}-I^{\prime}_{i}\|^{2}%
_{2}," class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3a.cmml">rec</mtext></msub><mo id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mfrac id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml"><mn id="S3.E1.m1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.E1.m1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.3.3.cmml">n</mi></mfrac><mo id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><munderover id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.3.cmml">n</mi></munderover><msubsup id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">I</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">I</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">′</mo></msubsup></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></eq><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E1.m1.1.1.1.1.3.3a.cmml" xref="S3.E1.m1.1.1.1.1.3.3"><mtext id="S3.E1.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.1.1.3.3">rec</mtext></ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3"><divide id="S3.E1.m1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.3"></divide><cn id="S3.E1.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.3.2">1</cn><ci id="S3.E1.m1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E1.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐼</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝐼</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.3">′</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3">2</cn></apply><cn id="S3.E1.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\mathcal{L}_{\text{rec}}=\frac{1}{n}\sum_{i=1}^{n}\|I_{i}-I^{\prime}_{i}\|^{2}%
_{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">caligraphic_L start_POSTSUBSCRIPT rec end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∥ italic_I start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_I start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.3">where <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m1.1"><semantics id="S3.SS1.p3.3.m1.1a"><mi id="S3.SS1.p3.3.m1.1.1" xref="S3.SS1.p3.3.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m1.1b"><ci id="S3.SS1.p3.3.m1.1.1.cmml" xref="S3.SS1.p3.3.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m1.1d">italic_n</annotation></semantics></math> is the number of samples.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.5"><span class="ltx_text ltx_font_bold" id="S3.SS1.p4.5.1">Covariance Loss:</span> To promote orthogonality, we penalize off-diagonal terms of the covariance matrix:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{cov}}=\left\|\frac{1}{n}(Z-\mu)^{\top}(Z-\mu)-\mathbb{I}%
\right\|_{F}^{2}," class="ltx_Math" display="block" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3a.cmml">cov</mtext></msub><mo id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml">=</mo><msubsup id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mfrac id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.cmml"><mn id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.2.cmml">1</mn><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.3.cmml">n</mi></mfrac><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><msup id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">Z</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">μ</mi></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3a" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.2" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml">Z</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml">−</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml">μ</mi></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.3" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.4.cmml">𝕀</mi></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mi id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml">F</mi><mn id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"></eq><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E2.m1.1.1.1.1.3.3a.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><mtext id="S3.E2.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E2.m1.1.1.1.1.3.3">cov</mtext></ci></apply><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1"><minus id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.3"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4"><divide id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4"></divide><cn id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.2.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.2">1</cn><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.4.3">𝑛</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑍</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝜇</ci></apply><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3">top</csymbol></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1"><minus id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.1"></minus><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.2">𝑍</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2.2.1.1.3">𝜇</ci></apply></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.4">𝕀</ci></apply></apply><ci id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3">𝐹</ci></apply><cn id="S3.E2.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\mathcal{L}_{\text{cov}}=\left\|\frac{1}{n}(Z-\mu)^{\top}(Z-\mu)-\mathbb{I}%
\right\|_{F}^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">caligraphic_L start_POSTSUBSCRIPT cov end_POSTSUBSCRIPT = ∥ divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ( italic_Z - italic_μ ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ( italic_Z - italic_μ ) - blackboard_I ∥ start_POSTSUBSCRIPT italic_F end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p4.4">where <math alttext="Z\in\mathbb{R}^{n\times d}" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">Z</mi><mo id="S3.SS1.p4.1.m1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml"><mi id="S3.SS1.p4.1.m1.1.1.3.2" xref="S3.SS1.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.1.m1.1.1.3.3" xref="S3.SS1.p4.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p4.1.m1.1.1.3.3.2" xref="S3.SS1.p4.1.m1.1.1.3.3.2.cmml">n</mi><mo id="S3.SS1.p4.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p4.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p4.1.m1.1.1.3.3.3" xref="S3.SS1.p4.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><in id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1"></in><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝑍</ci><apply id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.3.1.cmml" xref="S3.SS1.p4.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.3.2.cmml" xref="S3.SS1.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p4.1.m1.1.1.3.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3.3"><times id="S3.SS1.p4.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p4.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p4.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p4.1.m1.1.1.3.3.2">𝑛</ci><ci id="S3.SS1.p4.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">Z\in\mathbb{R}^{n\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">italic_Z ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the matrix of latent representations, <math alttext="\mu\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">μ</mi><mo id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml"><mi id="S3.SS1.p4.2.m2.1.1.3.2" xref="S3.SS1.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p4.2.m2.1.1.3.3" xref="S3.SS1.p4.2.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><in id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1"></in><ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">𝜇</ci><apply id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.3.1.cmml" xref="S3.SS1.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.3.2.cmml" xref="S3.SS1.p4.2.m2.1.1.3.2">ℝ</ci><ci id="S3.SS1.p4.2.m2.1.1.3.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\mu\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">italic_μ ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the mean of <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m3.1"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m3.1d">italic_Z</annotation></semantics></math>, and <math alttext="\mathbb{I}" class="ltx_Math" display="inline" id="S3.SS1.p4.4.m4.1"><semantics id="S3.SS1.p4.4.m4.1a"><mi id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml">𝕀</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><ci id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">𝕀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">\mathbb{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.4.m4.1d">blackboard_I</annotation></semantics></math> is the identity matrix.</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.7"><span class="ltx_text ltx_font_bold" id="S3.SS1.p5.7.1">Variance Loss:</span> We constrain the variance of each latent dimension to be one:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{var}}=\frac{1}{d}\sum_{i=1}^{d}\left(\text{Var}(z^{i})-1%
\right)^{2}," class="ltx_Math" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E3.m1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.3.3a.cmml">var</mtext></msub><mo id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mfrac id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml"><mn id="S3.E3.m1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.E3.m1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.3.3.cmml">d</mi></mfrac><mo id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><munderover id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E3.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml">d</mi></munderover><msup id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">Var</mtext><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E3.m1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2"></eq><apply id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E3.m1.1.1.1.1.3.3a.cmml" xref="S3.E3.m1.1.1.1.1.3.3"><mtext id="S3.E3.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E3.m1.1.1.1.1.3.3">var</mtext></ci></apply><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2"></times><apply id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3"><divide id="S3.E3.m1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.3"></divide><cn id="S3.E3.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.3.2">1</cn><ci id="S3.E3.m1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3.3">𝑑</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><apply id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3"><eq id="S3.E3.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E3.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1"><minus id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3">Var</mtext></ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><cn id="S3.E3.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\mathcal{L}_{\text{var}}=\frac{1}{d}\sum_{i=1}^{d}\left(\text{Var}(z^{i})-1%
\right)^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">caligraphic_L start_POSTSUBSCRIPT var end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_d end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT ( Var ( italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) - 1 ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p5.6">where <math alttext="z^{i}" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><msup id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml"><mi id="S3.SS1.p5.1.m1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.2.cmml">z</mi><mi id="S3.SS1.p5.1.m1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.p5.1.m1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1.2">𝑧</ci><ci id="S3.SS1.p5.1.m1.1.1.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">z^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.1d">italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p5.2.m2.1"><semantics id="S3.SS1.p5.2.m2.1a"><mi id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><ci id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.2.m2.1d">italic_i</annotation></semantics></math>-th latent dimension of <math alttext="z" class="ltx_Math" display="inline" id="S3.SS1.p5.3.m3.1"><semantics id="S3.SS1.p5.3.m3.1a"><mi id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.1b"><ci id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.3.m3.1d">italic_z</annotation></semantics></math> and <math alttext="\text{Var}(z^{i})" class="ltx_Math" display="inline" id="S3.SS1.p5.4.m4.1"><semantics id="S3.SS1.p5.4.m4.1a"><mrow id="S3.SS1.p5.4.m4.1.1" xref="S3.SS1.p5.4.m4.1.1.cmml"><mtext id="S3.SS1.p5.4.m4.1.1.3" xref="S3.SS1.p5.4.m4.1.1.3a.cmml">Var</mtext><mo id="S3.SS1.p5.4.m4.1.1.2" xref="S3.SS1.p5.4.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p5.4.m4.1.1.1.1" xref="S3.SS1.p5.4.m4.1.1.1.1.1.cmml"><mo id="S3.SS1.p5.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS1.p5.4.m4.1.1.1.1.1.cmml">(</mo><msup id="S3.SS1.p5.4.m4.1.1.1.1.1" xref="S3.SS1.p5.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS1.p5.4.m4.1.1.1.1.1.2" xref="S3.SS1.p5.4.m4.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS1.p5.4.m4.1.1.1.1.1.3" xref="S3.SS1.p5.4.m4.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S3.SS1.p5.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS1.p5.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m4.1b"><apply id="S3.SS1.p5.4.m4.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1"><times id="S3.SS1.p5.4.m4.1.1.2.cmml" xref="S3.SS1.p5.4.m4.1.1.2"></times><ci id="S3.SS1.p5.4.m4.1.1.3a.cmml" xref="S3.SS1.p5.4.m4.1.1.3"><mtext id="S3.SS1.p5.4.m4.1.1.3.cmml" xref="S3.SS1.p5.4.m4.1.1.3">Var</mtext></ci><apply id="S3.SS1.p5.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p5.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p5.4.m4.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS1.p5.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p5.4.m4.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m4.1c">\text{Var}(z^{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.4.m4.1d">Var ( italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT )</annotation></semantics></math> is the variance of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p5.5.m5.1"><semantics id="S3.SS1.p5.5.m5.1a"><mi id="S3.SS1.p5.5.m5.1.1" xref="S3.SS1.p5.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.5.m5.1b"><ci id="S3.SS1.p5.5.m5.1.1.cmml" xref="S3.SS1.p5.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.5.m5.1d">italic_i</annotation></semantics></math>-th latent dimension across all <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.p5.6.m6.1"><semantics id="S3.SS1.p5.6.m6.1a"><mi id="S3.SS1.p5.6.m6.1.1" xref="S3.SS1.p5.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.6.m6.1b"><ci id="S3.SS1.p5.6.m6.1.1.cmml" xref="S3.SS1.p5.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.6.m6.1d">italic_n</annotation></semantics></math> samples.</p>
</div>
<div class="ltx_para" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.4"><span class="ltx_text ltx_font_bold" id="S3.SS1.p6.4.1">Mean-Centering Loss:</span> To ensure the latent space is centered around zero, we minimize the mean of the latent dimensions:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{mean}}=\frac{1}{d}\sum_{i=1}^{d}(\mu^{i})^{2}," class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3a.cmml">mean</mtext></msub><mo id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mfrac id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml"><mn id="S3.E4.m1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.E4.m1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.3.3.cmml">d</mi></mfrac><mo id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><munderover id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E4.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E4.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E4.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E4.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E4.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.1.1.2.3.cmml">d</mi></munderover><msup id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"></eq><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E4.m1.1.1.1.1.3.3a.cmml" xref="S3.E4.m1.1.1.1.1.3.3"><mtext id="S3.E4.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.3.3">mean</mtext></ci></apply><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3"><divide id="S3.E4.m1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.3"></divide><cn id="S3.E4.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.3.2">1</cn><ci id="S3.E4.m1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3">𝑑</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><apply id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E4.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.2.3"><eq id="S3.E4.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E4.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2">𝜇</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><cn id="S3.E4.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\mathcal{L}_{\text{mean}}=\frac{1}{d}\sum_{i=1}^{d}(\mu^{i})^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">caligraphic_L start_POSTSUBSCRIPT mean end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_d end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT ( italic_μ start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p6.3">where <math alttext="\mu^{i}" class="ltx_Math" display="inline" id="S3.SS1.p6.1.m1.1"><semantics id="S3.SS1.p6.1.m1.1a"><msup id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml"><mi id="S3.SS1.p6.1.m1.1.1.2" xref="S3.SS1.p6.1.m1.1.1.2.cmml">μ</mi><mi id="S3.SS1.p6.1.m1.1.1.3" xref="S3.SS1.p6.1.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><apply id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.p6.1.m1.1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.1.2">𝜇</ci><ci id="S3.SS1.p6.1.m1.1.1.3.cmml" xref="S3.SS1.p6.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">\mu^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.1.m1.1d">italic_μ start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is the mean of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p6.2.m2.1"><semantics id="S3.SS1.p6.2.m2.1a"><mi id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><ci id="S3.SS1.p6.2.m2.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.2.m2.1d">italic_i</annotation></semantics></math>-th latent dimension across all <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.p6.3.m3.1"><semantics id="S3.SS1.p6.3.m3.1a"><mi id="S3.SS1.p6.3.m3.1.1" xref="S3.SS1.p6.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.3.m3.1b"><ci id="S3.SS1.p6.3.m3.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p6.3.m3.1d">italic_n</annotation></semantics></math> samples.</p>
</div>
<div class="ltx_para" id="S3.SS1.p7">
<p class="ltx_p" id="S3.SS1.p7.5"><span class="ltx_text ltx_font_bold" id="S3.SS1.p7.5.1">Total Loss:</span> The final objective combines all four losses:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{AE-SVC}}=\lambda_{\text{rec}}\mathcal{L}_{\text{rec}}+%
\lambda_{\text{cov}}\mathcal{L}_{\text{cov}}+\lambda_{\text{var}}\mathcal{L}_{%
\text{var}}+\lambda_{\text{mean}}\mathcal{L}_{\text{mean}}" class="ltx_Math" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><msub id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.2.2" xref="S3.E5.m1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E5.m1.1.1.2.3" xref="S3.E5.m1.1.1.2.3a.cmml">AE-SVC</mtext></msub><mo id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mrow id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml"><msub id="S3.E5.m1.1.1.3.2.2" xref="S3.E5.m1.1.1.3.2.2.cmml"><mi id="S3.E5.m1.1.1.3.2.2.2" xref="S3.E5.m1.1.1.3.2.2.2.cmml">λ</mi><mtext id="S3.E5.m1.1.1.3.2.2.3" xref="S3.E5.m1.1.1.3.2.2.3a.cmml">rec</mtext></msub><mo id="S3.E5.m1.1.1.3.2.1" xref="S3.E5.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E5.m1.1.1.3.2.3" xref="S3.E5.m1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.3.2.3.2" xref="S3.E5.m1.1.1.3.2.3.2.cmml">ℒ</mi><mtext id="S3.E5.m1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.3.2.3.3a.cmml">rec</mtext></msub></mrow><mo id="S3.E5.m1.1.1.3.1" xref="S3.E5.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><msub id="S3.E5.m1.1.1.3.3.2" xref="S3.E5.m1.1.1.3.3.2.cmml"><mi id="S3.E5.m1.1.1.3.3.2.2" xref="S3.E5.m1.1.1.3.3.2.2.cmml">λ</mi><mtext id="S3.E5.m1.1.1.3.3.2.3" xref="S3.E5.m1.1.1.3.3.2.3a.cmml">cov</mtext></msub><mo id="S3.E5.m1.1.1.3.3.1" xref="S3.E5.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E5.m1.1.1.3.3.3" xref="S3.E5.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.3.3.3.2" xref="S3.E5.m1.1.1.3.3.3.2.cmml">ℒ</mi><mtext id="S3.E5.m1.1.1.3.3.3.3" xref="S3.E5.m1.1.1.3.3.3.3a.cmml">cov</mtext></msub></mrow><mo id="S3.E5.m1.1.1.3.1a" xref="S3.E5.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.3.4" xref="S3.E5.m1.1.1.3.4.cmml"><msub id="S3.E5.m1.1.1.3.4.2" xref="S3.E5.m1.1.1.3.4.2.cmml"><mi id="S3.E5.m1.1.1.3.4.2.2" xref="S3.E5.m1.1.1.3.4.2.2.cmml">λ</mi><mtext id="S3.E5.m1.1.1.3.4.2.3" xref="S3.E5.m1.1.1.3.4.2.3a.cmml">var</mtext></msub><mo id="S3.E5.m1.1.1.3.4.1" xref="S3.E5.m1.1.1.3.4.1.cmml">⁢</mo><msub id="S3.E5.m1.1.1.3.4.3" xref="S3.E5.m1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.3.4.3.2" xref="S3.E5.m1.1.1.3.4.3.2.cmml">ℒ</mi><mtext id="S3.E5.m1.1.1.3.4.3.3" xref="S3.E5.m1.1.1.3.4.3.3a.cmml">var</mtext></msub></mrow><mo id="S3.E5.m1.1.1.3.1b" xref="S3.E5.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E5.m1.1.1.3.5" xref="S3.E5.m1.1.1.3.5.cmml"><msub id="S3.E5.m1.1.1.3.5.2" xref="S3.E5.m1.1.1.3.5.2.cmml"><mi id="S3.E5.m1.1.1.3.5.2.2" xref="S3.E5.m1.1.1.3.5.2.2.cmml">λ</mi><mtext id="S3.E5.m1.1.1.3.5.2.3" xref="S3.E5.m1.1.1.3.5.2.3a.cmml">mean</mtext></msub><mo id="S3.E5.m1.1.1.3.5.1" xref="S3.E5.m1.1.1.3.5.1.cmml">⁢</mo><msub id="S3.E5.m1.1.1.3.5.3" xref="S3.E5.m1.1.1.3.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.3.5.3.2" xref="S3.E5.m1.1.1.3.5.3.2.cmml">ℒ</mi><mtext id="S3.E5.m1.1.1.3.5.3.3" xref="S3.E5.m1.1.1.3.5.3.3a.cmml">mean</mtext></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"></eq><apply id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.2.2">ℒ</ci><ci id="S3.E5.m1.1.1.2.3a.cmml" xref="S3.E5.m1.1.1.2.3"><mtext id="S3.E5.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.2.3">AE-SVC</mtext></ci></apply><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><plus id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3.1"></plus><apply id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2"><times id="S3.E5.m1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.3.2.1"></times><apply id="S3.E5.m1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2.2">𝜆</ci><ci id="S3.E5.m1.1.1.3.2.2.3a.cmml" xref="S3.E5.m1.1.1.3.2.2.3"><mtext id="S3.E5.m1.1.1.3.2.2.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.3.2.2.3">rec</mtext></ci></apply><apply id="S3.E5.m1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.3.2.3.2">ℒ</ci><ci id="S3.E5.m1.1.1.3.2.3.3a.cmml" xref="S3.E5.m1.1.1.3.2.3.3"><mtext id="S3.E5.m1.1.1.3.2.3.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.3.2.3.3">rec</mtext></ci></apply></apply><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><times id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3.1"></times><apply id="S3.E5.m1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.1.1.3.3.2.2">𝜆</ci><ci id="S3.E5.m1.1.1.3.3.2.3a.cmml" xref="S3.E5.m1.1.1.3.3.2.3"><mtext id="S3.E5.m1.1.1.3.3.2.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.3.3.2.3">cov</mtext></ci></apply><apply id="S3.E5.m1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.3.2">ℒ</ci><ci id="S3.E5.m1.1.1.3.3.3.3a.cmml" xref="S3.E5.m1.1.1.3.3.3.3"><mtext id="S3.E5.m1.1.1.3.3.3.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.3.3.3.3">cov</mtext></ci></apply></apply><apply id="S3.E5.m1.1.1.3.4.cmml" xref="S3.E5.m1.1.1.3.4"><times id="S3.E5.m1.1.1.3.4.1.cmml" xref="S3.E5.m1.1.1.3.4.1"></times><apply id="S3.E5.m1.1.1.3.4.2.cmml" xref="S3.E5.m1.1.1.3.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.4.2.1.cmml" xref="S3.E5.m1.1.1.3.4.2">subscript</csymbol><ci id="S3.E5.m1.1.1.3.4.2.2.cmml" xref="S3.E5.m1.1.1.3.4.2.2">𝜆</ci><ci id="S3.E5.m1.1.1.3.4.2.3a.cmml" xref="S3.E5.m1.1.1.3.4.2.3"><mtext id="S3.E5.m1.1.1.3.4.2.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.3.4.2.3">var</mtext></ci></apply><apply id="S3.E5.m1.1.1.3.4.3.cmml" xref="S3.E5.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.4.3.1.cmml" xref="S3.E5.m1.1.1.3.4.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.4.3.2.cmml" xref="S3.E5.m1.1.1.3.4.3.2">ℒ</ci><ci id="S3.E5.m1.1.1.3.4.3.3a.cmml" xref="S3.E5.m1.1.1.3.4.3.3"><mtext id="S3.E5.m1.1.1.3.4.3.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.3.4.3.3">var</mtext></ci></apply></apply><apply id="S3.E5.m1.1.1.3.5.cmml" xref="S3.E5.m1.1.1.3.5"><times id="S3.E5.m1.1.1.3.5.1.cmml" xref="S3.E5.m1.1.1.3.5.1"></times><apply id="S3.E5.m1.1.1.3.5.2.cmml" xref="S3.E5.m1.1.1.3.5.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.5.2.1.cmml" xref="S3.E5.m1.1.1.3.5.2">subscript</csymbol><ci id="S3.E5.m1.1.1.3.5.2.2.cmml" xref="S3.E5.m1.1.1.3.5.2.2">𝜆</ci><ci id="S3.E5.m1.1.1.3.5.2.3a.cmml" xref="S3.E5.m1.1.1.3.5.2.3"><mtext id="S3.E5.m1.1.1.3.5.2.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.3.5.2.3">mean</mtext></ci></apply><apply id="S3.E5.m1.1.1.3.5.3.cmml" xref="S3.E5.m1.1.1.3.5.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.5.3.1.cmml" xref="S3.E5.m1.1.1.3.5.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.5.3.2.cmml" xref="S3.E5.m1.1.1.3.5.3.2">ℒ</ci><ci id="S3.E5.m1.1.1.3.5.3.3a.cmml" xref="S3.E5.m1.1.1.3.5.3.3"><mtext id="S3.E5.m1.1.1.3.5.3.3.cmml" mathsize="70%" xref="S3.E5.m1.1.1.3.5.3.3">mean</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathcal{L}_{\text{AE-SVC}}=\lambda_{\text{rec}}\mathcal{L}_{\text{rec}}+%
\lambda_{\text{cov}}\mathcal{L}_{\text{cov}}+\lambda_{\text{var}}\mathcal{L}_{%
\text{var}}+\lambda_{\text{mean}}\mathcal{L}_{\text{mean}}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">caligraphic_L start_POSTSUBSCRIPT AE-SVC end_POSTSUBSCRIPT = italic_λ start_POSTSUBSCRIPT rec end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT rec end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT cov end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT cov end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT var end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT var end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT mean end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT mean end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p7.4">where <math alttext="\lambda_{\text{rec}},\lambda_{\text{cov}},\lambda_{\text{var}}," class="ltx_Math" display="inline" id="S3.SS1.p7.1.m1.1"><semantics id="S3.SS1.p7.1.m1.1a"><mrow id="S3.SS1.p7.1.m1.1.1.1"><mrow id="S3.SS1.p7.1.m1.1.1.1.1.3" xref="S3.SS1.p7.1.m1.1.1.1.1.4.cmml"><msub id="S3.SS1.p7.1.m1.1.1.1.1.1.1" xref="S3.SS1.p7.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p7.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p7.1.m1.1.1.1.1.1.1.2.cmml">λ</mi><mtext id="S3.SS1.p7.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p7.1.m1.1.1.1.1.1.1.3a.cmml">rec</mtext></msub><mo id="S3.SS1.p7.1.m1.1.1.1.1.3.4" xref="S3.SS1.p7.1.m1.1.1.1.1.4.cmml">,</mo><msub id="S3.SS1.p7.1.m1.1.1.1.1.2.2" xref="S3.SS1.p7.1.m1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p7.1.m1.1.1.1.1.2.2.2" xref="S3.SS1.p7.1.m1.1.1.1.1.2.2.2.cmml">λ</mi><mtext id="S3.SS1.p7.1.m1.1.1.1.1.2.2.3" xref="S3.SS1.p7.1.m1.1.1.1.1.2.2.3a.cmml">cov</mtext></msub><mo id="S3.SS1.p7.1.m1.1.1.1.1.3.5" xref="S3.SS1.p7.1.m1.1.1.1.1.4.cmml">,</mo><msub id="S3.SS1.p7.1.m1.1.1.1.1.3.3" xref="S3.SS1.p7.1.m1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p7.1.m1.1.1.1.1.3.3.2" xref="S3.SS1.p7.1.m1.1.1.1.1.3.3.2.cmml">λ</mi><mtext id="S3.SS1.p7.1.m1.1.1.1.1.3.3.3" xref="S3.SS1.p7.1.m1.1.1.1.1.3.3.3a.cmml">var</mtext></msub></mrow><mo id="S3.SS1.p7.1.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.1.m1.1b"><list id="S3.SS1.p7.1.m1.1.1.1.1.4.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.3"><apply id="S3.SS1.p7.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p7.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.1.1.2">𝜆</ci><ci id="S3.SS1.p7.1.m1.1.1.1.1.1.1.3a.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.1.1.3"><mtext id="S3.SS1.p7.1.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p7.1.m1.1.1.1.1.1.1.3">rec</mtext></ci></apply><apply id="S3.SS1.p7.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p7.1.m1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p7.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.2.2.2">𝜆</ci><ci id="S3.SS1.p7.1.m1.1.1.1.1.2.2.3a.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.2.2.3"><mtext id="S3.SS1.p7.1.m1.1.1.1.1.2.2.3.cmml" mathsize="70%" xref="S3.SS1.p7.1.m1.1.1.1.1.2.2.3">cov</mtext></ci></apply><apply id="S3.SS1.p7.1.m1.1.1.1.1.3.3.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p7.1.m1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p7.1.m1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.3.3.2">𝜆</ci><ci id="S3.SS1.p7.1.m1.1.1.1.1.3.3.3a.cmml" xref="S3.SS1.p7.1.m1.1.1.1.1.3.3.3"><mtext id="S3.SS1.p7.1.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.SS1.p7.1.m1.1.1.1.1.3.3.3">var</mtext></ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.1.m1.1c">\lambda_{\text{rec}},\lambda_{\text{cov}},\lambda_{\text{var}},</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.1.m1.1d">italic_λ start_POSTSUBSCRIPT rec end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT cov end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT var end_POSTSUBSCRIPT ,</annotation></semantics></math> and <math alttext="\lambda_{\text{mean}}" class="ltx_Math" display="inline" id="S3.SS1.p7.2.m2.1"><semantics id="S3.SS1.p7.2.m2.1a"><msub id="S3.SS1.p7.2.m2.1.1" xref="S3.SS1.p7.2.m2.1.1.cmml"><mi id="S3.SS1.p7.2.m2.1.1.2" xref="S3.SS1.p7.2.m2.1.1.2.cmml">λ</mi><mtext id="S3.SS1.p7.2.m2.1.1.3" xref="S3.SS1.p7.2.m2.1.1.3a.cmml">mean</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.2.m2.1b"><apply id="S3.SS1.p7.2.m2.1.1.cmml" xref="S3.SS1.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.2.m2.1.1.1.cmml" xref="S3.SS1.p7.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p7.2.m2.1.1.2.cmml" xref="S3.SS1.p7.2.m2.1.1.2">𝜆</ci><ci id="S3.SS1.p7.2.m2.1.1.3a.cmml" xref="S3.SS1.p7.2.m2.1.1.3"><mtext id="S3.SS1.p7.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.p7.2.m2.1.1.3">mean</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.2.m2.1c">\lambda_{\text{mean}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.2.m2.1d">italic_λ start_POSTSUBSCRIPT mean end_POSTSUBSCRIPT</annotation></semantics></math> are hyperparameters discussed in <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS6" title="A.6 Hyperparameters ‣ Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">A.6</span></a>. By optimizing this loss, AE-SVC learns a latent space that improves retrieval performance through accurate reconstruction, decorrelated and normalized feature dimensions, and a zero-centered mean.
The latent representation, <math alttext="z\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS1.p7.3.m3.1"><semantics id="S3.SS1.p7.3.m3.1a"><mrow id="S3.SS1.p7.3.m3.1.1" xref="S3.SS1.p7.3.m3.1.1.cmml"><mi id="S3.SS1.p7.3.m3.1.1.2" xref="S3.SS1.p7.3.m3.1.1.2.cmml">z</mi><mo id="S3.SS1.p7.3.m3.1.1.1" xref="S3.SS1.p7.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p7.3.m3.1.1.3" xref="S3.SS1.p7.3.m3.1.1.3.cmml"><mi id="S3.SS1.p7.3.m3.1.1.3.2" xref="S3.SS1.p7.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p7.3.m3.1.1.3.3" xref="S3.SS1.p7.3.m3.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.3.m3.1b"><apply id="S3.SS1.p7.3.m3.1.1.cmml" xref="S3.SS1.p7.3.m3.1.1"><in id="S3.SS1.p7.3.m3.1.1.1.cmml" xref="S3.SS1.p7.3.m3.1.1.1"></in><ci id="S3.SS1.p7.3.m3.1.1.2.cmml" xref="S3.SS1.p7.3.m3.1.1.2">𝑧</ci><apply id="S3.SS1.p7.3.m3.1.1.3.cmml" xref="S3.SS1.p7.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p7.3.m3.1.1.3.1.cmml" xref="S3.SS1.p7.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p7.3.m3.1.1.3.2.cmml" xref="S3.SS1.p7.3.m3.1.1.3.2">ℝ</ci><ci id="S3.SS1.p7.3.m3.1.1.3.3.cmml" xref="S3.SS1.p7.3.m3.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.3.m3.1c">z\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.3.m3.1d">italic_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, is then used to guide the training of <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p7.4.1">(SS)<sub class="ltx_sub" id="S3.SS1.p7.4.1.1"><span class="ltx_text ltx_font_serif" id="S3.SS1.p7.4.1.1.1">2</span></sub>D</span>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Single Shot Similarity Space Distillation (<span class="ltx_text ltx_font_typewriter" id="S3.SS2.1.1">(SS)<sub class="ltx_sub" id="S3.SS2.1.1.1"><span class="ltx_text ltx_font_serif" id="S3.SS2.1.1.1.1">2</span></sub>D</span>)</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.3"><span class="ltx_text ltx_font_bold" id="S3.SS2.p1.3.1">Motivation: </span> As previously mentioned, embedding size significantly impacts retrieval speed. For an embedding of size <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_d</annotation></semantics></math> and a reference set with <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_N</annotation></semantics></math> image vectors, the retrieval speed for a single query is <math alttext="O(d\times N)" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">O</mi><mo id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.3.m3.1.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.3.m3.1.1.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.1.1.1.2" xref="S3.SS2.p1.3.m3.1.1.1.1.1.2.cmml">d</mi><mo id="S3.SS2.p1.3.m3.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.3.m3.1.1.1.1.1.1.cmml">×</mo><mi id="S3.SS2.p1.3.m3.1.1.1.1.1.3" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3.cmml">N</mi></mrow><mo id="S3.SS2.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><times id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2"></times><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑂</ci><apply id="S3.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1"><times id="S3.SS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.1"></times><ci id="S3.SS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.2">𝑑</ci><ci id="S3.SS2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">O(d\times N)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_O ( italic_d × italic_N )</annotation></semantics></math>. Therefore, it is crucial to reduce the embedding size while maintaining performance.
Standard dimensionality reduction techniques, such as PCA, Autoencoders (AEs), and Variational Autoencoders (VAEs), are not optimized for retrieval. Additionally, AEs and VAEs require separate training for each embedding size, which is impractical given varying computational constraints.
Therefore, there is a need for adaptive embeddings that maintain retrieval performance and are flexible, ensuring that smaller sub-chunks of the embedding also perform well in retrieval tasks.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.2"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.2.3">Approach:</span> Previous works have employed Similarity-Preserving Knowledge Distillation (SPKD) both in hidden layer activations <cite class="ltx_cite ltx_citemacro_citep">(Smith et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib29" title="">2023</a>)</cite> and output layers <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib39" title="">2022</a>)</cite>. SPKD trains a student network to ensure that input pairs producing similar (or dissimilar) activations in the teacher network yield similar (or dissimilar) activations in the student network. However, these studies have not explored similarity-preserving distillation for efficient dimensionality reduction. Our approach is conceptually similar to SPKD, but rather than focusing on network distillation (teacher to student), we perform embedding-level distillation, reducing a large embedding to a smaller one while preserving similarity relationships. Using SPKD directly for dimensionality reduction requires training separate networks for each dimension size. Previous works on adaptive embeddings have utilized random projections in a distributed compression setting <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib17" title="">2023</a>)</cite> or optimized multi-class classification loss for each nested dimension <cite class="ltx_cite ltx_citemacro_citep">(Kusupati et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib15" title="">2022</a>)</cite>. Following the approach in <cite class="ltx_cite ltx_citemacro_citep">(Kusupati et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib15" title="">2022</a>)</cite>, we optimize a similarity-preserving loss for each nested dimension. By combining a similarity-preserving loss with an adaptive embedding training pipeline, we introduce our approach, Single Shot Similarity Space Distillation, or <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p2.1.1">(SS)<sub class="ltx_sub" id="S3.SS2.p2.1.1.1"><span class="ltx_text ltx_font_serif" id="S3.SS2.p2.1.1.1.1">2</span></sub>D</span>. Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">1</span></a><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.2.4">(B)</span> illustrates the central idea of <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p2.2.2">(SS)<sub class="ltx_sub" id="S3.SS2.p2.2.2.1"><span class="ltx_text ltx_font_serif" id="S3.SS2.p2.2.2.1.1">2</span></sub>D</span> which we will now describe in detail.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.6">Let <math alttext="{z}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">z</mi><mo id="S3.SS2.p3.1.m1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.2" xref="S3.SS2.p3.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p3.1.m1.1.1.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><in id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1"></in><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑧</ci><apply id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">{z}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> be the latent representation of the reference set obtained via <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.6.2">AE-SVC</span>. Our goal is to reduce the dimensionality of <math alttext="{z}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_z</annotation></semantics></math> so that the performance of the smaller embedding approximates that of the full embedding. In essence, the complete embedding <math alttext="{z}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_z</annotation></semantics></math> serves as a guide for creating smaller embeddings. Although <span class="ltx_text ltx_font_typewriter" id="S3.SS2.p3.4.1">(SS)<sub class="ltx_sub" id="S3.SS2.p3.4.1.1"><span class="ltx_text ltx_font_serif" id="S3.SS2.p3.4.1.1.1">2</span></sub>D</span>could theoretically be applied directly to the foundation model embedding <math alttext="I" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m4.1"><semantics id="S3.SS2.p3.5.m4.1a"><mi id="S3.SS2.p3.5.m4.1.1" xref="S3.SS2.p3.5.m4.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m4.1b"><ci id="S3.SS2.p3.5.m4.1.1.cmml" xref="S3.SS2.p3.5.m4.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m4.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m4.1d">italic_I</annotation></semantics></math>, the latent representation <math alttext="{z}" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m5.1"><semantics id="S3.SS2.p3.6.m5.1a"><mi id="S3.SS2.p3.6.m5.1.1" xref="S3.SS2.p3.6.m5.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m5.1b"><ci id="S3.SS2.p3.6.m5.1.1.cmml" xref="S3.SS2.p3.6.m5.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m5.1c">{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m5.1d">italic_z</annotation></semantics></math> is shown to perform better in retrieval tasks, thus providing stronger guidance.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.17">Consider a set <math alttext="\mathcal{M}\subset[d]" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.2" xref="S3.SS2.p4.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.1.m1.1.2.2" xref="S3.SS2.p4.1.m1.1.2.2.cmml">ℳ</mi><mo id="S3.SS2.p4.1.m1.1.2.1" xref="S3.SS2.p4.1.m1.1.2.1.cmml">⊂</mo><mrow id="S3.SS2.p4.1.m1.1.2.3.2" xref="S3.SS2.p4.1.m1.1.2.3.1.cmml"><mo id="S3.SS2.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p4.1.m1.1.2.3.1.1.cmml">[</mo><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">d</mi><mo id="S3.SS2.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p4.1.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.2"><subset id="S3.SS2.p4.1.m1.1.2.1.cmml" xref="S3.SS2.p4.1.m1.1.2.1"></subset><ci id="S3.SS2.p4.1.m1.1.2.2.cmml" xref="S3.SS2.p4.1.m1.1.2.2">ℳ</ci><apply id="S3.SS2.p4.1.m1.1.2.3.1.cmml" xref="S3.SS2.p4.1.m1.1.2.3.2"><csymbol cd="latexml" id="S3.SS2.p4.1.m1.1.2.3.1.1.cmml" xref="S3.SS2.p4.1.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\mathcal{M}\subset[d]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">caligraphic_M ⊂ [ italic_d ]</annotation></semantics></math> of embedding sizes and a neural network <math alttext="\mathcal{F}(\cdot;\theta)" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.2"><semantics id="S3.SS2.p4.2.m2.2a"><mrow id="S3.SS2.p4.2.m2.2.3" xref="S3.SS2.p4.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.2.m2.2.3.2" xref="S3.SS2.p4.2.m2.2.3.2.cmml">ℱ</mi><mo id="S3.SS2.p4.2.m2.2.3.1" xref="S3.SS2.p4.2.m2.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p4.2.m2.2.3.3.2" xref="S3.SS2.p4.2.m2.2.3.3.1.cmml"><mo id="S3.SS2.p4.2.m2.2.3.3.2.1" stretchy="false" xref="S3.SS2.p4.2.m2.2.3.3.1.cmml">(</mo><mo id="S3.SS2.p4.2.m2.1.1" lspace="0em" rspace="0em" xref="S3.SS2.p4.2.m2.1.1.cmml">⋅</mo><mo id="S3.SS2.p4.2.m2.2.3.3.2.2" xref="S3.SS2.p4.2.m2.2.3.3.1.cmml">;</mo><mi id="S3.SS2.p4.2.m2.2.2" xref="S3.SS2.p4.2.m2.2.2.cmml">θ</mi><mo id="S3.SS2.p4.2.m2.2.3.3.2.3" stretchy="false" xref="S3.SS2.p4.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.2b"><apply id="S3.SS2.p4.2.m2.2.3.cmml" xref="S3.SS2.p4.2.m2.2.3"><times id="S3.SS2.p4.2.m2.2.3.1.cmml" xref="S3.SS2.p4.2.m2.2.3.1"></times><ci id="S3.SS2.p4.2.m2.2.3.2.cmml" xref="S3.SS2.p4.2.m2.2.3.2">ℱ</ci><list id="S3.SS2.p4.2.m2.2.3.3.1.cmml" xref="S3.SS2.p4.2.m2.2.3.3.2"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">⋅</ci><ci id="S3.SS2.p4.2.m2.2.2.cmml" xref="S3.SS2.p4.2.m2.2.2">𝜃</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.2c">\mathcal{F}(\cdot;\theta)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.2d">caligraphic_F ( ⋅ ; italic_θ )</annotation></semantics></math> parameterized by <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">italic_θ</annotation></semantics></math>. We want to learn a projection <math alttext="\hat{z}=\mathcal{F}(z;\theta)" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.2"><semantics id="S3.SS2.p4.4.m4.2a"><mrow id="S3.SS2.p4.4.m4.2.3" xref="S3.SS2.p4.4.m4.2.3.cmml"><mover accent="true" id="S3.SS2.p4.4.m4.2.3.2" xref="S3.SS2.p4.4.m4.2.3.2.cmml"><mi id="S3.SS2.p4.4.m4.2.3.2.2" xref="S3.SS2.p4.4.m4.2.3.2.2.cmml">z</mi><mo id="S3.SS2.p4.4.m4.2.3.2.1" xref="S3.SS2.p4.4.m4.2.3.2.1.cmml">^</mo></mover><mo id="S3.SS2.p4.4.m4.2.3.1" xref="S3.SS2.p4.4.m4.2.3.1.cmml">=</mo><mrow id="S3.SS2.p4.4.m4.2.3.3" xref="S3.SS2.p4.4.m4.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.4.m4.2.3.3.2" xref="S3.SS2.p4.4.m4.2.3.3.2.cmml">ℱ</mi><mo id="S3.SS2.p4.4.m4.2.3.3.1" xref="S3.SS2.p4.4.m4.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS2.p4.4.m4.2.3.3.3.2" xref="S3.SS2.p4.4.m4.2.3.3.3.1.cmml"><mo id="S3.SS2.p4.4.m4.2.3.3.3.2.1" stretchy="false" xref="S3.SS2.p4.4.m4.2.3.3.3.1.cmml">(</mo><mi id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">z</mi><mo id="S3.SS2.p4.4.m4.2.3.3.3.2.2" xref="S3.SS2.p4.4.m4.2.3.3.3.1.cmml">;</mo><mi id="S3.SS2.p4.4.m4.2.2" xref="S3.SS2.p4.4.m4.2.2.cmml">θ</mi><mo id="S3.SS2.p4.4.m4.2.3.3.3.2.3" stretchy="false" xref="S3.SS2.p4.4.m4.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.2b"><apply id="S3.SS2.p4.4.m4.2.3.cmml" xref="S3.SS2.p4.4.m4.2.3"><eq id="S3.SS2.p4.4.m4.2.3.1.cmml" xref="S3.SS2.p4.4.m4.2.3.1"></eq><apply id="S3.SS2.p4.4.m4.2.3.2.cmml" xref="S3.SS2.p4.4.m4.2.3.2"><ci id="S3.SS2.p4.4.m4.2.3.2.1.cmml" xref="S3.SS2.p4.4.m4.2.3.2.1">^</ci><ci id="S3.SS2.p4.4.m4.2.3.2.2.cmml" xref="S3.SS2.p4.4.m4.2.3.2.2">𝑧</ci></apply><apply id="S3.SS2.p4.4.m4.2.3.3.cmml" xref="S3.SS2.p4.4.m4.2.3.3"><times id="S3.SS2.p4.4.m4.2.3.3.1.cmml" xref="S3.SS2.p4.4.m4.2.3.3.1"></times><ci id="S3.SS2.p4.4.m4.2.3.3.2.cmml" xref="S3.SS2.p4.4.m4.2.3.3.2">ℱ</ci><list id="S3.SS2.p4.4.m4.2.3.3.3.1.cmml" xref="S3.SS2.p4.4.m4.2.3.3.3.2"><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">𝑧</ci><ci id="S3.SS2.p4.4.m4.2.2.cmml" xref="S3.SS2.p4.4.m4.2.2">𝜃</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.2c">\hat{z}=\mathcal{F}(z;\theta)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.2d">over^ start_ARG italic_z end_ARG = caligraphic_F ( italic_z ; italic_θ )</annotation></semantics></math> such that each of the first <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.1"><semantics id="S3.SS2.p4.5.m5.1a"><mi id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m5.1d">italic_m</annotation></semantics></math> dimensions, for <math alttext="m\in\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS2.p4.6.m6.1"><semantics id="S3.SS2.p4.6.m6.1a"><mrow id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml"><mi id="S3.SS2.p4.6.m6.1.1.2" xref="S3.SS2.p4.6.m6.1.1.2.cmml">m</mi><mo id="S3.SS2.p4.6.m6.1.1.1" xref="S3.SS2.p4.6.m6.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.6.m6.1.1.3" xref="S3.SS2.p4.6.m6.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1"><in id="S3.SS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1.1"></in><ci id="S3.SS2.p4.6.m6.1.1.2.cmml" xref="S3.SS2.p4.6.m6.1.1.2">𝑚</ci><ci id="S3.SS2.p4.6.m6.1.1.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">m\in\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.6.m6.1d">italic_m ∈ caligraphic_M</annotation></semantics></math>, of the learned embedding vector <math alttext="\hat{z}^{1:m}\in\mathbb{R}^{m}" class="ltx_Math" display="inline" id="S3.SS2.p4.7.m7.1"><semantics id="S3.SS2.p4.7.m7.1a"><mrow id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml"><msup id="S3.SS2.p4.7.m7.1.1.2" xref="S3.SS2.p4.7.m7.1.1.2.cmml"><mover accent="true" id="S3.SS2.p4.7.m7.1.1.2.2" xref="S3.SS2.p4.7.m7.1.1.2.2.cmml"><mi id="S3.SS2.p4.7.m7.1.1.2.2.2" xref="S3.SS2.p4.7.m7.1.1.2.2.2.cmml">z</mi><mo id="S3.SS2.p4.7.m7.1.1.2.2.1" xref="S3.SS2.p4.7.m7.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.SS2.p4.7.m7.1.1.2.3" xref="S3.SS2.p4.7.m7.1.1.2.3.cmml"><mn id="S3.SS2.p4.7.m7.1.1.2.3.2" xref="S3.SS2.p4.7.m7.1.1.2.3.2.cmml">1</mn><mo id="S3.SS2.p4.7.m7.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p4.7.m7.1.1.2.3.1.cmml">:</mo><mi id="S3.SS2.p4.7.m7.1.1.2.3.3" xref="S3.SS2.p4.7.m7.1.1.2.3.3.cmml">m</mi></mrow></msup><mo id="S3.SS2.p4.7.m7.1.1.1" xref="S3.SS2.p4.7.m7.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.7.m7.1.1.3" xref="S3.SS2.p4.7.m7.1.1.3.cmml"><mi id="S3.SS2.p4.7.m7.1.1.3.2" xref="S3.SS2.p4.7.m7.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p4.7.m7.1.1.3.3" xref="S3.SS2.p4.7.m7.1.1.3.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><apply id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1"><in id="S3.SS2.p4.7.m7.1.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1.1"></in><apply id="S3.SS2.p4.7.m7.1.1.2.cmml" xref="S3.SS2.p4.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.7.m7.1.1.2.1.cmml" xref="S3.SS2.p4.7.m7.1.1.2">superscript</csymbol><apply id="S3.SS2.p4.7.m7.1.1.2.2.cmml" xref="S3.SS2.p4.7.m7.1.1.2.2"><ci id="S3.SS2.p4.7.m7.1.1.2.2.1.cmml" xref="S3.SS2.p4.7.m7.1.1.2.2.1">^</ci><ci id="S3.SS2.p4.7.m7.1.1.2.2.2.cmml" xref="S3.SS2.p4.7.m7.1.1.2.2.2">𝑧</ci></apply><apply id="S3.SS2.p4.7.m7.1.1.2.3.cmml" xref="S3.SS2.p4.7.m7.1.1.2.3"><ci id="S3.SS2.p4.7.m7.1.1.2.3.1.cmml" xref="S3.SS2.p4.7.m7.1.1.2.3.1">:</ci><cn id="S3.SS2.p4.7.m7.1.1.2.3.2.cmml" type="integer" xref="S3.SS2.p4.7.m7.1.1.2.3.2">1</cn><ci id="S3.SS2.p4.7.m7.1.1.2.3.3.cmml" xref="S3.SS2.p4.7.m7.1.1.2.3.3">𝑚</ci></apply></apply><apply id="S3.SS2.p4.7.m7.1.1.3.cmml" xref="S3.SS2.p4.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.7.m7.1.1.3.1.cmml" xref="S3.SS2.p4.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.7.m7.1.1.3.2.cmml" xref="S3.SS2.p4.7.m7.1.1.3.2">ℝ</ci><ci id="S3.SS2.p4.7.m7.1.1.3.3.cmml" xref="S3.SS2.p4.7.m7.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">\hat{z}^{1:m}\in\mathbb{R}^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.7.m7.1d">over^ start_ARG italic_z end_ARG start_POSTSUPERSCRIPT 1 : italic_m end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> independently preserves the retrieval performance of <math alttext="{z}" class="ltx_Math" display="inline" id="S3.SS2.p4.8.m8.1"><semantics id="S3.SS2.p4.8.m8.1a"><mi id="S3.SS2.p4.8.m8.1.1" xref="S3.SS2.p4.8.m8.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m8.1b"><ci id="S3.SS2.p4.8.m8.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m8.1c">{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.8.m8.1d">italic_z</annotation></semantics></math>.
To learn the function <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S3.SS2.p4.9.m9.1"><semantics id="S3.SS2.p4.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.9.m9.1.1" xref="S3.SS2.p4.9.m9.1.1.cmml">ℱ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.9.m9.1b"><ci id="S3.SS2.p4.9.m9.1.1.cmml" xref="S3.SS2.p4.9.m9.1.1">ℱ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.9.m9.1c">\mathcal{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.9.m9.1d">caligraphic_F</annotation></semantics></math>, we first compute a cosine similarity matrix <math alttext="\mathrm{C}\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="S3.SS2.p4.10.m10.1"><semantics id="S3.SS2.p4.10.m10.1a"><mrow id="S3.SS2.p4.10.m10.1.1" xref="S3.SS2.p4.10.m10.1.1.cmml"><mi id="S3.SS2.p4.10.m10.1.1.2" mathvariant="normal" xref="S3.SS2.p4.10.m10.1.1.2.cmml">C</mi><mo id="S3.SS2.p4.10.m10.1.1.1" xref="S3.SS2.p4.10.m10.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.10.m10.1.1.3" xref="S3.SS2.p4.10.m10.1.1.3.cmml"><mi id="S3.SS2.p4.10.m10.1.1.3.2" xref="S3.SS2.p4.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.10.m10.1.1.3.3" xref="S3.SS2.p4.10.m10.1.1.3.3.cmml"><mi id="S3.SS2.p4.10.m10.1.1.3.3.2" xref="S3.SS2.p4.10.m10.1.1.3.3.2.cmml">N</mi><mo id="S3.SS2.p4.10.m10.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p4.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p4.10.m10.1.1.3.3.3" xref="S3.SS2.p4.10.m10.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.10.m10.1b"><apply id="S3.SS2.p4.10.m10.1.1.cmml" xref="S3.SS2.p4.10.m10.1.1"><in id="S3.SS2.p4.10.m10.1.1.1.cmml" xref="S3.SS2.p4.10.m10.1.1.1"></in><ci id="S3.SS2.p4.10.m10.1.1.2.cmml" xref="S3.SS2.p4.10.m10.1.1.2">C</ci><apply id="S3.SS2.p4.10.m10.1.1.3.cmml" xref="S3.SS2.p4.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.10.m10.1.1.3.1.cmml" xref="S3.SS2.p4.10.m10.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.10.m10.1.1.3.2.cmml" xref="S3.SS2.p4.10.m10.1.1.3.2">ℝ</ci><apply id="S3.SS2.p4.10.m10.1.1.3.3.cmml" xref="S3.SS2.p4.10.m10.1.1.3.3"><times id="S3.SS2.p4.10.m10.1.1.3.3.1.cmml" xref="S3.SS2.p4.10.m10.1.1.3.3.1"></times><ci id="S3.SS2.p4.10.m10.1.1.3.3.2.cmml" xref="S3.SS2.p4.10.m10.1.1.3.3.2">𝑁</ci><ci id="S3.SS2.p4.10.m10.1.1.3.3.3.cmml" xref="S3.SS2.p4.10.m10.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.10.m10.1c">\mathrm{C}\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.10.m10.1d">roman_C ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> by calculating the cosine similarities of every <math alttext="z" class="ltx_Math" display="inline" id="S3.SS2.p4.11.m11.1"><semantics id="S3.SS2.p4.11.m11.1a"><mi id="S3.SS2.p4.11.m11.1.1" xref="S3.SS2.p4.11.m11.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.11.m11.1b"><ci id="S3.SS2.p4.11.m11.1.1.cmml" xref="S3.SS2.p4.11.m11.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.11.m11.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.11.m11.1d">italic_z</annotation></semantics></math> with every other <math alttext="z" class="ltx_Math" display="inline" id="S3.SS2.p4.12.m12.1"><semantics id="S3.SS2.p4.12.m12.1a"><mi id="S3.SS2.p4.12.m12.1.1" xref="S3.SS2.p4.12.m12.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.12.m12.1b"><ci id="S3.SS2.p4.12.m12.1.1.cmml" xref="S3.SS2.p4.12.m12.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.12.m12.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.12.m12.1d">italic_z</annotation></semantics></math> in the reference set <math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.p4.13.m13.1"><semantics id="S3.SS2.p4.13.m13.1a"><mi id="S3.SS2.p4.13.m13.1.1" xref="S3.SS2.p4.13.m13.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.13.m13.1b"><ci id="S3.SS2.p4.13.m13.1.1.cmml" xref="S3.SS2.p4.13.m13.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.13.m13.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.13.m13.1d">italic_R</annotation></semantics></math>. We refer to this matrix as the cosine similarity space of the teacher <math alttext="Z" class="ltx_Math" display="inline" id="S3.SS2.p4.14.m14.1"><semantics id="S3.SS2.p4.14.m14.1a"><mi id="S3.SS2.p4.14.m14.1.1" xref="S3.SS2.p4.14.m14.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.14.m14.1b"><ci id="S3.SS2.p4.14.m14.1.1.cmml" xref="S3.SS2.p4.14.m14.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.14.m14.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.14.m14.1d">italic_Z</annotation></semantics></math>. Let <math alttext="\mathrm{C}_{i}" class="ltx_Math" display="inline" id="S3.SS2.p4.15.m15.1"><semantics id="S3.SS2.p4.15.m15.1a"><msub id="S3.SS2.p4.15.m15.1.1" xref="S3.SS2.p4.15.m15.1.1.cmml"><mi id="S3.SS2.p4.15.m15.1.1.2" mathvariant="normal" xref="S3.SS2.p4.15.m15.1.1.2.cmml">C</mi><mi id="S3.SS2.p4.15.m15.1.1.3" xref="S3.SS2.p4.15.m15.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.15.m15.1b"><apply id="S3.SS2.p4.15.m15.1.1.cmml" xref="S3.SS2.p4.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.15.m15.1.1.1.cmml" xref="S3.SS2.p4.15.m15.1.1">subscript</csymbol><ci id="S3.SS2.p4.15.m15.1.1.2.cmml" xref="S3.SS2.p4.15.m15.1.1.2">C</ci><ci id="S3.SS2.p4.15.m15.1.1.3.cmml" xref="S3.SS2.p4.15.m15.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.15.m15.1c">\mathrm{C}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.15.m15.1d">roman_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denote the <math alttext="i^{\text{th}}" class="ltx_Math" display="inline" id="S3.SS2.p4.16.m16.1"><semantics id="S3.SS2.p4.16.m16.1a"><msup id="S3.SS2.p4.16.m16.1.1" xref="S3.SS2.p4.16.m16.1.1.cmml"><mi id="S3.SS2.p4.16.m16.1.1.2" xref="S3.SS2.p4.16.m16.1.1.2.cmml">i</mi><mtext id="S3.SS2.p4.16.m16.1.1.3" xref="S3.SS2.p4.16.m16.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.16.m16.1b"><apply id="S3.SS2.p4.16.m16.1.1.cmml" xref="S3.SS2.p4.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.16.m16.1.1.1.cmml" xref="S3.SS2.p4.16.m16.1.1">superscript</csymbol><ci id="S3.SS2.p4.16.m16.1.1.2.cmml" xref="S3.SS2.p4.16.m16.1.1.2">𝑖</ci><ci id="S3.SS2.p4.16.m16.1.1.3a.cmml" xref="S3.SS2.p4.16.m16.1.1.3"><mtext id="S3.SS2.p4.16.m16.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p4.16.m16.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.16.m16.1c">i^{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.16.m16.1d">italic_i start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT</annotation></semantics></math> row of <math alttext="\mathrm{C}" class="ltx_Math" display="inline" id="S3.SS2.p4.17.m17.1"><semantics id="S3.SS2.p4.17.m17.1a"><mi id="S3.SS2.p4.17.m17.1.1" mathvariant="normal" xref="S3.SS2.p4.17.m17.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.17.m17.1b"><ci id="S3.SS2.p4.17.m17.1.1.cmml" xref="S3.SS2.p4.17.m17.1.1">C</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.17.m17.1c">\mathrm{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.17.m17.1d">roman_C</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.6">Next, for each <math alttext="m\in\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><mrow id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">m</mi><mo id="S3.SS2.p5.1.m1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><in id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1"></in><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">𝑚</ci><ci id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">m\in\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">italic_m ∈ caligraphic_M</annotation></semantics></math>, we define a student similarity space <math alttext="\tilde{\mathrm{C}}^{m}\in\mathbb{R}^{N\times N}" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.1"><semantics id="S3.SS2.p5.2.m2.1a"><mrow id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><msup id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml"><mover accent="true" id="S3.SS2.p5.2.m2.1.1.2.2" xref="S3.SS2.p5.2.m2.1.1.2.2.cmml"><mi id="S3.SS2.p5.2.m2.1.1.2.2.2" mathvariant="normal" xref="S3.SS2.p5.2.m2.1.1.2.2.2.cmml">C</mi><mo id="S3.SS2.p5.2.m2.1.1.2.2.1" xref="S3.SS2.p5.2.m2.1.1.2.2.1.cmml">~</mo></mover><mi id="S3.SS2.p5.2.m2.1.1.2.3" xref="S3.SS2.p5.2.m2.1.1.2.3.cmml">m</mi></msup><mo id="S3.SS2.p5.2.m2.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p5.2.m2.1.1.3.3" xref="S3.SS2.p5.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.3.3.2" xref="S3.SS2.p5.2.m2.1.1.3.3.2.cmml">N</mi><mo id="S3.SS2.p5.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p5.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p5.2.m2.1.1.3.3.3" xref="S3.SS2.p5.2.m2.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><in id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1"></in><apply id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.2.1.cmml" xref="S3.SS2.p5.2.m2.1.1.2">superscript</csymbol><apply id="S3.SS2.p5.2.m2.1.1.2.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2.2"><ci id="S3.SS2.p5.2.m2.1.1.2.2.1.cmml" xref="S3.SS2.p5.2.m2.1.1.2.2.1">~</ci><ci id="S3.SS2.p5.2.m2.1.1.2.2.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2.2.2">C</ci></apply><ci id="S3.SS2.p5.2.m2.1.1.2.3.cmml" xref="S3.SS2.p5.2.m2.1.1.2.3">𝑚</ci></apply><apply id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p5.2.m2.1.1.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3"><times id="S3.SS2.p5.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3.1"></times><ci id="S3.SS2.p5.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3.2">𝑁</ci><ci id="S3.SS2.p5.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">\tilde{\mathrm{C}}^{m}\in\mathbb{R}^{N\times N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.1d">over~ start_ARG roman_C end_ARG start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>. We then introduce a Kullback-Leibler (KL) divergence loss <math alttext="l^{m}" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m3.1"><semantics id="S3.SS2.p5.3.m3.1a"><msup id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">l</mi><mi id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">𝑙</ci><ci id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">l^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m3.1d">italic_l start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> between <math alttext="\tilde{\mathrm{C}}^{m}" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m4.1"><semantics id="S3.SS2.p5.4.m4.1a"><msup id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml"><mover accent="true" id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml"><mi id="S3.SS2.p5.4.m4.1.1.2.2" mathvariant="normal" xref="S3.SS2.p5.4.m4.1.1.2.2.cmml">C</mi><mo id="S3.SS2.p5.4.m4.1.1.2.1" xref="S3.SS2.p5.4.m4.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2"><ci id="S3.SS2.p5.4.m4.1.1.2.1.cmml" xref="S3.SS2.p5.4.m4.1.1.2.1">~</ci><ci id="S3.SS2.p5.4.m4.1.1.2.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2.2">C</ci></apply><ci id="S3.SS2.p5.4.m4.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">\tilde{\mathrm{C}}^{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.4.m4.1d">over~ start_ARG roman_C end_ARG start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathrm{C}" class="ltx_Math" display="inline" id="S3.SS2.p5.5.m5.1"><semantics id="S3.SS2.p5.5.m5.1a"><mi id="S3.SS2.p5.5.m5.1.1" mathvariant="normal" xref="S3.SS2.p5.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m5.1b"><ci id="S3.SS2.p5.5.m5.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1">C</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m5.1c">\mathrm{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.5.m5.1d">roman_C</annotation></semantics></math> for each <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.p5.6.m6.1"><semantics id="S3.SS2.p5.6.m6.1a"><mi id="S3.SS2.p5.6.m6.1.1" xref="S3.SS2.p5.6.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m6.1b"><ci id="S3.SS2.p5.6.m6.1.1.cmml" xref="S3.SS2.p5.6.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.6.m6.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.6.m6.1d">italic_m</annotation></semantics></math> as follows:</p>
</div>
<div class="ltx_para" id="S3.SS2.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="l^{m}=\sum_{i}\mathrm{D}_{\mathrm{KL}}(\tilde{\mathrm{C}}^{m}_{i}\|\mathrm{C}_%
{i})." class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msup id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml">l</mi><mi id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml">m</mi></msup><mo id="S3.E6.m1.1.1.1.1.2" rspace="0.111em" xref="S3.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><munder id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.1.1.1.1.1.2.2" movablelimits="false" xref="S3.E6.m1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E6.m1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.2.3.cmml">i</mi></munder><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="S3.E6.m1.1.1.1.1.1.1.3.2.cmml">D</mi><mi id="S3.E6.m1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.3.3.cmml">KL</mi></msub><mo id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2.2" mathvariant="normal" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">C</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">m</mi></msubsup><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml">∥</mo><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">C</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" lspace="0em" xref="S3.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></eq><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2">𝑙</ci><ci id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3">𝑚</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><apply id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E6.m1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.2.2"></sum><ci id="S3.E6.m1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2">D</ci><ci id="S3.E6.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.3">KL</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2"><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2.1">~</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.2.2">C</ci></apply><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.2.3">𝑚</ci></apply><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2">C</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">l^{m}=\sum_{i}\mathrm{D}_{\mathrm{KL}}(\tilde{\mathrm{C}}^{m}_{i}\|\mathrm{C}_%
{i}).</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">italic_l start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT ( over~ start_ARG roman_C end_ARG start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ roman_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p6.1">The overall loss <math alttext="L" class="ltx_Math" display="inline" id="S3.SS2.p6.1.m1.1"><semantics id="S3.SS2.p6.1.m1.1a"><mi id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><ci id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p6.1.m1.1d">italic_L</annotation></semantics></math> is then expressed as:</p>
</div>
<div class="ltx_para" id="S3.SS2.p7">
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{\texttt{(SS)${}_{2}$D}}=\sum_{m}l^{m}=\sum_{m}\sum_{i}\mathrm{D}_{\mathrm{%
KL}}(\tilde{\mathrm{C}}^{m}_{i}\|\mathrm{C}_{i})." class="ltx_Math" display="block" id="S3.E7.m1.2"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2.2.1" xref="S3.E7.m1.2.2.1.1.cmml"><mrow id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml"><msub id="S3.E7.m1.2.2.1.1.3" xref="S3.E7.m1.2.2.1.1.3.cmml"><mi id="S3.E7.m1.2.2.1.1.3.2" xref="S3.E7.m1.2.2.1.1.3.2.cmml">L</mi><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1f.cmml"><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.1.1.1a" xref="S3.E7.m1.1.1.1f.cmml">(SS)</mtext><mtext id="S3.E7.m1.1.1.1b" mathsize="142%" xref="S3.E7.m1.1.1.1f.cmml"><sub class="ltx_sub" id="S3.E7.m1.1.1.1.3nest"><span class="ltx_text" id="S3.E7.m1.1.1.1.3.1nest" style="font-size:70%;">2</span></sub></mtext><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.1.1.1e" xref="S3.E7.m1.1.1.1f.cmml">D</mtext></mrow></msub><mo id="S3.E7.m1.2.2.1.1.4" rspace="0.111em" xref="S3.E7.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E7.m1.2.2.1.1.5" xref="S3.E7.m1.2.2.1.1.5.cmml"><munder id="S3.E7.m1.2.2.1.1.5.1" xref="S3.E7.m1.2.2.1.1.5.1.cmml"><mo id="S3.E7.m1.2.2.1.1.5.1.2" movablelimits="false" xref="S3.E7.m1.2.2.1.1.5.1.2.cmml">∑</mo><mi id="S3.E7.m1.2.2.1.1.5.1.3" xref="S3.E7.m1.2.2.1.1.5.1.3.cmml">m</mi></munder><msup id="S3.E7.m1.2.2.1.1.5.2" xref="S3.E7.m1.2.2.1.1.5.2.cmml"><mi id="S3.E7.m1.2.2.1.1.5.2.2" xref="S3.E7.m1.2.2.1.1.5.2.2.cmml">l</mi><mi id="S3.E7.m1.2.2.1.1.5.2.3" xref="S3.E7.m1.2.2.1.1.5.2.3.cmml">m</mi></msup></mrow><mo id="S3.E7.m1.2.2.1.1.6" rspace="0.111em" xref="S3.E7.m1.2.2.1.1.6.cmml">=</mo><mrow id="S3.E7.m1.2.2.1.1.1" xref="S3.E7.m1.2.2.1.1.1.cmml"><munder id="S3.E7.m1.2.2.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.2.cmml"><mo id="S3.E7.m1.2.2.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E7.m1.2.2.1.1.1.2.2.cmml">∑</mo><mi id="S3.E7.m1.2.2.1.1.1.2.3" xref="S3.E7.m1.2.2.1.1.1.2.3.cmml">m</mi></munder><mrow id="S3.E7.m1.2.2.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.cmml"><munder id="S3.E7.m1.2.2.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E7.m1.2.2.1.1.1.1.2.2" movablelimits="false" xref="S3.E7.m1.2.2.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E7.m1.2.2.1.1.1.1.2.3" xref="S3.E7.m1.2.2.1.1.1.1.2.3.cmml">i</mi></munder><mrow id="S3.E7.m1.2.2.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.E7.m1.2.2.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.1.3.2" mathvariant="normal" xref="S3.E7.m1.2.2.1.1.1.1.1.3.2.cmml">D</mi><mi id="S3.E7.m1.2.2.1.1.1.1.1.3.3" xref="S3.E7.m1.2.2.1.1.1.1.1.3.3.cmml">KL</mi></msub><mo id="S3.E7.m1.2.2.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2" mathvariant="normal" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml">C</mi><mo id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml">m</mi></msubsup><mo id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">∥</mo><msub id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">C</mi><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.2.2.1.2" lspace="0em" xref="S3.E7.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1"><and id="S3.E7.m1.2.2.1.1a.cmml" xref="S3.E7.m1.2.2.1"></and><apply id="S3.E7.m1.2.2.1.1b.cmml" xref="S3.E7.m1.2.2.1"><eq id="S3.E7.m1.2.2.1.1.4.cmml" xref="S3.E7.m1.2.2.1.1.4"></eq><apply id="S3.E7.m1.2.2.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.3.2">𝐿</ci><ci id="S3.E7.m1.1.1.1f.cmml" xref="S3.E7.m1.1.1.1"><mrow id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.1.1.1a.cmml" mathsize="70%" xref="S3.E7.m1.1.1.1">(SS)</mtext><mtext id="S3.E7.m1.1.1.1b.cmml" xref="S3.E7.m1.1.1.1"><sub class="ltx_sub" id="S3.E7.m1.1.1.1.3anest"><span class="ltx_text" id="S3.E7.m1.1.1.1.3.1anest" style="font-size:70%;">2</span></sub></mtext><mtext class="ltx_mathvariant_monospace" id="S3.E7.m1.1.1.1e.cmml" mathsize="70%" xref="S3.E7.m1.1.1.1">D</mtext></mrow></ci></apply><apply id="S3.E7.m1.2.2.1.1.5.cmml" xref="S3.E7.m1.2.2.1.1.5"><apply id="S3.E7.m1.2.2.1.1.5.1.cmml" xref="S3.E7.m1.2.2.1.1.5.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.5.1.1.cmml" xref="S3.E7.m1.2.2.1.1.5.1">subscript</csymbol><sum id="S3.E7.m1.2.2.1.1.5.1.2.cmml" xref="S3.E7.m1.2.2.1.1.5.1.2"></sum><ci id="S3.E7.m1.2.2.1.1.5.1.3.cmml" xref="S3.E7.m1.2.2.1.1.5.1.3">𝑚</ci></apply><apply id="S3.E7.m1.2.2.1.1.5.2.cmml" xref="S3.E7.m1.2.2.1.1.5.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.5.2.1.cmml" xref="S3.E7.m1.2.2.1.1.5.2">superscript</csymbol><ci id="S3.E7.m1.2.2.1.1.5.2.2.cmml" xref="S3.E7.m1.2.2.1.1.5.2.2">𝑙</ci><ci id="S3.E7.m1.2.2.1.1.5.2.3.cmml" xref="S3.E7.m1.2.2.1.1.5.2.3">𝑚</ci></apply></apply></apply><apply id="S3.E7.m1.2.2.1.1c.cmml" xref="S3.E7.m1.2.2.1"><eq id="S3.E7.m1.2.2.1.1.6.cmml" xref="S3.E7.m1.2.2.1.1.6"></eq><share href="https://arxiv.org/html/2410.07022v1#S3.E7.m1.2.2.1.1.5.cmml" id="S3.E7.m1.2.2.1.1d.cmml" xref="S3.E7.m1.2.2.1"></share><apply id="S3.E7.m1.2.2.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1"><apply id="S3.E7.m1.2.2.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.2.1.cmml" xref="S3.E7.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.2.2.1.1.1.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.2.2"></sum><ci id="S3.E7.m1.2.2.1.1.1.2.3.cmml" xref="S3.E7.m1.2.2.1.1.1.2.3">𝑚</ci></apply><apply id="S3.E7.m1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1"><apply id="S3.E7.m1.2.2.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2.2"></sum><ci id="S3.E7.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E7.m1.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1"><times id="S3.E7.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.2"></times><apply id="S3.E7.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.3.2">D</ci><ci id="S3.E7.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.3.3">KL</ci></apply><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.2"><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.1">~</ci><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.2">C</ci></apply><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.2.3">𝑚</ci></apply><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.2">C</ci><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">L_{\texttt{(SS)${}_{2}$D}}=\sum_{m}l^{m}=\sum_{m}\sum_{i}\mathrm{D}_{\mathrm{%
KL}}(\tilde{\mathrm{C}}^{m}_{i}\|\mathrm{C}_{i}).</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.2d">italic_L start_POSTSUBSCRIPT (SS) D end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT italic_l start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_D start_POSTSUBSCRIPT roman_KL end_POSTSUBSCRIPT ( over~ start_ARG roman_C end_ARG start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ roman_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Theoretical Analysis of <span class="ltx_text ltx_font_typewriter" id="S4.1.1">AE-SVC</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.3">In Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3.SS1" title="3.1 Autoencoders with Strong Variance Constraints (AE-SVC) ‣ 3 Methodology ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we stated that the discriminative power of the retrieval task is maximized when the variance of the cosine similarity distribution is minimized. This discriminative power can be modeled as the probability that the cosine similarity between two randomly drawn vectors <math alttext="S_{a}" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><msub id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml"><mi id="S4.p1.1.m1.1.1.2" xref="S4.p1.1.m1.1.1.2.cmml">S</mi><mi id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.p1.1.m1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.2">𝑆</ci><ci id="S4.p1.1.m1.1.1.3.cmml" xref="S4.p1.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">S_{a}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">italic_S start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="S_{b}" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><msub id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml"><mi id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">S</mi><mi id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">𝑆</ci><ci id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">S_{b}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">italic_S start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> from the same class exceeds a given threshold <math alttext="\tau" class="ltx_Math" display="inline" id="S4.p1.3.m3.1"><semantics id="S4.p1.3.m3.1a"><mi id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><ci id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.p1.3.m3.1d">italic_τ</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P\left(\cos(S_{a},S_{b})&gt;\tau\right)=\mathrm{erf}\left(\frac{\mathbb{E}[\cos(S%
_{a},S_{b})]-\tau}{\sqrt{\text{Var}[\cos(S_{a},S_{b})]}}\right)," class="ltx_Math" display="block" id="S4.E8.m1.6"><semantics id="S4.E8.m1.6a"><mrow id="S4.E8.m1.6.6.1" xref="S4.E8.m1.6.6.1.1.cmml"><mrow id="S4.E8.m1.6.6.1.1" xref="S4.E8.m1.6.6.1.1.cmml"><mrow id="S4.E8.m1.6.6.1.1.1" xref="S4.E8.m1.6.6.1.1.1.cmml"><mi id="S4.E8.m1.6.6.1.1.1.3" xref="S4.E8.m1.6.6.1.1.1.3.cmml">P</mi><mo id="S4.E8.m1.6.6.1.1.1.2" xref="S4.E8.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.6.6.1.1.1.1.1" xref="S4.E8.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.6.6.1.1.1.1.1.2" xref="S4.E8.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.6.6.1.1.1.1.1.1" xref="S4.E8.m1.6.6.1.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E8.m1.5.5" xref="S4.E8.m1.5.5.cmml">cos</mi><mo id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2a" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.3.cmml"><mo id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">S</mi><mi id="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.4" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2.2.cmml">S</mi><mi id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.cmml">b</mi></msub><mo id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.6.6.1.1.1.1.1.1.3" xref="S4.E8.m1.6.6.1.1.1.1.1.1.3.cmml">&gt;</mo><mi id="S4.E8.m1.6.6.1.1.1.1.1.1.4" xref="S4.E8.m1.6.6.1.1.1.1.1.1.4.cmml">τ</mi></mrow><mo id="S4.E8.m1.6.6.1.1.1.1.1.3" xref="S4.E8.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.6.6.1.1.2" xref="S4.E8.m1.6.6.1.1.2.cmml">=</mo><mrow id="S4.E8.m1.6.6.1.1.3" xref="S4.E8.m1.6.6.1.1.3.cmml"><mi id="S4.E8.m1.6.6.1.1.3.2" xref="S4.E8.m1.6.6.1.1.3.2.cmml">erf</mi><mo id="S4.E8.m1.6.6.1.1.3.1" xref="S4.E8.m1.6.6.1.1.3.1.cmml">⁢</mo><mrow id="S4.E8.m1.6.6.1.1.3.3.2" xref="S4.E8.m1.4.4.cmml"><mo id="S4.E8.m1.6.6.1.1.3.3.2.1" xref="S4.E8.m1.4.4.cmml">(</mo><mfrac id="S4.E8.m1.4.4" xref="S4.E8.m1.4.4.cmml"><mrow id="S4.E8.m1.2.2.2" xref="S4.E8.m1.2.2.2.cmml"><mrow id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.2.cmml"><mi id="S4.E8.m1.2.2.2.2.3" xref="S4.E8.m1.2.2.2.2.3.cmml">𝔼</mi><mo id="S4.E8.m1.2.2.2.2.2" xref="S4.E8.m1.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.E8.m1.2.2.2.2.1.1" xref="S4.E8.m1.2.2.2.2.1.2.cmml"><mo id="S4.E8.m1.2.2.2.2.1.1.2" stretchy="false" xref="S4.E8.m1.2.2.2.2.1.2.1.cmml">[</mo><mrow id="S4.E8.m1.2.2.2.2.1.1.1.2" xref="S4.E8.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml">cos</mi><mo id="S4.E8.m1.2.2.2.2.1.1.1.2a" xref="S4.E8.m1.2.2.2.2.1.1.1.3.cmml">⁡</mo><mrow id="S4.E8.m1.2.2.2.2.1.1.1.2.2" xref="S4.E8.m1.2.2.2.2.1.1.1.3.cmml"><mo id="S4.E8.m1.2.2.2.2.1.1.1.2.2.3" stretchy="false" xref="S4.E8.m1.2.2.2.2.1.1.1.3.cmml">(</mo><msub id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">S</mi><mi id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S4.E8.m1.2.2.2.2.1.1.1.2.2.4" xref="S4.E8.m1.2.2.2.2.1.1.1.3.cmml">,</mo><msub id="S4.E8.m1.2.2.2.2.1.1.1.2.2.2" xref="S4.E8.m1.2.2.2.2.1.1.1.2.2.2.cmml"><mi id="S4.E8.m1.2.2.2.2.1.1.1.2.2.2.2" xref="S4.E8.m1.2.2.2.2.1.1.1.2.2.2.2.cmml">S</mi><mi id="S4.E8.m1.2.2.2.2.1.1.1.2.2.2.3" xref="S4.E8.m1.2.2.2.2.1.1.1.2.2.2.3.cmml">b</mi></msub><mo id="S4.E8.m1.2.2.2.2.1.1.1.2.2.5" stretchy="false" xref="S4.E8.m1.2.2.2.2.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.2.2.2.2.1.1.3" stretchy="false" xref="S4.E8.m1.2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E8.m1.2.2.2.3" xref="S4.E8.m1.2.2.2.3.cmml">−</mo><mi id="S4.E8.m1.2.2.2.4" xref="S4.E8.m1.2.2.2.4.cmml">τ</mi></mrow><msqrt id="S4.E8.m1.4.4.4" xref="S4.E8.m1.4.4.4.cmml"><mrow id="S4.E8.m1.4.4.4.2.2" xref="S4.E8.m1.4.4.4.2.2.cmml"><mtext id="S4.E8.m1.4.4.4.2.2.4" xref="S4.E8.m1.4.4.4.2.2.4a.cmml">Var</mtext><mo id="S4.E8.m1.4.4.4.2.2.3" xref="S4.E8.m1.4.4.4.2.2.3.cmml">⁢</mo><mrow id="S4.E8.m1.4.4.4.2.2.2.1" xref="S4.E8.m1.4.4.4.2.2.2.2.cmml"><mo id="S4.E8.m1.4.4.4.2.2.2.1.2" stretchy="false" xref="S4.E8.m1.4.4.4.2.2.2.2.1.cmml">[</mo><mrow id="S4.E8.m1.4.4.4.2.2.2.1.1.2" xref="S4.E8.m1.4.4.4.2.2.2.1.1.3.cmml"><mi id="S4.E8.m1.3.3.3.1.1.1" xref="S4.E8.m1.3.3.3.1.1.1.cmml">cos</mi><mo id="S4.E8.m1.4.4.4.2.2.2.1.1.2a" xref="S4.E8.m1.4.4.4.2.2.2.1.1.3.cmml">⁡</mo><mrow id="S4.E8.m1.4.4.4.2.2.2.1.1.2.2" xref="S4.E8.m1.4.4.4.2.2.2.1.1.3.cmml"><mo id="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.3" stretchy="false" xref="S4.E8.m1.4.4.4.2.2.2.1.1.3.cmml">(</mo><msub id="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1" xref="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1.cmml"><mi id="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1.2" xref="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1.2.cmml">S</mi><mi id="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1.3" xref="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.4" xref="S4.E8.m1.4.4.4.2.2.2.1.1.3.cmml">,</mo><msub id="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2" xref="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2.cmml"><mi id="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2.2" xref="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2.2.cmml">S</mi><mi id="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2.3" xref="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2.3.cmml">b</mi></msub><mo id="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.5" stretchy="false" xref="S4.E8.m1.4.4.4.2.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.4.4.4.2.2.2.1.3" stretchy="false" xref="S4.E8.m1.4.4.4.2.2.2.2.1.cmml">]</mo></mrow></mrow></msqrt></mfrac><mo id="S4.E8.m1.6.6.1.1.3.3.2.2" xref="S4.E8.m1.4.4.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.6.6.1.2" xref="S4.E8.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.6b"><apply id="S4.E8.m1.6.6.1.1.cmml" xref="S4.E8.m1.6.6.1"><eq id="S4.E8.m1.6.6.1.1.2.cmml" xref="S4.E8.m1.6.6.1.1.2"></eq><apply id="S4.E8.m1.6.6.1.1.1.cmml" xref="S4.E8.m1.6.6.1.1.1"><times id="S4.E8.m1.6.6.1.1.1.2.cmml" xref="S4.E8.m1.6.6.1.1.1.2"></times><ci id="S4.E8.m1.6.6.1.1.1.3.cmml" xref="S4.E8.m1.6.6.1.1.1.3">𝑃</ci><apply id="S4.E8.m1.6.6.1.1.1.1.1.1.cmml" xref="S4.E8.m1.6.6.1.1.1.1.1"><gt id="S4.E8.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.6.6.1.1.1.1.1.1.3"></gt><apply id="S4.E8.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.2"><cos id="S4.E8.m1.5.5.cmml" xref="S4.E8.m1.5.5"></cos><apply id="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.2">𝑆</ci><ci id="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2.2">𝑆</ci><ci id="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.6.6.1.1.1.1.1.1.2.2.2.2.3">𝑏</ci></apply></apply><ci id="S4.E8.m1.6.6.1.1.1.1.1.1.4.cmml" xref="S4.E8.m1.6.6.1.1.1.1.1.1.4">𝜏</ci></apply></apply><apply id="S4.E8.m1.6.6.1.1.3.cmml" xref="S4.E8.m1.6.6.1.1.3"><times id="S4.E8.m1.6.6.1.1.3.1.cmml" xref="S4.E8.m1.6.6.1.1.3.1"></times><ci id="S4.E8.m1.6.6.1.1.3.2.cmml" xref="S4.E8.m1.6.6.1.1.3.2">erf</ci><apply id="S4.E8.m1.4.4.cmml" xref="S4.E8.m1.6.6.1.1.3.3.2"><divide id="S4.E8.m1.4.4.5.cmml" xref="S4.E8.m1.6.6.1.1.3.3.2"></divide><apply id="S4.E8.m1.2.2.2.cmml" xref="S4.E8.m1.2.2.2"><minus id="S4.E8.m1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.3"></minus><apply id="S4.E8.m1.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2"><times id="S4.E8.m1.2.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2.2"></times><ci id="S4.E8.m1.2.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.2.3">𝔼</ci><apply id="S4.E8.m1.2.2.2.2.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1"><csymbol cd="latexml" id="S4.E8.m1.2.2.2.2.1.2.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="S4.E8.m1.2.2.2.2.1.1.1.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.2"><cos id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1"></cos><apply id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2">𝑆</ci><ci id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="S4.E8.m1.2.2.2.2.1.1.1.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.1.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E8.m1.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.2.2.2.2">𝑆</ci><ci id="S4.E8.m1.2.2.2.2.1.1.1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.2.2.2.3">𝑏</ci></apply></apply></apply></apply><ci id="S4.E8.m1.2.2.2.4.cmml" xref="S4.E8.m1.2.2.2.4">𝜏</ci></apply><apply id="S4.E8.m1.4.4.4.cmml" xref="S4.E8.m1.4.4.4"><root id="S4.E8.m1.4.4.4a.cmml" xref="S4.E8.m1.4.4.4"></root><apply id="S4.E8.m1.4.4.4.2.2.cmml" xref="S4.E8.m1.4.4.4.2.2"><times id="S4.E8.m1.4.4.4.2.2.3.cmml" xref="S4.E8.m1.4.4.4.2.2.3"></times><ci id="S4.E8.m1.4.4.4.2.2.4a.cmml" xref="S4.E8.m1.4.4.4.2.2.4"><mtext id="S4.E8.m1.4.4.4.2.2.4.cmml" xref="S4.E8.m1.4.4.4.2.2.4">Var</mtext></ci><apply id="S4.E8.m1.4.4.4.2.2.2.2.cmml" xref="S4.E8.m1.4.4.4.2.2.2.1"><csymbol cd="latexml" id="S4.E8.m1.4.4.4.2.2.2.2.1.cmml" xref="S4.E8.m1.4.4.4.2.2.2.1.2">delimited-[]</csymbol><apply id="S4.E8.m1.4.4.4.2.2.2.1.1.3.cmml" xref="S4.E8.m1.4.4.4.2.2.2.1.1.2"><cos id="S4.E8.m1.3.3.3.1.1.1.cmml" xref="S4.E8.m1.3.3.3.1.1.1"></cos><apply id="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1.2">𝑆</ci><ci id="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E8.m1.4.4.4.2.2.2.1.1.1.1.1.3">𝑎</ci></apply><apply id="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2.cmml" xref="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2.1.cmml" xref="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2">subscript</csymbol><ci id="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2.2.cmml" xref="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2.2">𝑆</ci><ci id="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2.3.cmml" xref="S4.E8.m1.4.4.4.2.2.2.1.1.2.2.2.3">𝑏</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.6c">P\left(\cos(S_{a},S_{b})&gt;\tau\right)=\mathrm{erf}\left(\frac{\mathbb{E}[\cos(S%
_{a},S_{b})]-\tau}{\sqrt{\text{Var}[\cos(S_{a},S_{b})]}}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.6d">italic_P ( roman_cos ( italic_S start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) &gt; italic_τ ) = roman_erf ( divide start_ARG blackboard_E [ roman_cos ( italic_S start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) ] - italic_τ end_ARG start_ARG square-root start_ARG Var [ roman_cos ( italic_S start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) ] end_ARG end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p1.6">where <math alttext="\mathrm{erf}" class="ltx_Math" display="inline" id="S4.p1.4.m1.1"><semantics id="S4.p1.4.m1.1a"><mi id="S4.p1.4.m1.1.1" xref="S4.p1.4.m1.1.1.cmml">erf</mi><annotation-xml encoding="MathML-Content" id="S4.p1.4.m1.1b"><ci id="S4.p1.4.m1.1.1.cmml" xref="S4.p1.4.m1.1.1">erf</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m1.1c">\mathrm{erf}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.4.m1.1d">roman_erf</annotation></semantics></math> is the error function. The vectors <math alttext="S_{a}" class="ltx_Math" display="inline" id="S4.p1.5.m2.1"><semantics id="S4.p1.5.m2.1a"><msub id="S4.p1.5.m2.1.1" xref="S4.p1.5.m2.1.1.cmml"><mi id="S4.p1.5.m2.1.1.2" xref="S4.p1.5.m2.1.1.2.cmml">S</mi><mi id="S4.p1.5.m2.1.1.3" xref="S4.p1.5.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.5.m2.1b"><apply id="S4.p1.5.m2.1.1.cmml" xref="S4.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S4.p1.5.m2.1.1.1.cmml" xref="S4.p1.5.m2.1.1">subscript</csymbol><ci id="S4.p1.5.m2.1.1.2.cmml" xref="S4.p1.5.m2.1.1.2">𝑆</ci><ci id="S4.p1.5.m2.1.1.3.cmml" xref="S4.p1.5.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m2.1c">S_{a}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.5.m2.1d">italic_S start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="S_{b}" class="ltx_Math" display="inline" id="S4.p1.6.m3.1"><semantics id="S4.p1.6.m3.1a"><msub id="S4.p1.6.m3.1.1" xref="S4.p1.6.m3.1.1.cmml"><mi id="S4.p1.6.m3.1.1.2" xref="S4.p1.6.m3.1.1.2.cmml">S</mi><mi id="S4.p1.6.m3.1.1.3" xref="S4.p1.6.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.6.m3.1b"><apply id="S4.p1.6.m3.1.1.cmml" xref="S4.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S4.p1.6.m3.1.1.1.cmml" xref="S4.p1.6.m3.1.1">subscript</csymbol><ci id="S4.p1.6.m3.1.1.2.cmml" xref="S4.p1.6.m3.1.1.2">𝑆</ci><ci id="S4.p1.6.m3.1.1.3.cmml" xref="S4.p1.6.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m3.1c">S_{b}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.6.m3.1d">italic_S start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> are assumed to be drawn from the same Gaussian distribution. As evident from Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.E8" title="In 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">8</span></a>, the discriminative power increases as the variance of the cosine similarity distribution decreases. For a theoretical proof of this and alternative methods for modeling discriminative power, we refer the reader to <cite class="ltx_cite ltx_citemacro_citet">Smith et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib29" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.2">We now verify if the results of Gaussian assumptions also hold for real datasets.
Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.F3" title="Figure 3 ‣ 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3</span></a> shows the distribution of cosine similarities of the reference set feature vectors on the Pittsburgh30k dataset <cite class="ltx_cite ltx_citemacro_citep">(Torii et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib33" title="">2013</a>)</cite>. We compute cosine similarities between all pairs of feature vectors in the reference set and plot the probability mass function (PMF) with and without <span class="ltx_text ltx_font_typewriter" id="S4.p2.2.1">AE-SVC</span> for two models: the off-the-shelf foundation model Dino (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.F3.sf1" title="In Figure 3 ‣ 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3a</span></a>) and the SOTA dataset-specific model Cosplace <cite class="ltx_cite ltx_citemacro_citep">(Berton et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib3" title="">2022</a>)</cite> (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.F3.sf2" title="In Figure 3 ‣ 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3b</span></a>).
Cosplace, which excels at retrieval, exhibits a PMF with significantly less variance compared to Dino, as seen in the blue curves in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.F3.sf1" title="In Figure 3 ‣ 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3a</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.F3.sf2" title="In Figure 3 ‣ 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3b</span></a>. The lower variance indicates more discriminative feature vectors, which aligns with the findings from Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.E8" title="In 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">8</span></a> that smaller variance enhances discriminative power and retrieval performance.
Applying <span class="ltx_text ltx_font_typewriter" id="S4.p2.2.2">AE-SVC</span> reduces the variance in both models (orange curves), with a more pronounced shift in Dino than in Cosplace. This suggests that <span class="ltx_text ltx_font_typewriter" id="S4.p2.2.3">AE-SVC</span> benefits the off-the-shelf foundation model more (<math alttext="10\%" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mn id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">10</mn><mo id="S4.p2.1.m1.1.1.1" xref="S4.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1">percent</csymbol><cn id="S4.p2.1.m1.1.1.2.cmml" type="integer" xref="S4.p2.1.m1.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">10 %</annotation></semantics></math>) than the dataset-specific model (<math alttext="2\%" class="ltx_Math" display="inline" id="S4.p2.2.m2.1"><semantics id="S4.p2.2.m2.1a"><mrow id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mn id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">2</mn><mo id="S4.p2.2.m2.1.1.1" xref="S4.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1">percent</csymbol><cn id="S4.p2.2.m2.1.1.2.cmml" type="integer" xref="S4.p2.2.m2.1.1.2">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">2\%</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m2.1d">2 %</annotation></semantics></math>), as reflected in the retrieval performance plot in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.F3.sf3" title="In Figure 3 ‣ 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3c</span></a>. Thus, the remainder of this work focuses on off-the-shelf foundation models.</p>
</div>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="128" id="S4.F3.sf1.g1" src="extracted/5913932/figs/theory_simspace_dino.png" width="192"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="123" id="S4.F3.sf2.g1" src="extracted/5913932/figs/theory_simspace_cosplace.png" width="192"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="121" id="S4.F3.sf3.g1" src="extracted/5913932/figs/theory_simspace_cosplace_vs_dino.png" width="192"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S4.F3.2.1" style="font-size:90%;">AE-SVC<span class="ltx_text ltx_font_serif" id="S4.F3.2.1.1"> reduces the variance of cosine similarity distributions in both foundation (a) and dataset-specific models (b), with a more significant shift in foundation models (a).<span class="ltx_text ltx_font_medium" id="S4.F3.2.1.1.1"> This results in greater improvement in retrieval performance for the foundation model (Dino) compared to the dataset-specific model (Cosplace), as shown in (c). </span></span></span></figcaption>
</figure>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.13">We have mathematically and empirically demonstrated that the discriminative power of the retrieval task is maximized when the variance of the cosine similarity distribution is minimized. Next, we will prove that the constraints introduced on the latent space in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3.SS1" title="3.1 Autoencoders with Strong Variance Constraints (AE-SVC) ‣ 3 Methodology ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3.1</span></a> indeed minimize this variance.
Let <math alttext="Z" class="ltx_Math" display="inline" id="S4.p3.1.m1.1"><semantics id="S4.p3.1.m1.1a"><mi id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><ci id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S4.p3.1.m1.1d">italic_Z</annotation></semantics></math> be the latent space distribution of <span class="ltx_text ltx_font_typewriter" id="S4.p3.13.1">AE-SVC</span>. By applying constraints in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3.E2" title="In 3.1 Autoencoders with Strong Variance Constraints (AE-SVC) ‣ 3 Methodology ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">2</span></a> and Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3.E4" title="In 3.1 Autoencoders with Strong Variance Constraints (AE-SVC) ‣ 3 Methodology ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">4</span></a>, the distribution <math alttext="Z" class="ltx_Math" display="inline" id="S4.p3.2.m2.1"><semantics id="S4.p3.2.m2.1a"><mi id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><ci id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S4.p3.2.m2.1d">italic_Z</annotation></semantics></math> has a zero mean, <math alttext="\mu=0" class="ltx_Math" display="inline" id="S4.p3.3.m3.1"><semantics id="S4.p3.3.m3.1a"><mrow id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml"><mi id="S4.p3.3.m3.1.1.2" xref="S4.p3.3.m3.1.1.2.cmml">μ</mi><mo id="S4.p3.3.m3.1.1.1" xref="S4.p3.3.m3.1.1.1.cmml">=</mo><mn id="S4.p3.3.m3.1.1.3" xref="S4.p3.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><apply id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1"><eq id="S4.p3.3.m3.1.1.1.cmml" xref="S4.p3.3.m3.1.1.1"></eq><ci id="S4.p3.3.m3.1.1.2.cmml" xref="S4.p3.3.m3.1.1.2">𝜇</ci><cn id="S4.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.p3.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">\mu=0</annotation><annotation encoding="application/x-llamapun" id="S4.p3.3.m3.1d">italic_μ = 0</annotation></semantics></math>, and a diagonal covariance matrix <math alttext="\Sigma\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S4.p3.4.m4.1"><semantics id="S4.p3.4.m4.1a"><mrow id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml"><mi id="S4.p3.4.m4.1.1.2" mathvariant="normal" xref="S4.p3.4.m4.1.1.2.cmml">Σ</mi><mo id="S4.p3.4.m4.1.1.1" xref="S4.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S4.p3.4.m4.1.1.3" xref="S4.p3.4.m4.1.1.3.cmml"><mi id="S4.p3.4.m4.1.1.3.2" xref="S4.p3.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.p3.4.m4.1.1.3.3" xref="S4.p3.4.m4.1.1.3.3.cmml"><mi id="S4.p3.4.m4.1.1.3.3.2" xref="S4.p3.4.m4.1.1.3.3.2.cmml">d</mi><mo id="S4.p3.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.p3.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S4.p3.4.m4.1.1.3.3.3" xref="S4.p3.4.m4.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><apply id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1"><in id="S4.p3.4.m4.1.1.1.cmml" xref="S4.p3.4.m4.1.1.1"></in><ci id="S4.p3.4.m4.1.1.2.cmml" xref="S4.p3.4.m4.1.1.2">Σ</ci><apply id="S4.p3.4.m4.1.1.3.cmml" xref="S4.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.p3.4.m4.1.1.3.1.cmml" xref="S4.p3.4.m4.1.1.3">superscript</csymbol><ci id="S4.p3.4.m4.1.1.3.2.cmml" xref="S4.p3.4.m4.1.1.3.2">ℝ</ci><apply id="S4.p3.4.m4.1.1.3.3.cmml" xref="S4.p3.4.m4.1.1.3.3"><times id="S4.p3.4.m4.1.1.3.3.1.cmml" xref="S4.p3.4.m4.1.1.3.3.1"></times><ci id="S4.p3.4.m4.1.1.3.3.2.cmml" xref="S4.p3.4.m4.1.1.3.3.2">𝑑</ci><ci id="S4.p3.4.m4.1.1.3.3.3.cmml" xref="S4.p3.4.m4.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">\Sigma\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.4.m4.1d">roman_Σ ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, with eigenvalues <math alttext="\lambda_{i}=\sigma_{i}^{2}" class="ltx_Math" display="inline" id="S4.p3.5.m5.1"><semantics id="S4.p3.5.m5.1a"><mrow id="S4.p3.5.m5.1.1" xref="S4.p3.5.m5.1.1.cmml"><msub id="S4.p3.5.m5.1.1.2" xref="S4.p3.5.m5.1.1.2.cmml"><mi id="S4.p3.5.m5.1.1.2.2" xref="S4.p3.5.m5.1.1.2.2.cmml">λ</mi><mi id="S4.p3.5.m5.1.1.2.3" xref="S4.p3.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="S4.p3.5.m5.1.1.1" xref="S4.p3.5.m5.1.1.1.cmml">=</mo><msubsup id="S4.p3.5.m5.1.1.3" xref="S4.p3.5.m5.1.1.3.cmml"><mi id="S4.p3.5.m5.1.1.3.2.2" xref="S4.p3.5.m5.1.1.3.2.2.cmml">σ</mi><mi id="S4.p3.5.m5.1.1.3.2.3" xref="S4.p3.5.m5.1.1.3.2.3.cmml">i</mi><mn id="S4.p3.5.m5.1.1.3.3" xref="S4.p3.5.m5.1.1.3.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.5.m5.1b"><apply id="S4.p3.5.m5.1.1.cmml" xref="S4.p3.5.m5.1.1"><eq id="S4.p3.5.m5.1.1.1.cmml" xref="S4.p3.5.m5.1.1.1"></eq><apply id="S4.p3.5.m5.1.1.2.cmml" xref="S4.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.p3.5.m5.1.1.2.1.cmml" xref="S4.p3.5.m5.1.1.2">subscript</csymbol><ci id="S4.p3.5.m5.1.1.2.2.cmml" xref="S4.p3.5.m5.1.1.2.2">𝜆</ci><ci id="S4.p3.5.m5.1.1.2.3.cmml" xref="S4.p3.5.m5.1.1.2.3">𝑖</ci></apply><apply id="S4.p3.5.m5.1.1.3.cmml" xref="S4.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.p3.5.m5.1.1.3.1.cmml" xref="S4.p3.5.m5.1.1.3">superscript</csymbol><apply id="S4.p3.5.m5.1.1.3.2.cmml" xref="S4.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.p3.5.m5.1.1.3.2.1.cmml" xref="S4.p3.5.m5.1.1.3">subscript</csymbol><ci id="S4.p3.5.m5.1.1.3.2.2.cmml" xref="S4.p3.5.m5.1.1.3.2.2">𝜎</ci><ci id="S4.p3.5.m5.1.1.3.2.3.cmml" xref="S4.p3.5.m5.1.1.3.2.3">𝑖</ci></apply><cn id="S4.p3.5.m5.1.1.3.3.cmml" type="integer" xref="S4.p3.5.m5.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.5.m5.1c">\lambda_{i}=\sigma_{i}^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.5.m5.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\sigma_{i}^{2}" class="ltx_Math" display="inline" id="S4.p3.6.m6.1"><semantics id="S4.p3.6.m6.1a"><msubsup id="S4.p3.6.m6.1.1" xref="S4.p3.6.m6.1.1.cmml"><mi id="S4.p3.6.m6.1.1.2.2" xref="S4.p3.6.m6.1.1.2.2.cmml">σ</mi><mi id="S4.p3.6.m6.1.1.2.3" xref="S4.p3.6.m6.1.1.2.3.cmml">i</mi><mn id="S4.p3.6.m6.1.1.3" xref="S4.p3.6.m6.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.p3.6.m6.1b"><apply id="S4.p3.6.m6.1.1.cmml" xref="S4.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p3.6.m6.1.1.1.cmml" xref="S4.p3.6.m6.1.1">superscript</csymbol><apply id="S4.p3.6.m6.1.1.2.cmml" xref="S4.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p3.6.m6.1.1.2.1.cmml" xref="S4.p3.6.m6.1.1">subscript</csymbol><ci id="S4.p3.6.m6.1.1.2.2.cmml" xref="S4.p3.6.m6.1.1.2.2">𝜎</ci><ci id="S4.p3.6.m6.1.1.2.3.cmml" xref="S4.p3.6.m6.1.1.2.3">𝑖</ci></apply><cn id="S4.p3.6.m6.1.1.3.cmml" type="integer" xref="S4.p3.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.6.m6.1c">\sigma_{i}^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.6.m6.1d">italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> is the variance of the individual dimensions of <math alttext="Z" class="ltx_Math" display="inline" id="S4.p3.7.m7.1"><semantics id="S4.p3.7.m7.1a"><mi id="S4.p3.7.m7.1.1" xref="S4.p3.7.m7.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.p3.7.m7.1b"><ci id="S4.p3.7.m7.1.1.cmml" xref="S4.p3.7.m7.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.7.m7.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S4.p3.7.m7.1d">italic_Z</annotation></semantics></math>. Given two vectors <math alttext="X" class="ltx_Math" display="inline" id="S4.p3.8.m8.1"><semantics id="S4.p3.8.m8.1a"><mi id="S4.p3.8.m8.1.1" xref="S4.p3.8.m8.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.p3.8.m8.1b"><ci id="S4.p3.8.m8.1.1.cmml" xref="S4.p3.8.m8.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.8.m8.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.p3.8.m8.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S4.p3.9.m9.1"><semantics id="S4.p3.9.m9.1a"><mi id="S4.p3.9.m9.1.1" xref="S4.p3.9.m9.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S4.p3.9.m9.1b"><ci id="S4.p3.9.m9.1.1.cmml" xref="S4.p3.9.m9.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.9.m9.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S4.p3.9.m9.1d">italic_Y</annotation></semantics></math> drawn from <math alttext="Z" class="ltx_Math" display="inline" id="S4.p3.10.m10.1"><semantics id="S4.p3.10.m10.1a"><mi id="S4.p3.10.m10.1.1" xref="S4.p3.10.m10.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S4.p3.10.m10.1b"><ci id="S4.p3.10.m10.1.1.cmml" xref="S4.p3.10.m10.1.1">𝑍</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.10.m10.1c">Z</annotation><annotation encoding="application/x-llamapun" id="S4.p3.10.m10.1d">italic_Z</annotation></semantics></math>, <span class="ltx_text ltx_font_italic" id="S4.p3.13.2">i.e.</span>, <math alttext="X,Y\sim Z" class="ltx_Math" display="inline" id="S4.p3.11.m11.2"><semantics id="S4.p3.11.m11.2a"><mrow id="S4.p3.11.m11.2.3" xref="S4.p3.11.m11.2.3.cmml"><mrow id="S4.p3.11.m11.2.3.2.2" xref="S4.p3.11.m11.2.3.2.1.cmml"><mi id="S4.p3.11.m11.1.1" xref="S4.p3.11.m11.1.1.cmml">X</mi><mo id="S4.p3.11.m11.2.3.2.2.1" xref="S4.p3.11.m11.2.3.2.1.cmml">,</mo><mi id="S4.p3.11.m11.2.2" xref="S4.p3.11.m11.2.2.cmml">Y</mi></mrow><mo id="S4.p3.11.m11.2.3.1" xref="S4.p3.11.m11.2.3.1.cmml">∼</mo><mi id="S4.p3.11.m11.2.3.3" xref="S4.p3.11.m11.2.3.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.11.m11.2b"><apply id="S4.p3.11.m11.2.3.cmml" xref="S4.p3.11.m11.2.3"><csymbol cd="latexml" id="S4.p3.11.m11.2.3.1.cmml" xref="S4.p3.11.m11.2.3.1">similar-to</csymbol><list id="S4.p3.11.m11.2.3.2.1.cmml" xref="S4.p3.11.m11.2.3.2.2"><ci id="S4.p3.11.m11.1.1.cmml" xref="S4.p3.11.m11.1.1">𝑋</ci><ci id="S4.p3.11.m11.2.2.cmml" xref="S4.p3.11.m11.2.2">𝑌</ci></list><ci id="S4.p3.11.m11.2.3.3.cmml" xref="S4.p3.11.m11.2.3.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.11.m11.2c">X,Y\sim Z</annotation><annotation encoding="application/x-llamapun" id="S4.p3.11.m11.2d">italic_X , italic_Y ∼ italic_Z</annotation></semantics></math>, the cosine similarity between <math alttext="X" class="ltx_Math" display="inline" id="S4.p3.12.m12.1"><semantics id="S4.p3.12.m12.1a"><mi id="S4.p3.12.m12.1.1" xref="S4.p3.12.m12.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.p3.12.m12.1b"><ci id="S4.p3.12.m12.1.1.cmml" xref="S4.p3.12.m12.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.12.m12.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.p3.12.m12.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S4.p3.13.m13.1"><semantics id="S4.p3.13.m13.1a"><mi id="S4.p3.13.m13.1.1" xref="S4.p3.13.m13.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S4.p3.13.m13.1b"><ci id="S4.p3.13.m13.1.1.cmml" xref="S4.p3.13.m13.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.13.m13.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S4.p3.13.m13.1d">italic_Y</annotation></semantics></math> is:</p>
</div>
<div class="ltx_para" id="S4.p4">
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{cos}(X,Y)=\frac{\sum_{i=1}^{d}X_{i}Y_{i}}{\sqrt{\sum_{i}X_{i}^{2}}%
\sqrt{\sum_{i}Y_{i}^{2}}}=\frac{X^{T}Y}{\sqrt{(X^{T}X)(Y^{T}Y)}}=\frac{X^{T}Y}%
{\|X\|\|Y\|}," class="ltx_Math" display="block" id="S4.E9.m1.7"><semantics id="S4.E9.m1.7a"><mrow id="S4.E9.m1.7.7.1" xref="S4.E9.m1.7.7.1.1.cmml"><mrow id="S4.E9.m1.7.7.1.1" xref="S4.E9.m1.7.7.1.1.cmml"><mrow id="S4.E9.m1.7.7.1.1.2" xref="S4.E9.m1.7.7.1.1.2.cmml"><mi id="S4.E9.m1.7.7.1.1.2.2" xref="S4.E9.m1.7.7.1.1.2.2.cmml">cos</mi><mo id="S4.E9.m1.7.7.1.1.2.1" xref="S4.E9.m1.7.7.1.1.2.1.cmml">⁢</mo><mrow id="S4.E9.m1.7.7.1.1.2.3.2" xref="S4.E9.m1.7.7.1.1.2.3.1.cmml"><mo id="S4.E9.m1.7.7.1.1.2.3.2.1" stretchy="false" xref="S4.E9.m1.7.7.1.1.2.3.1.cmml">(</mo><mi id="S4.E9.m1.5.5" xref="S4.E9.m1.5.5.cmml">X</mi><mo id="S4.E9.m1.7.7.1.1.2.3.2.2" xref="S4.E9.m1.7.7.1.1.2.3.1.cmml">,</mo><mi id="S4.E9.m1.6.6" xref="S4.E9.m1.6.6.cmml">Y</mi><mo id="S4.E9.m1.7.7.1.1.2.3.2.3" stretchy="false" xref="S4.E9.m1.7.7.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.7.7.1.1.3" xref="S4.E9.m1.7.7.1.1.3.cmml">=</mo><mfrac id="S4.E9.m1.7.7.1.1.4" xref="S4.E9.m1.7.7.1.1.4.cmml"><mrow id="S4.E9.m1.7.7.1.1.4.2" xref="S4.E9.m1.7.7.1.1.4.2.cmml"><msubsup id="S4.E9.m1.7.7.1.1.4.2.1" xref="S4.E9.m1.7.7.1.1.4.2.1.cmml"><mo id="S4.E9.m1.7.7.1.1.4.2.1.2.2" xref="S4.E9.m1.7.7.1.1.4.2.1.2.2.cmml">∑</mo><mrow id="S4.E9.m1.7.7.1.1.4.2.1.2.3" xref="S4.E9.m1.7.7.1.1.4.2.1.2.3.cmml"><mi id="S4.E9.m1.7.7.1.1.4.2.1.2.3.2" xref="S4.E9.m1.7.7.1.1.4.2.1.2.3.2.cmml">i</mi><mo id="S4.E9.m1.7.7.1.1.4.2.1.2.3.1" xref="S4.E9.m1.7.7.1.1.4.2.1.2.3.1.cmml">=</mo><mn id="S4.E9.m1.7.7.1.1.4.2.1.2.3.3" xref="S4.E9.m1.7.7.1.1.4.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.7.7.1.1.4.2.1.3" xref="S4.E9.m1.7.7.1.1.4.2.1.3.cmml">d</mi></msubsup><mrow id="S4.E9.m1.7.7.1.1.4.2.2" xref="S4.E9.m1.7.7.1.1.4.2.2.cmml"><msub id="S4.E9.m1.7.7.1.1.4.2.2.2" xref="S4.E9.m1.7.7.1.1.4.2.2.2.cmml"><mi id="S4.E9.m1.7.7.1.1.4.2.2.2.2" xref="S4.E9.m1.7.7.1.1.4.2.2.2.2.cmml">X</mi><mi id="S4.E9.m1.7.7.1.1.4.2.2.2.3" xref="S4.E9.m1.7.7.1.1.4.2.2.2.3.cmml">i</mi></msub><mo id="S4.E9.m1.7.7.1.1.4.2.2.1" xref="S4.E9.m1.7.7.1.1.4.2.2.1.cmml">⁢</mo><msub id="S4.E9.m1.7.7.1.1.4.2.2.3" xref="S4.E9.m1.7.7.1.1.4.2.2.3.cmml"><mi id="S4.E9.m1.7.7.1.1.4.2.2.3.2" xref="S4.E9.m1.7.7.1.1.4.2.2.3.2.cmml">Y</mi><mi id="S4.E9.m1.7.7.1.1.4.2.2.3.3" xref="S4.E9.m1.7.7.1.1.4.2.2.3.3.cmml">i</mi></msub></mrow></mrow><mrow id="S4.E9.m1.7.7.1.1.4.3" xref="S4.E9.m1.7.7.1.1.4.3.cmml"><msqrt id="S4.E9.m1.7.7.1.1.4.3.2" xref="S4.E9.m1.7.7.1.1.4.3.2.cmml"><mrow id="S4.E9.m1.7.7.1.1.4.3.2.2" xref="S4.E9.m1.7.7.1.1.4.3.2.2.cmml"><msub id="S4.E9.m1.7.7.1.1.4.3.2.2.1" xref="S4.E9.m1.7.7.1.1.4.3.2.2.1.cmml"><mo id="S4.E9.m1.7.7.1.1.4.3.2.2.1.2" xref="S4.E9.m1.7.7.1.1.4.3.2.2.1.2.cmml">∑</mo><mi id="S4.E9.m1.7.7.1.1.4.3.2.2.1.3" xref="S4.E9.m1.7.7.1.1.4.3.2.2.1.3.cmml">i</mi></msub><msubsup id="S4.E9.m1.7.7.1.1.4.3.2.2.2" xref="S4.E9.m1.7.7.1.1.4.3.2.2.2.cmml"><mi id="S4.E9.m1.7.7.1.1.4.3.2.2.2.2.2" xref="S4.E9.m1.7.7.1.1.4.3.2.2.2.2.2.cmml">X</mi><mi id="S4.E9.m1.7.7.1.1.4.3.2.2.2.2.3" xref="S4.E9.m1.7.7.1.1.4.3.2.2.2.2.3.cmml">i</mi><mn id="S4.E9.m1.7.7.1.1.4.3.2.2.2.3" xref="S4.E9.m1.7.7.1.1.4.3.2.2.2.3.cmml">2</mn></msubsup></mrow></msqrt><mo id="S4.E9.m1.7.7.1.1.4.3.1" xref="S4.E9.m1.7.7.1.1.4.3.1.cmml">⁢</mo><msqrt id="S4.E9.m1.7.7.1.1.4.3.3" xref="S4.E9.m1.7.7.1.1.4.3.3.cmml"><mrow id="S4.E9.m1.7.7.1.1.4.3.3.2" xref="S4.E9.m1.7.7.1.1.4.3.3.2.cmml"><msub id="S4.E9.m1.7.7.1.1.4.3.3.2.1" xref="S4.E9.m1.7.7.1.1.4.3.3.2.1.cmml"><mo id="S4.E9.m1.7.7.1.1.4.3.3.2.1.2" xref="S4.E9.m1.7.7.1.1.4.3.3.2.1.2.cmml">∑</mo><mi id="S4.E9.m1.7.7.1.1.4.3.3.2.1.3" xref="S4.E9.m1.7.7.1.1.4.3.3.2.1.3.cmml">i</mi></msub><msubsup id="S4.E9.m1.7.7.1.1.4.3.3.2.2" xref="S4.E9.m1.7.7.1.1.4.3.3.2.2.cmml"><mi id="S4.E9.m1.7.7.1.1.4.3.3.2.2.2.2" xref="S4.E9.m1.7.7.1.1.4.3.3.2.2.2.2.cmml">Y</mi><mi id="S4.E9.m1.7.7.1.1.4.3.3.2.2.2.3" xref="S4.E9.m1.7.7.1.1.4.3.3.2.2.2.3.cmml">i</mi><mn id="S4.E9.m1.7.7.1.1.4.3.3.2.2.3" xref="S4.E9.m1.7.7.1.1.4.3.3.2.2.3.cmml">2</mn></msubsup></mrow></msqrt></mrow></mfrac><mo id="S4.E9.m1.7.7.1.1.5" xref="S4.E9.m1.7.7.1.1.5.cmml">=</mo><mfrac id="S4.E9.m1.2.2" xref="S4.E9.m1.2.2.cmml"><mrow id="S4.E9.m1.2.2.4" xref="S4.E9.m1.2.2.4.cmml"><msup id="S4.E9.m1.2.2.4.2" xref="S4.E9.m1.2.2.4.2.cmml"><mi id="S4.E9.m1.2.2.4.2.2" xref="S4.E9.m1.2.2.4.2.2.cmml">X</mi><mi id="S4.E9.m1.2.2.4.2.3" xref="S4.E9.m1.2.2.4.2.3.cmml">T</mi></msup><mo id="S4.E9.m1.2.2.4.1" xref="S4.E9.m1.2.2.4.1.cmml">⁢</mo><mi id="S4.E9.m1.2.2.4.3" xref="S4.E9.m1.2.2.4.3.cmml">Y</mi></mrow><msqrt id="S4.E9.m1.2.2.2" xref="S4.E9.m1.2.2.2.cmml"><mrow id="S4.E9.m1.2.2.2.2.2" xref="S4.E9.m1.2.2.2.2.2.cmml"><mrow id="S4.E9.m1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.cmml"><msup id="S4.E9.m1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.cmml">X</mi><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="S4.E9.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E9.m1.2.2.2.2.2.3" xref="S4.E9.m1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S4.E9.m1.2.2.2.2.2.2.1" xref="S4.E9.m1.2.2.2.2.2.2.1.1.cmml"><mo id="S4.E9.m1.2.2.2.2.2.2.1.2" stretchy="false" xref="S4.E9.m1.2.2.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.E9.m1.2.2.2.2.2.2.1.1" xref="S4.E9.m1.2.2.2.2.2.2.1.1.cmml"><msup id="S4.E9.m1.2.2.2.2.2.2.1.1.2" xref="S4.E9.m1.2.2.2.2.2.2.1.1.2.cmml"><mi id="S4.E9.m1.2.2.2.2.2.2.1.1.2.2" xref="S4.E9.m1.2.2.2.2.2.2.1.1.2.2.cmml">Y</mi><mi id="S4.E9.m1.2.2.2.2.2.2.1.1.2.3" xref="S4.E9.m1.2.2.2.2.2.2.1.1.2.3.cmml">T</mi></msup><mo id="S4.E9.m1.2.2.2.2.2.2.1.1.1" xref="S4.E9.m1.2.2.2.2.2.2.1.1.1.cmml">⁢</mo><mi id="S4.E9.m1.2.2.2.2.2.2.1.1.3" xref="S4.E9.m1.2.2.2.2.2.2.1.1.3.cmml">Y</mi></mrow><mo id="S4.E9.m1.2.2.2.2.2.2.1.3" stretchy="false" xref="S4.E9.m1.2.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msqrt></mfrac><mo id="S4.E9.m1.7.7.1.1.6" xref="S4.E9.m1.7.7.1.1.6.cmml">=</mo><mfrac id="S4.E9.m1.4.4" xref="S4.E9.m1.4.4.cmml"><mrow id="S4.E9.m1.4.4.4" xref="S4.E9.m1.4.4.4.cmml"><msup id="S4.E9.m1.4.4.4.2" xref="S4.E9.m1.4.4.4.2.cmml"><mi id="S4.E9.m1.4.4.4.2.2" xref="S4.E9.m1.4.4.4.2.2.cmml">X</mi><mi id="S4.E9.m1.4.4.4.2.3" xref="S4.E9.m1.4.4.4.2.3.cmml">T</mi></msup><mo id="S4.E9.m1.4.4.4.1" xref="S4.E9.m1.4.4.4.1.cmml">⁢</mo><mi id="S4.E9.m1.4.4.4.3" xref="S4.E9.m1.4.4.4.3.cmml">Y</mi></mrow><mrow id="S4.E9.m1.4.4.2" xref="S4.E9.m1.4.4.2.cmml"><mrow id="S4.E9.m1.4.4.2.4.2" xref="S4.E9.m1.4.4.2.4.1.cmml"><mo id="S4.E9.m1.4.4.2.4.2.1" stretchy="false" xref="S4.E9.m1.4.4.2.4.1.1.cmml">‖</mo><mi id="S4.E9.m1.3.3.1.1" xref="S4.E9.m1.3.3.1.1.cmml">X</mi><mo id="S4.E9.m1.4.4.2.4.2.2" stretchy="false" xref="S4.E9.m1.4.4.2.4.1.1.cmml">‖</mo></mrow><mo id="S4.E9.m1.4.4.2.3" xref="S4.E9.m1.4.4.2.3.cmml">⁢</mo><mrow id="S4.E9.m1.4.4.2.5.2" xref="S4.E9.m1.4.4.2.5.1.cmml"><mo id="S4.E9.m1.4.4.2.5.2.1" stretchy="false" xref="S4.E9.m1.4.4.2.5.1.1.cmml">‖</mo><mi id="S4.E9.m1.4.4.2.2" xref="S4.E9.m1.4.4.2.2.cmml">Y</mi><mo id="S4.E9.m1.4.4.2.5.2.2" stretchy="false" xref="S4.E9.m1.4.4.2.5.1.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><mo id="S4.E9.m1.7.7.1.2" xref="S4.E9.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.7b"><apply id="S4.E9.m1.7.7.1.1.cmml" xref="S4.E9.m1.7.7.1"><and id="S4.E9.m1.7.7.1.1a.cmml" xref="S4.E9.m1.7.7.1"></and><apply id="S4.E9.m1.7.7.1.1b.cmml" xref="S4.E9.m1.7.7.1"><eq id="S4.E9.m1.7.7.1.1.3.cmml" xref="S4.E9.m1.7.7.1.1.3"></eq><apply id="S4.E9.m1.7.7.1.1.2.cmml" xref="S4.E9.m1.7.7.1.1.2"><times id="S4.E9.m1.7.7.1.1.2.1.cmml" xref="S4.E9.m1.7.7.1.1.2.1"></times><ci id="S4.E9.m1.7.7.1.1.2.2.cmml" xref="S4.E9.m1.7.7.1.1.2.2">cos</ci><interval closure="open" id="S4.E9.m1.7.7.1.1.2.3.1.cmml" xref="S4.E9.m1.7.7.1.1.2.3.2"><ci id="S4.E9.m1.5.5.cmml" xref="S4.E9.m1.5.5">𝑋</ci><ci id="S4.E9.m1.6.6.cmml" xref="S4.E9.m1.6.6">𝑌</ci></interval></apply><apply id="S4.E9.m1.7.7.1.1.4.cmml" xref="S4.E9.m1.7.7.1.1.4"><divide id="S4.E9.m1.7.7.1.1.4.1.cmml" xref="S4.E9.m1.7.7.1.1.4"></divide><apply id="S4.E9.m1.7.7.1.1.4.2.cmml" xref="S4.E9.m1.7.7.1.1.4.2"><apply id="S4.E9.m1.7.7.1.1.4.2.1.cmml" xref="S4.E9.m1.7.7.1.1.4.2.1"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.4.2.1.1.cmml" xref="S4.E9.m1.7.7.1.1.4.2.1">superscript</csymbol><apply id="S4.E9.m1.7.7.1.1.4.2.1.2.cmml" xref="S4.E9.m1.7.7.1.1.4.2.1"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.4.2.1.2.1.cmml" xref="S4.E9.m1.7.7.1.1.4.2.1">subscript</csymbol><sum id="S4.E9.m1.7.7.1.1.4.2.1.2.2.cmml" xref="S4.E9.m1.7.7.1.1.4.2.1.2.2"></sum><apply id="S4.E9.m1.7.7.1.1.4.2.1.2.3.cmml" xref="S4.E9.m1.7.7.1.1.4.2.1.2.3"><eq id="S4.E9.m1.7.7.1.1.4.2.1.2.3.1.cmml" xref="S4.E9.m1.7.7.1.1.4.2.1.2.3.1"></eq><ci id="S4.E9.m1.7.7.1.1.4.2.1.2.3.2.cmml" xref="S4.E9.m1.7.7.1.1.4.2.1.2.3.2">𝑖</ci><cn id="S4.E9.m1.7.7.1.1.4.2.1.2.3.3.cmml" type="integer" xref="S4.E9.m1.7.7.1.1.4.2.1.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.7.7.1.1.4.2.1.3.cmml" xref="S4.E9.m1.7.7.1.1.4.2.1.3">𝑑</ci></apply><apply id="S4.E9.m1.7.7.1.1.4.2.2.cmml" xref="S4.E9.m1.7.7.1.1.4.2.2"><times id="S4.E9.m1.7.7.1.1.4.2.2.1.cmml" xref="S4.E9.m1.7.7.1.1.4.2.2.1"></times><apply id="S4.E9.m1.7.7.1.1.4.2.2.2.cmml" xref="S4.E9.m1.7.7.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.4.2.2.2.1.cmml" xref="S4.E9.m1.7.7.1.1.4.2.2.2">subscript</csymbol><ci id="S4.E9.m1.7.7.1.1.4.2.2.2.2.cmml" xref="S4.E9.m1.7.7.1.1.4.2.2.2.2">𝑋</ci><ci id="S4.E9.m1.7.7.1.1.4.2.2.2.3.cmml" xref="S4.E9.m1.7.7.1.1.4.2.2.2.3">𝑖</ci></apply><apply id="S4.E9.m1.7.7.1.1.4.2.2.3.cmml" xref="S4.E9.m1.7.7.1.1.4.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.4.2.2.3.1.cmml" xref="S4.E9.m1.7.7.1.1.4.2.2.3">subscript</csymbol><ci id="S4.E9.m1.7.7.1.1.4.2.2.3.2.cmml" xref="S4.E9.m1.7.7.1.1.4.2.2.3.2">𝑌</ci><ci id="S4.E9.m1.7.7.1.1.4.2.2.3.3.cmml" xref="S4.E9.m1.7.7.1.1.4.2.2.3.3">𝑖</ci></apply></apply></apply><apply id="S4.E9.m1.7.7.1.1.4.3.cmml" xref="S4.E9.m1.7.7.1.1.4.3"><times id="S4.E9.m1.7.7.1.1.4.3.1.cmml" xref="S4.E9.m1.7.7.1.1.4.3.1"></times><apply id="S4.E9.m1.7.7.1.1.4.3.2.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2"><root id="S4.E9.m1.7.7.1.1.4.3.2a.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2"></root><apply id="S4.E9.m1.7.7.1.1.4.3.2.2.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2.2"><apply id="S4.E9.m1.7.7.1.1.4.3.2.2.1.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2.2.1"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.4.3.2.2.1.1.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2.2.1">subscript</csymbol><sum id="S4.E9.m1.7.7.1.1.4.3.2.2.1.2.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2.2.1.2"></sum><ci id="S4.E9.m1.7.7.1.1.4.3.2.2.1.3.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2.2.1.3">𝑖</ci></apply><apply id="S4.E9.m1.7.7.1.1.4.3.2.2.2.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.4.3.2.2.2.1.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2.2.2">superscript</csymbol><apply id="S4.E9.m1.7.7.1.1.4.3.2.2.2.2.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.4.3.2.2.2.2.1.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2.2.2">subscript</csymbol><ci id="S4.E9.m1.7.7.1.1.4.3.2.2.2.2.2.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2.2.2.2.2">𝑋</ci><ci id="S4.E9.m1.7.7.1.1.4.3.2.2.2.2.3.cmml" xref="S4.E9.m1.7.7.1.1.4.3.2.2.2.2.3">𝑖</ci></apply><cn id="S4.E9.m1.7.7.1.1.4.3.2.2.2.3.cmml" type="integer" xref="S4.E9.m1.7.7.1.1.4.3.2.2.2.3">2</cn></apply></apply></apply><apply id="S4.E9.m1.7.7.1.1.4.3.3.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3"><root id="S4.E9.m1.7.7.1.1.4.3.3a.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3"></root><apply id="S4.E9.m1.7.7.1.1.4.3.3.2.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3.2"><apply id="S4.E9.m1.7.7.1.1.4.3.3.2.1.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3.2.1"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.4.3.3.2.1.1.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3.2.1">subscript</csymbol><sum id="S4.E9.m1.7.7.1.1.4.3.3.2.1.2.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3.2.1.2"></sum><ci id="S4.E9.m1.7.7.1.1.4.3.3.2.1.3.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3.2.1.3">𝑖</ci></apply><apply id="S4.E9.m1.7.7.1.1.4.3.3.2.2.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.4.3.3.2.2.1.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3.2.2">superscript</csymbol><apply id="S4.E9.m1.7.7.1.1.4.3.3.2.2.2.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.4.3.3.2.2.2.1.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3.2.2">subscript</csymbol><ci id="S4.E9.m1.7.7.1.1.4.3.3.2.2.2.2.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3.2.2.2.2">𝑌</ci><ci id="S4.E9.m1.7.7.1.1.4.3.3.2.2.2.3.cmml" xref="S4.E9.m1.7.7.1.1.4.3.3.2.2.2.3">𝑖</ci></apply><cn id="S4.E9.m1.7.7.1.1.4.3.3.2.2.3.cmml" type="integer" xref="S4.E9.m1.7.7.1.1.4.3.3.2.2.3">2</cn></apply></apply></apply></apply></apply></apply><apply id="S4.E9.m1.7.7.1.1c.cmml" xref="S4.E9.m1.7.7.1"><eq id="S4.E9.m1.7.7.1.1.5.cmml" xref="S4.E9.m1.7.7.1.1.5"></eq><share href="https://arxiv.org/html/2410.07022v1#S4.E9.m1.7.7.1.1.4.cmml" id="S4.E9.m1.7.7.1.1d.cmml" xref="S4.E9.m1.7.7.1"></share><apply id="S4.E9.m1.2.2.cmml" xref="S4.E9.m1.2.2"><divide id="S4.E9.m1.2.2.3.cmml" xref="S4.E9.m1.2.2"></divide><apply id="S4.E9.m1.2.2.4.cmml" xref="S4.E9.m1.2.2.4"><times id="S4.E9.m1.2.2.4.1.cmml" xref="S4.E9.m1.2.2.4.1"></times><apply id="S4.E9.m1.2.2.4.2.cmml" xref="S4.E9.m1.2.2.4.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.4.2.1.cmml" xref="S4.E9.m1.2.2.4.2">superscript</csymbol><ci id="S4.E9.m1.2.2.4.2.2.cmml" xref="S4.E9.m1.2.2.4.2.2">𝑋</ci><ci id="S4.E9.m1.2.2.4.2.3.cmml" xref="S4.E9.m1.2.2.4.2.3">𝑇</ci></apply><ci id="S4.E9.m1.2.2.4.3.cmml" xref="S4.E9.m1.2.2.4.3">𝑌</ci></apply><apply id="S4.E9.m1.2.2.2.cmml" xref="S4.E9.m1.2.2.2"><root id="S4.E9.m1.2.2.2a.cmml" xref="S4.E9.m1.2.2.2"></root><apply id="S4.E9.m1.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2"><times id="S4.E9.m1.2.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.3"></times><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1"><times id="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.2">𝑋</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3">𝑋</ci></apply><apply id="S4.E9.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E9.m1.2.2.2.2.2.2.1"><times id="S4.E9.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S4.E9.m1.2.2.2.2.2.2.1.1.1"></times><apply id="S4.E9.m1.2.2.2.2.2.2.1.1.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.2.2.1.1.2.1.cmml" xref="S4.E9.m1.2.2.2.2.2.2.1.1.2">superscript</csymbol><ci id="S4.E9.m1.2.2.2.2.2.2.1.1.2.2.cmml" xref="S4.E9.m1.2.2.2.2.2.2.1.1.2.2">𝑌</ci><ci id="S4.E9.m1.2.2.2.2.2.2.1.1.2.3.cmml" xref="S4.E9.m1.2.2.2.2.2.2.1.1.2.3">𝑇</ci></apply><ci id="S4.E9.m1.2.2.2.2.2.2.1.1.3.cmml" xref="S4.E9.m1.2.2.2.2.2.2.1.1.3">𝑌</ci></apply></apply></apply></apply></apply><apply id="S4.E9.m1.7.7.1.1e.cmml" xref="S4.E9.m1.7.7.1"><eq id="S4.E9.m1.7.7.1.1.6.cmml" xref="S4.E9.m1.7.7.1.1.6"></eq><share href="https://arxiv.org/html/2410.07022v1#S4.E9.m1.2.2.cmml" id="S4.E9.m1.7.7.1.1f.cmml" xref="S4.E9.m1.7.7.1"></share><apply id="S4.E9.m1.4.4.cmml" xref="S4.E9.m1.4.4"><divide id="S4.E9.m1.4.4.3.cmml" xref="S4.E9.m1.4.4"></divide><apply id="S4.E9.m1.4.4.4.cmml" xref="S4.E9.m1.4.4.4"><times id="S4.E9.m1.4.4.4.1.cmml" xref="S4.E9.m1.4.4.4.1"></times><apply id="S4.E9.m1.4.4.4.2.cmml" xref="S4.E9.m1.4.4.4.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.2.1.cmml" xref="S4.E9.m1.4.4.4.2">superscript</csymbol><ci id="S4.E9.m1.4.4.4.2.2.cmml" xref="S4.E9.m1.4.4.4.2.2">𝑋</ci><ci id="S4.E9.m1.4.4.4.2.3.cmml" xref="S4.E9.m1.4.4.4.2.3">𝑇</ci></apply><ci id="S4.E9.m1.4.4.4.3.cmml" xref="S4.E9.m1.4.4.4.3">𝑌</ci></apply><apply id="S4.E9.m1.4.4.2.cmml" xref="S4.E9.m1.4.4.2"><times id="S4.E9.m1.4.4.2.3.cmml" xref="S4.E9.m1.4.4.2.3"></times><apply id="S4.E9.m1.4.4.2.4.1.cmml" xref="S4.E9.m1.4.4.2.4.2"><csymbol cd="latexml" id="S4.E9.m1.4.4.2.4.1.1.cmml" xref="S4.E9.m1.4.4.2.4.2.1">norm</csymbol><ci id="S4.E9.m1.3.3.1.1.cmml" xref="S4.E9.m1.3.3.1.1">𝑋</ci></apply><apply id="S4.E9.m1.4.4.2.5.1.cmml" xref="S4.E9.m1.4.4.2.5.2"><csymbol cd="latexml" id="S4.E9.m1.4.4.2.5.1.1.cmml" xref="S4.E9.m1.4.4.2.5.2.1">norm</csymbol><ci id="S4.E9.m1.4.4.2.2.cmml" xref="S4.E9.m1.4.4.2.2">𝑌</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.7c">\mathrm{cos}(X,Y)=\frac{\sum_{i=1}^{d}X_{i}Y_{i}}{\sqrt{\sum_{i}X_{i}^{2}}%
\sqrt{\sum_{i}Y_{i}^{2}}}=\frac{X^{T}Y}{\sqrt{(X^{T}X)(Y^{T}Y)}}=\frac{X^{T}Y}%
{\|X\|\|Y\|},</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.7d">roman_cos ( italic_X , italic_Y ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_X start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG square-root start_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_Y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_ARG = divide start_ARG italic_X start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Y end_ARG start_ARG square-root start_ARG ( italic_X start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_X ) ( italic_Y start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Y ) end_ARG end_ARG = divide start_ARG italic_X start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_Y end_ARG start_ARG ∥ italic_X ∥ ∥ italic_Y ∥ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p4.6">where subscript <math alttext="i" class="ltx_Math" display="inline" id="S4.p4.1.m1.1"><semantics id="S4.p4.1.m1.1a"><mi id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><ci id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.p4.1.m1.1d">italic_i</annotation></semantics></math> denotes the <math alttext="i" class="ltx_Math" display="inline" id="S4.p4.2.m2.1"><semantics id="S4.p4.2.m2.1a"><mi id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><ci id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.p4.2.m2.1d">italic_i</annotation></semantics></math>-th element of a vector
, and <math alttext="\|X\|" class="ltx_Math" display="inline" id="S4.p4.3.m3.1"><semantics id="S4.p4.3.m3.1a"><mrow id="S4.p4.3.m3.1.2.2" xref="S4.p4.3.m3.1.2.1.cmml"><mo id="S4.p4.3.m3.1.2.2.1" stretchy="false" xref="S4.p4.3.m3.1.2.1.1.cmml">‖</mo><mi id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml">X</mi><mo id="S4.p4.3.m3.1.2.2.2" stretchy="false" xref="S4.p4.3.m3.1.2.1.1.cmml">‖</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><apply id="S4.p4.3.m3.1.2.1.cmml" xref="S4.p4.3.m3.1.2.2"><csymbol cd="latexml" id="S4.p4.3.m3.1.2.1.1.cmml" xref="S4.p4.3.m3.1.2.2.1">norm</csymbol><ci id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">\|X\|</annotation><annotation encoding="application/x-llamapun" id="S4.p4.3.m3.1d">∥ italic_X ∥</annotation></semantics></math> and <math alttext="\|Y\|" class="ltx_Math" display="inline" id="S4.p4.4.m4.1"><semantics id="S4.p4.4.m4.1a"><mrow id="S4.p4.4.m4.1.2.2" xref="S4.p4.4.m4.1.2.1.cmml"><mo id="S4.p4.4.m4.1.2.2.1" stretchy="false" xref="S4.p4.4.m4.1.2.1.1.cmml">‖</mo><mi id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml">Y</mi><mo id="S4.p4.4.m4.1.2.2.2" stretchy="false" xref="S4.p4.4.m4.1.2.1.1.cmml">‖</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><apply id="S4.p4.4.m4.1.2.1.cmml" xref="S4.p4.4.m4.1.2.2"><csymbol cd="latexml" id="S4.p4.4.m4.1.2.1.1.cmml" xref="S4.p4.4.m4.1.2.2.1">norm</csymbol><ci id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">\|Y\|</annotation><annotation encoding="application/x-llamapun" id="S4.p4.4.m4.1d">∥ italic_Y ∥</annotation></semantics></math> denote the Euclidean norms of vectors <math alttext="X" class="ltx_Math" display="inline" id="S4.p4.5.m5.1"><semantics id="S4.p4.5.m5.1a"><mi id="S4.p4.5.m5.1.1" xref="S4.p4.5.m5.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.p4.5.m5.1b"><ci id="S4.p4.5.m5.1.1.cmml" xref="S4.p4.5.m5.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m5.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.p4.5.m5.1d">italic_X</annotation></semantics></math> and <math alttext="Y" class="ltx_Math" display="inline" id="S4.p4.6.m6.1"><semantics id="S4.p4.6.m6.1a"><mi id="S4.p4.6.m6.1.1" xref="S4.p4.6.m6.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S4.p4.6.m6.1b"><ci id="S4.p4.6.m6.1.1.cmml" xref="S4.p4.6.m6.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.m6.1c">Y</annotation><annotation encoding="application/x-llamapun" id="S4.p4.6.m6.1d">italic_Y</annotation></semantics></math> respectively.
Each term in the numerator of Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.E9" title="In 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">9</span></a> is just a product of two random variables, but the denominator makes things complicated.
A closed-form solution of a ratio of two random variables is difficult to calculate.</p>
</div>
<div class="ltx_para" id="S4.p5">
<p class="ltx_p" id="S4.p5.1">Let us introduce a relaxation that can be used to approximate the denominator and simplify the calculation. Using cosine’s scale invariance (shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS2" title="A.2 Cosine Scale Invariance ‣ Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">A.2</span></a>), we define a relaxation <math alttext="r(Z)" class="ltx_Math" display="inline" id="S4.p5.1.m1.1"><semantics id="S4.p5.1.m1.1a"><mrow id="S4.p5.1.m1.1.2" xref="S4.p5.1.m1.1.2.cmml"><mi id="S4.p5.1.m1.1.2.2" xref="S4.p5.1.m1.1.2.2.cmml">r</mi><mo id="S4.p5.1.m1.1.2.1" xref="S4.p5.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.p5.1.m1.1.2.3.2" xref="S4.p5.1.m1.1.2.cmml"><mo id="S4.p5.1.m1.1.2.3.2.1" stretchy="false" xref="S4.p5.1.m1.1.2.cmml">(</mo><mi id="S4.p5.1.m1.1.1" xref="S4.p5.1.m1.1.1.cmml">Z</mi><mo id="S4.p5.1.m1.1.2.3.2.2" stretchy="false" xref="S4.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.1b"><apply id="S4.p5.1.m1.1.2.cmml" xref="S4.p5.1.m1.1.2"><times id="S4.p5.1.m1.1.2.1.cmml" xref="S4.p5.1.m1.1.2.1"></times><ci id="S4.p5.1.m1.1.2.2.cmml" xref="S4.p5.1.m1.1.2.2">𝑟</ci><ci id="S4.p5.1.m1.1.1.cmml" xref="S4.p5.1.m1.1.1">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">r(Z)</annotation><annotation encoding="application/x-llamapun" id="S4.p5.1.m1.1d">italic_r ( italic_Z )</annotation></semantics></math> as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r(Z)=\frac{Z}{m}," class="ltx_Math" display="block" id="S4.E10.m1.2"><semantics id="S4.E10.m1.2a"><mrow id="S4.E10.m1.2.2.1" xref="S4.E10.m1.2.2.1.1.cmml"><mrow id="S4.E10.m1.2.2.1.1" xref="S4.E10.m1.2.2.1.1.cmml"><mrow id="S4.E10.m1.2.2.1.1.2" xref="S4.E10.m1.2.2.1.1.2.cmml"><mi id="S4.E10.m1.2.2.1.1.2.2" xref="S4.E10.m1.2.2.1.1.2.2.cmml">r</mi><mo id="S4.E10.m1.2.2.1.1.2.1" xref="S4.E10.m1.2.2.1.1.2.1.cmml">⁢</mo><mrow id="S4.E10.m1.2.2.1.1.2.3.2" xref="S4.E10.m1.2.2.1.1.2.cmml"><mo id="S4.E10.m1.2.2.1.1.2.3.2.1" stretchy="false" xref="S4.E10.m1.2.2.1.1.2.cmml">(</mo><mi id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml">Z</mi><mo id="S4.E10.m1.2.2.1.1.2.3.2.2" stretchy="false" xref="S4.E10.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.2.2.1.1.1" xref="S4.E10.m1.2.2.1.1.1.cmml">=</mo><mfrac id="S4.E10.m1.2.2.1.1.3" xref="S4.E10.m1.2.2.1.1.3.cmml"><mi id="S4.E10.m1.2.2.1.1.3.2" xref="S4.E10.m1.2.2.1.1.3.2.cmml">Z</mi><mi id="S4.E10.m1.2.2.1.1.3.3" xref="S4.E10.m1.2.2.1.1.3.3.cmml">m</mi></mfrac></mrow><mo id="S4.E10.m1.2.2.1.2" xref="S4.E10.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.2b"><apply id="S4.E10.m1.2.2.1.1.cmml" xref="S4.E10.m1.2.2.1"><eq id="S4.E10.m1.2.2.1.1.1.cmml" xref="S4.E10.m1.2.2.1.1.1"></eq><apply id="S4.E10.m1.2.2.1.1.2.cmml" xref="S4.E10.m1.2.2.1.1.2"><times id="S4.E10.m1.2.2.1.1.2.1.cmml" xref="S4.E10.m1.2.2.1.1.2.1"></times><ci id="S4.E10.m1.2.2.1.1.2.2.cmml" xref="S4.E10.m1.2.2.1.1.2.2">𝑟</ci><ci id="S4.E10.m1.1.1.cmml" xref="S4.E10.m1.1.1">𝑍</ci></apply><apply id="S4.E10.m1.2.2.1.1.3.cmml" xref="S4.E10.m1.2.2.1.1.3"><divide id="S4.E10.m1.2.2.1.1.3.1.cmml" xref="S4.E10.m1.2.2.1.1.3"></divide><ci id="S4.E10.m1.2.2.1.1.3.2.cmml" xref="S4.E10.m1.2.2.1.1.3.2">𝑍</ci><ci id="S4.E10.m1.2.2.1.1.3.3.cmml" xref="S4.E10.m1.2.2.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.2c">r(Z)=\frac{Z}{m},</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.2d">italic_r ( italic_Z ) = divide start_ARG italic_Z end_ARG start_ARG italic_m end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p5.6">where <math alttext="m=\sqrt{\sum_{i}\sigma_{i}^{2}}" class="ltx_Math" display="inline" id="S4.p5.2.m1.1"><semantics id="S4.p5.2.m1.1a"><mrow id="S4.p5.2.m1.1.1" xref="S4.p5.2.m1.1.1.cmml"><mi id="S4.p5.2.m1.1.1.2" xref="S4.p5.2.m1.1.1.2.cmml">m</mi><mo id="S4.p5.2.m1.1.1.1" xref="S4.p5.2.m1.1.1.1.cmml">=</mo><msqrt id="S4.p5.2.m1.1.1.3" xref="S4.p5.2.m1.1.1.3.cmml"><mrow id="S4.p5.2.m1.1.1.3.2" xref="S4.p5.2.m1.1.1.3.2.cmml"><msub id="S4.p5.2.m1.1.1.3.2.1" xref="S4.p5.2.m1.1.1.3.2.1.cmml"><mo id="S4.p5.2.m1.1.1.3.2.1.2" xref="S4.p5.2.m1.1.1.3.2.1.2.cmml">∑</mo><mi id="S4.p5.2.m1.1.1.3.2.1.3" xref="S4.p5.2.m1.1.1.3.2.1.3.cmml">i</mi></msub><msubsup id="S4.p5.2.m1.1.1.3.2.2" xref="S4.p5.2.m1.1.1.3.2.2.cmml"><mi id="S4.p5.2.m1.1.1.3.2.2.2.2" xref="S4.p5.2.m1.1.1.3.2.2.2.2.cmml">σ</mi><mi id="S4.p5.2.m1.1.1.3.2.2.2.3" xref="S4.p5.2.m1.1.1.3.2.2.2.3.cmml">i</mi><mn id="S4.p5.2.m1.1.1.3.2.2.3" xref="S4.p5.2.m1.1.1.3.2.2.3.cmml">2</mn></msubsup></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.2.m1.1b"><apply id="S4.p5.2.m1.1.1.cmml" xref="S4.p5.2.m1.1.1"><eq id="S4.p5.2.m1.1.1.1.cmml" xref="S4.p5.2.m1.1.1.1"></eq><ci id="S4.p5.2.m1.1.1.2.cmml" xref="S4.p5.2.m1.1.1.2">𝑚</ci><apply id="S4.p5.2.m1.1.1.3.cmml" xref="S4.p5.2.m1.1.1.3"><root id="S4.p5.2.m1.1.1.3a.cmml" xref="S4.p5.2.m1.1.1.3"></root><apply id="S4.p5.2.m1.1.1.3.2.cmml" xref="S4.p5.2.m1.1.1.3.2"><apply id="S4.p5.2.m1.1.1.3.2.1.cmml" xref="S4.p5.2.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.p5.2.m1.1.1.3.2.1.1.cmml" xref="S4.p5.2.m1.1.1.3.2.1">subscript</csymbol><sum id="S4.p5.2.m1.1.1.3.2.1.2.cmml" xref="S4.p5.2.m1.1.1.3.2.1.2"></sum><ci id="S4.p5.2.m1.1.1.3.2.1.3.cmml" xref="S4.p5.2.m1.1.1.3.2.1.3">𝑖</ci></apply><apply id="S4.p5.2.m1.1.1.3.2.2.cmml" xref="S4.p5.2.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.p5.2.m1.1.1.3.2.2.1.cmml" xref="S4.p5.2.m1.1.1.3.2.2">superscript</csymbol><apply id="S4.p5.2.m1.1.1.3.2.2.2.cmml" xref="S4.p5.2.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.p5.2.m1.1.1.3.2.2.2.1.cmml" xref="S4.p5.2.m1.1.1.3.2.2">subscript</csymbol><ci id="S4.p5.2.m1.1.1.3.2.2.2.2.cmml" xref="S4.p5.2.m1.1.1.3.2.2.2.2">𝜎</ci><ci id="S4.p5.2.m1.1.1.3.2.2.2.3.cmml" xref="S4.p5.2.m1.1.1.3.2.2.2.3">𝑖</ci></apply><cn id="S4.p5.2.m1.1.1.3.2.2.3.cmml" type="integer" xref="S4.p5.2.m1.1.1.3.2.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.2.m1.1c">m=\sqrt{\sum_{i}\sigma_{i}^{2}}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.2.m1.1d">italic_m = square-root start_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math>.
Relaxation <math alttext="r" class="ltx_Math" display="inline" id="S4.p5.3.m2.1"><semantics id="S4.p5.3.m2.1a"><mi id="S4.p5.3.m2.1.1" xref="S4.p5.3.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.p5.3.m2.1b"><ci id="S4.p5.3.m2.1.1.cmml" xref="S4.p5.3.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.3.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.p5.3.m2.1d">italic_r</annotation></semantics></math> has two properties. First, the expected value of the squared norm after relaxation, denoted as <math alttext="\mathbb{E}[||r(Z)||^{2}]" class="ltx_Math" display="inline" id="S4.p5.4.m3.2"><semantics id="S4.p5.4.m3.2a"><mrow id="S4.p5.4.m3.2.2" xref="S4.p5.4.m3.2.2.cmml"><mi id="S4.p5.4.m3.2.2.3" xref="S4.p5.4.m3.2.2.3.cmml">𝔼</mi><mo id="S4.p5.4.m3.2.2.2" xref="S4.p5.4.m3.2.2.2.cmml">⁢</mo><mrow id="S4.p5.4.m3.2.2.1.1" xref="S4.p5.4.m3.2.2.1.2.cmml"><mo id="S4.p5.4.m3.2.2.1.1.2" stretchy="false" xref="S4.p5.4.m3.2.2.1.2.1.cmml">[</mo><msup id="S4.p5.4.m3.2.2.1.1.1" xref="S4.p5.4.m3.2.2.1.1.1.cmml"><mrow id="S4.p5.4.m3.2.2.1.1.1.1.1" xref="S4.p5.4.m3.2.2.1.1.1.1.2.cmml"><mo id="S4.p5.4.m3.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.p5.4.m3.2.2.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.p5.4.m3.2.2.1.1.1.1.1.1" xref="S4.p5.4.m3.2.2.1.1.1.1.1.1.cmml"><mi id="S4.p5.4.m3.2.2.1.1.1.1.1.1.2" xref="S4.p5.4.m3.2.2.1.1.1.1.1.1.2.cmml">r</mi><mo id="S4.p5.4.m3.2.2.1.1.1.1.1.1.1" xref="S4.p5.4.m3.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.p5.4.m3.2.2.1.1.1.1.1.1.3.2" xref="S4.p5.4.m3.2.2.1.1.1.1.1.1.cmml"><mo id="S4.p5.4.m3.2.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.p5.4.m3.2.2.1.1.1.1.1.1.cmml">(</mo><mi id="S4.p5.4.m3.1.1" xref="S4.p5.4.m3.1.1.cmml">Z</mi><mo id="S4.p5.4.m3.2.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.p5.4.m3.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p5.4.m3.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.p5.4.m3.2.2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.p5.4.m3.2.2.1.1.1.3" xref="S4.p5.4.m3.2.2.1.1.1.3.cmml">2</mn></msup><mo id="S4.p5.4.m3.2.2.1.1.3" stretchy="false" xref="S4.p5.4.m3.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.4.m3.2b"><apply id="S4.p5.4.m3.2.2.cmml" xref="S4.p5.4.m3.2.2"><times id="S4.p5.4.m3.2.2.2.cmml" xref="S4.p5.4.m3.2.2.2"></times><ci id="S4.p5.4.m3.2.2.3.cmml" xref="S4.p5.4.m3.2.2.3">𝔼</ci><apply id="S4.p5.4.m3.2.2.1.2.cmml" xref="S4.p5.4.m3.2.2.1.1"><csymbol cd="latexml" id="S4.p5.4.m3.2.2.1.2.1.cmml" xref="S4.p5.4.m3.2.2.1.1.2">delimited-[]</csymbol><apply id="S4.p5.4.m3.2.2.1.1.1.cmml" xref="S4.p5.4.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p5.4.m3.2.2.1.1.1.2.cmml" xref="S4.p5.4.m3.2.2.1.1.1">superscript</csymbol><apply id="S4.p5.4.m3.2.2.1.1.1.1.2.cmml" xref="S4.p5.4.m3.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.p5.4.m3.2.2.1.1.1.1.2.1.cmml" xref="S4.p5.4.m3.2.2.1.1.1.1.1.2">norm</csymbol><apply id="S4.p5.4.m3.2.2.1.1.1.1.1.1.cmml" xref="S4.p5.4.m3.2.2.1.1.1.1.1.1"><times id="S4.p5.4.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S4.p5.4.m3.2.2.1.1.1.1.1.1.1"></times><ci id="S4.p5.4.m3.2.2.1.1.1.1.1.1.2.cmml" xref="S4.p5.4.m3.2.2.1.1.1.1.1.1.2">𝑟</ci><ci id="S4.p5.4.m3.1.1.cmml" xref="S4.p5.4.m3.1.1">𝑍</ci></apply></apply><cn id="S4.p5.4.m3.2.2.1.1.1.3.cmml" type="integer" xref="S4.p5.4.m3.2.2.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.4.m3.2c">\mathbb{E}[||r(Z)||^{2}]</annotation><annotation encoding="application/x-llamapun" id="S4.p5.4.m3.2d">blackboard_E [ | | italic_r ( italic_Z ) | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math>, is equal to 1. Second, the ratio of variance to square of the mean is given by <math alttext="\frac{\sum_{k}2\sigma_{k}^{2}}{(\sum_{k}\sigma_{k}^{2})^{2}}" class="ltx_Math" display="inline" id="S4.p5.5.m4.1"><semantics id="S4.p5.5.m4.1a"><mfrac id="S4.p5.5.m4.1.1" xref="S4.p5.5.m4.1.1.cmml"><mrow id="S4.p5.5.m4.1.1.3" xref="S4.p5.5.m4.1.1.3.cmml"><mstyle displaystyle="false" id="S4.p5.5.m4.1.1.3.1" xref="S4.p5.5.m4.1.1.3.1.cmml"><msub id="S4.p5.5.m4.1.1.3.1a" xref="S4.p5.5.m4.1.1.3.1.cmml"><mo id="S4.p5.5.m4.1.1.3.1.2" xref="S4.p5.5.m4.1.1.3.1.2.cmml">∑</mo><mi id="S4.p5.5.m4.1.1.3.1.3" xref="S4.p5.5.m4.1.1.3.1.3.cmml">k</mi></msub></mstyle><mrow id="S4.p5.5.m4.1.1.3.2" xref="S4.p5.5.m4.1.1.3.2.cmml"><mn id="S4.p5.5.m4.1.1.3.2.2" xref="S4.p5.5.m4.1.1.3.2.2.cmml">2</mn><mo id="S4.p5.5.m4.1.1.3.2.1" xref="S4.p5.5.m4.1.1.3.2.1.cmml">⁢</mo><msubsup id="S4.p5.5.m4.1.1.3.2.3" xref="S4.p5.5.m4.1.1.3.2.3.cmml"><mi id="S4.p5.5.m4.1.1.3.2.3.2.2" xref="S4.p5.5.m4.1.1.3.2.3.2.2.cmml">σ</mi><mi id="S4.p5.5.m4.1.1.3.2.3.2.3" xref="S4.p5.5.m4.1.1.3.2.3.2.3.cmml">k</mi><mn id="S4.p5.5.m4.1.1.3.2.3.3" xref="S4.p5.5.m4.1.1.3.2.3.3.cmml">2</mn></msubsup></mrow></mrow><msup id="S4.p5.5.m4.1.1.1" xref="S4.p5.5.m4.1.1.1.cmml"><mrow id="S4.p5.5.m4.1.1.1.1.1" xref="S4.p5.5.m4.1.1.1.1.1.1.cmml"><mo id="S4.p5.5.m4.1.1.1.1.1.2" stretchy="false" xref="S4.p5.5.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p5.5.m4.1.1.1.1.1.1" xref="S4.p5.5.m4.1.1.1.1.1.1.cmml"><mstyle displaystyle="false" id="S4.p5.5.m4.1.1.1.1.1.1.1" xref="S4.p5.5.m4.1.1.1.1.1.1.1.cmml"><msub id="S4.p5.5.m4.1.1.1.1.1.1.1a" xref="S4.p5.5.m4.1.1.1.1.1.1.1.cmml"><mo id="S4.p5.5.m4.1.1.1.1.1.1.1.2" xref="S4.p5.5.m4.1.1.1.1.1.1.1.2.cmml">∑</mo><mi id="S4.p5.5.m4.1.1.1.1.1.1.1.3" xref="S4.p5.5.m4.1.1.1.1.1.1.1.3.cmml">k</mi></msub></mstyle><msubsup id="S4.p5.5.m4.1.1.1.1.1.1.2" xref="S4.p5.5.m4.1.1.1.1.1.1.2.cmml"><mi id="S4.p5.5.m4.1.1.1.1.1.1.2.2.2" xref="S4.p5.5.m4.1.1.1.1.1.1.2.2.2.cmml">σ</mi><mi id="S4.p5.5.m4.1.1.1.1.1.1.2.2.3" xref="S4.p5.5.m4.1.1.1.1.1.1.2.2.3.cmml">k</mi><mn id="S4.p5.5.m4.1.1.1.1.1.1.2.3" xref="S4.p5.5.m4.1.1.1.1.1.1.2.3.cmml">2</mn></msubsup></mrow><mo id="S4.p5.5.m4.1.1.1.1.1.3" stretchy="false" xref="S4.p5.5.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.p5.5.m4.1.1.1.3" xref="S4.p5.5.m4.1.1.1.3.cmml">2</mn></msup></mfrac><annotation-xml encoding="MathML-Content" id="S4.p5.5.m4.1b"><apply id="S4.p5.5.m4.1.1.cmml" xref="S4.p5.5.m4.1.1"><divide id="S4.p5.5.m4.1.1.2.cmml" xref="S4.p5.5.m4.1.1"></divide><apply id="S4.p5.5.m4.1.1.3.cmml" xref="S4.p5.5.m4.1.1.3"><apply id="S4.p5.5.m4.1.1.3.1.cmml" xref="S4.p5.5.m4.1.1.3.1"><csymbol cd="ambiguous" id="S4.p5.5.m4.1.1.3.1.1.cmml" xref="S4.p5.5.m4.1.1.3.1">subscript</csymbol><sum id="S4.p5.5.m4.1.1.3.1.2.cmml" xref="S4.p5.5.m4.1.1.3.1.2"></sum><ci id="S4.p5.5.m4.1.1.3.1.3.cmml" xref="S4.p5.5.m4.1.1.3.1.3">𝑘</ci></apply><apply id="S4.p5.5.m4.1.1.3.2.cmml" xref="S4.p5.5.m4.1.1.3.2"><times id="S4.p5.5.m4.1.1.3.2.1.cmml" xref="S4.p5.5.m4.1.1.3.2.1"></times><cn id="S4.p5.5.m4.1.1.3.2.2.cmml" type="integer" xref="S4.p5.5.m4.1.1.3.2.2">2</cn><apply id="S4.p5.5.m4.1.1.3.2.3.cmml" xref="S4.p5.5.m4.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.p5.5.m4.1.1.3.2.3.1.cmml" xref="S4.p5.5.m4.1.1.3.2.3">superscript</csymbol><apply id="S4.p5.5.m4.1.1.3.2.3.2.cmml" xref="S4.p5.5.m4.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.p5.5.m4.1.1.3.2.3.2.1.cmml" xref="S4.p5.5.m4.1.1.3.2.3">subscript</csymbol><ci id="S4.p5.5.m4.1.1.3.2.3.2.2.cmml" xref="S4.p5.5.m4.1.1.3.2.3.2.2">𝜎</ci><ci id="S4.p5.5.m4.1.1.3.2.3.2.3.cmml" xref="S4.p5.5.m4.1.1.3.2.3.2.3">𝑘</ci></apply><cn id="S4.p5.5.m4.1.1.3.2.3.3.cmml" type="integer" xref="S4.p5.5.m4.1.1.3.2.3.3">2</cn></apply></apply></apply><apply id="S4.p5.5.m4.1.1.1.cmml" xref="S4.p5.5.m4.1.1.1"><csymbol cd="ambiguous" id="S4.p5.5.m4.1.1.1.2.cmml" xref="S4.p5.5.m4.1.1.1">superscript</csymbol><apply id="S4.p5.5.m4.1.1.1.1.1.1.cmml" xref="S4.p5.5.m4.1.1.1.1.1"><apply id="S4.p5.5.m4.1.1.1.1.1.1.1.cmml" xref="S4.p5.5.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p5.5.m4.1.1.1.1.1.1.1.1.cmml" xref="S4.p5.5.m4.1.1.1.1.1.1.1">subscript</csymbol><sum id="S4.p5.5.m4.1.1.1.1.1.1.1.2.cmml" xref="S4.p5.5.m4.1.1.1.1.1.1.1.2"></sum><ci id="S4.p5.5.m4.1.1.1.1.1.1.1.3.cmml" xref="S4.p5.5.m4.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.p5.5.m4.1.1.1.1.1.1.2.cmml" xref="S4.p5.5.m4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p5.5.m4.1.1.1.1.1.1.2.1.cmml" xref="S4.p5.5.m4.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.p5.5.m4.1.1.1.1.1.1.2.2.cmml" xref="S4.p5.5.m4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p5.5.m4.1.1.1.1.1.1.2.2.1.cmml" xref="S4.p5.5.m4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.p5.5.m4.1.1.1.1.1.1.2.2.2.cmml" xref="S4.p5.5.m4.1.1.1.1.1.1.2.2.2">𝜎</ci><ci id="S4.p5.5.m4.1.1.1.1.1.1.2.2.3.cmml" xref="S4.p5.5.m4.1.1.1.1.1.1.2.2.3">𝑘</ci></apply><cn id="S4.p5.5.m4.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.p5.5.m4.1.1.1.1.1.1.2.3">2</cn></apply></apply><cn id="S4.p5.5.m4.1.1.1.3.cmml" type="integer" xref="S4.p5.5.m4.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.5.m4.1c">\frac{\sum_{k}2\sigma_{k}^{2}}{(\sum_{k}\sigma_{k}^{2})^{2}}</annotation><annotation encoding="application/x-llamapun" id="S4.p5.5.m4.1d">divide start_ARG ∑ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT 2 italic_σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG ( ∑ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math>, and it approaches 0 as the dimensionality <math alttext="d" class="ltx_Math" display="inline" id="S4.p5.6.m5.1"><semantics id="S4.p5.6.m5.1a"><mi id="S4.p5.6.m5.1.1" xref="S4.p5.6.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.p5.6.m5.1b"><ci id="S4.p5.6.m5.1.1.cmml" xref="S4.p5.6.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.6.m5.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.p5.6.m5.1d">italic_d</annotation></semantics></math> tends to infinity. Under the condition that the contribution of any single covariance eigenvalue is sufficiently small. <cite class="ltx_cite ltx_citemacro_citet">Smith et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib29" title="">2023</a>)</cite> show that these properties can then be used to approximate the cosine similarity as:</p>
</div>
<div class="ltx_para" id="S4.p6">
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{cos}(X,Y)=\mathrm{cos}(r(X),r(Y))=\frac{\sum_{i=1}^{d}r(X)_{i}r(Y)_{i}%
}{\|r(X)\|\|r(Y)\|}\approx\sum_{i=1}^{d}r(X)_{i}r(Y)_{i}." class="ltx_Math" display="block" id="S4.E11.m1.13"><semantics id="S4.E11.m1.13a"><mrow id="S4.E11.m1.13.13.1" xref="S4.E11.m1.13.13.1.1.cmml"><mrow id="S4.E11.m1.13.13.1.1" xref="S4.E11.m1.13.13.1.1.cmml"><mrow id="S4.E11.m1.13.13.1.1.4" xref="S4.E11.m1.13.13.1.1.4.cmml"><mi id="S4.E11.m1.13.13.1.1.4.2" xref="S4.E11.m1.13.13.1.1.4.2.cmml">cos</mi><mo id="S4.E11.m1.13.13.1.1.4.1" xref="S4.E11.m1.13.13.1.1.4.1.cmml">⁢</mo><mrow id="S4.E11.m1.13.13.1.1.4.3.2" xref="S4.E11.m1.13.13.1.1.4.3.1.cmml"><mo id="S4.E11.m1.13.13.1.1.4.3.2.1" stretchy="false" xref="S4.E11.m1.13.13.1.1.4.3.1.cmml">(</mo><mi id="S4.E11.m1.7.7" xref="S4.E11.m1.7.7.cmml">X</mi><mo id="S4.E11.m1.13.13.1.1.4.3.2.2" xref="S4.E11.m1.13.13.1.1.4.3.1.cmml">,</mo><mi id="S4.E11.m1.8.8" xref="S4.E11.m1.8.8.cmml">Y</mi><mo id="S4.E11.m1.13.13.1.1.4.3.2.3" stretchy="false" xref="S4.E11.m1.13.13.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.13.13.1.1.5" xref="S4.E11.m1.13.13.1.1.5.cmml">=</mo><mrow id="S4.E11.m1.13.13.1.1.2" xref="S4.E11.m1.13.13.1.1.2.cmml"><mi id="S4.E11.m1.13.13.1.1.2.4" xref="S4.E11.m1.13.13.1.1.2.4.cmml">cos</mi><mo id="S4.E11.m1.13.13.1.1.2.3" xref="S4.E11.m1.13.13.1.1.2.3.cmml">⁢</mo><mrow id="S4.E11.m1.13.13.1.1.2.2.2" xref="S4.E11.m1.13.13.1.1.2.2.3.cmml"><mo id="S4.E11.m1.13.13.1.1.2.2.2.3" stretchy="false" xref="S4.E11.m1.13.13.1.1.2.2.3.cmml">(</mo><mrow id="S4.E11.m1.13.13.1.1.1.1.1.1" xref="S4.E11.m1.13.13.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.13.13.1.1.1.1.1.1.2" xref="S4.E11.m1.13.13.1.1.1.1.1.1.2.cmml">r</mi><mo id="S4.E11.m1.13.13.1.1.1.1.1.1.1" xref="S4.E11.m1.13.13.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E11.m1.13.13.1.1.1.1.1.1.3.2" xref="S4.E11.m1.13.13.1.1.1.1.1.1.cmml"><mo id="S4.E11.m1.13.13.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E11.m1.13.13.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E11.m1.9.9" xref="S4.E11.m1.9.9.cmml">X</mi><mo id="S4.E11.m1.13.13.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E11.m1.13.13.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.13.13.1.1.2.2.2.4" xref="S4.E11.m1.13.13.1.1.2.2.3.cmml">,</mo><mrow id="S4.E11.m1.13.13.1.1.2.2.2.2" xref="S4.E11.m1.13.13.1.1.2.2.2.2.cmml"><mi id="S4.E11.m1.13.13.1.1.2.2.2.2.2" xref="S4.E11.m1.13.13.1.1.2.2.2.2.2.cmml">r</mi><mo id="S4.E11.m1.13.13.1.1.2.2.2.2.1" xref="S4.E11.m1.13.13.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="S4.E11.m1.13.13.1.1.2.2.2.2.3.2" xref="S4.E11.m1.13.13.1.1.2.2.2.2.cmml"><mo id="S4.E11.m1.13.13.1.1.2.2.2.2.3.2.1" stretchy="false" xref="S4.E11.m1.13.13.1.1.2.2.2.2.cmml">(</mo><mi id="S4.E11.m1.10.10" xref="S4.E11.m1.10.10.cmml">Y</mi><mo id="S4.E11.m1.13.13.1.1.2.2.2.2.3.2.2" stretchy="false" xref="S4.E11.m1.13.13.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.13.13.1.1.2.2.2.5" stretchy="false" xref="S4.E11.m1.13.13.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.13.13.1.1.6" xref="S4.E11.m1.13.13.1.1.6.cmml">=</mo><mfrac id="S4.E11.m1.6.6" xref="S4.E11.m1.6.6.cmml"><mrow id="S4.E11.m1.2.2.2" xref="S4.E11.m1.2.2.2.cmml"><msubsup id="S4.E11.m1.2.2.2.3" xref="S4.E11.m1.2.2.2.3.cmml"><mo id="S4.E11.m1.2.2.2.3.2.2" xref="S4.E11.m1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E11.m1.2.2.2.3.2.3" xref="S4.E11.m1.2.2.2.3.2.3.cmml"><mi id="S4.E11.m1.2.2.2.3.2.3.2" xref="S4.E11.m1.2.2.2.3.2.3.2.cmml">i</mi><mo id="S4.E11.m1.2.2.2.3.2.3.1" xref="S4.E11.m1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E11.m1.2.2.2.3.2.3.3" xref="S4.E11.m1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E11.m1.2.2.2.3.3" xref="S4.E11.m1.2.2.2.3.3.cmml">d</mi></msubsup><mrow id="S4.E11.m1.2.2.2.4" xref="S4.E11.m1.2.2.2.4.cmml"><mi id="S4.E11.m1.2.2.2.4.2" xref="S4.E11.m1.2.2.2.4.2.cmml">r</mi><mo id="S4.E11.m1.2.2.2.4.1" xref="S4.E11.m1.2.2.2.4.1.cmml">⁢</mo><msub id="S4.E11.m1.2.2.2.4.3" xref="S4.E11.m1.2.2.2.4.3.cmml"><mrow id="S4.E11.m1.2.2.2.4.3.2.2" xref="S4.E11.m1.2.2.2.4.3.cmml"><mo id="S4.E11.m1.2.2.2.4.3.2.2.1" stretchy="false" xref="S4.E11.m1.2.2.2.4.3.cmml">(</mo><mi id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml">X</mi><mo id="S4.E11.m1.2.2.2.4.3.2.2.2" stretchy="false" xref="S4.E11.m1.2.2.2.4.3.cmml">)</mo></mrow><mi id="S4.E11.m1.2.2.2.4.3.3" xref="S4.E11.m1.2.2.2.4.3.3.cmml">i</mi></msub><mo id="S4.E11.m1.2.2.2.4.1a" xref="S4.E11.m1.2.2.2.4.1.cmml">⁢</mo><mi id="S4.E11.m1.2.2.2.4.4" xref="S4.E11.m1.2.2.2.4.4.cmml">r</mi><mo id="S4.E11.m1.2.2.2.4.1b" xref="S4.E11.m1.2.2.2.4.1.cmml">⁢</mo><msub id="S4.E11.m1.2.2.2.4.5" xref="S4.E11.m1.2.2.2.4.5.cmml"><mrow id="S4.E11.m1.2.2.2.4.5.2.2" xref="S4.E11.m1.2.2.2.4.5.cmml"><mo id="S4.E11.m1.2.2.2.4.5.2.2.1" stretchy="false" xref="S4.E11.m1.2.2.2.4.5.cmml">(</mo><mi id="S4.E11.m1.2.2.2.2" xref="S4.E11.m1.2.2.2.2.cmml">Y</mi><mo id="S4.E11.m1.2.2.2.4.5.2.2.2" stretchy="false" xref="S4.E11.m1.2.2.2.4.5.cmml">)</mo></mrow><mi id="S4.E11.m1.2.2.2.4.5.3" xref="S4.E11.m1.2.2.2.4.5.3.cmml">i</mi></msub></mrow></mrow><mrow id="S4.E11.m1.6.6.6" xref="S4.E11.m1.6.6.6.cmml"><mrow id="S4.E11.m1.5.5.5.3.1" xref="S4.E11.m1.5.5.5.3.2.cmml"><mo id="S4.E11.m1.5.5.5.3.1.2" stretchy="false" xref="S4.E11.m1.5.5.5.3.2.1.cmml">‖</mo><mrow id="S4.E11.m1.5.5.5.3.1.1" xref="S4.E11.m1.5.5.5.3.1.1.cmml"><mi id="S4.E11.m1.5.5.5.3.1.1.2" xref="S4.E11.m1.5.5.5.3.1.1.2.cmml">r</mi><mo id="S4.E11.m1.5.5.5.3.1.1.1" xref="S4.E11.m1.5.5.5.3.1.1.1.cmml">⁢</mo><mrow id="S4.E11.m1.5.5.5.3.1.1.3.2" xref="S4.E11.m1.5.5.5.3.1.1.cmml"><mo id="S4.E11.m1.5.5.5.3.1.1.3.2.1" stretchy="false" xref="S4.E11.m1.5.5.5.3.1.1.cmml">(</mo><mi id="S4.E11.m1.3.3.3.1" xref="S4.E11.m1.3.3.3.1.cmml">X</mi><mo id="S4.E11.m1.5.5.5.3.1.1.3.2.2" stretchy="false" xref="S4.E11.m1.5.5.5.3.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.5.5.5.3.1.3" stretchy="false" xref="S4.E11.m1.5.5.5.3.2.1.cmml">‖</mo></mrow><mo id="S4.E11.m1.6.6.6.5" xref="S4.E11.m1.6.6.6.5.cmml">⁢</mo><mrow id="S4.E11.m1.6.6.6.4.1" xref="S4.E11.m1.6.6.6.4.2.cmml"><mo id="S4.E11.m1.6.6.6.4.1.2" stretchy="false" xref="S4.E11.m1.6.6.6.4.2.1.cmml">‖</mo><mrow id="S4.E11.m1.6.6.6.4.1.1" xref="S4.E11.m1.6.6.6.4.1.1.cmml"><mi id="S4.E11.m1.6.6.6.4.1.1.2" xref="S4.E11.m1.6.6.6.4.1.1.2.cmml">r</mi><mo id="S4.E11.m1.6.6.6.4.1.1.1" xref="S4.E11.m1.6.6.6.4.1.1.1.cmml">⁢</mo><mrow id="S4.E11.m1.6.6.6.4.1.1.3.2" xref="S4.E11.m1.6.6.6.4.1.1.cmml"><mo id="S4.E11.m1.6.6.6.4.1.1.3.2.1" stretchy="false" xref="S4.E11.m1.6.6.6.4.1.1.cmml">(</mo><mi id="S4.E11.m1.4.4.4.2" xref="S4.E11.m1.4.4.4.2.cmml">Y</mi><mo id="S4.E11.m1.6.6.6.4.1.1.3.2.2" stretchy="false" xref="S4.E11.m1.6.6.6.4.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.6.6.6.4.1.3" stretchy="false" xref="S4.E11.m1.6.6.6.4.2.1.cmml">‖</mo></mrow></mrow></mfrac><mo id="S4.E11.m1.13.13.1.1.7" rspace="0.111em" xref="S4.E11.m1.13.13.1.1.7.cmml">≈</mo><mrow id="S4.E11.m1.13.13.1.1.8" xref="S4.E11.m1.13.13.1.1.8.cmml"><munderover id="S4.E11.m1.13.13.1.1.8.1" xref="S4.E11.m1.13.13.1.1.8.1.cmml"><mo id="S4.E11.m1.13.13.1.1.8.1.2.2" movablelimits="false" xref="S4.E11.m1.13.13.1.1.8.1.2.2.cmml">∑</mo><mrow id="S4.E11.m1.13.13.1.1.8.1.2.3" xref="S4.E11.m1.13.13.1.1.8.1.2.3.cmml"><mi id="S4.E11.m1.13.13.1.1.8.1.2.3.2" xref="S4.E11.m1.13.13.1.1.8.1.2.3.2.cmml">i</mi><mo id="S4.E11.m1.13.13.1.1.8.1.2.3.1" xref="S4.E11.m1.13.13.1.1.8.1.2.3.1.cmml">=</mo><mn id="S4.E11.m1.13.13.1.1.8.1.2.3.3" xref="S4.E11.m1.13.13.1.1.8.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E11.m1.13.13.1.1.8.1.3" xref="S4.E11.m1.13.13.1.1.8.1.3.cmml">d</mi></munderover><mrow id="S4.E11.m1.13.13.1.1.8.2" xref="S4.E11.m1.13.13.1.1.8.2.cmml"><mi id="S4.E11.m1.13.13.1.1.8.2.2" xref="S4.E11.m1.13.13.1.1.8.2.2.cmml">r</mi><mo id="S4.E11.m1.13.13.1.1.8.2.1" xref="S4.E11.m1.13.13.1.1.8.2.1.cmml">⁢</mo><msub id="S4.E11.m1.13.13.1.1.8.2.3" xref="S4.E11.m1.13.13.1.1.8.2.3.cmml"><mrow id="S4.E11.m1.13.13.1.1.8.2.3.2.2" xref="S4.E11.m1.13.13.1.1.8.2.3.cmml"><mo id="S4.E11.m1.13.13.1.1.8.2.3.2.2.1" stretchy="false" xref="S4.E11.m1.13.13.1.1.8.2.3.cmml">(</mo><mi id="S4.E11.m1.11.11" xref="S4.E11.m1.11.11.cmml">X</mi><mo id="S4.E11.m1.13.13.1.1.8.2.3.2.2.2" stretchy="false" xref="S4.E11.m1.13.13.1.1.8.2.3.cmml">)</mo></mrow><mi id="S4.E11.m1.13.13.1.1.8.2.3.3" xref="S4.E11.m1.13.13.1.1.8.2.3.3.cmml">i</mi></msub><mo id="S4.E11.m1.13.13.1.1.8.2.1a" xref="S4.E11.m1.13.13.1.1.8.2.1.cmml">⁢</mo><mi id="S4.E11.m1.13.13.1.1.8.2.4" xref="S4.E11.m1.13.13.1.1.8.2.4.cmml">r</mi><mo id="S4.E11.m1.13.13.1.1.8.2.1b" xref="S4.E11.m1.13.13.1.1.8.2.1.cmml">⁢</mo><msub id="S4.E11.m1.13.13.1.1.8.2.5" xref="S4.E11.m1.13.13.1.1.8.2.5.cmml"><mrow id="S4.E11.m1.13.13.1.1.8.2.5.2.2" xref="S4.E11.m1.13.13.1.1.8.2.5.cmml"><mo id="S4.E11.m1.13.13.1.1.8.2.5.2.2.1" stretchy="false" xref="S4.E11.m1.13.13.1.1.8.2.5.cmml">(</mo><mi id="S4.E11.m1.12.12" xref="S4.E11.m1.12.12.cmml">Y</mi><mo id="S4.E11.m1.13.13.1.1.8.2.5.2.2.2" stretchy="false" xref="S4.E11.m1.13.13.1.1.8.2.5.cmml">)</mo></mrow><mi id="S4.E11.m1.13.13.1.1.8.2.5.3" xref="S4.E11.m1.13.13.1.1.8.2.5.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S4.E11.m1.13.13.1.2" lspace="0em" xref="S4.E11.m1.13.13.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.13b"><apply id="S4.E11.m1.13.13.1.1.cmml" xref="S4.E11.m1.13.13.1"><and id="S4.E11.m1.13.13.1.1a.cmml" xref="S4.E11.m1.13.13.1"></and><apply id="S4.E11.m1.13.13.1.1b.cmml" xref="S4.E11.m1.13.13.1"><eq id="S4.E11.m1.13.13.1.1.5.cmml" xref="S4.E11.m1.13.13.1.1.5"></eq><apply id="S4.E11.m1.13.13.1.1.4.cmml" xref="S4.E11.m1.13.13.1.1.4"><times id="S4.E11.m1.13.13.1.1.4.1.cmml" xref="S4.E11.m1.13.13.1.1.4.1"></times><ci id="S4.E11.m1.13.13.1.1.4.2.cmml" xref="S4.E11.m1.13.13.1.1.4.2">cos</ci><interval closure="open" id="S4.E11.m1.13.13.1.1.4.3.1.cmml" xref="S4.E11.m1.13.13.1.1.4.3.2"><ci id="S4.E11.m1.7.7.cmml" xref="S4.E11.m1.7.7">𝑋</ci><ci id="S4.E11.m1.8.8.cmml" xref="S4.E11.m1.8.8">𝑌</ci></interval></apply><apply id="S4.E11.m1.13.13.1.1.2.cmml" xref="S4.E11.m1.13.13.1.1.2"><times id="S4.E11.m1.13.13.1.1.2.3.cmml" xref="S4.E11.m1.13.13.1.1.2.3"></times><ci id="S4.E11.m1.13.13.1.1.2.4.cmml" xref="S4.E11.m1.13.13.1.1.2.4">cos</ci><interval closure="open" id="S4.E11.m1.13.13.1.1.2.2.3.cmml" xref="S4.E11.m1.13.13.1.1.2.2.2"><apply id="S4.E11.m1.13.13.1.1.1.1.1.1.cmml" xref="S4.E11.m1.13.13.1.1.1.1.1.1"><times id="S4.E11.m1.13.13.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.13.13.1.1.1.1.1.1.1"></times><ci id="S4.E11.m1.13.13.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.13.13.1.1.1.1.1.1.2">𝑟</ci><ci id="S4.E11.m1.9.9.cmml" xref="S4.E11.m1.9.9">𝑋</ci></apply><apply id="S4.E11.m1.13.13.1.1.2.2.2.2.cmml" xref="S4.E11.m1.13.13.1.1.2.2.2.2"><times id="S4.E11.m1.13.13.1.1.2.2.2.2.1.cmml" xref="S4.E11.m1.13.13.1.1.2.2.2.2.1"></times><ci id="S4.E11.m1.13.13.1.1.2.2.2.2.2.cmml" xref="S4.E11.m1.13.13.1.1.2.2.2.2.2">𝑟</ci><ci id="S4.E11.m1.10.10.cmml" xref="S4.E11.m1.10.10">𝑌</ci></apply></interval></apply></apply><apply id="S4.E11.m1.13.13.1.1c.cmml" xref="S4.E11.m1.13.13.1"><eq id="S4.E11.m1.13.13.1.1.6.cmml" xref="S4.E11.m1.13.13.1.1.6"></eq><share href="https://arxiv.org/html/2410.07022v1#S4.E11.m1.13.13.1.1.2.cmml" id="S4.E11.m1.13.13.1.1d.cmml" xref="S4.E11.m1.13.13.1"></share><apply id="S4.E11.m1.6.6.cmml" xref="S4.E11.m1.6.6"><divide id="S4.E11.m1.6.6.7.cmml" xref="S4.E11.m1.6.6"></divide><apply id="S4.E11.m1.2.2.2.cmml" xref="S4.E11.m1.2.2.2"><apply id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.3.1.cmml" xref="S4.E11.m1.2.2.2.3">superscript</csymbol><apply id="S4.E11.m1.2.2.2.3.2.cmml" xref="S4.E11.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.3.2.1.cmml" xref="S4.E11.m1.2.2.2.3">subscript</csymbol><sum id="S4.E11.m1.2.2.2.3.2.2.cmml" xref="S4.E11.m1.2.2.2.3.2.2"></sum><apply id="S4.E11.m1.2.2.2.3.2.3.cmml" xref="S4.E11.m1.2.2.2.3.2.3"><eq id="S4.E11.m1.2.2.2.3.2.3.1.cmml" xref="S4.E11.m1.2.2.2.3.2.3.1"></eq><ci id="S4.E11.m1.2.2.2.3.2.3.2.cmml" xref="S4.E11.m1.2.2.2.3.2.3.2">𝑖</ci><cn id="S4.E11.m1.2.2.2.3.2.3.3.cmml" type="integer" xref="S4.E11.m1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E11.m1.2.2.2.3.3.cmml" xref="S4.E11.m1.2.2.2.3.3">𝑑</ci></apply><apply id="S4.E11.m1.2.2.2.4.cmml" xref="S4.E11.m1.2.2.2.4"><times id="S4.E11.m1.2.2.2.4.1.cmml" xref="S4.E11.m1.2.2.2.4.1"></times><ci id="S4.E11.m1.2.2.2.4.2.cmml" xref="S4.E11.m1.2.2.2.4.2">𝑟</ci><apply id="S4.E11.m1.2.2.2.4.3.cmml" xref="S4.E11.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.4.3.1.cmml" xref="S4.E11.m1.2.2.2.4.3">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1">𝑋</ci><ci id="S4.E11.m1.2.2.2.4.3.3.cmml" xref="S4.E11.m1.2.2.2.4.3.3">𝑖</ci></apply><ci id="S4.E11.m1.2.2.2.4.4.cmml" xref="S4.E11.m1.2.2.2.4.4">𝑟</ci><apply id="S4.E11.m1.2.2.2.4.5.cmml" xref="S4.E11.m1.2.2.2.4.5"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.4.5.1.cmml" xref="S4.E11.m1.2.2.2.4.5">subscript</csymbol><ci id="S4.E11.m1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2">𝑌</ci><ci id="S4.E11.m1.2.2.2.4.5.3.cmml" xref="S4.E11.m1.2.2.2.4.5.3">𝑖</ci></apply></apply></apply><apply id="S4.E11.m1.6.6.6.cmml" xref="S4.E11.m1.6.6.6"><times id="S4.E11.m1.6.6.6.5.cmml" xref="S4.E11.m1.6.6.6.5"></times><apply id="S4.E11.m1.5.5.5.3.2.cmml" xref="S4.E11.m1.5.5.5.3.1"><csymbol cd="latexml" id="S4.E11.m1.5.5.5.3.2.1.cmml" xref="S4.E11.m1.5.5.5.3.1.2">norm</csymbol><apply id="S4.E11.m1.5.5.5.3.1.1.cmml" xref="S4.E11.m1.5.5.5.3.1.1"><times id="S4.E11.m1.5.5.5.3.1.1.1.cmml" xref="S4.E11.m1.5.5.5.3.1.1.1"></times><ci id="S4.E11.m1.5.5.5.3.1.1.2.cmml" xref="S4.E11.m1.5.5.5.3.1.1.2">𝑟</ci><ci id="S4.E11.m1.3.3.3.1.cmml" xref="S4.E11.m1.3.3.3.1">𝑋</ci></apply></apply><apply id="S4.E11.m1.6.6.6.4.2.cmml" xref="S4.E11.m1.6.6.6.4.1"><csymbol cd="latexml" id="S4.E11.m1.6.6.6.4.2.1.cmml" xref="S4.E11.m1.6.6.6.4.1.2">norm</csymbol><apply id="S4.E11.m1.6.6.6.4.1.1.cmml" xref="S4.E11.m1.6.6.6.4.1.1"><times id="S4.E11.m1.6.6.6.4.1.1.1.cmml" xref="S4.E11.m1.6.6.6.4.1.1.1"></times><ci id="S4.E11.m1.6.6.6.4.1.1.2.cmml" xref="S4.E11.m1.6.6.6.4.1.1.2">𝑟</ci><ci id="S4.E11.m1.4.4.4.2.cmml" xref="S4.E11.m1.4.4.4.2">𝑌</ci></apply></apply></apply></apply></apply><apply id="S4.E11.m1.13.13.1.1e.cmml" xref="S4.E11.m1.13.13.1"><approx id="S4.E11.m1.13.13.1.1.7.cmml" xref="S4.E11.m1.13.13.1.1.7"></approx><share href="https://arxiv.org/html/2410.07022v1#S4.E11.m1.6.6.cmml" id="S4.E11.m1.13.13.1.1f.cmml" xref="S4.E11.m1.13.13.1"></share><apply id="S4.E11.m1.13.13.1.1.8.cmml" xref="S4.E11.m1.13.13.1.1.8"><apply id="S4.E11.m1.13.13.1.1.8.1.cmml" xref="S4.E11.m1.13.13.1.1.8.1"><csymbol cd="ambiguous" id="S4.E11.m1.13.13.1.1.8.1.1.cmml" xref="S4.E11.m1.13.13.1.1.8.1">superscript</csymbol><apply id="S4.E11.m1.13.13.1.1.8.1.2.cmml" xref="S4.E11.m1.13.13.1.1.8.1"><csymbol cd="ambiguous" id="S4.E11.m1.13.13.1.1.8.1.2.1.cmml" xref="S4.E11.m1.13.13.1.1.8.1">subscript</csymbol><sum id="S4.E11.m1.13.13.1.1.8.1.2.2.cmml" xref="S4.E11.m1.13.13.1.1.8.1.2.2"></sum><apply id="S4.E11.m1.13.13.1.1.8.1.2.3.cmml" xref="S4.E11.m1.13.13.1.1.8.1.2.3"><eq id="S4.E11.m1.13.13.1.1.8.1.2.3.1.cmml" xref="S4.E11.m1.13.13.1.1.8.1.2.3.1"></eq><ci id="S4.E11.m1.13.13.1.1.8.1.2.3.2.cmml" xref="S4.E11.m1.13.13.1.1.8.1.2.3.2">𝑖</ci><cn id="S4.E11.m1.13.13.1.1.8.1.2.3.3.cmml" type="integer" xref="S4.E11.m1.13.13.1.1.8.1.2.3.3">1</cn></apply></apply><ci id="S4.E11.m1.13.13.1.1.8.1.3.cmml" xref="S4.E11.m1.13.13.1.1.8.1.3">𝑑</ci></apply><apply id="S4.E11.m1.13.13.1.1.8.2.cmml" xref="S4.E11.m1.13.13.1.1.8.2"><times id="S4.E11.m1.13.13.1.1.8.2.1.cmml" xref="S4.E11.m1.13.13.1.1.8.2.1"></times><ci id="S4.E11.m1.13.13.1.1.8.2.2.cmml" xref="S4.E11.m1.13.13.1.1.8.2.2">𝑟</ci><apply id="S4.E11.m1.13.13.1.1.8.2.3.cmml" xref="S4.E11.m1.13.13.1.1.8.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.13.13.1.1.8.2.3.1.cmml" xref="S4.E11.m1.13.13.1.1.8.2.3">subscript</csymbol><ci id="S4.E11.m1.11.11.cmml" xref="S4.E11.m1.11.11">𝑋</ci><ci id="S4.E11.m1.13.13.1.1.8.2.3.3.cmml" xref="S4.E11.m1.13.13.1.1.8.2.3.3">𝑖</ci></apply><ci id="S4.E11.m1.13.13.1.1.8.2.4.cmml" xref="S4.E11.m1.13.13.1.1.8.2.4">𝑟</ci><apply id="S4.E11.m1.13.13.1.1.8.2.5.cmml" xref="S4.E11.m1.13.13.1.1.8.2.5"><csymbol cd="ambiguous" id="S4.E11.m1.13.13.1.1.8.2.5.1.cmml" xref="S4.E11.m1.13.13.1.1.8.2.5">subscript</csymbol><ci id="S4.E11.m1.12.12.cmml" xref="S4.E11.m1.12.12">𝑌</ci><ci id="S4.E11.m1.13.13.1.1.8.2.5.3.cmml" xref="S4.E11.m1.13.13.1.1.8.2.5.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.13c">\mathrm{cos}(X,Y)=\mathrm{cos}(r(X),r(Y))=\frac{\sum_{i=1}^{d}r(X)_{i}r(Y)_{i}%
}{\|r(X)\|\|r(Y)\|}\approx\sum_{i=1}^{d}r(X)_{i}r(Y)_{i}.</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.13d">roman_cos ( italic_X , italic_Y ) = roman_cos ( italic_r ( italic_X ) , italic_r ( italic_Y ) ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_r ( italic_X ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_r ( italic_Y ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∥ italic_r ( italic_X ) ∥ ∥ italic_r ( italic_Y ) ∥ end_ARG ≈ ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_r ( italic_X ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_r ( italic_Y ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.p7">
<p class="ltx_p" id="S4.p7.1">With this approximation, the moments of the cosine similarity can be easily calculated:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}[\mathrm{cos}(X,Y)]=0," class="ltx_Math" display="block" id="S4.E12.m1.3"><semantics id="S4.E12.m1.3a"><mrow id="S4.E12.m1.3.3.1" xref="S4.E12.m1.3.3.1.1.cmml"><mrow id="S4.E12.m1.3.3.1.1" xref="S4.E12.m1.3.3.1.1.cmml"><mrow id="S4.E12.m1.3.3.1.1.1" xref="S4.E12.m1.3.3.1.1.1.cmml"><mi id="S4.E12.m1.3.3.1.1.1.3" xref="S4.E12.m1.3.3.1.1.1.3.cmml">𝔼</mi><mo id="S4.E12.m1.3.3.1.1.1.2" xref="S4.E12.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E12.m1.3.3.1.1.1.1.1" xref="S4.E12.m1.3.3.1.1.1.1.2.cmml"><mo id="S4.E12.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E12.m1.3.3.1.1.1.1.1.1" xref="S4.E12.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.3.3.1.1.1.1.1.1.2" xref="S4.E12.m1.3.3.1.1.1.1.1.1.2.cmml">cos</mi><mo id="S4.E12.m1.3.3.1.1.1.1.1.1.1" xref="S4.E12.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E12.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E12.m1.3.3.1.1.1.1.1.1.3.1.cmml"><mo id="S4.E12.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E12.m1.3.3.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S4.E12.m1.1.1" xref="S4.E12.m1.1.1.cmml">X</mi><mo id="S4.E12.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S4.E12.m1.3.3.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S4.E12.m1.2.2" xref="S4.E12.m1.2.2.cmml">Y</mi><mo id="S4.E12.m1.3.3.1.1.1.1.1.1.3.2.3" stretchy="false" xref="S4.E12.m1.3.3.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E12.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E12.m1.3.3.1.1.2" xref="S4.E12.m1.3.3.1.1.2.cmml">=</mo><mn id="S4.E12.m1.3.3.1.1.3" xref="S4.E12.m1.3.3.1.1.3.cmml">0</mn></mrow><mo id="S4.E12.m1.3.3.1.2" xref="S4.E12.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.3b"><apply id="S4.E12.m1.3.3.1.1.cmml" xref="S4.E12.m1.3.3.1"><eq id="S4.E12.m1.3.3.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.2"></eq><apply id="S4.E12.m1.3.3.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.1"><times id="S4.E12.m1.3.3.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.1.2"></times><ci id="S4.E12.m1.3.3.1.1.1.3.cmml" xref="S4.E12.m1.3.3.1.1.1.3">𝔼</ci><apply id="S4.E12.m1.3.3.1.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.E12.m1.3.3.1.1.1.1.2.1.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E12.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1.1"><times id="S4.E12.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1.1.1"></times><ci id="S4.E12.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1.1.2">cos</ci><interval closure="open" id="S4.E12.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.3.3.1.1.1.1.1.1.3.2"><ci id="S4.E12.m1.1.1.cmml" xref="S4.E12.m1.1.1">𝑋</ci><ci id="S4.E12.m1.2.2.cmml" xref="S4.E12.m1.2.2">𝑌</ci></interval></apply></apply></apply><cn id="S4.E12.m1.3.3.1.1.3.cmml" type="integer" xref="S4.E12.m1.3.3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.3c">\mathbb{E}[\mathrm{cos}(X,Y)]=0,</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.3d">blackboard_E [ roman_cos ( italic_X , italic_Y ) ] = 0 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathrm{Var}(\mathrm{cos}(X,Y))=\sum_{i=1}^{d}\frac{\sigma_{i}^{4}}{(\sum_{j=1%
}^{d}\sigma_{j}^{2})^{2}}." class="ltx_Math" display="block" id="S4.E13.m1.4"><semantics id="S4.E13.m1.4a"><mrow id="S4.E13.m1.4.4.1" xref="S4.E13.m1.4.4.1.1.cmml"><mrow id="S4.E13.m1.4.4.1.1" xref="S4.E13.m1.4.4.1.1.cmml"><mrow id="S4.E13.m1.4.4.1.1.1" xref="S4.E13.m1.4.4.1.1.1.cmml"><mi id="S4.E13.m1.4.4.1.1.1.3" xref="S4.E13.m1.4.4.1.1.1.3.cmml">Var</mi><mo id="S4.E13.m1.4.4.1.1.1.2" xref="S4.E13.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S4.E13.m1.4.4.1.1.1.1.1" xref="S4.E13.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.4.4.1.1.1.1.1.1" xref="S4.E13.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.4.4.1.1.1.1.1.1.2" xref="S4.E13.m1.4.4.1.1.1.1.1.1.2.cmml">cos</mi><mo id="S4.E13.m1.4.4.1.1.1.1.1.1.1" xref="S4.E13.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E13.m1.4.4.1.1.1.1.1.1.3.2" xref="S4.E13.m1.4.4.1.1.1.1.1.1.3.1.cmml"><mo id="S4.E13.m1.4.4.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E13.m1.4.4.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S4.E13.m1.2.2" xref="S4.E13.m1.2.2.cmml">X</mi><mo id="S4.E13.m1.4.4.1.1.1.1.1.1.3.2.2" xref="S4.E13.m1.4.4.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S4.E13.m1.3.3" xref="S4.E13.m1.3.3.cmml">Y</mi><mo id="S4.E13.m1.4.4.1.1.1.1.1.1.3.2.3" stretchy="false" xref="S4.E13.m1.4.4.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E13.m1.4.4.1.1.2" rspace="0.111em" xref="S4.E13.m1.4.4.1.1.2.cmml">=</mo><mrow id="S4.E13.m1.4.4.1.1.3" xref="S4.E13.m1.4.4.1.1.3.cmml"><munderover id="S4.E13.m1.4.4.1.1.3.1" xref="S4.E13.m1.4.4.1.1.3.1.cmml"><mo id="S4.E13.m1.4.4.1.1.3.1.2.2" movablelimits="false" xref="S4.E13.m1.4.4.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E13.m1.4.4.1.1.3.1.2.3" xref="S4.E13.m1.4.4.1.1.3.1.2.3.cmml"><mi id="S4.E13.m1.4.4.1.1.3.1.2.3.2" xref="S4.E13.m1.4.4.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.E13.m1.4.4.1.1.3.1.2.3.1" xref="S4.E13.m1.4.4.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E13.m1.4.4.1.1.3.1.2.3.3" xref="S4.E13.m1.4.4.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E13.m1.4.4.1.1.3.1.3" xref="S4.E13.m1.4.4.1.1.3.1.3.cmml">d</mi></munderover><mfrac id="S4.E13.m1.1.1" xref="S4.E13.m1.1.1.cmml"><msubsup id="S4.E13.m1.1.1.3" xref="S4.E13.m1.1.1.3.cmml"><mi id="S4.E13.m1.1.1.3.2.2" xref="S4.E13.m1.1.1.3.2.2.cmml">σ</mi><mi id="S4.E13.m1.1.1.3.2.3" xref="S4.E13.m1.1.1.3.2.3.cmml">i</mi><mn id="S4.E13.m1.1.1.3.3" xref="S4.E13.m1.1.1.3.3.cmml">4</mn></msubsup><msup id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.cmml"><mrow id="S4.E13.m1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.cmml"><msubsup id="S4.E13.m1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.1.1.1.1.1.1.1.2.2" lspace="0em" xref="S4.E13.m1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1.2.3" xref="S4.E13.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.2.3.2" xref="S4.E13.m1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.2.3.1" xref="S4.E13.m1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S4.E13.m1.1.1.1.1.1.1.1.2.3.3" xref="S4.E13.m1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E13.m1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.3.cmml">d</mi></msubsup><msubsup id="S4.E13.m1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.2.2.2" xref="S4.E13.m1.1.1.1.1.1.1.2.2.2.cmml">σ</mi><mi id="S4.E13.m1.1.1.1.1.1.1.2.2.3" xref="S4.E13.m1.1.1.1.1.1.1.2.2.3.cmml">j</mi><mn id="S4.E13.m1.1.1.1.1.1.1.2.3" xref="S4.E13.m1.1.1.1.1.1.1.2.3.cmml">2</mn></msubsup></mrow><mo id="S4.E13.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E13.m1.1.1.1.3" xref="S4.E13.m1.1.1.1.3.cmml">2</mn></msup></mfrac></mrow></mrow><mo id="S4.E13.m1.4.4.1.2" lspace="0em" xref="S4.E13.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.4b"><apply id="S4.E13.m1.4.4.1.1.cmml" xref="S4.E13.m1.4.4.1"><eq id="S4.E13.m1.4.4.1.1.2.cmml" xref="S4.E13.m1.4.4.1.1.2"></eq><apply id="S4.E13.m1.4.4.1.1.1.cmml" xref="S4.E13.m1.4.4.1.1.1"><times id="S4.E13.m1.4.4.1.1.1.2.cmml" xref="S4.E13.m1.4.4.1.1.1.2"></times><ci id="S4.E13.m1.4.4.1.1.1.3.cmml" xref="S4.E13.m1.4.4.1.1.1.3">Var</ci><apply id="S4.E13.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E13.m1.4.4.1.1.1.1.1"><times id="S4.E13.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.4.4.1.1.1.1.1.1.1"></times><ci id="S4.E13.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.4.4.1.1.1.1.1.1.2">cos</ci><interval closure="open" id="S4.E13.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.4.4.1.1.1.1.1.1.3.2"><ci id="S4.E13.m1.2.2.cmml" xref="S4.E13.m1.2.2">𝑋</ci><ci id="S4.E13.m1.3.3.cmml" xref="S4.E13.m1.3.3">𝑌</ci></interval></apply></apply><apply id="S4.E13.m1.4.4.1.1.3.cmml" xref="S4.E13.m1.4.4.1.1.3"><apply id="S4.E13.m1.4.4.1.1.3.1.cmml" xref="S4.E13.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S4.E13.m1.4.4.1.1.3.1.1.cmml" xref="S4.E13.m1.4.4.1.1.3.1">superscript</csymbol><apply id="S4.E13.m1.4.4.1.1.3.1.2.cmml" xref="S4.E13.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S4.E13.m1.4.4.1.1.3.1.2.1.cmml" xref="S4.E13.m1.4.4.1.1.3.1">subscript</csymbol><sum id="S4.E13.m1.4.4.1.1.3.1.2.2.cmml" xref="S4.E13.m1.4.4.1.1.3.1.2.2"></sum><apply id="S4.E13.m1.4.4.1.1.3.1.2.3.cmml" xref="S4.E13.m1.4.4.1.1.3.1.2.3"><eq id="S4.E13.m1.4.4.1.1.3.1.2.3.1.cmml" xref="S4.E13.m1.4.4.1.1.3.1.2.3.1"></eq><ci id="S4.E13.m1.4.4.1.1.3.1.2.3.2.cmml" xref="S4.E13.m1.4.4.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.E13.m1.4.4.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.E13.m1.4.4.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E13.m1.4.4.1.1.3.1.3.cmml" xref="S4.E13.m1.4.4.1.1.3.1.3">𝑑</ci></apply><apply id="S4.E13.m1.1.1.cmml" xref="S4.E13.m1.1.1"><divide id="S4.E13.m1.1.1.2.cmml" xref="S4.E13.m1.1.1"></divide><apply id="S4.E13.m1.1.1.3.cmml" xref="S4.E13.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.3.1.cmml" xref="S4.E13.m1.1.1.3">superscript</csymbol><apply id="S4.E13.m1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.3.2.1.cmml" xref="S4.E13.m1.1.1.3">subscript</csymbol><ci id="S4.E13.m1.1.1.3.2.2.cmml" xref="S4.E13.m1.1.1.3.2.2">𝜎</ci><ci id="S4.E13.m1.1.1.3.2.3.cmml" xref="S4.E13.m1.1.1.3.2.3">𝑖</ci></apply><cn id="S4.E13.m1.1.1.3.3.cmml" type="integer" xref="S4.E13.m1.1.1.3.3">4</cn></apply><apply id="S4.E13.m1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1">superscript</csymbol><apply id="S4.E13.m1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1"><apply id="S4.E13.m1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E13.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S4.E13.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.2.2"></sum><apply id="S4.E13.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.2.3"><eq id="S4.E13.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S4.E13.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn id="S4.E13.m1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S4.E13.m1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.E13.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.3">𝑑</ci></apply><apply id="S4.E13.m1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E13.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.2.2.2">𝜎</ci><ci id="S4.E13.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><cn id="S4.E13.m1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E13.m1.1.1.1.1.1.1.2.3">2</cn></apply></apply><cn id="S4.E13.m1.1.1.1.3.cmml" type="integer" xref="S4.E13.m1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.4c">\mathrm{Var}(\mathrm{cos}(X,Y))=\sum_{i=1}^{d}\frac{\sigma_{i}^{4}}{(\sum_{j=1%
}^{d}\sigma_{j}^{2})^{2}}.</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.4d">roman_Var ( roman_cos ( italic_X , italic_Y ) ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT divide start_ARG italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT end_ARG start_ARG ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_σ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.p8">
<p class="ltx_p" id="S4.p8.1">We can see from Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.E13" title="In 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">13</span></a> that the cosine similarity distribution is highly dependent on the dimensions with high variance. Taking the gradient of Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.E13" title="In 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">13</span></a> with respect to <math alttext="\sigma_{i}^{2}" class="ltx_Math" display="inline" id="S4.p8.1.m1.1"><semantics id="S4.p8.1.m1.1a"><msubsup id="S4.p8.1.m1.1.1" xref="S4.p8.1.m1.1.1.cmml"><mi id="S4.p8.1.m1.1.1.2.2" xref="S4.p8.1.m1.1.1.2.2.cmml">σ</mi><mi id="S4.p8.1.m1.1.1.2.3" xref="S4.p8.1.m1.1.1.2.3.cmml">i</mi><mn id="S4.p8.1.m1.1.1.3" xref="S4.p8.1.m1.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.p8.1.m1.1b"><apply id="S4.p8.1.m1.1.1.cmml" xref="S4.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p8.1.m1.1.1.1.cmml" xref="S4.p8.1.m1.1.1">superscript</csymbol><apply id="S4.p8.1.m1.1.1.2.cmml" xref="S4.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p8.1.m1.1.1.2.1.cmml" xref="S4.p8.1.m1.1.1">subscript</csymbol><ci id="S4.p8.1.m1.1.1.2.2.cmml" xref="S4.p8.1.m1.1.1.2.2">𝜎</ci><ci id="S4.p8.1.m1.1.1.2.3.cmml" xref="S4.p8.1.m1.1.1.2.3">𝑖</ci></apply><cn id="S4.p8.1.m1.1.1.3.cmml" type="integer" xref="S4.p8.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.1.m1.1c">\sigma_{i}^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.p8.1.m1.1d">italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, we get:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\partial}{\partial\sigma_{i}^{2}}\mathrm{Var}(\mathrm{cos}(X,Y))=2\left(%
\sum_{j=1}^{d}\sigma_{j}^{2}\right)^{-3}\left[(\sum_{j=1}^{d}\sigma_{j}^{2})%
\sigma_{i}^{2}-(\sum_{j=1}^{d}\sigma_{j}^{4})\right]." class="ltx_Math" display="block" id="S4.E14.m1.3"><semantics id="S4.E14.m1.3a"><mrow id="S4.E14.m1.3.3.1" xref="S4.E14.m1.3.3.1.1.cmml"><mrow id="S4.E14.m1.3.3.1.1" xref="S4.E14.m1.3.3.1.1.cmml"><mrow id="S4.E14.m1.3.3.1.1.1" xref="S4.E14.m1.3.3.1.1.1.cmml"><mfrac id="S4.E14.m1.3.3.1.1.1.3" xref="S4.E14.m1.3.3.1.1.1.3.cmml"><mo id="S4.E14.m1.3.3.1.1.1.3.2" xref="S4.E14.m1.3.3.1.1.1.3.2.cmml">∂</mo><mrow id="S4.E14.m1.3.3.1.1.1.3.3" xref="S4.E14.m1.3.3.1.1.1.3.3.cmml"><mo id="S4.E14.m1.3.3.1.1.1.3.3.1" rspace="0em" xref="S4.E14.m1.3.3.1.1.1.3.3.1.cmml">∂</mo><msubsup id="S4.E14.m1.3.3.1.1.1.3.3.2" xref="S4.E14.m1.3.3.1.1.1.3.3.2.cmml"><mi id="S4.E14.m1.3.3.1.1.1.3.3.2.2.2" xref="S4.E14.m1.3.3.1.1.1.3.3.2.2.2.cmml">σ</mi><mi id="S4.E14.m1.3.3.1.1.1.3.3.2.2.3" xref="S4.E14.m1.3.3.1.1.1.3.3.2.2.3.cmml">i</mi><mn id="S4.E14.m1.3.3.1.1.1.3.3.2.3" xref="S4.E14.m1.3.3.1.1.1.3.3.2.3.cmml">2</mn></msubsup></mrow></mfrac><mo id="S4.E14.m1.3.3.1.1.1.2" xref="S4.E14.m1.3.3.1.1.1.2.cmml">⁢</mo><mi id="S4.E14.m1.3.3.1.1.1.4" xref="S4.E14.m1.3.3.1.1.1.4.cmml">Var</mi><mo id="S4.E14.m1.3.3.1.1.1.2a" xref="S4.E14.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.3.3.1.1.1.1.1" xref="S4.E14.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.3.3.1.1.1.1.1.1" xref="S4.E14.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.3.3.1.1.1.1.1.1.2" xref="S4.E14.m1.3.3.1.1.1.1.1.1.2.cmml">cos</mi><mo id="S4.E14.m1.3.3.1.1.1.1.1.1.1" xref="S4.E14.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E14.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.E14.m1.3.3.1.1.1.1.1.1.3.1.cmml"><mo id="S4.E14.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E14.m1.3.3.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S4.E14.m1.1.1" xref="S4.E14.m1.1.1.cmml">X</mi><mo id="S4.E14.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S4.E14.m1.3.3.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S4.E14.m1.2.2" xref="S4.E14.m1.2.2.cmml">Y</mi><mo id="S4.E14.m1.3.3.1.1.1.1.1.1.3.2.3" stretchy="false" xref="S4.E14.m1.3.3.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.3.3.1.1.4" xref="S4.E14.m1.3.3.1.1.4.cmml">=</mo><mrow id="S4.E14.m1.3.3.1.1.3" xref="S4.E14.m1.3.3.1.1.3.cmml"><mn id="S4.E14.m1.3.3.1.1.3.4" xref="S4.E14.m1.3.3.1.1.3.4.cmml">2</mn><mo id="S4.E14.m1.3.3.1.1.3.3" xref="S4.E14.m1.3.3.1.1.3.3.cmml">⁢</mo><msup id="S4.E14.m1.3.3.1.1.2.1" xref="S4.E14.m1.3.3.1.1.2.1.cmml"><mrow id="S4.E14.m1.3.3.1.1.2.1.1.1" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.cmml"><mo id="S4.E14.m1.3.3.1.1.2.1.1.1.2" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.3.3.1.1.2.1.1.1.1" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.cmml"><munderover id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mo id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.cmml"><mi id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.2" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.1" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.3" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.3.cmml">d</mi></munderover><msubsup id="S4.E14.m1.3.3.1.1.2.1.1.1.1.2" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.cmml"><mi id="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.2.2" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.2.2.cmml">σ</mi><mi id="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.2.3" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.2.3.cmml">j</mi><mn id="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.3" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.3.cmml">2</mn></msubsup></mrow><mo id="S4.E14.m1.3.3.1.1.2.1.1.1.3" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E14.m1.3.3.1.1.2.1.3" xref="S4.E14.m1.3.3.1.1.2.1.3.cmml"><mo id="S4.E14.m1.3.3.1.1.2.1.3a" xref="S4.E14.m1.3.3.1.1.2.1.3.cmml">−</mo><mn id="S4.E14.m1.3.3.1.1.2.1.3.2" xref="S4.E14.m1.3.3.1.1.2.1.3.2.cmml">3</mn></mrow></msup><mo id="S4.E14.m1.3.3.1.1.3.3a" xref="S4.E14.m1.3.3.1.1.3.3.cmml">⁢</mo><mrow id="S4.E14.m1.3.3.1.1.3.2.1" xref="S4.E14.m1.3.3.1.1.3.2.2.cmml"><mo id="S4.E14.m1.3.3.1.1.3.2.1.2" xref="S4.E14.m1.3.3.1.1.3.2.2.1.cmml">[</mo><mrow id="S4.E14.m1.3.3.1.1.3.2.1.1" xref="S4.E14.m1.3.3.1.1.3.2.1.1.cmml"><mrow id="S4.E14.m1.3.3.1.1.3.2.1.1.1" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.cmml"><mrow id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.cmml"><munderover id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.2" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.1" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.3.cmml">d</mi></munderover><msubsup id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.cmml"><mi id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.2.2" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.2.2.cmml">σ</mi><mi id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.2.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.2.3.cmml">j</mi><mn id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.3.cmml">2</mn></msubsup></mrow><mo id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E14.m1.3.3.1.1.3.2.1.1.1.2" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.2.cmml">⁢</mo><msubsup id="S4.E14.m1.3.3.1.1.3.2.1.1.1.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.cmml"><mi id="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.2.2" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.2.2.cmml">σ</mi><mi id="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.2.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.2.3.cmml">i</mi><mn id="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.3.cmml">2</mn></msubsup></mrow><mo id="S4.E14.m1.3.3.1.1.3.2.1.1.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.3.cmml">−</mo><mrow id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.cmml"><mo id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.2" stretchy="false" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.cmml">(</mo><mrow id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.cmml"><munderover id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.cmml"><mo id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.2" lspace="0em" movablelimits="false" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.cmml"><mi id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.2" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.2.cmml">j</mi><mo id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.1" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.1.cmml">=</mo><mn id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.3.cmml">d</mi></munderover><msubsup id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.cmml"><mi id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.2.2" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.2.2.cmml">σ</mi><mi id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.2.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.2.3.cmml">j</mi><mn id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.3" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.3.cmml">4</mn></msubsup></mrow><mo id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.3" stretchy="false" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E14.m1.3.3.1.1.3.2.1.3" xref="S4.E14.m1.3.3.1.1.3.2.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E14.m1.3.3.1.2" lspace="0em" xref="S4.E14.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.3b"><apply id="S4.E14.m1.3.3.1.1.cmml" xref="S4.E14.m1.3.3.1"><eq id="S4.E14.m1.3.3.1.1.4.cmml" xref="S4.E14.m1.3.3.1.1.4"></eq><apply id="S4.E14.m1.3.3.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.1"><times id="S4.E14.m1.3.3.1.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1.1.2"></times><apply id="S4.E14.m1.3.3.1.1.1.3.cmml" xref="S4.E14.m1.3.3.1.1.1.3"><divide id="S4.E14.m1.3.3.1.1.1.3.1.cmml" xref="S4.E14.m1.3.3.1.1.1.3"></divide><partialdiff id="S4.E14.m1.3.3.1.1.1.3.2.cmml" xref="S4.E14.m1.3.3.1.1.1.3.2"></partialdiff><apply id="S4.E14.m1.3.3.1.1.1.3.3.cmml" xref="S4.E14.m1.3.3.1.1.1.3.3"><partialdiff id="S4.E14.m1.3.3.1.1.1.3.3.1.cmml" xref="S4.E14.m1.3.3.1.1.1.3.3.1"></partialdiff><apply id="S4.E14.m1.3.3.1.1.1.3.3.2.cmml" xref="S4.E14.m1.3.3.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.1.3.3.2.1.cmml" xref="S4.E14.m1.3.3.1.1.1.3.3.2">superscript</csymbol><apply id="S4.E14.m1.3.3.1.1.1.3.3.2.2.cmml" xref="S4.E14.m1.3.3.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.1.3.3.2.2.1.cmml" xref="S4.E14.m1.3.3.1.1.1.3.3.2">subscript</csymbol><ci id="S4.E14.m1.3.3.1.1.1.3.3.2.2.2.cmml" xref="S4.E14.m1.3.3.1.1.1.3.3.2.2.2">𝜎</ci><ci id="S4.E14.m1.3.3.1.1.1.3.3.2.2.3.cmml" xref="S4.E14.m1.3.3.1.1.1.3.3.2.2.3">𝑖</ci></apply><cn id="S4.E14.m1.3.3.1.1.1.3.3.2.3.cmml" type="integer" xref="S4.E14.m1.3.3.1.1.1.3.3.2.3">2</cn></apply></apply></apply><ci id="S4.E14.m1.3.3.1.1.1.4.cmml" xref="S4.E14.m1.3.3.1.1.1.4">Var</ci><apply id="S4.E14.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1"><times id="S4.E14.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1.1.1"></times><ci id="S4.E14.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1.1.2">cos</ci><interval closure="open" id="S4.E14.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.3.3.1.1.1.1.1.1.3.2"><ci id="S4.E14.m1.1.1.cmml" xref="S4.E14.m1.1.1">𝑋</ci><ci id="S4.E14.m1.2.2.cmml" xref="S4.E14.m1.2.2">𝑌</ci></interval></apply></apply><apply id="S4.E14.m1.3.3.1.1.3.cmml" xref="S4.E14.m1.3.3.1.1.3"><times id="S4.E14.m1.3.3.1.1.3.3.cmml" xref="S4.E14.m1.3.3.1.1.3.3"></times><cn id="S4.E14.m1.3.3.1.1.3.4.cmml" type="integer" xref="S4.E14.m1.3.3.1.1.3.4">2</cn><apply id="S4.E14.m1.3.3.1.1.2.1.cmml" xref="S4.E14.m1.3.3.1.1.2.1"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.2.1.2.cmml" xref="S4.E14.m1.3.3.1.1.2.1">superscript</csymbol><apply id="S4.E14.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1"><apply id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1">superscript</csymbol><apply id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1">subscript</csymbol><sum id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.2"></sum><apply id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3"><eq id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.1.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.1"></eq><ci id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.2.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.2">𝑗</ci><cn id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.1.3">𝑑</ci></apply><apply id="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.2">superscript</csymbol><apply id="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.2.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.2.1.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.2">subscript</csymbol><ci id="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.2.2.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.2.2">𝜎</ci><ci id="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.2.3.cmml" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.2.3">𝑗</ci></apply><cn id="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.3.cmml" type="integer" xref="S4.E14.m1.3.3.1.1.2.1.1.1.1.2.3">2</cn></apply></apply><apply id="S4.E14.m1.3.3.1.1.2.1.3.cmml" xref="S4.E14.m1.3.3.1.1.2.1.3"><minus id="S4.E14.m1.3.3.1.1.2.1.3.1.cmml" xref="S4.E14.m1.3.3.1.1.2.1.3"></minus><cn id="S4.E14.m1.3.3.1.1.2.1.3.2.cmml" type="integer" xref="S4.E14.m1.3.3.1.1.2.1.3.2">3</cn></apply></apply><apply id="S4.E14.m1.3.3.1.1.3.2.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1"><csymbol cd="latexml" id="S4.E14.m1.3.3.1.1.3.2.2.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.2">delimited-[]</csymbol><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1"><minus id="S4.E14.m1.3.3.1.1.3.2.1.1.3.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.3"></minus><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1"><times id="S4.E14.m1.3.3.1.1.3.2.1.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.2"></times><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1"><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1">subscript</csymbol><sum id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.2"></sum><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3"><eq id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.2">𝑗</ci><cn id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.1.3">𝑑</ci></apply><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.2.2">𝜎</ci><ci id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><cn id="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.1.1.1.2.3">2</cn></apply></apply><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.3">superscript</csymbol><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.2.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.3">subscript</csymbol><ci id="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.2.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.2.2">𝜎</ci><ci id="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.2.3.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.2.3">𝑖</ci></apply><cn id="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.3.cmml" type="integer" xref="S4.E14.m1.3.3.1.1.3.2.1.1.1.3.3">2</cn></apply></apply><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1"><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1">superscript</csymbol><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1">subscript</csymbol><sum id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.2"></sum><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3"><eq id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.1"></eq><ci id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.2">𝑗</ci><cn id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.3.cmml" type="integer" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.2.3.3">1</cn></apply></apply><ci id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.3.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.1.3">𝑑</ci></apply><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2">superscript</csymbol><apply id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.2.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2">subscript</csymbol><ci id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.2.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.2.2">𝜎</ci><ci id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.2.3.cmml" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.2.3">𝑗</ci></apply><cn id="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.3.cmml" type="integer" xref="S4.E14.m1.3.3.1.1.3.2.1.1.2.1.1.2.3">4</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.3c">\frac{\partial}{\partial\sigma_{i}^{2}}\mathrm{Var}(\mathrm{cos}(X,Y))=2\left(%
\sum_{j=1}^{d}\sigma_{j}^{2}\right)^{-3}\left[(\sum_{j=1}^{d}\sigma_{j}^{2})%
\sigma_{i}^{2}-(\sum_{j=1}^{d}\sigma_{j}^{4})\right].</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.3d">divide start_ARG ∂ end_ARG start_ARG ∂ italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG roman_Var ( roman_cos ( italic_X , italic_Y ) ) = 2 ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_σ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT [ ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_σ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ( ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT italic_σ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.p9">
<p class="ltx_p" id="S4.p9.2">We can see that the global minimum of the approximation for <math alttext="\mathrm{Var}(\mathrm{cos}(X,Y))" class="ltx_Math" display="inline" id="S4.p9.1.m1.3"><semantics id="S4.p9.1.m1.3a"><mrow id="S4.p9.1.m1.3.3" xref="S4.p9.1.m1.3.3.cmml"><mi id="S4.p9.1.m1.3.3.3" xref="S4.p9.1.m1.3.3.3.cmml">Var</mi><mo id="S4.p9.1.m1.3.3.2" xref="S4.p9.1.m1.3.3.2.cmml">⁢</mo><mrow id="S4.p9.1.m1.3.3.1.1" xref="S4.p9.1.m1.3.3.1.1.1.cmml"><mo id="S4.p9.1.m1.3.3.1.1.2" stretchy="false" xref="S4.p9.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.p9.1.m1.3.3.1.1.1" xref="S4.p9.1.m1.3.3.1.1.1.cmml"><mi id="S4.p9.1.m1.3.3.1.1.1.2" xref="S4.p9.1.m1.3.3.1.1.1.2.cmml">cos</mi><mo id="S4.p9.1.m1.3.3.1.1.1.1" xref="S4.p9.1.m1.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S4.p9.1.m1.3.3.1.1.1.3.2" xref="S4.p9.1.m1.3.3.1.1.1.3.1.cmml"><mo id="S4.p9.1.m1.3.3.1.1.1.3.2.1" stretchy="false" xref="S4.p9.1.m1.3.3.1.1.1.3.1.cmml">(</mo><mi id="S4.p9.1.m1.1.1" xref="S4.p9.1.m1.1.1.cmml">X</mi><mo id="S4.p9.1.m1.3.3.1.1.1.3.2.2" xref="S4.p9.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S4.p9.1.m1.2.2" xref="S4.p9.1.m1.2.2.cmml">Y</mi><mo id="S4.p9.1.m1.3.3.1.1.1.3.2.3" stretchy="false" xref="S4.p9.1.m1.3.3.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.p9.1.m1.3.3.1.1.3" stretchy="false" xref="S4.p9.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p9.1.m1.3b"><apply id="S4.p9.1.m1.3.3.cmml" xref="S4.p9.1.m1.3.3"><times id="S4.p9.1.m1.3.3.2.cmml" xref="S4.p9.1.m1.3.3.2"></times><ci id="S4.p9.1.m1.3.3.3.cmml" xref="S4.p9.1.m1.3.3.3">Var</ci><apply id="S4.p9.1.m1.3.3.1.1.1.cmml" xref="S4.p9.1.m1.3.3.1.1"><times id="S4.p9.1.m1.3.3.1.1.1.1.cmml" xref="S4.p9.1.m1.3.3.1.1.1.1"></times><ci id="S4.p9.1.m1.3.3.1.1.1.2.cmml" xref="S4.p9.1.m1.3.3.1.1.1.2">cos</ci><interval closure="open" id="S4.p9.1.m1.3.3.1.1.1.3.1.cmml" xref="S4.p9.1.m1.3.3.1.1.1.3.2"><ci id="S4.p9.1.m1.1.1.cmml" xref="S4.p9.1.m1.1.1">𝑋</ci><ci id="S4.p9.1.m1.2.2.cmml" xref="S4.p9.1.m1.2.2">𝑌</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.1.m1.3c">\mathrm{Var}(\mathrm{cos}(X,Y))</annotation><annotation encoding="application/x-llamapun" id="S4.p9.1.m1.3d">roman_Var ( roman_cos ( italic_X , italic_Y ) )</annotation></semantics></math> is achieved when all individual variances of the original distribution are equal, <span class="ltx_text ltx_font_italic" id="S4.p9.2.1">i.e.</span>, <math alttext="\sigma_{i}^{2}=\sigma_{j}^{2}\ \forall\ i,j" class="ltx_Math" display="inline" id="S4.p9.2.m2.2"><semantics id="S4.p9.2.m2.2a"><mrow id="S4.p9.2.m2.2.2" xref="S4.p9.2.m2.2.2.cmml"><msubsup id="S4.p9.2.m2.2.2.3" xref="S4.p9.2.m2.2.2.3.cmml"><mi id="S4.p9.2.m2.2.2.3.2.2" xref="S4.p9.2.m2.2.2.3.2.2.cmml">σ</mi><mi id="S4.p9.2.m2.2.2.3.2.3" xref="S4.p9.2.m2.2.2.3.2.3.cmml">i</mi><mn id="S4.p9.2.m2.2.2.3.3" xref="S4.p9.2.m2.2.2.3.3.cmml">2</mn></msubsup><mo id="S4.p9.2.m2.2.2.2" xref="S4.p9.2.m2.2.2.2.cmml">=</mo><mrow id="S4.p9.2.m2.2.2.1.1" xref="S4.p9.2.m2.2.2.1.2.cmml"><mrow id="S4.p9.2.m2.2.2.1.1.1" xref="S4.p9.2.m2.2.2.1.1.1.cmml"><msubsup id="S4.p9.2.m2.2.2.1.1.1.2" xref="S4.p9.2.m2.2.2.1.1.1.2.cmml"><mi id="S4.p9.2.m2.2.2.1.1.1.2.2.2" xref="S4.p9.2.m2.2.2.1.1.1.2.2.2.cmml">σ</mi><mi id="S4.p9.2.m2.2.2.1.1.1.2.2.3" xref="S4.p9.2.m2.2.2.1.1.1.2.2.3.cmml">j</mi><mn id="S4.p9.2.m2.2.2.1.1.1.2.3" xref="S4.p9.2.m2.2.2.1.1.1.2.3.cmml">2</mn></msubsup><mo id="S4.p9.2.m2.2.2.1.1.1.1" lspace="0.167em" xref="S4.p9.2.m2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.p9.2.m2.2.2.1.1.1.3" xref="S4.p9.2.m2.2.2.1.1.1.3.cmml"><mo id="S4.p9.2.m2.2.2.1.1.1.3.1" rspace="0.667em" xref="S4.p9.2.m2.2.2.1.1.1.3.1.cmml">∀</mo><mi id="S4.p9.2.m2.2.2.1.1.1.3.2" xref="S4.p9.2.m2.2.2.1.1.1.3.2.cmml">i</mi></mrow></mrow><mo id="S4.p9.2.m2.2.2.1.1.2" xref="S4.p9.2.m2.2.2.1.2.cmml">,</mo><mi id="S4.p9.2.m2.1.1" xref="S4.p9.2.m2.1.1.cmml">j</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p9.2.m2.2b"><apply id="S4.p9.2.m2.2.2.cmml" xref="S4.p9.2.m2.2.2"><eq id="S4.p9.2.m2.2.2.2.cmml" xref="S4.p9.2.m2.2.2.2"></eq><apply id="S4.p9.2.m2.2.2.3.cmml" xref="S4.p9.2.m2.2.2.3"><csymbol cd="ambiguous" id="S4.p9.2.m2.2.2.3.1.cmml" xref="S4.p9.2.m2.2.2.3">superscript</csymbol><apply id="S4.p9.2.m2.2.2.3.2.cmml" xref="S4.p9.2.m2.2.2.3"><csymbol cd="ambiguous" id="S4.p9.2.m2.2.2.3.2.1.cmml" xref="S4.p9.2.m2.2.2.3">subscript</csymbol><ci id="S4.p9.2.m2.2.2.3.2.2.cmml" xref="S4.p9.2.m2.2.2.3.2.2">𝜎</ci><ci id="S4.p9.2.m2.2.2.3.2.3.cmml" xref="S4.p9.2.m2.2.2.3.2.3">𝑖</ci></apply><cn id="S4.p9.2.m2.2.2.3.3.cmml" type="integer" xref="S4.p9.2.m2.2.2.3.3">2</cn></apply><list id="S4.p9.2.m2.2.2.1.2.cmml" xref="S4.p9.2.m2.2.2.1.1"><apply id="S4.p9.2.m2.2.2.1.1.1.cmml" xref="S4.p9.2.m2.2.2.1.1.1"><times id="S4.p9.2.m2.2.2.1.1.1.1.cmml" xref="S4.p9.2.m2.2.2.1.1.1.1"></times><apply id="S4.p9.2.m2.2.2.1.1.1.2.cmml" xref="S4.p9.2.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.p9.2.m2.2.2.1.1.1.2.1.cmml" xref="S4.p9.2.m2.2.2.1.1.1.2">superscript</csymbol><apply id="S4.p9.2.m2.2.2.1.1.1.2.2.cmml" xref="S4.p9.2.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.p9.2.m2.2.2.1.1.1.2.2.1.cmml" xref="S4.p9.2.m2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.p9.2.m2.2.2.1.1.1.2.2.2.cmml" xref="S4.p9.2.m2.2.2.1.1.1.2.2.2">𝜎</ci><ci id="S4.p9.2.m2.2.2.1.1.1.2.2.3.cmml" xref="S4.p9.2.m2.2.2.1.1.1.2.2.3">𝑗</ci></apply><cn id="S4.p9.2.m2.2.2.1.1.1.2.3.cmml" type="integer" xref="S4.p9.2.m2.2.2.1.1.1.2.3">2</cn></apply><apply id="S4.p9.2.m2.2.2.1.1.1.3.cmml" xref="S4.p9.2.m2.2.2.1.1.1.3"><csymbol cd="latexml" id="S4.p9.2.m2.2.2.1.1.1.3.1.cmml" xref="S4.p9.2.m2.2.2.1.1.1.3.1">for-all</csymbol><ci id="S4.p9.2.m2.2.2.1.1.1.3.2.cmml" xref="S4.p9.2.m2.2.2.1.1.1.3.2">𝑖</ci></apply></apply><ci id="S4.p9.2.m2.1.1.cmml" xref="S4.p9.2.m2.1.1">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.2.m2.2c">\sigma_{i}^{2}=\sigma_{j}^{2}\ \forall\ i,j</annotation><annotation encoding="application/x-llamapun" id="S4.p9.2.m2.2d">italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = italic_σ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ∀ italic_i , italic_j</annotation></semantics></math>. This is enforced in <span class="ltx_text ltx_font_typewriter" id="S4.p9.2.2">AE-SVC</span> by the variance constraint (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3.E3" title="In 3.1 Autoencoders with Strong Variance Constraints (AE-SVC) ‣ 3 Methodology ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3</span></a>). Therefore, we theoretically and empirically justified that <span class="ltx_text ltx_font_typewriter" id="S4.p9.2.3">AE-SVC</span> minimizes the variance of the cosine similarity distribution, improving retrieval performance.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">Datasets</span>: We evaluate our approach on four distinct image retrieval datasets: InShop <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib18" title="">2016</a>)</cite>, Stanford Online Products (SOP) <cite class="ltx_cite ltx_citemacro_citep">(Song et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib31" title="">2016</a>)</cite>, Pittsburgh30K <cite class="ltx_cite ltx_citemacro_citep">(Torii et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib33" title="">2013</a>)</cite>, and TokyoVal <cite class="ltx_cite ltx_citemacro_citep">(Torii et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib34" title="">2015</a>)</cite>. InShop and SOP are state-of-the-art (SOTA) image retrieval datasets commonly used in metric learning research, while Pittsburgh30K and TokyoVal are recognized as SOTA place recognition datasets, frequently used in robotics research.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p2.1.1">Foundation Models Evaluated</span>:
To demonstrate the broad applicability of our approach, we conducted experiments using four different foundational models trained with a variety of techniques and pre-training datasets: CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib25" title="">2021</a>)</cite>, DINO <cite class="ltx_cite ltx_citemacro_citep">(Caron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib5" title="">2021</a>)</cite>, DINOv2 <cite class="ltx_cite ltx_citemacro_citep">(Oquab et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib22" title="">2024</a>)</cite>, and ViT <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib7" title="">2021</a>)</cite>. The CLIP model was pre-trained on the LAION-2B dataset <cite class="ltx_cite ltx_citemacro_citep">(Community, <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib6" title="">2023</a>)</cite> using a contrastive learning approach. Both DINO and ViT models were pre-trained in a self-supervised manner on the ImageNet dataset <cite class="ltx_cite ltx_citemacro_citep">(Russakovsky et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib27" title="">2015</a>)</cite>. The DINOv2 model was pre-trained in a self-supervised manner on the LVD-142M dataset <cite class="ltx_cite ltx_citemacro_citep">(Oquab et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#bib.bib21" title="">2023</a>)</cite>. For the DINO and DINOv2 models, we evaluated different model sizes: specifically, DINO-S8 with 22.7 million parameters and DINO-B16 with 300 million parameters, as well as DINOv2-Small with 22.1 million parameters and DINOv2-Large with 300 million parameters.</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.8"><span class="ltx_text ltx_font_bold" id="S5.SS1.p3.8.6">Settings</span>: Our work presents two contributions: the introduction of a novel space, <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p3.8.7">AE-SVC</span>, and a new method for learning an adaptive embedding, <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p3.1.1">(SS)<sub class="ltx_sub" id="S5.SS1.p3.1.1.1"><span class="ltx_text ltx_font_serif" id="S5.SS1.p3.1.1.1.1">2</span></sub>D</span>, on top of <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p3.8.8">AE-SVC</span>. Consequently, our experiments are divided into two parts. First, we demonstrate that <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p3.8.9">AE-SVC</span> significantly enhances the retrieval performance of foundation models across various datasets and model choices. Second, we show that <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p3.2.2">(SS)<sub class="ltx_sub" id="S5.SS1.p3.2.2.1"><span class="ltx_text ltx_font_serif" id="S5.SS1.p3.2.2.1.1">2</span></sub>D</span> facilitates more effective dimensionality reduction on top of <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p3.8.10">AE-SVC</span>, further improving performance at lower dimensions. We compare <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p3.3.3">(SS)<sub class="ltx_sub" id="S5.SS1.p3.3.3.1"><span class="ltx_text ltx_font_serif" id="S5.SS1.p3.3.3.1.1">2</span></sub>D</span> with the following baselines: a variational auto-encoder (VAE) applied to <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p3.8.11">AE-SVC</span> for each dimensional size separately. Additionally, we compare <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p3.4.4">(SS)<sub class="ltx_sub" id="S5.SS1.p3.4.4.1"><span class="ltx_text ltx_font_serif" id="S5.SS1.p3.4.4.1.1">2</span></sub>D</span> with using Similarity Space Distillation applied to each dimension separately, referred to as SSD. Note that SSD serves as a theoretical upper bound for <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p3.5.5">(SS)<sub class="ltx_sub" id="S5.SS1.p3.5.5.1"><span class="ltx_text ltx_font_serif" id="S5.SS1.p3.5.5.1.1">2</span></sub>D</span>. We use mean Average Precision at <math alttext="\mathbf{k}" class="ltx_Math" display="inline" id="S5.SS1.p3.6.m1.1"><semantics id="S5.SS1.p3.6.m1.1a"><mi id="S5.SS1.p3.6.m1.1.1" xref="S5.SS1.p3.6.m1.1.1.cmml">𝐤</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.6.m1.1b"><ci id="S5.SS1.p3.6.m1.1.1.cmml" xref="S5.SS1.p3.6.m1.1.1">𝐤</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.6.m1.1c">\mathbf{k}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.6.m1.1d">bold_k</annotation></semantics></math> (mAP@<math alttext="\mathbf{k}" class="ltx_Math" display="inline" id="S5.SS1.p3.7.m2.1"><semantics id="S5.SS1.p3.7.m2.1a"><mi id="S5.SS1.p3.7.m2.1.1" xref="S5.SS1.p3.7.m2.1.1.cmml">𝐤</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.7.m2.1b"><ci id="S5.SS1.p3.7.m2.1.1.cmml" xref="S5.SS1.p3.7.m2.1.1">𝐤</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.7.m2.1c">\mathbf{k}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.7.m2.1d">bold_k</annotation></semantics></math>), a standard metric for evaluating retrieval performance. We show additional results on the Recall@<math alttext="\mathbf{k}" class="ltx_Math" display="inline" id="S5.SS1.p3.8.m3.1"><semantics id="S5.SS1.p3.8.m3.1a"><mi id="S5.SS1.p3.8.m3.1.1" xref="S5.SS1.p3.8.m3.1.1.cmml">𝐤</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.8.m3.1b"><ci id="S5.SS1.p3.8.m3.1.1.cmml" xref="S5.SS1.p3.8.m3.1.1">𝐤</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.8.m3.1c">\mathbf{k}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.8.m3.1d">bold_k</annotation></semantics></math> metric in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS5" title="A.5 AE-SVC Additional Results on the Recall Metric ‣ Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">A.5</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Results</h3>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="142" id="S5.F4.g1" src="extracted/5913932/figs/exp_vapca_map.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S5.F4.2.1" style="font-size:90%;">AE-SVC<span class="ltx_text ltx_font_serif" id="S5.F4.2.1.1"> significantly improves the retrieval performance of foundation models.<span class="ltx_text ltx_font_medium" id="S5.F4.2.1.1.1"> <span class="ltx_text ltx_font_typewriter" id="S5.F4.2.1.1.1.1">AE-SVC</span> (solid lines) consistently outperforms the off-the-shelf foundation models, i.e., PCA (dashed lines), on four datasets, achieving a 15.5% average improvement in retrieval performance. </span></span></span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.7">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S5.F4" title="Figure 4 ‣ 5.2 Results ‣ 5 Experiments ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">4</span></a> shows the performance comparison between <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.7.1">AE-SVC</span> and PCA across <math alttext="4" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mn id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><cn id="S5.SS2.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS2.p1.1.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">4</annotation></semantics></math> datasets, InShop, Stanford Online Products (SOP), Pittsburgh30K, and TokyoVal, using <math alttext="3" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><mn id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><cn id="S5.SS2.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS2.p1.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">3</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">3</annotation></semantics></math> foundation models (ViT, DINOv2-Large, and DINO-B16). The performance of PCA (dotted line) represents the default off-the-shelf performance of the foundation models, while the performance of <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.7.2">AE-SVC</span> is shown with solid lines. <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.7.3">AE-SVC</span> consistently outperforms PCA across all datasets and embeddings. For example, the DINOv2-Large embedding (yellow) shows a <math alttext="24\%" class="ltx_Math" display="inline" id="S5.SS2.p1.3.m3.1"><semantics id="S5.SS2.p1.3.m3.1a"><mrow id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml"><mn id="S5.SS2.p1.3.m3.1.1.2" xref="S5.SS2.p1.3.m3.1.1.2.cmml">24</mn><mo id="S5.SS2.p1.3.m3.1.1.1" xref="S5.SS2.p1.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><apply id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1"><csymbol cd="latexml" id="S5.SS2.p1.3.m3.1.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1.1">percent</csymbol><cn id="S5.SS2.p1.3.m3.1.1.2.cmml" type="integer" xref="S5.SS2.p1.3.m3.1.1.2">24</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">24\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.3.m3.1d">24 %</annotation></semantics></math> improvement on InShop, <math alttext="10\%" class="ltx_Math" display="inline" id="S5.SS2.p1.4.m4.1"><semantics id="S5.SS2.p1.4.m4.1a"><mrow id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml"><mn id="S5.SS2.p1.4.m4.1.1.2" xref="S5.SS2.p1.4.m4.1.1.2.cmml">10</mn><mo id="S5.SS2.p1.4.m4.1.1.1" xref="S5.SS2.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><apply id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1"><csymbol cd="latexml" id="S5.SS2.p1.4.m4.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1">percent</csymbol><cn id="S5.SS2.p1.4.m4.1.1.2.cmml" type="integer" xref="S5.SS2.p1.4.m4.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.4.m4.1d">10 %</annotation></semantics></math> on SoP, <math alttext="5\%" class="ltx_Math" display="inline" id="S5.SS2.p1.5.m5.1"><semantics id="S5.SS2.p1.5.m5.1a"><mrow id="S5.SS2.p1.5.m5.1.1" xref="S5.SS2.p1.5.m5.1.1.cmml"><mn id="S5.SS2.p1.5.m5.1.1.2" xref="S5.SS2.p1.5.m5.1.1.2.cmml">5</mn><mo id="S5.SS2.p1.5.m5.1.1.1" xref="S5.SS2.p1.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m5.1b"><apply id="S5.SS2.p1.5.m5.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1"><csymbol cd="latexml" id="S5.SS2.p1.5.m5.1.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1.1">percent</csymbol><cn id="S5.SS2.p1.5.m5.1.1.2.cmml" type="integer" xref="S5.SS2.p1.5.m5.1.1.2">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m5.1c">5\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.5.m5.1d">5 %</annotation></semantics></math> on Pittsburgh30K, and <math alttext="22\%" class="ltx_Math" display="inline" id="S5.SS2.p1.6.m6.1"><semantics id="S5.SS2.p1.6.m6.1a"><mrow id="S5.SS2.p1.6.m6.1.1" xref="S5.SS2.p1.6.m6.1.1.cmml"><mn id="S5.SS2.p1.6.m6.1.1.2" xref="S5.SS2.p1.6.m6.1.1.2.cmml">22</mn><mo id="S5.SS2.p1.6.m6.1.1.1" xref="S5.SS2.p1.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.6.m6.1b"><apply id="S5.SS2.p1.6.m6.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1"><csymbol cd="latexml" id="S5.SS2.p1.6.m6.1.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1.1">percent</csymbol><cn id="S5.SS2.p1.6.m6.1.1.2.cmml" type="integer" xref="S5.SS2.p1.6.m6.1.1.2">22</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.6.m6.1c">22\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.6.m6.1d">22 %</annotation></semantics></math> on TokyoVal at full embedding size. Overall, <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.7.4">AE-SVC</span> achieves an average improvement of <math alttext="15.5\%" class="ltx_Math" display="inline" id="S5.SS2.p1.7.m7.1"><semantics id="S5.SS2.p1.7.m7.1a"><mrow id="S5.SS2.p1.7.m7.1.1" xref="S5.SS2.p1.7.m7.1.1.cmml"><mn id="S5.SS2.p1.7.m7.1.1.2" xref="S5.SS2.p1.7.m7.1.1.2.cmml">15.5</mn><mo id="S5.SS2.p1.7.m7.1.1.1" xref="S5.SS2.p1.7.m7.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.7.m7.1b"><apply id="S5.SS2.p1.7.m7.1.1.cmml" xref="S5.SS2.p1.7.m7.1.1"><csymbol cd="latexml" id="S5.SS2.p1.7.m7.1.1.1.cmml" xref="S5.SS2.p1.7.m7.1.1.1">percent</csymbol><cn id="S5.SS2.p1.7.m7.1.1.2.cmml" type="float" xref="S5.SS2.p1.7.m7.1.1.2">15.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.7.m7.1c">15.5\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.7.m7.1d">15.5 %</annotation></semantics></math> across all datasets and embeddings at full size. Also, <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.7.5">AE-SVC</span> consistently surpasses PCA at smaller embedding sizes, providing a better size-performance trade-off. For additional results with more foundation models, see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS3" title="A.3 AE-SVC Additional Results with more foundation models ‣ Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">A.3</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.9">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S5.F5" title="Figure 5 ‣ 5.2 Results ‣ 5 Experiments ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">5</span></a> illustrates the advantages of <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.1">(SS)<sub class="ltx_sub" id="S5.SS2.p2.1.1.1"><span class="ltx_text ltx_font_serif" id="S5.SS2.p2.1.1.1.1">2</span></sub>D</span> on two datasets: InShop and Pittsburgh30K, utilizing two foundation models, Dinov2-Large and Dino-S8. We compare <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.2.2">(SS)<sub class="ltx_sub" id="S5.SS2.p2.2.2.1"><span class="ltx_text ltx_font_serif" id="S5.SS2.p2.2.2.1.1">2</span></sub>D</span> with a non-linear dimensionality reduction technique, Variational Auto Encoder (VAE) (black crosses). Additionally, we compare it with Similarity Space Distillation (SSD), which represents the theoretical upper bound of <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.3.3">(SS)<sub class="ltx_sub" id="S5.SS2.p2.3.3.1"><span class="ltx_text ltx_font_serif" id="S5.SS2.p2.3.3.1.1">2</span></sub>D</span>. Note that unlike VAE (black crosses) and SSD (red crosses), which are trained for each dimension separately, <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.4.4">(SS)<sub class="ltx_sub" id="S5.SS2.p2.4.4.1"><span class="ltx_text ltx_font_serif" id="S5.SS2.p2.4.4.1.1">2</span></sub>D</span> learns an adaptive embedding in one shot. From the plot, we observe that <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.9.9">AE-SVC</span> (orange) initially enhances the performance of the original embedding (blue), and <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.5.5">(SS)<sub class="ltx_sub" id="S5.SS2.p2.5.5.1"><span class="ltx_text ltx_font_serif" id="S5.SS2.p2.5.5.1.1">2</span></sub>D</span> subsequently provides additional improvements of up to <math alttext="10\%" class="ltx_Math" display="inline" id="S5.SS2.p2.6.m1.1"><semantics id="S5.SS2.p2.6.m1.1a"><mrow id="S5.SS2.p2.6.m1.1.1" xref="S5.SS2.p2.6.m1.1.1.cmml"><mn id="S5.SS2.p2.6.m1.1.1.2" xref="S5.SS2.p2.6.m1.1.1.2.cmml">10</mn><mo id="S5.SS2.p2.6.m1.1.1.1" xref="S5.SS2.p2.6.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.6.m1.1b"><apply id="S5.SS2.p2.6.m1.1.1.cmml" xref="S5.SS2.p2.6.m1.1.1"><csymbol cd="latexml" id="S5.SS2.p2.6.m1.1.1.1.cmml" xref="S5.SS2.p2.6.m1.1.1.1">percent</csymbol><cn id="S5.SS2.p2.6.m1.1.1.2.cmml" type="integer" xref="S5.SS2.p2.6.m1.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.6.m1.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.6.m1.1d">10 %</annotation></semantics></math> at smaller embedding sizes.
Also note that since SSD is trained for each dimension separately, it serves as the theoretical upper bound of <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.7.6">(SS)<sub class="ltx_sub" id="S5.SS2.p2.7.6.1"><span class="ltx_text ltx_font_serif" id="S5.SS2.p2.7.6.1.1">2</span></sub>D</span>. The results indicate that <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.8.7">(SS)<sub class="ltx_sub" id="S5.SS2.p2.8.7.1"><span class="ltx_text ltx_font_serif" id="S5.SS2.p2.8.7.1.1">2</span></sub>D</span> closely approaches this upper bound. For additional results involving more datasets and foundation models, please refer to Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS4" title="A.4 (SS)2D Additional Results with more datasets and foundation models ‣ Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">A.4</span></a>. As discussed in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S1" title="1 Introduction ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">1</span></a>, a smaller embedding size directly translates to faster retrieval speeds. Therefore, the effective dimensionality reduction achieved with <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.9.8">(SS)<sub class="ltx_sub" id="S5.SS2.p2.9.8.1"><span class="ltx_text ltx_font_serif" id="S5.SS2.p2.9.8.1.1">2</span></sub>D</span> results in improved retrieval speeds, as demonstrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">1</span></a><span class="ltx_text ltx_font_bold" id="S5.SS2.p2.9.10">(D)</span>.</p>
</div>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="147" id="S5.F5.g1" src="extracted/5913932/figs/exp_ss2d.png" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="ltx_text ltx_font_bold" id="S5.F5.4.2" style="font-size:90%;">Applying <span class="ltx_text ltx_font_typewriter" id="S5.F5.3.1.1">(SS)<sub class="ltx_sub" id="S5.F5.3.1.1.1"><span class="ltx_text ltx_font_serif ltx_font_medium" id="S5.F5.3.1.1.1.1">2</span></sub>D</span> over <span class="ltx_text ltx_font_typewriter" id="S5.F5.4.2.3">AE-SVC</span> leads to further performance boost at lower embedding sizes.<span class="ltx_text ltx_font_medium" id="S5.F5.4.2.2"> Compared to VAE and SSD, <span class="ltx_text ltx_font_typewriter" id="S5.F5.4.2.2.1">(SS)<sub class="ltx_sub" id="S5.F5.4.2.2.1.1"><span class="ltx_text ltx_font_serif" id="S5.F5.4.2.2.1.1.1">2</span></sub>D</span> offers superior single-shot dimensionality reduction, achieving up to a 10% enhancement at smaller embedding sizes, closely approaching SSD’s theoretical upper bound.</span></span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Limitations</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">While <span class="ltx_text ltx_font_typewriter" id="S5.SS3.p1.1.2">AE-SVC</span> demonstrates significant improvements when applied to foundation models, its ability to enhance dataset-specific models is limited. The pre-trained models tailored for a specific dataset already capture the nuances required for effective retrieval, leaving less room for further optimization via <span class="ltx_text ltx_font_typewriter" id="S5.SS3.p1.1.3">AE-SVC</span>.
Additionally, <span class="ltx_text ltx_font_typewriter" id="S5.SS3.p1.1.1">(SS)<sub class="ltx_sub" id="S5.SS3.p1.1.1.1"><span class="ltx_text ltx_font_serif" id="S5.SS3.p1.1.1.1.1">2</span></sub>D</span> introduces a computational overhead during training due to the need to compute the loss functions for various embedding sizes. This overhead increases training time, though it is still substantially lower than the cost of retraining neural networks for different embedding sizes from scratch.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion and Future Work</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.5">In this paper, we proposed <span class="ltx_text ltx_font_typewriter" id="S6.p1.5.3">AE-SVC</span> and <span class="ltx_text ltx_font_typewriter" id="S6.p1.1.1">(SS)<sub class="ltx_sub" id="S6.p1.1.1.1"><span class="ltx_text ltx_font_serif" id="S6.p1.1.1.1.1">2</span></sub>D</span>, which improve retrieval scalability and efficiency.
Our results show a significant improvement on <math alttext="4" class="ltx_Math" display="inline" id="S6.p1.2.m1.1"><semantics id="S6.p1.2.m1.1a"><mn id="S6.p1.2.m1.1.1" xref="S6.p1.2.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S6.p1.2.m1.1b"><cn id="S6.p1.2.m1.1.1.cmml" type="integer" xref="S6.p1.2.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.2.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="S6.p1.2.m1.1d">4</annotation></semantics></math> datasets, from image retrieval to place recognition tasks.
<span class="ltx_text ltx_font_typewriter" id="S6.p1.5.4">AE-SVC</span> demonstrates up to a <math alttext="16\%" class="ltx_Math" display="inline" id="S6.p1.3.m2.1"><semantics id="S6.p1.3.m2.1a"><mrow id="S6.p1.3.m2.1.1" xref="S6.p1.3.m2.1.1.cmml"><mn id="S6.p1.3.m2.1.1.2" xref="S6.p1.3.m2.1.1.2.cmml">16</mn><mo id="S6.p1.3.m2.1.1.1" xref="S6.p1.3.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.3.m2.1b"><apply id="S6.p1.3.m2.1.1.cmml" xref="S6.p1.3.m2.1.1"><csymbol cd="latexml" id="S6.p1.3.m2.1.1.1.cmml" xref="S6.p1.3.m2.1.1.1">percent</csymbol><cn id="S6.p1.3.m2.1.1.2.cmml" type="integer" xref="S6.p1.3.m2.1.1.2">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.3.m2.1c">16\%</annotation><annotation encoding="application/x-llamapun" id="S6.p1.3.m2.1d">16 %</annotation></semantics></math> improvement in retrieval performance, and <span class="ltx_text ltx_font_typewriter" id="S6.p1.4.2">(SS)<sub class="ltx_sub" id="S6.p1.4.2.1"><span class="ltx_text ltx_font_serif" id="S6.p1.4.2.1.1">2</span></sub>D</span> shows an improvement of <math alttext="10\%" class="ltx_Math" display="inline" id="S6.p1.5.m3.1"><semantics id="S6.p1.5.m3.1a"><mrow id="S6.p1.5.m3.1.1" xref="S6.p1.5.m3.1.1.cmml"><mn id="S6.p1.5.m3.1.1.2" xref="S6.p1.5.m3.1.1.2.cmml">10</mn><mo id="S6.p1.5.m3.1.1.1" xref="S6.p1.5.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.5.m3.1b"><apply id="S6.p1.5.m3.1.1.cmml" xref="S6.p1.5.m3.1.1"><csymbol cd="latexml" id="S6.p1.5.m3.1.1.1.cmml" xref="S6.p1.5.m3.1.1.1">percent</csymbol><cn id="S6.p1.5.m3.1.1.2.cmml" type="integer" xref="S6.p1.5.m3.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.5.m3.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S6.p1.5.m3.1d">10 %</annotation></semantics></math> for smaller embedding sizes, which further boosts retrieval efficiency.
Future work includes new retrieval models that orchestrate the variance-aware property in training loss of foundation models.
Although we observe the resulting difference in the cosine similarity distributions of the foundation models and the data set-specific models (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.F3" title="Figure 3 ‣ 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3</span></a>), the fundamental discrepancy between the embedding spaces remains unknown to the community.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Reproducibility Statement</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">In the theoretical analysis section (Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4" title="4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">4</span></a>) of this work, we clearly state all the assumptions as and when necessary. Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS1" title="A.1 Invariance of Orthogonal Transformation ‣ Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">A.1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS2" title="A.2 Cosine Scale Invariance ‣ Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">A.2</span></a> provides additional details necessary to understand the proofs in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4" title="4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">4</span></a>. We also discussed all the hyperparameters in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS6" title="A.6 Hyperparameters ‣ Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">A.6</span></a>. Lastly, we release a reproducible codebase in the supplementary details. The code includes dataloaders, execution code, and links to download all the datasets and models used. We also provide detailed instructions on how to replicate our experiment setup and results, ensuring complete transparency and reproducibility.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ba &amp; Caruana (2014)</span>
<span class="ltx_bibblock">
Jimmy Ba and Rich Caruana.

</span>
<span class="ltx_bibblock">Do deep nets really need to be deep?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Advances in neural information processing systems</em>, pp.  2654–2662, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bardes et al. (2022)</span>
<span class="ltx_bibblock">
Adrien Bardes, Jean Ponce, and Yann LeCun.

</span>
<span class="ltx_bibblock">VICReg: Variance-invariance-covariance regularization for self-supervised learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">International Conference on Learning Representations</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=xm6YD62D1Ub" title="">https://openreview.net/forum?id=xm6YD62D1Ub</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berton et al. (2022)</span>
<span class="ltx_bibblock">
Gabriele Berton, Carlo Masone, and Barbara Caputo.

</span>
<span class="ltx_bibblock">Rethinking visual geo-localization for large-scale applications.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  4878–4888, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Buciluǎ et al. (2006)</span>
<span class="ltx_bibblock">
Cristian Buciluǎ, Rich Caruana, and Alexandru Niculescu-Mizil.

</span>
<span class="ltx_bibblock">Model compression.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the 12th ACM SIGKDD international conference on Knowledge discovery and data mining</em>, pp.  535–541, 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caron et al. (2021)</span>
<span class="ltx_bibblock">
Mathilde Caron, Hugo Touvron, Ishan Misra, Hervé Jégou, Julien Mairal, Piotr Bojanowski, and Armand Joulin.

</span>
<span class="ltx_bibblock">Emerging properties in self-supervised vision transformers, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Community (2023)</span>
<span class="ltx_bibblock">
LAION Community.

</span>
<span class="ltx_bibblock">Laion-2b: A large-scale dataset for multimodal learning.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/datasets/laion/laion2B-en" title="">https://huggingface.co/datasets/laion/laion2B-en</a>, 2023.

</span>
<span class="ltx_bibblock">Accessed: 2024-05-16.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2021)</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, Jakob Uszkoreit, and Neil Houlsby.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at scale, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Garg et al. (2021)</span>
<span class="ltx_bibblock">
Sourav Garg, Tobias Fischer, and Michael Milford.

</span>
<span class="ltx_bibblock">Where is your place, visual place recognition?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">IJCAI</em>, volume 8, pp.  4416–4425, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ge et al. (2020)</span>
<span class="ltx_bibblock">
Yixiao Ge, Haibo Wang, Feng Zhu, Rui Zhao, and Hongsheng Li.

</span>
<span class="ltx_bibblock">Self-supervising fine-grained region similarities for large-scale image localization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part IV 16</em>, pp.  369–386. Springer, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hadsell et al. (2006)</span>
<span class="ltx_bibblock">
Raia Hadsell, Sumit Chopra, and Yann LeCun.

</span>
<span class="ltx_bibblock">Dimensionality reduction by learning an invariant mapping.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">2006 IEEE computer society conference on computer vision and pattern recognition (CVPR’06)</em>, volume 2, pp.  1735–1742. IEEE, 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton et al. (2015)</span>
<span class="ltx_bibblock">
Geoffrey Hinton, Oriol Vinyals, and Jeff Dean.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:1503.02531</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton &amp; Salakhutdinov (2006)</span>
<span class="ltx_bibblock">
Geoffrey E Hinton and Ruslan R Salakhutdinov.

</span>
<span class="ltx_bibblock">Reducing the dimensionality of data with neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Science</em>, 313(5786):504–507, 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Keetha et al. (2023)</span>
<span class="ltx_bibblock">
Nikhil Keetha, Avneesh Mishra, Jay Karhade, Krishna Murthy Jatavallabhula, Sebastian Scherer, Madhava Krishna, and Sourav Garg.

</span>
<span class="ltx_bibblock">Anyloc: Towards universal visual place recognition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2308.00688</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Welling (2013)</span>
<span class="ltx_bibblock">
Diederik P Kingma and Max Welling.

</span>
<span class="ltx_bibblock">Auto-encoding variational bayes.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:1312.6114</em>, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kusupati et al. (2022)</span>
<span class="ltx_bibblock">
Aditya Kusupati, Gantavya Bhatt, Aniket Rege, Matthew Wallingford, Aditya Sinha, Vivek Ramanujan, William Howard-Snyder, Kaifeng Chen, Sham Kakade, Prateek Jain, et al.

</span>
<span class="ltx_bibblock">Matryoshka representation learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>, 35:30233–30249, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leyva-Vallina et al. (2023)</span>
<span class="ltx_bibblock">
María Leyva-Vallina, Nicola Strisciuglio, and Nicolai Petkov.

</span>
<span class="ltx_bibblock">Data-efficient large scale place recognition with graded similarity supervision.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  23487–23496, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Po-han Li, Sravan Kumar Ankireddy, Ruihan Philip Zhao, Hossein Nourkhiz Mahjoub, Ehsan Moradi Pari, Ufuk Topcu, Sandeep Chinchali, and Hyeji Kim.

</span>
<span class="ltx_bibblock">Task-aware distributed source coding under dynamic bandwidth.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Advances in Neural Information Processing Systems</em>, 36, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2016)</span>
<span class="ltx_bibblock">
Ziwei Liu, Ping Luo, Shi Qiu, Xiaogang Wang, and Xiaoou Tang.

</span>
<span class="ltx_bibblock">Deepfashion: Powering robust clothes recognition and retrieval with rich annotations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.  1096–1104, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2024)</span>
<span class="ltx_bibblock">
Feng Lu, Lijun Zhang, Xiangyuan Lan, Shuting Dong, Yaowei Wang, and Chun Yuan.

</span>
<span class="ltx_bibblock">Towards seamless adaptation of pre-trained models for visual place recognition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2402.14505</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh Song et al. (2016)</span>
<span class="ltx_bibblock">
Hyun Oh Song, Yu Xiang, Stefanie Jegelka, and Silvio Savarese.

</span>
<span class="ltx_bibblock">Deep metric learning via lifted structured feature embedding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.  4004–4012, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oquab et al. (2023)</span>
<span class="ltx_bibblock">
Maxime Oquab, Timothée Darcet, Theo Moutakanni, Huy V. Vo, Marc Szafraniec, Vasil Khalidov, Pierre Fernandez, Daniel Haziza, Francisco Massa, Alaaeldin El-Nouby, Russell Howes, Po-Yao Huang, Hu Xu, Vasu Sharma, Shang-Wen Li, Wojciech Galuba, Mike Rabbat, Mido Assran, Nicolas Ballas, Gabriel Synnaeve, Ishan Misra, Herve Jegou, Julien Mairal, Patrick Labatut, Armand Joulin, and Piotr Bojanowski.

</span>
<span class="ltx_bibblock">Lvd-142m: A curated dataset for self-supervised learning.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/facebookresearch/dinov2" title="">https://github.com/facebookresearch/dinov2</a>, 2023.

</span>
<span class="ltx_bibblock">Utilized in the pretraining of DINOv2 models.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oquab et al. (2024)</span>
<span class="ltx_bibblock">
Maxime Oquab, Timothée Darcet, Théo Moutakanni, Huy Vo, Marc Szafraniec, Vasil Khalidov, Pierre Fernandez, Daniel Haziza, Francisco Massa, Alaaeldin El-Nouby, Mahmoud Assran, Nicolas Ballas, Wojciech Galuba, Russell Howes, Po-Yao Huang, Shang-Wen Li, Ishan Misra, Michael Rabbat, Vasu Sharma, Gabriel Synnaeve, Hu Xu, Hervé Jegou, Julien Mairal, Patrick Labatut, Armand Joulin, and Piotr Bojanowski.

</span>
<span class="ltx_bibblock">Dinov2: Learning robust visual features without supervision, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park et al. (2019)</span>
<span class="ltx_bibblock">
Wonpyo Park, Dongju Kim, Yan Lu, and Minsu Cho.

</span>
<span class="ltx_bibblock">Relational knowledge distillation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Passalis &amp; Tefas (2018)</span>
<span class="ltx_bibblock">
Nikolaos Passalis and Anastasios Tefas.

</span>
<span class="ltx_bibblock">Learning deep representations with probabilistic knowledge transfer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the European Conference on Computer Vision (ECCV)</em>, pp.  268–284, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2021)</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language supervision.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">International conference on machine learning</em>, pp.  8748–8763. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Romero et al. (2014)</span>
<span class="ltx_bibblock">
Adriana Romero, Nicolas Ballas, Samira Ebrahimi Kahou, Antoine Chassang, Carlo Gatta, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Fitnets: Hints for thin deep nets.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:1412.6550</em>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Russakovsky et al. (2015)</span>
<span class="ltx_bibblock">
Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause, Sanjeev Satheesh, Sean Ma, Zhiheng Huang, Andrej Karpathy, Aditya Khosla, Michael Bernstein, et al.

</span>
<span class="ltx_bibblock">Imagenet large scale visual recognition challenge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">International journal of computer vision</em>, 115:211–252, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schroff et al. (2015)</span>
<span class="ltx_bibblock">
Florian Schroff, Dmitry Kalenichenko, and James Philbin.

</span>
<span class="ltx_bibblock">Facenet: A unified embedding for face recognition and clustering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.  815–823, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith et al. (2023)</span>
<span class="ltx_bibblock">
Ian Smith, Janosch Ortmann, Farnoosh Abbas-Aghababazadeh, Petr Smirnov, and Benjamin Haibe-Kains.

</span>
<span class="ltx_bibblock">On the distribution of cosine similarity with application to biology.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:2310.13994</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sohn (2016)</span>
<span class="ltx_bibblock">
Kihyuk Sohn.

</span>
<span class="ltx_bibblock">Improved deep metric learning with multi-class n-pair loss objective.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Advances in neural information processing systems</em>, 29, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2016)</span>
<span class="ltx_bibblock">
Hyun Oh Song, Yu Xiang, Stefanie Jegelka, and Silvio Savarese.

</span>
<span class="ltx_bibblock">Deep metric learning via lifted structured feature embedding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al. (2020)</span>
<span class="ltx_bibblock">
Yonglong Tian, Dilip Krishnan, and Phillip Isola.

</span>
<span class="ltx_bibblock">Contrastive representation distillation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">International Conference on Learning Representations (ICLR)</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Torii et al. (2013)</span>
<span class="ltx_bibblock">
Akihiko Torii, Josef Sivic, Tomas Pajdla, and Masatoshi Okutomi.

</span>
<span class="ltx_bibblock">Visual place recognition with repetitive structures.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.  883–890, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Torii et al. (2015)</span>
<span class="ltx_bibblock">
Akihiko Torii, Relja Arandjelovic, Josef Sivic, Masatoshi Okutomi, and Tomas Pajdla.

</span>
<span class="ltx_bibblock">24/7 place recognition by view synthesis.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.  1808–1817, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tung &amp; Mori (2019)</span>
<span class="ltx_bibblock">
Frederick Tung and Greg Mori.

</span>
<span class="ltx_bibblock">Similarity-preserving knowledge distillation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the IEEE International Conference on Computer Vision (ICCV)</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ustinova &amp; Lempitsky (2016)</span>
<span class="ltx_bibblock">
Evgeniya Ustinova and Victor Lempitsky.

</span>
<span class="ltx_bibblock">Learning deep embeddings with histogram loss.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Advances in neural information processing systems</em>, 29, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2017)</span>
<span class="ltx_bibblock">
Jiang Wang, Yang Song, Thomas Leung, Chuck Rosenberg, Jingbin Wang, James Philbin, Bo Chen, and Ying Wu.

</span>
<span class="ltx_bibblock">Deep metric learning: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:1706.09720</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Xun Wang, Xintong Han, Weilin Huang, Dengke Dong, and Matthew R Scott.

</span>
<span class="ltx_bibblock">Multi-similarity loss with general pair weighting for deep metric learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pp.  5022–5030, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2022)</span>
<span class="ltx_bibblock">
Hui Wu, Min Wang, Wengang Zhou, Houqiang Li, and Qi Tian.

</span>
<span class="ltx_bibblock">Contextual similarity distillation for asymmetric image retrieval.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  9489–9498, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2023)</span>
<span class="ltx_bibblock">
Jiuhong Xiao, Gao Zhu, and Giuseppe Loianno.

</span>
<span class="ltx_bibblock">Visual geo-localization with self-supervised representation learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2308.00090</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zagoruyko &amp; Komodakis (2017)</span>
<span class="ltx_bibblock">
Sergey Zagoruyko and Nikos Komodakis.

</span>
<span class="ltx_bibblock">Paying more attention to attention: Improving the performance of convolutional neural networks via attention transfer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">International Conference on Learning Representations (ICLR)</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zbontar et al. (2021)</span>
<span class="ltx_bibblock">
Jure Zbontar, Li Jing, Ishan Misra, Yann LeCun, and Stéphane Deny.

</span>
<span class="ltx_bibblock">Barlow twins: Self-supervised learning via redundancy reduction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">International conference on machine learning</em>, pp.  12310–12320. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2019)</span>
<span class="ltx_bibblock">
Chiyuan Zhang, Samy Bengio, Moritz Hardt, Benjamin Recht, and Oriol Vinyals.

</span>
<span class="ltx_bibblock">Your classifier is secretly an energy based model and you should treat it like one.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">International Conference on Learning Representations (ICLR)</em>, 2019.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Invariance of Orthogonal Transformation</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">We show that cosine similarity is invariant to orthogonal transformation.
Define <math alttext="T_{\mathrm{orth}}\in\{T:T^{\top}T=\mathbf{I}\}" class="ltx_Math" display="inline" id="A1.SS1.p1.1.m1.2"><semantics id="A1.SS1.p1.1.m1.2a"><mrow id="A1.SS1.p1.1.m1.2.2" xref="A1.SS1.p1.1.m1.2.2.cmml"><msub id="A1.SS1.p1.1.m1.2.2.3" xref="A1.SS1.p1.1.m1.2.2.3.cmml"><mi id="A1.SS1.p1.1.m1.2.2.3.2" xref="A1.SS1.p1.1.m1.2.2.3.2.cmml">T</mi><mi id="A1.SS1.p1.1.m1.2.2.3.3" xref="A1.SS1.p1.1.m1.2.2.3.3.cmml">orth</mi></msub><mo id="A1.SS1.p1.1.m1.2.2.2" xref="A1.SS1.p1.1.m1.2.2.2.cmml">∈</mo><mrow id="A1.SS1.p1.1.m1.2.2.1.1" xref="A1.SS1.p1.1.m1.2.2.1.2.cmml"><mo id="A1.SS1.p1.1.m1.2.2.1.1.2" stretchy="false" xref="A1.SS1.p1.1.m1.2.2.1.2.1.cmml">{</mo><mi id="A1.SS1.p1.1.m1.1.1" xref="A1.SS1.p1.1.m1.1.1.cmml">T</mi><mo id="A1.SS1.p1.1.m1.2.2.1.1.3" lspace="0.278em" rspace="0.278em" xref="A1.SS1.p1.1.m1.2.2.1.2.1.cmml">:</mo><mrow id="A1.SS1.p1.1.m1.2.2.1.1.1" xref="A1.SS1.p1.1.m1.2.2.1.1.1.cmml"><mrow id="A1.SS1.p1.1.m1.2.2.1.1.1.2" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2.cmml"><msup id="A1.SS1.p1.1.m1.2.2.1.1.1.2.2" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2.2.cmml"><mi id="A1.SS1.p1.1.m1.2.2.1.1.1.2.2.2" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2.2.2.cmml">T</mi><mo id="A1.SS1.p1.1.m1.2.2.1.1.1.2.2.3" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2.2.3.cmml">⊤</mo></msup><mo id="A1.SS1.p1.1.m1.2.2.1.1.1.2.1" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2.1.cmml">⁢</mo><mi id="A1.SS1.p1.1.m1.2.2.1.1.1.2.3" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2.3.cmml">T</mi></mrow><mo id="A1.SS1.p1.1.m1.2.2.1.1.1.1" xref="A1.SS1.p1.1.m1.2.2.1.1.1.1.cmml">=</mo><mi id="A1.SS1.p1.1.m1.2.2.1.1.1.3" xref="A1.SS1.p1.1.m1.2.2.1.1.1.3.cmml">𝐈</mi></mrow><mo id="A1.SS1.p1.1.m1.2.2.1.1.4" stretchy="false" xref="A1.SS1.p1.1.m1.2.2.1.2.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p1.1.m1.2b"><apply id="A1.SS1.p1.1.m1.2.2.cmml" xref="A1.SS1.p1.1.m1.2.2"><in id="A1.SS1.p1.1.m1.2.2.2.cmml" xref="A1.SS1.p1.1.m1.2.2.2"></in><apply id="A1.SS1.p1.1.m1.2.2.3.cmml" xref="A1.SS1.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.2.2.3.1.cmml" xref="A1.SS1.p1.1.m1.2.2.3">subscript</csymbol><ci id="A1.SS1.p1.1.m1.2.2.3.2.cmml" xref="A1.SS1.p1.1.m1.2.2.3.2">𝑇</ci><ci id="A1.SS1.p1.1.m1.2.2.3.3.cmml" xref="A1.SS1.p1.1.m1.2.2.3.3">orth</ci></apply><apply id="A1.SS1.p1.1.m1.2.2.1.2.cmml" xref="A1.SS1.p1.1.m1.2.2.1.1"><csymbol cd="latexml" id="A1.SS1.p1.1.m1.2.2.1.2.1.cmml" xref="A1.SS1.p1.1.m1.2.2.1.1.2">conditional-set</csymbol><ci id="A1.SS1.p1.1.m1.1.1.cmml" xref="A1.SS1.p1.1.m1.1.1">𝑇</ci><apply id="A1.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="A1.SS1.p1.1.m1.2.2.1.1.1"><eq id="A1.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="A1.SS1.p1.1.m1.2.2.1.1.1.1"></eq><apply id="A1.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2"><times id="A1.SS1.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2.1"></times><apply id="A1.SS1.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.p1.1.m1.2.2.1.1.1.2.2.1.cmml" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2.2">superscript</csymbol><ci id="A1.SS1.p1.1.m1.2.2.1.1.1.2.2.2.cmml" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2.2.2">𝑇</ci><csymbol cd="latexml" id="A1.SS1.p1.1.m1.2.2.1.1.1.2.2.3.cmml" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2.2.3">top</csymbol></apply><ci id="A1.SS1.p1.1.m1.2.2.1.1.1.2.3.cmml" xref="A1.SS1.p1.1.m1.2.2.1.1.1.2.3">𝑇</ci></apply><ci id="A1.SS1.p1.1.m1.2.2.1.1.1.3.cmml" xref="A1.SS1.p1.1.m1.2.2.1.1.1.3">𝐈</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p1.1.m1.2c">T_{\mathrm{orth}}\in\{T:T^{\top}T=\mathbf{I}\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS1.p1.1.m1.2d">italic_T start_POSTSUBSCRIPT roman_orth end_POSTSUBSCRIPT ∈ { italic_T : italic_T start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_T = bold_I }</annotation></semantics></math> as an orthogonal transformation.
Following equation <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.E9" title="In 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">9</span></a>, we see that</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A1.E15">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E15X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cos(T_{\mathrm{orth}}X,T_{\mathrm{orth}}Y)" class="ltx_Math" display="inline" id="A1.E15X.2.1.1.m1.3"><semantics id="A1.E15X.2.1.1.m1.3a"><mrow id="A1.E15X.2.1.1.m1.3.3.2" xref="A1.E15X.2.1.1.m1.3.3.3.cmml"><mi id="A1.E15X.2.1.1.m1.1.1" xref="A1.E15X.2.1.1.m1.1.1.cmml">cos</mi><mo id="A1.E15X.2.1.1.m1.3.3.2a" xref="A1.E15X.2.1.1.m1.3.3.3.cmml">⁡</mo><mrow id="A1.E15X.2.1.1.m1.3.3.2.2" xref="A1.E15X.2.1.1.m1.3.3.3.cmml"><mo id="A1.E15X.2.1.1.m1.3.3.2.2.3" stretchy="false" xref="A1.E15X.2.1.1.m1.3.3.3.cmml">(</mo><mrow id="A1.E15X.2.1.1.m1.2.2.1.1.1" xref="A1.E15X.2.1.1.m1.2.2.1.1.1.cmml"><msub id="A1.E15X.2.1.1.m1.2.2.1.1.1.2" xref="A1.E15X.2.1.1.m1.2.2.1.1.1.2.cmml"><mi id="A1.E15X.2.1.1.m1.2.2.1.1.1.2.2" xref="A1.E15X.2.1.1.m1.2.2.1.1.1.2.2.cmml">T</mi><mi id="A1.E15X.2.1.1.m1.2.2.1.1.1.2.3" xref="A1.E15X.2.1.1.m1.2.2.1.1.1.2.3.cmml">orth</mi></msub><mo id="A1.E15X.2.1.1.m1.2.2.1.1.1.1" xref="A1.E15X.2.1.1.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="A1.E15X.2.1.1.m1.2.2.1.1.1.3" xref="A1.E15X.2.1.1.m1.2.2.1.1.1.3.cmml">X</mi></mrow><mo id="A1.E15X.2.1.1.m1.3.3.2.2.4" xref="A1.E15X.2.1.1.m1.3.3.3.cmml">,</mo><mrow id="A1.E15X.2.1.1.m1.3.3.2.2.2" xref="A1.E15X.2.1.1.m1.3.3.2.2.2.cmml"><msub id="A1.E15X.2.1.1.m1.3.3.2.2.2.2" xref="A1.E15X.2.1.1.m1.3.3.2.2.2.2.cmml"><mi id="A1.E15X.2.1.1.m1.3.3.2.2.2.2.2" xref="A1.E15X.2.1.1.m1.3.3.2.2.2.2.2.cmml">T</mi><mi id="A1.E15X.2.1.1.m1.3.3.2.2.2.2.3" xref="A1.E15X.2.1.1.m1.3.3.2.2.2.2.3.cmml">orth</mi></msub><mo id="A1.E15X.2.1.1.m1.3.3.2.2.2.1" xref="A1.E15X.2.1.1.m1.3.3.2.2.2.1.cmml">⁢</mo><mi id="A1.E15X.2.1.1.m1.3.3.2.2.2.3" xref="A1.E15X.2.1.1.m1.3.3.2.2.2.3.cmml">Y</mi></mrow><mo id="A1.E15X.2.1.1.m1.3.3.2.2.5" stretchy="false" xref="A1.E15X.2.1.1.m1.3.3.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E15X.2.1.1.m1.3b"><apply id="A1.E15X.2.1.1.m1.3.3.3.cmml" xref="A1.E15X.2.1.1.m1.3.3.2"><cos id="A1.E15X.2.1.1.m1.1.1.cmml" xref="A1.E15X.2.1.1.m1.1.1"></cos><apply id="A1.E15X.2.1.1.m1.2.2.1.1.1.cmml" xref="A1.E15X.2.1.1.m1.2.2.1.1.1"><times id="A1.E15X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="A1.E15X.2.1.1.m1.2.2.1.1.1.1"></times><apply id="A1.E15X.2.1.1.m1.2.2.1.1.1.2.cmml" xref="A1.E15X.2.1.1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E15X.2.1.1.m1.2.2.1.1.1.2.1.cmml" xref="A1.E15X.2.1.1.m1.2.2.1.1.1.2">subscript</csymbol><ci id="A1.E15X.2.1.1.m1.2.2.1.1.1.2.2.cmml" xref="A1.E15X.2.1.1.m1.2.2.1.1.1.2.2">𝑇</ci><ci id="A1.E15X.2.1.1.m1.2.2.1.1.1.2.3.cmml" xref="A1.E15X.2.1.1.m1.2.2.1.1.1.2.3">orth</ci></apply><ci id="A1.E15X.2.1.1.m1.2.2.1.1.1.3.cmml" xref="A1.E15X.2.1.1.m1.2.2.1.1.1.3">𝑋</ci></apply><apply id="A1.E15X.2.1.1.m1.3.3.2.2.2.cmml" xref="A1.E15X.2.1.1.m1.3.3.2.2.2"><times id="A1.E15X.2.1.1.m1.3.3.2.2.2.1.cmml" xref="A1.E15X.2.1.1.m1.3.3.2.2.2.1"></times><apply id="A1.E15X.2.1.1.m1.3.3.2.2.2.2.cmml" xref="A1.E15X.2.1.1.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="A1.E15X.2.1.1.m1.3.3.2.2.2.2.1.cmml" xref="A1.E15X.2.1.1.m1.3.3.2.2.2.2">subscript</csymbol><ci id="A1.E15X.2.1.1.m1.3.3.2.2.2.2.2.cmml" xref="A1.E15X.2.1.1.m1.3.3.2.2.2.2.2">𝑇</ci><ci id="A1.E15X.2.1.1.m1.3.3.2.2.2.2.3.cmml" xref="A1.E15X.2.1.1.m1.3.3.2.2.2.2.3">orth</ci></apply><ci id="A1.E15X.2.1.1.m1.3.3.2.2.2.3.cmml" xref="A1.E15X.2.1.1.m1.3.3.2.2.2.3">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15X.2.1.1.m1.3c">\displaystyle\cos(T_{\mathrm{orth}}X,T_{\mathrm{orth}}Y)</annotation><annotation encoding="application/x-llamapun" id="A1.E15X.2.1.1.m1.3d">roman_cos ( italic_T start_POSTSUBSCRIPT roman_orth end_POSTSUBSCRIPT italic_X , italic_T start_POSTSUBSCRIPT roman_orth end_POSTSUBSCRIPT italic_Y )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\left(T_{\mathrm{orth}}X\right)^{\top}T_{\mathrm{orth}}Y}{%
\|T_{\mathrm{orth}}X\|\|T_{\mathrm{orth}}Y\|}" class="ltx_Math" display="inline" id="A1.E15X.3.2.2.m1.3"><semantics id="A1.E15X.3.2.2.m1.3a"><mrow id="A1.E15X.3.2.2.m1.3.4" xref="A1.E15X.3.2.2.m1.3.4.cmml"><mi id="A1.E15X.3.2.2.m1.3.4.2" xref="A1.E15X.3.2.2.m1.3.4.2.cmml"></mi><mo id="A1.E15X.3.2.2.m1.3.4.1" xref="A1.E15X.3.2.2.m1.3.4.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E15X.3.2.2.m1.3.3" xref="A1.E15X.3.2.2.m1.3.3.cmml"><mfrac id="A1.E15X.3.2.2.m1.3.3a" xref="A1.E15X.3.2.2.m1.3.3.cmml"><mrow id="A1.E15X.3.2.2.m1.1.1.1" xref="A1.E15X.3.2.2.m1.1.1.1.cmml"><msup id="A1.E15X.3.2.2.m1.1.1.1.1" xref="A1.E15X.3.2.2.m1.1.1.1.1.cmml"><mrow id="A1.E15X.3.2.2.m1.1.1.1.1.1.1" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.2" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.cmml"><msub id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml"><mi id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.2" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml">T</mi><mi id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.3" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml">orth</mi></msub><mo id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml">X</mi></mrow><mo id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.3" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="A1.E15X.3.2.2.m1.1.1.1.1.3" xref="A1.E15X.3.2.2.m1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="A1.E15X.3.2.2.m1.1.1.1.2" xref="A1.E15X.3.2.2.m1.1.1.1.2.cmml">⁢</mo><msub id="A1.E15X.3.2.2.m1.1.1.1.3" xref="A1.E15X.3.2.2.m1.1.1.1.3.cmml"><mi id="A1.E15X.3.2.2.m1.1.1.1.3.2" xref="A1.E15X.3.2.2.m1.1.1.1.3.2.cmml">T</mi><mi id="A1.E15X.3.2.2.m1.1.1.1.3.3" xref="A1.E15X.3.2.2.m1.1.1.1.3.3.cmml">orth</mi></msub><mo id="A1.E15X.3.2.2.m1.1.1.1.2a" xref="A1.E15X.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mi id="A1.E15X.3.2.2.m1.1.1.1.4" xref="A1.E15X.3.2.2.m1.1.1.1.4.cmml">Y</mi></mrow><mrow id="A1.E15X.3.2.2.m1.3.3.3" xref="A1.E15X.3.2.2.m1.3.3.3.cmml"><mrow id="A1.E15X.3.2.2.m1.2.2.2.1.1" xref="A1.E15X.3.2.2.m1.2.2.2.1.2.cmml"><mo id="A1.E15X.3.2.2.m1.2.2.2.1.1.2" stretchy="false" xref="A1.E15X.3.2.2.m1.2.2.2.1.2.1.cmml">‖</mo><mrow id="A1.E15X.3.2.2.m1.2.2.2.1.1.1" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1.cmml"><msub id="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2.cmml"><mi id="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2.2" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2.2.cmml">T</mi><mi id="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2.3" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2.3.cmml">orth</mi></msub><mo id="A1.E15X.3.2.2.m1.2.2.2.1.1.1.1" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="A1.E15X.3.2.2.m1.2.2.2.1.1.1.3" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1.3.cmml">X</mi></mrow><mo id="A1.E15X.3.2.2.m1.2.2.2.1.1.3" stretchy="false" xref="A1.E15X.3.2.2.m1.2.2.2.1.2.1.cmml">‖</mo></mrow><mo id="A1.E15X.3.2.2.m1.3.3.3.3" xref="A1.E15X.3.2.2.m1.3.3.3.3.cmml">⁢</mo><mrow id="A1.E15X.3.2.2.m1.3.3.3.2.1" xref="A1.E15X.3.2.2.m1.3.3.3.2.2.cmml"><mo id="A1.E15X.3.2.2.m1.3.3.3.2.1.2" stretchy="false" xref="A1.E15X.3.2.2.m1.3.3.3.2.2.1.cmml">‖</mo><mrow id="A1.E15X.3.2.2.m1.3.3.3.2.1.1" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1.cmml"><msub id="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2.cmml"><mi id="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2.2" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2.2.cmml">T</mi><mi id="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2.3" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2.3.cmml">orth</mi></msub><mo id="A1.E15X.3.2.2.m1.3.3.3.2.1.1.1" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1.1.cmml">⁢</mo><mi id="A1.E15X.3.2.2.m1.3.3.3.2.1.1.3" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1.3.cmml">Y</mi></mrow><mo id="A1.E15X.3.2.2.m1.3.3.3.2.1.3" stretchy="false" xref="A1.E15X.3.2.2.m1.3.3.3.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E15X.3.2.2.m1.3b"><apply id="A1.E15X.3.2.2.m1.3.4.cmml" xref="A1.E15X.3.2.2.m1.3.4"><eq id="A1.E15X.3.2.2.m1.3.4.1.cmml" xref="A1.E15X.3.2.2.m1.3.4.1"></eq><csymbol cd="latexml" id="A1.E15X.3.2.2.m1.3.4.2.cmml" xref="A1.E15X.3.2.2.m1.3.4.2">absent</csymbol><apply id="A1.E15X.3.2.2.m1.3.3.cmml" xref="A1.E15X.3.2.2.m1.3.3"><divide id="A1.E15X.3.2.2.m1.3.3.4.cmml" xref="A1.E15X.3.2.2.m1.3.3"></divide><apply id="A1.E15X.3.2.2.m1.1.1.1.cmml" xref="A1.E15X.3.2.2.m1.1.1.1"><times id="A1.E15X.3.2.2.m1.1.1.1.2.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.2"></times><apply id="A1.E15X.3.2.2.m1.1.1.1.1.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E15X.3.2.2.m1.1.1.1.1.2.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.1">superscript</csymbol><apply id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1"><times id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.1"></times><apply id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.2">𝑇</ci><ci id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.2.3">orth</ci></apply><ci id="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.1.1.1.1.3">𝑋</ci></apply><csymbol cd="latexml" id="A1.E15X.3.2.2.m1.1.1.1.1.3.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.1.3">top</csymbol></apply><apply id="A1.E15X.3.2.2.m1.1.1.1.3.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E15X.3.2.2.m1.1.1.1.3.1.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.3">subscript</csymbol><ci id="A1.E15X.3.2.2.m1.1.1.1.3.2.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.3.2">𝑇</ci><ci id="A1.E15X.3.2.2.m1.1.1.1.3.3.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.3.3">orth</ci></apply><ci id="A1.E15X.3.2.2.m1.1.1.1.4.cmml" xref="A1.E15X.3.2.2.m1.1.1.1.4">𝑌</ci></apply><apply id="A1.E15X.3.2.2.m1.3.3.3.cmml" xref="A1.E15X.3.2.2.m1.3.3.3"><times id="A1.E15X.3.2.2.m1.3.3.3.3.cmml" xref="A1.E15X.3.2.2.m1.3.3.3.3"></times><apply id="A1.E15X.3.2.2.m1.2.2.2.1.2.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.1.1"><csymbol cd="latexml" id="A1.E15X.3.2.2.m1.2.2.2.1.2.1.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.2">norm</csymbol><apply id="A1.E15X.3.2.2.m1.2.2.2.1.1.1.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1"><times id="A1.E15X.3.2.2.m1.2.2.2.1.1.1.1.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1.1"></times><apply id="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2.1.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2">subscript</csymbol><ci id="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2.2.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2.2">𝑇</ci><ci id="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2.3.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1.2.3">orth</ci></apply><ci id="A1.E15X.3.2.2.m1.2.2.2.1.1.1.3.cmml" xref="A1.E15X.3.2.2.m1.2.2.2.1.1.1.3">𝑋</ci></apply></apply><apply id="A1.E15X.3.2.2.m1.3.3.3.2.2.cmml" xref="A1.E15X.3.2.2.m1.3.3.3.2.1"><csymbol cd="latexml" id="A1.E15X.3.2.2.m1.3.3.3.2.2.1.cmml" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.2">norm</csymbol><apply id="A1.E15X.3.2.2.m1.3.3.3.2.1.1.cmml" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1"><times id="A1.E15X.3.2.2.m1.3.3.3.2.1.1.1.cmml" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1.1"></times><apply id="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2.cmml" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2"><csymbol cd="ambiguous" id="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2.1.cmml" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2">subscript</csymbol><ci id="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2.2.cmml" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2.2">𝑇</ci><ci id="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2.3.cmml" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1.2.3">orth</ci></apply><ci id="A1.E15X.3.2.2.m1.3.3.3.2.1.1.3.cmml" xref="A1.E15X.3.2.2.m1.3.3.3.2.1.1.3">𝑌</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15X.3.2.2.m1.3c">\displaystyle=\frac{\left(T_{\mathrm{orth}}X\right)^{\top}T_{\mathrm{orth}}Y}{%
\|T_{\mathrm{orth}}X\|\|T_{\mathrm{orth}}Y\|}</annotation><annotation encoding="application/x-llamapun" id="A1.E15X.3.2.2.m1.3d">= divide start_ARG ( italic_T start_POSTSUBSCRIPT roman_orth end_POSTSUBSCRIPT italic_X ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_T start_POSTSUBSCRIPT roman_orth end_POSTSUBSCRIPT italic_Y end_ARG start_ARG ∥ italic_T start_POSTSUBSCRIPT roman_orth end_POSTSUBSCRIPT italic_X ∥ ∥ italic_T start_POSTSUBSCRIPT roman_orth end_POSTSUBSCRIPT italic_Y ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="4"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(15)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E15Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{X^{\top}\mathbf{I}Y}{\sqrt{X^{\top}\mathbf{I}X}\sqrt{Y^{%
\top}\mathbf{I}Y}}" class="ltx_Math" display="inline" id="A1.E15Xa.2.1.1.m1.1"><semantics id="A1.E15Xa.2.1.1.m1.1a"><mrow id="A1.E15Xa.2.1.1.m1.1.1" xref="A1.E15Xa.2.1.1.m1.1.1.cmml"><mi id="A1.E15Xa.2.1.1.m1.1.1.2" xref="A1.E15Xa.2.1.1.m1.1.1.2.cmml"></mi><mo id="A1.E15Xa.2.1.1.m1.1.1.1" xref="A1.E15Xa.2.1.1.m1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E15Xa.2.1.1.m1.1.1.3" xref="A1.E15Xa.2.1.1.m1.1.1.3.cmml"><mfrac id="A1.E15Xa.2.1.1.m1.1.1.3a" xref="A1.E15Xa.2.1.1.m1.1.1.3.cmml"><mrow id="A1.E15Xa.2.1.1.m1.1.1.3.2" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.cmml"><msup id="A1.E15Xa.2.1.1.m1.1.1.3.2.2" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.2.cmml"><mi id="A1.E15Xa.2.1.1.m1.1.1.3.2.2.2" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.2.2.cmml">X</mi><mo id="A1.E15Xa.2.1.1.m1.1.1.3.2.2.3" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.2.3.cmml">⊤</mo></msup><mo id="A1.E15Xa.2.1.1.m1.1.1.3.2.1" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="A1.E15Xa.2.1.1.m1.1.1.3.2.3" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.3.cmml">𝐈</mi><mo id="A1.E15Xa.2.1.1.m1.1.1.3.2.1a" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="A1.E15Xa.2.1.1.m1.1.1.3.2.4" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.4.cmml">Y</mi></mrow><mrow id="A1.E15Xa.2.1.1.m1.1.1.3.3" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.cmml"><msqrt id="A1.E15Xa.2.1.1.m1.1.1.3.3.2" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.cmml"><mrow id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.cmml"><msup id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2.cmml"><mi id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2.2" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2.2.cmml">X</mi><mo id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2.3" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2.3.cmml">⊤</mo></msup><mo id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.1" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.1.cmml">⁢</mo><mi id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.3" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.3.cmml">𝐈</mi><mo id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.1a" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.1.cmml">⁢</mo><mi id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.4" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.4.cmml">X</mi></mrow></msqrt><mo id="A1.E15Xa.2.1.1.m1.1.1.3.3.1" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.1.cmml">⁢</mo><msqrt id="A1.E15Xa.2.1.1.m1.1.1.3.3.3" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.cmml"><mrow id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.cmml"><msup id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2.cmml"><mi id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2.2" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2.2.cmml">Y</mi><mo id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2.3" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2.3.cmml">⊤</mo></msup><mo id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.1" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.1.cmml">⁢</mo><mi id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.3" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.3.cmml">𝐈</mi><mo id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.1a" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.1.cmml">⁢</mo><mi id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.4" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.4.cmml">Y</mi></mrow></msqrt></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E15Xa.2.1.1.m1.1b"><apply id="A1.E15Xa.2.1.1.m1.1.1.cmml" xref="A1.E15Xa.2.1.1.m1.1.1"><eq id="A1.E15Xa.2.1.1.m1.1.1.1.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.1"></eq><csymbol cd="latexml" id="A1.E15Xa.2.1.1.m1.1.1.2.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.2">absent</csymbol><apply id="A1.E15Xa.2.1.1.m1.1.1.3.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3"><divide id="A1.E15Xa.2.1.1.m1.1.1.3.1.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3"></divide><apply id="A1.E15Xa.2.1.1.m1.1.1.3.2.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.2"><times id="A1.E15Xa.2.1.1.m1.1.1.3.2.1.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.1"></times><apply id="A1.E15Xa.2.1.1.m1.1.1.3.2.2.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="A1.E15Xa.2.1.1.m1.1.1.3.2.2.1.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.2">superscript</csymbol><ci id="A1.E15Xa.2.1.1.m1.1.1.3.2.2.2.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.2.2">𝑋</ci><csymbol cd="latexml" id="A1.E15Xa.2.1.1.m1.1.1.3.2.2.3.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.2.3">top</csymbol></apply><ci id="A1.E15Xa.2.1.1.m1.1.1.3.2.3.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.3">𝐈</ci><ci id="A1.E15Xa.2.1.1.m1.1.1.3.2.4.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.2.4">𝑌</ci></apply><apply id="A1.E15Xa.2.1.1.m1.1.1.3.3.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3"><times id="A1.E15Xa.2.1.1.m1.1.1.3.3.1.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.1"></times><apply id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2"><root id="A1.E15Xa.2.1.1.m1.1.1.3.3.2a.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2"></root><apply id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2"><times id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.1.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.1"></times><apply id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2.1.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2">superscript</csymbol><ci id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2.2.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2.2">𝑋</ci><csymbol cd="latexml" id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2.3.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.2.3">top</csymbol></apply><ci id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.3.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.3">𝐈</ci><ci id="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.4.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.2.2.4">𝑋</ci></apply></apply><apply id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3"><root id="A1.E15Xa.2.1.1.m1.1.1.3.3.3a.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3"></root><apply id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2"><times id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.1.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.1"></times><apply id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2.1.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2">superscript</csymbol><ci id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2.2.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2.2">𝑌</ci><csymbol cd="latexml" id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2.3.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.2.3">top</csymbol></apply><ci id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.3.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.3">𝐈</ci><ci id="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.4.cmml" xref="A1.E15Xa.2.1.1.m1.1.1.3.3.3.2.4">𝑌</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15Xa.2.1.1.m1.1c">\displaystyle=\frac{X^{\top}\mathbf{I}Y}{\sqrt{X^{\top}\mathbf{I}X}\sqrt{Y^{%
\top}\mathbf{I}Y}}</annotation><annotation encoding="application/x-llamapun" id="A1.E15Xa.2.1.1.m1.1d">= divide start_ARG italic_X start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_I italic_Y end_ARG start_ARG square-root start_ARG italic_X start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_I italic_X end_ARG square-root start_ARG italic_Y start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT bold_I italic_Y end_ARG end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E15Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{X^{\top}Y}{\|X\|\|Y\|}" class="ltx_Math" display="inline" id="A1.E15Xb.2.1.1.m1.2"><semantics id="A1.E15Xb.2.1.1.m1.2a"><mrow id="A1.E15Xb.2.1.1.m1.2.3" xref="A1.E15Xb.2.1.1.m1.2.3.cmml"><mi id="A1.E15Xb.2.1.1.m1.2.3.2" xref="A1.E15Xb.2.1.1.m1.2.3.2.cmml"></mi><mo id="A1.E15Xb.2.1.1.m1.2.3.1" xref="A1.E15Xb.2.1.1.m1.2.3.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E15Xb.2.1.1.m1.2.2" xref="A1.E15Xb.2.1.1.m1.2.2.cmml"><mfrac id="A1.E15Xb.2.1.1.m1.2.2a" xref="A1.E15Xb.2.1.1.m1.2.2.cmml"><mrow id="A1.E15Xb.2.1.1.m1.2.2.4" xref="A1.E15Xb.2.1.1.m1.2.2.4.cmml"><msup id="A1.E15Xb.2.1.1.m1.2.2.4.2" xref="A1.E15Xb.2.1.1.m1.2.2.4.2.cmml"><mi id="A1.E15Xb.2.1.1.m1.2.2.4.2.2" xref="A1.E15Xb.2.1.1.m1.2.2.4.2.2.cmml">X</mi><mo id="A1.E15Xb.2.1.1.m1.2.2.4.2.3" xref="A1.E15Xb.2.1.1.m1.2.2.4.2.3.cmml">⊤</mo></msup><mo id="A1.E15Xb.2.1.1.m1.2.2.4.1" xref="A1.E15Xb.2.1.1.m1.2.2.4.1.cmml">⁢</mo><mi id="A1.E15Xb.2.1.1.m1.2.2.4.3" xref="A1.E15Xb.2.1.1.m1.2.2.4.3.cmml">Y</mi></mrow><mrow id="A1.E15Xb.2.1.1.m1.2.2.2" xref="A1.E15Xb.2.1.1.m1.2.2.2.cmml"><mrow id="A1.E15Xb.2.1.1.m1.2.2.2.4.2" xref="A1.E15Xb.2.1.1.m1.2.2.2.4.1.cmml"><mo id="A1.E15Xb.2.1.1.m1.2.2.2.4.2.1" stretchy="false" xref="A1.E15Xb.2.1.1.m1.2.2.2.4.1.1.cmml">‖</mo><mi id="A1.E15Xb.2.1.1.m1.1.1.1.1" xref="A1.E15Xb.2.1.1.m1.1.1.1.1.cmml">X</mi><mo id="A1.E15Xb.2.1.1.m1.2.2.2.4.2.2" stretchy="false" xref="A1.E15Xb.2.1.1.m1.2.2.2.4.1.1.cmml">‖</mo></mrow><mo id="A1.E15Xb.2.1.1.m1.2.2.2.3" xref="A1.E15Xb.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.E15Xb.2.1.1.m1.2.2.2.5.2" xref="A1.E15Xb.2.1.1.m1.2.2.2.5.1.cmml"><mo id="A1.E15Xb.2.1.1.m1.2.2.2.5.2.1" stretchy="false" xref="A1.E15Xb.2.1.1.m1.2.2.2.5.1.1.cmml">‖</mo><mi id="A1.E15Xb.2.1.1.m1.2.2.2.2" xref="A1.E15Xb.2.1.1.m1.2.2.2.2.cmml">Y</mi><mo id="A1.E15Xb.2.1.1.m1.2.2.2.5.2.2" stretchy="false" xref="A1.E15Xb.2.1.1.m1.2.2.2.5.1.1.cmml">‖</mo></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E15Xb.2.1.1.m1.2b"><apply id="A1.E15Xb.2.1.1.m1.2.3.cmml" xref="A1.E15Xb.2.1.1.m1.2.3"><eq id="A1.E15Xb.2.1.1.m1.2.3.1.cmml" xref="A1.E15Xb.2.1.1.m1.2.3.1"></eq><csymbol cd="latexml" id="A1.E15Xb.2.1.1.m1.2.3.2.cmml" xref="A1.E15Xb.2.1.1.m1.2.3.2">absent</csymbol><apply id="A1.E15Xb.2.1.1.m1.2.2.cmml" xref="A1.E15Xb.2.1.1.m1.2.2"><divide id="A1.E15Xb.2.1.1.m1.2.2.3.cmml" xref="A1.E15Xb.2.1.1.m1.2.2"></divide><apply id="A1.E15Xb.2.1.1.m1.2.2.4.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.4"><times id="A1.E15Xb.2.1.1.m1.2.2.4.1.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.4.1"></times><apply id="A1.E15Xb.2.1.1.m1.2.2.4.2.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.4.2"><csymbol cd="ambiguous" id="A1.E15Xb.2.1.1.m1.2.2.4.2.1.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.4.2">superscript</csymbol><ci id="A1.E15Xb.2.1.1.m1.2.2.4.2.2.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.4.2.2">𝑋</ci><csymbol cd="latexml" id="A1.E15Xb.2.1.1.m1.2.2.4.2.3.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.4.2.3">top</csymbol></apply><ci id="A1.E15Xb.2.1.1.m1.2.2.4.3.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.4.3">𝑌</ci></apply><apply id="A1.E15Xb.2.1.1.m1.2.2.2.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2"><times id="A1.E15Xb.2.1.1.m1.2.2.2.3.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.3"></times><apply id="A1.E15Xb.2.1.1.m1.2.2.2.4.1.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.4.2"><csymbol cd="latexml" id="A1.E15Xb.2.1.1.m1.2.2.2.4.1.1.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.4.2.1">norm</csymbol><ci id="A1.E15Xb.2.1.1.m1.1.1.1.1.cmml" xref="A1.E15Xb.2.1.1.m1.1.1.1.1">𝑋</ci></apply><apply id="A1.E15Xb.2.1.1.m1.2.2.2.5.1.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.5.2"><csymbol cd="latexml" id="A1.E15Xb.2.1.1.m1.2.2.2.5.1.1.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.5.2.1">norm</csymbol><ci id="A1.E15Xb.2.1.1.m1.2.2.2.2.cmml" xref="A1.E15Xb.2.1.1.m1.2.2.2.2">𝑌</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15Xb.2.1.1.m1.2c">\displaystyle=\frac{X^{\top}Y}{\|X\|\|Y\|}</annotation><annotation encoding="application/x-llamapun" id="A1.E15Xb.2.1.1.m1.2d">= divide start_ARG italic_X start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_Y end_ARG start_ARG ∥ italic_X ∥ ∥ italic_Y ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E15Xc">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cos(X,Y)~{}~{}~{}\square." class="ltx_Math" display="inline" id="A1.E15Xc.2.1.1.m1.4"><semantics id="A1.E15Xc.2.1.1.m1.4a"><mrow id="A1.E15Xc.2.1.1.m1.4.4.1" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.cmml"><mrow id="A1.E15Xc.2.1.1.m1.4.4.1.1" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.cmml"><mi id="A1.E15Xc.2.1.1.m1.4.4.1.1.2" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.2.cmml"></mi><mo id="A1.E15Xc.2.1.1.m1.4.4.1.1.1" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.1.cmml">=</mo><mrow id="A1.E15Xc.2.1.1.m1.4.4.1.1.3" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3.cmml"><mrow id="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.2" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.1.cmml"><mi id="A1.E15Xc.2.1.1.m1.1.1" xref="A1.E15Xc.2.1.1.m1.1.1.cmml">cos</mi><mo id="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.2a" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.1.cmml">⁡</mo><mrow id="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.2.1" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.1.cmml"><mo id="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.2.1.1" stretchy="false" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.1.cmml">(</mo><mi id="A1.E15Xc.2.1.1.m1.2.2" xref="A1.E15Xc.2.1.1.m1.2.2.cmml">X</mi><mo id="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.2.1.2" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.1.cmml">,</mo><mi id="A1.E15Xc.2.1.1.m1.3.3" xref="A1.E15Xc.2.1.1.m1.3.3.cmml">Y</mi><mo id="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.2.1.3" stretchy="false" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.1.cmml">)</mo></mrow></mrow><mo id="A1.E15Xc.2.1.1.m1.4.4.1.1.3.1" lspace="0.990em" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3.1.cmml">⁢</mo><mi id="A1.E15Xc.2.1.1.m1.4.4.1.1.3.3" mathvariant="normal" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3.3.cmml">□</mi></mrow></mrow><mo id="A1.E15Xc.2.1.1.m1.4.4.1.2" lspace="0em" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E15Xc.2.1.1.m1.4b"><apply id="A1.E15Xc.2.1.1.m1.4.4.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.4.4.1"><eq id="A1.E15Xc.2.1.1.m1.4.4.1.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.1"></eq><csymbol cd="latexml" id="A1.E15Xc.2.1.1.m1.4.4.1.1.2.cmml" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.2">absent</csymbol><apply id="A1.E15Xc.2.1.1.m1.4.4.1.1.3.cmml" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3"><times id="A1.E15Xc.2.1.1.m1.4.4.1.1.3.1.cmml" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3.1"></times><apply id="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.1.cmml" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3.2.2"><cos id="A1.E15Xc.2.1.1.m1.1.1.cmml" xref="A1.E15Xc.2.1.1.m1.1.1"></cos><ci id="A1.E15Xc.2.1.1.m1.2.2.cmml" xref="A1.E15Xc.2.1.1.m1.2.2">𝑋</ci><ci id="A1.E15Xc.2.1.1.m1.3.3.cmml" xref="A1.E15Xc.2.1.1.m1.3.3">𝑌</ci></apply><ci id="A1.E15Xc.2.1.1.m1.4.4.1.1.3.3.cmml" xref="A1.E15Xc.2.1.1.m1.4.4.1.1.3.3">□</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E15Xc.2.1.1.m1.4c">\displaystyle=\cos(X,Y)~{}~{}~{}\square.</annotation><annotation encoding="application/x-llamapun" id="A1.E15Xc.2.1.1.m1.4d">= roman_cos ( italic_X , italic_Y ) □ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Cosine Scale Invariance</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">Similar to the derivation in <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.SS1" title="A.1 Invariance of Orthogonal Transformation ‣ Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">A.1</span></a>, we now show that cosine similarity is invariant to scaling.
Again, we define a constant <math alttext="c" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.1"><semantics id="A1.SS2.p1.1.m1.1a"><mi id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><ci id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">italic_c</annotation></semantics></math> and follow equation <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S4.E9" title="In 4 Theoretical Analysis of AE-SVC ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">9</span></a>:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="A1.E16">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E16X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\cos\left(\frac{X}{c},\frac{Y}{c}\right)" class="ltx_Math" display="inline" id="A1.E16X.2.1.1.m1.3"><semantics id="A1.E16X.2.1.1.m1.3a"><mrow id="A1.E16X.2.1.1.m1.3.4.2" xref="A1.E16X.2.1.1.m1.3.4.1.cmml"><mi id="A1.E16X.2.1.1.m1.1.1" xref="A1.E16X.2.1.1.m1.1.1.cmml">cos</mi><mo id="A1.E16X.2.1.1.m1.3.4.2a" xref="A1.E16X.2.1.1.m1.3.4.1.cmml">⁡</mo><mrow id="A1.E16X.2.1.1.m1.3.4.2.1" xref="A1.E16X.2.1.1.m1.3.4.1.cmml"><mo id="A1.E16X.2.1.1.m1.3.4.2.1.1" xref="A1.E16X.2.1.1.m1.3.4.1.cmml">(</mo><mstyle displaystyle="true" id="A1.E16X.2.1.1.m1.2.2" xref="A1.E16X.2.1.1.m1.2.2.cmml"><mfrac id="A1.E16X.2.1.1.m1.2.2a" xref="A1.E16X.2.1.1.m1.2.2.cmml"><mi id="A1.E16X.2.1.1.m1.2.2.2" xref="A1.E16X.2.1.1.m1.2.2.2.cmml">X</mi><mi id="A1.E16X.2.1.1.m1.2.2.3" xref="A1.E16X.2.1.1.m1.2.2.3.cmml">c</mi></mfrac></mstyle><mo id="A1.E16X.2.1.1.m1.3.4.2.1.2" xref="A1.E16X.2.1.1.m1.3.4.1.cmml">,</mo><mstyle displaystyle="true" id="A1.E16X.2.1.1.m1.3.3" xref="A1.E16X.2.1.1.m1.3.3.cmml"><mfrac id="A1.E16X.2.1.1.m1.3.3a" xref="A1.E16X.2.1.1.m1.3.3.cmml"><mi id="A1.E16X.2.1.1.m1.3.3.2" xref="A1.E16X.2.1.1.m1.3.3.2.cmml">Y</mi><mi id="A1.E16X.2.1.1.m1.3.3.3" xref="A1.E16X.2.1.1.m1.3.3.3.cmml">c</mi></mfrac></mstyle><mo id="A1.E16X.2.1.1.m1.3.4.2.1.3" xref="A1.E16X.2.1.1.m1.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E16X.2.1.1.m1.3b"><apply id="A1.E16X.2.1.1.m1.3.4.1.cmml" xref="A1.E16X.2.1.1.m1.3.4.2"><cos id="A1.E16X.2.1.1.m1.1.1.cmml" xref="A1.E16X.2.1.1.m1.1.1"></cos><apply id="A1.E16X.2.1.1.m1.2.2.cmml" xref="A1.E16X.2.1.1.m1.2.2"><divide id="A1.E16X.2.1.1.m1.2.2.1.cmml" xref="A1.E16X.2.1.1.m1.2.2"></divide><ci id="A1.E16X.2.1.1.m1.2.2.2.cmml" xref="A1.E16X.2.1.1.m1.2.2.2">𝑋</ci><ci id="A1.E16X.2.1.1.m1.2.2.3.cmml" xref="A1.E16X.2.1.1.m1.2.2.3">𝑐</ci></apply><apply id="A1.E16X.2.1.1.m1.3.3.cmml" xref="A1.E16X.2.1.1.m1.3.3"><divide id="A1.E16X.2.1.1.m1.3.3.1.cmml" xref="A1.E16X.2.1.1.m1.3.3"></divide><ci id="A1.E16X.2.1.1.m1.3.3.2.cmml" xref="A1.E16X.2.1.1.m1.3.3.2">𝑌</ci><ci id="A1.E16X.2.1.1.m1.3.3.3.cmml" xref="A1.E16X.2.1.1.m1.3.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16X.2.1.1.m1.3c">\displaystyle\cos\left(\frac{X}{c},\frac{Y}{c}\right)</annotation><annotation encoding="application/x-llamapun" id="A1.E16X.2.1.1.m1.3d">roman_cos ( divide start_ARG italic_X end_ARG start_ARG italic_c end_ARG , divide start_ARG italic_Y end_ARG start_ARG italic_c end_ARG )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{X^{\top}Y/c^{2}}{\|X\|\|Y\|/c^{2}}" class="ltx_Math" display="inline" id="A1.E16X.3.2.2.m1.2"><semantics id="A1.E16X.3.2.2.m1.2a"><mrow id="A1.E16X.3.2.2.m1.2.3" xref="A1.E16X.3.2.2.m1.2.3.cmml"><mi id="A1.E16X.3.2.2.m1.2.3.2" xref="A1.E16X.3.2.2.m1.2.3.2.cmml"></mi><mo id="A1.E16X.3.2.2.m1.2.3.1" xref="A1.E16X.3.2.2.m1.2.3.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E16X.3.2.2.m1.2.2" xref="A1.E16X.3.2.2.m1.2.2.cmml"><mfrac id="A1.E16X.3.2.2.m1.2.2a" xref="A1.E16X.3.2.2.m1.2.2.cmml"><mrow id="A1.E16X.3.2.2.m1.2.2.4" xref="A1.E16X.3.2.2.m1.2.2.4.cmml"><mrow id="A1.E16X.3.2.2.m1.2.2.4.2" xref="A1.E16X.3.2.2.m1.2.2.4.2.cmml"><msup id="A1.E16X.3.2.2.m1.2.2.4.2.2" xref="A1.E16X.3.2.2.m1.2.2.4.2.2.cmml"><mi id="A1.E16X.3.2.2.m1.2.2.4.2.2.2" xref="A1.E16X.3.2.2.m1.2.2.4.2.2.2.cmml">X</mi><mo id="A1.E16X.3.2.2.m1.2.2.4.2.2.3" xref="A1.E16X.3.2.2.m1.2.2.4.2.2.3.cmml">⊤</mo></msup><mo id="A1.E16X.3.2.2.m1.2.2.4.2.1" xref="A1.E16X.3.2.2.m1.2.2.4.2.1.cmml">⁢</mo><mi id="A1.E16X.3.2.2.m1.2.2.4.2.3" xref="A1.E16X.3.2.2.m1.2.2.4.2.3.cmml">Y</mi></mrow><mo id="A1.E16X.3.2.2.m1.2.2.4.1" xref="A1.E16X.3.2.2.m1.2.2.4.1.cmml">/</mo><msup id="A1.E16X.3.2.2.m1.2.2.4.3" xref="A1.E16X.3.2.2.m1.2.2.4.3.cmml"><mi id="A1.E16X.3.2.2.m1.2.2.4.3.2" xref="A1.E16X.3.2.2.m1.2.2.4.3.2.cmml">c</mi><mn id="A1.E16X.3.2.2.m1.2.2.4.3.3" xref="A1.E16X.3.2.2.m1.2.2.4.3.3.cmml">2</mn></msup></mrow><mrow id="A1.E16X.3.2.2.m1.2.2.2" xref="A1.E16X.3.2.2.m1.2.2.2.cmml"><mrow id="A1.E16X.3.2.2.m1.2.2.2.4" xref="A1.E16X.3.2.2.m1.2.2.2.4.cmml"><mrow id="A1.E16X.3.2.2.m1.2.2.2.4.2.2" xref="A1.E16X.3.2.2.m1.2.2.2.4.2.1.cmml"><mo id="A1.E16X.3.2.2.m1.2.2.2.4.2.2.1" stretchy="false" xref="A1.E16X.3.2.2.m1.2.2.2.4.2.1.1.cmml">‖</mo><mi id="A1.E16X.3.2.2.m1.1.1.1.1" xref="A1.E16X.3.2.2.m1.1.1.1.1.cmml">X</mi><mo id="A1.E16X.3.2.2.m1.2.2.2.4.2.2.2" stretchy="false" xref="A1.E16X.3.2.2.m1.2.2.2.4.2.1.1.cmml">‖</mo></mrow><mo id="A1.E16X.3.2.2.m1.2.2.2.4.1" xref="A1.E16X.3.2.2.m1.2.2.2.4.1.cmml">⁢</mo><mrow id="A1.E16X.3.2.2.m1.2.2.2.4.3.2" xref="A1.E16X.3.2.2.m1.2.2.2.4.3.1.cmml"><mo id="A1.E16X.3.2.2.m1.2.2.2.4.3.2.1" stretchy="false" xref="A1.E16X.3.2.2.m1.2.2.2.4.3.1.1.cmml">‖</mo><mi id="A1.E16X.3.2.2.m1.2.2.2.2" xref="A1.E16X.3.2.2.m1.2.2.2.2.cmml">Y</mi><mo id="A1.E16X.3.2.2.m1.2.2.2.4.3.2.2" stretchy="false" xref="A1.E16X.3.2.2.m1.2.2.2.4.3.1.1.cmml">‖</mo></mrow></mrow><mo id="A1.E16X.3.2.2.m1.2.2.2.3" xref="A1.E16X.3.2.2.m1.2.2.2.3.cmml">/</mo><msup id="A1.E16X.3.2.2.m1.2.2.2.5" xref="A1.E16X.3.2.2.m1.2.2.2.5.cmml"><mi id="A1.E16X.3.2.2.m1.2.2.2.5.2" xref="A1.E16X.3.2.2.m1.2.2.2.5.2.cmml">c</mi><mn id="A1.E16X.3.2.2.m1.2.2.2.5.3" xref="A1.E16X.3.2.2.m1.2.2.2.5.3.cmml">2</mn></msup></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E16X.3.2.2.m1.2b"><apply id="A1.E16X.3.2.2.m1.2.3.cmml" xref="A1.E16X.3.2.2.m1.2.3"><eq id="A1.E16X.3.2.2.m1.2.3.1.cmml" xref="A1.E16X.3.2.2.m1.2.3.1"></eq><csymbol cd="latexml" id="A1.E16X.3.2.2.m1.2.3.2.cmml" xref="A1.E16X.3.2.2.m1.2.3.2">absent</csymbol><apply id="A1.E16X.3.2.2.m1.2.2.cmml" xref="A1.E16X.3.2.2.m1.2.2"><divide id="A1.E16X.3.2.2.m1.2.2.3.cmml" xref="A1.E16X.3.2.2.m1.2.2"></divide><apply id="A1.E16X.3.2.2.m1.2.2.4.cmml" xref="A1.E16X.3.2.2.m1.2.2.4"><divide id="A1.E16X.3.2.2.m1.2.2.4.1.cmml" xref="A1.E16X.3.2.2.m1.2.2.4.1"></divide><apply id="A1.E16X.3.2.2.m1.2.2.4.2.cmml" xref="A1.E16X.3.2.2.m1.2.2.4.2"><times id="A1.E16X.3.2.2.m1.2.2.4.2.1.cmml" xref="A1.E16X.3.2.2.m1.2.2.4.2.1"></times><apply id="A1.E16X.3.2.2.m1.2.2.4.2.2.cmml" xref="A1.E16X.3.2.2.m1.2.2.4.2.2"><csymbol cd="ambiguous" id="A1.E16X.3.2.2.m1.2.2.4.2.2.1.cmml" xref="A1.E16X.3.2.2.m1.2.2.4.2.2">superscript</csymbol><ci id="A1.E16X.3.2.2.m1.2.2.4.2.2.2.cmml" xref="A1.E16X.3.2.2.m1.2.2.4.2.2.2">𝑋</ci><csymbol cd="latexml" id="A1.E16X.3.2.2.m1.2.2.4.2.2.3.cmml" xref="A1.E16X.3.2.2.m1.2.2.4.2.2.3">top</csymbol></apply><ci id="A1.E16X.3.2.2.m1.2.2.4.2.3.cmml" xref="A1.E16X.3.2.2.m1.2.2.4.2.3">𝑌</ci></apply><apply id="A1.E16X.3.2.2.m1.2.2.4.3.cmml" xref="A1.E16X.3.2.2.m1.2.2.4.3"><csymbol cd="ambiguous" id="A1.E16X.3.2.2.m1.2.2.4.3.1.cmml" xref="A1.E16X.3.2.2.m1.2.2.4.3">superscript</csymbol><ci id="A1.E16X.3.2.2.m1.2.2.4.3.2.cmml" xref="A1.E16X.3.2.2.m1.2.2.4.3.2">𝑐</ci><cn id="A1.E16X.3.2.2.m1.2.2.4.3.3.cmml" type="integer" xref="A1.E16X.3.2.2.m1.2.2.4.3.3">2</cn></apply></apply><apply id="A1.E16X.3.2.2.m1.2.2.2.cmml" xref="A1.E16X.3.2.2.m1.2.2.2"><divide id="A1.E16X.3.2.2.m1.2.2.2.3.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.3"></divide><apply id="A1.E16X.3.2.2.m1.2.2.2.4.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.4"><times id="A1.E16X.3.2.2.m1.2.2.2.4.1.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.4.1"></times><apply id="A1.E16X.3.2.2.m1.2.2.2.4.2.1.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.4.2.2"><csymbol cd="latexml" id="A1.E16X.3.2.2.m1.2.2.2.4.2.1.1.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.4.2.2.1">norm</csymbol><ci id="A1.E16X.3.2.2.m1.1.1.1.1.cmml" xref="A1.E16X.3.2.2.m1.1.1.1.1">𝑋</ci></apply><apply id="A1.E16X.3.2.2.m1.2.2.2.4.3.1.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.4.3.2"><csymbol cd="latexml" id="A1.E16X.3.2.2.m1.2.2.2.4.3.1.1.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.4.3.2.1">norm</csymbol><ci id="A1.E16X.3.2.2.m1.2.2.2.2.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.2">𝑌</ci></apply></apply><apply id="A1.E16X.3.2.2.m1.2.2.2.5.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.5"><csymbol cd="ambiguous" id="A1.E16X.3.2.2.m1.2.2.2.5.1.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.5">superscript</csymbol><ci id="A1.E16X.3.2.2.m1.2.2.2.5.2.cmml" xref="A1.E16X.3.2.2.m1.2.2.2.5.2">𝑐</ci><cn id="A1.E16X.3.2.2.m1.2.2.2.5.3.cmml" type="integer" xref="A1.E16X.3.2.2.m1.2.2.2.5.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16X.3.2.2.m1.2c">\displaystyle=\frac{X^{\top}Y/c^{2}}{\|X\|\|Y\|/c^{2}}</annotation><annotation encoding="application/x-llamapun" id="A1.E16X.3.2.2.m1.2d">= divide start_ARG italic_X start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_Y / italic_c start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG ∥ italic_X ∥ ∥ italic_Y ∥ / italic_c start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="3"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(16)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E16Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{X^{\top}Y}{\|X\|\|Y\|}" class="ltx_Math" display="inline" id="A1.E16Xa.2.1.1.m1.2"><semantics id="A1.E16Xa.2.1.1.m1.2a"><mrow id="A1.E16Xa.2.1.1.m1.2.3" xref="A1.E16Xa.2.1.1.m1.2.3.cmml"><mi id="A1.E16Xa.2.1.1.m1.2.3.2" xref="A1.E16Xa.2.1.1.m1.2.3.2.cmml"></mi><mo id="A1.E16Xa.2.1.1.m1.2.3.1" xref="A1.E16Xa.2.1.1.m1.2.3.1.cmml">=</mo><mstyle displaystyle="true" id="A1.E16Xa.2.1.1.m1.2.2" xref="A1.E16Xa.2.1.1.m1.2.2.cmml"><mfrac id="A1.E16Xa.2.1.1.m1.2.2a" xref="A1.E16Xa.2.1.1.m1.2.2.cmml"><mrow id="A1.E16Xa.2.1.1.m1.2.2.4" xref="A1.E16Xa.2.1.1.m1.2.2.4.cmml"><msup id="A1.E16Xa.2.1.1.m1.2.2.4.2" xref="A1.E16Xa.2.1.1.m1.2.2.4.2.cmml"><mi id="A1.E16Xa.2.1.1.m1.2.2.4.2.2" xref="A1.E16Xa.2.1.1.m1.2.2.4.2.2.cmml">X</mi><mo id="A1.E16Xa.2.1.1.m1.2.2.4.2.3" xref="A1.E16Xa.2.1.1.m1.2.2.4.2.3.cmml">⊤</mo></msup><mo id="A1.E16Xa.2.1.1.m1.2.2.4.1" xref="A1.E16Xa.2.1.1.m1.2.2.4.1.cmml">⁢</mo><mi id="A1.E16Xa.2.1.1.m1.2.2.4.3" xref="A1.E16Xa.2.1.1.m1.2.2.4.3.cmml">Y</mi></mrow><mrow id="A1.E16Xa.2.1.1.m1.2.2.2" xref="A1.E16Xa.2.1.1.m1.2.2.2.cmml"><mrow id="A1.E16Xa.2.1.1.m1.2.2.2.4.2" xref="A1.E16Xa.2.1.1.m1.2.2.2.4.1.cmml"><mo id="A1.E16Xa.2.1.1.m1.2.2.2.4.2.1" stretchy="false" xref="A1.E16Xa.2.1.1.m1.2.2.2.4.1.1.cmml">‖</mo><mi id="A1.E16Xa.2.1.1.m1.1.1.1.1" xref="A1.E16Xa.2.1.1.m1.1.1.1.1.cmml">X</mi><mo id="A1.E16Xa.2.1.1.m1.2.2.2.4.2.2" stretchy="false" xref="A1.E16Xa.2.1.1.m1.2.2.2.4.1.1.cmml">‖</mo></mrow><mo id="A1.E16Xa.2.1.1.m1.2.2.2.3" xref="A1.E16Xa.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.E16Xa.2.1.1.m1.2.2.2.5.2" xref="A1.E16Xa.2.1.1.m1.2.2.2.5.1.cmml"><mo id="A1.E16Xa.2.1.1.m1.2.2.2.5.2.1" stretchy="false" xref="A1.E16Xa.2.1.1.m1.2.2.2.5.1.1.cmml">‖</mo><mi id="A1.E16Xa.2.1.1.m1.2.2.2.2" xref="A1.E16Xa.2.1.1.m1.2.2.2.2.cmml">Y</mi><mo id="A1.E16Xa.2.1.1.m1.2.2.2.5.2.2" stretchy="false" xref="A1.E16Xa.2.1.1.m1.2.2.2.5.1.1.cmml">‖</mo></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A1.E16Xa.2.1.1.m1.2b"><apply id="A1.E16Xa.2.1.1.m1.2.3.cmml" xref="A1.E16Xa.2.1.1.m1.2.3"><eq id="A1.E16Xa.2.1.1.m1.2.3.1.cmml" xref="A1.E16Xa.2.1.1.m1.2.3.1"></eq><csymbol cd="latexml" id="A1.E16Xa.2.1.1.m1.2.3.2.cmml" xref="A1.E16Xa.2.1.1.m1.2.3.2">absent</csymbol><apply id="A1.E16Xa.2.1.1.m1.2.2.cmml" xref="A1.E16Xa.2.1.1.m1.2.2"><divide id="A1.E16Xa.2.1.1.m1.2.2.3.cmml" xref="A1.E16Xa.2.1.1.m1.2.2"></divide><apply id="A1.E16Xa.2.1.1.m1.2.2.4.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.4"><times id="A1.E16Xa.2.1.1.m1.2.2.4.1.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.4.1"></times><apply id="A1.E16Xa.2.1.1.m1.2.2.4.2.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.4.2"><csymbol cd="ambiguous" id="A1.E16Xa.2.1.1.m1.2.2.4.2.1.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.4.2">superscript</csymbol><ci id="A1.E16Xa.2.1.1.m1.2.2.4.2.2.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.4.2.2">𝑋</ci><csymbol cd="latexml" id="A1.E16Xa.2.1.1.m1.2.2.4.2.3.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.4.2.3">top</csymbol></apply><ci id="A1.E16Xa.2.1.1.m1.2.2.4.3.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.4.3">𝑌</ci></apply><apply id="A1.E16Xa.2.1.1.m1.2.2.2.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.2"><times id="A1.E16Xa.2.1.1.m1.2.2.2.3.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.2.3"></times><apply id="A1.E16Xa.2.1.1.m1.2.2.2.4.1.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.2.4.2"><csymbol cd="latexml" id="A1.E16Xa.2.1.1.m1.2.2.2.4.1.1.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.2.4.2.1">norm</csymbol><ci id="A1.E16Xa.2.1.1.m1.1.1.1.1.cmml" xref="A1.E16Xa.2.1.1.m1.1.1.1.1">𝑋</ci></apply><apply id="A1.E16Xa.2.1.1.m1.2.2.2.5.1.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.2.5.2"><csymbol cd="latexml" id="A1.E16Xa.2.1.1.m1.2.2.2.5.1.1.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.2.5.2.1">norm</csymbol><ci id="A1.E16Xa.2.1.1.m1.2.2.2.2.cmml" xref="A1.E16Xa.2.1.1.m1.2.2.2.2">𝑌</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16Xa.2.1.1.m1.2c">\displaystyle=\frac{X^{\top}Y}{\|X\|\|Y\|}</annotation><annotation encoding="application/x-llamapun" id="A1.E16Xa.2.1.1.m1.2d">= divide start_ARG italic_X start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_Y end_ARG start_ARG ∥ italic_X ∥ ∥ italic_Y ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="A1.E16Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\cos(X,Y)~{}~{}~{}\square." class="ltx_Math" display="inline" id="A1.E16Xb.2.1.1.m1.4"><semantics id="A1.E16Xb.2.1.1.m1.4a"><mrow id="A1.E16Xb.2.1.1.m1.4.4.1" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.cmml"><mrow id="A1.E16Xb.2.1.1.m1.4.4.1.1" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.cmml"><mi id="A1.E16Xb.2.1.1.m1.4.4.1.1.2" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.2.cmml"></mi><mo id="A1.E16Xb.2.1.1.m1.4.4.1.1.1" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.1.cmml">=</mo><mrow id="A1.E16Xb.2.1.1.m1.4.4.1.1.3" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3.cmml"><mrow id="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.2" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.1.cmml"><mi id="A1.E16Xb.2.1.1.m1.1.1" xref="A1.E16Xb.2.1.1.m1.1.1.cmml">cos</mi><mo id="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.2a" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.1.cmml">⁡</mo><mrow id="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.2.1" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.1.cmml"><mo id="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.2.1.1" stretchy="false" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.1.cmml">(</mo><mi id="A1.E16Xb.2.1.1.m1.2.2" xref="A1.E16Xb.2.1.1.m1.2.2.cmml">X</mi><mo id="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.2.1.2" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.1.cmml">,</mo><mi id="A1.E16Xb.2.1.1.m1.3.3" xref="A1.E16Xb.2.1.1.m1.3.3.cmml">Y</mi><mo id="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.2.1.3" stretchy="false" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.1.cmml">)</mo></mrow></mrow><mo id="A1.E16Xb.2.1.1.m1.4.4.1.1.3.1" lspace="0.990em" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3.1.cmml">⁢</mo><mi id="A1.E16Xb.2.1.1.m1.4.4.1.1.3.3" mathvariant="normal" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3.3.cmml">□</mi></mrow></mrow><mo id="A1.E16Xb.2.1.1.m1.4.4.1.2" lspace="0em" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E16Xb.2.1.1.m1.4b"><apply id="A1.E16Xb.2.1.1.m1.4.4.1.1.cmml" xref="A1.E16Xb.2.1.1.m1.4.4.1"><eq id="A1.E16Xb.2.1.1.m1.4.4.1.1.1.cmml" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.1"></eq><csymbol cd="latexml" id="A1.E16Xb.2.1.1.m1.4.4.1.1.2.cmml" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.2">absent</csymbol><apply id="A1.E16Xb.2.1.1.m1.4.4.1.1.3.cmml" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3"><times id="A1.E16Xb.2.1.1.m1.4.4.1.1.3.1.cmml" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3.1"></times><apply id="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.1.cmml" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3.2.2"><cos id="A1.E16Xb.2.1.1.m1.1.1.cmml" xref="A1.E16Xb.2.1.1.m1.1.1"></cos><ci id="A1.E16Xb.2.1.1.m1.2.2.cmml" xref="A1.E16Xb.2.1.1.m1.2.2">𝑋</ci><ci id="A1.E16Xb.2.1.1.m1.3.3.cmml" xref="A1.E16Xb.2.1.1.m1.3.3">𝑌</ci></apply><ci id="A1.E16Xb.2.1.1.m1.4.4.1.1.3.3.cmml" xref="A1.E16Xb.2.1.1.m1.4.4.1.1.3.3">□</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E16Xb.2.1.1.m1.4c">\displaystyle=\cos(X,Y)~{}~{}~{}\square.</annotation><annotation encoding="application/x-llamapun" id="A1.E16Xb.2.1.1.m1.4d">= roman_cos ( italic_X , italic_Y ) □ .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span><span class="ltx_text ltx_font_typewriter" id="A1.SS3.1.1">AE-SVC</span> Additional Results with more foundation models</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S5.F4" title="Figure 4 ‣ 5.2 Results ‣ 5 Experiments ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">4</span></a>, we showed the advantage of using <span class="ltx_text ltx_font_typewriter" id="A1.SS3.p1.1.1">AE-SVC</span> for embeddings of three models. Here, in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.F6" title="Figure 6 ‣ A.3 AE-SVC Additional Results with more foundation models ‣ Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">6</span></a>, we show additional results with three more embeddings, namely: CLIP, DINO-V2-Small, and DINO-S8. We observe similar trends as previously noted. We release our codebase in the supplementary material for easy reproduction of all these results.</p>
</div>
<figure class="ltx_figure" id="A1.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="142" id="A1.F6.g1" src="extracted/5913932/figs/appendix_vapca.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.F6.2.1" style="font-size:90%;">AE-SVC<span class="ltx_text ltx_font_serif" id="A1.F6.2.1.1"> significantly improves the retrieval performance of foundation models.<span class="ltx_text ltx_font_medium" id="A1.F6.2.1.1.1"> Here, we see a similar trend as discussed in the main paper but with three additional foundation models.</span></span></span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span><span class="ltx_text ltx_font_typewriter" id="A1.SS4.1.1">(SS)<sub class="ltx_sub" id="A1.SS4.1.1.1"><span class="ltx_text ltx_font_serif" id="A1.SS4.1.1.1.1">2</span></sub>D</span> Additional Results with more datasets and foundation models</h3>
<div class="ltx_para" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.3">In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S5.F5" title="Figure 5 ‣ 5.2 Results ‣ 5 Experiments ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">5</span></a>, we showed the advantage of using <span class="ltx_text ltx_font_typewriter" id="A1.SS4.p1.1.1">(SS)<sub class="ltx_sub" id="A1.SS4.p1.1.1.1"><span class="ltx_text ltx_font_serif" id="A1.SS4.p1.1.1.1.1">2</span></sub>D</span> on top of <span class="ltx_text ltx_font_typewriter" id="A1.SS4.p1.3.4">AE-SVC</span> for additional improvement in retrieval performance at smaller dimensions. Here, in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.F7" title="Figure 7 ‣ A.4 (SS)2D Additional Results with more datasets and foundation models ‣ Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">7</span></a>, we show additional results for <span class="ltx_text ltx_font_typewriter" id="A1.SS4.p1.2.2">(SS)<sub class="ltx_sub" id="A1.SS4.p1.2.2.1"><span class="ltx_text ltx_font_serif" id="A1.SS4.p1.2.2.1.1">2</span></sub>D</span> on SOP with DINO-B16 and on TokyoVal with ViT. We observe similar trends as previously noted. For trying <span class="ltx_text ltx_font_typewriter" id="A1.SS4.p1.3.3">(SS)<sub class="ltx_sub" id="A1.SS4.p1.3.3.1"><span class="ltx_text ltx_font_serif" id="A1.SS4.p1.3.3.1.1">2</span></sub>D</span> with more combinations of datasets and foundation models, please refer to our codebase that we release in the supplementary material.</p>
</div>
<figure class="ltx_figure" id="A1.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="146" id="A1.F7.g1" src="extracted/5913932/figs/appendix_ss2d.png" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="ltx_text ltx_font_bold" id="A1.F7.2.1" style="font-size:90%;">Applying <span class="ltx_text ltx_font_typewriter" id="A1.F7.2.1.1">(SS)<sub class="ltx_sub" id="A1.F7.2.1.1.1"><span class="ltx_text ltx_font_serif ltx_font_medium" id="A1.F7.2.1.1.1.1">2</span></sub>D</span> over <span class="ltx_text ltx_font_typewriter" id="A1.F7.2.1.2">AE-SVC</span> leads to further performance boost at lower embedding sizes.<span class="ltx_text ltx_font_medium" id="A1.F7.2.1.3"> Here, we see a similar trend as discussed in the main paper but with two additional foundation models and datasets.</span></span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span><span class="ltx_text ltx_font_typewriter" id="A1.SS5.1.1">AE-SVC</span> Additional Results on the Recall Metric</h3>
<div class="ltx_para" id="A1.SS5.p1">
<p class="ltx_p" id="A1.SS5.p1.5">In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S5.F4" title="Figure 4 ‣ 5.2 Results ‣ 5 Experiments ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">4</span></a>, we show the advantage of using <span class="ltx_text ltx_font_typewriter" id="A1.SS5.p1.5.1">AE-SVC</span> for embeddings of three models on the mean Average Precision at <math alttext="\mathbf{k}" class="ltx_Math" display="inline" id="A1.SS5.p1.1.m1.1"><semantics id="A1.SS5.p1.1.m1.1a"><mi id="A1.SS5.p1.1.m1.1.1" xref="A1.SS5.p1.1.m1.1.1.cmml">𝐤</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.1.m1.1b"><ci id="A1.SS5.p1.1.m1.1.1.cmml" xref="A1.SS5.p1.1.m1.1.1">𝐤</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.1.m1.1c">\mathbf{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.1.m1.1d">bold_k</annotation></semantics></math> (mAP@<math alttext="\mathbf{k}" class="ltx_Math" display="inline" id="A1.SS5.p1.2.m2.1"><semantics id="A1.SS5.p1.2.m2.1a"><mi id="A1.SS5.p1.2.m2.1.1" xref="A1.SS5.p1.2.m2.1.1.cmml">𝐤</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.2.m2.1b"><ci id="A1.SS5.p1.2.m2.1.1.cmml" xref="A1.SS5.p1.2.m2.1.1">𝐤</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.2.m2.1c">\mathbf{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.2.m2.1d">bold_k</annotation></semantics></math>) metric. Here, in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#A1.F8" title="Figure 8 ‣ A.5 AE-SVC Additional Results on the Recall Metric ‣ Appendix A Appendix ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">8</span></a>, we show additional results on the Recall@<math alttext="\mathbf{k}" class="ltx_Math" display="inline" id="A1.SS5.p1.3.m3.1"><semantics id="A1.SS5.p1.3.m3.1a"><mi id="A1.SS5.p1.3.m3.1.1" xref="A1.SS5.p1.3.m3.1.1.cmml">𝐤</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.3.m3.1b"><ci id="A1.SS5.p1.3.m3.1.1.cmml" xref="A1.SS5.p1.3.m3.1.1">𝐤</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.3.m3.1c">\mathbf{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.3.m3.1d">bold_k</annotation></semantics></math> metric. We observe very similar trends on the Recall@<math alttext="\mathbf{k}" class="ltx_Math" display="inline" id="A1.SS5.p1.4.m4.1"><semantics id="A1.SS5.p1.4.m4.1a"><mi id="A1.SS5.p1.4.m4.1.1" xref="A1.SS5.p1.4.m4.1.1.cmml">𝐤</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.4.m4.1b"><ci id="A1.SS5.p1.4.m4.1.1.cmml" xref="A1.SS5.p1.4.m4.1.1">𝐤</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.4.m4.1c">\mathbf{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.4.m4.1d">bold_k</annotation></semantics></math> metric as we did on the mAP@<math alttext="\mathbf{k}" class="ltx_Math" display="inline" id="A1.SS5.p1.5.m5.1"><semantics id="A1.SS5.p1.5.m5.1a"><mi id="A1.SS5.p1.5.m5.1.1" xref="A1.SS5.p1.5.m5.1.1.cmml">𝐤</mi><annotation-xml encoding="MathML-Content" id="A1.SS5.p1.5.m5.1b"><ci id="A1.SS5.p1.5.m5.1.1.cmml" xref="A1.SS5.p1.5.m5.1.1">𝐤</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p1.5.m5.1c">\mathbf{k}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p1.5.m5.1d">bold_k</annotation></semantics></math> metric. We release a reproducible codebase for readers to experiment with both metrics.</p>
</div>
<figure class="ltx_figure" id="A1.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="142" id="A1.F8.g1" src="extracted/5913932/figs/exp_vapca_recall.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span class="ltx_text ltx_font_typewriter ltx_font_bold" id="A1.F8.2.1" style="font-size:90%;">AE-SVC<span class="ltx_text ltx_font_serif" id="A1.F8.2.1.1"> significantly improves the retrieval performance of foundation models on the recall metric.<span class="ltx_text ltx_font_medium" id="A1.F8.2.1.1.1"> <span class="ltx_text ltx_font_typewriter" id="A1.F8.2.1.1.1.1">AE-SVC</span> (solid lines) consistently outperforms the off-the-shelf foundation models, i.e., PCA (dashed lines), on four datasets.</span></span></span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6 </span>Hyperparameters</h3>
<div class="ltx_para" id="A1.SS6.p1">
<p class="ltx_p" id="A1.SS6.p1.8">We discussed four hyperparameters in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.07022v1#S3.SS1" title="3.1 Autoencoders with Strong Variance Constraints (AE-SVC) ‣ 3 Methodology ‣ Exploiting Distribution Constraints for Scalable and Efficient Image Retrieval"><span class="ltx_text ltx_ref_tag">3.1</span></a>: <math alttext="\lambda_{\text{rec}}" class="ltx_Math" display="inline" id="A1.SS6.p1.1.m1.1"><semantics id="A1.SS6.p1.1.m1.1a"><msub id="A1.SS6.p1.1.m1.1.1" xref="A1.SS6.p1.1.m1.1.1.cmml"><mi id="A1.SS6.p1.1.m1.1.1.2" xref="A1.SS6.p1.1.m1.1.1.2.cmml">λ</mi><mtext id="A1.SS6.p1.1.m1.1.1.3" xref="A1.SS6.p1.1.m1.1.1.3a.cmml">rec</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.1.m1.1b"><apply id="A1.SS6.p1.1.m1.1.1.cmml" xref="A1.SS6.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.1.m1.1.1.1.cmml" xref="A1.SS6.p1.1.m1.1.1">subscript</csymbol><ci id="A1.SS6.p1.1.m1.1.1.2.cmml" xref="A1.SS6.p1.1.m1.1.1.2">𝜆</ci><ci id="A1.SS6.p1.1.m1.1.1.3a.cmml" xref="A1.SS6.p1.1.m1.1.1.3"><mtext id="A1.SS6.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="A1.SS6.p1.1.m1.1.1.3">rec</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.1.m1.1c">\lambda_{\text{rec}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.1.m1.1d">italic_λ start_POSTSUBSCRIPT rec end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\lambda_{\text{cov}}" class="ltx_Math" display="inline" id="A1.SS6.p1.2.m2.1"><semantics id="A1.SS6.p1.2.m2.1a"><msub id="A1.SS6.p1.2.m2.1.1" xref="A1.SS6.p1.2.m2.1.1.cmml"><mi id="A1.SS6.p1.2.m2.1.1.2" xref="A1.SS6.p1.2.m2.1.1.2.cmml">λ</mi><mtext id="A1.SS6.p1.2.m2.1.1.3" xref="A1.SS6.p1.2.m2.1.1.3a.cmml">cov</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.2.m2.1b"><apply id="A1.SS6.p1.2.m2.1.1.cmml" xref="A1.SS6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.2.m2.1.1.1.cmml" xref="A1.SS6.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS6.p1.2.m2.1.1.2.cmml" xref="A1.SS6.p1.2.m2.1.1.2">𝜆</ci><ci id="A1.SS6.p1.2.m2.1.1.3a.cmml" xref="A1.SS6.p1.2.m2.1.1.3"><mtext id="A1.SS6.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="A1.SS6.p1.2.m2.1.1.3">cov</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.2.m2.1c">\lambda_{\text{cov}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.2.m2.1d">italic_λ start_POSTSUBSCRIPT cov end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\lambda_{\text{var}}" class="ltx_Math" display="inline" id="A1.SS6.p1.3.m3.1"><semantics id="A1.SS6.p1.3.m3.1a"><msub id="A1.SS6.p1.3.m3.1.1" xref="A1.SS6.p1.3.m3.1.1.cmml"><mi id="A1.SS6.p1.3.m3.1.1.2" xref="A1.SS6.p1.3.m3.1.1.2.cmml">λ</mi><mtext id="A1.SS6.p1.3.m3.1.1.3" xref="A1.SS6.p1.3.m3.1.1.3a.cmml">var</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.3.m3.1b"><apply id="A1.SS6.p1.3.m3.1.1.cmml" xref="A1.SS6.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.3.m3.1.1.1.cmml" xref="A1.SS6.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS6.p1.3.m3.1.1.2.cmml" xref="A1.SS6.p1.3.m3.1.1.2">𝜆</ci><ci id="A1.SS6.p1.3.m3.1.1.3a.cmml" xref="A1.SS6.p1.3.m3.1.1.3"><mtext id="A1.SS6.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="A1.SS6.p1.3.m3.1.1.3">var</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.3.m3.1c">\lambda_{\text{var}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.3.m3.1d">italic_λ start_POSTSUBSCRIPT var end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\lambda_{\text{mean}}" class="ltx_Math" display="inline" id="A1.SS6.p1.4.m4.1"><semantics id="A1.SS6.p1.4.m4.1a"><msub id="A1.SS6.p1.4.m4.1.1" xref="A1.SS6.p1.4.m4.1.1.cmml"><mi id="A1.SS6.p1.4.m4.1.1.2" xref="A1.SS6.p1.4.m4.1.1.2.cmml">λ</mi><mtext id="A1.SS6.p1.4.m4.1.1.3" xref="A1.SS6.p1.4.m4.1.1.3a.cmml">mean</mtext></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.4.m4.1b"><apply id="A1.SS6.p1.4.m4.1.1.cmml" xref="A1.SS6.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.4.m4.1.1.1.cmml" xref="A1.SS6.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS6.p1.4.m4.1.1.2.cmml" xref="A1.SS6.p1.4.m4.1.1.2">𝜆</ci><ci id="A1.SS6.p1.4.m4.1.1.3a.cmml" xref="A1.SS6.p1.4.m4.1.1.3"><mtext id="A1.SS6.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="A1.SS6.p1.4.m4.1.1.3">mean</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.4.m4.1c">\lambda_{\text{mean}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.4.m4.1d">italic_λ start_POSTSUBSCRIPT mean end_POSTSUBSCRIPT</annotation></semantics></math>. We empirically determined the values of these hyperparameters, ensuring optimal performance across all datasets. The fixed values are: <math alttext="\lambda_{\text{rec}}=25" class="ltx_Math" display="inline" id="A1.SS6.p1.5.m5.1"><semantics id="A1.SS6.p1.5.m5.1a"><mrow id="A1.SS6.p1.5.m5.1.1" xref="A1.SS6.p1.5.m5.1.1.cmml"><msub id="A1.SS6.p1.5.m5.1.1.2" xref="A1.SS6.p1.5.m5.1.1.2.cmml"><mi id="A1.SS6.p1.5.m5.1.1.2.2" xref="A1.SS6.p1.5.m5.1.1.2.2.cmml">λ</mi><mtext id="A1.SS6.p1.5.m5.1.1.2.3" xref="A1.SS6.p1.5.m5.1.1.2.3a.cmml">rec</mtext></msub><mo id="A1.SS6.p1.5.m5.1.1.1" xref="A1.SS6.p1.5.m5.1.1.1.cmml">=</mo><mn id="A1.SS6.p1.5.m5.1.1.3" xref="A1.SS6.p1.5.m5.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.5.m5.1b"><apply id="A1.SS6.p1.5.m5.1.1.cmml" xref="A1.SS6.p1.5.m5.1.1"><eq id="A1.SS6.p1.5.m5.1.1.1.cmml" xref="A1.SS6.p1.5.m5.1.1.1"></eq><apply id="A1.SS6.p1.5.m5.1.1.2.cmml" xref="A1.SS6.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="A1.SS6.p1.5.m5.1.1.2.1.cmml" xref="A1.SS6.p1.5.m5.1.1.2">subscript</csymbol><ci id="A1.SS6.p1.5.m5.1.1.2.2.cmml" xref="A1.SS6.p1.5.m5.1.1.2.2">𝜆</ci><ci id="A1.SS6.p1.5.m5.1.1.2.3a.cmml" xref="A1.SS6.p1.5.m5.1.1.2.3"><mtext id="A1.SS6.p1.5.m5.1.1.2.3.cmml" mathsize="70%" xref="A1.SS6.p1.5.m5.1.1.2.3">rec</mtext></ci></apply><cn id="A1.SS6.p1.5.m5.1.1.3.cmml" type="integer" xref="A1.SS6.p1.5.m5.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.5.m5.1c">\lambda_{\text{rec}}=25</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.5.m5.1d">italic_λ start_POSTSUBSCRIPT rec end_POSTSUBSCRIPT = 25</annotation></semantics></math>, <math alttext="\lambda_{\text{cov}}=1" class="ltx_Math" display="inline" id="A1.SS6.p1.6.m6.1"><semantics id="A1.SS6.p1.6.m6.1a"><mrow id="A1.SS6.p1.6.m6.1.1" xref="A1.SS6.p1.6.m6.1.1.cmml"><msub id="A1.SS6.p1.6.m6.1.1.2" xref="A1.SS6.p1.6.m6.1.1.2.cmml"><mi id="A1.SS6.p1.6.m6.1.1.2.2" xref="A1.SS6.p1.6.m6.1.1.2.2.cmml">λ</mi><mtext id="A1.SS6.p1.6.m6.1.1.2.3" xref="A1.SS6.p1.6.m6.1.1.2.3a.cmml">cov</mtext></msub><mo id="A1.SS6.p1.6.m6.1.1.1" xref="A1.SS6.p1.6.m6.1.1.1.cmml">=</mo><mn id="A1.SS6.p1.6.m6.1.1.3" xref="A1.SS6.p1.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.6.m6.1b"><apply id="A1.SS6.p1.6.m6.1.1.cmml" xref="A1.SS6.p1.6.m6.1.1"><eq id="A1.SS6.p1.6.m6.1.1.1.cmml" xref="A1.SS6.p1.6.m6.1.1.1"></eq><apply id="A1.SS6.p1.6.m6.1.1.2.cmml" xref="A1.SS6.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="A1.SS6.p1.6.m6.1.1.2.1.cmml" xref="A1.SS6.p1.6.m6.1.1.2">subscript</csymbol><ci id="A1.SS6.p1.6.m6.1.1.2.2.cmml" xref="A1.SS6.p1.6.m6.1.1.2.2">𝜆</ci><ci id="A1.SS6.p1.6.m6.1.1.2.3a.cmml" xref="A1.SS6.p1.6.m6.1.1.2.3"><mtext id="A1.SS6.p1.6.m6.1.1.2.3.cmml" mathsize="70%" xref="A1.SS6.p1.6.m6.1.1.2.3">cov</mtext></ci></apply><cn id="A1.SS6.p1.6.m6.1.1.3.cmml" type="integer" xref="A1.SS6.p1.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.6.m6.1c">\lambda_{\text{cov}}=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.6.m6.1d">italic_λ start_POSTSUBSCRIPT cov end_POSTSUBSCRIPT = 1</annotation></semantics></math>, <math alttext="\lambda_{\text{var}}=15" class="ltx_Math" display="inline" id="A1.SS6.p1.7.m7.1"><semantics id="A1.SS6.p1.7.m7.1a"><mrow id="A1.SS6.p1.7.m7.1.1" xref="A1.SS6.p1.7.m7.1.1.cmml"><msub id="A1.SS6.p1.7.m7.1.1.2" xref="A1.SS6.p1.7.m7.1.1.2.cmml"><mi id="A1.SS6.p1.7.m7.1.1.2.2" xref="A1.SS6.p1.7.m7.1.1.2.2.cmml">λ</mi><mtext id="A1.SS6.p1.7.m7.1.1.2.3" xref="A1.SS6.p1.7.m7.1.1.2.3a.cmml">var</mtext></msub><mo id="A1.SS6.p1.7.m7.1.1.1" xref="A1.SS6.p1.7.m7.1.1.1.cmml">=</mo><mn id="A1.SS6.p1.7.m7.1.1.3" xref="A1.SS6.p1.7.m7.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.7.m7.1b"><apply id="A1.SS6.p1.7.m7.1.1.cmml" xref="A1.SS6.p1.7.m7.1.1"><eq id="A1.SS6.p1.7.m7.1.1.1.cmml" xref="A1.SS6.p1.7.m7.1.1.1"></eq><apply id="A1.SS6.p1.7.m7.1.1.2.cmml" xref="A1.SS6.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="A1.SS6.p1.7.m7.1.1.2.1.cmml" xref="A1.SS6.p1.7.m7.1.1.2">subscript</csymbol><ci id="A1.SS6.p1.7.m7.1.1.2.2.cmml" xref="A1.SS6.p1.7.m7.1.1.2.2">𝜆</ci><ci id="A1.SS6.p1.7.m7.1.1.2.3a.cmml" xref="A1.SS6.p1.7.m7.1.1.2.3"><mtext id="A1.SS6.p1.7.m7.1.1.2.3.cmml" mathsize="70%" xref="A1.SS6.p1.7.m7.1.1.2.3">var</mtext></ci></apply><cn id="A1.SS6.p1.7.m7.1.1.3.cmml" type="integer" xref="A1.SS6.p1.7.m7.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.7.m7.1c">\lambda_{\text{var}}=15</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.7.m7.1d">italic_λ start_POSTSUBSCRIPT var end_POSTSUBSCRIPT = 15</annotation></semantics></math>, and <math alttext="\lambda_{\text{mean}}=1" class="ltx_Math" display="inline" id="A1.SS6.p1.8.m8.1"><semantics id="A1.SS6.p1.8.m8.1a"><mrow id="A1.SS6.p1.8.m8.1.1" xref="A1.SS6.p1.8.m8.1.1.cmml"><msub id="A1.SS6.p1.8.m8.1.1.2" xref="A1.SS6.p1.8.m8.1.1.2.cmml"><mi id="A1.SS6.p1.8.m8.1.1.2.2" xref="A1.SS6.p1.8.m8.1.1.2.2.cmml">λ</mi><mtext id="A1.SS6.p1.8.m8.1.1.2.3" xref="A1.SS6.p1.8.m8.1.1.2.3a.cmml">mean</mtext></msub><mo id="A1.SS6.p1.8.m8.1.1.1" xref="A1.SS6.p1.8.m8.1.1.1.cmml">=</mo><mn id="A1.SS6.p1.8.m8.1.1.3" xref="A1.SS6.p1.8.m8.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.8.m8.1b"><apply id="A1.SS6.p1.8.m8.1.1.cmml" xref="A1.SS6.p1.8.m8.1.1"><eq id="A1.SS6.p1.8.m8.1.1.1.cmml" xref="A1.SS6.p1.8.m8.1.1.1"></eq><apply id="A1.SS6.p1.8.m8.1.1.2.cmml" xref="A1.SS6.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="A1.SS6.p1.8.m8.1.1.2.1.cmml" xref="A1.SS6.p1.8.m8.1.1.2">subscript</csymbol><ci id="A1.SS6.p1.8.m8.1.1.2.2.cmml" xref="A1.SS6.p1.8.m8.1.1.2.2">𝜆</ci><ci id="A1.SS6.p1.8.m8.1.1.2.3a.cmml" xref="A1.SS6.p1.8.m8.1.1.2.3"><mtext id="A1.SS6.p1.8.m8.1.1.2.3.cmml" mathsize="70%" xref="A1.SS6.p1.8.m8.1.1.2.3">mean</mtext></ci></apply><cn id="A1.SS6.p1.8.m8.1.1.3.cmml" type="integer" xref="A1.SS6.p1.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.8.m8.1c">\lambda_{\text{mean}}=1</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.8.m8.1d">italic_λ start_POSTSUBSCRIPT mean end_POSTSUBSCRIPT = 1</annotation></semantics></math>.</p>
</div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct  9 16:04:51 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
