<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2404.17799] Personalized Federated Learning via Sequential Layer Expansion in Representation Learning</title><meta property="og:description" content="Federated learning ensures the privacy of clients by conducting distributed training on individual client devices and sharing only the model weights with a central server. However, in real-world scenarios, the heteroge…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Personalized Federated Learning via Sequential Layer Expansion in Representation Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Personalized Federated Learning via Sequential Layer Expansion in Representation Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2404.17799">

<!--Generated on Sun May  5 18:18:42 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Personalized Federated Learning via Sequential 
<br class="ltx_break">Layer Expansion in Representation Learning
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jaewon Jang, Bonjun Choi 
<br class="ltx_break">Computer Science and Engineering 
<br class="ltx_break">Soongsil University 
<br class="ltx_break">Seoul, South Korea
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">{jwon0524, davidchoi}@soongsil.ac.kr</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">Federated learning ensures the privacy of clients by conducting distributed training on individual client devices and sharing only the model weights with a central server. However, in real-world scenarios, the heterogeneity of data among clients necessitates appropriate personalization methods. In this paper, we aim to address this heterogeneity using a form of parameter decoupling known as representation learning. Representation learning divides deep learning models into ’base’ and ’head’ components. The base component, capturing common features across all clients, is shared with the server, while the head component, capturing unique features specific to individual clients, remains local. We propose a new representation learning-based approach that suggests decoupling the entire deep learning model into more densely divided parts with the application of suitable scheduling methods, which can benefit not only data heterogeneity but also class heterogeneity. In this paper, we compare and analyze two layer scheduling approaches, namely forward (<span id="id2.id1.1" class="ltx_text ltx_font_italic">Vanilla</span>) and backward (<span id="id2.id1.2" class="ltx_text ltx_font_italic">Anti</span>), in the context of data and class heterogeneity among clients. Our experimental results show that the proposed algorithm, when compared to existing personalized federated learning algorithms, achieves increased accuracy, especially under challenging conditions, while reducing computation costs.</p>
</div>
<div id="p1" class="ltx_para ltx_noindent">
<p id="p1.3" class="ltx_p"><em id="p1.3.1" class="ltx_emph ltx_font_bold ltx_font_italic">K</em><span id="p1.3.2" class="ltx_text ltx_font_bold">eywords</span> Federated Learning  <math id="p1.1.m1.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.1.m1.1a"><mo id="p1.1.m1.1.1" xref="p1.1.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.1.m1.1b"><ci id="p1.1.m1.1.1.cmml" xref="p1.1.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.1.m1.1c">\cdot</annotation></semantics></math>
Personalized Federated Learning  <math id="p1.2.m2.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.2.m2.1a"><mo id="p1.2.m2.1.1" xref="p1.2.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.2.m2.1b"><ci id="p1.2.m2.1.1.cmml" xref="p1.2.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.2.m2.1c">\cdot</annotation></semantics></math>
Representation Learning  <math id="p1.3.m3.1" class="ltx_Math" alttext="\cdot" display="inline"><semantics id="p1.3.m3.1a"><mo id="p1.3.m3.1.1" xref="p1.3.m3.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.3.m3.1b"><ci id="p1.3.m3.1.1.cmml" xref="p1.3.m3.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.3.m3.1c">\cdot</annotation></semantics></math>
data heterogeniety</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Traditional centralized machine learning collects all raw data to a central server for training. However, concerns about data privacy have grown among companies and researchers in the era of big data. Moreover, the implementation of stringent legal regulations, such as the General Data Protection Regulation (GDPR) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> in Europe and the California Consumer Privacy Act (CCPA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> in the United States, has underscored the need for new methods of collecting and sharing client data that comply with these laws. In this context, federated learning has emerged as a significant research area, allowing the utilization of diverse data distributed across various devices like smartphones, IoT devices, and wearables while ensuring data privacy.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, in contrast to centralized machine learning, does not directly share raw client data with a central server. Instead, it trains models on each edge device and shares only the model’s weights, aggregating them to update a global model. This training approach ensures privacy, as raw data is not shared with the server, and it offers communication cost advantages when dealing with large datasets. However, in real-world scenarios, local data among clients can be highly heterogeneous, exhibiting varying data distributions. This heterogeneity can lower the performance of the global model during server-side aggregation and may introduce bias towards certain clients.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">Therefore, the need for suitable personalization methodologies arises to capture and optimize each client’s unique data characteristics. To address these issues, personalized federated learning (PFL) approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> are actively being researched. In this study, we utilize representation learning which is one of the PFL approaches. Representation learning divides the layers of a deep learning model into <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">base</span> and <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">head</span> components. In representation learning, the <span id="S1.p3.1.3" class="ltx_text ltx_font_italic">base (or feature extractor)</span> part represents common features for all clients and is shared with the server and all clients. The <span id="S1.p3.1.4" class="ltx_text ltx_font_italic">head (or classifier)</span> part represents unique features for specific clients and remains on the local device, not shared with the server. Typically, the <span id="S1.p3.1.5" class="ltx_text ltx_font_italic">head</span> part uses the last fully connected layer (classification layer), and in our experimental setup, we also designate the <span id="S1.p3.1.6" class="ltx_text ltx_font_italic">head</span> part as the last fully connected layer while setting the remaining layers as the <span id="S1.p3.1.7" class="ltx_text ltx_font_italic">base</span> part.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">Our idea originated with the goal of subdividing the components of the deep learning model in representation learning more densely than just the base and head. Additionally, the layer scheduling approach drew inspired from curriculum learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, resulting in the development of both Vanilla and Anti scheduling.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">Curriculum learning is a method that, similar to how human learning, gradually progresses from easy examples to more challenging ones.
Traditional curriculum learning focuses on determining the difficulty of datasets and utilizes pre-trained expert models on the entire dataset to evaluate the difficulty of each data point. Subsequently, it assigns difficulty scores based on the client’s loss using the pre-trained expert model and then conducts training either by starting with easy examples and progressing to harder ones or vice versa. In the recently researched federated learning environment, curriculum learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> also necessitates a well-trained expert model.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">However, curriculum learning relies on expert models to assess the difficulty of data points. This dependence can result in significantly reduced performance if the expert models are compromised by malicious attacks or poorly trained. Furthermore, the process of assigning difficulty scores and dividing datasets based on difficulty can complicate operations in a federated learning environment, as highlighted by  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. In contrast to curriculum learning, our scheduling algorithm does not categorize data based on difficulty levels. Instead, it focuses on decoupling layers according to the principles of representation learning. In typical deep learning models, the initial layers are responsible for extracting low-level features, while the later layers handle the extraction of more complex and abstract features. Building on this insight, we have concentrated on more densely separating the base layer in representation learning algorithms and sequentially training it, deviating from the traditional curriculum learning approach.</p>
</div>
<div id="S1.p7" class="ltx_para ltx_noindent">
<p id="S1.p7.1" class="ltx_p">Hence, our algorithm densely divides the base layer, initially freezing the entire layer set, and then progressively unfreezes specific layers for training according to a schedule. There are two scheduling methods: <span id="S1.p7.1.1" class="ltx_text ltx_font_italic">Vanilla</span> scheduling, which starts by unfreezing layers closest to the input and progresses towards the output, and <span id="S1.p7.1.2" class="ltx_text ltx_font_italic">Anti</span> scheduling, which begins by unfreezing layers nearest to the output and works backward. A key advantage of our proposed algorithm is that, during the early rounds, only a portion of the unfrozen base layer is shared with the server, rather than the entirety. This approach not only enhances performance but also reduces the communication and computational costs compared to other algorithms.</p>
</div>
<div id="S1.p8" class="ltx_para ltx_noindent">
<p id="S1.p8.1" class="ltx_p">The contributions of this paper are as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Our algorithm densely divides the base layer to address the heterogeneity of the client’s data and class distribution, and it proposes two scheduling methods.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">The implementation of scheduling reduces the need to communicate all base layers in the early stages of training, thereby cutting down on communication and computational costs.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">In scenarios with both data and class heterogeneity, the <span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_italic">Anti</span> scheduling approach outperforms other algorithms in terms of accuracy, while the <span id="S1.I1.i3.p1.1.2" class="ltx_text ltx_font_italic">Vanilla</span> scheduling method significantly reduces computational costs compared to other algorithms.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="S1.I1.i4.p1.1" class="ltx_p">We visually present the accuracy for each client and mathematically compare the computational costs of each algorithm.
</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.1" class="ltx_p">Federated Learning is a machine learning technique that enables training while ensuring the privacy of clients’ distributed data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. However, a significant challenge in real-world federated learning scenarios is the heterogeneity of the data distribution among distributed clients, necessitating the application of appropriate personalization techniques.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Personalized Federated Learning</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p">Personalized Federated Learning (PFL) has been proposed to tackle the heterogeneity of client data and can be categorized into several approaches such as Clustering, Meta Learning, and Representation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. This section compares three related personalization methods, including representation learning, which are considered similar.</p>
</div>
<section id="S2.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1 </span>Meta Learning</h4>

<div id="S2.SS2.SSS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.SSS1.p1.1" class="ltx_p">Meta learning, also referred to as learning to learn, was initially proposed for few-shot learning. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> focuses on finding model initialization methods that can rapidly adapt to new and unseen tasks, allowing for the quick learning of new tasks with limited data. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> employs first-order algorithms, which are computationally less complex compared to other meta-learning algorithms, and demonstrates comparable performance without the need for second-order methods.</p>
</div>
</section>
<section id="S2.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2 </span>Transfer Learning</h4>

<div id="S2.SS2.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.SSS2.p1.1" class="ltx_p">Transfer learning has also been proposed for few-shot learning and is a method to apply knowledge learned in a specific domain to a different domain. It involves adapting a pre-trained backbone from a different domain to a similar but distinct domain using the well-known method of fine-tuning. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> helps solve heterogeneity by transferring and learning knowledge between models with different structures. Additionally, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> proposes a federated transfer learning framework for wearable health data.</p>
</div>
</section>
<section id="S2.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.3 </span>Multi-task Learning</h4>

<div id="S2.SS2.SSS3.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.SSS3.p1.1" class="ltx_p">Multi-task learning is a method that can enhance a model’s generalization ability by simultaneously learning multiple tasks and sharing knowledge or representations between these tasks. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, a novel approach is proposed that combines federated learning with multi-task learning. This approach improves the performance of each task by addressing multiple related learning tasks simultaneously, enabling efficient learning through the utilization of shared knowledge.</p>
</div>
</section>
<section id="S2.SS2.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.4 </span>Representaion Learning</h4>

<div id="S2.SS2.SSS4.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.SSS4.p1.1" class="ltx_p">The PFL technique we used is a kind of representation learning, which is a parameter decoupling method to alleviate statistical heterogeneity. Representation learning is a method of training deep learning models by dividing the layers into a base and a head. The base shares common features among clients, while the head layer keeps in locally and is used for personalization  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.</p>
</div>
<div id="S2.SS2.SSS4.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.SSS4.p2.1" class="ltx_p">Moreover, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> argues that it generalizes more easily to new devices compared to other learning mechanisms and that fair representations, which obscure protected attributes, are effectively learned through adversarial training. Additionally, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> demonstrates fast convergence in linear regression problems by leveraging distributed computational power among clients to perform many local updates. Furthermore, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> shows that there is a discrepancy in the validation methods between general federated learning algorithms and personalized federated learning algorithms. They argue that both local and global model accuracy should be considered and introduce a new loss function to mitigate class imbalance issues. In addition, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> suggests that updating the head in cases where client data is highly heterogeneous can negatively affect personalization. Therefore, during training rounds, a randomly initialized head is used, employing only the body for training and aggregation. We adopt a similar training setup <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, using a randomly initialized head during training rounds, and the head is only utilized in the final fine-tuning after the training rounds are completed.</p>
</div>
</section>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Algorithm</h2>

<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>List of Symbols Used</figcaption>
<table id="S3.T1.20" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.20.21.1" class="ltx_tr">
<th id="S3.T1.20.21.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Symbol</th>
<th id="S3.T1.20.21.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t">
<span id="S3.T1.20.21.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.20.21.1.2.1.1" class="ltx_p" style="width:199.2pt;">Description</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><mi id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><ci id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">N</annotation></semantics></math></th>
<td id="S3.T1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.1.2.1.1" class="ltx_p" style="width:199.2pt;">Total number of clients</span>
</span>
</td>
</tr>
<tr id="S3.T1.4.4" class="ltx_tr">
<th id="S3.T1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S3.T1.2.2.1.m1.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.T1.2.2.1.m1.1a"><msub id="S3.T1.2.2.1.m1.1.1" xref="S3.T1.2.2.1.m1.1.1.cmml"><mi id="S3.T1.2.2.1.m1.1.1.2" xref="S3.T1.2.2.1.m1.1.1.2.cmml">C</mi><mi id="S3.T1.2.2.1.m1.1.1.3" xref="S3.T1.2.2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.1.m1.1b"><apply id="S3.T1.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.2.2.1.m1.1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.2.2.1.m1.1.1.2.cmml" xref="S3.T1.2.2.1.m1.1.1.2">𝐶</ci><ci id="S3.T1.2.2.1.m1.1.1.3.cmml" xref="S3.T1.2.2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.1.m1.1c">C_{i}</annotation></semantics></math></th>
<td id="S3.T1.4.4.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.4.4.3.2" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.4.4.3.2.2" class="ltx_p" style="width:199.2pt;">Client <math id="S3.T1.3.3.2.1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.T1.3.3.2.1.1.m1.1a"><mi id="S3.T1.3.3.2.1.1.m1.1.1" xref="S3.T1.3.3.2.1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.2.1.1.m1.1b"><ci id="S3.T1.3.3.2.1.1.m1.1.1.cmml" xref="S3.T1.3.3.2.1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.2.1.1.m1.1c">i</annotation></semantics></math>, <math id="S3.T1.4.4.3.2.2.m2.4" class="ltx_Math" alttext="i\in\{1,2,\ldots,N\}" display="inline"><semantics id="S3.T1.4.4.3.2.2.m2.4a"><mrow id="S3.T1.4.4.3.2.2.m2.4.5" xref="S3.T1.4.4.3.2.2.m2.4.5.cmml"><mi id="S3.T1.4.4.3.2.2.m2.4.5.2" xref="S3.T1.4.4.3.2.2.m2.4.5.2.cmml">i</mi><mo id="S3.T1.4.4.3.2.2.m2.4.5.1" xref="S3.T1.4.4.3.2.2.m2.4.5.1.cmml">∈</mo><mrow id="S3.T1.4.4.3.2.2.m2.4.5.3.2" xref="S3.T1.4.4.3.2.2.m2.4.5.3.1.cmml"><mo stretchy="false" id="S3.T1.4.4.3.2.2.m2.4.5.3.2.1" xref="S3.T1.4.4.3.2.2.m2.4.5.3.1.cmml">{</mo><mn id="S3.T1.4.4.3.2.2.m2.1.1" xref="S3.T1.4.4.3.2.2.m2.1.1.cmml">1</mn><mo id="S3.T1.4.4.3.2.2.m2.4.5.3.2.2" xref="S3.T1.4.4.3.2.2.m2.4.5.3.1.cmml">,</mo><mn id="S3.T1.4.4.3.2.2.m2.2.2" xref="S3.T1.4.4.3.2.2.m2.2.2.cmml">2</mn><mo id="S3.T1.4.4.3.2.2.m2.4.5.3.2.3" xref="S3.T1.4.4.3.2.2.m2.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.T1.4.4.3.2.2.m2.3.3" xref="S3.T1.4.4.3.2.2.m2.3.3.cmml">…</mi><mo id="S3.T1.4.4.3.2.2.m2.4.5.3.2.4" xref="S3.T1.4.4.3.2.2.m2.4.5.3.1.cmml">,</mo><mi id="S3.T1.4.4.3.2.2.m2.4.4" xref="S3.T1.4.4.3.2.2.m2.4.4.cmml">N</mi><mo stretchy="false" id="S3.T1.4.4.3.2.2.m2.4.5.3.2.5" xref="S3.T1.4.4.3.2.2.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.3.2.2.m2.4b"><apply id="S3.T1.4.4.3.2.2.m2.4.5.cmml" xref="S3.T1.4.4.3.2.2.m2.4.5"><in id="S3.T1.4.4.3.2.2.m2.4.5.1.cmml" xref="S3.T1.4.4.3.2.2.m2.4.5.1"></in><ci id="S3.T1.4.4.3.2.2.m2.4.5.2.cmml" xref="S3.T1.4.4.3.2.2.m2.4.5.2">𝑖</ci><set id="S3.T1.4.4.3.2.2.m2.4.5.3.1.cmml" xref="S3.T1.4.4.3.2.2.m2.4.5.3.2"><cn type="integer" id="S3.T1.4.4.3.2.2.m2.1.1.cmml" xref="S3.T1.4.4.3.2.2.m2.1.1">1</cn><cn type="integer" id="S3.T1.4.4.3.2.2.m2.2.2.cmml" xref="S3.T1.4.4.3.2.2.m2.2.2">2</cn><ci id="S3.T1.4.4.3.2.2.m2.3.3.cmml" xref="S3.T1.4.4.3.2.2.m2.3.3">…</ci><ci id="S3.T1.4.4.3.2.2.m2.4.4.cmml" xref="S3.T1.4.4.3.2.2.m2.4.4">𝑁</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.3.2.2.m2.4c">i\in\{1,2,\ldots,N\}</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S3.T1.6.6" class="ltx_tr">
<th id="S3.T1.5.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S3.T1.5.5.1.m1.1" class="ltx_Math" alttext="|D_{i}|" display="inline"><semantics id="S3.T1.5.5.1.m1.1a"><mrow id="S3.T1.5.5.1.m1.1.1.1" xref="S3.T1.5.5.1.m1.1.1.2.cmml"><mo stretchy="false" id="S3.T1.5.5.1.m1.1.1.1.2" xref="S3.T1.5.5.1.m1.1.1.2.1.cmml">|</mo><msub id="S3.T1.5.5.1.m1.1.1.1.1" xref="S3.T1.5.5.1.m1.1.1.1.1.cmml"><mi id="S3.T1.5.5.1.m1.1.1.1.1.2" xref="S3.T1.5.5.1.m1.1.1.1.1.2.cmml">D</mi><mi id="S3.T1.5.5.1.m1.1.1.1.1.3" xref="S3.T1.5.5.1.m1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.T1.5.5.1.m1.1.1.1.3" xref="S3.T1.5.5.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.1.m1.1b"><apply id="S3.T1.5.5.1.m1.1.1.2.cmml" xref="S3.T1.5.5.1.m1.1.1.1"><abs id="S3.T1.5.5.1.m1.1.1.2.1.cmml" xref="S3.T1.5.5.1.m1.1.1.1.2"></abs><apply id="S3.T1.5.5.1.m1.1.1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.5.5.1.m1.1.1.1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.5.5.1.m1.1.1.1.1.2.cmml" xref="S3.T1.5.5.1.m1.1.1.1.1.2">𝐷</ci><ci id="S3.T1.5.5.1.m1.1.1.1.1.3.cmml" xref="S3.T1.5.5.1.m1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.1.m1.1c">|D_{i}|</annotation></semantics></math></th>
<td id="S3.T1.6.6.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.6.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.6.6.2.1.1" class="ltx_p" style="width:199.2pt;">Number of data points for client <math id="S3.T1.6.6.2.1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.T1.6.6.2.1.1.m1.1a"><mi id="S3.T1.6.6.2.1.1.m1.1.1" xref="S3.T1.6.6.2.1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.2.1.1.m1.1b"><ci id="S3.T1.6.6.2.1.1.m1.1.1.cmml" xref="S3.T1.6.6.2.1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.2.1.1.m1.1c">i</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S3.T1.7.7" class="ltx_tr">
<th id="S3.T1.7.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S3.T1.7.7.1.m1.1" class="ltx_Math" alttext="|D|" display="inline"><semantics id="S3.T1.7.7.1.m1.1a"><mrow id="S3.T1.7.7.1.m1.1.2.2" xref="S3.T1.7.7.1.m1.1.2.1.cmml"><mo stretchy="false" id="S3.T1.7.7.1.m1.1.2.2.1" xref="S3.T1.7.7.1.m1.1.2.1.1.cmml">|</mo><mi id="S3.T1.7.7.1.m1.1.1" xref="S3.T1.7.7.1.m1.1.1.cmml">D</mi><mo stretchy="false" id="S3.T1.7.7.1.m1.1.2.2.2" xref="S3.T1.7.7.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.1.m1.1b"><apply id="S3.T1.7.7.1.m1.1.2.1.cmml" xref="S3.T1.7.7.1.m1.1.2.2"><abs id="S3.T1.7.7.1.m1.1.2.1.1.cmml" xref="S3.T1.7.7.1.m1.1.2.2.1"></abs><ci id="S3.T1.7.7.1.m1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.1.m1.1c">|D|</annotation></semantics></math></th>
<td id="S3.T1.7.7.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.7.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.7.7.2.1.1" class="ltx_p" style="width:199.2pt;">Total number of data points</span>
</span>
</td>
</tr>
<tr id="S3.T1.8.8" class="ltx_tr">
<th id="S3.T1.8.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S3.T1.8.8.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.T1.8.8.1.m1.1a"><mi id="S3.T1.8.8.1.m1.1.1" xref="S3.T1.8.8.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.1.m1.1b"><ci id="S3.T1.8.8.1.m1.1.1.cmml" xref="S3.T1.8.8.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.1.m1.1c">T</annotation></semantics></math></th>
<td id="S3.T1.8.8.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.8.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.8.8.2.1.1" class="ltx_p" style="width:199.2pt;">Total global rounds</span>
</span>
</td>
</tr>
<tr id="S3.T1.9.9" class="ltx_tr">
<th id="S3.T1.9.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S3.T1.9.9.1.m1.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S3.T1.9.9.1.m1.1a"><mi id="S3.T1.9.9.1.m1.1.1" xref="S3.T1.9.9.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.1.m1.1b"><ci id="S3.T1.9.9.1.m1.1.1.cmml" xref="S3.T1.9.9.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.1.m1.1c">F</annotation></semantics></math></th>
<td id="S3.T1.9.9.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.9.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.9.9.2.1.1" class="ltx_p" style="width:199.2pt;">Fine-tuning rounds</span>
</span>
</td>
</tr>
<tr id="S3.T1.10.10" class="ltx_tr">
<th id="S3.T1.10.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S3.T1.10.10.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.T1.10.10.1.m1.1a"><mi id="S3.T1.10.10.1.m1.1.1" xref="S3.T1.10.10.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.1.m1.1b"><ci id="S3.T1.10.10.1.m1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.1.m1.1c">K</annotation></semantics></math></th>
<td id="S3.T1.10.10.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.10.10.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.10.10.2.1.1" class="ltx_p" style="width:199.2pt;">Total number of base layers</span>
</span>
</td>
</tr>
<tr id="S3.T1.12.12" class="ltx_tr">
<th id="S3.T1.11.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S3.T1.11.11.1.m1.1" class="ltx_Math" alttext="t_{k}" display="inline"><semantics id="S3.T1.11.11.1.m1.1a"><msub id="S3.T1.11.11.1.m1.1.1" xref="S3.T1.11.11.1.m1.1.1.cmml"><mi id="S3.T1.11.11.1.m1.1.1.2" xref="S3.T1.11.11.1.m1.1.1.2.cmml">t</mi><mi id="S3.T1.11.11.1.m1.1.1.3" xref="S3.T1.11.11.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.1.m1.1b"><apply id="S3.T1.11.11.1.m1.1.1.cmml" xref="S3.T1.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.11.11.1.m1.1.1.1.cmml" xref="S3.T1.11.11.1.m1.1.1">subscript</csymbol><ci id="S3.T1.11.11.1.m1.1.1.2.cmml" xref="S3.T1.11.11.1.m1.1.1.2">𝑡</ci><ci id="S3.T1.11.11.1.m1.1.1.3.cmml" xref="S3.T1.11.11.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.1.m1.1c">t_{k}</annotation></semantics></math></th>
<td id="S3.T1.12.12.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.12.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.12.12.2.1.1" class="ltx_p" style="width:199.2pt;">Unfreeze point (round) of <math id="S3.T1.12.12.2.1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.T1.12.12.2.1.1.m1.1a"><mi id="S3.T1.12.12.2.1.1.m1.1.1" xref="S3.T1.12.12.2.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.2.1.1.m1.1b"><ci id="S3.T1.12.12.2.1.1.m1.1.1.cmml" xref="S3.T1.12.12.2.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.2.1.1.m1.1c">k</annotation></semantics></math>-th layer</span>
</span>
</td>
</tr>
<tr id="S3.T1.13.13" class="ltx_tr">
<th id="S3.T1.13.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S3.T1.13.13.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.T1.13.13.1.m1.1a"><mi id="S3.T1.13.13.1.m1.1.1" xref="S3.T1.13.13.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.1.m1.1b"><ci id="S3.T1.13.13.1.m1.1.1.cmml" xref="S3.T1.13.13.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.1.m1.1c">\eta</annotation></semantics></math></th>
<td id="S3.T1.13.13.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.13.13.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.13.13.2.1.1" class="ltx_p" style="width:199.2pt;">Learning Rate</span>
</span>
</td>
</tr>
<tr id="S3.T1.14.14" class="ltx_tr">
<th id="S3.T1.14.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S3.T1.14.14.1.m1.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.T1.14.14.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.T1.14.14.1.m1.1.1" xref="S3.T1.14.14.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.1.m1.1b"><ci id="S3.T1.14.14.1.m1.1.1.cmml" xref="S3.T1.14.14.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.1.m1.1c">\mathcal{L}</annotation></semantics></math></th>
<td id="S3.T1.14.14.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.14.14.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.14.14.2.1.1" class="ltx_p" style="width:199.2pt;">Loss Function</span>
</span>
</td>
</tr>
<tr id="S3.T1.16.16" class="ltx_tr">
<th id="S3.T1.15.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S3.T1.15.15.1.m1.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.T1.15.15.1.m1.1a"><msub id="S3.T1.15.15.1.m1.1.1" xref="S3.T1.15.15.1.m1.1.1.cmml"><mi id="S3.T1.15.15.1.m1.1.1.2" xref="S3.T1.15.15.1.m1.1.1.2.cmml">θ</mi><mi id="S3.T1.15.15.1.m1.1.1.3" xref="S3.T1.15.15.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.1.m1.1b"><apply id="S3.T1.15.15.1.m1.1.1.cmml" xref="S3.T1.15.15.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.15.15.1.m1.1.1.1.cmml" xref="S3.T1.15.15.1.m1.1.1">subscript</csymbol><ci id="S3.T1.15.15.1.m1.1.1.2.cmml" xref="S3.T1.15.15.1.m1.1.1.2">𝜃</ci><ci id="S3.T1.15.15.1.m1.1.1.3.cmml" xref="S3.T1.15.15.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.1.m1.1c">\theta_{i}</annotation></semantics></math></th>
<td id="S3.T1.16.16.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.16.16.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.16.16.2.1.1" class="ltx_p" style="width:199.2pt;">Local parameter for client <math id="S3.T1.16.16.2.1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.T1.16.16.2.1.1.m1.1a"><mi id="S3.T1.16.16.2.1.1.m1.1.1" xref="S3.T1.16.16.2.1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.T1.16.16.2.1.1.m1.1b"><ci id="S3.T1.16.16.2.1.1.m1.1.1.cmml" xref="S3.T1.16.16.2.1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.16.2.1.1.m1.1c">i</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S3.T1.17.17" class="ltx_tr">
<th id="S3.T1.17.17.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S3.T1.17.17.1.m1.1" class="ltx_Math" alttext="\theta_{G}" display="inline"><semantics id="S3.T1.17.17.1.m1.1a"><msub id="S3.T1.17.17.1.m1.1.1" xref="S3.T1.17.17.1.m1.1.1.cmml"><mi id="S3.T1.17.17.1.m1.1.1.2" xref="S3.T1.17.17.1.m1.1.1.2.cmml">θ</mi><mi id="S3.T1.17.17.1.m1.1.1.3" xref="S3.T1.17.17.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.17.17.1.m1.1b"><apply id="S3.T1.17.17.1.m1.1.1.cmml" xref="S3.T1.17.17.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.17.17.1.m1.1.1.1.cmml" xref="S3.T1.17.17.1.m1.1.1">subscript</csymbol><ci id="S3.T1.17.17.1.m1.1.1.2.cmml" xref="S3.T1.17.17.1.m1.1.1.2">𝜃</ci><ci id="S3.T1.17.17.1.m1.1.1.3.cmml" xref="S3.T1.17.17.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.17.1.m1.1c">\theta_{G}</annotation></semantics></math></th>
<td id="S3.T1.17.17.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.17.17.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.17.17.2.1.1" class="ltx_p" style="width:199.2pt;">Global model parameter</span>
</span>
</td>
</tr>
<tr id="S3.T1.18.18" class="ltx_tr">
<th id="S3.T1.18.18.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S3.T1.18.18.1.m1.2" class="ltx_Math" alttext="\theta_{i,b}" display="inline"><semantics id="S3.T1.18.18.1.m1.2a"><msub id="S3.T1.18.18.1.m1.2.3" xref="S3.T1.18.18.1.m1.2.3.cmml"><mi id="S3.T1.18.18.1.m1.2.3.2" xref="S3.T1.18.18.1.m1.2.3.2.cmml">θ</mi><mrow id="S3.T1.18.18.1.m1.2.2.2.4" xref="S3.T1.18.18.1.m1.2.2.2.3.cmml"><mi id="S3.T1.18.18.1.m1.1.1.1.1" xref="S3.T1.18.18.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.T1.18.18.1.m1.2.2.2.4.1" xref="S3.T1.18.18.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.T1.18.18.1.m1.2.2.2.2" xref="S3.T1.18.18.1.m1.2.2.2.2.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.18.18.1.m1.2b"><apply id="S3.T1.18.18.1.m1.2.3.cmml" xref="S3.T1.18.18.1.m1.2.3"><csymbol cd="ambiguous" id="S3.T1.18.18.1.m1.2.3.1.cmml" xref="S3.T1.18.18.1.m1.2.3">subscript</csymbol><ci id="S3.T1.18.18.1.m1.2.3.2.cmml" xref="S3.T1.18.18.1.m1.2.3.2">𝜃</ci><list id="S3.T1.18.18.1.m1.2.2.2.3.cmml" xref="S3.T1.18.18.1.m1.2.2.2.4"><ci id="S3.T1.18.18.1.m1.1.1.1.1.cmml" xref="S3.T1.18.18.1.m1.1.1.1.1">𝑖</ci><ci id="S3.T1.18.18.1.m1.2.2.2.2.cmml" xref="S3.T1.18.18.1.m1.2.2.2.2">𝑏</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.18.1.m1.2c">\theta_{i,b}</annotation></semantics></math></th>
<td id="S3.T1.18.18.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.18.18.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.18.18.2.1.1" class="ltx_p" style="width:199.2pt;">Base parameter shared among all clients</span>
</span>
</td>
</tr>
<tr id="S3.T1.20.20" class="ltx_tr">
<th id="S3.T1.19.19.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r"><math id="S3.T1.19.19.1.m1.2" class="ltx_Math" alttext="\theta_{i,p}" display="inline"><semantics id="S3.T1.19.19.1.m1.2a"><msub id="S3.T1.19.19.1.m1.2.3" xref="S3.T1.19.19.1.m1.2.3.cmml"><mi id="S3.T1.19.19.1.m1.2.3.2" xref="S3.T1.19.19.1.m1.2.3.2.cmml">θ</mi><mrow id="S3.T1.19.19.1.m1.2.2.2.4" xref="S3.T1.19.19.1.m1.2.2.2.3.cmml"><mi id="S3.T1.19.19.1.m1.1.1.1.1" xref="S3.T1.19.19.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.T1.19.19.1.m1.2.2.2.4.1" xref="S3.T1.19.19.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.T1.19.19.1.m1.2.2.2.2" xref="S3.T1.19.19.1.m1.2.2.2.2.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.19.19.1.m1.2b"><apply id="S3.T1.19.19.1.m1.2.3.cmml" xref="S3.T1.19.19.1.m1.2.3"><csymbol cd="ambiguous" id="S3.T1.19.19.1.m1.2.3.1.cmml" xref="S3.T1.19.19.1.m1.2.3">subscript</csymbol><ci id="S3.T1.19.19.1.m1.2.3.2.cmml" xref="S3.T1.19.19.1.m1.2.3.2">𝜃</ci><list id="S3.T1.19.19.1.m1.2.2.2.3.cmml" xref="S3.T1.19.19.1.m1.2.2.2.4"><ci id="S3.T1.19.19.1.m1.1.1.1.1.cmml" xref="S3.T1.19.19.1.m1.1.1.1.1">𝑖</ci><ci id="S3.T1.19.19.1.m1.2.2.2.2.cmml" xref="S3.T1.19.19.1.m1.2.2.2.2">𝑝</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.19.19.1.m1.2c">\theta_{i,p}</annotation></semantics></math></th>
<td id="S3.T1.20.20.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b">
<span id="S3.T1.20.20.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.20.20.2.1.1" class="ltx_p" style="width:199.2pt;">Head parameter of client <math id="S3.T1.20.20.2.1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.T1.20.20.2.1.1.m1.1a"><mi id="S3.T1.20.20.2.1.1.m1.1.1" xref="S3.T1.20.20.2.1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.T1.20.20.2.1.1.m1.1b"><ci id="S3.T1.20.20.2.1.1.m1.1.1.cmml" xref="S3.T1.20.20.2.1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.20.20.2.1.1.m1.1c">i</annotation></semantics></math></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">In this section, we present our proposed algorithms in detail, namely <span id="S3.p1.1.1" class="ltx_text ltx_font_italic">Vanilla Scheduling</span> and <span id="S3.p1.1.2" class="ltx_text ltx_font_italic">Anti Scheduling</span>. As shown in Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Proposed Algorithm ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, Vanilla Scheduling starts by unfreezing the shallowest layers (closest to the input) and progressively moves towards deeper layers. This method allows the model to capture low-level features early in the training process, which is crucial for building a strong foundational understanding before more high-level features are introduced. Conversely, Anti Scheduling begins with the deepest layers (closest to the output) and progressively unfreezes towards the input. This approach prioritizes the learning of high-level features from the outset, which can be beneficial for complex pattern recognition tasks that depend heavily on such features.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2404.17799/assets/figure/vanilla_anti_flow.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="320" height="180" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration of the proposed Vanilla and Anti Scheduling algorithms. The upper shows Vanilla Scheduling, starting with the shallowest layer and advancing to deeper ones. The lower shows Anti Scheduling, which begins with the deepest layer and progresses inversely.</figcaption>
</figure>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p">As shown in Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Proposed Algorithm ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the structured progression from shallow to deep layers in Vanilla Scheduling, and the reverse in Anti Scheduling, structurally differ from traditional representation learning. In traditional representation learning methods, the base and head of the model are typically trained simultaneously without specific layer prioritization. In our approach, however, each layer’s training is specifically timed and prioritized. This strategic scheduling enhances the model’s ability to adapt to varying complexities of features throughout the training process.</p>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.1" class="ltx_p">Furthermore, as detailed in Section <a href="#S5.SS2" title="5.2 Estimation of Computational Cost for Each Algorithm ‣ 5 Ablation Study ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>, Vanilla Scheduling can achieve comparable accuracy with significantly lower computational costs in environments characterized by high data and class heterogeneity. In contrast, Anti Scheduling excels in achieving the highest accuracy in scenarios where both data and class heterogeneity are pronounced. They both follow the basic federated learning setup and the representation learning as explained below.</p>
</div>
<div id="S3.p4" class="ltx_para ltx_noindent">
<p id="S3.p4.10" class="ltx_p">As a basic federated learning setup, we assume that each client <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.p4.1.m1.1a"><msub id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">C</mi><mi id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2">𝐶</ci><ci id="S3.p4.1.m1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">C_{i}</annotation></semantics></math> possess data <math id="S3.p4.2.m2.1" class="ltx_math_unparsed" alttext="\mathbf{D}_{i}=\textbf{(}{x}_{i},y_{i})\in R^{d}" display="inline"><semantics id="S3.p4.2.m2.1a"><mrow id="S3.p4.2.m2.1b"><msub id="S3.p4.2.m2.1.1"><mi id="S3.p4.2.m2.1.1.2">𝐃</mi><mi id="S3.p4.2.m2.1.1.3">i</mi></msub><mo id="S3.p4.2.m2.1.2">=</mo><mtext class="ltx_mathvariant_bold" id="S3.p4.2.m2.1.3">(</mtext><msub id="S3.p4.2.m2.1.4"><mi id="S3.p4.2.m2.1.4.2">x</mi><mi id="S3.p4.2.m2.1.4.3">i</mi></msub><mo id="S3.p4.2.m2.1.5">,</mo><msub id="S3.p4.2.m2.1.6"><mi id="S3.p4.2.m2.1.6.2">y</mi><mi id="S3.p4.2.m2.1.6.3">i</mi></msub><mo stretchy="false" id="S3.p4.2.m2.1.7">)</mo><mo id="S3.p4.2.m2.1.8">∈</mo><mi id="S3.p4.2.m2.1.9">R</mi><msup id="S3.p4.2.m2.1.10"><mi id="S3.p4.2.m2.1.10a"></mi><mi id="S3.p4.2.m2.1.10.1">d</mi></msup></mrow><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">\mathbf{D}_{i}=\textbf{(}{x}_{i},y_{i})\in R^{d}</annotation></semantics></math>, where <math id="S3.p4.3.m3.4" class="ltx_Math" alttext="i\in{1,2,\ldots,N}" display="inline"><semantics id="S3.p4.3.m3.4a"><mrow id="S3.p4.3.m3.4.5" xref="S3.p4.3.m3.4.5.cmml"><mi id="S3.p4.3.m3.4.5.2" xref="S3.p4.3.m3.4.5.2.cmml">i</mi><mo id="S3.p4.3.m3.4.5.1" xref="S3.p4.3.m3.4.5.1.cmml">∈</mo><mrow id="S3.p4.3.m3.4.5.3.2" xref="S3.p4.3.m3.4.5.3.1.cmml"><mn id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml">1</mn><mo id="S3.p4.3.m3.4.5.3.2.1" xref="S3.p4.3.m3.4.5.3.1.cmml">,</mo><mn id="S3.p4.3.m3.2.2" xref="S3.p4.3.m3.2.2.cmml">2</mn><mo id="S3.p4.3.m3.4.5.3.2.2" xref="S3.p4.3.m3.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.p4.3.m3.3.3" xref="S3.p4.3.m3.3.3.cmml">…</mi><mo id="S3.p4.3.m3.4.5.3.2.3" xref="S3.p4.3.m3.4.5.3.1.cmml">,</mo><mi id="S3.p4.3.m3.4.4" xref="S3.p4.3.m3.4.4.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.4b"><apply id="S3.p4.3.m3.4.5.cmml" xref="S3.p4.3.m3.4.5"><in id="S3.p4.3.m3.4.5.1.cmml" xref="S3.p4.3.m3.4.5.1"></in><ci id="S3.p4.3.m3.4.5.2.cmml" xref="S3.p4.3.m3.4.5.2">𝑖</ci><list id="S3.p4.3.m3.4.5.3.1.cmml" xref="S3.p4.3.m3.4.5.3.2"><cn type="integer" id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1">1</cn><cn type="integer" id="S3.p4.3.m3.2.2.cmml" xref="S3.p4.3.m3.2.2">2</cn><ci id="S3.p4.3.m3.3.3.cmml" xref="S3.p4.3.m3.3.3">…</ci><ci id="S3.p4.3.m3.4.4.cmml" xref="S3.p4.3.m3.4.4">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.4c">i\in{1,2,\ldots,N}</annotation></semantics></math> represents <math id="S3.p4.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p4.4.m4.1a"><mi id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><ci id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">i</annotation></semantics></math>-th client out of a total of <math id="S3.p4.5.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p4.5.m5.1a"><mi id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><ci id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">N</annotation></semantics></math> clients and <math id="S3.p4.6.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.p4.6.m6.1a"><mi id="S3.p4.6.m6.1.1" xref="S3.p4.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.p4.6.m6.1b"><ci id="S3.p4.6.m6.1.1.cmml" xref="S3.p4.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m6.1c">d</annotation></semantics></math> represents the input dimension. Each client <math id="S3.p4.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p4.7.m7.1a"><mi id="S3.p4.7.m7.1.1" xref="S3.p4.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p4.7.m7.1b"><ci id="S3.p4.7.m7.1.1.cmml" xref="S3.p4.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.m7.1c">i</annotation></semantics></math> updates its local model parameter <math id="S3.p4.8.m8.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.p4.8.m8.1a"><msub id="S3.p4.8.m8.1.1" xref="S3.p4.8.m8.1.1.cmml"><mi id="S3.p4.8.m8.1.1.2" xref="S3.p4.8.m8.1.1.2.cmml">θ</mi><mi id="S3.p4.8.m8.1.1.3" xref="S3.p4.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.8.m8.1b"><apply id="S3.p4.8.m8.1.1.cmml" xref="S3.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p4.8.m8.1.1.1.cmml" xref="S3.p4.8.m8.1.1">subscript</csymbol><ci id="S3.p4.8.m8.1.1.2.cmml" xref="S3.p4.8.m8.1.1.2">𝜃</ci><ci id="S3.p4.8.m8.1.1.3.cmml" xref="S3.p4.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.8.m8.1c">\theta_{i}</annotation></semantics></math> based on its data <math id="S3.p4.9.m9.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S3.p4.9.m9.1a"><msub id="S3.p4.9.m9.1.1" xref="S3.p4.9.m9.1.1.cmml"><mi id="S3.p4.9.m9.1.1.2" xref="S3.p4.9.m9.1.1.2.cmml">D</mi><mi id="S3.p4.9.m9.1.1.3" xref="S3.p4.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.9.m9.1b"><apply id="S3.p4.9.m9.1.1.cmml" xref="S3.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p4.9.m9.1.1.1.cmml" xref="S3.p4.9.m9.1.1">subscript</csymbol><ci id="S3.p4.9.m9.1.1.2.cmml" xref="S3.p4.9.m9.1.1.2">𝐷</ci><ci id="S3.p4.9.m9.1.1.3.cmml" xref="S3.p4.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.9.m9.1c">D_{i}</annotation></semantics></math> and the global model parameter <math id="S3.p4.10.m10.1" class="ltx_Math" alttext="\theta_{G}" display="inline"><semantics id="S3.p4.10.m10.1a"><msub id="S3.p4.10.m10.1.1" xref="S3.p4.10.m10.1.1.cmml"><mi id="S3.p4.10.m10.1.1.2" xref="S3.p4.10.m10.1.1.2.cmml">θ</mi><mi id="S3.p4.10.m10.1.1.3" xref="S3.p4.10.m10.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.10.m10.1b"><apply id="S3.p4.10.m10.1.1.cmml" xref="S3.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p4.10.m10.1.1.1.cmml" xref="S3.p4.10.m10.1.1">subscript</csymbol><ci id="S3.p4.10.m10.1.1.2.cmml" xref="S3.p4.10.m10.1.1.2">𝜃</ci><ci id="S3.p4.10.m10.1.1.3.cmml" xref="S3.p4.10.m10.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.10.m10.1c">\theta_{G}</annotation></semantics></math> as</p>
</div>
<div id="S3.p5" class="ltx_para ltx_noindent">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="\theta_{i}^{(t+1)}=\theta_{i}^{(t)}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},\theta_{i}^{(t)})," display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4.1" xref="S3.E1.m1.4.4.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><msubsup id="S3.E1.m1.4.4.1.1.4" xref="S3.E1.m1.4.4.1.1.4.cmml"><mi id="S3.E1.m1.4.4.1.1.4.2.2" xref="S3.E1.m1.4.4.1.1.4.2.2.cmml">θ</mi><mi id="S3.E1.m1.4.4.1.1.4.2.3" xref="S3.E1.m1.4.4.1.1.4.2.3.cmml">i</mi><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E1.m1.4.4.1.1.3" xref="S3.E1.m1.4.4.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml"><msubsup id="S3.E1.m1.4.4.1.1.2.4" xref="S3.E1.m1.4.4.1.1.2.4.cmml"><mi id="S3.E1.m1.4.4.1.1.2.4.2.2" xref="S3.E1.m1.4.4.1.1.2.4.2.2.cmml">θ</mi><mi id="S3.E1.m1.4.4.1.1.2.4.2.3" xref="S3.E1.m1.4.4.1.1.2.4.2.3.cmml">i</mi><mrow id="S3.E1.m1.2.2.1.3" xref="S3.E1.m1.4.4.1.1.2.4.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.1.3.1" xref="S3.E1.m1.4.4.1.1.2.4.cmml">(</mo><mi id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S3.E1.m1.2.2.1.3.2" xref="S3.E1.m1.4.4.1.1.2.4.cmml">)</mo></mrow></msubsup><mo id="S3.E1.m1.4.4.1.1.2.3" xref="S3.E1.m1.4.4.1.1.2.3.cmml">−</mo><mrow id="S3.E1.m1.4.4.1.1.2.2" xref="S3.E1.m1.4.4.1.1.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.4" xref="S3.E1.m1.4.4.1.1.2.2.4.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.4.4.1.1.2.2.5" xref="S3.E1.m1.4.4.1.1.2.2.5.cmml"><msub id="S3.E1.m1.4.4.1.1.2.2.5.1" xref="S3.E1.m1.4.4.1.1.2.2.5.1.cmml"><mo rspace="0.167em" id="S3.E1.m1.4.4.1.1.2.2.5.1.2" xref="S3.E1.m1.4.4.1.1.2.2.5.1.2.cmml">∇</mo><msub id="S3.E1.m1.4.4.1.1.2.2.5.1.3" xref="S3.E1.m1.4.4.1.1.2.2.5.1.3.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.5.1.3.2" xref="S3.E1.m1.4.4.1.1.2.2.5.1.3.2.cmml">θ</mi><mi id="S3.E1.m1.4.4.1.1.2.2.5.1.3.3" xref="S3.E1.m1.4.4.1.1.2.2.5.1.3.3.cmml">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.1.1.2.2.5.2" xref="S3.E1.m1.4.4.1.1.2.2.5.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.2.3a" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.4.4.1.1.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.1.1.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.2.3.cmml">(</mo><msub id="S3.E1.m1.4.4.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml">D</mi><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.4.4.1.1.2.2.2.2.4" xref="S3.E1.m1.4.4.1.1.2.2.2.3.cmml">,</mo><msubsup id="S3.E1.m1.4.4.1.1.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.cmml">θ</mi><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.E1.m1.3.3.1.3" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.3.1" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml">(</mo><mi id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.3.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E1.m1.4.4.1.1.2.2.2.2.5" xref="S3.E1.m1.4.4.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.4.4.1.2" xref="S3.E1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1"><eq id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3"></eq><apply id="S3.E1.m1.4.4.1.1.4.cmml" xref="S3.E1.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.4.1.cmml" xref="S3.E1.m1.4.4.1.1.4">superscript</csymbol><apply id="S3.E1.m1.4.4.1.1.4.2.cmml" xref="S3.E1.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.4.2.1.cmml" xref="S3.E1.m1.4.4.1.1.4">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.4.2.2.cmml" xref="S3.E1.m1.4.4.1.1.4.2.2">𝜃</ci><ci id="S3.E1.m1.4.4.1.1.4.2.3.cmml" xref="S3.E1.m1.4.4.1.1.4.2.3">𝑖</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><plus id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"></plus><ci id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2"><minus id="S3.E1.m1.4.4.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.3"></minus><apply id="S3.E1.m1.4.4.1.1.2.4.cmml" xref="S3.E1.m1.4.4.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.4.1.cmml" xref="S3.E1.m1.4.4.1.1.2.4">superscript</csymbol><apply id="S3.E1.m1.4.4.1.1.2.4.2.cmml" xref="S3.E1.m1.4.4.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.4.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.4">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.4.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.4.2.2">𝜃</ci><ci id="S3.E1.m1.4.4.1.1.2.4.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.4.2.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1.1">𝑡</ci></apply><apply id="S3.E1.m1.4.4.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2"><times id="S3.E1.m1.4.4.1.1.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.3"></times><ci id="S3.E1.m1.4.4.1.1.2.2.4.cmml" xref="S3.E1.m1.4.4.1.1.2.2.4">𝜂</ci><apply id="S3.E1.m1.4.4.1.1.2.2.5.cmml" xref="S3.E1.m1.4.4.1.1.2.2.5"><apply id="S3.E1.m1.4.4.1.1.2.2.5.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.5.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.5.1.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.5.1">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.5.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.5.1.2">∇</ci><apply id="S3.E1.m1.4.4.1.1.2.2.5.1.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.5.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.5.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.5.1.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.5.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.5.1.3.2">𝜃</ci><ci id="S3.E1.m1.4.4.1.1.2.2.5.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.5.1.3.3">𝑖</ci></apply></apply><ci id="S3.E1.m1.4.4.1.1.2.2.5.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.5.2">ℒ</ci></apply><interval closure="open" id="S3.E1.m1.4.4.1.1.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2"><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.2">𝐷</ci><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2">superscript</csymbol><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.2">𝜃</ci><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1">𝑡</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\theta_{i}^{(t+1)}=\theta_{i}^{(t)}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},\theta_{i}^{(t)}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p5.5" class="ltx_p">where <math id="S3.p5.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.p5.1.m1.1a"><mi id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><ci id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">\eta</annotation></semantics></math> is the learning rate, <math id="S3.p5.2.m2.1" class="ltx_Math" alttext="\nabla L" display="inline"><semantics id="S3.p5.2.m2.1a"><mrow id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml"><mo rspace="0.167em" id="S3.p5.2.m2.1.1.1" xref="S3.p5.2.m2.1.1.1.cmml">∇</mo><mi id="S3.p5.2.m2.1.1.2" xref="S3.p5.2.m2.1.1.2.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><apply id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1"><ci id="S3.p5.2.m2.1.1.1.cmml" xref="S3.p5.2.m2.1.1.1">∇</ci><ci id="S3.p5.2.m2.1.1.2.cmml" xref="S3.p5.2.m2.1.1.2">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">\nabla L</annotation></semantics></math> is the gradient of the loss function <math id="S3.p5.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.p5.3.m3.1a"><mi id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><ci id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">L</annotation></semantics></math>, and <math id="S3.p5.4.m4.4" class="ltx_Math" alttext="t\in(1,2,\ldots,T)" display="inline"><semantics id="S3.p5.4.m4.4a"><mrow id="S3.p5.4.m4.4.5" xref="S3.p5.4.m4.4.5.cmml"><mi id="S3.p5.4.m4.4.5.2" xref="S3.p5.4.m4.4.5.2.cmml">t</mi><mo id="S3.p5.4.m4.4.5.1" xref="S3.p5.4.m4.4.5.1.cmml">∈</mo><mrow id="S3.p5.4.m4.4.5.3.2" xref="S3.p5.4.m4.4.5.3.1.cmml"><mo stretchy="false" id="S3.p5.4.m4.4.5.3.2.1" xref="S3.p5.4.m4.4.5.3.1.cmml">(</mo><mn id="S3.p5.4.m4.1.1" xref="S3.p5.4.m4.1.1.cmml">1</mn><mo id="S3.p5.4.m4.4.5.3.2.2" xref="S3.p5.4.m4.4.5.3.1.cmml">,</mo><mn id="S3.p5.4.m4.2.2" xref="S3.p5.4.m4.2.2.cmml">2</mn><mo id="S3.p5.4.m4.4.5.3.2.3" xref="S3.p5.4.m4.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.p5.4.m4.3.3" xref="S3.p5.4.m4.3.3.cmml">…</mi><mo id="S3.p5.4.m4.4.5.3.2.4" xref="S3.p5.4.m4.4.5.3.1.cmml">,</mo><mi id="S3.p5.4.m4.4.4" xref="S3.p5.4.m4.4.4.cmml">T</mi><mo stretchy="false" id="S3.p5.4.m4.4.5.3.2.5" xref="S3.p5.4.m4.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.4.m4.4b"><apply id="S3.p5.4.m4.4.5.cmml" xref="S3.p5.4.m4.4.5"><in id="S3.p5.4.m4.4.5.1.cmml" xref="S3.p5.4.m4.4.5.1"></in><ci id="S3.p5.4.m4.4.5.2.cmml" xref="S3.p5.4.m4.4.5.2">𝑡</ci><vector id="S3.p5.4.m4.4.5.3.1.cmml" xref="S3.p5.4.m4.4.5.3.2"><cn type="integer" id="S3.p5.4.m4.1.1.cmml" xref="S3.p5.4.m4.1.1">1</cn><cn type="integer" id="S3.p5.4.m4.2.2.cmml" xref="S3.p5.4.m4.2.2">2</cn><ci id="S3.p5.4.m4.3.3.cmml" xref="S3.p5.4.m4.3.3">…</ci><ci id="S3.p5.4.m4.4.4.cmml" xref="S3.p5.4.m4.4.4">𝑇</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.4.m4.4c">t\in(1,2,\ldots,T)</annotation></semantics></math> denotes the number of rounds.
The central server updates the global parameter <math id="S3.p5.5.m5.1" class="ltx_Math" alttext="\theta_{G}" display="inline"><semantics id="S3.p5.5.m5.1a"><msub id="S3.p5.5.m5.1.1" xref="S3.p5.5.m5.1.1.cmml"><mi id="S3.p5.5.m5.1.1.2" xref="S3.p5.5.m5.1.1.2.cmml">θ</mi><mi id="S3.p5.5.m5.1.1.3" xref="S3.p5.5.m5.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p5.5.m5.1b"><apply id="S3.p5.5.m5.1.1.cmml" xref="S3.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p5.5.m5.1.1.1.cmml" xref="S3.p5.5.m5.1.1">subscript</csymbol><ci id="S3.p5.5.m5.1.1.2.cmml" xref="S3.p5.5.m5.1.1.2">𝜃</ci><ci id="S3.p5.5.m5.1.1.3.cmml" xref="S3.p5.5.m5.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.5.m5.1c">\theta_{G}</annotation></semantics></math> based on all clients’ local parameter updates as</p>
</div>
<div id="S3.p6" class="ltx_para ltx_noindent">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.5" class="ltx_Math" alttext="\theta_{G}^{(t+1)}=\sum_{i=1}^{N}\frac{|D_{i}|}{|D|}\theta_{i}^{(t+1)}," display="block"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5.1" xref="S3.E2.m1.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml"><msubsup id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.2.cmml"><mi id="S3.E2.m1.5.5.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.2.2.2.cmml">θ</mi><mi id="S3.E2.m1.5.5.1.1.2.2.3" xref="S3.E2.m1.5.5.1.1.2.2.3.cmml">G</mi><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo rspace="0.111em" id="S3.E2.m1.5.5.1.1.1" xref="S3.E2.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.3" xref="S3.E2.m1.5.5.1.1.3.cmml"><munderover id="S3.E2.m1.5.5.1.1.3.1" xref="S3.E2.m1.5.5.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.5.5.1.1.3.1.2.2" xref="S3.E2.m1.5.5.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.5.5.1.1.3.1.2.3" xref="S3.E2.m1.5.5.1.1.3.1.2.3.cmml"><mi id="S3.E2.m1.5.5.1.1.3.1.2.3.2" xref="S3.E2.m1.5.5.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E2.m1.5.5.1.1.3.1.2.3.1" xref="S3.E2.m1.5.5.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.5.5.1.1.3.1.2.3.3" xref="S3.E2.m1.5.5.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.5.5.1.1.3.1.3" xref="S3.E2.m1.5.5.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E2.m1.5.5.1.1.3.2" xref="S3.E2.m1.5.5.1.1.3.2.cmml"><mfrac id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.2.1.cmml">|</mo><msub id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.2.cmml">D</mi><mi id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2.m1.2.2.1.1.3" xref="S3.E2.m1.2.2.1.2.1.cmml">|</mo></mrow><mrow id="S3.E2.m1.3.3.2.3" xref="S3.E2.m1.3.3.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.2.3.1" xref="S3.E2.m1.3.3.2.2.1.cmml">|</mo><mi id="S3.E2.m1.3.3.2.1" xref="S3.E2.m1.3.3.2.1.cmml">D</mi><mo stretchy="false" id="S3.E2.m1.3.3.2.3.2" xref="S3.E2.m1.3.3.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.3.2.1" xref="S3.E2.m1.5.5.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E2.m1.5.5.1.1.3.2.2" xref="S3.E2.m1.5.5.1.1.3.2.2.cmml"><mi id="S3.E2.m1.5.5.1.1.3.2.2.2.2" xref="S3.E2.m1.5.5.1.1.3.2.2.2.2.cmml">θ</mi><mi id="S3.E2.m1.5.5.1.1.3.2.2.2.3" xref="S3.E2.m1.5.5.1.1.3.2.2.2.3.cmml">i</mi><mrow id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.1.2" xref="S3.E2.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.2.cmml">t</mi><mo id="S3.E2.m1.4.4.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.cmml">+</mo><mn id="S3.E2.m1.4.4.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E2.m1.4.4.1.1.3" xref="S3.E2.m1.4.4.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S3.E2.m1.5.5.1.2" xref="S3.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1"><eq id="S3.E2.m1.5.5.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1"></eq><apply id="S3.E2.m1.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.2.2.2">𝜃</ci><ci id="S3.E2.m1.5.5.1.1.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.2.2.3">𝐺</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"><plus id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"></plus><ci id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E2.m1.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3"><apply id="S3.E2.m1.5.5.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3.1.1.cmml" xref="S3.E2.m1.5.5.1.1.3.1">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.3.1.2.cmml" xref="S3.E2.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3.1.2.1.cmml" xref="S3.E2.m1.5.5.1.1.3.1">subscript</csymbol><sum id="S3.E2.m1.5.5.1.1.3.1.2.2.cmml" xref="S3.E2.m1.5.5.1.1.3.1.2.2"></sum><apply id="S3.E2.m1.5.5.1.1.3.1.2.3.cmml" xref="S3.E2.m1.5.5.1.1.3.1.2.3"><eq id="S3.E2.m1.5.5.1.1.3.1.2.3.1.cmml" xref="S3.E2.m1.5.5.1.1.3.1.2.3.1"></eq><ci id="S3.E2.m1.5.5.1.1.3.1.2.3.2.cmml" xref="S3.E2.m1.5.5.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.5.5.1.1.3.1.2.3.3.cmml" xref="S3.E2.m1.5.5.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.5.5.1.1.3.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E2.m1.5.5.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.3.2"><times id="S3.E2.m1.5.5.1.1.3.2.1.cmml" xref="S3.E2.m1.5.5.1.1.3.2.1"></times><apply id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3"><divide id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3"></divide><apply id="S3.E2.m1.2.2.1.2.cmml" xref="S3.E2.m1.2.2.1.1"><abs id="S3.E2.m1.2.2.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2"></abs><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2">𝐷</ci><ci id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.3.3.2.2.cmml" xref="S3.E2.m1.3.3.2.3"><abs id="S3.E2.m1.3.3.2.2.1.cmml" xref="S3.E2.m1.3.3.2.3.1"></abs><ci id="S3.E2.m1.3.3.2.1.cmml" xref="S3.E2.m1.3.3.2.1">𝐷</ci></apply></apply><apply id="S3.E2.m1.5.5.1.1.3.2.2.cmml" xref="S3.E2.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.3.2.2">superscript</csymbol><apply id="S3.E2.m1.5.5.1.1.3.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3.2.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.3.2.2">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S3.E2.m1.5.5.1.1.3.2.2.2.2">𝜃</ci><ci id="S3.E2.m1.5.5.1.1.3.2.2.2.3.cmml" xref="S3.E2.m1.5.5.1.1.3.2.2.2.3">𝑖</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1"><plus id="S3.E2.m1.4.4.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1"></plus><ci id="S3.E2.m1.4.4.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E2.m1.4.4.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">\theta_{G}^{(t+1)}=\sum_{i=1}^{N}\frac{|D_{i}|}{|D|}\theta_{i}^{(t+1)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.p6.3" class="ltx_p">where <math id="S3.p6.1.m1.1" class="ltx_Math" alttext="|D_{i}|" display="inline"><semantics id="S3.p6.1.m1.1a"><mrow id="S3.p6.1.m1.1.1.1" xref="S3.p6.1.m1.1.1.2.cmml"><mo stretchy="false" id="S3.p6.1.m1.1.1.1.2" xref="S3.p6.1.m1.1.1.2.1.cmml">|</mo><msub id="S3.p6.1.m1.1.1.1.1" xref="S3.p6.1.m1.1.1.1.1.cmml"><mi id="S3.p6.1.m1.1.1.1.1.2" xref="S3.p6.1.m1.1.1.1.1.2.cmml">D</mi><mi id="S3.p6.1.m1.1.1.1.1.3" xref="S3.p6.1.m1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p6.1.m1.1.1.1.3" xref="S3.p6.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.1.m1.1b"><apply id="S3.p6.1.m1.1.1.2.cmml" xref="S3.p6.1.m1.1.1.1"><abs id="S3.p6.1.m1.1.1.2.1.cmml" xref="S3.p6.1.m1.1.1.1.2"></abs><apply id="S3.p6.1.m1.1.1.1.1.cmml" xref="S3.p6.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p6.1.m1.1.1.1.1.1.cmml" xref="S3.p6.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.p6.1.m1.1.1.1.1.2.cmml" xref="S3.p6.1.m1.1.1.1.1.2">𝐷</ci><ci id="S3.p6.1.m1.1.1.1.1.3.cmml" xref="S3.p6.1.m1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.1.m1.1c">|D_{i}|</annotation></semantics></math> is the number of data points for client <math id="S3.p6.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p6.2.m2.1a"><mi id="S3.p6.2.m2.1.1" xref="S3.p6.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p6.2.m2.1b"><ci id="S3.p6.2.m2.1.1.cmml" xref="S3.p6.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.2.m2.1c">i</annotation></semantics></math>, and <math id="S3.p6.3.m3.1" class="ltx_Math" alttext="|D|" display="inline"><semantics id="S3.p6.3.m3.1a"><mrow id="S3.p6.3.m3.1.2.2" xref="S3.p6.3.m3.1.2.1.cmml"><mo stretchy="false" id="S3.p6.3.m3.1.2.2.1" xref="S3.p6.3.m3.1.2.1.1.cmml">|</mo><mi id="S3.p6.3.m3.1.1" xref="S3.p6.3.m3.1.1.cmml">D</mi><mo stretchy="false" id="S3.p6.3.m3.1.2.2.2" xref="S3.p6.3.m3.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.3.m3.1b"><apply id="S3.p6.3.m3.1.2.1.cmml" xref="S3.p6.3.m3.1.2.2"><abs id="S3.p6.3.m3.1.2.1.1.cmml" xref="S3.p6.3.m3.1.2.2.1"></abs><ci id="S3.p6.3.m3.1.1.cmml" xref="S3.p6.3.m3.1.1">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.3.m3.1c">|D|</annotation></semantics></math> is the total number of data points.</p>
</div>
<div id="S3.p7" class="ltx_para ltx_noindent">
<p id="S3.p7.4" class="ltx_p">For representation learning, the model parameters are divided into two components <math id="S3.p7.1.m1.6" class="ltx_Math" alttext="\theta_{i}=(\theta_{i,b},\theta_{i,h})" display="inline"><semantics id="S3.p7.1.m1.6a"><mrow id="S3.p7.1.m1.6.6" xref="S3.p7.1.m1.6.6.cmml"><msub id="S3.p7.1.m1.6.6.4" xref="S3.p7.1.m1.6.6.4.cmml"><mi id="S3.p7.1.m1.6.6.4.2" xref="S3.p7.1.m1.6.6.4.2.cmml">θ</mi><mi id="S3.p7.1.m1.6.6.4.3" xref="S3.p7.1.m1.6.6.4.3.cmml">i</mi></msub><mo id="S3.p7.1.m1.6.6.3" xref="S3.p7.1.m1.6.6.3.cmml">=</mo><mrow id="S3.p7.1.m1.6.6.2.2" xref="S3.p7.1.m1.6.6.2.3.cmml"><mo stretchy="false" id="S3.p7.1.m1.6.6.2.2.3" xref="S3.p7.1.m1.6.6.2.3.cmml">(</mo><msub id="S3.p7.1.m1.5.5.1.1.1" xref="S3.p7.1.m1.5.5.1.1.1.cmml"><mi id="S3.p7.1.m1.5.5.1.1.1.2" xref="S3.p7.1.m1.5.5.1.1.1.2.cmml">θ</mi><mrow id="S3.p7.1.m1.2.2.2.4" xref="S3.p7.1.m1.2.2.2.3.cmml"><mi id="S3.p7.1.m1.1.1.1.1" xref="S3.p7.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.p7.1.m1.2.2.2.4.1" xref="S3.p7.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.p7.1.m1.2.2.2.2" xref="S3.p7.1.m1.2.2.2.2.cmml">b</mi></mrow></msub><mo id="S3.p7.1.m1.6.6.2.2.4" xref="S3.p7.1.m1.6.6.2.3.cmml">,</mo><msub id="S3.p7.1.m1.6.6.2.2.2" xref="S3.p7.1.m1.6.6.2.2.2.cmml"><mi id="S3.p7.1.m1.6.6.2.2.2.2" xref="S3.p7.1.m1.6.6.2.2.2.2.cmml">θ</mi><mrow id="S3.p7.1.m1.4.4.2.4" xref="S3.p7.1.m1.4.4.2.3.cmml"><mi id="S3.p7.1.m1.3.3.1.1" xref="S3.p7.1.m1.3.3.1.1.cmml">i</mi><mo id="S3.p7.1.m1.4.4.2.4.1" xref="S3.p7.1.m1.4.4.2.3.cmml">,</mo><mi id="S3.p7.1.m1.4.4.2.2" xref="S3.p7.1.m1.4.4.2.2.cmml">h</mi></mrow></msub><mo stretchy="false" id="S3.p7.1.m1.6.6.2.2.5" xref="S3.p7.1.m1.6.6.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.1.m1.6b"><apply id="S3.p7.1.m1.6.6.cmml" xref="S3.p7.1.m1.6.6"><eq id="S3.p7.1.m1.6.6.3.cmml" xref="S3.p7.1.m1.6.6.3"></eq><apply id="S3.p7.1.m1.6.6.4.cmml" xref="S3.p7.1.m1.6.6.4"><csymbol cd="ambiguous" id="S3.p7.1.m1.6.6.4.1.cmml" xref="S3.p7.1.m1.6.6.4">subscript</csymbol><ci id="S3.p7.1.m1.6.6.4.2.cmml" xref="S3.p7.1.m1.6.6.4.2">𝜃</ci><ci id="S3.p7.1.m1.6.6.4.3.cmml" xref="S3.p7.1.m1.6.6.4.3">𝑖</ci></apply><interval closure="open" id="S3.p7.1.m1.6.6.2.3.cmml" xref="S3.p7.1.m1.6.6.2.2"><apply id="S3.p7.1.m1.5.5.1.1.1.cmml" xref="S3.p7.1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.p7.1.m1.5.5.1.1.1.1.cmml" xref="S3.p7.1.m1.5.5.1.1.1">subscript</csymbol><ci id="S3.p7.1.m1.5.5.1.1.1.2.cmml" xref="S3.p7.1.m1.5.5.1.1.1.2">𝜃</ci><list id="S3.p7.1.m1.2.2.2.3.cmml" xref="S3.p7.1.m1.2.2.2.4"><ci id="S3.p7.1.m1.1.1.1.1.cmml" xref="S3.p7.1.m1.1.1.1.1">𝑖</ci><ci id="S3.p7.1.m1.2.2.2.2.cmml" xref="S3.p7.1.m1.2.2.2.2">𝑏</ci></list></apply><apply id="S3.p7.1.m1.6.6.2.2.2.cmml" xref="S3.p7.1.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.p7.1.m1.6.6.2.2.2.1.cmml" xref="S3.p7.1.m1.6.6.2.2.2">subscript</csymbol><ci id="S3.p7.1.m1.6.6.2.2.2.2.cmml" xref="S3.p7.1.m1.6.6.2.2.2.2">𝜃</ci><list id="S3.p7.1.m1.4.4.2.3.cmml" xref="S3.p7.1.m1.4.4.2.4"><ci id="S3.p7.1.m1.3.3.1.1.cmml" xref="S3.p7.1.m1.3.3.1.1">𝑖</ci><ci id="S3.p7.1.m1.4.4.2.2.cmml" xref="S3.p7.1.m1.4.4.2.2">ℎ</ci></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.1.m1.6c">\theta_{i}=(\theta_{i,b},\theta_{i,h})</annotation></semantics></math>. Here, <math id="S3.p7.2.m2.2" class="ltx_Math" alttext="\theta_{i,b}" display="inline"><semantics id="S3.p7.2.m2.2a"><msub id="S3.p7.2.m2.2.3" xref="S3.p7.2.m2.2.3.cmml"><mi id="S3.p7.2.m2.2.3.2" xref="S3.p7.2.m2.2.3.2.cmml">θ</mi><mrow id="S3.p7.2.m2.2.2.2.4" xref="S3.p7.2.m2.2.2.2.3.cmml"><mi id="S3.p7.2.m2.1.1.1.1" xref="S3.p7.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.p7.2.m2.2.2.2.4.1" xref="S3.p7.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.p7.2.m2.2.2.2.2" xref="S3.p7.2.m2.2.2.2.2.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p7.2.m2.2b"><apply id="S3.p7.2.m2.2.3.cmml" xref="S3.p7.2.m2.2.3"><csymbol cd="ambiguous" id="S3.p7.2.m2.2.3.1.cmml" xref="S3.p7.2.m2.2.3">subscript</csymbol><ci id="S3.p7.2.m2.2.3.2.cmml" xref="S3.p7.2.m2.2.3.2">𝜃</ci><list id="S3.p7.2.m2.2.2.2.3.cmml" xref="S3.p7.2.m2.2.2.2.4"><ci id="S3.p7.2.m2.1.1.1.1.cmml" xref="S3.p7.2.m2.1.1.1.1">𝑖</ci><ci id="S3.p7.2.m2.2.2.2.2.cmml" xref="S3.p7.2.m2.2.2.2.2">𝑏</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.2.m2.2c">\theta_{i,b}</annotation></semantics></math> represents the base parameter shared among all clients and <math id="S3.p7.3.m3.2" class="ltx_Math" alttext="\theta_{i,h}" display="inline"><semantics id="S3.p7.3.m3.2a"><msub id="S3.p7.3.m3.2.3" xref="S3.p7.3.m3.2.3.cmml"><mi id="S3.p7.3.m3.2.3.2" xref="S3.p7.3.m3.2.3.2.cmml">θ</mi><mrow id="S3.p7.3.m3.2.2.2.4" xref="S3.p7.3.m3.2.2.2.3.cmml"><mi id="S3.p7.3.m3.1.1.1.1" xref="S3.p7.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.p7.3.m3.2.2.2.4.1" xref="S3.p7.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.p7.3.m3.2.2.2.2" xref="S3.p7.3.m3.2.2.2.2.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p7.3.m3.2b"><apply id="S3.p7.3.m3.2.3.cmml" xref="S3.p7.3.m3.2.3"><csymbol cd="ambiguous" id="S3.p7.3.m3.2.3.1.cmml" xref="S3.p7.3.m3.2.3">subscript</csymbol><ci id="S3.p7.3.m3.2.3.2.cmml" xref="S3.p7.3.m3.2.3.2">𝜃</ci><list id="S3.p7.3.m3.2.2.2.3.cmml" xref="S3.p7.3.m3.2.2.2.4"><ci id="S3.p7.3.m3.1.1.1.1.cmml" xref="S3.p7.3.m3.1.1.1.1">𝑖</ci><ci id="S3.p7.3.m3.2.2.2.2.cmml" xref="S3.p7.3.m3.2.2.2.2">ℎ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.3.m3.2c">\theta_{i,h}</annotation></semantics></math> represents the head parameter of the <math id="S3.p7.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p7.4.m4.1a"><mi id="S3.p7.4.m4.1.1" xref="S3.p7.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p7.4.m4.1b"><ci id="S3.p7.4.m4.1.1.cmml" xref="S3.p7.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p7.4.m4.1c">i</annotation></semantics></math>-th client. The model parameters from Eq. (<a href="#S3.E1" title="In 3 Proposed Algorithm ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) is modified as follows:</p>
</div>
<div id="S3.p8" class="ltx_para ltx_noindent">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.9" class="ltx_Math" alttext="\theta_{i}^{(t+1)}=\theta_{i}^{(t)}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},\theta_{i,b}^{(t)},\theta_{i,h}^{(0)})." display="block"><semantics id="S3.E3.m1.9a"><mrow id="S3.E3.m1.9.9.1" xref="S3.E3.m1.9.9.1.1.cmml"><mrow id="S3.E3.m1.9.9.1.1" xref="S3.E3.m1.9.9.1.1.cmml"><msubsup id="S3.E3.m1.9.9.1.1.5" xref="S3.E3.m1.9.9.1.1.5.cmml"><mi id="S3.E3.m1.9.9.1.1.5.2.2" xref="S3.E3.m1.9.9.1.1.5.2.2.cmml">θ</mi><mi id="S3.E3.m1.9.9.1.1.5.2.3" xref="S3.E3.m1.9.9.1.1.5.2.3.cmml">i</mi><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E3.m1.9.9.1.1.4" xref="S3.E3.m1.9.9.1.1.4.cmml">=</mo><mrow id="S3.E3.m1.9.9.1.1.3" xref="S3.E3.m1.9.9.1.1.3.cmml"><msubsup id="S3.E3.m1.9.9.1.1.3.5" xref="S3.E3.m1.9.9.1.1.3.5.cmml"><mi id="S3.E3.m1.9.9.1.1.3.5.2.2" xref="S3.E3.m1.9.9.1.1.3.5.2.2.cmml">θ</mi><mi id="S3.E3.m1.9.9.1.1.3.5.2.3" xref="S3.E3.m1.9.9.1.1.3.5.2.3.cmml">i</mi><mrow id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.9.9.1.1.3.5.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.3.1" xref="S3.E3.m1.9.9.1.1.3.5.cmml">(</mo><mi id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S3.E3.m1.2.2.1.3.2" xref="S3.E3.m1.9.9.1.1.3.5.cmml">)</mo></mrow></msubsup><mo id="S3.E3.m1.9.9.1.1.3.4" xref="S3.E3.m1.9.9.1.1.3.4.cmml">−</mo><mrow id="S3.E3.m1.9.9.1.1.3.3" xref="S3.E3.m1.9.9.1.1.3.3.cmml"><mi id="S3.E3.m1.9.9.1.1.3.3.5" xref="S3.E3.m1.9.9.1.1.3.3.5.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S3.E3.m1.9.9.1.1.3.3.4" xref="S3.E3.m1.9.9.1.1.3.3.4.cmml">​</mo><mrow id="S3.E3.m1.9.9.1.1.3.3.6" xref="S3.E3.m1.9.9.1.1.3.3.6.cmml"><msub id="S3.E3.m1.9.9.1.1.3.3.6.1" xref="S3.E3.m1.9.9.1.1.3.3.6.1.cmml"><mo rspace="0.167em" id="S3.E3.m1.9.9.1.1.3.3.6.1.2" xref="S3.E3.m1.9.9.1.1.3.3.6.1.2.cmml">∇</mo><msub id="S3.E3.m1.9.9.1.1.3.3.6.1.3" xref="S3.E3.m1.9.9.1.1.3.3.6.1.3.cmml"><mi id="S3.E3.m1.9.9.1.1.3.3.6.1.3.2" xref="S3.E3.m1.9.9.1.1.3.3.6.1.3.2.cmml">θ</mi><mi id="S3.E3.m1.9.9.1.1.3.3.6.1.3.3" xref="S3.E3.m1.9.9.1.1.3.3.6.1.3.3.cmml">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.9.9.1.1.3.3.6.2" xref="S3.E3.m1.9.9.1.1.3.3.6.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.9.9.1.1.3.3.4a" xref="S3.E3.m1.9.9.1.1.3.3.4.cmml">​</mo><mrow id="S3.E3.m1.9.9.1.1.3.3.3.3" xref="S3.E3.m1.9.9.1.1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E3.m1.9.9.1.1.3.3.3.3.4" xref="S3.E3.m1.9.9.1.1.3.3.3.4.cmml">(</mo><msub id="S3.E3.m1.9.9.1.1.1.1.1.1.1" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.9.9.1.1.1.1.1.1.1.2" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.2.cmml">D</mi><mi id="S3.E3.m1.9.9.1.1.1.1.1.1.1.3" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3.m1.9.9.1.1.3.3.3.3.5" xref="S3.E3.m1.9.9.1.1.3.3.3.4.cmml">,</mo><msubsup id="S3.E3.m1.9.9.1.1.2.2.2.2.2" xref="S3.E3.m1.9.9.1.1.2.2.2.2.2.cmml"><mi id="S3.E3.m1.9.9.1.1.2.2.2.2.2.2.2" xref="S3.E3.m1.9.9.1.1.2.2.2.2.2.2.2.cmml">θ</mi><mrow id="S3.E3.m1.4.4.2.4" xref="S3.E3.m1.4.4.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml">i</mi><mo id="S3.E3.m1.4.4.2.4.1" xref="S3.E3.m1.4.4.2.3.cmml">,</mo><mi id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.2.cmml">b</mi></mrow><mrow id="S3.E3.m1.5.5.1.3" xref="S3.E3.m1.9.9.1.1.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.1.3.1" xref="S3.E3.m1.9.9.1.1.2.2.2.2.2.cmml">(</mo><mi id="S3.E3.m1.5.5.1.1" xref="S3.E3.m1.5.5.1.1.cmml">t</mi><mo stretchy="false" id="S3.E3.m1.5.5.1.3.2" xref="S3.E3.m1.9.9.1.1.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.E3.m1.9.9.1.1.3.3.3.3.6" xref="S3.E3.m1.9.9.1.1.3.3.3.4.cmml">,</mo><msubsup id="S3.E3.m1.9.9.1.1.3.3.3.3.3" xref="S3.E3.m1.9.9.1.1.3.3.3.3.3.cmml"><mi id="S3.E3.m1.9.9.1.1.3.3.3.3.3.2.2" xref="S3.E3.m1.9.9.1.1.3.3.3.3.3.2.2.cmml">θ</mi><mrow id="S3.E3.m1.7.7.2.4" xref="S3.E3.m1.7.7.2.3.cmml"><mi id="S3.E3.m1.6.6.1.1" xref="S3.E3.m1.6.6.1.1.cmml">i</mi><mo id="S3.E3.m1.7.7.2.4.1" xref="S3.E3.m1.7.7.2.3.cmml">,</mo><mi id="S3.E3.m1.7.7.2.2" xref="S3.E3.m1.7.7.2.2.cmml">h</mi></mrow><mrow id="S3.E3.m1.8.8.1.3" xref="S3.E3.m1.9.9.1.1.3.3.3.3.3.cmml"><mo stretchy="false" id="S3.E3.m1.8.8.1.3.1" xref="S3.E3.m1.9.9.1.1.3.3.3.3.3.cmml">(</mo><mn id="S3.E3.m1.8.8.1.1" xref="S3.E3.m1.8.8.1.1.cmml">0</mn><mo stretchy="false" id="S3.E3.m1.8.8.1.3.2" xref="S3.E3.m1.9.9.1.1.3.3.3.3.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E3.m1.9.9.1.1.3.3.3.3.7" xref="S3.E3.m1.9.9.1.1.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.9.9.1.2" xref="S3.E3.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.9b"><apply id="S3.E3.m1.9.9.1.1.cmml" xref="S3.E3.m1.9.9.1"><eq id="S3.E3.m1.9.9.1.1.4.cmml" xref="S3.E3.m1.9.9.1.1.4"></eq><apply id="S3.E3.m1.9.9.1.1.5.cmml" xref="S3.E3.m1.9.9.1.1.5"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.5.1.cmml" xref="S3.E3.m1.9.9.1.1.5">superscript</csymbol><apply id="S3.E3.m1.9.9.1.1.5.2.cmml" xref="S3.E3.m1.9.9.1.1.5"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.5.2.1.cmml" xref="S3.E3.m1.9.9.1.1.5">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.5.2.2.cmml" xref="S3.E3.m1.9.9.1.1.5.2.2">𝜃</ci><ci id="S3.E3.m1.9.9.1.1.5.2.3.cmml" xref="S3.E3.m1.9.9.1.1.5.2.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1"><plus id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"></plus><ci id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E3.m1.9.9.1.1.3.cmml" xref="S3.E3.m1.9.9.1.1.3"><minus id="S3.E3.m1.9.9.1.1.3.4.cmml" xref="S3.E3.m1.9.9.1.1.3.4"></minus><apply id="S3.E3.m1.9.9.1.1.3.5.cmml" xref="S3.E3.m1.9.9.1.1.3.5"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.3.5.1.cmml" xref="S3.E3.m1.9.9.1.1.3.5">superscript</csymbol><apply id="S3.E3.m1.9.9.1.1.3.5.2.cmml" xref="S3.E3.m1.9.9.1.1.3.5"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.3.5.2.1.cmml" xref="S3.E3.m1.9.9.1.1.3.5">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.3.5.2.2.cmml" xref="S3.E3.m1.9.9.1.1.3.5.2.2">𝜃</ci><ci id="S3.E3.m1.9.9.1.1.3.5.2.3.cmml" xref="S3.E3.m1.9.9.1.1.3.5.2.3">𝑖</ci></apply><ci id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1">𝑡</ci></apply><apply id="S3.E3.m1.9.9.1.1.3.3.cmml" xref="S3.E3.m1.9.9.1.1.3.3"><times id="S3.E3.m1.9.9.1.1.3.3.4.cmml" xref="S3.E3.m1.9.9.1.1.3.3.4"></times><ci id="S3.E3.m1.9.9.1.1.3.3.5.cmml" xref="S3.E3.m1.9.9.1.1.3.3.5">𝜂</ci><apply id="S3.E3.m1.9.9.1.1.3.3.6.cmml" xref="S3.E3.m1.9.9.1.1.3.3.6"><apply id="S3.E3.m1.9.9.1.1.3.3.6.1.cmml" xref="S3.E3.m1.9.9.1.1.3.3.6.1"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.3.3.6.1.1.cmml" xref="S3.E3.m1.9.9.1.1.3.3.6.1">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.3.3.6.1.2.cmml" xref="S3.E3.m1.9.9.1.1.3.3.6.1.2">∇</ci><apply id="S3.E3.m1.9.9.1.1.3.3.6.1.3.cmml" xref="S3.E3.m1.9.9.1.1.3.3.6.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.3.3.6.1.3.1.cmml" xref="S3.E3.m1.9.9.1.1.3.3.6.1.3">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.3.3.6.1.3.2.cmml" xref="S3.E3.m1.9.9.1.1.3.3.6.1.3.2">𝜃</ci><ci id="S3.E3.m1.9.9.1.1.3.3.6.1.3.3.cmml" xref="S3.E3.m1.9.9.1.1.3.3.6.1.3.3">𝑖</ci></apply></apply><ci id="S3.E3.m1.9.9.1.1.3.3.6.2.cmml" xref="S3.E3.m1.9.9.1.1.3.3.6.2">ℒ</ci></apply><vector id="S3.E3.m1.9.9.1.1.3.3.3.4.cmml" xref="S3.E3.m1.9.9.1.1.3.3.3.3"><apply id="S3.E3.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.2">𝐷</ci><ci id="S3.E3.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.9.9.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E3.m1.9.9.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.9.9.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.9.9.1.1.2.2.2.2.2">superscript</csymbol><apply id="S3.E3.m1.9.9.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.9.9.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.9.9.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.9.9.1.1.2.2.2.2.2.2.2">𝜃</ci><list id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.4"><ci id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1">𝑖</ci><ci id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.2">𝑏</ci></list></apply><ci id="S3.E3.m1.5.5.1.1.cmml" xref="S3.E3.m1.5.5.1.1">𝑡</ci></apply><apply id="S3.E3.m1.9.9.1.1.3.3.3.3.3.cmml" xref="S3.E3.m1.9.9.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.3.3.3.3.3.1.cmml" xref="S3.E3.m1.9.9.1.1.3.3.3.3.3">superscript</csymbol><apply id="S3.E3.m1.9.9.1.1.3.3.3.3.3.2.cmml" xref="S3.E3.m1.9.9.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.1.1.3.3.3.3.3.2.1.cmml" xref="S3.E3.m1.9.9.1.1.3.3.3.3.3">subscript</csymbol><ci id="S3.E3.m1.9.9.1.1.3.3.3.3.3.2.2.cmml" xref="S3.E3.m1.9.9.1.1.3.3.3.3.3.2.2">𝜃</ci><list id="S3.E3.m1.7.7.2.3.cmml" xref="S3.E3.m1.7.7.2.4"><ci id="S3.E3.m1.6.6.1.1.cmml" xref="S3.E3.m1.6.6.1.1">𝑖</ci><ci id="S3.E3.m1.7.7.2.2.cmml" xref="S3.E3.m1.7.7.2.2">ℎ</ci></list></apply><cn type="integer" id="S3.E3.m1.8.8.1.1.cmml" xref="S3.E3.m1.8.8.1.1">0</cn></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.9c">\theta_{i}^{(t+1)}=\theta_{i}^{(t)}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},\theta_{i,b}^{(t)},\theta_{i,h}^{(0)}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p9" class="ltx_para ltx_noindent">
<p id="S3.p9.1" class="ltx_p">Excluding FedBABU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, previous works the gradient of the head parameter is stopped during training and during the aggregation phase. The global model is updated using both the base and head parameters. However, FedBABU and our scheduling algorithm perform both training and aggregation using only the base without involving the head. Only after training, a few rounds of fine-tuning are included using both the base and head.</p>
</div>
<div id="S3.p10" class="ltx_para ltx_noindent">
<p id="S3.p10.1" class="ltx_p">The aggregation process, which excludes the use of the head, proceeds as follows:</p>
</div>
<div id="S3.p11" class="ltx_para ltx_noindent">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.7" class="ltx_Math" alttext="\theta_{G}^{(t+1)}=\sum_{i=1}^{N}\frac{|D_{i}|}{|D|}\theta_{i,b}^{(t+1)}." display="block"><semantics id="S3.E4.m1.7a"><mrow id="S3.E4.m1.7.7.1" xref="S3.E4.m1.7.7.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1" xref="S3.E4.m1.7.7.1.1.cmml"><msubsup id="S3.E4.m1.7.7.1.1.2" xref="S3.E4.m1.7.7.1.1.2.cmml"><mi id="S3.E4.m1.7.7.1.1.2.2.2" xref="S3.E4.m1.7.7.1.1.2.2.2.cmml">θ</mi><mi id="S3.E4.m1.7.7.1.1.2.2.3" xref="S3.E4.m1.7.7.1.1.2.2.3.cmml">G</mi><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo rspace="0.111em" id="S3.E4.m1.7.7.1.1.1" xref="S3.E4.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.7.7.1.1.3" xref="S3.E4.m1.7.7.1.1.3.cmml"><munderover id="S3.E4.m1.7.7.1.1.3.1" xref="S3.E4.m1.7.7.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E4.m1.7.7.1.1.3.1.2.2" xref="S3.E4.m1.7.7.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.7.7.1.1.3.1.2.3" xref="S3.E4.m1.7.7.1.1.3.1.2.3.cmml"><mi id="S3.E4.m1.7.7.1.1.3.1.2.3.2" xref="S3.E4.m1.7.7.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E4.m1.7.7.1.1.3.1.2.3.1" xref="S3.E4.m1.7.7.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.7.7.1.1.3.1.2.3.3" xref="S3.E4.m1.7.7.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.7.7.1.1.3.1.3" xref="S3.E4.m1.7.7.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E4.m1.7.7.1.1.3.2" xref="S3.E4.m1.7.7.1.1.3.2.cmml"><mfrac id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.2.1.cmml">|</mo><msub id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.2.cmml">D</mi><mi id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.2.2.1.1.3" xref="S3.E4.m1.2.2.1.2.1.cmml">|</mo></mrow><mrow id="S3.E4.m1.3.3.2.3" xref="S3.E4.m1.3.3.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.2.3.1" xref="S3.E4.m1.3.3.2.2.1.cmml">|</mo><mi id="S3.E4.m1.3.3.2.1" xref="S3.E4.m1.3.3.2.1.cmml">D</mi><mo stretchy="false" id="S3.E4.m1.3.3.2.3.2" xref="S3.E4.m1.3.3.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.1.3.2.1" xref="S3.E4.m1.7.7.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E4.m1.7.7.1.1.3.2.2" xref="S3.E4.m1.7.7.1.1.3.2.2.cmml"><mi id="S3.E4.m1.7.7.1.1.3.2.2.2.2" xref="S3.E4.m1.7.7.1.1.3.2.2.2.2.cmml">θ</mi><mrow id="S3.E4.m1.5.5.2.4" xref="S3.E4.m1.5.5.2.3.cmml"><mi id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml">i</mi><mo id="S3.E4.m1.5.5.2.4.1" xref="S3.E4.m1.5.5.2.3.cmml">,</mo><mi id="S3.E4.m1.5.5.2.2" xref="S3.E4.m1.5.5.2.2.cmml">b</mi></mrow><mrow id="S3.E4.m1.6.6.1.1" xref="S3.E4.m1.6.6.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.6.6.1.1.2" xref="S3.E4.m1.6.6.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.6.6.1.1.1" xref="S3.E4.m1.6.6.1.1.1.cmml"><mi id="S3.E4.m1.6.6.1.1.1.2" xref="S3.E4.m1.6.6.1.1.1.2.cmml">t</mi><mo id="S3.E4.m1.6.6.1.1.1.1" xref="S3.E4.m1.6.6.1.1.1.1.cmml">+</mo><mn id="S3.E4.m1.6.6.1.1.1.3" xref="S3.E4.m1.6.6.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E4.m1.6.6.1.1.3" xref="S3.E4.m1.6.6.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo lspace="0em" id="S3.E4.m1.7.7.1.2" xref="S3.E4.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.7b"><apply id="S3.E4.m1.7.7.1.1.cmml" xref="S3.E4.m1.7.7.1"><eq id="S3.E4.m1.7.7.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1"></eq><apply id="S3.E4.m1.7.7.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.2">superscript</csymbol><apply id="S3.E4.m1.7.7.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.2.2.1.cmml" xref="S3.E4.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.2.2.2.cmml" xref="S3.E4.m1.7.7.1.1.2.2.2">𝜃</ci><ci id="S3.E4.m1.7.7.1.1.2.2.3.cmml" xref="S3.E4.m1.7.7.1.1.2.2.3">𝐺</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"><plus id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"></plus><ci id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E4.m1.7.7.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.3"><apply id="S3.E4.m1.7.7.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.3.1.1.cmml" xref="S3.E4.m1.7.7.1.1.3.1">superscript</csymbol><apply id="S3.E4.m1.7.7.1.1.3.1.2.cmml" xref="S3.E4.m1.7.7.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.3.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.3.1">subscript</csymbol><sum id="S3.E4.m1.7.7.1.1.3.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.3.1.2.2"></sum><apply id="S3.E4.m1.7.7.1.1.3.1.2.3.cmml" xref="S3.E4.m1.7.7.1.1.3.1.2.3"><eq id="S3.E4.m1.7.7.1.1.3.1.2.3.1.cmml" xref="S3.E4.m1.7.7.1.1.3.1.2.3.1"></eq><ci id="S3.E4.m1.7.7.1.1.3.1.2.3.2.cmml" xref="S3.E4.m1.7.7.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.7.7.1.1.3.1.2.3.3.cmml" xref="S3.E4.m1.7.7.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.7.7.1.1.3.1.3.cmml" xref="S3.E4.m1.7.7.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E4.m1.7.7.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2"><times id="S3.E4.m1.7.7.1.1.3.2.1.cmml" xref="S3.E4.m1.7.7.1.1.3.2.1"></times><apply id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"><divide id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3"></divide><apply id="S3.E4.m1.2.2.1.2.cmml" xref="S3.E4.m1.2.2.1.1"><abs id="S3.E4.m1.2.2.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2"></abs><apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2">𝐷</ci><ci id="S3.E4.m1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.2.3"><abs id="S3.E4.m1.3.3.2.2.1.cmml" xref="S3.E4.m1.3.3.2.3.1"></abs><ci id="S3.E4.m1.3.3.2.1.cmml" xref="S3.E4.m1.3.3.2.1">𝐷</ci></apply></apply><apply id="S3.E4.m1.7.7.1.1.3.2.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.3.2.2.1.cmml" xref="S3.E4.m1.7.7.1.1.3.2.2">superscript</csymbol><apply id="S3.E4.m1.7.7.1.1.3.2.2.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.3.2.2.2.1.cmml" xref="S3.E4.m1.7.7.1.1.3.2.2">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.3.2.2.2.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2.2.2.2">𝜃</ci><list id="S3.E4.m1.5.5.2.3.cmml" xref="S3.E4.m1.5.5.2.4"><ci id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1.1">𝑖</ci><ci id="S3.E4.m1.5.5.2.2.cmml" xref="S3.E4.m1.5.5.2.2">𝑏</ci></list></apply><apply id="S3.E4.m1.6.6.1.1.1.cmml" xref="S3.E4.m1.6.6.1.1"><plus id="S3.E4.m1.6.6.1.1.1.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1"></plus><ci id="S3.E4.m1.6.6.1.1.1.2.cmml" xref="S3.E4.m1.6.6.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E4.m1.6.6.1.1.1.3.cmml" xref="S3.E4.m1.6.6.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.7c">\theta_{G}^{(t+1)}=\sum_{i=1}^{N}\frac{|D_{i}|}{|D|}\theta_{i,b}^{(t+1)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p12" class="ltx_para ltx_noindent">
<p id="S3.p12.1" class="ltx_p">Our algorithm follows the same training setup as FedBABU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, wherein the head layer is not trained or aggregated during training; instead, it is fine-tuned for each client after training completion. In FedBABU, the training round sets the learning rate of the head to zero, allowing gradient computation but preventing its application. In contrast, our scheduling algorithm ensures complete decoupling by freezing gradients in both the head and base parts, preventing both computation and application.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Method 1: Vanilla Scheduling</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">Vanilla scheduling is a training method that starts by thoroughly learning the shallowest layers (closest to the input) in the base layer, freezing the rest layers, and then progressively unfreezing them. This enables the model to preferentially learn low-level features and patterns, aiding in better understanding the abstract characteristics and patterns of the data. The training steps of Vanilla scheduling, which starts with the shallowest layers, can be represented as</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\theta_{i}^{(t_{1}+1)}=\theta_{i}^{(t_{1})}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i}," display="inline"><semantics id="S3.Ex1.m1.2a"><mrow id="S3.Ex1.m1.2b"><msubsup id="S3.Ex1.m1.2.3"><mi id="S3.Ex1.m1.2.3.2.2">θ</mi><mi id="S3.Ex1.m1.2.3.2.3">i</mi><mrow id="S3.Ex1.m1.1.1.1.1"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.2">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1"><msub id="S3.Ex1.m1.1.1.1.1.1.2"><mi id="S3.Ex1.m1.1.1.1.1.1.2.2">t</mi><mn id="S3.Ex1.m1.1.1.1.1.1.2.3">1</mn></msub><mo id="S3.Ex1.m1.1.1.1.1.1.1">+</mo><mn id="S3.Ex1.m1.1.1.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex1.m1.2.4">=</mo><msubsup id="S3.Ex1.m1.2.5"><mi id="S3.Ex1.m1.2.5.2.2">θ</mi><mi id="S3.Ex1.m1.2.5.2.3">i</mi><mrow id="S3.Ex1.m1.2.2.1.1"><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.2">(</mo><msub id="S3.Ex1.m1.2.2.1.1.1"><mi id="S3.Ex1.m1.2.2.1.1.1.2">t</mi><mn id="S3.Ex1.m1.2.2.1.1.1.3">1</mn></msub><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex1.m1.2.6">−</mo><mi id="S3.Ex1.m1.2.7">η</mi><msub id="S3.Ex1.m1.2.8"><mo lspace="0.167em" rspace="0.167em" id="S3.Ex1.m1.2.8.2">∇</mo><msub id="S3.Ex1.m1.2.8.3"><mi id="S3.Ex1.m1.2.8.3.2">θ</mi><mi id="S3.Ex1.m1.2.8.3.3">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.2.9">ℒ</mi><mrow id="S3.Ex1.m1.2.10"><mo stretchy="false" id="S3.Ex1.m1.2.10.1">(</mo><msub id="S3.Ex1.m1.2.10.2"><mi id="S3.Ex1.m1.2.10.2.2">D</mi><mi id="S3.Ex1.m1.2.10.2.3">i</mi></msub><mo id="S3.Ex1.m1.2.10.3">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex1.m1.2c">\displaystyle\theta_{i}^{(t_{1}+1)}=\theta_{i}^{(t_{1})}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m2.16" class="ltx_math_unparsed" alttext="\displaystyle\theta_{i,b_{1}}^{(t_{1})},\theta_{i,b_{2}}^{(0)},\ldots,\theta_{i,b_{K-1}}^{(0)},\theta_{i,b_{K}}^{(0)},\theta_{i,h}^{(0)})" display="inline"><semantics id="S3.Ex1.m2.16a"><mrow id="S3.Ex1.m2.16b"><msubsup id="S3.Ex1.m2.16.17"><mi id="S3.Ex1.m2.16.17.2.2">θ</mi><mrow id="S3.Ex1.m2.2.2.2.2"><mi id="S3.Ex1.m2.1.1.1.1">i</mi><mo id="S3.Ex1.m2.2.2.2.2.2">,</mo><msub id="S3.Ex1.m2.2.2.2.2.1"><mi id="S3.Ex1.m2.2.2.2.2.1.2">b</mi><mn id="S3.Ex1.m2.2.2.2.2.1.3">1</mn></msub></mrow><mrow id="S3.Ex1.m2.3.3.1.1"><mo stretchy="false" id="S3.Ex1.m2.3.3.1.1.2">(</mo><msub id="S3.Ex1.m2.3.3.1.1.1"><mi id="S3.Ex1.m2.3.3.1.1.1.2">t</mi><mn id="S3.Ex1.m2.3.3.1.1.1.3">1</mn></msub><mo stretchy="false" id="S3.Ex1.m2.3.3.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex1.m2.16.18">,</mo><msubsup id="S3.Ex1.m2.16.19"><mi id="S3.Ex1.m2.16.19.2.2">θ</mi><mrow id="S3.Ex1.m2.5.5.2.2"><mi id="S3.Ex1.m2.4.4.1.1">i</mi><mo id="S3.Ex1.m2.5.5.2.2.2">,</mo><msub id="S3.Ex1.m2.5.5.2.2.1"><mi id="S3.Ex1.m2.5.5.2.2.1.2">b</mi><mn id="S3.Ex1.m2.5.5.2.2.1.3">2</mn></msub></mrow><mrow id="S3.Ex1.m2.6.6.1.3"><mo stretchy="false" id="S3.Ex1.m2.6.6.1.3.1">(</mo><mn id="S3.Ex1.m2.6.6.1.1">0</mn><mo stretchy="false" id="S3.Ex1.m2.6.6.1.3.2">)</mo></mrow></msubsup><mo id="S3.Ex1.m2.16.20">,</mo><mi mathvariant="normal" id="S3.Ex1.m2.16.16">…</mi><mo id="S3.Ex1.m2.16.21">,</mo><msubsup id="S3.Ex1.m2.16.22"><mi id="S3.Ex1.m2.16.22.2.2">θ</mi><mrow id="S3.Ex1.m2.8.8.2.2"><mi id="S3.Ex1.m2.7.7.1.1">i</mi><mo id="S3.Ex1.m2.8.8.2.2.2">,</mo><msub id="S3.Ex1.m2.8.8.2.2.1"><mi id="S3.Ex1.m2.8.8.2.2.1.2">b</mi><mrow id="S3.Ex1.m2.8.8.2.2.1.3"><mi id="S3.Ex1.m2.8.8.2.2.1.3.2">K</mi><mo id="S3.Ex1.m2.8.8.2.2.1.3.1">−</mo><mn id="S3.Ex1.m2.8.8.2.2.1.3.3">1</mn></mrow></msub></mrow><mrow id="S3.Ex1.m2.9.9.1.3"><mo stretchy="false" id="S3.Ex1.m2.9.9.1.3.1">(</mo><mn id="S3.Ex1.m2.9.9.1.1">0</mn><mo stretchy="false" id="S3.Ex1.m2.9.9.1.3.2">)</mo></mrow></msubsup><mo id="S3.Ex1.m2.16.23">,</mo><msubsup id="S3.Ex1.m2.16.24"><mi id="S3.Ex1.m2.16.24.2.2">θ</mi><mrow id="S3.Ex1.m2.11.11.2.2"><mi id="S3.Ex1.m2.10.10.1.1">i</mi><mo id="S3.Ex1.m2.11.11.2.2.2">,</mo><msub id="S3.Ex1.m2.11.11.2.2.1"><mi id="S3.Ex1.m2.11.11.2.2.1.2">b</mi><mi id="S3.Ex1.m2.11.11.2.2.1.3">K</mi></msub></mrow><mrow id="S3.Ex1.m2.12.12.1.3"><mo stretchy="false" id="S3.Ex1.m2.12.12.1.3.1">(</mo><mn id="S3.Ex1.m2.12.12.1.1">0</mn><mo stretchy="false" id="S3.Ex1.m2.12.12.1.3.2">)</mo></mrow></msubsup><mo id="S3.Ex1.m2.16.25">,</mo><msubsup id="S3.Ex1.m2.16.26"><mi id="S3.Ex1.m2.16.26.2.2">θ</mi><mrow id="S3.Ex1.m2.14.14.2.4"><mi id="S3.Ex1.m2.13.13.1.1">i</mi><mo id="S3.Ex1.m2.14.14.2.4.1">,</mo><mi id="S3.Ex1.m2.14.14.2.2">h</mi></mrow><mrow id="S3.Ex1.m2.15.15.1.3"><mo stretchy="false" id="S3.Ex1.m2.15.15.1.3.1">(</mo><mn id="S3.Ex1.m2.15.15.1.1">0</mn><mo stretchy="false" id="S3.Ex1.m2.15.15.1.3.2">)</mo></mrow></msubsup><mo stretchy="false" id="S3.Ex1.m2.16.27">)</mo></mrow><annotation encoding="application/x-tex" id="S3.Ex1.m2.16c">\displaystyle\theta_{i,b_{1}}^{(t_{1})},\theta_{i,b_{2}}^{(0)},\ldots,\theta_{i,b_{K-1}}^{(0)},\theta_{i,b_{K}}^{(0)},\theta_{i,h}^{(0)})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex2.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\theta_{i}^{(t_{2}+1)}=\theta_{i}^{(t_{2})}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i}," display="inline"><semantics id="S3.Ex2.m1.2a"><mrow id="S3.Ex2.m1.2b"><msubsup id="S3.Ex2.m1.2.3"><mi id="S3.Ex2.m1.2.3.2.2">θ</mi><mi id="S3.Ex2.m1.2.3.2.3">i</mi><mrow id="S3.Ex2.m1.1.1.1.1"><mo stretchy="false" id="S3.Ex2.m1.1.1.1.1.2">(</mo><mrow id="S3.Ex2.m1.1.1.1.1.1"><msub id="S3.Ex2.m1.1.1.1.1.1.2"><mi id="S3.Ex2.m1.1.1.1.1.1.2.2">t</mi><mn id="S3.Ex2.m1.1.1.1.1.1.2.3">2</mn></msub><mo id="S3.Ex2.m1.1.1.1.1.1.1">+</mo><mn id="S3.Ex2.m1.1.1.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S3.Ex2.m1.1.1.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex2.m1.2.4">=</mo><msubsup id="S3.Ex2.m1.2.5"><mi id="S3.Ex2.m1.2.5.2.2">θ</mi><mi id="S3.Ex2.m1.2.5.2.3">i</mi><mrow id="S3.Ex2.m1.2.2.1.1"><mo stretchy="false" id="S3.Ex2.m1.2.2.1.1.2">(</mo><msub id="S3.Ex2.m1.2.2.1.1.1"><mi id="S3.Ex2.m1.2.2.1.1.1.2">t</mi><mn id="S3.Ex2.m1.2.2.1.1.1.3">2</mn></msub><mo stretchy="false" id="S3.Ex2.m1.2.2.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex2.m1.2.6">−</mo><mi id="S3.Ex2.m1.2.7">η</mi><msub id="S3.Ex2.m1.2.8"><mo lspace="0.167em" rspace="0.167em" id="S3.Ex2.m1.2.8.2">∇</mo><msub id="S3.Ex2.m1.2.8.3"><mi id="S3.Ex2.m1.2.8.3.2">θ</mi><mi id="S3.Ex2.m1.2.8.3.3">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.2.9">ℒ</mi><mrow id="S3.Ex2.m1.2.10"><mo stretchy="false" id="S3.Ex2.m1.2.10.1">(</mo><msub id="S3.Ex2.m1.2.10.2"><mi id="S3.Ex2.m1.2.10.2.2">D</mi><mi id="S3.Ex2.m1.2.10.2.3">i</mi></msub><mo id="S3.Ex2.m1.2.10.3">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex2.m1.2c">\displaystyle\theta_{i}^{(t_{2}+1)}=\theta_{i}^{(t_{2})}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex2.m2.16" class="ltx_math_unparsed" alttext="\displaystyle\theta_{i,b_{1}}^{(t_{2})},\theta_{i,b_{2}}^{(t_{2})},\ldots,\theta_{i,b_{K-1}}^{(0)},\theta_{i,b_{K}}^{(0)},\theta_{i,h}^{(0)})" display="inline"><semantics id="S3.Ex2.m2.16a"><mrow id="S3.Ex2.m2.16b"><msubsup id="S3.Ex2.m2.16.17"><mi id="S3.Ex2.m2.16.17.2.2">θ</mi><mrow id="S3.Ex2.m2.2.2.2.2"><mi id="S3.Ex2.m2.1.1.1.1">i</mi><mo id="S3.Ex2.m2.2.2.2.2.2">,</mo><msub id="S3.Ex2.m2.2.2.2.2.1"><mi id="S3.Ex2.m2.2.2.2.2.1.2">b</mi><mn id="S3.Ex2.m2.2.2.2.2.1.3">1</mn></msub></mrow><mrow id="S3.Ex2.m2.3.3.1.1"><mo stretchy="false" id="S3.Ex2.m2.3.3.1.1.2">(</mo><msub id="S3.Ex2.m2.3.3.1.1.1"><mi id="S3.Ex2.m2.3.3.1.1.1.2">t</mi><mn id="S3.Ex2.m2.3.3.1.1.1.3">2</mn></msub><mo stretchy="false" id="S3.Ex2.m2.3.3.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex2.m2.16.18">,</mo><msubsup id="S3.Ex2.m2.16.19"><mi id="S3.Ex2.m2.16.19.2.2">θ</mi><mrow id="S3.Ex2.m2.5.5.2.2"><mi id="S3.Ex2.m2.4.4.1.1">i</mi><mo id="S3.Ex2.m2.5.5.2.2.2">,</mo><msub id="S3.Ex2.m2.5.5.2.2.1"><mi id="S3.Ex2.m2.5.5.2.2.1.2">b</mi><mn id="S3.Ex2.m2.5.5.2.2.1.3">2</mn></msub></mrow><mrow id="S3.Ex2.m2.6.6.1.1"><mo stretchy="false" id="S3.Ex2.m2.6.6.1.1.2">(</mo><msub id="S3.Ex2.m2.6.6.1.1.1"><mi id="S3.Ex2.m2.6.6.1.1.1.2">t</mi><mn id="S3.Ex2.m2.6.6.1.1.1.3">2</mn></msub><mo stretchy="false" id="S3.Ex2.m2.6.6.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex2.m2.16.20">,</mo><mi mathvariant="normal" id="S3.Ex2.m2.16.16">…</mi><mo id="S3.Ex2.m2.16.21">,</mo><msubsup id="S3.Ex2.m2.16.22"><mi id="S3.Ex2.m2.16.22.2.2">θ</mi><mrow id="S3.Ex2.m2.8.8.2.2"><mi id="S3.Ex2.m2.7.7.1.1">i</mi><mo id="S3.Ex2.m2.8.8.2.2.2">,</mo><msub id="S3.Ex2.m2.8.8.2.2.1"><mi id="S3.Ex2.m2.8.8.2.2.1.2">b</mi><mrow id="S3.Ex2.m2.8.8.2.2.1.3"><mi id="S3.Ex2.m2.8.8.2.2.1.3.2">K</mi><mo id="S3.Ex2.m2.8.8.2.2.1.3.1">−</mo><mn id="S3.Ex2.m2.8.8.2.2.1.3.3">1</mn></mrow></msub></mrow><mrow id="S3.Ex2.m2.9.9.1.3"><mo stretchy="false" id="S3.Ex2.m2.9.9.1.3.1">(</mo><mn id="S3.Ex2.m2.9.9.1.1">0</mn><mo stretchy="false" id="S3.Ex2.m2.9.9.1.3.2">)</mo></mrow></msubsup><mo id="S3.Ex2.m2.16.23">,</mo><msubsup id="S3.Ex2.m2.16.24"><mi id="S3.Ex2.m2.16.24.2.2">θ</mi><mrow id="S3.Ex2.m2.11.11.2.2"><mi id="S3.Ex2.m2.10.10.1.1">i</mi><mo id="S3.Ex2.m2.11.11.2.2.2">,</mo><msub id="S3.Ex2.m2.11.11.2.2.1"><mi id="S3.Ex2.m2.11.11.2.2.1.2">b</mi><mi id="S3.Ex2.m2.11.11.2.2.1.3">K</mi></msub></mrow><mrow id="S3.Ex2.m2.12.12.1.3"><mo stretchy="false" id="S3.Ex2.m2.12.12.1.3.1">(</mo><mn id="S3.Ex2.m2.12.12.1.1">0</mn><mo stretchy="false" id="S3.Ex2.m2.12.12.1.3.2">)</mo></mrow></msubsup><mo id="S3.Ex2.m2.16.25">,</mo><msubsup id="S3.Ex2.m2.16.26"><mi id="S3.Ex2.m2.16.26.2.2">θ</mi><mrow id="S3.Ex2.m2.14.14.2.4"><mi id="S3.Ex2.m2.13.13.1.1">i</mi><mo id="S3.Ex2.m2.14.14.2.4.1">,</mo><mi id="S3.Ex2.m2.14.14.2.2">h</mi></mrow><mrow id="S3.Ex2.m2.15.15.1.3"><mo stretchy="false" id="S3.Ex2.m2.15.15.1.3.1">(</mo><mn id="S3.Ex2.m2.15.15.1.1">0</mn><mo stretchy="false" id="S3.Ex2.m2.15.15.1.3.2">)</mo></mrow></msubsup><mo stretchy="false" id="S3.Ex2.m2.16.27">)</mo></mrow><annotation encoding="application/x-tex" id="S3.Ex2.m2.16c">\displaystyle\theta_{i,b_{1}}^{(t_{2})},\theta_{i,b_{2}}^{(t_{2})},\ldots,\theta_{i,b_{K-1}}^{(0)},\theta_{i,b_{K}}^{(0)},\theta_{i,h}^{(0)})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex3.m1.1" class="ltx_Math" alttext="\displaystyle\vdots" display="inline"><semantics id="S3.Ex3.m1.1a"><mi mathvariant="normal" id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml">⋮</mi><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><ci id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1">⋮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\displaystyle\vdots</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\theta_{i}^{(t_{K}+1)}=\theta_{i}^{(t_{K})}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i}," display="inline"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2b"><msubsup id="S3.E5.m1.2.3"><mi id="S3.E5.m1.2.3.2.2">θ</mi><mi id="S3.E5.m1.2.3.2.3">i</mi><mrow id="S3.E5.m1.1.1.1.1"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.2">(</mo><mrow id="S3.E5.m1.1.1.1.1.1"><msub id="S3.E5.m1.1.1.1.1.1.2"><mi id="S3.E5.m1.1.1.1.1.1.2.2">t</mi><mi id="S3.E5.m1.1.1.1.1.1.2.3">K</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1">+</mo><mn id="S3.E5.m1.1.1.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S3.E5.m1.1.1.1.1.3">)</mo></mrow></msubsup><mo id="S3.E5.m1.2.4">=</mo><msubsup id="S3.E5.m1.2.5"><mi id="S3.E5.m1.2.5.2.2">θ</mi><mi id="S3.E5.m1.2.5.2.3">i</mi><mrow id="S3.E5.m1.2.2.1.1"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.2">(</mo><msub id="S3.E5.m1.2.2.1.1.1"><mi id="S3.E5.m1.2.2.1.1.1.2">t</mi><mi id="S3.E5.m1.2.2.1.1.1.3">K</mi></msub><mo stretchy="false" id="S3.E5.m1.2.2.1.1.3">)</mo></mrow></msubsup><mo id="S3.E5.m1.2.6">−</mo><mi id="S3.E5.m1.2.7">η</mi><msub id="S3.E5.m1.2.8"><mo lspace="0.167em" rspace="0.167em" id="S3.E5.m1.2.8.2">∇</mo><msub id="S3.E5.m1.2.8.3"><mi id="S3.E5.m1.2.8.3.2">θ</mi><mi id="S3.E5.m1.2.8.3.3">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.9">ℒ</mi><mrow id="S3.E5.m1.2.10"><mo stretchy="false" id="S3.E5.m1.2.10.1">(</mo><msub id="S3.E5.m1.2.10.2"><mi id="S3.E5.m1.2.10.2.2">D</mi><mi id="S3.E5.m1.2.10.2.3">i</mi></msub><mo id="S3.E5.m1.2.10.3">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\displaystyle\theta_{i}^{(t_{K}+1)}=\theta_{i}^{(t_{K})}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5.m2.16" class="ltx_math_unparsed" alttext="\displaystyle\theta_{i,b_{1}}^{(t_{K})},\theta_{i,b_{2}}^{(t_{K})},\ldots,\theta_{i,b_{K-1}}^{(t_{L})},\theta_{i,b_{K}}^{(t_{K})},\theta_{i,h}^{(0)})." display="inline"><semantics id="S3.E5.m2.16a"><mrow id="S3.E5.m2.16b"><msubsup id="S3.E5.m2.16.17"><mi id="S3.E5.m2.16.17.2.2">θ</mi><mrow id="S3.E5.m2.2.2.2.2"><mi id="S3.E5.m2.1.1.1.1">i</mi><mo id="S3.E5.m2.2.2.2.2.2">,</mo><msub id="S3.E5.m2.2.2.2.2.1"><mi id="S3.E5.m2.2.2.2.2.1.2">b</mi><mn id="S3.E5.m2.2.2.2.2.1.3">1</mn></msub></mrow><mrow id="S3.E5.m2.3.3.1.1"><mo stretchy="false" id="S3.E5.m2.3.3.1.1.2">(</mo><msub id="S3.E5.m2.3.3.1.1.1"><mi id="S3.E5.m2.3.3.1.1.1.2">t</mi><mi id="S3.E5.m2.3.3.1.1.1.3">K</mi></msub><mo stretchy="false" id="S3.E5.m2.3.3.1.1.3">)</mo></mrow></msubsup><mo id="S3.E5.m2.16.18">,</mo><msubsup id="S3.E5.m2.16.19"><mi id="S3.E5.m2.16.19.2.2">θ</mi><mrow id="S3.E5.m2.5.5.2.2"><mi id="S3.E5.m2.4.4.1.1">i</mi><mo id="S3.E5.m2.5.5.2.2.2">,</mo><msub id="S3.E5.m2.5.5.2.2.1"><mi id="S3.E5.m2.5.5.2.2.1.2">b</mi><mn id="S3.E5.m2.5.5.2.2.1.3">2</mn></msub></mrow><mrow id="S3.E5.m2.6.6.1.1"><mo stretchy="false" id="S3.E5.m2.6.6.1.1.2">(</mo><msub id="S3.E5.m2.6.6.1.1.1"><mi id="S3.E5.m2.6.6.1.1.1.2">t</mi><mi id="S3.E5.m2.6.6.1.1.1.3">K</mi></msub><mo stretchy="false" id="S3.E5.m2.6.6.1.1.3">)</mo></mrow></msubsup><mo id="S3.E5.m2.16.20">,</mo><mi mathvariant="normal" id="S3.E5.m2.16.16">…</mi><mo id="S3.E5.m2.16.21">,</mo><msubsup id="S3.E5.m2.16.22"><mi id="S3.E5.m2.16.22.2.2">θ</mi><mrow id="S3.E5.m2.8.8.2.2"><mi id="S3.E5.m2.7.7.1.1">i</mi><mo id="S3.E5.m2.8.8.2.2.2">,</mo><msub id="S3.E5.m2.8.8.2.2.1"><mi id="S3.E5.m2.8.8.2.2.1.2">b</mi><mrow id="S3.E5.m2.8.8.2.2.1.3"><mi id="S3.E5.m2.8.8.2.2.1.3.2">K</mi><mo id="S3.E5.m2.8.8.2.2.1.3.1">−</mo><mn id="S3.E5.m2.8.8.2.2.1.3.3">1</mn></mrow></msub></mrow><mrow id="S3.E5.m2.9.9.1.1"><mo stretchy="false" id="S3.E5.m2.9.9.1.1.2">(</mo><msub id="S3.E5.m2.9.9.1.1.1"><mi id="S3.E5.m2.9.9.1.1.1.2">t</mi><mi id="S3.E5.m2.9.9.1.1.1.3">L</mi></msub><mo stretchy="false" id="S3.E5.m2.9.9.1.1.3">)</mo></mrow></msubsup><mo id="S3.E5.m2.16.23">,</mo><msubsup id="S3.E5.m2.16.24"><mi id="S3.E5.m2.16.24.2.2">θ</mi><mrow id="S3.E5.m2.11.11.2.2"><mi id="S3.E5.m2.10.10.1.1">i</mi><mo id="S3.E5.m2.11.11.2.2.2">,</mo><msub id="S3.E5.m2.11.11.2.2.1"><mi id="S3.E5.m2.11.11.2.2.1.2">b</mi><mi id="S3.E5.m2.11.11.2.2.1.3">K</mi></msub></mrow><mrow id="S3.E5.m2.12.12.1.1"><mo stretchy="false" id="S3.E5.m2.12.12.1.1.2">(</mo><msub id="S3.E5.m2.12.12.1.1.1"><mi id="S3.E5.m2.12.12.1.1.1.2">t</mi><mi id="S3.E5.m2.12.12.1.1.1.3">K</mi></msub><mo stretchy="false" id="S3.E5.m2.12.12.1.1.3">)</mo></mrow></msubsup><mo id="S3.E5.m2.16.25">,</mo><msubsup id="S3.E5.m2.16.26"><mi id="S3.E5.m2.16.26.2.2">θ</mi><mrow id="S3.E5.m2.14.14.2.4"><mi id="S3.E5.m2.13.13.1.1">i</mi><mo id="S3.E5.m2.14.14.2.4.1">,</mo><mi id="S3.E5.m2.14.14.2.2">h</mi></mrow><mrow id="S3.E5.m2.15.15.1.3"><mo stretchy="false" id="S3.E5.m2.15.15.1.3.1">(</mo><mn id="S3.E5.m2.15.15.1.1">0</mn><mo stretchy="false" id="S3.E5.m2.15.15.1.3.2">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E5.m2.16.27">)</mo><mo lspace="0em" id="S3.E5.m2.16.28">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E5.m2.16c">\displaystyle\theta_{i,b_{1}}^{(t_{K})},\theta_{i,b_{2}}^{(t_{K})},\ldots,\theta_{i,b_{K-1}}^{(t_{L})},\theta_{i,b_{K}}^{(t_{K})},\theta_{i,h}^{(0)}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.5" class="ltx_p">In Eq. (5), Once the first base layer <math id="S3.SS1.p3.1.m1.2" class="ltx_Math" alttext="\theta_{i,b_{1}}" display="inline"><semantics id="S3.SS1.p3.1.m1.2a"><msub id="S3.SS1.p3.1.m1.2.3" xref="S3.SS1.p3.1.m1.2.3.cmml"><mi id="S3.SS1.p3.1.m1.2.3.2" xref="S3.SS1.p3.1.m1.2.3.2.cmml">θ</mi><mrow id="S3.SS1.p3.1.m1.2.2.2.2" xref="S3.SS1.p3.1.m1.2.2.2.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p3.1.m1.2.2.2.2.2" xref="S3.SS1.p3.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.1.m1.2.2.2.2.1" xref="S3.SS1.p3.1.m1.2.2.2.2.1.cmml"><mi id="S3.SS1.p3.1.m1.2.2.2.2.1.2" xref="S3.SS1.p3.1.m1.2.2.2.2.1.2.cmml">b</mi><mn id="S3.SS1.p3.1.m1.2.2.2.2.1.3" xref="S3.SS1.p3.1.m1.2.2.2.2.1.3.cmml">1</mn></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.2b"><apply id="S3.SS1.p3.1.m1.2.3.cmml" xref="S3.SS1.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.2.3.1.cmml" xref="S3.SS1.p3.1.m1.2.3">subscript</csymbol><ci id="S3.SS1.p3.1.m1.2.3.2.cmml" xref="S3.SS1.p3.1.m1.2.3.2">𝜃</ci><list id="S3.SS1.p3.1.m1.2.2.2.3.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2"><ci id="S3.SS1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1">𝑖</ci><apply id="S3.SS1.p3.1.m1.2.2.2.2.1.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.2.2.2.2.1.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.1.2">𝑏</ci><cn type="integer" id="S3.SS1.p3.1.m1.2.2.2.2.1.3.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.2c">\theta_{i,b_{1}}</annotation></semantics></math> is sufficiently trained, the freeze on the next base layer <math id="S3.SS1.p3.2.m2.2" class="ltx_Math" alttext="\theta_{i,b_{2}}" display="inline"><semantics id="S3.SS1.p3.2.m2.2a"><msub id="S3.SS1.p3.2.m2.2.3" xref="S3.SS1.p3.2.m2.2.3.cmml"><mi id="S3.SS1.p3.2.m2.2.3.2" xref="S3.SS1.p3.2.m2.2.3.2.cmml">θ</mi><mrow id="S3.SS1.p3.2.m2.2.2.2.2" xref="S3.SS1.p3.2.m2.2.2.2.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p3.2.m2.2.2.2.2.2" xref="S3.SS1.p3.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.2.m2.2.2.2.2.1" xref="S3.SS1.p3.2.m2.2.2.2.2.1.cmml"><mi id="S3.SS1.p3.2.m2.2.2.2.2.1.2" xref="S3.SS1.p3.2.m2.2.2.2.2.1.2.cmml">b</mi><mn id="S3.SS1.p3.2.m2.2.2.2.2.1.3" xref="S3.SS1.p3.2.m2.2.2.2.2.1.3.cmml">2</mn></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.2b"><apply id="S3.SS1.p3.2.m2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.2.3.1.cmml" xref="S3.SS1.p3.2.m2.2.3">subscript</csymbol><ci id="S3.SS1.p3.2.m2.2.3.2.cmml" xref="S3.SS1.p3.2.m2.2.3.2">𝜃</ci><list id="S3.SS1.p3.2.m2.2.2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2"><ci id="S3.SS1.p3.2.m2.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1">𝑖</ci><apply id="S3.SS1.p3.2.m2.2.2.2.2.1.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.2.2.2.2.1.1.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.2.2.2.2.1.2.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2.1.2">𝑏</ci><cn type="integer" id="S3.SS1.p3.2.m2.2.2.2.2.1.3.cmml" xref="S3.SS1.p3.2.m2.2.2.2.2.1.3">2</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.2c">\theta_{i,b_{2}}</annotation></semantics></math> is released for training. This sequential unfreezing and training of base layers up to <math id="S3.SS1.p3.3.m3.2" class="ltx_Math" alttext="\theta_{i,b_{K}}" display="inline"><semantics id="S3.SS1.p3.3.m3.2a"><msub id="S3.SS1.p3.3.m3.2.3" xref="S3.SS1.p3.3.m3.2.3.cmml"><mi id="S3.SS1.p3.3.m3.2.3.2" xref="S3.SS1.p3.3.m3.2.3.2.cmml">θ</mi><mrow id="S3.SS1.p3.3.m3.2.2.2.2" xref="S3.SS1.p3.3.m3.2.2.2.3.cmml"><mi id="S3.SS1.p3.3.m3.1.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p3.3.m3.2.2.2.2.2" xref="S3.SS1.p3.3.m3.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.3.m3.2.2.2.2.1" xref="S3.SS1.p3.3.m3.2.2.2.2.1.cmml"><mi id="S3.SS1.p3.3.m3.2.2.2.2.1.2" xref="S3.SS1.p3.3.m3.2.2.2.2.1.2.cmml">b</mi><mi id="S3.SS1.p3.3.m3.2.2.2.2.1.3" xref="S3.SS1.p3.3.m3.2.2.2.2.1.3.cmml">K</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.2b"><apply id="S3.SS1.p3.3.m3.2.3.cmml" xref="S3.SS1.p3.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.2.3.1.cmml" xref="S3.SS1.p3.3.m3.2.3">subscript</csymbol><ci id="S3.SS1.p3.3.m3.2.3.2.cmml" xref="S3.SS1.p3.3.m3.2.3.2">𝜃</ci><list id="S3.SS1.p3.3.m3.2.2.2.3.cmml" xref="S3.SS1.p3.3.m3.2.2.2.2"><ci id="S3.SS1.p3.3.m3.1.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1.1">𝑖</ci><apply id="S3.SS1.p3.3.m3.2.2.2.2.1.cmml" xref="S3.SS1.p3.3.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.2.2.2.2.1.1.cmml" xref="S3.SS1.p3.3.m3.2.2.2.2.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.2.2.2.2.1.2.cmml" xref="S3.SS1.p3.3.m3.2.2.2.2.1.2">𝑏</ci><ci id="S3.SS1.p3.3.m3.2.2.2.2.1.3.cmml" xref="S3.SS1.p3.3.m3.2.2.2.2.1.3">𝐾</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.2c">\theta_{i,b_{K}}</annotation></semantics></math> defines Vanilla scheduling. The {<math id="S3.SS1.p3.4.m4.4" class="ltx_Math" alttext="t_{1},t_{2},\ldots,t_{K}\in T" display="inline"><semantics id="S3.SS1.p3.4.m4.4a"><mrow id="S3.SS1.p3.4.m4.4.4" xref="S3.SS1.p3.4.m4.4.4.cmml"><mrow id="S3.SS1.p3.4.m4.4.4.3.3" xref="S3.SS1.p3.4.m4.4.4.3.4.cmml"><msub id="S3.SS1.p3.4.m4.2.2.1.1.1" xref="S3.SS1.p3.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS1.p3.4.m4.2.2.1.1.1.2" xref="S3.SS1.p3.4.m4.2.2.1.1.1.2.cmml">t</mi><mn id="S3.SS1.p3.4.m4.2.2.1.1.1.3" xref="S3.SS1.p3.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p3.4.m4.4.4.3.3.4" xref="S3.SS1.p3.4.m4.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p3.4.m4.3.3.2.2.2" xref="S3.SS1.p3.4.m4.3.3.2.2.2.cmml"><mi id="S3.SS1.p3.4.m4.3.3.2.2.2.2" xref="S3.SS1.p3.4.m4.3.3.2.2.2.2.cmml">t</mi><mn id="S3.SS1.p3.4.m4.3.3.2.2.2.3" xref="S3.SS1.p3.4.m4.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p3.4.m4.4.4.3.3.5" xref="S3.SS1.p3.4.m4.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">…</mi><mo id="S3.SS1.p3.4.m4.4.4.3.3.6" xref="S3.SS1.p3.4.m4.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p3.4.m4.4.4.3.3.3" xref="S3.SS1.p3.4.m4.4.4.3.3.3.cmml"><mi id="S3.SS1.p3.4.m4.4.4.3.3.3.2" xref="S3.SS1.p3.4.m4.4.4.3.3.3.2.cmml">t</mi><mi id="S3.SS1.p3.4.m4.4.4.3.3.3.3" xref="S3.SS1.p3.4.m4.4.4.3.3.3.3.cmml">K</mi></msub></mrow><mo id="S3.SS1.p3.4.m4.4.4.4" xref="S3.SS1.p3.4.m4.4.4.4.cmml">∈</mo><mi id="S3.SS1.p3.4.m4.4.4.5" xref="S3.SS1.p3.4.m4.4.4.5.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.4b"><apply id="S3.SS1.p3.4.m4.4.4.cmml" xref="S3.SS1.p3.4.m4.4.4"><in id="S3.SS1.p3.4.m4.4.4.4.cmml" xref="S3.SS1.p3.4.m4.4.4.4"></in><list id="S3.SS1.p3.4.m4.4.4.3.4.cmml" xref="S3.SS1.p3.4.m4.4.4.3.3"><apply id="S3.SS1.p3.4.m4.2.2.1.1.1.cmml" xref="S3.SS1.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS1.p3.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS1.p3.4.m4.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS1.p3.4.m4.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p3.4.m4.3.3.2.2.2.cmml" xref="S3.SS1.p3.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS1.p3.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p3.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS1.p3.4.m4.3.3.2.2.2.2">𝑡</ci><cn type="integer" id="S3.SS1.p3.4.m4.3.3.2.2.2.3.cmml" xref="S3.SS1.p3.4.m4.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">…</ci><apply id="S3.SS1.p3.4.m4.4.4.3.3.3.cmml" xref="S3.SS1.p3.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.4.4.3.3.3.1.cmml" xref="S3.SS1.p3.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p3.4.m4.4.4.3.3.3.2.cmml" xref="S3.SS1.p3.4.m4.4.4.3.3.3.2">𝑡</ci><ci id="S3.SS1.p3.4.m4.4.4.3.3.3.3.cmml" xref="S3.SS1.p3.4.m4.4.4.3.3.3.3">𝐾</ci></apply></list><ci id="S3.SS1.p3.4.m4.4.4.5.cmml" xref="S3.SS1.p3.4.m4.4.4.5">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.4c">t_{1},t_{2},\ldots,t_{K}\in T</annotation></semantics></math>} represent the global rounds where the freeze of each layer is released. Throughout the training process, the head layer <math id="S3.SS1.p3.5.m5.2" class="ltx_Math" alttext="\theta_{i,h}" display="inline"><semantics id="S3.SS1.p3.5.m5.2a"><msub id="S3.SS1.p3.5.m5.2.3" xref="S3.SS1.p3.5.m5.2.3.cmml"><mi id="S3.SS1.p3.5.m5.2.3.2" xref="S3.SS1.p3.5.m5.2.3.2.cmml">θ</mi><mrow id="S3.SS1.p3.5.m5.2.2.2.4" xref="S3.SS1.p3.5.m5.2.2.2.3.cmml"><mi id="S3.SS1.p3.5.m5.1.1.1.1" xref="S3.SS1.p3.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p3.5.m5.2.2.2.4.1" xref="S3.SS1.p3.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p3.5.m5.2.2.2.2" xref="S3.SS1.p3.5.m5.2.2.2.2.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.2b"><apply id="S3.SS1.p3.5.m5.2.3.cmml" xref="S3.SS1.p3.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.2.3.1.cmml" xref="S3.SS1.p3.5.m5.2.3">subscript</csymbol><ci id="S3.SS1.p3.5.m5.2.3.2.cmml" xref="S3.SS1.p3.5.m5.2.3.2">𝜃</ci><list id="S3.SS1.p3.5.m5.2.2.2.3.cmml" xref="S3.SS1.p3.5.m5.2.2.2.4"><ci id="S3.SS1.p3.5.m5.1.1.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1.1.1">𝑖</ci><ci id="S3.SS1.p3.5.m5.2.2.2.2.cmml" xref="S3.SS1.p3.5.m5.2.2.2.2">ℎ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.2c">\theta_{i,h}</annotation></semantics></math> is initialized and kept frozen, only being utilized in the final fine-tuning stage.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Method 2: Anti Scheduling</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.1" class="ltx_p">Anti scheduling is a training approach that initiates with the deepest layers (closest to the output) in the base layer, freezing the remaining layers, and then progressively unfreezing them for sufficient training. This method allows the model to preferentially grasp high-level and various features. The training steps of Anti scheduling, starting with the deepest layers, can be given as</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<table id="S6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex4.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\theta_{i}^{(t_{1}+1)}=\theta_{i}^{(t_{1})}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i}," display="inline"><semantics id="S3.Ex4.m1.2a"><mrow id="S3.Ex4.m1.2b"><msubsup id="S3.Ex4.m1.2.3"><mi id="S3.Ex4.m1.2.3.2.2">θ</mi><mi id="S3.Ex4.m1.2.3.2.3">i</mi><mrow id="S3.Ex4.m1.1.1.1.1"><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.2">(</mo><mrow id="S3.Ex4.m1.1.1.1.1.1"><msub id="S3.Ex4.m1.1.1.1.1.1.2"><mi id="S3.Ex4.m1.1.1.1.1.1.2.2">t</mi><mn id="S3.Ex4.m1.1.1.1.1.1.2.3">1</mn></msub><mo id="S3.Ex4.m1.1.1.1.1.1.1">+</mo><mn id="S3.Ex4.m1.1.1.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex4.m1.2.4">=</mo><msubsup id="S3.Ex4.m1.2.5"><mi id="S3.Ex4.m1.2.5.2.2">θ</mi><mi id="S3.Ex4.m1.2.5.2.3">i</mi><mrow id="S3.Ex4.m1.2.2.1.1"><mo stretchy="false" id="S3.Ex4.m1.2.2.1.1.2">(</mo><msub id="S3.Ex4.m1.2.2.1.1.1"><mi id="S3.Ex4.m1.2.2.1.1.1.2">t</mi><mn id="S3.Ex4.m1.2.2.1.1.1.3">1</mn></msub><mo stretchy="false" id="S3.Ex4.m1.2.2.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex4.m1.2.6">−</mo><mi id="S3.Ex4.m1.2.7">η</mi><msub id="S3.Ex4.m1.2.8"><mo lspace="0.167em" rspace="0.167em" id="S3.Ex4.m1.2.8.2">∇</mo><msub id="S3.Ex4.m1.2.8.3"><mi id="S3.Ex4.m1.2.8.3.2">θ</mi><mi id="S3.Ex4.m1.2.8.3.3">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="S3.Ex4.m1.2.9">ℒ</mi><mrow id="S3.Ex4.m1.2.10"><mo stretchy="false" id="S3.Ex4.m1.2.10.1">(</mo><msub id="S3.Ex4.m1.2.10.2"><mi id="S3.Ex4.m1.2.10.2.2">D</mi><mi id="S3.Ex4.m1.2.10.2.3">i</mi></msub><mo id="S3.Ex4.m1.2.10.3">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex4.m1.2c">\displaystyle\theta_{i}^{(t_{1}+1)}=\theta_{i}^{(t_{1})}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex4.m2.16" class="ltx_math_unparsed" alttext="\displaystyle\theta_{i,b_{1}}^{(0)},\theta_{i,b_{2}}^{(0)},\ldots,\theta_{i,b_{K-1}}^{(0)},\theta_{i,b_{K}}^{(t_{1})},\theta_{i,h}^{(0)})" display="inline"><semantics id="S3.Ex4.m2.16a"><mrow id="S3.Ex4.m2.16b"><msubsup id="S3.Ex4.m2.16.17"><mi id="S3.Ex4.m2.16.17.2.2">θ</mi><mrow id="S3.Ex4.m2.2.2.2.2"><mi id="S3.Ex4.m2.1.1.1.1">i</mi><mo id="S3.Ex4.m2.2.2.2.2.2">,</mo><msub id="S3.Ex4.m2.2.2.2.2.1"><mi id="S3.Ex4.m2.2.2.2.2.1.2">b</mi><mn id="S3.Ex4.m2.2.2.2.2.1.3">1</mn></msub></mrow><mrow id="S3.Ex4.m2.3.3.1.3"><mo stretchy="false" id="S3.Ex4.m2.3.3.1.3.1">(</mo><mn id="S3.Ex4.m2.3.3.1.1">0</mn><mo stretchy="false" id="S3.Ex4.m2.3.3.1.3.2">)</mo></mrow></msubsup><mo id="S3.Ex4.m2.16.18">,</mo><msubsup id="S3.Ex4.m2.16.19"><mi id="S3.Ex4.m2.16.19.2.2">θ</mi><mrow id="S3.Ex4.m2.5.5.2.2"><mi id="S3.Ex4.m2.4.4.1.1">i</mi><mo id="S3.Ex4.m2.5.5.2.2.2">,</mo><msub id="S3.Ex4.m2.5.5.2.2.1"><mi id="S3.Ex4.m2.5.5.2.2.1.2">b</mi><mn id="S3.Ex4.m2.5.5.2.2.1.3">2</mn></msub></mrow><mrow id="S3.Ex4.m2.6.6.1.3"><mo stretchy="false" id="S3.Ex4.m2.6.6.1.3.1">(</mo><mn id="S3.Ex4.m2.6.6.1.1">0</mn><mo stretchy="false" id="S3.Ex4.m2.6.6.1.3.2">)</mo></mrow></msubsup><mo id="S3.Ex4.m2.16.20">,</mo><mi mathvariant="normal" id="S3.Ex4.m2.16.16">…</mi><mo id="S3.Ex4.m2.16.21">,</mo><msubsup id="S3.Ex4.m2.16.22"><mi id="S3.Ex4.m2.16.22.2.2">θ</mi><mrow id="S3.Ex4.m2.8.8.2.2"><mi id="S3.Ex4.m2.7.7.1.1">i</mi><mo id="S3.Ex4.m2.8.8.2.2.2">,</mo><msub id="S3.Ex4.m2.8.8.2.2.1"><mi id="S3.Ex4.m2.8.8.2.2.1.2">b</mi><mrow id="S3.Ex4.m2.8.8.2.2.1.3"><mi id="S3.Ex4.m2.8.8.2.2.1.3.2">K</mi><mo id="S3.Ex4.m2.8.8.2.2.1.3.1">−</mo><mn id="S3.Ex4.m2.8.8.2.2.1.3.3">1</mn></mrow></msub></mrow><mrow id="S3.Ex4.m2.9.9.1.3"><mo stretchy="false" id="S3.Ex4.m2.9.9.1.3.1">(</mo><mn id="S3.Ex4.m2.9.9.1.1">0</mn><mo stretchy="false" id="S3.Ex4.m2.9.9.1.3.2">)</mo></mrow></msubsup><mo id="S3.Ex4.m2.16.23">,</mo><msubsup id="S3.Ex4.m2.16.24"><mi id="S3.Ex4.m2.16.24.2.2">θ</mi><mrow id="S3.Ex4.m2.11.11.2.2"><mi id="S3.Ex4.m2.10.10.1.1">i</mi><mo id="S3.Ex4.m2.11.11.2.2.2">,</mo><msub id="S3.Ex4.m2.11.11.2.2.1"><mi id="S3.Ex4.m2.11.11.2.2.1.2">b</mi><mi id="S3.Ex4.m2.11.11.2.2.1.3">K</mi></msub></mrow><mrow id="S3.Ex4.m2.12.12.1.1"><mo stretchy="false" id="S3.Ex4.m2.12.12.1.1.2">(</mo><msub id="S3.Ex4.m2.12.12.1.1.1"><mi id="S3.Ex4.m2.12.12.1.1.1.2">t</mi><mn id="S3.Ex4.m2.12.12.1.1.1.3">1</mn></msub><mo stretchy="false" id="S3.Ex4.m2.12.12.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex4.m2.16.25">,</mo><msubsup id="S3.Ex4.m2.16.26"><mi id="S3.Ex4.m2.16.26.2.2">θ</mi><mrow id="S3.Ex4.m2.14.14.2.4"><mi id="S3.Ex4.m2.13.13.1.1">i</mi><mo id="S3.Ex4.m2.14.14.2.4.1">,</mo><mi id="S3.Ex4.m2.14.14.2.2">h</mi></mrow><mrow id="S3.Ex4.m2.15.15.1.3"><mo stretchy="false" id="S3.Ex4.m2.15.15.1.3.1">(</mo><mn id="S3.Ex4.m2.15.15.1.1">0</mn><mo stretchy="false" id="S3.Ex4.m2.15.15.1.3.2">)</mo></mrow></msubsup><mo stretchy="false" id="S3.Ex4.m2.16.27">)</mo></mrow><annotation encoding="application/x-tex" id="S3.Ex4.m2.16c">\displaystyle\theta_{i,b_{1}}^{(0)},\theta_{i,b_{2}}^{(0)},\ldots,\theta_{i,b_{K-1}}^{(0)},\theta_{i,b_{K}}^{(t_{1})},\theta_{i,h}^{(0)})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex5.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\theta_{i}^{(t_{2}+1)}=\theta_{i}^{(t_{2})}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i}," display="inline"><semantics id="S3.Ex5.m1.2a"><mrow id="S3.Ex5.m1.2b"><msubsup id="S3.Ex5.m1.2.3"><mi id="S3.Ex5.m1.2.3.2.2">θ</mi><mi id="S3.Ex5.m1.2.3.2.3">i</mi><mrow id="S3.Ex5.m1.1.1.1.1"><mo stretchy="false" id="S3.Ex5.m1.1.1.1.1.2">(</mo><mrow id="S3.Ex5.m1.1.1.1.1.1"><msub id="S3.Ex5.m1.1.1.1.1.1.2"><mi id="S3.Ex5.m1.1.1.1.1.1.2.2">t</mi><mn id="S3.Ex5.m1.1.1.1.1.1.2.3">2</mn></msub><mo id="S3.Ex5.m1.1.1.1.1.1.1">+</mo><mn id="S3.Ex5.m1.1.1.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S3.Ex5.m1.1.1.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex5.m1.2.4">=</mo><msubsup id="S3.Ex5.m1.2.5"><mi id="S3.Ex5.m1.2.5.2.2">θ</mi><mi id="S3.Ex5.m1.2.5.2.3">i</mi><mrow id="S3.Ex5.m1.2.2.1.1"><mo stretchy="false" id="S3.Ex5.m1.2.2.1.1.2">(</mo><msub id="S3.Ex5.m1.2.2.1.1.1"><mi id="S3.Ex5.m1.2.2.1.1.1.2">t</mi><mn id="S3.Ex5.m1.2.2.1.1.1.3">2</mn></msub><mo stretchy="false" id="S3.Ex5.m1.2.2.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex5.m1.2.6">−</mo><mi id="S3.Ex5.m1.2.7">η</mi><msub id="S3.Ex5.m1.2.8"><mo lspace="0.167em" rspace="0.167em" id="S3.Ex5.m1.2.8.2">∇</mo><msub id="S3.Ex5.m1.2.8.3"><mi id="S3.Ex5.m1.2.8.3.2">θ</mi><mi id="S3.Ex5.m1.2.8.3.3">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="S3.Ex5.m1.2.9">ℒ</mi><mrow id="S3.Ex5.m1.2.10"><mo stretchy="false" id="S3.Ex5.m1.2.10.1">(</mo><msub id="S3.Ex5.m1.2.10.2"><mi id="S3.Ex5.m1.2.10.2.2">D</mi><mi id="S3.Ex5.m1.2.10.2.3">i</mi></msub><mo id="S3.Ex5.m1.2.10.3">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.Ex5.m1.2c">\displaystyle\theta_{i}^{(t_{2}+1)}=\theta_{i}^{(t_{2})}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex5.m2.16" class="ltx_math_unparsed" alttext="\displaystyle\theta_{i,b_{1}}^{(0)},\theta_{i,b_{2}}^{(0)},\ldots,\theta_{i,b_{K-1}}^{(t_{2})},\theta_{i,b_{K}}^{(t_{2})},\theta_{i,h}^{(0)})" display="inline"><semantics id="S3.Ex5.m2.16a"><mrow id="S3.Ex5.m2.16b"><msubsup id="S3.Ex5.m2.16.17"><mi id="S3.Ex5.m2.16.17.2.2">θ</mi><mrow id="S3.Ex5.m2.2.2.2.2"><mi id="S3.Ex5.m2.1.1.1.1">i</mi><mo id="S3.Ex5.m2.2.2.2.2.2">,</mo><msub id="S3.Ex5.m2.2.2.2.2.1"><mi id="S3.Ex5.m2.2.2.2.2.1.2">b</mi><mn id="S3.Ex5.m2.2.2.2.2.1.3">1</mn></msub></mrow><mrow id="S3.Ex5.m2.3.3.1.3"><mo stretchy="false" id="S3.Ex5.m2.3.3.1.3.1">(</mo><mn id="S3.Ex5.m2.3.3.1.1">0</mn><mo stretchy="false" id="S3.Ex5.m2.3.3.1.3.2">)</mo></mrow></msubsup><mo id="S3.Ex5.m2.16.18">,</mo><msubsup id="S3.Ex5.m2.16.19"><mi id="S3.Ex5.m2.16.19.2.2">θ</mi><mrow id="S3.Ex5.m2.5.5.2.2"><mi id="S3.Ex5.m2.4.4.1.1">i</mi><mo id="S3.Ex5.m2.5.5.2.2.2">,</mo><msub id="S3.Ex5.m2.5.5.2.2.1"><mi id="S3.Ex5.m2.5.5.2.2.1.2">b</mi><mn id="S3.Ex5.m2.5.5.2.2.1.3">2</mn></msub></mrow><mrow id="S3.Ex5.m2.6.6.1.3"><mo stretchy="false" id="S3.Ex5.m2.6.6.1.3.1">(</mo><mn id="S3.Ex5.m2.6.6.1.1">0</mn><mo stretchy="false" id="S3.Ex5.m2.6.6.1.3.2">)</mo></mrow></msubsup><mo id="S3.Ex5.m2.16.20">,</mo><mi mathvariant="normal" id="S3.Ex5.m2.16.16">…</mi><mo id="S3.Ex5.m2.16.21">,</mo><msubsup id="S3.Ex5.m2.16.22"><mi id="S3.Ex5.m2.16.22.2.2">θ</mi><mrow id="S3.Ex5.m2.8.8.2.2"><mi id="S3.Ex5.m2.7.7.1.1">i</mi><mo id="S3.Ex5.m2.8.8.2.2.2">,</mo><msub id="S3.Ex5.m2.8.8.2.2.1"><mi id="S3.Ex5.m2.8.8.2.2.1.2">b</mi><mrow id="S3.Ex5.m2.8.8.2.2.1.3"><mi id="S3.Ex5.m2.8.8.2.2.1.3.2">K</mi><mo id="S3.Ex5.m2.8.8.2.2.1.3.1">−</mo><mn id="S3.Ex5.m2.8.8.2.2.1.3.3">1</mn></mrow></msub></mrow><mrow id="S3.Ex5.m2.9.9.1.1"><mo stretchy="false" id="S3.Ex5.m2.9.9.1.1.2">(</mo><msub id="S3.Ex5.m2.9.9.1.1.1"><mi id="S3.Ex5.m2.9.9.1.1.1.2">t</mi><mn id="S3.Ex5.m2.9.9.1.1.1.3">2</mn></msub><mo stretchy="false" id="S3.Ex5.m2.9.9.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex5.m2.16.23">,</mo><msubsup id="S3.Ex5.m2.16.24"><mi id="S3.Ex5.m2.16.24.2.2">θ</mi><mrow id="S3.Ex5.m2.11.11.2.2"><mi id="S3.Ex5.m2.10.10.1.1">i</mi><mo id="S3.Ex5.m2.11.11.2.2.2">,</mo><msub id="S3.Ex5.m2.11.11.2.2.1"><mi id="S3.Ex5.m2.11.11.2.2.1.2">b</mi><mi id="S3.Ex5.m2.11.11.2.2.1.3">K</mi></msub></mrow><mrow id="S3.Ex5.m2.12.12.1.1"><mo stretchy="false" id="S3.Ex5.m2.12.12.1.1.2">(</mo><msub id="S3.Ex5.m2.12.12.1.1.1"><mi id="S3.Ex5.m2.12.12.1.1.1.2">t</mi><mn id="S3.Ex5.m2.12.12.1.1.1.3">2</mn></msub><mo stretchy="false" id="S3.Ex5.m2.12.12.1.1.3">)</mo></mrow></msubsup><mo id="S3.Ex5.m2.16.25">,</mo><msubsup id="S3.Ex5.m2.16.26"><mi id="S3.Ex5.m2.16.26.2.2">θ</mi><mrow id="S3.Ex5.m2.14.14.2.4"><mi id="S3.Ex5.m2.13.13.1.1">i</mi><mo id="S3.Ex5.m2.14.14.2.4.1">,</mo><mi id="S3.Ex5.m2.14.14.2.2">h</mi></mrow><mrow id="S3.Ex5.m2.15.15.1.3"><mo stretchy="false" id="S3.Ex5.m2.15.15.1.3.1">(</mo><mn id="S3.Ex5.m2.15.15.1.1">0</mn><mo stretchy="false" id="S3.Ex5.m2.15.15.1.3.2">)</mo></mrow></msubsup><mo stretchy="false" id="S3.Ex5.m2.16.27">)</mo></mrow><annotation encoding="application/x-tex" id="S3.Ex5.m2.16c">\displaystyle\theta_{i,b_{1}}^{(0)},\theta_{i,b_{2}}^{(0)},\ldots,\theta_{i,b_{K-1}}^{(t_{2})},\theta_{i,b_{K}}^{(t_{2})},\theta_{i,h}^{(0)})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex6.m1.1" class="ltx_Math" alttext="\displaystyle\vdots" display="inline"><semantics id="S3.Ex6.m1.1a"><mi mathvariant="normal" id="S3.Ex6.m1.1.1" xref="S3.Ex6.m1.1.1.cmml">⋮</mi><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.1b"><ci id="S3.Ex6.m1.1.1.cmml" xref="S3.Ex6.m1.1.1">⋮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.1c">\displaystyle\vdots</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\theta_{i}^{(t_{K}+1)}=\theta_{i}^{(t_{K})}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i}," display="inline"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2b"><msubsup id="S3.E6.m1.2.3"><mi id="S3.E6.m1.2.3.2.2">θ</mi><mi id="S3.E6.m1.2.3.2.3">i</mi><mrow id="S3.E6.m1.1.1.1.1"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.2">(</mo><mrow id="S3.E6.m1.1.1.1.1.1"><msub id="S3.E6.m1.1.1.1.1.1.2"><mi id="S3.E6.m1.1.1.1.1.1.2.2">t</mi><mi id="S3.E6.m1.1.1.1.1.1.2.3">K</mi></msub><mo id="S3.E6.m1.1.1.1.1.1.1">+</mo><mn id="S3.E6.m1.1.1.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.3">)</mo></mrow></msubsup><mo id="S3.E6.m1.2.4">=</mo><msubsup id="S3.E6.m1.2.5"><mi id="S3.E6.m1.2.5.2.2">θ</mi><mi id="S3.E6.m1.2.5.2.3">i</mi><mrow id="S3.E6.m1.2.2.1.1"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.2">(</mo><msub id="S3.E6.m1.2.2.1.1.1"><mi id="S3.E6.m1.2.2.1.1.1.2">t</mi><mi id="S3.E6.m1.2.2.1.1.1.3">K</mi></msub><mo stretchy="false" id="S3.E6.m1.2.2.1.1.3">)</mo></mrow></msubsup><mo id="S3.E6.m1.2.6">−</mo><mi id="S3.E6.m1.2.7">η</mi><msub id="S3.E6.m1.2.8"><mo lspace="0.167em" rspace="0.167em" id="S3.E6.m1.2.8.2">∇</mo><msub id="S3.E6.m1.2.8.3"><mi id="S3.E6.m1.2.8.3.2">θ</mi><mi id="S3.E6.m1.2.8.3.3">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.9">ℒ</mi><mrow id="S3.E6.m1.2.10"><mo stretchy="false" id="S3.E6.m1.2.10.1">(</mo><msub id="S3.E6.m1.2.10.2"><mi id="S3.E6.m1.2.10.2.2">D</mi><mi id="S3.E6.m1.2.10.2.3">i</mi></msub><mo id="S3.E6.m1.2.10.3">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E6.m1.2c">\displaystyle\theta_{i}^{(t_{K}+1)}=\theta_{i}^{(t_{K})}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6.m2.16" class="ltx_math_unparsed" alttext="\displaystyle\theta_{i,b_{1}}^{(t_{K})},\theta_{i,b_{2}}^{(t_{K})},\ldots,\theta_{i,b_{K-1}}^{(t_{K})},\theta_{i,b_{K}}^{(t_{K})},\theta_{i,h}^{(0)})." display="inline"><semantics id="S3.E6.m2.16a"><mrow id="S3.E6.m2.16b"><msubsup id="S3.E6.m2.16.17"><mi id="S3.E6.m2.16.17.2.2">θ</mi><mrow id="S3.E6.m2.2.2.2.2"><mi id="S3.E6.m2.1.1.1.1">i</mi><mo id="S3.E6.m2.2.2.2.2.2">,</mo><msub id="S3.E6.m2.2.2.2.2.1"><mi id="S3.E6.m2.2.2.2.2.1.2">b</mi><mn id="S3.E6.m2.2.2.2.2.1.3">1</mn></msub></mrow><mrow id="S3.E6.m2.3.3.1.1"><mo stretchy="false" id="S3.E6.m2.3.3.1.1.2">(</mo><msub id="S3.E6.m2.3.3.1.1.1"><mi id="S3.E6.m2.3.3.1.1.1.2">t</mi><mi id="S3.E6.m2.3.3.1.1.1.3">K</mi></msub><mo stretchy="false" id="S3.E6.m2.3.3.1.1.3">)</mo></mrow></msubsup><mo id="S3.E6.m2.16.18">,</mo><msubsup id="S3.E6.m2.16.19"><mi id="S3.E6.m2.16.19.2.2">θ</mi><mrow id="S3.E6.m2.5.5.2.2"><mi id="S3.E6.m2.4.4.1.1">i</mi><mo id="S3.E6.m2.5.5.2.2.2">,</mo><msub id="S3.E6.m2.5.5.2.2.1"><mi id="S3.E6.m2.5.5.2.2.1.2">b</mi><mn id="S3.E6.m2.5.5.2.2.1.3">2</mn></msub></mrow><mrow id="S3.E6.m2.6.6.1.1"><mo stretchy="false" id="S3.E6.m2.6.6.1.1.2">(</mo><msub id="S3.E6.m2.6.6.1.1.1"><mi id="S3.E6.m2.6.6.1.1.1.2">t</mi><mi id="S3.E6.m2.6.6.1.1.1.3">K</mi></msub><mo stretchy="false" id="S3.E6.m2.6.6.1.1.3">)</mo></mrow></msubsup><mo id="S3.E6.m2.16.20">,</mo><mi mathvariant="normal" id="S3.E6.m2.16.16">…</mi><mo id="S3.E6.m2.16.21">,</mo><msubsup id="S3.E6.m2.16.22"><mi id="S3.E6.m2.16.22.2.2">θ</mi><mrow id="S3.E6.m2.8.8.2.2"><mi id="S3.E6.m2.7.7.1.1">i</mi><mo id="S3.E6.m2.8.8.2.2.2">,</mo><msub id="S3.E6.m2.8.8.2.2.1"><mi id="S3.E6.m2.8.8.2.2.1.2">b</mi><mrow id="S3.E6.m2.8.8.2.2.1.3"><mi id="S3.E6.m2.8.8.2.2.1.3.2">K</mi><mo id="S3.E6.m2.8.8.2.2.1.3.1">−</mo><mn id="S3.E6.m2.8.8.2.2.1.3.3">1</mn></mrow></msub></mrow><mrow id="S3.E6.m2.9.9.1.1"><mo stretchy="false" id="S3.E6.m2.9.9.1.1.2">(</mo><msub id="S3.E6.m2.9.9.1.1.1"><mi id="S3.E6.m2.9.9.1.1.1.2">t</mi><mi id="S3.E6.m2.9.9.1.1.1.3">K</mi></msub><mo stretchy="false" id="S3.E6.m2.9.9.1.1.3">)</mo></mrow></msubsup><mo id="S3.E6.m2.16.23">,</mo><msubsup id="S3.E6.m2.16.24"><mi id="S3.E6.m2.16.24.2.2">θ</mi><mrow id="S3.E6.m2.11.11.2.2"><mi id="S3.E6.m2.10.10.1.1">i</mi><mo id="S3.E6.m2.11.11.2.2.2">,</mo><msub id="S3.E6.m2.11.11.2.2.1"><mi id="S3.E6.m2.11.11.2.2.1.2">b</mi><mi id="S3.E6.m2.11.11.2.2.1.3">K</mi></msub></mrow><mrow id="S3.E6.m2.12.12.1.1"><mo stretchy="false" id="S3.E6.m2.12.12.1.1.2">(</mo><msub id="S3.E6.m2.12.12.1.1.1"><mi id="S3.E6.m2.12.12.1.1.1.2">t</mi><mi id="S3.E6.m2.12.12.1.1.1.3">K</mi></msub><mo stretchy="false" id="S3.E6.m2.12.12.1.1.3">)</mo></mrow></msubsup><mo id="S3.E6.m2.16.25">,</mo><msubsup id="S3.E6.m2.16.26"><mi id="S3.E6.m2.16.26.2.2">θ</mi><mrow id="S3.E6.m2.14.14.2.4"><mi id="S3.E6.m2.13.13.1.1">i</mi><mo id="S3.E6.m2.14.14.2.4.1">,</mo><mi id="S3.E6.m2.14.14.2.2">h</mi></mrow><mrow id="S3.E6.m2.15.15.1.3"><mo stretchy="false" id="S3.E6.m2.15.15.1.3.1">(</mo><mn id="S3.E6.m2.15.15.1.1">0</mn><mo stretchy="false" id="S3.E6.m2.15.15.1.3.2">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E6.m2.16.27">)</mo><mo lspace="0em" id="S3.E6.m2.16.28">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E6.m2.16c">\displaystyle\theta_{i,b_{1}}^{(t_{K})},\theta_{i,b_{2}}^{(t_{K})},\ldots,\theta_{i,b_{K-1}}^{(t_{K})},\theta_{i,b_{K}}^{(t_{K})},\theta_{i,h}^{(0)}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.5" class="ltx_p">In Eq (6), once the deepest base layer <math id="S3.SS2.p3.1.m1.2" class="ltx_Math" alttext="\theta_{i,b_{K}}" display="inline"><semantics id="S3.SS2.p3.1.m1.2a"><msub id="S3.SS2.p3.1.m1.2.3" xref="S3.SS2.p3.1.m1.2.3.cmml"><mi id="S3.SS2.p3.1.m1.2.3.2" xref="S3.SS2.p3.1.m1.2.3.2.cmml">θ</mi><mrow id="S3.SS2.p3.1.m1.2.2.2.2" xref="S3.SS2.p3.1.m1.2.2.2.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.1.m1.2.2.2.2.2" xref="S3.SS2.p3.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p3.1.m1.2.2.2.2.1" xref="S3.SS2.p3.1.m1.2.2.2.2.1.cmml"><mi id="S3.SS2.p3.1.m1.2.2.2.2.1.2" xref="S3.SS2.p3.1.m1.2.2.2.2.1.2.cmml">b</mi><mi id="S3.SS2.p3.1.m1.2.2.2.2.1.3" xref="S3.SS2.p3.1.m1.2.2.2.2.1.3.cmml">K</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.2b"><apply id="S3.SS2.p3.1.m1.2.3.cmml" xref="S3.SS2.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.2.3.1.cmml" xref="S3.SS2.p3.1.m1.2.3">subscript</csymbol><ci id="S3.SS2.p3.1.m1.2.3.2.cmml" xref="S3.SS2.p3.1.m1.2.3.2">𝜃</ci><list id="S3.SS2.p3.1.m1.2.2.2.3.cmml" xref="S3.SS2.p3.1.m1.2.2.2.2"><ci id="S3.SS2.p3.1.m1.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1">𝑖</ci><apply id="S3.SS2.p3.1.m1.2.2.2.2.1.cmml" xref="S3.SS2.p3.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS2.p3.1.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.2.2.2.2.1.2.cmml" xref="S3.SS2.p3.1.m1.2.2.2.2.1.2">𝑏</ci><ci id="S3.SS2.p3.1.m1.2.2.2.2.1.3.cmml" xref="S3.SS2.p3.1.m1.2.2.2.2.1.3">𝐾</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.2c">\theta_{i,b_{K}}</annotation></semantics></math> is sufficiently trained, the freeze on the preceding layer <math id="S3.SS2.p3.2.m2.2" class="ltx_Math" alttext="\theta_{i,b_{K-1}}" display="inline"><semantics id="S3.SS2.p3.2.m2.2a"><msub id="S3.SS2.p3.2.m2.2.3" xref="S3.SS2.p3.2.m2.2.3.cmml"><mi id="S3.SS2.p3.2.m2.2.3.2" xref="S3.SS2.p3.2.m2.2.3.2.cmml">θ</mi><mrow id="S3.SS2.p3.2.m2.2.2.2.2" xref="S3.SS2.p3.2.m2.2.2.2.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.2.m2.2.2.2.2.2" xref="S3.SS2.p3.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p3.2.m2.2.2.2.2.1" xref="S3.SS2.p3.2.m2.2.2.2.2.1.cmml"><mi id="S3.SS2.p3.2.m2.2.2.2.2.1.2" xref="S3.SS2.p3.2.m2.2.2.2.2.1.2.cmml">b</mi><mrow id="S3.SS2.p3.2.m2.2.2.2.2.1.3" xref="S3.SS2.p3.2.m2.2.2.2.2.1.3.cmml"><mi id="S3.SS2.p3.2.m2.2.2.2.2.1.3.2" xref="S3.SS2.p3.2.m2.2.2.2.2.1.3.2.cmml">K</mi><mo id="S3.SS2.p3.2.m2.2.2.2.2.1.3.1" xref="S3.SS2.p3.2.m2.2.2.2.2.1.3.1.cmml">−</mo><mn id="S3.SS2.p3.2.m2.2.2.2.2.1.3.3" xref="S3.SS2.p3.2.m2.2.2.2.2.1.3.3.cmml">1</mn></mrow></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.2b"><apply id="S3.SS2.p3.2.m2.2.3.cmml" xref="S3.SS2.p3.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.3.1.cmml" xref="S3.SS2.p3.2.m2.2.3">subscript</csymbol><ci id="S3.SS2.p3.2.m2.2.3.2.cmml" xref="S3.SS2.p3.2.m2.2.3.2">𝜃</ci><list id="S3.SS2.p3.2.m2.2.2.2.3.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2"><ci id="S3.SS2.p3.2.m2.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1">𝑖</ci><apply id="S3.SS2.p3.2.m2.2.2.2.2.1.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.2.2.2.1.1.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.2.2.2.2.1.2.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.1.2">𝑏</ci><apply id="S3.SS2.p3.2.m2.2.2.2.2.1.3.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.1.3"><minus id="S3.SS2.p3.2.m2.2.2.2.2.1.3.1.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.1.3.1"></minus><ci id="S3.SS2.p3.2.m2.2.2.2.2.1.3.2.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.1.3.2">𝐾</ci><cn type="integer" id="S3.SS2.p3.2.m2.2.2.2.2.1.3.3.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.1.3.3">1</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.2c">\theta_{i,b_{K-1}}</annotation></semantics></math> is released for training. Anti scheduling is thus defined as the sequential unfreezing and training of base layers starting from <math id="S3.SS2.p3.3.m3.2" class="ltx_Math" alttext="\theta_{i,b_{K}}" display="inline"><semantics id="S3.SS2.p3.3.m3.2a"><msub id="S3.SS2.p3.3.m3.2.3" xref="S3.SS2.p3.3.m3.2.3.cmml"><mi id="S3.SS2.p3.3.m3.2.3.2" xref="S3.SS2.p3.3.m3.2.3.2.cmml">θ</mi><mrow id="S3.SS2.p3.3.m3.2.2.2.2" xref="S3.SS2.p3.3.m3.2.2.2.3.cmml"><mi id="S3.SS2.p3.3.m3.1.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.3.m3.2.2.2.2.2" xref="S3.SS2.p3.3.m3.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p3.3.m3.2.2.2.2.1" xref="S3.SS2.p3.3.m3.2.2.2.2.1.cmml"><mi id="S3.SS2.p3.3.m3.2.2.2.2.1.2" xref="S3.SS2.p3.3.m3.2.2.2.2.1.2.cmml">b</mi><mi id="S3.SS2.p3.3.m3.2.2.2.2.1.3" xref="S3.SS2.p3.3.m3.2.2.2.2.1.3.cmml">K</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.2b"><apply id="S3.SS2.p3.3.m3.2.3.cmml" xref="S3.SS2.p3.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.2.3.1.cmml" xref="S3.SS2.p3.3.m3.2.3">subscript</csymbol><ci id="S3.SS2.p3.3.m3.2.3.2.cmml" xref="S3.SS2.p3.3.m3.2.3.2">𝜃</ci><list id="S3.SS2.p3.3.m3.2.2.2.3.cmml" xref="S3.SS2.p3.3.m3.2.2.2.2"><ci id="S3.SS2.p3.3.m3.1.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1">𝑖</ci><apply id="S3.SS2.p3.3.m3.2.2.2.2.1.cmml" xref="S3.SS2.p3.3.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.2.2.2.2.1.1.cmml" xref="S3.SS2.p3.3.m3.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.2.2.2.2.1.2.cmml" xref="S3.SS2.p3.3.m3.2.2.2.2.1.2">𝑏</ci><ci id="S3.SS2.p3.3.m3.2.2.2.2.1.3.cmml" xref="S3.SS2.p3.3.m3.2.2.2.2.1.3">𝐾</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.2c">\theta_{i,b_{K}}</annotation></semantics></math> and proceeding to the first base layer <math id="S3.SS2.p3.4.m4.2" class="ltx_Math" alttext="\theta_{i,b_{1}}" display="inline"><semantics id="S3.SS2.p3.4.m4.2a"><msub id="S3.SS2.p3.4.m4.2.3" xref="S3.SS2.p3.4.m4.2.3.cmml"><mi id="S3.SS2.p3.4.m4.2.3.2" xref="S3.SS2.p3.4.m4.2.3.2.cmml">θ</mi><mrow id="S3.SS2.p3.4.m4.2.2.2.2" xref="S3.SS2.p3.4.m4.2.2.2.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.4.m4.2.2.2.2.2" xref="S3.SS2.p3.4.m4.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p3.4.m4.2.2.2.2.1" xref="S3.SS2.p3.4.m4.2.2.2.2.1.cmml"><mi id="S3.SS2.p3.4.m4.2.2.2.2.1.2" xref="S3.SS2.p3.4.m4.2.2.2.2.1.2.cmml">b</mi><mn id="S3.SS2.p3.4.m4.2.2.2.2.1.3" xref="S3.SS2.p3.4.m4.2.2.2.2.1.3.cmml">1</mn></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.2b"><apply id="S3.SS2.p3.4.m4.2.3.cmml" xref="S3.SS2.p3.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.2.3.1.cmml" xref="S3.SS2.p3.4.m4.2.3">subscript</csymbol><ci id="S3.SS2.p3.4.m4.2.3.2.cmml" xref="S3.SS2.p3.4.m4.2.3.2">𝜃</ci><list id="S3.SS2.p3.4.m4.2.2.2.3.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2"><ci id="S3.SS2.p3.4.m4.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1">𝑖</ci><apply id="S3.SS2.p3.4.m4.2.2.2.2.1.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.2.2.2.2.1.1.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.2.2.2.2.1.2.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.1.2">𝑏</ci><cn type="integer" id="S3.SS2.p3.4.m4.2.2.2.2.1.3.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.2c">\theta_{i,b_{1}}</annotation></semantics></math>. The training progresses in the reverse order of Anti scheduling, and during this process, the head layer <math id="S3.SS2.p3.5.m5.2" class="ltx_Math" alttext="\theta_{i,h}" display="inline"><semantics id="S3.SS2.p3.5.m5.2a"><msub id="S3.SS2.p3.5.m5.2.3" xref="S3.SS2.p3.5.m5.2.3.cmml"><mi id="S3.SS2.p3.5.m5.2.3.2" xref="S3.SS2.p3.5.m5.2.3.2.cmml">θ</mi><mrow id="S3.SS2.p3.5.m5.2.2.2.4" xref="S3.SS2.p3.5.m5.2.2.2.3.cmml"><mi id="S3.SS2.p3.5.m5.1.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p3.5.m5.2.2.2.4.1" xref="S3.SS2.p3.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p3.5.m5.2.2.2.2" xref="S3.SS2.p3.5.m5.2.2.2.2.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.2b"><apply id="S3.SS2.p3.5.m5.2.3.cmml" xref="S3.SS2.p3.5.m5.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.2.3.1.cmml" xref="S3.SS2.p3.5.m5.2.3">subscript</csymbol><ci id="S3.SS2.p3.5.m5.2.3.2.cmml" xref="S3.SS2.p3.5.m5.2.3.2">𝜃</ci><list id="S3.SS2.p3.5.m5.2.2.2.3.cmml" xref="S3.SS2.p3.5.m5.2.2.2.4"><ci id="S3.SS2.p3.5.m5.1.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1.1">𝑖</ci><ci id="S3.SS2.p3.5.m5.2.2.2.2.cmml" xref="S3.SS2.p3.5.m5.2.2.2.2">ℎ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.2c">\theta_{i,h}</annotation></semantics></math> remains frozen and is only utilized in the final fine-tuning phase.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.12.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Layer Decoupling Algorithm with Vanilla and Anti Scheduling</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.10" class="ltx_p ltx_figure_panel"><span id="alg1.10.1" class="ltx_text ltx_font_bold">Input</span>: Total global rounds <math id="alg1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">T</annotation></semantics></math>, Total clients <math id="alg1.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.2.m2.1a"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">N</annotation></semantics></math>, join ratio <math id="alg1.3.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="alg1.3.m3.1a"><mi id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">r</annotation></semantics></math>, Learning rate <math id="alg1.4.m4.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.4.m4.1a"><mi id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><ci id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">\eta</annotation></semantics></math>, Total base layers <math id="alg1.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.5.m5.1a"><mi id="alg1.5.m5.1.1" xref="alg1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><ci id="alg1.5.m5.1.1.cmml" xref="alg1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">K</annotation></semantics></math>, Fine-tuning rounds <math id="alg1.6.m6.1" class="ltx_Math" alttext="F" display="inline"><semantics id="alg1.6.m6.1a"><mi id="alg1.6.m6.1.1" xref="alg1.6.m6.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="alg1.6.m6.1b"><ci id="alg1.6.m6.1.1.cmml" xref="alg1.6.m6.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m6.1c">F</annotation></semantics></math>, Scheduling Mode <math id="alg1.7.m7.1" class="ltx_Math" alttext="Mode" display="inline"><semantics id="alg1.7.m7.1a"><mrow id="alg1.7.m7.1.1" xref="alg1.7.m7.1.1.cmml"><mi id="alg1.7.m7.1.1.2" xref="alg1.7.m7.1.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="alg1.7.m7.1.1.1" xref="alg1.7.m7.1.1.1.cmml">​</mo><mi id="alg1.7.m7.1.1.3" xref="alg1.7.m7.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.7.m7.1.1.1a" xref="alg1.7.m7.1.1.1.cmml">​</mo><mi id="alg1.7.m7.1.1.4" xref="alg1.7.m7.1.1.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.7.m7.1.1.1b" xref="alg1.7.m7.1.1.1.cmml">​</mo><mi id="alg1.7.m7.1.1.5" xref="alg1.7.m7.1.1.5.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.7.m7.1b"><apply id="alg1.7.m7.1.1.cmml" xref="alg1.7.m7.1.1"><times id="alg1.7.m7.1.1.1.cmml" xref="alg1.7.m7.1.1.1"></times><ci id="alg1.7.m7.1.1.2.cmml" xref="alg1.7.m7.1.1.2">𝑀</ci><ci id="alg1.7.m7.1.1.3.cmml" xref="alg1.7.m7.1.1.3">𝑜</ci><ci id="alg1.7.m7.1.1.4.cmml" xref="alg1.7.m7.1.1.4">𝑑</ci><ci id="alg1.7.m7.1.1.5.cmml" xref="alg1.7.m7.1.1.5">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m7.1c">Mode</annotation></semantics></math>, Layer Unfreeze Rounds <math id="alg1.8.m8.4" class="ltx_Math" alttext="t_{1},t_{2},\ldots,t_{K}" display="inline"><semantics id="alg1.8.m8.4a"><mrow id="alg1.8.m8.4.4.3" xref="alg1.8.m8.4.4.4.cmml"><msub id="alg1.8.m8.2.2.1.1" xref="alg1.8.m8.2.2.1.1.cmml"><mi id="alg1.8.m8.2.2.1.1.2" xref="alg1.8.m8.2.2.1.1.2.cmml">t</mi><mn id="alg1.8.m8.2.2.1.1.3" xref="alg1.8.m8.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.8.m8.4.4.3.4" xref="alg1.8.m8.4.4.4.cmml">,</mo><msub id="alg1.8.m8.3.3.2.2" xref="alg1.8.m8.3.3.2.2.cmml"><mi id="alg1.8.m8.3.3.2.2.2" xref="alg1.8.m8.3.3.2.2.2.cmml">t</mi><mn id="alg1.8.m8.3.3.2.2.3" xref="alg1.8.m8.3.3.2.2.3.cmml">2</mn></msub><mo id="alg1.8.m8.4.4.3.5" xref="alg1.8.m8.4.4.4.cmml">,</mo><mi mathvariant="normal" id="alg1.8.m8.1.1" xref="alg1.8.m8.1.1.cmml">…</mi><mo id="alg1.8.m8.4.4.3.6" xref="alg1.8.m8.4.4.4.cmml">,</mo><msub id="alg1.8.m8.4.4.3.3" xref="alg1.8.m8.4.4.3.3.cmml"><mi id="alg1.8.m8.4.4.3.3.2" xref="alg1.8.m8.4.4.3.3.2.cmml">t</mi><mi id="alg1.8.m8.4.4.3.3.3" xref="alg1.8.m8.4.4.3.3.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.8.m8.4b"><list id="alg1.8.m8.4.4.4.cmml" xref="alg1.8.m8.4.4.3"><apply id="alg1.8.m8.2.2.1.1.cmml" xref="alg1.8.m8.2.2.1.1"><csymbol cd="ambiguous" id="alg1.8.m8.2.2.1.1.1.cmml" xref="alg1.8.m8.2.2.1.1">subscript</csymbol><ci id="alg1.8.m8.2.2.1.1.2.cmml" xref="alg1.8.m8.2.2.1.1.2">𝑡</ci><cn type="integer" id="alg1.8.m8.2.2.1.1.3.cmml" xref="alg1.8.m8.2.2.1.1.3">1</cn></apply><apply id="alg1.8.m8.3.3.2.2.cmml" xref="alg1.8.m8.3.3.2.2"><csymbol cd="ambiguous" id="alg1.8.m8.3.3.2.2.1.cmml" xref="alg1.8.m8.3.3.2.2">subscript</csymbol><ci id="alg1.8.m8.3.3.2.2.2.cmml" xref="alg1.8.m8.3.3.2.2.2">𝑡</ci><cn type="integer" id="alg1.8.m8.3.3.2.2.3.cmml" xref="alg1.8.m8.3.3.2.2.3">2</cn></apply><ci id="alg1.8.m8.1.1.cmml" xref="alg1.8.m8.1.1">…</ci><apply id="alg1.8.m8.4.4.3.3.cmml" xref="alg1.8.m8.4.4.3.3"><csymbol cd="ambiguous" id="alg1.8.m8.4.4.3.3.1.cmml" xref="alg1.8.m8.4.4.3.3">subscript</csymbol><ci id="alg1.8.m8.4.4.3.3.2.cmml" xref="alg1.8.m8.4.4.3.3.2">𝑡</ci><ci id="alg1.8.m8.4.4.3.3.3.cmml" xref="alg1.8.m8.4.4.3.3.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m8.4c">t_{1},t_{2},\ldots,t_{K}</annotation></semantics></math> 
<br class="ltx_break"><span id="alg1.10.2" class="ltx_text ltx_font_bold">Initialize</span>: Global base parameters <math id="alg1.9.m9.13" class="ltx_Math" alttext="\theta_{G,b_{1}}^{(0)},\theta_{G,b_{2}}^{(0)},\ldots,\theta_{G,b_{K}}^{(0)}" display="inline"><semantics id="alg1.9.m9.13a"><mrow id="alg1.9.m9.13.13.3" xref="alg1.9.m9.13.13.4.cmml"><msubsup id="alg1.9.m9.11.11.1.1" xref="alg1.9.m9.11.11.1.1.cmml"><mi id="alg1.9.m9.11.11.1.1.2.2" xref="alg1.9.m9.11.11.1.1.2.2.cmml">θ</mi><mrow id="alg1.9.m9.2.2.2.2" xref="alg1.9.m9.2.2.2.3.cmml"><mi id="alg1.9.m9.1.1.1.1" xref="alg1.9.m9.1.1.1.1.cmml">G</mi><mo id="alg1.9.m9.2.2.2.2.2" xref="alg1.9.m9.2.2.2.3.cmml">,</mo><msub id="alg1.9.m9.2.2.2.2.1" xref="alg1.9.m9.2.2.2.2.1.cmml"><mi id="alg1.9.m9.2.2.2.2.1.2" xref="alg1.9.m9.2.2.2.2.1.2.cmml">b</mi><mn id="alg1.9.m9.2.2.2.2.1.3" xref="alg1.9.m9.2.2.2.2.1.3.cmml">1</mn></msub></mrow><mrow id="alg1.9.m9.3.3.1.3" xref="alg1.9.m9.11.11.1.1.cmml"><mo stretchy="false" id="alg1.9.m9.3.3.1.3.1" xref="alg1.9.m9.11.11.1.1.cmml">(</mo><mn id="alg1.9.m9.3.3.1.1" xref="alg1.9.m9.3.3.1.1.cmml">0</mn><mo stretchy="false" id="alg1.9.m9.3.3.1.3.2" xref="alg1.9.m9.11.11.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.9.m9.13.13.3.4" xref="alg1.9.m9.13.13.4.cmml">,</mo><msubsup id="alg1.9.m9.12.12.2.2" xref="alg1.9.m9.12.12.2.2.cmml"><mi id="alg1.9.m9.12.12.2.2.2.2" xref="alg1.9.m9.12.12.2.2.2.2.cmml">θ</mi><mrow id="alg1.9.m9.5.5.2.2" xref="alg1.9.m9.5.5.2.3.cmml"><mi id="alg1.9.m9.4.4.1.1" xref="alg1.9.m9.4.4.1.1.cmml">G</mi><mo id="alg1.9.m9.5.5.2.2.2" xref="alg1.9.m9.5.5.2.3.cmml">,</mo><msub id="alg1.9.m9.5.5.2.2.1" xref="alg1.9.m9.5.5.2.2.1.cmml"><mi id="alg1.9.m9.5.5.2.2.1.2" xref="alg1.9.m9.5.5.2.2.1.2.cmml">b</mi><mn id="alg1.9.m9.5.5.2.2.1.3" xref="alg1.9.m9.5.5.2.2.1.3.cmml">2</mn></msub></mrow><mrow id="alg1.9.m9.6.6.1.3" xref="alg1.9.m9.12.12.2.2.cmml"><mo stretchy="false" id="alg1.9.m9.6.6.1.3.1" xref="alg1.9.m9.12.12.2.2.cmml">(</mo><mn id="alg1.9.m9.6.6.1.1" xref="alg1.9.m9.6.6.1.1.cmml">0</mn><mo stretchy="false" id="alg1.9.m9.6.6.1.3.2" xref="alg1.9.m9.12.12.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.9.m9.13.13.3.5" xref="alg1.9.m9.13.13.4.cmml">,</mo><mi mathvariant="normal" id="alg1.9.m9.10.10" xref="alg1.9.m9.10.10.cmml">…</mi><mo id="alg1.9.m9.13.13.3.6" xref="alg1.9.m9.13.13.4.cmml">,</mo><msubsup id="alg1.9.m9.13.13.3.3" xref="alg1.9.m9.13.13.3.3.cmml"><mi id="alg1.9.m9.13.13.3.3.2.2" xref="alg1.9.m9.13.13.3.3.2.2.cmml">θ</mi><mrow id="alg1.9.m9.8.8.2.2" xref="alg1.9.m9.8.8.2.3.cmml"><mi id="alg1.9.m9.7.7.1.1" xref="alg1.9.m9.7.7.1.1.cmml">G</mi><mo id="alg1.9.m9.8.8.2.2.2" xref="alg1.9.m9.8.8.2.3.cmml">,</mo><msub id="alg1.9.m9.8.8.2.2.1" xref="alg1.9.m9.8.8.2.2.1.cmml"><mi id="alg1.9.m9.8.8.2.2.1.2" xref="alg1.9.m9.8.8.2.2.1.2.cmml">b</mi><mi id="alg1.9.m9.8.8.2.2.1.3" xref="alg1.9.m9.8.8.2.2.1.3.cmml">K</mi></msub></mrow><mrow id="alg1.9.m9.9.9.1.3" xref="alg1.9.m9.13.13.3.3.cmml"><mo stretchy="false" id="alg1.9.m9.9.9.1.3.1" xref="alg1.9.m9.13.13.3.3.cmml">(</mo><mn id="alg1.9.m9.9.9.1.1" xref="alg1.9.m9.9.9.1.1.cmml">0</mn><mo stretchy="false" id="alg1.9.m9.9.9.1.3.2" xref="alg1.9.m9.13.13.3.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.m9.13b"><list id="alg1.9.m9.13.13.4.cmml" xref="alg1.9.m9.13.13.3"><apply id="alg1.9.m9.11.11.1.1.cmml" xref="alg1.9.m9.11.11.1.1"><csymbol cd="ambiguous" id="alg1.9.m9.11.11.1.1.1.cmml" xref="alg1.9.m9.11.11.1.1">superscript</csymbol><apply id="alg1.9.m9.11.11.1.1.2.cmml" xref="alg1.9.m9.11.11.1.1"><csymbol cd="ambiguous" id="alg1.9.m9.11.11.1.1.2.1.cmml" xref="alg1.9.m9.11.11.1.1">subscript</csymbol><ci id="alg1.9.m9.11.11.1.1.2.2.cmml" xref="alg1.9.m9.11.11.1.1.2.2">𝜃</ci><list id="alg1.9.m9.2.2.2.3.cmml" xref="alg1.9.m9.2.2.2.2"><ci id="alg1.9.m9.1.1.1.1.cmml" xref="alg1.9.m9.1.1.1.1">𝐺</ci><apply id="alg1.9.m9.2.2.2.2.1.cmml" xref="alg1.9.m9.2.2.2.2.1"><csymbol cd="ambiguous" id="alg1.9.m9.2.2.2.2.1.1.cmml" xref="alg1.9.m9.2.2.2.2.1">subscript</csymbol><ci id="alg1.9.m9.2.2.2.2.1.2.cmml" xref="alg1.9.m9.2.2.2.2.1.2">𝑏</ci><cn type="integer" id="alg1.9.m9.2.2.2.2.1.3.cmml" xref="alg1.9.m9.2.2.2.2.1.3">1</cn></apply></list></apply><cn type="integer" id="alg1.9.m9.3.3.1.1.cmml" xref="alg1.9.m9.3.3.1.1">0</cn></apply><apply id="alg1.9.m9.12.12.2.2.cmml" xref="alg1.9.m9.12.12.2.2"><csymbol cd="ambiguous" id="alg1.9.m9.12.12.2.2.1.cmml" xref="alg1.9.m9.12.12.2.2">superscript</csymbol><apply id="alg1.9.m9.12.12.2.2.2.cmml" xref="alg1.9.m9.12.12.2.2"><csymbol cd="ambiguous" id="alg1.9.m9.12.12.2.2.2.1.cmml" xref="alg1.9.m9.12.12.2.2">subscript</csymbol><ci id="alg1.9.m9.12.12.2.2.2.2.cmml" xref="alg1.9.m9.12.12.2.2.2.2">𝜃</ci><list id="alg1.9.m9.5.5.2.3.cmml" xref="alg1.9.m9.5.5.2.2"><ci id="alg1.9.m9.4.4.1.1.cmml" xref="alg1.9.m9.4.4.1.1">𝐺</ci><apply id="alg1.9.m9.5.5.2.2.1.cmml" xref="alg1.9.m9.5.5.2.2.1"><csymbol cd="ambiguous" id="alg1.9.m9.5.5.2.2.1.1.cmml" xref="alg1.9.m9.5.5.2.2.1">subscript</csymbol><ci id="alg1.9.m9.5.5.2.2.1.2.cmml" xref="alg1.9.m9.5.5.2.2.1.2">𝑏</ci><cn type="integer" id="alg1.9.m9.5.5.2.2.1.3.cmml" xref="alg1.9.m9.5.5.2.2.1.3">2</cn></apply></list></apply><cn type="integer" id="alg1.9.m9.6.6.1.1.cmml" xref="alg1.9.m9.6.6.1.1">0</cn></apply><ci id="alg1.9.m9.10.10.cmml" xref="alg1.9.m9.10.10">…</ci><apply id="alg1.9.m9.13.13.3.3.cmml" xref="alg1.9.m9.13.13.3.3"><csymbol cd="ambiguous" id="alg1.9.m9.13.13.3.3.1.cmml" xref="alg1.9.m9.13.13.3.3">superscript</csymbol><apply id="alg1.9.m9.13.13.3.3.2.cmml" xref="alg1.9.m9.13.13.3.3"><csymbol cd="ambiguous" id="alg1.9.m9.13.13.3.3.2.1.cmml" xref="alg1.9.m9.13.13.3.3">subscript</csymbol><ci id="alg1.9.m9.13.13.3.3.2.2.cmml" xref="alg1.9.m9.13.13.3.3.2.2">𝜃</ci><list id="alg1.9.m9.8.8.2.3.cmml" xref="alg1.9.m9.8.8.2.2"><ci id="alg1.9.m9.7.7.1.1.cmml" xref="alg1.9.m9.7.7.1.1">𝐺</ci><apply id="alg1.9.m9.8.8.2.2.1.cmml" xref="alg1.9.m9.8.8.2.2.1"><csymbol cd="ambiguous" id="alg1.9.m9.8.8.2.2.1.1.cmml" xref="alg1.9.m9.8.8.2.2.1">subscript</csymbol><ci id="alg1.9.m9.8.8.2.2.1.2.cmml" xref="alg1.9.m9.8.8.2.2.1.2">𝑏</ci><ci id="alg1.9.m9.8.8.2.2.1.3.cmml" xref="alg1.9.m9.8.8.2.2.1.3">𝐾</ci></apply></list></apply><cn type="integer" id="alg1.9.m9.9.9.1.1.cmml" xref="alg1.9.m9.9.9.1.1">0</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m9.13c">\theta_{G,b_{1}}^{(0)},\theta_{G,b_{2}}^{(0)},\ldots,\theta_{G,b_{K}}^{(0)}</annotation></semantics></math> and Global Head parameter <math id="alg1.10.m10.3" class="ltx_Math" alttext="\theta_{G,h}^{(0)}" display="inline"><semantics id="alg1.10.m10.3a"><msubsup id="alg1.10.m10.3.4" xref="alg1.10.m10.3.4.cmml"><mi id="alg1.10.m10.3.4.2.2" xref="alg1.10.m10.3.4.2.2.cmml">θ</mi><mrow id="alg1.10.m10.2.2.2.4" xref="alg1.10.m10.2.2.2.3.cmml"><mi id="alg1.10.m10.1.1.1.1" xref="alg1.10.m10.1.1.1.1.cmml">G</mi><mo id="alg1.10.m10.2.2.2.4.1" xref="alg1.10.m10.2.2.2.3.cmml">,</mo><mi id="alg1.10.m10.2.2.2.2" xref="alg1.10.m10.2.2.2.2.cmml">h</mi></mrow><mrow id="alg1.10.m10.3.3.1.3" xref="alg1.10.m10.3.4.cmml"><mo stretchy="false" id="alg1.10.m10.3.3.1.3.1" xref="alg1.10.m10.3.4.cmml">(</mo><mn id="alg1.10.m10.3.3.1.1" xref="alg1.10.m10.3.3.1.1.cmml">0</mn><mo stretchy="false" id="alg1.10.m10.3.3.1.3.2" xref="alg1.10.m10.3.4.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.10.m10.3b"><apply id="alg1.10.m10.3.4.cmml" xref="alg1.10.m10.3.4"><csymbol cd="ambiguous" id="alg1.10.m10.3.4.1.cmml" xref="alg1.10.m10.3.4">superscript</csymbol><apply id="alg1.10.m10.3.4.2.cmml" xref="alg1.10.m10.3.4"><csymbol cd="ambiguous" id="alg1.10.m10.3.4.2.1.cmml" xref="alg1.10.m10.3.4">subscript</csymbol><ci id="alg1.10.m10.3.4.2.2.cmml" xref="alg1.10.m10.3.4.2.2">𝜃</ci><list id="alg1.10.m10.2.2.2.3.cmml" xref="alg1.10.m10.2.2.2.4"><ci id="alg1.10.m10.1.1.1.1.cmml" xref="alg1.10.m10.1.1.1.1">𝐺</ci><ci id="alg1.10.m10.2.2.2.2.cmml" xref="alg1.10.m10.2.2.2.2">ℎ</ci></list></apply><cn type="integer" id="alg1.10.m10.3.3.1.1.cmml" xref="alg1.10.m10.3.3.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m10.3c">\theta_{G,h}^{(0)}</annotation></semantics></math> 
<br class="ltx_break"></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.13" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l1.m1.1" class="ltx_Math" alttext="t=1" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">t</mi><mo id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">=</mo><mn id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><eq id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1"></eq><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">t=1</annotation></semantics></math> <span id="alg1.l1.2" class="ltx_text ltx_font_bold">to</span> <math id="alg1.l1.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">T</annotation></semantics></math> <span id="alg1.l1.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>     Randomly select <math id="alg1.l2.m1.1" class="ltx_Math" alttext="M=\lfloor r\times N\rfloor" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">M</mi><mo id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">=</mo><mrow id="alg1.l2.m1.1.1.1.1" xref="alg1.l2.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l2.m1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.2.1.cmml">⌊</mo><mrow id="alg1.l2.m1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.cmml"><mi id="alg1.l2.m1.1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.1.2.cmml">r</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l2.m1.1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.1.cmml">×</mo><mi id="alg1.l2.m1.1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.1.3.cmml">N</mi></mrow><mo stretchy="false" id="alg1.l2.m1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.2.1.cmml">⌋</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><eq id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"></eq><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑀</ci><apply id="alg1.l2.m1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1"><floor id="alg1.l2.m1.1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.1.1.2"></floor><apply id="alg1.l2.m1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1"><times id="alg1.l2.m1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1.1"></times><ci id="alg1.l2.m1.1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.1.2">𝑟</ci><ci id="alg1.l2.m1.1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.1.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">M=\lfloor r\times N\rfloor</annotation></semantics></math> clients

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> Each selected client <math id="alg1.l3.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">i</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mn id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">i=1</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">to</span> <math id="alg1.l3.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">M</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>        <span id="alg1.l4.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l4.m1.1" class="ltx_Math" alttext="Mode=\text{'Vanilla'}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mrow id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1a" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.4" xref="alg1.l4.m1.1.1.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.1b" xref="alg1.l4.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.5" xref="alg1.l4.m1.1.1.2.5.cmml">e</mi></mrow><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mtext id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3a.cmml">’Vanilla’</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><times id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2.1"></times><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">𝑀</ci><ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">𝑜</ci><ci id="alg1.l4.m1.1.1.2.4.cmml" xref="alg1.l4.m1.1.1.2.4">𝑑</ci><ci id="alg1.l4.m1.1.1.2.5.cmml" xref="alg1.l4.m1.1.1.2.5">𝑒</ci></apply><ci id="alg1.l4.m1.1.1.3a.cmml" xref="alg1.l4.m1.1.1.3"><mtext id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">’Vanilla’</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">Mode=\text{'Vanilla'}</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>           <span id="alg1.l5.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l5.m1.1" class="ltx_Math" alttext="t\geq t_{k}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">t</mi><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">≥</mo><msub id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">t</mi><mi id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><geq id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></geq><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑡</ci><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">𝑡</ci><ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">t\geq t_{k}</annotation></semantics></math> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>              Unfreeze <math id="alg1.l6.m1.2" class="ltx_Math" alttext="\theta_{i,b_{k}}" display="inline"><semantics id="alg1.l6.m1.2a"><msub id="alg1.l6.m1.2.3" xref="alg1.l6.m1.2.3.cmml"><mi id="alg1.l6.m1.2.3.2" xref="alg1.l6.m1.2.3.2.cmml">θ</mi><mrow id="alg1.l6.m1.2.2.2.2" xref="alg1.l6.m1.2.2.2.3.cmml"><mi id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l6.m1.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l6.m1.2.2.2.2.1" xref="alg1.l6.m1.2.2.2.2.1.cmml"><mi id="alg1.l6.m1.2.2.2.2.1.2" xref="alg1.l6.m1.2.2.2.2.1.2.cmml">b</mi><mi id="alg1.l6.m1.2.2.2.2.1.3" xref="alg1.l6.m1.2.2.2.2.1.3.cmml">k</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.3.cmml" xref="alg1.l6.m1.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.3.1.cmml" xref="alg1.l6.m1.2.3">subscript</csymbol><ci id="alg1.l6.m1.2.3.2.cmml" xref="alg1.l6.m1.2.3.2">𝜃</ci><list id="alg1.l6.m1.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2"><ci id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1">𝑖</ci><apply id="alg1.l6.m1.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.1.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.2">𝑏</ci><ci id="alg1.l6.m1.2.2.2.2.1.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">\theta_{i,b_{k}}</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>           <span id="alg1.l7.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l7.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>           <math id="alg1.l8.m1.16" class="ltx_Math" alttext="\theta_{i}^{(t+1)}=\theta_{i}^{(t)}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},\theta_{i,b_{1}}^{(t)},\ldots,\theta_{i,b_{K}}^{(t)},\theta_{i,h}^{(0)})" display="inline"><semantics id="alg1.l8.m1.16a"><mrow id="alg1.l8.m1.16.16" xref="alg1.l8.m1.16.16.cmml"><msubsup id="alg1.l8.m1.16.16.6" xref="alg1.l8.m1.16.16.6.cmml"><mi id="alg1.l8.m1.16.16.6.2.2" xref="alg1.l8.m1.16.16.6.2.2.cmml">θ</mi><mi id="alg1.l8.m1.16.16.6.2.3" xref="alg1.l8.m1.16.16.6.2.3.cmml">i</mi><mrow id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l8.m1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.2.cmml">t</mi><mo id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.l8.m1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l8.m1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l8.m1.16.16.5" xref="alg1.l8.m1.16.16.5.cmml">=</mo><mrow id="alg1.l8.m1.16.16.4" xref="alg1.l8.m1.16.16.4.cmml"><msubsup id="alg1.l8.m1.16.16.4.6" xref="alg1.l8.m1.16.16.4.6.cmml"><mi id="alg1.l8.m1.16.16.4.6.2.2" xref="alg1.l8.m1.16.16.4.6.2.2.cmml">θ</mi><mi id="alg1.l8.m1.16.16.4.6.2.3" xref="alg1.l8.m1.16.16.4.6.2.3.cmml">i</mi><mrow id="alg1.l8.m1.2.2.1.3" xref="alg1.l8.m1.16.16.4.6.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.1.3.1" xref="alg1.l8.m1.16.16.4.6.cmml">(</mo><mi id="alg1.l8.m1.2.2.1.1" xref="alg1.l8.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l8.m1.2.2.1.3.2" xref="alg1.l8.m1.16.16.4.6.cmml">)</mo></mrow></msubsup><mo id="alg1.l8.m1.16.16.4.5" xref="alg1.l8.m1.16.16.4.5.cmml">−</mo><mrow id="alg1.l8.m1.16.16.4.4" xref="alg1.l8.m1.16.16.4.4.cmml"><mi id="alg1.l8.m1.16.16.4.4.6" xref="alg1.l8.m1.16.16.4.4.6.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l8.m1.16.16.4.4.5" xref="alg1.l8.m1.16.16.4.4.5.cmml">​</mo><mrow id="alg1.l8.m1.16.16.4.4.7" xref="alg1.l8.m1.16.16.4.4.7.cmml"><msub id="alg1.l8.m1.16.16.4.4.7.1" xref="alg1.l8.m1.16.16.4.4.7.1.cmml"><mo rspace="0.167em" id="alg1.l8.m1.16.16.4.4.7.1.2" xref="alg1.l8.m1.16.16.4.4.7.1.2.cmml">∇</mo><msub id="alg1.l8.m1.16.16.4.4.7.1.3" xref="alg1.l8.m1.16.16.4.4.7.1.3.cmml"><mi id="alg1.l8.m1.16.16.4.4.7.1.3.2" xref="alg1.l8.m1.16.16.4.4.7.1.3.2.cmml">θ</mi><mi id="alg1.l8.m1.16.16.4.4.7.1.3.3" xref="alg1.l8.m1.16.16.4.4.7.1.3.3.cmml">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.16.16.4.4.7.2" xref="alg1.l8.m1.16.16.4.4.7.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l8.m1.16.16.4.4.5a" xref="alg1.l8.m1.16.16.4.4.5.cmml">​</mo><mrow id="alg1.l8.m1.16.16.4.4.4.4" xref="alg1.l8.m1.16.16.4.4.4.5.cmml"><mo stretchy="false" id="alg1.l8.m1.16.16.4.4.4.4.5" xref="alg1.l8.m1.16.16.4.4.4.5.cmml">(</mo><msub id="alg1.l8.m1.13.13.1.1.1.1.1" xref="alg1.l8.m1.13.13.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.13.13.1.1.1.1.1.2" xref="alg1.l8.m1.13.13.1.1.1.1.1.2.cmml">D</mi><mi id="alg1.l8.m1.13.13.1.1.1.1.1.3" xref="alg1.l8.m1.13.13.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l8.m1.16.16.4.4.4.4.6" xref="alg1.l8.m1.16.16.4.4.4.5.cmml">,</mo><msubsup id="alg1.l8.m1.14.14.2.2.2.2.2" xref="alg1.l8.m1.14.14.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.14.14.2.2.2.2.2.2.2" xref="alg1.l8.m1.14.14.2.2.2.2.2.2.2.cmml">θ</mi><mrow id="alg1.l8.m1.4.4.2.2" xref="alg1.l8.m1.4.4.2.3.cmml"><mi id="alg1.l8.m1.3.3.1.1" xref="alg1.l8.m1.3.3.1.1.cmml">i</mi><mo id="alg1.l8.m1.4.4.2.2.2" xref="alg1.l8.m1.4.4.2.3.cmml">,</mo><msub id="alg1.l8.m1.4.4.2.2.1" xref="alg1.l8.m1.4.4.2.2.1.cmml"><mi id="alg1.l8.m1.4.4.2.2.1.2" xref="alg1.l8.m1.4.4.2.2.1.2.cmml">b</mi><mn id="alg1.l8.m1.4.4.2.2.1.3" xref="alg1.l8.m1.4.4.2.2.1.3.cmml">1</mn></msub></mrow><mrow id="alg1.l8.m1.5.5.1.3" xref="alg1.l8.m1.14.14.2.2.2.2.2.cmml"><mo stretchy="false" id="alg1.l8.m1.5.5.1.3.1" xref="alg1.l8.m1.14.14.2.2.2.2.2.cmml">(</mo><mi id="alg1.l8.m1.5.5.1.1" xref="alg1.l8.m1.5.5.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l8.m1.5.5.1.3.2" xref="alg1.l8.m1.14.14.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l8.m1.16.16.4.4.4.4.7" xref="alg1.l8.m1.16.16.4.4.4.5.cmml">,</mo><mi mathvariant="normal" id="alg1.l8.m1.12.12" xref="alg1.l8.m1.12.12.cmml">…</mi><mo id="alg1.l8.m1.16.16.4.4.4.4.8" xref="alg1.l8.m1.16.16.4.4.4.5.cmml">,</mo><msubsup id="alg1.l8.m1.15.15.3.3.3.3.3" xref="alg1.l8.m1.15.15.3.3.3.3.3.cmml"><mi id="alg1.l8.m1.15.15.3.3.3.3.3.2.2" xref="alg1.l8.m1.15.15.3.3.3.3.3.2.2.cmml">θ</mi><mrow id="alg1.l8.m1.7.7.2.2" xref="alg1.l8.m1.7.7.2.3.cmml"><mi id="alg1.l8.m1.6.6.1.1" xref="alg1.l8.m1.6.6.1.1.cmml">i</mi><mo id="alg1.l8.m1.7.7.2.2.2" xref="alg1.l8.m1.7.7.2.3.cmml">,</mo><msub id="alg1.l8.m1.7.7.2.2.1" xref="alg1.l8.m1.7.7.2.2.1.cmml"><mi id="alg1.l8.m1.7.7.2.2.1.2" xref="alg1.l8.m1.7.7.2.2.1.2.cmml">b</mi><mi id="alg1.l8.m1.7.7.2.2.1.3" xref="alg1.l8.m1.7.7.2.2.1.3.cmml">K</mi></msub></mrow><mrow id="alg1.l8.m1.8.8.1.3" xref="alg1.l8.m1.15.15.3.3.3.3.3.cmml"><mo stretchy="false" id="alg1.l8.m1.8.8.1.3.1" xref="alg1.l8.m1.15.15.3.3.3.3.3.cmml">(</mo><mi id="alg1.l8.m1.8.8.1.1" xref="alg1.l8.m1.8.8.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l8.m1.8.8.1.3.2" xref="alg1.l8.m1.15.15.3.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="alg1.l8.m1.16.16.4.4.4.4.9" xref="alg1.l8.m1.16.16.4.4.4.5.cmml">,</mo><msubsup id="alg1.l8.m1.16.16.4.4.4.4.4" xref="alg1.l8.m1.16.16.4.4.4.4.4.cmml"><mi id="alg1.l8.m1.16.16.4.4.4.4.4.2.2" xref="alg1.l8.m1.16.16.4.4.4.4.4.2.2.cmml">θ</mi><mrow id="alg1.l8.m1.10.10.2.4" xref="alg1.l8.m1.10.10.2.3.cmml"><mi id="alg1.l8.m1.9.9.1.1" xref="alg1.l8.m1.9.9.1.1.cmml">i</mi><mo id="alg1.l8.m1.10.10.2.4.1" xref="alg1.l8.m1.10.10.2.3.cmml">,</mo><mi id="alg1.l8.m1.10.10.2.2" xref="alg1.l8.m1.10.10.2.2.cmml">h</mi></mrow><mrow id="alg1.l8.m1.11.11.1.3" xref="alg1.l8.m1.16.16.4.4.4.4.4.cmml"><mo stretchy="false" id="alg1.l8.m1.11.11.1.3.1" xref="alg1.l8.m1.16.16.4.4.4.4.4.cmml">(</mo><mn id="alg1.l8.m1.11.11.1.1" xref="alg1.l8.m1.11.11.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l8.m1.11.11.1.3.2" xref="alg1.l8.m1.16.16.4.4.4.4.4.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.l8.m1.16.16.4.4.4.4.10" xref="alg1.l8.m1.16.16.4.4.4.5.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.16b"><apply id="alg1.l8.m1.16.16.cmml" xref="alg1.l8.m1.16.16"><eq id="alg1.l8.m1.16.16.5.cmml" xref="alg1.l8.m1.16.16.5"></eq><apply id="alg1.l8.m1.16.16.6.cmml" xref="alg1.l8.m1.16.16.6"><csymbol cd="ambiguous" id="alg1.l8.m1.16.16.6.1.cmml" xref="alg1.l8.m1.16.16.6">superscript</csymbol><apply id="alg1.l8.m1.16.16.6.2.cmml" xref="alg1.l8.m1.16.16.6"><csymbol cd="ambiguous" id="alg1.l8.m1.16.16.6.2.1.cmml" xref="alg1.l8.m1.16.16.6">subscript</csymbol><ci id="alg1.l8.m1.16.16.6.2.2.cmml" xref="alg1.l8.m1.16.16.6.2.2">𝜃</ci><ci id="alg1.l8.m1.16.16.6.2.3.cmml" xref="alg1.l8.m1.16.16.6.2.3">𝑖</ci></apply><apply id="alg1.l8.m1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1"><plus id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1"></plus><ci id="alg1.l8.m1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l8.m1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg1.l8.m1.16.16.4.cmml" xref="alg1.l8.m1.16.16.4"><minus id="alg1.l8.m1.16.16.4.5.cmml" xref="alg1.l8.m1.16.16.4.5"></minus><apply id="alg1.l8.m1.16.16.4.6.cmml" xref="alg1.l8.m1.16.16.4.6"><csymbol cd="ambiguous" id="alg1.l8.m1.16.16.4.6.1.cmml" xref="alg1.l8.m1.16.16.4.6">superscript</csymbol><apply id="alg1.l8.m1.16.16.4.6.2.cmml" xref="alg1.l8.m1.16.16.4.6"><csymbol cd="ambiguous" id="alg1.l8.m1.16.16.4.6.2.1.cmml" xref="alg1.l8.m1.16.16.4.6">subscript</csymbol><ci id="alg1.l8.m1.16.16.4.6.2.2.cmml" xref="alg1.l8.m1.16.16.4.6.2.2">𝜃</ci><ci id="alg1.l8.m1.16.16.4.6.2.3.cmml" xref="alg1.l8.m1.16.16.4.6.2.3">𝑖</ci></apply><ci id="alg1.l8.m1.2.2.1.1.cmml" xref="alg1.l8.m1.2.2.1.1">𝑡</ci></apply><apply id="alg1.l8.m1.16.16.4.4.cmml" xref="alg1.l8.m1.16.16.4.4"><times id="alg1.l8.m1.16.16.4.4.5.cmml" xref="alg1.l8.m1.16.16.4.4.5"></times><ci id="alg1.l8.m1.16.16.4.4.6.cmml" xref="alg1.l8.m1.16.16.4.4.6">𝜂</ci><apply id="alg1.l8.m1.16.16.4.4.7.cmml" xref="alg1.l8.m1.16.16.4.4.7"><apply id="alg1.l8.m1.16.16.4.4.7.1.cmml" xref="alg1.l8.m1.16.16.4.4.7.1"><csymbol cd="ambiguous" id="alg1.l8.m1.16.16.4.4.7.1.1.cmml" xref="alg1.l8.m1.16.16.4.4.7.1">subscript</csymbol><ci id="alg1.l8.m1.16.16.4.4.7.1.2.cmml" xref="alg1.l8.m1.16.16.4.4.7.1.2">∇</ci><apply id="alg1.l8.m1.16.16.4.4.7.1.3.cmml" xref="alg1.l8.m1.16.16.4.4.7.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.16.16.4.4.7.1.3.1.cmml" xref="alg1.l8.m1.16.16.4.4.7.1.3">subscript</csymbol><ci id="alg1.l8.m1.16.16.4.4.7.1.3.2.cmml" xref="alg1.l8.m1.16.16.4.4.7.1.3.2">𝜃</ci><ci id="alg1.l8.m1.16.16.4.4.7.1.3.3.cmml" xref="alg1.l8.m1.16.16.4.4.7.1.3.3">𝑖</ci></apply></apply><ci id="alg1.l8.m1.16.16.4.4.7.2.cmml" xref="alg1.l8.m1.16.16.4.4.7.2">ℒ</ci></apply><vector id="alg1.l8.m1.16.16.4.4.4.5.cmml" xref="alg1.l8.m1.16.16.4.4.4.4"><apply id="alg1.l8.m1.13.13.1.1.1.1.1.cmml" xref="alg1.l8.m1.13.13.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.13.13.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.13.13.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.13.13.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.13.13.1.1.1.1.1.2">𝐷</ci><ci id="alg1.l8.m1.13.13.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.13.13.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l8.m1.14.14.2.2.2.2.2.cmml" xref="alg1.l8.m1.14.14.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.14.14.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.14.14.2.2.2.2.2">superscript</csymbol><apply id="alg1.l8.m1.14.14.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.14.14.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.14.14.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.14.14.2.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.14.14.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.14.14.2.2.2.2.2.2.2">𝜃</ci><list id="alg1.l8.m1.4.4.2.3.cmml" xref="alg1.l8.m1.4.4.2.2"><ci id="alg1.l8.m1.3.3.1.1.cmml" xref="alg1.l8.m1.3.3.1.1">𝑖</ci><apply id="alg1.l8.m1.4.4.2.2.1.cmml" xref="alg1.l8.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.2.2.1.1.cmml" xref="alg1.l8.m1.4.4.2.2.1">subscript</csymbol><ci id="alg1.l8.m1.4.4.2.2.1.2.cmml" xref="alg1.l8.m1.4.4.2.2.1.2">𝑏</ci><cn type="integer" id="alg1.l8.m1.4.4.2.2.1.3.cmml" xref="alg1.l8.m1.4.4.2.2.1.3">1</cn></apply></list></apply><ci id="alg1.l8.m1.5.5.1.1.cmml" xref="alg1.l8.m1.5.5.1.1">𝑡</ci></apply><ci id="alg1.l8.m1.12.12.cmml" xref="alg1.l8.m1.12.12">…</ci><apply id="alg1.l8.m1.15.15.3.3.3.3.3.cmml" xref="alg1.l8.m1.15.15.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.15.15.3.3.3.3.3.1.cmml" xref="alg1.l8.m1.15.15.3.3.3.3.3">superscript</csymbol><apply id="alg1.l8.m1.15.15.3.3.3.3.3.2.cmml" xref="alg1.l8.m1.15.15.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.15.15.3.3.3.3.3.2.1.cmml" xref="alg1.l8.m1.15.15.3.3.3.3.3">subscript</csymbol><ci id="alg1.l8.m1.15.15.3.3.3.3.3.2.2.cmml" xref="alg1.l8.m1.15.15.3.3.3.3.3.2.2">𝜃</ci><list id="alg1.l8.m1.7.7.2.3.cmml" xref="alg1.l8.m1.7.7.2.2"><ci id="alg1.l8.m1.6.6.1.1.cmml" xref="alg1.l8.m1.6.6.1.1">𝑖</ci><apply id="alg1.l8.m1.7.7.2.2.1.cmml" xref="alg1.l8.m1.7.7.2.2.1"><csymbol cd="ambiguous" id="alg1.l8.m1.7.7.2.2.1.1.cmml" xref="alg1.l8.m1.7.7.2.2.1">subscript</csymbol><ci id="alg1.l8.m1.7.7.2.2.1.2.cmml" xref="alg1.l8.m1.7.7.2.2.1.2">𝑏</ci><ci id="alg1.l8.m1.7.7.2.2.1.3.cmml" xref="alg1.l8.m1.7.7.2.2.1.3">𝐾</ci></apply></list></apply><ci id="alg1.l8.m1.8.8.1.1.cmml" xref="alg1.l8.m1.8.8.1.1">𝑡</ci></apply><apply id="alg1.l8.m1.16.16.4.4.4.4.4.cmml" xref="alg1.l8.m1.16.16.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l8.m1.16.16.4.4.4.4.4.1.cmml" xref="alg1.l8.m1.16.16.4.4.4.4.4">superscript</csymbol><apply id="alg1.l8.m1.16.16.4.4.4.4.4.2.cmml" xref="alg1.l8.m1.16.16.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l8.m1.16.16.4.4.4.4.4.2.1.cmml" xref="alg1.l8.m1.16.16.4.4.4.4.4">subscript</csymbol><ci id="alg1.l8.m1.16.16.4.4.4.4.4.2.2.cmml" xref="alg1.l8.m1.16.16.4.4.4.4.4.2.2">𝜃</ci><list id="alg1.l8.m1.10.10.2.3.cmml" xref="alg1.l8.m1.10.10.2.4"><ci id="alg1.l8.m1.9.9.1.1.cmml" xref="alg1.l8.m1.9.9.1.1">𝑖</ci><ci id="alg1.l8.m1.10.10.2.2.cmml" xref="alg1.l8.m1.10.10.2.2">ℎ</ci></list></apply><cn type="integer" id="alg1.l8.m1.11.11.1.1.cmml" xref="alg1.l8.m1.11.11.1.1">0</cn></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.16c">\theta_{i}^{(t+1)}=\theta_{i}^{(t)}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},\theta_{i,b_{1}}^{(t)},\ldots,\theta_{i,b_{K}}^{(t)},\theta_{i,h}^{(0)})</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>        <span id="alg1.l9.1" class="ltx_text ltx_font_bold">else</span> <span id="alg1.l9.2" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l9.m1.1" class="ltx_Math" alttext="Mode=\text{'Anti'}" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.1" xref="alg1.l9.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.1a" xref="alg1.l9.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.4" xref="alg1.l9.m1.1.1.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.2.1b" xref="alg1.l9.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l9.m1.1.1.2.5" xref="alg1.l9.m1.1.1.2.5.cmml">e</mi></mrow><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">=</mo><mtext id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3a.cmml">’Anti’</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><eq id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></eq><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><times id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2.1"></times><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑀</ci><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝑜</ci><ci id="alg1.l9.m1.1.1.2.4.cmml" xref="alg1.l9.m1.1.1.2.4">𝑑</ci><ci id="alg1.l9.m1.1.1.2.5.cmml" xref="alg1.l9.m1.1.1.2.5">𝑒</ci></apply><ci id="alg1.l9.m1.1.1.3a.cmml" xref="alg1.l9.m1.1.1.3"><mtext id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">’Anti’</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">Mode=\text{'Anti'}</annotation></semantics></math> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>           <span id="alg1.l10.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l10.m1.1" class="ltx_Math" alttext="t\geq t_{k}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">t</mi><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">≥</mo><msub id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">t</mi><mi id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><geq id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></geq><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑡</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑡</ci><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">t\geq t_{k}</annotation></semantics></math> <span id="alg1.l10.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>              Unfreeze <math id="alg1.l11.m1.2" class="ltx_Math" alttext="\theta_{i,b_{K-k+1}}" display="inline"><semantics id="alg1.l11.m1.2a"><msub id="alg1.l11.m1.2.3" xref="alg1.l11.m1.2.3.cmml"><mi id="alg1.l11.m1.2.3.2" xref="alg1.l11.m1.2.3.2.cmml">θ</mi><mrow id="alg1.l11.m1.2.2.2.2" xref="alg1.l11.m1.2.2.2.3.cmml"><mi id="alg1.l11.m1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l11.m1.2.2.2.2.2" xref="alg1.l11.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l11.m1.2.2.2.2.1" xref="alg1.l11.m1.2.2.2.2.1.cmml"><mi id="alg1.l11.m1.2.2.2.2.1.2" xref="alg1.l11.m1.2.2.2.2.1.2.cmml">b</mi><mrow id="alg1.l11.m1.2.2.2.2.1.3" xref="alg1.l11.m1.2.2.2.2.1.3.cmml"><mrow id="alg1.l11.m1.2.2.2.2.1.3.2" xref="alg1.l11.m1.2.2.2.2.1.3.2.cmml"><mi id="alg1.l11.m1.2.2.2.2.1.3.2.2" xref="alg1.l11.m1.2.2.2.2.1.3.2.2.cmml">K</mi><mo id="alg1.l11.m1.2.2.2.2.1.3.2.1" xref="alg1.l11.m1.2.2.2.2.1.3.2.1.cmml">−</mo><mi id="alg1.l11.m1.2.2.2.2.1.3.2.3" xref="alg1.l11.m1.2.2.2.2.1.3.2.3.cmml">k</mi></mrow><mo id="alg1.l11.m1.2.2.2.2.1.3.1" xref="alg1.l11.m1.2.2.2.2.1.3.1.cmml">+</mo><mn id="alg1.l11.m1.2.2.2.2.1.3.3" xref="alg1.l11.m1.2.2.2.2.1.3.3.cmml">1</mn></mrow></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.2b"><apply id="alg1.l11.m1.2.3.cmml" xref="alg1.l11.m1.2.3"><csymbol cd="ambiguous" id="alg1.l11.m1.2.3.1.cmml" xref="alg1.l11.m1.2.3">subscript</csymbol><ci id="alg1.l11.m1.2.3.2.cmml" xref="alg1.l11.m1.2.3.2">𝜃</ci><list id="alg1.l11.m1.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.2"><ci id="alg1.l11.m1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1">𝑖</ci><apply id="alg1.l11.m1.2.2.2.2.1.cmml" xref="alg1.l11.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.1">subscript</csymbol><ci id="alg1.l11.m1.2.2.2.2.1.2.cmml" xref="alg1.l11.m1.2.2.2.2.1.2">𝑏</ci><apply id="alg1.l11.m1.2.2.2.2.1.3.cmml" xref="alg1.l11.m1.2.2.2.2.1.3"><plus id="alg1.l11.m1.2.2.2.2.1.3.1.cmml" xref="alg1.l11.m1.2.2.2.2.1.3.1"></plus><apply id="alg1.l11.m1.2.2.2.2.1.3.2.cmml" xref="alg1.l11.m1.2.2.2.2.1.3.2"><minus id="alg1.l11.m1.2.2.2.2.1.3.2.1.cmml" xref="alg1.l11.m1.2.2.2.2.1.3.2.1"></minus><ci id="alg1.l11.m1.2.2.2.2.1.3.2.2.cmml" xref="alg1.l11.m1.2.2.2.2.1.3.2.2">𝐾</ci><ci id="alg1.l11.m1.2.2.2.2.1.3.2.3.cmml" xref="alg1.l11.m1.2.2.2.2.1.3.2.3">𝑘</ci></apply><cn type="integer" id="alg1.l11.m1.2.2.2.2.1.3.3.cmml" xref="alg1.l11.m1.2.2.2.2.1.3.3">1</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.2c">\theta_{i,b_{K-k+1}}</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>           <span id="alg1.l12.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l12.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>           <math id="alg1.l13.m1.16" class="ltx_Math" alttext="\theta_{i}^{(t+1)}=\theta_{i}^{(t)}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},\theta_{i,b_{1}}^{(t)},\ldots,\theta_{i,b_{K}}^{(t)},\theta_{i,h}^{(0)})" display="inline"><semantics id="alg1.l13.m1.16a"><mrow id="alg1.l13.m1.16.16" xref="alg1.l13.m1.16.16.cmml"><msubsup id="alg1.l13.m1.16.16.6" xref="alg1.l13.m1.16.16.6.cmml"><mi id="alg1.l13.m1.16.16.6.2.2" xref="alg1.l13.m1.16.16.6.2.2.cmml">θ</mi><mi id="alg1.l13.m1.16.16.6.2.3" xref="alg1.l13.m1.16.16.6.2.3.cmml">i</mi><mrow id="alg1.l13.m1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l13.m1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l13.m1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.2.cmml">t</mi><mo id="alg1.l13.m1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.l13.m1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l13.m1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l13.m1.16.16.5" xref="alg1.l13.m1.16.16.5.cmml">=</mo><mrow id="alg1.l13.m1.16.16.4" xref="alg1.l13.m1.16.16.4.cmml"><msubsup id="alg1.l13.m1.16.16.4.6" xref="alg1.l13.m1.16.16.4.6.cmml"><mi id="alg1.l13.m1.16.16.4.6.2.2" xref="alg1.l13.m1.16.16.4.6.2.2.cmml">θ</mi><mi id="alg1.l13.m1.16.16.4.6.2.3" xref="alg1.l13.m1.16.16.4.6.2.3.cmml">i</mi><mrow id="alg1.l13.m1.2.2.1.3" xref="alg1.l13.m1.16.16.4.6.cmml"><mo stretchy="false" id="alg1.l13.m1.2.2.1.3.1" xref="alg1.l13.m1.16.16.4.6.cmml">(</mo><mi id="alg1.l13.m1.2.2.1.1" xref="alg1.l13.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l13.m1.2.2.1.3.2" xref="alg1.l13.m1.16.16.4.6.cmml">)</mo></mrow></msubsup><mo id="alg1.l13.m1.16.16.4.5" xref="alg1.l13.m1.16.16.4.5.cmml">−</mo><mrow id="alg1.l13.m1.16.16.4.4" xref="alg1.l13.m1.16.16.4.4.cmml"><mi id="alg1.l13.m1.16.16.4.4.6" xref="alg1.l13.m1.16.16.4.4.6.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l13.m1.16.16.4.4.5" xref="alg1.l13.m1.16.16.4.4.5.cmml">​</mo><mrow id="alg1.l13.m1.16.16.4.4.7" xref="alg1.l13.m1.16.16.4.4.7.cmml"><msub id="alg1.l13.m1.16.16.4.4.7.1" xref="alg1.l13.m1.16.16.4.4.7.1.cmml"><mo rspace="0.167em" id="alg1.l13.m1.16.16.4.4.7.1.2" xref="alg1.l13.m1.16.16.4.4.7.1.2.cmml">∇</mo><msub id="alg1.l13.m1.16.16.4.4.7.1.3" xref="alg1.l13.m1.16.16.4.4.7.1.3.cmml"><mi id="alg1.l13.m1.16.16.4.4.7.1.3.2" xref="alg1.l13.m1.16.16.4.4.7.1.3.2.cmml">θ</mi><mi id="alg1.l13.m1.16.16.4.4.7.1.3.3" xref="alg1.l13.m1.16.16.4.4.7.1.3.3.cmml">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.16.16.4.4.7.2" xref="alg1.l13.m1.16.16.4.4.7.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l13.m1.16.16.4.4.5a" xref="alg1.l13.m1.16.16.4.4.5.cmml">​</mo><mrow id="alg1.l13.m1.16.16.4.4.4.4" xref="alg1.l13.m1.16.16.4.4.4.5.cmml"><mo stretchy="false" id="alg1.l13.m1.16.16.4.4.4.4.5" xref="alg1.l13.m1.16.16.4.4.4.5.cmml">(</mo><msub id="alg1.l13.m1.13.13.1.1.1.1.1" xref="alg1.l13.m1.13.13.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.13.13.1.1.1.1.1.2" xref="alg1.l13.m1.13.13.1.1.1.1.1.2.cmml">D</mi><mi id="alg1.l13.m1.13.13.1.1.1.1.1.3" xref="alg1.l13.m1.13.13.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l13.m1.16.16.4.4.4.4.6" xref="alg1.l13.m1.16.16.4.4.4.5.cmml">,</mo><msubsup id="alg1.l13.m1.14.14.2.2.2.2.2" xref="alg1.l13.m1.14.14.2.2.2.2.2.cmml"><mi id="alg1.l13.m1.14.14.2.2.2.2.2.2.2" xref="alg1.l13.m1.14.14.2.2.2.2.2.2.2.cmml">θ</mi><mrow id="alg1.l13.m1.4.4.2.2" xref="alg1.l13.m1.4.4.2.3.cmml"><mi id="alg1.l13.m1.3.3.1.1" xref="alg1.l13.m1.3.3.1.1.cmml">i</mi><mo id="alg1.l13.m1.4.4.2.2.2" xref="alg1.l13.m1.4.4.2.3.cmml">,</mo><msub id="alg1.l13.m1.4.4.2.2.1" xref="alg1.l13.m1.4.4.2.2.1.cmml"><mi id="alg1.l13.m1.4.4.2.2.1.2" xref="alg1.l13.m1.4.4.2.2.1.2.cmml">b</mi><mn id="alg1.l13.m1.4.4.2.2.1.3" xref="alg1.l13.m1.4.4.2.2.1.3.cmml">1</mn></msub></mrow><mrow id="alg1.l13.m1.5.5.1.3" xref="alg1.l13.m1.14.14.2.2.2.2.2.cmml"><mo stretchy="false" id="alg1.l13.m1.5.5.1.3.1" xref="alg1.l13.m1.14.14.2.2.2.2.2.cmml">(</mo><mi id="alg1.l13.m1.5.5.1.1" xref="alg1.l13.m1.5.5.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l13.m1.5.5.1.3.2" xref="alg1.l13.m1.14.14.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l13.m1.16.16.4.4.4.4.7" xref="alg1.l13.m1.16.16.4.4.4.5.cmml">,</mo><mi mathvariant="normal" id="alg1.l13.m1.12.12" xref="alg1.l13.m1.12.12.cmml">…</mi><mo id="alg1.l13.m1.16.16.4.4.4.4.8" xref="alg1.l13.m1.16.16.4.4.4.5.cmml">,</mo><msubsup id="alg1.l13.m1.15.15.3.3.3.3.3" xref="alg1.l13.m1.15.15.3.3.3.3.3.cmml"><mi id="alg1.l13.m1.15.15.3.3.3.3.3.2.2" xref="alg1.l13.m1.15.15.3.3.3.3.3.2.2.cmml">θ</mi><mrow id="alg1.l13.m1.7.7.2.2" xref="alg1.l13.m1.7.7.2.3.cmml"><mi id="alg1.l13.m1.6.6.1.1" xref="alg1.l13.m1.6.6.1.1.cmml">i</mi><mo id="alg1.l13.m1.7.7.2.2.2" xref="alg1.l13.m1.7.7.2.3.cmml">,</mo><msub id="alg1.l13.m1.7.7.2.2.1" xref="alg1.l13.m1.7.7.2.2.1.cmml"><mi id="alg1.l13.m1.7.7.2.2.1.2" xref="alg1.l13.m1.7.7.2.2.1.2.cmml">b</mi><mi id="alg1.l13.m1.7.7.2.2.1.3" xref="alg1.l13.m1.7.7.2.2.1.3.cmml">K</mi></msub></mrow><mrow id="alg1.l13.m1.8.8.1.3" xref="alg1.l13.m1.15.15.3.3.3.3.3.cmml"><mo stretchy="false" id="alg1.l13.m1.8.8.1.3.1" xref="alg1.l13.m1.15.15.3.3.3.3.3.cmml">(</mo><mi id="alg1.l13.m1.8.8.1.1" xref="alg1.l13.m1.8.8.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l13.m1.8.8.1.3.2" xref="alg1.l13.m1.15.15.3.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="alg1.l13.m1.16.16.4.4.4.4.9" xref="alg1.l13.m1.16.16.4.4.4.5.cmml">,</mo><msubsup id="alg1.l13.m1.16.16.4.4.4.4.4" xref="alg1.l13.m1.16.16.4.4.4.4.4.cmml"><mi id="alg1.l13.m1.16.16.4.4.4.4.4.2.2" xref="alg1.l13.m1.16.16.4.4.4.4.4.2.2.cmml">θ</mi><mrow id="alg1.l13.m1.10.10.2.4" xref="alg1.l13.m1.10.10.2.3.cmml"><mi id="alg1.l13.m1.9.9.1.1" xref="alg1.l13.m1.9.9.1.1.cmml">i</mi><mo id="alg1.l13.m1.10.10.2.4.1" xref="alg1.l13.m1.10.10.2.3.cmml">,</mo><mi id="alg1.l13.m1.10.10.2.2" xref="alg1.l13.m1.10.10.2.2.cmml">h</mi></mrow><mrow id="alg1.l13.m1.11.11.1.3" xref="alg1.l13.m1.16.16.4.4.4.4.4.cmml"><mo stretchy="false" id="alg1.l13.m1.11.11.1.3.1" xref="alg1.l13.m1.16.16.4.4.4.4.4.cmml">(</mo><mn id="alg1.l13.m1.11.11.1.1" xref="alg1.l13.m1.11.11.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l13.m1.11.11.1.3.2" xref="alg1.l13.m1.16.16.4.4.4.4.4.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.l13.m1.16.16.4.4.4.4.10" xref="alg1.l13.m1.16.16.4.4.4.5.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.16b"><apply id="alg1.l13.m1.16.16.cmml" xref="alg1.l13.m1.16.16"><eq id="alg1.l13.m1.16.16.5.cmml" xref="alg1.l13.m1.16.16.5"></eq><apply id="alg1.l13.m1.16.16.6.cmml" xref="alg1.l13.m1.16.16.6"><csymbol cd="ambiguous" id="alg1.l13.m1.16.16.6.1.cmml" xref="alg1.l13.m1.16.16.6">superscript</csymbol><apply id="alg1.l13.m1.16.16.6.2.cmml" xref="alg1.l13.m1.16.16.6"><csymbol cd="ambiguous" id="alg1.l13.m1.16.16.6.2.1.cmml" xref="alg1.l13.m1.16.16.6">subscript</csymbol><ci id="alg1.l13.m1.16.16.6.2.2.cmml" xref="alg1.l13.m1.16.16.6.2.2">𝜃</ci><ci id="alg1.l13.m1.16.16.6.2.3.cmml" xref="alg1.l13.m1.16.16.6.2.3">𝑖</ci></apply><apply id="alg1.l13.m1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1"><plus id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1"></plus><ci id="alg1.l13.m1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l13.m1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg1.l13.m1.16.16.4.cmml" xref="alg1.l13.m1.16.16.4"><minus id="alg1.l13.m1.16.16.4.5.cmml" xref="alg1.l13.m1.16.16.4.5"></minus><apply id="alg1.l13.m1.16.16.4.6.cmml" xref="alg1.l13.m1.16.16.4.6"><csymbol cd="ambiguous" id="alg1.l13.m1.16.16.4.6.1.cmml" xref="alg1.l13.m1.16.16.4.6">superscript</csymbol><apply id="alg1.l13.m1.16.16.4.6.2.cmml" xref="alg1.l13.m1.16.16.4.6"><csymbol cd="ambiguous" id="alg1.l13.m1.16.16.4.6.2.1.cmml" xref="alg1.l13.m1.16.16.4.6">subscript</csymbol><ci id="alg1.l13.m1.16.16.4.6.2.2.cmml" xref="alg1.l13.m1.16.16.4.6.2.2">𝜃</ci><ci id="alg1.l13.m1.16.16.4.6.2.3.cmml" xref="alg1.l13.m1.16.16.4.6.2.3">𝑖</ci></apply><ci id="alg1.l13.m1.2.2.1.1.cmml" xref="alg1.l13.m1.2.2.1.1">𝑡</ci></apply><apply id="alg1.l13.m1.16.16.4.4.cmml" xref="alg1.l13.m1.16.16.4.4"><times id="alg1.l13.m1.16.16.4.4.5.cmml" xref="alg1.l13.m1.16.16.4.4.5"></times><ci id="alg1.l13.m1.16.16.4.4.6.cmml" xref="alg1.l13.m1.16.16.4.4.6">𝜂</ci><apply id="alg1.l13.m1.16.16.4.4.7.cmml" xref="alg1.l13.m1.16.16.4.4.7"><apply id="alg1.l13.m1.16.16.4.4.7.1.cmml" xref="alg1.l13.m1.16.16.4.4.7.1"><csymbol cd="ambiguous" id="alg1.l13.m1.16.16.4.4.7.1.1.cmml" xref="alg1.l13.m1.16.16.4.4.7.1">subscript</csymbol><ci id="alg1.l13.m1.16.16.4.4.7.1.2.cmml" xref="alg1.l13.m1.16.16.4.4.7.1.2">∇</ci><apply id="alg1.l13.m1.16.16.4.4.7.1.3.cmml" xref="alg1.l13.m1.16.16.4.4.7.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.16.16.4.4.7.1.3.1.cmml" xref="alg1.l13.m1.16.16.4.4.7.1.3">subscript</csymbol><ci id="alg1.l13.m1.16.16.4.4.7.1.3.2.cmml" xref="alg1.l13.m1.16.16.4.4.7.1.3.2">𝜃</ci><ci id="alg1.l13.m1.16.16.4.4.7.1.3.3.cmml" xref="alg1.l13.m1.16.16.4.4.7.1.3.3">𝑖</ci></apply></apply><ci id="alg1.l13.m1.16.16.4.4.7.2.cmml" xref="alg1.l13.m1.16.16.4.4.7.2">ℒ</ci></apply><vector id="alg1.l13.m1.16.16.4.4.4.5.cmml" xref="alg1.l13.m1.16.16.4.4.4.4"><apply id="alg1.l13.m1.13.13.1.1.1.1.1.cmml" xref="alg1.l13.m1.13.13.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.13.13.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.13.13.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.13.13.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.13.13.1.1.1.1.1.2">𝐷</ci><ci id="alg1.l13.m1.13.13.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.13.13.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l13.m1.14.14.2.2.2.2.2.cmml" xref="alg1.l13.m1.14.14.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.14.14.2.2.2.2.2.1.cmml" xref="alg1.l13.m1.14.14.2.2.2.2.2">superscript</csymbol><apply id="alg1.l13.m1.14.14.2.2.2.2.2.2.cmml" xref="alg1.l13.m1.14.14.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.14.14.2.2.2.2.2.2.1.cmml" xref="alg1.l13.m1.14.14.2.2.2.2.2">subscript</csymbol><ci id="alg1.l13.m1.14.14.2.2.2.2.2.2.2.cmml" xref="alg1.l13.m1.14.14.2.2.2.2.2.2.2">𝜃</ci><list id="alg1.l13.m1.4.4.2.3.cmml" xref="alg1.l13.m1.4.4.2.2"><ci id="alg1.l13.m1.3.3.1.1.cmml" xref="alg1.l13.m1.3.3.1.1">𝑖</ci><apply id="alg1.l13.m1.4.4.2.2.1.cmml" xref="alg1.l13.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="alg1.l13.m1.4.4.2.2.1.1.cmml" xref="alg1.l13.m1.4.4.2.2.1">subscript</csymbol><ci id="alg1.l13.m1.4.4.2.2.1.2.cmml" xref="alg1.l13.m1.4.4.2.2.1.2">𝑏</ci><cn type="integer" id="alg1.l13.m1.4.4.2.2.1.3.cmml" xref="alg1.l13.m1.4.4.2.2.1.3">1</cn></apply></list></apply><ci id="alg1.l13.m1.5.5.1.1.cmml" xref="alg1.l13.m1.5.5.1.1">𝑡</ci></apply><ci id="alg1.l13.m1.12.12.cmml" xref="alg1.l13.m1.12.12">…</ci><apply id="alg1.l13.m1.15.15.3.3.3.3.3.cmml" xref="alg1.l13.m1.15.15.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l13.m1.15.15.3.3.3.3.3.1.cmml" xref="alg1.l13.m1.15.15.3.3.3.3.3">superscript</csymbol><apply id="alg1.l13.m1.15.15.3.3.3.3.3.2.cmml" xref="alg1.l13.m1.15.15.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l13.m1.15.15.3.3.3.3.3.2.1.cmml" xref="alg1.l13.m1.15.15.3.3.3.3.3">subscript</csymbol><ci id="alg1.l13.m1.15.15.3.3.3.3.3.2.2.cmml" xref="alg1.l13.m1.15.15.3.3.3.3.3.2.2">𝜃</ci><list id="alg1.l13.m1.7.7.2.3.cmml" xref="alg1.l13.m1.7.7.2.2"><ci id="alg1.l13.m1.6.6.1.1.cmml" xref="alg1.l13.m1.6.6.1.1">𝑖</ci><apply id="alg1.l13.m1.7.7.2.2.1.cmml" xref="alg1.l13.m1.7.7.2.2.1"><csymbol cd="ambiguous" id="alg1.l13.m1.7.7.2.2.1.1.cmml" xref="alg1.l13.m1.7.7.2.2.1">subscript</csymbol><ci id="alg1.l13.m1.7.7.2.2.1.2.cmml" xref="alg1.l13.m1.7.7.2.2.1.2">𝑏</ci><ci id="alg1.l13.m1.7.7.2.2.1.3.cmml" xref="alg1.l13.m1.7.7.2.2.1.3">𝐾</ci></apply></list></apply><ci id="alg1.l13.m1.8.8.1.1.cmml" xref="alg1.l13.m1.8.8.1.1">𝑡</ci></apply><apply id="alg1.l13.m1.16.16.4.4.4.4.4.cmml" xref="alg1.l13.m1.16.16.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l13.m1.16.16.4.4.4.4.4.1.cmml" xref="alg1.l13.m1.16.16.4.4.4.4.4">superscript</csymbol><apply id="alg1.l13.m1.16.16.4.4.4.4.4.2.cmml" xref="alg1.l13.m1.16.16.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l13.m1.16.16.4.4.4.4.4.2.1.cmml" xref="alg1.l13.m1.16.16.4.4.4.4.4">subscript</csymbol><ci id="alg1.l13.m1.16.16.4.4.4.4.4.2.2.cmml" xref="alg1.l13.m1.16.16.4.4.4.4.4.2.2">𝜃</ci><list id="alg1.l13.m1.10.10.2.3.cmml" xref="alg1.l13.m1.10.10.2.4"><ci id="alg1.l13.m1.9.9.1.1.cmml" xref="alg1.l13.m1.9.9.1.1">𝑖</ci><ci id="alg1.l13.m1.10.10.2.2.cmml" xref="alg1.l13.m1.10.10.2.2">ℎ</ci></list></apply><cn type="integer" id="alg1.l13.m1.11.11.1.1.cmml" xref="alg1.l13.m1.11.11.1.1">0</cn></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.16c">\theta_{i}^{(t+1)}=\theta_{i}^{(t)}-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},\theta_{i,b_{1}}^{(t)},\ldots,\theta_{i,b_{K}}^{(t)},\theta_{i,h}^{(0)})</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>        <span id="alg1.l14.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l14.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>        Keep <math id="alg1.l15.m1.2" class="ltx_Math" alttext="\theta_{i,h}" display="inline"><semantics id="alg1.l15.m1.2a"><msub id="alg1.l15.m1.2.3" xref="alg1.l15.m1.2.3.cmml"><mi id="alg1.l15.m1.2.3.2" xref="alg1.l15.m1.2.3.2.cmml">θ</mi><mrow id="alg1.l15.m1.2.2.2.4" xref="alg1.l15.m1.2.2.2.3.cmml"><mi id="alg1.l15.m1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l15.m1.2.2.2.4.1" xref="alg1.l15.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l15.m1.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.2b"><apply id="alg1.l15.m1.2.3.cmml" xref="alg1.l15.m1.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.2.3.1.cmml" xref="alg1.l15.m1.2.3">subscript</csymbol><ci id="alg1.l15.m1.2.3.2.cmml" xref="alg1.l15.m1.2.3.2">𝜃</ci><list id="alg1.l15.m1.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.4"><ci id="alg1.l15.m1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1">𝑖</ci><ci id="alg1.l15.m1.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2">ℎ</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.2c">\theta_{i,h}</annotation></semantics></math> frozen

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>        Send updated base parameters <math id="alg1.l16.m1.9" class="ltx_Math" alttext="\theta_{i,b_{1}}^{(t+1)},\ldots,\theta_{i,b_{K}}^{(t+1)}" display="inline"><semantics id="alg1.l16.m1.9a"><mrow id="alg1.l16.m1.9.9.2" xref="alg1.l16.m1.9.9.3.cmml"><msubsup id="alg1.l16.m1.8.8.1.1" xref="alg1.l16.m1.8.8.1.1.cmml"><mi id="alg1.l16.m1.8.8.1.1.2.2" xref="alg1.l16.m1.8.8.1.1.2.2.cmml">θ</mi><mrow id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.3.cmml"><mi id="alg1.l16.m1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l16.m1.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l16.m1.2.2.2.2.1" xref="alg1.l16.m1.2.2.2.2.1.cmml"><mi id="alg1.l16.m1.2.2.2.2.1.2" xref="alg1.l16.m1.2.2.2.2.1.2.cmml">b</mi><mn id="alg1.l16.m1.2.2.2.2.1.3" xref="alg1.l16.m1.2.2.2.2.1.3.cmml">1</mn></msub></mrow><mrow id="alg1.l16.m1.3.3.1.1" xref="alg1.l16.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="alg1.l16.m1.3.3.1.1.2" xref="alg1.l16.m1.3.3.1.1.1.cmml">(</mo><mrow id="alg1.l16.m1.3.3.1.1.1" xref="alg1.l16.m1.3.3.1.1.1.cmml"><mi id="alg1.l16.m1.3.3.1.1.1.2" xref="alg1.l16.m1.3.3.1.1.1.2.cmml">t</mi><mo id="alg1.l16.m1.3.3.1.1.1.1" xref="alg1.l16.m1.3.3.1.1.1.1.cmml">+</mo><mn id="alg1.l16.m1.3.3.1.1.1.3" xref="alg1.l16.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l16.m1.3.3.1.1.3" xref="alg1.l16.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l16.m1.9.9.2.3" xref="alg1.l16.m1.9.9.3.cmml">,</mo><mi mathvariant="normal" id="alg1.l16.m1.7.7" xref="alg1.l16.m1.7.7.cmml">…</mi><mo id="alg1.l16.m1.9.9.2.4" xref="alg1.l16.m1.9.9.3.cmml">,</mo><msubsup id="alg1.l16.m1.9.9.2.2" xref="alg1.l16.m1.9.9.2.2.cmml"><mi id="alg1.l16.m1.9.9.2.2.2.2" xref="alg1.l16.m1.9.9.2.2.2.2.cmml">θ</mi><mrow id="alg1.l16.m1.5.5.2.2" xref="alg1.l16.m1.5.5.2.3.cmml"><mi id="alg1.l16.m1.4.4.1.1" xref="alg1.l16.m1.4.4.1.1.cmml">i</mi><mo id="alg1.l16.m1.5.5.2.2.2" xref="alg1.l16.m1.5.5.2.3.cmml">,</mo><msub id="alg1.l16.m1.5.5.2.2.1" xref="alg1.l16.m1.5.5.2.2.1.cmml"><mi id="alg1.l16.m1.5.5.2.2.1.2" xref="alg1.l16.m1.5.5.2.2.1.2.cmml">b</mi><mi id="alg1.l16.m1.5.5.2.2.1.3" xref="alg1.l16.m1.5.5.2.2.1.3.cmml">K</mi></msub></mrow><mrow id="alg1.l16.m1.6.6.1.1" xref="alg1.l16.m1.6.6.1.1.1.cmml"><mo stretchy="false" id="alg1.l16.m1.6.6.1.1.2" xref="alg1.l16.m1.6.6.1.1.1.cmml">(</mo><mrow id="alg1.l16.m1.6.6.1.1.1" xref="alg1.l16.m1.6.6.1.1.1.cmml"><mi id="alg1.l16.m1.6.6.1.1.1.2" xref="alg1.l16.m1.6.6.1.1.1.2.cmml">t</mi><mo id="alg1.l16.m1.6.6.1.1.1.1" xref="alg1.l16.m1.6.6.1.1.1.1.cmml">+</mo><mn id="alg1.l16.m1.6.6.1.1.1.3" xref="alg1.l16.m1.6.6.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l16.m1.6.6.1.1.3" xref="alg1.l16.m1.6.6.1.1.1.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.9b"><list id="alg1.l16.m1.9.9.3.cmml" xref="alg1.l16.m1.9.9.2"><apply id="alg1.l16.m1.8.8.1.1.cmml" xref="alg1.l16.m1.8.8.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.8.8.1.1.1.cmml" xref="alg1.l16.m1.8.8.1.1">superscript</csymbol><apply id="alg1.l16.m1.8.8.1.1.2.cmml" xref="alg1.l16.m1.8.8.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.8.8.1.1.2.1.cmml" xref="alg1.l16.m1.8.8.1.1">subscript</csymbol><ci id="alg1.l16.m1.8.8.1.1.2.2.cmml" xref="alg1.l16.m1.8.8.1.1.2.2">𝜃</ci><list id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2"><ci id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1">𝑖</ci><apply id="alg1.l16.m1.2.2.2.2.1.cmml" xref="alg1.l16.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.2.1.1.cmml" xref="alg1.l16.m1.2.2.2.2.1">subscript</csymbol><ci id="alg1.l16.m1.2.2.2.2.1.2.cmml" xref="alg1.l16.m1.2.2.2.2.1.2">𝑏</ci><cn type="integer" id="alg1.l16.m1.2.2.2.2.1.3.cmml" xref="alg1.l16.m1.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="alg1.l16.m1.3.3.1.1.1.cmml" xref="alg1.l16.m1.3.3.1.1"><plus id="alg1.l16.m1.3.3.1.1.1.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1"></plus><ci id="alg1.l16.m1.3.3.1.1.1.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l16.m1.3.3.1.1.1.3.cmml" xref="alg1.l16.m1.3.3.1.1.1.3">1</cn></apply></apply><ci id="alg1.l16.m1.7.7.cmml" xref="alg1.l16.m1.7.7">…</ci><apply id="alg1.l16.m1.9.9.2.2.cmml" xref="alg1.l16.m1.9.9.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.9.9.2.2.1.cmml" xref="alg1.l16.m1.9.9.2.2">superscript</csymbol><apply id="alg1.l16.m1.9.9.2.2.2.cmml" xref="alg1.l16.m1.9.9.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.9.9.2.2.2.1.cmml" xref="alg1.l16.m1.9.9.2.2">subscript</csymbol><ci id="alg1.l16.m1.9.9.2.2.2.2.cmml" xref="alg1.l16.m1.9.9.2.2.2.2">𝜃</ci><list id="alg1.l16.m1.5.5.2.3.cmml" xref="alg1.l16.m1.5.5.2.2"><ci id="alg1.l16.m1.4.4.1.1.cmml" xref="alg1.l16.m1.4.4.1.1">𝑖</ci><apply id="alg1.l16.m1.5.5.2.2.1.cmml" xref="alg1.l16.m1.5.5.2.2.1"><csymbol cd="ambiguous" id="alg1.l16.m1.5.5.2.2.1.1.cmml" xref="alg1.l16.m1.5.5.2.2.1">subscript</csymbol><ci id="alg1.l16.m1.5.5.2.2.1.2.cmml" xref="alg1.l16.m1.5.5.2.2.1.2">𝑏</ci><ci id="alg1.l16.m1.5.5.2.2.1.3.cmml" xref="alg1.l16.m1.5.5.2.2.1.3">𝐾</ci></apply></list></apply><apply id="alg1.l16.m1.6.6.1.1.1.cmml" xref="alg1.l16.m1.6.6.1.1"><plus id="alg1.l16.m1.6.6.1.1.1.1.cmml" xref="alg1.l16.m1.6.6.1.1.1.1"></plus><ci id="alg1.l16.m1.6.6.1.1.1.2.cmml" xref="alg1.l16.m1.6.6.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l16.m1.6.6.1.1.1.3.cmml" xref="alg1.l16.m1.6.6.1.1.1.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.9c">\theta_{i,b_{1}}^{(t+1)},\ldots,\theta_{i,b_{K}}^{(t+1)}</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>     <span id="alg1.l17.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l17.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>     Aggregate global model <math id="alg1.l18.m1.6" class="ltx_Math" alttext="\theta_{G}^{(t+1)}=\sum_{i=1}^{N}\frac{|D_{i}|}{|D|}\theta_{i,b}^{(t+1)}" display="inline"><semantics id="alg1.l18.m1.6a"><mrow id="alg1.l18.m1.6.7" xref="alg1.l18.m1.6.7.cmml"><msubsup id="alg1.l18.m1.6.7.2" xref="alg1.l18.m1.6.7.2.cmml"><mi id="alg1.l18.m1.6.7.2.2.2" xref="alg1.l18.m1.6.7.2.2.2.cmml">θ</mi><mi id="alg1.l18.m1.6.7.2.2.3" xref="alg1.l18.m1.6.7.2.2.3.cmml">G</mi><mrow id="alg1.l18.m1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l18.m1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l18.m1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.2.cmml">t</mi><mo id="alg1.l18.m1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.l18.m1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l18.m1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo rspace="0.111em" id="alg1.l18.m1.6.7.1" xref="alg1.l18.m1.6.7.1.cmml">=</mo><mrow id="alg1.l18.m1.6.7.3" xref="alg1.l18.m1.6.7.3.cmml"><msubsup id="alg1.l18.m1.6.7.3.1" xref="alg1.l18.m1.6.7.3.1.cmml"><mo id="alg1.l18.m1.6.7.3.1.2.2" xref="alg1.l18.m1.6.7.3.1.2.2.cmml">∑</mo><mrow id="alg1.l18.m1.6.7.3.1.2.3" xref="alg1.l18.m1.6.7.3.1.2.3.cmml"><mi id="alg1.l18.m1.6.7.3.1.2.3.2" xref="alg1.l18.m1.6.7.3.1.2.3.2.cmml">i</mi><mo id="alg1.l18.m1.6.7.3.1.2.3.1" xref="alg1.l18.m1.6.7.3.1.2.3.1.cmml">=</mo><mn id="alg1.l18.m1.6.7.3.1.2.3.3" xref="alg1.l18.m1.6.7.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l18.m1.6.7.3.1.3" xref="alg1.l18.m1.6.7.3.1.3.cmml">N</mi></msubsup><mrow id="alg1.l18.m1.6.7.3.2" xref="alg1.l18.m1.6.7.3.2.cmml"><mfrac id="alg1.l18.m1.3.3" xref="alg1.l18.m1.3.3.cmml"><mrow id="alg1.l18.m1.2.2.1.1" xref="alg1.l18.m1.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l18.m1.2.2.1.1.2" xref="alg1.l18.m1.2.2.1.2.1.cmml">|</mo><msub id="alg1.l18.m1.2.2.1.1.1" xref="alg1.l18.m1.2.2.1.1.1.cmml"><mi id="alg1.l18.m1.2.2.1.1.1.2" xref="alg1.l18.m1.2.2.1.1.1.2.cmml">D</mi><mi id="alg1.l18.m1.2.2.1.1.1.3" xref="alg1.l18.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l18.m1.2.2.1.1.3" xref="alg1.l18.m1.2.2.1.2.1.cmml">|</mo></mrow><mrow id="alg1.l18.m1.3.3.2.3" xref="alg1.l18.m1.3.3.2.2.cmml"><mo stretchy="false" id="alg1.l18.m1.3.3.2.3.1" xref="alg1.l18.m1.3.3.2.2.1.cmml">|</mo><mi id="alg1.l18.m1.3.3.2.1" xref="alg1.l18.m1.3.3.2.1.cmml">D</mi><mo stretchy="false" id="alg1.l18.m1.3.3.2.3.2" xref="alg1.l18.m1.3.3.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l18.m1.6.7.3.2.1" xref="alg1.l18.m1.6.7.3.2.1.cmml">​</mo><msubsup id="alg1.l18.m1.6.7.3.2.2" xref="alg1.l18.m1.6.7.3.2.2.cmml"><mi id="alg1.l18.m1.6.7.3.2.2.2.2" xref="alg1.l18.m1.6.7.3.2.2.2.2.cmml">θ</mi><mrow id="alg1.l18.m1.5.5.2.4" xref="alg1.l18.m1.5.5.2.3.cmml"><mi id="alg1.l18.m1.4.4.1.1" xref="alg1.l18.m1.4.4.1.1.cmml">i</mi><mo id="alg1.l18.m1.5.5.2.4.1" xref="alg1.l18.m1.5.5.2.3.cmml">,</mo><mi id="alg1.l18.m1.5.5.2.2" xref="alg1.l18.m1.5.5.2.2.cmml">b</mi></mrow><mrow id="alg1.l18.m1.6.6.1.1" xref="alg1.l18.m1.6.6.1.1.1.cmml"><mo stretchy="false" id="alg1.l18.m1.6.6.1.1.2" xref="alg1.l18.m1.6.6.1.1.1.cmml">(</mo><mrow id="alg1.l18.m1.6.6.1.1.1" xref="alg1.l18.m1.6.6.1.1.1.cmml"><mi id="alg1.l18.m1.6.6.1.1.1.2" xref="alg1.l18.m1.6.6.1.1.1.2.cmml">t</mi><mo id="alg1.l18.m1.6.6.1.1.1.1" xref="alg1.l18.m1.6.6.1.1.1.1.cmml">+</mo><mn id="alg1.l18.m1.6.6.1.1.1.3" xref="alg1.l18.m1.6.6.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l18.m1.6.6.1.1.3" xref="alg1.l18.m1.6.6.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.6b"><apply id="alg1.l18.m1.6.7.cmml" xref="alg1.l18.m1.6.7"><eq id="alg1.l18.m1.6.7.1.cmml" xref="alg1.l18.m1.6.7.1"></eq><apply id="alg1.l18.m1.6.7.2.cmml" xref="alg1.l18.m1.6.7.2"><csymbol cd="ambiguous" id="alg1.l18.m1.6.7.2.1.cmml" xref="alg1.l18.m1.6.7.2">superscript</csymbol><apply id="alg1.l18.m1.6.7.2.2.cmml" xref="alg1.l18.m1.6.7.2"><csymbol cd="ambiguous" id="alg1.l18.m1.6.7.2.2.1.cmml" xref="alg1.l18.m1.6.7.2">subscript</csymbol><ci id="alg1.l18.m1.6.7.2.2.2.cmml" xref="alg1.l18.m1.6.7.2.2.2">𝜃</ci><ci id="alg1.l18.m1.6.7.2.2.3.cmml" xref="alg1.l18.m1.6.7.2.2.3">𝐺</ci></apply><apply id="alg1.l18.m1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1"><plus id="alg1.l18.m1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1"></plus><ci id="alg1.l18.m1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l18.m1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg1.l18.m1.6.7.3.cmml" xref="alg1.l18.m1.6.7.3"><apply id="alg1.l18.m1.6.7.3.1.cmml" xref="alg1.l18.m1.6.7.3.1"><csymbol cd="ambiguous" id="alg1.l18.m1.6.7.3.1.1.cmml" xref="alg1.l18.m1.6.7.3.1">superscript</csymbol><apply id="alg1.l18.m1.6.7.3.1.2.cmml" xref="alg1.l18.m1.6.7.3.1"><csymbol cd="ambiguous" id="alg1.l18.m1.6.7.3.1.2.1.cmml" xref="alg1.l18.m1.6.7.3.1">subscript</csymbol><sum id="alg1.l18.m1.6.7.3.1.2.2.cmml" xref="alg1.l18.m1.6.7.3.1.2.2"></sum><apply id="alg1.l18.m1.6.7.3.1.2.3.cmml" xref="alg1.l18.m1.6.7.3.1.2.3"><eq id="alg1.l18.m1.6.7.3.1.2.3.1.cmml" xref="alg1.l18.m1.6.7.3.1.2.3.1"></eq><ci id="alg1.l18.m1.6.7.3.1.2.3.2.cmml" xref="alg1.l18.m1.6.7.3.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.l18.m1.6.7.3.1.2.3.3.cmml" xref="alg1.l18.m1.6.7.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l18.m1.6.7.3.1.3.cmml" xref="alg1.l18.m1.6.7.3.1.3">𝑁</ci></apply><apply id="alg1.l18.m1.6.7.3.2.cmml" xref="alg1.l18.m1.6.7.3.2"><times id="alg1.l18.m1.6.7.3.2.1.cmml" xref="alg1.l18.m1.6.7.3.2.1"></times><apply id="alg1.l18.m1.3.3.cmml" xref="alg1.l18.m1.3.3"><divide id="alg1.l18.m1.3.3.3.cmml" xref="alg1.l18.m1.3.3"></divide><apply id="alg1.l18.m1.2.2.1.2.cmml" xref="alg1.l18.m1.2.2.1.1"><abs id="alg1.l18.m1.2.2.1.2.1.cmml" xref="alg1.l18.m1.2.2.1.1.2"></abs><apply id="alg1.l18.m1.2.2.1.1.1.cmml" xref="alg1.l18.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.1.1.1.1.cmml" xref="alg1.l18.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.l18.m1.2.2.1.1.1.2.cmml" xref="alg1.l18.m1.2.2.1.1.1.2">𝐷</ci><ci id="alg1.l18.m1.2.2.1.1.1.3.cmml" xref="alg1.l18.m1.2.2.1.1.1.3">𝑖</ci></apply></apply><apply id="alg1.l18.m1.3.3.2.2.cmml" xref="alg1.l18.m1.3.3.2.3"><abs id="alg1.l18.m1.3.3.2.2.1.cmml" xref="alg1.l18.m1.3.3.2.3.1"></abs><ci id="alg1.l18.m1.3.3.2.1.cmml" xref="alg1.l18.m1.3.3.2.1">𝐷</ci></apply></apply><apply id="alg1.l18.m1.6.7.3.2.2.cmml" xref="alg1.l18.m1.6.7.3.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.6.7.3.2.2.1.cmml" xref="alg1.l18.m1.6.7.3.2.2">superscript</csymbol><apply id="alg1.l18.m1.6.7.3.2.2.2.cmml" xref="alg1.l18.m1.6.7.3.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.6.7.3.2.2.2.1.cmml" xref="alg1.l18.m1.6.7.3.2.2">subscript</csymbol><ci id="alg1.l18.m1.6.7.3.2.2.2.2.cmml" xref="alg1.l18.m1.6.7.3.2.2.2.2">𝜃</ci><list id="alg1.l18.m1.5.5.2.3.cmml" xref="alg1.l18.m1.5.5.2.4"><ci id="alg1.l18.m1.4.4.1.1.cmml" xref="alg1.l18.m1.4.4.1.1">𝑖</ci><ci id="alg1.l18.m1.5.5.2.2.cmml" xref="alg1.l18.m1.5.5.2.2">𝑏</ci></list></apply><apply id="alg1.l18.m1.6.6.1.1.1.cmml" xref="alg1.l18.m1.6.6.1.1"><plus id="alg1.l18.m1.6.6.1.1.1.1.cmml" xref="alg1.l18.m1.6.6.1.1.1.1"></plus><ci id="alg1.l18.m1.6.6.1.1.1.2.cmml" xref="alg1.l18.m1.6.6.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l18.m1.6.6.1.1.1.3.cmml" xref="alg1.l18.m1.6.6.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.6c">\theta_{G}^{(t+1)}=\sum_{i=1}^{N}\frac{|D_{i}|}{|D|}\theta_{i,b}^{(t+1)}</annotation></semantics></math>

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>  <span id="alg1.l19.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>  <span id="alg1.l20.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l20.m1.1" class="ltx_Math" alttext="f=1" display="inline"><semantics id="alg1.l20.m1.1a"><mrow id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><mi id="alg1.l20.m1.1.1.2" xref="alg1.l20.m1.1.1.2.cmml">f</mi><mo id="alg1.l20.m1.1.1.1" xref="alg1.l20.m1.1.1.1.cmml">=</mo><mn id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><eq id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1"></eq><ci id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2">𝑓</ci><cn type="integer" id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">f=1</annotation></semantics></math> <span id="alg1.l20.2" class="ltx_text ltx_font_bold">to</span> <math id="alg1.l20.m2.1" class="ltx_Math" alttext="F" display="inline"><semantics id="alg1.l20.m2.1a"><mi id="alg1.l20.m2.1.1" xref="alg1.l20.m2.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="alg1.l20.m2.1b"><ci id="alg1.l20.m2.1.1.cmml" xref="alg1.l20.m2.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m2.1c">F</annotation></semantics></math> <span id="alg1.l20.3" class="ltx_text ltx_font_bold">do</span>

 
</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span>     Unfreeze all layers for each client

</div>
<div id="alg1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22:</span>     <span id="alg1.l22.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l22.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="alg1.l22.m1.1a"><mrow id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><mi id="alg1.l22.m1.1.1.2" xref="alg1.l22.m1.1.1.2.cmml">i</mi><mo id="alg1.l22.m1.1.1.1" xref="alg1.l22.m1.1.1.1.cmml">=</mo><mn id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><eq id="alg1.l22.m1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1"></eq><ci id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">i=1</annotation></semantics></math> <span id="alg1.l22.2" class="ltx_text ltx_font_bold">to</span> <math id="alg1.l22.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l22.m2.1a"><mi id="alg1.l22.m2.1.1" xref="alg1.l22.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l22.m2.1b"><ci id="alg1.l22.m2.1.1.cmml" xref="alg1.l22.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m2.1c">N</annotation></semantics></math> <span id="alg1.l22.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23:</span>        Update all parameters <math id="alg1.l23.m1.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg1.l23.m1.1a"><msub id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml"><mi id="alg1.l23.m1.1.1.2" xref="alg1.l23.m1.1.1.2.cmml">θ</mi><mi id="alg1.l23.m1.1.1.3" xref="alg1.l23.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><apply id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.1.cmml" xref="alg1.l23.m1.1.1">subscript</csymbol><ci id="alg1.l23.m1.1.1.2.cmml" xref="alg1.l23.m1.1.1.2">𝜃</ci><ci id="alg1.l23.m1.1.1.3.cmml" xref="alg1.l23.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">\theta_{i}</annotation></semantics></math> for fine tuning

</div>
<div id="alg1.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24:</span>        <math id="alg1.l24.m1.14" class="ltx_Math" alttext="\theta_{i}^{(T+f)}=\theta_{i}^{(T+f-1)}\qquad\qquad\qquad-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},\theta_{i,b_{1}}^{(T+f-1)},\ldots,\theta_{i,b_{K}}^{(T+f-1)},\theta_{i,h}^{(T+f-1)})" display="inline"><semantics id="alg1.l24.m1.14a"><mrow id="alg1.l24.m1.14.14" xref="alg1.l24.m1.14.14.cmml"><msubsup id="alg1.l24.m1.14.14.4" xref="alg1.l24.m1.14.14.4.cmml"><mi id="alg1.l24.m1.14.14.4.2.2" xref="alg1.l24.m1.14.14.4.2.2.cmml">θ</mi><mi id="alg1.l24.m1.14.14.4.2.3" xref="alg1.l24.m1.14.14.4.2.3.cmml">i</mi><mrow id="alg1.l24.m1.1.1.1.1" xref="alg1.l24.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l24.m1.1.1.1.1.2" xref="alg1.l24.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l24.m1.1.1.1.1.1" xref="alg1.l24.m1.1.1.1.1.1.cmml"><mi id="alg1.l24.m1.1.1.1.1.1.2" xref="alg1.l24.m1.1.1.1.1.1.2.cmml">T</mi><mo id="alg1.l24.m1.1.1.1.1.1.1" xref="alg1.l24.m1.1.1.1.1.1.1.cmml">+</mo><mi id="alg1.l24.m1.1.1.1.1.1.3" xref="alg1.l24.m1.1.1.1.1.1.3.cmml">f</mi></mrow><mo stretchy="false" id="alg1.l24.m1.1.1.1.1.3" xref="alg1.l24.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l24.m1.14.14.3" xref="alg1.l24.m1.14.14.3.cmml">=</mo><mrow id="alg1.l24.m1.14.14.2.2" xref="alg1.l24.m1.14.14.2.3.cmml"><msubsup id="alg1.l24.m1.13.13.1.1.1" xref="alg1.l24.m1.13.13.1.1.1.cmml"><mi id="alg1.l24.m1.13.13.1.1.1.2.2" xref="alg1.l24.m1.13.13.1.1.1.2.2.cmml">θ</mi><mi id="alg1.l24.m1.13.13.1.1.1.2.3" xref="alg1.l24.m1.13.13.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l24.m1.2.2.1.1" xref="alg1.l24.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l24.m1.2.2.1.1.2" xref="alg1.l24.m1.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l24.m1.2.2.1.1.1" xref="alg1.l24.m1.2.2.1.1.1.cmml"><mrow id="alg1.l24.m1.2.2.1.1.1.2" xref="alg1.l24.m1.2.2.1.1.1.2.cmml"><mi id="alg1.l24.m1.2.2.1.1.1.2.2" xref="alg1.l24.m1.2.2.1.1.1.2.2.cmml">T</mi><mo id="alg1.l24.m1.2.2.1.1.1.2.1" xref="alg1.l24.m1.2.2.1.1.1.2.1.cmml">+</mo><mi id="alg1.l24.m1.2.2.1.1.1.2.3" xref="alg1.l24.m1.2.2.1.1.1.2.3.cmml">f</mi></mrow><mo id="alg1.l24.m1.2.2.1.1.1.1" xref="alg1.l24.m1.2.2.1.1.1.1.cmml">−</mo><mn id="alg1.l24.m1.2.2.1.1.1.3" xref="alg1.l24.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l24.m1.2.2.1.1.3" xref="alg1.l24.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mspace width="6em" id="alg1.l24.m1.14.14.2.2.3" xref="alg1.l24.m1.14.14.2.3.cmml"></mspace><mrow id="alg1.l24.m1.14.14.2.2.2" xref="alg1.l24.m1.14.14.2.2.2.cmml"><mo id="alg1.l24.m1.14.14.2.2.2a" xref="alg1.l24.m1.14.14.2.2.2.cmml">−</mo><mrow id="alg1.l24.m1.14.14.2.2.2.4" xref="alg1.l24.m1.14.14.2.2.2.4.cmml"><mi id="alg1.l24.m1.14.14.2.2.2.4.6" xref="alg1.l24.m1.14.14.2.2.2.4.6.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l24.m1.14.14.2.2.2.4.5" xref="alg1.l24.m1.14.14.2.2.2.4.5.cmml">​</mo><mrow id="alg1.l24.m1.14.14.2.2.2.4.7" xref="alg1.l24.m1.14.14.2.2.2.4.7.cmml"><msub id="alg1.l24.m1.14.14.2.2.2.4.7.1" xref="alg1.l24.m1.14.14.2.2.2.4.7.1.cmml"><mo rspace="0.167em" id="alg1.l24.m1.14.14.2.2.2.4.7.1.2" xref="alg1.l24.m1.14.14.2.2.2.4.7.1.2.cmml">∇</mo><msub id="alg1.l24.m1.14.14.2.2.2.4.7.1.3" xref="alg1.l24.m1.14.14.2.2.2.4.7.1.3.cmml"><mi id="alg1.l24.m1.14.14.2.2.2.4.7.1.3.2" xref="alg1.l24.m1.14.14.2.2.2.4.7.1.3.2.cmml">θ</mi><mi id="alg1.l24.m1.14.14.2.2.2.4.7.1.3.3" xref="alg1.l24.m1.14.14.2.2.2.4.7.1.3.3.cmml">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="alg1.l24.m1.14.14.2.2.2.4.7.2" xref="alg1.l24.m1.14.14.2.2.2.4.7.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l24.m1.14.14.2.2.2.4.5a" xref="alg1.l24.m1.14.14.2.2.2.4.5.cmml">​</mo><mrow id="alg1.l24.m1.14.14.2.2.2.4.4.4" xref="alg1.l24.m1.14.14.2.2.2.4.4.5.cmml"><mo stretchy="false" id="alg1.l24.m1.14.14.2.2.2.4.4.4.5" xref="alg1.l24.m1.14.14.2.2.2.4.4.5.cmml">(</mo><msub id="alg1.l24.m1.14.14.2.2.2.1.1.1.1" xref="alg1.l24.m1.14.14.2.2.2.1.1.1.1.cmml"><mi id="alg1.l24.m1.14.14.2.2.2.1.1.1.1.2" xref="alg1.l24.m1.14.14.2.2.2.1.1.1.1.2.cmml">D</mi><mi id="alg1.l24.m1.14.14.2.2.2.1.1.1.1.3" xref="alg1.l24.m1.14.14.2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l24.m1.14.14.2.2.2.4.4.4.6" xref="alg1.l24.m1.14.14.2.2.2.4.4.5.cmml">,</mo><msubsup id="alg1.l24.m1.14.14.2.2.2.2.2.2.2" xref="alg1.l24.m1.14.14.2.2.2.2.2.2.2.cmml"><mi id="alg1.l24.m1.14.14.2.2.2.2.2.2.2.2.2" xref="alg1.l24.m1.14.14.2.2.2.2.2.2.2.2.2.cmml">θ</mi><mrow id="alg1.l24.m1.4.4.2.2" xref="alg1.l24.m1.4.4.2.3.cmml"><mi id="alg1.l24.m1.3.3.1.1" xref="alg1.l24.m1.3.3.1.1.cmml">i</mi><mo id="alg1.l24.m1.4.4.2.2.2" xref="alg1.l24.m1.4.4.2.3.cmml">,</mo><msub id="alg1.l24.m1.4.4.2.2.1" xref="alg1.l24.m1.4.4.2.2.1.cmml"><mi id="alg1.l24.m1.4.4.2.2.1.2" xref="alg1.l24.m1.4.4.2.2.1.2.cmml">b</mi><mn id="alg1.l24.m1.4.4.2.2.1.3" xref="alg1.l24.m1.4.4.2.2.1.3.cmml">1</mn></msub></mrow><mrow id="alg1.l24.m1.5.5.1.1" xref="alg1.l24.m1.5.5.1.1.1.cmml"><mo stretchy="false" id="alg1.l24.m1.5.5.1.1.2" xref="alg1.l24.m1.5.5.1.1.1.cmml">(</mo><mrow id="alg1.l24.m1.5.5.1.1.1" xref="alg1.l24.m1.5.5.1.1.1.cmml"><mrow id="alg1.l24.m1.5.5.1.1.1.2" xref="alg1.l24.m1.5.5.1.1.1.2.cmml"><mi id="alg1.l24.m1.5.5.1.1.1.2.2" xref="alg1.l24.m1.5.5.1.1.1.2.2.cmml">T</mi><mo id="alg1.l24.m1.5.5.1.1.1.2.1" xref="alg1.l24.m1.5.5.1.1.1.2.1.cmml">+</mo><mi id="alg1.l24.m1.5.5.1.1.1.2.3" xref="alg1.l24.m1.5.5.1.1.1.2.3.cmml">f</mi></mrow><mo id="alg1.l24.m1.5.5.1.1.1.1" xref="alg1.l24.m1.5.5.1.1.1.1.cmml">−</mo><mn id="alg1.l24.m1.5.5.1.1.1.3" xref="alg1.l24.m1.5.5.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l24.m1.5.5.1.1.3" xref="alg1.l24.m1.5.5.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l24.m1.14.14.2.2.2.4.4.4.7" xref="alg1.l24.m1.14.14.2.2.2.4.4.5.cmml">,</mo><mi mathvariant="normal" id="alg1.l24.m1.12.12" xref="alg1.l24.m1.12.12.cmml">…</mi><mo id="alg1.l24.m1.14.14.2.2.2.4.4.4.8" xref="alg1.l24.m1.14.14.2.2.2.4.4.5.cmml">,</mo><msubsup id="alg1.l24.m1.14.14.2.2.2.3.3.3.3" xref="alg1.l24.m1.14.14.2.2.2.3.3.3.3.cmml"><mi id="alg1.l24.m1.14.14.2.2.2.3.3.3.3.2.2" xref="alg1.l24.m1.14.14.2.2.2.3.3.3.3.2.2.cmml">θ</mi><mrow id="alg1.l24.m1.7.7.2.2" xref="alg1.l24.m1.7.7.2.3.cmml"><mi id="alg1.l24.m1.6.6.1.1" xref="alg1.l24.m1.6.6.1.1.cmml">i</mi><mo id="alg1.l24.m1.7.7.2.2.2" xref="alg1.l24.m1.7.7.2.3.cmml">,</mo><msub id="alg1.l24.m1.7.7.2.2.1" xref="alg1.l24.m1.7.7.2.2.1.cmml"><mi id="alg1.l24.m1.7.7.2.2.1.2" xref="alg1.l24.m1.7.7.2.2.1.2.cmml">b</mi><mi id="alg1.l24.m1.7.7.2.2.1.3" xref="alg1.l24.m1.7.7.2.2.1.3.cmml">K</mi></msub></mrow><mrow id="alg1.l24.m1.8.8.1.1" xref="alg1.l24.m1.8.8.1.1.1.cmml"><mo stretchy="false" id="alg1.l24.m1.8.8.1.1.2" xref="alg1.l24.m1.8.8.1.1.1.cmml">(</mo><mrow id="alg1.l24.m1.8.8.1.1.1" xref="alg1.l24.m1.8.8.1.1.1.cmml"><mrow id="alg1.l24.m1.8.8.1.1.1.2" xref="alg1.l24.m1.8.8.1.1.1.2.cmml"><mi id="alg1.l24.m1.8.8.1.1.1.2.2" xref="alg1.l24.m1.8.8.1.1.1.2.2.cmml">T</mi><mo id="alg1.l24.m1.8.8.1.1.1.2.1" xref="alg1.l24.m1.8.8.1.1.1.2.1.cmml">+</mo><mi id="alg1.l24.m1.8.8.1.1.1.2.3" xref="alg1.l24.m1.8.8.1.1.1.2.3.cmml">f</mi></mrow><mo id="alg1.l24.m1.8.8.1.1.1.1" xref="alg1.l24.m1.8.8.1.1.1.1.cmml">−</mo><mn id="alg1.l24.m1.8.8.1.1.1.3" xref="alg1.l24.m1.8.8.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l24.m1.8.8.1.1.3" xref="alg1.l24.m1.8.8.1.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l24.m1.14.14.2.2.2.4.4.4.9" xref="alg1.l24.m1.14.14.2.2.2.4.4.5.cmml">,</mo><msubsup id="alg1.l24.m1.14.14.2.2.2.4.4.4.4" xref="alg1.l24.m1.14.14.2.2.2.4.4.4.4.cmml"><mi id="alg1.l24.m1.14.14.2.2.2.4.4.4.4.2.2" xref="alg1.l24.m1.14.14.2.2.2.4.4.4.4.2.2.cmml">θ</mi><mrow id="alg1.l24.m1.10.10.2.4" xref="alg1.l24.m1.10.10.2.3.cmml"><mi id="alg1.l24.m1.9.9.1.1" xref="alg1.l24.m1.9.9.1.1.cmml">i</mi><mo id="alg1.l24.m1.10.10.2.4.1" xref="alg1.l24.m1.10.10.2.3.cmml">,</mo><mi id="alg1.l24.m1.10.10.2.2" xref="alg1.l24.m1.10.10.2.2.cmml">h</mi></mrow><mrow id="alg1.l24.m1.11.11.1.1" xref="alg1.l24.m1.11.11.1.1.1.cmml"><mo stretchy="false" id="alg1.l24.m1.11.11.1.1.2" xref="alg1.l24.m1.11.11.1.1.1.cmml">(</mo><mrow id="alg1.l24.m1.11.11.1.1.1" xref="alg1.l24.m1.11.11.1.1.1.cmml"><mrow id="alg1.l24.m1.11.11.1.1.1.2" xref="alg1.l24.m1.11.11.1.1.1.2.cmml"><mi id="alg1.l24.m1.11.11.1.1.1.2.2" xref="alg1.l24.m1.11.11.1.1.1.2.2.cmml">T</mi><mo id="alg1.l24.m1.11.11.1.1.1.2.1" xref="alg1.l24.m1.11.11.1.1.1.2.1.cmml">+</mo><mi id="alg1.l24.m1.11.11.1.1.1.2.3" xref="alg1.l24.m1.11.11.1.1.1.2.3.cmml">f</mi></mrow><mo id="alg1.l24.m1.11.11.1.1.1.1" xref="alg1.l24.m1.11.11.1.1.1.1.cmml">−</mo><mn id="alg1.l24.m1.11.11.1.1.1.3" xref="alg1.l24.m1.11.11.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l24.m1.11.11.1.1.3" xref="alg1.l24.m1.11.11.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.l24.m1.14.14.2.2.2.4.4.4.10" xref="alg1.l24.m1.14.14.2.2.2.4.4.5.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.14b"><apply id="alg1.l24.m1.14.14.cmml" xref="alg1.l24.m1.14.14"><eq id="alg1.l24.m1.14.14.3.cmml" xref="alg1.l24.m1.14.14.3"></eq><apply id="alg1.l24.m1.14.14.4.cmml" xref="alg1.l24.m1.14.14.4"><csymbol cd="ambiguous" id="alg1.l24.m1.14.14.4.1.cmml" xref="alg1.l24.m1.14.14.4">superscript</csymbol><apply id="alg1.l24.m1.14.14.4.2.cmml" xref="alg1.l24.m1.14.14.4"><csymbol cd="ambiguous" id="alg1.l24.m1.14.14.4.2.1.cmml" xref="alg1.l24.m1.14.14.4">subscript</csymbol><ci id="alg1.l24.m1.14.14.4.2.2.cmml" xref="alg1.l24.m1.14.14.4.2.2">𝜃</ci><ci id="alg1.l24.m1.14.14.4.2.3.cmml" xref="alg1.l24.m1.14.14.4.2.3">𝑖</ci></apply><apply id="alg1.l24.m1.1.1.1.1.1.cmml" xref="alg1.l24.m1.1.1.1.1"><plus id="alg1.l24.m1.1.1.1.1.1.1.cmml" xref="alg1.l24.m1.1.1.1.1.1.1"></plus><ci id="alg1.l24.m1.1.1.1.1.1.2.cmml" xref="alg1.l24.m1.1.1.1.1.1.2">𝑇</ci><ci id="alg1.l24.m1.1.1.1.1.1.3.cmml" xref="alg1.l24.m1.1.1.1.1.1.3">𝑓</ci></apply></apply><list id="alg1.l24.m1.14.14.2.3.cmml" xref="alg1.l24.m1.14.14.2.2"><apply id="alg1.l24.m1.13.13.1.1.1.cmml" xref="alg1.l24.m1.13.13.1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.13.13.1.1.1.1.cmml" xref="alg1.l24.m1.13.13.1.1.1">superscript</csymbol><apply id="alg1.l24.m1.13.13.1.1.1.2.cmml" xref="alg1.l24.m1.13.13.1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.13.13.1.1.1.2.1.cmml" xref="alg1.l24.m1.13.13.1.1.1">subscript</csymbol><ci id="alg1.l24.m1.13.13.1.1.1.2.2.cmml" xref="alg1.l24.m1.13.13.1.1.1.2.2">𝜃</ci><ci id="alg1.l24.m1.13.13.1.1.1.2.3.cmml" xref="alg1.l24.m1.13.13.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l24.m1.2.2.1.1.1.cmml" xref="alg1.l24.m1.2.2.1.1"><minus id="alg1.l24.m1.2.2.1.1.1.1.cmml" xref="alg1.l24.m1.2.2.1.1.1.1"></minus><apply id="alg1.l24.m1.2.2.1.1.1.2.cmml" xref="alg1.l24.m1.2.2.1.1.1.2"><plus id="alg1.l24.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l24.m1.2.2.1.1.1.2.1"></plus><ci id="alg1.l24.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l24.m1.2.2.1.1.1.2.2">𝑇</ci><ci id="alg1.l24.m1.2.2.1.1.1.2.3.cmml" xref="alg1.l24.m1.2.2.1.1.1.2.3">𝑓</ci></apply><cn type="integer" id="alg1.l24.m1.2.2.1.1.1.3.cmml" xref="alg1.l24.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="alg1.l24.m1.14.14.2.2.2.cmml" xref="alg1.l24.m1.14.14.2.2.2"><minus id="alg1.l24.m1.14.14.2.2.2.5.cmml" xref="alg1.l24.m1.14.14.2.2.2"></minus><apply id="alg1.l24.m1.14.14.2.2.2.4.cmml" xref="alg1.l24.m1.14.14.2.2.2.4"><times id="alg1.l24.m1.14.14.2.2.2.4.5.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.5"></times><ci id="alg1.l24.m1.14.14.2.2.2.4.6.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.6">𝜂</ci><apply id="alg1.l24.m1.14.14.2.2.2.4.7.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.7"><apply id="alg1.l24.m1.14.14.2.2.2.4.7.1.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.7.1"><csymbol cd="ambiguous" id="alg1.l24.m1.14.14.2.2.2.4.7.1.1.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.7.1">subscript</csymbol><ci id="alg1.l24.m1.14.14.2.2.2.4.7.1.2.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.7.1.2">∇</ci><apply id="alg1.l24.m1.14.14.2.2.2.4.7.1.3.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.7.1.3"><csymbol cd="ambiguous" id="alg1.l24.m1.14.14.2.2.2.4.7.1.3.1.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.7.1.3">subscript</csymbol><ci id="alg1.l24.m1.14.14.2.2.2.4.7.1.3.2.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.7.1.3.2">𝜃</ci><ci id="alg1.l24.m1.14.14.2.2.2.4.7.1.3.3.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.7.1.3.3">𝑖</ci></apply></apply><ci id="alg1.l24.m1.14.14.2.2.2.4.7.2.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.7.2">ℒ</ci></apply><vector id="alg1.l24.m1.14.14.2.2.2.4.4.5.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.4.4"><apply id="alg1.l24.m1.14.14.2.2.2.1.1.1.1.cmml" xref="alg1.l24.m1.14.14.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.14.14.2.2.2.1.1.1.1.1.cmml" xref="alg1.l24.m1.14.14.2.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l24.m1.14.14.2.2.2.1.1.1.1.2.cmml" xref="alg1.l24.m1.14.14.2.2.2.1.1.1.1.2">𝐷</ci><ci id="alg1.l24.m1.14.14.2.2.2.1.1.1.1.3.cmml" xref="alg1.l24.m1.14.14.2.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l24.m1.14.14.2.2.2.2.2.2.2.cmml" xref="alg1.l24.m1.14.14.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l24.m1.14.14.2.2.2.2.2.2.2.1.cmml" xref="alg1.l24.m1.14.14.2.2.2.2.2.2.2">superscript</csymbol><apply id="alg1.l24.m1.14.14.2.2.2.2.2.2.2.2.cmml" xref="alg1.l24.m1.14.14.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l24.m1.14.14.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l24.m1.14.14.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l24.m1.14.14.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l24.m1.14.14.2.2.2.2.2.2.2.2.2">𝜃</ci><list id="alg1.l24.m1.4.4.2.3.cmml" xref="alg1.l24.m1.4.4.2.2"><ci id="alg1.l24.m1.3.3.1.1.cmml" xref="alg1.l24.m1.3.3.1.1">𝑖</ci><apply id="alg1.l24.m1.4.4.2.2.1.cmml" xref="alg1.l24.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="alg1.l24.m1.4.4.2.2.1.1.cmml" xref="alg1.l24.m1.4.4.2.2.1">subscript</csymbol><ci id="alg1.l24.m1.4.4.2.2.1.2.cmml" xref="alg1.l24.m1.4.4.2.2.1.2">𝑏</ci><cn type="integer" id="alg1.l24.m1.4.4.2.2.1.3.cmml" xref="alg1.l24.m1.4.4.2.2.1.3">1</cn></apply></list></apply><apply id="alg1.l24.m1.5.5.1.1.1.cmml" xref="alg1.l24.m1.5.5.1.1"><minus id="alg1.l24.m1.5.5.1.1.1.1.cmml" xref="alg1.l24.m1.5.5.1.1.1.1"></minus><apply id="alg1.l24.m1.5.5.1.1.1.2.cmml" xref="alg1.l24.m1.5.5.1.1.1.2"><plus id="alg1.l24.m1.5.5.1.1.1.2.1.cmml" xref="alg1.l24.m1.5.5.1.1.1.2.1"></plus><ci id="alg1.l24.m1.5.5.1.1.1.2.2.cmml" xref="alg1.l24.m1.5.5.1.1.1.2.2">𝑇</ci><ci id="alg1.l24.m1.5.5.1.1.1.2.3.cmml" xref="alg1.l24.m1.5.5.1.1.1.2.3">𝑓</ci></apply><cn type="integer" id="alg1.l24.m1.5.5.1.1.1.3.cmml" xref="alg1.l24.m1.5.5.1.1.1.3">1</cn></apply></apply><ci id="alg1.l24.m1.12.12.cmml" xref="alg1.l24.m1.12.12">…</ci><apply id="alg1.l24.m1.14.14.2.2.2.3.3.3.3.cmml" xref="alg1.l24.m1.14.14.2.2.2.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l24.m1.14.14.2.2.2.3.3.3.3.1.cmml" xref="alg1.l24.m1.14.14.2.2.2.3.3.3.3">superscript</csymbol><apply id="alg1.l24.m1.14.14.2.2.2.3.3.3.3.2.cmml" xref="alg1.l24.m1.14.14.2.2.2.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l24.m1.14.14.2.2.2.3.3.3.3.2.1.cmml" xref="alg1.l24.m1.14.14.2.2.2.3.3.3.3">subscript</csymbol><ci id="alg1.l24.m1.14.14.2.2.2.3.3.3.3.2.2.cmml" xref="alg1.l24.m1.14.14.2.2.2.3.3.3.3.2.2">𝜃</ci><list id="alg1.l24.m1.7.7.2.3.cmml" xref="alg1.l24.m1.7.7.2.2"><ci id="alg1.l24.m1.6.6.1.1.cmml" xref="alg1.l24.m1.6.6.1.1">𝑖</ci><apply id="alg1.l24.m1.7.7.2.2.1.cmml" xref="alg1.l24.m1.7.7.2.2.1"><csymbol cd="ambiguous" id="alg1.l24.m1.7.7.2.2.1.1.cmml" xref="alg1.l24.m1.7.7.2.2.1">subscript</csymbol><ci id="alg1.l24.m1.7.7.2.2.1.2.cmml" xref="alg1.l24.m1.7.7.2.2.1.2">𝑏</ci><ci id="alg1.l24.m1.7.7.2.2.1.3.cmml" xref="alg1.l24.m1.7.7.2.2.1.3">𝐾</ci></apply></list></apply><apply id="alg1.l24.m1.8.8.1.1.1.cmml" xref="alg1.l24.m1.8.8.1.1"><minus id="alg1.l24.m1.8.8.1.1.1.1.cmml" xref="alg1.l24.m1.8.8.1.1.1.1"></minus><apply id="alg1.l24.m1.8.8.1.1.1.2.cmml" xref="alg1.l24.m1.8.8.1.1.1.2"><plus id="alg1.l24.m1.8.8.1.1.1.2.1.cmml" xref="alg1.l24.m1.8.8.1.1.1.2.1"></plus><ci id="alg1.l24.m1.8.8.1.1.1.2.2.cmml" xref="alg1.l24.m1.8.8.1.1.1.2.2">𝑇</ci><ci id="alg1.l24.m1.8.8.1.1.1.2.3.cmml" xref="alg1.l24.m1.8.8.1.1.1.2.3">𝑓</ci></apply><cn type="integer" id="alg1.l24.m1.8.8.1.1.1.3.cmml" xref="alg1.l24.m1.8.8.1.1.1.3">1</cn></apply></apply><apply id="alg1.l24.m1.14.14.2.2.2.4.4.4.4.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l24.m1.14.14.2.2.2.4.4.4.4.1.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.4.4.4">superscript</csymbol><apply id="alg1.l24.m1.14.14.2.2.2.4.4.4.4.2.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l24.m1.14.14.2.2.2.4.4.4.4.2.1.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.4.4.4">subscript</csymbol><ci id="alg1.l24.m1.14.14.2.2.2.4.4.4.4.2.2.cmml" xref="alg1.l24.m1.14.14.2.2.2.4.4.4.4.2.2">𝜃</ci><list id="alg1.l24.m1.10.10.2.3.cmml" xref="alg1.l24.m1.10.10.2.4"><ci id="alg1.l24.m1.9.9.1.1.cmml" xref="alg1.l24.m1.9.9.1.1">𝑖</ci><ci id="alg1.l24.m1.10.10.2.2.cmml" xref="alg1.l24.m1.10.10.2.2">ℎ</ci></list></apply><apply id="alg1.l24.m1.11.11.1.1.1.cmml" xref="alg1.l24.m1.11.11.1.1"><minus id="alg1.l24.m1.11.11.1.1.1.1.cmml" xref="alg1.l24.m1.11.11.1.1.1.1"></minus><apply id="alg1.l24.m1.11.11.1.1.1.2.cmml" xref="alg1.l24.m1.11.11.1.1.1.2"><plus id="alg1.l24.m1.11.11.1.1.1.2.1.cmml" xref="alg1.l24.m1.11.11.1.1.1.2.1"></plus><ci id="alg1.l24.m1.11.11.1.1.1.2.2.cmml" xref="alg1.l24.m1.11.11.1.1.1.2.2">𝑇</ci><ci id="alg1.l24.m1.11.11.1.1.1.2.3.cmml" xref="alg1.l24.m1.11.11.1.1.1.2.3">𝑓</ci></apply><cn type="integer" id="alg1.l24.m1.11.11.1.1.1.3.cmml" xref="alg1.l24.m1.11.11.1.1.1.3">1</cn></apply></apply></vector></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.14c">\theta_{i}^{(T+f)}=\theta_{i}^{(T+f-1)}\qquad\qquad\qquad-\eta\nabla_{\theta_{i}}\mathcal{L}(D_{i},\theta_{i,b_{1}}^{(T+f-1)},\ldots,\theta_{i,b_{K}}^{(T+f-1)},\theta_{i,h}^{(T+f-1)})</annotation></semantics></math>

</div>
<div id="alg1.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25:</span>     <span id="alg1.l25.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l25.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26:</span>  <span id="alg1.l26.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l26.2" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</div>
</div>
</figure>
<div id="S3.SS2.p4" class="ltx_para ltx_noindent">
<p id="S3.SS2.p4.4" class="ltx_p">Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.2 Method 2: Anti Scheduling ‣ 3 Proposed Algorithm ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> outlines the training procedure for both Vanilla and Anti scheduling. Line 2 represents client sampling. Lines 4–8 represent the Vanilla scheduling mode. When the Vanilla mode is selected, if the current global round <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">t</annotation></semantics></math> is greater than the layers unfreeze round <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="t_{k}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">t</mi><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝑡</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">t_{k}</annotation></semantics></math>, as specified in line 5, the algorithm unfreezes the <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">k</annotation></semantics></math>-th base parameter <math id="S3.SS2.p4.4.m4.2" class="ltx_Math" alttext="\theta_{i,b_{k}}" display="inline"><semantics id="S3.SS2.p4.4.m4.2a"><msub id="S3.SS2.p4.4.m4.2.3" xref="S3.SS2.p4.4.m4.2.3.cmml"><mi id="S3.SS2.p4.4.m4.2.3.2" xref="S3.SS2.p4.4.m4.2.3.2.cmml">θ</mi><mrow id="S3.SS2.p4.4.m4.2.2.2.2" xref="S3.SS2.p4.4.m4.2.2.2.3.cmml"><mi id="S3.SS2.p4.4.m4.1.1.1.1" xref="S3.SS2.p4.4.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p4.4.m4.2.2.2.2.2" xref="S3.SS2.p4.4.m4.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p4.4.m4.2.2.2.2.1" xref="S3.SS2.p4.4.m4.2.2.2.2.1.cmml"><mi id="S3.SS2.p4.4.m4.2.2.2.2.1.2" xref="S3.SS2.p4.4.m4.2.2.2.2.1.2.cmml">b</mi><mi id="S3.SS2.p4.4.m4.2.2.2.2.1.3" xref="S3.SS2.p4.4.m4.2.2.2.2.1.3.cmml">k</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.2b"><apply id="S3.SS2.p4.4.m4.2.3.cmml" xref="S3.SS2.p4.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.2.3.1.cmml" xref="S3.SS2.p4.4.m4.2.3">subscript</csymbol><ci id="S3.SS2.p4.4.m4.2.3.2.cmml" xref="S3.SS2.p4.4.m4.2.3.2">𝜃</ci><list id="S3.SS2.p4.4.m4.2.2.2.3.cmml" xref="S3.SS2.p4.4.m4.2.2.2.2"><ci id="S3.SS2.p4.4.m4.1.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1.1.1">𝑖</ci><apply id="S3.SS2.p4.4.m4.2.2.2.2.1.cmml" xref="S3.SS2.p4.4.m4.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.2.2.2.2.1.1.cmml" xref="S3.SS2.p4.4.m4.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.2.2.2.2.1.2.cmml" xref="S3.SS2.p4.4.m4.2.2.2.2.1.2">𝑏</ci><ci id="S3.SS2.p4.4.m4.2.2.2.2.1.3.cmml" xref="S3.SS2.p4.4.m4.2.2.2.2.1.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.2c">\theta_{i,b_{k}}</annotation></semantics></math>. Then, in line 8, the unfrozen base parameters are used to perform a local update.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para ltx_noindent">
<p id="S3.SS2.p5.4" class="ltx_p">Lines 9–13 describe the Anti scheduling mode. In Anti mode, as line 10 indicates, if the current global round <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mi id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">t</annotation></semantics></math> exceeds the layer unfreeze round <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="t_{k}" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><msub id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">t</mi><mi id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2">𝑡</ci><ci id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">t_{k}</annotation></semantics></math>, the algorithm unfreezes the (<math id="S3.SS2.p5.3.m3.1" class="ltx_Math" alttext="K-k+1" display="inline"><semantics id="S3.SS2.p5.3.m3.1a"><mrow id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mrow id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml"><mi id="S3.SS2.p5.3.m3.1.1.2.2" xref="S3.SS2.p5.3.m3.1.1.2.2.cmml">K</mi><mo id="S3.SS2.p5.3.m3.1.1.2.1" xref="S3.SS2.p5.3.m3.1.1.2.1.cmml">−</mo><mi id="S3.SS2.p5.3.m3.1.1.2.3" xref="S3.SS2.p5.3.m3.1.1.2.3.cmml">k</mi></mrow><mo id="S3.SS2.p5.3.m3.1.1.1" xref="S3.SS2.p5.3.m3.1.1.1.cmml">+</mo><mn id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><plus id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1.1"></plus><apply id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2"><minus id="S3.SS2.p5.3.m3.1.1.2.1.cmml" xref="S3.SS2.p5.3.m3.1.1.2.1"></minus><ci id="S3.SS2.p5.3.m3.1.1.2.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2.2">𝐾</ci><ci id="S3.SS2.p5.3.m3.1.1.2.3.cmml" xref="S3.SS2.p5.3.m3.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">K-k+1</annotation></semantics></math>)-th base parameter <math id="S3.SS2.p5.4.m4.2" class="ltx_Math" alttext="\theta_{i,b_{K-k+1}}" display="inline"><semantics id="S3.SS2.p5.4.m4.2a"><msub id="S3.SS2.p5.4.m4.2.3" xref="S3.SS2.p5.4.m4.2.3.cmml"><mi id="S3.SS2.p5.4.m4.2.3.2" xref="S3.SS2.p5.4.m4.2.3.2.cmml">θ</mi><mrow id="S3.SS2.p5.4.m4.2.2.2.2" xref="S3.SS2.p5.4.m4.2.2.2.3.cmml"><mi id="S3.SS2.p5.4.m4.1.1.1.1" xref="S3.SS2.p5.4.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p5.4.m4.2.2.2.2.2" xref="S3.SS2.p5.4.m4.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p5.4.m4.2.2.2.2.1" xref="S3.SS2.p5.4.m4.2.2.2.2.1.cmml"><mi id="S3.SS2.p5.4.m4.2.2.2.2.1.2" xref="S3.SS2.p5.4.m4.2.2.2.2.1.2.cmml">b</mi><mrow id="S3.SS2.p5.4.m4.2.2.2.2.1.3" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.cmml"><mrow id="S3.SS2.p5.4.m4.2.2.2.2.1.3.2" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.cmml"><mi id="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.2" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.2.cmml">K</mi><mo id="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.1" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.1.cmml">−</mo><mi id="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.3" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.3.cmml">k</mi></mrow><mo id="S3.SS2.p5.4.m4.2.2.2.2.1.3.1" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.1.cmml">+</mo><mn id="S3.SS2.p5.4.m4.2.2.2.2.1.3.3" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.3.cmml">1</mn></mrow></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.2b"><apply id="S3.SS2.p5.4.m4.2.3.cmml" xref="S3.SS2.p5.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.2.3.1.cmml" xref="S3.SS2.p5.4.m4.2.3">subscript</csymbol><ci id="S3.SS2.p5.4.m4.2.3.2.cmml" xref="S3.SS2.p5.4.m4.2.3.2">𝜃</ci><list id="S3.SS2.p5.4.m4.2.2.2.3.cmml" xref="S3.SS2.p5.4.m4.2.2.2.2"><ci id="S3.SS2.p5.4.m4.1.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1">𝑖</ci><apply id="S3.SS2.p5.4.m4.2.2.2.2.1.cmml" xref="S3.SS2.p5.4.m4.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.2.2.2.2.1.1.cmml" xref="S3.SS2.p5.4.m4.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.p5.4.m4.2.2.2.2.1.2.cmml" xref="S3.SS2.p5.4.m4.2.2.2.2.1.2">𝑏</ci><apply id="S3.SS2.p5.4.m4.2.2.2.2.1.3.cmml" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3"><plus id="S3.SS2.p5.4.m4.2.2.2.2.1.3.1.cmml" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.1"></plus><apply id="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.cmml" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.2"><minus id="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.1.cmml" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.1"></minus><ci id="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.2.cmml" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.2">𝐾</ci><ci id="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.3.cmml" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.2.3">𝑘</ci></apply><cn type="integer" id="S3.SS2.p5.4.m4.2.2.2.2.1.3.3.cmml" xref="S3.SS2.p5.4.m4.2.2.2.2.1.3.3">1</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.2c">\theta_{i,b_{K-k+1}}</annotation></semantics></math>, which is closer to the head layer. Line 13 then uses the unfrozen base parameters for the local update. Lines 15–16 maintain the freezing of the head while sending the updated base parameters to the server. Line 18 performs global aggregation after local updates, and lines 20–24 is the fine-tuning process in which both base and head parameters are utilized in each client after the global rounds are complete</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.3" class="ltx_p">In our experimental setup, the total number of clients <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">N</annotation></semantics></math> is set to 100, with each round involving a client participation ratio <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.p1.2.m2.1a"><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">r</annotation></semantics></math> of 0.1, indicating that 10 clients participate in each training round. The batch size is configured to 10, and the learning rate is set at 0.005. The datasets used in our experiments include MNIST, CIFAR-10, CIFAR-100, and Tiny-ImageNet. To induce heterogeneity among the data distributed to each client, we sampled from a Dirichlet distribution with a Dirichlet parameter of 0.1, establishing a highly heterogeneous environment. This approach to data distribution is visualized in Figure <a href="#S4.F2" title="Figure 2 ‣ 4 Experiments ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, which illustrates the results of sampling the CIFAR-10 dataset among 10 clients. Despite the high heterogeneity induced by the Dirichlet parameter <math id="S4.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.p1.3.m3.1a"><mi id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><ci id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">\alpha</annotation></semantics></math> of 0.1, MNIST and CIFAR-10 dataset inherently lacks significant class heterogeneity. Therefore, our experiments focus on CIFAR-100 and Tiny-ImageNet datasets because our approach performs well in environments with significant data and class heterogeneity. The CIFAR-100 dataset contains 100 different classes, and the Tiny-ImageNet dataset contains 200 classes.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2404.17799/assets/figure/data_info_in_CIFAR-10.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="299" height="199" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Results of sampling the CIFAR-10 dataset among 10 clients from a Dirichlet distribution. The Dirichlet parameter <math id="S4.F2.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.F2.2.m1.1b"><mi id="S4.F2.2.m1.1.1" xref="S4.F2.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.F2.2.m1.1c"><ci id="S4.F2.2.m1.1.1.cmml" xref="S4.F2.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.2.m1.1d">\alpha</annotation></semantics></math> is 0.1, generating highly heterogeneous data. However, the nature of the CIFAR-10 dataset does not offer much class heterogeneity.</figcaption>
</figure>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.4" class="ltx_p">In our experiments, we compare our approach against six baselines, as detailed in the following references:  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. The model used is a shallow CNN model comprising two convolutional layers and two fully connected layers. Here, the last fully connected layer is set as the <span id="S4.p2.4.1" class="ltx_text ltx_font_italic">head</span>, and the remaining three layers are designated as the base. The total number of base layers <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.p2.1.m1.1a"><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">K</annotation></semantics></math> is set to 3, with <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="t_{1}" display="inline"><semantics id="S4.p2.2.m2.1a"><msub id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">t</mi><mn id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1">subscript</csymbol><ci id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">𝑡</ci><cn type="integer" id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">t_{1}</annotation></semantics></math> at the 0 (initial) round, <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="t_{2}" display="inline"><semantics id="S4.p2.3.m3.1a"><msub id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mi id="S4.p2.3.m3.1.1.2" xref="S4.p2.3.m3.1.1.2.cmml">t</mi><mn id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1">subscript</csymbol><ci id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1.2">𝑡</ci><cn type="integer" id="S4.p2.3.m3.1.1.3.cmml" xref="S4.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">t_{2}</annotation></semantics></math> at the 100-th global round, and <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="t_{3}" display="inline"><semantics id="S4.p2.4.m4.1a"><msub id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml"><mi id="S4.p2.4.m4.1.1.2" xref="S4.p2.4.m4.1.1.2.cmml">t</mi><mn id="S4.p2.4.m4.1.1.3" xref="S4.p2.4.m4.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><apply id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.1.cmml" xref="S4.p2.4.m4.1.1">subscript</csymbol><ci id="S4.p2.4.m4.1.1.2.cmml" xref="S4.p2.4.m4.1.1.2">𝑡</ci><cn type="integer" id="S4.p2.4.m4.1.1.3.cmml" xref="S4.p2.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">t_{3}</annotation></semantics></math> at the 200-th global round. Additionally, in FedBABU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, the learning rate of the <span id="S4.p2.4.2" class="ltx_text ltx_font_italic">head</span> is set to zero during the training rounds, implying that gradients are calculated but not applied. In contrast, our scheduling algorithm achieves complete decoupling by freezing the gradients, thus preventing both computation and application. We will delve into the comparison of computational and communication costs in Section <a href="#S5.SS2" title="5.2 Estimation of Computational Cost for Each Algorithm ‣ 5 Ablation Study ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Comparison of accuracy</figcaption>
<div id="S4.T2.4" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:391pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-42.7pt,38.5pt) scale(0.835540032826245,0.835540032826245) ;">
<table id="S4.T2.4.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.4.4.5.1" class="ltx_tr">
<th id="S4.T2.4.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" rowspan="2"><span id="S4.T2.4.4.5.1.1.1" class="ltx_text">Algorithm</span></th>
<th id="S4.T2.4.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2">MNIST</th>
<th id="S4.T2.4.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2">CIFAR-10</th>
<th id="S4.T2.4.4.5.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2">CIFAR-100</th>
<th id="S4.T2.4.4.5.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2">Tiny-ImageNet</th>
</tr>
<tr id="S4.T2.4.4.4" class="ltx_tr">
<th id="S4.T2.4.4.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Acc. (%)</th>
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">T</annotation></semantics></math></th>
<th id="S4.T2.4.4.4.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Acc. (%)</th>
<th id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><math id="S4.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.T2.2.2.2.2.m1.1a"><mi id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><ci id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">T</annotation></semantics></math></th>
<th id="S4.T2.4.4.4.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Acc. (%)</th>
<th id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t"><math id="S4.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.T2.3.3.3.3.m1.1a"><mi id="S4.T2.3.3.3.3.m1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.1b"><ci id="S4.T2.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.1c">T</annotation></semantics></math></th>
<th id="S4.T2.4.4.4.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Acc. (%)</th>
<th id="S4.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S4.T2.4.4.4.4.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.T2.4.4.4.4.m1.1a"><mi id="S4.T2.4.4.4.4.m1.1.1" xref="S4.T2.4.4.4.4.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.4.m1.1b"><ci id="S4.T2.4.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.4.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.4.m1.1c">T</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.4.4.6.1" class="ltx_tr">
<th id="S4.T2.4.4.6.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.4.4.6.1.1.1" class="ltx_text">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite></span></th>
<td id="S4.T2.4.4.6.1.2" class="ltx_td ltx_align_center ltx_border_t">91.48</td>
<td id="S4.T2.4.4.6.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.6.1.4" class="ltx_td ltx_align_center ltx_border_t">36.87</td>
<td id="S4.T2.4.4.6.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.6.1.6" class="ltx_td ltx_align_center ltx_border_t">29.04</td>
<td id="S4.T2.4.4.6.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">500</td>
<td id="S4.T2.4.4.6.1.8" class="ltx_td ltx_align_center ltx_border_t">16.97</td>
<td id="S4.T2.4.4.6.1.9" class="ltx_td ltx_align_center ltx_border_t">300</td>
</tr>
<tr id="S4.T2.4.4.7.2" class="ltx_tr">
<td id="S4.T2.4.4.7.2.1" class="ltx_td ltx_align_center">96.32</td>
<td id="S4.T2.4.4.7.2.2" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.7.2.3" class="ltx_td ltx_align_center">42.00</td>
<td id="S4.T2.4.4.7.2.4" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.7.2.5" class="ltx_td ltx_align_center">30.95</td>
<td id="S4.T2.4.4.7.2.6" class="ltx_td ltx_align_center ltx_border_r">1000</td>
<td id="S4.T2.4.4.7.2.7" class="ltx_td ltx_align_center">14.06</td>
<td id="S4.T2.4.4.7.2.8" class="ltx_td ltx_align_center">500</td>
</tr>
<tr id="S4.T2.4.4.8.3" class="ltx_tr">
<td id="S4.T2.4.4.8.3.1" class="ltx_td ltx_align_center">97.48</td>
<td id="S4.T2.4.4.8.3.2" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.8.3.3" class="ltx_td ltx_align_center">49.36</td>
<td id="S4.T2.4.4.8.3.4" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.8.3.5" class="ltx_td ltx_align_center">30.34</td>
<td id="S4.T2.4.4.8.3.6" class="ltx_td ltx_align_center ltx_border_r">1500</td>
<td id="S4.T2.4.4.8.3.7" class="ltx_td ltx_align_center">14.27</td>
<td id="S4.T2.4.4.8.3.8" class="ltx_td ltx_align_center">1500</td>
</tr>
<tr id="S4.T2.4.4.9.4" class="ltx_tr">
<th id="S4.T2.4.4.9.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.4.4.9.4.1.1" class="ltx_text">FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite></span></th>
<td id="S4.T2.4.4.9.4.2" class="ltx_td ltx_align_center ltx_border_t">98.30</td>
<td id="S4.T2.4.4.9.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.9.4.4" class="ltx_td ltx_align_center ltx_border_t">86.16</td>
<td id="S4.T2.4.4.9.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.9.4.6" class="ltx_td ltx_align_center ltx_border_t">40.22</td>
<td id="S4.T2.4.4.9.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">500</td>
<td id="S4.T2.4.4.9.4.8" class="ltx_td ltx_align_center ltx_border_t">29.04</td>
<td id="S4.T2.4.4.9.4.9" class="ltx_td ltx_align_center ltx_border_t">300</td>
</tr>
<tr id="S4.T2.4.4.10.5" class="ltx_tr">
<td id="S4.T2.4.4.10.5.1" class="ltx_td ltx_align_center">98.63</td>
<td id="S4.T2.4.4.10.5.2" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.10.5.3" class="ltx_td ltx_align_center">87.34</td>
<td id="S4.T2.4.4.10.5.4" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.10.5.5" class="ltx_td ltx_align_center">41.03</td>
<td id="S4.T2.4.4.10.5.6" class="ltx_td ltx_align_center ltx_border_r">1000</td>
<td id="S4.T2.4.4.10.5.7" class="ltx_td ltx_align_center">29.24</td>
<td id="S4.T2.4.4.10.5.8" class="ltx_td ltx_align_center">500</td>
</tr>
<tr id="S4.T2.4.4.11.6" class="ltx_tr">
<td id="S4.T2.4.4.11.6.1" class="ltx_td ltx_align_center">98.69</td>
<td id="S4.T2.4.4.11.6.2" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.11.6.3" class="ltx_td ltx_align_center">86.66</td>
<td id="S4.T2.4.4.11.6.4" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.11.6.5" class="ltx_td ltx_align_center">40.05</td>
<td id="S4.T2.4.4.11.6.6" class="ltx_td ltx_align_center ltx_border_r">1500</td>
<td id="S4.T2.4.4.11.6.7" class="ltx_td ltx_align_center">29.11</td>
<td id="S4.T2.4.4.11.6.8" class="ltx_td ltx_align_center">1000</td>
</tr>
<tr id="S4.T2.4.4.12.7" class="ltx_tr">
<th id="S4.T2.4.4.12.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.4.4.12.7.1.1" class="ltx_text">LG-FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite></span></th>
<td id="S4.T2.4.4.12.7.2" class="ltx_td ltx_align_center ltx_border_t">97.95</td>
<td id="S4.T2.4.4.12.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.12.7.4" class="ltx_td ltx_align_center ltx_border_t">85.75</td>
<td id="S4.T2.4.4.12.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.12.7.6" class="ltx_td ltx_align_center ltx_border_t">41.06</td>
<td id="S4.T2.4.4.12.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">500</td>
<td id="S4.T2.4.4.12.7.8" class="ltx_td ltx_align_center ltx_border_t">26.46</td>
<td id="S4.T2.4.4.12.7.9" class="ltx_td ltx_align_center ltx_border_t">300</td>
</tr>
<tr id="S4.T2.4.4.13.8" class="ltx_tr">
<td id="S4.T2.4.4.13.8.1" class="ltx_td ltx_align_center">98.17</td>
<td id="S4.T2.4.4.13.8.2" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.13.8.3" class="ltx_td ltx_align_center">86.10</td>
<td id="S4.T2.4.4.13.8.4" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.13.8.5" class="ltx_td ltx_align_center">41.01</td>
<td id="S4.T2.4.4.13.8.6" class="ltx_td ltx_align_center ltx_border_r">1000</td>
<td id="S4.T2.4.4.13.8.7" class="ltx_td ltx_align_center">26.35</td>
<td id="S4.T2.4.4.13.8.8" class="ltx_td ltx_align_center">500</td>
</tr>
<tr id="S4.T2.4.4.14.9" class="ltx_tr">
<td id="S4.T2.4.4.14.9.1" class="ltx_td ltx_align_center">98.13</td>
<td id="S4.T2.4.4.14.9.2" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.14.9.3" class="ltx_td ltx_align_center">85.91</td>
<td id="S4.T2.4.4.14.9.4" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.14.9.5" class="ltx_td ltx_align_center">40.80</td>
<td id="S4.T2.4.4.14.9.6" class="ltx_td ltx_align_center ltx_border_r">1500</td>
<td id="S4.T2.4.4.14.9.7" class="ltx_td ltx_align_center">26.36</td>
<td id="S4.T2.4.4.14.9.8" class="ltx_td ltx_align_center">1000</td>
</tr>
<tr id="S4.T2.4.4.15.10" class="ltx_tr">
<th id="S4.T2.4.4.15.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.4.4.15.10.1.1" class="ltx_text">FedRep <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite></span></th>
<td id="S4.T2.4.4.15.10.2" class="ltx_td ltx_align_center ltx_border_t">98.56</td>
<td id="S4.T2.4.4.15.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.15.10.4" class="ltx_td ltx_align_center ltx_border_t">86.58</td>
<td id="S4.T2.4.4.15.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.15.10.6" class="ltx_td ltx_align_center ltx_border_t">40.44</td>
<td id="S4.T2.4.4.15.10.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">500</td>
<td id="S4.T2.4.4.15.10.8" class="ltx_td ltx_align_center ltx_border_t">28.85</td>
<td id="S4.T2.4.4.15.10.9" class="ltx_td ltx_align_center ltx_border_t">300</td>
</tr>
<tr id="S4.T2.4.4.16.11" class="ltx_tr">
<td id="S4.T2.4.4.16.11.1" class="ltx_td ltx_align_center">98.69</td>
<td id="S4.T2.4.4.16.11.2" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.16.11.3" class="ltx_td ltx_align_center">88.12</td>
<td id="S4.T2.4.4.16.11.4" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.16.11.5" class="ltx_td ltx_align_center">41.24</td>
<td id="S4.T2.4.4.16.11.6" class="ltx_td ltx_align_center ltx_border_r">1000</td>
<td id="S4.T2.4.4.16.11.7" class="ltx_td ltx_align_center">28.54</td>
<td id="S4.T2.4.4.16.11.8" class="ltx_td ltx_align_center">500</td>
</tr>
<tr id="S4.T2.4.4.17.12" class="ltx_tr">
<td id="S4.T2.4.4.17.12.1" class="ltx_td ltx_align_center">98.75</td>
<td id="S4.T2.4.4.17.12.2" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.17.12.3" class="ltx_td ltx_align_center">88.11</td>
<td id="S4.T2.4.4.17.12.4" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.17.12.5" class="ltx_td ltx_align_center">40.66</td>
<td id="S4.T2.4.4.17.12.6" class="ltx_td ltx_align_center ltx_border_r">1000</td>
<td id="S4.T2.4.4.17.12.7" class="ltx_td ltx_align_center">28.50</td>
<td id="S4.T2.4.4.17.12.8" class="ltx_td ltx_align_center">1000</td>
</tr>
<tr id="S4.T2.4.4.18.13" class="ltx_tr">
<th id="S4.T2.4.4.18.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.4.4.18.13.1.1" class="ltx_text">FedROD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite></span></th>
<td id="S4.T2.4.4.18.13.2" class="ltx_td ltx_align_center ltx_border_t">98.61</td>
<td id="S4.T2.4.4.18.13.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.18.13.4" class="ltx_td ltx_align_center ltx_border_t">86.24</td>
<td id="S4.T2.4.4.18.13.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.18.13.6" class="ltx_td ltx_align_center ltx_border_t">49.50</td>
<td id="S4.T2.4.4.18.13.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">500</td>
<td id="S4.T2.4.4.18.13.8" class="ltx_td ltx_align_center ltx_border_t">37.23</td>
<td id="S4.T2.4.4.18.13.9" class="ltx_td ltx_align_center ltx_border_t">300</td>
</tr>
<tr id="S4.T2.4.4.19.14" class="ltx_tr">
<td id="S4.T2.4.4.19.14.1" class="ltx_td ltx_align_center">98.95</td>
<td id="S4.T2.4.4.19.14.2" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.19.14.3" class="ltx_td ltx_align_center">88.01</td>
<td id="S4.T2.4.4.19.14.4" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.19.14.5" class="ltx_td ltx_align_center">48.70</td>
<td id="S4.T2.4.4.19.14.6" class="ltx_td ltx_align_center ltx_border_r">1000</td>
<td id="S4.T2.4.4.19.14.7" class="ltx_td ltx_align_center">35.34</td>
<td id="S4.T2.4.4.19.14.8" class="ltx_td ltx_align_center">500</td>
</tr>
<tr id="S4.T2.4.4.20.15" class="ltx_tr">
<td id="S4.T2.4.4.20.15.1" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.20.15.1.1" class="ltx_text ltx_font_bold">99.06</span></td>
<td id="S4.T2.4.4.20.15.2" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.20.15.3" class="ltx_td ltx_align_center">88.59</td>
<td id="S4.T2.4.4.20.15.4" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.20.15.5" class="ltx_td ltx_align_center">50.56</td>
<td id="S4.T2.4.4.20.15.6" class="ltx_td ltx_align_center ltx_border_r">1500</td>
<td id="S4.T2.4.4.20.15.7" class="ltx_td ltx_align_center">35.35</td>
<td id="S4.T2.4.4.20.15.8" class="ltx_td ltx_align_center">1000</td>
</tr>
<tr id="S4.T2.4.4.21.16" class="ltx_tr">
<th id="S4.T2.4.4.21.16.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.4.4.21.16.1.1" class="ltx_text">FedBABU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite></span></th>
<td id="S4.T2.4.4.21.16.2" class="ltx_td ltx_align_center ltx_border_t">98.19</td>
<td id="S4.T2.4.4.21.16.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.21.16.4" class="ltx_td ltx_align_center ltx_border_t">85.77</td>
<td id="S4.T2.4.4.21.16.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.21.16.6" class="ltx_td ltx_align_center ltx_border_t">49.28</td>
<td id="S4.T2.4.4.21.16.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">500</td>
<td id="S4.T2.4.4.21.16.8" class="ltx_td ltx_align_center ltx_border_t">37.84</td>
<td id="S4.T2.4.4.21.16.9" class="ltx_td ltx_align_center ltx_border_t">300</td>
</tr>
<tr id="S4.T2.4.4.22.17" class="ltx_tr">
<td id="S4.T2.4.4.22.17.1" class="ltx_td ltx_align_center">98.77</td>
<td id="S4.T2.4.4.22.17.2" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.22.17.3" class="ltx_td ltx_align_center">86.16</td>
<td id="S4.T2.4.4.22.17.4" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.22.17.5" class="ltx_td ltx_align_center">52.75</td>
<td id="S4.T2.4.4.22.17.6" class="ltx_td ltx_align_center ltx_border_r">1000</td>
<td id="S4.T2.4.4.22.17.7" class="ltx_td ltx_align_center">33.78</td>
<td id="S4.T2.4.4.22.17.8" class="ltx_td ltx_align_center">500</td>
</tr>
<tr id="S4.T2.4.4.23.18" class="ltx_tr">
<td id="S4.T2.4.4.23.18.1" class="ltx_td ltx_align_center">98.84</td>
<td id="S4.T2.4.4.23.18.2" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.23.18.3" class="ltx_td ltx_align_center">87.07</td>
<td id="S4.T2.4.4.23.18.4" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.23.18.5" class="ltx_td ltx_align_center">51.82</td>
<td id="S4.T2.4.4.23.18.6" class="ltx_td ltx_align_center ltx_border_r">1500</td>
<td id="S4.T2.4.4.23.18.7" class="ltx_td ltx_align_center">32.57</td>
<td id="S4.T2.4.4.23.18.8" class="ltx_td ltx_align_center">1000</td>
</tr>
<tr id="S4.T2.4.4.24.19" class="ltx_tr">
<th id="S4.T2.4.4.24.19.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.4.4.24.19.1.1" class="ltx_text ltx_font_bold">Vanilla Scheduling</span></th>
<td id="S4.T2.4.4.24.19.2" class="ltx_td ltx_align_center ltx_border_t">98.21</td>
<td id="S4.T2.4.4.24.19.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.24.19.4" class="ltx_td ltx_align_center ltx_border_t">85.82</td>
<td id="S4.T2.4.4.24.19.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.24.19.6" class="ltx_td ltx_align_center ltx_border_t">56.86</td>
<td id="S4.T2.4.4.24.19.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">500</td>
<td id="S4.T2.4.4.24.19.8" class="ltx_td ltx_align_center ltx_border_t">41.86</td>
<td id="S4.T2.4.4.24.19.9" class="ltx_td ltx_align_center ltx_border_t">300</td>
</tr>
<tr id="S4.T2.4.4.25.20" class="ltx_tr">
<td id="S4.T2.4.4.25.20.1" class="ltx_td ltx_align_center">98.84</td>
<td id="S4.T2.4.4.25.20.2" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.25.20.3" class="ltx_td ltx_align_center">87.81</td>
<td id="S4.T2.4.4.25.20.4" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.25.20.5" class="ltx_td ltx_align_center">59.52</td>
<td id="S4.T2.4.4.25.20.6" class="ltx_td ltx_align_center ltx_border_r">1000</td>
<td id="S4.T2.4.4.25.20.7" class="ltx_td ltx_align_center">39.51</td>
<td id="S4.T2.4.4.25.20.8" class="ltx_td ltx_align_center">500</td>
</tr>
<tr id="S4.T2.4.4.26.21" class="ltx_tr">
<td id="S4.T2.4.4.26.21.1" class="ltx_td ltx_align_center">98.99</td>
<td id="S4.T2.4.4.26.21.2" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.26.21.3" class="ltx_td ltx_align_center">88.58</td>
<td id="S4.T2.4.4.26.21.4" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T2.4.4.26.21.5" class="ltx_td ltx_align_center">58.49</td>
<td id="S4.T2.4.4.26.21.6" class="ltx_td ltx_align_center ltx_border_r">1500</td>
<td id="S4.T2.4.4.26.21.7" class="ltx_td ltx_align_center">36.44</td>
<td id="S4.T2.4.4.26.21.8" class="ltx_td ltx_align_center">1000</td>
</tr>
<tr id="S4.T2.4.4.27.22" class="ltx_tr">
<th id="S4.T2.4.4.27.22.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" rowspan="3"><span id="S4.T2.4.4.27.22.1.1" class="ltx_text ltx_font_bold">Anti Scheduling</span></th>
<td id="S4.T2.4.4.27.22.2" class="ltx_td ltx_align_center ltx_border_t">98.34</td>
<td id="S4.T2.4.4.27.22.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.27.22.4" class="ltx_td ltx_align_center ltx_border_t">85.73</td>
<td id="S4.T2.4.4.27.22.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">100</td>
<td id="S4.T2.4.4.27.22.6" class="ltx_td ltx_align_center ltx_border_t">56.17</td>
<td id="S4.T2.4.4.27.22.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">500</td>
<td id="S4.T2.4.4.27.22.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.4.27.22.8.1" class="ltx_text ltx_font_bold">41.94</span></td>
<td id="S4.T2.4.4.27.22.9" class="ltx_td ltx_align_center ltx_border_t">300</td>
</tr>
<tr id="S4.T2.4.4.28.23" class="ltx_tr">
<td id="S4.T2.4.4.28.23.1" class="ltx_td ltx_align_center">98.81</td>
<td id="S4.T2.4.4.28.23.2" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.28.23.3" class="ltx_td ltx_align_center">87.67</td>
<td id="S4.T2.4.4.28.23.4" class="ltx_td ltx_align_center ltx_border_r">200</td>
<td id="S4.T2.4.4.28.23.5" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.28.23.5.1" class="ltx_text ltx_font_bold">60.06</span></td>
<td id="S4.T2.4.4.28.23.6" class="ltx_td ltx_align_center ltx_border_r">1000</td>
<td id="S4.T2.4.4.28.23.7" class="ltx_td ltx_align_center">39.67</td>
<td id="S4.T2.4.4.28.23.8" class="ltx_td ltx_align_center">500</td>
</tr>
<tr id="S4.T2.4.4.29.24" class="ltx_tr">
<td id="S4.T2.4.4.29.24.1" class="ltx_td ltx_align_center ltx_border_b">98.96</td>
<td id="S4.T2.4.4.29.24.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">300</td>
<td id="S4.T2.4.4.29.24.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.4.4.29.24.3.1" class="ltx_text ltx_font_bold">88.61</span></td>
<td id="S4.T2.4.4.29.24.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">300</td>
<td id="S4.T2.4.4.29.24.5" class="ltx_td ltx_align_center ltx_border_b">58.58</td>
<td id="S4.T2.4.4.29.24.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">1500</td>
<td id="S4.T2.4.4.29.24.7" class="ltx_td ltx_align_center ltx_border_b">36.63</td>
<td id="S4.T2.4.4.29.24.8" class="ltx_td ltx_align_center ltx_border_b">1000</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.2" class="ltx_p">Table <a href="#S4.T2" title="Table 2 ‣ 4 Experiments ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents a comparison of the accuracies achieved by various federated learning algorithms across multiple datasets, including MNIST, CIFAR-10, CIFAR-100, and Tiny-ImageNet. It encompasses representation learning algorithms such as FedAvg, FedPer, LG-FedAvg, FedRep, FedROD, and FedBABU, as well as our proposed Vanilla and Anti scheduling algorithms. A key aspect of both FedBABU and our scheduling algorithms is their approach during the training phases leading up to the final global round, denoted as <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.p3.1.m1.1a"><mi id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><ci id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">T</annotation></semantics></math>. Characteristically, these algorithms exclusively use the base layers and do not employ the head layer during the training rounds, resulting in relatively lower accuracies prior to the final round. To ensure a fair comparison, the accuracy figures for FedBABU and our scheduling algorithms at <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.p3.2.m2.1a"><mi id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><ci id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">T</annotation></semantics></math> represent the performance after fine-tuning. Additionally, it is noteworthy that our scheduling algorithms have achieved high accuracy in environments with significant data and class heterogeneity, demonstrating their effectiveness in processing complex and diverse datasets.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2404.17799/assets/figure/cifar100_vanila_anti.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="299" height="159" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>This figure shows the average accuracy of clients on the CIFAR-100 dataset. As can be seen, the earlier round accuracy of our scheduling algorithm is lower than FedAvg and FedBABU. This is because, in the earlier rounds, not all base and head participate and the training is conducted using only a portion of the unfrozen base layers.</figcaption>
</figure>
<div id="S4.p4" class="ltx_para ltx_noindent">
<p id="S4.p4.1" class="ltx_p">Figure <a href="#S4.F3" title="Figure 3 ‣ 4 Experiments ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the average accuracy of clients on the CIFAR-100 dataset, visualizing the performance of our scheduling algorithms compared to baselines. As can be seen, the earlier round accuracy of our scheduling algorithm is lower than FedAvg and FedBABU, which is attributed to the fact that, in the earlier rounds, not only all base but also head participate, and the training is conducted using only a portion of the unfrozen base layers.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2404.17799/assets/figure/tiny_vanila_anti.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="299" height="159" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>This figure represents the average accuracy of clients on the Tiny-ImageNet dataset, where the initial round accuracy of our scheduling algorithm is lower compared to FedAvg and FedBABU, consistent with its characteristics.</figcaption>
</figure>
<div id="S4.p5" class="ltx_para ltx_noindent">
<p id="S4.p5.1" class="ltx_p">Similarly, Figure <a href="#S4.F4" title="Figure 4 ‣ 4 Experiments ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> represents the average accuracy of clients on the Tiny-ImageNet dataset. Our scheduling algorithm’s earlier round accuracy is lower than FedAvg and FedBABU, consistent with its characteristics. This visualization helps underscore how our scheduling algorithms gradually catch up and potentially surpass other algorithms as the training progresses.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Ablation Study</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">In our ablation study, we demonstrate the results of varying different parameters. The contents to be covered in the ablation study include:</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p">Comparison of client-specific accuracy</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p">Estimation of computational cost for each algorithm</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p">Effect of layer unfreezing timing on the accuracy</p>
</div>
</li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="S5.I1.i4.p1.1" class="ltx_p">Application of scheduling to the baseline algorithms</p>
</div>
</li>
</ul>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Comparison of Client-specific Accuracy</h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.1" class="ltx_p">To ensure that accuracy improvements during fine-tuning are not biased or limited to specific clients, we conducted a comparative analysis of client-specific accuracy between the latest representation learning algorithms and our algorithm. Since the accuracy differences in the MNIST and CIFAR-10 datasets are not significantly pronounced, the comparison was focused on the CIFAR-100 and Tiny-ImageNet datasets. The results demonstrated that the higher average accuracy of our scheduling algorithm was not due to bias towards specific clients but was consistently achieved across all clients.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.1" class="ltx_p">Figure <a href="#S5.F5" title="Figure 5 ‣ 5.1 Comparison of Client-specific Accuracy ‣ 5 Ablation Study ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the comparison of client-specific accuracy in the CIFAR-100 dataset. This visualization helps to highlight that our scheduling algorithm achieves consistent accuracy across a spectrum of different clients without favoring any particular group.</p>
</div>
<figure id="S5.F5" class="ltx_figure">
<p id="S5.F5.1" class="ltx_p ltx_align_center"><span id="S5.F5.1.1" class="ltx_text"><img src="/html/2404.17799/assets/figure/cifar100_client.png" id="S5.F5.1.1.g1" class="ltx_graphics ltx_img_landscape" width="299" height="194" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Comparison of client-specific accuracy in the CIFAR-100 dataset. This figure visualizes the accuracy of each client in ascending order.</figcaption>
</figure>
<div id="S5.SS1.p3" class="ltx_para ltx_noindent">
<p id="S5.SS1.p3.1" class="ltx_p">Similarly, Figure <a href="#S5.F6" title="Figure 6 ‣ 5.1 Comparison of Client-specific Accuracy ‣ 5 Ablation Study ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> demonstrates the client-specific accuracy in the Tiny-ImageNet dataset. As with CIFAR-100, the visualization confirms that our algorithm manages to maintain high accuracy uniformly across different clients, showcasing its robustness.</p>
</div>
<figure id="S5.F6" class="ltx_figure">
<p id="S5.F6.1" class="ltx_p ltx_align_center"><span id="S5.F6.1.1" class="ltx_text"><img src="/html/2404.17799/assets/figure/tiny_client.png" id="S5.F6.1.1.g1" class="ltx_graphics ltx_img_landscape" width="299" height="194" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Comparison of client-specific accuracy in the Tiny-ImageNet dataset. This figure visualizes the accuracy of each client in ascending order.</figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Estimation of Computational Cost for Each Algorithm</h3>

<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.p1.1" class="ltx_p">In the actual experimental environment, using non-IID data makes it challenging to estimate computational costs. Therefore, we estimate the computational costs using the number of FLOPs. The number of parameters in each layer is mentioned following in Table <a href="#S5.T3" title="Table 3 ‣ 5.2 Estimation of Computational Cost for Each Algorithm ‣ 5 Ablation Study ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Number of Parameter per Layer</figcaption>
<table id="S5.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.1.1.1" class="ltx_tr">
<th id="S5.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">Layer</th>
<th id="S5.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"># of Parameters</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.1.2.1" class="ltx_tr">
<th id="S5.T3.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">conv1.weight</th>
<td id="S5.T3.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">800</td>
</tr>
<tr id="S5.T3.1.3.2" class="ltx_tr">
<th id="S5.T3.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">conv1.bias</th>
<td id="S5.T3.1.3.2.2" class="ltx_td ltx_align_left">32</td>
</tr>
<tr id="S5.T3.1.4.3" class="ltx_tr">
<th id="S5.T3.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">conv2.weight</th>
<td id="S5.T3.1.4.3.2" class="ltx_td ltx_align_left">51,200</td>
</tr>
<tr id="S5.T3.1.5.4" class="ltx_tr">
<th id="S5.T3.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">conv2.bias</th>
<td id="S5.T3.1.5.4.2" class="ltx_td ltx_align_left">64</td>
</tr>
<tr id="S5.T3.1.6.5" class="ltx_tr">
<th id="S5.T3.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">fc1.weight</th>
<td id="S5.T3.1.6.5.2" class="ltx_td ltx_align_left">524,288</td>
</tr>
<tr id="S5.T3.1.7.6" class="ltx_tr">
<th id="S5.T3.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">fc1.bias</th>
<td id="S5.T3.1.7.6.2" class="ltx_td ltx_align_left">512</td>
</tr>
<tr id="S5.T3.1.8.7" class="ltx_tr">
<th id="S5.T3.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">fc2.weight</th>
<td id="S5.T3.1.8.7.2" class="ltx_td ltx_align_left">5,120</td>
</tr>
<tr id="S5.T3.1.9.8" class="ltx_tr">
<th id="S5.T3.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">fc2.bias</th>
<td id="S5.T3.1.9.8.2" class="ltx_td ltx_align_left">10</td>
</tr>
<tr id="S5.T3.1.10.9" class="ltx_tr">
<th id="S5.T3.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t">Total Parameters</th>
<td id="S5.T3.1.10.9.2" class="ltx_td ltx_align_left ltx_border_b ltx_border_t">582,026</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.p2.1" class="ltx_p">To compare the computational costs of FedAvg, FedBABU, and our scheduling algorithms, we consider the data processed by each client in an IID (independent and identically distributed) environment. Costs are measured in FLOPs, and for simplicity, all algorithms are assumed to use datasets with an equal pixel count per image. In datasets like MNIST, CIFAR-10, and CIFAR-100, each with a total of 50,000 training data and 100 clients, each client processes 500 data points. In the setting of our experiments, a batch size of 10 is used, with each client handling 50 batches per epoch.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para ltx_noindent">
<p id="S5.SS2.p3.1" class="ltx_p">For FedAvg, as seen in the Table <a href="#S5.T3" title="Table 3 ‣ 5.2 Estimation of Computational Cost for Each Algorithm ‣ 5 Ablation Study ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the total model parameters are 582,026, and the computational cost per round is <math id="S5.SS2.p3.1.m1.2" class="ltx_Math" alttext="582,026\times 50" display="inline"><semantics id="S5.SS2.p3.1.m1.2a"><mrow id="S5.SS2.p3.1.m1.2.2.1" xref="S5.SS2.p3.1.m1.2.2.2.cmml"><mn id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">582</mn><mo id="S5.SS2.p3.1.m1.2.2.1.2" xref="S5.SS2.p3.1.m1.2.2.2.cmml">,</mo><mrow id="S5.SS2.p3.1.m1.2.2.1.1" xref="S5.SS2.p3.1.m1.2.2.1.1.cmml"><mn id="S5.SS2.p3.1.m1.2.2.1.1.2" xref="S5.SS2.p3.1.m1.2.2.1.1.2.cmml">026</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS2.p3.1.m1.2.2.1.1.1" xref="S5.SS2.p3.1.m1.2.2.1.1.1.cmml">×</mo><mn id="S5.SS2.p3.1.m1.2.2.1.1.3" xref="S5.SS2.p3.1.m1.2.2.1.1.3.cmml">50</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.2b"><list id="S5.SS2.p3.1.m1.2.2.2.cmml" xref="S5.SS2.p3.1.m1.2.2.1"><cn type="integer" id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">582</cn><apply id="S5.SS2.p3.1.m1.2.2.1.1.cmml" xref="S5.SS2.p3.1.m1.2.2.1.1"><times id="S5.SS2.p3.1.m1.2.2.1.1.1.cmml" xref="S5.SS2.p3.1.m1.2.2.1.1.1"></times><cn type="integer" id="S5.SS2.p3.1.m1.2.2.1.1.2.cmml" xref="S5.SS2.p3.1.m1.2.2.1.1.2">026</cn><cn type="integer" id="S5.SS2.p3.1.m1.2.2.1.1.3.cmml" xref="S5.SS2.p3.1.m1.2.2.1.1.3">50</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.2c">582,026\times 50</annotation></semantics></math>. Thus, the total computational cost for all clients and all rounds is 873.039 billion FLOPs. In the same environment, the computational cost for FedBABU, considering that the <span id="S5.SS2.p3.1.1" class="ltx_text ltx_font_italic">head</span> (fc2) layer parameters are not computed during the training rounds, results in 576,896 learning parameters. Hence, the total computational cost for FedBABU is 865.344 billion FLOPs. Using the same method for our scheduling algorithms, the computed parameters result in 314.912 billion FLOPs for Vanilla Scheduling and 838.880 billion FLOPs for Anti Scheduling, as detailed in Table <a href="#S5.T4" title="Table 4 ‣ 5.2 Estimation of Computational Cost for Each Algorithm ‣ 5 Ablation Study ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para ltx_noindent">
<p id="S5.SS2.p4.1" class="ltx_p">Figure <a href="#S5.F7" title="Figure 7 ‣ 5.2 Estimation of Computational Cost for Each Algorithm ‣ 5 Ablation Study ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> visually compares the computational costs between FedAvg, FedBABU, and our scheduling algorithms. It illustrates how Vanilla scheduling significantly reduces computational costs in the earlier rounds by updating only the earlier unfreezed layers. This visualization supports the data presented in Table <a href="#S5.T4" title="Table 4 ‣ 5.2 Estimation of Computational Cost for Each Algorithm ‣ 5 Ablation Study ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, emphasizing the efficiency of Vanilla Scheduling in managing computational resources.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comparison of Computational Cost</figcaption>
<table id="S5.T4.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T4.2.2" class="ltx_tr">
<th id="S5.T4.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Algorithm</th>
<th id="S5.T4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"># of FLOPs <math id="S5.T4.1.1.1.m1.1" class="ltx_math_unparsed" alttext="(\times 10^{9})" display="inline"><semantics id="S5.T4.1.1.1.m1.1a"><mrow id="S5.T4.1.1.1.m1.1b"><mo stretchy="false" id="S5.T4.1.1.1.m1.1.1">(</mo><mo lspace="0em" rspace="0.222em" id="S5.T4.1.1.1.m1.1.2">×</mo><msup id="S5.T4.1.1.1.m1.1.3"><mn id="S5.T4.1.1.1.m1.1.3.2">10</mn><mn id="S5.T4.1.1.1.m1.1.3.3">9</mn></msup><mo stretchy="false" id="S5.T4.1.1.1.m1.1.4">)</mo></mrow><annotation encoding="application/x-tex" id="S5.T4.1.1.1.m1.1c">(\times 10^{9})</annotation></semantics></math>
</th>
<th id="S5.T4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><math id="S5.T4.2.2.2.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.T4.2.2.2.m1.1a"><mi id="S5.T4.2.2.2.m1.1.1" xref="S5.T4.2.2.2.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.T4.2.2.2.m1.1b"><ci id="S5.T4.2.2.2.m1.1.1.cmml" xref="S5.T4.2.2.2.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.2.2.m1.1c">T</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T4.2.3.1" class="ltx_tr">
<td id="S5.T4.2.3.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>
</td>
<td id="S5.T4.2.3.1.2" class="ltx_td ltx_align_center ltx_border_t">873,04</td>
<td id="S5.T4.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t">300</td>
</tr>
<tr id="S5.T4.2.4.2" class="ltx_tr">
<td id="S5.T4.2.4.2.1" class="ltx_td ltx_align_center ltx_border_r">FedBABU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>
</td>
<td id="S5.T4.2.4.2.2" class="ltx_td ltx_align_center">865,34</td>
<td id="S5.T4.2.4.2.3" class="ltx_td ltx_align_center">300</td>
</tr>
<tr id="S5.T4.2.5.3" class="ltx_tr">
<td id="S5.T4.2.5.3.1" class="ltx_td ltx_align_center ltx_border_r">Vanilla Scheduling</td>
<td id="S5.T4.2.5.3.2" class="ltx_td ltx_align_center">314,91</td>
<td id="S5.T4.2.5.3.3" class="ltx_td ltx_align_center">300</td>
</tr>
<tr id="S5.T4.2.6.4" class="ltx_tr">
<td id="S5.T4.2.6.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Anti Scheduling</td>
<td id="S5.T4.2.6.4.2" class="ltx_td ltx_align_center ltx_border_b">838,88</td>
<td id="S5.T4.2.6.4.3" class="ltx_td ltx_align_center ltx_border_b">300</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.F7" class="ltx_figure">
<p id="S5.F7.1" class="ltx_p ltx_align_center"><span id="S5.F7.1.1" class="ltx_text"><img src="/html/2404.17799/assets/figure/computation.png" id="S5.F7.1.1.g1" class="ltx_graphics ltx_img_landscape" width="240" height="191" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Comparison of computational costs between FedAvg, FedBABU, and our scheduling algorithms. Vanilla scheduling significantly reduces computational costs in the initial rounds by updating only the front-end layers.</figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Accuracy Differences Due to Changes in Layer Unfreezing Timing</h3>

<div id="S5.SS3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.p1.2" class="ltx_p">In our two scheduling algorithms, the number of base layers, <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="t_{k}" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">t</mi><mi id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝑡</ci><ci id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">t_{k}</annotation></semantics></math>, is set to 3, leading to parameter unfreezing occurring across three phases. For instance, in Vanilla scheduling, training proceeds with the unfreezing of the conv1 layer from round <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="T=0" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">T</mi><mo id="S5.SS3.p1.2.m2.1.1.1" xref="S5.SS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><eq id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1.1"></eq><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">𝑇</ci><cn type="integer" id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">T=0</annotation></semantics></math> to 100. Subsequently, from rounds 100 to 200, both conv1 and conv2 layers are unfrozen for training. Finally, from round 200 to the final global round, all base layers, including conv1, conv2, and fc1, are unfrozen and utilized for training. While the unfreezing points in this paper are arbitrarily set for discussing the effectiveness of layer decoupling, an appropriate scheduling method is required accordingly. Therefore, we compare the differences in outcomes when unfreezing occurs at rounds 50 and 100 instead of 100 and 200.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para ltx_noindent">
<p id="S5.SS3.p2.7" class="ltx_p">In the CIFAR-100 dataset, with the global round <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="T=1000" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mi id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">T</mi><mo id="S5.SS3.p2.1.m1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><eq id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1"></eq><ci id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S5.SS3.p2.1.m1.1.1.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">T=1000</annotation></semantics></math> and layer unfreezing round set at <math id="S5.SS3.p2.2.m2.2" class="ltx_Math" alttext="t_{1}=0,t_{2}=100,t_{3}=200" display="inline"><semantics id="S5.SS3.p2.2.m2.2a"><mrow id="S5.SS3.p2.2.m2.2.2.2" xref="S5.SS3.p2.2.m2.2.2.3.cmml"><mrow id="S5.SS3.p2.2.m2.1.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.1.cmml"><msub id="S5.SS3.p2.2.m2.1.1.1.1.2" xref="S5.SS3.p2.2.m2.1.1.1.1.2.cmml"><mi id="S5.SS3.p2.2.m2.1.1.1.1.2.2" xref="S5.SS3.p2.2.m2.1.1.1.1.2.2.cmml">t</mi><mn id="S5.SS3.p2.2.m2.1.1.1.1.2.3" xref="S5.SS3.p2.2.m2.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS3.p2.2.m2.1.1.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.2.m2.1.1.1.1.3" xref="S5.SS3.p2.2.m2.1.1.1.1.3.cmml">0</mn></mrow><mo id="S5.SS3.p2.2.m2.2.2.2.3" xref="S5.SS3.p2.2.m2.2.2.3a.cmml">,</mo><mrow id="S5.SS3.p2.2.m2.2.2.2.2.2" xref="S5.SS3.p2.2.m2.2.2.2.2.3.cmml"><mrow id="S5.SS3.p2.2.m2.2.2.2.2.1.1" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.cmml"><msub id="S5.SS3.p2.2.m2.2.2.2.2.1.1.2" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.2.cmml"><mi id="S5.SS3.p2.2.m2.2.2.2.2.1.1.2.2" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.2.2.cmml">t</mi><mn id="S5.SS3.p2.2.m2.2.2.2.2.1.1.2.3" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.2.3.cmml">2</mn></msub><mo id="S5.SS3.p2.2.m2.2.2.2.2.1.1.1" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.2.m2.2.2.2.2.1.1.3" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.3.cmml">100</mn></mrow><mo id="S5.SS3.p2.2.m2.2.2.2.2.2.3" xref="S5.SS3.p2.2.m2.2.2.2.2.3a.cmml">,</mo><mrow id="S5.SS3.p2.2.m2.2.2.2.2.2.2" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2.cmml"><msub id="S5.SS3.p2.2.m2.2.2.2.2.2.2.2" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2.2.cmml"><mi id="S5.SS3.p2.2.m2.2.2.2.2.2.2.2.2" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2.2.2.cmml">t</mi><mn id="S5.SS3.p2.2.m2.2.2.2.2.2.2.2.3" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2.2.3.cmml">3</mn></msub><mo id="S5.SS3.p2.2.m2.2.2.2.2.2.2.1" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2.1.cmml">=</mo><mn id="S5.SS3.p2.2.m2.2.2.2.2.2.2.3" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2.3.cmml">200</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.2b"><apply id="S5.SS3.p2.2.m2.2.2.3.cmml" xref="S5.SS3.p2.2.m2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.2.2.3a.cmml" xref="S5.SS3.p2.2.m2.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS3.p2.2.m2.1.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1"><eq id="S5.SS3.p2.2.m2.1.1.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.1"></eq><apply id="S5.SS3.p2.2.m2.1.1.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.1.1.1.1.2.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.2.m2.1.1.1.1.2.2.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.2.2">𝑡</ci><cn type="integer" id="S5.SS3.p2.2.m2.1.1.1.1.2.3.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.2.3">1</cn></apply><cn type="integer" id="S5.SS3.p2.2.m2.1.1.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.1.1.3">0</cn></apply><apply id="S5.SS3.p2.2.m2.2.2.2.2.3.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.2.2.2.2.3a.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS3.p2.2.m2.2.2.2.2.1.1.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1"><eq id="S5.SS3.p2.2.m2.2.2.2.2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.1"></eq><apply id="S5.SS3.p2.2.m2.2.2.2.2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.2.2.2.2.1.1.2.1.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.2.m2.2.2.2.2.1.1.2.2.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.2.2">𝑡</ci><cn type="integer" id="S5.SS3.p2.2.m2.2.2.2.2.1.1.2.3.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.2.3">2</cn></apply><cn type="integer" id="S5.SS3.p2.2.m2.2.2.2.2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.1.1.3">100</cn></apply><apply id="S5.SS3.p2.2.m2.2.2.2.2.2.2.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2"><eq id="S5.SS3.p2.2.m2.2.2.2.2.2.2.1.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2.1"></eq><apply id="S5.SS3.p2.2.m2.2.2.2.2.2.2.2.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.2.2.2.2.2.2.2.1.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S5.SS3.p2.2.m2.2.2.2.2.2.2.2.2.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2.2.2">𝑡</ci><cn type="integer" id="S5.SS3.p2.2.m2.2.2.2.2.2.2.2.3.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2.2.3">3</cn></apply><cn type="integer" id="S5.SS3.p2.2.m2.2.2.2.2.2.2.3.cmml" xref="S5.SS3.p2.2.m2.2.2.2.2.2.2.3">200</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.2c">t_{1}=0,t_{2}=100,t_{3}=200</annotation></semantics></math>, Vanilla scheduling achieves an accuracy of 59.52%, while Anti scheduling achieves 60.06%. However, when the unfreezing round is changed to <math id="S5.SS3.p2.3.m3.2" class="ltx_Math" alttext="t_{1}=0,t_{2}=50,t_{3}=100" display="inline"><semantics id="S5.SS3.p2.3.m3.2a"><mrow id="S5.SS3.p2.3.m3.2.2.2" xref="S5.SS3.p2.3.m3.2.2.3.cmml"><mrow id="S5.SS3.p2.3.m3.1.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.1.cmml"><msub id="S5.SS3.p2.3.m3.1.1.1.1.2" xref="S5.SS3.p2.3.m3.1.1.1.1.2.cmml"><mi id="S5.SS3.p2.3.m3.1.1.1.1.2.2" xref="S5.SS3.p2.3.m3.1.1.1.1.2.2.cmml">t</mi><mn id="S5.SS3.p2.3.m3.1.1.1.1.2.3" xref="S5.SS3.p2.3.m3.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS3.p2.3.m3.1.1.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.3.m3.1.1.1.1.3" xref="S5.SS3.p2.3.m3.1.1.1.1.3.cmml">0</mn></mrow><mo id="S5.SS3.p2.3.m3.2.2.2.3" xref="S5.SS3.p2.3.m3.2.2.3a.cmml">,</mo><mrow id="S5.SS3.p2.3.m3.2.2.2.2.2" xref="S5.SS3.p2.3.m3.2.2.2.2.3.cmml"><mrow id="S5.SS3.p2.3.m3.2.2.2.2.1.1" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1.cmml"><msub id="S5.SS3.p2.3.m3.2.2.2.2.1.1.2" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1.2.cmml"><mi id="S5.SS3.p2.3.m3.2.2.2.2.1.1.2.2" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1.2.2.cmml">t</mi><mn id="S5.SS3.p2.3.m3.2.2.2.2.1.1.2.3" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1.2.3.cmml">2</mn></msub><mo id="S5.SS3.p2.3.m3.2.2.2.2.1.1.1" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.3.m3.2.2.2.2.1.1.3" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1.3.cmml">50</mn></mrow><mo id="S5.SS3.p2.3.m3.2.2.2.2.2.3" xref="S5.SS3.p2.3.m3.2.2.2.2.3a.cmml">,</mo><mrow id="S5.SS3.p2.3.m3.2.2.2.2.2.2" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2.cmml"><msub id="S5.SS3.p2.3.m3.2.2.2.2.2.2.2" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2.2.cmml"><mi id="S5.SS3.p2.3.m3.2.2.2.2.2.2.2.2" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2.2.2.cmml">t</mi><mn id="S5.SS3.p2.3.m3.2.2.2.2.2.2.2.3" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2.2.3.cmml">3</mn></msub><mo id="S5.SS3.p2.3.m3.2.2.2.2.2.2.1" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2.1.cmml">=</mo><mn id="S5.SS3.p2.3.m3.2.2.2.2.2.2.3" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2.3.cmml">100</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.2b"><apply id="S5.SS3.p2.3.m3.2.2.3.cmml" xref="S5.SS3.p2.3.m3.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.2.2.3a.cmml" xref="S5.SS3.p2.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS3.p2.3.m3.1.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1"><eq id="S5.SS3.p2.3.m3.1.1.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.1"></eq><apply id="S5.SS3.p2.3.m3.1.1.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.1.1.1.1.2.1.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.3.m3.1.1.1.1.2.2.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.2.2">𝑡</ci><cn type="integer" id="S5.SS3.p2.3.m3.1.1.1.1.2.3.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.2.3">1</cn></apply><cn type="integer" id="S5.SS3.p2.3.m3.1.1.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.1.1.3">0</cn></apply><apply id="S5.SS3.p2.3.m3.2.2.2.2.3.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.2.2.2.2.3a.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS3.p2.3.m3.2.2.2.2.1.1.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1"><eq id="S5.SS3.p2.3.m3.2.2.2.2.1.1.1.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1.1"></eq><apply id="S5.SS3.p2.3.m3.2.2.2.2.1.1.2.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.2.2.2.2.1.1.2.1.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.3.m3.2.2.2.2.1.1.2.2.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1.2.2">𝑡</ci><cn type="integer" id="S5.SS3.p2.3.m3.2.2.2.2.1.1.2.3.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1.2.3">2</cn></apply><cn type="integer" id="S5.SS3.p2.3.m3.2.2.2.2.1.1.3.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.1.1.3">50</cn></apply><apply id="S5.SS3.p2.3.m3.2.2.2.2.2.2.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2"><eq id="S5.SS3.p2.3.m3.2.2.2.2.2.2.1.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2.1"></eq><apply id="S5.SS3.p2.3.m3.2.2.2.2.2.2.2.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.2.2.2.2.2.2.2.1.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2.2">subscript</csymbol><ci id="S5.SS3.p2.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2.2.2">𝑡</ci><cn type="integer" id="S5.SS3.p2.3.m3.2.2.2.2.2.2.2.3.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2.2.3">3</cn></apply><cn type="integer" id="S5.SS3.p2.3.m3.2.2.2.2.2.2.3.cmml" xref="S5.SS3.p2.3.m3.2.2.2.2.2.2.3">100</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.2c">t_{1}=0,t_{2}=50,t_{3}=100</annotation></semantics></math>, Vanilla scheduling achieves 58.68%, and Anti scheduling achieves 59.02% accuracy, slightly lower accuracy. For the Tiny-ImageNet dataset at global round <math id="S5.SS3.p2.4.m4.1" class="ltx_Math" alttext="T=300" display="inline"><semantics id="S5.SS3.p2.4.m4.1a"><mrow id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml"><mi id="S5.SS3.p2.4.m4.1.1.2" xref="S5.SS3.p2.4.m4.1.1.2.cmml">T</mi><mo id="S5.SS3.p2.4.m4.1.1.1" xref="S5.SS3.p2.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.4.m4.1.1.3" xref="S5.SS3.p2.4.m4.1.1.3.cmml">300</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><apply id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1"><eq id="S5.SS3.p2.4.m4.1.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1.1"></eq><ci id="S5.SS3.p2.4.m4.1.1.2.cmml" xref="S5.SS3.p2.4.m4.1.1.2">𝑇</ci><cn type="integer" id="S5.SS3.p2.4.m4.1.1.3.cmml" xref="S5.SS3.p2.4.m4.1.1.3">300</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">T=300</annotation></semantics></math>, with <math id="S5.SS3.p2.5.m5.2" class="ltx_Math" alttext="t_{1}=0,t_{2}=100,t_{3}=200" display="inline"><semantics id="S5.SS3.p2.5.m5.2a"><mrow id="S5.SS3.p2.5.m5.2.2.2" xref="S5.SS3.p2.5.m5.2.2.3.cmml"><mrow id="S5.SS3.p2.5.m5.1.1.1.1" xref="S5.SS3.p2.5.m5.1.1.1.1.cmml"><msub id="S5.SS3.p2.5.m5.1.1.1.1.2" xref="S5.SS3.p2.5.m5.1.1.1.1.2.cmml"><mi id="S5.SS3.p2.5.m5.1.1.1.1.2.2" xref="S5.SS3.p2.5.m5.1.1.1.1.2.2.cmml">t</mi><mn id="S5.SS3.p2.5.m5.1.1.1.1.2.3" xref="S5.SS3.p2.5.m5.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS3.p2.5.m5.1.1.1.1.1" xref="S5.SS3.p2.5.m5.1.1.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.5.m5.1.1.1.1.3" xref="S5.SS3.p2.5.m5.1.1.1.1.3.cmml">0</mn></mrow><mo id="S5.SS3.p2.5.m5.2.2.2.3" xref="S5.SS3.p2.5.m5.2.2.3a.cmml">,</mo><mrow id="S5.SS3.p2.5.m5.2.2.2.2.2" xref="S5.SS3.p2.5.m5.2.2.2.2.3.cmml"><mrow id="S5.SS3.p2.5.m5.2.2.2.2.1.1" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.cmml"><msub id="S5.SS3.p2.5.m5.2.2.2.2.1.1.2" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.2.cmml"><mi id="S5.SS3.p2.5.m5.2.2.2.2.1.1.2.2" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.2.2.cmml">t</mi><mn id="S5.SS3.p2.5.m5.2.2.2.2.1.1.2.3" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.2.3.cmml">2</mn></msub><mo id="S5.SS3.p2.5.m5.2.2.2.2.1.1.1" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.5.m5.2.2.2.2.1.1.3" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.3.cmml">100</mn></mrow><mo id="S5.SS3.p2.5.m5.2.2.2.2.2.3" xref="S5.SS3.p2.5.m5.2.2.2.2.3a.cmml">,</mo><mrow id="S5.SS3.p2.5.m5.2.2.2.2.2.2" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2.cmml"><msub id="S5.SS3.p2.5.m5.2.2.2.2.2.2.2" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2.2.cmml"><mi id="S5.SS3.p2.5.m5.2.2.2.2.2.2.2.2" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2.2.2.cmml">t</mi><mn id="S5.SS3.p2.5.m5.2.2.2.2.2.2.2.3" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2.2.3.cmml">3</mn></msub><mo id="S5.SS3.p2.5.m5.2.2.2.2.2.2.1" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2.1.cmml">=</mo><mn id="S5.SS3.p2.5.m5.2.2.2.2.2.2.3" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2.3.cmml">200</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.5.m5.2b"><apply id="S5.SS3.p2.5.m5.2.2.3.cmml" xref="S5.SS3.p2.5.m5.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.5.m5.2.2.3a.cmml" xref="S5.SS3.p2.5.m5.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS3.p2.5.m5.1.1.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1.1.1"><eq id="S5.SS3.p2.5.m5.1.1.1.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1.1.1.1"></eq><apply id="S5.SS3.p2.5.m5.1.1.1.1.2.cmml" xref="S5.SS3.p2.5.m5.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.5.m5.1.1.1.1.2.1.cmml" xref="S5.SS3.p2.5.m5.1.1.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.5.m5.1.1.1.1.2.2.cmml" xref="S5.SS3.p2.5.m5.1.1.1.1.2.2">𝑡</ci><cn type="integer" id="S5.SS3.p2.5.m5.1.1.1.1.2.3.cmml" xref="S5.SS3.p2.5.m5.1.1.1.1.2.3">1</cn></apply><cn type="integer" id="S5.SS3.p2.5.m5.1.1.1.1.3.cmml" xref="S5.SS3.p2.5.m5.1.1.1.1.3">0</cn></apply><apply id="S5.SS3.p2.5.m5.2.2.2.2.3.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.5.m5.2.2.2.2.3a.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS3.p2.5.m5.2.2.2.2.1.1.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1"><eq id="S5.SS3.p2.5.m5.2.2.2.2.1.1.1.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.1"></eq><apply id="S5.SS3.p2.5.m5.2.2.2.2.1.1.2.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.5.m5.2.2.2.2.1.1.2.1.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.5.m5.2.2.2.2.1.1.2.2.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.2.2">𝑡</ci><cn type="integer" id="S5.SS3.p2.5.m5.2.2.2.2.1.1.2.3.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.2.3">2</cn></apply><cn type="integer" id="S5.SS3.p2.5.m5.2.2.2.2.1.1.3.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.1.1.3">100</cn></apply><apply id="S5.SS3.p2.5.m5.2.2.2.2.2.2.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2"><eq id="S5.SS3.p2.5.m5.2.2.2.2.2.2.1.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2.1"></eq><apply id="S5.SS3.p2.5.m5.2.2.2.2.2.2.2.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.5.m5.2.2.2.2.2.2.2.1.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2.2">subscript</csymbol><ci id="S5.SS3.p2.5.m5.2.2.2.2.2.2.2.2.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2.2.2">𝑡</ci><cn type="integer" id="S5.SS3.p2.5.m5.2.2.2.2.2.2.2.3.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2.2.3">3</cn></apply><cn type="integer" id="S5.SS3.p2.5.m5.2.2.2.2.2.2.3.cmml" xref="S5.SS3.p2.5.m5.2.2.2.2.2.2.3">200</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.5.m5.2c">t_{1}=0,t_{2}=100,t_{3}=200</annotation></semantics></math>, Vanilla and Anti scheduling achieve accuracies of 41.86% and 41.94%, respectively. Changing the unfreezing points to <math id="S5.SS3.p2.6.m6.2" class="ltx_Math" alttext="t_{1}=0,t_{2}=50,t_{3}=100" display="inline"><semantics id="S5.SS3.p2.6.m6.2a"><mrow id="S5.SS3.p2.6.m6.2.2.2" xref="S5.SS3.p2.6.m6.2.2.3.cmml"><mrow id="S5.SS3.p2.6.m6.1.1.1.1" xref="S5.SS3.p2.6.m6.1.1.1.1.cmml"><msub id="S5.SS3.p2.6.m6.1.1.1.1.2" xref="S5.SS3.p2.6.m6.1.1.1.1.2.cmml"><mi id="S5.SS3.p2.6.m6.1.1.1.1.2.2" xref="S5.SS3.p2.6.m6.1.1.1.1.2.2.cmml">t</mi><mn id="S5.SS3.p2.6.m6.1.1.1.1.2.3" xref="S5.SS3.p2.6.m6.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S5.SS3.p2.6.m6.1.1.1.1.1" xref="S5.SS3.p2.6.m6.1.1.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.6.m6.1.1.1.1.3" xref="S5.SS3.p2.6.m6.1.1.1.1.3.cmml">0</mn></mrow><mo id="S5.SS3.p2.6.m6.2.2.2.3" xref="S5.SS3.p2.6.m6.2.2.3a.cmml">,</mo><mrow id="S5.SS3.p2.6.m6.2.2.2.2.2" xref="S5.SS3.p2.6.m6.2.2.2.2.3.cmml"><mrow id="S5.SS3.p2.6.m6.2.2.2.2.1.1" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1.cmml"><msub id="S5.SS3.p2.6.m6.2.2.2.2.1.1.2" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1.2.cmml"><mi id="S5.SS3.p2.6.m6.2.2.2.2.1.1.2.2" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1.2.2.cmml">t</mi><mn id="S5.SS3.p2.6.m6.2.2.2.2.1.1.2.3" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1.2.3.cmml">2</mn></msub><mo id="S5.SS3.p2.6.m6.2.2.2.2.1.1.1" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.6.m6.2.2.2.2.1.1.3" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1.3.cmml">50</mn></mrow><mo id="S5.SS3.p2.6.m6.2.2.2.2.2.3" xref="S5.SS3.p2.6.m6.2.2.2.2.3a.cmml">,</mo><mrow id="S5.SS3.p2.6.m6.2.2.2.2.2.2" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2.cmml"><msub id="S5.SS3.p2.6.m6.2.2.2.2.2.2.2" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2.2.cmml"><mi id="S5.SS3.p2.6.m6.2.2.2.2.2.2.2.2" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2.2.2.cmml">t</mi><mn id="S5.SS3.p2.6.m6.2.2.2.2.2.2.2.3" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2.2.3.cmml">3</mn></msub><mo id="S5.SS3.p2.6.m6.2.2.2.2.2.2.1" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2.1.cmml">=</mo><mn id="S5.SS3.p2.6.m6.2.2.2.2.2.2.3" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2.3.cmml">100</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.6.m6.2b"><apply id="S5.SS3.p2.6.m6.2.2.3.cmml" xref="S5.SS3.p2.6.m6.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.6.m6.2.2.3a.cmml" xref="S5.SS3.p2.6.m6.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS3.p2.6.m6.1.1.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1.1.1"><eq id="S5.SS3.p2.6.m6.1.1.1.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1.1.1.1"></eq><apply id="S5.SS3.p2.6.m6.1.1.1.1.2.cmml" xref="S5.SS3.p2.6.m6.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.6.m6.1.1.1.1.2.1.cmml" xref="S5.SS3.p2.6.m6.1.1.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.6.m6.1.1.1.1.2.2.cmml" xref="S5.SS3.p2.6.m6.1.1.1.1.2.2">𝑡</ci><cn type="integer" id="S5.SS3.p2.6.m6.1.1.1.1.2.3.cmml" xref="S5.SS3.p2.6.m6.1.1.1.1.2.3">1</cn></apply><cn type="integer" id="S5.SS3.p2.6.m6.1.1.1.1.3.cmml" xref="S5.SS3.p2.6.m6.1.1.1.1.3">0</cn></apply><apply id="S5.SS3.p2.6.m6.2.2.2.2.3.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.6.m6.2.2.2.2.3a.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S5.SS3.p2.6.m6.2.2.2.2.1.1.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1"><eq id="S5.SS3.p2.6.m6.2.2.2.2.1.1.1.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1.1"></eq><apply id="S5.SS3.p2.6.m6.2.2.2.2.1.1.2.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S5.SS3.p2.6.m6.2.2.2.2.1.1.2.1.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1.2">subscript</csymbol><ci id="S5.SS3.p2.6.m6.2.2.2.2.1.1.2.2.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1.2.2">𝑡</ci><cn type="integer" id="S5.SS3.p2.6.m6.2.2.2.2.1.1.2.3.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1.2.3">2</cn></apply><cn type="integer" id="S5.SS3.p2.6.m6.2.2.2.2.1.1.3.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.1.1.3">50</cn></apply><apply id="S5.SS3.p2.6.m6.2.2.2.2.2.2.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2"><eq id="S5.SS3.p2.6.m6.2.2.2.2.2.2.1.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2.1"></eq><apply id="S5.SS3.p2.6.m6.2.2.2.2.2.2.2.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.SS3.p2.6.m6.2.2.2.2.2.2.2.1.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2.2">subscript</csymbol><ci id="S5.SS3.p2.6.m6.2.2.2.2.2.2.2.2.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2.2.2">𝑡</ci><cn type="integer" id="S5.SS3.p2.6.m6.2.2.2.2.2.2.2.3.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2.2.3">3</cn></apply><cn type="integer" id="S5.SS3.p2.6.m6.2.2.2.2.2.2.3.cmml" xref="S5.SS3.p2.6.m6.2.2.2.2.2.2.3">100</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.6.m6.2c">t_{1}=0,t_{2}=50,t_{3}=100</annotation></semantics></math> results in accuracies of 41.23% for Vanilla and 41.63% for Anti scheduling, which are also slightly lower. The insight gained here is that while the timing of layer unfreezing does not significantly affect accuracy, as seen in Section <a href="#S5.SS2" title="5.2 Estimation of Computational Cost for Each Algorithm ‣ 5 Ablation Study ‣ Personalized Federated Learning via Sequential Layer Expansion in Representation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>, it has a substantial impact on computational cost. Therefore, setting larger values for <math id="S5.SS3.p2.7.m7.1" class="ltx_Math" alttext="t_{k}" display="inline"><semantics id="S5.SS3.p2.7.m7.1a"><msub id="S5.SS3.p2.7.m7.1.1" xref="S5.SS3.p2.7.m7.1.1.cmml"><mi id="S5.SS3.p2.7.m7.1.1.2" xref="S5.SS3.p2.7.m7.1.1.2.cmml">t</mi><mi id="S5.SS3.p2.7.m7.1.1.3" xref="S5.SS3.p2.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.7.m7.1b"><apply id="S5.SS3.p2.7.m7.1.1.cmml" xref="S5.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.7.m7.1.1.1.cmml" xref="S5.SS3.p2.7.m7.1.1">subscript</csymbol><ci id="S5.SS3.p2.7.m7.1.1.2.cmml" xref="S5.SS3.p2.7.m7.1.1.2">𝑡</ci><ci id="S5.SS3.p2.7.m7.1.1.3.cmml" xref="S5.SS3.p2.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.7.m7.1c">t_{k}</annotation></semantics></math> is advantageous where possible.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Application of Scheduling to Baseline Algorithms</h3>

<div id="S5.SS4.p1" class="ltx_para ltx_noindent">
<p id="S5.SS4.p1.1" class="ltx_p">When our scheduling methods are applied to the baseline algorithms, there was no observed improvement in accuracy. This lack of improvement is attributed to the fact that, except for <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, other algorithms update the head during training rounds, which nullifies the effect of freezing base layers. Furthermore, Vanilla scheduling achieved a performance similar to the non-scheduled approach, while Anti scheduling, in particular, resulted in significantly lower accuracy. Therefore, natively applying a dense division of the base layer only for scheduling purposes might inadvertently lead to a negative impact on accuracy. Additionally, if the head layer is utilized for local updates during training, the intended effect of freezing the base layers is effectively nullified.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">This research introduces a layer decoupling technique in representation learning, a domain of personalized federated learning, to address data and class heterogeneity among clients. In traditional representation learning, the model is divided into ’base’ and ’head’ components, each customized to process the common and unique features of client data, respectively. Our primary contribution focuses on the dense division of the base component in representation learning, and the subsequent application of two novel scheduling methodologies, namely Vanilla and Anti scheduling, to these finely segmented base layers in federated learning architecture. The Vanilla scheduling approach excels in significantly reducing computational costs without degrading model performance. This aspect is particularly crucial in federated learning environments where resources and computational power are often limited. Conversely, Anti scheduling demonstrates superior capability in handling scenarios with pronounced data and class heterogeneity. Our experimental analysis, conducted on datasets with high data and class heterogeneity, such as CIFAR-100 and Tiny-ImageNet, shows that these scheduling methods not only contribute to a more efficient training process but also ensure fair improvements in accuracy across all clients. This addresses the challenges of personalized federated learning by ensuring that no single client’s data disproportionately influences the global model.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
IS Jacobs and CP Bean.

</span>
<span class="ltx_bibblock">Fine particles, thin films and exchange anisotropy (effects of finite dimensions and interfaces on the basic properties of ferromagnets).

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Spin arrangements and crystal structure, domains, and micromagnetics</span>, 3:271–350, 1963.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
A Mactaggert.

</span>
<span class="ltx_bibblock">The california privacy rights and enforcement act of 2020.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Retrieved October</span>, 21(2020):19–0019, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pages 1273–1282. PMLR, 2017.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Proceedings of Machine learning and systems</span>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">International conference on machine learning</span>, pages 5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Yoshua Bengio, Jérôme Louradour, Ronan Collobert, and Jason Weston.

</span>
<span class="ltx_bibblock">Curriculum learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Proceedings of the 26th annual international conference on machine learning</span>, pages 41–48, 2009.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Saeed Vahidian, Sreevatsank Kadaveru, Woonjoon Baek, Weijia Wang, Vyacheslav Kungurtsev, Chen Chen, Mubarak Shah, and Bill Lin.

</span>
<span class="ltx_bibblock">When do curricula work in federated learning?

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</span>, pages 5084–5094, 2023.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Alysa Ziying Tan, Han Yu, Lizhen Cui, and Qiang Yang.

</span>
<span class="ltx_bibblock">Towards personalized federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</span>, 2022.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Chelsea Finn, Pieter Abbeel, and Sergey Levine.

</span>
<span class="ltx_bibblock">Model-agnostic meta-learning for fast adaptation of deep networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">International conference on machine learning</span>, pages 1126–1135. PMLR, 2017.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Alex Nichol, Joshua Achiam, and John Schulman.

</span>
<span class="ltx_bibblock">On first-order meta-learning algorithms.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1803.02999</span>, 2018.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Daliang Li and Junpu Wang.

</span>
<span class="ltx_bibblock">Fedmd: Heterogenous federated learning via model distillation.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1910.03581</span>, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Yiqiang Chen, Xin Qin, Jindong Wang, Chaohui Yu, and Wen Gao.

</span>
<span class="ltx_bibblock">Fedhealth: A federated transfer learning framework for wearable healthcare.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">IEEE Intelligent Systems</span>, 35(4):83–93, 2020.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Virginia Smith, Chao-Kai Chiang, Maziar Sanjabi, and Ameet S Talwalkar.

</span>
<span class="ltx_bibblock">Federated multi-task learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 30, 2017.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Manoj Ghuhan Arivazhagan, Vinay Aggarwal, Aaditya Kumar Singh, and Sunav Choudhary.

</span>
<span class="ltx_bibblock">Federated learning with personalization layers.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1912.00818</span>, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Paul Pu Liang, Terrance Liu, Liu Ziyin, Nicholas B Allen, Randy P Auerbach, David Brent, Ruslan Salakhutdinov, and Louis-Philippe Morency.

</span>
<span class="ltx_bibblock">Think locally, act globally: Federated learning with local and global representations.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2001.01523</span>, 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Liam Collins, Hamed Hassani, Aryan Mokhtari, and Sanjay Shakkottai.

</span>
<span class="ltx_bibblock">Exploiting shared representations for personalized federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">International conference on machine learning</span>, pages 2089–2099. PMLR, 2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Hong-You Chen and Wei-Lun Chao.

</span>
<span class="ltx_bibblock">On bridging generic and personalized federated learning for image classification.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2107.00778</span>, 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Jaehoon Oh, Sangmook Kim, and Se-Young Yun.

</span>
<span class="ltx_bibblock">Fedbabu: Towards enhanced representation for federated image classification.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2106.06042</span>, 2021.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2404.17798" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2404.17799" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2404.17799">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2404.17799" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2404.17802" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun May  5 18:18:42 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
